(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[32],{1454:function(z,F,b){function a(kc){return Jf.call(this,kc)||this}function c(kc){this.$=kc}function e(kc){var $c=$e.call(this)||this;$c.$=kc;$c.Xb();return $c}function l(kc,$c,rd,me,te){var ge=zc.call(this)||this;ge.statusBarManager=null;ge.f0c=!1;ge.V$=null;ge.qEc=!1;ge.bRd=null;ge.cza=null;ge.XGd=!1;ge.Do=!1;ge.Zp=null;ge.uhe=null;ge.Hga=null;ge.nge=null;ge.XEa=null;ge.MOe=function(){oa.ULS.sendTraceTag(537154520,306,
50,"PolicyManagerWrapper::EnableAutoLabellingInDocument - Triggered EnableAutoLabellingInDocument");var pd=ge.aSf(1);oa.ULS.sendTraceTag(537154519,306,50,"PolicyManagerWrapper::EnableAutoLabellingInDocument - Annotation registration result: {0}.",pd)};ge.kVd=function(pd,jc){jc?(ge.Zp=jc.title,ge.uhe=jc.isc,ge.Hga=jc.buttonText,ge.nge=jc.Qyf,ge.ZE.lg(27,null),oa.ULS.sendTraceTag(537154509,306,50,"Add entry to BusinessBar succeeded. Message is shown to user.")):oa.ULS.sendTraceTag(537154510,306,15,
"ShowPolicyBusinessBar is called but PolicyTipventArgs is null.")};ge.A8f=function(pd,jc){var jf=Object(ie.a)(ea,jc);jf?jf.Z7f?ge.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CommonBusinessBarEntryForSensitivityLabelError",!1)?(oa.ULS.sendTraceTag(537154508,306,15,"ShowSetPolicyLabelFailureInBusinessBar :: SetPolicyLabelFailure because of {0}",jf.errorType),ge.ZE.WGj(jf.title,jf.message,jf.buttonText,function(dc){jf.zZ&&(ge.ZE.HC(52)&&ge.ZE.removeEntry(52),jf.zZ(dc))})):1===jf.errorType?
(oa.ULS.sendTraceTag(537154507,306,15,"ShowSetPolicyLabelFailureInBusinessBar :: SetPolicyLabelFailure because of File too large"),ge.ZE.lg(47,null)):2===jf.errorType?ge.ZE.lg(48,null):3===jf.errorType?ge.ZE.lg(49,null):4===jf.errorType?ge.ZE.lg(50,null):5===jf.errorType?ge.ZE.XGj(jf.title,jf.message,jf.buttonText,function(dc){ge.ZE.HC(51)&&ge.ZE.removeEntry(51);jf.zZ(dc)}):ge.ZE.lg(46,null):oa.ULS.sendTraceTag(537154506,306,50,"ShowSetPolicyLabelFailureInBusinessBar :: SetPolicyLabelFailure ShowMessage is false"):
(oa.ULS.sendTraceTag(537154505,306,10,"ShowSetPolicyLabelFailureInBusinessBar :: SetPolicyLabelFailure args is null"),ge.ZE.lg(46,null))};ge.C0d=function(pd,jc){ge.q7&&(oa.ULS.sendTraceTag(537154504,306,50,"PolicyManagerWrapper: UpdateLabelInfo called"),ge.q7.L3f(),ge.q7.a3f(),ge.q7.oOf(),ge.$.Dd&64&&(jc.onSuccess&&ge.cza?ge.COg():ge.q7.Tdg()));ge.ha.ra("SupportsOfficeClientCoauthoring")&&(pd=ge.Qr.Hn,ge.XEa=pd.AppliedPolicyId,"null"===ge.labelId&&(ge.XEa=""),ge.qEc&&(pd=pd.PolicyLabelAssignmentMethod&&
Nb.c(pd.PolicyLabelAssignmentMethod)===Nb.c("standard")?4:2,ge.applyPolicyLabel(ge.labelId,pd,!0,ge.bRd)));ge.uVe();ge.Xz()};ge.lCf=function(){ge.XGd=!0;ge.uVe()};ge.WGf=function(pd,jc){oa.ULS.sendTraceTag(42322116,306,50,"PolicyManagerWrapper.OnSetLabelSucceeded: Applying outcomes for change in policy label. ProtectedFile = {0}, ApplyLabelFlag = {1}",nb.AFrameworkApplication.protectedFile,jc.zQ);ge.applyPolicyLabel(jc.hsc,jc.zQ,!1,null)};ge.KLi=function(pd,jc){ge.XEa=jc.hsc;if(Cd.a.Ar(pd.Errors)){var jf=
Cd.a.eba(pd.Errors,[2045508683]);0<jf.length&&(pd.Errors=Cd.a.uG(pd.Errors,[2045508683],"PolicyManagerWrapper: OnApplyManualPolicyLabelSuccessCallback"),ge.$.ea.Hp(pd.Errors));jf=Cd.a.eba(pd.Errors,[2046680228]);0<jf.length&&(4===jc.zQ||1===jc.zQ)&&(pd.Errors=Cd.a.uG(pd.Errors,[2046680228],"PolicyManagerWrapper: OnApplyManualPolicyLabelSuccessCallback"),ge.$.ea.Hp(pd.Errors));jf=pd=null;for(var dc=Cl(ge.Qr.Hn.SensitivityLabels),za=dc.next();!za.done;za=dc.next())za=za.value,od.a.equals(ge.labelId,
za.Id,!1)&&(pd=za),od.a.equals(jc.Z0f,za.Id,!1)&&(jf=za);dc={};dc.ApplyLabelFlag=jc.zQ;pd?(dc.currentLabel="Set",dc.currentLabelEnabled=pd.Enabled,dc.currentLabelName=pd.Name?"Set":"NotSet",dc.currentLabelParentId=pd.ParentId?"Set":"NotSet"):dc.currentLabel="NotSet";jf?(dc.serverLabel="Set",dc.serverLabelEnabled=jf.Enabled,dc.serverLabelName=jf.Name?"Set":"NotSet",dc.serverLabelParentId=jf.ParentId?"Set":"NotSet"):dc.serverLabel="NotSet";oa.ULS.sendTraceTag(541638850,306,15,"PolicyManagerWrapper.OnApplyManualPolicyLabelSuccessCallback Failed. DiagnosticInfo : {0}",
JSON.stringify(dc))}};ge.JSg=function(pd,jc){if(!ge.$.workbookContext.HasRoundTrippedHFPart)return!1;var jf=ge.Qr.Hn;if(!jf)return oa.ULS.sendTraceTag(537154502,306,15,"PolicyManagerWrapper.BlockSetSensitivityCall: policyLabelsData is null."),!1;var dc=null;jf=Cl(jf.SensitivityLabels);for(var za=jf.next();!za.done;za=jf.next())za=za.value,od.a.equals(za.Id,pd,!1)&&(dc=za);return dc&&ge.gai(dc)?(oa.ULS.sendTraceTag(50341186,306,50,"PolicyManagerWrapper.BlockSetSensitivityCall: selectedSensitivityLabel has watermark label action."),
ge.CEj(jc),!0):!1};ge.Aji=function(){var pd=!1;!ge.$.ya.IsNewWorkbook||ge.labelId&&ge.labelId.length||(pd=!0);oa.ULS.sendTraceTag(537154501,306,50,"PolicyManagerWrapper.IsANewFile: is this a new file : {0}",pd);return pd};ge.Zsf=function(pd,jc){1===jc.$te?ge.$.isEditMode?(oa.ULS.sendTraceTag(537154500,306,50,"MandatoryLabellingHandler : Swtiching to view-mode."),ge.$.Ka.dc(new ed.a(-723527778,0,ge.$.jd,10,null))):oa.ULS.sendTraceTag(537154499,306,50,"MandatoryLabellingHandler : App is already in view-mode."):
(ge.cza=jc.cza,ge.$.ea.A$(ge.ove),ge.$.Bgb(),oa.ULS.sendTraceTag(537154498,306,50,"MandatoryLabellingHandler : Swtiching to edit-mode."),ge.$.Ka.dc(new ed.a(-8805455,0,ge.$.jd,10,null)))};ge.Hpe=function(pd,jc){jc?(pd=!!(ge.$.Dd&64),oa.ULS.sendTraceTag(537154496,306,50,"AddMandatoryLabellingBusinessBar User has edit permission : {0}",pd),pd&&(ge.$.Bgb(),ge.ZE.aGj(jc.title,jc.message,jc.buttonText,function(jf){jc.zZ(jf)}))):oa.ULS.sendTraceTag(537154497,306,15,"AddMandatoryLabellingBusinessBar is called but MandatoryLabellingAppHandlerEventArgs is null.")};
ge.sTf=function(){ge.ZE.HC(40)&&ge.ZE.removeEntry(40)};ge.cfg=function(pd,jc){jc.ICj&&(oa.ULS.sendTraceTag(527716803,306,50,"PolicyManagerWrapper.udpLabelingAppHandler: Open the document in the client when the applied label is a UDP label."),Zd.TaskExtensions.Ba(Pc.GetServiceTaskFactory.Ua(ge.$.da,55,56,0),function(jf){jf.result.m5c()},ge.$.la,3))};ge.ove=function(){ge.cza&&ge.$.isEditMode?(ge.$.ea.N7(ge.ove),ge.a5a()):oa.ULS.sendTraceTag(537154467,306,15,"ApplyMandatoryLabelOnEditMode : mandatoryPolicyId empty {0} , edit mode : {1}.",
!ge.cza,ge.$.isEditMode)};ge.ARj=function(){ge.$.isEditMode?(ge.$.ea.N7(ge.ARj),ge.a5a()):oa.ULS.sendTraceTag(537154466,306,15,"TriggerDefaultLabelingOnModeChanged is not expected in View-mode. Mode.")};ge.Zka=function(){var pd=ge.$.ea.Pm;pd&&!od.a.equals(pd.AppliedPolicyLabelId,ge.labelId,!1)&&(oa.ULS.sendTraceTag(537154464,306,50,"PolicyManagerWrapper.HandleWorkbookMetadataChanged: Calling GetPolicyLabels to update statusbar and ribbon control."),oa.ULS.shipAssertTag(537154463,306,ge.$.isEditMode,
"PolicyManagerWrapper.HandleWorkbookMetadataChanged policyId cannot change in read-only mode, this can happen if right policy id is not read from server."),ge.ha.ra("SupportsOfficeClientCoauthoring")&&ge.$.isEditMode&&(ge.qEc=!0,ge.bRd=pd.AppliedPolicyLabelId),ge.XEa=pd.AppliedPolicyLabelId,ge.a5a())};ge.rrd=function(){var pd=!0;if(!ge.$.ea.amIAlone)for(var jc=Cl(ge.$.ea.Om),jf=jc.next();!jf.done;jf=jc.next())if(!jf.value.SupportsClientIsMipTrusted){pd=!1;break}oa.ULS.sendTraceTag(537154462,306,50,
"PolicyManagerWrapper.IsEveryCoauthorInSessionClientMipTrusted : {0}",pd);return pd};ge.qDf=function(){oa.ULS.sendTraceTag(537154461,306,50,"PolicyManagerWrapper.OnLabelUpdate: RTC notification received");ge.qEc=!0;ge.a5a()};ge.$=me;ge.Qr=kc;ge.ZE=rd;ge.ha=te;ge.Qr.Pre(ge.kVd);ge.q7=$c;return ge}function m(kc){return zd.call(this,kc,m.JR(kc))||this}function n(kc,$c,rd,me,te){var ge=kf.call(this)||this;ge.ktf=3;ge.augmentationLoopManager=null;ge.eB=null;ge.Z_a=!1;ge.Eab=[];ge.Nnf=new qd.a(He.a.LK());
ge.iId=0;ge.nId=null;ge.a6b=function(pd,jc){pd=Object.assign(new Od.a,{parentPath:["session","doc","security"],items:[Object.assign(new ae.a,{id:"clp",body:Object.assign(new w,{existingLabelPriority:jc.existingLabelPriority,partialDocSITs:jc.HDe,fullDocSITs:jc.GDe})})]});ge.Eab.push(pd);ge.Ezb()};ge.qgg=function(pd,jc){pd=Object.assign(new Ad.a,{parentPath:["session","doc","security"],items:[Object.assign(new ae.a,{id:"clp",body:Object.assign(new w,{existingLabelPriority:jc.existingLabelPriority})})]});
ge.Eab.push(pd);ge.Ezb()};ge.rgg=function(pd,jc){pd=Object.assign(new Ad.a,{parentPath:["session","doc","security"],items:[Object.assign(new ae.a,{id:"clp",body:Object.assign(new w,{partialDocSITs:jc.HDe,fullDocSITs:jc.GDe})})]});ge.Eab.push(pd);ge.Ezb()};ge.W6=function(){oa.ULS.sendTraceTag(537154588,306,50,"AutoPolicyManager::OnApplicationModeChanged - isEditMode:{0}.",ge.$.isEditMode);ge.$.isEditMode?La.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",!1)?ge.Ezb():
ge.vdf():(ge.businessBar.removeEntry(39),ge.businessBar.removeEntry(38),ge.agh())};ge.Hoc=function(){oa.ULS.sendTraceTag(537154587,306,50,"AutoPolicyManager::OnAugmentationLoopSessionClose called.");ge.dLe();ge.augmentationLoopManager=null};ge.Bvi=function(pd,jc){var jf,dc,za,Mb,hc;oa.ULS.sendTraceTag(537154586,306,50,"AutoPolicyManager::LabellingAnnotationHandler called.");if(3===jc.operationType)oa.ULS.sendTraceTag(537154585,306,50,"AutoPolicyManager::LabellingAnnotationHandler Ignoring delete operation.");
else{var cc=pd=null,Ec=null;if(ge.eqd()){var Lc=jc.$J;if(!Lc){oa.ULS.sendTraceTag(537154584,306,50,"AutoPolicyManager::LabellingAnnotationHandler LabellingAnnotation is null.");return}if(null===(jf=Lc.automatic)||void 0===jf?0:jf.id)pd=Lc.automatic.id;if(null===(dc=Lc.recommended)||void 0===dc?0:dc.id)cc=Lc.recommended.id,Lc.recommended.policyTip&&(Ec=Lc.recommended.policyTip)}else{jf=jc.$J;if(!jf){oa.ULS.sendTraceTag(537154583,306,50,"AutoPolicyManager::LabellingAnnotationHandler LabellingAnnotation is null.");
return}if(null===(za=null===(Lc=jf.automatic)||void 0===Lc?void 0:Lc.sensitivityLabel)||void 0===za?0:za.id)pd=jf.automatic.sensitivityLabel.id;if(null===(hc=null===(Mb=jf.recommended)||void 0===Mb?void 0:Mb.sensitivityLabel)||void 0===hc?0:hc.id)cc=jf.recommended.sensitivityLabel.id,jf.recommended.sensitivityLabel.policyTip&&(Ec=jf.recommended.sensitivityLabel.policyTip)}ge.applyPolicyLabel(pd,cc,Ec,1)}};ge.rxi=function(pd,jc){oa.ULS.sendTraceTag(537154582,306,50,"AutoPolicyManager::LinkedDataTypeLabellingAnnnotationHandler - Handler called.");
3===jc.operationType?oa.ULS.sendTraceTag(537154581,306,50,"AutoPolicyManager::LinkedDataTypeLabellingAnnnotationHandler - Received delete operation."):(pd=jc.$J)?(pd=pd.classificationId,ge.applyPolicyLabel(pd,pd,null,2)):oa.ULS.sendTraceTag(537154580,306,50,"AutoPolicyManager::LinkedDataTypeLabellingAnnnotationHandler - Received an empty annotation.")};ge.USf=function(pd,jc){jc?jc.yBb&&ge.businessBar.HC(39)?(ge.businessBar.removeEntry(39),oa.ULS.sendTraceTag(537154562,306,50,"Remove entry to RecommendedSensitivityLabelBusinessBarEntry succeeded.")):
!jc.yBb&&ge.businessBar.HC(38)&&(ge.businessBar.removeEntry(38),oa.ULS.sendTraceTag(537154561,306,50,"Remove entry to AutomaticSensitivityLabelBusinessBarEntry succeeded.")):oa.ULS.sendTraceTag(537154563,306,15,"RemoveAutoPolicyBusinessBar is called but AddAutoPolicyBusinessBarEntryEventArgs is null.")};ge.j7f=function(pd,jc){jc?jc.yBb?(ge.businessBar.MGj(jc.title,jc.message,jc.buttonText,function(jf){jc.zZ(jf);ge.businessBar.HC(39)&&ge.businessBar.removeEntry(39)}),oa.ULS.sendTraceTag(537154531,
306,50,"Add entry to RecommendedSensitivityLabelBusinessBarEntry succeeded. Message is shown to user.")):(ge.businessBar.AEj(jc.title,jc.message,jc.buttonText,function(jf){jc.zZ(jf);ge.businessBar.HC(38)&&ge.businessBar.removeEntry(38)}),oa.ULS.sendTraceTag(537154530,306,50,"Add entry to AutomaticSensitivityLabelBusinessBarEntry succeeded. Message is shown to user.")):oa.ULS.sendTraceTag(537154560,306,15,"ShowAutoPolicyBusinessBar is called but AddAutoPolicyBusinessBarEntryEventArgs is null.")};ge.WGd=
kc;ge.policyManager=$c;ge.$=rd;ge.ha=me;ge.businessBar=te;ge.Ddi();ge.acj();ge.disposed=!1;return ge}function h(){var kc=Ve.call(this)||this;kc.classificationId=null;kc.H_=Object.assign(new Ae.a,{T_:h.getTypeName(),B_:h.xe()});return kc}function u(){var kc=Bc.call(this)||this;kc.recommended=null;kc.automatic=null;kc.source=null;kc.H_=Object.assign(new Ae.a,{T_:u.getTypeName(),B_:u.xe()});return kc}function w(){var kc=r.call(this)||this;kc.existingLabelPriority=null;kc.H_=Object.assign(new Ae.a,{T_:w.getTypeName(),
B_:w.xe()});return kc}function r(){var kc=we.call(this)||this;kc.partialDocSITs=null;kc.fullDocSITs=null;kc.H_=Object.assign(new Ae.a,{T_:r.getTypeName(),B_:r.xe()});return kc}function B(){var kc=yd.call(this)||this;kc.recommended=null;kc.automatic=null;kc.source=null;kc.H_=Object.assign(new Ae.a,{T_:B.getTypeName(),B_:B.xe()});return kc}function y(kc,$c,rd,me,te,ge,pd){pd=kc.Ma(1,void 0===pd?null:pd);pd.tenantId=$c;return Hf.i(kc,"GetPolicyApplicationMethod",pd,rd,me,te,ge,4)}function v(kc,$c,rd,
me,te,ge,pd){pd=kc.Ma(1,void 0===pd?null:pd);pd.tenantId=$c;return Hf.i(kc,"GetPolicyLabelId",pd,rd,me,te,ge,4)}function A(){this.B_a=this.annotationType=null;this.ZMa=this.XF=!1}function t(){this.hsc=this.Z0f=null;this.zQ=0}function E(){this.o2=this.bsa=this.tb=this.Zg=null}function C(kc,$c,rd,me,te){me=void 0===me?0:me;te=void 0===te?null:te;this.KJc=this.b9d=null;this.xsa=this.mkb=this.okb=0;this.h9="";this.RFa=this.BHc=this.rbe=this.uqa=this.oPc=null;this.Ube=!1;this.ADa=null;this.oMc=0;this.OWb=
this.TFa=this.BEa=this.NWb=null;this.$a=new Wc.a;this.WLb=this.Fxb=this.OFa=null;this.aNc=!1;this.RCb=null;this.vb=kc;this.Yg=$c;this.Ih=rd;this.QVb=me;this.Hn=new ia;this.she=this.vb.Wa("PolicyHandlerEndpointName")||"PolicyHandler.ashx";this.XP=te;this.dAb=kc.ra("WacApplyManualPolicyLabelIsEnabled");this.Rhc=kc.ra("CoAuthForProtectedFilesIsEnabled");this.supportsOfficeClientCoauthoring=kc.ra("SupportsOfficeClientCoauthoring");this.Pri=!1;this.rxj=3E4;this.re=va.a.instance;kc.ra("SupportsPolicies")&&
rb.a("MipSupportsPolicies");this.Rhc&&this.supportsOfficeClientCoauthoring&&rb.a("MipSupportsOfficeClientCoauthoring")}function H(){}function U(kc,$c,rd,me,te,ge,pd,jc,jf,dc,za,Mb,hc,cc,Ec,Lc,he,qe,Af,xf,fc){this.url=kc;this.i0j=$c;this.body=rd;this.headers=me;this.Ieb=te;this.priority=ge;this.state=pd;this.rkg=void 0===jc?null:jc;this.XL=void 0===jf?null:jf;this.HW=void 0===dc?!1:dc;this.B8i=void 0===za?null:za;this.etj=void 0===Mb?null:Mb;this.name=void 0===hc?null:hc;this.VGb=void 0===cc?null:
cc;this.Ped=void 0===Ec?!1:Ec;this.KJf=void 0===Lc?null:Lc;this.$$b=void 0===he?null:he;this.vhc=void 0===qe?null:qe;this.gdb=void 0===Af?null:Af;this.Abi=void 0===xf?null:xf;this.responseType=void 0===fc?null:fc}function Q(kc){var $c=Zc.call(this)||this;$c.ICj=kc;return $c}function O(kc){var $c=Uc.call(this)||this;$c.BOg=kc;return $c}function ea(kc,$c,rd,me,te,ge,pd){me=void 0===me?null:me;te=void 0===te?null:te;ge=void 0===ge?null:ge;pd=void 0===pd?null:pd;var jc=ac.call(this)||this;jc.errorType=
kc;jc.BOg=$c;jc.Z7f=rd;jc.title=me;jc.message=te;jc.buttonText=ge;jc.zZ=pd;return jc}function Z(kc,$c){var rd=mb.call(this)||this;rd.hsc=kc;rd.zQ=$c;return rd}function S(){return qb.call(this)||this}function I(kc,$c){var rd=Sb.call(this)||this;rd.Uqb=kc;rd.yBb=$c;return rd}function P(kc,$c,rd,me){var te=xb.call(this)||this;te.title=kc;te.isc=$c;te.buttonText=rd;te.Qyf=me;return te}function J(kc,$c){var rd=Xb.call(this)||this;rd.cza=kc;rd.$te=$c;return rd}function aa(kc){kc=void 0===kc?!1:kc;var $c=
hb.call(this)||this;$c.onSuccess=kc;return $c}function ia(){this.AreLabelsAvailable=!1;this.AppliedPolicyId=null;this.MandatoryLabelingEnforced=this.RequiredDowngradeJustification=!1;this.SensitivityLabels=this.PolicyLabelVersionToken=this.PolicyLabelAssignmentMethod=this.CustomUrl=this.DefaultLabelId=null;this.AreLabelsAvailable=!1;this.AppliedPolicyId="";this.RequiredDowngradeJustification=!1;this.PolicyLabelVersionToken=this.PolicyLabelAssignmentMethod=this.DefaultLabelId="";this.SensitivityLabels=
[];this.MandatoryLabelingEnforced=!1;this.CustomUrl=""}function ba(){return Sa.call(this)||this}function ra(kc){var $c=db.call(this)||this;$c.J4j=kc;return $c}function ka(kc,$c,rd){var me=Ca.call(this)||this;me.HDe=kc;me.GDe=$c;me.existingLabelPriority=rd;return me}function da(kc,$c,rd,me,te){var ge=ma.call(this)||this;ge.Uqb=kc;ge.title=$c;ge.message=rd;ge.buttonText=me;ge.zZ=te;return ge}function ha(kc,$c,rd,me,te,ge){var pd=ua.call(this)||this;pd.Uqb=kc;pd.title=$c;pd.message=rd;pd.buttonText=
me;pd.zZ=te;pd.yBb=ge;return pd}function qa(kc,$c,rd,me){this.BOc=this.COc=null;this.SNc=this.lOc=this.Wkb=this.vee=this.OJc=!1;this.LWa=this.$fa=this.Xga=this.xqa=this.tVb=this.dw=this.b$=this.Gh=null;this.IHc=0;this.R9d=this.iOc=this.THc=null;this.La=kc;this.jf=$c;this.vb=rd;this.Zg=me;this.Glb={};this.the={};this.wee={};this.dAb=rd.ra("WacApplyManualPolicyLabelIsEnabled");this.Zg.value.dse(Object(Ma.a)(this,this.GId,"processAutoSensitivityLabel"));this.Zg.value.fYc(Object(Ma.a)(this,this.GId,"processAutoSensitivityLabel"));
this.Zg.value.b0b(Object(Ma.a)(this,this.gZi,"onUpdateLabelInfo"));nb.AFrameworkApplication.sa&&nb.AFrameworkApplication.sa.NJg(Object(Ma.a)(this,this.Hbj,"refreshDocumentPolicyLabelsOnModeChange"));rd.ra("SupportsPolicies")&&rd.Wa("AppliedPolicyId")&&(this.COc=rd.Wa("IrmPolicyTitle"),this.BOc=rd.Wa("IrmPolicyDescription"));this.IRc=rd.ra("ProtectedFile");this.ppg=this.vb.Cd("SetPolicyLabelAwaitFileExistsOnHostMaxRetries",6);this.qpg=this.vb.Cd("SetPolicyLabelAwaitFileExistsOnHostRetryDelayMs",5E3)}
function Aa(){}function Fa(){this.Tkb=!!nb.AFrameworkApplication.sa&&nb.AFrameworkApplication.sa.Qa.Tw}function ab(kc,$c,rd){var me=wc.call(this,!1,!1,!0)||this;if(!kc||!rd)return oa.ULS.sendTraceTag(560547850,306,10,"MandatoryLabelingDialog was triggered with invalid inputs"),me;var te={};te=(te.id="MandatoryLabellingDialog",te);me.Drg=rd;me.bPc=$c;if(!nb.AFrameworkApplication.ha.ra("MandatoryLabelingDialogLearnMoreSwitchIsEnabled")||me.bPc&&""!==me.bPc)$c={},$c=($c.href=me.bPc,$c.target="_blank",
$c),rd={},te.learnMoreLink=(rd.type="AppLinkProps",rd.id="mandatoryLabellingLearnMoreLink",rd.text=CommonUIStrings.l_LearnMore,rd.handler=$c,rd.customTooltip=CommonUIStrings.L_LearnMoreTooltip,rd);$c={};kc=($c.id="mandatoryLabellingFlyoutMenuSection",$c.controls=kc,$c);$c={};$c=($c.sections=[],$c.shouldAutoOpen=!1,$c);Array.add($c.sections,kc);kc={};te.labelFlyout=(kc.type="AppFlyoutAnchorProps",kc.id="mandatoryLabellingFyout",kc.label="Pick a label",kc.hideLabel=!1,kc.hideChevron=!1,kc.hideIcon=
!0,kc.menuDefinition=$c,kc);kc={};kc=(kc.id="MandatoryLabellingDialog",kc.bodyControls=te,kc);te.initialLabelText=CommonUIStrings.l_MandatoryLabellingDialogInitialLabelText;te.descriptionText=CommonUIStrings.l_MandatoryLabellingDialogDescriptionText;me.initializeAndShow(CommonUIStrings.l_MandatoryLabellingDialogBusinessBarTitle,Object(Ma.a)(me,me.pDi,"mandatoryLabellingDialogHandler"),kc);return me}function Ua(kc,$c){var rd=Rb.call(this,!1,!1,Ua.Yy)||this;rd.vra=[CommonUIStrings.l_SensitivityJustificationNoLongerApplies,
CommonUIStrings.l_SensitivityJustificationIncorrect,CommonUIStrings.l_SensitivityJustificationOther];rd.ZWb=null;rd.YWb=!1;rd.Xje=kc;rd.AJ=$c;rd.ig=rd.yUg();rd.lc=1;rd.Ve=Ua.id;rd.Bc(1,CommonUIStrings.l_DialogChange);rd.gM(1,!1);rd.Boa(0);return rd}function bb(){}function xa(kc,$c){this.zQ=kc;this.displayName=$c}function Gb(kc,$c,rd){rd=void 0===rd?null:rd;this.id=kc.Id;rd||(rd="");this.Kaj=rd;this.sensitivityLabel=kc}b.r(F);var $b=b(0),oa=b(13),Ma=b(82),Za=b(1063),gb=b(199);Object($b.a)(Gb,"AutoPolicyLabelData",
null,[]);Object($b.a)(xa,"PolicyLabelRequestState",null,[]);var zb=b(149),nb=b(4),pa=b(156),Ja=b(12),Da=b(41),ib=b(28);uk.Object.defineProperties(bb,{ovd:{configurable:!0,enumerable:!0,get:function(){return bb.dvi}}});bb.dvi="<div class='WACDialogRow' id='JustificationMessageBlock'> <div class='WACDialogIcon' id='JustificationIconArea'> <div class='clip32x32' id='JustificationIconClip' unselectable='on' style='z-index: 0; display: inline-block;'> <img id='iconJustification' class='{1}' role='presentation' src={0} /> </div> </div> <div class='WACDialogTextPanel WACJustificationDialogMessage' id='JustificationMessageArea'> <label id='messageJustification' class='WACDialogLabel' >{2}</label> </div> </div> <br/> <div class='WACDialogTextPanel WACJustificationDialogRow' id='JustificationDlgBlock0'> <input type='radio' id='radiobox0' name='ListRadioBox' class='WACDialogRadio' alt='{3}' title='{3}'></input> <label id='JustificationDlgList0' class='WACDialogLabel' for='radiobox0' >{3}</label> </div> <div class='WACDialogTextPanel WACJustificationDialogRow' id='JustificationDlgBlock1'> <input type='radio' id='radiobox1' name='ListRadioBox' class='WACDialogRadio' alt='{4}' title='{4}'></input> <label id='JustificationDlgList1' class='WACDialogLabel' for='radiobox1' >{4}</label> </div> <div class='WACDialogTextPanel WACJustificationDialogRow' id='JustificationDlgBlock2'> <input type='radio' id='radiobox2' name='ListRadioBox' class='WACDialogRadio' alt='{5}' title='{5}'></input> <label id='JustificationDlgList2' class='WACDialogLabel' for='radiobox2' >{5}</label> </div> <div class='WACDialogTextPanel WACJustificationDialogRow WACJustificationDialogTextAreaRow' id='JustificationTextAreaBlock'> <textarea id='txtJustification' class='JustificationTextArea' placeholder='{6}' style='border:solid 1px grey;resize:none;' autocomplete=\"off\"></textarea> </div>";
Object($b.a)(bb,"JustificationDialogHtml",null,[]);var Rb=zb.a;Am(Ua,Rb);Ua.prototype.aVd=function(){if(Ua.Yy)this.initializeAndShow(CommonUIStrings.l_SensitivityJustificationTitle,Object(Ma.a)(this,this.aQf,"reactJustificationDialogHandler"),this.R5e(this.YWb));else{for(var kc={},$c=0;$c<this.vra.length;$c++)kc[Ua.nJd+$c]=!1;kc[Ua.tOb]="";this.initializeAndShow(CommonUIStrings.l_SensitivityJustificationTitle,Object(Ma.a)(this,this.cvi,"justificationDialogHandler"),kc);this.zcj();Da.a.addHandler($get(Ua.tOb),
Ja.a.input,Object(Ma.a)(this,this.fOj,"textAreaHandler"))}};Ua.prototype.validate=function(){if(Ua.Yy)return this.rjg(this.ZWb);var kc=$get(Ua.tOb);return kc.disabled?!0:this.rjg(kc.value)};Ua.prototype.rjg=function(kc){var $c=2>kc.length,rd=500<kc.length,me=RegExp("[{|}|;|\\\\]").test(kc);kc=""===ib.a.ouc(kc);return!$c&&!rd&&!me&&!kc};Ua.prototype.cvi=function(kc,$c){var rd="";if(1===kc)for(var me=0;me<this.vra.length;me++)if($c[Ua.nJd+me]){rd=me===this.vra.length-1?$c[Ua.tOb]:this.vra[me];break}this.AJ(kc,
this.Xje,rd)};Ua.prototype.aQf=function(kc){var $c="";1===kc&&this.ZWb&&($c=this.ZWb);this.AJ(kc,this.Xje,$c)};Ua.prototype.$Si=function(kc){this.ZWb=kc;kc=this.validate();this.YWb!==kc&&(this.YWb=kc,this.ODc(CommonUIStrings.l_SensitivityJustificationTitle,Object(Ma.a)(this,this.aQf,"reactJustificationDialogHandler"),this.R5e(this.YWb)))};Ua.prototype.R5e=function(kc){var $c={},rd={},me={},te={};return te.id=this.Ve,te.bodyControls=(rd.choiceGroupProps={},rd.textAreaProps=($c.placeholder=CommonUIStrings.l_SensitivityJustificationPlaceholder,
$c),rd),te.actionButtonProps=(me.label=CommonUIStrings.l_DialogChange,me.disabled=!kc,me),te.infoMessage=CommonUIStrings.l_SensitivityJustificationMessage,te.justificationIrrelevantLabel=CommonUIStrings.l_SensitivityJustificationNoLongerApplies,te.justificationIncorrectLabel=CommonUIStrings.l_SensitivityJustificationIncorrect,te.justificationOtherLabel=CommonUIStrings.l_SensitivityJustificationOther,te.onJustificationUpdated=Object(Ma.a)(this,this.$Si,"onJustificationUpdated"),te};Ua.prototype.fOj=
function(kc){kc.target&&this.gM(1,this.validate())};Ua.prototype.yUg=function(){return zb.a.Qn(Ua.ovd,nb.AFrameworkApplication.mD,pa.getImageClass(Ua.iconName),CommonUIStrings.l_SensitivityJustificationMessage,this.vra[0],this.vra[1],this.vra[2],CommonUIStrings.l_SensitivityJustificationPlaceholder)};Ua.prototype.zcj=function(){for(var kc=document.getElementsByName(Ua.uxi),$c=0;$c<kc.length;$c++)Da.a.addHandler(kc[$c],Ja.a.focus,Object(Ma.a)(this,this.JOf,"radioButtonFocusHandler")),Da.a.addHandler(kc[$c],
Ja.a.click,Object(Ma.a)(this,this.JOf,"radioButtonFocusHandler"))};Ua.prototype.JOf=function(kc){if(kc=kc.target){kc.checked=!0;var $c=$get(Ua.tOb);kc.id===Ua.nJd+(this.vra.length-1)?($c.disabled=!1,Sys.UI.DomElement.setVisible($c,!0),$c.focus()):($c.disabled=!0,kc.focus());this.gM(1,this.validate())}};uk.Object.defineProperties(Ua,{Yy:{configurable:!0,enumerable:!0,get:function(){return nb.AFrameworkApplication.sa.Qa.Tw&&nb.AFrameworkApplication.sa.Qa.jkf}}});Ua.ovd=bb.ovd;Ua.uxi="ListRadioBox";
Ua.nJd="radiobox";Ua.tOb="txtJustification";Ua.iconName="Info_32x32x32";Ua.id="JustificationDialog";Object($b.a)(Ua,"JustificationDialog",zb.a,[]);var wc=zb.a;Am(ab,wc);ab.prototype.pDi=function(kc,$c){1===kc&&$c.selectedLabel&&(kc=$c.selectedLabel,""!==kc&&this.Drg(kc))};Object($b.a)(ab,"MandatoryLabellingDialog",zb.a,[]);Fa.prototype.Pah=function(kc,$c,rd){this.Tkb&&new ab(kc,$c,rd)};uk.Object.defineProperties(Fa,{instance:{configurable:!0,enumerable:!0,get:function(){return Fa.Na||(Fa.Na=new Fa)}}});
Fa.Na=null;Object($b.a)(Fa,"MandatoryLabellingDialogFactory",null,[824]);Aa.eLj="sbProtectForm14";Aa.gLj="SBStatusBarMarkAsReadOnly14";Aa.Hwi="Info_16x16x32";Aa.Grb="QuickSearchCompletedToday_16x16x32";Aa.OJd="CommonControlCheckboxCheck_16";Aa.ddg="On";Aa.visible="Visible";Aa.MIh="ImageIsVisible";Aa.hJ="SourceControlId";Aa.menuItemId="MenuItemId";Aa.menu="Menu";Aa.YYc="AppLockId";Aa.value="Value";Aa.Ii="LabelText";Aa.alt="Alt";Aa.Tcf="Image16by16";Aa.S6a="Image16by16Class";Aa.dLj="SBProtectForm_16";
Aa.fLj="SBStatusBarMarkAsReadOnly_16";Aa.icon="Icon";Aa.iconColor="IconColor";Aa.customTooltip="CustomTooltip";Aa.X$i="MipTagDynamicFillWithOutline_20";Aa.Y$i="MipTagLockDynamicFillWithOutline_20";Aa.W$i="MipTagErrorOutline_20";Aa.Z$i="MipTagQuestionOutline_20";Aa.SZd="transparent";Object($b.a)(Aa,"PolicyConstants",null,[]);var Cb=b(650),lb=b(392),yb=b(321),pc=b(630),Ta=b(99),rb=b(185),ic=b(623),Va=b(620),jb=b(174),rc=b(460),Cc=b(133),Hc=b(90),Nb=b(202),nc=b(519),Ha=b(84),tb=b(105),Ub=b(26),gc=b(53);
qa.prototype.Sg=function(){this.La.ic(Ub.a.gJf,tb.a.frame,Object(Ma.a)(this,this.UMe,"documentLabelPaneHandler"));this.La.gf(Ub.a.Obb,tb.a.frame,Object(Ma.a)(this,this.Obb,"queryPolicyLabel"),96);this.La.ic(Ub.a.EUa,tb.a.frame,Object(Ma.a)(this,this.EUa,"toggleSensitivity"));this.La.ic(Ub.a.oAa,tb.a.frame,Object(Ma.a)(this,this.oAa,"populateSensitivityFlyout"));this.La.ic(Ub.a.setSensitivity,tb.a.frame,Object(Ma.a)(this,this.setSensitivity,"setSensitivity"));this.La.gf(Ub.a.Pbb,tb.a.frame,Object(Ma.a)(this,
this.Pbb,"querySensitivity"),96);this.La.ic(Ub.a.x7,tb.a.frame,Object(Ma.a)(this,this.x7,"querySensitivityToggleButton"));this.La.ic(Ub.a.w7,tb.a.frame,Object(Ma.a)(this,this.w7,"querySensitivitySubFlyout"));this.oob(Ub.a.EUa)||this.La.Qdb(Ub.a.EUa,4);this.oob(Ub.a.oAa)||this.La.Qdb(Ub.a.oAa,4);this.oob(Ub.a.setSensitivity)||this.La.Qdb(Ub.a.setSensitivity,4);this.oob(Ub.a.x7)||this.La.Qdb(Ub.a.x7,4);this.oob(Ub.a.w7)||this.La.Qdb(Ub.a.w7,4);this.jf.updateCommandUI();nb.AFrameworkApplication.ha&&
nb.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CacheSensitivityVisibility",!1)&&jb.a("isSharedUxGateEnabled")&&appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.DelayPolicyActionRegistration")&&this.Zg.value.bhj(Object(Ma.a)(this,this.ZRf,"registerActionsHandler"))};qa.prototype.ZRf=function(){this.Sg()};qa.prototype.qPb=function(){this.La.RD(Ub.a.gJf,tb.a.frame,Object(Ma.a)(this,this.UMe,"documentLabelPaneHandler"));this.La.RD(Ub.a.Obb,tb.a.frame,Object(Ma.a)(this,
this.Obb,"queryPolicyLabel"));this.La.RD(Ub.a.EUa,tb.a.frame,Object(Ma.a)(this,this.EUa,"toggleSensitivity"));this.La.RD(Ub.a.oAa,tb.a.frame,Object(Ma.a)(this,this.oAa,"populateSensitivityFlyout"));this.La.RD(Ub.a.setSensitivity,tb.a.frame,Object(Ma.a)(this,this.setSensitivity,"setSensitivity"));this.La.RD(Ub.a.Pbb,tb.a.frame,Object(Ma.a)(this,this.Pbb,"querySensitivity"));this.La.RD(Ub.a.x7,tb.a.frame,Object(Ma.a)(this,this.x7,"querySensitivityToggleButton"));this.La.RD(Ub.a.w7,tb.a.frame,Object(Ma.a)(this,
this.w7,"querySensitivitySubFlyout"))};qa.prototype.EUa=function(){return 32};qa.prototype.Z_e=function(kc){var $c="mandatoryLabelling_"+kc.Id;this.wee[$c]=kc.Id;var rd={};return rd.type="AppToggleButtonProps",rd.id=$c,rd.label=kc.DisplayName,rd.hideLabel=!1,rd.customTooltip=kc.Tooltip,rd};qa.prototype.ZXh=function(){var kc=[],$c=this.b$,rd;for(rd in $c){var me=$c[rd],te=this.dw[rd];if(this.vb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.HideUDPFromMandatoryDialogEnabled",!1)){if(!te||!te.Enabled||
te.HasUserDefinedPermissions)continue}else if(!te||!te.Enabled)continue;if(me.count){var ge={};ge=(ge.sections=[],ge.shouldAutoOpen=!1,ge);var pd={};pd=(pd.id="mandatoryLabelling_flyoutMenuSection_"+te.Id,pd.controls=[],pd);me=Cl(me);for(var jc=me.next();!jc.done;jc=me.next()){jc=this.dw[jc.value];if(this.vb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.HideUDPFromMandatoryDialogEnabled",!1)){if(!jc||!jc.Enabled||jc.HasUserDefinedPermissions)continue}else if(!jc||!jc.Enabled)continue;Array.add(pd.controls,
this.Z_e(jc))}Array.add(ge.sections,pd);pd={};te=(pd.type="AppFlyoutAnchorProps",pd.id="mandatoryLabelling_"+te.Id,pd.label=te.DisplayName,pd.hideLabel=!1,pd.hideChevron=!1,pd.hideIcon=!1,pd.menuDefinition=ge,pd);Array.add(kc,te)}else Array.add(kc,this.Z_e(te))}return kc};qa.prototype.oAa=function(kc,$c,rd,me,te){if(1===rd||!this.Zg.value.Zha(!0))return 32;te.MenuItems=Object.assign(new ic.a,{Id:"SensitivityList",MenuSectionList:[],UpdateDynamically:!0});Array.add(te.MenuItems.MenuSectionList,this.Oc(!this.isReactRibbonEnabled()));
this.Gh.CustomUrl&&Array.add(te.MenuItems.MenuSectionList,this.Fah(this.isReactRibbonEnabled()?this.Gh.CustomUrl:ib.a.sf(this.Gh.CustomUrl)));this.isReactRibbonEnabled()||(te.PopulationXML=yb.s(te.MenuItems));return 32};qa.prototype.Pbb=function(kc,$c,rd,me,te){if(1===rd||!te||!this.dAb)return 32;this.Gh=this.Zg.value.Hn;if(this.Zg.value.Zha(!0)&&(te[Aa.visible]=!0,rb.a("MipLabelsAvailable"),this.vb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpLouderLabelTUIEnabled",!1)&&this.Gh&&this.Gh.AreLabelsAvailable&&
(kc=Ha.a.instance.qc("Common.ISystemInitiatedFeedback")))){var ge=qa.Qh(this.Gh.AppliedPolicyId)?"LouderLabel_NoLabelAppliedOnLoadActivity":"LouderLabel_LabelExistsOnLoadActivity";kc.execute(function(pd){pd.logActivity(ge,null)})}return 32};qa.prototype.x7=function(kc,$c,rd,me,te){if(1===rd||!te)return 32;var ge,pd;te[Aa.ddg]=!!(ge=te[Aa.menuItemId])&&!!(pd=this.Glb[ge])&&pd===this.Gh.AppliedPolicyId;return 32};qa.prototype.w7=function(kc,$c,rd,me,te){if(1===rd||!te)return 32;var ge,pd,jc;kc=!!(ge=
te[Aa.hJ])&&!!(pd=this.Glb[ge])&&!!(jc=this.b$[pd])&&jc.contains(this.Gh.AppliedPolicyId);te[Aa.MIh]=kc;te[Aa.ddg]=kc;return 32};qa.prototype.setSensitivity=function(kc,$c,rd,me,te){return 1!==rd&&te?this.ieb(this.Glb[te[Aa.hJ]],te,2):32};qa.prototype.jic=function(){return!!nb.AFrameworkApplication.sa&&1===nb.AFrameworkApplication.sa.mode};qa.prototype.Hbj=function(){this.SNc&&!this.jic()&&(this.SNc=!1,this.Zg.value.Gbj())};qa.prototype.Tdg=function(){this.Gh.DefaultLabelId&&this.Gh.MandatoryLabelingEnforced?
this.OJc||this.jic()?this.Gh.AppliedPolicyId?this.Jad(""):(this.Zg.value.$qi(this.Zg.value.RCb)||this.jic())&&this.jPe():this.g2f():this.Gh.DefaultLabelId?this.g2f():this.Gh.MandatoryLabelingEnforced&&(this.Gh.AppliedPolicyId?this.Jad(""):this.jPe())};qa.prototype.Vif=function(){return this.Gh.MandatoryLabelingEnforced?this.Gh&&this.Gh.AreLabelsAvailable?this.vb.ra("TestOverrideIsReactDialogEnabled")||this.jf&&this.jf.Qa&&this.jf.Qa.Tw?!0:(oa.ULS.sendTraceTag(539109065,306,50,"Mandatory labelling not invoked b/c react dialogs disabled!"),
!1):(oa.ULS.sendTraceTag(539109064,306,50,"Mandatory labelling not invoked b/c there are no sensitivity labels!"),!1):(oa.ULS.sendTraceTag(539109063,306,50,"Mandatory labelling not invoked b/c user did not have policy!"),!1)};qa.prototype.jPe=function(){var kc=this;!this.Vif()||nb.AFrameworkApplication.c6||this.vee||(this.vee=nb.AFrameworkApplication.c6=!0,oa.ULS.sendTraceTag(562837517,306,50,"Mandatory labelling is invoked successfully."),this.Zg.value.bPf("",1),this.Zg.value.aXc(37,CommonUIStrings.l_MandatoryLabellingDialogBusinessBarTitle,
CommonUIStrings.l_MandatoryLabellingDialogDescriptionText,CommonUIStrings.l_MandatoryLabellingDialogBusinessBarButton,function(){kc.nDi()}))};qa.prototype.Jad=function(kc){this.Vif()&&nb.AFrameworkApplication.c6&&(nb.AFrameworkApplication.c6=!1,oa.ULS.sendTraceTag(562837518,306,50,"Mandatory labelling is escaped successfully."),this.Zg.value.TLd(),this.Zg.value.bPf(kc,2))};qa.prototype.nDi=function(){Fa.instance.Pah(this.ZXh(),this.Gh.CustomUrl,Object(Ma.a)(this,this.oDi,"mandatoryLabellingDialogCallback"))};
qa.prototype.oDi=function(kc){this.Jad(this.wee[kc])};qa.prototype.Zwe=function(){return this.vb.ra("CoAuthForProtectedFilesEnabled")&&this.vb.ra("SupportsOfficeClientCoauthoring")&&this.vb.ra("SetPolicyLabelAwaitFileExistsOnHostIsEnabled")&&!!this.R9d&&this.jBb};qa.prototype.ieb=function(kc,$c,rd){var me=this;this.Zg.value.E9i(rd);var te=32,ge=!1,pd=!0,jc=2===rd||8===rd||16===rd,jf=kc===this.Gh.AppliedPolicyId;if(this.THc&&this.THc(kc,jc))oa.ULS.sendTraceTag(42860829,306,15,"SetSensitivity : As app doesn't support changing the label, skipping SetSensitivity call. ApplyLabelFlag : {0}",
rd),this.jf.updateCommandUI();else if($c&&Aa.YYc in $c&&this.Zg.value.Fwj($c[Aa.YYc]),kc)if(this.Zg.value.alf()||this.Zwe()&&this.lOc)oa.ULS.sendTraceTag(42796168,306,50,"Policy label cannot be set because a set policy label request is already in progress. ApplyLabelFlag: {0}",rd),this.jf.updateCommandUI(),jc&&this.U0b(CommonUIStrings.l_SensitivityApplicationDialogErrorTitle,CommonUIStrings.l_SensitivityQuickApplicationErrorMessage);else if(this.vb.ra("HasDocumentEditRights"))if(this.Zg.value.NYg(kc))if(this.vb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.LabelHasUDPEnabled",
!1)&&this.dw[kc]&&this.dw[kc].HasUserDefinedPermissions&&!jf)oa.ULS.sendTraceTag(540608323,306,50,"UDP label cannot be applied during UDP in WAC Phase 1. ApplyLabelFlag: {0}",rd),1!==rd&&4!==rd&&this.MMg();else if(jc&&this.Gh.MandatoryLabelingEnforced&&jf)oa.ULS.sendTraceTag(570972054,306,50,"Policy label cannot be removed due to mandatory labeling. ApplyLabelFlag: {0}",rd),this.U0b(CommonUIStrings.l_MandatoryLabellingBlockLabelRemovalDialogTitle,CommonUIStrings.l_MandatoryLabellingBlockLabelRemovalDialogDescriptionText);
else{if(jc&&this.vb.ra("WacLabelingJustificationDialogIsEnabled")&&this.Gh.RequiredDowngradeJustification&&(jf||this.dw[kc].RequiredDowngradeJustification)&&!this.tVb)return oa.ULS.sendTraceTag(570972055,306,50,"Downgrade justification is required. ApplyLabelFlag: {0}",rd),this.aVd(kc),te;if(this.Zwe()&&!this.R9d())this.IHc<this.ppg?(oa.ULS.sendTraceTag(577356770,306,50,"File does not exist on host, retrying after delay. RetryCount: {0} ApplyLabelFlag: {1}",this.IHc,rd),this.lOc=!0,this.IHc++,gc.Task.delay(this.qpg).continueWith(function(){me.lOc=
!1;me.ieb(kc,$c,rd)})):(oa.ULS.sendTraceTag(577356771,306,15,"Policy label cannot be set because maximum retries were reached checking for file existence. ApplyLabelFlag: {0}",rd),ge=1!==rd,pd=!1,te=8);else{if(this.vb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.WacBlockParentLabelSetLabel",!1)&&this.Lpi(kc)&&(oa.ULS.sendTraceTag(553911752,306,15,"Policy label cannot be set because the selected label is a parent label. ApplyLabelFlag: {0}",rd),1===rd||8===rd||4===rd))return te;oa.ULS.sendTraceTag(570972056,
306,50,"SetSensitivityByPolicyId is succeeded. ApplyLabelFlag: {0}",rd);this.setPolicyLabel(jf?"":kc,this.tVb,rd);return te}}else oa.ULS.sendTraceTag(42796169,306,50,"Policy label cannot be set because the user is in a coauth session. ApplyLabelFlag: {0}",rd),this.jf.updateCommandUI(),jc&&this.U0b(CommonUIStrings.l_SensitivityApplicationDialogErrorTitle,CommonUIStrings.l_SensitivityCoauthApplicationErrorMessage);else oa.ULS.sendTraceTag(558892739,306,50,"Policy label cannot be set because the user doesn't have edit rights. ApplyLabelFlag: {0}",
rd),this.jf.updateCommandUI(),jc&&this.U0b(CommonUIStrings.l_SensitivityApplicationDialogErrorTitle,CommonUIStrings.l_SensitivityNoEditRightsErrorMessage);else oa.ULS.sendTraceTag(42796167,306,15,"Policy label cannot be set because the selected policy ID is null. ApplyLabelFlag: {0}",rd),this.jf.updateCommandUI(),ge=jc,pd=!1,te=8;this.Zg.value.BJd(0,rd,ge,pd);return te};qa.prototype.G_a=function(kc,$c,rd,me){rd=void 0===rd?null:rd;me=void 0===me?!1:me;Ta.Health.instance.recordKpiUsage("MipAutoClassificationSetLabel",
0,"wordclpfc",null);this.vb.ra("SupportsOfficeClientCoauthoring")&&this.vb.ra("CoAuthForProtectedFilesIsEnabled")?(this.Wkb=!1,(this.Gh=this.Zg.value.Hn)&&!this.Gh.AppliedPolicyId?this.Wkb=!0:this.Gh&&this.Gh.PolicyLabelAssignmentMethod&&(this.Wkb=Nb.c(this.Gh.PolicyLabelAssignmentMethod)===Nb.c("standard"))):this.Wkb=me;kc=qa.Qh(kc)?null:this.dw[kc];($c=qa.Qh($c)?null:this.dw[$c])?this.Xga=new Gb($c,!0,rd):(this.Zg.value.Zda(29),this.$fa=null);kc?this.xqa=new Gb(kc,!1):this.LWa=null;this.GId(null,
null);return 32};qa.prototype.DOg=function(kc){""!==this.Gh.AppliedPolicyId?this.Zg.value.BJd(4,16,!0):this.ieb(kc,null,16)};qa.prototype.a3f=function(){this.dw={};if(this.Gh=this.Zg.value.Hn)for(var kc=Cl(this.Gh.SensitivityLabels),$c=kc.next();!$c.done;$c=kc.next())$c=$c.value,this.dw[$c.Id]=$c};qa.prototype.Lpi=function(kc){if(this.b$&&kc in this.b$){kc=Cl(this.b$[kc]);for(var $c=kc.next();!$c.done;$c=kc.next())if(($c=this.dw[$c.value])&&$c.Enabled)return!0}return!1};qa.prototype.L3f=function(){this.b$=
{};if(this.Gh=this.Zg.value.Hn){for(var kc=Cl(this.Gh.SensitivityLabels),$c=kc.next();!$c.done;$c=kc.next())$c=$c.value,$c.ParentId||(this.b$[$c.Id]=new gb.a);kc=Cl(this.Gh.SensitivityLabels);for($c=kc.next();!$c.done;$c=kc.next())$c=$c.value,$c.ParentId&&$c.ParentId in this.b$&&this.b$[$c.ParentId].add($c.Id)}};qa.prototype.oOf=function(){if(this.vb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CacheSensitivityVisibility",!1)){this.Gh=this.Zg.value.Hn;var kc=this.dAb&&this.isReactRibbonEnabled()&&
this.Zg.value.Zha();qa.SRa(kc)}else this.dAb&&this.isReactRibbonEnabled()?(this.Gh=this.Zg.value.Hn,this.Zg.value.Zha()?(qa.SRa(!0),appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("Sensitivity",!1))):qa.SRa(!1)):qa.SRa(!1)};qa.prototype.ccj=function(kc){this.THc=kc};qa.prototype.Vcj=function(kc){this.iOc=kc};qa.prototype.g2f=function(){this.vb.ra("WacApplyDefaultPolicyLabelIsEnabled")&&(this.jic()?this.SNc=!0:this.OJc||(this.OJc=!0,(this.Gh=this.Zg.value.Hn)&&this.Gh.DefaultLabelId&&
!this.Gh.AppliedPolicyId&&(oa.ULS.sendTraceTag(593774210,306,50,"Default labeling triggered. DefaultLabel: {0}",this.Gh.DefaultLabelId),this.ieb(this.Gh.DefaultLabelId,null,1))))};qa.prototype.GId=function(){var kc=this;if(!this.Zg.value.alf()){var $c=this.dw[this.Zg.value.Hn.AppliedPolicyId];this.Wkb&&this.xqa&&this.LWa!==this.xqa.id&&(!$c||$c.Order<this.xqa.sensitivityLabel.Order)&&($c=this.ieb(this.xqa.id,{},4),32!==$c?oa.ULS.sendTraceTag(50868813,306,10,"ProcessAutoSensitivityLabel: SetSensitivityByPolicyId failed with response: "+
$c):(this.LWa=this.xqa.id,this.$fa&&($c=this.dw[this.$fa])&&$c.Order<=this.xqa.sensitivityLabel.Order&&(this.Zg.value.Zda(29),this.$fa=null)));$c=this.dw[this.Zg.value.Hn.AppliedPolicyId];if(this.Xga&&this.$fa!==this.Xga.id&&(!$c||$c.Order<this.Xga.sensitivityLabel.Order)){var rd=this.Xga.id;this.Zg.value.Zda(29);this.Zg.value.n_b(29,CommonUIStrings.l_PolicyBusinessBarTitle,String.format(CommonUIStrings.l_PolicyLabelRecommendationMessage,this.kjd(this.Xga.sensitivityLabel))+" "+this.Xga.Kaj,CommonUIStrings.l_PolicyLabelRecommendationButton,
function(){kc.ieb(rd,{},8)});this.$fa=this.Xga.id}this.Xga=this.xqa=null}};qa.prototype.setPolicyLabel=function(kc,$c,rd){rd=void 0===rd?2:rd;this.tVb=$c;this.Zg.value.setPolicyLabel(kc);this.jf.updateCommandUI();$c=new xa(rd,this.kjd(this.dw[kc]));this.Zg.value.nSd(kc,this.tVb,$c)};qa.prototype.M6g=function(kc,$c,rd){1===kc?this.setPolicyLabel($c===this.Gh.AppliedPolicyId?"":$c,rd):this.jf.updateCommandUI()};qa.prototype.aVd=function(kc){(new Ua(kc,Object(Ma.a)(this,this.M6g,"continueToSetPolicyLabel"))).aVd()};
qa.prototype.U0b=function(kc,$c){kc=void 0===kc?"":kc;$c=void 0===$c?"":$c;var rd=new Cc.StandardDialog;rd.rv=nb.AFrameworkApplication.kAb;rd.lc=0;rd.Bc(1,CommonUIStrings.l_DialogClose);rd.$X(kc,$c,null)};qa.prototype.LSg=function(kc){1===kc&&this.Zg.value.I9i()};qa.prototype.MMg=function(){var kc=new Cc.StandardDialog;kc.rv=nb.AFrameworkApplication.kAb;kc.lc=1;kc.Bc(1,CommonUIStrings.l_OICDownLoadACopyDialogOpenButton);kc.Bc(0,CommonUIStrings.l_DialogClose);kc.$X(CommonUIStrings.l_SensitivityApplicationDialogErrorTitle,
CommonUIStrings.l_SensitivityBlockUDPSetLabelMessage,Object(Ma.a)(this,this.LSg,"blockUDPSetLabelHandler"))};qa.prototype.isReactRibbonEnabled=function(){return!!this.jf&&!!this.jf.Qa&&this.jf.Qa.Wi};qa.prototype.Jjc=function(){return this.jf&&this.jf.Qa?this.jf.Qa.Jjc:!1};qa.prototype.UMe=function(){return 32};qa.prototype.Obb=function(kc,$c,rd,me,te){if(1===rd)return 32;this.Gh=this.Zg.value.Hn;if(!this.Gh||!te)return 32;te[Aa.value]="";te[Aa.Ii]="";te[Aa.alt]=null;te[Aa.Tcf]=null;te[Aa.S6a]=null;
te[Aa.customTooltip]="";te[Aa.visible]=!1;te[Aa.iconColor]="";rd=$c=kc=te[Aa.icon]="";if(!this.Gh.AreLabelsAvailable){if(!this.COc)return 32;kc=this.COc;rd=Aa.SZd;this.BOc&&($c=this.BOc)}else if(this.Gh.AppliedPolicyId){me=null;for(var ge=Cl(this.Gh.SensitivityLabels),pd=ge.next();!pd.done;pd=ge.next())if(pd=pd.value,pd.Id.toLowerCase()===this.Gh.AppliedPolicyId.toLowerCase()){me=pd;break}me&&(kc=this.kjd(me),$c=me.Tooltip,this.IRc=nb.AFrameworkApplication.protectedFile=me.IsEndpointProtectionEnabled,
rd=this.X0e(me))}this.vb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpLouderLabelEnabled",!1)?(kc?(te[Aa.value]=kc,te[Aa.Ii]=kc,te[Aa.customTooltip]=$c,this.l3f(rd,this.IRc,te)):this.vb.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ClpUseOutlineImageForNoLabel")?(te[Aa.iconColor]=Aa.SZd,this.Gh.MandatoryLabelingEnforced?(te[Aa.value]=te[Aa.Ii]=HeaderStrings.SelectASensitivityLabel,te[Aa.icon]=Aa.W$i):(te[Aa.value]=te[Aa.Ii]=HeaderStrings.NoSensitivityLabel,te[Aa.icon]=Aa.Z$i)):
(te[Aa.iconColor]="#000000",this.Gh.MandatoryLabelingEnforced?(te[Aa.value]=te[Aa.Ii]=HeaderStrings.SelectASensitivityLabel,te[Aa.icon]="MipTagErrorDynamicColor_20"):(te[Aa.value]=te[Aa.Ii]=HeaderStrings.NoSensitivityLabel,te[Aa.icon]="MipTagQuestionDynamicColor_20")),te[Aa.visible]=!0):kc&&(te[Aa.value]=kc,te[Aa.Ii]=kc,this.Jjc()?te[Aa.customTooltip]=$c:te[Aa.alt]=$c,this.l3f(rd,this.IRc,te),te[Aa.visible]=!0);return 32};qa.prototype.kjd=function(kc){return kc?this.dw?kc.ParentId&&this.dw[kc.ParentId]?
this.dw[kc.ParentId].DisplayName+"\\"+kc.DisplayName:kc.DisplayName:(oa.ULS.sendTraceTag(4282E4,306,15,"Policy ID to Sensitivity label dictionary has not been initialized."),kc.DisplayName):""};qa.prototype.l3f=function(kc,$c,rd){this.vb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpLouderLabelEnabled",!1)?(rd[Aa.icon]=this.w7e($c),rd[Aa.iconColor]=this.x7e(kc)):this.Jjc()?rd[Aa.icon]=$c?Aa.dLj:Aa.fLj:(rd[Aa.Tcf]=nb.AFrameworkApplication.mD,rd[Aa.S6a]=$c?pa.getImageClass(Aa.eLj):pa.getImageClass(Aa.gLj))};
qa.prototype.Fah=function(kc){var $c=this.nV("LearnMoreSection",!0);kc=Object.assign(new lb.a,{Id:"SensitivityLearnMore",ExternalId:"SensitivityLearnMore",MenuItemId:kc,LabelText:CommonUIStrings.l_LearnMore,Command:"1959943459",Image16by16:nb.AFrameworkApplication.mD,Image16by16Class:pa.getImageClass(Aa.Hwi),Visible:!0,Alt:CommonUIStrings.L_LearnMoreTooltip,KeyTip:"L"});Array.add($c.ControlList,kc);return $c};qa.prototype.XIe=function(kc,$c,rd){rd=void 0===rd?!1:rd;var me="Toggle_"+kc.Id;me="Sensitivity_"+
me;var te=kc.DisplayName,ge=kc.Tooltip,pd=kc.Id===this.Gh.AppliedPolicyId,jc=rd?ib.a.sf(me):me;this.vb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpLouderLabelEnabled",!1)?(pd=this.X0e(kc),$c=Object.assign(new rc.a,{Id:jc,ExternalId:jc,LabelText:rd?ib.a.sf(te):te,Command:"2935633379",MenuItemId:jc,QueryCommand:"991261903",Visible:!0,Alt:rd?ib.a.sf(ge):ge,AriaLabel:Hc.a.D1b,IconColor:this.x7e(pd),KeyTip:$c}),$c.ExternalImageId=this.w7e(kc.IsEndpointProtectionEnabled)):(jc=Object.assign(new Cb.a,
{Id:jc,ExternalId:jc,LabelText:rd?ib.a.sf(te):te,Command:"2935633379",MenuItemId:jc,QueryCommand:"991261903",CheckedImage:nb.AFrameworkApplication.mD,Visible:!0,Alt:rd?ib.a.sf(ge):ge,IsChecked:pd,AriaLabel:Hc.a.D1b,KeyTip:$c}),this.isReactRibbonEnabled()?(jc.CheckedImageClass=pa.getImageClass(Aa.OJd),jc.ExternalImageId=Aa.OJd):jc.CheckedImageClass=pa.getImageClass(Aa.Grb),$c=jc);jc=me;this.Glb[jc]=kc.Id;this.the[kc.Id]=jc;return $c};qa.prototype.nV=function(kc,$c){$c=void 0===$c?!1:$c;return Object.assign(new Va.a,
{Title:"",Id:kc,DisplayMode:Aa.menu,ShowMenuSectionSeparator:$c,ControlsId:"Ctrl_"+kc,ControlList:[]})};qa.prototype.Ddh=function(kc,$c,rd){kc=this.nV(kc+"Sub");var me=1;$c=Cl($c);for(var te=$c.next();!te.done;te=$c.next())(te=this.dw[te.value])&&te.Enabled&&(Array.add(kc.ControlList,this.XIe(te,me.toString(),rd)),me++);return kc};qa.prototype.Oc=function(kc){kc=void 0===kc?!1:kc;var $c=this.nV("SensitivitySection"),rd=1,me=this.b$,te;for(te in me){var ge=me[te],pd=this.dw[te];if(pd&&pd.Enabled){if(ge.count){var jc=
"Sensitivity_"+pd.Name,jf=kc?ib.a.sf(jc):jc;jf=Object.assign(new pc.a,{Id:jf,ExternalId:jf,LabelText:kc?ib.a.sf(pd.DisplayName):pd.DisplayName,Command:"798637440",QueryCommand:"2875864574",Menu:Object.assign(new ic.a,{Title:"",MenuSectionList:[],UpdateDynamically:!0}),ImageIsVisible:!1,Toggled:!1,ImageUsesSpaceWhileInvisible:!0,AriaLabel:Hc.a.D1b,KeyTip:rd.toString()});this.isReactRibbonEnabled()?jf.ExternalImageId=Aa.OJd:(jf.Image16by16=nb.AFrameworkApplication.mD,jf.Image16by16Class=pa.getImageClass(Aa.Grb));
Array.add(jf.Menu.MenuSectionList,this.Ddh(jc,ge,kc));Array.add($c.ControlList,jf);this.Glb[jf.Id]=pd.Id;this.the[pd.Id]=jf.Id}else Array.add($c.ControlList,this.XIe(pd,rd.toString(),kc));rd++}}return $c};qa.prototype.oob=function(kc){return!!this.La.i5(kc)&&!!this.La.i5(kc).flags&&!!this.La.i5(kc).flags.length};qa.prototype.gZi=function(kc,$c){$c.onSuccess&&this.dw&&(kc=this.dw[this.Zg.value.Hn.AppliedPolicyId])&&(this.$fa&&($c=this.dw[this.$fa])&&$c.Order<=kc.Order&&(this.Zg.value.Zda(29),this.$fa=
null),this.LWa&&this.LWa!==kc.Id&&(this.Zg.value.Zda(28),this.LWa=null))};qa.prototype.w7e=function(kc){return kc?Aa.Y$i:Aa.X$i};qa.prototype.x7e=function(kc){return kc?kc:Aa.SZd};qa.prototype.X0e=function(kc){if(kc.Color||!kc.ParentId)return kc.Color;var $c=this.dw[kc.ParentId];return $c?$c.Color:kc.Color};qa.SRa=function(kc){nb.AFrameworkApplication.ha&&nb.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)||(kc?(nc.a.EBd("ribbon","sensitivity"),
nc.a.ABd("ribbon","sensitivity")):nc.a.DBd("ribbon","sensitivity"));nb.AFrameworkApplication.ha&&nb.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CacheSensitivityVisibility",!1)&&jb.c()&&appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("Sensitivity",!kc))};qa.Qh=function(kc){return kc&&kc.length?!1:!0};uk.Object.defineProperties(qa.prototype,{jBb:{configurable:!0,enumerable:!0,get:function(){return nb.AFrameworkApplication.jBb||!!this.iOc&&this.iOc()}}});
Object($b.a)(qa,"PolicyActor",null,[779]);var Eb=b(736),Tb=b(614),Wc=b(96),T;(function(kc){kc[kc.unknown=0]="unknown";kc[kc.boot=1]="boot";kc[kc.refresh=2]="refresh";kc[kc.selfSetPolicyLabel=3]="selfSetPolicyLabel"})(T||(T={}));Object($b.b)("GetPolicyLabelsReason",T);var ua=Sys.EventArgs;Am(ha,ua);Object($b.a)(ha,"AddAutoPolicyBusinessBarEntryEventArgs",Sys.EventArgs,[]);var ma=Sys.EventArgs;Am(da,ma);Object($b.a)(da,"AddMandatoryLabellingBusinessBarEntryEventArgs",Sys.EventArgs,[]);var wa;(function(kc){kc[kc.none=
0]="none";kc[kc.reasonDefaultLabel=1]="reasonDefaultLabel";kc[kc.reasonManual=2]="reasonManual";kc[kc.reasonAutomatic=4]="reasonAutomatic";kc[kc.reasonRecommended=8]="reasonRecommended";kc[kc.reasonMandatory=16]="reasonMandatory"})(wa||(wa={}));Object($b.b)("ApplyLabelFlags",wa);var Ca=Sys.EventArgs;Am(ka,Ca);Object($b.a)(ka,"AutoCLPSecurityNodesEventArgs",Sys.EventArgs,[]);var db=Sys.EventArgs;Am(ra,db);Object($b.a)(ra,"GetPolicyLabelEventArgs",Sys.EventArgs,[]);var Sa=Sys.EventArgs;Am(ba,Sa);Object($b.a)(ba,
"GetPolicyLabelFailureEventArgs",Sys.EventArgs,[]);Object($b.a)(ia,"GetPolicyLabelsData",null,[]);var hb=Sys.EventArgs;Am(aa,hb);Object($b.a)(aa,"LabelInfoUpdateEventArgs",Sys.EventArgs,[]);var Xb=Sys.EventArgs;Am(J,Xb);Object($b.a)(J,"MandatoryLabellingAppHandlerEventArgs",Sys.EventArgs,[]);var xb=Sys.EventArgs;Am(P,xb);Object($b.a)(P,"PolicyTipEventArgs",Sys.EventArgs,[]);var Sb=Sys.EventArgs;Am(I,Sb);Object($b.a)(I,"RemoveAutoPolicyBusinessBarEntryEventArgs",Sys.EventArgs,[]);var qb=Sys.EventArgs;
Am(S,qb);Object($b.a)(S,"RemoveMandatoryLabellingBusinessBarEntryEventArgs",Sys.EventArgs,[]);var mb=Sys.EventArgs;Am(Z,mb);Object($b.a)(Z,"SetPolicyLabelEventArgs",Sys.EventArgs,[]);var ac=Sys.EventArgs;Am(ea,ac);Object($b.a)(ea,"SetPolicyLabelFailureEventArgs",Sys.EventArgs,[]);var Uc=Sys.EventArgs;Am(O,Uc);Object($b.a)(O,"SetPolicyLabelTriggeredEventArgs",Sys.EventArgs,[]);var Zc=Sys.EventArgs;Am(Q,Zc);Object($b.a)(Q,"UDPLabelingAppHandlerEventArgs",Sys.EventArgs,[]);var Kc=b(107),va=b(102),fb=
b(40),Pb=b(79),sc=b(37);Object($b.a)(U,"ClientRequest",null,[]);var hd=b(495),Ob=b(273);H.qvj=function(kc,$c){if(!kc||!$c||kc.count!==$c.count)return!1;kc=Cl(kc);for(var rd=kc.next();!rd.done;rd=kc.next())if(!$c.contains(rd.value))return!1;return!0};H.toArray=function(kc){if(!kc)return null;var $c=Array(kc.count),rd=0;kc=Cl(kc);for(var me=kc.next();!me.done;me=kc.next())$c[rd]=me.value,rd++;return $c};Object($b.a)(H,"HashSetUtils",null,[]);var Ac=b(287),sb=b(76),ad=b(355);C.prototype.Pre=function(kc){this.$a.addHandler("PolicyTipEvent",
kc)};C.prototype.b0b=function(kc){this.$a.addHandler("LabelInfoUpdateEvent",kc)};C.prototype.bhj=function(kc){this.$a.removeHandler("LabelInfoUpdateEvent",kc)};C.prototype.dse=function(kc){this.$a.addHandler("SetPolicyLabelEventKey",kc)};C.prototype.rij=function(kc){this.$a.removeHandler("SetPolicyLabelEventKey",kc)};C.prototype.fYc=function(kc){this.$a.addHandler("SetPolicyLabelFailureEventKey",kc)};C.prototype.qij=function(kc){this.$a.removeHandler("SetPolicyLabelFailureEventKey",kc)};C.prototype.aJg=
function(kc){this.$a.addHandler("GetPolicyLabelEventKey",kc)};C.prototype.$Ig=function(kc){this.$a.addHandler("GetPolicyLabelFailureEventKey",kc)};C.prototype.YIg=function(kc){this.$a.addHandler("GetAutoPolicyLabelEventKey",kc);this.iqd&&(oa.ULS.sendTraceTag(51668058,306,15,"GetAutoPolicyLabelHandler was registered after the AutoPolicyLabelHandlerEvent was raised"),this.rJd(new ra(0)))};C.prototype.Igj=function(kc){this.$a.removeHandler("GetAutoPolicyLabelEventKey",kc)};C.prototype.uIg=function(kc){this.$a.addHandler("CreateAutoCLPSecurityNodesEventKey",
kc)};C.prototype.jgj=function(kc){this.$a.removeHandler("CreateAutoCLPSecurityNodesEventKey",kc)};C.prototype.uLg=function(kc){this.$a.addHandler("UpdateAutoCLPLabelPriorityNodeEventKey",kc)};C.prototype.Iij=function(kc){this.$a.removeHandler("UpdateAutoCLPLabelPriorityNodeEventKey",kc)};C.prototype.vLg=function(kc){this.$a.addHandler("UpdateAutoCLPSITNodesEventKey",kc)};C.prototype.Jij=function(kc){this.$a.removeHandler("UpdateAutoCLPSITNodesEventKey",kc)};C.prototype.Fqe=function(kc){this.$a.addHandler("AddAutoPolicyBusinessBarEntryEventKey",
kc)};C.prototype.Cfj=function(kc){this.$a.removeHandler("AddAutoPolicyBusinessBarEntryEventKey",kc)};C.prototype.Sre=function(kc){this.$a.addHandler("RemoveAutoPolicyBusinessBarEntryEventKey",kc)};C.prototype.$hj=function(kc){this.$a.removeHandler("RemoveAutoPolicyBusinessBarEntryEventKey",kc)};C.prototype.Gqe=function(kc){this.$a.addHandler("AddMandatoryLabellingBusinessBarEntryEventKey",kc)};C.prototype.Efj=function(kc){this.$a.removeHandler("AddMandatoryLabellingBusinessBarEntryEventKey",kc)};
C.prototype.Tre=function(kc){this.$a.addHandler("RemoveMandatoryLabellingBusinessBarEntryEventKey",kc)};C.prototype.aij=function(kc){this.$a.removeHandler("RemoveMandatoryLabellingBusinessBarEntryEventKey",kc)};C.prototype.JJg=function(kc){this.$a.addHandler("MandatoryLabellingAppHandlerEventKey",kc)};C.prototype.nhj=function(kc){this.$a.removeHandler("MandatoryLabellingAppHandlerEventKey",kc)};C.prototype.sLg=function(kc){this.$a.addHandler("UDPLabelingAppHandlerEventKey",kc)};C.prototype.Hij=function(kc){this.$a.removeHandler("UDPLabelingAppHandlerEventKey",
kc)};C.prototype.j0g=function(){return nb.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsClpBlockedByAppSpecificScenarioEnabled",!1)?this.rbe?this.rbe():!1:!1};C.prototype.Zbj=function(kc){this.BHc=kc};C.prototype.Hw=function(){return(new Date).getTime()};C.prototype.Occ=function(){this.Ih&&(this.NWb=this.Ih.Hc("WebServiceCall","Call Get Policy Endpoint On Server"));var kc=Ac.a.dja(1,1);this.vb.ra("SendHostAttributionInfoForPolicyLabelEnabled")?(kc=new U(this.A5a("datalosspolicy"),
1,null,null,!0,2,null,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,kc),this.Yg.send(kc).YKd(Object(Ma.a)(this,this.nAf,"onDataLossPolicySuccessCallback"),Object(Ma.a)(this,this.mAf,"onDataLossPolicyFailureCallback"))):this.Yg.jm(this.A5a("datalosspolicy"),1,null,null,!0,2,Object(Ma.a)(this,this.nAf,"onDataLossPolicySuccessCallback"),Object(Ma.a)(this,this.mAf,"onDataLossPolicyFailureCallback"),null);this.okb++;oa.ULS.sendTraceTag(25565151,306,50,"Policy request is sent to server. The endpoint used is {0}. Policy call times: {1}.",
this.she,this.okb)};C.prototype.Gbj=function(){this.fhd(this.h9,2,this.uqa)};C.prototype.fhd=function(kc,$c,rd,me){$c=void 0===$c?0:$c;rd=void 0===rd?null:rd;me=void 0===me?!1:me;Ta.Health.instance.recordKpiUsage("MipGetPolicyLabel",0,"officewebclp",this.phd(void 0,$c));this.Fxb=this.Hw();var te=this.y6c($c);this.Ncc(kc,te,rd,me,$c);this.rNd(!0)};C.prototype.nAf=function(kc){this.rLf();var $c=this.o_d(kc);kc=$c.data;$c.returnValue&&(oa.ULS.sendTraceTag(25565153,306,50,"Request to get DataLossPrevention policy succeeded."),
this.okb=0,this.Ih&&(this.OWb=this.Ih.Hc("Task","Parse and Handle Get Policy Response")),this.l1i(kc),this.OWb&&(this.OWb.stop(),this.OWb=null))};C.prototype.mAf=function(kc){this.rLf();this.okb<=this.QVb?this.Occ():(oa.ULS.sendTraceTag(25565154,306,15,"Request to get DataLossPrevention policy failed with error response: {0}.",kc?kc.data?kc.data.dSa:null:null),this.okb=0)};C.prototype.alf=function(){return 0<this.xsa};C.prototype.setPolicyLabel=function(kc){this.Hn.AppliedPolicyId=kc};C.prototype.nSd=
function(kc,$c,rd){rd=void 0===rd?null:rd;var me=this.jah(rd);this.qxj(kc,$c,me,rd)};C.prototype.YGf=function(kc){this.TFa&&(this.TFa.stop(),this.TFa=null);var $c=this.F6e(kc);var rd=$c.i0f;$c=$c.S3f;var me=kc.data.state,te=me?me.zQ:2,ge=this.o_d(kc);kc=ge.data;ge.returnValue?(oa.ULS.sendTraceTag(41799707,306,50,"Request to set label policy data succeeded. ApplyLabelFlag: {0}",te),this.xsa=0,this.D1i(kc,rd,$c,me)):this.TOd(te)};C.prototype.E9i=function(kc){Ta.Health.instance.recordKpiUsage("MipSetPolicyLabel",
0,"officewebclp",this.phd(kc));this.WLb=this.Hw();oa.ULS.sendTraceTag(575947405,306,50,"Raising set policy label triggered event.");this.$a.raiseEvent("SetPolicyLabelTriggeredEventKey",new O(kc))};C.prototype.hJi=function(){this.Rhc&&this.supportsOfficeClientCoauthoring&&this.kri&&this.OFa.zea(12,null,!0)};C.prototype.XGf=function(kc){this.TFa&&(this.TFa.stop(),this.TFa=null);var $c=this.F6e(kc);var rd=$c.i0f;$c=$c.S3f;this.xsa<=this.QVb?this.nSd(rd,$c):(rd=(rd=kc.data.state)?rd.zQ:2,oa.ULS.sendTraceTag(41799708,
306,15,"Request to set label policy failed with error response: {0}. ApplyLabelFlag: {1}",kc?kc.data?kc.data.dSa:null:null,rd),this.RCb="WACServerConnectionFailed",this.xsa=0,this.TOd(rd))};C.prototype.$qi=function(kc){if(kc&&("LabelNotSupported"===kc||"LabelErrorRetryLater"===kc||"CoherencyFailure"===kc||"LabelIdNotFound"===kc||"LabelDisabled"===kc))return oa.ULS.sendTraceTag(539103556,306,50,"LabelError is retriable: {0}",kc),!0;oa.ULS.sendTraceTag(539103557,306,50,"LabelError is not retriable: {0}",
kc);return!1};C.prototype.NYg=function(kc){if(!kc)return!1;for(var $c=null,rd=null,me=Cl(this.Hn.SensitivityLabels),te=me.next();!te.done;te=me.next())te=te.value,te.Id===kc&&($c=te),te.Id===this.h9&&(rd=te);if(!$c)return!1;if(this.Rhc&&this.supportsOfficeClientCoauthoring){if(this.BHc&&this.BHc()||this.rrd)return!0}else if(nb.AFrameworkApplication.uz&&nb.AFrameworkApplication.uz.wwb||this.uqa&&this.uqa())return!0;return $c.IsEndpointProtectionEnabled===(!!rd&&rd.IsEndpointProtectionEnabled)};C.prototype.n_b=
function(kc,$c,rd,me,te){28===kc?this.LOf(new ha(kc,$c,rd,me,te,!1)):this.LOf(new ha(kc,$c,rd,me,te,!0))};C.prototype.Zda=function(kc){28===kc?this.mPf(new I(kc,!1)):this.mPf(new I(kc,!0))};C.prototype.Q8i=function(kc,$c,rd){oa.ULS.sendTraceTag(545280777,306,50,"Raising a CreateAutoCLPSecurityNodes event.");this.$a.raiseEvent("CreateAutoCLPSecurityNodesEventKey",new ka(kc,$c,rd))};C.prototype.J9i=function(kc){oa.ULS.sendTraceTag(545280778,306,50,"Raising a UpdateAutoCLPLabelPriorityNode event.");
this.$a.raiseEvent("UpdateAutoCLPLabelPriorityNodeEventKey",new ka(null,null,kc))};C.prototype.K9i=function(kc,$c){oa.ULS.sendTraceTag(545280779,306,50,"Raising a UpdateAutoCLPSITNodes event.");this.$a.raiseEvent("UpdateAutoCLPSITNodesEventKey",new ka(kc,$c,null))};C.prototype.bPf=function(kc,$c){oa.ULS.sendTraceTag(572650527,306,50,"Raising a mandatory labelling"+(1===$c?"Reading":"Edit")+" switch event.");this.$a.raiseEvent("MandatoryLabellingAppHandlerEventKey",new J(kc,$c))};C.prototype.aXc=function(kc,
$c,rd,me,te){37===kc&&this.G8i(new da(37,$c,rd,me,te))};C.prototype.TLd=function(){this.y9i(new S)};C.prototype.I9i=function(){oa.ULS.sendTraceTag(540608322,306,50,"Raising a UDP labeling event.");this.$a.raiseEvent("UDPLabelingAppHandlerEventKey",new Q(!0))};C.prototype.Zha=function(kc){kc=void 0===kc?!1:kc;var $c=!!this.Hn&&this.Hn.AreLabelsAvailable&&!!this.Hn.SensitivityLabels&&0<this.Hn.SensitivityLabels.length&&Ob.a.any(this.Hn.SensitivityLabels,function(rd){return!!rd&&rd.Enabled});$c||kc||
qa.SRa(!1);return $c};C.prototype.nCf=function(kc){this.BEa&&(this.BEa.stop(),this.BEa=null);this.rNd(!1);var $c=this.o_d(kc);var rd=$c.data;$c.returnValue?(oa.ULS.sendTraceTag(34996493,306,50,"Request to get label policy data succeeded."),this.mkb=0,rd=this.u1i(rd),kc=this.z5e(kc.data),Ta.Health.instance.recordKpiSuccess("MipGetPolicyLabel",this.Vbc(void 0,kc,this.Fxb)),this.Fxb=null,kc=new ra(kc),this.a9i(kc),this.vb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",!1)?
rd&&this.tBj()?this.iqd?this.DVj():(this.a6b(),this.rJd(kc),this.aNc=!0):rd||this.mtc():!this.iqd&&rd&&this.vb.ra("WacApplyManualPolicyLabelIsEnabled")&&this.yve()?(this.rJd(kc),this.aNc=!0):rd||this.mtc()):this.mtc()};C.prototype.tBj=function(){if(!this.vb.ra("WacApplyManualPolicyLabelIsEnabled"))return oa.ULS.sendTraceTag(539877667,306,50,"ShouldAutoClassificationRun returned false - Manual Labeling is not enabled"),!1;if(!this.yve())return!1;if(""===this.h9)return oa.ULS.sendTraceTag(539877696,
306,50,"ShouldAutoClassificationRun returned true - document is not labeled"),!0;if(this.ADa===this.oMc)return oa.ULS.sendTraceTag(539877697,306,50,"ShouldAutoClassificationRun returned false - Applied label already has the highest priority"),!1;oa.ULS.sendTraceTag(539877698,306,50,"ShouldAutoClassificationRun returned true - document is labeled but not with the highest priority label");return!0};C.prototype.a6b=function(){this.sgg();oa.ULS.sendTraceTag(545104324,306,50,"Creating AutoCLP Security nodes. HasSITs: {0}, LabelPriority: {1}",
0<this.RFa.count,this.ADa);var kc=H.toArray(this.RFa);this.Q8i(kc,kc,this.ADa)};C.prototype.DVj=function(){var kc=this.RFa;this.sgg();H.qvj(kc,this.RFa)||(oa.ULS.sendTraceTag(545104325,306,50,"Updating AutoCLP SIT nodes. HasSITs: {0}",0<this.RFa.count),kc=H.toArray(this.RFa),this.K9i(kc,kc));this.Ube&&(oa.ULS.sendTraceTag(545104326,306,50,"Updating AutoCLP Label Priority node. LabelPriority: {0}",this.ADa),this.J9i(this.ADa))};C.prototype.sgg=function(){for(var kc=new Eb.a(Tb.a.Uk()),$c=Cl(this.Hn.SensitivityLabels),
rd=$c.next();!rd.done;rd=$c.next())if((rd=rd.value)&&rd.AutoLabelingSensitiveTypeIds&&0<rd.AutoLabelingSensitiveTypeIds.length){rd=Cl(rd.AutoLabelingSensitiveTypeIds);for(var me=rd.next();!me.done;me=rd.next())(me=me.value)&&kc.add(me)}this.RFa=kc};C.prototype.mCf=function(kc){var $c=this.z5e(kc.data);Ta.Health.instance.recordKpiFailure("MipGetPolicyLabel","GetPolicyLabelsFailure",!1,!1,this.Vbc(void 0,$c,this.Fxb));this.Fxb=null;this.BEa&&(this.BEa.stop(),this.BEa=null);if(this.mkb<=this.QVb){if(this.vb.ra("SendHostAttributionInfoForPolicyLabelEnabled")){var rd=
kc.data.request.get_headers();if("HostAttributionInfo.ScenarioParamName"in rd&&rd[Ac.a.MPd]&&"HostAttributionInfo.ScenarioTypeParamName"in rd&&rd[Ac.a.NPd]){kc.data.request.get_headers();kc.data.request.get_headers();kc=this.y6c($c);this.Ncc(this.h9,kc,this.uqa,void 0,$c);return}}this.fhd(this.h9,$c,this.uqa)}else oa.ULS.sendTraceTag(34996494,306,15,"Request to get label policy failed with error response: {0}.",kc?kc.data?kc.data.dSa:null:null),this.mtc(),this.mkb=0,this.rNd(!1)};C.prototype.z5e=
function(kc){return kc.state?kc.state:0};C.prototype.A5a=function(kc,$c){$c=void 0===$c?!1:$c;var rd=String.format("{0}{1}?action={2}&{3}",this.vb.Wa("PolicyHandlerWebServiceBase")||nb.AFrameworkApplication.sa.Qa.ZW,this.she,kc,nb.AFrameworkApplication.uj);"setpolicylabel"===kc&&nb.AFrameworkApplication.uz&&nb.AFrameworkApplication.uz.xhf&&(rd=Pb.a.vl(rd,"sl","1"));$c&&(rd=Pb.a.vl(rd,"cbd","1"));return rd};C.prototype.F6e=function(kc){var $c;var rd=$c=null;kc&&kc.data&&kc.data.request&&kc.data.request.get_headers()&&
(rd=kc.data.request.get_headers()[hd.a.j0f],$c=kc.data.request.get_headers()[hd.a.T3f]);return{i0f:rd,S3f:$c}};C.prototype.o_d=function(kc){kc=kc?kc.data?kc.data.oe:null:null;return kc&&kc.length&&!this.Mri(kc)?{returnValue:!0,data:kc}:(oa.ULS.sendTraceTag(25565152,306,10,"No response data from policy endpoint."),{returnValue:!1,data:kc})};C.prototype.l1i=function(kc){try{var $c=fb.b(kc)}catch(rd){oa.ULS.sendTraceTag(37880331,306,10,"Error when deserializing DataLossPrevention response.");return}if($c)if($c.IsPolicyTipAvailable)switch($c.IsPolicyTipAvailable.toLowerCase()){case "false":oa.ULS.sendTraceTag(26007261,
306,50,"policyData.IsPolicyTipAvailable is false so DLP policy tip is not present.");break;case "true":oa.ULS.sendTraceTag(25565186,306,50,"DLP Policy is enabled on this document.");this.KJc=$c.NavigateUrl;this.yGj($c.GeneralText,Object(Ma.a)(this,this.rOi,"onDataLossPolicyOverrideButtonClick"));break;default:oa.ULS.sendTraceTag(26007262,306,10,"policyData.IsPolicyTipAvailable is expected to be 'true' or 'false' but it is {0}",$c.IsPolicyTipAvailable)}else oa.ULS.sendTraceTag(26007260,306,10,"policyData.IsPolicyTipAvailable is null or empty whereas it should be 'true' or 'false'.");
else oa.ULS.sendTraceTag(25565185,306,10,"policyData is null after deserializing DataLossPrevention response.")};C.prototype.D1i=function(kc,$c,rd,me){var te=this,ge=me?me.zQ:2,pd=0,jc="",jf;if(function(){var za=fb.d(kc);jf=za.ev;return za}().returnValue)if(jf){jc="Success";var dc=this.y6c(3);if(jf.IsSuccessful){Ta.Health.instance.recordKpiSuccess("MipSetPolicyLabel",this.Vbc(ge,void 0,this.WLb));this.RCb=this.WLb=null;oa.ULS.sendTraceTag(51233632,306,50,"setPolicyLabel was successful as seen after deserializing set policy label data response. ApplyLabelFlag: {0}",
ge);2===ge&&this.Zda(29);this.pyj($c,ge);this.hJi();this.Zda(28);me&&4===ge&&this.n_b(28,CommonUIStrings.l_PolicyBusinessBarTitle,String.format(CommonUIStrings.l_PolicyLabelAutomaticallyAppliedMessage,me.displayName),CommonUIStrings.l_DialogOk,function(){});rb.a("MipAppliedLabels",void 0,void 0,[Object.assign(new sb.a,{name:"SetPolicyLabelApplyFlag",string:wa[ge]})]);this.Ncc($c,dc,this.uqa,void 0,3);return}oa.ULS.sendTraceTag(51233631,306,10,"setPolicyLabel was unsuccessful as seen after deserializing set policy label data response. ApplyLabelFlag: {0}, FailureReason: {1}",
ge,jf.FailureReason);this.RCb=jf.FailureReason;"FileTooLarge"===jf.FailureReason?pd=1:"LabelNotSupported"===jf.FailureReason?pd=2:"LabelDisabled"===jf.FailureReason?pd=3:"MinorVersionLimitExceeded"===jf.FailureReason&&(pd=5);this.Pri&&0<=jf.FailureReason.indexOf("InvalidOperationOnZeroByteFile")&&(me=new Kc.a(2,1,this.rxj,function(){oa.ULS.sendTraceTag(575428443,306,15,"Retring SetPolicyLabelRequestAsync as previous called failed due to zero byte. Attempt number : {0}",te.xsa);te.xsa<=te.QVb&&te.nSd($c,
rd)}),this.re.$g(me));this.Rhc&&this.supportsOfficeClientCoauthoring&&this.Ncc(this.Hn.AppliedPolicyId,dc,this.uqa,!0,3)}else jc="setPolicyLabelData null.",oa.ULS.sendTraceTag(42467541,306,10,"setPolicyLabelData is null after deserializing set policy label data response. ApplyLabelFlag: {0}",ge);else jc="TryDeserialize failed.",oa.ULS.sendTraceTag(41799709,306,10,"Error when deserializing set policy label data response. ApplyLabelFlag: {0}",ge);this.TOd(ge,pd);ge=this.Vbc(ge,void 0,this.WLb);this.WLb=
null;ge.extendedProperties.set("SetPolicyLabelDataFailureReason",this.RCb);ge.extendedProperties.set("SetPolicyLabelDataParseStatus",jc.toString());Ta.Health.instance.recordKpiFailure("MipSetPolicyLabel","SetPolicyLabelFailure",!1,!1,ge)};C.prototype.TOd=function(kc,$c){$c=void 0===$c?0:$c;this.setPolicyLabel(this.h9);this.$Of(new aa);this.BJd($c,kc,2===kc||8===kc||16===kc,!1)};C.prototype.pyj=function(kc,$c){this.setPolicyLabel(this.h9=kc);if(""===kc)nb.AFrameworkApplication.protectedFile=!1,nb.AFrameworkApplication.enableMacrosForProtectedFile=
!1;else for(var rd=Cl(this.Hn.SensitivityLabels),me=rd.next();!me.done;me=rd.next())if(me=me.value,me.Id===kc){nb.AFrameworkApplication.protectedFile=me.IsEndpointProtectionEnabled;break}this.D9i(new Z(kc,$c))};C.prototype.vXj=function(){for(var kc=Cl(this.Hn.SensitivityLabels),$c=kc.next();!$c.done;$c=kc.next())($c=$c.value)&&$c.Enabled&&($c.Id===this.h9&&(this.Ube=this.ADa!==$c.Order,this.ADa=$c.Order),$c.Order>this.oMc&&(this.oMc=$c.Order))};C.prototype.u1i=function(kc){var $c=fb.d(kc);kc=$c.ev;
if(!$c.returnValue)return oa.ULS.sendTraceTag(34996495,306,10,"Error when deserializing label policy data response."),!1;if(!kc)return oa.ULS.sendTraceTag(42467542,306,10,"policyData is null after deserializing label policy data response."),!1;if(!kc.AreLabelsAvailable)return!1;this.Hn=kc;this.h9=kc.AppliedPolicyId;this.vb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",!1)&&this.vXj();this.Zha()&&oa.ULS.sendTraceTag(51197846,306,50,"Labels are available for display after GetPolicyLabels call.");
this.$Of(new aa(!0));return!0};C.prototype.yve=function(){if(!this.Zha())return oa.ULS.sendTraceTag(539877699,306,50,"AreAutoLabelingSensitiveTypesAvailable returned false - No labels to display"),!1;for(var kc=Cl(this.Hn.SensitivityLabels),$c=kc.next();!$c.done;$c=kc.next())if(($c=$c.value)&&$c.AutoLabelingSensitiveTypeIds&&0<$c.AutoLabelingSensitiveTypeIds.length)return!0;oa.ULS.sendTraceTag(539877700,306,50,"AreAutoLabelingSensitiveTypesAvailable returned false - No labels with AutoClp SIT");return!1};
C.prototype.$Of=function(kc){oa.ULS.sendTraceTag(35393610,306,50,"Raising label info update event.");this.$a.raiseEvent("LabelInfoUpdateEvent",kc)};C.prototype.a9i=function(kc){oa.ULS.sendTraceTag(50676305,306,50,"Raising get policy label event.");this.$a.raiseEvent("GetPolicyLabelEventKey",kc)};C.prototype.mtc=function(){qa.SRa(!1);this.$a.raiseEvent("GetPolicyLabelFailureEventKey",new ba)};C.prototype.rJd=function(kc){var $c=this;this.XP&&this.XP.execute(function(rd){rd=[rd.isFeatureEnabled("MsoClpSpTwo",
!0),rd.isFeatureEnabled("MsoDrmPremiumSpTwo",!0)];Promise.all(rd).then(function(me){Ob.a.any(me,function(te){return te})&&(oa.ULS.sendTraceTag(50944077,306,50,"Raising get auto policy label event."),$c.$a.raiseEvent("GetAutoPolicyLabelEventKey",kc),rb.a("MipAutoClassificationEnabled"));return null})})};C.prototype.phd=function(kc,$c){kc=void 0===kc?null:kc;$c=void 0===$c?null:$c;var rd=new Map;rd.set("ClpCoauth",this.supportsOfficeClientCoauthoring.toString());null!=kc&&rd.set("ApplyLabelFlags",wa[kc]);
null!=$c&&rd.set("GetPolicyLabelsReason",T[$c]);return rd};C.prototype.Vbc=function(kc,$c,rd){kc=void 0===kc?null:kc;$c=void 0===$c?null:$c;rd=void 0===rd?null:rd;var me=new ad.a;me.extendedProperties=this.phd(kc,$c);null!=rd&&(me.durationMs=this.Hw()-rd);return me};C.prototype.D9i=function(kc){oa.ULS.sendTraceTag(41799710,306,50,"Raising set policy label event.");this.$a.raiseEvent("SetPolicyLabelEventKey",kc)};C.prototype.LOf=function(kc){oa.ULS.sendTraceTag(51128227,306,50,"Raising an add auto policy business bar entry event.");
kc&&kc.yBb&&rb.a("MipRecommendations");this.$a.raiseEvent("AddAutoPolicyBusinessBarEntryEventKey",kc)};C.prototype.mPf=function(kc){oa.ULS.sendTraceTag(51128256,306,50,"Raising an remove auto policy business bar entry event.");this.$a.raiseEvent("RemoveAutoPolicyBusinessBarEntryEventKey",kc)};C.prototype.G8i=function(kc){oa.ULS.sendTraceTag(573842331,306,50,"Raising an add mandatory labelling business bar entry event.");this.$a.raiseEvent("AddMandatoryLabellingBusinessBarEntryEventKey",kc)};C.prototype.y9i=
function(kc){oa.ULS.sendTraceTag(573842332,306,50,"Raising a remove mandatory labelling business bar entry event.");this.$a.raiseEvent("RemoveMandatoryLabellingBusinessBarEntryEventKey",kc)};C.prototype.yGj=function(kc,$c){$c=void 0===$c?null:$c;oa.ULS.sendTraceTag(34996496,306,50,"Showing policy tip to user.");this.$a.raiseEvent("PolicyTipEvent",new P(CommonUIStrings.l_PolicyBusinessBarTitle,kc,CommonUIStrings.l_PolicyOverrideButton,$c))};C.prototype.BJd=function(kc,$c,rd,me){var te=this;oa.ULS.sendTraceTag(42074656,
306,void 0===me||me?50:15,"Raising set policy label failure event. ApplyLabelFlags: {0}",$c);if(this.vb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CommonBusinessBarEntryForSensitivityLabelError",!1)){me=CommonUIStrings.l_SensitivityApplicationErrorBusinessBarTitle;var ge=CommonUIStrings.l_SensitivityApplicationErrorBusinessBarMessage,pd=null,jc=null;switch(kc){case 1:me=CommonUIStrings.l_SensitivityApplicationErrorFileTooLargeBusinessBarTitle;ge=CommonUIStrings.l_SensitivityApplicationErrorFileTooLargeBusinessBarMessage;
break;case 2:me=CommonUIStrings.l_SensitivityApplicationErrorLabelNotSupportedBusinessBarTitle;ge=CommonUIStrings.l_SensitivityApplicationErrorLabelNotSupportedBusinessBarMessage;break;case 3:me=CommonUIStrings.l_SensitivityApplicationErrorLabelDisabledBusinessBarTitle;ge=CommonUIStrings.l_SensitivityApplicationErrorLabelDisabledBusinessBarMessage;break;case 4:me=CommonUIStrings.l_SensitivityCoauthMandatoryApplicationErrorTitle;ge=CommonUIStrings.l_SensitivityCoauthMandatoryApplicationErrorMessage;
break;case 5:me=CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedBusinessBarTitle,ge=CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedBusinessBarMessage,pd=CommonUIStrings.l_LearnMore,jc=function(){te.U3f()}}kc=new ea(kc,$c,rd,me,ge,pd,jc)}else kc=5===kc?new ea(kc,$c,rd,CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedBusinessBarTitle,CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedBusinessBarMessage,CommonUIStrings.l_LearnMore,
function(){te.U3f()}):new ea(kc,$c,rd);this.$a.raiseEvent("SetPolicyLabelFailureEventKey",kc)};C.prototype.Fwj=function(kc){this.oPc=kc};C.prototype.rOi=function(){this.KJc?(oa.ULS.sendTraceTag(25565187,306,50,"DLP override button was clicked."),sc.a.XV(this.KJc)):oa.ULS.sendTraceTag(25565188,306,10,"Null NavigateUrl got in policy response. Could not navigate to SPO.")};C.prototype.Mri=function(kc){if(!kc.startsWith("<")||-1===kc.indexOf("Error")&&-1===kc.indexOf("Unavailable"))return!1;oa.ULS.sendTraceTag(25565189,
306,10,"The response from server is not a valid JSON response and it matches the error page keyword. This might be the error response from a non-existing endpoint.");return!0};C.prototype.rLf=function(){this.NWb&&(this.NWb.stop(),this.NWb=null)};C.prototype.CNh=function(kc){if(!kc)return"manual";switch(kc.zQ){case 0:return"manual";case 4:return"auto";case 1:return"default";case 16:return"mandatory";case 2:return"manual";case 8:return"recommended";default:return"manual"}};C.prototype.KOh=function(kc){if(!kc)return"privileged";
kc=kc.zQ;var $c="privileged";if(4===kc||1===kc)$c="standard";return $c};C.prototype.Ncc=function(kc,$c,rd,me,te){rd=void 0===rd?null:rd;me=void 0===me?!1:me;te=void 0===te?0:te;this.vb.ra("WacLabelingGetPolicyLabelsIsEnabled")&&(this.h9=kc,this.uqa=rd,this.Ih&&(this.BEa=this.Ih.Hc("WebServiceCall","Call Get Policy Endpoint On Server")),rd={},rd[hd.a.sOg]=kc,this.vb.ra("SendHostAttributionInfoForPolicyLabelEnabled")?(kc=new U(this.A5a("getpolicylabels",me),1,null,rd,!0,2,te,void 0,void 0,void 0,void 0,
void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,$c),this.Yg.send(kc).YKd(Object(Ma.a)(this,this.nCf,"onGetPolicyLabelsSuccessCallback"),Object(Ma.a)(this,this.mCf,"onGetPolicyLabelsFailureCallback"))):this.Yg.jm(this.A5a("getpolicylabels",me),1,null,rd,!0,2,Object(Ma.a)(this,this.nCf,"onGetPolicyLabelsSuccessCallback"),Object(Ma.a)(this,this.mCf,"onGetPolicyLabelsFailureCallback"),te,void 0,void 0,void 0,void 0,"22"),this.mkb++,oa.ULS.sendTraceTag(34996492,306,50,"Policy label request sent to server. Policy call times: {0}",
this.mkb))};C.prototype.qxj=function(kc,$c,rd,me){me=void 0===me?null:me;if(this.dAb){this.Ih&&(this.TFa=this.Ih.Hc("WebServiceCall","Call Set Policy Endpoint On Server"));var te={};te[hd.a.j0f]=kc;$c&&(te[hd.a.T3f]=encodeURIComponent($c));this.oPc&&(te[hd.a.KNg]=this.oPc);me?(te[hd.a.Q3f]=this.CNh(me),te[hd.a.R3f]=this.KOh(me)):(te[hd.a.Q3f]="manual",te[hd.a.R3f]="privileged");this.supportsOfficeClientCoauthoring&&this.Hn&&(te[hd.a.m3i]=this.Hn.PolicyLabelVersionToken);this.vb.ra("SendHostAttributionInfoForPolicyLabelEnabled")?
(kc=new U(this.A5a("setpolicylabel",!0),1,null,te,!0,2,me,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,rd),this.Yg.send(kc).YKd(Object(Ma.a)(this,this.YGf,"onSetPolicyLabelSuccessCallback"),Object(Ma.a)(this,this.XGf,"onSetPolicyLabelFailureCallback"))):this.Yg.jm(this.A5a("setpolicylabel",!0),1,null,te,!0,2,Object(Ma.a)(this,this.YGf,"onSetPolicyLabelSuccessCallback"),Object(Ma.a)(this,this.XGf,"onSetPolicyLabelFailureCallback"),me,void 0,void 0,void 0,void 0,
"32");this.xsa++;oa.ULS.sendTraceTag(41799706,306,50,"Set policy label request sent to server. Policy call times: {0}",this.xsa)}else oa.ULS.sendTraceTag(570972052,306,50,"SetPolicyLabelRequestInternalAsync was exited - ApplyManualPolicyLabel was not enabled.")};C.prototype.U3f=function(){var kc=new Cc.StandardDialog,$c=this.vb.Wa("BreadcrumbFolderUrl");$c?(kc.lc=11,kc.Bc(1,CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedViewInfoAction),kc.Bc(2,CommonUIStrings.l_DialogOk)):(kc.lc=
0,kc.Bc(1,CommonUIStrings.l_DialogOk));kc.Cpe(CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedViewInfoHelpText,"0f6cd105-974f-44a4-aadb-43ac5bdfd247");kc.Oej();kc.$X(CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedViewInfoTitle,CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedViewInfoMessage,function(rd){1===rd&&$c&&sc.a.wf($c,"_blank",void 0,"SetPolicyLabelFailureBusinessBarActionCallback.BreadcrumbFolderUrl")})};C.prototype.y6c=function(kc){switch(kc){case 1:return Ac.a.dja(1,
1);case 2:return Ac.a.dja(7,1);case 3:return Ac.a.dja(8,1);default:return Ac.a.dja(7,0)}};C.prototype.jah=function(kc){kc=void 0===kc?null:kc;if(!kc)return Ac.a.dja(8,0);switch(kc.zQ){case 1:case 16:return Ac.a.dja(1,1);case 4:case 2:case 8:return Ac.a.dja(8,1);default:return Ac.a.dja(8,0)}};C.prototype.rNd=function(kc){this.vb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)&&appChrome.api.setAsyncRequestStatus("sensitivity",kc)};uk.Object.defineProperties(C.prototype,
{iqd:{configurable:!0,enumerable:!0,get:function(){return this.aNc}},rrd:{configurable:!0,enumerable:!0,get:function(){if(!this.b9d)return!1;for(var kc=Cl(this.b9d.H4j()),$c=kc.next();!$c.done;$c=kc.next())if($c=$c.value,!$c.Capabilities||!$c.Capabilities.SupportsClientIsMipTrusted)return!1;return!0}},kri:{configurable:!0,enumerable:!0,get:function(){return!!this.OFa}}});Object($b.a)(C,"PolicyManager",null,[728]);var Hd=b(140),Ne=b(254);E.prototype.init=function(){var kc=this;nb.AFrameworkApplication.ha.ra("ShouldInitCommonPolicyPackage")&&
(nb.AFrameworkApplication.ha.ra("IsDataLossPreventionEnabledForUser")&&nb.AFrameworkApplication.sa&&(this.Zg=this.tb.resolve("Common.App.Policy.Contracts.IPolicyManager"),this.Zg.Pre(Object(Ma.a)(this,this.kVd,"showPolicyBusinessBar")),oa.ULS.sendTraceTag(36537375,306,50,"PolicyManager is created successfully."),Hd.a.get_instance().Qk(6,function(){kc.Zg.Occ()})),nb.AFrameworkApplication.ha.ra("WacLabelingPoliciesIsEnabled")&&nb.AFrameworkApplication.ha.ra("SupportsPolicies")?Hd.a.get_instance().Qk(6,
Object(Ma.a)(this,this.zLi,"onAfterRibbonBehaviorAttached")):qa.SRa(!1))};E.prototype.dispose=function(){};E.prototype.hi=function(kc){kc.register(728,"Common.App.Policy.Contracts.IPolicyManager").Ic().Nc(function(){return new C(nb.AFrameworkApplication.ha,nb.AFrameworkApplication.Ld,nb.AFrameworkApplication.sa.gE,nb.AFrameworkApplication.ha.Cd("MaxGetPolicyRetries",1),kc.qc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),nb.AFrameworkApplication.sa.Qa.Yj)});kc.register(qa,"Common.App.Policy.PolicyActor").as("Common.App.Policy.Contracts.IPolicyActor").Ic().Nc(function(){return new qa(nb.AFrameworkApplication.Ib,
nb.AFrameworkApplication.sa,nb.AFrameworkApplication.ha,kc.yOd("Common.App.Policy.Contracts.IPolicyManager"))});this.tb=kc};E.prototype.zLi=function(){this.o2=this.tb.Nh("CommonUI.BusinessBar");this.Zg||(this.Zg=this.tb.resolve("Common.App.Policy.Contracts.IPolicyManager"));this.bsa=this.tb.resolve("Common.App.Policy.PolicyActor");nb.AFrameworkApplication.ha&&nb.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CacheSensitivityVisibility",!1)&&jb.a("isSharedUxGateEnabled")&&
appChrome.api.isSharedUxGateEnabled("SharedOnline.ChangeGate.DelayPolicyActionRegistration")?this.Zg.b0b(Object(Ma.a)(this.bsa,this.bsa.ZRf,"registerActionsHandler")):this.bsa.Sg();this.Zg.b0b(Object(Ma.a)(this,this.C0d,"updateLabelInfo"));nb.AFrameworkApplication.ha.ra("WacApplyManualPolicyLabelIsEnabled")&&(this.Zg.fYc(Object(Ma.a)(this,this.I9h,"handleSetPolicyLabelFailure")),this.Zg.Fqe(Object(Ma.a)(this,this.n_b,"addAutoPolicyBusinessBarEntry")),this.Zg.Sre(Object(Ma.a)(this,this.Zda,"removeAutoPolicyBusinessBarEntry")),
this.Zg.Gqe(Object(Ma.a)(this,this.aXc,"addMandatoryLabellingBusinessBarEntry")),this.Zg.Tre(Object(Ma.a)(this,this.TLd,"removeMandatoryLabellingBusinessBarEntry")))};E.prototype.C0d=function(){this.bsa.L3f();this.bsa.a3f();this.bsa.oOf();var kc=this.Zg.j0g();nb.AFrameworkApplication.ha.ra("HasDocumentEditRights")&&!kc?this.bsa.Tdg():oa.ULS.sendTraceTag(558682911,306,50,"Default/Mandatory Labeling has been skipped because HasDocumentEditRights: {0}, IsClpBlockedByAppSpecificScenario: {1}",nb.AFrameworkApplication.ha.ra("HasDocumentEditRights"),
kc);nb.AFrameworkApplication.sa.updateCommandUI()};E.prototype.kVd=function(kc,$c){this.x5e($c.title,$c.isc,38,$c.Qyf,$c.buttonText);oa.ULS.sendTraceTag(34174784,306,10,"Failed to add entry to business bar. Policy message could not be shown to user.")};E.prototype.I9h=function(kc,$c){if($c.Z7f){kc=CommonUIStrings.l_SensitivityApplicationErrorBusinessBarTitle;var rd=CommonUIStrings.l_SensitivityApplicationErrorBusinessBarMessage,me=null,te=null;nb.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CommonBusinessBarEntryForSensitivityLabelError",
!1)?(kc=$c.title,rd=$c.message,me=$c.buttonText,te=$c.zZ):1===$c.errorType?(kc=CommonUIStrings.l_SensitivityApplicationErrorFileTooLargeBusinessBarTitle,rd=CommonUIStrings.l_SensitivityApplicationErrorFileTooLargeBusinessBarMessage):2===$c.errorType?(kc=CommonUIStrings.l_SensitivityApplicationErrorLabelNotSupportedBusinessBarTitle,rd=CommonUIStrings.l_SensitivityApplicationErrorLabelNotSupportedBusinessBarMessage):nb.AFrameworkApplication.ha.ra("ClpLabelDisabledErrorCodeIsEnabled")&&3===$c.errorType?
(kc=CommonUIStrings.l_SensitivityApplicationErrorLabelDisabledBusinessBarTitle,rd=CommonUIStrings.l_SensitivityApplicationErrorLabelDisabledBusinessBarMessage):4===$c.errorType?(kc=CommonUIStrings.l_SensitivityCoauthMandatoryApplicationErrorTitle,rd=CommonUIStrings.l_SensitivityCoauthMandatoryApplicationErrorMessage):5===$c.errorType&&(kc=$c.title,rd=$c.message,me=$c.buttonText,te=$c.zZ);this.x5e(kc,rd,21,null,null,te,me);oa.ULS.sendTraceTag(42074654,306,10,"Failed to add entry to business bar. CLP policy message could not be shown to user.")}};
E.prototype.Zda=function(){};E.prototype.n_b=function(kc,$c){this.o2&&(this.Zg.Zda($c.Uqb),kc=new Za.a($c.title,$c.message,null),kc.id=$c.Uqb,kc.closeable=!0,kc.image=3,kc.addButton($c.buttonText,$c.zZ,$c.buttonText,!0),this.o2.OE(kc,!1))};E.prototype.aXc=function(kc,$c){this.o2&&(kc=new Za.a($c.title,$c.message,null),kc.id=$c.Uqb,kc.closeable=!1,kc.image=3,kc.addButton($c.buttonText,$c.zZ,$c.buttonText,!1),this.o2.OE(kc,!1))};E.prototype.TLd=function(){};E.prototype.x5e=function(kc,$c,rd,me,te,ge,
pd){me=void 0===me?null:me;te=void 0===te?null:te;ge=void 0===ge?null:ge;pd=void 0===pd?null:pd;kc=new Za.a(kc,$c,null);kc.id=rd;kc.closeable=!0;me&&kc.zFg(te,me);ge&&kc.addButton(pd,ge,pd)};E.main=function(){Ne.a.instance.nj(new E)};uk.Object.defineProperties(E.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.Policy"}}});Object($b.a)(E,"PackageManager",null,[4,5]);var Ud=b(10),Ge=b(613),Sc=b(224),Pc=b(51),Zd=b(35),ie=b(81),vd=b(36),Lb=b(326),id=b(387),uc=b(173),ed=
b(95),Cd=b(29),$d=b(289),La=b(1),od=b(21),ne=b(288);Object($b.a)(t,"ApplyPolicyContextParameters",null,[]);var qd=b(904),He=b(625),Ue=b(46),zf=b(43);Object($b.a)(A,"AnnotationActivationOptions",null,[]);var Hf=b(83),De=b(932),Ae=b(909),yd=De.a;Am(B,yd);B.getTypeName=function(){return"AugLoop_SecurityClp_LabellingAnnotation"};B.xe=function(){return["AugLoop_Core_Annotation"]};Object($b.a)(B,"LabellingAnnotation",De.a,[]);var je=b(933),we=je.a;Am(r,we);r.getTypeName=function(){return"AugLoop_SecurityShared_SecurityShared"};
r.xe=function(){return[]};Object($b.a)(r,"SecurityShared",je.a,[]);Am(w,r);w.getTypeName=function(){return"AugLoop_SecurityShared_CLP"};w.xe=function(){return["AugLoop_SecurityShared_SecurityShared"]};Object($b.a)(w,"CLP",r,[]);var Bc=De.a;Am(u,Bc);u.getTypeName=function(){return"AugLoop_Automatic_Clp_LabellingAnnotation"};u.xe=function(){return["AugLoop_Core_Annotation"]};Object($b.a)(u,"LabellingAnnotation",De.a,[]);var Od=b(1192),ae=b(1085),Ad=b(1194),Ve=De.a;Am(h,Ve);h.getTypeName=function(){return"AugLoop_LinkedDataType_LinkedDataTypeAnnotation"};
h.xe=function(){return["AugLoop_Core_Annotation"]};Object($b.a)(h,"LinkedDataTypeAnnotation",De.a,[]);var kf=vd.a;Am(n,kf);n.prototype.dispose=function(){this.disposed||(this.disposed=!0,this.Lhh(),this.dLe(),this.WGd=this.policyManager=this.augmentationLoopManager=null,kf.prototype.dispose.call(this))};n.prototype.G_a=function(kc,$c,rd,me,te){te=void 0===te?!1:te;oa.ULS.sendTraceTag(537154642,306,50,"AutoPolicyManager: ApplyAutoPolicyLabel called for LabellingSource {0} with AutoLabelPresent: {1}, RecommendedLabelPresent: {2}, isStandard: {3}.",
me,!!kc,!!$c,te);this.sc?this.WGd&&(this.OYg($c,me)?(this.nId=$c,this.iId=me,this.Nnf.ia(me,$c)):$c=this.nId,kc=this.WGd.G_a(kc,$c,rd,te),oa.ULS.sendTraceTag(537154640,306,50,"AutoPolicyManager::ApplyAutoPolicyLabel - policyActor.ApplyAutoPolicyLabel returned {0}.",kc)):oa.ULS.sendTraceTag(537154641,306,15,"AutoPolicyManager: ApplyAutoPolicyLabel failing because IsDisposed: {0}, IsSessionActive: {1}.",this.disposed,this.$.ea.sc)};n.prototype.OYg=function(kc,$c){if(!this.policyManager.Zha())return oa.ULS.sendTraceTag(537154639,
306,15,"CanShowRecommendedSensitivityLabel - Labels are not available."),!1;var rd=this.policyManager.Hn;var me=this.Nnf.Fc(this.iId).value;var te=null,ge=null,pd=null;rd=Cl(rd.SensitivityLabels);for(var jc=rd.next();!jc.done;jc=rd.next())jc=jc.value,jc.Id===kc&&(te=jc),jc.Id===me&&(ge=jc),jc.Id===this.nId&&(pd=jc);return ge&&ge.Id===kc?(oa.ULS.sendTraceTag(537154638,306,50,"AutoPolicyManager: CanShowRecommendedSensitivityLabel - Suppressing the recommendation since it is same as last recommendation from current source."),
!1):this.businessBar.HC(39)&&this.iId!==$c&&pd&&(!te||pd.Order>=te.Order)?(oa.ULS.sendTraceTag(537154637,306,50,"AutoPolicyManager: CanShowRecommendedSensitivityLabel - Suppressing the recommendation since current label priority is lower than last label priority."),!1):!0};n.prototype.eqd=function(){return La.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",!1)};n.prototype.acj=function(){this.policyManager.Fqe(this.j7f);this.policyManager.Sre(this.USf);this.$.ea.A$(this.W6);
this.eqd()&&(this.policyManager.uIg(this.a6b),this.policyManager.uLg(this.qgg),this.policyManager.vLg(this.rgg))};n.prototype.Lhh=function(){this.businessBar.removeEntry(39);this.businessBar.removeEntry(38);this.policyManager.Cfj(this.j7f);this.policyManager.$hj(this.USf);this.$.ea.N7(this.W6);La.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",!1)&&(this.policyManager.jgj(this.a6b),this.policyManager.Iij(this.qgg),this.policyManager.Jij(this.rgg))};n.prototype.Ddi=
function(){this.eB=new qd.a(He.a.LK());var kc=this.eqd()?B.getTypeName():u.getTypeName();this.eB.add(1,Object.assign(new A,{annotationType:kc,B_a:this.Bvi,XF:!1,ZMa:!1}));this.eB.add(2,Object.assign(new A,{annotationType:h.getTypeName(),B_a:this.rxi,XF:!1,ZMa:!1}))};n.prototype.xag=function(){for(var kc=Cl(this.Eab),$c=kc.next();!$c.done;$c=kc.next())this.augmentationLoopManager.submitOperation($c.value);this.Eab=[]};n.prototype.Wbj=function(kc){if(!this.eB.xb(kc))return oa.ULS.sendTraceTag(537154636,
306,15,"AutoPolicyManager::RegisterAnnotation - AnnotationActivationOptions not available for LabellingSource {0}.",kc),!1;if(this.eB.pa(kc).XF)return oa.ULS.sendTraceTag(537154635,306,15,"AutoPolicyManager::RegisterAnnotation - Annotations already registered for LabellingSource {0}.",kc),!0;this.eB.pa(kc).XF=!0;oa.ULS.sendTraceTag(537154634,306,50,"AutoPolicyManager::RegisterAnnotation - Annotations registered for LabellingSource {0}.",kc);if(!this.$.isEditMode)return oa.ULS.sendTraceTag(537154633,
306,50,"AutoPolicyManager::RegisterAnnotation - Skipping AugmentationLoop initialization in view mode."),!0;La.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",!1)?this.Ezb():this.vdf();return!0};n.prototype.vdf=function(){for(var kc=this,$c=!1,rd=Cl(this.eB),me=rd.next();!me.done&&!($c=me.value.value.XF||$c);me=rd.next());$c?this.augmentationLoopManager?(oa.ULS.sendTraceTag(537154631,306,50,"AutoPolicyManager::InitAugmentationLoopIfNecessaryAndActivateAnnotations - AugmentationLoop already initialized."),
this.LZb()):this.Z_a?oa.ULS.sendTraceTag(537154630,306,50,"AutoPolicyManager::InitAugmentationLoopIfNecessaryAndActivateAnnotations - AugmentationLoop initialization in-progress."):(this.Z_a=!0,$c=this.$.ya.FlightingSettings.AutoCLPStartUpDelay,oa.ULS.sendTraceTag(537154629,306,50,"AutoPolicyManager::InitAugmentationLoopIfNecessaryAndActivateAnnotations - Initializing AugmentationLoop in {0} milliseconds.",$c),Ue.a.instance.create(function(){kc.Fdi()},$c,zf.a.Swe,!0,!0)):oa.ULS.sendTraceTag(537154632,
306,50,"AutoPolicyManager::InitAugmentationLoopIfNecessaryAndActivateAnnotations - no registered annotations.")};n.prototype.Ezb=function(){var kc=this,$c=0<this.Eab.length;if(!$c)for(var rd=Cl(this.eB),me=rd.next();!me.done&&!($c=me.value.value.XF||$c);me=rd.next());$c?this.augmentationLoopManager?(oa.ULS.sendTraceTag(537154627,306,50,"AutoPolicyManager::InitAugmentationLoopIfNecessary - AugmentationLoop already initialized."),this.LZb(),this.xag()):this.Z_a?oa.ULS.sendTraceTag(537154626,306,50,
"AutoPolicyManager::InitAugmentationLoopIfNecessary - AugmentationLoop initialization in-progress."):(this.Z_a=!0,$c=this.$.ya.FlightingSettings.AutoCLPStartUpDelay,oa.ULS.sendTraceTag(537154625,306,50,"AutoPolicyManager::InitAugmentationLoopIfNecessary - Initializing AugmentationLoop in {0} milliseconds.",$c),Ue.a.instance.create(function(){kc.Gdi()},$c,zf.a.Swe,!0,!0)):oa.ULS.sendTraceTag(537154628,306,50,"AutoPolicyManager::InitAugmentationLoopIfNecessary - no registered annotations and operations.")};
n.prototype.Gdi=function(){var kc=this;Zd.TaskExtensions.Ba(Pc.GetServiceTaskFactory.Ua(this.$.da,328,327,1),function($c){kc.augmentationLoopManager=$c.result;kc.Z_a=!1;kc.augmentationLoopManager?(oa.ULS.sendTraceTag(537154595,306,50,"AutoPolicyManager::InitAugmentationLoop - AugmentationLoopManager instantiated."),kc.augmentationLoopManager.MWc(kc.Hoc),kc.$.isEditMode?(kc.LZb(),kc.xag()):oa.ULS.sendTraceTag(537154594,306,50,"AutoPolicyManager::InitAugmentationLoop - Skipping annotation activation in view mode.")):
oa.ULS.sendTraceTag(537154624,306,10,"AutoPolicyManager::InitAugmentationLoop - Failed to instantiate AugmentationLoopManager.")},this.la,3)};n.prototype.Fdi=function(){var kc=this;Zd.TaskExtensions.Ba(Pc.GetServiceTaskFactory.Ua(this.$.da,328,327,1),function($c){kc.augmentationLoopManager=$c.result;kc.Z_a=!1;kc.augmentationLoopManager?(oa.ULS.sendTraceTag(571479120,306,50,"AutoPolicyManager::InitAugmentationLoop - AugmentationLoopManager instantiated."),kc.augmentationLoopManager.MWc(kc.Hoc),kc.$.isEditMode?
kc.LZb():oa.ULS.sendTraceTag(537154592,306,50,"AutoPolicyManager::InitAugmentationLoop - Skipping annotation activation in view mode.")):oa.ULS.sendTraceTag(537154593,306,10,"AutoPolicyManager::InitAugmentationLoop - Failed to instantiate AugmentationLoopManager.")},this.la,3)};n.prototype.dLe=function(){for(var kc=Cl(this.eB),$c=kc.next();!$c.done;$c=kc.next())$c=$c.value,$c.value.XF&&this.Khh($c.key)};n.prototype.Khh=function(kc){this.eB.pa(kc).ZMa&&this.bKe(kc);this.eB.pa(kc).XF=!1;oa.ULS.sendTraceTag(537154591,
306,50,"AutoPolicyManager::DeregisterAnnotation completed for LabellingSource {0}.",kc)};n.prototype.LZb=function(){for(var kc=Cl(this.eB),$c=kc.next();!$c.done;$c=kc.next())$c=$c.value,$c.value.XF&&!$c.value.ZMa&&this.activateAnnotation($c.key)};n.prototype.activateAnnotation=function(kc){this.augmentationLoopManager.activateAnnotation(this.eB.pa(kc).annotationType);this.augmentationLoopManager.uQ(this.eB.pa(kc).annotationType,this.eB.pa(kc).B_a);this.eB.pa(kc).ZMa=!0;oa.ULS.sendTraceTag(537154590,
306,50,"AutoPolicyManager::ActivateAnnotation completed for LabellingSource {0}.",kc)};n.prototype.agh=function(){for(var kc=Cl(this.eB),$c=kc.next();!$c.done;$c=kc.next())$c=$c.value,$c.value.ZMa&&this.bKe($c.key)};n.prototype.bKe=function(kc){this.augmentationLoopManager.GRa(this.eB.pa(kc).annotationType,this.eB.pa(kc).B_a);this.eB.pa(kc).ZMa=!1;oa.ULS.sendTraceTag(537154589,306,50,"AutoPolicyManager::DeactivateAnnotation completed for LabellingSource {0}.",kc)};n.prototype.applyPolicyLabel=function(kc,
$c,rd,me){var te=this;if(this.ha.ra("SupportsOfficeClientCoauthoring"))oa.ULS.sendTraceTag(537154579,306,50,"AutoPolicyManager::ApplyPolicyLabel - SupportsOfficeClientCoauthoring is enabled."),this.G_a(kc,$c,rd,me);else{oa.ULS.sendTraceTag(537154578,306,50,"AutoPolicyManager::ApplyPolicyLabel - SupportsOfficeClientCoauthoring is disabled.");var ge=function(pd){te.G_a(kc,$c,rd,me,0===pd||1===pd||4===pd)};this.qjd(ge,function(){ge(2)},this.ktf)}};n.prototype.h_c=function(kc,$c){var rd=this.Deg(kc);
kc=rd.sensitivityLabel;var me=rd.mHa;if(!rd.returnValue)return oa.ULS.sendTraceTag(537154577,306,15,"AutoApplyOrRecommendPolicyLabel - Failed to set the sensitivity labels."),!1;if(me&&me.Order>=kc.Order)return oa.ULS.sendTraceTag(537154576,306,50,"AutoApplyOrRecommendPolicyLabel - The applied label has a higher sensitivty."),!1;this.applyPolicyLabel(kc.Id,kc.Id,null,$c);return!0};n.prototype.i_c=function(kc,$c){var rd=this;$c=!1;var me=null,te=null;if(!function(){var jc=rd.Deg(kc);me=jc.sensitivityLabel;
te=jc.mHa;return jc}().returnValue)return oa.ULS.sendTraceTag(537154575,306,15,"AutoApplyOrRecommendPowerBILabel - Failed to set the sensitivity labels."),{returnValue:!1,xNa:$c};if(te&&te.ParentId&&me.ParentId&&te.ParentId===me.ParentId)return oa.ULS.sendTraceTag(537154574,306,50,"AutoPolicyManager::AutoApplyOrRecommendPowerBILabel - Label has a common parent with AppliedLabel."),{returnValue:!1,xNa:$c};if(te&&te.Order>=me.Order)return oa.ULS.sendTraceTag(537154573,306,50,"AutoPolicyManager::AutoApplyOrRecommendPowerBILabel - Label does not have a higher priority than AppliedLabel."),
{returnValue:!1,xNa:$c};if(this.ha.ra("SupportsOfficeClientCoauthoring")){oa.ULS.sendTraceTag(537154572,306,50,"AutoPolicyManager::AutoApplyOrRecommendPowerBILabel - SupportsOfficeClientCoauthoring is enabled.");var ge=this.policyManager.Hn;ge=!ge.AppliedPolicyId||!ge.PolicyLabelAssignmentMethod||Nb.c(ge.PolicyLabelAssignmentMethod)===Nb.c("standard");this.tve(me.Id,ge)}else{oa.ULS.sendTraceTag(537154571,306,50,"AutoPolicyManager::AutoApplyOrRecommendPowerBILabel - SupportsOfficeClientCoauthoring is disabled.");
var pd=function(jc){rd.tve(me.Id,0===jc||1===jc||4===jc)};this.qjd(pd,function(){pd(2)},this.ktf)}return{returnValue:!0,xNa:$c}};n.prototype.qjd=function(kc,$c,rd,me){var te=this;me=void 0===me?0:me;if(this.sc){var ge=this.$.na.ta.fc();y(this.$.na.ta,this.$.ya.DocumentHostInfo.TenantId,function(pd){te.n_h(pd,kc)},function(){te.m_h(kc,$c,rd,me)},null,null,ge)}else oa.ULS.sendTraceTag(537154570,306,15,"AutoPolicyManager: GetPolicyApplicationMethod failing because IsDisposed: {0}, IsSessionActive: {1}.",
this.disposed,this.$.ea.sc)};n.prototype.n_h=function(kc,$c){oa.ULS.sendTraceTag(537154569,306,50,"AutoPolicyManager: GetPolicyApplicationMethod web service call was successful.");this.sc?!kc||$d.a(kc)?oa.ULS.sendTraceTag(537154567,306,15,kc?"AutoPolicyManager: GetPolicyApplicationMethod result has non-status message.":"AutoPolicyManager: GetPolicyApplicationMethod result is null"):$c(kc.Result):oa.ULS.sendTraceTag(537154568,306,50,"AutoPolicyManager: GetPolicyApplicationMethodSuccessCallback failing because IsDisposed: {0}, IsSessionActive: {1}.",
this.disposed,this.$.ea.sc)};n.prototype.m_h=function(kc,$c,rd,me){oa.ULS.sendTraceTag(537154566,306,15,"AutoPolicyManager: GetPolicyApplicationMethod web service call failed. Trying again");this.sc?me>=rd?(oa.ULS.sendTraceTag(537154564,306,15,"AutoPolicyManager: GetPolicyApplicationMethod max retries exhausted."),$c()):this.qjd(kc,$c,rd,me+1):oa.ULS.sendTraceTag(537154565,306,50,"AutoPolicyManager: GetPolicyApplicationMethodFailureCallback failing because IsDisposed: {0}, IsSessionActive: {1}.",
this.disposed,this.$.ea.sc)};n.prototype.tve=function(kc,$c){$c?this.G_a(kc,null,null,3,!0):this.G_a(null,kc,null,3,!1)};n.prototype.Deg=function(kc){var $c;var rd=$c=null;if(!this.$.isEditMode)return{returnValue:!1,sensitivityLabel:$c,mHa:rd};if(!this.policyManager.Zha())return oa.ULS.sendTraceTag(537154529,306,15,"TryGettingSensitivityLabels - Labels are not available."),{returnValue:!1,sensitivityLabel:$c,mHa:rd};var me=this.policyManager.Hn;if(!me)return oa.ULS.sendTraceTag(537154528,306,15,"TryGettingSensitivityLabels - GetPolicyLabelsData returned an invalid result."),
{returnValue:!1,sensitivityLabel:$c,mHa:rd};if(Ob.a.Qh(me.SensitivityLabels))return oa.ULS.sendTraceTag(537154527,306,15,"TryGettingSensitivityLabels - Attempting to apply labels when there are no sensitivity labels available."),{returnValue:!1,sensitivityLabel:$c,mHa:rd};var te=me.AppliedPolicyId;kc=Cl(kc);for(var ge=kc.next();!ge.done;ge=kc.next()){ge=ge.value;for(var pd=Cl(me.SensitivityLabels),jc=pd.next();!jc.done;jc=pd.next())jc=jc.value,jc.Id===ge&&(!$c||$c.Order<jc.Order)&&($c=jc),jc.Id===
te&&(rd=jc)}return $c?{returnValue:!0,sensitivityLabel:$c,mHa:rd}:(oa.ULS.sendTraceTag(537154526,306,10,"TryGettingSensitivityLabels - None of the sensitivity labels matched."),{returnValue:!1,sensitivityLabel:$c,mHa:rd})};uk.Object.defineProperties(n.prototype,{sc:{configurable:!0,enumerable:!0,get:function(){return!this.disposed&&this.$.ea.sc}}});Object($b.a)(n,"AutoPolicyManager",vd.a,[3]);var Fc=b(158),fd=b(11),jd=b(14),zd=Fc.ErrorDialog;Am(m,zd);m.prototype.um=function(){var kc=this;zd.prototype.um.call(this);
if(this.error.Appearance&1&&this.$.Dd&2){var $c=this.getButton(0);fd.DOMElementExtensions.IRd($c.get_element(),jd.a.instance.fa(1272));this.wQ(function(){0===kc.returnValue&&kc.$.Dd&2&&(oa.ULS.sendTraceTag(50373725,306,50,"BlockSenitivityLabelActionDialog : Opening the book in excel desktop."),Zd.TaskExtensions.Ba(Pc.GetServiceTaskFactory.Ua(kc.$.da,55,56,0),function(rd){rd.result.m5c()},kc.$.la,3))})}};m.JR=function(kc){return kc.Dd&2?Cd.a.ed(3,1,0,1915,0,-1237306487,"SensitivityLabelBlockApplyLabelOpenInDesktop"):
Cd.a.ed(1,1,0,1916,0,-313914360,"SensitivityLabelBlockApplyLabel")};Object($b.a)(m,"BlockSenitivityLabelActionDialog",Fc.ErrorDialog,[]);var zc=vd.a;Am(l,zc);l.prototype.initialize=function(){var kc=this;this.ha.ra("SupportsPolicies")?(this.XEa=this.ha.Wa("AppliedPolicyId"),this.q7.Sg(),this.$.da.Ya(29,function($c){kc.statusBarManager=$c;$c.WJ(kc)}),this.Xz(),od.a.Qh(this.ha.Wa("HostUserId"))||this.n3i(),this.q7.ccj(this.JSg),this.q7.Vcj(this.Aji),this.Qr.Zbj(this.rrd),this.Do=La.EwaSettings.getBooleanFeatureGate(Lb.a.$Qa,
!1)):La.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CacheSensitivityVisibility",!1)&&jb.c()&&appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("Sensitivity",!0));!od.a.Qh(this.ha.Wa("HostUserId"))&&La.EwaSettings.ma(170)&&this.$.ea.ah.get(45)&&(oa.ULS.sendTraceTag(537154524,306,50,"DataLossPrevention feature is Enabled and launched on Excel."),this.qTh())};l.prototype.Gq=function(kc){this.addHandler("LabelInfoChangedKey",kc)};l.prototype.er=function(kc){this.removeHandler("LabelInfoChangedKey",
kc)};l.prototype.wn=function(){return!0};l.prototype.Bs=function(kc,$c){if("QueryPolicyLabel"!==kc)return!1;if(this.sTa())return $c.Visible=!1,!0;$c.Visible=!0;return 32===nb.AFrameworkApplication.Ib.Be(Ub.a.Obb,2,$c)};l.prototype.dispose=function(){this.statusBarManager&&(this.statusBarManager.tG(this),this.statusBarManager=null);this.q7.qPb();this.f0c=!1;this.Qr.qij(this.A8f);this.Qr.rij(this.WGf);this.$.ea.jx(this.Zka);if(this.ha.ra("SupportsOfficeClientCoauthoring")){var kc=this.$.da.Aa(292);
kc&&kc.chj(this.qDf)}this.Qr.Efj(this.Hpe);this.Qr.aij(this.sTf);this.Qr.nhj(this.Zsf);this.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.LabelHasUDPEnabled",!1)&&this.Qr.Hij(this.cfg);La.EwaSettings.ma(295)&&this.Qr.Igj(this.MOe);this.V$&&(this.V$.dispose(),this.V$=null);zc.prototype.dispose.call(this)};l.prototype.h_c=function(kc,$c){if(!this.ha.ra("SupportsPolicies"))return oa.ULS.sendTraceTag(537154523,306,15,"AutoApplyOrRecommendPolicyLabel - Called when SupportPolicies is disabled."),
!1;if(!this.XGd)return oa.ULS.sendTraceTag(537154522,306,15,"AutoApplyOrRecommendPolicyLabel - PolicyData hasn't been received yet."),!1;if(Ob.a.Qh(kc))return!1;this.V$||this.Iod();return this.V$.h_c(kc,$c)};l.prototype.Xz=function(){this.raiseEvent("LabelInfoChangedKey")};l.prototype.qTh=function(){var kc=this;La.EwaSettings.isChangeGateEnabled("OfficeVSO:6000793_RibbonDisplayedDependencyInDataLossPolicyCall")?Hd.a.get_instance().Qk(10,function(){kc.Qr.Occ()}):this.Qr.Occ()};l.prototype.n3i=function(){var kc=
this;Hd.a.get_instance().Qk(10,function(){kc.Qr.b0b(kc.C0d);kc.Qr.aJg(kc.lCf);kc.Qr.$Ig(kc.lCf);kc.Qr.fYc(kc.A8f);kc.Qr.dse(kc.WGf);kc.$.ea.Yt(kc.Zka);kc.Qr.Gqe(kc.Hpe);kc.Qr.Tre(kc.sTf);kc.Qr.JJg(kc.Zsf);kc.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.LabelHasUDPEnabled",!1)&&kc.Qr.sLg(kc.cfg);if(kc.ha.ra("SupportsOfficeClientCoauthoring")){var $c=kc.$.da.Aa(292);$c&&$c.zJg(kc.qDf)}La.EwaSettings.ma(295)&&(oa.ULS.sendTraceTag(537154521,306,50,"PolicyManagerWrapper: ApplyAutomaticPolicyLabel enabled and registered GetAutoPolicyLabelHandler"),
kc.Qr.YIg(kc.MOe));kc.aFh()});this.$.heb("sensitivity",!0)};l.prototype.aFh=function(){this.ha.ra("SupportsOfficeClientCoauthoring")||this.labelId&&this.labelId.length?this.a5a():this.DOh(this.$.ya.DocumentHostInfo.TenantId)};l.prototype.Iod=function(){this.V$=new n(this.q7,this.Qr,this.$,this.ha,this.ZE)};l.prototype.aSf=function(kc){if(!this.ha.ra("SupportsPolicies"))return oa.ULS.sendTraceTag(537154518,306,10,"PolicyManagerWrapper::RegisterAugmentationLoopAnnotations called when CLP is disabled."),
!1;this.V$||this.Iod();return this.V$.Wbj(kc)};l.prototype.i_c=function(kc,$c){if(La.EwaSettings.isChangeGateEnabled("OfficeVSO:5697254_ApplyPowerBiLabel")){if(!this.ha.ra("SupportsPolicies"))return oa.ULS.sendTraceTag(537154517,306,10,"PolicyManagerWrapper::AutoApplyOrRecommendPowerBILabel called when CLP is disabled."),{returnValue:!1,xNa:!1};if(!this.XGd)return oa.ULS.sendTraceTag(537154516,306,15,"PolicyManagerWrapper::AutoApplyOrRecommendPowerBILabel called before PolicyData fetch is complete."),
{returnValue:!1,xNa:!0};this.V$||this.Iod();return this.V$.i_c(kc,$c)}oa.ULS.sendTraceTag(537154515,306,10,"PolicyManagerWrapper::AutoApplyOrRecommendPowerBILabel called when BRS ApplyPowerBiLabel is disabled.");return{returnValue:!1,xNa:!1}};l.prototype.DOh=function(kc){var $c=this;oa.ULS.sendTraceTag(537154514,306,50,"PolicyManagerWrapper: Doing GetPolicyLabelId web service call with tenantId length {0}",kc.length);var rd=this.$.na.ta.fc();v(this.$.na.ta,kc,function(me){$c.hMj(me)},null,null,null,
rd)};l.prototype.hMj=function(kc){oa.ULS.sendTraceTag(537154513,306,50,"PolicyManagerWrapper: GetPolicyLabelId web service call was successful");kc&&!$d.a(kc)&&(this.XEa=kc.Result);this.a5a();this.labelId?oa.ULS.sendTraceTag(537154512,306,50,"PolicyManagerWrapper: Fetched LabelId length from custom.xml is {0}",this.labelId.length):oa.ULS.sendTraceTag(537154511,306,50,"PolicyManagerWrapper: LabelId is invalid")};l.prototype.a5a=function(){this.Qr.fhd(this.labelId,void 0,void 0,!1)};l.prototype.uVe=
function(){if(!this.f0c){this.$.Cf();this.f0c=!0;this.ZE.p$e();var kc={};kc.hasLabel=!!this.labelId&&0<this.labelId.length;kc.isProtectedFile=this.ha.ra("ProtectedFile");kc.SupportsPolicies=this.ha.ra("SupportsPolicies");kc.AreLabelsAvailableForDisplay=this.Qr.Zha();kc.SupportsOfficeClientCoauthoring=this.ha.ra("SupportsOfficeClientCoauthoring");kc.IsAnonymousUser=this.ha.ra("IsAnonymousUser");oa.ULS.sendTraceTag(51238051,306,50,"CLPUsage : {0}",JSON.stringify(kc))}};l.prototype.COg=function(){this.q7.DOg(this.cza);
this.cza=null};l.prototype.gai=function(kc){kc=Cl(kc.LabelActions);for(var $c=kc.next();!$c.done;$c=kc.next())if(od.a.equals($c.value.Name,"ApplyWatermark",!1))return!0;return!1};l.prototype.CEj=function(kc){kc?(new m(this.$)).pf():oa.ULS.sendTraceTag(537154465,306,50,"PolicyManagerWrapper.showBlockApplyLabelDialogDialog: Watermark Dialog box called with showDialog set to false from autoapply.")};l.prototype.applyPolicyLabel=function(kc,$c,rd,me){var te=this,ge=fb.c(this.Qr.Hn);if(void 0===kc||null===
kc)kc="";var pd=new t;pd.hsc=kc;pd.Z0f=me;pd.zQ=$c;var jc=this.$.na.ta;id.a(this.$.userOperationManager,function(jf,dc,za){dc=kc;var Mb=te.$.ya.DocumentHostInfo.TenantId;jf=ne.b.call(null,te.KLi,jf);var hc=jc.Ma(41,null);hc.labelsInfoJson=ge;hc.appliedLabelId=dc;hc.tenantId=Mb;hc.applyLabelFlag=$c;hc.skipApplyOutcomes=rd;return Hf.i(jc,"ApplyPolicyLabel",hc,jf,null,za,pd,0)},function(jf){return new uc.a(222,0,jf)},null);this.qEc=!1;this.bRd=null};l.prototype.sTa=function(){var kc=this.$.da.Aa(478);
return this.Do&&kc?kc.Do():!1};uk.Object.defineProperties(l.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return this.Zp}},isc:{configurable:!0,enumerable:!0,get:function(){return this.uhe}},linkText:{configurable:!0,enumerable:!0,get:function(){return this.Hga}},yTi:{configurable:!0,enumerable:!0,get:function(){return this.nge}},labelId:{configurable:!0,enumerable:!0,get:function(){return this.XEa}}});Object($b.a)(l,"PolicyManagerWrapper",vd.a,[533,299,852]);var $e=Sc.a;Am(e,$e);
e.prototype.create=function(){var kc=this,$c=Pc.GetServiceTaskFactory.Ua(this.$.da,5,4,this.ub),rd=nb.AFrameworkApplication.Ld,me=nb.AFrameworkApplication.ha;Zd.TaskExtensions.Ba($c,function(){try{var te=new Ge.a(function(){return new C(me,rd,nb.AFrameworkApplication.sa.gE,kc.$.ya.MaxGetPolicyRetries,Ha.a.instance.qc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))}),ge=new Ge.a(function(){return new qa(nb.AFrameworkApplication.Ib,nb.AFrameworkApplication.sa,nb.AFrameworkApplication.ha,
te)}),pd=kc.$.da.Aa(274);pd||(pd=new l(te.value,ge.value,$c.result,kc.$,nb.AFrameworkApplication.ha),pd.initialize());kc.Eb(pd)}catch(jc){throw oa.ULS.sendTraceTag(537154525,306,10,"PolicyManager was not created successfully [Exception: {0}]",jc.toString()),jc;}},this.la,3)};e.ka=function(kc){kc.da.Ha(275,new e(kc))};Object($b.a)(e,"PolicyManagerFactory",Sc.a,[]);var Xe=b(905),pe=b(184);c.prototype.$c=function(){return!1};c.prototype.executeCommand=function(kc,$c,rd){switch($c.command){case Ub.a.setSensitivity:return this.$.workbookContext.FileCoauthorable||
(rd[Aa.YYc]=this.$.workbookContext.ExclusiveLockId),kc=nb.AFrameworkApplication.Ib.Be(Ub.a.setSensitivity,2,rd),gc.Task.Sa(32===kc);case Ub.a.w7:return kc=nb.AFrameworkApplication.Ib.Be(Ub.a.w7,2,rd),gc.Task.Sa(32===kc);case Ub.a.x7:return kc=nb.AFrameworkApplication.Ib.Be(Ub.a.x7,2,rd),gc.Task.Sa(32===kc);default:return pe.a($c.command)}};c.prototype.Mc=function(kc,$c){switch($c.command){case Ub.a.setSensitivity:case Ub.a.w7:case Ub.a.x7:return!0;default:return!1}};c.prototype.nd=function(kc,$c,
rd){switch($c){case "PopulateSensitivityFlyout":return 32===nb.AFrameworkApplication.Ib.Be(Ub.a.oAa,2,rd);default:return!1}};Object($b.a)(c,"SensitivityCommandHandler",null,[434]);var Jf=Xe.a;Am(a,Jf);a.prototype.Qd=function(){this.Jd([new c(this.$)])};a.ka=function(kc){Xe.a.je(316,new a(kc))};Object($b.a)(a,"SensitivityCommandHandlerFactory",Xe.a,[]);Type.registerNamespace("_Ewa");Type.registerNamespace("Common.App.Policy.Contracts");Type.registerNamespace("Common.App.Policy");E.main();(function(){Ud.a.Ga(function(kc){e.ka(kc);
a.ka(kc)})})()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.policy.js.map/0f75c6d89f39f9ebf44365d9367f7dc1/EwaDS.policy.js.map