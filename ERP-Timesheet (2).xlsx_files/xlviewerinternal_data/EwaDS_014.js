(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[7],{1018:function(z,F,b){function a(ia,ba,ra){this.mSb=null;this.rG={};this.cTb=this.Ex=null;n.ULS.sendTraceTag(537159566,0,50,"BorderFormatManager: Request new instance");this.$=ia;this.L7d=a.z8c;this.M7d=a.borderStyleSolidLine;this.Jh=ba;this.Ta=ra;A.EwaSettings.isChangeGateEnabled("OfficeVSO:5680290_AddBorderFormatManagerFactory")||this.$.da.Ha(296,this);this.EV=new c(this.$,this.Jh);this.qD=A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",
!1);n.ULS.sendTraceTag(537159565,0,50,"BorderFormatManager: register BorderFormatManager with ServiceName {0}","296")}function c(ia,ba){var ra=this;this.MHb=this.ribbonCommandInfo=this.cellFormat=this.ms=this.Fb=this.ga=null;this.auc=!1;this.NMf=this.QMa=this.WMf=this.zae=this.uAa=this.Gna=null;this.v2b=this.gva=this.UMf=0;this.borderStyle=this.q0a=this.borderColor=null;this.GB=!1;this.g7b=this.ybb=null;this.c1=function(){if(!ra.GB||J.g(ra.$).Nz)ra.GB=!1,J.g(ra.$).Nz=!1,ra.gva=0,J.g(ra.$).Lg.Np(w.a.v5),
1===ra.$.Ka.QH()&&(J.g(ra.$).kW(E.a.clone(ra.WMf),ra.UMf,ra.$.oa?ra.$.oa.sheetName:null,null,ra.NMf.clone(),null,null,0,P.a.qmh,!0),J.g(ra.$).y1(!0)),ra.Uv(),ra.L_d(),ra.wm(),ra.auc=!1,ra.Gna=null,ra.uAa=null,ra.ms&&(ra.ms.cancel(),ra.ms.dispose()),n.ULS.sendTraceTag(537159516,0,50,"DrawBorderBehavior.ResetBehavior : Ending ResetBehavior ")};this.onPointerDown=function(ka){try{if(ka=ra.se(ka),J.g(ra.$).Nz=!0,ra.Gna={},ra.uAa={},ra.ybb=null,ra.Nqb(ra.v2b),2===ka.zb){var da=J.g(ra.$).ga.Ip(ka.clientPoint,
ka.Mb,5,void 0,void 0,!1);da&&(ra.QMa=da,ra.g7b=da,ra.ocj())}}catch(ha){J.g(ra.$).Nz=!1}return!0};this.Uh=function(ka){try{ka=ra.se(ka);var da=J.g(ra.$).ga.Ip(ka.clientPoint,ka.Mb,5,void 0,void 0,!1),ha=J.g(ra.$).Da.Es(da);if(!ra.MHb||ha&&(ha.XK!==ra.MHb.XK||ha.WK!==ra.MHb.WK))if(ra.GB=!0,ra.MHb=ha,da){var qa=new O.Range(ra.QMa.top,ra.QMa.left,ra.QMa.top,ra.QMa.left,!0,!1);qa.union(da);qa=J.g(ra.$).ga.h0h(qa);ra.z2b(da);ra.PXf(ra.ybb,qa);if(ra.bottomRightCorner(qa.bottom,qa.right))return n.ULS.sendTraceTag(537159515,
0,15,"DrawBorderBehavior.OnPointerMove - Bottom-right corner of sheet reached, cannot expand further."),!1;var Aa=new O.Range(qa.top,qa.left,qa.bottom+1,qa.right+1,!0,!1),Fa=J.g(ra.$).Daa("DrawBorderBehavior.OnPointerMove",[Aa]);if(ra.Gna&&ra.uAa)for(;Fa.$$mn();){var ab=Fa.$$cu(),Ua=ab.cell.getRange().toString();Ua in ra.Gna&&1!==ra.gva||(ra.Gna[Ua]=ab,ra.uAa[Ua]=ab.cell.DN())}ra.ybb=Aa;ra.g7b=qa;J.g(ra.$).kW([qa],0,ra.$.oa.sheetName,null,qa.topLeft,null,null,0,P.a.nmh,!0);ra.Jh.Kea(J.g(ra.$),-1690267012,
ra.cellFormat,!0,null,[qa])}return!0}catch(bb){return J.g(ra.$).Nz=!1}};this.Sf=function(ka){ka=ra.se(ka);(ka=J.g(ra.$).ga.Ip(ka.clientPoint,ka.Mb,5,void 0,void 0,!1))?ra.GB&&(ra.z2b(ka),ra.QMa.union(ka),3===ra.gva?ra.Nqb(0):ra.Nqb(ra.v2b),J.g(ra.$).kW([ra.QMa],0,ra.$.oa.sheetName,null,null,null,null,0,P.a.omh,!0),ra.Jh.formatCells(-1690267012,ra.cellFormat,ra.ribbonCommandInfo)):(3===ra.gva?ra.Nqb(0):ra.Nqb(ra.v2b),J.g(ra.$).kW([ra.g7b],0,ra.$.oa.sheetName,null,null,null,null,0,P.a.pmh,!0),ra.Jh.formatCells(-1690267012,
ra.cellFormat,ra.ribbonCommandInfo));ra.GB=!1;ra.L_d();ra.Gna=null;ra.uAa=null;return!0};this.onKeyDown=function(ka){ka=ra.se(ka);if(ra.GB||Array.contains([17,16,18,20],ka.Ca.keyCode))return!0;ra.c1();return!1};this.onKeyUp=function(ka){ka=ra.se(ka);if(ka.Ca.keyCode===C.a.vM&&ra.GB)return ra.GB=!1,ra.PXf(ra.ybb,ra.g7b,!0),ra.L_d(),!0;if(ra.GB||ka.Ca.keyCode===C.a.X8||ka.Ca.keyCode===C.a.n4d||ka.Ca.keyCode===C.a.m4d||Array.contains([17,16,18,20,37,39,38,40,33,34,9,13],ka.Ca.keyCode)||ka.Ca.keyCode===
C.a.cog||ka.Ca.keyCode===C.a.Zng||ka.Ca.keyCode===C.a.Vng)return!0;ra.c1();return!1};this.z0=function(ka,da){J.g(ra.$).Nz&&!Array.contains(ra.Bci,da.Xd.command)&&(n.ULS.sendTraceTag(537159512,0,50,"DrawBorderBehavior.OnCommandExecutionStarting : Command Triggered : {0} ",da.Xd),ra.c1())};this.$=ia;this.Jh=ba}function e(ia){ia.tSf()}function l(){this.iconName=this.title=this.key=null}function m(ia,ba,ra,ka,da,ha,qa,Aa){this.Cpg=ia;this.Dpg=ba;this.Bpg=ra;this.rQ=ka;this.NAg=da;this.Ywg=ha;this.llb=
qa;this.Uvg=Aa}b.r(F);z=b(0);var n=b(13),h=b(1025),u=b(934),w=b(5),r=b(78),B=b(52),y=b(225),v=b(34),A=b(1),t=b(14);m.$Tg=function(){return new m("BorderStyleSolidLine",1903,1,"1","",1,8,0)};m.WTg=function(){return new m("BorderStyleDashedLine",1904,3,"1","5,3",1,8,0)};m.XTg=function(){return new m("BorderStyleDottedLine",1905,4,"1","1,1",1,8,0)};m.ZTg=function(){return new m("BorderStyleMediumLine",1906,2,"2","",1,8,0)};m.aUg=function(){return new m("BorderStyleThickLine",1907,5,"3","",1,8,0)};m.YTg=
function(){return new m("BorderStyleDoubleLine",1908,6,"1","",2,8,3)};uk.Object.defineProperties(m.prototype,{Txe:{configurable:!0,enumerable:!0,get:function(){return this.Cpg}},t2b:{configurable:!0,enumerable:!0,get:function(){return this.Dpg}},Sxe:{configurable:!0,enumerable:!0,get:function(){return this.Bpg}},width:{configurable:!0,enumerable:!0,get:function(){return this.rQ}},KLj:{configurable:!0,enumerable:!0,get:function(){return this.NAg}},sKi:{configurable:!0,enumerable:!0,get:function(){return this.Ywg}},
lineHeight:{configurable:!0,enumerable:!0,get:function(){return this.llb}},lxi:{configurable:!0,enumerable:!0,get:function(){return this.Uvg}}});Object(z.a)(m,"BorderLineStyleProperties",null,[]);Object(z.a)(l,"BorderLineStyleProps",null,[]);e.prototype.getBorderLineStyleProps=function(){var ia=b(1018).BorderFormatManager.p0a,ba=Array(Object.keys(ia).length),ra=0,ka;for(ka in ia){var da=ka,ha=ia[ka];ba[ra]=new l;ba[ra].key=da;da=ha;ba[ra].title=t.a.instance.fa(da.t2b);ba[ra].iconName=da.Txe;ra++}return ba};
Object(z.a)(e,"BorderMenuController",null,[834]);var E=b(273),C=b(85),H=b(177),U=b(12),Q=b(108),O=b(24),ea=b(46),Z=b(43),S=b(211),I=b(8),P=b(106),J=b(20),aa=b(32);c.prototype.vDg=function(ia){n.ULS.sendTraceTag(537159517,0,50,"DrawBorderBehavior.ActivateBehavior : Starting ActivateBehavior ");this.ga=J.g(this.$).ga;this.Fb=J.g(this.$).Fb;this.ribbonCommandInfo=ia;this.WMf=E.a.clone(this.ga.va.selectedRanges);this.UMf=this.ga.va.CB;this.NMf=this.ga.va.activeCell.clone();this.Fb&&this.Fb.cnd();this.Gv();
this.Ik()};c.prototype.dispose=function(){this.c1();this.MHb=this.ribbonCommandInfo=this.cellFormat=null};c.prototype.Nqb=function(ia){var ba=b(1018).BorderFormatManager;this.cellFormat={};var ra={};this.borderColor=this.borderColor||ba.z8c;var ka=y.a.NH(this.borderColor,!1);ra.Color=[ka,ka,ka,ka];A.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1)&&this.q0a&&(ra.ThemeBorderColor=[this.q0a,this.q0a,this.q0a,this.q0a],ra.ColorTypeOption=1);ka=b(1018).BorderFormatManager.p0a;
this.borderStyle=this.borderStyle||ba.borderStyleSolidLine;ba=ka[this.borderStyle].Sxe;ra.LineStyle=[ba,ba,ba,ba];this.cellFormat.BorderFormat=ra;this.cellFormat.ValidMembers=128;this.cellFormat.Border=ia};c.prototype.Gv=function(){for(var ia=Cl(J.g(this.$).zn),ba=ia.next();!ba.done;ba=ia.next())H.a.instance.qa(U.a.pointerDown,ba.value.domElement,this.onPointerDown);Q.KeyInputManager.instance.qa(U.a.Ub,document.documentElement,this.onKeyDown);Q.KeyInputManager.instance.qa(U.a.Td,document.documentElement,
this.onKeyUp)};c.prototype.ocj=function(){for(var ia=Cl(J.g(this.$).zn),ba=ia.next();!ba.done;ba=ia.next())ba=ba.value,H.a.instance.qa(U.a.ph,ba.domElement,this.Uh),H.a.instance.qa(U.a.$d,ba.domElement,this.Sf);H.a.instance.qa(U.a.$d,document.documentElement,this.Sf);H.a.instance.qa(U.a.Ky,document.documentElement,this.Sf);this.auc=!0};c.prototype.Uv=function(){try{for(var ia=Cl(J.g(this.$).zn),ba=ia.next();!ba.done;ba=ia.next())H.a.instance.za(U.a.pointerDown,ba.value.domElement,this.onPointerDown);
Q.KeyInputManager.instance.za(U.a.Ub,document.documentElement,this.onKeyDown);Q.KeyInputManager.instance.za(U.a.Td,document.documentElement,this.onKeyUp)}catch(ra){J.g(this.$).Nz=!1,n.ULS.sendTraceTag(537159514,0,10,"DrawBorderBehavior.UnregisterHandlers: Unregistering of Handlers failed with Exception {0}",ra)}};c.prototype.L_d=function(){if(this.auc)try{this.auc=!1;for(var ia=Cl(J.g(this.$).zn),ba=ia.next();!ba.done;ba=ia.next()){var ra=ba.value;H.a.instance.za(U.a.ph,ra.domElement,this.Uh);H.a.instance.za(U.a.$d,
ra.domElement,this.Sf)}H.a.instance.za(U.a.$d,document.documentElement,this.Sf);H.a.instance.za(U.a.Ky,document.documentElement,this.Sf)}catch(ka){J.g(this.$).Nz=!1,n.ULS.sendTraceTag(537159513,0,10,"DrawBehavior.UnregisterDrawHandlersForMouse: Unregistering of Handlers failed with Exception {0}",ka)}};c.prototype.Ik=function(){this.$.xa.Nf(this.c1);J.g(this.$).zc.wl(this.c1);J.g(this.$).RE(this.c1);this.$.Ka.HGa(this.z0)};c.prototype.wm=function(){this.$.xa.Ag(this.c1);J.g(this.$).zc.$k(this.c1);
J.g(this.$).wG(this.c1);this.$.Ka.NRa(this.z0)};c.prototype.PXf=function(ia,ba,ra){ra=void 0===ra?!1:ra;if(ia&&this.Gna&&this.uAa)for(ia=J.g(this.$).Daa("DrawBorderBehavior.ApplyBordersOnPreviewCells",[ia]);ia.$$mn();){var ka=ia.$$cu().cell.getRange();if(ra||!ba.contains(ka)||1===this.gva){ka=ka.toString();var da=v.a.Fc(this.Gna,ka);if(da){var ha=v.a.Fc(this.uAa,ka);this.setBorders(da,ha);delete this.Gna[ka];delete this.uAa[ka]}}}};c.prototype.setBorders=function(ia,ba){var ra=ia.cell,ka=ra.getRange();
ra.ruc();ka.right!==this.ybb.right&&(ra=new O.Range(ka.top,ka.left-1,ka.bottom,ka.left-1,!0,!1),J.g(this.$).Da.Es(ra).HRa(3));ka.bottom!==this.ybb.bottom&&(ra=new O.Range(ka.top-1,ka.left,ka.top-1,ka.right,!0,!1),J.g(this.$).Da.Es(ra).HRa(1));if(null===ba||void 0===ba?0:ba.Borders.length){var da={};ra=0;for(var ha=Array(4),qa=Array(4),Aa=0;4>Aa;Aa++)ha[Aa]=1,qa[Aa]=0;ba=Cl(ba.Borders);for(Aa=ba.next();!Aa.done;Aa=ba.next()){Aa=Aa.value;var Fa=Aa.BorderPosition;ha[Fa]=Aa.BorderLineStyle;var ab=new S.a(Aa.Color.Red,
Aa.Color.Green,Aa.Color.Blue);qa[Fa]=ab.jY();ra|=I.HelperMethods.Q4a(Aa.BorderPosition)}da.LineStyle=ha;da.Color=qa;da={BorderFormat:da};da.Border=ra;this.Jh.uxj(ia,da,ka)}};c.prototype.z2b=function(ia){var ba=this,ra=new O.Range(Math.max(1,ia.top-1),Math.max(1,ia.left-1),ia.bottom+1,ia.right+1,!1,!1);J.g(this.$).h6(ra)||this.ms&&this.ms.Ap||(this.ms=ea.a.instance.create(function(){J.g(ba.$).mu(ra,60,P.a.lmh)},40,Z.a.mmh))};c.prototype.bottomRightCorner=function(ia,ba){return 1048576<=ia||16384<=
ba?!0:!1};c.prototype.se=function(ia){return aa.a(this.$).se(ia)};uk.Object.defineProperties(c.prototype,{Bci:{configurable:!0,enumerable:!0,get:function(){return this.zae||(this.zae=[1256700402,-1756763834,-1418159950,-236759591,-2118943501,1981159862,395594266,-1502853784,-111689794,-1059615499,-1027730316,-1104934572,1872288872,2045211913,1504715724,46555851,-70383382,-28797232])}}});Object(z.a)(c,"DrawBorderBehavior",null,[3]);b.d(F,"BorderFormatManager",function(){return a});a.prototype.w9e=
function(ia,ba){n.ULS.sendTraceTag(537159564,0,50,"HandleBorderCommand : Begin handling, Command being executed: {0}",ba.command.toString());var ra={},ka={};var da=y.a.NH(this.m4,!1);ka.Color=[da,da,da,da];this.qD&&this.Bua&&(ka.ThemeBorderColor=[this.Bua,this.Bua,this.Bua,this.Bua],ka.ColorTypeOption=1);ia=-600086683===ba.command?"OutsideBorders":ia[r.a.od];ka.LineStyle=v.a.Fc(a.cMf,ia);ka.LineStyle?n.ULS.sendTraceTag(537159562,0,50,"RibbonCommand.Border is using the BorderFormat information, the predefined borderStyle requested is {0}",
ia):(da=a.p0a[this.QIa].Sxe,ka.LineStyle=[da,da,da,da],n.ULS.sendTraceTag(537159563,0,50,"RibbonCommand.Border is using the BorderFormat information, the custom borderStyle requested is {0}",this.QIa));da=v.a.fo(a.ZSg,ia,0);n.ULS.sendTraceTag(40732555,0,50,"RibbonCommand.Border is using the BorderFormat information, the border type requested is {0}, the border color selected is {1}",ia,this.m4);ra.BorderFormat=ka;4!==da&&8!==da||!this.$.oa.displayRtl||(da=4===da?8:4);ra.ValidMembers=128;ra.Border=
da;this.Jh.formatCells(-1690267012,ra,ba);n.ULS.sendTraceTag(537159561,0,50,"HandleBorderCommand : Successfully handled, Command executed: {0}",ba.command.toString());return!0};a.prototype.wld=function(ia,ba,ra){n.ULS.sendTraceTag(537159560,0,50,"RibbonCommand:{0} is being executed, the previous border color is {1}",ia.toString(),this.m4);if(this.qD){if((ba.SqmControlId||"").includes("ThemeColorPicker")){var ka=this.themesManager.getThemeColor(ba.Color);var da=ka.themeIndex;var ha=ka.pCa;ka.returnValue?
(this.cTb={},this.Bua.ThemeColorIndex=da,this.Bua.ThemeColorRow=ha):this.cTb=null}else this.cTb=null;this.EV.q0a=this.Bua}this.L7d=-1803452024===ia?a.z8c:ba.Color;this.EV.borderColor=this.m4;this.OOe(ra);this.$.Cf();n.ULS.sendTraceTag(40944211,0,50,"RibbonCommand:{0} is being executed, the updated border color is {1}",ia.toString(),this.m4);return!0};a.prototype.b9h=function(ia){n.ULS.sendTraceTag(537159559,0,50,"RibbonPopulateCommand.PopulateBorderStyle command Invoked");var ba=this.Ta.iq(),ra=this.Ta.Oc();
ba.Dc.push(ra);var ka=this.Ta.oB("StyleDashGallery",1,"Size120by20");ra.buttons.push(ka);ra=a.p0a;for(var da in ra){var ha=da,qa=ra[da],Aa=t.a.instance.fa(qa.t2b);ka.Xt(ha,-2118943501,"QueryBorderStyle",qa.t2b,ha,ha,void 0,void 0,Aa)}n.ULS.sendTraceTag(537159557,0,50,"RibbonPopulateCommand, Invoke BuildMenuProps");ia.MenuItems=ba.BC();n.ULS.sendTraceTag(537159556,0,50,"RibbonPopulateCommand handled")};a.prototype.G7h=function(ia,ba){n.ULS.sendTraceTag(537159555,0,50,"RibbonCommand.BorderStyle: Begin handling, Current Border Style is {0}",
this.QIa);ia=ia[r.a.od];if(a.yti(ia))this.M7d=ia,n.ULS.sendTraceTag(537159554,0,50,"RibbonCommand.BorderStyle: Updated Border Style is {0}",this.QIa);else return n.ULS.sendTraceTag(537159553,0,15,"RibbonCommand.BorderStyle: Invalid Border Style encountered, Requested Border Style : {0}",ia),!0;this.EV.borderStyle=this.QIa;this.OOe(ba);this.$.Cf();n.ULS.sendTraceTag(40944220,0,50,"RibbonCommand.BorderStyle: Successfully handled Current Border Style is {0}",this.QIa);return!0};a.prototype.Bld=function(ia){n.ULS.sendTraceTag(537159552,
0,50,"HandleDrawBorderCommand : Begin handling, Command being executed: {0}",ia.command.toString());this.dWc(ia,64,this.m4,86,1);return!0};a.prototype.Cld=function(ia){n.ULS.sendTraceTag(537159523,0,50,"HandleDrawBorderGridCommand : Begin handling, Command being executed: {0}",ia.command.toString());this.dWc(ia,112,this.m4,87,2);return!0};a.prototype.J9e=function(ia){n.ULS.sendTraceTag(537159522,0,50,"HandleEraseBorderCommand : Begin handling, Command being executed: {0}",ia.command.toString());this.dWc(ia,
112,"white",88,3);return!0};a.prototype.e9h=function(ia){this.dwj(this.$Sg,ia,ia.MenuItemId?ia.MenuItemId:a.borderStyleSolidLine)};a.prototype.dwj=function(ia,ba,ra){ra in ia?(ia=ia[ra],n.ULS.sendTraceTag(537159521,0,50,"HandleQueryBorderStyleCommand:SetIcon command {0}",ra),this.fwj(ba,ia)):n.ULS.sendTraceTag(537159520,0,15,"HandleQueryBorderStyleCommand: cannot find dashes '{0}' in BorderLineStyleButtons dictionary",ra)};a.prototype.p9h=function(ia,ba){var ra=ia[r.a.od];return"DrawBorder"===ra?
this.Bld(ba):"DrawBorderGrid"===ra?this.Cld(ba):"EraseBorder"===ra?this.J9e(ba):this.w9e(ia,ba)};a.prototype.tSf=function(){this.mSb||this.bUg()};a.prototype.sPh=function(){return new e(this)};a.prototype.bUg=function(){this.mSb={};var ia=0,ba=a.p0a,ra={},ka;for(ka in ba){ra.Dfa=ba[ka];var da=ra.Dfa.Txe;t.a.instance.fa(ra.Dfa.t2b);var ha=function(qa){return function(){return appChrome.buildBorderStyleIconNew(qa.Dfa.KLj,qa.Dfa.width,qa.Dfa.sKi,qa.Dfa.lineHeight,qa.Dfa.lxi)}}(ra);this.mSb[da]=da;this.mcb(da,
ha);ia++;ra={Dfa:ra.Dfa}}};a.prototype.mcb=function(ia,ba){if(!(ia in this.rG)){var ra={};ba=ba();ra[ia]=ba;appChrome.api.registerIconProvider(function(){return ra});this.rG[ia]=!0}return ia};a.prototype.fwj=function(ia,ba){ia.MenuItemId&&(ia[h.a.On]=ia.MenuItemId===this.QIa,ia[u.a.Icon]=ba)};a.prototype.dWc=function(ia,ba,ra,ka,da){n.ULS.sendTraceTag(537159519,0,50,"BorderFormatManager.ActivateDrawBorderBehavior : Starting ActivateDrawBorderBehavior ");this.Z_g(ia,da)?(n.ULS.sendTraceTag(537159518,
0,50,"BorderFormatManager.CheckDrawBorderBehaviorTriggered : Toggled Ribbon menu button "),this.EV.c1()):(J.g(this.$).Nz&&this.EV.c1(),B.a.current&&(ka=String.format(w.a.Gua,B.a.current.Bo(ka)),J.g(this.$).Lg.Np(ka)),this.EV.v2b=ba,this.EV.borderColor=ra,J.g(this.$).Nz=!0,this.EV.vDg(ia),this.EV.gva=da)};a.prototype.OOe=function(ia){if(ia)switch(this.EV.gva){case 2:this.Cld(ia);break;default:this.Bld(ia)}};a.prototype.Z_g=function(ia,ba){return this.EV.gva===ba&&-236759591!==ia.command&&-2118943501!==
ia.command?!0:!1};a.yti=function(ia){return ia?ia in a.cMf||ia in a.p0a:!1};uk.Object.defineProperties(a.prototype,{QIa:{configurable:!0,enumerable:!0,get:function(){return this.M7d}},m4:{configurable:!0,enumerable:!0,get:function(){return this.L7d}},Bua:{configurable:!0,enumerable:!0,get:function(){return this.cTb}},themesManager:{configurable:!0,enumerable:!0,get:function(){this.Ex||(this.Ex=this.$.da.Aa(422));return this.Ex}},$Sg:{configurable:!0,enumerable:!0,get:function(){this.tSf();return this.mSb}}});
uk.Object.defineProperties(a,{p0a:{configurable:!0,enumerable:!0,get:function(){var ia={};return a.P5d||(a.P5d=(ia.BorderStyleSolidLine=m.$Tg(),ia.BorderStyleDashedLine=m.WTg(),ia.BorderStyleDottedLine=m.XTg(),ia.BorderStyleMediumLine=m.ZTg(),ia.BorderStyleThickLine=m.aUg(),ia.BorderStyleDoubleLine=m.YTg(),ia))}},ZSg:{configurable:!0,enumerable:!0,get:function(){var ia={};return a.O5d||(a.O5d=(ia.NoBorder=0,ia.BottomBorder=1,ia.TopBorder=2,ia.LeftBorder=4,ia.RightBorder=8,ia.OutsideBorders=64,ia.AllBorders=
112,ia.ThickOutsideBorders=64,ia.InsideBorders=48,ia.InsideHorizontalBorders=16,ia.InsideVerticalBorders=32,ia.BottomDoubleBorder=1,ia.ThickBottomBorder=1,ia.TopBottomBorder=3,ia.TopThickBottomBorder=3,ia.TopDoubleBottomBorder=3,ia))}},cMf:{configurable:!0,enumerable:!0,get:function(){var ia={};return a.zhe||(a.zhe=(ia.ThickOutsideBorders=[2,2,2,2],ia.BottomDoubleBorder=[1,6,1,1],ia.ThickBottomBorder=[1,2,1,1],ia.TopBottomBorder=a.Hgh,ia.TopThickBottomBorder=[1,2,1,1],ia.TopDoubleBottomBorder=[1,
6,1,1],ia))}}});a.O5d=null;a.P5d=null;a.zhe=null;a.z8c="black";a.borderStyleSolidLine="BorderStyleSolidLine";a.Hgh=[1,1,1,1];Object(z.a)(a,"BorderFormatManager",null,[750])},1050:function(z,F,b){function a(E,C,H){window.performance.measure(E,C,H);C=window.performance.getEntriesByName(E);C.length||w.ULS.sendTraceTag(537167063,0,10,"ContextMenuHelper.MeasureTime: measure name [{0}] returned no measures.",E);return C[C.length-1]?C[C.length-1].duration:-1}function c(){if(r.a.Kqb){var E=a("OnContextMenuHandling",
"ContextMenuPerf.A","ContextMenuPerf.B"),C=a("PrepInfraWork","ContextMenuPerf.B","ContextMenuPerf.C1"),H=a("EWAPopulation","ContextMenuPerf.C2","ContextMenuPerf.D");w.ULS.sendTraceTag(537167064,0,50,"ContextMenuHelper.ReportPerformanceIfSupported: OnContextMenuHandling=[{0}], PrepInfraWork=[{1}], EWAPopulation =[{2}]",E,C,H)}}function e(E,C){A.HelperMethods.o0c&&window.performance.mark(C)}function l(E){E=t.g(E).ga.va;return E.Wg&&(E.xd.isRow||E.xd.Xf)}function m(E){return E.Tb.Qla(E.ga.va.activeCell)}
function n(E,C,H,U,Q){E=U.Pk("ContextMenuHelper.FindFirstCellInViewportArea",E,C,H);try{for(E.$$rst();E.$$mn();){var O=E.$$cu();if(O&&h(O,U,Q))return O.cell}}finally{E&&E.dispose()}return null}function h(E,C,H){var U=C.rtl,Q=H.isChromeRtl;E=E.cell;return(H=t.g(H).BK(E))?(H=H.topLeft,U=H.x+=U===Q?E.offsetWidth:0,Q=H.y+=E.offsetHeight,C.view.visibleArea.contains(new y.a(U,Q,0,0))):!1}function u(E,C){var H=E.rc(null);if((null===H||void 0===H?0:H.cell.Vj)&&h(H,E,C))return E.getCellBounds(H.cell);H=E.ga.va.activeCell;
return(C=n(new v.Range(H.top,H.left,B.a.Sh,H.left,!1,!1),2,!0,E,C)||n(new v.Range(1,H.left,H.top,H.left,!1,!1),2,!1,E,C)||n(new v.Range(H.top,H.right,H.top,B.a.di,!1,!1),1,!0,E,C)||n(new v.Range(H.top,1,H.top,H.right,!1,!1),1,!1,E,C)||null)&&C.Vj?E.getCellBounds(C):Sys.UI.DomElement.getBounds(E.w6a.Kb)}b.d(F,"i",function(){return"ContextMenuPerf.A"});b.d(F,"b",function(){return"ContextMenuPerf.B"});b.d(F,"d",function(){return"ContextMenuPerf.C1"});b.d(F,"a",function(){return"ContextMenuPerf.C2"});
b.d(F,"c",function(){return"ContextMenuPerf.D"});b.d(F,"e",function(){return u});b.d(F,"f",function(){return m});b.d(F,"g",function(){return l});b.d(F,"h",function(){return e});b.d(F,"j",function(){return c});var w=b(13),r=b(332),B=b(9),y=b(59),v=b(24),A=b(8),t=b(20)},1051:function(z,F,b){function a(){}b.d(F,"a",function(){return a});z=b(0);a.edit="Edit";a.clipboard="Clipboard";a.copy="Copy";a.color="Color";a.YQg="AutoFill";a.foj="RowOperations";a.p3g="ColumnOperations";a.J0j="ViewModeRowOperations";
a.I0j="ViewModeColumnOperations";a.hyperlink="Hyperlink";a.openHyperlink="OpenHyperlink";a.nAj="ShapeStyle";a.mIh="FloatingObjectClipboard";a.eLf="PivotTableCopyDelete";a.gLf="PivotTableFieldListActions";a.aBe="CellFloatie";a.jAj="ShapeFloatie";a.contextMenu="ContextMenu";a.R6h="GridContextMenu";a.R2i="PivotTableContextMenu";a.nIh="FloatingObjectContextMenu";a.b_g="CellRTEFloatie";a.i5f="ShapeRTEFloatie";Object(z.a)(a,"FloatieGroupIdentifiers",null,[])},1052:function(z,F,b){function a(B,y,v){var A=
r.call(this,y)||this;A.pS=!1;A.Qlc=!1;A.NOa=null;A._selectedRowListBox=null;A.Un=null;A.eDf=function(t){return A.Bpc(t)};A.WDd=function(t){u.g(t.Ca);A.raiseEvent(a.T5a);A.raiseEvent(a.wRd);return!0};A.onScroll=function(t){u.g(t);A.tJd();A.raiseEvent(a.T5a)};A.onBlur=function(t){u.g(t);A.tJd()};A.onPointerDown=function(){A.tJd();A.raiseEvent(a.T5a);A.raiseEvent(a.OQa);return!1};A.LFb=function(t){var E=t.Ca;if(E.button===Sys.UI.MouseButton.leftButton||E.button===Sys.UI.MouseButton.rightButton||n.EwaSettings.isChangeGateEnabled("OfficeVSO:6154487_EnableTouchInputInDVDropDown")&&
E.type.includes("touch"))A.al=A.rcc(E),A.onPointerDown(t);A.raiseEvent(a.Xud);return!1};A.wb=B;A.cDb=v;A.cCa(!0);return A}b.d(F,"a",function(){return a});z=b(0);var c=b(89),e=b(226),l=b(12),m=b(177);F=b(240);var n=b(1),h=b(11),u=b(71),w=b(20),r=F.a;Am(a,r);a.prototype.B$=function(B){this.get_events().addHandler(a.T5a,B)};a.prototype.bea=function(B){this.get_events().removeHandler(a.T5a,B)};a.prototype.Z_b=function(B){this.get_events().addHandler(a.Xnd,B)};a.prototype.Zuc=function(B){this.get_events().removeHandler(a.Xnd,
B)};a.prototype.qpb=function(B){this.get_events().addHandler(a.wRd,B)};a.prototype.xJb=function(B){this.get_events().removeHandler(a.wRd,B)};a.prototype.h_a=function(B){this.get_events().addHandler(a.OQa,B)};a.prototype.Icb=function(B){this.get_events().removeHandler(a.OQa,B)};a.prototype.LXc=function(B){this.get_events().addHandler(a.Xud,B)};a.prototype.xMd=function(B){this.get_events().removeHandler(a.Xud,B)};a.prototype.dispose=function(){this.y8(!1);this.cCa(!1);c.a.tc([this.NOa]);this.NOa=null;
r.prototype.dispose.call(this)};a.prototype.rcc=function(B){return h.DOMElementExtensions.zhd(B.target,"tr",!0)};a.prototype.MB=function(B){if(B){if(!this.al){var y=this.Un;if(!y||!y.rows.length)return;this.al=y.rows[0];0<B?B--:B++}y=this.al;for(var v=0,A=Math.abs(B);v<A;v++)if(0>B){if(!y.previousSibling)break;y=y.previousSibling}else{if(!y.nextSibling)break;y=y.nextSibling}y&&(this.al=y)}};a.prototype.Vob=function(B,y){h.DOMElementExtensions.toggleCssClass(B,this.cDb.ListTableClassInTouch,y)};a.prototype.y8=
function(B){var y=this.Un;y&&(B&&!this.Qlc?(e.a.instance.qa(l.a.click,y,this.eDf),e.a.instance.qa(l.a.qk,y,this.WDd),m.a.instance.qa(l.a.pointerDown,y,this.LFb),this.Qlc=!0):this.Qlc&&(e.a.instance.za(l.a.click,y,this.eDf),e.a.instance.za(l.a.qk,y,this.WDd),m.a.instance.za(l.a.pointerDown,y,this.LFb),this.Qlc=!1))};a.prototype.vCa=function(B){var y=null;B&&(y=h.DOMElementExtensions.Ij(B,this.cDb.ListCellClass))&&y.classList.toggle(this.cDb.ListCellSelectedClass);return y};a.prototype.cCa=function(B){this.pg&&
(B&&!this.pS?(this.NOa=this.Rd.Gd(this.pg),this.NOa.ka("scroll",this.onScroll),this.NOa.ka("blur",this.onBlur),m.a.instance.qa(l.a.pointerDown,this.domElement,this.onPointerDown),this.pS=!0):this.pS&&(c.a.Fa(this.NOa),this.NOa=null,m.a.instance.za(l.a.pointerDown,this.domElement,this.onPointerDown),this.pS=!1))};a.prototype.Bpc=function(B){return this.WDd(B)};a.prototype.$wc=function(B){if(B){var y=B.offsetTop,v=this.pg.scrollTop;y<v?this.I_f(!0):y+B.offsetHeight>v+this.pg.clientHeight&&this.I_f(!1)}};
a.prototype.I_f=function(B){this.pg.scrollTop=B?this.al.offsetTop:this.al.offsetTop+this.al.offsetHeight-this.pg.clientHeight};a.prototype.tJd=function(){w.g(this.$).isEditing&&this.raiseEvent(a.Xnd)};uk.Object.defineProperties(a.prototype,{al:{configurable:!0,enumerable:!0,get:function(){return this._selectedRowListBox},set:function(B){this.vCa(this._selectedRowListBox);B?(this._selectedRowListBox=B,this.vCa(this._selectedRowListBox),this.$wc(B)):this._selectedRowListBox=null}},f0:{configurable:!0,
enumerable:!0,get:function(){return this.cDb.ListCellClass}},Kca:{configurable:!0,enumerable:!0,get:function(){return this.cDb.ListTableClass}},xI:{configurable:!0,enumerable:!0,get:function(){return 8}},TDb:{configurable:!0,enumerable:!0,get:function(){return 5}},Olc:{configurable:!0,enumerable:!0,get:function(){return 24}},Nlc:{configurable:!0,enumerable:!0,get:function(){return 35}},pg:{configurable:!0,enumerable:!0,get:function(){return this.domElement}},$:{configurable:!0,enumerable:!0,get:function(){return this.wb}}});
a.T5a="GotFocus";a.Xnd="IgnoreBlur";a.wRd="SetCell";a.OQa="PointerDown";a.Xud="ItemPointerDown";Object(z.a)(a,"ListBox",F.a,[802,3])},1118:function(z,F,b){function a(h,u){var w=n.call(this,u.textBox.domElement)||this;w.k_c=null;w.ULi=function(){w.uCd()};w.UAf=function(r,B){w.Rg(r,B)};w.$Af=function(r,B){w.mj(r,B)};w.wb=h;w.CJ=u;u.vZ&&(u.vZ.add(w),u.wl(w.$Af),u.Wo(w.UAf));return w}b.d(F,"a",function(){return a});z=b(0);var c=b(89);F=b(87);var e=b(46),l=b(43),m=b(71),n=F.a;Am(a,n);a.prototype.dispose=
function(){var h=this.CJ;if(null===h||void 0===h?0:h.vZ)h.vZ.remove(this),h.$k(this.$Af),h.Zn(this.UAf);c.a.Fa(this.k_c);this.CJ=null;n.prototype.dispose.call(this)};a.prototype.Yh=function(h,u){switch(u){case -1470715894:case -1231471547:this.fV(!1);break;default:if(this.YId(h,u))return m.g(h),!0;a.opi(u)||this.fV(!1)}return!1};a.prototype.fV=function(){c.a.Fa(this.k_c);this.k_c=e.a.instance.create(this.ULi,10,l.a.sxi)};a.prototype.mj=function(){this.fV(!1)};a.opi=function(h){switch(h){case 137938150:case -798660877:case 742457698:case 2091832999:return!0}return!1};
uk.Object.defineProperties(a.prototype,{$:{configurable:!0,enumerable:!0,get:function(){return this.wb}},Za:{configurable:!0,enumerable:!0,get:function(){return this.CJ}}});Object(z.a)(a,"ListAutoCompleteBehavior",F.a,[801,3])},1258:function(z,F,b){function a(r){var B=w.call(this,document.createElement("div"))||this;B.vJa=!1;B.wJa=!1;B.uJa=!1;B.sJa=!1;B.tJa=!1;B.pS=!1;B.CJ=null;B.spc=function(y,v){B.Gt(y,v)};B.GMa=function(){B.Za.textBox.VK=!0};B.Qza=function(){B.oz(!0)};B.yyf=function(){B.Za.textBox.focus()};
B.Th=function(){n.g(B.$).inRangePicker||(B.isListVisible=!1)};B.$=r;n.g(r)&&n.g(r).ga&&n.g(B.$).ga.XJ(B.Th);B.dca=e.a.WN(r)&&l.EwaSettings.isChangeGateEnabled("OfficeVSO:5609548_AddAutocompleteCardInteractionTelemetry");return B}b.d(F,"a",function(){return a});z=b(0);F=b(240);var c=b(5),e=b(39),l=b(1),m=b(8),n=b(20),h=b(32),u=b(4),w=F.a;Am(a,w);a.prototype.Gt=function(){this.JCa(!1);this.au.Gt()};a.prototype.dispose=function(){this.$&&n.g(this.$)&&n.g(this.$).ga&&n.g(this.$).ga.VO(this.Th);this.$=
null;w.prototype.dispose.call(this)};a.prototype.Yh=function(r,B,y){r=!1;if((this.k2a||(void 0===y?0:y))&&!this.$xa()&&this.get_visible()&&this.isListVisible)switch(this.dca&&this.BDc(B),B){case 1872288872:this.isListVisible=!1;r=!0;break;case -798660877:this.au.MB(1);r=!0;break;case 137938150:this.au.MB(-1);r=!0;break;case 2091832999:this.au.MB(this.xI-1);r=!0;break;case 742457698:this.au.MB(-(this.xI-1));r=!0;break;case 125627505:r=this.oz(!1);break;case 267796030:e.a.WN(this.$)&&(r=this.oz(!1))}return r};
a.prototype.JCa=function(r){if(this.isListVisible||r){var B=n.g(this.$);r=B.domElement;var y=this.CJ.textBox.domElement,v=h.a(this.$).Mi(y.offsetHeight),A=h.a(this.$).Mi(y.offsetTop),t=h.a(this.$).Mi(y.offsetWidth);y=h.a(this.$).Mi(y.offsetLeft);B=B.yj;var E=u.AFrameworkApplication.sa&&u.AFrameworkApplication.sa.Qa.eh,C=$get(this.$.Lb+c.a.n1a,this.$.domElement);E&&(C=document.getElementById("EditorContainer"));var H=new Sys.UI.Point(B?this.au.ybc:0,B?this.$Jh:a.m7h);v=C.offsetTop+H.y+(e.a.aO(this.$)&&
B?0:v+A);this.$.hca||(A=$get(c.a.kHa,this.$.domElement),v+=A&&!E?A.offsetHeight:0);A=this.domElement;A.style.top=m.HelperMethods.Yb(v);y=C.offsetLeft+y+H.x;!e.a.aO(this.$)&&this.$.isChromeRtl?A.style.right=m.HelperMethods.Yb(B?this.au.ybc:r.offsetLeft+r.offsetWidth-y-t):A.style.left=m.HelperMethods.Yb(y)}};a.prototype.gUa=function(r){this.au&&(r&&!this.pS?(this.au.B$(this.yyf),this.au.Z_b(this.GMa),this.au.qpb(this.Qza),this.pS=!0):this.pS&&(this.au.bea(this.yyf),this.au.Zuc(this.GMa),this.au.xJb(this.Qza),
this.pS=!1))};a.prototype.BDc=function(r){switch(r){case -798660877:case 137938150:case 2091832999:case 742457698:this.vJa=!0;break;case 125627505:this.uJa=!0;break;case 267796030:e.a.WN(this.$)&&(this.sJa=!0)}};uk.Object.defineProperties(a.prototype,{xI:{configurable:!0,enumerable:!0,get:function(){return this.au.xI}},isListVisible:{configurable:!0,enumerable:!0,get:function(){return this.au.isListVisible},set:function(r){this.au.isListVisible=r}},Za:{configurable:!0,enumerable:!0,get:function(){return this.CJ},
set:function(r){(this.CJ=r)&&this.CJ.s2d.add(this)}},$Jh:{configurable:!0,enumerable:!0,get:function(){return e.a.aO(this.$)?-5:-40}}});a.ybc=0;a.m7h=1;Object(z.a)(a,"AutoCompleteControl",F.a,[747])},1259:function(z,F,b){function a(e,l,m,n){l=void 0===l?0:l;m=void 0===m?"":m;n=void 0===n?"":n;var h=c.call(this)||this;h.length=e;h.selectedIndex=l;h.aJ=m;h.description=n;return h}b.d(F,"a",function(){return a});z=b(0);var c=Sys.EventArgs;Am(a,c);Object(z.a)(a,"ListEventArgs",Sys.EventArgs,[])},1260:function(z,
F,b){function a(A,t){A=v.call(this,A,t,new y.a(l.a.listItem,l.a.dDb,l.a.iDb,l.a.jDb))||this;A.Tec=!1;A.Cs=null;A.inb=null;A.nZe=!1;A.cCa(!0);A.nZe=w.EwaSettings.isChangeGateEnabled("OfficeVSO:5893822_FixFormulaBarXOffsetCrash");return A}b.d(F,"a",function(){return a});z=b(0);var c=b(13),e=b(23);F=b(1052);var l=b(984),m=b(5),n=b(78),h=b(39),u=b(11),w=b(1),r=b(114),B=b(20),y=b(1117),v=F.a;Am(a,v);a.prototype.jza=function(){var A=460,t=B.g(this.$),E=t.domElement,C=this.GUa.style,H=this.pg.offsetTop+
this.al.offsetHeight*this.al.sectionRowIndex-this.pg.scrollTop;C.width="auto";C.whiteSpace="nowrap";C.position=e.a.Oic?"relative":"absolute";var U=E.offsetLeft+E.offsetWidth-(this.domElement.offsetLeft+this.pg.offsetLeft+this.pg.offsetWidth+3);E=this.domElement.offsetLeft-3-(E.offsetLeft+this.ybc);A=Math.min(this.GUa.offsetWidth,A,Math.max(U,E));u.DOMElementExtensions.nr(this.GUa,A);C.whiteSpace="";C.position="absolute";H+3>this.pg.offsetTop+this.pg.offsetHeight||H<this.pg.offsetTop||(A=this.pg.offsetLeft-
3-this.GUa.offsetWidth,C=this.pg.offsetLeft+this.pg.offsetWidth+3,u.DOMElementExtensions.updatePosition(this.GUa,E>U!==t.rtl?A:C,H,!1))};a.prototype.MB=function(A){v.prototype.MB.call(this,A);this.jza()};a.prototype.Gt=function(){this.jza()};a.prototype.ata=function(){var A=this.Un,t=this.pg,E=3===n.a.$b||e.a.zp,C=E?this.TDb:this.xI;this.isListVisible=!0;t.style.height="auto";this.vHa.set_visible(!0);this.Vob(A,E);this.Cs.length>C?(u.DOMElementExtensions.UG(t,Math.floor(t.offsetHeight*C/this.Cs.length)),
t.style.overflowY="auto"):(t.style.height="auto",t.style.overflowY="hidden");u.DOMElementExtensions.nr(t,A.offsetWidth+(this.Cs.length>C?r.a.Mp:0))};uk.Object.defineProperties(a.prototype,{ybc:{configurable:!0,enumerable:!0,get:function(){if(h.a.aO(this.$)){var A=document.getElementById(this.$.Lb+m.a.mZe);return!this.nZe||A?u.DOMElementExtensions.getBoundingClientRect(A).x:0}A=w.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddNamedRange",!1)?document.getElementById(m.a.pAd):document.getElementById(this.$.Lb+
m.a.pAd+"-"+m.a.mvf);c.ULS.shipAssertTag(537170323,0,!!A||this.$.bO,"AutoCompleteListBox.FormulaBarXOffset : Can't find the name box combobox element.");return A?A.offsetWidth:0}},ve:{configurable:!0,enumerable:!0,get:function(){return this.inb},set:function(A){this.inb=A}},isListVisible:{configurable:!0,enumerable:!0,get:function(){return u.DOMElementExtensions.isVisible(this.pg)&&0<this.Cs.length},set:function(A){u.DOMElementExtensions.setVisible(this.pg,A);u.DOMElementExtensions.setVisible(this.GUa,
A);var t=B.g(this.$).view;A?this.Tec||(t.nt(this.vHa.spc),this.Tec=!0):(Array.clear(this.Cs),this.Tec&&(t.fr(this.vHa.spc),this.Tec=!1))}}});Object(z.a)(a,"AutoCompleteListBox",F.a,[])},1309:function(z,F,b){function a(Hc,Nb,nc,Ha){var tb=Cc.call(this,Hc,"PopulateGridContextMenu",1247109494,-2064931494,a.$6h,!0,!1,a.nKb,Nb,nc,!0,Ha)||this;tb.QBa=!1;tb.jxa=!1;tb.g_=!1;tb.refresh=!1;tb.expandCollapse=!1;tb.skc=!1;tb.VHe=!0;tb.grid=bb.g(Hc);tb.fnc=!0;tb.Whc=ab.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.GridContextMenuFilterByValue",
!1);if(tb.Whc){var Ub=$b.GetServiceTaskFactory.Ua(tb.$.da,309,310,3),gc=$b.GetServiceTaskFactory.create(tb.$.da,18,tb.la,3);qa.TaskExtensions.Ba(qa.TaskExtensions.we([Ub,gc],tb.la),function(){tb.$.da.Ya(268,function(Eb){tb.W5a=new c(Hc,Ub.result,gc.result,Eb)})},tb.la,3)}return tb}function c(Hc,Nb,nc,Ha){this.kZc=this.Tfb=this.Vfb=0;this.$=Hc;this.gridView=bb.g(this.$);this.namedSheetViewPublic=Nb;this.Jh=nc;this.instantaneousSupportInformationManager=Ha;this.UNa=Ta.a.gqd()}function e(Hc){this.ranges=
null;this.ranges=Hc}function l(Hc,Nb,nc,Ha,tb,Ub,gc,Eb){this.$=Nb;this.Ta=nc;this.tm=Ha;this.selectedRanges=tb;this.grid=Ub;this.XB=Eb;this.$ba=gc;this.fta=w.a.all(tb,function(Tb){return Tb.isRow});this.eta=w.a.all(tb,function(Tb){return Tb.Xf});this.HEb=w.a.all(tb,function(Tb){return!Tb.isRow&&!Tb.Xf});Nb=Ub.Tb.pkd(tb);this.u6b=!!Nb;this.RVf=!!Nb&&Nb.hasActiveFilter;this.menuSection=nc.Oc();Array.add(Hc.Dc,this.menuSection);this.sla=this.fta||this.eta?this.menuSection:nc.Oc();this.Pua=this.fta||
this.eta?this.menuSection:nc.Oc()}b.r(F);z=b(0);var m=b(13),n=b(284),h=b(92),u=b(37),w=b(273),r=b(609),B=b(4),y=b(81),v=b(437),A=b(928),t=b(9),E=b(30),C=b(17),H=b(59),U=b(5),Q=b(1001),O=b(1240),ea=b(1051),Z=b(14);l.prototype.Afd=function(){this.XLh();this.CLh();var Hc=this.XB.v8a(this.selectedRanges,this.grid);Array.add(this.menuSection.buttons,this.Ta.Cb(Hc?149:148))};l.prototype.bMh=function(){var Hc=0;this.u6b?this.$ba.Tn(942362098)?Hc=this.XB.Tn(this.tm,942362098,this.selectedRanges,this.grid)?
161:169:this.RVf&&(Hc=this.XB.Tn(this.tm,-1113896058,this.selectedRanges,this.grid)?177:181):this.$ba.Tn(-1113896058)&&(Hc=this.fta?this.XB.Tn(this.tm,-1113896058,this.selectedRanges,this.grid)?49:116:this.XB.Tn(this.tm,-1113896058,this.selectedRanges,this.grid)?177:181);0!==Hc&&Array.add(this.sla.buttons,this.Ta.Cb(Hc))};l.prototype.YLh=function(){var Hc=0;this.u6b?this.$ba.Tn(622604322)&&(Hc=this.grid.rtl?this.XB.Tn(this.tm,622604322,this.selectedRanges,this.grid)?191:192:this.XB.Tn(this.tm,622604322,
this.selectedRanges,this.grid)?162:170):this.$ba.Tn(1415868706)&&(Hc=this.eta?this.XB.Tn(this.tm,1415868706,this.selectedRanges,this.grid)?50:117:this.XB.Tn(this.tm,1415868706,this.selectedRanges,this.grid)?178:182);0!==Hc&&Array.add(this.sla.buttons,this.Ta.Cb(Hc))};l.prototype.WLh=function(){this.$ba.Tn(1035996630)&&(this.XB.Tn(this.tm,1035996630,this.selectedRanges,this.grid)?(Array.add(this.sla.buttons,this.Ta.Cb(this.grid.rtl?187:165)),Array.add(this.sla.buttons,this.Ta.Cb(166))):(Array.add(this.sla.buttons,
this.Ta.Cb(this.grid.rtl?188:173)),Array.add(this.sla.buttons,this.Ta.Cb(174))))};l.prototype.XLh=function(){var Hc=b(1309).GridContextMenu,Nb=null;this.HEb&&(Nb=this.Ta.yw("ContextMenu.InsertCells",null,Z.a.instance.fa(346),1896159024),Array.add(Nb.menu.Dc,this.sla));Hc.ZLh(this.sla,this.Ta,this.$);this.bMh();this.YLh();this.WLh();Nb&&0<this.sla.buttons.length&&Array.add(this.menuSection.buttons,Nb)};l.prototype.ELh=function(){var Hc=0;this.u6b?this.$ba.Tn(1405456548)?Hc=this.XB.Tn(this.tm,1405456548,
this.selectedRanges,this.grid)?163:171:this.RVf&&(Hc=this.XB.Tn(this.tm,1554436520,this.selectedRanges,this.grid)?179:183):this.$ba.Tn(1554436520)&&(Hc=this.fta?this.XB.Tn(this.tm,1554436520,this.selectedRanges,this.grid)?51:118:this.XB.Tn(this.tm,1554436520,this.selectedRanges,this.grid)?179:183);0!==Hc&&Array.add(this.Pua.buttons,this.Ta.Cb(Hc))};l.prototype.DLh=function(){var Hc=0;this.u6b?this.$ba.Tn(284490184)&&(Hc=this.XB.Tn(this.tm,284490184,this.selectedRanges,this.grid)?164:172):this.$ba.Tn(674605324)&&
(Hc=this.eta?this.XB.Tn(this.tm,674605324,this.selectedRanges,this.grid)?52:119:this.XB.Tn(this.tm,674605324,this.selectedRanges,this.grid)?180:184);0!==Hc&&Array.add(this.Pua.buttons,this.Ta.Cb(Hc))};l.prototype.BLh=function(){this.$ba.Tn(1035996630)&&(this.XB.Tn(this.tm,1035996630,this.selectedRanges,this.grid)?(Array.add(this.Pua.buttons,this.Ta.Cb(this.grid.rtl?189:167)),Array.add(this.Pua.buttons,this.Ta.Cb(168))):(Array.add(this.Pua.buttons,this.Ta.Cb(this.grid.rtl?190:175)),Array.add(this.Pua.buttons,
this.Ta.Cb(176))))};l.prototype.CLh=function(){var Hc=null;this.HEb&&(Hc=this.Ta.yw("ContextMenu.DeleteCells",null,Z.a.instance.fa(406),-1554384558),Array.add(Hc.menu.Dc,this.Pua));this.ELh();this.DLh();this.BLh();Hc&&0<this.Pua.buttons.length&&Array.add(this.menuSection.buttons,Hc)};Object(z.a)(l,"CellsContextMenuGenerator",null,[]);Object(z.a)(e,"MacroRecorderRangeHyperlinkRemovedPayload",null,[428]);var S=b(590),I=b(24),P=b(101),J=b(78),aa=b(74),ia=b(45),ba=b(173),ra=b(83),ka=b(699),da=b(39),ha=
b(150),qa=b(35),Aa=b(615),Fa=b(617),ab=b(1),Ua=b(184),bb=b(20),xa=b(389),Gb=b(32),$b=b(51),oa=b(246),Ma=b(21),Za=b(28),gb=b(1251),zb=b(1116),nb=b(131),pa=b(561),Ja=b(387),Da=b(165),ib=b(158),Rb=b(356),wc=b(95),Cb=b(29),lb=b(289),yb=b(288),pc=b(132),Ta=b(982),rb=b(983),ic=b(145),Va=b(40),jb=b(53),rc;(function(Hc){Hc[Hc.none=0]="none";Hc[Hc.once=1]="once";Hc[Hc.twice=2]="twice"})(rc||(rc={}));Object(z.b)("ToggleState",rc);c.prototype.ilh=function(){var Hc=this.$V(),Nb={};Hc=(Nb.CommandValueId=Va.c(Hc),
Nb);Nb=new wc.a(-2058042992,2,this.$.jd,19,null);m.ULS.sendTraceTag(527500302,0,50,"GridContextMenuFilter::DoClearFilter GridContextMenu ClearFilter command executed");return this.$.Ka.dc(Nb,Hc)};c.prototype.ylh=function(){var Hc=new wc.a(644342024,2,this.$.jd,19,null);m.ULS.sendTraceTag(527500301,0,50,"GridContextMenuFilter::DoReapplyFilter GridContextMenu ReapplyFilter command executed");return this.$.Ka.dc(Hc)};c.prototype.nlh=function(){var Hc=this.gridView.ga.va.activeCell,Nb=this.$.da.Aa(66).Ig,
nc=this.$.da.Aa(66).zwb(Hc);return Nb||nc?this.plh(Nb,nc,Hc):this.olh(Hc)};c.prototype.plh=function(Hc,Nb,nc){if(this.O_g(Hc,Nb,nc))return m.ULS.sendTraceTag(527500300,0,50,"GridContextMenuFilter::DoFilterByValue Header/Total error dialog raised for FilterByValue in Table"),jb.Task.Sa(!1);if(null!=Hc&&Hc.hasAutoFilter||null!=Nb&&Nb.C0a.every(function(Ha){return 0!=Ha.length}))return this.Vfb=rc.none,this.iZc();this.Vfb=rc.once;return this.Q8b(rc.once)};c.prototype.olh=function(Hc){var Nb=ia.v(this.gridView.ga.va.xd,
this.$);Nb=this.gridView.$.xa.getItemByName(Nb.SheetName);var nc=ia.D(Nb.v1);if(this.N_g(nc,Hc))return m.ULS.sendTraceTag(527500299,0,50,"GridContextMenuFilter::DoFilterByValue Header/EmptyRange error dialog raised for FilterByValue in Sheet"),jb.Task.Sa(!1);if(Nb.hasAutoFilter){if(nc&&nc.contains(this.gridView.ga.va.activeCell))return this.Vfb=rc.none,this.iZc();this.Vfb=rc.twice;return this.Q8b(rc.twice)}this.Vfb=rc.once;return this.Q8b(rc.once)};c.prototype.Q8b=function(Hc){function Nb(Eb){lb.a(Eb)?
m.ULS.sendTraceTag(527500297,0,50,"GridContextMenuFilter::ToggleFilter service call failed with errors : {}",Cb.a.Wc(Eb.Errors)):(m.ULS.sendTraceTag(527500298,0,50,"GridContextMenuFilter::ToggleFilter service call succeeded"),Hc===rc.twice?Ha.Q8b(rc.once):Ha.iZc())}function nc(){return new gb.a(tb)}var Ha=this,tb=ia.v(this.gridView.ga.va.xd,this.$);if(!tb)return jb.Task.Sa(!1);this.Tfb||(this.Tfb=Date.now());var Ub=new wc.a(368460465,2,this.$.jd,19,null),gc=this.$.na.ta.fc();return ab.EwaSettings.uc()?
Ja.a(this.$.userOperationManager,function(Eb,Tb,Wc){return ra.kb(Ha.$.na.ta,tb,yb.b(Eb,Nb),Tb,Wc,null,gc)},function(Eb){return new ba.a(516,0,Eb,64,nc)},Ub):Ja.a(this.$.userOperationManager,function(Eb,Tb,Wc){return ra.kb(Ha.$.na.ta,tb,yb.b(Eb,Nb),Tb,Wc,null,gc)},function(Eb){return new pa.a(516,0,Eb,void 0,nc)},Ub)};c.prototype.O_g=function(Hc,Nb,nc){return null!=Hc&&Da.d(Hc)&&nc.top===Hc.usedRange.top||null!=Nb&&Nb.Pba&&nc.top===Nb.top?(this.ltc(this.$,224),!0):null!=Hc&&Da.g(Hc)&&nc.top===Hc.usedRange.bottom?
(this.ltc(this.$,225),!0):!1};c.prototype.N_g=function(Hc,Nb){if(Hc&&Hc.contains(Nb)&&Nb.top===Hc.top||!Hc&&this.NZg(Nb.top,Nb.left))return this.ltc(this.$,226),!0;Hc=new I.Range(Nb.top,Nb.left,Nb.top+1,Nb.left+1,!1,!1);return this.gridView.Tb.Hjc(Hc)?(this.ltc(this.$,227),!0):!1};c.prototype.ltc=function(Hc,Nb){Nb=Cb.a.ed(1,1,738,Nb,0,147079615,"ContextMenuFilterByCellValueError");ab.EwaSettings.Rz()?new Rb.a(Hc,Nb):(Hc=new ib.ErrorDialog(Hc,Nb),Hc.initialize(),Hc.pf())};c.prototype.iZc=function(){function Hc(Eb){var Tb=
{};Tb=(Tb.ToggleFilterOperationCount=Nb.Vfb,Tb.ApplyFilterTime=Nb.kZc?Date.now()-Nb.kZc:-1,Tb.ToggleAndApplyFilterTime=Nb.Tfb?Date.now()-Nb.Tfb:-1,Tb.FilterByValueType=Ha.AutoFilterType,Tb);m.ULS.sendTraceTag(527500295,0,50,"GridContextMenuFilter::ApplyFilterByValue Perf Telemetry : {0}",JSON.stringify(Tb));Nb.Tfb&&(Nb.Tfb=0);Ta.a.yzc(Eb)&&(Tb=Ta.a.bcc(Eb),Nb.UNa?Ta.a.TRa(rb.a.filterByCellValue,Tb.MessageIdName,ic.a.uta,!0,Ta.a.isSessionEndingError(Tb.MessageId)):m.ULS.sendTraceTag(527500294,0,10,
"GridContextMenuFilter::ApplyFilterByValue failed with FilterException -{0}",Tb.MessageIdName));lb.a(Eb)?m.ULS.sendTraceTag(527500292,0,50,"GridContextMenuFilter::ApplyFilterByValue service call failed with errors : {}",Cb.a.Wc(Eb.Errors)):(m.ULS.sendTraceTag(527500293,0,50,"GridContextMenuFilter::ApplyFilterByValue service call succeeded"),pc.b(Nb.$).he(nb.a.XBf,Nb.om(),void 0,!0),Eb={},Eb.FirstRow=Nb.yUh(),Eb.FirstColumn=Ha.Column,-1!==Eb.FirstRow&&(Eb=ia.C(Eb),Nb.tM(Eb)))}var Nb=this;this.kZc=
Date.now();var nc=this.t5h();if(!nc)return m.ULS.sendTraceTag(527500296,0,50,"GridContextMenuFilter::ApplyFilterByValue . CellValue returned is null"),jb.Task.Sa(!1);var Ha=this.$V(),tb={FirstRow:0};tb.FirstColumn=Ha.Column;tb.SheetName=Ha.SheetName;pc.b(this.$).he(nb.a.nyf,this.om(),void 0,!0);var Ub=this.Y5c(Ha,tb),gc=new ba.a(208,0,function(Eb,Tb,Wc){return ra.a(Nb.$.na.ta,Ub,nc,yb.b(Eb,Hc),Tb,Wc,null,null)},6,function(){return new zb.a(nc,Ub)});this.namedSheetViewPublic?this.namedSheetViewPublic.TBa().continueWith(function(Eb){Eb.result&&
Nb.$.userOperationManager.jc(gc,null)}):this.$.userOperationManager.jc(gc,null);return jb.Task.Sa(!0)};c.prototype.tM=function(Hc){(ab.EwaSettings.isChangeGateEnabled("OfficeVSO:6063473_PTPSDisableLive")?da.a.Pla(this.$):ab.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.PivotTableHandRaise",!1))&&qa.TaskExtensions.Ba($b.GetServiceTaskFactory.Ua(this.$.da,430,431,1),function(Nb){Nb.result.ifa(Hc);m.ULS.sendTraceTag(527500291,306,50,"GridContextMenuFilter:TriggerPivotTableHandRaise Trigger hand raise from context menu filterByValue.")},
this.$.la,3)};c.prototype.om=function(){var Hc={};return Hc.Location="contextMenu",Hc};c.prototype.$V=function(){var Hc=0,Nb=this.gridView.ga.va.activeCell;var nc=this.$.da.Aa(66).Ig;var Ha=this.$.da.Aa(66).zwb(Nb);if(nc){var tb="Table";Hc=nc.objectId}else Ha?(tb="Table",Hc=Ha.id):tb="Sheet";nc=Nb.left;Nb={};Nb.AutoFilterType=tb;Nb.Column=nc;Nb.Id=Hc;tb={};this.$.Jj(tb);tb.FirstRow=0;tb.FirstColumn=Nb.Column;Hc=this.$.ea.isNamedObjectViewMode;Nb.NamedObjectView=Hc;Nb.SheetName=Hc?tb.NamedObjectName:
tb.SheetName;Nb.ItemListOptions=null;return Nb};c.prototype.NZg=function(Hc,Nb){Hc=I.Range.kd(Hc,Nb);return this.gridView.Da.X$(Hc,this.$.oa.name)&&(Hc=this.gridView.Da.s5a(Hc))&&Hc.autoFilterMenu?!0:!1};c.prototype.t5h=function(){var Hc=null,Nb=this.gridView.rc(this.gridView.ga.va.activeCell);if(!Nb)return null;var nc=Nb.cell.yWd;var Ha=this.instantaneousSupportInformationManager.pgb(nc,!1).category;if(1===Nb.uJ.type)if(3===Ha){if(!Nb.cell.C$a)return m.ULS.sendTraceTag(527500290,0,15,"GridContextMenuFilter::GetValueForFilter() for category : {0}. NumFmt is null. ",
Ha),null;Hc=(Nb.cell.C$a.Start+Nb.cell.C$a.End).trim()}else if(!Ha&&(Ma.a.P1a(Nb.uJ.value,"E")||Ma.a.P1a(Nb.originalText,"E"))){Hc=this.Jh.FJh(Nb.uJ.value,nc,Nb.cell.gja);if(!Hc.success)return m.ULS.sendTraceTag(527500289,0,50,"GridContextMenuFilter::GetValueForFilter() for category : {0}. Failed to acquire formatted value",Ha),null;Hc=Hc.LH}Hc||(Hc=Nb.originalText);return Za.a.N2c(Hc)?["[Blanks]"]:["i"+Hc.trim()]};c.prototype.yUh=function(){var Hc=this.gridView.ga.va.activeCell,Nb=this.$.da.Aa(66).Ig,
nc=this.$.da.Aa(66).zwb(Hc);if(Nb)return Nb.usedRange.top;if(null!=nc)return nc.top;Nb=this.$.xa.getItemByName(this.$.oa.sheetName);return(Nb=ia.D(Nb.v1))&&Nb.contains(Hc)?Nb.top:-1};c.prototype.Y5c=function(Hc,Nb){var nc={};nc.Location=Nb;nc.FieldId=Hc.Id.toString();nc.DataSourceIndex=-1;nc.FilterType=Hc.AutoFilterType;nc.AnchorType=0;nc.ChartId=null;nc.AnchorValue1=-1;nc.AnchorValue2=-1;nc.Property=Hc.RichProperty;return nc};Object(z.a)(c,"GridContextMenuFilter",null,[]);b.d(F,"GridContextMenu",
function(){return a});var Cc=A.a;Am(a,Cc);a.prototype.dispose=function(){Cc.prototype.dispose.call(this);this.grid=null};a.prototype.$c=function(Hc,Nb){Hc=!this.wtd(Hc,Nb);if(!Hc)switch(Nb){case -1977666927:Hc=null==this.W5a||this.OBj();break;case 1549396389:Hc=null==this.W5a||!this.Ski();break;case 2045563128:case 1803952894:Hc=null==this.W5a||!this.$.isEditMode&&!this.Tki()}return Hc};a.prototype.wtd=function(Hc,Nb){var nc=this.grid.ga.va.selectedRanges;return(new ha.a(this.$.xa)).Tn(Hc,Nb,nc,this.grid)};
a.prototype.executeCommand=function(Hc,Nb,nc){var Ha=Nb.command;Hc=null;switch(Ha){case -1396319072:if(Nb=this.grid.rc(null))n.a.instance.D1c(!0),h.EventHandlerManager.instance.Ned(),a.m_i(Nb);break;case -1253126584:this.removeHyperlinksFromRange(this.grid.ga.va.selectedRanges,Nb);break;case 324156914:Hc=this.grid.startEdit(!1,1);break;case 1441131127:this.showGridContextMenu(nc);break;case -1977666927:Hc=this.W5a.ilh();break;case 1549396389:Hc=this.W5a.ylh();break;case 1803952894:Hc=this.W5a.nlh();
break;default:Hc=Ua.a(Ha)}return Hc||qa.TaskExtensions.s5()};a.prototype.Mc=function(Hc,Nb,nc){Hc=!1;switch(Nb.command){case -1396319072:case -1253126584:case 324156914:case -1977666927:case 1549396389:case 1803952894:Hc=!0;break;case 1441131127:Hc=!!nc}return Hc};a.prototype.QZ=function(Hc){Hc=void 0===Hc?!1:Hc;var Nb=!1,nc=!1,Ha=0;ab.EwaSettings.isChangeGateEnabled("OfficeVSO:5244620_ContextualUIDetailedTelemetryIsEnabled")&&(Ha=u.a.Ae());var tb=this.Ta.iq(this.menuId),Ub=this.grid.ga.va,gc=Ub.Wg,
Eb=gc&&Ub.xd.Xf,Tb=gc&&Ub.xd.isRow;Ub=Ub.selectedRanges;var Wc=w.a.all(Ub,function(wa){return wa.Xf}),T=w.a.all(Ub,function(wa){return wa.isRow}),ua=ia.O(Ub),ma=ia.P(Ub);this.Ojf(Eb,Tb)?(Nb=!0,this.FMh(tb)):this.$.isEditMode?xa.a(this.$)?this.GMh(tb,Eb,Tb):(this.FLh(tb,!(Tb||Eb||!this.skc)),this.$Lh(tb,Ub,Hc),this.QLh(tb,Wc,T,ua,ma),this.q_e(tb,gc,Eb,Tb),this.YMh(tb),this.VZe(tb,Eb,Tb),this.wMh(tb,gc,Eb,Tb,Ub),this.ILh(tb),this.GLh(tb,Ub),this.gMh(tb),this.TMh(tb,gc),ab.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImmersiveReader",
!1)&&this.ULh(tb)):(nc=!0,xa.a(this.$)?this.k_e(tb):this.nNh(tb,gc,Eb,Tb,Ub));ab.EwaSettings.isChangeGateEnabled("OfficeVSO:5244620_ContextualUIDetailedTelemetryIsEnabled")&&(Hc=u.a.Ae()-Ha,m.ULS.sendTraceTag(537167046,0,50,"GridContextMenu::CreateMenuModel, ExecutionTimeTotal: {0}, isPivotMenu: {1}, isViewMenu: {2}, firstTimeEntry: {3}",Hc,Nb,nc,this.VHe));this.VHe=!1;return tb};a.prototype.mLa=function(Hc){var Nb=[];if(xa.a(this.$))return Nb;if(3===Hc){Hc=this.grid.ga.va;var nc=Hc.Wg,Ha=nc&&Hc.xd.Xf,
tb=nc&&Hc.xd.isRow,Ub=!1,gc=!1,Eb=!1;this.$.isMobileMode&&(gc=Hc.selectedRanges,Ub=ia.O(gc),gc=ia.P(gc));if(nc){var Tb=bb.e(this.grid);Tb&&Tb.range.contains(Hc.xd)&&this.yW(Tb)&&(Eb=!0)}this.$.isEditMode?this.Ojf(Ha,tb)?Array.addRange(Nb,[ea.a.eLf,ea.a.gLf]):Ha||tb?(Array.add(Nb,ea.a.clipboard),tb?Array.add(Nb,ea.a.foj):Ha&&Array.add(Nb,ea.a.p3g)):(Array.addRange(Nb,[ea.a.edit,ea.a.clipboard]),Eb?Array.add(Nb,ea.a.hyperlink):Array.add(Nb,ea.a.color),nc&&Array.add(Nb,ea.a.YQg)):(Array.add(Nb,ea.a.copy),
Eb&&Array.add(Nb,ea.a.openHyperlink),!tb||this.$.isMobileMode&&gc?!Ha||this.$.isMobileMode&&Ub||Array.add(Nb,ea.a.I0j):Array.add(Nb,ea.a.J0j));Array.add(Nb,ea.a.R6h)}else 2===Hc&&Array.add(Nb,ea.a.aBe);return Nb};a.prototype.Ojf=function(Hc,Nb){return(this.QBa||this.jxa||this.g_||this.refresh||this.expandCollapse)&&!(Hc||Nb)};a.prototype.showGridContextMenu=function(Hc){this.expandCollapse=this.refresh=this.g_=this.jxa=this.QBa=!1;var Nb=this.$,nc=Aa.a(Nb).CLa(),Ha=this.grid.ga.va,tb=Ha.Wg,Ub=tb&&
Ha.xd.Xf;Ha=tb&&Ha.xd.isRow;if(nc&&!Ub&&!Ha){Ub=Fa.a(Nb);if(null===Ub||void 0===Ub?0:Ub.RTd)this.QBa=Ub=P.f(Nb.qg),this.jxa=!Ub;Ub=Nb.pc;this.g_=nc.supportsBIExplore&&!!Q.a(Nb)&&Ub.B3(32768);Ub.allowInteractivity&&(Nb=this.grid.rc(null),(null===Nb||void 0===Nb?0:Nb.cell)&&(Nb.cell.s1c||Nb.cell.O6f)&&(this.expandCollapse=!0),Ub.allowManualDataRefresh&&(this.refresh=!0))}Nb=null;nc=1;Ub=Object(y.a)(r.a,Hc.eventArgs);Hc=Object(y.a)(O.a,Hc.creationParams);Ha=this.CRh();Hc?(Nb=Hc.clientPoint,nc=Hc.inputMethod):
Ub&&1!==Ub.zb?(Nb=new Sys.UI.Point(Ub.clientPoint.x,Ub.clientPoint.y),nc=Ub.zb):Ha&&(Nb=new Sys.UI.Point(Ha.x+(this.$.isChromeRtl?0:Ha.width),Ha.y+Ha.height));J.a.$b=nc;this.skc=3===nc;Hc=E.a.jvb;this.Qp(Nb,!Ub||Ub.Ca.target.className!==Hc,nc)};a.prototype.removeHyperlinksFromRange=function(Hc,Nb){var nc=this;if(!ab.EwaSettings.isChangeGateEnabled("OfficeVSO:5639309_CheckedProtectedRangeUnlockStateWhenInsertHyperlink")||this.$.Br(Hc,!0)){var Ha=ia.r(Hc,this.$),tb=this.$.na.ta.fc();this.$.userOperationManager.jc(new ba.a(125,
0,function(Ub,gc,Eb){nc.$.Qy();return ra.c(nc.$.na.ta,Ha,"","",!0,!1,127,Ub,gc,Eb,null,tb)},void 0,function(){return new e(Ha)}),Nb);this.grid.Lg.xH(!1)}};a.prototype.CRh=function(){var Hc=this.grid.rc(null);if((null===Hc||void 0===Hc?0:Hc.cell.Vj)&&this.Yif(Hc))return this.grid.getCellBounds(Hc.cell);Hc=this.grid.ga.va.activeCell;return(Hc=this.Kac(new I.Range(Hc.top,Hc.left,t.a.Sh,Hc.left,!1,!1),2,!0)||this.Kac(new I.Range(1,Hc.left,Hc.top,Hc.left,!1,!1),2,!1)||this.Kac(new I.Range(Hc.top,Hc.right,
Hc.top,t.a.di,!1,!1),1,!0)||this.Kac(new I.Range(Hc.top,1,Hc.top,Hc.right,!1,!1),1,!1)||null)&&Hc.Vj?this.grid.getCellBounds(Hc):Sys.UI.DomElement.getBounds(this.grid.w6a.Kb)};a.prototype.Yif=function(Hc){var Nb=this.grid.rtl,nc=this.$.isChromeRtl;Hc=Hc.cell;var Ha=bb.g(this.$).BK(Hc);return Ha?(Ha=Ha.topLeft,Nb=Ha.x+=Nb===nc?Hc.offsetWidth:0,nc=Ha.y+=Hc.offsetHeight,this.grid.view.visibleArea.contains(new H.a(Nb,nc,0,0))):!1};a.prototype.Kac=function(Hc,Nb,nc){Hc=this.grid.Pk("GridContextMenu.FindFirstCellInViewportArea",
Hc,Nb,nc);try{for(Hc.$$rst();Hc.$$mn();){var Ha=Hc.$$cu();if(Ha&&this.Yif(Ha))return Ha.cell}}finally{Hc&&Hc.dispose()}return null};a.prototype.FMh=function(Hc){var Nb=this.Ta,nc=Nb.Oc();this.refresh&&Array.add(nc.buttons,Nb.Cb(100));this.g_&&Array.add(nc.buttons,Nb.Cb(99));this.QBa?Array.add(nc.buttons,Nb.Cb(59)):this.jxa&&Array.add(nc.buttons,Nb.Cb(58));if(this.expandCollapse){var Ha=Nb.yw("ContextMenu.PivotExpandCollapse",null,Z.a.instance.fa(1120),589118293);var tb=Nb.Oc();Array.add(tb.buttons,
Nb.Cb(243));Array.add(tb.buttons,Nb.Cb(244));Array.add(tb.buttons,Nb.Cb(245));Array.add(tb.buttons,Nb.Cb(246));Array.add(Ha.menu.Dc,tb);Ha&&0<tb.buttons.length&&Array.add(nc.buttons,Ha)}Array.add(Hc.Dc,nc)};a.prototype.q_e=function(Hc,Nb,nc,Ha){if(Nb&&!nc&&!Ha){Nb=this.Ta.Oc();this.Whc&&!this.$.bO&&this.Ffd(Nb);this.Ofd(Nb);this.bNh(Nb);if(ab.EwaSettings.ma(491)&&bb.g(this.$).ga.va.ZK()&&bb.g(this.$).ga.va.X_)switch(ab.EwaSettings.getIntFeatureGate("Microsoft.Office.ExcelOnline.Insights.GridContextMenuQnABrandingCandidatesIndex",
0)){case 1:Array.add(Nb.buttons,this.Ta.Cb(237));break;case 2:Array.add(Nb.buttons,this.Ta.Cb(238));break;default:Array.add(Nb.buttons,this.Ta.Cb(236))}Array.add(Hc.Dc,Nb)}};a.prototype.Ofd=function(Hc){if(!ab.EwaSettings.isChangeGateEnabled("OfficeVSO:6172529_FixAllowSort")||this.$.pc.allowSorting)if(!ab.EwaSettings.isChangeGateEnabled("OfficeVSO:5230917_HideSortForProtectedSheetInMobiles")||!this.$.isMobileMode||(new ha.a(this.$.xa)).qe(2048)){var Nb=this.Ta.Oc();Array.add(Nb.buttons,this.Ta.Cb(223));
Array.add(Nb.buttons,this.Ta.Cb(224));this.$.isMobileMode||Array.add(Nb.buttons,this.Ta.Cb(225));var nc=this.Ta.yw("ContextMenu.sort",null,Z.a.instance.fa(228),-864298118);Array.add(nc.menu.Dc,Nb);Array.add(Hc.buttons,nc)}};a.prototype.Ffd=function(Hc){var Nb=this.Ta.yw("ContextMenu.filter",null,Z.a.instance.fa(1910),2045563128),nc=this.Ta.Oc(),Ha=this.aWh(),tb=this.Ta.Cb(234);tb.label=Ha;Array.add(nc.buttons,tb);Array.add(nc.buttons,this.Ta.Cb(235));Ha=this.Ta.Oc();Array.add(Ha.buttons,this.Ta.Cb(233));
Array.add(Nb.menu.Dc,nc);Array.add(Nb.menu.Dc,Ha);Array.add(Hc.buttons,Nb)};a.prototype.bNh=function(Hc){if(bb.g(this.$).ga.va.ZK()){var Nb=this.Ta.Oc();Array.add(Nb.buttons,this.Ta.Cb(232));ab.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableMissingContextMenuOptions",!1)&&(Array.add(Nb.buttons,this.Ta.Cb(285)),Array.add(Nb.buttons,this.Ta.Cb(286)));var nc=this.Ta.yw("ContextMenu.table",null,Z.a.instance.fa(1909),-697806646);Array.add(nc.menu.Dc,Nb);Array.add(Hc.buttons,nc)}};a.prototype.f_e=
function(Hc,Nb,nc,Ha,tb){if(Nb){var Ub=ia.K(tb),gc=bb.e(this.grid);if(gc&&!nc&&!Ha){nc=new ha.a(this.$.xa);if(gc.range.contains(Ub)&&this.yW(gc)){(Nb=!gc.HNa&&!nc.zj)&&this.$.isEditMode&&Array.add(Hc.buttons,this.Ta.Cb(45));gc.Nba&&Array.add(Hc.buttons,this.Ta.Cb(53));Nb&&this.$.isEditMode&&Array.add(Hc.buttons,this.Ta.Cb(47));return}!gc.HNa&&this.$.isEditMode&&(gc=nc.qe(128),Array.add(Hc.buttons,this.Ta.Cb(gc?46:121)))}}this.$9i(tb)&&Array.add(Hc.buttons,this.Ta.Cb(48));(gc=this.$.xa.oa)&&gc.Yd&&
(gc=gc.Yd.vy||gc.Yd.fL,!Nb||this.$.bO||!ab.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||this.$.ea.isNamedObjectViewMode||this.$.isMobileMode||gc||(Nb=ia.K(tb),this.Z9i(Nb)?Array.add(Hc.buttons,this.Ta.Cb(276)):Nb.Xf||Nb.isRow||Array.add(Hc.buttons,this.Ta.Cb(275))))};a.prototype.$9i=function(Hc){Hc=Cl(Hc);for(var Nb=Hc.next();!Nb.done;Nb=Hc.next()){Nb=this.grid.getRangeInformation(Nb.value);for(var nc=0;nc<Nb.length;nc++)if(Object(v.a)(S.HyperlinkRange,Nb[nc])){var Ha=
this.grid.rc(Nb[nc]);if(Ha&&this.yW(Ha)&&!Ha.HNa)return!0}}return!1};a.prototype.Z9i=function(Hc){if(bb.g(this.$).ga.va.ZK()){var Nb=bb.g(this.$).Tb.Wj(Hc);if(Nb&&Nb.usedRange.equals(Hc))return!0}return!1};a.prototype.VZe=function(Hc,Nb,nc){var Ha,tb;if(1===bb.g(this.$).ga.Ye&&!Nb&&!nc){Nb=xa.a(this.$);nc=this.Ta;var Ub=nc.Oc(),gc=this.$.da.Aa(65);(null===(Ha=null===gc||void 0===gc?void 0:gc.Wn)||void 0===Ha?0:Ha.NF)&&!Nb&&Array.add(Ub.buttons,nc.Cb(227));gc&&gc.isCommentOperationEnabled(3)&&Array.add(Ub.buttons,
nc.Cb(221));(null===(tb=null===gc||void 0===gc?void 0:gc.Wn)||void 0===tb?0:tb.zaf)&&!Nb&&Array.add(Ub.buttons,nc.Cb(228));(null===gc||void 0===gc?0:gc.hasCommentAtActiveCell)?gc.JC.isResolved||Array.add(Ub.buttons,nc.Cb(159)):gc&&gc.hasCommentAtActiveCell||(gc&&gc.Wn&&gc.Wn.NF?Nb||(Array.add(Ub.buttons,nc.Cb(229)),Array.add(Ub.buttons,nc.Cb(230))):(Array.add(Ub.buttons,nc.Cb(160)),Nb||Array.add(Ub.buttons,nc.Cb(226))));Array.add(Hc.Dc,Ub)}};a.prototype.YMh=function(Hc){if(ab.EwaSettings.ma(135)){var Nb=
this.Ta,nc=Nb.Oc();Array.add(nc.buttons,Nb.Cb(250));Array.add(Hc.Dc,nc)}};a.prototype.$Lh=function(Hc,Nb,nc){if(!nc){nc=this.$.Ka.QH();var Ha=new ha.a(this.$.xa),tb=new ka.a(nc,Nb,this.grid);(new l(Hc,this.$,this.Ta,nc,Nb,this.grid,tb,Ha)).Afd()}};a.prototype.QLh=function(Hc,Nb,nc,Ha,tb){var Ub=(new ha.a(this.$.xa)).qe(8),gc=this.Ta,Eb=gc.Oc();Nb&&Array.add(Eb.buttons,gc.Cb(Ub?152:153));nc&&Array.add(Eb.buttons,gc.Cb(Ub?150:151));Nb&&(Ha||Array.add(Eb.buttons,gc.Cb(Ub?109:155)),Array.add(Eb.buttons,
gc.Cb(Ub?111:157)));nc&&(tb||Array.add(Eb.buttons,gc.Cb(Ub?108:154)),Array.add(Eb.buttons,gc.Cb(Ub?110:156)));Array.add(Hc.Dc,Eb)};a.prototype.FLh=function(Hc,Nb){var nc=this.Ta,Ha=nc.Oc();Array.add(Hc.Dc,Ha);Nb&&Array.add(Ha.buttons,nc.Cb(102));Array.add(Ha.buttons,nc.Cb(42));Array.add(Ha.buttons,nc.Cb(43));Nb=this.CMh(nc);Array.add(Hc.Dc,Nb)};a.prototype.CMh=function(Hc){var Nb=Hc.Oc();Nb.title=Z.a.instance.fa(1100);Nb.N8f=!1;Nb.M8f=!1;Nb.Tcg=!1;var nc=5,Ha=da.a.Pud(this.$);Ha&&(nc=6);Hc=Hc.oB("PasteOptionsGallery",
nc,"Size24by24",Nb.title);Array.add(Nb.buttons,Hc);Hc.Xt("ContextMenu.Paste",237279923,"QueryAdvancedPasteContextMenuGalleryIcon",1101,void 0,"Paste_24",1,C.a.$yh);Hc.Xt("ContextMenu.PasteValues",-185374993,"QueryAdvancedPasteContextMenuGalleryIcon",1102,void 0,"PasteValues_24",1,C.a.ezh);Hc.Xt("ContextMenu.PasteFormulas",1766348718,"QueryAdvancedPasteContextMenuGalleryIcon",1103,void 0,"PasteFormulas_24",1,C.a.bzh);Hc.Xt("ContextMenu.PasteTranspose",-958589048,"QueryAdvancedPasteContextMenuGalleryIcon",
1104,void 0,"PasteTranspose_24",1,C.a.dzh);Hc.Xt("ContextMenu.PasteFormatting",1804571062,"QueryAdvancedPasteContextMenuGalleryIcon",1105,void 0,"PasteFormatting_24",1,C.a.azh);Ha&&Hc.Xt("ContextMenu.PasteLink",42074747,"QueryAdvancedPasteContextMenuGalleryIcon",1106,void 0,"PasteLink_24",1,C.a.czh);return Nb};a.prototype.nNh=function(Hc,Nb,nc,Ha,tb){var Ub,gc=this.Ta,Eb=gc.Oc();Array.add(Eb.buttons,gc.Cb(43));Array.add(Hc.Dc,Eb);this.Whc&&!this.$.bO&&(Eb=this.Ta.Oc(),this.Ffd(Eb),Array.add(Hc.Dc,
Eb));ab.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MiniWACInReadOnlyEditMode",!1)&&this.$.ea.pc.isMobileMode&&this.$.ea.pc.isReadOnlyEditMode&&!this.$.ya.IsMeetingLiveSession||(Eb=this.Ta.Oc(),this.Ofd(Eb),Array.add(Hc.Dc,Eb),m.ULS.sendTraceTag(537167045,0,50,"GridContextMenu::GenerateViewMenuSection, Remove the sort options from right contextual menu in mobile, readonlyeditmode and non-meeting scenario"));Eb=this.$.da.Aa(65);if(null===(Ub=null===Eb||void 0===Eb?void 0:Eb.Wn)||void 0===
Ub?0:Ub.NF)Ub=this.Ta.Oc(),Array.add(Ub.buttons,gc.Cb(229)),Array.add(Hc.Dc,Ub);Ub=this.Ta.Oc();this.f_e(Ub,Nb,nc,Ha,tb);Array.add(Hc.Dc,Ub);B.AFrameworkApplication.isMobileMode&&!aa.a(this.$.ya,30)&&(Nb=gc.Oc(),Array.add(Nb.buttons,gc.Cb(272)),Array.add(Hc.Dc,Nb))};a.prototype.wMh=function(Hc,Nb,nc,Ha,tb){var Ub=this.Ta.Oc();this.xMh(Ub);this.f_e(Ub,Nb,nc,Ha,tb);0<Ub.buttons.length&&Array.add(Hc.Dc,Ub)};a.prototype.xMh=function(Hc){Array.add(Hc.buttons,this.Ta.Cb(135))};a.prototype.ULh=function(Hc){var Nb=
this.Ta.Oc();Array.add(Nb.buttons,this.Ta.Cb(185));Array.add(Hc.Dc,Nb)};a.prototype.TMh=function(Hc,Nb){ab.EwaSettings.ma(492)&&Nb&&(Nb=this.Ta.Oc(),Array.add(Nb.buttons,this.Ta.Cb(262)),Array.add(Hc.Dc,Nb))};a.prototype.gMh=function(Hc){var Nb=this.grid.ga.va.selectedRanges;if(Nb&&Nb.length){for(var nc=!1,Ha=0;Ha<Nb.length;Ha++)if(this.grid.Tb.ZNa(Nb[Ha])){nc=!0;break}if(nc){var tb=this.Ta;nc=tb.Oc();Ha=tb.Oc();for(var Ub=1===Nb.length&&(Nb[0].isSingle||this.grid.Tb.KBb(Nb[0])),gc=!1,Eb=!1,Tb=!1,
Wc=!1,T=0;T<Nb.length&&!(gc&&Tb&&Eb&&Wc);T++)!gc&&this.grid.Tb.spi(Nb[T])&&(gc=!0),!Tb&&this.grid.Tb.Qif(Nb[T],!1)&&(Tb=!0),!Eb&&this.grid.Tb.ntd(Nb[T])&&(Eb=!0),!Wc&&this.grid.Tb.Vki(Nb[T])&&(Wc=!0);ab.EwaSettings.ma(105)&&Ub&&!this.grid.Tb.zhc(Nb[0])&&(Wc?Array.add(nc.buttons,tb.Cb(217)):Array.add(nc.buttons,tb.Cb(216)));Wc=gc;Wc=!(new ha.a(this.$.xa)).zj&&Wc;Tb&&(ab.EwaSettings.ma(131)&&P.l(this.$.qg)&&(ab.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityRefreshMenu",!1)&&
(ab.EwaSettings.isChangeGateEnabled("OfficeVSO:5695344_showRefreshSettingsOnProtectedSheet")?Array.add(Ha.buttons,tb.Cb(220)):Array.add(Ha.buttons,tb.Cb(Wc?220:271))),Eb&&Array.add(Ha.buttons,tb.Cb(Wc?218:269)),Ub&&(this.grid.Tb.ntd(Nb[0])||this.grid.Tb.zhc(Nb[0]))&&Array.add(Ha.buttons,tb.Cb(Wc?219:270))),Array.add(Ha.buttons,tb.Cb(Wc?215:268)));0<Ha.buttons.length&&(Nb=tb.yw(gc?"ContexMenu.LinkedEntitiesFlyOut_EnabledContents":"ContexMenu.LinkedEntitiesFlyOut_DisabledContents",null,Z.a.instance.fa(1733),
798637440),Array.add(Nb.menu.Dc,Ha),Array.add(nc.buttons,Nb));0<nc.buttons.length&&Array.add(Hc.Dc,nc)}}};a.prototype.GLh=function(Hc,Nb){this.grid.Tb.khf(Nb)&&(Nb=this.Ta.Oc(),this.grid.ga.va.uca()?(Array.add(Nb.buttons,this.Ta.Cb(241)),Array.add(Nb.buttons,this.Ta.Cb(239))):Array.add(Nb.buttons,this.Ta.Cb(240)),Array.add(Hc.Dc,Nb))};a.prototype.yW=function(Hc){return Hc.cell.hasHyperlink};a.prototype.k_e=function(Hc){this.HMh(Hc);var Nb=this.Ta.Oc();this.Ofd(Nb);Array.add(Hc.Dc,Nb);this.Whc&&(Nb=
this.Ta.Oc(),this.Ffd(Nb),Array.add(Hc.Dc,Nb))};a.prototype.GMh=function(Hc,Nb,nc){this.k_e(Hc);this.VZe(Hc,Nb,nc)};a.prototype.HMh=function(Hc){if(this.grid.ga.va.Wg&&!this.grid.rb.jj){var Nb=this.Ta,nc=Nb.Oc();Gb.a(this.$).vUd()?Array.add(nc.buttons,Nb.Cb(265)):Array.add(nc.buttons,Nb.Cb(264));Array.add(Hc.Dc,nc)}};a.m_i=function(Hc){var Nb=Hc.tLa(a.Rnd);Nb&&Nb.Ipd&a.Rnd&&Hc.invoke(a.Rnd,null)};a.ZLh=function(Hc,Nb,nc){if(ab.EwaSettings.isChangeGateEnabled("OfficeVSO:5552180_DontAssertIfCopyPasteInfraNotReadyOnContextMenuOpen")){if(nc=
nc.da.Aa(254),!nc){m.ULS.sendTraceTag(537167044,0,50,"GridContextMenu::GenerateInsertCopiedCutCellsConextMenu, CopyPasteInfrastructure is not ready.");return}}else if(nc=nc.da.Aa(254,!0),!nc)return;nc.csd()&&nc.Jnf()&&Array.add(Hc.buttons,Nb.Cb(212));nc.csd()&&nc.nlc()&&Array.add(Hc.buttons,Nb.Cb(213))};a.prototype.OBj=function(){var Hc=this.$.da.Aa(66).Ig,Nb=this.grid.ga.va.activeCell;return null!=Hc&&!Hc.hasActiveFilter||oa.c(this.$,Nb)||!this.Uki(Nb)};a.prototype.Uki=function(Hc){var Nb=Hc.left,
nc=this.lec();if(null!=nc&&null!=nc.Aac&&Array.contains(nc.Aac,Nb-1))return!0;nc=this.dec();return null!=nc&&ia.D(nc).contains(Hc)&&null!=nc.FilteredColumns&&Array.contains(nc.FilteredColumns,Nb-1)?!0:!1};a.prototype.Ski=function(){var Hc=this.$.da.Aa(66).Ig,Nb=this.lec();if(null!=Hc)return Hc.hasAutoFilter&&Hc.hasActiveFilter;if(null!=Nb)return null!=Nb.Aac&&0<Nb.Aac.length;Hc=this.dec();return null!=Hc&&null!=Hc.FilteredColumns&&0<Hc.FilteredColumns.length};a.prototype.Tki=function(){var Hc=this.$.da.Aa(66).Ig,
Nb=this.lec();if(null!=Hc&&Hc.hasAutoFilter||null!=Nb&&Nb.C0a.every(function(nc){return 0!=nc.length}))return!0;Hc=ia.D(this.dec());return null!=Hc&&Hc.contains(this.grid.ga.va.activeCell)?!0:!1};a.prototype.lec=function(){var Hc=this.$.da.Aa(66);Hc.rn(this.grid.ga.va.activeCell);return Hc.zwb(this.grid.ga.va.activeCell)};a.prototype.dec=function(){return this.$.xa.getItemByName(this.$.oa.sheetName).v1};a.prototype.aWh=function(){var Hc=this.grid.ga.va.activeCell,Nb=0,nc=!1,Ha=this.$.da.Aa(66),tb=
this.lec();Ha=Ha.Ig;null!=Ha?(Nb=Ha.usedRange.top,nc=!0):null!=tb?(Nb=tb.top,nc=!0):(tb=this.dec(),null!=tb&&ia.D(tb).contains(Hc)&&(Nb=tb.FirstRow+1,nc=!0));return nc?(Hc=Hc.left,Nb=I.Range.kd(Nb,Hc),Nb=this.grid.rc(Nb),nc="",null!=Nb&&(nc=Nb.text),this.lUg(nc,Hc)):Z.a.instance.fa(221)};a.prototype.lUg=function(Hc,Nb){null==Hc||Ma.a.Qh(Hc.trim())?Hc=String.format(Z.a.instance.Bb(156),I.Range.hV(Nb)):Hc.length>a.b4d?(Hc=Hc.substring(0,a.b4d),Hc=String.format(Z.a.instance.Bb(154),Hc)):Hc=String.format(Z.a.instance.Bb(155),
Hc);return Hc};uk.Object.defineProperties(a.prototype,{It:{configurable:!0,enumerable:!0,get:function(){return"PopulateGridContextMenu"}},TB:{configurable:!0,enumerable:!0,get:function(){return U.a.$Pf}}});a.nKb="GridContextMenuRootName";a.$6h=U.a.KFe;a.Rnd=192;a.b4d=26;Object(z.a)(a,"GridContextMenu",A.a,[])},1310:function(z,F,b){function a(Fa,ab){var Ua=Aa.call(this,Fa)||this;Ua.WDa=null;Ua.g2c=[];Ua.d8d=null;Ua.nxa=!1;Ua.dgc=!1;Ua.zq=null;Ua.Rde=null;Ua.ANe=function(){Ua.FZ.xKa(Ua.items,Ua.WDa);
Ua.raiseEvent("ACLBUpdated",new y.a(Ua.items.length));Ua.show()};Ua.tableManager=ab;Ua.domElement.className=r.a.sQe;Ua.domElement.innerHTML=qa;Z.DOMElementExtensions.setVisible(Ua.domElement,!1);ha.d(Ua.style,Ua.$.isChromeRtl);Ua.Hhf=H.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ServiceInit",!1);Ua.WAe=$get(m.Nag,Ua.domElement);Ua.FZ=new c(Ua.$,Ua.WAe,Ua);Ua.gUa(!0);Ua.$.domElement.appendChild(Ua.domElement);Ua.iqb(Fa,ba.a(Fa));Ua.iqb(Fa,Q.g(Fa).zc);Ua.Hhf||Ua.$.da.Ha(1,Ua);Ua.$ki=H.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChangeHandleKeyDownConditionOrder",
!1);return Ua}function c(Fa,ab,Ua){Fa=J.call(this,Fa,ab)||this;Fa.cellAutoCompleteControl=null;Fa.vsa=null;Fa.hAb=H.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ServiceInit",!1);Fa.hAb&&(Fa.cellAutoCompleteControl=Ua);Fa.Cs=[];return Fa}function e(Fa,ab,Ua){var bb=O.call(this,Fa,ab)||this;bb.ASb=null;bb.jlc=0;bb.p9a=null;bb.L1=null;bb.hNa=!1;bb.Z6=function(xa,Gb){if(xa=bb.cellAutoCompleteControl.items)if(1===xa.length&&bb.cellAutoCompleteControl.k2a.length<xa[0].tta.length&&bb.cellAutoCompleteControl.nxa&&
U.a.kM(xa[0].tta,bb.cellAutoCompleteControl.k2a)&&(Gb.newValue=xa[0].tta),bb.Za&&H.EwaSettings.ma(136)){var $b=-1;1<xa.length?$b=bb.cellAutoCompleteControl.iec(bb.Za.text,!0):1===xa.length&&(bb.cellAutoCompleteControl.nxa||bb.cellAutoCompleteControl.dgc)&&($b=0);if(0<=$b&&xa.length>$b&&xa[$b].j_c){var oa=C.C(xa[$b].j_c);oa&&Q.g(bb.$).Tb.ZNa(oa)&&(Gb.hgf=!0,Gb.XAe=xa[$b].j_c)}}};bb.wGb=function(){bb.hNa&&(bb.cellAutoCompleteControl.nxa=!1)};bb.Za.b_a(bb.Z6);bb.hNa=H.EwaSettings.isChangeGateEnabled("OfficeVSO:5858567_CellAutoCompletePreserveCase_V3");
bb.hAb=H.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ServiceInit",!1);bb.hAb&&(bb.ASb=Ua);bb.hNa&&(bb.L1=bb.Rd.Gd(bb.Za.textBox.domElement),bb.L1.ka("mousedown",bb.wGb));return bb}function l(Fa,ab){this.npg=Fa;this.mpg=ab}function m(){}b.r(F);z=b(0);var n=b(13),h=b(89),u=b(1258),w=b(9),r=b(984);m.Nag="suggested_cells_list_box";Object(z.a)(m,"CssElementIds",null,[]);var B=b(5),y=b(1259);uk.Object.defineProperties(l.prototype,{tta:{configurable:!0,enumerable:!0,get:function(){return this.npg}},
j_c:{configurable:!0,enumerable:!0,get:function(){return this.mpg}}});Object(z.a)(l,"CellAutoCompleteItem",null,[840]);var v=b(4),A=b(81),t=b(1118),E=b(405),C=b(45),H=b(1),U=b(21),Q=b(20),O=t.a;Am(e,O);e.prototype.dispose=function(){this.Za.iJb(this.Z6);O.prototype.dispose.call(this)};e.prototype.fV=function(Fa){Fa&&!this.cellAutoCompleteControl.isListVisible||O.prototype.fV.call(this,Fa)};e.prototype.Yh=function(Fa,ab){this.cellAutoCompleteControl.Za=this.Za;this.jlc=Fa.keyCode;if(this.Za.isEditing){var Ua=
this.Za.text;U.a.equals(this.p9a,Ua,!1)||(this.p9a=Ua)}else this.p9a=null;if(237279923===ab)return this.cellAutoCompleteControl.isListVisible=!1;H.EwaSettings.ma(136)&&17===this.jlc&&this.cellAutoCompleteControl.nxa&&(this.cellAutoCompleteControl.dgc=!0);return O.prototype.Yh.call(this,Fa,ab)};e.prototype.uCd=function(){var Fa;if(!H.EwaSettings.isChangeGateEnabled("OfficeVSO:5172529_CheckForShuttingDownInAutocompletionTimedCallback")||!v.AFrameworkApplication.Pg)if(this.cellAutoCompleteControl.Za=
this.Za,this.cellAutoCompleteControl.nxa=!1,this.Za.isEditing){var ab=!U.a.equals(this.p9a,this.Za.text,!0),Ua=this.Za.frd;(H.EwaSettings.tlf()?Ua||!ab&&229!==this.jlc:!ab)?Ua&&(this.cellAutoCompleteControl.isListVisible&&(this.cellAutoCompleteControl.isListVisible=!1),null===(Fa=this.cellAutoCompleteControl.OOa)||void 0===Fa?void 0:Fa.cancel()):this.cellAutoCompleteControl.MPg(this.jlc)}else this.p9a=null};e.prototype.mj=function(){};e.prototype.Rg=function(){this.BW=!1;this.cellAutoCompleteControl.set_visible(!1);
this.p9a=null;this.cellAutoCompleteControl.nxa=!1;this.cellAutoCompleteControl.dgc=!1;this.cellAutoCompleteControl.OOa&&this.cellAutoCompleteControl.OOa.cancel()};e.prototype.YId=function(Fa,ab){return this.cellAutoCompleteControl.Yh(Fa,ab)};uk.Object.defineProperties(e.prototype,{uAb:{configurable:!0,enumerable:!0,get:function(){return!1}},BW:{configurable:!0,enumerable:!0,get:function(){return this.cellAutoCompleteControl.isListVisible},set:function(Fa){this.cellAutoCompleteControl.isListVisible=
Fa}},KMa:{configurable:!0,enumerable:!0,get:function(){return!1}},key:{configurable:!0,enumerable:!0,get:function(){return E.a.h2c}},cellAutoCompleteControl:{configurable:!0,enumerable:!0,get:function(){if(this.hAb)return this.ASb;var Fa=b(1310).CellAutoCompleteControl;return this.ASb||(this.ASb=Object(A.a)(Fa,this.$.da.Aa(1)))}}});Object(z.a)(e,"CellAutoCompleteListAutoCompleteBehavior",t.a,[]);var ea=b(28);t=b(1260);var Z=b(11),S=b(8),I=b(114),P=b(66),J=t.a;Am(c,J);c.prototype.dispose=function(){J.prototype.dispose.call(this);
this.vsa=null};c.prototype.ABc=function(Fa){this.y8(!1);var ab=""+String.format("<table class='{0}' aria-live='polite'><tbody>",this.Kca);for(var Ua=0,bb=this.Cs.length;Ua<bb;Ua++){var xa=ea.a.Rf(Fa[this.Cs[Ua]].tta);xa=String.format("<tr><td class='{0}'><span class='{1}' {2}='{3}'>{4}</span></td></tr>",this.f0,c.i2c,B.a.wte,xa,ea.a.F9b(xa));ab+=xa}this.pg.innerHTML=ab+"</tbody></table>";this.Un=Z.DOMElementExtensions.Ij(this.domElement,this.Kca);this.y8(!0);this.ata()};c.prototype.xKa=function(Fa,
ab){if(Fa&&Fa.length){var Ua=[];if(ab)for(var bb=0,xa=Fa.length;bb<xa;bb++)U.a.kM(Fa[bb].tta,ab)&&Array.add(Ua,bb);this.Cs=Ua;this.ABc(Fa)}else this.isListVisible=!1,this.vsa=null};c.prototype.jza=function(){};c.prototype.zXg=function(Fa,ab,Ua){var bb=Math.min(Fa,Math.max(200,Ua));ab&&Fa<Ua&&(bb+=I.a.Mp);Z.DOMElementExtensions.nr(this.pg,bb);ab&&(bb-=I.a.Mp);return bb};c.prototype.ata=function(){J.prototype.ata.call(this);var Fa=Z.DOMElementExtensions.Ij(this.get_element(),this.Kca),ab=this.Cs.length>
this.xI,Ua=Q.g(this.$);if(Ua=Ua.rc(Ua.ga.va.activeCell))for(Fa=this.zXg(Fa.offsetWidth,ab,Ua.width),ab=this.pg.getElementsByClassName(c.i2c),Ua=0;Ua<ab.length;Ua++)ab[Ua].style.maxWidth=S.HelperMethods.Yb(Fa);else n.ULS.sendTraceTag(537167964,0,15,"CellAutoCompleteListBox.AdjustHeightAndWidth: Can't retrive FormattedCell of the Current Active Cell.")};c.prototype.Bpc=function(Fa){if(Fa=J.prototype.Bpc.call(this,Fa)){var ab=Q.g(this.$);ab.kr(!1);ab.focus()}return Fa};uk.Object.defineProperties(c.prototype,
{al:{configurable:!0,enumerable:!0,get:function(){return this.vsa},set:function(Fa){this.vCa(this.al);this.vsa=Fa;var ab=this.vCa(this.al);this.ve=Fa?ab.innerText:null;this.$wc(Fa)}},isListVisible:{configurable:!0,enumerable:!0,get:function(){return Object(P.a)(c.prototype,this,"isListVisible")},set:function(Fa){Object(P.b)(c.prototype,this,"isListVisible",Fa);Fa||(this.al=null)}},GUa:{configurable:!0,enumerable:!0,get:function(){return null}},vHa:{configurable:!0,enumerable:!0,get:function(){return this.hAb?
this.cellAutoCompleteControl:this.cellAutoCompleteControl||(this.cellAutoCompleteControl=this.$.da.Aa(1))}}});c.i2c=r.a.kyh;Object(z.a)(c,"CellAutoCompleteListBox",t.a,[]);var aa=b(24),ia=b(62),ba=b(120),ra=b(187),ka=b(43),da=b(34),ha=b(257);t=b(17);b.d(F,"CellAutoCompleteControl",function(){return a});var qa="<div id='"+m.Nag+"' class='"+r.a.hbd+" "+t.a.il+"' ></div>",Aa=u.a;Am(a,Aa);a.prototype.OXc=function(Fa){this.addHandler("ACLBUpdated",Fa)};a.prototype.zMd=function(Fa){this.removeHandler("ACLBUpdated",
Fa)};a.prototype.w3=function(Fa){this.addHandler("ACLBSelectionChanged",Fa)};a.prototype.dea=function(Fa){this.removeHandler("ACLBSelectionChanged",Fa)};a.prototype.tJg=function(Fa){this.addHandler("ACLBMatchedItem",Fa)};a.prototype.Wgj=function(Fa){this.removeHandler("ACLBMatchedItem",Fa)};a.prototype.aag=function(Fa){for(var ab=0;ab<Fa.length;ab++){var Ua=Fa.charCodeAt(ab);if(H.EwaSettings.isChangeGateEnabled("OfficeVSO:4831363_UseUpdatedisLetterCharacterCodeRangesInStringExtensions")?U.a.isLetter(Ua):
U.a.ksd(Ua))return!0}return!1};a.prototype.$xa=function(){return!this.items};a.prototype.dispose=function(){if(this.$){this.gUa(!1);var Fa=Q.g(this.$);Fa&&Fa.view.fr(this.spc)}h.a.tc([this.FZ,this.OOa]);h.a.tc(this.g2c);this.g2c=this.WAe=this.FZ=this.Za=null;Aa.prototype.dispose.call(this)};a.prototype.Yh=function(Fa,ab){var Ua=!1,bb=H.EwaSettings.isChangeGateEnabled("OfficeVSO:5858567_CellAutoCompletePreserveCase_V3");if(this.kCj(bb,ab))switch(ab){case -798660877:if(1===this.items.length&&this.ve)break;
this.au.MB(1);this.raiseEvent("ACLBSelectionChanged",new y.a(this.items.length,this.iec(this.ve),this.ve));Ua=this.oz(!1);break;case 137938150:if(1===this.items.length&&this.ve)break;this.au.MB(-1);this.raiseEvent("ACLBSelectionChanged",new y.a(this.items.length,this.iec(this.ve),this.ve));Ua=this.oz(!1);break;case 2091832999:this.au.MB(this.xI-1);Ua=this.oz(!1);break;case 742457698:this.au.MB(-(this.xI-1));Ua=this.oz(!1);break;case 125627505:this.Za.textBox.caretPosition=this.Za.text.length;this.isListVisible=
!1;Ua=!0;break;case 267796030:bb||1!==this.items.length?this.oz(!0):this.Egc(!0);break;default:Ua=Aa.prototype.Yh.call(this,Fa,ab)}return Ua};a.prototype.show=function(){this.items&&this.items.length&&(this.FZ.al=this.ve?this.au.Un.rows[this.iec(this.ve)]:null,this.isListVisible=0<this.FZ.Cs.length,this.JCa(!0),this.FZ.jza())};a.prototype.MPg=function(Fa){var ab=!!this.Za&&!ia.f(this.$.oa);this.dgc=this.nxa=!1;this.Za&&!this.Za.isEditing?this.set_visible(!1):ab&&!this.Hfh(this.activeCell)&&this.VFj(Fa)};
a.prototype.Hfh=function(Fa){return!!this.dataValidationControl&&this.dataValidationControl.Q9c(Fa)};a.prototype.oz=function(Fa){if(!this.Za||!this.isListVisible)return!1;var ab=this.WDa;if(this.ve){var Ua=Z.DOMElementExtensions.r_(Z.DOMElementExtensions.Ij(this.FZ.al,c.i2c),B.a.wte,""),bb=Ua.substring(ab.length,Ua.length);Fa?this.Za.text=Ua:this.Za.insertTextAt(bb,ab.length,this.Za.text.length)}Ua=Q.g(this.$);Ua.yj&&(Ua=Ua.zc,Ua.text=this.Za.text,Ua.setCaretPosition(this.Za.textBox.caretPosition));
Fa?this.isListVisible=!1:this.Za.textBox.selectRange(ab.length,this.Za.text.length);return!0};a.prototype.iec=function(Fa,ab){ab=void 0===ab?!1:ab;if(!this.FZ.Un)return-1;for(var Ua=this.FZ.Un.children[0],bb=Ua.children.length,xa,Gb=0;Gb<bb;++Gb)if(xa=Ua.children[Gb],U.a.equals(xa.innerText.trim(),Fa,ab))return Gb;return-1};a.prototype.AEg=function(Fa,ab,Ua,bb,xa,Gb,$b){var oa=Ua.originalText.replace(a.iwf,String.fromCharCode(32)),Ma=new aa.Range(Fa.top-1,Fa.left,Fa.bottom-1,Fa.right,!1,!1),Za=$b?
$b.rn(Ua.range):null;(!Ua.WF||Ua.range.left===Fa.left)&&1<oa.length&&!bb.xb(oa.toUpperCase())&&U.a.kM(oa,ab)&&!U.a.equals(oa,ab,!0)&&!a.UXe(ab)&&this.aag(oa)&&(!xa&&!Za||!xa&&Za.equals($b.rn(Ma))||xa&&Ua.range.Od(Gb)&&Ua.range.top!==Gb.top)&&(Fa=Ua.formulaBarText,U.a.equals(Fa,Ua.text,!1)||!Fa)&&(Fa={},Fa.FirstRow=Ua.range.top-1,Fa.FirstColumn=Ua.range.left-1,Ua=new l(oa,Fa),bb.add(oa.toUpperCase(),Ua))};a.prototype.VFj=function(Fa){this.zq=this.s3h();this.OOa&&this.OOa.cancel();0<this.Za.text.length&&
(H.EwaSettings.tlf()||229!==Fa)&&0!==Fa?this.items&&((1<this.items.length||this.isListVisible)&&this.vmh(),8!==Fa&&127!==Fa&&46!==Fa&&(1===this.items.length?this.Egc(!1):this.FZ.al&&this.oz(!1))):this.isListVisible=!1};a.prototype.vmh=function(){this.isListVisible?this.ANe():this.Rde=ra.AsyncMethodContext.av(this.ANe,500,ka.a.LZg,this.OOa)};a.prototype.Egc=function(Fa){n.ULS.shipAssertTag(537167966,0,!this.$xa()&&1===this.items.length,"Invalid Items");var ab=this.items[0].tta,Ua=this.Za.text,bb=ab.substring(Ua.length,
ab.length);if(Fa&&!bb.length)this.Za.text=ab;else if(!Fa&&0<bb.length)this.Za.appendText(bb),this.Za.textBox.selectRange(Ua.length,this.Za.text.length);else return;this.raiseEvent("ACLBMatchedItem",new y.a(this.items.length,0,ab));this.nxa=!0};a.prototype.s3h=function(){this.zq=null;var Fa=new da.a(!1),ab=this.activeCell;this.WDa=this.Za.text.replace(a.iwf,String.fromCharCode(32));var Ua=this.tableManager.rn(ab),bb=ab.Od(Ua);if(a.UXe(this.WDa)||!this.aag(this.WDa))return this.items;var xa=new aa.Range(1,
ab.left,ab.top-1,ab.left,!1,!1),Gb=new aa.Range(ab.top+1,ab.left,w.a.Sh,ab.left,!1,!1),$b=Q.g(this.$);Gb=$b.Pk("CellAutoCompleteControl.GetSuggestedCells",Gb);try{var oa=$b.Pk("CellAutoCompleteControl.GetSuggestedCells2",xa);try{for(var Ma=Cl([oa,Gb]),Za=Ma.next();!Za.done;Za=Ma.next())for(var gb=Za.value;gb.$$mn();){var zb=gb.$$cu();this.AEg(ab,this.WDa,zb,Fa,bb,Ua,this.tableManager)}}finally{oa&&oa.dispose()}}finally{Gb&&Gb.dispose()}this.zq=Array(Fa.values.length);for(ab=0;ab<this.items.length;ab++)this.items[ab]=
Fa.values[ab];this.items.sort(function(nb,pa){return nb.tta.localeCompare(pa.tta)});return this.items};a.prototype.iqb=function(Fa,ab){Fa&&ab&&Array.add(this.g2c,new e(Fa,ab,this.Hhf?this:void 0))};a.prototype.kCj=function(Fa,ab){return this.$ki?Fa||267796030!==ab?this.k2a&&!this.$xa()&&this.isListVisible?this.get_visible():!1:!0:this.k2a&&!this.$xa()&&this.get_visible()&&this.isListVisible||!Fa&&267796030===ab};a.UXe=function(Fa){Fa=0<Fa.length?Fa.charCodeAt(0):-1;return 35===Fa||61===Fa||43===Fa||
45===Fa||64===Fa};uk.Object.defineProperties(a.prototype,{au:{configurable:!0,enumerable:!0,get:function(){return this.FZ}},k2a:{configurable:!0,enumerable:!0,get:function(){return this.WDa}},ve:{configurable:!0,enumerable:!0,get:function(){return this.FZ.ve}},items:{configurable:!0,enumerable:!0,get:function(){return this.zq}},OOa:{configurable:!0,enumerable:!0,get:function(){return this.Rde}},activeCell:{configurable:!0,enumerable:!0,get:function(){return Q.g(this.$).ga.va.activeCell}},dataValidationControl:{configurable:!0,
enumerable:!0,get:function(){return this.d8d||(this.d8d=this.$.da.Aa(14))}}});uk.Object.defineProperties(a,{iwf:{configurable:!0,enumerable:!0,get:function(){return a.Bfe||(a.Bfe=new RegExp(String.fromCharCode(160),"g"))}}});a.Bfe=null;Object(z.a)(a,"CellAutoCompleteControl",u.a,[746,747,748,3])},1441:function(z,F,b){function a(){this.tb=null;this.yx=!1}function c(f,D){var N=vb.call(this)||this;N.ora=Yk.a.qNh;N.vRc=!!window.PointerEvent;N.qme=window.hasOwnProperty("ontouchstart");N.amb=null;N.vXa=
null;N.H9=!1;N.iU=new fl.a;N.wmb=new fl.a;N.ftg=new Ab.a;N.Kqa=null;N.$nb=!1;N.H6d=!1;N.Jie=!1;N.pPc=!1;N.CIc=!1;N.B6d=!1;N.JLc=!1;N.yWa=!1;N.Blb=-1;N.fUc=null;N.session=null;N.handlers=null;N.element=null;N.curRecognizer=null;N.Wd=ig.EventHandlerManager.instance;N.vRc?(ld.ULS.sendTraceTag(593893141,310,50,"Using pointer events"),N.amb=Object(Nh.a)(N,N.gqc,"onPointerEvent"),N.vXa=hg.a.sNh):N.qme?(ld.ULS.sendTraceTag(593893140,310,50,"Using touch events"),N.amb=Object(Nh.a)(N,N.Uza,"onTouchEvent"),
N.vXa=hg.a.touchEvents):(ld.ULS.sendTraceTag(593893139,310,50,"Using mouse events"),N.amb=Object(Nh.a)(N,N.Spc,"onMouseEvent"),N.vXa=hg.a.rNh);N.Ih=D;N.hga=f;Gg.AFrameworkApplication.ha&&(N.$nb=Gg.AFrameworkApplication.ha.ra("UsePointerCaptureIsEnabled"),N.H6d=Gg.AFrameworkApplication.ha.ra("ClearCacheOnPrimaryPointerIsEnabled"),N.Jie=Gg.AFrameworkApplication.ha.ra("ResetHandledBeforeInputHandlerIsEnabled"),N.pPc=Gg.AFrameworkApplication.ha.ra("LogCoalescedEventsIsEnabled"),N.CIc=Gg.AFrameworkApplication.ha.ra("CheckExistenceOfGetCoalescedEventsIsEnabled"),
N.B6d=Gg.AFrameworkApplication.ha.ra("CheckIfHammerExistsAfterDownloadIsEnabled"),N.JLc=Gg.AFrameworkApplication.ha.ra("HammerJsPerformanceTimersIsEnabled"),N.yWa=N.$nb&&Gg.AFrameworkApplication.ha.ra("CancelDragFromGestureInputManagerIsEnabled")&&Gg.AFrameworkApplication.ha.ra("UseGestureInputManagerPointerCacheIsEnabled"));return N}function e(){}function l(){this.srcEvent=this.pointerType=this.changedPointers=this.pointers=null;this.maxPointers=this.rotation=this.scale=this.angle=this.distance=
this.overallVelocity=this.overallVelocityY=this.overallVelocityX=0;this.additionalEvent=this.center=this.target=null;this.isFinal=this.isFirst=!1;this.deltaTime=this.timeStamp=this.deltaY=this.deltaX=this.eventType=0;this.offsetDirection=null}function m(f,D,N,fa,Ia,pb,Wb,Nc,kd){f=ja.call(this,f,N,fa,pb)||this;f.Oib=D;f.jha=Wb;f.EY=Nc;f.M3j=kd;f.etg=Ia;return f}function n(){this.TJc=null}function h(){this.Rda=this.x_e=null}function u(f){var D=Xk.call(this)||this;D.$=f;D.Xb();return D}function w(f){var D=
this;this.$=f;this.wba=Object.assign({},wl);this.PKa=Object.assign({},sl);this.xZ=Object.assign({},ql);this.rqb=Object.assign({},vl);this.MSa=Object.assign({},nl);this.rd=function(){D.ryj();D.$.sendBeaconTraceTag(88392384,50,!1,"{0}",D.getJsonForLogging())};this.dbb=new fl.a;f.Gl(this.rd)}function r(f){var D=this;this.ruf=f;this.I0=Object.assign({},Wk);this.l9b=[];this.dnc=-1;(this.quf=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5999949_formulaTelemetryMetriThresholds"))&&f&&(this.I0.countAboveThresholds=
{},f.forEach(function(N){return D.I0.countAboveThresholds[N]=0}))}function B(f){var D=jl.call(this)||this;D.$=f;D.Xb();return D}function y(f,D,N,fa,Ia){var pb=Vk.call(this)||this;pb.KP=null;pb.f1=null;pb.uGa=null;pb.fxc=null;pb.qQc=null;pb.YYa=null;pb.Uhe=0;pb.aHc=!1;pb.zh=function(){pb.Hxa&&(pb.gridView?1===pb.gridView.ga.Ye?(pb.gridView.ga.va.activeCell.equals(pb.uGa)||pb.eO||pb.py(),pb.dqb.hr()):pb.py():ld.ULS.shipAssertTag(537154141,0,!1,"GridView is null during selection"))};pb.mj=function(){pb.py()};
pb.vd=function(){pb.YX()};pb.rd=function(){pb.py()};pb.dd=function(){pb.showCallout()};pb.Eza=function(){if(pb.xh.Rk&&pb.xh.Rk.length)if(pb.I0c)pb.xh.oyi||(pb.aHc=pb.xh.Rk[0].BlockingDataForExpand),pb.xh.nUh&&ld.ULS.sendTraceTag(537154140,0,50,"User clicked pullout launch button before fieldInfo web service returned"),pb.Uhe=pb.xh.J7c&&pb.xh.zZe<pb.xh.J7c.left-1?pb.xh.J7c.left-1-pb.xh.zZe:-1,pb.showCallout();else if(pb.gridView.ga.va.Wg){var Wb=pb.gridView.ga.va.activeCell;if(Wb&&pb.f1){var Nc=pb.tableManager.rn(Wb);
pb.eOc=!!Nc;var kd=pb.gridView.ga.va.xd;Nc=pb.eO&&pb.f1.Od(Nc);var Xc=pb.nld&&!pb.eO&&kd.equals(pb.selectedRange);Nc||Xc?(ld.ULS.sendTraceTag(39662912,0,50,"Field TableWidget shown on grid"),pb.pac=!0,ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichPivotAll",!1)&&!pb.eO&&pb.tableManager.ALa(Wb)?ld.ULS.shipAssertTag(537154139,0,!1,"PulloutManager:OnFieldInfoListContextLoaded fetch rich fields for a cell on PivotTable range"):(ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5459087_FixLinkedEntityConvertPulloutButtonVisibilityBounds")?
pb.eO?pb.$h.PBa(pb.f1,pb.eO):pb.$h.PBa(kd,pb.eO):pb.$h.PBa(pb.f1,pb.eO),pb.Vvc())):ld.ULS.shipAssertTag(537154138,0,!1,"PulloutManager:OnFieldInfoListContextLoaded FAILURE")}}};pb.lj=function(){pb.a8a()&&pb.$h.hide();1===pb.gridView.ga.Ye&&pb.YX()};pb.BS=function(){var Wb=pb.gridView.ga.Ye;pb.gridView.ga.va.activeCell&&1===Wb&&pb.YX()};pb.Gt=function(){if(ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5459087_FixLinkedEntityConvertPulloutButtonVisibilityBounds"))if(pb.eO){if(pb.f1&&pb.uGa){var Wb=
pb.tableManager.rn(pb.uGa);Wb&&1<Wb.bottom-Wb.top&&(--Wb.bottom,pb.gridView.V_(Wb)&&pb.dqb.hr())}}else pb.gridView.ga.va.Wg&&pb.gridView.V_(pb.gridView.ga.va.xd)&&pb.dqb.hr();else pb.f1&&pb.uGa&&pb.eO&&(Wb=pb.tableManager.rn(pb.uGa))&&1<Wb.bottom-Wb.top&&(--Wb.bottom,pb.gridView.V_(Wb)&&pb.dqb.hr())};pb.YX=function(){if(pb.$&&pb.gridView){if(pb.pac&&pb.eO){var Wb=pb.gridView.ga.va.activeCell;pb.f1=pb.CXe();var Nc=!!pb.fxc&&pb.fxc.contains(Wb);if(pb.f1&&(Wb.equals(pb.uGa)||Nc)){pb.$h.PBa(pb.f1,pb.eO);
return}}pb.pac=!1;pb.f1=pb.CXe();pb.f1&&pb.rza&&pb.gridView&&pb.gridView.Da.Es(pb.rza)?(pb.I0c=!1,pb.t_()):(pb.xh.F1c(),pb.xh.n3b());pb.pac||pb.$h.hide()}};pb.$=f;pb.tableManager=N;pb.contextMenuManager=fa;pb.$h=new v(f,pb.dd,D,Ia);pb.xh=D.m6c(f,N);pb.I0c=!1;pb.pac=!1;pb.nld=ye.EwaSettings.ma(136);pb.eOc=!0;pb.gridView=We.g(pb.$);pb.gridView.zc.wl(pb.mj);pb.gridView.yr(pb.BS);pb.$.fl(pb.vd);pb.$.Gl(pb.rd);pb.$.aB(pb.lj);pb.gridView.view.nt(pb.Gt);pb.gridView.ga.pZ(pb.zh);pb.dqb=mi.a.instance.create(pb.YX,
250,Ai.a.H7i);ld.ULS.sendTraceTag(537154143,0,50,"Feature TableWidget enabled");pb.xh.V_b(pb.Eza);pb.YX();f.da.Ha(261,pb);return pb}function v(f,D,N,fa){var Ia=il.call(this)||this;Ia.isMac=bj.a.isMac;Ia.$=f;Ia.ariaLiveNotifier=fa;Ia.gq=N.x6b(f,null,D,R.a.mzh,Te.a.Ge(9),oe.a.instance.fa(1691),"PulloutPointerDown");return Ia}function A(f){var D=Ok.call(this)||this;D.z6b=null;D.$=f;D.Xb();return D}function t(f){var D=Gk.call(this)||this;D.$=f;ye.EwaSettings.isChangeGateEnabled("OfficeVSO:6198510_AddServiceCreatedEvent")&&
D.Xb();return D}function E(){}function C(f,D,N,fa,Ia){N=void 0===N?null:N;fa=void 0===fa?null:fa;Ia=void 0===Ia?0:Ia;f=U.call(this,f,D)||this;f.TOa=null;f.Dgc=N||Te.a.current.Bo(82);f.ypf=Ia;f.M7c=fa;f.BFg();return f}function H(f,D,N,fa){f=U.call(this,f,D)||this;f.oDb=null;f.Hrg=N;f.Iai=fa;f.CFg();return f}function U(f,D){f=aj.call(this,f)||this;f.pDb=null;f.xdi=Math.max(1,D);return f}function Q(f,D,N,fa,Ia,pb,Wb,Nc){Nc=void 0===Nc?"":Nc;var kd=vj.call(this)||this;kd.xxa=null;kd.jcf=!1;kd.znc=null;
kd.ync=null;kd.buttons={};kd.iQe={};kd.$=f;kd.svgIconProvider=D;kd.jNi=N;kd.jod=fa;kd.iod=Ia;kd.altText=pb;kd.wHb=Wb;kd.buttonText=Nc;return kd}function O(f,D,N,fa,Ia,pb,Wb,Nc){function kd(Ie){Yf.g(Ie)}var Xc=wj.call(this,document.createElement("div"))||this;Xc.Inf=null;Xc.GVd=!1;Xc.HTa=null;Xc.sOb=null;Xc.iG=function(){Xc.raiseEvent("OnObjectButtonMouseOver")};Xc.GI=function(){Xc.raiseEvent("OnObjectButtonMouseOut")};Xc.xHj=function(){Xc.eoe()};Xc.dd=function(Ie){Xc.raiseEvent(Xc.wHb,Ie);Xc.uHb();
return!0};Xc.dDd=function(Ie){100<md.a(ff.a.Ra,Xc.Inf)&&Xc.Old(new Sys.UI.Point(Math.round(Ie.clientX),Math.round(Ie.clientY)))};Xc.yO=function(Ie){Yf.g(Ie.Ca,!1);return!1};Xc.a_=Xc.Rd.sua();Xc.set_visible(!1);Xc.ekc=Ia;Xc.wHb=pb;Xc.boc=f;Xc.n4b=D;Xc.ekc&&(Xc.HTa=mi.a.instance.create(Xc.xHj,3E4,"OnObjectButton.ShyTimerFired",!1,!1));f&&Xc.domElement.classList.add(f);Xc.A0a=document.createElement("div");Xc.domElement.appendChild(Xc.A0a);N&&Xc.A0a.classList.add(N);fa&&(Xc.A0a.innerHTML=fa);Wb&&(Xc.sOb=
document.createElement("div"),Xc.domElement.appendChild(Xc.sOb),Xc.sOb.classList.add(Nc),Xc.sOb.innerText=Wb,Xc.domElement.style.padding="3px",gi.a.instance.qa(hg.a.pointerDown,Xc.domElement,Xc.yO));Xc.s0a=new Ci.a(Xc.domElement,7);vi.a.instance.qa(hg.a.click,Xc.domElement,Xc.dd);ye.EwaSettings.isChangeGateEnabled("OfficeVSO:4996434_AvoidSelectionFromClickInOOUIPadding")&&gi.a.instance.qa(hg.a.pointerDown,Xc.domElement,Xc.yO);Xc.xc.ka("mouseup",kd);Xc.xc.ka("click",kd);Xc.xc.ka("dblclick",kd);return Xc}
function ea(){}function Z(f,D,N,fa){var Ia=S.call(this,f,D)||this;Ia.h3a=null;Ia.tBf=function(){Ia.Uuc(Ia.tBf);if(Ia.Rk&&Ia.Rk.length&&Ia.contextMenuManager){var pb=Ia.contextMenuManager.Ogd("autoFilterRichFieldList"),Wb=window.document.getElementById(Ia.h3a);pb.w1(null,Wb,Ia,null,!0)}};Ia.opg=N;Ia.contextMenuManager=fa;return Ia}function S(f,D){var N=Dh.call(this)||this;N.fQ=null;N.bxb=null;N.thd=null;N.dKb=null;N.CVb=!1;N.R7d=null;N.EQi=function(fa,Ia,pb){ld.ULS.sendTraceTag(25264350,0,10,"Call to GetRichValueFieldListContextList failed in: "+
pb);N.dKb&&N.dKb.stop();N.fQ=null;N.raiseEvent("GetFieldInfoListContextOperationFailed")};N.FQi=function(fa){Mh.a(fa)||(N.dKb&&N.dKb.stop(),N.CVb=!1,N.fQ=fa.Result,N.fQ&&0<N.fQ.length&&ld.ULS.sendTraceTag(25264351,0,50,"Retrieved {0} rich value field list context for autocomplete",N.fQ.length),N.Nkb=!0,N.qJd())};N.Nkb=!1;N.wb=f;N.oUb=-1;N.tableManager=D;return N}function I(f){var D=Ce.call(this)||this;D.firstElement=null;D.Eo=null;D.yNa=!1;D.Ys=null;D.pBj=bj.a.Hf||bj.a.FB;D.tDf=function(N){var fa=
N.Ca.keyCode;return fa===jj.a.fi?D.jPi():fa===jj.a.kE&&N.Ca.shiftKey?D.HDh(D.firstElement):!1};D.SIf=function(N){if(!D.yNa||N.Ca.keyCode!==jj.a.vM)return!1;I.Hbf();rg.Task.delay(1).CWRCC(function(){D.Eo.focus();return!0},D.la);return!0};D.TZi=function(){document.activeElement&&document.activeElement.id===D.Eo.id||(I.Hbf(),rg.Task.delay(1).CWRCC(function(){D.Eo.focus();return!0},D.la))};D.zBf=function(){D.Jdg(D.Eo)};D.sDf=function(N){N.stopPropagation();N.preventDefault();D.yNa&&(D.yNa=!1)};D.$=f;
(f=D.$.ea.pc)&&ld.ULS.sendTraceTag(39350791,0,50,"EmbedViewFocusControl: PermissionSet = {0}; InWebPart = '{1}', InEmbedView = '{2}'",f.uaa,f.inWebPart?"Classic":"Non Classic",f.inEmbedView?"True (+Modern)":"False (not Modern)");f&&(f.inWebPart||f.inEmbedView)?ld.ULS.sendTraceTag(537153856,0,15,"EwaControl.EmbedViewFocusControl: disable focus grabbing by embedded workbooks and disable some related keyboard navigation. InWebPart = '{0}', InEmbedView = '{1}'",f.inWebPart?"Classic":"Non Classic",f.inEmbedView?
"True (+Modern)":"False (not Modern)"):(D.F$g(),D.Cah(),nk.KeyInputManager.instance.qa(hg.a.Ub,D.$.domElement,D.SIf));D.$.da.Ha(238,D);return D}function P(f,D,N,fa,Ia){Ia=void 0===Ia?null:Ia;var pb=Dd.call(this)||this;pb.ypb=null;pb.pQa=null;pb.N0c=0;pb.Xqc=null;pb.tWi=function(){var Wb=pb.pQa.c2e();ld.ULS.sendTraceTag(537153861,0,50,"ActionAggregator<{0}>.OnRunningLong: Operation running for more than {1}ms",pb.tma,Wb);pb.Xqc=mi.a.instance.create(pb.pna,Math.max(pb.cze-Wb,0),Ai.a.Sne)};pb.pna=function(){ld.ULS.sendTraceTag(537153860,
0,50,"ActionAggregator<{0}>.OnTimeout: Operation running for more than {1}ms, timing out. Has pending actions: {2}",pb.tma,pb.pQa.c2e(),pb.k7a);pb.N0c++;pb.N0c>pb.bze&&ld.ULS.sendTraceTag(537153859,0,50,"ActionAggregator<{0}>.OnTimeout: passed the allowed bypassed count",pb.tma);pb.pQa.Qx.C();pb.LXe()};pb.Dza=function(){pb.k7a&&ld.ULS.sendTraceTag(537153858,0,50,"ActionAggregator<{0}>.OnDocumentUnhidden: Start. IsActionOngoing: {1}, AggregatedActionParams not null: {2}",pb.tma,pb.YMa,pb.k7a);pb.Lpd()};
pb.mDg=f;pb.nDg=D;pb.documentVisibilityObserver=N;pb.tma=fa;pb.xP=Ia;N&&pb.documentVisibilityObserver.dpb(pb.Dza);pb.M0c=!!N&&ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperation",!1);pb.bze=ye.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationLimit",3);D=ye.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationThresholdInMs",5E3);pb.cze=f.Sbc(D);f=ye.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationLogThresholdInMs",
1E3);pb.OWg=Math.max(pb.cze-D,0)+f;return pb}function J(){this.startTime=ff.a.Ra.Ob;this.Qx=new sh.a}function aa(f){var D=Xa.call(this)||this;D.$=f;D.Xb();return D}function ia(f,D,N,fa,Ia,pb,Wb){var Nc=this;this.$=f;this.functionInfoManager=D;this.calcManager=N;this.pluginScheduler=fa;this.formulaAssistanceUIControl=Ia;this.formulaAssistanceTelemetryManager=pb;this.xh=Wb;this.tTa=!0;this.zOa=null;this.yOa=-1;this.vda=0;this.Th=function(){We.g(Nc.$).isEditing||We.g(Nc.$).Vi||Nc.KEb()};this.onFunctionInfoLoaded=
function(){Nc.functionInfoManager.oJb(Nc.onFunctionInfoLoaded);Nc.zYj();Nc.iea()};this.pyf=function(){Nc.tTa=!1};this.xyf=function(kd,Xc){var Ie=Nc.Za;kd=Ie.text;Ie=Ie.textBox.caretPosition;0<Nc.vda&&Nc.formulaAssistanceTelemetryManager.xZ.commitWhileRequestPending++;Nc.formulaAssistanceTelemetryManager.kJ(["argumentAssistanceComputation"]);Xc.shouldRequestAutocompleteOnCommit?Nc.w0f(kd,Ie):Nc.MNd(kd,Ie)};this.Rg=function(){Nc.tTa=!0;ye.EwaSettings.isChangeGateEnabled("OfficeVSO:6103891_dismissControlOnEditEnded")&&
Nc.gMe()};this.Z6=function(kd,Xc){Nc.sPd(Xc.newValue)};this.Qg=function(){Nc.Sgg()};this.Sgg=function(){Nc.pluginScheduler.notifier().setDefinedNamesInfo(Nc.M7b.NKe)};this.functionInfoManager=D;this.formulaAssistanceUIControl=Ia;this.pluginScheduler=fa;this.mjf=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5951570_sendingNamedObjectsAutocompleteRequest");this.cca=ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ArgumentAssistanceDismiss",!1);this.vBd=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5656143_SendCellFormatOnCellChanged");
this.mjf&&(this.M7b=new rc(f),We.g(this.$).Da.aq(this.Qg),this.Sgg());this.ira=new da(this.$,this.formulaAssistanceUIControl,this.formulaAssistanceTelemetryManager);this.sga=new ka(this.$,this.formulaAssistanceUIControl,this.formulaAssistanceTelemetryManager);f.da.Ha(464,this);this.calcManager=N;cg.a.xW()&&this.lpd();this.cca&&(We.g(this.$).Ac.Wo(this.Rg),this.ira.AIg(this.pyf));this.o7a=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5724663_OptimizeAutocompleteRenderingUsingCache")}function ba(f,
D){var N=this;this.xh=f;this.$=D;this.Eza=function(){N.oac.resolve(N.xh.Rk);N.kfg();N.VAf||(We.g(N.$).Ac.Wo(N.Rg),N.VAf=!0)};this.bCf=function(){N.oac.reject(null);N.kfg()};this.Rg=function(){N.xh.$cb();We.g(N.$).Ac.Zn(N.Rg);N.VAf=!1}}function ra(){var f=this;this.promise=new Promise(function(D,N){f.Tyg=D;f.Cyg=N})}function ka(f,D,N){var fa=na.call(this,ka.XKa())||this;fa.$=f;fa.formulaAssistanceUIControl=D;fa.formulaAssistanceTelemetryManager=N;fa.Za=null;fa.Hr=null;fa.vJa=!1;fa.wJa=!1;fa.uJa=!1;
fa.sJa=!1;fa.tJa=!1;fa.Mx=null;fa.Y7=0;fa.gr=null;fa.kw=!1;fa.Cga=!1;fa.XBa=!1;fa.QTa=!1;fa.vNb=!1;fa.lPb=K.Dismissed;fa.onRestoreFocus=function(){};fa.dismiss=function(){fa.kw=!1;fa.dca&&fa.axd();fa.cL&&fa.Za.isEditing&&fa.Vna();fa.gr=null;fa.formulaAssistanceUIControl&&(fa.formulaAssistanceUIControl.dismiss(fa.domElement),fa.zla&&(fa.Hr.canReceiveFocus=!1),fa.lPb=K.Dismissed)};fa.uld=function(){fa.DNa&&fa.raiseEvent("FAFocusOnSmartSuggestionsCard",null)};fa.KOi=function(){fa.dismiss();We.g(fa.$).Uj.textBox.focus()};
fa.ISa=function(){var Ia={};fa.cJf?Ia[Bf.a.UV]="SmartSuggestionsCard":Ia[Bf.a.UV]="FunctionAndSmartSuggestionsCard";fa.$.ae(802602464,0,8,Ia)};fa.Rg=function(){fa.OAb&&fa.IMg()};fa.VCd=function(Ia,pb){fa.Ogb(pb);fa.dca&&(fa.wJa=!0)};fa.ld=function(){fa.visible=!1};fa.UCd=function(Ia){fa.dca&&(fa.tJa=!0);fa.jsb(Ia)};fa.li=function(){fa.dismiss()};fa.Gt=function(){void 0!==fa.gr&&null!==fa.gr&&fa.gr()};fa.zla=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5751361_AutocompleteAccessibilityLoop");fa.zla&&
(fa.Hr=new rb(fa.$,fa.formulaAssistanceUIControl,1,nj.a.Yed,fa.uld));We.g(fa.$).view.nt(fa.Gt);We.g(fa.$).ga.nH(fa.ld);fa.$.xa.Nf(fa.li);fa.WN=cg.a.WN(fa.$);fa.OAb=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5523443_FormulaSuggestionsCardUserInteractionTelemetry");fa.dca=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5609548_AddAutocompleteCardInteractionTelemetry");fa.DNa=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5793445_FormulaSuggestionsReadout");fa.Yqd=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:6018145_AutoCompleteDismissFocus");
fa.ANa=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:6019296_FormulaAutoCompleteShownReadout");fa.OAb&&We.g(fa.$).Ac.Wo(fa.Rg);ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceNoLayer",!1)&&fa.$.domElement.appendChild(fa.domElement);return fa}function da(f,D,N){var fa=ok.call(this,da.XKa())||this;fa.$=f;fa.formulaAssistanceUIControl=D;fa.formulaAssistanceTelemetryManager=N;fa.D3=0;fa.Hr=null;fa.gr=null;fa.jma=null;fa.kw=!1;fa.dS=!1;fa.ld=function(){fa.visible=!1};fa.onCardModeChange=
function(Ia){fa.wPb(Ia);1===Ia?fa.formulaAssistanceTelemetryManager.wba.argumentAssistanceCollapseCounter++:fa.formulaAssistanceTelemetryManager.wba.argumentAssistanceExpandCounter++};fa.ISa=function(Ia){var pb={};pb[Bf.a.UV]="ArgumentAssistanceCard";var Wb={};Wb.FunctionName=Ia.functionName;pb[Bf.a.Rcd]=Wb;fa.$.ae(802602464,0,8,pb)};fa.Gt=function(){void 0!==fa.gr&&null!==fa.gr&&fa.gr()};fa.onDismissClick=function(){fa.formulaAssistanceTelemetryManager.wba.argumentAssistanceDismissCounter++;fa.dismiss();
fa.raiseEvent("DC");fa.dS&&fa.EH.clear();0===fa.D3&&fa.wPb(1)};fa.Rg=function(){fa.dS&&fa.EH.clear()};fa.cca=ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ArgumentAssistanceDismiss",!1);fa.XRd();fa.Hr=new rb(fa.$,fa.formulaAssistanceUIControl,0,nj.a.Ved);We.g(fa.$).view.nt(fa.Gt);We.g(fa.$).ga.nH(fa.ld);fa.dS=ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceDismiss",!1)&&ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceDrag",
!1);fa.dS&&(fa.EH=new ib(fa.formulaAssistanceUIControl,fa.formulaAssistanceTelemetryManager),We.g(fa.$).Ac.Wo(fa.Rg));ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceNoLayer",!1)&&fa.$.domElement.appendChild(fa.domElement);return fa}function ha(f,D,N,fa,Ia,pb,Wb,Nc,kd){var Xc=Sj.call(this,f)||this;Xc.functionInfoManager=D;Xc.calcManager=fa;Xc.instantaneousSupportInformationManager=Ia;Xc.formulaAssistanceUIControl=Wb;Xc.formulaAssistanceTelemetryManager=Nc;Xc.pluginScheduler=
kd;Xc.Jfc=!1;Xc.Hr=null;Xc.wHa=null;Xc.Ig=null;Xc.JW=null;Xc.Wud=null;Xc.q6=null;Xc.A4a=0;Xc.Fbc=0;Xc.E4=0;Xc.dNe=0;Xc.fub=0;Xc.Afb=0;Xc.b7b=0;Xc.wzc=!1;Xc.Qja=null;Xc.Jrc=null;Xc.columnName="";Xc.S8c=!1;Xc.rAe=!1;Xc.LKa=[];Xc.iR=null;Xc.PTa=[];Xc.gr=null;Xc.wfd=null;Xc.i9=null;Xc.Cga=!1;Xc.XBa=!1;Xc.QTa=!1;Xc.vNb=!1;Xc.zOa=null;Xc.yOa=0;Xc.o5d=null;Xc.gEb=0;Xc.fqd=!1;Xc.onRestoreFocus=function(){};Xc.uld=function(){Xc.DNa&&Xc.raiseEvent(ha.yed,null)};Xc.VWe=function(){Xc.Qja=!1;Xc.JW=Xc.Za.text;
Xc.Pf.xKa(Xc.Mx,Xc.JW,!0,Xc.columnName,void 0,!1);1===Xc.Pf.Cs.length&&1===Xc.Pf.tX.length?(Xc.set_visible(!1),Xc.rAe||Xc.Egc()):Xc.show()};Xc.ORi=function(Ie){if(Mh.a(Ie))-315732528!==Ie.Errors[0].MessageId&&ld.ULS.sendTraceTag(537162013,0,10,"FormulaAssistanceControl.OnGetTableColHeadersSuccess - Webservice call failed with Unexpected error : {0}",Cf.a.Wc(Ie.Errors));else if((Ie=Ie.Result)&&Ie.length){Xc.Ig.wP||(Xc.Ig.wP={},Xc.Ig.wP.HeadersList=[]);Xc.Ig.wP.IsFullTableHeaders=!0;for(var Ze=0;Ze<
Ie.length;++Ze)Xc.Ig.wP.HeadersList[Ze]={},Xc.Ig.wP.HeadersList[Ze].Index=Ze,Xc.Ig.wP.HeadersList[Ze].Name=Ie[Ze];Xc.JLf(!0);Xc.JW=Xc.s7e();Xc.Pf.xKa(Xc.Mx,Xc.JW,!0,void 0,void 0,!0);Xc.show()}else ld.ULS.sendTraceTag(537162012,0,10,"FormulaAssistanceControl.OnGetTableColHeadersSuccess - Webservice call returned no results")};Xc.NRi=function(Ie){Ie=yf.a.mg(Ie.data);ld.ULS.sendTraceTag(537162011,0,10,"FormulaAssistanceControl.OnGetTableColHeadersFailure - Webservice call failed with Errors: {0}",Cf.a.Wc(Ie))};
Xc.Qxf=function(){We.g(Xc.$).isEditing||We.g(Xc.$).Vi||Xc.KEb()};Xc.Z6=function(Ie,Ze){Xc.sPd(Ze.newValue)};Xc.ld=function(){(ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AutocompleteTableColumnHeaders",!1)||Xc.Ln)&&Xc.set_visible(!1)};Xc.UBf=function(){Xc.wHa=null;Xc.i9=null};Xc.li=function(){Xc.Ln&&Xc.R2a()};Xc.onFunctionInfoLoaded=function(){Xc.aqb()};Xc.Eza=function(){Xc.kla?(Xc.i9=null,Xc.wHa=null,Xc.aqb()):Xc.xh.Rk&&Xc.$ve()};Xc.ida=function(){Xc.iR&&Ca(Xc.$,Xc.iR.HelpId,Xc.iR.IsDynamicUdf);
return!0};Xc.R2a=function(){Xc.dca&&Xc.axd();Xc.cL&&Xc.Za.isEditing&&Xc.Vna();Xc.gr=null;Xc.formulaAssistanceUIControl&&(Xc.formulaAssistanceUIControl.dismiss(Xc.Z1b),Xc.zla&&(Xc.Hr.canReceiveFocus=!1));Xc.fqd=!1};Xc.JGf=function(){Xc.cL&&Xc.Vna();Xc.s8f();1===Xc.g0f.type&&ye.EwaSettings.Gb()&&!Xc.Za.text.includes("\n")&&Xc.WHd(Xc.g0f)};Xc.onDismiss=function(){Xc.isListVisible=!1;We.g(Xc.$).Uj.textBox.focus()};Xc.ISa=function(){var Ie={};Xc.Pf.dkc?Ie[Bf.a.UV]="SmartSuggestionsCard":Ie[Bf.a.UV]="FunctionAndSmartSuggestionsCard";
Xc.$.ae(802602464,0,8,Ie)};Xc.VCd=function(Ie,Ze){Xc.Pf.Zhg(Ze);Xc.dca&&(Xc.wJa=!0)};Xc.UCd=function(Ie){Xc.dca&&(Xc.tJa=!0);Xc.cL?(Xc.DEe(),We.g(Xc.$).Uj.endEdit(!0,"FormulaAssistanceControl.OnCompletionItemClicked",0)):Ie.textEdit?Xc.jsb(Ie.textEdit):Xc.oz(!0)};Xc.gridView=We.g(f);Xc.domElement.className=ti.a.sQe;Xc.xh=pb.m6c(f,N);Xc.M7b=new rc(f);Xc.eBg=N;Xc.Ln=cg.a.WN(f);ha.Mnd||(ha.Mnd=ha.XKa());Xc.domElement.innerHTML=ha.Mnd;Xc.UBd=RegExp("\\d+");Pe.d(Xc.style,Xc.$.isChromeRtl);Xc.dka=new Da(Xc.$,
Xc.domElement,Xc.functionInfoManager,Xc.formulaAssistanceUIControl,Xc.formulaAssistanceTelemetryManager,Xc.pluginScheduler);D=$get(db.tfd,Xc.domElement);N=$get(db.ofd,Xc.domElement);fa=$get(db.vfd,Xc.domElement);Xc.Vsg=new oa(Xc.$,D,fa,N,Xc);Xc.xh.V_b(Xc.Eza);Xc.functionInfoManager.hpb(Xc.onFunctionInfoLoaded);Xc.functionInfoManager.XIg(Xc.UBf);Xc.Z1b=Xc.domElement;Xc.Ln&&(Xc.$.xa.Nf(Xc.li),Xc.Pf.Zre(Xc.JGf),ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceNoLayer",!1)&&
(Xc.Z1b=document.createElement("div")));Xc.gUa(!0);Xc.Dag(!0);Xc.$.domElement.appendChild(Xc.Z1b);Xc.aTc=0;(N=zk.a(f))&&Array.add(Xc.LKa,new pa(f,N,Xc,Xc.formulaAssistanceTelemetryManager));Array.add(Xc.LKa,new pa(f,Xc.gridView.zc,Xc,Xc.formulaAssistanceTelemetryManager));Xc.cwb=Xc.LKa[0];Xc.vrb=Xc.LKa[Xc.LKa.length-1];f.da.Ha(221,Xc);Xc.instantaneousSupportInformationManager||Xc.$.da.Ya(268,function(Ie){Xc.instantaneousSupportInformationManager=Ie});Xc.eWe=ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.LETAutocomplete",
!1);ye.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.MockSetActiveCell",0)&&(void 0===Xc.formulaAssistanceTelemetryManager.MSa.anyPluginInitialized?ld.ULS.sendTraceTag(523511372,0,15,"FormulaAssistanceControl - tried to initiailize mockSetActiveCellExperimentStage before pluginInitialized data is set."):Xc.formulaAssistanceTelemetryManager.MSa.anyPluginInitialized||(Xc.gEb=ye.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.MockSetActiveCell",0)));Xc.WBa=cg.a.CNa(Xc.$);Xc.BAc=cg.a.cud();
Xc.vBd=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5656143_SendCellFormatOnCellChanged");Xc.Yqd=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:6018145_AutoCompleteDismissFocus");cg.a.xW()&&Xc.lpd();cg.a.aO(Xc.$)&&D.classList.add("ewa-fb-refactor");Xc.Ln?We.g(Xc.$).ga.nH(Xc.ld):We.g(Xc.$).ga.pZ(Xc.ld);Xc.zla=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5751361_AutocompleteAccessibilityLoop");Xc.zla&&(Xc.Hr=new rb(Xc.$,Xc.formulaAssistanceUIControl,1,nj.a.Yed,Xc.uld));Xc.DNa=Xc.Ln&&ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5793445_FormulaSuggestionsReadout");
Xc.ANa=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:6019296_FormulaAutoCompleteShownReadout");return Xc}function qa(){}function Aa(){this.caretPosition=this.content=null}function Fa(){this.rowIndex=this.colIndex=0;this.builtIn=this.formatString=this.docName=this.docPath=this.sheetIndex=null}function ab(){this.callbacks=this.completionItems=null;this.activeItemIndex=0}function Ua(){this.onRestoreFocus=this.onDismiss=this.onFeedback=this.onCompletionItemCommitted=this.onCompletionItemSelected=null}
function bb(){this.q$=this._name=null}function xa(){this._name=null}function Gb(){this._name=null}function $b(){this.q$=this._name=null}function oa(f,D,N,fa,Ia){D=ui.call(this,f,D)||this;D.vsa=null;D.qxc=0;D.uNb=0;D.M4c=null;D.IZe=N;D.jwb=fa;D.formulaAssistanceControl=Ia;D.Cs=[];D.tX=[];D.Ln=cg.a.WN(f);D.ojf=D.Ln&&ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5931218_FaAvoidDomOperations");return D}function Ma(){this.textEdit=this.label=null;this.kind=0;this.shouldRequestAutocompleteOnCommit=this.data=
this.isPrefixed=this.detail=this.type=null}function Za(f,D){this.$=f;this.items=D;this.CNa=cg.a.CNa(this.$)}function gb(f,D){this.S5i=f;this.Ovf=D}function zb(){}function nb(f){this.index=f}function pa(f,D,N,fa){var Ia=qh.call(this,f,D)||this;Ia.formulaAssistanceControl=N;Ia.formulaAssistanceTelemetryManager=fa;Ia.bJf=!1;Ia.xTa=null;Ia.uod=0;Ia.rIc=null;Ia.$Ia=null;Ia.jR=0;Ia.mqb=D.textBox;Ia.o7a=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5724663_OptimizeAutocompleteRenderingUsingCache");Ia.Ln=
cg.a.WN(f);Ia.Tej=ye.EwaSettings.Gb();return Ia}function Ja(){this.Pia=this.Yta=this.Zta=!1;this.pJf=40;this.yDe=41;this.q1a=this.QFd=this.RFd=this.aHb=0;this.iAf=!0;this.qEd=!1;this.VXe=this.iQd=-1}function Da(f,D,N,fa,Ia,pb){var Wb=xi.call(this,Da.XKa(cg.a.WN(f)))||this;Wb.$=f;Wb.Fj=D;Wb.functionInfoManager=N;Wb.formulaAssistanceUIControl=fa;Wb.formulaAssistanceTelemetryManager=Ia;Wb.pluginScheduler=pb;Wb.c3a=null;Wb.D3=0;Wb.Hr=null;Wb.xZc=!1;Wb.gr=null;Wb.jma=null;Wb.tTa=!0;Wb.dS=!1;Wb.onCardModeChange=
function(Nc){Wb.wPb(Nc);1===Nc?Wb.formulaAssistanceTelemetryManager.wba.argumentAssistanceCollapseCounter++:Wb.formulaAssistanceTelemetryManager.wba.argumentAssistanceExpandCounter++};Wb.ISa=function(Nc){var kd={};kd[Bf.a.UV]="ArgumentAssistanceCard";var Xc={};Xc.FunctionName=Nc.functionName;kd[Bf.a.Rcd]=Xc;Wb.$.ae(802602464,0,8,kd)};Wb.onDismissClick=function(){Wb.formulaAssistanceTelemetryManager.wba.argumentAssistanceDismissCounter++;Wb.tTa=!1;Wb.Utb();Wb.dS&&Wb.EH.clear();0===Wb.D3&&Wb.wPb(1)};
Wb.Rg=function(){Wb.tTa=!0;Wb.dS&&Wb.EH.clear()};Wb.eQi=function(Nc){Nc.button===Sys.UI.MouseButton.leftButton&&Nc.target&&(Yf.g(Nc),Wb.c3a&&Wb.c3a.epa(Nc))};Wb.Gt=function(){void 0!==Wb.gr&&null!==Wb.gr&&Wb.gr()};Wb.Ln=cg.a.WN(f);Wb.cca=Wb.Ln&&ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ArgumentAssistanceDismiss",!1);Wb.Ln?(Wb.XRd(),Wb.Hr=new rb(Wb.$,Wb.formulaAssistanceUIControl,0,nj.a.Ved),Wb.cca&&We.g(Wb.$).Ac.Wo(Wb.Rg),Wb.dS=ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceDismiss",
!1)&&ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceDrag",!1)&&!!Wb.formulaAssistanceUIControl,Wb.dS&&(Wb.EH=new ib(Wb.formulaAssistanceUIControl,Wb.formulaAssistanceTelemetryManager)),ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceNoLayer",!1)&&Wb.$.domElement.appendChild(Wb.domElement)):(Wb.c3a=new pc(Wb.domElement,Wb.$.fF,void 0,cg.a.aO(Wb.$)),Wb.xc.ka("mousedown",Wb.eQi),f=$get(db.tfd,Wb.Fj),Wb.Fj.insertBefore(Wb.domElement,f));We.g(Wb.$).view.nt(Wb.Gt);
return Wb}function ib(f,D){this.wbc=f;this.formulaAssistanceTelemetryManager=D;this.un=!1;f={};this.usageCount=(f[ii.Drag]=0,f[ii.Move]=0,f);this.rFc=this.wbc.getWindowEdgeBuffer()+1;this.Luf=new wc(this);this.rNe=new Rb(this)}function Rb(f){this.EH=f;this.un=!1}function wc(f){var D=this;this.EH=f;this.F_=this.VTd=this.un=!1;this.onKeyDown=function(N){if(!D.F_&&N.keyCode===jj.a.Xpa&&N.altKey&&N.ctrlKey)return D.W9b(),N.stopPropagation(),N.preventDefault(),!0};this.oOa=function(N){if(!D.F_)return!1;
if(N.eventName===hg.a.Ub){var fa=N.Ca.ctrlKey?1:N.Ca.shiftKey?50:10;switch(N.Ca.keyCode){case jj.a.vVa:D.K6(0,-fa);break;case jj.a.Vpa:D.K6(0,fa);break;case jj.a.Wpa:D.K6(-fa,0);break;case jj.a.Zgb:D.K6(fa,0);break;case jj.a.vM:case jj.a.fi:D.VTd=!0;break;default:return!1}}N.eventName===hg.a.Td&&D.VTd&&D.Y4(!0);N.Ca.preventDefault();return!0};this.vHb=function(N){if(!D.F_)return!1;N.Ca.preventDefault();D.Y4();return!0};this.onBlur=function(){if(!D.F_)return!1;D.Y4();return!0};this.Lr=nk.KeyInputManager.instance;
this.pointerInputManager=gi.a.instance}function Cb(){this.content=null;this.caretPosition=0}function lb(){this.callbacks=this.functionRenderingInfo=null;this.cardMode=0}function yb(){this.onDismissClick=this.onFeedback=this.onHelpLink=this.onCardModeChange=null}function pc(f,D,N,fa){fa=void 0===fa?!1:fa;D=Bi.call(this,f,D,!1,void 0===N?null:N)||this;D.fTa(fa);D.rj=Ba.a.equals("rtl",f.dir,!0);return D}function Ta(f,D){var N=xh.call(this)||this;N.$sg=[];N.xfd={};N.LZe={};N.cU=null;N.G9=[];N.UKa={};
N.iCf=function(fa,Ia){ld.ULS.sendTraceTag(537161987,0,50,"FunctionInfoManager.OnGetFunctionListPartialSucceeded");N.VBf(fa,!!Ia&&1!==Ia.FilterType,!0)};N.hCf=function(){ld.ULS.sendTraceTag(537161986,0,50,"FunctionInfoManager.OnGetFunctionListPartialFailed -  reset varaible to ensure we will re-issue the webservice call");N.cU=null};N.SBf=function(fa){ld.ULS.sendTraceTag(537161985,0,50,"FunctionInfoManager.OnFullFunctionListLoaded - full list was loaded");N.JKd(fa.jka,!0,!1)};N.gCf=function(fa){ld.ULS.sendTraceTag(537161984,
0,50,"FunctionInfoManager.OnGetFunctionListFullSucceeded");N.VBf(fa,!0,!1)};N.zNc=!1;N.xNc=!1;N.wb=f;N.pluginScheduler=D;N.$.da.Ha(19,N);return N}function rb(f,D,N,fa,Ia){this.v1c=!1;this.$=f;this.formulaAssistanceUIControl=D;this.iZe=N;this.grj=fa;this.V9e=void 0===Ia?null:Ia}function ic(f,D,N){var fa=Oi.call(this)||this;fa.ufd=f;fa.xQd=D;fa.X0i=N;return fa}function Va(f){var D=Vi.call(this)||this;D.xQd=f;return D}function jb(f,D){var N=hi.call(this)||this;N.functionName=f;N.ufd=D;return N}function rc(f){this.OKe=
{};this.$=f}function Cc(){this.sheetName=this.namedRange=this.tooltip=this.name=null;this.type=0}function Hc(){this.gU=0;this.ube=!1;this.uXa=this.Tce=null;this.Ace=!1;this.textEdit=null}function Nb(f){var D=this;this.jtb=this.via=this.calcManager=this.Za=null;this.T$a=function(){D.B6a(!1,!1)};this.$=f;this.bwb=new Ha(f);this.ubc=new Ub(f);this.vbc=new nc(this);We.g(f).zc.Wo(this.T$a);this.$.da.Ha(317,this)}function nc(f){this.D8=0;this.Wed=f}function Ha(f){this.Dra=this.iUa=this.A3a=this.$Q=this.xaa=
this.Za=null;this.smd=!1;this.Qc=f}function tb(){}function Ub(f){var D=this;this.cEi=30;this.calcManager=null;this.Pd=!1;this.qQa=this.lHb=this.cbb=null;this.AD=function(){D.xia.J_()};this.$=f;this.xia=new Eb;this.SWf=-1;this.$.ea.UE(this.AD)}function gc(f,D,N,fa,Ia,pb,Wb){Wb=f.Ma(1,void 0===Wb?null:Wb);Wb.getPartialCalcResultsParameters=D;return Se.i(f,"GetPartialCalcResults",Wb,N,fa,Ia,pb,4)}function Eb(){this.fSa={}}function Tb(f){var D=mg.call(this)||this;D.$=f;D.Xb();return D}function Wc(f,D){var N=
this;this.TKa=this.Wva=this.eka=null;this.zFf=function(fa,Ia){N.caj(Ia.functionName,Ia.ufd)};this.BFf=function(fa,Ia){N.baj(Ia.ufd,Ia.xQd,Ia.X0i)};this.AFf=function(fa,Ia){fa=[];Ia=Cl(Ia.xQd);for(var pb=Ia.next();!pb.done;pb=Ia.next())pb=pb.value,(!N.n7a||void 0!==pb&&null!==pb)&&(pb=pb.trim())&&Array.add(fa,pb);if(!N.n7a||fa.length){Ia="";for(pb=0;pb<fa.length;pb++){var Wb=N.C0c(fa[pb]),Nc=Wc.mHd(pb,fa.length);Ia+=Wb+Nc;Nc&&(Ia+=N.ariaLiveNotifier.Uya)}N.ariaLiveNotifier.readText(Ia)}};this.CFf=
function(fa,Ia){N.ariaLiveNotifier.eaj(Ia.aJ,Ia.description,Ia.selectedIndex.toString(),Ia.length.toString(),N.ANa)};this.vFf=function(fa,Ia){N.ariaLiveNotifier.qQf(Ia.description,Ia.length)};this.OBf=function(){N.ariaLiveNotifier.$bb(oe.a.instance.fa(865),Bf.a.P_a)};this.HBf=function(){N.ariaLiveNotifier.readText(oe.a.instance.fa(866))};this.KBf=function(){N.ariaLiveNotifier.readText(oe.a.instance.fa(867))};this.$=D;this.ariaLiveNotifier=f;this.$.da.Ha(219,this);this.n7a=cg.a.WN(D);this.DNa=cg.a.WN(D)&&
ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5793445_FormulaSuggestionsReadout");this.ANa=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:6019296_FormulaAutoCompleteShownReadout")}function T(f){return jg.call(this,f)||this}function ua(f,D,N){var fa=this;this.PKh="FinancialFns LogicalFns TextFns DateTimeFns LookupReferenceFns MathTrigFns StatisticalFns EngineeringFns CubeFns InformationFns".split(" ");this.menuId=null;this.onFunctionInfoLoaded=function(){fa.menuId&&Array.contains(fa.PKh,fa.menuId)&&
fa.frame.Vv(fa.menuId)};this.$=f;this.functionInfoManager=N;this.Ta=D;if(this.pD=cg.a.pD(this.$))this.formulaAssistanceManager=this.$.da.Aa(464);this.eN={};this.frame=this.$.frame;this.functionInfoManager.hpb(this.onFunctionInfoLoaded)}function ma(f,D){var N=uf.call(this,f,oe.a.instance.fa(1003),void 0,void 0,void 0,ye.EwaSettings.ma(401))||this;N.SKa=null;N.ika=null;N.RKa=null;N.lwb=null;N.FZe=null;N.hka=null;N.GZe=null;N.JZe=null;N.Apf=null;N.kwb=null;N.Gmd=!1;N.w3b=null;N.L6=null;N.Syb=null;N.onFunctionInfoLoaded=
function(){if(!N.RKa.count){for(var fa=N.functionInfoManager.AZe,Ia=0,pb=fa.length;Ia<pb;++Ia)N.RKa.XM(fa[Ia],fa[Ia],!1).className=X.a.Ish;N.RKa.selectedIndex=0;Ag.a.tc([N.w3b,N.L6,N.Syb]);N.w3b=N.Rd.Gd(N.SKa);N.L6=N.Rd.Gd(N.ika);N.Syb=N.Rd.Gd(N.kwb);N.w3b.ka("change",N.TBf);N.L6.ka("change",N.fQi);N.L6.ka("dblclick",N.gQi);N.Syb.ka("click",N.ida);N.Syb.ka("keyup",N.hSi);$a.DOMElementExtensions.setVisible(N.ika,!0);$a.DOMElementExtensions.setVisible(N.FZe,!1);N.$.e8c&&$a.DOMElementExtensions.setVisible(N.Apf,
!0)}N.TBf(null);N.getButton(0).get_element().disabled=!1;N.SKa.disabled=!1;N.ZSa();N.Gmd=!0};N.ida=function(){N.Faa&&Ca(N.$,N.Faa.HelpId,N.Faa.IsDynamicUdf)};N.hSi=function(fa){13!==fa.keyCode&&32!==fa.keyCode||N.ida(fa)};N.TBf=function(){var fa=N.functionInfoManager.P2e(N.RKa.ve.value);N.cwa(fa);N.ika.scrollTop=0;N.a2f()};N.fQi=function(){N.a2f()};N.gQi=function(fa){N.Faa&&(Yf.g(fa),N.close(0))};N.fd=function(fa,Ia){ya.b(Ia)&&N.eu()};N.functionInfoManager=f.da.Aa(19);N.formulaAssistanceControl=f.da.Aa(221);
N.Xed=cg.a.pD(N.$);N.Xed&&(N.formulaAssistanceManager=f.da.Aa(464));N.NJa=D;N.a2c=D.textBox.caretPosition;return N}function wa(f){var D=Ya.a.x0,N=f.da.Aa(368);N&&!We.g(f).yj&&(D=N.zoom);return D}function Ca(f,D,N){if(f){var fa=f.da.Aa(491);fa?fa.wba.argumentAssistanceLearnMoreCounter++:ld.ULS.sendTraceTag(523551513,0,50,"FormulaAssistanceExtensions: logHelpLinkClick getService returned a null formulaAssistanceManager");if(N){if(D&&(!D||D.startsWith("http://")||D.startsWith("https://"))){if(f.ma(157)&&
(f=f.da.Aa(269))&&f.DCa(D))return;ca.HelperMethods.wf(D,"_blank",kb.a)}}else N=new bg.a(-859308420,tf.a.$b,f.jd,0,null),fa={},D=(fa[tf.a.od]=Bf.a.oW,fa[tf.a.Gg]="HelpID="+D,fa),f.Ka.dc(N,D)}}function db(){}function Sa(f){var D=Fk.call(this)||this;D.$=f;D.Xb();return D}function hb(f){var D=gk.call(this,document.createElement("div"))||this;D.pS=!1;D.WR=!1;D.M2b=!1;D.Rh=null;D.ai=null;D.Uli=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:6172290_DataValidationConditionalHideAll");D.Vli=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:6172279_DataValidationConstButtonWidth");
D.msd=!1;D.ftd=!1;D.pqd=!1;D.y7b=[];D.Th=function(){D.z7f(!1)};D.aQa=function(fa,Ia){D.show(D.hS,!D.isListVisible,!0,bj.a.zp||3===Ia.zb||3===tf.a.$b);D.$Cd(null,null)};D.$Cd=function(){D.gridView.setFocus()};D.GMa=function(){D.Za.textBox.VK=!0};D.Gt=function(){D.Fhg()};D.onContentReady=function(){D.z7f(D.isListVisible)};D.rd=function(){D.py()};D.Qza=function(){D.SSa()};D.SAf=function(){D.Fhg()};D.$=f;D.gridView=We.g(D.$);D.CJ=D.gridView.zc;var N="<div id='dv_reader_description' class='"+kk.a.GRe+
"' role='alert' aria-live='polite'></div>\r\n<div id='dv_list_button' class='"+ac.Wsh+" "+R.a.kp+"'></div>\r\n<div id='dv_list_box' class='"+ac.csh+" "+R.a.il+" "+R.a.kp+"'></div>\r\n<div id='dv_prompt_box' class='"+ac.Ush+" "+R.a.kp+"'></div>";D.domElement.className=ac.Vsh;D.domElement.innerHTML=N;Pe.d(D.style,D.isGridRtl);D.pg=$get("dv_list_box",D.domElement);D.N0=$get("dv_prompt_box",D.domElement);D.Eta=$get("dv_list_button",D.domElement);D.hDb=$get("dv_reader_description",D.domElement);(N=zk.a(f))&&
Array.add(D.y7b,new Sb(f,N,D));Array.add(D.y7b,new Sb(f,D.gridView.zc,D));D.gridView.ga.XJ(D.Th);D.gridView.yr(D.onContentReady);D.gridView.Ac.EIg(D.SAf);D.$.Gl(D.rd);N=D.gridView.Fj;N.insertBefore(D.domElement,N.firstChild);D.onContentReady(null,null);f.da.Ha(14,D);return D}function Xb(f,D,N,fa,Ia,pb,Wb,Nc,kd,Xc){var Ie=Mk.call(this,document.createElement("a"))||this;Ie.El=!1;Ie.dd=function(Ze){Ie.raiseEvent("ClickButton",Ze);return!0};Ie.onKeyDown=function(Ze){Ie.raiseEvent("KeyDown",Ze);return!1};
Ie.$w=function(){Ie.hovered=!0;Ie.raiseEvent("PointerOver");return!1};Ie.HO=function(){Ie.hovered=!1;Ie.raiseEvent("PointerOut");return!1};Ie.onBlur=function(Ze){Yf.g(Ze);Ie.focused=!1;Ie.raiseEvent("Blur")};Ie.onFocus=function(Ze){Yf.g(Ze);Ie.focused=!0;Ie.raiseEvent("Focus")};Ie.dph=Nc;Ie.Qjh=kd;Ie.IJ=Xb.Cb(Ie.domElement,D,N,fa,Ia,pb,Wb,Xc);Ie.xc.ka("contextmenu",function(Ze){Yf.g(Ze)});Ie.enable();Ie.hovered=!1;Ie.focused=!1;f.appendChild(Ie.domElement);return Ie}function xb(f,D,N){f=fk.call(this,
f,D,new Sk.a(ac.listItem,ac.dDb,ac.iDb,ac.jDb))||this;f.jnb=null;f.ve=null;f.vea=null;f.QW=null;f.eJa=null;f.QOa=0;f.QGb=[];f.DWj=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:6172276_UpdateDvListHeightUsingItemHeight");f.hDb=N;return f}function Sb(f,D,N){f=mk.call(this,f,D)||this;f.dataValidationControl=N;return f}function qb(f,D,N){var fa=Yj.call(this,f)||this;fa.Maa=null;fa.NV=null;fa.ykf=!1;fa.errorMessage=null;fa.gbf=null;fa.Hm=null;fa.Tea=null;fa.VJe=function(Ia){var pb=fa.$,Wb=fa.ykf;fa.hide();
var Nc=We.g(pb);Nc.isEditing&&Nc.zc.endEdit(!1,"DataValidationErrorDialog.DataValidationErrorDialogHandler",0);1===Ia&&Wb&&ud.TaskExtensions.Ba(Nc.startEdit(!1,1),function(){var Xc=Nc.zc.textBox;Xc.text&&Xc.selectRange(0,Xc.text.length)},fa.la,11,Vc.a.current);if(1===Ia&&!Wb){if(Wb=Nc.rc(null)){Nc.Da.wW();var kd=Object.assign(new ta.a,{Text:ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5785565_FixDataValidationErrorDialogHandlerBug")?Wb.cell.userInput:Wb.originalText});Nc.setCell(kd,Wb.range,0,63,
null)}pb.ae(-798660877,tf.a.$b,8,null)}2===Ia&&ud.TaskExtensions.Ba(Nc.startEdit(!1,0),function(){var Xc=Nc.zc.textBox;Xc.text&&Xc.selectRange(0,Xc.text.length)},fa.la,11,Vc.a.current)};fa.W$a=function(){ca.HelperMethods.pda(fa.$.sJ,fa.error.HelpTopicId,fa.$.qY)};fa.$Ri=function(){fa.bzb();fa.$.ae(802602464,2,8,fa.NV)};fa.xQi=function(){ld.ULS.sendTraceTag(537163288,0,10,"DataValidationErrorDialog.OnGetDataValidationRuleInformationFailureCallback, failed to get expected results.")};fa.yQi=function(Ia){!Ia||
Mh.a(Ia)?ld.ULS.sendTraceTag(537163287,0,10,"DataValidationErrorDialog.OnGetDataValidationRuleInformationSuccessCallback, failed to get expected results."):(Ia=fa.x1h(Ia.Result),fa.Maa.errorInformation=Ia,fa.ODc(fa.YJa,fa.Ljd(fa.VJe),fa.Maa))};fa.pDd=function(){fa.show(fa.yTb)};fa.ZPe=N;fa.sqmManager=Ck.a(fa.$);fa.error=qb.JR(D,f,N);fa.yb.jq=fa;f=f.da.Aa(14);fa.dv=f.Y4a(fa.ZPe);fa.YJa=fa.dv&&fa.dv.YJa?fa.dv.YJa:oe.a.instance.fa(1687);fa.avj();fa.initializeAndShow(fa.YJa,fa.VJe,fa.Maa);return fa}function mb(f,
D,N){var fa=Ki.call(this,f,mb.JR(D,f,N))||this;fa.ld=function(){fa.setFocus()};We.g(fa.$).ga.nH(fa.ld);ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5780477_datavalidationListRule")&&(f=f.da.Aa(14).Y4a(N))&&f.options&1&&ld.ULS.sendTraceTag(537163291,0,50,"DataValidationErrorDeprecatedDialog.DataValidationErrorDeprecatedDialogs, Data validation Error opened on a list rule.");return fa}function ac(){}function Uc(f){var D=wk.call(this)||this;D.$=f;D.Xb();return D}function Zc(f,D){var N=this;this.$_a=
null;this.wFf=function(fa,Ia){1<Ia.length&&(fa=oe.a.instance.fa(840),N.ariaLiveNotifier.qQf(fa,Ia.length))};this.xFf=function(fa,Ia){ld.ULS.shipAssertTag(537167961,0,0<=Ia.selectedIndex&&0<=Ia.length&&Ia.selectedIndex<Ia.length,"Invalid ListEventArgs: SelectedIndex/Length");ld.ULS.shipAssertTag(537167960,0,!!Ia.aJ,"ListEventArgs: SelectedValue should not be null");N.ariaLiveNotifier.daj(Ia.aJ,Ia.selectedIndex+1,Ia.length)};this.yFf=function(fa,Ia){N.ariaLiveNotifier.oRa(Ia.aJ)};this.ariaLiveNotifier=
f;ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ServiceInit",!1)||D.Ha(213,this)}function Kc(f){var D=wg.call(this)||this;D.$=f;D.Xb();return D}function va(f){var D=Kk.call(this)||this;D.$=f;D.Xb();return D}function fb(f,D){var N=this;this.BOa=1;this.Aha=[];this.active=!1;this.ax=function(){var fa=N.gridView.Ekd();if(!(0>=fa||fa===N.BOa||N.gridView.jr)){for(var Ia=!1,pb=[],Wb=[],Nc=N.Aha.length-1;0<=Nc;Nc--){var kd=N.Aha[Nc];if(N.Dkd(kd)>fa||kd.bottom<fa)Array.add(pb,kd),Array.removeAt(N.Aha,
Nc),Ia=!0}for(Nc=N.tableManager.rangeList.length-1;0<=Nc;Nc--){kd=N.tableManager.rangeList[Nc];var Xc=N.Dkd(kd);Xc<=fa&&kd.bottom>=fa&&!(Xc<=N.BOa&&kd.bottom>=N.BOa)&&kd.Pba&&(Array.add(Wb,kd),Ia=!0)}if(Ia)for(kd=ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ApplyHeaderSnappingOnVerticalFreezePane",!1)?N.gridView.xrc:[N.gridView.a4],Nc=Cl(kd),kd=Nc.next();!kd.done;kd=Nc.next())for(Xc=Cl(kd.value),kd=Xc.next();!kd.done;kd=Xc.next()){var Ie=Cl(kd.value);for(kd=Ie.next();!kd.done;kd=Ie.next()){for(var Ze=
kd.value,Sf=Ze.Sn,ag=al.a(Ze.E5),og=pb.length-1;0<=og;og--)kd=pb[og],N.wCc(kd,!1,ag,Sf)&&Array.removeAt(pb,og);for(og=Wb.length-1;0<=og;og--)kd=Wb[og],N.wCc(kd,!0,ag,Sf)&&Array.add(N.Aha,kd);Ia&&Ze.VRd(ag)}}else ld.ULS.sendTraceTag(537157657,0,50,"HeaderSnappingFeature:OnVisibleAreaChanged: detected an opportunity for bailing out");N.BOa=fa}};this.JCf=function(fa,Ia){Ia.isRow||Ia.lYc(N.kMa)};this.KCf=function(fa,Ia){Ia.isRow||(N.tableManager.rangeList.length||N.deactivate(),Ia.WMd(N.kMa))};this.kMa=
function(fa,Ia){if(N.qe())N.activate();else if(fa=N.active,N.deactivate(),!fa){ld.ULS.sendTraceTag(537157652,0,50,"HeaderSnappingFeature:HeaderBlockOnUpdatedBlockHtml: detected an opportunity for bailing out");return}(Ia=Ia.ou)&&N.C9f(Ia.Sn[0],Ia.Sn[Ia.Sn.length-1],Ia.E5,Ia.Sn)};this.qFf=function(fa,Ia){!N.gridView.jr&&(N.qe()?N.activate():(fa=N.active,N.deactivate(),fa||ld.ULS.sendTraceTag(537157651,0,50,"HeaderSnappingFeature:OnRangeListUpdated: detected an opportunity for bailing out")),Ia=Ia.ou)&&
(fa=al.a(Ia.E5),N.C9f(Ia.Sn[0],Ia.Sn[Ia.Sn.length-1],fa,Ia.Sn)&&Ia.VRd(fa))};this.Ie=function(){N.gridView.rb.z5?N.deactivate():N.activate()};this.tableManager=f;this.gridView=D;this.$=D.$;f.Qre(this.qFf);D.cJg(this.JCf);D.dJg(this.KCf);this.$.xa.Nf(this.Ie);this.$.Ab.Nf(this.Ie);this.qve(function(fa){fa.lYc(N.kMa)});this.qe()&&(this.activate(),this.ax(this,null));this.$.da.Ha(68,this)}function Pb(f){return hl.call(this,f)||this}function sc(f,D,N,fa,Ia,pb,Wb){var Nc=this;this.$=f;this.gridView=D;
this.Jh=N;this.SB=fa;this.borderFormatManager=Ia;this.moreColorsHelper=pb;this.Ded=Wb;this.jB=null;this.I0a=1461300262;this.Ex=this.F0a=this.c$a=this.tbc=null;this.HSi=function(kd,Xc){if(!Mh.a(kd)&&Xc){var Ie=!!kd&&!!kd.RequestTelemetryData;We.g(Nc.$).Ri.xma(Xc,kd.StateId,Ie?kd.RequestTelemetryData.EcsOperationDuration:0,Ie?kd.RequestTelemetryData.EcsRequestDuration:0,Ie?kd.RequestTelemetryData.WfeRequestDuration:0)}};this.Qrb=function(){if(Nc.gridView.J7a){var kd=Nc.$.da.Aa(254,!0);kd&&kd.Ghj(Nc.Qrb);
Nc.gridView.J7a=!1;Nc.gridView.Lg.Np(Bf.a.v5);Nc.gridView.ga.EX(Nc.Ued);We.g(Nc.$).$.Cf()}};this.Ued=function(){var kd=Nc.tbc;Nc.tbc=Tc.d(Nc.$.xa.oa);if(kd===Nc.tbc)if(Nc.gridView.ga.EX(Nc.Ued),(kd=Nc.$.da.Aa(254,!0))&&kd.u1c(36,We.g(Nc.$).ga.va.selectedRanges)){kd=new bg.a(1804571062,2,2,0,null);var Xc={};Nc.$.Ka.dc(kd,(Xc[Bf.a.skipClipboardAccess]=!0,Xc[Bf.a.Z2c]=!0,Xc[Bf.a.isFormatPainter]=!0,Xc)).continueWith(function(){Nc.Qrb()})}else Nc.gridView.Lg.xH(!1)};this.Gb=ye.EwaSettings.Gb();this.mnc=
new hd(this.$,N);this.qD=ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1);this.Nm=ye.EwaSettings.Nm();this.tu=cg.a.tu()}function hd(f,D){this.$=f;this.Jh=D;this.iB=new Ue(We.g(this.$).Da,this.$);this.ckf=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5412627_MergeCellRangeBorderScenariosTelemetry");this.pAb=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5607672_MergeCellCseForOutOfViewPortCells");this.rsd=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5658006_MergeCellCSEBugFixesforCellStylesAndRTL");
this.Xic=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5954689_MergeCellCSEUnmergewithMergeCommand");this.gif=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:6013788_MergeCellHighGetRangeNumbersTelemetry");this.Lli=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:6100978_MergeCellCSEIsCsePossibleForWrapTextWrongValueForUnmergeCommandFix");this.$lf=ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellUnmergeWithBorderScenariosCse",!1);this.Gjc=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:6147046_MergeCellCSERangeBorderScenarioFix");
this.fBb=ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellMultipleBlocksScenarioCse",!1);this.Yic=ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellBorderScenarioCse",!1)}function Ob(){this.scenario=0;this.CR=null}function Ac(){this.lSa=this.DHa=this.JOa=this.IUa=0}function sb(f,D,N,fa){this.targetSheetRange=this.sourceSheetRange=null;this.fillRangeDirection=this.fillRangeType=0;this.sourceSheetRange=f;this.targetSheetRange=D;this.fillRangeType=N;this.fillRangeDirection=
fa}function ad(f,D,N){var fa=Ak.call(this,f)||this;fa.uo=null;fa.m9c=0;fa.uhi=function(Ia,pb){if(0===Ia)ld.ULS.sendTraceTag(574993491,0,50,"InsertDeleteCellsDialog.InsertDeleteCellsDialogHandler: User pressed Cancel");else{Ia={};var Wb="",Nc=1035996630;switch(pb.selectedKey){case 0:Wb=1896159024===fa.Lp?"InsertCellsShiftRight":"DeleteCellsShiftLeft";break;case 1:Wb=1896159024===fa.Lp?"InsertCellsShiftDown":"DeleteCellsShiftUp";break;case 2:1896159024===fa.Lp?(Wb="InsertRows",Nc=-1113896058):(Wb="DeleteRows",
Nc=1554436520);break;case 3:1896159024===fa.Lp?(Wb="InsertColumns",Nc=1415868706):(Wb="DeleteColumns",Nc=674605324)}ld.ULS.sendTraceTag(574993490,0,50,"InsertDeleteCellsDialog.InsertDeleteCellsDialogHandler: Handle RibbonCommand.InsertOrDeleteCells, MenuItemId:{0}",Wb);pb=new bg.a(Nc,1,2,8,null);Ia[tf.a.od]=Wb;fa.$.Ka.dc(pb,Ia)}};fa.Lp=D;fa.selectedRanges=N;f=Object(k.a)(sd.a,fa.$.xa.oa);fa.isRtl=f.displayRtl;return fa}function Hd(f,D,N,fa,Ia,pb){var Wb=this;this.A3d=!1;this.B3d=null;this.WFc=0;this.qj=
null;this._state=0;this.moveNext=function(){try{for(Wb._state=1;1===Wb._state;)Wb.Tu=Wb.Tu()}catch(Nc){Wb.dispose(),Wb._state=3}};this.Ef=f;this.lDa=D;this.kDa=this.o3d=Ia;this.QQb=pb;this.Tu=this.AM;this.moveNext()}function Ne(f,D,N,fa,Ia,pb,Wb,Nc){var kd=this;this.TFc=0;this.D3d=this.XFc=!1;this.qj=this.F3d=null;this._state=0;this.moveNext=function(){try{for(kd._state=1;1===kd._state;)kd.Tu=kd.Tu()}catch(Xc){kd.dispose(),kd._state=3}};this.Ef=f;this.lDa=D;this.rlg=Ia;this.kDa=this.o3d=pb;this.QQb=
Wb;this.n3d=Nc;this.Tu=this.AM;this.moveNext()}function Ud(f,D,N,fa,Ia){this.PYe=0;this.Tsg=f;this.Usg=D;this.QAg=N;this.rYb=fa;this.PYe=void 0===Ia?0:Ia}function Ge(f){var D=this;this.menuId=null;this.Zvb=0;this.OFi="+mn-lt";this.KCi="+mj-lt";this.pVi=function(N){D.Rjf=!0;D.vXg=null;D.$.gD(function(fa){fa.RQa("FontName_New")});ld.ULS.sendTraceTag(537159511,1,15,String.format("PreviewFont Status is {0}",N))};this.XPi=function(N,fa,Ia){ld.ULS.sendTraceTag(524042310,1,50,"FontDropdownHelper.onFontPreviewRequestComplete: Attempt to request FontUrl method: {0} has succeeded.",
Ia);D.k5i(N);D.Zvb=2;D.IRf()};this.YPi=function(N,fa,Ia){ld.ULS.sendTraceTag(524042309,1,10,"FontDropdownHelper.onFontPreviewRequestFailed: Encountered errors for {0}.",Ia);D.Zvb=3;D.IRf()};this.$=f;this.frame=this.$.frame;this.Eki=!!String.fromCodePoint&&!bj.a.uf&&!!window.gridRenderer&&gridRenderer.CanvasRendererGlobals.isFontLoadApiSupported();this.Rjf=!1;this.vXg=null;this.Nm=ye.EwaSettings.Nm();(this.tu=cg.a.tu())&&this.Vkj()}function Sc(f){this.lv=f}function Pc(){}function Zd(f){this.insertDeleteMultiRangeParameters=
null;this.insertDeleteMultiRangeParameters=f}function ie(f){var D=Qi.call(this)||this;D.$=f;D.Xb();return D}function vd(f){return Qj.call(this,f)||this}function Lb(f,D){var N=this;this.Bbc=this.VId=null;this.PBf=function(){ye.EwaSettings.ma(681)||N.Yvc();if(N.Bbc){var fa=Aj.a(ff.a.Ra.ke,N.Bbc);ld.ULS.sendTraceTag(570949840,5,50,"FreezePanesCommandHandler.OnFreezePanesUpdateCompleted: duration of FreezePane from operation until allBlockUpdated: {0}",fa);N.Bbc=null}N.tJf()};this.$=f;this.gridView=We.g(f);
this.dG=D.d2a(this.$.domElement,500,null,null);this.YLa=this.XLa=-1}function id(f){this.freezeOptions=null;this.freezeOptions=f}function uc(){}function ed(f){var D=Qh.call(this)||this;D.oqj="formulaAssistance";D.$=f;D.Xb();return D}function Cd(){this.isFeedbackAllowed=!1;this.zoomLevel=0}function $d(f){var D=mh.call(this)||this;D.$=f;D.Xb();return D}function La(f){var D=this;this.iB=this.calcManager=this.Ol=this.KTa=null;this.ZPi=function(N,fa){if(N&&!Mh.a(N)&&fa){var Ia=!!N&&!!N.RequestTelemetryData;
We.g(D.$).Ri.xma(fa.toString(),N.StateId,Ia?N.RequestTelemetryData.EcsOperationDuration:0,Ia?N.RequestTelemetryData.EcsRequestDuration:0,Ia?N.RequestTelemetryData.WfeRequestDuration:0)}};this.$=f;this.$.da.Ya(268,function(N){D.Ol=N});this.zJh=new He(We.g(this.$).Da,this.$);this.N3=new Hf(this.$,We.g(this.$),this);this.$.da.Ya(266,function(N){D.calcManager=N});this.Gb=ye.EwaSettings.Gb();this.Nm=ye.EwaSettings.Nm();this.ykc=ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseNumberFormatterInWebWorker",
!1);this.Tud=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:6169583_checkTextAlignmentColorAndApplyNumberFormat2")}function od(f,D){this.success=f;this.LH=D}function ne(){this.zjg=this.p1j=!1;this.source=0;this.Bxa=this.Djc=!1}function qd(f,D,N,fa,Ia){N=void 0===N?null:N;fa=void 0===fa?null:fa;Ia=void 0===Ia?null:Ia;ld.ULS.shipAssertTag(537162128,0,!!(!!(null!=N^!(void 0===fa||null===fa))^!(void 0===Ia||null===Ia))&&!(null!=N&&void 0!==fa&&null!==fa&&void 0!==Ia&&null!==Ia),"NumberFormatHolder: holder must contain either an ifmt or a format string!");
null!=N&&0>N&&(ld.ULS.sendTraceTag(537162127,0,50,"NumberFormatHolder: ifmt is negative, setting it to null..."),N=null);this.Ol=f;this.uq=D;this.Ssg=N;this.uza=fa;this.Sra=Ia}function He(f,D){this.iB=null;this.Da=f;this.S3a=D}function Ue(f,D){this.Da=f;this.S3a=D}function zf(f,D,N){this.success=f;this.ooc=void 0===D?null:D;this.reason=void 0===N?"":N}function Hf(f,D,N){var fa=this;this.Pda=[];this.calcManager=this.tBc=this.lastSetCellInstantaneousOperation=null;this.$=f;this.grid=D;this.Jh=N;this.Ida=
Hf.CKe;this.$.da.Ya(268,function(Ia){fa.tBc=Ia});this.$.da.Ya(266,function(Ia){fa.calcManager=Ia});this.ykc=ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseNumberFormatterInWebWorker",!1);this.Tud=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:6169583_checkTextAlignmentColorAndApplyNumberFormat2")}function De(f,D,N,fa){this.rangeDelta=f;this.stateId=D;this.isFinished=N;this.priorityGroup=fa}function Ae(f,D,N,fa,Ia,pb,Wb,Nc,kd,Xc,Ie,Ze,Sf,ag,og,Vg,Hh,ji,kj,Ej,Rh,Zk,ll,gl,$k){this.numberOfDependentRecalcedCellsInBatch=
this.numberOfEditedRecalcedCellsInBatch=this.newProcessingTimeLimit=this.originalProcessingTimeLimit=this.totalExecutionTime=this.numberOfSkippedCellsDueToMissingLocaleInfo=this.numberOfUnsupportedRichCellTypes=this.numberOfUnsupportedBlankCellTypes=this.numberOfUnsupportedErrorCellTypes=this.numberOfCellsWithNoFormattedCell=this.numberOfCellsSkippedDueToTimeout=this.numberOfCellsUpdatedAlreadyByServer=this.numberOfUpdatedCells=this.numberOfNonUpdatedCells=this.totalNumberOfCellsInBatch=0;this.isNewTask=
!1;this.lastSetCellInstantaneousOperation=null;this.taskId=0;this.numberOfHashFormattedValues=this.numberOfMeasureTextWidthCalls=this.newNumberFormatterFinalizeFailures=this.totalNumberFormatterTime=this.numberOfRecalcedCellsWithoutFormattedValue=this.numberOfRecalcedCellsWithFormattedValue=this.isNewNumberFormatter=null;this.totalNumberOfCellsInBatch=void 0===f?0:f;this.numberOfNonUpdatedCells=void 0===D?0:D;this.numberOfUpdatedCells=void 0===N?0:N;this.numberOfCellsUpdatedAlreadyByServer=void 0===
fa?0:fa;this.numberOfCellsSkippedDueToTimeout=void 0===Ia?0:Ia;this.numberOfCellsWithNoFormattedCell=void 0===pb?0:pb;this.numberOfUnsupportedErrorCellTypes=void 0===Wb?0:Wb;this.numberOfUnsupportedBlankCellTypes=void 0===Nc?0:Nc;this.numberOfUnsupportedRichCellTypes=void 0===kd?0:kd;this.numberOfSkippedCellsDueToMissingLocaleInfo=void 0===Xc?0:Xc;this.totalExecutionTime=void 0===Ie?0:Ie;this.originalProcessingTimeLimit=void 0===Ze?0:Ze;this.newProcessingTimeLimit=void 0===Sf?0:Sf;this.numberOfEditedRecalcedCellsInBatch=
void 0===ag?0:ag;this.numberOfDependentRecalcedCellsInBatch=void 0===og?0:og;this.isNewTask=void 0===Vg?!1:Vg;this.lastSetCellInstantaneousOperation=void 0===Hh?"":Hh;this.taskId=void 0===ji?0:ji;this.isNewNumberFormatter=void 0===kj?null:kj;this.numberOfRecalcedCellsWithFormattedValue=void 0===Ej?null:Ej;this.numberOfRecalcedCellsWithoutFormattedValue=void 0===Rh?null:Rh;this.totalNumberFormatterTime=void 0===Zk?null:Zk;this.newNumberFormatterFinalizeFailures=void 0===ll?null:ll;this.numberOfMeasureTextWidthCalls=
void 0===gl?null:gl;this.numberOfHashFormattedValues=void 0===$k?null:$k}function yd(){}function je(f,D,N,fa,Ia){this.cV=void 0===f?0:f;this.cellValue=void 0===D?"":D;this.ifmt=void 0===N?0:N;this.priorityGroup=void 0===fa?"":fa;this.LH=void 0===Ia?"":Ia}function we(f){f=Bc(f);if(0===f)return 1;if(1===f)return 2;ld.ULS.sendTraceTag(537162182,0,10,"CalcInterfaceAdapter.GetInstantaneousUpdatedCellType: unknown updated cell type!");return 0}function Bc(f){if(f.priorityGroup===fd.editCell)return 0;if(f.priorityGroup===
fd.dependentCell)return 1;ld.ULS.sendTraceTag(537162183,0,10,"CalcInterfaceAdapter.GetRecalcPriorityGroup: unknown priority group!");return 2}function Od(f,D){var N=Bc(D),fa=!(void 0===D.rangeDelta.data.format||null===D.rangeDelta.data.format);ld.ULS.shipAssertTag(537162187,0,0===N||!fa,"CalcInterfaceAdapter.GetRecalcInferredFormat: Format inference expected for Edited cell only {0}",D.priorityGroup);f=Math.max(f.cell.Qm,0);fa&&(fa=excelOnlineCalc.calc.getCellFormatKind(D.rangeDelta.data.format.format),
"number"===fa?f=D.rangeDelta.data.format.format:"string"===fa?ld.ULS.sendTraceTag(537162186,0,50,"CalcInterfaceAdapter.GetRecalcInferredFormat: format kind string"):"Unavailable"===fa?ld.ULS.sendTraceTag(537162185,0,50,"CalcInterfaceAdapter.GetRecalcInferredFormat: format kind unavailable"):ld.ULS.shipAssertTag(537162184,0,!1,"CalcInterfaceAdapter.GetRecalcInferredFormat: unknown format kind!"));return f}function ae(f){var D=f.value;switch(f.type){case 2:return void 0===D||null===D?"":D;case 1:return f=
parseFloat(D),isNaN(f)?null:f;case 3:return f=parseFloat(D),isNaN(f)?null:1===f;case 4:return f=parseFloat(D),isNaN(f)?null:excelOnlineCalc.calc.errorValue(f);default:return excelOnlineCalc.calc.blankValue}}function Ad(f){f=excelOnlineCalc.calc.getCellValueKind(f.rangeDelta.data.value);var D=0;switch(f){case "number":D=1;break;case "string":D=2;break;case "boolean":D=3;break;case "Error":D=4;break;case "Blank":D=0;break;default:ld.ULS.shipAssertTag(537162191,0,!1,"CalcInterfaceAdapter.GetCellValueType: Unexpected unsupported type {0}",
f)}return D}function Ve(f,D){f=excelOnlineCalc.calc.getCellValueKind(f.rangeDelta.data.value);switch(f){case "number":case "string":case "boolean":return!0;case "Blank":if(ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5477761_Calc_BlankCellValueTypeSupported"))return!0;D.numberOfUnsupportedBlankCellTypes++;return!1;case "Error":if(ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcErrorValueTypeSupported",!1))return!0;D.numberOfUnsupportedErrorCellTypes++;return!1;case "Rich":return D.numberOfUnsupportedRichCellTypes++,
!1;default:return ld.ULS.shipAssertTag(537162192,0,!1,"CalcInterfaceAdapter.IsCellValueTypeSupported: Unexpected unsupported type {0}",f),!1}}function kf(f){if(f=f.color){if("String"===Object.getType(f).getName())return Ea.a.pq(f);if("Number"===Object.getType(f).getName())return null}else return null;ld.ULS.sendTraceTag(537162193,0,10,"CalcInterfaceAdapter.GetFontColorFromFormattedValue: unknown color type!");return null}function Fc(f){switch(f.alignment){case "Center":return 2;case "Left":return 1;
case "Right":return 3;default:return ld.ULS.sendTraceTag(537162194,0,10,"CalcInterfaceAdapter.GetHorizontalAlignmentFromFormattedValue: unknown horizontal alignment!"),0}}function fd(){}function jd(f,D,N,fa,Ia,pb,Wb,Nc,kd,Xc,Ie,Ze,Sf){Ze=void 0===Ze?null:Ze;Sf=void 0===Sf?null:Sf;Nc=ih.call(this,11,0,Nc,Ie)||this;Nc.yJh=f;Nc.Ted=D;Nc.format=fa;Nc.activeCell=N;Nc.kve=Ia;Nc.kLf=pb;Nc.fLf=Wb;Nc.iGa=kd;Nc.clientCorrelationId=Xc;Nc.Gnb=Ze;Nc.Ujb=Sf;return Nc}function zd(){}function zc(f){var D=Lj.call(this)||
this;D.ZTb=null;D.$=f;D.Xb();return D}function $e(f){var D=Rk.call(this)||this;D.QMf=0;D.HH=null;D.c3g=function(N,fa){if(1===N&&D.HH.FileCollectionErrorStateId){N=D.$.na.ta;var Ia=D.HH.MessageId,pb=D.HH.OriginalEcsServerId,Wb=D.HH.FileCollectionErrorStateId,Nc=N.Ma(0);Nc.errorMessageId=Ia;Nc.ecsServerId=pb;Nc.fileCollectionErrorStateId=Wb;Nc.userComment=fa;N.n1c("CollectFile",Nc,null,null,null,null,0)}D.raiseEvent("fileCollectionComplete",null,D)};D.$=f;return D}function Xe(f){var D=zi.call(this,
!1,!1,Xe.Yy)||this;D.vyd=!1;D.Gsf=!0;D.Rrf=0;D.lc=1;D.Bc(1,CommonUIStrings.l_Send);D.Bc(0,CommonUIStrings.l_NoThanks);D.ig=pe.Smg;D.Krf=f;D.Ve=Xe.YWg;return D}function pe(){}function Jf(f){return vk.call(this,f)||this}function kc(){}function $c(f,D,N,fa){var Ia=bk.call(this,f)||this;Ia.tEb=null;Ia.pnc=null;Ia.dhc=null;Ia.g4=null;Ia.Bla=!1;Ia.disposed=!1;Ia.mOa=!1;Ia.qh=null;Ia.ZCd=function(pb){ld.ULS.sendTraceTag(537163269,0,50,"DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback");
if(Ia.disposed)ld.ULS.sendTraceTag(537163268,0,50,"DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback: Callback not handled since dialog was already disposed");else{if(Mh.a(pb)){ld.ULS.sendTraceTag(537163267,0,15,"DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback - request has expected errors: {0}.",pb?Cf.a.Wc(pb.Errors):null);if(pb.Errors&&1===pb.Errors.length){var Wb=pb.Errors[0].MessageId,Nc=Ia.Zgd(Wb);if(Nc){Ia.YDj(Wb)?Ia.fzj(Nc):Ia.Ss(Nc);Ia.pma("OkInvalidByServer",
pb.Errors[0].MessageIdName);return}}ld.ULS.sendTraceTag(537163266,0,15,"DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback - Unexpected error, cannot parse: {0}",Cf.a.Wc(pb.Errors))}Ia.pma("OkValid","None");Ia.hide()}};Ia.f8c=function(pb){Ia.GX(pb);2!==pb&&(Ia.qh=Ia.$.Sb.Hc("UserAction","DataValidationEditTimeToDialogTryClose"));1===pb?Ia.mab():2===pb?Ia.Bza():Ia.Yma()};Ia.jda=function(){Ia.$Vj();Ia.mOa?Ia.TCe():Ia.$2c();return Ia.Bla=!1};Ia.selectedRanges=D;Ia.xTb=N;Ia.command=
fa;3===fa&&(Ia.Bla=!0);Ia.lc=2;Ia.cw=!1;Ia.ig=dc.ig;return Ia}function rd(f,D){this.options=this.cellRange=null;this.cellRange=f;this.options=D}function me(f,D){var N=Pj.call(this,f)||this;N.F$=null;N.lia=null;N.HVa=null;N.H$=null;N.G$=null;N.ypc=function(){N.F$.checked?(N.lia.disabled=!1,N.HVa.disabled=!1,N.H$.disabled=!1,N.G$.disabled=!1):(N.lia.disabled=!0,N.HVa.disabled=!0,N.H$.disabled=!0,N.G$.disabled=!0);return!1};N.get_visible=N.Rka;N.set_visible=N.Koa;N.Hk=D;N.nla();return N}function te(f,
D){var N=Ii.call(this,f)||this;N.Wba=null;N.vef=null;N.Yba=null;N.Xba=null;N.zpc=function(){N.Wba.checked?(N.Yba.disabled=!1,N.Xba.disabled=!1):(N.Yba.disabled=!0,N.Xba.disabled=!0);return!1};N.get_visible=N.Rka;N.set_visible=N.Koa;N.Hk=D;N.nla();return N}function ge(){}function pd(f,D,N,fa){var Ia=ek.call(this,f)||this;Ia.Fvb=null;Ia.kQd=null;Ia.Bla=!1;Ia.disposed=!1;Ia.mOa=!1;Ia.qh=null;Ia.P_j=function(pb,Wb){Ia.Mcc(pb);var Nc=Ia.O1d();pb=Nc.errorString;var kd=Nc.Kq;if(Nc.returnValue)return Ia.TMa(121,
Ia.zSh(Ia.$,Wb),0,Ia.d6,!1),"";Ia.pma("OkInvalidByClient",kd);return pb};Ia.f8c=function(pb){Ia.GX(pb);Ia.qh=Ia.$.Sb.Hc("UserAction","DataValidationEditTimeToDialogTryClose");0===pb&&Ia.Yma()};Ia.selectedRanges=D;Ia.xTb=N;Ia.command=fa;3===fa&&(Ia.Bla=!0);Ia.lc=2;Ia.cw=!1;return Ia}function jc(f,D,N,fa,Ia,pb,Wb,Nc){Nc=f.Ma(9,void 0===Nc?null:Nc);Nc.selectedRanges=D;Nc.ruleOptions=N;return Se.i(f,"CreateOrEditDataValidation",Nc,fa,Ia,pb,Wb,0)}function jf(f,D,N){var fa=Wj.call(this,D)||this;fa.txa=
null;fa.Fgc=null;fa.NU=null;fa.BL=null;fa.Zza=null;fa.$za=null;fa.W6a=null;fa.POa=null;fa.Hab=null;fa.wQa=null;fa.$qc=null;fa.JFd=null;fa.NHh=[[12,12,12,12,12,12,12,12],[0,0,2,2,0,1,0,1],[0,0,2,2,0,1,0,1],[3,3,3,3,3,3,3,3],[5,5,7,7,5,6,5,6],[8,8,10,10,8,9,8,9],[0,0,11,11,0,1,0,1],[4,4,4,4,4,4,4,4]];fa.Xqj=[[12,12],[1,1],[1,1],[12,12],[6,6],[9,9],[1,1],[12,12]];fa.xpc=function(Ia){var pb=!1;(null===Ia||void 0===Ia?0:Ia.Ca)&&(Ia.Ca.keyCode===jj.a.Xpa||Ia.Ca.keyCode===jj.a.fi)&&(pb=fa.jda(Ia),fa.NU.blur(),
fa.BL.blur());return pb};fa.jda=function(){var Ia=fa.NU.selectedIndex,pb=fa.BL.selectedIndex;fa.$qc.innerText=fa.cxb(Ia,pb);fa.JFd.innerText=fa.Qjd(Ia,pb);switch(Ia){case 0:return fa.BL.disabled=!0,$a.DOMElementExtensions.setVisible(fa.Hab,!1),$a.DOMElementExtensions.setVisible(fa.wQa,!1),$a.DOMElementExtensions.setVisible(fa.W6a,!1),$a.DOMElementExtensions.setVisible(fa.POa,!1),fa.txa.disabled=!0,!1;case 3:return fa.BL.disabled=!0,$a.DOMElementExtensions.setVisible(fa.Hab,!0),$a.DOMElementExtensions.setVisible(fa.wQa,
!1),$a.DOMElementExtensions.setVisible(fa.W6a,!0),$a.DOMElementExtensions.setVisible(fa.POa,!0),fa.txa.disabled=!1;case 7:return fa.BL.disabled=!0,$a.DOMElementExtensions.setVisible(fa.Hab,!0),$a.DOMElementExtensions.setVisible(fa.wQa,!1),$a.DOMElementExtensions.setVisible(fa.W6a,!1),$a.DOMElementExtensions.setVisible(fa.POa,!1),fa.txa.disabled=!1;default:fa.txa.disabled=!1,$a.DOMElementExtensions.setVisible(fa.Hab,!0),$a.DOMElementExtensions.setVisible(fa.POa,!1)}switch(pb){case 0:case 1:$a.DOMElementExtensions.setVisible(fa.wQa,
!0);break;default:$a.DOMElementExtensions.setVisible(fa.wQa,!1)}fa.BL.disabled=!1;fa.$qc.disabled=!1;$a.DOMElementExtensions.setVisible(fa.W6a,!1);$a.DOMElementExtensions.setVisible(fa.POa,!1);return!1};fa.get_visible=fa.Rka;fa.set_visible=fa.Koa;fa.oS=new Ab.a;fa.oS.add(oe.a.instance.fa(1627));fa.oS.add(oe.a.instance.fa(1628));fa.oS.add(oe.a.instance.fa(1631));fa.oS.add(oe.a.instance.fa(1629));fa.oS.add(oe.a.instance.fa(1630));fa.oS.add(oe.a.instance.fa(1632));fa.oS.add(oe.a.instance.fa(1633));fa.oS.add(oe.a.instance.fa(1634));
fa.oS.add(oe.a.instance.fa(1635));fa.oS.add(oe.a.instance.fa(1636));fa.oS.add(oe.a.instance.fa(1637));fa.oS.add(oe.a.instance.fa(1638));fa.oS.add("");fa.$=f;fa.Hk=N;fa.nla();return fa}function dc(){}function za(f,D){var N=this;this.dC=this.y2a=this.selectedRanges=null;this.INe=!1;this.qh=null;this.wQi=function(fa){ld.ULS.sendTraceTag(537163284,0,50,"DataValidationEditCommandHandler.OnGetDataValidationInitialStateSuccessCallback");!fa||Mh.a(fa)?ld.ULS.sendTraceTag(537163283,0,10,"DataValidationEditCommandHandler.OnGetDataValidationInitialStateSuccessCallback, failed to get expected results."):
(N.y2a=fa.Result,N.D5i())};this.LDh=function(fa){N.GX("DataValidationEdit.ExpandExisitngDialog",fa);N.dC.c=za.oja(fa);1===fa?N.HIa(new Mb(N.y2a)):2===fa?N.HIa(new Mb):N.crf()};this.D0i=function(fa){N.GX("DataValidationEdit.OverrideExisitngDialog",fa);N.dC.c=za.oja(fa);1===fa?N.HIa(new Mb):N.crf()};this.$=f;this.g8c=D}function Mb(f){this.Z5=(f=void 0===f?null:f)?f.IsIgnoreBlank:!0;this.a6=f?f.IsInCellDropDown:!0;this.JO=f?f.LowerBoundary:"";this.LO=f?f.UpperBoundary:"";this.VB=f?f.ConditionType:0;
this.ruleType=f?f.RuleType:0;this.L_=f?f.IsAlertBlocking:!0;this.MU=f?f.AlertTitle:"";this.LU=f?f.AlertMessage:"";this.tW=f?f.InputMessage:"";this.RF=f?f.InputTitle:"";this.n6=f?f.IsShowErrorAlert:!0;this.o6=f?f.IsShowInputMessage:!0}function hc(f){switch(f){case 0:f="AnyValue";break;case 1:f="WholeNumber";break;case 2:f="Decimal";break;case 3:f="List";break;case 4:f="Date";break;case 5:f="Time";break;case 6:f="TextLength";break;case 7:f="Custom";break;default:f="Unknown"}return f}function cc(f){switch(f){case 0:f=
"Between";break;case 1:f="NotBetween";break;case 2:f="Equal";break;case 3:f="NotEqual";break;case 4:f="GreaterThan";break;case 5:f="LessThan";break;case 6:f="GreaterThanOrEqual";break;case 7:f="LessThanOrEqual";break;default:f="Unknown"}return f}function Ec(f){var D=Tj.call(this)||this;D.$=f;D.Xb();return D}function Lc(f,D,N){var fa=this;this.rAc={};this.Pd=!1;this.nl=function(Ia,pb){fa.showContextMenu(void 0===pb?null:pb)};this.eAf=function(Ia,pb){pb.cFi===Lc.S6h&&We.g(fa.$).focus()};this.z0=function(Ia,
pb){Ia=fa.$.Ka.Aba(pb.Xd.command);(null===Ia||void 0===Ia?0:Ia.dismissesContextualUI)&&fa.w4()};this.W6=function(){fa.$.da.yV(342);ud.TaskExtensions.Ba(mf.GetServiceTaskFactory.create(fa.$.da,338,fa.$.la,3),function(Ia){Ia=Ia.result;for(var pb=Cl(fa.rAc),Wb=pb.next();!Wb.done;Wb=pb.next())Wb.value.dSf(Ia)},fa.$.la)};this.$=f;this.contextMenuController=N;this.U9d=new he(this.$);f.da.Ha(8,this);for(N=0;N<D.length;N++)this.rAc[Lc.E6g[N]]=D[N];this.ga=We.g(f).ga;this.ga.R_b(this.nl);this.$.Ka.KGa(this.eAf);
fi.a.instance.wyj();ye.EwaSettings.isChangeGateEnabled("OfficeVSO:4728637_DissmissContextualUIFromContextMenuManager")&&this.$.Ka.HGa(this.z0);ye.EwaSettings.isChangeGateEnabled("OfficeVSO:4932179_RemoveControllerRecreationOnModeSwitch")||this.$.ea.A$(this.W6)}function he(f){this.$We=null;this.$=f;this.a$a=new xf;ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")&&ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5035623_autofiltersHitTest")||(this.$We=new qe(this.$))}function qe(f){var D=
this;this.a0a=null;this.gUd=!1;this.VCb=0;this.Qad=1;this.lQe=0;this.GFb=function(N){D.GOf(N.domElement,N.hashCode)};this.sSf=function(N){for(var fa=0;window.performance.now()-N<D.Wqh&&0<D.a0a.length;)D.Wpe(D.a0a.shift()),fa++;ld.ULS.sendTraceTag(537167052,1,50,"FilterMenuManager.RegisterQueuedAutoFilterEventHandler: Batch number: {0}, Events Registered in this frame: {1}, Events in queue: {2}",D.Qad,fa,D.a0a.length);0<D.a0a.length?D.VCb=window.requestAnimationFrame(D.sSf):(ld.ULS.sendTraceTag(537167051,
1,50,"FilterMenuManager.RegisterQueuedAutoFilterEventHandler: Finished batch number: {0}, Total time in MS: {1}",D.Qad,window.performance.now()-D.lQe),D.Qad++,D.VCb=0)};this.onPointerDown=function(N){pf.a.slim(N.Ca.rawEvent);return!1};this.$=f;this.gridView=We.g(this.$);this.Qdi();this.Wqh=this.$.ya.AutoFilterEventRegistrationTimeLimit}function Af(){this.Zd=this.Pwe=this.cell=null}function xf(){this.Ffc={}}function fc(){this.menuModel=null;this.gJe=0}function Gc(){this.dictionary=this.Xd=null}function xd(f){var D=
qj.call(this)||this;D.Kdf=!1;D.Nod=function(){var N;(N=D.$.da.Aa(342))?D.Eb(N):D.$.gD(function(fa){fa.Ogc().then(function(Ia){(N=D.$.da.Aa(342))?D.Eb(N):(N=new Id(D.$,Ia),D.Eb(D.$.da.Ha(342,N)))})})};D.$=f;D.Xb();return D}function Id(f,D){this.Bsb=D;this.$=f}function le(f){return df.call(this,f)||this}function Wd(f,D,N,fa){f=kh.call(this,f,"PopulateTimeSlicerLevelMenu",-227942804,1634477200,Wd.fPj,!0,!1,Wd.nKb,D,N,!1,fa)||this;f.o2a=0;f.Ota=null;f.vLa=null;f.YNe=null;return f}function Je(f,D,N){this.type=
f;this.z6g=D;this.Lp=N}function lf(f,D,N,fa){return vg.call(this,f,"PopulateSlicerContextMenu",-1920954846,723126814,"SlicerContextMenu",!0,!1,"SlicerContextMenuRootName",D,N,!0,fa)||this}function vf(f,D,N,fa){f=bf.call(this,f,"PopulateSheetOpsContextMenu",274207288,-1497523576,Vd,!0,!1,"SheetTabContextMenuRootName",D,N,!1,fa)||this;f.Gic=!1;f.fkc=!1;return f}function se(f,D,N,fa){D=Bb.call(this,f,"PopulateRichTextContextMenu",679816325,1151222423,qc,!0,!1,qc,D,N,!0,fa)||this;D.grid=We.g(f);return D}
function wf(f,D,N,fa){D=Kb.call(this,f,"PopulateTableFieldListContextMenu",-751848458,-1085236154,ob,!0,!1,"TableFieldListContextMenuRoot",D,N,!1,fa)||this;D.Z6b=null;D.MBd=0;D.UWb=null;D.grid=We.g(f);return D}function Uf(){}function Wf(f,D,N,fa){var Ia=W.call(this,f,"PopulatePivotTableContextMenu",-1475408662,1114549926,tg,!0,!1,"PivotTableContextMenuRootName",D,N,!0,fa)||this;Ia.Tc=null;Ia.activeCell=null;Ia.pFc=null;Ia.skc=!1;Ia.zrd=!1;Ia.expandCollapse=!1;Ia.refresh=!1;Ia.g_=!1;Ia.gg=null;Ia.rA=
null;Ia.S1a=null;Ia.Db=null;Ia.ubb=null;Ia.nca=!1;Ia.oRi=function(pb){pb&&!Cf.a.vh(pb.Errors)&&Ia.Tc&&(Ia.Tc.ap=pb.Result,Ia.BLb());Ia.showPivotTableContextMenu()};Ia.nRi=function(){};Ia.cVi=function(){Ia.Zcb()};Ia.bVi=function(){Ia.Zcb()};Ia.TLi=function(){Ia.Zcb()};Ia.SLi=function(){Ia.Zcb()};Ia.zu=function(){Ia.W_d();Ia.nca=!1};Ia.Xq=function(){if(Ia.nca){ld.ULS.sendTraceTag(537167E3,0,50,"PivotTableContextMenu.OnAfterAllBlocksUpdated: Context menu was closed after changes were made by other users");
var pb=Ia.Tc;Ia.grid.Tb.qp(Ia.grid.ga.va.activeCell)!==pb&&(Ia.Zcb(),Ia.Zai())}};Ia.Tlh=new DOMParser;Ia.GBj=!0;Ia.grid=We.g(f);Ia.fnc=!0;return Ia}function Tf(f,D,N,fa){return ke.call(this,f,"PopulatePivotContextMenu",2123758504,912277356,D,N,fa)||this}function ug(f,D,N,fa){f=Jd.call(this,f,"PopulateFieldWellContextMenu",1374696078,495005930,gd,!0,!1,gd,D,N,!1,fa)||this;f.cell=null;f.yo=null;f.Ko=null;f.externalSourceIndex=-1;f.c3d=-1;f.TTa=0;f.GAc=-1;f.wM=null;f.isOlap=!1;f.pI=!1;f.U3a=!1;return f}
function Le(f,D,N,fa,Ia,pb,Wb,Nc,kd){var Xc=ec.call(this,Ia,oe.a.instance.Bb(60),!0,2,!0)||this;Xc.d7f=!0;Xc.bne=null;Xc.GTa=null;Xc.Mga=null;Xc.ytb=null;Xc.b8c=null;Xc.oUc=null;Xc.NLi=function(Ie){gg.a.any(Ie.Errors,function(Ze){return-103190598===Ze.MessageId})&&Xc.kUa.Omj()};Xc.YRi=function(Ie){Ie&&!Mh.a(Ie)&&(Ie=Ie.Result,Xc.b8c.innerHTML=oe.a.instance.fa(1054)+Lg.a.Rf(Ie.ValueFieldSourceName),Xc.isOlap&&!Xc.pI?(Xc.kUa.enabled=!1,Xc.Mga.activeTab=Xc.Mga.DBc-1):(Xc.kUa.enabled=!0,Xc.Mga.activeTab=
0),Xc.kUa.nxj(Ie.PivotValueFieldSettingsSummarizeValueByInfo),Xc.GTa.oxj(Ie.PivotValueFieldShowValueAsInitialInfo),Xc.pf())};Xc.cell=f;Xc.Ko=D;Xc.externalSourceIndex=N;Xc.vjg=fa;Xc.Xd=pb;Xc.$ia=Wb;Xc.isOlap=Nc;Xc.pI=kd;return Xc}function Qd(f,D,N){N=void 0===N?null:N;this.Jnb=this.Tnb=null;this.k2=-1;this.gi=f;this.dZ=(void 0===D?null:D)||new Ab.a;this.cBg=N||new Eg;this.$Fa=new Ab.a;f=0;D=Cl(this.dZ);for(N=D.next();!N.done;N=D.next()){N=N.value;this.Hud(this.k2)||(this.k2=f);var fa=f++;this.$Fa.add(new Of(document.createElement("li"),
N.title,this.t$g(fa)))}}function Of(f,D,N){this.gi=f;this.Zp=D;this.KIc=N;this.zga=document.createElement("a");Ra.a.kyc(this.zga,this.Zp);Sys.UI.DomElement.addCssClass(this.zga,Ee.jNj);Sys.UI.DomElement.addCssClass(this.gi,Ee.iNj);this.gi.appendChild(this.zga);this.zga.tabIndex=0;this.ADc();ni.a.addHandler(this.gi,"click",this.KIc);ni.a.addHandler(this.gi,"keyup",Object(Nh.a)(this,this.vab,"onTitleKeyUp"))}function Ee(){}function Eg(){}function lg(f){f=yj.call(this,f)||this;f.nhe=null;f.get_visible=
f.Rka;f.set_visible=f.Koa;f.nla();return f}function Ef(){}function eg(f,D,N,fa,Ia,pb,Wb,Nc){var kd=Vh.call(this,f)||this;kd.dG=null;kd.w7b=null;kd.g2b=null;kd.A5d=null;kd.B5d=null;kd.a8d=null;kd.lAf=function(){var Xc=parseInt(kd.s4.ve.value,10);kd.MYg(Xc)?(kd.SU.ao.disabled=!0,kd.DQ.ao.disabled=!0,kd.DQ.clear(),eg.Wff(Xc)?(kd.SU.ao.disabled=!1,kd.uPb(!0)):eg.Xff(Xc)?(kd.SU.ao.disabled=!1,kd.DQ.ao.disabled=!1,kd.uPb(!0),kd.Yof()):kd.uPb(!1)):(Xc=Cf.a.ed(1,0,0,1084,0,7896227,"FormatRequiresBaseFieldsOrBaseItems"),
Og.a(kd.$).Ss([Xc]),kd.s4.Smj())};kd.YLi=function(){0>kd.SU.selectedIndex||kd.DQ.ao.disabled||(kd.uPb(!0),kd.Yof())};kd.ZRi=function(Xc){kd.dG.cUa();kd.DQ.ao.style.overflowY="scroll";if(Xc&&!Mh.a(Xc)){Xc=Xc.Result;kd.DQ.clear();for(var Ie=Cl(Xc.BaseItems),Ze=Ie.next();!Ze.done;Ze=Ie.next())Ze=Ze.value,kd.DQ.XM(Ze.DisplayString,Ze.Id.toString(),Ze.Id===Xc.SelectedBaseItem);kd.uPb(!1)}};kd.get_visible=kd.Rka;kd.set_visible=kd.Koa;kd.$=D;kd.cell=N;kd.Ko=fa;kd.externalSourceIndex=Ia;kd.Xd=pb;kd.$ia=Wb;
kd.npi=Nc;kd.OXj=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:4859461_DisableOKButtonWhenLoadingIndictorIsOn");kd.nla();return kd}function Na(){}function Ib(f,D,N,fa,Ia){this.externalSourceIndex=0;this.pivotFieldTitle=this.activeCell=null;this.summarizeBy=0;this.showAsValueParameters=null;this.externalSourceIndex=f;this.activeCell=D;this.pivotFieldTitle=N;this.summarizeBy=fa;this.showAsValueParameters=Ia}function vc(f,D,N){this.baseItemIndex=this.baseFieldIndex=this.dataFormat=0;this.dataFormat=
f;this.baseFieldIndex=D;this.baseItemIndex=N}function Yc(){}function Md(){}function Ed(f,D,N,fa){return ke.call(this,f,"PopulateFieldListPivotMenu",-1793121409,1378457149,D,N,fa,yg)||this}function ke(f,D,N,fa,Ia,pb,Wb,Nc){Nc=void 0===Nc?Qf:Nc;var kd=kg.call(this,f,D,N,fa,Nc,!0,!1,"PivotFilterMenuRootName",Ia,pb,!1,Wb)||this;kd.U6b=null;kd.snf=null;kd.iob=null;kd.pivotData=null;kd.WBd=null;kd.voc=null;kd.VEb=0;kd.P3b=0;kd.rZ=0;kd.ltb=null;kd.cRi=function(Xc,Ie){if(Ie)if(Mh.a(Xc))kd.Xyd(Ie,!1);else if(Xc=
Xc.Result){kd.Ytb=Rc.Gid(Ie,kd.$,kd.pivotData.cell,kd.rZ);var Ze=kd.Ytf(Xc.MenuModel.Sections);kd.ltb=Ze;ke.nO.set(kd.pivotData.cell,Ie,Ze,kd.rZ);Ye.a(kd.$).yLj(Xc);kd.Xyd(Ie,!0)}};kd.bRi=function(Xc,Ie){kd.Xyd(Ie,!1)};kd.Xe=function(Xc,Ie){ke.nO.h9b(Ie.gd.hash)};kd.Rm=function(Xc,Ie){ke.nO.h9b(Ie.gd.hash)};kd.Oda=null;kd.XBd=kd.VEb=-1;kd.zBe=kd.P3b=-1;kd.Bte=kd.rZ=0;kd.ty=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");ke.nO||(ke.nO=new Rc(kd.$),We.g(kd.$).Da.xr(kd.Xe),We.g(kd.$).Da.lH(kd.Rm),
We.g(kd.$).Da.Mha(kd.Xe));return kd}function mc(){this.cell=null;this.dataSourceIndex=0;this.Ko=this.pivotName=null}function Rc(f){this.$=f;this.nO={}}function nd(f,D,N,fa){f=Jc.call(this,f,"PopulateFieldListContextMenu",-1045020714,-170383950,Yb,!0,!1,Yb,D,N,!1,fa)||this;f.yo=null;f.wM=null;f.N_=!1;f.pI=!1;f.isOlap=!1;f.DXd=!1;return f}function Td(f,D,N,fa){f=Fe.call(this,f,D,N,fa,"PopulateChartContextMenu",-498523270,1640762262,la)||this;f.QBa=!1;f.jxa=!1;f.g_=!1;f.refresh=!1;f.isPivotChart=!1;
return f}function Fe(f,D,N,fa,Ia,pb,Wb,Nc,kd,Xc){Nc=void 0===Nc?Bf.a.x6g:Nc;f=lc.call(this,f,void 0===Ia?"PopulateFloatingObjectContextMenu":Ia,void 0===pb?-2017893763:pb,void 0===Wb?1350204367:Wb,Nc,void 0===kd?!0:kd,void 0===Xc?!1:Xc,Nc,D,N,!0,fa)||this;f.floatingObject=null;f.zb=0;f.fnc=!0;return f}function fe(f,D,N,fa){f=x.call(this,f,"PopulateAutoFilterFieldListContextMenu",474690375,216058793,fe.cFh,!0,!1,fe.nKb,D,N,!1,fa)||this;f.nm=null;return f}function ef(){}function If(){}function Ke(f,
D){f=ng.call(this,f,2,0,null)||this;f.Owe=D;return f}function ng(f,D,N,fa){this.ywg=f;this.erg=D;this.irg=N;this.WAg=fa}function rf(){}function dg(f,D,N,fa){var Ia=wh.call(this,f,"PopulateAutoFilterContextMenu",1675506831,1651433993,eh,!0,!1,"AutoFilterContextMenuRoot",D,N,!1,fa)||this;Ia.ltb=null;Ia.sheetName=null;Ia.JUa=null;Ia.jZc=null;Ia.vpf=!1;Ia.X3a=!1;Ia.qHd=null;Ia.xNb=null;Ia.hcd=null;Ia.Mdc=null;Ia.HQa=null;Ia.xJe=null;Ia.Yab=null;Ia.w7c=null;Ia.vO=function(){Ia.EAc();Ia.$.ea.Kp(Ia.vO)};
Ia.LQi=function(pb){function Wb(ag,og,Vg){Ia.w7c=Se.t(Ia.$.na.ta,Xc,Pg.b(ag,Ie),Ia.X3a?Pg.a(og,Ze):og,Vg,null,Sf);return Ia.w7c}Ia.X3a||rh.b(Ia.$).he(wb.a.cCf,Ia.om(),void 0,!0);var Nc={};Ia.$.Jj(Nc);var kd=Ia.$.ea.isNamedObjectViewMode,Xc=Ka.a.ui(Ia.jZc);Xc.SheetName=kd?Nc.NamedObjectName:Nc.SheetName;Xc.NamedObjectView=kd;Nc=!!pb.searchText;kd=586;Ia.X3a&&(Nc&&(Xc.ItemListOptions=Ia.b9g(pb.searchText),kd=597),pb={},rh.b(Ia.$).he(wb.a.cCf,(pb.UserOperation=kd.toString(),pb),void 0,!0));var Ie=Ia.CDd(Nc),
Ze=Ia.MQi(),Sf=Ia.$.na.ta.fc();Ia.xJe=Sf.RequestId;Ia.X3a&&Ia.Mdc&&!Ia.Mdc.dequeueUtcTime&&(Ia.$.userOperationManager.nJa(Ia.Mdc),Ia.YYg());pb=ye.EwaSettings.uc()?new Mf.a(kd,0,Wb,80):new Pf.a(kd,0,Wb,16);Ia.Mdc=Ia.$.userOperationManager.jc(pb,null);Ia.Yab=Ia.w7c;Ia.HQa=Ia.xJe};Ia.onMenuItemClick=function(pb,Wb,Nc){rh.b(Ia.$).he(wb.a.GVi,Ia.om(),void 0,!0);var kd={};Wb=(kd.CommandValueId=Wb,kd.MenuItemId=Wb,kd.InputMethod=Nc,kd.TopCellAddress=Ia.JUa,kd);kd=new bg.a(pb,Nc,Ia.$.isEditMode?2:1,19,null);
Ia.$.Ka.dc(kd,Wb);ld.ULS.sendTraceTag(537167131,0,50,"AutoFilterContextMenu::OnMenuItemClick {0}, {1}",pb,Nc)};Ia.JLi=function(pb){if(pb.checkedItems&&pb.checkedItems.length){rh.b(Ia.$).he(wb.a.nyf,Ia.om(),void 0,!0);var Wb=Ka.a.ui(Ia.jZc),Nc={};Ia.$.Jj(Nc);Nc.FirstRow=0;Nc.FirstColumn=Wb.Column;var kd=Ia.$.ea.isNamedObjectViewMode;Wb.NamedObjectView=kd;Wb.SheetName=kd?Nc.NamedObjectName:Nc.SheetName;var Xc=function(Sf){if(Ph.a.yzc(Sf)){var ag=Ph.a.bcc(Sf);Ia.UNa?Ph.a.TRa(Di.a.applyItemFilter,ag.MessageIdName,
Fg.a.uta,!0,Ph.a.isSessionEndingError(ag.MessageId)):ld.ULS.sendTraceTag(537167129,0,10,"AutoFilterContextMenu::OnApplyFilterByValue failed with AutoFilterException -{0}",ag.MessageIdName)}Mh.a(Sf)||(ld.ULS.sendTraceTag(537167128,0,50,"AutoFilterContextMenu::OnApplyFilterByValue service call succeeded"),rh.b(Ia.$).he(wb.a.XBf,Ia.om(),void 0,!0),Sf=Object.assign(new ah,{isSuccess:!0}),Ia.xNb.onApplyFilterByValueFinish(Sf),Ia.tM(Ia.JUa))},Ie=Ia.Y5c(Wb,Nc),Ze=new Mf.a(208,0,function(Sf,ag,og){return Se.a(Ia.$.na.ta,
Ie,pb.checkedItems,Pg.b(Sf,Xc),ag,og,null,null)},6,function(){return new sa.a(pb.checkedItems,Ie)});Ia.b8f(function(){Ia.$.userOperationManager.jc(Ze,null)})}else ld.ULS.sendTraceTag(537167130,0,15,"AutoFilterContextMenu::OnApplyFilterByValue Received Zero checked items to apply filter on")};Ia.LOg=function(pb){var Wb=af.o(Ia.JUa,Ia.$),Nc=af.v(Ia.JUa,Ia.$),kd=Object.assign(new Bd,{SortConditionType:pb.type,RowColOffset:Wb.FirstColumn-Nc.FirstColumn,SortColor:pb.color,SortIconSet:pb.icon.IconSet,SortIcon:pb.icon.Icon,
IsAscending:!0}),Xc={SortOptions:Object.assign(new Dc,{OperationType:1,ActiveCell:Wb,SelectedRange:Nc,SortConditions:[kd],SortTopToBottom:!0,GuessHeader:!0,IsCaseSensitive:!1}),SelectedRange:Nc,OriginalActiveCell:Wb,ShouldRestoreSelection:!1};Xc.ShouldPromptNamedSheetViewTeachingDialog=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:6170028_HandleSheetProtectionForSortFeatures");ld.ULS.sendTraceTag(537167119,0,50,"AutoFilterContextMenu.ApplySortByColorOrIcon: Aplying Sort, type: {0}",pb.type);ye.EwaSettings.isChangeGateEnabled("OfficeVSO:6170028_HandleSheetProtectionForSortFeatures")?
(pb={},Ia.$.ae(-1089513346,tf.a.$b,19,(pb.CustomSortCommandData=Xc,pb))):Ia.b8f(function(){var Ie={};Ia.$.ae(1659552324,tf.a.$b,19,(Ie.CustomSortCommandData=Xc,Ie))})};Ia.UNa=Ph.a.gqd();Ia.ty=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");return Ia}function qf(){this.top=this.left=0}function $g(){this.onMenuItemClick=this.applyFilterByValueRequest=this.getFilterByValueItemsRequest=null;this.autoFilterMenuWidth=0;this.applySortByColorOrIconRequest=null}function nf(){this.autoFilterMenu=
this.targetPoint=null}function Qe(){this.filterByValueItems=null;this.hasMoreRecords=!1;this.searchText=null}function fh(){this.selectedSortIcon=this.selectedSortFontColor=this.selectedSortCellColor=this.getColorName=this.icons=this.fontColors=this.cellColors=null}function Rg(){this.displayText=null;this.state=0;this.children=this.parent=this.key=null;this.indentationLevel=0;this.expanded=!1}function ah(){this.isSuccess=!1}function pg(){this.Title=this.MenuItems=this.Id=null;this.DisplayType=0}function Ga(){this.Disabled=
!1;this.RibbonCommand=this.Identifier=this.Type=0;this.SubMenu=this.Label=this.CommandData=null;this.IsChecked=!1;this.TooltipText=this.Id=this.IconName=null}function Hb(){this.Sections=this.Id=null}function Dc(){this.ActiveCell=this.SelectedRange=null;this.SortTopToBottom=this.IsCaseSensitive=this.GuessHeader=this.HasHeader=this.IsAscending=!1;this.SortInfoMode=this.OperationType=0;this.ExpandSortSelection=this.SortConditions=null;this.ExpandSortSelectionSupported=!1}function Bd(){this.RowColOffset=
0;this.IsAscending=!1;this.CustomOrder=null;this.SortColor=this.SortConditionType=0;this.FillGradient=null;this.SortIcon=this.SortIconSet=0;this.RichProperty=null}function Fd(){}function Be(f,D,N,fa){var Ia=this;this.X5d=this.o2=this.ej=this.tE=this.l9=null;this.pYb=f;this.aAg=fa;this.pYb.eNa&&(this.ej=new Tg.a(3,2,5E3,Object(Nh.a)(this,this.QQg,"authenticationCheckTask"),2),Gg.AFrameworkApplication.Yi.$g(this.ej),this.Sg(D,N));this.pYb.Zob(function(){Ia.vyf()});this.pYb.$Za(function(){Ia.wyf()})}
function Me(){}function sf(f){return Eh.call(this,f)||this}function Qa(f,D,N){var fa=zh.call(this)||this;fa.cNi=function(Ia,pb){if(!Mh.a(Ia)&&pb){var Wb=!!Ia&&!!Ia.RequestTelemetryData;We.g(fa.$).Ri.xma(pb.toString(),Ia.StateId,Wb?Ia.RequestTelemetryData.EcsOperationDuration:0,Wb?Ia.RequestTelemetryData.EcsRequestDuration:0,Wb?Ia.RequestTelemetryData.WfeRequestDuration:0)}};fa.$=f;fa.tableManager=D;fa.Jh=N;return fa}function cb(f,D){this.command=0;this.selectedRanges=null;this.command=f;this.selectedRanges=
D}function bc(f){return Oh.call(this,f)||this}function yc(f){var D=th.call(this)||this;D.zyf=function(N){var fa=We.g(D.$);if(N=N.Result){var Ia=af.D(N.NewSelection),pb=af.D(N.NewActiveCell);if(Ia&&pb)if(!N.Committed&&N.AutoSumFormula){var Wb=fa.rc(pb);Wb&&(fa.ga.updateSelection(Ia,pb,60),Ia=pb=af.D(N.MarkedArea),fa.sK=2,Kd(fa.Ac,Wb,N.AutoSumFormula,!!Ia,N.FormulaMarkStart,N.FormulaMarkEnd),Ia&&pb&&fa.ga.updateSelection(Ia,pb,0),fa.Ac.etd=!1,ud.TaskExtensions.Ba(mf.GetServiceTaskFactory.create(D.$.da,
153,D.la,0),function(Nc){Nc.result.Lub(null)},D.la,3))}else fa.ga.updateSelection(Ia,pb,60)}};D.$=f;return D}function bd(f,D){this.sharedSheetRange=null;this.type=0;this.sharedSheetRange=f;this.type=D}function Kd(f,D,N,fa,Ia,pb){if(D){var Wb=f.textBox;f.isEditing||f.startEdit(D,!0);f.etd=!0;f.text=N;Wb.caretPosition=Ia;Ia<pb&&(fa&&f.$Ba(),Wb.selectRange(0,pb+1),Wb.selectRange(Ia,pb))}}function de(f,D,N,fa,Ia,pb,Wb,Nc,kd,Xc){Xc=f.Ma(9,Xc);Xc.selectedRange=D;Xc.activeCell=N;Xc.autoSumType=fa;Xc.topLeftCell=
Ia;return Se.i(f,"AutoSum",Xc,pb,Wb,Nc,kd,0)}function Re(f,D,N,fa,Ia,pb){if(0===fa)return Object(re.a)(Ng.UnsupportedZeroResize);if(0>fa||0===N.length)return Object(re.a)(Ng.InvalidInput);if(f.Z$h())return Object(re.a)(Ng.UnsupportedSkeletonInView);var Wb=f.Ff;if(!Wb)return Object(re.a)(Ng.NullSPD);var Nc=Wb.h3e(N);if(Nc&&0<Nc.length)return Object(re.a)(Nc.length.toString()+" "+Ng.UnsupportedHiddenInRange);a:{Nc=Cl(N);for(var kd=Nc.next();!kd.done;kd=Nc.next())kd=kd.value,Ia?kd.right=Ya.a.di:kd.bottom=
Ya.a.Sh;Nc=f.Daa("EditGridAction.IsMergeCellAcrossBlocksExistInRanges",N);try{for(Nc.$$rst();Nc.$$mn();)if(Nc.to.mJj){var Xc=!0;break a}}finally{Nc&&Nc.dispose()}Xc=!1}if(Xc)return Object(re.a)(Ng.UnsupportedMergeCell);if(ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase2",!1)&&!Ia&&"undefined"!==typeof gridRenderer)for(Xc=Cl(N),Nc=Xc.next();!Nc.done;Nc=Xc.next())gridRenderer.CanvasRendererGlobals.resetColWidthCacheByCol(Nc.value.left);f=f.Da;Xc=Sg.a.create().toString();
Wb.Vhg(N,fa,Ia);pb=f.xgg(Ia,pb);D.vbj(N,Ia);f.OOf(pb,Xc);return Object(re.d)(fa)}b.r(F);var ce=b(556),Jb=b(0),Mc=b(905),ld=b(13),fg=b(204),Se=b(83),tf=b(78);bd.prototype.I5a=function(){return this.sharedSheetRange};Object(Jb.a)(bd,"MacroRecorderAutoSumPayload",null,[428]);var af=b(45),Pf=b(561),Sd=b(387),Mf=b(173),mf=b(51),ud=b(35),Vf=b(158),Ih=b(356),Cf=b(29),ye=b(1),be=b(184),Pg=b(288),We=b(20),Zh=b(167),hh=b(626),rg=b(53),th=fg.a;Am(yc,th);yc.prototype.$c=function(){return!1};yc.prototype.executeCommand=
function(f,D,N){f=D.command;switch(f){case 1220954656:D=this.KMe(0,D);break;case -1537138325:D=this.KMe(parseInt(N[tf.a.od].toString(),10),D);break;default:D=be.a(f)}return D};yc.prototype.Mc=function(f,D){if(f=1===f)switch(D.command){case 1220954656:case -1537138325:break;default:f=!1}return f};yc.prototype.nd=function(){return!1};yc.prototype.KMe=function(f,D){function N(){return new bd(Wb,f)}var fa=this,Ia=We.g(this.$);Ia.Lg.xH(!1);if(!We.g(this.$).ga.va.Wg)return ld.ULS.sendTraceTag(537170308,
0,50,"AutoSumCommandHandler.DoAutoSum: Unhandled AutoSum of type {0} due to discontinuous selection. Number of selected ranges is {1}",f,We.g(this.$).ga.va.zL),this.pAa(),rg.Task.Sa(!1);var pb=Ia.JK();if(!pb)return null;var Wb=af.v(Ia.ga.va.xd,this.$),Nc=af.o(Ia.ga.va.activeCell,this.$),kd=af.o(pb,this.$),Xc=this.$.na.ta.fc();return this.$.Br(Ia.ga.va.selectedRanges,!0)?ye.EwaSettings.uc()?Sd.a(this.$.userOperationManager,function(Ie,Ze,Sf){return de(fa.$.na.ta,Wb,Nc,f,kd,Pg.b(Ie,fa.zyf),Ze,Sf,f,
Xc)},function(Ie){return new Mf.a(502,0,Ie,64,N)},D):Sd.a(this.$.userOperationManager,function(Ie,Ze,Sf){return de(fa.$.na.ta,Wb,Nc,f,kd,Pg.b(Ie,fa.zyf),Ze,Sf,f,Xc)},function(Ie){return new Pf.a(502,0,Ie,void 0,N)},D):rg.Task.Sa(!1)};yc.prototype.pAa=function(){hh.a(Zh.a.discontinuousSelectionBlocking,["OtherICE"],!0,!0,!1,!1,null);var f=Cf.a.ed(1,1,738,2129,0,371863010,"DiscontinuousSelectionBlocking");ye.EwaSettings.Rz()?new Ih.a(this.$,f):(f=new Vf.ErrorDialog(this.$,f),f.initialize(),f.pf())};
Object(Jb.a)(yc,"AutoSumCommandHandler",fg.a,[434]);var Oh=Mc.a;Am(bc,Oh);bc.prototype.Qd=function(){this.Jd([new yc(this.$)])};bc.ka=function(f){Mc.a.je(96,new bc(f))};Object(Jb.a)(bc,"AutoSumCommandHandlerFactory",Mc.a,[]);var Xg=b(10),Sg=b(186),gg=b(273),di=b(36),Jg=b(337);cb.prototype.yt=function(){return this.command};Object(Jb.a)(cb,"MacroRecorderRangeOperationAppliedPayload",null,[428]);var Mh=b(289),$h=b(69),zh=di.a;Am(Qa,zh);Qa.prototype.cIg=function(f){this.addHandler("ekcvc",f)};Qa.prototype.Ufj=
function(f){this.removeHandler("ekcvc",f)};Qa.prototype.$c=function(){return!1};Qa.prototype.executeCommand=function(f,D){f=D.command;switch(f){case -730106152:D=this.yld(D,3);break;case -1228228458:D=this.yld(D,4);break;case -848953656:case 2045211913:if(this.dqi()){D=rg.Task.Sa(!0);break}D=this.yld(D,1);break;default:D=be.a(f)}return D};Qa.prototype.Mc=function(f,D){if(f=1===f)switch(D.command){case -730106152:case -1228228458:case -848953656:case 2045211913:break;default:f=!1}return f};Qa.prototype.nd=
function(){return!1};Qa.prototype.yld=function(f,D){function N(){return new cb(D,Xc)}function fa(Ze,Sf,ag){Ia.$.Qy();return Se.f(Ia.$.na.ta,D,Xc,!1,Pg.b(Ze,Ia.cNi),Sf,ag,kd,Ie)}var Ia=this,pb=We.g(this.$),Wb=pb.ga.va.selectedRanges,Nc=f.command,kd=Sg.a.create().toString();if(!this.$.Br(Wb,!0)&&-730106152!==Nc)return rg.Task.Sa(!0);var Xc=af.r(Wb,this.$);this.OFj(Nc,pb,Wb,kd);ye.EwaSettings.isChangeGateEnabled("OfficeVSO:3371143_RegisterFormulaBarToClearContentEvent")&&this.L8i();var Ie=this.$.na.ta.fc(!0);
return ye.EwaSettings.uc()?Sd.a(this.$.userOperationManager,fa,function(Ze){return new Mf.a(508,0,Ze,67,N)},f):Sd.a(this.$.userOperationManager,fa,function(Ze){return new Pf.a(508,0,Ze,3,N)},f)};Qa.prototype.OFj=function(f,D,N,fa){var Ia=this;if(-848953656!==f&&2045211913!==f&&-730106152!==f&&-1228228458!==f)ld.ULS.sendTraceTag(537167938,0,10,"ClearCommandHandler.ShowInstantaneousClear: Unexpected command {0}.",f);else if(!gg.a.any(N,function(Wb){return 0<D.getRangeInformation(Wb).length})){var pb=
gg.a.any(N,function(Wb){return Ia.tableManager.nud(Wb)});if(-730106152!==f&&-1228228458!==f||!pb)this.UJj(D,f,fa,N),-730106152!==f&&-1228228458!==f||this.Jh.Kea(D,-730106152,{}),-1228228458!==f&&2045211913!==f&&-848953656!==f||this.Jh.I1g(N,fa),D.Ri.D1(fa,$h.BasicTelemetryCalculator.$R)}};Qa.prototype.UJj=function(f,D,N,fa){var Ia="";switch(D){case -1228228458:Ia="ClearAll";break;case 2045211913:case -848953656:Ia="ClearContent";break;case -730106152:Ia="ClearFormat";break;default:ld.ULS.sendTraceTag(537167937,
0,15,"ClearCommandHandler.StampTimeWithCompatibleDescription: Unexpected command {0}.",D)}D=fa.length;fa=af.b(fa);f.Ri.t8(15,N,Ia+(", ranges to clear: "+D+", cells to clear: "+fa))};Qa.prototype.L8i=function(){this.raiseEvent("ekcvc",new Jg.a)};Qa.prototype.dqi=function(){if(We.g(this.$).Nz){var f=this.$.da.Aa(296);return!!f&&f.EV.GB}return!1};Object(Jb.a)(Qa,"ClearCommandHandler",di.a,[434,758]);var Eh=Mc.a;Am(sf,Eh);sf.prototype.Qd=function(){var f=this,D=mf.GetServiceTaskFactory.create(this.$.da,
134,this.la,this.ub),N=mf.GetServiceTaskFactory.create(this.$.da,18,this.la,this.ub);ud.TaskExtensions.Ba(ud.TaskExtensions.we([D,N],this.la),function(){var fa=new Qa(f.$,D.result,N.result);f.Jd([fa]);f.$.da.Ha(313,fa)},this.la,3)};sf.ka=function(f){Mc.a.je(101,new sf(f))};Object(Jb.a)(sf,"ClearCommandHandlerFactory",Mc.a,[]);var Xh=b(630),Fh=b(623),Kg=b(620),Sh=b(1219);Me.prototype.ich=function(f,D){if(f&&!(1>f.length)&&D){var N=Object.assign(new Kg.a,{ExternalId:"msPresenceOuter",ControlList:[]});
this.J$g(f,N.ControlList);D.push(N)}};Me.prototype.J$g=function(f,D){var N=Object.assign(new Xh.a,{ExternalId:"ContextCoauthors",LabelText:CommonUIStrings.l_PresenceMenuSectionTitle,Menu:Object.assign(new Fh.a,{ExternalId:"msPresenceInner",UpdateDynamically:!0,ShouldAutoOpen:!1,MenuSectionList:[]})});Array.add(D,N);D=Object.assign(new Kg.a,{Title:"",ControlList:[]});Array.add(N.Menu.MenuSectionList,D);this.Pbh(f,D.ControlList)};Me.prototype.Pbh=function(f,D){for(var N=0;N<f.length;N++){var fa=Object.assign(new Sh.a,
{ExternalId:String.format("CoauthorPersona_{0}",N),Command:"336231556",DisplayName:f[N].userName,LabelText:f[N].userName,ImageBackColor:f[N].color,PersonaId:f[N].email,IsAnonymous:f[N].isAnonymous});Array.add(D,fa)}};Object(Jb.a)(Me,"PresenceContextMenuSectionBuilder",null,[102]);var Nh=b(82),Gg=b(4),vh=b(178),Hi=b(621),Tg=b(107),ph=b(133),Ag=b(89),oh=b(84),Zg=b(105),Dg=b(26);Be.prototype.Sg=function(f,D){var N=Gg.AFrameworkApplication.Ib;N.gf(Dg.a.authenticationLost,Zg.a.frame,f,96);N.gf(Dg.a.Hwe,
Zg.a.frame,D,96);N.ic(Dg.a.BAe,Zg.a.frame,vh.ActionManager.K9c);N.ic(Dg.a.CAe,Zg.a.frame,vh.ActionManager.K9c);N.ic(Dg.a.ewd,Zg.a.frame,vh.ActionManager.K9c)};Be.prototype.vyf=function(){this.showDialog(CommonUIStrings.l_AuthenticationLostMessage);Gg.AFrameworkApplication.Ib.processAction(Dg.a.authenticationLost,2)};Be.prototype.wyf=function(){this.ONj();Gg.AFrameworkApplication.Ib.processAction(Dg.a.Hwe,2)};Be.prototype.QQg=function(){this.pYb.authenticationCheck()};Be.prototype.ONj=function(){this.tE&&
(this.tE.hide(),this.tE.dispose(),this.tE=null);this.l9&&this.businessBar&&(Gg.AFrameworkApplication.Pg||this.businessBar.removeEntry(this.l9),this.l9.dispose(),this.l9=null)};Be.prototype.showDialog=function(f){Ag.a.Fa(this.tE);this.tE=new ph.StandardDialog;this.aAg||(this.tE.rv=!1,this.tE.lc=0);this.tE.Bc(1,CommonUIStrings.l_SignIn);this.tE.$X(CommonUIStrings.l_DefaultDialogTitle,f,Object(Nh.a)(this,this.Cw,"dialogHandler"))};Be.prototype.Cw=function(f){1===f?(Hi.a.p7(),this.showDialog(CommonUIStrings.l_AuthenticationLostSigninInProgressMessage),
Gg.AFrameworkApplication.Ib.processAction(Dg.a.ewd,2)):(this.IUd(),Gg.AFrameworkApplication.Ib.processAction(Dg.a.CAe,2))};Be.prototype.IUd=function(){this.businessBar&&this.Qye&&(this.l9=this.Qye.create(CommonUIStrings.l_AuthenticationLostTitle,CommonUIStrings.l_AuthenticationLostMessage,null),this.l9.closeable=!0,this.l9.addButton(CommonUIStrings.l_SignIn,Be.rWg,""),this.l9.maa=Object(Nh.a)(this,this.uWg,"businessBarEntryCloseHandler"),this.businessBar.OE(this.l9,!1))};Be.prototype.uWg=function(){this.Ojh();
Gg.AFrameworkApplication.Ib.processAction(Dg.a.BAe,2)};Be.prototype.Ojh=function(){this.ej&&(Gg.AFrameworkApplication.Yi.kq(this.ej),this.ej=null)};Be.prototype.dispose=function(){this.ej=this.tE=this.l9=null};Be.rWg=function(){Hi.a.p7();Gg.AFrameworkApplication.Ib.processAction(Dg.a.ewd,2)};uk.Object.defineProperties(Be.prototype,{businessBar:{configurable:!0,enumerable:!0,get:function(){return this.o2||(this.o2=oh.a.instance.Nh("CommonUI.IBusinessBar"))}},Qye:{configurable:!0,enumerable:!0,get:function(){return this.X5d||
(this.X5d=oh.a.instance.Nh("CommonUI.IBusinessBarEntryFactory"))}}});Object(Jb.a)(Be,"SignOutResponseUI",null,[3]);var li=b(254);Fd.prototype.hi=function(f){f.register(Me,"Common.App.UI.PresenceContextMenuSectionBuilder").as("Common.App.UI.IPresenceContextMenuSectionBuilder").Ic()};Fd.prototype.init=function(){};Fd.prototype.dispose=function(){Ag.a.Fa(Fd.W2);Fd.W2=null};Fd.main=function(){li.a.instance.nj(new Fd)};uk.Object.defineProperties(Fd.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.UI"}}});
Fd.W2=null;Object(Jb.a)(Fd,"CommonAppUIPackage",null,[4,5]);var zg=b(152),Ah=b(161);Object(Jb.a)(Bd,"SharedSortCondition",null,[]);Object(Jb.a)(Dc,"SharedSortOptions",null,[]);var Qg=b(928),Bf=b(5),Gi=b(494),Uh=b(624),Ka=b(54),sa=b(1116),wb=b(131),Nd=b(960),ee=b(150),yf=b(118),sg=b(211),bg=b(95),Yf=b(71),xg=b(34),oe=b(14),Gh=b(63),rh=b(132),Ph=b(982),Di=b(983),Fg=b(145),$f=b(49),Bg=b(32),uh=b(443);Object(Jb.a)(Hb,"AutoFilterMenu",null,[]);Object(Jb.a)(Ga,"MenuItem",null,[]);Object(Jb.a)(pg,"MenuSection",
null,[]);Object(Jb.a)(ah,"ApplyFilterByValueResponse",null,[]);Object(Jb.a)(Rg,"FilterByValueItem",null,[]);Object(Jb.a)(fh,"GetColorsAndIconsResponse",null,[]);Object(Jb.a)(Qe,"GetFilterByValueItemsResponse",null,[]);Object(Jb.a)(nf,"ShowSortFilterMenuParams",null,[]);Object(Jb.a)($g,"SortFilterControllerFactoryParams",null,[]);Object(Jb.a)(qf,"TargetPoint",null,[]);var ei=b(290),cg=b(39),Gf=b(175),Zf=b(228),eh=Bf.a.r6g,wh=Qg.a;Am(dg,wh);dg.prototype.executeCommand=function(f,D,N){var fa=this;f=
D.command;switch(f){case 1701016594:Qg.a.oDh(N);break;case 966232027:if(ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ServiceInit",!1)){var Ia=new Ah.a;ud.TaskExtensions.Ba(mf.GetServiceTaskFactory.Ua(this.$.da,8,9,0),function(pb){fa.H$e(D,N,pb.result);Ia.setResult(!0)},this.la,3).CWCT(function(){Ia.setResult(!1)},this.la,5,Zf.a.instance);return Ia.task}this.H$e(D,N);return rg.Task.Sa(!0);default:return be.a(f)}};dg.prototype.H$e=function(f,D,N){var fa=this,Ia=D.domEvent;if(!Yf.e(Ia.rawEvent))rg.Task.Sa(!0);
else if(Yf.e(Ia.rawEvent))if(Yf.g(Ia),Ia.target){var pb=new ee.a(this.$.xa);if(pb.qe(4096)||pb.qe(2048)){var Wb=Ka.a.ui(D[tf.a.Gg]);this.D6f(Wb)&&(this.vpf?this.vvc(Ia,Ia.target,Wb,f,N):(this.qHd=function(){fa.D6f(Wb)&&(fa.Dgi(),fa.vvc(Ia,Ia.target,Wb,f,N),fa.X3a=ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FilterByValueSearch",!1),fa.vpf=!0)},this.EAc()))}else rg.Task.Sa(!0)}else rg.Task.Sa(!0)};dg.prototype.Mc=function(f,D,N){if(f=!!N)switch(D.command){case 1701016594:case 966232027:ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ServiceInit",
!1)||Gi.a(this.$)||(f=!1,ld.ULS.sendTraceTag(537167137,0,15,"AutoFilterContextMenu.CanExecuteCommand: ContextMenuManager is not ready. RibbonCommand was {0}",$f.b().yi(D.command)));break;default:f=!1}return f};dg.prototype.cHd=function(f){Array.addRange(f.MenuSectionList,this.ltb)};dg.prototype.Dgi=function(){var f=this;uh.a(function(){f.xNb=sortFilter.SortFilterControllerFactoryGlobal.createSortFilterController(Object.assign(new $g,{getFilterByValueItemsRequest:f.LQi,applyFilterByValueRequest:f.JLi,
onMenuItemClick:f.onMenuItemClick,autoFilterMenuWidth:dg.Nwe,applySortByColorOrIconRequest:f.LOg}))});this.hcd=oh.a.instance.Nh("Common.IExternalUICommandDefinitionMapping")||new Uh.a(this.$.Lb,this.$)};dg.prototype.vvc=function(f,D,N,fa,Ia){rh.b(this.$).he(wb.a.vvc,this.om(),void 0,!0);ld.ULS.shipAssertTag(537167135,0,!!N,"Attempt at opening AutoFilterContextMenu failed, autoFilterData is null.");f=this.SOh(N,Ia);Ia=Sys.UI.DomElement.getBounds(D);fa=Ia.x+Ia.width;Ia=Ia.y;if(this.ty&&!N.IsHeaderSnapped){if(ye.EwaSettings.isChangeGateEnabled("OfficeVSO:6053383_EnsureContextMenuCellInView")&&
!Qg.a.Kqd(this.$,N.Cell))return;N=Qg.a.Pgd(this.$,N.Cell,!0);fa=N.x;Ia=N.y}N=We.g(this.$).rtl?new Sys.UI.Point(fa-Bg.a(this.$).ZGa(dg.Nwe),Ia):new Sys.UI.Point(fa,Ia);this.eVa(N,D);N=Bg.a(this.$).Gka(N);D=Object.assign(new nf,{targetPoint:Object.assign(new qf,{left:N.x,top:N.y}),autoFilterMenu:f});this.xNb.showSortFilterMenu(D);this.$.ae(-544117314,-1,0,null)};dg.prototype.D6f=function(f){return ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5819197_CheckActiveItemBeforeRenderingAutofilterMenu")&&
f.Cell.SheetName?We.g(this.$).e6?f.Cell.SheetName===this.$.oa.name:f.Cell.SheetName===this.$.oa.sheetName:!0};dg.prototype.SOh=function(f,D){return(f=this.TOh(f,D))?this.zNf(f):null};dg.prototype.zNf=function(f){for(var D=[],N=Cl(f.Sections),fa=N.next();!fa.done;fa=N.next())fa=fa.value,Object(Gf.e)(this.$)&&ye.EwaSettings.isChangeGateEnabled("OfficeVSO:6122433_NSVTitleEnabled")&&fa.Title===oe.a.instance.fa(1899)||(fa=this.H6i(fa),Array.add(D,fa));return Object.assign(new Hb,{Id:f.Id,Sections:D})};
dg.prototype.H6i=function(f){for(var D=[],N=Cl(f.MenuItems),fa=N.next();!fa.done;fa=N.next())if(fa=fa.value,2===fa.Identifier)this.jZc=fa.CommandData;else switch(fa.Type){case 3:case 2:Array.add(D,this.F6i(fa,2===fa.Type));break;case 1:Array.add(D,this.G6i(fa))}return Object.assign(new pg,{MenuItems:D,DisplayType:f.DisplayType,Id:this.qMh(f)})};dg.prototype.G6i=function(f){var D=this.l_e(f);var N=D.label;var fa=D.CMa;D=this.zNf(f.SubMenu);var Ia=this.b_e(f);fa=this.hcd.Xcc(fa);N=N||f.Label;return Object.assign(new Ga,
{Disabled:f.Disabled,Type:f.Type,Identifier:f.Identifier,Id:Ia,CommandData:f.CommandData,Label:N,SubMenu:D,IsChecked:f.IsChecked,IconName:"MissingIcon_20"===fa?null:fa})};dg.prototype.F6i=function(f,D){var N=this.Mbc(f,D&&f.IsChecked);D=N.label;var fa=N.CMa;N=N.Lp;var Ia=this.Ifd(f,D);fa=this.hcd.Xcc(fa);return Object.assign(new Ga,{Disabled:f.Disabled,Type:f.Type,Identifier:f.Identifier,Id:Ia,RibbonCommand:N,CommandData:f.CommandData,Label:D||f.Label,SubMenu:null,IsChecked:f.IsChecked,IconName:"MissingIcon_20"===
fa?null:fa})};dg.prototype.TOh=function(f,D){var N;this.JUa=N=af.C(f.Cell);this.sheetName=this.$.oa.sheetName;D=D||Gi.a(this.$);if(f.IsHeaderSnapped)N=D.zac.cWh(N);else{D=We.g(this.$).Da.s5a(N);if(!D)return this.UNa?Ph.a.TRa(Di.a.RPf,Zh.a.a7h,Fg.a.b0a,!0,!1):ld.ULS.sendTraceTag(537167134,0,10,"AutoFilterContextMenu.GetAutoFilterMenuProps: gridModelCellProxy that is supposed to hold model is null. Range requested {0}, visible range: {1}",N,We.g(this.$).view.visibleArea),null;N=D.autoFilterMenu}if(!N)return this.UNa?
Ph.a.TRa(Di.a.RPf,Zh.a.YEi,Fg.a.b0a,!0,!1):ld.ULS.sendTraceTag(537167133,0,10,"AutoFilterContextMenu.GetMenuPropsFromCachedBlock: a cell that's supposed to have an autofilter menu returned a null menu."),null;this.Ytb=f.Cell.FirstRow+"_"+f.Cell.FirstColumn;return N};dg.prototype.EAc=function(){var f=this;if(this.$.ea.yh){var D=mf.GetServiceTaskFactory.Ua(this.$.da,283,284,1);ud.TaskExtensions.Ba(D,function(){f.UNa?D.result.ho.loadScript("sortFilter").then(function(){f.qHd()},function(N){Gh.a.pl(N,
"AutoFilterContextMenu.SortFilterScriptLoad");Ph.a.TRa(Di.a.EAc,Zh.a.WIj,Fg.a.b0a,!1,!1)}):ud.TaskExtensions.Ba(ei.c(D.result.ho.loadScript("sortFilter")),function(){f.qHd()},f.$.la,3)},this.$.la,3)}else this.$.ea.Gm(this.vO)};dg.prototype.b9g=function(f){var D={};D.SearchText=f;D.Page=1;D.DateNodeType=-1;return D};dg.prototype.YYg=function(){this.HQa&&(ld.ULS.sendTraceTag(537167132,0,15,"AutoFilterContextMenu.CancelGetAutoFilterItemListWebRequest Cancelling pending getAutoFilterItemList request with ID={0}",
this.HQa),Se.j(this.$.na.ta,this.HQa,null,null,null),this.HQa=null);this.Yab&&(Gg.AFrameworkApplication.Ld.Ku(this.Yab.$t),this.Yab=null)};dg.prototype.CDd=function(f){var D=this;return function(N){D.HQa=null;D.Yab=null;if(Ph.a.yzc(N)){var fa=Ph.a.bcc(N);D.UNa?Ph.a.TRa(f?Di.a.searchAutoFilterItemList:Di.a.getAutoFilterItemList,fa.MessageIdName,Fg.a.b0a,!0,!0):ld.ULS.sendTraceTag(537167127,0,10,"AutoFilterContextMenu::OnGetFilterByValueItemsSuccessCallback failed with AutoFilterException -{0}",fa.MessageIdName)}if(!Mh.a(N)){ld.ULS.sendTraceTag(537167126,
0,50,"AutoFilterContextMenu::OnGetFilterByValueItems service call succeeded");N=N.Result;fa=new xg.a(!0);var Ia=N.AutoFilterDateNodes?!0:!1;N.AutoFilterItems&&fa.add("AutoFilterItemsCount",N.AutoFilterItems.length);Ia&&fa.add("AutoFilterDateItemsCount",N.AutoFilterDateNodes.length);fa.add("Location","contextMenu");rh.b(D.$).he(wb.a.CDd,fa.xv,void 0,!0);fa=D.X3a?Object.assign(new Qe,{filterByValueItems:D.YFe(N),hasMoreRecords:N.ItemListMaxExceeded,searchText:N.SearchText}):Object.assign(new Qe,{filterByValueItems:D.YFe(N),
hasMoreRecords:N.ItemListMaxExceeded});D.xNb.onGetFilterByValueItemsFinish(fa);!f&&ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SortByColor",!1)&&(ld.ULS.shipAssertTag(529063959,0,null!==N.FontColors&&null!==N.CellColors&&null!==N.Icons&&null!==N.SelectedSortFontColors&&null!==N.SelectedSortCellColors&&null!==N.SelectedSortIcons,"AutoFilterContextMenu.onGetFilterByValueItemsSuccessCallback: SortByColor items should not be null"),N=Object.assign(new fh,{fontColors:N.FontColors,cellColors:N.CellColors,
icons:N.Icons,selectedSortFontColor:0<N.SelectedSortFontColors.length?N.SelectedSortFontColors[0]:null,selectedSortCellColor:0<N.SelectedSortCellColors.length?N.SelectedSortCellColors[0]:null,selectedSortIcon:0<N.SelectedSortIcons.length?N.SelectedSortIcons[0]:null,getColorName:D.getColorName}),D.xNb.onGetColorsAndIconsFinish(N))}}};dg.prototype.MQi=function(){var f=this;return function(D){f.HQa=null;f.Yab=null;D=yf.a.mg(D.data);ld.ULS.sendTraceTag(537167125,0,10,"AutoFilterContextMenu.OnGetFilterByValueItemsFailureCallback Errors: [{0}].",
Cf.a.Wc(D))}};dg.prototype.YFe=function(f){var D=this.T6g(f),N=this.$6g(f.AutoFilterItems),fa=[],Ia=0;f.HasBlanks&&(f=dg.n6c(oe.a.instance.fa(765),f.IsBlanksSelected?1:0,Bf.a.Mwe),fa[Ia++]=f);D=Cl(D);for(f=D.next();!f.done;f=D.next())f=f.value,fa[Ia++]=f;N=Cl(N);for(f=N.next();!f.done;f=N.next())D=f.value,fa[Ia++]=D;return fa};dg.prototype.T6g=function(f){var D=[];if(!f.AutoFilterDateNodes||!f.AutoFilterDateNodes.length)return D;for(var N=[this.p5a(f.YearKeys,f.YearValues),this.p5a(f.MonthKeys,f.MonthValues),
this.p5a(f.DayKeys,f.DayValues),this.p5a(f.HourKeys,f.HourValues),this.p5a(f.MinuteKeys,f.MinuteValues),this.p5a(f.SecondKeys,f.SecondValues)],fa=!1,Ia=!1,pb=0,Wb=null,Nc=Array(6),kd=null,Xc=Cl(f.AutoFilterDateNodes),Ie=Xc.next();!Ie.done;Ie=Xc.next()){Ie=Ie.value;Nc[0]&&(kd.Year!==Ie.Year?(fa=!0,pb=0,Wb=null):kd.Month!==Ie.Month?(Ia=!0,pb=1,Wb=Nc[0]):kd.Day!==Ie.Day?(pb=2,Wb=Nc[1]):f.ShowTime&&(kd.Hour!==Ie.Hour?(pb=3,Wb=Nc[2]):kd.Minute!==Ie.Minute?(pb=4,Wb=Nc[3]):(pb=5,Wb=Nc[4])));for(;6>pb;){switch(pb){case 0:var Ze=
Ie.Year;kd=N[0].getItem(Ze.toString());break;case 1:Ze=Ie.Month;kd=N[1].getItem(Ze.toString());break;case 2:Ze=Ie.Day;kd=N[2].getItem(Ze.toString());break;case 3:Ze=Ie.Hour;kd=N[3].getItem(Ze.toString());break;case 4:Ze=Ie.Minute;kd=N[4].getItem(Ze.toString());break;case 5:Ze=Ie.Second;kd=N[5].getItem(Ze.toString());break;default:throw Error.invalidOperation("Unknown AutoFilterDateNodeType.");}kd=dg.n6c(kd,-1!==Ie.NodeType&&pb>=Ie.NodeType?1:0,Wb?Wb.key+";"+Ze:Bf.a.n_c+Ze,!1,[]);Wb=Wb?Wb.children:
D;Wb=Wb[Wb.length]=kd;Nc[pb]=kd;switch(pb){case 5:pb=6;break;case 2:pb=f.ShowTime?pb+1:6;break;default:pb++}}kd=Ie}fa||(Nc[0].expanded=!0,Ia||(Nc[1].expanded=!0));return D};dg.prototype.$6g=function(f){var D=[];if(!f)return D;var N=0;f=Cl(f);for(var fa=f.next();!fa.done;fa=f.next())fa=fa.value,D[N++]=dg.n6c(fa.DisplayString,fa.Selected?1:0,Bf.a.o_c+fa.DisplayString);return D};dg.prototype.p5a=function(f,D){var N=new xg.a(!0);if(!f||!D)return N;for(var fa=f.length<D.length?f.length:D.length,Ia=0;Ia<
fa;Ia++)N.add(f[Ia].toString(),D[Ia]);return N};dg.prototype.Y5c=function(f,D){var N={};N.Location=D;N.FieldId=f.Id.toString();N.DataSourceIndex=-1;N.FilterType=f.AutoFilterType;N.AnchorType=0;N.ChartId=null;N.AnchorValue1=-1;N.AnchorValue2=-1;N.Property=f.RichProperty;return N};dg.prototype.tM=function(f){(ye.EwaSettings.isChangeGateEnabled("OfficeVSO:6063473_PTPSDisableLive")?cg.a.Pla(this.$):ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.PivotTableHandRaise",!1))&&ud.TaskExtensions.Ba(mf.GetServiceTaskFactory.Ua(this.$.da,
430,431,1),function(D){D.result.ifa(f);ld.ULS.sendTraceTag(537167123,306,50,"AutoFilterContextMenu:TriggerPivotTableHandRaise Trigger hand raise from filter context menu.")},this.$.la,3)};dg.prototype.om=function(){var f={};return f.Location="contextMenu",f};dg.prototype.getColorName=function(f){return Nd.a.wLa(sg.a.MH(f))};dg.prototype.b8f=function(f){ud.TaskExtensions.Ba(mf.GetServiceTaskFactory.Ua(this.$.da,309,310,3),function(D){D.result.TBa().continueWith(function(N){N.result&&f()})},this.$.la,
3)};dg.n6c=function(f,D,N,fa,Ia){f=void 0===f?null:f;D=void 0===D?0:D;N=void 0===N?null:N;fa=void 0===fa?!1:fa;Ia=void 0===Ia?null:Ia;return Object.assign(new Rg,{displayText:f?Qg.a.Il(f):f,state:D,key:N,parent:null,children:Ia,indentationLevel:0,expanded:fa})};uk.Object.defineProperties(dg.prototype,{It:{configurable:!0,enumerable:!0,get:function(){return"PopulateAutoFilterContextMenu"}},TB:{configurable:!0,enumerable:!0,get:function(){return Bf.a.PPf}}});dg.Nwe=268;Object(Jb.a)(dg,"AutoFilterContextMenu",
Qg.a,[]);var Yg=b(934),k=b(81),Ab=b(199),oc=b(64),R=b(17);rf.WWe=26;rf.ydd=[229,230,0,98,0,94,93];Object(Jb.a)(rf,"Constants",null,[]);uk.Object.defineProperties(ng.prototype,{Toi:{configurable:!0,enumerable:!0,get:function(){return 3===this.I6b}},vsi:{configurable:!0,enumerable:!0,get:function(){return 4===this.I6b&&!!this.subMenu}},subMenu:{configurable:!0,enumerable:!0,get:function(){return this.WAg}},cuf:{configurable:!0,enumerable:!0,get:function(){return this.ywg}},I6b:{configurable:!0,enumerable:!0,
get:function(){return this.erg}},N7c:{configurable:!0,enumerable:!0,get:function(){return this.irg}}});Object(Jb.a)(ng,"FiltersMenuData",null,[]);Am(Ke,ng);Object(Jb.a)(Ke,"AutoFilterFiltersMenuData",ng,[]);If.eOj=[new ng(99,2,0,null),new ng(100,2,1,null),new ng(0,3,0,null),new ng(171,2,2,null),new ng(173,2,4,null),new ng(0,3,0,null),new ng(175,2,6,null),new ng(176,2,7,null),new ng(0,3,0,null),new ng(107,0,0,null)];If.fKi=[new ng(99,2,0,null),new ng(100,2,1,null),new ng(0,3,0,null),new ng(101,2,8,
null),new ng(102,2,10,null),new ng(103,2,12,null),new ng(0,3,0,null),new ng(104,1,0,null),new Ke(105,1),new Ke(106,2),new ng(0,3,0,null),new ng(107,0,0,null)];If.Mfh=[new ng(99,2,0,null),new ng(0,3,0,null),new ng(111,2,10,null),new ng(112,2,8,null),new ng(103,2,12,null),new ng(0,3,0,null),new Ke(109,8),new Ke(108,9),new Ke(110,10),new ng(0,3,0,null),new Ke(114,11),new Ke(113,12),new Ke(115,13),new ng(0,3,0,null),new Ke(116,14),new Ke(117,15),new Ke(118,16),new ng(0,3,0,null),new Ke(119,17),new Ke(120,
18),new Ke(121,19),new ng(0,3,0,null),new Ke(122,20),new Ke(123,21),new Ke(124,22),new ng(0,3,0,null),new Ke(125,23),new ng(126,2,12,[new Ke(127,24),new Ke(128,25),new Ke(129,26),new Ke(130,27),new ng(0,3,0,null),new Ke(131,28),new Ke(132,29),new Ke(133,30),new Ke(134,31),new Ke(135,32),new Ke(136,33),new Ke(137,34),new Ke(138,35),new Ke(139,36),new Ke(140,37),new Ke(141,38),new Ke(142,39)]),new ng(0,3,0,null),new ng(107,0,0,null)];Object(Jb.a)(If,"Constants",null,[]);var Ba=b(21);ef.prototype.compare=
function(f,D){return Ba.a.compare(f,D,!0)};Object(Jb.a)(ef,"IgnoreCaseComparer",null,[883]);var d=b(73),x=Qg.a;Am(fe,x);fe.prototype.executeCommand=function(f,D,N){f=D.command;switch(f){case -699941697:this.applyAutoFilterFieldList(D,N);break;case 216058793:String.format("TableFieldListContextMenu:AutoFilterFieldListContextMenuClose");break;case -1494291901:break;default:return be.a(f)}return rg.Task.Sa(!0)};fe.prototype.Fgd=function(f,D){return!f||f.length<=D?(ld.ULS.sendTraceTag(537167117,0,10,
"AutoFilterFieldListContextMenu:GetCommandId - incomplete id list"),-1):parseInt(f[D],10)};fe.prototype.HId=function(f,D,N,fa,Ia,pb){var Wb=this.Fgd(Ia,pb);0>Wb&&ld.ULS.sendTraceTag(537167116,0,10,"AutoFilterFieldListContextMenu:ProcessCommand - command id not found");switch(rf.ydd[Wb]){case 98:f=new bg.a(-2058042992,D.method,D.mode,D.ef,D.tabName);this.nm.pH.nvb(this.$,fa,0,f);break;case 229:f=new bg.a(504133448,D.method,D.mode,D.ef,D.tabName);this.nm.pH.nvb(this.$,fa,0,f);break;case 230:f=new bg.a(-798968736,
D.method,D.mode,D.ef,D.tabName);this.nm.pH.nvb(this.$,fa,0,f);break;case 231:f=new bg.a(-1677817820,D.method,D.mode,D.ef,D.tabName);this.nm.pH.nvb(this.$,fa,0,f);break;case 94:this.ONf(f,D,fa,N,Ia,pb+1);break;case 93:this.nm.pH.jwi(this.$,fa)}};fe.prototype.ONf=function(f,D,N,fa,Ia,pb){var Wb=this.Fgd(Ia,pb);0>Wb&&ld.ULS.sendTraceTag(537167115,0,10,"AutoFilterFieldListContextMenu:ProcessSubMenuCommand - command id not found");if(!fa||Wb>=fa.length)ld.ULS.sendTraceTag(537167114,0,15,"AutoFilterFieldListContextMenu:ProcessSubMenuCommand() - no menuData.");
else switch(fa=fa[Wb],fa.I6b){case 1:this.nm.pH.Cwi(this.$,N);break;case 2:(Ia=Object(k.a)(Ke,fa))?(f=new bg.a(-2058042992,D.method,D.mode,D.ef,D.tabName),this.nm.pH.nvb(this.$,N,Ia.Owe,f)):this.nm.pH.iof(this.$,f,N,fa.N7c);break;case 0:this.nm.pH.iof(this.$,f,N,fa.N7c);break;case 4:this.ONf(f,D,N,fa.subMenu,Ia,pb+1)}};fe.prototype.applyAutoFilterFieldList=function(f,D){var N=D[Yg.a.hJ];if(N)if(N=N.split(oc.a.BV),3>N.length)ld.ULS.sendTraceTag(537167112,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - unexpected SourceIdControl string.");
else{var fa=this.Fgd(N,1),Ia=this.kLa(fa),pb=this.Wtf(fa).returnValue;pb?this.HId(D,f,pb,Ia,N,2):ld.ULS.sendTraceTag(537167111,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - menu data not found for index "+fa.toString()+oc.a.BV)}else ld.ULS.sendTraceTag(537167113,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - SourceIdControl string is null.")};fe.prototype.Mc=function(f,D){if(f=this.$.isEditMode)switch(D.command){case 216058793:break;case -699941697:break;case -1494291901:f=
!0;break;default:f=!1}return f};fe.prototype.w1=function(f,D,N){this.$.isEditMode&&((this.nm=Object(k.a)(841,N))||ld.ULS.sendTraceTag(537167110,0,10,"AutoFilterFieldListContextMenu:ShowDropDown() - filterInfoManager not found."),this.QZ(),x.prototype.w1.call(this,f,D,null,null,!0))};fe.prototype.g6c=function(){if(!this.nm||!this.nm.Rk||1!==this.nm.Rk.length)return ld.ULS.sendTraceTag(537167109,0,15,"AutoFilterFieldListContextMenu:CreateContextMenuItemList() - incorrect fields list."),null;var f=this.nm.Rk[0],
D=new Ab.a;D.add(oe.a.instance.fa(247));D=d.OBc(d.concat(D,d.select(d.asEnumerable(f.FieldInfoDataList),function(N){return N.Name})),function(N){return N},new ef);return d.toArray(D)};fe.prototype.fieldIndex=function(f){if(!this.nm||!this.nm.Rk||1!==this.nm.Rk.length||!this.nm.Rk[0].FieldInfoDataList)return-1;for(var D=0;D<this.nm.Rk[0].FieldInfoDataList.length;++D)if(this.nm.Rk[0].FieldInfoDataList[D].Name===f)return D;return-1};fe.prototype.kLa=function(f){return 0>f||!this.nm||!this.nm.Rk||1!==
this.nm.Rk.length||!this.nm.Rk[0].FieldInfoDataList||this.nm.Rk[0].FieldInfoDataList.length<f?null:this.nm.Rk[0].FieldInfoDataList[f].Name};fe.prototype.QZ=function(){var f=this,D=this.g6c();if(!D||!D.length)return null;for(var N=this.Ta,fa=N.Oc(),Ia={},pb=0;pb<D.length;Ia={Ehb:Ia.Ehb},++pb){var Wb=D[pb];Ia.Ehb=0<pb?this.fieldIndex(Wb):-1;for(var Nc=fe.H9f+Ia.Ehb.toString()+oc.a.BV,kd=null,Xc=this.nm.pH.E$h(0<pb?Wb:null),Ie=this.q6c(N,Xc,fe.H9f+Ia.Ehb.toString(),Wb),Ze={},Sf=0;Sf<rf.ydd.length;Ze=
{$Qb:Ze.$Qb,Dhb:Ze.Dhb},++Sf){var ag=rf.ydd[Sf],og=Nc+Sf.toString();kd||(kd=N.Oc());switch(ag){case 229:Array.add(kd.buttons,N.hd(223,og,-699941697,this.nm.pH.hsi(0<pb?Wb:null)?R.a.y$b:R.a.eKa,8,229,!1,null));break;case 230:Array.add(kd.buttons,N.hd(224,og,-699941697,this.nm.pH.isi(0<pb?Wb:null)?R.a.z$b:R.a.fKa,8,230,!1,null));break;case 231:Array.add(kd.buttons,N.hd(225,og,-699941697,R.a.w$b,1,231,!1,null));break;case 98:ag=this.rVg(Wb);og=N.GIa(og+(Xc?".enabled":".disabled"),ag,-699941697,null,
"None",null,!Xc,void 0,!0);og.jT("Image16by16",8,R.a.I3a);Array.add(kd.buttons,og);break;case 94:Ze.$Qb=void 0;Ze.Dhb=void 0;var Vg=function(Hh,ji){return function(){var kj=f.Wtf(Hh.Ehb);ji.$Qb=kj.eXe;ji.Dhb=kj.isChecked;return kj}}(Ia,Ze)().returnValue;if(!Vg)return null;ag=this.q6c(N,Ze.Dhb&&Xc,og,Ze.$Qb);og=this.r_e(ag.menu,N,og+oc.a.BV,Vg,Ze.Dhb&&Xc);Array.add(ag.menu.Dc,og);Array.add(kd.buttons,ag);break;case 0:kd&&(Array.add(Ie.menu.Dc,kd),kd=null);break;default:og=N.GIa(og,oe.a.instance.fa(ag),
-699941697,null,"None",null,!1,void 0,!0),this.M1f(og,Xc&&93===ag&&this.nm.pH.filter(),oe.a.instance.fa(ag)),Array.add(kd.buttons,og)}}Array.add(Ie.menu.Dc,kd);Array.add(fa.buttons,Ie)}D=N.iq(this.menuId);Array.add(D.Dc,fa);return D};fe.prototype.r_e=function(f,D,N,fa,Ia){for(var pb=null,Wb=0;Wb<fa.length;++Wb){var Nc=fa[Wb],kd=N+Wb.toString(),Xc=!1;switch(Nc.I6b){case 1:Xc=Ia&&this.nm.pH.Wh.IsTop10;break;case 2:Xc=Object(k.a)(Ke,Nc);Xc=Ia&&this.nm.pH.Ili(Xc?Xc.Owe:0,Nc.N7c);break;case 0:Xc=Ia&&this.nm.pH.Wh.IsCustomSupportedAndNotPresent}pb||
(pb=D.Oc());if(Nc.Toi)pb&&(Array.add(f.Dc,pb),pb=null);else if(Nc.vsi){var Ie=oe.a.instance.fa(Nc.cuf);Ie=this.q6c(D,Xc,kd,Ie);Array.add(Ie.menu.Dc,this.r_e(Ie.menu,D,kd+oc.a.BV,Nc.subMenu,Xc));Array.add(pb.buttons,Ie)}else Nc=oe.a.instance.fa(Nc.cuf),kd=D.GIa(kd,Nc,-699941697,null,"None",null,!1,void 0,!0),this.M1f(kd,Xc,Nc),Array.add(pb.buttons,kd)}return pb};fe.prototype.M1f=function(f,D,N){D?f.jT("Image16by16",8,R.a.Ava):f.jT("None",0,null);f.hT(N);f.label=N};fe.prototype.q6c=function(f,D,N,fa){return D?
f.i6c(N,this.menuId,fa,798637440,8,R.a.Ava):f.yw(N,this.menuId,fa,798637440)};fe.prototype.Qh=function(f){return!f||!f.length};fe.prototype.Wtf=function(f){var D=0>f?0:this.nm.Rk[0].FieldInfoDataList[f].MajorityDataTypeForField;var N=null;f=this.nm.pH.D$h(D);switch(D){case 0:N=95;D=If.eOj;break;case 1:N=94;D=If.fKi;break;case 2:N=96;D=If.Mfh;break;default:return ld.ULS.sendTraceTag(537167108,0,10,"AutoFilterFieldListContextMenu:MenuDataForDataType() - unknown data type."),{returnValue:null,eXe:N,
isChecked:f}}N=oe.a.instance.fa(N);return{returnValue:D,eXe:N,isChecked:f}};fe.prototype.rVg=function(f){!f||this.Qh(f.trim())?f=oe.a.instance.fa(97):f.length>rf.WWe?(f=f.substring(0,rf.WWe),f=String.format(oe.a.instance.Bb(154),f)):f=String.format(oe.a.instance.Bb(155),f);return f};uk.Object.defineProperties(fe.prototype,{It:{configurable:!0,enumerable:!0,get:function(){return"PopulateAutoFilterFieldListContextMenu"}},TB:{configurable:!0,enumerable:!0,get:function(){return Bf.a.QPf}}});fe.cFh=Bf.a.q6g;
fe.nKb="AutoFilterFieldListContextMenuRoot";fe.H9f="ApplyAutoFilterFieldList.";Object(Jb.a)(fe,"AutoFilterFieldListContextMenu",Qg.a,[]);var M=b(609),V=b(1051),ca=b(8),Oa=b(119),Fb=b(389),lc=Qg.a;Am(Fe,lc);Fe.prototype.executeCommand=function(f,D,N){f=Object(k.a)(M.a,N.eventArgs);switch(D.command){case -1372040782:N=We.g(this.$).ga.Pa.nc;ld.ULS.shipAssertTag(537167048,0,!!N);N&&(this.floatingObject=N.floatingObject,this.zb=D.method,D=this.Dcc(f),this.Qp(D,!0,f.zb));break;case 848910589:f&&(D=[V.a.i5f],
f=new Sys.UI.Point(f.Ca.clientX,f.Ca.clientY),this.showFloatie(D,new Sys.UI.Bounds(f.x,f.y,0,0),2))}return rg.Task.Sa(!0)};Fe.prototype.Mc=function(f,D,N){switch(D.command){case -1372040782:return!!N&&this.wlf(f);case 848910589:return f=We.g(this.$).ga.Pa.nc,!!N&&!!f&&f.isEditing;default:return!1}};Fe.prototype.wlf=function(f){switch(f){case 8:case 2:case 64:case 4:case 256:return!0;default:return!1}};Fe.prototype.NWc=function(f,D,N){Fb.a(this.$)?We.g(this.$).rb.jj||(Bg.a(this.$).vUd()?Array.add(N.buttons,
f.Cb(265)):Array.add(N.buttons,f.Cb(264))):(this.$.isEditMode&&3===this.zb&&!this.ebc()&&Array.add(N.buttons,f.Cb(101)),5!==this.floatingObject.type||Oa.a.jI(this.floatingObject.Jb)||this.floatingObject.Jb.IsGroup||(ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5449286_ShapeTextEditContextMenu")&&this.Gtd()?Array.add(N.buttons,f.Cb(186)):Array.add(N.buttons,f.Cb(147))),this.ebc()||this.Gtd()||Array.add(N.buttons,f.Cb(146)),ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChangeFOZOrder",
!1)&&(this.rLh(N),this.RMh(N)),ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1)&&0===this.floatingObject.type&&Array.add(N.buttons,f.Cb(287)),ye.EwaSettings.ma(167)&&0===this.floatingObject.type&&Array.add(N.buttons,f.Cb(249)),5===this.floatingObject.type&&We.g(this.$).ga.Pa.nc.l6()&&this.$.Nla&&this.$.$ha&&Array.add(N.buttons,f.Cb(273)))};Fe.prototype.mLa=function(f){var D=[];if(Fb.a(this.$))return D;3===f?(f=!!this.$.dg.get(5)&&this.floatingObject.BXd(),this.ebc()||
(this.$.isEditMode?(f&&Array.add(D,V.a.mIh),5===We.g(this.$).ga.Pa.VC.floatingObject.type&&Array.add(D,V.a.nAj)):f&&Array.add(D,V.a.copy)),Array.add(D,V.a.nIh)):2===f&&(ye.EwaSettings.isChangeGateEnabled("OfficeVSO:4840604_JsCrashInGetFloatieGroupsForSelection")?We.g(this.$).ga.Pa.nc&&this.l4e(We.g(this.$).ga.Pa.nc,D):this.l4e(We.g(this.$).ga.Pa.VC,D));return D};Fe.prototype.QZ=function(){var f=this.Ta,D=f.iq(this.menuId),N=Fb.a(this.$);if(this.$.isEditMode){var fa=f.Oc();this.NWc(f,D,fa);Array.add(D.Dc,
fa)}this.$.dg.get(5)&&this.floatingObject.BXd()&&!this.ebc()&&!N&&(fa=f.Oc(),this.PEg(f,fa),Array.add(D.Dc,fa));(fa=this.$.xa.oa)&&fa.Yd&&(fa=fa.Yd.vy||fa.Yd.fL,!ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||0!==this.floatingObject.type||this.$.ea.isNamedObjectViewMode||N||this.$.isMobileMode||fa||(N=f.Oc(),this.JGg(f,N),Array.add(D.Dc,N)));return D};Fe.prototype.Dcc=function(f){var D=We.g(this.$).ga.Pa.nc;f=f&&1!==f.zb&&f.clientPoint?f.clientPoint:Sys.UI.DomElement.getLocation(D.domElement);
var N=this.$.domElement,fa=We.g(this.$).rtl;(D=ca.HelperMethods.yB(D.sg.domElement,N,fa))?(f.y=Math.max(f.y,D.y),f.x=Math.max(f.x,D.x)):ld.ULS.sendTraceTag(537167047,5,15,"FloatingObjectContextMenu.GetContextMenuClientPoint sheetContentDivLocation is null if the offset parent is null. IsShuttingdown : {0}",Gg.AFrameworkApplication.Pg);return f};Fe.prototype.Gtd=function(){var f=We.g(this.$).ga.Pa.nc;return!!f&&f.isEditing};Fe.prototype.PEg=function(f,D){if(this.$.isEditMode){Array.add(D.buttons,f.Cb(42));
Array.add(D.buttons,f.Cb(43));var N=this.$.da.Aa(254,!0);(N&&2===N.ICb()||ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5449286_ShapeTextEditContextMenu")&&this.Gtd())&&Array.add(D.buttons,f.Cb(44))}else Array.add(D.buttons,f.Cb(43))};Fe.prototype.JGg=function(f,D){Array.add(D.buttons,f.Cb(274))};Fe.prototype.ebc=function(){return ye.EwaSettings.ma(477)&&!!We.g(this.$).ga.Pa.Qo};Fe.prototype.l4e=function(f,D){5===f.floatingObject.type?ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5449286_ShapeTextEditContextMenu")&&
f.isEditing?Array.add(D,V.a.i5f):Array.add(D,V.a.jAj):Array.add(D,Qg.a.lYe)};Fe.prototype.rLh=function(f){var D=this.Ta.Oc();Array.add(D.buttons,this.Ta.Cb(282));Array.add(D.buttons,this.Ta.Cb(281));var N=this.Ta.yw("BringToFront","BringToFrontMenuId",oe.a.instance.fa(805),-1777747317);Array.add(N.menu.Dc,D);Array.add(f.buttons,N)};Fe.prototype.RMh=function(f){var D=this.Ta.Oc();Array.add(D.buttons,this.Ta.Cb(284));Array.add(D.buttons,this.Ta.Cb(283));var N=this.Ta.yw("SendToBack","SendToBackMenuId",
oe.a.instance.fa(806),-1777747317);Array.add(N.menu.Dc,D);Array.add(f.buttons,N)};uk.Object.defineProperties(Fe.prototype,{It:{configurable:!0,enumerable:!0,get:function(){return"PopulateFloatingObjectContextMenu"}},TB:{configurable:!0,enumerable:!0,get:function(){return Bf.a.YPf}}});Object(Jb.a)(Fe,"FloatingObjectContextMenu",Qg.a,[]);var Oc=b(1001),wd=b(101),Rd=b(617),Oe=b(563),la=Bf.a.t6g;Am(Td,Fe);Td.prototype.executeCommand=function(f,D,N){var fa=this.$;this.zb=D.method;D=N[Td.z2c];if(!(f&68)){if(!D){if(8===
f)D=Oe.a(fa).Zc;else{var Ia=We.g(fa).ga.Pa.nc;if(null===Ia||void 0===Ia?0:Ia.floatingObject)D=Ia.floatingObject.Zc}if(!D)return rg.Task.Sa(!0)}this.isPivotChart=!!(D.Attributes&4)}if(this.isPivotChart||fa.isEditMode)if(this.refresh=this.g_=this.jxa=this.QBa=!1,Ia=We.g(this.$).ga.Pa.nc,ld.ULS.shipAssertTag(537167107,0,!!Ia),Ia){this.floatingObject=Ia.floatingObject;Ia=Rd.a(fa);if(null===Ia||void 0===Ia?0:Ia.RTd)this.QBa=Ia=wd.f(fa.qg),this.jxa=!Ia;Ia=fa.pc;this.g_=!!Oc.a(fa)&&!!D&&!!(D.Attributes&
512)&&!(f&8)&&Ia.B3(32768);Ia.allowManualDataRefresh&&Ia.allowInteractivity&&(this.refresh=!0);f=this.Dcc(Object(k.a)(M.a,N.eventArgs));this.Qp(f,!0)}return rg.Task.Sa(!0)};Td.prototype.Mc=function(f,D,N){return-149612405===D.command&&!!N&&this.wlf(f)};Td.prototype.NWc=function(f,D,N){this.isPivotChart&&(this.refresh&&Array.add(N.buttons,f.Cb(100)),this.g_&&Array.add(N.buttons,f.Cb(99)),this.QBa?Array.add(N.buttons,f.Cb(59)):this.jxa&&Array.add(N.buttons,f.Cb(58)));Fe.prototype.NWc.call(this,f,D,
N)};uk.Object.defineProperties(Td.prototype,{It:{configurable:!0,enumerable:!0,get:function(){return"PopulateChartContextMenu"}},TB:{configurable:!0,enumerable:!0,get:function(){return Bf.a.SPf}}});uk.Object.defineProperties(Td,{z2c:{configurable:!0,enumerable:!0,get:function(){return"chartMetaData"}}});Object(Jb.a)(Td,"ChartContextMenu",Fe,[]);var $a=b(11),Yb=Bf.a.v6g,Jc=Qg.a;Am(nd,Jc);nd.prototype.executeCommand=function(f,D,N){f=D.command;switch(f){case 330754562:D=N.domElement;this.isOlap=N.isOlap;
this.wM=N.versionkey;this.yo=N.fieldItem;this.N_=N.isChart;this.pI=N.isPpm;this.DXd="supportsImplicitMeasures"in N?N.supportsImplicitMeasures:!1;We.g(this.$).kr(!0);f=$a.DOMElementExtensions.getBounds(D);f=new Sys.UI.Point(f.x+f.width,f.y+f.height/2);this.eVa(f,D);"isKeyboardInput"in N&&N.isKeyboardInput?this.Qp(f,!1,1):this.Qp(f,!1);break;case 926905850:this.DXd&&this.yo&&5===this.yo.TypeTag&&!this.yo.IsCollapsible&&ld.ULS.sendTraceTag(537167057,0,50,"Add implicit measurement from field list.");
Rd.a(this.$).FH(this.yo,8,-1,this.wM,D);break;case -67292059:Rd.a(this.$).FH(this.yo,1,-1,this.wM,D);break;case 745182485:Rd.a(this.$).FH(this.yo,2,-1,this.wM,D);break;case 359279088:Rd.a(this.$).FH(this.yo,4,-1,this.wM,D);break;case 547535945:Rd.a(this.$).t$i(this.yo);break;default:return be.a(f)}return rg.Task.Sa(!0)};nd.prototype.Mc=function(f,D,N){f=!1;switch(D.command){case 330754562:f=!!N;break;case 926905850:case -67292059:case 745182485:case 359279088:case 547535945:f=!0}return f};nd.prototype.QZ=
function(){var f=this.Ta.iq(this.menuId);this.Z3i(f);this.N_||this.isOlap||this.Y3i(f);return f};nd.prototype.Z3i=function(f){var D=this.Ta,N=D.Oc(),fa=!1;ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImplicitMeasureSupport",!1)&&(fa=this.isOlap&&!this.pI&&this.DXd&&5===this.yo.TypeTag&&!this.yo.IsCollapsible);3!==this.yo.TypeTag&&37!==this.yo.TypeTag||this.yo.IsSet?17===this.yo.TypeTag||this.pI?(Array.add(N.buttons,D.Cb(79)),Array.add(N.buttons,D.Cb(this.N_?91:80)),Array.add(N.buttons,
D.Cb(this.N_?92:81)),Array.add(N.buttons,D.Cb(82))):13===this.yo.TypeTag||this.yo.IsSet?(Array.add(N.buttons,D.Cb(83)),Array.add(N.buttons,D.Cb(this.N_?91:80)),Array.add(N.buttons,D.Cb(this.N_?92:81)),Array.add(N.buttons,D.Cb(86))):(Array.add(N.buttons,D.Cb(79)),Array.add(N.buttons,D.Cb(this.N_?91:80)),Array.add(N.buttons,D.Cb(this.N_?92:81)),Array.add(N.buttons,D.Cb(fa?82:86))):(Array.add(N.buttons,D.Cb(83)),Array.add(N.buttons,D.Cb(this.N_?93:84)),Array.add(N.buttons,D.Cb(this.N_?94:85)),Array.add(N.buttons,
D.Cb(82)));Array.add(f.Dc,N)};nd.prototype.Y3i=function(f){var D=this.Ta.Oc();Array.add(D.buttons,this.Ta.Cb(78));Array.add(f.Dc,D)};uk.Object.defineProperties(nd.prototype,{It:{configurable:!0,enumerable:!0,get:function(){return"PopulateFieldListContextMenu"}},TB:{configurable:!0,enumerable:!0,get:function(){return Bf.a.QJd}}});Object(Jb.a)(nd,"FieldListContextMenu",Qg.a,[]);var td=b(437),Tc=b(62);Rc.prototype.get=function(f,D,N){var fa=this.teg(f,"PivotFilterContextMenuCache.Get");return fa&&this.nO[fa]?
this.nO[fa][Rc.Gid(D,this.$,f,N)]:null};Rc.prototype.set=function(f,D,N,fa){var Ia=this.teg(f,"PivotFilterContextMenuCache.Set");Ia&&(this.nO[Ia]||(this.nO[Ia]={}),this.nO[Ia][Rc.Gid(D,this.$,f,fa)]=N)};Rc.prototype.h9b=function(f){f in this.nO&&this.nO[f]&&(this.nO[f]=null)};Rc.prototype.teg=function(f,D){return Tc.f(this.$.oa)?this.$.activeItemName:(f=this.BSj(f,D))?f.Zd:null};Rc.prototype.BSj=function(f,D){f=af.C(f);f=We.g(this.$).Da.ywa(f,this.$.activeItemName);ld.ULS.shipAssertTag(537167008,
0,!!f,"PivotFilterContextMenuBase.TryGetBlockModelProxyFromCell: Can't query the menuCache as block wasn't found in the BlockManager (returned null). Called from: {0}",D);return f};Rc.Gid=function(f,D,N,fa){return ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")&&0===fa?D.oa.index+"_"+f.id+"_"+N.FirstRow.toString()+"_"+N.FirstColumn.toString():D.oa.index+"_"+f.id};Object(Jb.a)(Rc,"PivotFilterContextMenuCache",null,[]);Object(Jb.a)(mc,"ShowPivotFilterData",null,[]);var ve=b(615),
Ye=b(1346),Te=b(52),Qf=Bf.a.LFe,kg=Qg.a;Am(ke,kg);ke.prototype.qcd=function(f,D){var N=this,fa=f.rawEvent,Ia=f.cell,pb=f.requiresConfirmation;ve.a(this.$).Wx(pb,function(Wb){if(Wb){Wb=fa?new Sys.UI.DomEvent(fa):null;N.pivotData=new mc;N.pivotData.pivotName=f.pivotName;N.pivotData.dataSourceIndex=f.dataSourceIndex;N.pivotData.cell=Ia;N.pivotData.Ko=f.optionalPivotMenuAnchorParameter;if(N.pivotData.Ko&&0<N.pivotData.Ko.AnchorType){N.voc=f.objectId;N.VEb=f.objectVersion;var Nc=N.pivotData.Ko.AnchorType;
if(4===Nc||5===Nc||6===Nc||11===Nc||9===Nc||10===Nc||8===Nc)N.iob=f.location}else N.WBd=N.voc=null,N.XBd=N.VEb=-1;We.g(N.$).kr(!0);N.$.Jj(Ia);N.w1(Wb,Wb?Wb.target:f.domElement,N.pivotData,D,N.oNa())}});return!0};ke.prototype.w1=function(f,D,N,fa){var Ia=this;if(Object(td.a)(mc,N)){this.pivotData=N;this.U6b=D;this.snf=f;this.P3b=this.pivotData.Ko?this.pivotData.Ko.AnchorValue1:-1;this.rZ=this.pivotData.Ko?this.pivotData.Ko.AnchorType:0;var pb=!1,Wb=null;Wb=ke.nO.get(this.pivotData.cell,D,this.rZ);
pb=!!Wb;var Nc=!0;switch(this.rZ){case 4:case 5:case 6:this.Oda=new Sys.UI.Point(this.iob.x,this.iob.y);Nc=!1;break;case 7:var kd=Sys.UI.DomElement.getBounds(D);Nc=kd.x+(0<=kd.x?0:kd.width);kd=kd.y+(0<=kd.y?0:kd.height);this.Oda=new Sys.UI.Point(0<=Nc?Nc:0,0<=kd?kd:0);Nc=!1;break;case 8:case 10:case 9:case 11:this.Oda=new Sys.UI.Point(this.iob.x,this.iob.y);break;default:this.Oda=null}pb&&this.voc===this.WBd&&this.VEb===this.XBd&&this.P3b===this.zBe&&this.rZ===this.Bte?(ld.ULS.sendTraceTag(537167042,
0,50,"PivotFilterContextMenuBase.ShowDropDown: rendering pivot filter context menu from menu cache"),this.ltb=Wb,this.Oda?(this.eVa(this.Oda,D),this.Qp(this.Oda,this.oNa())):this.ty?(!ye.EwaSettings.isChangeGateEnabled("OfficeVSO:6053383_EnsureContextMenuCellInView")||Qg.a.Kqd(this.$,this.pivotData.cell))&&this.Qp(Qg.a.Pgd(this.$,this.pivotData.cell,!1),this.oNa()):kg.prototype.w1.call(this,f,D,N,fa,this.oNa())):1!==ke.mUh(D)&&(Nc&&(D.parentNode.menuFetchStates=1,this.Luj(D),this.u1f(!0)),this.$.userOperationManager.jc(new Mf.a(126,
0,function(Xc,Ie,Ze){var Sf=Ia.$;return Se.A(Sf.na.ta,Ia.pivotData.cell,Ia.pivotData.dataSourceIndex,Ia.pivotData.pivotName,Sf.domElement.id,Sf.isChromeRtl,Sf.workbookContext.NovMode,Pg.b(Xc,Ia.cRi),Pg.a(Ie,Ia.bRi),Ze,D,Ia.pivotData.Ko)},16),fa))}};ke.prototype.cHd=function(f){Array.addRange(f.MenuSectionList,this.ltb)};ke.prototype.Xyd=function(f,D){f.parentNode.menuFetchStates=2;this.u1f(!1);if(D){if(this.U6b!==f||this.ZEi())this.eVa(this.Oda,f),this.Qp(this.Oda,this.oNa());else if(this.ty&&!this.Oda){if(ye.EwaSettings.isChangeGateEnabled("OfficeVSO:6053383_EnsureContextMenuCellInView")&&
!Qg.a.Kqd(this.$,this.pivotData.cell))return;this.Qp(Qg.a.Pgd(this.$,this.pivotData.cell,!1),this.oNa())}else kg.prototype.w1.call(this,this.snf,f,null,null,this.oNa());this.WBd=this.voc;this.XBd=this.VEb;this.Bte=this.rZ;this.zBe=this.P3b}};ke.prototype.oNa=function(){return 8!==this.rZ&&9!==this.rZ&&10!==this.rZ&&11!==this.rZ};ke.prototype.ZEi=function(){switch(this.pivotData.Ko?this.pivotData.Ko.AnchorType:0){case 1:case 2:case 3:case 4:case 5:case 6:case 7:return!0;default:return!1}};ke.prototype.u1f=
function(f){var D=this.U6b;if(D){if(ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5041973_FixDropdownImageDisappearing")){var N=$a.DOMElementExtensions.r_(D,"ewaprevsrc","");N=!!N&&"null"!==N}else N=!!$a.DOMElementExtensions.r_(D,"ewaprevsrc","");f&&N||!f&&!N||(f?(D.setAttribute("ewaprevsrc",D.src),D.src=Te.a.current.Bo(77)):(f=$a.DOMElementExtensions.r_(D,"ewaprevsrc",""),D.src=f,D.setAttribute("ewaprevsrc",null)))}};ke.prototype.Luj=function(f){this.U6b=f};ke.mUh=function(f){var D=f.parentNode.menuFetchStates;
void 0===D&&(f.parentNode.menuFetchStates=0);return D};ke.nO=null;Object(Jb.a)(ke,"PivotFilterContextMenuBase",Qg.a,[]);var yg="FieldList"+Bf.a.LFe;Am(Ed,ke);Ed.prototype.executeCommand=function(f,D,N){return this.qcd(N,D)?rg.Task.Sa(!0):be.a(D.command)};Ed.prototype.Mc=function(f,D,N){return-1065117584===D.command&&!!N};uk.Object.defineProperties(Ed.prototype,{It:{configurable:!0,enumerable:!0,get:function(){return"PopulateFieldListPivotMenu"}},TB:{configurable:!0,enumerable:!0,get:function(){return Bf.a.WPf}}});
Object(Jb.a)(Ed,"FieldListPivotContextMenu",ke,[]);var Lg=b(28),Mg=b(936);Object(Jb.a)(Md,"PivotValueFieldSettingsApplyData",null,[]);Yc.sfh="dataFieldCustomLabel";Yc.NJe="dataFieldSourceLabel";Yc.FVd="showValueAsSelect";Yc.DVd="showValueAsBaseFieldSelect";Yc.EVd="showValueAsBaseItemSelect";Yc.T1d="valueFieldsSettingsFieldName";Yc.wjg="valueFieldSettingTabs";Object(Jb.a)(Yc,"CssElementIds",null,[]);var ai=b(115);Object(Jb.a)(vc,"MacroRecorderPivotFieldShowValueAsParameters",null,[]);Ib.prototype.getActiveCell=
function(){return this.activeCell};Object(Jb.a)(Ib,"MacroRecorderPivotValueFieldSettingAppliedPayload",null,[428]);var Ug=b(240);Object(Jb.a)(Na,"PivotValueFieldShowValueAsApplyData",null,[]);var nh=b(937),Og=b(42),Ei="<div id='showValueAsControlBody'><label for='"+Yc.FVd+"' class='"+ai.a.wo+" valueFielsSettingsControlTitle'>{0}</label><div><select size=1 id='"+Yc.FVd+"' class='"+ai.a.aD+"'></select></div><div class='showValueAsControlSelectRegion'><label for='"+Yc.DVd+"'>{1}</label><div><select size=6 id='"+
Yc.DVd+"' class='"+ai.a.aD+"'></select></div></div><div class='showValueAsControlSelectRegionSeparator'></div><div class='showValueAsControlSelectRegion'><label for='"+Yc.EVd+"'>{2}</label><div><select size=6 id='"+Yc.EVd+"' class='"+ai.a.aD+"'></select></div></div></div>",Vh=Ug.a;Am(eg,Vh);eg.prototype.Rka=function(){return this.isVisible};eg.prototype.Koa=function(f){return this.isVisible=f};eg.prototype.setFocus=function(){$a.DOMElementExtensions.setFocus(this.s4.ao)};eg.prototype.render=function(f){f.appendChild(this.domElement)};
eg.prototype.dispose=function(){Ag.a.tc([this.s4,this.SU,this.DQ,this.w7b,this.g2b]);Vh.prototype.dispose.call(this)};eg.prototype.oxj=function(f){Ag.a.tc([this.w7b,this.g2b]);this.s4.clear();for(var D=Cl(f.DataFormatTypes),N=D.next();!N.done;N=D.next())N=N.value,this.s4.XM(eg.ySh(N),N.toString(),N===f.SelectedDataFormat);this.w7b=this.Rd.Gd(this.s4.domElement);this.w7b.ka("change",this.lAf);this.SU.clear();D=Cl(f.BaseFieldList);for(N=D.next();!N.done;N=D.next())N=N.value,this.SU.XM(N.DisplayString,
N.Id.toString(),N.Id===f.SelectedBaseField);this.g2b=this.Rd.Gd(this.s4.domElement);this.g2b.ka("change",this.YLi);this.dG=this.$ia.d2a(this.DQ.ao.parentNode,1E3,null,"",723);this.lAf(null)};eg.prototype.XR=function(f){this.s4.XR(f);this.SU.XR(f);this.DQ.XR(f)};eg.prototype.nla=function(){this.domElement.innerHTML=String.format(Ei,oe.a.instance.fa(1073),oe.a.instance.fa(1074),oe.a.instance.fa(1075));this.a8d=new nh.a($a.DOMElementExtensions.getElementById(this.domElement,Yc.FVd),!1);this.A5d=new nh.a($a.DOMElementExtensions.getElementById(this.domElement,
Yc.DVd),!1);this.B5d=new nh.a($a.DOMElementExtensions.getElementById(this.domElement,Yc.EVd),!1)};eg.prototype.MYg=function(f){return this.npi||!eg.Wff(f)&&!eg.Xff(f)?!0:!!this.SU.count};eg.prototype.getValueFieldSettingsShowValueAsBaseItemsInfo=function(){var f=this;this.$.userOperationManager.jc(new Mf.a(108,0,function(D,N,fa){var Ia=f.$.na.ta,pb=parseInt(f.SU.ve.value,10);D=Pg.b.call(null,D,f.ZRi);var Wb=Se.nb(Ia,f.cell,f.externalSourceIndex,f.Ko);Wb.selectedBaseField=pb;return Se.i(Ia,"GetPivotValueFieldSettingsShowValueAsBaseItems",
Wb,D,N,fa,null,4)},16),this.Xd)};eg.prototype.Yof=function(){this.DQ.clear();this.SU.ve&&(this.dG.ZBa(),this.DQ.ao.style.overflowY="hidden",this.getValueFieldSettingsShowValueAsBaseItemsInfo())};eg.prototype.uPb=function(f){var D=document.getElementById("WACDialogActionButton");this.OXj&&D&&(D.disabled=f)};eg.ySh=function(f){switch(f){case 0:return oe.a.instance.fa(1076);case 1:return oe.a.instance.fa(1077);case 2:return oe.a.instance.fa(1078);case 3:return oe.a.instance.fa(1079);case 4:return oe.a.instance.fa(1080);
case 5:return oe.a.instance.fa(1081);case 6:return oe.a.instance.fa(1082);case 7:return oe.a.instance.fa(1083);case 8:return oe.a.instance.fa(1085);case 9:return oe.a.instance.fa(1086);case 10:return oe.a.instance.fa(1087);case 11:return oe.a.instance.fa(1088);case 12:return oe.a.instance.fa(1089);case 13:return oe.a.instance.fa(1090);case 14:return oe.a.instance.fa(1091);default:return""}};eg.Wff=function(f){return 11===f||12===f||14===f||13===f||4===f};eg.Xff=function(f){return 1===f||3===f||2===
f};uk.Object.defineProperties(eg.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return oe.a.instance.fa(1072)}},Exb:{configurable:!0,enumerable:!0,get:function(){var f=this.s4.ve?parseInt(this.s4.ve.value,10):-1,D=this.SU.ve?parseInt(this.SU.ve.value,10):-1,N=this.DQ.ve?parseInt(this.DQ.ve.value,10):-1;return Object.assign(new Na,{SelectedDataFormat:0<=f?f:-1,SelectedBaseField:D,SelectedBaseItem:N})}},SU:{configurable:!0,enumerable:!0,get:function(){return this.A5d}},DQ:{configurable:!0,
enumerable:!0,get:function(){return this.B5d}},s4:{configurable:!0,enumerable:!0,get:function(){return this.a8d}}});Object(Jb.a)(eg,"ShowValueAsControl",Ug.a,[809,3]);Object(Jb.a)(Ef,"PivotValueFieldSummarizeValueByApplyData",null,[]);var Xi="<div id='summarizeValuesByControlBody'><label class='"+(ai.a.wo+" valueFielsSettingsControlTitle' for='pivotDataFieldSelect'>{0}</label><div id='pivotDataFieldSelectDescription' class='")+(ai.a.wo+" summarizeValuesByControlDescription'>{1}</div><div><select class='")+
(ai.a.aD+"' size=6 id='pivotDataFieldSelect' style='width: 100%' "+Bf.a.aK+"='pivotDataFieldSelectDescription'></select></div></div>"),yj=Ug.a;Am(lg,yj);lg.prototype.Rka=function(){return this.isVisible};lg.prototype.Koa=function(f){return this.isVisible=f};lg.prototype.setFocus=function(){$a.DOMElementExtensions.setFocus(this.ol.ao)};lg.prototype.render=function(f){f.appendChild(this.domElement)};lg.prototype.dispose=function(){Ag.a.Fa(this.ol);yj.prototype.dispose.call(this)};lg.prototype.focus=
function(){$a.DOMElementExtensions.setFocus(this.ol.ao)};lg.prototype.nxj=function(f){this.ol.BWd();for(var D=Cl(f.AggregationTypes),N=D.next();!N.done;N=D.next()){N=N.value;var fa=N===f.SelectedAggregation;this.ol.KWc(lg.dOh(N),N.toString(),fa,"")}this.ol.T$c();this.ol.ao.disabled=f.AggregationsDisabled};lg.prototype.Omj=function(){this.ol.Pmj()};lg.prototype.nla=function(){this.domElement.innerHTML=String.format(Xi,oe.a.instance.fa(1056),oe.a.instance.fa(1057));this.nhe=new nh.a($a.DOMElementExtensions.getElementById(this.domElement,
lg.aLf),!1)};lg.dOh=function(f){switch(f){case 0:return oe.a.instance.fa(1059);case 1:return oe.a.instance.fa(1060);case 2:return oe.a.instance.fa(1061);case 3:return oe.a.instance.fa(1062);case 4:return oe.a.instance.fa(1063);case 5:return oe.a.instance.fa(1064);case 6:return oe.a.instance.fa(1065);case 7:return oe.a.instance.fa(1066);case 8:return oe.a.instance.fa(1067);case 9:return oe.a.instance.fa(1068);case 10:return oe.a.instance.fa(1069);case 11:return oe.a.instance.fa(1070);default:return""}};
uk.Object.defineProperties(lg.prototype,{Exb:{configurable:!0,enumerable:!0,get:function(){var f=this.ol.ve?parseInt(this.ol.ve.value,10):-1;return Object.assign(new Ef,{Aggregation:0<=f?f:-1})}},title:{configurable:!0,enumerable:!0,get:function(){return oe.a.instance.fa(1071)}},enabled:{configurable:!0,enumerable:!0,get:function(){return!this.ol.ao.disabled},set:function(f){this.ol.ao.disabled=!f}},ol:{configurable:!0,enumerable:!0,get:function(){return this.nhe}}});lg.aLf="pivotDataFieldSelect";
Object(Jb.a)(lg,"SummarizeValuesByControl",Ug.a,[809,3]);var yi=b(212),Hg=b(492);Eg.prototype.PMj=function(f,D){f.set_visible(!1);D.set_visible(!0)};Object(Jb.a)(Eg,"DefaultTabSwitchBehaviour",null,[823]);Ee.BNj="TabsContainer";Ee.kNj="TabTitlesContainer";Ee.iNj="TabTitle";Ee.jNj="TabTitleText";Ee.$Xd="TabTitleActive";Object(Jb.a)(Ee,"MultitabControlStyles",null,[]);var ni=b(41),jj=b(85),Y=b(90),Ra=b(55);Of.prototype.dispose=function(){ni.a.removeHandler(this.gi,"keyup",Object(Nh.a)(this,this.vab,
"onTitleKeyUp"));ni.a.removeHandler(this.gi,"click",this.KIc);this.gi=this.zga=null};Of.prototype.setActive=function(f){f?Sys.UI.DomElement.addCssClass(this.gi,Ee.$Xd):Sys.UI.DomElement.removeCssClass(this.gi,Ee.$Xd);this.zga&&this.zga.setAttribute(Y.a.bia,f)};Of.prototype.vab=function(f){f.keyCode!==jj.a.fi&&f.keyCode!==jj.a.Xpa||this.KIc(f)};Of.prototype.ADc=function(){this.gi.setAttribute(Y.a.Vd,Y.a.ls);this.zga.setAttribute(Y.a.Zt,this.Zp);this.zga.setAttribute(Y.a.Vd,Y.a.Wpb)};uk.Object.defineProperties(Of.prototype,
{Kb:{configurable:!0,enumerable:!0,get:function(){return this.gi}},title:{configurable:!0,enumerable:!0,get:function(){return this.Zp}},isActive:{configurable:!0,enumerable:!0,get:function(){return Sys.UI.DomElement.containsCssClass(this.gi,Ee.$Xd)},set:function(f){this.setActive(f)}}});Object(Jb.a)(Of,"TabTitleControl",null,[3]);var Db=b(37);Qd.prototype.lVf=function(){this.Tnb=document.createElement("ul");this.Tnb.className=Ee.kNj;this.Jnb=document.createElement("div");this.Jnb.className=Ee.BNj;
for(var f=0;f<this.DBc;++f){var D=this.dZ.pa(f),N=this.$Fa.pa(f);D.set_visible(!1);N.isActive=!1;var fa=document.createElement("div");D.render(fa);this.Jnb.appendChild(fa);this.Tnb.appendChild(N.Kb)}this.Kb.appendChild(this.Tnb);this.Kb.appendChild(this.Jnb);this.Hud(this.k2)&&(this.$Fa.pa(this.k2).isActive=!0,this.dZ.pa(this.k2).set_visible(!0))};Qd.prototype.dispose=function(){for(var f=0;f<this.DBc;++f)this.dZ.pa(f).dispose(),this.$Fa.pa(f).dispose();this.$Fa=this.dZ=this.gi=this.Jnb=this.Tnb=
null};Qd.prototype.setFocus=function(){this.dZ.pa(this.k2).setFocus()};Qd.prototype.Hud=function(f){return 0<=f&&f<this.DBc};Qd.prototype.jbg=function(f){this.k2!==f&&this.Hud(f)&&(this.cBg.PMj(this.dZ.pa(this.k2),this.dZ.pa(f)),this.$Fa.pa(this.k2).isActive=!1,this.$Fa.pa(f).isActive=!0,this.k2=f,this.setFocus())};Qd.prototype.t$g=function(f){var D=this;return function(){D.jbg(f)}};uk.Object.defineProperties(Qd.prototype,{DBc:{configurable:!0,enumerable:!0,get:function(){return this.dZ.count}},activeTab:{configurable:!0,
enumerable:!0,get:function(){return this.k2},set:function(f){this.jbg(f)}},Kb:{configurable:!0,enumerable:!0,get:function(){return this.gi}},visible:{configurable:!0,enumerable:!0,get:function(){return Db.a.isVisible(this.gi)},set:function(f){this.gi.style.visibility=f?"visible":"hidden"}}});Object(Jb.a)(Qd,"MultitabControl",null,[808,3]);var ec=Mg.a;Am(Le,ec);Le.prototype.dispose=function(){this.b8c=this.ytb=this.GTa=this.oUc=null;Ag.a.Fa(this.Mga);this.Mga=null;ec.prototype.dispose.call(this)};
Le.prototype.initialize=function(){var f="<div id='"+Yc.NJe+"' class='"+ai.a.wo+"'></div><div id='"+Yc.sfh+"' class='"+ai.a.wo+"'><label for='"+Yc.T1d+"'>{0}</label><input type='text' id='"+Yc.T1d+"' value='{1}' class='"+ai.a.aD+" UIFont' /></div><div id='"+Yc.wjg+"'></div>";f=String.format(f,oe.a.instance.fa(1055),Lg.a.Rf(this.vjg));this.Rb.innerHTML=f;this.Pe||(this.s3(),this.ll());this.bne=[-103190598];this.s5h();ec.prototype.initialize.call(this)};Le.prototype.close=function(f){1===f&&(this.d7f=
!1);ec.prototype.close.call(this,f)};Le.prototype.QLe=function(f){this.cS=f;this.domElement.disabled=f;for(var D=["input","option","select"],N=0,fa=D.length;N<fa;++N)for(var Ia=this.domElement.getElementsByTagName(D[N]),pb=0;pb<Ia.length;++pb)Ia[pb].disabled=f};Le.prototype.ll=function(){this.ytb=document.getElementById(Yc.T1d);this.b8c=$a.DOMElementExtensions.getElementById(this.Rb,Yc.NJe);var f=$a.DOMElementExtensions.getElementById(this.Rb,Yc.wjg);this.oUc=new lg(document.createElement("div"));
this.GTa=new eg(document.createElement("div"),this.$,this.cell,this.Ko,this.externalSourceIndex,this.Xd,this.$ia,!this.isOlap);var D;this.Mga=new Qd(f,(D=new Ab.a,D.add(this.kUa),D.add(this.GTa),D));this.Mga.lVf()};Le.prototype.rsc=function(){var f=new Le(this.cell,this.Ko,this.externalSourceIndex,this.vjg,this.$,this.Xd,this.$ia,this.isOlap,this.pI);f.initialize();f.pf()};Le.prototype.wVa=function(){var f=new Hg.a;if(!this.d7f)return f.isValid=!0,f;this.ytb.value.length?f.isValid=!0:(this.QLe(!0),
f.error=Cf.a.ed(1,0,738,753,0,1783218700,"PivotTableValueFieldNoBlank"),this.cS=!0,this.Pe||(this.Ux.disabled=!0),f.isValid=!1);return f};Le.prototype.K9e=function(){this.cS=!1;this.Pe||(this.Ux.disabled=!1);this.QLe(!1)};Le.prototype.Bza=function(f){var D=new bg.a(2105621672,0,this.$.jd,30,null);this.$.Ka.dc(D);this.GX(5,f.zb,"Number Format");return!0};Le.prototype.um=function(){this.uCa=String.format(oe.a.instance.Bb(60),null);ec.prototype.um.call(this)};Le.prototype.setFocus=function(){if(this.Pe){var f=
$a.DOMElementExtensions.getElementById(this.Rb,lg.aLf);yi.a.bDc(f)}else this.Mga.setFocus()};Le.prototype.Bk=function(){var f=this,D=this.GTa.Exb,N=new vc(D.SelectedDataFormat,D.SelectedBaseField,D.SelectedBaseItem);return function(){return new Ib(f.externalSourceIndex,f.cell,f.ytb.value,f.kUa.Exb.Aggregation,N)}};Le.prototype.Ox=function(){var f=this,D=Object.assign(new Md,{PivotValueFieldSummarizeValueByApplyData:this.kUa.Exb,PivotValueFieldShowValueAsApplyData:this.GTa.Exb,PivotValueFieldTitle:this.ytb.value});
return function(N,fa,Ia){var pb=f.$.na.ta;N=Pg.b(N,f.NLi);var Wb=Se.nb(pb,f.cell,f.externalSourceIndex,f.Ko);Wb.pivotValueFieldSettingsApplyData=D;return Se.i(pb,"ApplyPivotValueFieldSettings",Wb,N,fa,Ia,null,0)}};Le.prototype.XR=function(f){var D=this;this.$.da.Ya(40,function(){D.GTa.XR(f)})};Le.prototype.s5h=function(){var f=this;this.$.userOperationManager.jc(new Mf.a(123,0,function(D,N,fa){var Ia=f.$.na.ta;D=Pg.b.call(null,D,f.YRi);var pb=Se.nb(Ia,f.cell,f.externalSourceIndex,f.Ko);return Se.i(Ia,
"GetPivotValueFieldSettingsInitial",pb,D,N,fa,null,4)},16),this.Xd)};uk.Object.defineProperties(Le.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"ValueFieldSettingsDialog"}},xfa:{configurable:!0,enumerable:!0,get:function(){return this.bne}},tEb:{configurable:!0,enumerable:!0,get:function(){return this.Mga}},kUa:{configurable:!0,enumerable:!0,get:function(){return this.oUc}},Mu:{configurable:!0,enumerable:!0,get:function(){return 560}}});Object(Jb.a)(Le,"ValueFieldSettingsDialog",
Mg.a,[]);var gd=Bf.a.w6g,Jd=Qg.a;Am(ug,Jd);ug.prototype.executeCommand=function(f,D,N,fa){var Ia=this;f=D.command;switch(f){case -1453503574:fa=N.domElement;this.yo=N.fieldItem;this.c3d=N.zoneCount;this.TTa=N.sourceAxis;this.GAc=N.sourceAxisPos;this.Ko=N.optionalPivotMenuAnchorParameter;this.wM=N.versionkey;this.isOlap=N.isOlap;this.pI=N.isPpm;this.U3a="fieldItemsupportsImplicitMeasures"in N?N.fieldItemsupportsImplicitMeasures:!1;this.cell=N.cell;this.externalSourceIndex=N.externalSourceIndex;We.g(this.$).kr(!0);
f=$a.DOMElementExtensions.getBounds(fa);var pb=new Sys.UI.Point(f.x,f.y+f.height);this.$.isChromeRtl&&(pb.x+=f.width);this.eVa(pb,fa);"isKeyboardInput"in N&&N.isKeyboardInput?this.Qp(pb,!1,1):this.Qp(pb,!1);break;case 495005930:Rd.a(this.$).Djh();break;case -1170196828:Rd.a(this.$).FH(this.yo,this.TTa,this.GAc-1,this.wM,D);break;case -889576107:Rd.a(this.$).FH(this.yo,this.TTa,this.GAc+2,this.wM,D);break;case 2033235475:Rd.a(this.$).FH(this.yo,this.TTa,this.c3d,this.wM,D);break;case 389774337:Rd.a(this.$).FH(this.yo,
this.TTa,0,this.wM,D);break;case -96230454:Rd.a(this.$).FH(this.yo,4,-1,this.wM,D);break;case 74086617:Rd.a(this.$).FH(this.yo,1,-1,this.wM,D);break;case 1529312473:Rd.a(this.$).FH(this.yo,2,-1,this.wM,D);break;case 563292088:this.U3a&&ld.ULS.sendTraceTag(537167056,0,50,"Move a field into values area as implicit measurement.");Rd.a(this.$).FH(this.yo,8,-1,this.wM,D);break;case -1092351914:Rd.a(this.$).FH(this.yo,0,-1,this.wM,D);break;case -2141589616:var Wb=mf.GetServiceTaskFactory.Ua(this.$.da,12,
477,fa.Jka());return ud.TaskExtensions.Ba(Wb,function(){(new Le(Ia.cell,Ia.Ko,Ia.externalSourceIndex,Ia.yo.Name,Ia.$,D,Wb.result,Ia.isOlap,Ia.pI)).initialize()},this.la);default:return be.a(f)}return rg.Task.Sa(!0)};ug.prototype.Mc=function(f,D,N){f=!1;switch(D.command){case -1453503574:f=!!N;break;case 495005930:case -1170196828:case -889576107:case 2033235475:case 389774337:case -96230454:case 74086617:case 1529312473:case 563292088:case -1092351914:case -2141589616:f=!0}return f};ug.prototype.QZ=
function(){var f=this.Ta.iq(this.menuId);this.f4i(f,this.GAc,this.c3d);this.g4i(f,this.TTa);this.h4i(f);8===this.TTa&&this.d4i(f);return f};ug.prototype.f4i=function(f,D,N){var fa=this.Ta,Ia=fa.Oc();D||D!==N-1?!D&&D<N-1?(Array.add(Ia.buttons,fa.Cb(64)),Array.add(Ia.buttons,fa.Cb(61)),Array.add(Ia.buttons,fa.Cb(66)),Array.add(Ia.buttons,fa.Cb(63))):0<D&&D<N-1?(Array.add(Ia.buttons,fa.Cb(60)),Array.add(Ia.buttons,fa.Cb(61)),Array.add(Ia.buttons,fa.Cb(62)),Array.add(Ia.buttons,fa.Cb(63))):0<D&&D===N-
1&&(Array.add(Ia.buttons,fa.Cb(60)),Array.add(Ia.buttons,fa.Cb(65)),Array.add(Ia.buttons,fa.Cb(62)),Array.add(Ia.buttons,fa.Cb(67))):(Array.add(Ia.buttons,fa.Cb(64)),Array.add(Ia.buttons,fa.Cb(65)),Array.add(Ia.buttons,fa.Cb(66)),Array.add(Ia.buttons,fa.Cb(67)));Array.add(f.Dc,Ia)};ug.prototype.g4i=function(f,D){var N=this.Ta,fa=N.Oc(),Ia=1!==D&&(!this.isOlap||this.pI||8!==D||this.U3a),pb=2!==D&&(!this.isOlap||this.pI||8!==D||this.U3a),Wb=8!==D&&-2!==this.yo.PivotTableIndex&&(!this.isOlap||this.pI||
this.U3a);Array.add(fa.buttons,N.Cb(4===D||this.yo.IsSet||-2===this.yo.PivotTableIndex||this.isOlap&&!this.pI&&8===D&&!this.U3a?72:68));8===this.Ko.AnchorType||10===this.Ko.AnchorType?(Array.add(fa.buttons,N.Cb(Ia?95:97)),Array.add(fa.buttons,N.Cb(pb?96:98))):(Array.add(fa.buttons,N.Cb(Ia?69:73)),Array.add(fa.buttons,N.Cb(pb?70:74)));Array.add(fa.buttons,N.Cb(Wb?71:75));Array.add(f.Dc,fa)};ug.prototype.h4i=function(f){var D=this.Ta.Oc();Array.add(D.buttons,this.Ta.Cb(76));Array.add(f.Dc,D)};ug.prototype.d4i=
function(f){var D=this.Ta.Oc();Array.add(D.buttons,this.Ta.Cb(77));Array.add(f.Dc,D)};uk.Object.defineProperties(ug.prototype,{It:{configurable:!0,enumerable:!0,get:function(){return"PopulateFieldWellContextMenu"}},TB:{configurable:!0,enumerable:!0,get:function(){return Bf.a.RJd}}});Object(Jb.a)(ug,"FieldWellContextMenu",Qg.a,[]);var Xd=b(1309);Am(Tf,ke);Tf.prototype.executeCommand=function(f,D,N){var fa=!1,Ia=D.command;switch(Ia){case 37023044:fa=this.qcd(N,D);break;case 541421805:case -569786022:fa=
this.cmd(f,D)}return fa?rg.Task.Sa(!0):be.a(Ia)};Tf.prototype.Mc=function(f,D,N){f=!1;switch(D.command){case 37023044:f=!!N;break;case 541421805:case -569786022:f=!0}return f};Tf.prototype.cmd=function(f,D){var N=8===f,fa=this.$,Ia=Oe.a(fa),pb=We.g(fa).ga.Pa.nc,Wb=f=null;N&&Ia?(f=Ia.chartId,Wb=Ia.Zc):!N&&pb&&(f=pb.floatingObject.id,Wb=pb.floatingObject.Zc);return Tf.zve(Wb,260)?(N={},fa.Jj(N),N.FirstColumn=N.FirstRow=-1,fa={},Wb=(fa.rawEvent=null,fa.pivotName=null,fa.cell=N,fa.requiresConfirmation=
Tf.zve(Wb,64),fa.dataSourceIndex=Wb.ExternalSourceIndex,fa),pb?(Ia=pb.floatingObject,Wb.domElement=pb.domElement,Wb.objectId=Ia.id,Wb.objectVersion=Ia.version):Ia&&(Wb.domElement=Ia.ik,Wb.objectId=Ia.chartId,Wb.objectVersion=Ia.BBe),pb={AnchorType:7},pb.ChartId=f,pb.AnchorValue1=-1,pb.AnchorValue2=-1,Wb.optionalPivotMenuAnchorParameter=pb,this.qcd(Wb,D)):!1};Tf.zve=function(f,D){return(f.Attributes&D)===D};uk.Object.defineProperties(Tf.prototype,{It:{configurable:!0,enumerable:!0,get:function(){return"PopulatePivotContextMenu"}},
TB:{configurable:!0,enumerable:!0,get:function(){return Bf.a.bQf}}});Object(Jb.a)(Tf,"PivotFilterContextMenu",ke,[]);var xe=b(1344),cf=b(1050),pf=b(159),ff=b(27),tg=Bf.a.A6g,Ig=tg+".RemoveField",qg=tg+".Subtotal",pi=tg+".ClearFilter",Ld=tg+".LayoutSameColumn",qi=tg+".LayoutNextColumn",W=Qg.a;Am(Wf,W);Wf.prototype.executeCommand=function(f,D,N){D=D.command;f=null;this.grid=We.g(this.$);this.activeCell=af.o(this.grid.ga.va.activeCell,this.$);if(this.$.isEditMode&&(this.Tc=this.grid.Tb.qp(this.grid.ga.va.activeCell),
!this.Tc))return ld.ULS.sendTraceTag(537167007,0,10,"No PivotTable range found."),ud.TaskExtensions.s5();this.pFc=this.$.na.ta;this.S1a=Object(k.a)(M.a,N.eventArgs);switch(D){case 671488277:this.uDj()?this.e_h():(this.Zcb(),this.showPivotTableContextMenu());break;case 1801458190:this.performPivotTableOperation(1801458190,1);break;case -2016405815:this.performPivotTableOperation(-2016405815,6);break;case 671485366:this.performPivotTableOperation(671485366,7);break;case 772221736:this.performPivotTableOperation(772221736,
8);break;case 1600778266:this.performPivotTableOperation(1600778266,2);break;case -556893687:this.performPivotTableOperation(-556893687,3);break;case -1966978671:this.performPivotTableOperation(-1966978671,4);break;case -1951357930:this.performPivotTableOperation(-1951357930,5);break;case -1390365353:this.performPivotTableOperation(-1390365353,9);break;case -1457478532:this.performPivotTableOperation(-1457478532,10);break;case -771066011:this.rA.PivotValueFieldSummarizeValueByApplyData.Aggregation=
2;this.applyValueFieldSettingsToPivotTable(-771066011,!0);break;case 1746132849:this.rA.PivotValueFieldSummarizeValueByApplyData.Aggregation=1;this.applyValueFieldSettingsToPivotTable(1746132849,!0);break;case 1475494885:this.rA.PivotValueFieldSummarizeValueByApplyData.Aggregation=6;this.applyValueFieldSettingsToPivotTable(1475494885);break;case 376946683:this.rA.PivotValueFieldSummarizeValueByApplyData.Aggregation=11;this.applyValueFieldSettingsToPivotTable(376946683,!0);break;case 835007294:this.rA.PivotValueFieldSummarizeValueByApplyData.Aggregation=
3;this.applyValueFieldSettingsToPivotTable(835007294,!0);break;case 929115636:this.rA.PivotValueFieldSummarizeValueByApplyData.Aggregation=4;this.applyValueFieldSettingsToPivotTable(929115636,!0);break;case 1935475057:this.rA.PivotValueFieldSummarizeValueByApplyData.Aggregation=5;this.applyValueFieldSettingsToPivotTable(1935475057,!0);break;case 588680636:this.rA.PivotValueFieldSummarizeValueByApplyData.Aggregation=7;this.applyValueFieldSettingsToPivotTable(588680636);break;case -910892852:this.rA.PivotValueFieldSummarizeValueByApplyData.Aggregation=
8;this.applyValueFieldSettingsToPivotTable(-910892852);break;case -1255320719:this.rA.PivotValueFieldSummarizeValueByApplyData.Aggregation=0;this.applyValueFieldSettingsToPivotTable(-1255320719,!0);break;case 1668427539:this.rA.PivotValueFieldSummarizeValueByApplyData.Aggregation=9;this.applyValueFieldSettingsToPivotTable(1668427539);break;case -1751371357:this.rA.PivotValueFieldSummarizeValueByApplyData.Aggregation=10;this.applyValueFieldSettingsToPivotTable(-1751371357);break;case -841863025:this.hTa(0,
0);this.applyValueFieldSettingsToPivotTable(-841863025);break;case -178796371:this.hTa(7,0);this.applyValueFieldSettingsToPivotTable(-178796371);break;case 786592977:this.hTa(6,0);this.applyValueFieldSettingsToPivotTable(786592977);break;case 767774849:this.hTa(5,0);this.applyValueFieldSettingsToPivotTable(767774849);break;case 282586693:this.hTa(9,0);this.applyValueFieldSettingsToPivotTable(282586693);break;case -1067664355:this.hTa(10,0);this.applyValueFieldSettingsToPivotTable(-1067664355);break;
case -2031744961:N=Number.parseInvariant(N.MenuItemId.split(".")[2]);this.hTa(11,N);this.applyValueFieldSettingsToPivotTable(-2031744961);break;case -1007663920:this.applyPivotSort(1);break;case 234234584:this.applyPivotSort(2);break;case 1194992911:this.$.ae(-1556797033,tf.a.$b,8,null);break;case 1514686611:this.qwi();break;case 1217404289:case -743135194:case 771421327:case 1015867427:case 1105960559:N=Number.parseInvariant(N.MenuItemId);this.F1g(N);break;case 1778578888:N=Number.parseInvariant(N.MenuItemId);
this.xOg(N);break;default:f=be.a(D)}return f||ud.TaskExtensions.s5()};Wf.prototype.Mc=function(f,D){f=!1;switch(D.command){case 671488277:f=cf.f(this.grid);break;case 1801458190:case -2016405815:case 671485366:case 772221736:f=!0;break;case 1600778266:f=!0;break;case -556893687:f=!0;break;case -1966978671:f=!0;break;case -1951357930:f=!0;break;case -1390365353:case -1457478532:f=!0;break;case -249874296:case -771066011:case 1746132849:case 1475494885:case 376946683:case 835007294:case 929115636:case 1935475057:case 588680636:case -910892852:case -1255320719:case 1668427539:case -1751371357:f=
!0;break;case -1128612833:case -841863025:case -178796371:case 767774849:case 786592977:case 282586693:case -1067664355:case -2031744961:f=!0;break;case -1007663920:case 234234584:case 1194992911:f=!0;break;case 1514686611:case 1217404289:case -743135194:case 771421327:case 1015867427:case 1105960559:case 1778578888:f=!0}return f};Wf.prototype.uDj=function(){if(!this.$.isEditMode||this.Tc.ric)return!1;var f=this.d6f(!1);return ye.EwaSettings.isChangeGateEnabled("OfficeVSO:6214209_EnableFullRightClickMenuForExtNativePT")?
!this.Tc.isOlap||f:!this.Tc.Isd()||f};Wf.prototype.$c=function(f,D){var N=!1;switch(D){case -249874296:case -1128612833:case 1801458190:case -1951357930:case -1390365353:case -1457478532:case 1600778266:case -556893687:case -1966978671:case 1514686611:case 1778578888:N=this.lT();break;case -1007663920:case 234234584:N=this.WBj()||this.lT();break;case 1194992911:N=this.XBj()||this.lT();break;case 1217404289:N=!xe.j(this.Db.LabelOrDateFilterType)||this.lT();break;case -743135194:N=!xe.m(this.Db.ValueFilterType)&&
!xe.l(this.Db.ValueFilterType)||this.lT();break;case 771421327:N=0===this.Db.LabelOrDateFilterType&&0===this.Db.ValueFilterType&&!this.Db.HasManualFilter||this.lT();break;case 1015867427:N=!xe.i(this.Db.LabelOrDateFilterType)||this.lT();break;case 1105960559:N=!xe.k(this.Db.LabelOrDateFilterType)||this.lT()}return N||W.prototype.$c.call(this,f,D)};Wf.prototype.Zcb=function(){this.ubb=this.Db=this.gg=null};Wf.prototype.nXd=function(){this.grid.vQ(this.Xq);this.$.Ka.KGa(this.zu)};Wf.prototype.W_d=function(){this.grid.UL(this.Xq);
this.$.Ka.Fcb(this.zu)};Wf.prototype.BLb=function(){if(this.Tc&&this.Tc.ap){this.gg=this.Tc.ap;this.Db=this.Tc.Hcc();if(this.R6f()){var f=this.Tc.aM[4===this.gg.CellType?this.Tc.d8c-1:this.gg.CurrentFieldIndex-1];f&&(this.ubb=-2===f.Index?this.Tc.SJe:f.Caption)}this.Iei();this.Db&&8===this.gg.CellArea&&(this.rA.PivotValueFieldSummarizeValueByApplyData.Aggregation=this.Db.DataFieldAggregationType,this.rA.PivotValueFieldShowValueAsApplyData.SelectedDataFormat=this.Db.DataFieldFormatType,this.rA.PivotValueFieldShowValueAsApplyData.SelectedBaseField=
this.Db.BaseFieldIndex,this.rA.PivotValueFieldTitle=this.Db.Caption)}};Wf.prototype.d6f=function(f){if(!this.Tc)return!1;f=this.Tc.isOlap&&!this.Tc.M8a(!f);return ye.EwaSettings.ma(597)&&f};Wf.prototype.dCj=function(){var f=ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImplicitMeasureSupport",!1);return 1!==this.Db.MeasureType&&(!this.Tc.pkf||f&&2===this.Db.MeasureType)};Wf.prototype.QZ=function(){var f=this.Ta.iq(this.menuId),D=this.Ta.Oc();if(this.Tc)this.gg&&this.Tc.ap&&this.gg!==
this.Tc.ap&&ld.ULS.shipAssertTag(537167006,0,!1,"CurrentCellInfo is out of sync with cell info from PivotTable Range"),this.Db&&this.Db!==this.Tc.Hcc()&&ld.ULS.shipAssertTag(537167005,0,!1,"CurrentField is out of sync with field from PivotTable Range");else return f;this.vLh(f);if(this.$.isEditMode){this.refresh&&this.KMh(f);if(this.gg&&this.Db){var N=this.Ta.Oc();this.ZMh(N);this.KLh(N);Array.add(f.Dc,N)}this.g_&&Array.add(D.buttons,this.Ta.Cb(99));this.gg&&this.Db&&this.fMh(f);if(this.expandCollapse){N=
this.Ta.yw("ContextMenu.PivotExpandCollapse",null,oe.a.instance.fa(1120),589118293);var fa=this.Ta.Oc();Array.add(fa.buttons,this.Ta.Cb(243));Array.add(fa.buttons,this.Ta.Cb(244));Array.add(fa.buttons,this.Ta.Cb(245));Array.add(fa.buttons,this.Ta.Cb(246));Array.add(N.menu.Dc,fa);N&&0<fa.buttons.length&&Array.add(D.buttons,N)}this.gg&&this.LMh(f);this.gg&&this.Db&&8===this.gg.CellArea&&8!==this.gg.CellType&&(N=this.Ta.Oc(),this.dCj()&&this.aNh(N),3!==this.gg.CellType&&this.WMh(N),Array.add(f.Dc,N));
!this.Tc.isOlap&&this.gg&&0===this.gg.CellType&&ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableShowDetails",!1)&&this.VMh(f);this.Wpi()?Array.add(D.buttons,this.Ta.Cb(257)):Array.add(D.buttons,this.Ta.Cb(258));this.zrd?Array.add(D.buttons,this.Ta.Cb(59)):Array.add(D.buttons,this.Ta.Cb(58))}Array.add(f.Dc,D);return f};Wf.prototype.zUd=function(){return this.Db&&this.Db.Caption?20<this.Db.Caption.length:!1};Wf.prototype.uhd=function(f){return this.Db&&this.Db.Caption?f?this.Db.Caption.substring(0,
20)+"...":this.Db.Caption:""};Wf.prototype.zwa=function(f){return ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5548525_FixLoggingColumnNameInButtonId")?Ba.a.hashCode(f).toString():f};Wf.prototype.ZMh=function(f){if(this.gg&&this.Db&&4!==this.gg.CellArea){var D=this.bwa(this.PH("PivotTableContextMenu.Sort",this.zwa(this.Db.Caption)),-1777747317,0,0!==this.Db.SortInfo,oe.a.instance.fa(228)),N=this.Ta.Oc();Array.add(N.buttons,this.ie("PivotTableContextMenu.SortAscending",-1007663920,0,1===this.Db.SortInfo,
oe.a.instance.fa(229)));Array.add(N.buttons,this.ie("PivotTableContextMenu.SortDescending",234234584,0,2===this.Db.SortInfo,oe.a.instance.fa(230)));1!==this.gg.CellArea&&2!==this.gg.CellArea||Array.add(N.buttons,this.ie("PivotTableContextMenu.SortByValue",1194992911,0,3===this.Db.SortInfo||4===this.Db.SortInfo,oe.a.instance.fa(155)));Array.add(D.menu.Dc,N);D&&0<N.buttons.length&&Array.add(f.buttons,D)}};Wf.prototype.KLh=function(f){if(this.gg&&this.Db&&(1===this.gg.CellArea||2===this.gg.CellArea)){var D=
this.tDj(),N=this.bwa(this.PH("PivotTableContextMenu.Filter",this.zwa(this.Db.Caption)),-1777747317,0,D,oe.a.instance.fa(644)),fa=this.Ta.Oc(),Ia="",pb=this.zUd(),Wb=String.format(oe.a.instance.Bb(155),this.uhd(pb));pb&&(Ia=String.format(oe.a.instance.Bb(155),this.Db.Caption));D=this.zwa(this.Db.Caption)+"."+(D?"enabled":"disabled");Ia=this.ie(this.PH(pi,D),771421327,0,!1,Wb,"0",Ia,8,R.a.I3a);D=this.zwa(this.Db.Caption)+"."+this.Db.LabelOrDateFilterType.toString();this.Db.IsDateField?(Wb=this.bwa(this.PH("PivotTableContextMenu.DateFilter",
D),-1777747317,0,0!==this.Db.LabelOrDateFilterType,oe.a.instance.fa(96)),this.yLh(Wb.menu)):(Wb=this.bwa(this.PH("PivotTableContextMenu.LabelFilter",D),-1777747317,0,0!==this.Db.LabelOrDateFilterType,oe.a.instance.fa(642)),this.eMh(Wb.menu));D=this.zwa(this.Db.Caption)+"."+this.Db.ValueFilterType.toString();D=this.bwa(this.PH("PivotTableContextMenu.ValueFilter",D),-1777747317,0,0!==this.Db.ValueFilterType,oe.a.instance.fa(643));this.mNh(D.menu);pb=this.Ta.Oc();Array.add(pb.buttons,this.ie("PivotTableContextMenu.ManualFilter",
1514686611,0,this.Db.HasManualFilter,oe.a.instance.fa(93)));Array.add(fa.buttons,Ia);Array.add(fa.buttons,Wb);Array.add(fa.buttons,D);Array.add(N.menu.Dc,fa);Array.add(N.menu.Dc,pb);N&&0<fa.buttons.length&&Array.add(f.buttons,N)}};Wf.prototype.yLh=function(f){Array.add(f.Dc,this.cdc(!0,!1));Array.add(f.Dc,this.CSh());Array.add(f.Dc,this.BSh());Array.add(f.Dc,this.rUh());Array.add(f.Dc,this.uUh());Array.add(f.Dc,this.sUh());Array.add(f.Dc,this.tUh());Array.add(f.Dc,this.vUh());Array.add(f.Dc,this.wUh());
Array.add(f.Dc,this.pSh())};Wf.prototype.nLh=function(f){Array.add(f.Dc,this.cdc(!0,!0));Array.add(f.Dc,this.a0h());Array.add(f.Dc,this.tYh())};Wf.prototype.eMh=function(f){Array.add(f.Dc,this.cdc(!0,!1));Array.add(f.Dc,this.i2e(!0));Array.add(f.Dc,this.YOh());Array.add(f.Dc,this.yRh());Array.add(f.Dc,this.g1e(!0));Array.add(f.Dc,this.m0e(!0))};Wf.prototype.mNh=function(f){Array.add(f.Dc,this.cdc(!1,!1));Array.add(f.Dc,this.i2e(!1));Array.add(f.Dc,this.g1e(!1));Array.add(f.Dc,this.m0e(!1));Array.add(f.Dc,
this.p4h())};Wf.prototype.p4h=function(){var f=this.Ta.Oc();Array.add(f.buttons,this.ie("PivotTableContextMenu.Top10",-1611233597,0,xe.l(this.Db.ValueFilterType),oe.a.instance.fa(104)));return f};Wf.prototype.yRh=function(){var f=this.Ta.Oc();this.Db&&(Array.add(f.buttons,this.ie("PivotTableContextMenu.Contains",786260386,0,10===this.Db.LabelOrDateFilterType,oe.a.instance.fa(645),"10")),Array.add(f.buttons,this.ie("PivotTableContextMenu.DoesNotContain",786260386,0,11===this.Db.LabelOrDateFilterType,
oe.a.instance.fa(646),"11")));return f};Wf.prototype.YOh=function(){var f=this.Ta.Oc();this.Db&&(Array.add(f.buttons,this.ie("PivotTableContextMenu.BeginsWith",786260386,0,6===this.Db.LabelOrDateFilterType,oe.a.instance.fa(647),"6")),Array.add(f.buttons,this.ie("PivotTableContextMenu.DoesNotBeginWith",786260386,0,7===this.Db.LabelOrDateFilterType,oe.a.instance.fa(648),"7")),Array.add(f.buttons,this.ie("PivotTableContextMenu.EndsWith",786260386,0,8===this.Db.LabelOrDateFilterType,oe.a.instance.fa(649),
"8")),Array.add(f.buttons,this.ie("PivotTableContextMenu.DoesNotEndWith",786260386,0,9===this.Db.LabelOrDateFilterType,oe.a.instance.fa(650),"9")));return f};Wf.prototype.i2e=function(f){var D=this.Ta.Oc();if(this.Db){var N=f?xe.c:xe.f;Array.add(D.buttons,this.ie(this.PH("PivotTableContextMenu.Equals",N),786260386,0,f?4===this.Db.LabelOrDateFilterType:18===this.Db.ValueFilterType,oe.a.instance.fa(99),f?"4":"18"));Array.add(D.buttons,this.ie(this.PH("PivotTableContextMenu.DoesNotEqual",N),786260386,
0,f?5===this.Db.LabelOrDateFilterType:19===this.Db.ValueFilterType,oe.a.instance.fa(100),f?"5":"19"))}return D};Wf.prototype.g1e=function(f){var D=this.Ta.Oc();if(this.Db){var N=f?xe.c:xe.f;Array.add(D.buttons,this.ie(this.PH("PivotTableContextMenu.GreaterThan",N),786260386,0,f?12===this.Db.LabelOrDateFilterType:20===this.Db.ValueFilterType,oe.a.instance.fa(101),f?"12":"20"));Array.add(D.buttons,this.ie(this.PH("PivotTableContextMenu.GreaterThanOrEqualTo",N),786260386,0,f?13===this.Db.LabelOrDateFilterType:
21===this.Db.ValueFilterType,oe.a.instance.fa(651),f?"13":"21"));Array.add(D.buttons,this.ie(this.PH("PivotTableContextMenu.LessThan",N),786260386,0,f?14===this.Db.LabelOrDateFilterType:22===this.Db.ValueFilterType,oe.a.instance.fa(102),f?"14":"22"));Array.add(D.buttons,this.ie(this.PH("PivotTableContextMenu.LessThanOrEqualTo",N),786260386,0,f?15===this.Db.LabelOrDateFilterType:23===this.Db.ValueFilterType,oe.a.instance.fa(652),f?"15":"23"))}return D};Wf.prototype.m0e=function(f){var D=this.Ta.Oc();
if(this.Db){var N=f?xe.c:xe.f;Array.add(D.buttons,this.ie(this.PH("PivotTableContextMenu.Between",N),786260386,0,f?16===this.Db.LabelOrDateFilterType:24===this.Db.ValueFilterType,oe.a.instance.fa(103),f?"16":"24"));Array.add(D.buttons,this.ie(this.PH("PivotTableContextMenu.NotBetween",N),786260386,0,f?17===this.Db.LabelOrDateFilterType:25===this.Db.ValueFilterType,oe.a.instance.fa(653),f?"17":"25"))}return D};Wf.prototype.cdc=function(f,D){var N=this.Ta.Oc();if(this.Db){var fa=oe.a.instance.fa(97),
Ia=f?this.Db.LabelOrDateFilterType.toString():this.Db.ValueFilterType.toString(),pb=["PivotTableContextMenu.ClearFilter",this.zwa(this.Db.Caption),Ia];f=f?this.Db.IsDateField?D?1015867427:1105960559:1217404289:-743135194;pb.push(f.toString());pb=pb.join(".");fa=this.ie(pb,f,0,!1,fa,Ia,fa,8,R.a.I3a);Array.add(N.buttons,fa)}return N};Wf.prototype.CSh=function(){var f=this.Ta.Oc();this.Db&&Array.add(f.buttons,this.ie(this.PH("PivotTableContextMenu.Equals",xe.d),786260386,0,26===this.Db.LabelOrDateFilterType,
oe.a.instance.fa(99),"26"));return f};Wf.prototype.BSh=function(){var f=this.Ta.Oc();this.Db&&(Array.add(f.buttons,this.ie("PivotTableContextMenu.Before",786260386,0,27===this.Db.LabelOrDateFilterType,oe.a.instance.fa(111),"27")),Array.add(f.buttons,this.ie("PivotTableContextMenu.After",786260386,0,28===this.Db.LabelOrDateFilterType,oe.a.instance.fa(112),"28")),Array.add(f.buttons,this.ie("PivotTableContextMenu.Between",786260386,0,29===this.Db.LabelOrDateFilterType,oe.a.instance.fa(103),"29")));
return f};Wf.prototype.rUh=function(){var f=this.Ta.Oc();this.Db&&(Array.add(f.buttons,this.ie("PivotTableContextMenu.Tomorrow",1778578888,0,30===this.Db.LabelOrDateFilterType,oe.a.instance.fa(109),"30")),Array.add(f.buttons,this.ie("PivotTableContextMenu.Today",1778578888,0,31===this.Db.LabelOrDateFilterType,oe.a.instance.fa(108),"31")),Array.add(f.buttons,this.ie("PivotTableContextMenu.Yesterday",1778578888,0,32===this.Db.LabelOrDateFilterType,oe.a.instance.fa(110),"32")));return f};Wf.prototype.uUh=
function(){var f=this.Ta.Oc();this.Db&&(Array.add(f.buttons,this.ie("PivotTableContextMenu.NextWeek",1778578888,0,33===this.Db.LabelOrDateFilterType,oe.a.instance.fa(114),"33")),Array.add(f.buttons,this.ie("PivotTableContextMenu.ThisWeek",1778578888,0,34===this.Db.LabelOrDateFilterType,oe.a.instance.fa(113),"34")),Array.add(f.buttons,this.ie("PivotTableContextMenu.LastWeek",1778578888,0,35===this.Db.LabelOrDateFilterType,oe.a.instance.fa(115),"35")));return f};Wf.prototype.sUh=function(){var f=this.Ta.Oc();
this.Db&&(Array.add(f.buttons,this.ie("PivotTableContextMenu.NextMonth",1778578888,0,36===this.Db.LabelOrDateFilterType,oe.a.instance.fa(116),"36")),Array.add(f.buttons,this.ie("PivotTableContextMenu.ThisMonth",1778578888,0,37===this.Db.LabelOrDateFilterType,oe.a.instance.fa(117),"37")),Array.add(f.buttons,this.ie("PivotTableContextMenu.LastMonth",1778578888,0,38===this.Db.LabelOrDateFilterType,oe.a.instance.fa(118),"38")));return f};Wf.prototype.tUh=function(){var f=this.Ta.Oc();this.Db&&(Array.add(f.buttons,
this.ie("PivotTableContextMenu.NextQuarter",1778578888,0,39===this.Db.LabelOrDateFilterType,oe.a.instance.fa(119),"39")),Array.add(f.buttons,this.ie("PivotTableContextMenu.ThisQuarter",1778578888,0,40===this.Db.LabelOrDateFilterType,oe.a.instance.fa(120),"40")),Array.add(f.buttons,this.ie("PivotTableContextMenu.LastQuarter",1778578888,0,41===this.Db.LabelOrDateFilterType,oe.a.instance.fa(121),"41")));return f};Wf.prototype.vUh=function(){var f=this.Ta.Oc();this.Db&&(Array.add(f.buttons,this.ie("PivotTableContextMenu.NextYear",
1778578888,0,42===this.Db.LabelOrDateFilterType,oe.a.instance.fa(122),"42")),Array.add(f.buttons,this.ie("PivotTableContextMenu.ThisYear",1778578888,0,43===this.Db.LabelOrDateFilterType,oe.a.instance.fa(123),"43")),Array.add(f.buttons,this.ie("PivotTableContextMenu.LastYear",1778578888,0,44===this.Db.LabelOrDateFilterType,oe.a.instance.fa(124),"44")));return f};Wf.prototype.wUh=function(){var f=this.Ta.Oc();if(this.Db){Array.add(f.buttons,this.ie("PivotTableContextMenu.YearToDate",1778578888,0,45===
this.Db.LabelOrDateFilterType,oe.a.instance.fa(125),"45"));var D=this.bwa("PivotTableContextMenu.AllDatesInThePeriod",1778578888,0,xe.i(this.Db.LabelOrDateFilterType),oe.a.instance.fa(126));this.nLh(D.menu);Array.add(f.buttons,D)}return f};Wf.prototype.pSh=function(){var f=this.Ta.Oc();this.Db&&Array.add(f.buttons,this.ie("PivotTableContextMenu.CustomFilter",786260386,0,this.qDj(this.Db.LabelOrDateFilterType),oe.a.instance.fa(107),"26"));return f};Wf.prototype.a0h=function(){var f=this.Ta.Oc();this.Db&&
(Array.add(f.buttons,this.ie("PivotTableContextMenu.Quarter1",1778578888,0,46===this.Db.LabelOrDateFilterType,oe.a.instance.fa(127),"46")),Array.add(f.buttons,this.ie("PivotTableContextMenu.Quarter2",1778578888,0,47===this.Db.LabelOrDateFilterType,oe.a.instance.fa(128),"47")),Array.add(f.buttons,this.ie("PivotTableContextMenu.Quarter3",1778578888,0,48===this.Db.LabelOrDateFilterType,oe.a.instance.fa(129),"48")),Array.add(f.buttons,this.ie("PivotTableContextMenu.Quarter4",1778578888,0,49===this.Db.LabelOrDateFilterType,
oe.a.instance.fa(130),"49")));return f};Wf.prototype.tYh=function(){var f=this.Ta.Oc();this.Db&&(Array.add(f.buttons,this.ie("PivotTableContextMenu.January",1778578888,0,50===this.Db.LabelOrDateFilterType,oe.a.instance.fa(131),"50")),Array.add(f.buttons,this.ie("PivotTableContextMenu.February",1778578888,0,51===this.Db.LabelOrDateFilterType,oe.a.instance.fa(132),"51")),Array.add(f.buttons,this.ie("PivotTableContextMenu.March",1778578888,0,52===this.Db.LabelOrDateFilterType,oe.a.instance.fa(133),"52")),
Array.add(f.buttons,this.ie("PivotTableContextMenu.April",1778578888,0,53===this.Db.LabelOrDateFilterType,oe.a.instance.fa(134),"53")),Array.add(f.buttons,this.ie("PivotTableContextMenu.May",1778578888,0,54===this.Db.LabelOrDateFilterType,oe.a.instance.fa(135),"54")),Array.add(f.buttons,this.ie("PivotTableContextMenu.June",1778578888,0,55===this.Db.LabelOrDateFilterType,oe.a.instance.fa(136),"55")),Array.add(f.buttons,this.ie("PivotTableContextMenu.July",1778578888,0,56===this.Db.LabelOrDateFilterType,
oe.a.instance.fa(137),"56")),Array.add(f.buttons,this.ie("PivotTableContextMenu.August",1778578888,0,57===this.Db.LabelOrDateFilterType,oe.a.instance.fa(138),"57")),Array.add(f.buttons,this.ie("PivotTableContextMenu.September",1778578888,0,58===this.Db.LabelOrDateFilterType,oe.a.instance.fa(139),"58")),Array.add(f.buttons,this.ie("PivotTableContextMenu.October",1778578888,0,59===this.Db.LabelOrDateFilterType,oe.a.instance.fa(140),"59")),Array.add(f.buttons,this.ie("PivotTableContextMenu.November",
1778578888,0,60===this.Db.LabelOrDateFilterType,oe.a.instance.fa(141),"60")),Array.add(f.buttons,this.ie("PivotTableContextMenu.December",1778578888,0,61===this.Db.LabelOrDateFilterType,oe.a.instance.fa(142),"61")));return f};Wf.prototype.fMh=function(f){var D=this.Ta.Oc();if(this.R6f()){var N=this.Tc.aM[4===this.gg.CellType?this.Tc.d8c-1:this.gg.CurrentFieldIndex-1];if(N&&this.ubb){var fa=this.Ta.yw("ContextMenu.PivotTableLayout",null,oe.a.instance.fa(640),-1777747317);var Ia=this.Ta.Oc(),pb=String.format(oe.a.instance.Bb(160),
this.ubb),Wb=String.format(oe.a.instance.Bb(161),this.ubb);Array.add(Ia.buttons,this.ie(qi,-1457478532,0,!N.IsCompactLayout,pb));Array.add(Ia.buttons,this.ie(Ld,-1390365353,0,N.IsCompactLayout,Wb));Array.add(fa.menu.Dc,Ia);fa&&Array.add(D.buttons,fa)}}if(1===this.gg.CellArea||2===this.gg.CellArea)this.Db.Caption&&(N="",Ia=this.zUd(),fa=String.format(oe.a.instance.Bb(158),this.uhd(Ia)),Ia&&(N=String.format(oe.a.instance.Bb(158),this.Db.Caption)),1===this.gg.CellArea?(N=this.bwa("ContextMenu.PivotTableSubtotal",
1801458190,0,this.Db.ShowSubtotal,fa),fa=this.Ta.Oc(),Array.add(fa.buttons,this.Ta.Cb(259)),Array.add(fa.buttons,this.ie("ContextMenu.PivotTableSubtotalOnTop",671485366,632,this.Db.ShowSubtotal&&this.Db.ShowSubtotalAtTop)),Array.add(fa.buttons,this.ie("ContextMenu.PivotTableSubtotalOnBottom",772221736,633,this.Db.ShowSubtotal&&!this.Db.ShowSubtotalAtTop)),Array.add(N.menu.Dc,fa),N&&0<fa.buttons.length&&Array.add(D.buttons,N)):(Ia=Ia?this.PH(qg,this.zwa(fa)):qg,Array.add(D.buttons,this.ie(Ia,1801458190,
0,this.Db.ShowSubtotal,fa,null,N)))),Array.add(D.buttons,this.ie("ContextMenu.RepeatItemLabels",-556893687,635,this.Db.RepeatItemLabels));1===this.gg.CellArea&&Array.add(D.buttons,this.ie("ContextMenu.PivotBlankLineAfterEachItem",1600778266,634,this.Db.ShowBlankLineAfterEachItem));Array.add(f.Dc,D)};Wf.prototype.VMh=function(f){var D=this.Ta.Oc();Array.add(D.buttons,this.Ta.Cb(247));Array.add(f.Dc,D)};Wf.prototype.LMh=function(f){var D="",N="",fa=!1;3===this.gg.CellType?D=oe.a.instance.fa(637):8===
this.gg.CellType?this.Tc&&(D=String.format(oe.a.instance.Bb(159),this.Tc.SJe)):this.Db&&((fa=this.zUd())&&(N=String.format(oe.a.instance.Bb(159),this.Db.Caption)),D=String.format(oe.a.instance.Bb(159),this.uhd(fa)));if(D){var Ia=this.Ta.Oc();fa=fa?this.PH(Ig,this.zwa(D)):Ig;D=this.ie(fa,-1951357930,0,!1,D,null,N,8,R.a.Mbd);Array.add(Ia.buttons,D);Array.add(f.Dc,Ia)}};Wf.prototype.vLh=function(f){var D=this.Ta.Oc();ye.EwaSettings.ma(474)&&Array.add(D.buttons,this.Ta.Cb(43));this.Db&&this.gg&&this.$.isEditMode&&
(0===this.gg.CellType||4===this.gg.CellType)&&Array.add(D.buttons,this.Ta.Cb(136));Array.add(f.Dc,D)};Wf.prototype.KMh=function(f){var D=this.Ta.Oc();Array.add(D.buttons,this.Ta.Cb(100));Array.add(f.Dc,D)};Wf.prototype.aNh=function(f){var D=2===this.Db.MeasureType&&!this.Db.IsNumeric,N=this.Ta.yw("ContextMenu.SummarizeValuesBy",null,oe.a.instance.fa(638),-249874296),fa=this.Ta.Oc();Array.add(fa.buttons,this.ie("ContextMenu.SummarizeValuesBySum",-1255320719,1059,0===this.Db.DataFieldAggregationType,
void 0,void 0,void 0,void 0,void 0,D));Array.add(fa.buttons,this.ie("ContextMenu.SummarizeValuesByCount",1746132849,1060,1===this.Db.DataFieldAggregationType));Array.add(fa.buttons,this.ie("ContextMenu.SummarizeValuesByAverage",-771066011,1061,2===this.Db.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,D));Array.add(fa.buttons,this.ie("ContextMenu.SummarizeValuesByMax",835007294,1062,3===this.Db.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,D));Array.add(fa.buttons,this.ie("ContextMenu.SummarizeValuesByMin",
929115636,1063,4===this.Db.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,D));Array.add(fa.buttons,this.ie("ContextMenu.SummarizeValuesByProduct",1935475057,1064,5===this.Db.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,this.d6f(!0)||D));2!==this.Db.MeasureType&&(Array.add(fa.buttons,this.ie("ContextMenu.SummarizeValuesByCountNumbers",1475494885,1065,6===this.Db.DataFieldAggregationType)),Array.add(fa.buttons,this.ie("ContextMenu.SummarizeValuesByStdDeviation",588680636,
1066,7===this.Db.DataFieldAggregationType)),Array.add(fa.buttons,this.ie("ContextMenu.SummarizeValuesByStdDeviationPercent",-910892852,1067,8===this.Db.DataFieldAggregationType)),Array.add(fa.buttons,this.ie("ContextMenu.SummarizeValuesByVariant",1668427539,1068,9===this.Db.DataFieldAggregationType)),Array.add(fa.buttons,this.ie("ContextMenu.SummarizeValuesByVariantPercent",-1751371357,1069,10===this.Db.DataFieldAggregationType)));this.Tc&&this.Tc.Isd()&&Array.add(fa.buttons,this.ie("ContextMenu.SummarizeValuesByDistinctCountPPM",
376946683,1070,11===this.Db.DataFieldAggregationType));Array.add(N.menu.Dc,fa);Array.add(f.buttons,N)};Wf.prototype.WMh=function(f){var D=this.Ta.yw("ContextMenu.ShowValuesAs",null,oe.a.instance.fa(639),-1128612833),N=this.Ta.Oc();Array.add(N.buttons,this.ie("ContextMenu.ShowValuesAsNoCalculation",-841863025,1076,0===this.Db.DataFieldFormatType));Array.add(N.buttons,this.ie("ContextMenu.ShowValuesAsPercentOfGrandTotal",-178796371,1083,7===this.Db.DataFieldFormatType));Array.add(N.buttons,this.ie("ContextMenu.ShowValuesAsPercentOfColumnTotal",
786592977,1082,6===this.Db.DataFieldFormatType));Array.add(N.buttons,this.ie("ContextMenu.ShowValuesAsPercentOfRowTotal",767774849,1081,5===this.Db.DataFieldFormatType));Array.add(N.buttons,this.ie("ContextMenu.ShowValuesAsPercentOfParentRowTotal",282586693,1086,9===this.Db.DataFieldFormatType));Array.add(N.buttons,this.ie("ContextMenu.ShowValuesAsParentColumnTotal",-1067664355,1087,10===this.Db.DataFieldFormatType));if(this.Tc&&this.Tc.aM&&0<this.Tc.aM.length||this.Tc.qaa&&0<this.Tc.qaa.length){for(var fa=
this.bwa("ContextMenu.ShowValuesAsPercentOfParentTotal",-1128612833,1088,11===this.Db.DataFieldFormatType),Ia=this.Ta.Oc(),pb=this.$Mh(),Wb=0;Wb<pb.length;Wb++){var Nc=pb[Wb];Array.add(Ia.buttons,this.ie("ContextMenu.ShowValuesAsPercentOfParentTotal."+Nc.Caption,-2031744961,1088,11===this.Db.DataFieldFormatType&&this.Db.BaseFieldIndex===Nc.Index,Nc.Caption,"ContextMenu.ShowValuesAsPercentOfParentTotal."+Nc.Index))}Array.add(fa.menu.Dc,Ia);Array.add(N.buttons,fa)}Array.add(D.menu.Dc,N);Array.add(f.buttons,
D)};Wf.prototype.showPivotTableContextMenu=function(){this.zrd=!0;this.expandCollapse=this.g_=this.refresh=!1;var f=this.$,D=We.g(f),N=ve.a(f).CLa();if(N){var fa=Rd.a(f);if(null===fa||void 0===fa?0:fa.RTd)this.zrd=wd.f(f.qg);fa=f.pc;this.g_=N.supportsBIExplore&&!!Oc.a(f)&&fa.B3(32768);fa.allowInteractivity&&(f=D.rc(null),(null===f||void 0===f?0:f.cell)&&(f.cell.s1c||f.cell.O6f)&&(this.expandCollapse=!0),fa.allowManualDataRefresh&&(this.refresh=!0))}f=null;N=1;this.S1a&&1!==this.S1a.zb?(f=new Sys.UI.Point(this.S1a.clientPoint.x,
this.S1a.clientPoint.y),N=this.S1a.zb):(D=cf.e(D,this.$))&&(f=new Sys.UI.Point(D.x+(this.$.isChromeRtl?0:D.width),D.y+D.height));tf.a.$b=N;this.skc=3===N;this.Qp(f,!0,N);this.nca=!0;this.nXd()};Wf.prototype.Zai=function(){var f=new bg.a(1114549926,0,this.$.jd,19,null);this.$.Ka.dc(f)};Wf.prototype.e_h=function(){var f=this;if(this.Tc&&this.Tc.ap){var D=this.Tc.ap.CurrentCol;if(this.Tc.ap.CurrentRow===this.activeCell.FirstRow&&D===this.activeCell.FirstColumn){this.BLb();this.showPivotTableContextMenu();
return}}D=new Mf.a(228,0,function(N,fa,Ia){return Se.C(f.$.na.ta,f.activeCell,Pg.b(N,f.oRi),Pg.a(fa,f.nRi),Ia,null)},16);this.$.userOperationManager.jc(D,null)};Wf.prototype.Wpi=function(){if(cg.a.Md(this.$)){var f=this.$.da.Aa(441);if(f)return f.As}else if(f=this.$.da.Aa(346))return f.As;return!1};Wf.prototype.PH=function(f,D){return f+"."+D};Wf.prototype.performPivotTableOperation=function(f,D){var N=this,fa=ff.a.Ra.Ob;if(!this.Tc||!this.Db&&this.gg&&3!==this.gg.CellType)this.zi();else{var Ia=this.Tc.isOlap;
ve.a(this.$).Wx(Ia,function(pb){pb&&N.$.jc(f,function(Wb,Nc,kd){if(ye.EwaSettings.ma(514)){var Xc=N.pFc,Ie=N.activeCell,Ze=N.Db?N.Db.Caption:null,Sf=N.ubb;Wb=Pg.b(Wb,N.cVi);Nc=Pg.a(Nc,N.bVi);var ag=N.$.na.ta.fc();ag=Xc.Ma(41,void 0===ag?null:ag);ag.activeCell=Ie;ag.operationType=D;ag.fieldCaption=Ze;ag.prevFieldCaption=Sf;kd=Se.i(Xc,"ExecutePivotTableOperation",ag,Wb,Nc,kd,null,0)}else Xc=N.pFc,Ie=N.activeCell,Ze=N.$.na.ta.fc(),Ze=Xc.Ma(41,void 0===Ze?null:Ze),Ze.activeCell=Ie,Ze.operationType=D,
kd=Se.i(Xc,"PerformPivotTableOperation",Ze,Wb,Nc,kd,null,0);return kd},fa,0,4,229)})}};Wf.prototype.applyValueFieldSettingsToPivotTable=function(f,D){var N=this;D=void 0===D?!1:D;var fa=ff.a.Ra.Ob;this.Tc&&this.Db?(D&&2===this.Db.MeasureType&&ld.ULS.sendTraceTag(537167002,0,50,"change aggregation type for an implicit measure from right click context menu."),D=this.Tc.isOlap,ve.a(this.$).Wx(D,function(Ia){Ia&&N.$.jc(f,function(pb,Wb,Nc){var kd=N.pFc,Xc=N.activeCell,Ie=N.rA;pb=Pg.b(pb,N.TLi);Wb=Pg.a(Wb,
N.SLi);var Ze=N.$.na.ta.fc();Ze=kd.Ma(41,void 0===Ze?null:Ze);Ze.activeCell=Xc;Ze.pivotValueFieldSettingsApplyData=Ie;return Se.i(kd,"ApplyValueFieldSettingsToPivotTable",Ze,pb,Wb,Nc,null,0)},fa,0,4,231)})):this.zi()};Wf.prototype.ie=function(f,D,N,fa,Ia,pb,Wb,Nc,kd,Xc){Ia=void 0===Ia?null:Ia;pb=void 0===pb?null:pb;Wb=void 0===Wb?null:Wb;Nc=void 0===Nc?8:Nc;kd=void 0===kd?null:kd;Xc=void 0===Xc?!1:Xc;fa&&(f+=".Checked");Xc&&(f+=".Disabled");this.Ta.oqd(f)&&this.Ta.FLd(f);N=Ia||oe.a.instance.fa(N);
f=this.Ta.GIa(f,N,D,null,"None",pb,Xc,null);f.eyc(null);Wb&&f.hT(Wb);fa?f.jT("Image16by16",3,R.a.$aa):kd?f.jT("Image16by16",Nc,kd):f.g4b();return f};Wf.prototype.bwa=function(f,D,N,fa,Ia){N=(void 0===Ia?null:Ia)||oe.a.instance.fa(N);this.Ta.oqd(f)?this.Ta.FLd(f):this.Ta.FLd(f+".Checked");fa&&(f+=".Checked");this.GBj&&(N=this.Tlh.parseFromString(N,"text/html").body.innerText);f=this.Ta.i6c(f,null,N,D,3,R.a.$aa);f.Xcf=fa;!fa&&ye.EwaSettings.isChangeGateEnabled("OfficeVSO:4877664_HidePivotTableContextMenuFlyoutCheckmark")&&
f.g4b();return f};Wf.prototype.Iei=function(){this.rA=Object.assign(new Md,{PivotValueFieldSummarizeValueByApplyData:Object.assign(new Ef,{Aggregation:-1}),PivotValueFieldShowValueAsApplyData:Object.assign(new Na,{SelectedDataFormat:-1,SelectedBaseField:-1,SelectedBaseItem:-1}),PivotValueFieldTitle:null})};Wf.prototype.hTa=function(f,D){this.rA.PivotValueFieldShowValueAsApplyData.SelectedDataFormat=f;this.rA.PivotValueFieldShowValueAsApplyData.SelectedBaseField=D;this.rA.PivotValueFieldShowValueAsApplyData.SelectedBaseItem=
-1};Wf.prototype.$Mh=function(){var f=[];if(this.Tc&&this.Tc.qaa&&0<this.Tc.qaa.length)for(var D=Cl(this.Tc.qaa),N=D.next();!N.done;N=D.next())(N=N.value)&&Array.add(f,N);if(this.Tc&&this.Tc.aM&&0<this.Tc.aM.length)for(D=Cl(this.Tc.aM),N=D.next();!N.done;N=D.next())(N=N.value)&&Array.add(f,N);f.sort(function(fa,Ia){return fa.Index-Ia.Index});return f};Wf.prototype.R6f=function(){if(!this.gg||!this.Tc||!this.Tc.aM)return!1;var f=1===this.gg.CellArea||4===this.gg.CellType&&this.gg.IsRowAxis,D=4===this.gg.CellType?
0<this.Tc.d8c:0<this.gg.CurrentFieldIndex;return 1<this.Tc.aM.length&&f&&D};Wf.prototype.mLa=function(f){var D=[];3===f?this.$.isEditMode?Array.addRange(D,[V.a.eLf,V.a.gLf,V.a.R2i]):Array.addRange(D,[V.a.copy]):2===f&&Array.add(D,V.a.aBe);return D};Wf.prototype.zi=function(){var f=Cf.a.ed(1,0,0,641,0,104573951,"PivotTableContextMenuOperationFailure");Og.a(this.$).zi(f)};Wf.prototype.tDj=function(){return this.Db?0!==this.Db.LabelOrDateFilterType||0!==this.Db.ValueFilterType||this.Db.HasManualFilter:
!1};Wf.prototype.qDj=function(f){return 62<=f&&65>=f};Wf.prototype.qwi=function(){if(this.activeCell&&this.Db&&this.Tc){var f={};f.cell=this.activeCell;f.dataSourceIndex=this.Tc.externalSourceIndex;f.fieldId=this.Db.Index.toString();f.isOlap=this.Tc.isOlap;f.confirmationRequired=this.Tc.confirmationRequiredForDataOps;this.$.ae(492140419,tf.a.$b,19,{showPivotFilterDialogCommandData:f})}};Wf.prototype.F1g=function(f){var D=this;this.activeCell&&this.Db&&this.Tc&&this.$.userOperationManager.jc(new Mf.a(153,
0,function(N,fa,Ia){return Se.X(D.$.na.ta,D.activeCell,D.Tc.externalSourceIndex,D.Db.Index.toString(),f,N,fa,Ia,null,null)}),null)};Wf.prototype.xOg=function(f){var D=this;!(30>f||61<f)&&this.activeCell&&this.Db&&this.Tc&&this.$.userOperationManager.jc(new Mf.a(152,0,function(N,fa,Ia){return Se.g(D.$.na.ta,D.activeCell,D.Tc.externalSourceIndex,D.Db.Index.toString(),f,N,fa,Ia,null,null)}),null)};Wf.prototype.applyPivotSort=function(f){var D=this;if(this.Tc&&this.Db&&this.activeCell&&this.gg){var N=
1===this.gg.CellArea||2===this.gg.CellArea;8===this.gg.CellArea?Sd.a(this.$.userOperationManager,function(fa,Ia,pb){return Se.e(D.$.na.ta,D.activeCell,f,D.Db.Caption,fa,Ia,pb,null)},function(fa){return new Mf.a(1015,0,fa,void 0,null)},null):N&&(N=1===this.gg.CellArea?1:2,this.$.ma(716)?pf.a.naps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.Tc.externalSourceIndex,this.Db.Index.toString(),this.Db.Caption,this.Tc.isOlap?"":this.Db.Caption,N,1===f):pf.a.aps(this.$.domElement,
this.activeCell.FirstRow,this.activeCell.FirstColumn,this.Tc.externalSourceIndex,this.Db.Index.toString(),1===f))}};Wf.prototype.lT=function(){return!this.Tc||!this.Tc.isActionable&&ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReadOnlyPivotTable",!1)};Wf.prototype.WBj=function(){return(this.gg||this.Tc)&&4!==this.gg.CellType&&(0!==this.gg.CellType||8!==this.gg.CellArea||this.Tc.qaa&&this.Tc.qaa.length||this.Tc.aM&&this.Tc.aM.length)?!1:!0};Wf.prototype.XBj=function(){return this.gg&&
this.Tc&&(1===this.gg.CellArea||2===this.gg.CellArea)&&this.Tc.mQb&&this.Tc.mQb.length?!1:!0};uk.Object.defineProperties(Wf.prototype,{It:{configurable:!0,enumerable:!0,get:function(){return"PopulatePivotTableContextMenu"}},TB:{configurable:!0,enumerable:!0,get:function(){return Bf.a.cQf}}});Object(Jb.a)(Wf,"PivotTableContextMenu",Qg.a,[]);Uf.prototype.compare=function(f,D){return(f||"").localeCompare(D||"",void 0,{numeric:!0,sensitivity:"accent"})};Object(Jb.a)(Uf,"DigitsAsNumberComparer",null,[883]);
var ta=b(270),ob=Bf.a.C6g,Kb=Qg.a;Am(wf,Kb);wf.prototype.executeCommand=function(f,D,N){f=D.command;switch(f){case 639960842:this.applyTableFieldList(N);this.TO.lea();break;case -1085236154:N=String.format("TableFieldListContextMenu:TableFieldListContextMenuClose, ColWithEntities, {0}",this.MBd);ld.ULS.sendTraceTag(537166999,0,50,N);this.TO.lea();break;case 1833782813:this.TO.showCallout();break;default:return be.a(f)}return rg.Task.Sa(!0)};wf.prototype.applyTableFieldList=function(f){var D=f.MenuItemId.toString();
ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5239502_UpdatePulloutFieldNameContainingSplChars")&&(D=D.replace("'","''"),D=D.replace("[","'["),D=D.replace("]","']"));var N=Object(k.a)(String,f.SourceControlId),fa={};fa.PulloutField=D;fa.PulloutCardPath=f.SourceCardKeyPath;fa.PulloutCardSourceRow=f.SourceCardRow;fa.PulloutCardSourceColumn=f.SourceCardColumn;if(this.TO.eO){ld.ULS.sendTraceTag(38887748,0,50,"Table Pullout operation started");fa.ParameterType=2;f=f.ColumnIndex;if(void 0===f||null===f){if(void 0===
N||null===N){ld.ULS.shipAssertTag(537166998,0,!1,"TableFieldListContextMenu: ApplyTableFieldList, must specifiy ColumnIndex or SourceControlId");return}f=0<=this.TO.gOf?this.TO.gOf:parseInt(N.substring(20+D.length+1,N.length),10);if(isNaN(f)){D=String.format("TableFieldListContextMenu:ApplyTableFieldListMalformatHTMLAttribute, Attribute, {0}",N);ld.ULS.shipAssertTag(537166997,0,!1,D);return}}fa.PulloutRichColumnSourceIndex=f;if(this.UWb.$Lg){this.PMg(D,fa);return}}else ld.ULS.sendTraceTag(38887749,
0,50,"Grid Pullout operation started"),fa.ParameterType=4,N=this.TO.selectedRange.right,void 0!==fa.PulloutCardSourceColumn&&null!==fa.PulloutCardSourceColumn&&(N=fa.PulloutCardSourceColumn+1),fa.PulloutRichColumnSourceIndex=N;this.JRd(D,fa)};wf.prototype.JRd=function(f,D,N){N=void 0===N?0:N;var fa=String.format("TableFieldListContextMenu:ApplyTableFieldList, ColWithEntities, {0}, SelectedColumnIndex, {1}",this.MBd,D.PulloutRichColumnSourceIndex);ld.ULS.sendTraceTag(537166996,0,50,fa);String.format("TableFieldListContextMenu:ApplyTableFieldList, richValueParameterType, {0}, PulloutRichColumnSourceIndex, {1}",
D.ParameterType,D.PulloutRichColumnSourceIndex);f=Object.assign(new ta.a,{Text:f});this.grid.setCell(f,this.TO.rza,0,127,D,N);this.grid.focus();this.Z6b=null;this.TO.lea();this.TO.Olj()};wf.prototype.Mc=function(f,D,N){if(f=this.$.isEditMode&&ye.EwaSettings.ma(136)&&!!this.TO)switch(D.command){case -1085236154:break;case 639960842:f=!!N;break;case 1833782813:f=this.TO.Hxa&&this.TO.UCb;break;default:f=!1}return f};wf.prototype.w1=function(f,D,N){this.$.isEditMode&&(this.Z6b=this.oMh(Object(k.a)(842,
N)),Kb.prototype.w1.call(this,f,D,null,null,!1))};wf.prototype.QZ=function(){return this.Z6b};wf.prototype.g6c=function(f){if(!this.TO||!f||!f.Rk)return ld.ULS.shipAssertTag(537166994,0,!!this.TO,"TableFieldListContextMenu:CreateContextMenuItemList PulloutManager null"),ld.ULS.shipAssertTag(537166993,0,!!f,"TableFieldListContextMenu:CreateContextMenuItemList fieldInfoManager null"),f&&ld.ULS.shipAssertTag(537166992,0,!!f.Rk,"TableFieldListContextMenu:CreateContextMenuItemList fieldInfoManager.FieldInfoListContextList null"),
null;var D=new Ab.a;f=Cl(f.Rk);for(var N=f.next();!N.done;N=f.next()){var fa=N.value;N=new Ab.a;N.add(fa.ColumnName);N.add(fa.ColumnIndex.toString());var Ia=new Ab.a,pb=null;pb=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5860557_CompareDigitsAsNumberRichDataProperties")?new Uf:new ef;Ia=d.OBc(d.concat(Ia,d.select(d.asEnumerable(fa.FieldInfoDataList),function(Wb){return Wb.Name})),function(Wb){return Wb},pb);fa=new Ab.a;fa.add(d.toArray(d.concat(N,Ia)));D=d.toList(d.concat(D,fa))}return d.toArray(D)};
wf.prototype.oMh=function(f){var D=this.g6c(f);if(!D||!D.length)return this.Z6b=null;var N=this.Ta;f=N.Oc();var fa=1<D.length;this.MBd=D.length;D=Cl(D);for(var Ia=D.next();!Ia.done;Ia=D.next()){var pb=Ia.value;fa||(f.title=pb[0]);Ia=N.Oc();for(var Wb=2,Nc=pb.length;Wb<Nc;++Wb)Array.add(fa?Ia.buttons:f.buttons,N.GIa("ApplyTableFieldList."+pb[Wb]+"."+pb[1],pb[Wb],639960842,null,"None",pb[Wb],!1,void 0,!0));fa&&(pb=N.yw("ApplyTableFieldList."+pb[0],this.menuId,pb[0],798637440),Array.add(pb.menu.Dc,Ia),
Array.add(f.buttons,pb))}N=N.iq(this.menuId);Array.add(N.Dc,f);return N};wf.prototype.PMg=function(f,D){var N=this,fa=Cf.a.ed(12,1,0,881,0,2007340793,"RichValuePulloutIntoNonEmptyRange");if(ye.EwaSettings.Rz()){var Ia=new Ih.a(this.$,fa);Ia.wQ(function(){2===Ia.returnValue&&N.JRd(f,D,8)})}else{var pb=new Vf.ErrorDialog(this.$,fa);pb.wQ(function(){2===pb.returnValue&&N.JRd(f,D,8)});pb.pf()}};uk.Object.defineProperties(wf.prototype,{It:{configurable:!0,enumerable:!0,get:function(){return"PopulateTableFieldListContextMenu"}},
TB:{configurable:!0,enumerable:!0,get:function(){return Bf.a.eQf}},TO:{configurable:!0,enumerable:!0,get:function(){this.UWb||(this.UWb=this.$.da.Aa(261));return this.UWb}}});Object(Jb.a)(wf,"PulloutFieldListContextMenu",Qg.a,[]);var qc=Bf.a.gQf,Bb=Qg.a;Am(se,Bb);se.prototype.Mc=function(f,D,N){return-1687037502===D.command&&!!N&&this.grid.isEditing};se.prototype.executeCommand=function(f,D,N){this.showRichTextFloatie(N);return rg.Task.Sa(!0)};se.prototype.mLa=function(){return[V.a.b_g]};se.prototype.showRichTextFloatie=
function(f){var D=Object(k.a)(M.a,f.eventArgs);D&&(f=this.mLa(D.zb),D=new Sys.UI.Point(D.Ca.clientX,D.Ca.clientY),this.showFloatie(f,new Sys.UI.Bounds(D.x,D.y,0,0),2))};uk.Object.defineProperties(se.prototype,{It:{configurable:!0,enumerable:!0,get:function(){return"PopulateRichTextContextMenu"}},TB:{configurable:!0,enumerable:!0,get:function(){return Bf.a.gQf}}});Object(Jb.a)(se,"RichTextContextMenu",Qg.a,[]);var sd=b(98),Vd=Bf.a.B6g,bf=Qg.a;Am(vf,bf);vf.prototype.executeCommand=function(f,D,N){if(Fb.a(this.$))return rg.Task.Sa(!0);
this.$.isEditMode&&(f=N[Bf.a.G5f],f=f.x&&f.y?new Sys.UI.Point(f.x+(this.$.isChromeRtl?10:-10),f.y):$a.DOMElementExtensions.getLocation(N[Bf.a.H5f]),this.Qp(f,!1));return rg.Task.Sa(!0)};vf.prototype.Mc=function(f,D,N){return-1075099431===D.command&&!!N};vf.prototype.QZ=function(){var f=this.Ta.iq(this.menuId),D=this.$.isEditMode;this.KYj();this.aMh(f,D);this.RLh(f);this.UMh(f);return f};vf.prototype.y_b=function(f,D,N,fa){Array.add(f,this.Ta.Cb(D?N:fa))};vf.prototype.aMh=function(f,D){var N=this.Ta,
fa=N.Oc();Array.add(fa.buttons,N.Cb(54));this.y_b(fa.buttons,this.fkc,127,56);Array.add(fa.buttons,N.Cb(55));D&&this.y_b(fa.buttons,this.fkc,126,125);Array.add(fa.buttons,N.Cb(158));this.$.ea.nMb&&(D=Object(k.a)(sd.a,this.$.oa))&&Tc.q(D)&&this.$.isEditMode&&(Array.add(fa.buttons,N.Cb(277)),D.isLockPausedInSession?Array.add(fa.buttons,N.Cb(279)):D.zj&&Array.add(fa.buttons,N.Cb(278)));D=N.yw("ContextMenu.TabColor",null,oe.a.instance.fa(511),1841703919);N=N.c6c(467002767,1549407384,534,-221093529,this.TB);
Array.add(D.menu.Dc,N);Array.add(fa.buttons,D);Array.add(f.Dc,fa)};vf.prototype.RLh=function(f){var D=this.Ta.Oc();this.y_b(D.buttons,this.fkc,114,112);this.y_b(D.buttons,!this.Gic,115,113);Array.add(f.Dc,D)};vf.prototype.UMh=function(f){if(ye.EwaSettings.ma(492)&&!Tc.e(this.$.xa.oa)){var D=this.Ta,N=D.Oc();Array.add(N.buttons,D.Cb(263));Array.add(f.Dc,N)}};vf.prototype.KYj=function(){var f=this.$.P5c();var D=f.Q5c;f=f.DGe;this.fkc=1===D;this.Gic=0<f};uk.Object.defineProperties(vf.prototype,{It:{configurable:!0,
enumerable:!0,get:function(){return"PopulateSheetOpsContextMenu"}},TB:{configurable:!0,enumerable:!0,get:function(){return Bf.a.hQf}}});Object(Jb.a)(vf,"SheetOpsContextMenu",Qg.a,[]);var Xf=b(564),vg=Qg.a;Am(lf,vg);lf.prototype.$c=function(f,D){var N=!0;switch(D){case -231711729:N=!1;break;case -1909381757:N=this.eec();N=!!N&&N.Xmi;break;case 1312363469:N=ye.EwaSettings.ma(457)}return!N||vg.prototype.$c.call(this,f,D)};lf.prototype.executeCommand=function(f,D,N){if(!this.$.isEditMode)return ud.TaskExtensions.s5();
f=D.command;D=this.eec();var fa=null;switch(f){case 2108047455:D&&D.ZCe();break;case -231711729:ld.ULS.shipAssertTag(537166990,0,!1,"Shouldn't be hitting Slicer Refresh - NYI");break;case -1909381757:D&&D.o4b();break;case 1312363469:this.showSlicerContextMenu(N);break;default:fa=be.a(f)}return fa||ud.TaskExtensions.s5()};lf.prototype.Mc=function(f,D,N){f=!1;switch(D.command){case -231711729:case 2108047455:case -1909381757:f=!0;break;case 1312363469:f=ye.EwaSettings.ma(457)&&!!N}return f};lf.prototype.QZ=
function(){var f=this.Ta.iq(this.menuId),D=this.Ta.Oc();Array.add(D.buttons,this.Ta.Cb(252));ye.EwaSettings.ma(495)&&Array.add(D.buttons,this.Ta.Cb(253));Array.add(D.buttons,this.Ta.Cb(254));Array.add(f.Dc,D);D=this.Ta.Oc();this.fsi()?Array.add(D.buttons,this.Ta.Cb(266)):Array.add(D.buttons,this.Ta.Cb(267));Array.add(f.Dc,D);return f};lf.prototype.fsi=function(){if(cg.a.Md(this.$)){var f=this.$.da.Aa(439);if(f)return f.As}else if(f=this.$.da.Aa(371))return f.As;return!1};lf.prototype.showSlicerContextMenu=
function(f){var D=Object(k.a)(M.a,f.eventArgs);f=this.Dcc(Object(k.a)(M.a,f.eventArgs));D=D.zb;tf.a.$b=D;this.Qp(f,!1,D)};lf.prototype.q_e=function(f){var D=this.Ta.Oc(),N=this.Ta.Oc();Array.add(N.buttons,this.Ta.Cb(255));Array.add(N.buttons,this.Ta.Cb(256));var fa=this.Ta.i6c("ContextMenu.SlicerSort",null,oe.a.instance.fa(2116),-814639094,0,R.a.gTe);Array.add(fa.menu.Dc,N);Array.add(D.buttons,fa);Array.add(f.Dc,D)};lf.prototype.KDj=function(f){return ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5103035_SlicerCornerResizePointContextMenuUseOnlyClientPoint")&&
f.Mb.className===R.a.tbd||ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5185773_SlicerShortcutContextMenuSkipFramePoint")&&1===f.zb};lf.prototype.Dcc=function(f){var D=We.g(this.$).ga.Pa.nc,N=f&&1!==f.zb&&f.clientPoint?f.clientPoint:Sys.UI.DomElement.getLocation(D.domElement);if(this.KDj(f)){var fa=this.eec();fa&&(f.Mb.className===R.a.tbd&&(N=ca.HelperMethods.Lwb(f.Ca)),1===f.zb&&(N=Bg.a(this.$).Gka($a.DOMElementExtensions.getLocation(fa.frame))))}else if(f=this.eec())f=this.rVh(f.frame),(fa=ca.HelperMethods.yB(this.$.zf,
this.$.domElement,We.g(this.$).rtl,!1))?(f.x=Bg.a(this.$).Mi(f.x-fa.x)+fa.x,f.y=Bg.a(this.$).Mi(f.y-fa.y)+fa.y):ld.ULS.sendTraceTag(537166989,0,15,"Cannot get constant pane size."),N.y+=f.y,N.x+=f.x;f=this.$.domElement;fa=We.g(this.$).rtl;D=ca.HelperMethods.yB(D.sg.domElement,f,fa);N.y=Math.max(N.y,D.y);N.x=Math.max(N.x,D.x);return N};lf.prototype.eec=function(){var f=We.g(this.$).ga.Pa.nc;ld.ULS.shipAssertTag(537166988,0,!!f);return Xf.a(this.$).iD(f.floatingObject.id)};lf.prototype.rVh=function(f){var D=
new Sys.UI.Point(f.offsetParent.offsetLeft,f.offsetParent.offsetTop),N=We.g(this.$);if(!N)return D;var fa=We.g(this.$).rtl;D=ca.HelperMethods.yB(f,this.$.zr.ownerDocument.body,fa);N.uGe(D);D.x=fa?this.$.zr.clientWidth-D.x-f.clientWidth:D.x;f=N.view.Jqb;N=fa?-N.cP.$ca(f.x):f.x;D.x-=N;D.y-=f.y;return D};uk.Object.defineProperties(lf.prototype,{It:{configurable:!0,enumerable:!0,get:function(){return"PopulateSlicerContextMenu"}},TB:{configurable:!0,enumerable:!0,get:function(){return Bf.a.iQf}}});Object(Jb.a)(lf,
"SlicerContextMenu",Qg.a,[]);Object(Jb.a)(Je,"TimeSlicerRibbonButtonParameter",null,[]);var kh=Qg.a;Am(Wd,kh);Wd.prototype.executeCommand=function(f,D,N){f=D.command;switch(f){case 2000085697:f=N.DOMElement;this.Ota=N.ChangeLevelCallback;this.vLa=N.GetLevelLabelCallback;this.o2a=N.CurrentLevel;var fa=N.DomEvent;Yf.g(fa);var Ia=N.location;N=N.levelLabelText;this.YNe=$a.DOMElementExtensions.Oz(document.activeElement,"iframe")&&N?N.parentNode:null;N=Sys.UI.DomElement.getBounds(N);N.x=Ia.x;N.y=Ia.y;this.w1(fa,
f,N,D,!0);break;case -649826274:this.Ota(0);break;case 149600865:this.Ota(1);break;case -2012435159:this.Ota(2);break;case -1979934975:this.Ota(3);break;case 1634477200:$a.DOMElementExtensions.setFocus(this.YNe);break;default:return be.a(f)}return rg.Task.Sa(!0)};Wd.prototype.Mc=function(f,D,N){f=!1;switch(D.command){case 2000085697:f=!!N;break;case -649826274:case 149600865:case -2012435159:case -1979934975:case 1634477200:f=!0}return f};Wd.prototype.w1=function(f,D,N){f=Sys.UI.DomElement.getBounds(D);
N.x=Bg.a(this.$).Mi(N.x);N.y=Bg.a(this.$).Mi(N.y);f.x=Bg.a(this.$).Mi(f.x);f.y=Bg.a(this.$).Mi(f.y);f=new Sys.UI.Point(f.x+N.x,f.y+N.y);this.eVa(f,D);this.showContextMenu(new Sys.UI.Bounds(f.x,f.y-N.height,N.width,N.height))};Wd.prototype.QZ=function(){for(var f=this.Ta,D=f.iq(this.menuId),N=f.Oc(),fa=0;3>=fa;fa++){var Ia=this.vLa(fa),pb=Wd.KPh(fa);pb=f.y8g(pb.z6g,pb.Lp,this.o2a===fa,Wd.dCe);pb.label=Ia;pb.hT(Ia);this.o2a===fa?pb.jT("Image16by16",8,Wd.dCe):pb.g4b();Array.add(N.buttons,pb)}Array.add(D.Dc,
N);return D};Wd.KPh=function(f){var D=null;switch(f){case 0:D=new Je(87,"ContextMenu.TimeSlicerLevelYear",-649826274);break;case 1:D=new Je(88,"ContextMenu.TimeSlicerLevelQuater",149600865);break;case 2:D=new Je(89,"ContextMenu.TimeSlicerLevelMonth",-2012435159);break;case 3:D=new Je(90,"ContextMenu.TimeSlicerLevelDay",-1979934975)}return D};uk.Object.defineProperties(Wd.prototype,{It:{configurable:!0,enumerable:!0,get:function(){return"PopulateTimeSlicerLevelMenu"}},TB:{configurable:!0,enumerable:!0,
get:function(){return Bf.a.lQf}}});Wd.fPj=Bf.a.D6g;Wd.nKb="TimeSlicerLevelMenuRootName";Wd.dCe=R.a.Ava;Object(Jb.a)(Wd,"TimeSlicerLevelMenu",Qg.a,[]);var ki=b(327),Yd=b(3),df=Mc.a;Am(le,df);le.prototype.Qd=function(){var f=this,D=this.$,N=Zf.a.g2a($f.b(),this.la,"Task","IRootUser"),fa=zg.a(D),Ia=null;Ia=function(Nc,kd){fa.JUf(Ia);N.setResult(kd.z5b)};fa.Fre(Ia);fa.$4e();var pb=mf.GetServiceTaskFactory.create(D.da,102,D.la,this.ub),Wb=mf.GetServiceTaskFactory.Ua(D.da,342,338,this.ub);ud.TaskExtensions.Ba(ud.TaskExtensions.we([N.task,
pb,Wb],this.la),function(){var Nc=pb.result,kd=N.task.result,Xc=Wb.result;f.Jd([new dg(D,kd,Nc,Xc),new Td(D,kd,Nc,Xc),new nd(D,kd,Nc,Xc),new Ed(D,kd,Nc,Xc),new ug(D,kd,Nc,Xc),new Fe(D,kd,Nc,Xc),new Xd.GridContextMenu(D,kd,Nc,Xc),new Tf(D,kd,Nc,Xc),new vf(D,kd,Nc,Xc),new Wd(D,kd,Nc,Xc),new wf(D,kd,Nc,Xc),new fe(D,kd,Nc,Xc),new Wf(D,kd,Nc,Xc),new lf(D,kd,Nc,Xc),new se(D,kd,Nc,Xc)])},D.la,3)};le.initData=function(){var f=ki.a.n3;f(2000085697,20479,0,0);f(-227942804,Yd.a.Lc|24576,0,0);f(1634477200,Yd.a.Lc|
131072,0,0);f(-649826274,4095,0,0);f(149600865,4095,0,0);f(-2012435159,4095,0,0);f(-1979934975,4095,0,0);f(1247109494,Yd.a.Lc|24576,0,0);f(-2064931494,Yd.a.Lc|131072,0,0);f(-1396319072,Yd.a.Ia,128,0);f(-425234874,Yd.a.Ia,128,0);f(-1253126584,Yd.a.Ia,0,0);f(274207288,Yd.a.Lc|24576,0,0);f(-1497523576,Yd.a.Lc|131072,0,0);f(-498523270,Yd.a.Lc|24576,64,0);f(1640762262,Yd.a.Lc|131072,64,0);f(-2017893763,Yd.a.Lc|24576,0,0);f(1350204367,Yd.a.Lc|131072,0,0);f(-889576107,Yd.a.uw,128,0);f(-1170196828,Yd.a.uw,
128,0);f(389774337,Yd.a.uw,128,0);f(1529312473,Yd.a.uw,128,0);f(2033235475,Yd.a.uw,128,0);f(-96230454,Yd.a.uw,128,0);f(74086617,Yd.a.uw,128,0);f(563292088,Yd.a.uw,128,0);f(-1092351914,Yd.a.uw,128,0);f(-2141589616,Yd.a.uw|16384,128,0);f(745182485,Yd.a.uw,0,0);f(359279088,Yd.a.uw,128,0);f(-67292059,Yd.a.uw,128,0);f(926905850,Yd.a.uw,128,0);f(547535945,Yd.a.uw,128,0);f(1374696078,Yd.a.Lc|24576,0,0);f(495005930,Yd.a.Lc|212992,0,0);f(-1045020714,Yd.a.Lc|24576,0,0);f(-170383950,Yd.a.Lc|212992,0,0);f(324156914,
Yd.a.Ia,0,0);f(-1085236154,Yd.a.Zu,0,0);f(-751848458,Yd.a.xl|16384,0,0);f(216058793,Yd.a.Zu,0,0);f(474690375,Yd.a.xl|16384,0,0);f(-1920954846,Yd.a.Lc|24576,0,0);f(723126814,Yd.a.Lc|131072,0,0);f(2108047455,128,128,0);f(-231711729,128,128,0);f(-1909381757,128,128,0);f(-814639094,128,128,0);f(1701016594,Yd.a.Lc|3072,128,0);f(-1475408662,Yd.a.Lc|24576,0,0);f(1114549926,Yd.a.Lc|131072,32,0)};le.ka=function(f){Mc.a.je(10,new le(f))};Object(Jb.a)(le,"ContextMenuCommandHandlerFactory",Mc.a,[]);var lh=b(224),
Oj=b(1436),ig=b(92),pj=b(261);Id.prototype.dispose=function(){};Id.prototype.Oaa=function(){this.Bsb.w4()};Id.prototype.XC=function(){this.Bsb.XC()};Id.prototype.QUd=function(f,D,N){cf.h(this.$,cf.b);this.Bsb.showContextMenu(Object.assign(new Oj.a,{x:D.x,y:D.y}),N,f);ig.EventHandlerManager.instance.Ned()};Id.prototype.Szc=function(f,D,N){cf.h(this.$,cf.b);this.Bsb.showFloatie(Object.assign(new Oj.a,{x:D.x,y:D.y}),f,N);pj.a(function(){ig.EventHandlerManager.instance.Ned()},this.$.la)};Id.prototype.PUd=
function(f,D,N,fa){cf.h(this.$,cf.b);this.Bsb.PUd(Object.assign(new Oj.a,{x:D.x,y:D.y}),f,N,fa)};Object(Jb.a)(Id,"ReactContextMenuController",null,[755,3]);var qj=lh.a;Am(xd,qj);xd.prototype.dispose=function(){this.Kdf&&this.$&&this.$.ea.Kp(this.Nod);qj.prototype.dispose.call(this)};xd.prototype.create=function(){this.$.ea.yh?(ld.ULS.sendTraceTag(537167065,0,50,"ContextMenuControllerFactory.InitReactUISurfacesAndRegisterControllerIfNeeded: GFI = {0}",this.$.ea.yh),this.Nod(null,null)):(this.Kdf=!0,
this.$.ea.Gm(this.Nod))};xd.ka=function(f){f.da.Ha(338,new xd(f))};Object(Jb.a)(xd,"ContextMenuControllerFactory",lh.a,[]);var fi=b(160);Object(Jb.a)(Gc,"RibbonCommandParams",null,[]);Object(Jb.a)(fc,"HeaderSnappedAutoFilterMenuCacheEntry",null,[]);xf.prototype.WPh=function(f){return(f=this.Ffc[f.toString()])?f.menuModel:null};xf.prototype.lXg=function(f,D){this.Ffc[D.toString()]=Object.assign(new fc,{menuModel:f,gJe:ca.HelperMethods.kc()})};xf.prototype.h9b=function(f){this.Ffc[f.toString()]=null};
xf.prototype.g4h=function(f){return(f=this.Ffc[f.toString()])?f.gJe:-1};Object(Jb.a)(xf,"FilterMenuCache",null,[]);var hg=b(12),Wh=b(193),vi=b(226);Object(Jb.a)(Af,"AutoFilterEventRegistrationArgs",null,[]);var Si=b(24);qe.prototype.dispose=function(){window.cancelAnimationFrame(this.VCb);this.gridView&&this.gridView.Yuc(this.GFb);this.gridView=null};qe.prototype.Qdi=function(){if(this.gUd=ca.HelperMethods.g8a)this.a0a=[];this.iGg();this.gridView.Y_b(this.GFb)};qe.prototype.iGg=function(){for(var f=
Cl(this.gridView.zn),D=f.next();!D.done;D=f.next()){D=D.value.XCa;for(var N in D){var fa=D[N];this.GOf(fa.domElement,fa.hashCode)}}};qe.prototype.GOf=function(f,D){if(We.g(this.$).Da.Wl.W2a(D))if(f){f=f.querySelectorAll('[id^="'+Bf.a.xdd+'"]');for(var N=0;N<f.length;N++){var fa=f[N],Ia=fa.getAttribute(Bf.a.jGh),pb=fa.getAttribute(Bf.a.cGh);ld.ULS.shipAssertTag(537167053,0,!!Ia&&!!pb,"FilterMenuManager.QueuePointerHandlerRegistrationsToFiltersInBlock: Row and Column attributes should exist in AF input element. AutoFilterId: {0}, BlockHash: {1}",
fa.id,D);Ia=Si.Range.kd(parseInt(Ia,10),parseInt(pb,10));fa=Object.assign(new Af,{cell:Ia,Pwe:fa,Zd:D});this.gUd?(this.a0a.push(fa),this.VCb||(this.lQe=window.performance.now(),this.VCb=window.requestAnimationFrame(this.sSf))):this.Wpe(fa)}}else ld.ULS.sendTraceTag(537167054,0,50,"FilterMenuManager.QueuePointerHandlerRegistrationsToFiltersInBlock: Block DOM element is null. BlockHash: {0}",D);else ld.ULS.sendTraceTag(537167055,0,50,"FilterMenuManager.QueuePointerHandlerRegistrationsToFiltersInBlock: Block model does not exist yet. Handlers will be added when block is rendered. BlockHash: {0}",
D)};qe.prototype.Wpe=function(f){var D=this.gridView.Da.s5a(f.cell,f.Zd);D?this.hGg(f.Pwe,D):ld.ULS.sendTraceTag(537167050,1,10,"FilterMenuManager.AddPointerHandlersToAutoFilterInCell: GetModelCellFromRange returned null. BlockHash: {0}, AutoFilter Cell: {1}",f.Zd,f.cell)};qe.prototype.hGg=function(f,D){D.hasAutoFilter?this.jEg(f,D.vdd):D.C5?this.fGg(f,D.vdd,D.Njf):ld.ULS.sendTraceTag(537167049,1,50,"FilterMenuManager.AddPointerEventHandlersToAutoFilter: Cell must have either AutoFilter or PivotFilter if reached here!");
fi.a.instance.qa(hg.a.Mf,f,this.onPointerDown);Wh.a.instance.qa(hg.a.mza,f,this.onPointerDown)};qe.prototype.jEg=function(f,D){vi.a.instance.qa(hg.a.click,f,function(N){D&&pf.a.hrc(N.Ca.rawEvent,966232027,D,null);return!0})};qe.prototype.fGg=function(f,D,N){var fa=Ka.a.ui(D);vi.a.instance.qa(hg.a.click,f,function(Ia){N?pf.a.spf(document.getElementById(fa.EwaElementId),fa.Cell,fa.DataSourceIndex,fa.FieldId,fa.IsOlap,fa.RequiresConfirmation,Ia.Ca.rawEvent,fa.OptionalPivotMenuAnchor):pf.a.spfm(Ia.Ca.rawEvent,
fa.RequiresConfirmation,fa.Cell,fa.DataSourceIndex,fa.PivotName,fa.OptionalPivotMenuAnchor);return!1})};Object(Jb.a)(qe,"FilterMenuPointerEventsManager",null,[3]);he.prototype.dispose=function(){ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")&&ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5035623_autofiltersHitTest")||this.$We.dispose();this.$=null};he.prototype.cWh=function(f){var D=We.g(this.$).Da.X$(f,this.$.activeItemName);return D&&D.blockPresentInViewportTimeStamp>this.a$a.g4h(f.left)?
D.xt(f).autoFilterMenu:this.a$a.WPh(f.left)};he.prototype.fSi=function(f,D,N){this.a$a&&this.a$a.lXg(f.menuModel[D],N)};he.prototype.gSi=function(f){this.a$a&&this.a$a.h9b(f)};Object(Jb.a)(he,"FilterMenuManager",null,[753,3]);var Nf=b(232),ri=b(181);Lc.prototype.Ogd=function(f){return xg.a.Fc(this.rAc,f)};Lc.prototype.dispose=function(){this.Pd?ld.ULS.sendTraceTag(537167062,1,50,"ContextMenuManager.Dispose: Dispose has been called more than once"):(this.Pd=!0,this.$&&(this.$.Bl(Lc.vd),this.$.da.yV(8),
this.ga&&this.ga.Puc(this.nl),this.$.Ka.Fcb(this.eAf),ye.EwaSettings.isChangeGateEnabled("OfficeVSO:4728637_DissmissContextualUIFromContextMenuManager")&&this.$.Ka&&this.$.Ka.NRa(this.z0),ye.EwaSettings.isChangeGateEnabled("OfficeVSO:4932179_RemoveControllerRecreationOnModeSwitch")||this.$.ea.N7(this.W6)),this.$=this.ga=null,this.zac.dispose(),this.rAc=this.U9d=null)};Lc.prototype.showContextMenu=function(f,D,N){D=void 0===D?null:D;N=void 0===N?null:N;this.pDj(f)&&(cf.h(this.$,cf.i),f=this.J9g(f,
D,N),this.$.Ka.dc(f.Xd,f.dictionary))};Lc.prototype.w4=function(){this.contextMenuController?this.contextMenuController.Oaa():ld.ULS.sendTraceTag(537167061,1,10,"ContextMenuManager.DismissContextualUI: Context menu controller is null.")};Lc.prototype.pDj=function(f){return Og.a(this.$).Rq()?(ld.ULS.sendTraceTag(537167060,1,50,"ContextMenuManager.OnContextMenu: Ignoring ContextMenu event because it is not allowed in partial interactivity mode"),Og.a(this.$).S0(ri.a.grid,Nf.a.showContextMenu),!1):!this.$.Ka.EDh&&
(!f||f.Mb!==We.g(this.$).domElement&&!Ba.a.equals(f.Mb.tagName,"INPUT",!0))};Lc.prototype.J9g=function(f,D,N){D=void 0===D?null:D;var fa={};N=(fa.eventArgs=f,fa.creationParams=void 0===N?null:N,fa);f=f?f.zb:-1;fa=this.ga.Pa.nc;var Ia=1441131127;fa?(D=fa.floatingObject,ld.ULS.shipAssertTag(537167059,0,!!D,"floatingObj shouldn't be null."),Lc.bud(D)?Ia=1312363469:Lc.isPivotChart(D)?(N[Td.z2c]=D?D.Zc:null,Ia=-149612405):Ia=-1372040782):Lc.Mjf(D)?(N[Td.z2c]=D,Ia=-149612405):!cf.g(this.$)&&cf.f(We.g(this.$))&&
(Ia=671488277);D=new bg.a(Ia,f,this.$.jd,30,null);return Object.assign(new Gc,{Xd:D,dictionary:N})};Lc.ka=function(f){f.fl(Lc.vd)};Lc.isPivotChart=function(f){return!!f&&0===f.type&&Lc.Mjf(f.Zc)};Lc.bud=function(f){return!!f&&2===f.type};Lc.Mjf=function(f){return!!f&&!!(f.Attributes&4)};uk.Object.defineProperties(Lc.prototype,{zac:{configurable:!0,enumerable:!0,get:function(){return this.U9d}}});Lc.E6g="autoFilter chart fieldList fieldListPivotFilter fieldWell floatingObject grid pivotFilter sheetOps timeSlicerLevel tableFieldList autoFilterRichFieldList slicer richText".split(" ");
Lc.S6h="GridContextMenu";Lc.vd=function(f){(f=Object(k.a)(6,f))&&mf.GetServiceTaskFactory.create(f.da,9,f.la,0)};Object(Jb.a)(Lc,"ContextMenuManager",null,[726,3]);var Tj=lh.a;Am(Ec,Tj);Ec.prototype.create=function(){var f=this,D=this.$,N=D.pc;if(N.allowSelection||N.allowEdits||N.allowFiltering||N.allowSorting||N.allowPivotSpecificOperations){var fa=mf.GetServiceTaskFactory.create(D.da,10,D.la,this.ub),Ia=mf.GetServiceTaskFactory.Ua(D.da,342,338,this.ub);ud.TaskExtensions.Ba(ud.TaskExtensions.we([fa,
Ia],this.la),function(){f.Eb(Gi.a(D)||new Lc(D,fa.result,Ia.result))},this.$.la,3)}else ld.ULS.sendTraceTag(537167058,0,15,"ContextMenuManagerFactory.Create: no client permissions to allow creating ConetxtMenuManager. Returning null."),D.da.yV(8),this.Eb(null)};Ec.ka=function(f){f.da.Ha(9,new Ec(f))};Object(Jb.a)(Ec,"ContextMenuManagerFactory",lh.a,[]);Mb.prototype.isEqual=function(f){return f?this.Z5===f.Z5&&this.a6===f.a6&&this.JO===f.JO&&this.LO===f.LO&&this.VB===f.VB&&this.ruleType===f.ruleType&&
this.L_===f.L_&&this.MU===f.MU&&this.LU===f.LU&&this.tW===f.tW&&this.RF===f.RF&&this.n6===f.n6&&this.o6===f.o6:(ld.ULS.shipAssertTag(537163233,0,!1,"DataValidationEditDialogState.IsEqual: State should not be Null"),!1)};Object(Jb.a)(Mb,"DataValidationEditDialogState",null,[]);za.prototype.$c=function(){return!1};za.prototype.executeCommand=function(f,D){-1728432249!==D.command&&be.a(D.command);this.selectedRanges=af.r(We.g(this.$).ga.va.selectedRanges,this.$);We.g(this.$).y1(!0);this.getDataValidationInitialState();
this.qh=this.$.Sb.Hc("UserAction","DataValidationEditTimeToDialogOpen");this.INe?ld.ULS.sendTraceTag(537163285,0,50,"Open data validation edit dialog - NOT first time in session"):(ld.ULS.sendTraceTag(23667778,0,50,"Open data validation edit dialog - FIRST time in session"),this.INe=!0);return rg.Task.Sa(!0)};za.prototype.Mc=function(f,D){return-1728432249===D.command};za.prototype.nd=function(){return!1};za.prototype.getDataValidationInitialState=function(){var f=this,D=this.$.na.ta.fc();Sd.a(this.$.userOperationManager,
function(N,fa,Ia){return Se.u(f.$.na.ta,f.selectedRanges,Pg.b(N,f.wQi),Pg.a(fa),Ia,D)},function(N){return new Mf.a(120,0,N,16)},null)};za.prototype.D5i=function(){var f=this.dC={};switch(this.y2a.Command){case 0:var D="CreateNew";break;case 1:D="CreateNewFromRule";break;case 2:D="ExpandExisitng";break;case 3:D="OverrideExisitng";break;default:D="Unknown"}f.a=D;this.qh&&(this.qh.stop(),this.dC.r=this.qh.id);switch(this.y2a.Command){case 0:this.dC.b=!1;this.dC.c="None";this.HIa(new Mb);break;case 1:this.dC.b=
!1;this.dC.c="None";this.HIa(new Mb(this.y2a));break;case 2:this.dC.b=!0;this.g8c.H8g(this.$,this.LDh);break;case 3:this.dC.b=!0;this.g8c.J8g(this.$,this.D0i);break;default:ld.ULS.sendTraceTag(537163282,0,10,"DataValidationEditCommandHandler.PrepareUserDialog, unexpected command type.")}};za.prototype.HIa=function(f){this.g8c.HIa(this.$,this.selectedRanges,f,this.y2a.Command);this.BBi(f)};za.prototype.BBi=function(f){za.Qtb(f,this.dC);this.dC.d=!0;$f.b().Te(48,this.dC,!0)};za.prototype.crf=function(){this.dC.d=
!1;$f.b().Te(48,this.dC,!0)};za.prototype.GX=function(f,D){var N={};f=(N.ButtonType=za.oja(D),N.DialogName=f,N.Location="dialog",N.NumberOfSelectedRanges=We.g(this.$).ga.va.zL,N);rh.b(this.$).he(wb.a.c8b,f)};za.Qtb=function(f,D){D.e=hc(f.ruleType);D.f=cc(f.VB);D.g=!!f.JO;D.h=!!f.LO;D.i=f.Z5;D.j=f.a6;D.k=f.o6;D.l=!!f.RF;D.m=!!f.tW;D.n=f.n6;D.o=f.L_;D.p=!!f.MU;D.q=!!f.LU};za.oja=function(f){switch(f){case 1:return"Yes";case 2:return"No";case 0:return"Cancel";default:return ld.ULS.shipAssertTag(537163281,
0,!1,"DataValidationEditCommandHandler.DialogButtonToString: Unknown DialogButton"),"Unknown"}};Object(Jb.a)(za,"DataValidationEditCommandHandler",null,[434]);var Jh=b(1007),Ui;(function(f){f[f.between=0]="between";f[f.notBetween=1]="notBetween";f[f.equal=2]="equal";f[f.notEqual=3]="notEqual";f[f.greaterThan=4]="greaterThan";f[f.lessThan=5]="lessThan";f[f.greaterThanOrEqual=6]="greaterThanOrEqual";f[f.lessThanOrEqual=7]="lessThanOrEqual"})(Ui||(Ui={}));Object(Jb.b)("DataValidationRuleConditionType",
Ui);var Kh;(function(f){f[f.anyValue=0]="anyValue";f[f.wholeNumber=1]="wholeNumber";f[f.decimal=2]="decimal";f[f.list=3]="list";f[f.date=4]="date";f[f.time=5]="time";f[f.textLength=6]="textLength";f[f.custom=7]="custom"})(Kh||(Kh={}));Object(Jb.b)("DataValidationRuleType",Kh);var Yi=b(149),jh=b(168);uk.Object.defineProperties(dc,{ig:{configurable:!0,enumerable:!0,get:function(){return Yi.a.Qn(dc.fk,"")}},Tih:{configurable:!0,enumerable:!0,get:function(){return Yi.a.Qn(dc.Xih,jh.a.fa(1625),jh.a.fa(1640),
jh.a.fa(1641),jh.a.fa(1642),jh.a.fa(1643),jh.a.fa(1644),jh.a.fa(1645),jh.a.fa(1646),jh.a.fa(1647),jh.a.fa(1626),jh.a.fa(1650),jh.a.fa(1651),jh.a.fa(1652),jh.a.fa(1653),jh.a.fa(1654),jh.a.fa(1655),jh.a.fa(1656),jh.a.fa(1657),jh.a.fa(1627),jh.a.fa(1628),jh.a.fa(1648),jh.a.fa(1649),jh.a.fa(1639),"255")}},$ih:{configurable:!0,enumerable:!0,get:function(){return Yi.a.Qn(dc.Yih,jh.a.fa(1662),jh.a.fa(1666),jh.a.fa(1667),"255","32")}},djh:{configurable:!0,enumerable:!0,get:function(){return Yi.a.Qn(dc.Zih,
jh.a.fa(1661),jh.a.fa(1664),jh.a.fa(1663),jh.a.fa(1665),jh.a.fa(1666),jh.a.fa(1667),"255","32")}}});dc.gcg=255;dc.fk="<div class='WACDialogRow' id='dataValidationTabsId'> </div> <div class='DataValidationEditErrorMessage WACDialogRowNoBreak' id='ErrorContainer'> <label id='validationErrorMessageId' class='WACDialogLabel' role='alert' >{0}</label> </div>";dc.Xih="<div class='DataValidationEditTabContent' id='ConditionDivID'> <div class='DataValidationRow' id='allowConditionRow'> <label id='allowConditionSelectionLabelId' class='DataValidationEditElementLabel' for='allowConditionSelectionId'>{0}</label> <select class='WACDialogList DataValidationEditElement DataValidationEditSelect' id='allowConditionSelectionId'> <option value='0'>{1}</option> <option value='1'>{2}</option> <option value='2'>{3}</option> <option value='3'>{4}</option> <option value='4'>{5}</option> <option value='5'>{6}</option> <option value='6'>{7}</option> <option value='7'>{8}</option> </select> </div> <div class='DataValidationRow' id='operatorSelectionDivId'> <label id='operatorSelectionLabelId' class='DataValidationEditElementLabel' for='operatorSelectionId'>{9}</label> <select class='WACDialogList DataValidationEditElement DataValidationEditSelect' id='operatorSelectionId'> <option value='0'>{10}</option> <option value='1'>{11}</option> <option value='2'>{12}</option> <option value='3'>{13}</option> <option value='4'>{14}</option> <option value='5'>{15}</option> <option value='6'>{16}</option> <option value='7'>{17}</option> </select> </div> <div class='DataValidationRow' id='operatorInputDivId1'> <label id='operatorInputLableId1' class='DataValidationEditElementLabel' for='operatorInputId1'>{18}</label> <input type='text' id='operatorInputId1' class='DataValidationEditElement DataValidationEditInput' spellcheck=\"false\" maxlength={23} autocomplete=\"off\"/> </div> <div class='DataValidationRow' id='operatorInputDivId2'> <label id='operatorInputLableId2' class='DataValidationEditElementLabel' for='operatorInputId2'>{19}</label> <input type='text' id='operatorInputId2' class='DataValidationEditElement DataValidationEditInput' spellcheck=\"false\" maxlength={23} autocomplete=\"off\"/> </div> <div class='DataValidationNonBorderRow' id='listDescriptionDivId'> <div id='listDescriptionDummyLabelId' class='DataValidationEditElementLabel'></div> <div class='DataValidationEditNoBorderElement' id='listDescriptionSubDivID'> <label id='listDescriptionLabelId' class='DataValidationEditLabel' for='listDescriptionSubDivID'>{20}</label> </div> </div> <div class='DataValidationNonBorderRow' id='ignoreBlankCheckboxDivID'> <div id='ignoreBlankCheckboxDummyLabelId' class='DataValidationEditElementLabel'></div> <div class='DataValidationEditNoBorderElement' id='ignoreBlankCheckboxSubDivID'> <input type='checkbox' id='ignoreBlankCheckBoxId' class='WACDialogCheckBox DataValidationEditCheckBoxWithText' title='{21}'></input> <label id='\"\"' class='WACDialogLabel' for='ignoreBlankCheckBoxId' >{21}</label> </div> </div> <div class='DataValidationNonBorderRow' id='inCellDropdownDivId'> <div id='inCellDropdownDummyLabelId' class='DataValidationEditElementLabel'></div> <div class='DataValidationEditNoBorderElement' id='inCellDropdownSubDivId'> <input type='checkbox' id='inCellDropdownCheckboxId' class='WACDialogCheckBox DataValidationEditCheckBoxWithText' title='{22}'></input> <label id='\"\"' class='WACDialogLabel' for='inCellDropdownCheckboxId' >{22}</label> </div> </div> </div>";
dc.Yih="<div class='DataValidationEditTabContent' id='inputDivID'> <div class='DataValidationNonBorderRow' id='inputMessageCheckBoxDivID'> <label id='showInputCheckBoxLabelId' class='DataValidationEditElementLabel' for='showInputCheckBoxId'>{0}</label> <div class='DataValidationEditNoBorderElement' id='inputMessageCheckBoxSubDivID'> <input type='checkbox' id='showInputCheckBoxId' class='WACDialogCheckBox DataValidationEditCheckBoxNoText'></input> </div> </div> <div class='DataValidationRow' id='inputTitleDivID'> <label id='inputTitleLabelId' class='DataValidationEditElementLabel' for='textForInputTitleId'>{1}</label> <input type='text' id='textForInputTitleId' class='DataValidationEditElement DataValidationEditInput' maxlength={4} autocomplete=\"off\"/> </div> <div class='DataValidationRow' id='inputMessageDivID'> <label id='inputMessageLabelId' class='DataValidationEditElementLabel' for='textForInputMessageId'>{2}</label> <textarea id='textForInputMessageId' class='DataValidationEditElement DataValidationEditTextArea' maxlength={3} autocomplete=\"off\"></textarea> </div> </div>";
dc.Zih="<div class='DataValidationEditTabContent' id='alertDivID'> <div class='DataValidationNonBorderRow' id='showAlertCheckBoxDivID'> <label id='showAlertCheckBoxLabelId' class='DataValidationEditElementLabel' for='showAlertCheckBoxId'>{0}</label> <div class='DataValidationEditNoBorderElement' id='showAlertCheckBoxSubDivID'> <input type='checkbox' id='showAlertCheckBoxId' class='WACDialogCheckBox DataValidationEditCheckBoxNoText'></input> </div> </div> <div class='DataValidationRow' id='blockWarnRadioDivID'> <label id='blockWarnRadioLabelId' class='DataValidationEditElementLabel' for='blockWarnRadioSubDivID'>{1}</label> <div class='DataValidationEditRadio DataValidationEditNoBorderElement' id='blockWarnRadioSubDivID'> <input type='radio' id='blockingId' name='alertType' class='WACDialogRadio DataValidationEditRadio' alt='{2}' title='{2}'></input> <label id='blockingId' class='WACDialogLabel' for='blockingId' >{2}</label> <input type='radio' id='warningId' name='alertType' class='WACDialogRadio DataValidationEditRadio' alt='{3}' title='{3}'></input> <label id='blockingId' class='WACDialogLabel' for='warningId' >{3}</label> </div> </div> <div class='DataValidationRow' id='alertTitleDivID'> <label id='alertTitleLabelId' class='DataValidationEditElementLabel' for='textForAlertTitleId'>{4}</label> <input type='text' id='textForAlertTitleId' class='DataValidationEditElement DataValidationEditInput' maxlength={7} autocomplete=\"off\"/> </div> <div class='DataValidationRow' id='alertMessageDivID'> <label id='alertMessageLabelId' class='DataValidationEditElementLabel' for='textForAlertMessageId'>{5}</label> <textarea id='textForAlertMessageId' class='DataValidationEditElement DataValidationEditTextArea' maxlength={6} autocomplete=\"off\"></textarea> </div> </div>";
Object(Jb.a)(dc,"DataValidationEditDialogHtml",null,[]);var bh=b(616),Wj=Ug.a;Am(jf,Wj);jf.prototype.CBa=function(f){this.NU.selectedIndex=f.ruleType;this.BL.selectedIndex=f.VB;this.Fgc.checked=f.a6;this.txa.checked=f.Z5;this.Zza.value=f.JO;this.$za.value=f.LO;this.jda(null)};jf.prototype.arb=function(f){f.Z5=this.txa.checked;f.a6=this.Fgc.checked;f.VB=this.BL.selectedIndex;f.ruleType=this.NU.selectedIndex;f.JO=this.Zza.value;f.LO=this.$za.value};jf.prototype.dispose=function(){this.wm();this.Hk=
this.JFd=this.$qc=this.wQa=this.Hab=this.POa=this.W6a=this.Fgc=this.$za=this.Zza=this.BL=this.NU=this.txa=null;Wj.prototype.dispose.call(this)};jf.prototype.render=function(f){f.appendChild(this.domElement)};jf.prototype.Rka=function(){return this.isVisible};jf.prototype.Koa=function(f){return this.isVisible=f};jf.prototype.setFocus=function(){};jf.prototype.cxb=function(f,D){return this.W4e(f,D,this.NHh)};jf.prototype.Qjd=function(f,D){return 0!==D&&1!==D?"":this.W4e(f,D,this.Xqj)};jf.prototype.nla=
function(){this.domElement.innerHTML=dc.Tih;this.txa=$a.DOMElementExtensions.getElementById(this.domElement,"ignoreBlankCheckBoxId");this.NU=$a.DOMElementExtensions.getElementById(this.domElement,"allowConditionSelectionId");this.BL=$a.DOMElementExtensions.getElementById(this.domElement,"operatorSelectionId");this.Zza=$a.DOMElementExtensions.getElementById(this.domElement,"operatorInputId1");this.$za=$a.DOMElementExtensions.getElementById(this.domElement,"operatorInputId2");this.$qc=$a.DOMElementExtensions.getElementById(this.domElement,
"operatorInputLableId1");this.JFd=$a.DOMElementExtensions.getElementById(this.domElement,"operatorInputLableId2");this.W6a=$a.DOMElementExtensions.getElementById(this.domElement,"inCellDropdownDivId");this.POa=$a.DOMElementExtensions.getElementById(this.domElement,"listDescriptionDivId");this.Hab=$a.DOMElementExtensions.getElementById(this.domElement,"operatorInputDivId1");this.wQa=$a.DOMElementExtensions.getElementById(this.domElement,"operatorInputDivId2");this.Fgc=$a.DOMElementExtensions.getElementById(this.domElement,
"inCellDropdownCheckboxId");this.Ik()};jf.prototype.W4e=function(f,D,N){return N.length<f||N[f].length<D?(ld.ULS.sendTraceTag(537163280,0,10,"DataValidationEditDialog.GetOperatorLabel: wrong parameters conditionOption={0} operatorOption={1}, cannot get label.",f,D),""):this.oS.pa(N[f][D])};jf.prototype.Ik=function(){bh.a.instance.qa(hg.a.Ub,this.NU,this.xpc);bh.a.instance.qa(hg.a.Ub,this.BL,this.xpc);bh.a.instance.qa(hg.a.change,this.NU,this.jda);bh.a.instance.qa(hg.a.change,this.BL,this.jda);bh.a.instance.qa(hg.a.change,
this.BL,this.Hk);bh.a.instance.qa(hg.a.change,this.NU,this.Hk);bh.a.instance.qa(hg.a.change,this.Zza,this.Hk);bh.a.instance.qa(hg.a.Ub,this.Zza,this.Hk);bh.a.instance.qa(hg.a.change,this.$za,this.Hk);bh.a.instance.qa(hg.a.Ub,this.$za,this.Hk)};jf.prototype.wm=function(){bh.a.instance.za(hg.a.Ub,this.NU,this.xpc);bh.a.instance.za(hg.a.Ub,this.BL,this.xpc);bh.a.instance.za(hg.a.change,this.NU,this.jda);bh.a.instance.za(hg.a.change,this.BL,this.jda);bh.a.instance.za(hg.a.change,this.BL,this.Hk);bh.a.instance.za(hg.a.change,
this.NU,this.Hk);bh.a.instance.za(hg.a.change,this.Zza,this.Hk);bh.a.instance.za(hg.a.Ub,this.Zza,this.Hk);bh.a.instance.za(hg.a.change,this.$za,this.Hk);bh.a.instance.za(hg.a.Ub,this.$za,this.Hk)};jf.lka=function(){var f;return f=new Ab.a,f.add("operatorInputId1"),f.add("operatorInputId2"),f};uk.Object.defineProperties(jf.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return oe.a.instance.fa(1658)}},a5g:{configurable:!0,enumerable:!0,get:function(){return this.NU.selectedIndex}}});
Object(Jb.a)(jf,"DataValidationEditConditionsControl",Ug.a,[809,3,810]);var Df=b(203),ek=Jh.a;Am(pd,ek);pd.prototype.CVd=function(){var f={};f=(f.RuleType=this.Hd.ruleType,f.RuleOperatorType=this.Hd.VB,f.OperatorInput1=this.Hd.JO,f.OperatorInput2=this.Hd.LO,f.IsIgnoreBlank=this.Hd.Z5,f.IsInCellDropDown=this.Hd.a6,f.IsAlertBlocking=this.Hd.L_,f.AlertTitle=this.Hd.MU,f.AlertMessage=this.Hd.LU,f.InputTitle=this.Hd.RF,f.InputMessage=this.Hd.tW,f.IsShowErrorAlert=this.Hd.n6,f.IsShowInputMessage=this.Hd.o6,
f);this.Bc(2,oe.a.instance.fa(1624));var D={};f=(D[pd.Cz]=this.Cc,D.validateDialogValues=this.P_j,D.RangePickerController=We.g(this.$).Lg.Tdc(),D.isModal=!1,D.bodyProps=f,D);this.initializeAndShow(oe.a.instance.fa(1623),this.f8c,f);ld.ULS.sendTraceTag(537163278,0,50,"DataValidationEditDialog dialog opened.")};pd.prototype.dispose=function(){this.disposed||(ek.prototype.dispose.call(this),this.disposed=!0)};pd.prototype.lka=function(){return jf.lka()};pd.prototype.zSh=function(f,D){var N=this;return function(fa,
Ia,pb){var Wb=f.na.ta.fc();return jc(N.$.na.ta,N.selectedRanges,N.iVg(),N.a1a(fa,N.ZCd(D)),Pg.a(Ia),pb,Wb)}};pd.prototype.ZCd=function(f){var D=this;return function(N){ld.ULS.sendTraceTag(537163277,0,50,"DataValidationEditDialog.OnDataValidationEditSuccessCallback");var fa;Mh.a(N)?(ld.ULS.sendTraceTag(537163276,0,15,"DataValidationEditDialog.OnDataValidationEditSuccessCallback - request has expected errors: {0}.",N?Cf.a.Wc(N.Errors):null),N.Errors&&1===N.Errors.length&&((fa=D.Zgd(N.Errors[0].MessageId))?
D.pma("OkInvalidByServer",N.Errors[0].MessageIdName):(D.pma("OkValid","None"),D.hide()),f(fa)),ld.ULS.sendTraceTag(537163275,0,15,"DataValidationEditDialog.OnDataValidationEditSuccessCallback - Unexpected error, cannot parse: {0}",Cf.a.Wc(N.Errors))):D.hide()}};pd.prototype.iVg=function(){var f={};f.Command=this.command;f.RuleType=this.Hd.ruleType;f.ConditionType=this.Hd.VB;f.IsIgnoreBlank=this.Hd.Z5;f.IsInCellDropDown=this.Hd.a6;f.LowerBoundary=this.Hd.JO;f.UpperBoundary=this.Hd.LO;f.IsAlertBlocking=
this.Hd.L_;f.IsShowErrorAlert=this.Hd.n6;f.IsShowInputMessage=this.Hd.o6;f.AlertTitle=this.Hd.MU;f.AlertMessage=this.Hd.LU;f.InputTitle=this.Hd.RF;f.InputMessage=this.Hd.tW;f.ShouldIgnoreFormulaError=this.mOa;return f};pd.prototype.Zgd=function(f){switch(f){case 1173235830:return oe.a.instance.fa(1673);case 43935303:return oe.a.instance.fa(1674);case -1323438439:return oe.a.instance.fa(1676);case 2112020473:return oe.a.instance.fa(1670);case -219503282:return oe.a.instance.fa(1671);case 1689335445:return oe.a.instance.fa(1672);
case 2146493810:return oe.a.instance.fa(1675);case -2104909922:return String.format(oe.a.instance.Bb(104),this.Fvb,this.kQd);case -869372599:return String.format(oe.a.instance.Bb(103),this.Fvb);case -1181828368:return oe.a.instance.fa(1678);case -758480861:return oe.a.instance.fa(1679);case -13729088:return oe.a.instance.fa(1680);case -846654055:return oe.a.instance.fa(1681);case 751854001:return oe.a.instance.fa(1682);case -453846397:return oe.a.instance.fa(1683);case 1102013489:return oe.a.instance.fa(1684);
case 835813260:return oe.a.instance.fa(1685);case 1577787509:return oe.a.instance.fa(1686);case 2083564019:return oe.a.instance.fa(1677);default:ld.ULS.sendTraceTag(537163274,0,15,"DataValidationEditDialog.GetDataValidationServerErrorString - unexpected error: {0}.",f.toString())}return null};pd.prototype.Yma=function(){this.pma("Cancel","None")};pd.prototype.GX=function(f){ld.ULS.sendTraceTag(537163273,0,50,"DataValidationEditDialog {0} was clicked.",1===f?"Ok":"Cancel");var D={};f=(D.ButtonType=
pd.oja(f),D.DialogName=this.Cc,D.Location="dialog",D.NumberOfSelectedRanges=We.g(this.$).ga.va.zL,D);rh.b(this.$).he(wb.a.c8b,f)};pd.prototype.pma=function(f,D){var N={};pd.Qtb(this.Hd,N);N.o=f;N.p=D;N.n=this.Bla;this.qh&&(this.qh.stop(),N.q=this.qh.id);$f.b().Te(49,N,!0)};pd.prototype.Mcc=function(f){this.Hd.ruleType=f.RuleType;this.Hd.VB=f.RuleOperatorType;this.Hd.JO=f.OperatorInput1;this.Hd.LO=f.OperatorInput2;this.Hd.L_=f.IsAlertBlocking;this.Hd.n6=f.IsShowErrorAlert;this.Hd.MU=f.AlertTitle;this.Hd.LU=
f.AlertMessage;this.Hd.o6=f.IsShowInputMessage;this.Hd.RF=f.InputTitle;this.Hd.tW=f.InputMessage;this.Hd.Z5=f.IsIgnoreBlank;this.Hd.a6=f.IsInCellDropDown;this.Fvb=f.firstOperatorLabel;this.kQd=f.secondOperatorLabel};pd.prototype.jQb=function(f,D,N){var fa;var Ia=fa=null;if(!f)return N?(fa=String.format(oe.a.instance.Bb(104),this.Fvb,this.kQd),Ia="DataValidationEditNoMinMaxError"):(fa=String.format(oe.a.instance.Bb(103),this.Fvb),Ia="DataValidationEditNoValueError"),{returnValue:!1,errorString:fa,
Kq:Ia};if(f.length>dc.gcg)return fa=oe.a.instance.fa(1677),{returnValue:!1,errorString:fa,Kq:Ia};if(Df.d(f))return{returnValue:!0,errorString:fa,Kq:Ia};if(1===D||2===D||6===D){if(!Ba.a.f6(f))return fa=oe.a.instance.fa(1670),{returnValue:!1,errorString:fa,Kq:Ia};if(1===D&&!Ba.a.isInteger(f))return fa=oe.a.instance.fa(1671),{returnValue:!1,errorString:fa,Kq:Ia};if(6===D){if(!Ba.a.isInteger(f))return fa=oe.a.instance.fa(1671),{returnValue:!1,errorString:fa,Kq:Ia};if(0>parseInt(f,10))return fa=oe.a.instance.fa(1672),
{returnValue:!1,errorString:fa,Kq:Ia}}}return{returnValue:!0,errorString:fa,Kq:Ia}};pd.prototype.O1d=function(){var f=this,D;var N=D=null;var fa=this.Hd.JO,Ia=this.Hd.LO,pb=Kh[this.Hd.ruleType],Wb=Ui[this.Hd.VB];if(0===pb)return{returnValue:!0,errorString:D,Kq:N};var Nc=(0===Wb||1===Wb)&&3!==pb&&7!==pb;return!function(){var kd=f.jQb(fa,pb,Nc);D=kd.errorString;N=kd.Kq;return kd}().returnValue||Nc&&!function(){var kd=f.jQb(Ia,pb,Nc);D=kd.errorString;N=kd.Kq;return kd}().returnValue?{returnValue:!1,
errorString:D,Kq:N}:Nc&&(1===pb||2===pb||6===pb)&&!Df.d(fa)&&!Df.d(Ia)&&parseFloat(fa)>parseFloat(Ia)?(D=oe.a.instance.fa(1675),N="DataValidationEditMaximumLessMinimumError",{returnValue:!1,errorString:D,Kq:N}):{returnValue:!0,errorString:D,Kq:N}};pd.oja=function(f){switch(f){case 0:return"Cancel";case 1:return"Ok";case 2:return"ClearAll";default:return ld.ULS.shipAssertTag(537163272,0,!1,"DataValidationEditDialog.DialogButtonToString: Unknown DialogButton"),"Unknown"}};pd.Qtb=function(f,D){D.a=hc(f.ruleType);
D.b=cc(f.VB);D.c=!!f.JO;D.d=!!f.LO;D.e=f.Z5;D.f=f.a6;D.g=f.o6;D.h=!!f.RF;D.i=!!f.tW;D.j=f.n6;D.k=f.L_;D.l=!!f.MU;D.m=!!f.LU};uk.Object.defineProperties(pd.prototype,{Hd:{configurable:!0,enumerable:!0,get:function(){return this.xTb}},Cc:{configurable:!0,enumerable:!0,get:function(){return"DataValidationEditDialog"}},B3b:{configurable:!0,enumerable:!0,get:function(){return 3===this.Hd.ruleType}}});Object(Jb.a)(pd,"DataValidationEditDialog",Jh.a,[]);var Kj=b(322);ge.Gfh="DataValidationDialogPanel";ge.Ffh=
"DataValidationButtonPanel";ge.Efh="DataValidationButtonClearAll";Object(Jb.a)(ge,"CssClassNames",null,[]);var Ii=Ug.a;Am(te,Ii);te.prototype.render=function(f){f.appendChild(this.domElement)};te.prototype.Rka=function(){return this.isVisible};te.prototype.Koa=function(f){return this.isVisible=f};te.prototype.setFocus=function(){};te.prototype.dispose=function(){this.wm();this.Hk=this.Yba=this.Xba=this.vef=this.Wba=null;Ii.prototype.dispose.call(this)};te.prototype.nla=function(){this.domElement.innerHTML=
dc.$ih;this.Wba=$a.DOMElementExtensions.getElementById(this.domElement,"showInputCheckBoxId");this.vef=$a.DOMElementExtensions.getElementById(this.domElement,"inputMessageDivID");this.Yba=$a.DOMElementExtensions.getElementById(this.domElement,"textForInputTitleId");this.Xba=$a.DOMElementExtensions.getElementById(this.domElement,"textForInputMessageId");this.Wba.checked=!0;this.Ik();this.zpc(null)};te.prototype.CBa=function(f){this.Yba.value=void 0===f.RF||null===f.RF?"":f.RF;this.Xba.value=void 0===
f.tW||null===f.tW?"":f.tW;this.Wba.checked=f.o6;this.zpc(null)};te.prototype.arb=function(f){f.RF=this.Yba.value;f.tW=this.Xba.value;f.o6=this.Wba.checked};te.prototype.Ik=function(){bh.a.instance.qa(hg.a.change,this.Wba,this.zpc);bh.a.instance.qa(hg.a.change,this.Wba,this.Hk);bh.a.instance.qa(hg.a.change,this.Yba,this.Hk);bh.a.instance.qa(hg.a.Ub,this.Yba,this.Hk);bh.a.instance.qa(hg.a.change,this.Xba,this.Hk);bh.a.instance.qa(hg.a.Ub,this.Xba,this.Hk)};te.prototype.wm=function(){bh.a.instance.za(hg.a.change,
this.Wba,this.zpc);bh.a.instance.za(hg.a.change,this.Wba,this.Hk);bh.a.instance.za(hg.a.change,this.Yba,this.Hk);bh.a.instance.za(hg.a.Ub,this.Yba,this.Hk);bh.a.instance.za(hg.a.change,this.Xba,this.Hk);bh.a.instance.za(hg.a.Ub,this.Xba,this.Hk)};uk.Object.defineProperties(te.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return oe.a.instance.fa(1660)}}});Object(Jb.a)(te,"DataValidationEditInputControl",Ug.a,[809,3,812]);var Pj=Ug.a;Am(me,Pj);me.prototype.render=function(f){f.appendChild(this.domElement)};
me.prototype.Rka=function(){return this.isVisible};me.prototype.Koa=function(f){return this.isVisible=f};me.prototype.setFocus=function(){};me.prototype.dispose=function(){this.wm();this.Hk=this.H$=this.G$=this.HVa=this.lia=this.F$=null;Pj.prototype.dispose.call(this)};me.prototype.nla=function(){this.domElement.innerHTML=dc.djh;this.F$=$a.DOMElementExtensions.getElementById(this.domElement,"showAlertCheckBoxId");this.lia=$a.DOMElementExtensions.getElementById(this.domElement,"blockingId");this.HVa=
$a.DOMElementExtensions.getElementById(this.domElement,"warningId");this.H$=$a.DOMElementExtensions.getElementById(this.domElement,"textForAlertTitleId");this.G$=$a.DOMElementExtensions.getElementById(this.domElement,"textForAlertMessageId");this.F$.checked=!0;this.lia.checked=!0;this.Ik();this.ypc(null)};me.prototype.CBa=function(f){this.lia.checked=f.L_;this.HVa.checked=!f.L_;this.H$.value=void 0===f.MU||null===f.MU?"":f.MU;this.G$.value=void 0===f.LU||null===f.LU?"":f.LU;this.F$.checked=f.n6;this.ypc(null)};
me.prototype.arb=function(f){f.MU=this.H$.value;f.LU=this.G$.value;f.L_=this.lia.checked;f.n6=this.F$.checked};me.prototype.Ik=function(){bh.a.instance.qa(hg.a.change,this.F$,this.ypc);bh.a.instance.qa(hg.a.change,this.F$,this.Hk);bh.a.instance.qa(hg.a.change,this.lia,this.Hk);bh.a.instance.qa(hg.a.change,this.HVa,this.Hk);bh.a.instance.qa(hg.a.change,this.H$,this.Hk);bh.a.instance.qa(hg.a.Ub,this.H$,this.Hk);bh.a.instance.qa(hg.a.change,this.G$,this.Hk);bh.a.instance.qa(hg.a.Ub,this.G$,this.Hk)};
me.prototype.wm=function(){bh.a.instance.za(hg.a.change,this.F$,this.ypc);bh.a.instance.za(hg.a.change,this.F$,this.Hk);bh.a.instance.qa(hg.a.change,this.lia,this.Hk);bh.a.instance.qa(hg.a.change,this.HVa,this.Hk);bh.a.instance.za(hg.a.change,this.H$,this.Hk);bh.a.instance.za(hg.a.Ub,this.H$,this.Hk);bh.a.instance.za(hg.a.change,this.G$,this.Hk);bh.a.instance.za(hg.a.Ub,this.G$,this.Hk)};uk.Object.defineProperties(me.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return oe.a.instance.fa(1659)}}});
Object(Jb.a)(me,"DataValidationEditMessagesControl",Ug.a,[809,3,811]);rd.prototype.T4a=function(){return this.cellRange};Object(Jb.a)(rd,"MacroRecorderRangeDataValidationChangedPayload",null,[428]);var pk=b(66),bk=Kj.a;Am($c,bk);$c.prototype.CVd=function(){var f={};f=(f.key=this.Hd,f);this.initializeAndShow(oe.a.instance.fa(1623),this.f8c,f);ld.ULS.sendTraceTag(537163271,0,50,"DataValidationEditDialogDeprecated dialog opened.")};$c.prototype.dispose=function(){this.disposed||(this.dhc=this.pnc=this.g4=
null,Ag.a.Fa(this.tEb),this.tEb=null,rh.b(this.$)&&rh.b(this.$).ZWd("DataValidationDialogCorellation"),bk.prototype.dispose.call(this),this.disposed=!0)};$c.prototype.Kv=function(f){bk.prototype.Kv.call(this,f);this.Bc(2,oe.a.instance.fa(1624));f=this.aW(2);var D=this.aW(1),N=this.aW(0),fa=D.parentNode;fa.appendChild(f);fa.appendChild(D);fa.appendChild(N);f.parentNode.classList.add(ge.Ffh);f.classList.add(ge.Efh);f=document.getElementById("dataValidationTabsId");D=new jf(this.$,document.createElement("div"),
this.jda);N=new te(document.createElement("div"),this.jda);fa=new me(document.createElement("div"),this.jda);this.Kgi(D,N,fa);var Ia;this.tEb=new Qd(f,(Ia=new Ab.a,Ia.add(D),Ia.add(N),Ia.add(fa),Ia));this.tEb.lVf();this.OV=document.getElementById("validationErrorMessageId");this.CBa();rh.b(this.$)&&rh.b(this.$).LWd("DataValidationDialogCorellation")};$c.prototype.qP=function(){bk.prototype.qP.call(this);document.getElementById(this.vi("WACDialogPanel")).classList.add(ge.Gfh)};$c.prototype.lka=function(){return jf.lka()};
$c.prototype.lhd=function(){return"validationErrorMessageId"};$c.prototype.Kgi=function(f,D,N){this.g4=f;this.dhc=D;this.pnc=N};$c.prototype.dsj=function(){function f(){return new rd(D.selectedRanges,N)}var D=this,N={};N.IsClearAll=this.Bla;N.Command=this.command;N.RuleType=this.Hd.ruleType;N.ConditionType=this.Hd.VB;N.IsIgnoreBlank=this.Hd.Z5;N.IsInCellDropDown=this.Hd.a6;N.LowerBoundary=this.Hd.JO;N.UpperBoundary=this.Hd.LO;N.IsAlertBlocking=this.Hd.L_;N.IsShowErrorAlert=this.Hd.n6;N.IsShowInputMessage=
this.Hd.o6;N.AlertTitle=this.Hd.MU;N.AlertMessage=this.Hd.LU;N.InputTitle=this.Hd.RF;N.InputMessage=this.Hd.tW;N.ShouldIgnoreFormulaError=this.mOa;var fa=this.$.na.ta.fc();Sd.a(this.$.userOperationManager,function(Ia,pb,Wb){return jc(D.$.na.ta,D.selectedRanges,N,Pg.b(Ia,D.ZCd),Pg.a(pb),Wb,fa)},function(Ia){return new Mf.a(121,0,Ia,void 0,f)},null)};$c.prototype.YDj=function(f){return 1577787509===f};$c.prototype.fzj=function(f){this.OV.innerText=f;this.jA(this.aW(0));this.mOa=!0};$c.prototype.TCe=
function(){this.mOa=!1;this.OV.innerText=""};$c.prototype.Zgd=function(f){switch(f){case 1173235830:return oe.a.instance.fa(1673);case 43935303:return oe.a.instance.fa(1674);case -1323438439:return oe.a.instance.fa(1676);case 2112020473:return oe.a.instance.fa(1670);case -219503282:return oe.a.instance.fa(1671);case 1689335445:return oe.a.instance.fa(1672);case 2146493810:return oe.a.instance.fa(1675);case -2104909922:return String.format(oe.a.instance.Bb(104),this.g4.cxb(this.Hd.ruleType,this.Hd.VB),
this.g4.Qjd(this.Hd.ruleType,this.Hd.VB));case -869372599:return String.format(oe.a.instance.Bb(103),this.g4.cxb(this.Hd.ruleType,this.Hd.VB));case -1181828368:return oe.a.instance.fa(1678);case -758480861:return oe.a.instance.fa(1679);case -13729088:return oe.a.instance.fa(1680);case -846654055:return oe.a.instance.fa(1681);case 751854001:return oe.a.instance.fa(1682);case -453846397:return oe.a.instance.fa(1683);case 1102013489:return oe.a.instance.fa(1684);case 835813260:return oe.a.instance.fa(1685);
case 1577787509:return oe.a.instance.fa(1686);case 2083564019:return oe.a.instance.fa(1677);default:ld.ULS.sendTraceTag(537163265,0,15,"DataValidationEditDialogDeprecated.GetDataValidationServerErrorString - unexpected error: {0}.",f.toString())}return null};$c.prototype.mab=function(){ld.ULS.sendTraceTag(537163264,0,50,"DataValidationEditDialogDeprecated 'Ok' was clicked.");this.Mcc();var f=this.O1d();var D=f.errorString;var N=f.Kq;if(!f.returnValue)return this.Ss(D),this.pma("OkInvalidByClient",
N),!1;this.dsj();return!0};$c.prototype.Yma=function(){this.Mcc();this.pma("Cancel","None");this.hide()};$c.prototype.Bza=function(){ld.ULS.sendTraceTag(537163235,0,50,"DataValidationEditDialogDeprecated 'ClearAll' was clicked.");this.mOa?this.TCe():this.$2c();this.vlj();this.Bla=!0};$c.prototype.GX=function(f){var D={};f=(D.ButtonType=$c.oja(f),D.DialogName=this.Cc,D.Location="dialog",D.NumberOfSelectedRanges=We.g(this.$).ga.va.zL,D);rh.b(this.$).he(wb.a.c8b,f)};$c.prototype.vlj=function(){this.xTb=
new Mb;this.CBa()};$c.prototype.CBa=function(){this.pnc.CBa(this.Hd);this.dhc.CBa(this.Hd);this.g4.CBa(this.Hd)};$c.prototype.Mcc=function(){this.g4.arb(this.Hd);this.pnc.arb(this.Hd);this.dhc.arb(this.Hd)};$c.prototype.pma=function(f,D){var N={};$c.Qtb(this.Hd,N);N.o=f;N.p=D;N.n=this.Bla;this.qh&&(this.qh.stop(),N.q=this.qh.id);$f.b().Te(49,N,!0)};$c.prototype.jQb=function(f,D){var N;var fa=N=null;if(!f)return D?(N=String.format(oe.a.instance.Bb(104),this.g4.cxb(this.Hd.ruleType,this.Hd.VB),this.g4.Qjd(this.Hd.ruleType,
this.Hd.VB)),fa="DataValidationEditNoMinMaxError"):(N=String.format(oe.a.instance.Bb(103),this.g4.cxb(this.Hd.ruleType,this.Hd.VB)),fa="DataValidationEditNoValueError"),{returnValue:!1,errorString:N,Kq:fa};if(f.length>dc.gcg)return N=oe.a.instance.fa(1677),{returnValue:!1,errorString:N,Kq:fa};if(Df.d(f))return{returnValue:!0,errorString:N,Kq:fa};if(1===this.Hd.ruleType||2===this.Hd.ruleType||6===this.Hd.ruleType){if(!Ba.a.f6(f))return N=oe.a.instance.fa(1670),{returnValue:!1,errorString:N,Kq:fa};
if(1===this.Hd.ruleType&&!Ba.a.isInteger(f))return N=oe.a.instance.fa(1671),{returnValue:!1,errorString:N,Kq:fa};if(6===this.Hd.ruleType){if(!Ba.a.isInteger(f))return N=oe.a.instance.fa(1671),{returnValue:!1,errorString:N,Kq:fa};if(0>parseInt(f,10))return N=oe.a.instance.fa(1672),{returnValue:!1,errorString:N,Kq:fa}}}return{returnValue:!0,errorString:N,Kq:fa}};$c.prototype.O1d=function(){var f=this,D;var N=D=null;if(this.Bla||0===this.Hd.ruleType)return{returnValue:!0,errorString:D,Kq:N};var fa=(0===
this.Hd.VB||1===this.Hd.VB)&&3!==this.Hd.ruleType&&7!==this.Hd.ruleType;return!function(){var Ia=f.jQb(f.Hd.JO,fa);D=Ia.errorString;N=Ia.Kq;return Ia}().returnValue||fa&&!function(){var Ia=f.jQb(f.Hd.LO,fa);D=Ia.errorString;N=Ia.Kq;return Ia}().returnValue?{returnValue:!1,errorString:D,Kq:N}:fa&&(1===this.Hd.ruleType||2===this.Hd.ruleType||6===this.Hd.ruleType)&&!Df.d(this.Hd.JO)&&!Df.d(this.Hd.LO)&&parseFloat(this.Hd.JO)>parseFloat(this.Hd.LO)?(D=oe.a.instance.fa(1675),N="DataValidationEditMaximumLessMinimumError",
{returnValue:!1,errorString:D,Kq:N}):{returnValue:!0,errorString:D,Kq:N}};$c.oja=function(f){switch(f){case 0:return"Cancel";case 1:return"Ok";case 2:return"ClearAll";default:return ld.ULS.shipAssertTag(537163234,0,!1,"DataValidationEditDialogDeprecated.DialogButtonToString: Unknown DialogButton"),"Unknown"}};$c.Qtb=function(f,D){D.a=hc(f.ruleType);D.b=cc(f.VB);D.c=!!f.JO;D.d=!!f.LO;D.e=f.Z5;D.f=f.a6;D.g=f.o6;D.h=!!f.RF;D.i=!!f.tW;D.j=f.n6;D.k=f.L_;D.l=!!f.MU;D.m=!!f.LU};uk.Object.defineProperties($c.prototype,
{Hd:{configurable:!0,enumerable:!0,get:function(){return this.xTb}},Cc:{configurable:!0,enumerable:!0,get:function(){return"DataValidationEditDialog"}},onCommitDialogHandler:{configurable:!0,enumerable:!0,get:function(){var f=this;return function(){f.GX(1);f.mab()}},set:function(f){Object(pk.b)($c.prototype,this,"onCommitDialogHandler",f)}},canBePreempted:{configurable:!0,enumerable:!0,get:function(){return!1}},B3b:{configurable:!0,enumerable:!0,get:function(){return 3===this.g4.a5g}}});Object(Jb.a)($c,
"DataValidationEditDialogDeprecated",Kj.a,[]);kc.prototype.HIa=function(f,D,N,fa){ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataValidationReactDialog",!1)?(new pd(f,D,N,fa)).CVd():(new $c(f,D,N,fa)).CVd()};kc.prototype.H8g=function(f,D){var N=new ph.StandardDialog;N.lc=3;N.RBa(f.yb.q_,oe.a.instance.fa(1668),D)};kc.prototype.J8g=function(f,D){var N=new ph.StandardDialog;N.lc=1;N.$X(f.yb.q_,oe.a.instance.fa(1669),D)};Object(Jb.a)(kc,"DataValidationEditDialogFactory",null,[754]);var vk=
Mc.a;Am(Jf,vk);Jf.prototype.Qd=function(){this.Jd([new za(this.$,new kc)])};Jf.ka=function(f){Mc.a.je(245,new Jf(f))};Object(Jb.a)(Jf,"DataValidationEditCommandHandlerFactory",Mc.a,[]);pe.Smg='<div id="WACDialogRow" class="WACDialogRow">\r\n\t\t\t\t\t<div id="WACDialogIconPanel" class="WACDialogIconPanel"></div>\r\n\t\t\t\t\t<div id="WACDialogTextPanel" class="WACDialogTextPanel" style="padding-right: 30px;">\r\n\t\t\t\t\t\t<div id="WACDialogErrorMessage"></div>\r\n\t\t\t\t\t\t<br>\r\n\t\t\t\t\t\t<div id="WACDialogErrorReportMessage"> </div>\r\n\t\t\t\t\t\t<br>\r\n\t\t\t\t\t\t<div id="WACDialogErrorTextPrompt" ></div> \r\n\t\t\t\t\t\t<textarea id="WACDialogInput" class="WACDialogInput" rows="5" style="margin-bottom: 10px; margin-top: 9px; overflow: auto;" maxlength="256"></textarea>\r\n\t\t\t\t\t\t<div id = "WACDialogSendFileCheckboxContainer" class="WACDialogRow" >\r\n\t\t\t\t\t\t<input type="checkbox" id="WACDialogSendFileCheckbox">\r\n\t\t\t\t\t\t<span id="WACDialogSendFileCheckboxText">text</span>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<a id="WACDialogPrivacyText"> </a> \r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>';
Object(Jb.a)(pe,"FileUploadDialogHTML",null,[]);var lj=b(156),zi=Yi.a;Am(Xe,zi);Xe.prototype.zi=function(f,D,N,fa,Ia){Ia=void 0===Ia?!0:Ia;this.vyd=void 0===fa?!1:fa;this.$Ej(D);this.Rrf=f;Ia&&Gg.AFrameworkApplication.zG(f)};Xe.prototype.$Ej=function(f){if(Xe.Yy)this.LGj(f);else{var D={};D[Xe.UWg]=f;D[Xe.$Wg]=CommonUIStrings.l_SendFileErrorReportMessage;D[Xe.aXg]=CommonUIStrings.l_SendFileErrorReportTextCaption;D[Xe.W0c]="";D[Xe.XWg]=CommonUIStrings.l_UserReportLinkText;D[Xe.R2b]=!0;this.initializeAndShow(CommonUIStrings.l_DefaultDialogTitle,
Object(Nh.a)(this,this.Rwi,"legacyDialogHandler"),D);this.UX(Xe.fXg)}};Xe.prototype.LGj=function(f){var D={},N={},fa={},Ia={},pb={};f=(pb.id=this.Ve,pb.bodyControls=(Ia.reportErrorCheckboxProps=this.vyd?(D.label=CommonUIStrings.l_UserReportLinkText,D):null,Ia.textAreaProps=this.Gsf?{}:null,Ia.privacyStatementLinkProps=(fa.text=CommonUIStrings.l_PrivacyStatement,fa.handler=(N.href=Gg.AFrameworkApplication.Kna,N.target="_blank",N),fa),Ia),pb.errorMessage=f,pb.errorReportMessage=CommonUIStrings.l_SendFileErrorReportMessage,
pb.errorTextPrompt=CommonUIStrings.l_SendFileErrorReportTextCaption,pb);this.initializeAndShow(CommonUIStrings.l_DefaultDialogTitle,Object(Nh.a)(this,this.PJd,"reactDialogHandler"),f)};Xe.prototype.Y$a=function(){if(!Xe.Yy){var f=document.getElementById(Xe.cXg);f&&(f.className=Xe.bXg,f.appendChild(lj.createClusteredImage(32,32,Xe.ZWg,null,!0,CommonUIStrings.l_DialogError)));if(f=document.getElementById(Xe.dXg))f.innerText=CommonUIStrings.l_PrivacyStatement,f.href=Gg.AFrameworkApplication.Kna,ni.a.addHandler(f,
"click",Object(Nh.a)(this,this.sVi,"onPrivacyClickHandler"));this.Gsf||(f=document.getElementById(Xe.W0c))&&f.parentNode&&f.parentNode.removeChild(f);this.vyd||(f=document.getElementById(Xe.WWg))&&f.parentNode&&f.parentNode.removeChild(f)}};Xe.prototype.qP=function(){Xe.Yy||(zi.prototype.qP.call(this),document.getElementById(this.vi("WACDialogPanel")).style.width=String.format("{0}px",400))};Xe.prototype.Rwi=function(f,D){var N=D[Xe.W0c]||"",fa=!0;void 0!==D[Xe.R2b]&&null!==D[Xe.R2b]&&(fa=D[Xe.R2b]);
this.Cw(f,N,fa)};Xe.prototype.PJd=function(f,D){this.Cw(f,D.text||"",D.reportErrorChecked)};Xe.prototype.Cw=function(f,D,N){this.Krf&&(N&&ld.ULS.sendTraceTag(5768786,306,50,"Error Report sent for errorCode:{0}",this.Rrf),this.Krf(f,D,N))};Xe.prototype.sVi=function(f){Gg.AFrameworkApplication.Ib.Be(Dg.a.xAa,2,f)};uk.Object.defineProperties(Xe.prototype,{canBePreempted:{configurable:!0,enumerable:!0,get:function(){return!1}}});uk.Object.defineProperties(Xe,{Yy:{configurable:!0,enumerable:!0,get:function(){return Gg.AFrameworkApplication.sa.Qa.Tw&&
Gg.AFrameworkApplication.sa.Qa.Cqi}}});Xe.UWg="WACDialogErrorMessage";Xe.$Wg="WACDialogErrorReportMessage";Xe.aXg="WACDialogErrorTextPrompt";Xe.W0c="WACDialogInput";Xe.dXg="WACDialogPrivacyText";Xe.cXg="WACDialogIconPanel";Xe.ZWg="CancelRequest_32x32x32";Xe.bXg="WACDialogIcon";Xe.fXg="WACDialogTextPanel";Xe.R2b="WACDialogSendFileCheckbox";Xe.WWg="WACDialogSendFileCheckboxContainer";Xe.XWg="WACDialogSendFileCheckboxText";Xe.YWg="FileUploadErrorDialog";Object(Jb.a)(Xe,"FileUploadErrorDialog",Yi.a,[]);
var Rk=di.a;Am($e,Rk);$e.prototype.nIg=function(f){this.addHandler("fileCollectionComplete",f)};$e.prototype.cgj=function(f){this.removeHandler("fileCollectionComplete",f)};$e.prototype.b3g=function(f,D,N){this.QMf=D;this.HH=f;this.nIg(N);Gg.AFrameworkApplication.Kna=this.$.workbookContext.FullDocumentInfo.PrivacyUrl;f=new Xe(this.c3g);Gg.AFrameworkApplication.Ib.ic(Dg.a.xAa,Zg.a.frame,$e.A6i);f.zi(0,"",null,!1,!1)};$e.prototype.Pej=function(f){this.cgj(f)};$e.A6i=function(f,D,N,fa,Ia){ni.a.cu(Ia);
Gg.AFrameworkApplication.Kna&&ca.HelperMethods.wf(Gg.AFrameworkApplication.Kna,void 0,void 0,"FileCollectionOperation.PrivacyUrl");return 32};Object(Jb.a)($e,"FileCollectionOperation",di.a,[752,3]);var Lj=lh.a;Am(zc,Lj);zc.prototype.create=function(){var f=this;ud.TaskExtensions.Ba(mf.GetServiceTaskFactory.create(this.$.da,155,this.la,this.ub),function(){f.Eb(f.oFh)},this.la,3)};zc.prototype.dispose=function(){Ag.a.Fa(this.ZTb);this.ZTb=null;Lj.prototype.dispose.call(this)};zc.ka=function(f){f.da.Ha(125,
new zc(f))};uk.Object.defineProperties(zc.prototype,{oFh:{configurable:!0,enumerable:!0,get:function(){return this.ZTb||(this.ZTb=new $e(this.$))}}});Object(Jb.a)(zc,"FileCollectionCommandHandlerFactory",lh.a,[]);var zj=b(1009),rj=b(189),Th=b(276),ck=b(1093);zd.cLh="GalleryGeneral";zd.eLh="GalleryNumber";zd.aLh="GalleryCurrency";zd.ZKh="GalleryAccounting";zd.hLh="GalleryShortDate";zd.dLh="GalleryLongDate";zd.jLh="GalleryTime";zd.fLh="GalleryPercentage";zd.bLh="GalleryFraction";zd.gLh="GalleryScientific";
zd.iLh="GalleryText";zd.yWg="ButtonComma";zd.buttonPercentage="ButtonPercentage";zd.keyboardNumber="KeyboardNumber";zd.keyboardCurrency="KeyboardCurrency";zd.keyboardDate="KeyboardDate";zd.keyboardTime="KeyboardTime";zd.keyboardPercentage="KeyboardPercentage";Object(Jb.a)(zd,"RibbonFormatKind",null,[]);var Uj=b(306),of=b(714),oi=b(713),si=b(712),ih=Uj.a;Am(jd,ih);jd.prototype.J3=function(f){return ih.prototype.J3.call(this,f)||this.yJh.J3(this.Ted,this.activeCell,this.format,this.kve,this.kLf,this.fLf,
this.T0b,this.iGa,this.clientCorrelationId,this.Gnb,this.Ujb)};jd.prototype.Bk=function(){var f=[];if(this.Sec)for(var D=Cl(this.Sec),N=D.next();!N.done;N=D.next())f.push(si.a(N.value));else f.push(new oi.a(this.format,this.Ted,this.activeCell));return function(){return new of.a(f)}};jd.prototype.Sfb=function(){var f={OperationType:0};f.FormatCellsMultiRange=this.Ted;f.ActiveCell=this.activeCell;f.Format=this.format;f.ApplyFormatOnPivotTableValueField=this.kve;f.PivotTableXluid=this.kLf;f.PivotTableFieldCaption=
this.fLf;return f};uk.Object.defineProperties(jd.prototype,{operationWorkingState:{configurable:!0,enumerable:!0,get:function(){return ye.EwaSettings.uc()?Object(pk.a)(jd.prototype,this,"operationWorkingState"):0}},Ur:{configurable:!0,enumerable:!0,get:function(){return this.Gnb}},a5:{configurable:!0,enumerable:!0,get:function(){return this.Ujb}},EEc:{configurable:!0,enumerable:!0,get:function(){return this.iGa}}});Object(Jb.a)(jd,"FormatCellsBatchOperation",Uj.a,[]);var L=b(210);fd.editCell="Edited";
fd.dependentCell="Dependents";Object(Jb.a)(fd,"RecalcPriorityGroupType",null,[]);var Ea=b(225),Ya=b(9);Object(Jb.a)(je,"RecalcAccuracyObject",null,[]);yd.string="String";yd.blank="Blank";yd.general="General";yd.dIh="Flexible";Object(Jb.a)(yd,"FormattedUnitKind",null,[]);Object(Jb.a)(Ae,"RecalcResultProcessingStatistics",null,[]);Object(Jb.a)(De,"RecalcedCellInfo",null,[]);var Vb=b(109),Vc=b(60),re=b(567);Hf.prototype.dispose=function(){this.calcManager=this.tBc=this.Jh=this.grid=this.$=null};Hf.prototype.LNf=
function(f){var D;if(f&&f.rangeDeltas){for(var N=this.Pda.length,fa=0;fa<f.rangeDeltas.length;fa++)(null===(D=f.rangeDeltas[fa])||void 0===D?0:D.data)&&void 0!==f.rangeDeltas[fa].data.value&&null!==f.rangeDeltas[fa].data.value&&void 0!==f.rangeDeltas[fa].range&&null!==f.rangeDeltas[fa].range&&Array.add(this.Pda,new De(f.rangeDeltas[fa],f.stateId,f.isFinished,f.priorityGroup));ld.ULS.sendTraceTag(574993422,0,50,"CalcResultProcessor.ProcessResults stateId={0}, priorityGroup={1}, recalcFinished={2}, cellsFromCalc={3}, initialCellsToRender={4}, recalcedCells={5}, lastSetCellInstantaneousOperation={6}",
f.stateId,f.priorityGroup,f.isFinished,f.rangeDeltas.length,N,this.Pda.length,this.lastSetCellInstantaneousOperation);!N&&this.Pda.length&&this.FFf(!1,0)}};Hf.prototype.Bdd=function(f,D,N,fa,Ia,pb,Wb){if(!D)return Object(re.a)("Null");var Nc=excelOnlineCalc.numfmt.renderCallback(fa,function(Xc){return gridRenderer.CanvasRendererGlobals.measureTextWidth(Xc,Ia,!0,ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase1",!1))},Wb),kd=f.renderValue(D,Nc);if(!excelOnlineCalc.util.isSuccess(kd))return Object(re.a)("Finalize");
fa=null;if(Wb=excelOnlineCalc.numfmt.isHashesValue(kd.value)){if(kd=f.renderHashesValue(kd.value,Nc),!excelOnlineCalc.util.isSuccess(kd))return Object(re.a)("Hashes")}else fa=Hf.KJh(D,kd.value);Nc=kd.value;f=excelOnlineCalc.numfmt.renderedValueToString(Nc);D=Fc(Nc);Nc=kf(Nc);return Object(re.d)({text:f,valueType:N,fontColor:Nc,Qm:pb,C$a:fa,horizontalAlignment:D,isHashesValue:Wb})};Hf.prototype.FFf=function(f,D){var N=this;this.$&&this.grid&&this.calcManager&&this.tBc&&this.calcManager.uq?(f&&(this.Ida=
this.tBc.Nef),this.d7i(this.grid,this.calcManager.uq,f,D),!this.Ida&&this.Pda.length?rg.Task.delay(0).CWRCT(function(fa){N.FFf(!0,fa.id);return!0},null,0,Vc.a.current):rg.Task.Sa(!0)):(ld.ULS.sendTraceTag(537162181,0,50,"CalcResultProcessor.OnRecalcResultsTask: one of the objects required for processing is null. Aborting..."),rg.Task.Sa(!1))};Hf.prototype.d7i=function(f,D,N,fa){var Ia=ca.HelperMethods.kc();for(N=new Ae(this.Pda.length,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,
void 0,this.Ida,void 0,void 0,void 0,N,void 0,fa,!0,0,0,0,0,0,0);0<this.Pda.length;){fa=ca.HelperMethods.kc()-Ia;if(!this.Ida||fa>this.Ida){N.numberOfCellsSkippedDueToTimeout=this.Pda.length;break}fa=Array.dequeue(this.Pda);if(Ve(fa,N)){var pb=Si.Range.kd(fa.rangeDelta.range.row+1,fa.rangeDelta.range.column+1);(pb=f.rc(pb))?Hf.vYg(fa.stateId,pb.cell)?(Hf.joc(f,pb,fa,N),this.IOg(D,pb,fa,N)):N.numberOfCellsUpdatedAlreadyByServer++:N.numberOfCellsWithNoFormattedCell++}}fa=Math.round(ca.HelperMethods.kc()-
Ia);this.hZj(fa);this.nMj(N,fa);this.Dkj(N)};Hf.prototype.IOg=function(f,D,N,fa){var Ia,pb,Wb,Nc,kd=Od(D,N),Xc=N.rangeDelta.data.formatted,Ie=Ad(N),Ze=Bc(N);f=this.Bdd(f,Xc,Ie,D.cell.tUa,D.cell.gja,kd,!1);if(Object(re.c)(f))if(this.ykc&&this.Tud){if(0===Ze||D.text!==f.value.text)this.Jh.I_a(D,f.value),N=we(N),this.Jh.V$c(D,this.lastSetCellInstantaneousOperation,2,N,!0,!0),fa.numberOfUpdatedCells++}else D.text!==f.value.text&&(this.Jh.I_a(D,f.value),N=we(N),this.Jh.V$c(D,this.lastSetCellInstantaneousOperation,
2,N,!0,!0),fa.numberOfUpdatedCells++);else switch(f.reason){case "Null":ye.EwaSettings.isChangeGateEnabled("OfficeVSO:6195588_fixGetValueOrDefaultDullscriptBug")?fa.numberOfRecalcedCellsWithoutFormattedValue=(null!==(Ia=fa.numberOfRecalcedCellsWithoutFormattedValue)&&void 0!==Ia?Ia:0)+1:fa.numberOfRecalcedCellsWithoutFormattedValue=null==fa.numberOfRecalcedCellsWithoutFormattedValue?0:fa.numberOfRecalcedCellsWithoutFormattedValue+1;break;case "Hashes":ye.EwaSettings.isChangeGateEnabled("OfficeVSO:6195588_fixGetValueOrDefaultDullscriptBug")?
fa.numberOfHashFormattedValues=(null!==(pb=fa.numberOfHashFormattedValues)&&void 0!==pb?pb:0)+1:fa.numberOfHashFormattedValues=null==fa.numberOfHashFormattedValues?0:fa.numberOfHashFormattedValues+1;break;case "Finalize":ye.EwaSettings.isChangeGateEnabled("OfficeVSO:6195588_fixGetValueOrDefaultDullscriptBug")?fa.newNumberFormatterFinalizeFailures=(null!==(Wb=fa.newNumberFormatterFinalizeFailures)&&void 0!==Wb?Wb:0)+1:fa.newNumberFormatterFinalizeFailures=null==fa.newNumberFormatterFinalizeFailures?
0:fa.newNumberFormatterFinalizeFailures+1}Object(re.b)(f)&&"Null"!==f.reason&&(ye.EwaSettings.isChangeGateEnabled("OfficeVSO:6195588_fixGetValueOrDefaultDullscriptBug")?fa.numberOfRecalcedCellsWithFormattedValue=(null!==(Nc=fa.numberOfRecalcedCellsWithFormattedValue)&&void 0!==Nc?Nc:0)+1:fa.numberOfRecalcedCellsWithFormattedValue=null==fa.numberOfRecalcedCellsWithFormattedValue?0:fa.numberOfRecalcedCellsWithFormattedValue+1);fa=0===Ze?D.cell.userInput:D.formulaBarText;Nc=Object(re.c)(f)?f.value.text:
"";N=Object(re.b)(f)?f.reason:"";ld.ULS.sendTraceTag(537162180,0,50,"CalcResultProcessor.ApplyRecalcResultOnCell: ({0}, {1}) 2nd pass formatting, success: {2}, reason: {3}, priority: {4}, ifmt: {5}, input: '{6}', prediction: '{7}',",D.range.top,D.range.left,f.success,N,Ze,D.cell.Qm,fa?Ba.a.ZJ(fa):"null",Nc?Ba.a.ZJ(Nc):"null")};Hf.prototype.hZj=function(f){this.Ida=Math.max(this.Ida-Math.max(f,1),0)};Hf.prototype.nMj=function(f,D){f.numberOfNonUpdatedCells=this.Pda.length;f.totalExecutionTime=D;f.newProcessingTimeLimit=
this.Ida;f.lastSetCellInstantaneousOperation=this.lastSetCellInstantaneousOperation};Hf.prototype.Dkj=function(f){f=Sys.Serialization.JavaScriptSerializer.serialize(f);ld.ULS.sendTraceTag(574993417,0,50,"CalcResultProcessor.ReportRecalcProcessingStatistics:{0}",f)};Hf.KJh=function(f,D){f=f.units;var N=D.units;if(f.length!==N.length)return ld.ULS.sendTraceTag(537162179,0,15,"CalcResultProcessor.FormattedValueToNumberFormatInformation: can't convert to NumberFormatInformation: units and finalized units don't have the same length!"),
null;D=[];for(var fa=-1,Ia=0;Ia<f.length;Ia++)switch(f[Ia].kind){case yd.blank:D.push.apply(D,Vb.h(" ",N[Ia].str.length));break;case yd.string:D.push(f[Ia].str);break;case yd.dIh:D.push("");fa=Ia;break;case yd.general:D.push(N[Ia].str);break;default:ld.ULS.sendTraceTag(537162178,0,15,"CalcResultProcessor.ProcessFormattedValue: unknown FormattedUnitKind!")}if(0>=fa||""===N[fa].str)return null;N={};N.Start=D.slice(0,fa).join("");N.Separator=f[fa].str;N.End=D.slice(fa+1,D.length).join("");return N};
Hf.kQh=function(f){return f&&f&&f.nu?f.nu.cK:Ya.a.Re};Hf.vYg=function(f,D){if(!D)return!1;D=Hf.kQh(D);return D===Ya.a.Re||D===f};Hf.joc=function(f,D,N,fa){var Ia=N.rangeDelta.data.value.toString(),pb=Ad(N),Wb=Od(D,N);Ia=new je(pb,Ia,Wb,N.priorityGroup);D.cell.joc(Ia,f.Da.iL);1===Bc(N)?fa.numberOfDependentRecalcedCellsInBatch++:fa.numberOfEditedRecalcedCellsInBatch++};Hf.CKe=20;Object(Jb.a)(Hf,"CalcResultProcessor",null,[839,3]);Object(Jb.a)(zf,"GetRibbonNumberFormatResult",null,[]);Ue.prototype.yLb=
function(f,D,N){var fa=D.Border;D=D.BorderFormat;var Ia=0,pb=!1;if(0===fa)f.cell.ruc(),this.ALd(f.cell.getRange());else{for(var Wb=0;3>=Wb;Wb++)Ue.xBj(f,N,Wb,fa)&&(Ia|=ca.HelperMethods.Q4a(Wb),this.h0d(f.cell.getRange(),Wb,D),pb=!0);ca.HelperMethods.fS(fa,16)&&!Df.c(f,0,N)&&(Ia|=2,this.h0d(f.cell.getRange(),0,D),pb=!0);ca.HelperMethods.fS(fa,32)&&!Df.c(f,2,N)&&(Ia|=4,this.h0d(f.cell.getRange(),2,D),pb=!0);pb&&(N=f.cell.nu.yf,ca.HelperMethods.fS(Ia,2)&&this.C6f(f,N,0)&&(Ia&=-3),ca.HelperMethods.fS(Ia,
1)&&this.B6f(f,N,1)&&(Ia&=-2),ca.HelperMethods.fS(Ia,4)&&this.C6f(f,N,2)&&(Ia&=-5),ca.HelperMethods.fS(Ia,8)&&this.B6f(f,N,3)&&(Ia&=-9),f.cell.setBorders(D,Ia,!1))}};Ue.prototype.GR=function(f,D){f=Ue.K_e(f,D);return f.isValidRange?(f=this.Da.fwa(f))&&f.length?f:null:null};Ue.prototype.ALd=function(f){for(var D=0;3>=D;D++){var N=Ue.K_e(f,D);if(N.isValidRange&&(N=this.Da.fwa(N))&&N.length)for(var fa=Ue.X4e(D),Ia=0;Ia<N.length;Ia++)N[Ia].HRa(fa)}};Ue.prototype.h0d=function(f,D,N){if(f=this.GR(f,D))for(var fa=
Ue.X4e(D),Ia=ca.HelperMethods.Q4a(fa),pb=0;pb<f.length;pb++){var Wb=f[pb];this.Aki(Wb,fa)&&Ue.setBorders(Wb,N,Ia,D,fa)}};Ue.prototype.Aki=function(f,D){var N=f.nu.yf,fa=f.getRange();fa=this.GR(fa,D);var Ia=!1,pb=!1,Wb=!1,Nc=!1;fa&&(Ia=Ue.W7a(fa,!0),pb=Ue.W7a(fa,!1),Nc=Ue.ssd(fa),Wb=1===fa.length?!0:!1);switch(D){case 0:return Ue.Sji(f,N,Nc,pb,Wb);case 1:return Ue.Pji(f,N,Nc,Ia,Wb);case 2:return Ue.Qji(f,N,Nc,Ia,Wb);case 3:return Ue.Rji(f,N,Nc,pb,Wb)}return!1};Ue.prototype.C6f=function(f,D,N){if(!f.cell.$N)return!1;
var fa=f.range,Ia=this.GR(fa,N),pb=Df.c(f,N,D),Wb=!1;D=0===N?fa.top<D.top:fa.left<D.left;!Ue.gBb(f.cell)&&Ia&&1!==Ia.length&&(Wb=(0===N?Ue.W7a(Ia,!0):Ue.W7a(Ia,!1))?!1:!0);return!pb&&Wb||D?!0:!1};Ue.prototype.B6f=function(f,D,N){var fa=f.cell,Ia=this.GR(fa.getRange(),N);f=Df.c(f,N,D);D=!1;if(Ia){var pb=Ue.W7a(Ia,!0),Wb=Ue.W7a(Ia,!1),Nc=pb&&!Wb;Wb=Wb&&!pb;1!==N||Ue.YBb(fa)?3!==N||Ue.UAb(fa)||Ue.EBj(fa,Ia,Wb,Nc)&&(D=!0):Ue.DBj(fa,Ia,pb,Wb)&&(D=!0)}return!f&&D||Ue.gBb(fa)?!0:!1};Ue.VTg=function(f,D,
N){var fa={};fa.LineStyle=Array(4);fa.LineStyle[N]=f.LineStyle[D];fa.Color=Array(4);fa.Color[N]=f.Color[D];return fa};Ue.Zff=function(f,D,N,fa,Ia){return ca.HelperMethods.fS(f,Ia)&&Df.c(D,N,fa)};Ue.xBj=function(f,D,N,fa){return Ue.Zff(fa,f,N,D,ca.HelperMethods.Q4a(N))||Ue.Zff(fa,f,N,D,64)||112===fa};Ue.setBorders=function(f,D,N,fa,Ia){D=Ue.VTg(D,fa,Ia);f.setBorders(D,N,!1)};Ue.K_e=function(f,D){switch(D){case 0:return new Si.Range(f.top-1,f.left,f.top-1,f.right,!1,!1);case 2:return new Si.Range(f.top,
f.left-1,f.bottom,f.left-1,!1,!1);case 1:return new Si.Range(f.bottom+1,f.left,f.bottom+1,f.right,!1,!1);case 3:return new Si.Range(f.top,f.right+1,f.bottom,f.right+1,!1,!1)}return f};Ue.X4e=function(f){switch(f){case 0:return 1;case 2:return 3;case 1:return 0;default:return 2}};Ue.W7a=function(f,D){for(var N=0;N<f.length;N++){var fa=f[N];if(fa.$N)return D?Ue.UAb(fa):Ue.YBb(fa)}return!1};Ue.gBb=function(f){var D=f.nu.yf,N=f.getRange();return f.$N&&(N.top<D.top||N.bottom>D.bottom||N.left<D.left||N.right>
D.right)?!0:!1};Ue.ssd=function(f){for(var D=0;D<f.length;D++)if(Ue.gBb(f[D]))return!0;return!1};Ue.DBj=function(f,D,N,fa){if(!f.$N){if(!N||Ue.ssd(D))return!0}else if(Ue.UAb(f)&&(1===D.length&&Ue.cPg(f,D[0])||!N))return!0;return fa};Ue.EBj=function(f,D,N,fa){if(!f.$N){if(!N||Ue.ssd(D))return!0}else if(Ue.YBb(f)&&(1===D.length&&Ue.dPg(f,D[0])||!N))return!0;return f.Wla||fa};Ue.Sji=function(f,D,N,fa,Ia){var pb=f.getRange();return Ue.UAb(f)?Ue.gBb(f)||Ia:D.top===pb.top||!fa||N};Ue.Pji=function(f,D,N,
fa,Ia){var pb=f.getRange();return Ue.UAb(f)?D.bottom===pb.bottom&&Ia:fa&&!N||D.bottom===pb.bottom};Ue.Qji=function(f,D,N,fa,Ia){var pb=f.getRange();return Ue.YBb(f)?Ue.gBb(f)||Ia:D.left===pb.left||!fa||N};Ue.Rji=function(f,D,N,fa,Ia){var pb=f.getRange();return f.Wla?!1:Ue.YBb(f)?D.right===pb.right&&Ia:fa&&!N||D.right===pb.right};Ue.UAb=function(f){return 0<f.getRange().right-f.getRange().left};Ue.YBb=function(f){return 0<f.getRange().bottom-f.getRange().top};Ue.dPg=function(f,D){f=f.getRange();D=
D.getRange();return f.top===D.top&&f.bottom===D.bottom};Ue.cPg=function(f,D){f=f.getRange();D=D.getRange();return f.left===D.left&&f.right===D.right};Object(Jb.a)(Ue,"BorderModelAccessorHelper",null,[]);He.prototype.Xdb=function(f,D,N,fa,Ia,pb){f&&(f.h8(D,N,void 0===Ia?!1:Ia,void 0===pb?!1:pb),f.verticalAlignment=fa)};He.prototype.yLb=function(f,D,N){this.iB||(this.iB=new Ue(this.Da,this.S3a));this.iB.yLb(f,D,N)};Object(Jb.a)(He,"FormatCellsActionModelAccessor",null,[836]);qd.prototype.isValid=function(){return this.Ol&&
this.uq?!(void 0===this.formatString||null===this.formatString):!1};qd.prototype.tWh=function(){return null!=this.HF?this.HF:this.formatString};uk.Object.defineProperties(qd.prototype,{HF:{configurable:!0,enumerable:!0,get:function(){return this.Ssg}},formatString:{configurable:!0,enumerable:!0,get:function(){if(this.uza)return this.uza;if(this.Sra)return this.Sra.formatString;if(!this.Ol)return null;if(null!=this.HF){var f=this.HF;return 0>f?(ld.ULS.shipAssertTag(537162126,0,!1,"NumberFormatHolder.FormatString: ifmt is negative!"),
null):(f=this.Ol.cda[f])?this.uza=f.FormatString:null}return null}},numberFormat:{configurable:!0,enumerable:!0,get:function(){return this.Sra?this.Sra:this.uq&&this.formatString?this.Sra=this.uq.createFormat(this.formatString,this.qWg).value:null}},qWg:{configurable:!0,enumerable:!0,get:function(){if(!this.Ol||null==this.HF||0>this.HF)return!1;var f=this.Ol.cda[this.HF];return f?f.Builtin:!1}}});Object(Jb.a)(qd,"NumberFormatHolder",null,[835]);var Pe=b(257);Object(Jb.a)(ne,"FormatCellInstantaneousResult",
null,[]);Object(Jb.a)(od,"FormatStringResult",null,[]);var hf=b(1256),Lf=b(566),Ff=b(202),Ng;(function(f){f.InvalidInput="invalid input";f.UnsupportedZeroResize="resizing to 0 - ignore";f.UnsupportedSkeletonInView="skeleton in view - ignore";f.NullSPD="ActiveSheetProcessedData is null";f.UnsupportedHiddenInRange="hiddens in resizeRanges";f.UnsupportedMergeCell="There's a merge cell across blocks in resizeRanges"})(Ng||(Ng={}));Object(Jb.b)("InstantaneousRowColumnResizeFailureReason",Ng);var Cg=b(326);
La.prototype.dispose=function(){Ag.a.tc([this.KTa,this.N3]);this.$=this.N3=this.KTa=null};La.prototype.SBa=function(f,D,N,fa,Ia,pb,Wb,Nc,kd){return this.PFj(f,D,N,void 0===Ia?!1:Ia,void 0===Nc?0:Nc,void 0===pb?"":pb,void 0===kd?null:kd)};La.prototype.V$c=function(f,D,N,fa,Ia,pb){f.cell.nu.fR|=fa;La.O4g(We.g(this.$),f,N,Ia);this.N3.lastSetCellInstantaneousOperation=D;pb&&We.g(this.$).Ri.D1(D,$h.BasicTelemetryCalculator.$R)};La.prototype.Kea=function(f,D,N,fa,Ia,pb){fa=void 0===fa?!1:fa;Ia=void 0===
Ia?null:Ia;var Wb=void 0===Wb?null:Wb;pb=(void 0===pb?null:pb)||f.ga.va.selectedRanges;if(!(-1690267012===D&&1<pb.length)){-1690267012===D&&ld.ULS.shipAssertTag(537162176,0,1===pb.length,"FormatCellsAction.ShowInstantaneousFormatting: targetRanges.Length = {0}",pb.length);var Nc=f.Daa("FormatCellsAction.ShowInstantaneousFormatting",pb);try{Nc.$$rst();for(var kd=!1;Nc.$$mn();){var Xc=void 0,Ie=Nc.$$cu().WF?f.WKb(Nc.$$cu().range):(Xc=new Ab.a,Xc.add(Nc.$$cu()),Xc);Xc={};for(var Ze=Cl(Ie),Sf=Ze.next();!Sf.done;Xc=
{whb:Xc.whb},Sf=Ze.next()){var ag=Sf.value;if(We.g(this.$).Nz&&ag&&Wb&&-1690267012===D&&(Xc.whb=ag.range,Xc.whb&&Wb.contains(Xc.whb)&&gg.a.all(pb,function(og){return function(Vg){return!af.c(Vg,og.whb)}}(Xc))))continue;if(!ag||Nc.Nb.contains(ag.range))if(this.T7f(D,ag,N,fa,Ia,Nc.$$cu().WF),kd||(f.Da.wW(),kd=!0),Ia)break}}}finally{Nc&&Nc.dispose()}}};La.prototype.I_a=function(f,D,N){if(N=void 0===N?null:N)N.Bxa=!0;N=!D.text;var fa=Ba.a.wjf(D.text),Ia,pb=f.WF?We.g(this.$).WKb(f.range):(Ia=new Ab.a,
Ia.add(f),Ia);Ia=Cl(pb);for(pb=Ia.next();!pb.done;pb=Ia.next())this.GOg(this.$,pb.value,D.text,D.horizontalAlignment,D.fontColor,D.Qm,f.cell.Qm,N,fa,D.valueType,D.C$a);f.cell.sEc()};La.prototype.Z1i=function(f,D,N,fa,Ia){Ia=void 0===Ia?null:Ia;try{var pb=af.D(D),Wb=af.D(N);if(f.Tb.X7a(pb)||f.Tb.X7a(Wb))return 8;if(-185374993!==fa&&this.jsi(f,pb,Wb))return 9;if(-185374993!==fa&&(f.Tb.i6(Wb)||f.Tb.vBb(pb)))return 10;if(1804571062!==fa&&f.Tb.Qla(Wb))return 11;if(this.Plh(Wb))return 12;if(this.$si(pb,
Wb))return 13;var Nc=this.$.Sb.Hc("UserAction","PasteInstantaneous");Nc.start();Lf.a(Nc);Ia&&$f.b().xC(Nc.id,Ia.id,"actions","actions");!pb.isSingle&&Wb.isSingle&&(Wb=La.expandRange(pb,Wb),f.ga.updateSelection(Wb,Wb,0));switch(fa){case 237279923:case 808159687:if(!this.q2i(pb,Wb))return 14;this.E5c(f,pb,Wb,!0,!1);break;case 1804571062:this.E5c(f,pb,Wb,!0,!1);break;case -185374993:this.E5c(f,pb,Wb,!1,!0);break;default:return 2}ld.ULS.sendTraceTag(537162146,0,50,"FormatCellsAction.PasteInstantaneous: Complete processing.");
return 1}catch(kd){return ld.ULS.sendTraceTag(537162145,0,10,"FormatCellsAction.PasteInstantaneous: failed with the following error: {0}",JSON.stringify(kd)),15}};La.prototype.I1g=function(f,D){f=Cl(f);for(var N=f.next();!N.done;N=f.next())this.i3c(N.value,!0,D)};La.prototype.i3c=function(f,D,N){N=void 0===N?"":N;if(f){var fa=We.g(this.$);if(D){if(D=fa.Pk("FormatCellsAction.ClearRangeInstantaneous",f),f=f.isSingle?null:f,D.$$mn()&&void 0!==D.$$cu()&&null!==D.$$cu())for(fa=Object.assign(new ta.a,{Text:""}),
this.SBa(D.$$cu(),fa,!1,void 0,cg.a.Lic(this.$),N,void 0,void 0,f);D.$$mn();)void 0!==D.$$cu()&&null!==D.$$cu()&&this.SBa(D.$$cu(),fa,!1,void 0,!1,N)}else this.Kea(fa,-1228228458,{},void 0,void 0,[f])}else ld.ULS.shipAssertTag(537162144,0,!1,"FormatCellsAction.ClearRangeInstantaneous: targetRange shouldn't be null")};La.prototype.vbj=function(f,D){if(!D){D=ca.HelperMethods.kc();var N=We.g(this.$),fa=N.Daa("FormatCellsAction.ReformatCells",f);try{fa.$$rst();for(var Ia=!1;fa.$$mn();){var pb=fa.$$cu().cell;
if(0===pb.cV||2===pb.cV)this.updateSpillInformation(pb,f),Ia||(N.Da.wW(),Ia=!0)}}finally{fa&&fa.dispose()}ld.ULS.sendTraceTag(537162143,0,50,"FormatCellsAction.ReformatCellsAfterGeometryChange: reformatting cells total time: {0}.",ca.HelperMethods.kc()-D)}};La.prototype.ufc=function(f,D){if(this.Gb){if(f.formulaBarText)return!Ba.a.equals(D.Text,f.formulaBarText,!1);var N=f.cell.formattedText;N=Pe.a(N,f.cell.getCellFont());return!gridRenderer.CanvasRendererGlobals.compareFormattedTexts(N,D).isEqual}return!Ba.a.equals(D.Text,
f.text,!1)};La.prototype.cZe=function(f){if(void 0===f||null===f)return new od(!1,"1234.56");f=new qd(this.Ol,this.uq,void 0,f);if(!f.isValid())return new od(!1,"1234.56");f=this.o4a({value:"1234.56",type:1},f,244,"12px sans-serif");return Object(re.b)(f)?new od(!1,"1234.56"):new od(!0,f.value.text)};La.prototype.QFj=function(f,D,N,fa){return Re(f,this,D,N,fa,!0)};La.prototype.S7f=function(f,D,N){if(!this.ufc(D,N))return Object(re.d)("Skip unchanged cell content");D=D.cell;var fa=new qd(this.Ol,this.uq,
D.Qm);N=this.eZe(N.Text,fa,D.tUa,D.gja,!0);if(Object(re.b)(N))f=N;else{N=N.value;fa=N.text;var Ia=N.valueType;fa=D.hasRichValueIcon?"Unsupported rich value icon":D.BT?ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EstimateWrapTextEditResize",!1)&&2==Ia&&'normal 11pt "calibri"'===D.gja&&D.CFe(fa)>=D.offsetWidth*Math.floor(D.offsetHeight/Ya.a.Htb)?"Unsupported wrapped text with long input":"Unsupported wrapped text":D.$Bb||null!=D.vUa&&0!==D.vUa?"Unsupported rotated text":!0;!0!==fa?f=
Object(re.a)(fa):(D.isCellWidthFixed?fa="Skip fixed width cell":(fa=N.valueType,fa=0===fa?"Skip empty cell value":2===fa?"Skip string cell value":D.$N&&!D.csi?"Skip merged cell":D.jAc?"Skip shrunk to fit":N.isHashesValue?"Skip hashes cell value":!0),!0!==fa?f=Object(re.d)(fa):(N=D.CFe(N.text),N>D.offsetWidth?(D=[D.getRange().clone()],f=Re(f,this,D,N,!1,!1),f=Object(re.b)(f)?f:Object(re.d)(N)):f=Object(re.d)("Column is wide enough")))}return f};La.prototype.FJh=function(f,D,N){var fa=Number.POSITIVE_INFINITY;
D=new qd(this.Ol,this.uq,D);if(!D.isValid())return new od(!1,f);var Ia={};Ia.value=f;Ia.type=1;N=this.o4a(Ia,D,fa,N);return Object(re.b)(N)?new od(!1,f):new od(!0,N.value.text)};La.prototype.updateSpillInformation=function(f,D){var N=f.getRange(),fa=!1;D=Cl(D);for(var Ia=D.next();!Ia.done;Ia=D.next())if(N.left===Ia.value.left){fa=!0;break}f.ZVj(fa)};La.prototype.PFj=function(f,D,N,fa,Ia,pb,Wb){var Nc=void 0;pb=void 0===pb?"":pb;Nc=void 0===Nc?1:Nc;Wb=void 0===Wb?null:Wb;var kd=new ne;kd.source=0;
kd.Bxa=!1;f.cell.erc=f.cell.Qm;var Xc=D.Text,Ie=!Xc,Ze=Ba.a.wjf(Xc);Ba.a.Co(Xc)&&(ld.ULS.shipAssertTag(537162142,0,!((void 0===Xc||null===Xc)&&void 0!==D.TextRuns&&null!==D.TextRuns),"FormatCellsAction.ShowInstantaneousDataEntryOnCellInternal: Text is null but TextRuns isn't"),D=Object.assign(new ta.a,{Text:""}),Xc="");f.cell.userInput=Xc;if(!this.ufc(f,D))return this.d_g(f,Ia,Ie,Ze,kd);N?this.WZg(f,Xc,this.$.workbookContext.DefaultHyperlinkStyle,kd):this.QZg(f,D,Xc,Ie,Ze,fa,kd,Wb);this.V$c(f,pb,
Ia,Nc,kd.Djc,kd.Bxa);return kd};La.prototype.d_g=function(f,D,N,fa,Ia){Ia.zjg=!0;Ia.Djc=!0;Ia.Bxa=!1;0===D&&We.g(this.$).Da.wW();0===f.cell.bAa&&(N?f.cell.h8(0,!1):fa&&f.cell.h8(1,!1));return Ia};La.prototype.WZg=function(f,D,N,fa){fa.Bxa=!0;f.insertHyperlink(D,L.a.ded(D),N)};La.prototype.QZg=function(f,D,N,fa,Ia,pb,Wb,Nc){Nc=void 0===Nc?null:Nc;Wb.Bxa=!1;var kd=f.cell;this.Ol||(this.Ol=this.$.da.Aa(268));this.VRj(this.Ol,kd.Qm);fa||Ia?this.SZg(f,fa,Ia,Wb):(fa=new qd(this.Ol,this.uq,kd.Qm),fa=this.eZe(N,
fa,kd.tUa,kd.gja,!1),Object(re.c)(fa)?(this.LCj(D.TextRuns,D.Fonts)&&this.UZg(f,D,fa.value),this.I_a(f,fa.value,Wb)):this.ykc&&this.Tud?this.$Zg(f,D.Text,Wb):this.a_g(f,D.Text),D=Object(re.c)(fa)?fa.value.text:"",Ia=Object(re.b)(fa)?fa.reason:"",ld.ULS.sendTraceTag(559724065,0,50,"FormatCellsAction.CellDataEntryCSE: ({0}, {1}) 1st pass formatting, success: {2}, reason: {3}, ifmt: {4}, input: '{5}', prediction: '{6}',",f.range.top,f.range.left,fa.success,Ia,kd.Qm,Ba.a.Fpb(kd.userInput),Ba.a.Fpb(D)));
kd.formulaBarText=N;pb&&this.zRj(this.Ol,f,N,Nc);Wb.Djc=!0};La.prototype.SZg=function(f,D,N,fa){fa.Bxa=!0;f.text="";f.formulaBarText="";f.cell.userInput="";this.x3b(f,null,null,D,N)};La.prototype.UZg=function(f,D,N){D.Text===N.text&&2===N.valueType&&(f.cell.formattedText=D)};La.prototype.$Zg=function(f,D,N){N&&(N.Bxa=!0);f.text=D;f.formulaBarText=D;this.x3b(f,1)};La.prototype.a_g=function(f,D){f.text=D;f.formulaBarText=D;this.x3b(f,1)};La.prototype.x3b=function(f,D,N,fa,Ia,pb){N=void 0===N?null:N;
fa=void 0===fa?!1:fa;Ia=void 0===Ia?!1:Ia;pb=void 0===pb?!1:pb;var Wb=f.horizontalAlignment;N=null!=N?N:f.verticalAlignment;0===f.cell.bAa&&(null!=D||fa||Ia||pb)&&(fa?Wb=0:Ia||pb?Wb=1:null!=D&&(Wb=D),this.Vva.Xdb(f,Wb,!1,N,!0))};La.prototype.VRj=function(f,D){(null===f||void 0===f?0:f.cda)&&D>=La.KHh&&D>f.cda.length-1&&(ld.ULS.sendTraceTag(537162141,0,50,"FormatCellsAction.TriggerSupportInformationRefresh: The cell has a missing format, ifmt:{0}. Triggering refresh...",D),f.WYe())};La.prototype.zRj=
function(f,D,N,fa){fa=void 0===fa?null:fa;if(void 0!==f&&null!==f)if(this.Ol.Fpd)ld.ULS.sendTraceTag(537162140,0,50,"FormatCellsAction.TriggerCalc: in manual mode - not recalcing");else{var Ia=this.$.da.Aa(266);Ia&&(this.N3.Ida=Hf.CKe,f&&(this.N3.Ida=f.Nef),Ia.KXg(D,N,Object(Nh.a)(this.N3,this.N3.LNf,"processResults"),fa))}};La.prototype.o4a=function(f,D,N,fa){var Ia=this.$.da.Aa(266);if(!Ia)return Object(re.a)("calcManager is null");if(!Ia.uq)return Object(re.a)("calcManager.NumberFormatter is null");
if(!this.Ol)return Object(re.a)("instantaneousManager is null");if(!D||!D.isValid())return Object(re.a)("numberFormatHolder is invalid or null");var pb=Ia.Sid(D);if(null===pb)return Object(re.a)("cellFormat is null");var Wb=Ia.uq,Nc=ae(f);if(void 0===Nc||null===Nc)return Object(re.a)("cellValue is null");Ia=excelOnlineCalc.calc.cellValueToReadOper(Ia.config.mathpack,Nc);if(void 0===Ia||null===Ia)return Object(re.a)("readOper is null");pb=Wb.applyFormat(pb,Ia);return excelOnlineCalc.util.isSuccess(pb)?
this.N3.Bdd(Wb,pb.value,f.type,N,fa,null!=D.HF?D.HF:-1,!1):Object(re.a)("NumberFormatter.ApplyFormat: "+JSON.stringify(pb.reason.kind))};La.prototype.eZe=function(f,D,N,fa,Ia){var pb=this.$.da.Aa(266);if(void 0===pb||null===pb)return Object(re.a)("calcManager is null");if(void 0===pb.uq||null===pb.uq)return Object(re.a)("calcManager.NumberFormatter is null");if(void 0===this.Ol||null===this.Ol)return Object(re.a)("instantaneousManager is null");if(void 0===D||null===D||!D.isValid())return Object(re.a)("numberFormatHolder is invalid or null");
if(this.ykc)return Object(re.a)("No main thread number formatter");var Wb=pb.Sid(D);if(void 0===Wb||null===Wb)return Object(re.a)("cellFormat is null");var Nc=pb.uq;f=Nc.parseEdit(f,Wb);if(!excelOnlineCalc.util.isSuccess(f))return Object(re.a)("ParseEdit failure: reason="+f.reason.kind+", features="+f.reason.features);if(f.value.kind===ck.a.formula)return Object(re.a)("Main thread - skipping formula edit");pb=excelOnlineCalc.numfmt.applyValueEdit(Nc,pb.localeInfo,Wb,f.value);if(!excelOnlineCalc.util.isSuccess(pb))return Object(re.a)("NumberFormatter.FormatValueEdit: "+
JSON.stringify(pb.reason.kind));Wb=f.value;ld.ULS.shipAssertTag(537162190,0,Wb.kind!==ck.a.formula,"CalcInterfaceAdapter.GetCellValueTypeFromParsedEdit: given parsed edit must be a value edit!");Wb=excelOnlineCalc.numfmt.getValueEditOperKind(Wb);f=0;switch(Wb){case 0:case 128:f=0;break;case 1:f=1;break;case 2:f=2;break;case 4:f=3;break;case 8:f=4;break;case 16:case 32:case 64:case 256:ld.ULS.sendTraceTag(537162189,0,15,"CalcInterfaceAdapter.OperKindToCellValueType: can't convert given OperKind {0} to a CellValueType",
Wb);break;default:ld.ULS.shipAssertTag(537162188,0,!1,"CalcInterfaceAdapter.OperKindToCellValueType: Unexpected oper kind {0}",Wb)}return this.N3.Bdd(Nc,pb.value,f,N,fa,null!=D.HF?D.HF:-1,Ia)};La.prototype.jsi=function(f,D,N){if(D.width<N.width)for(var fa=f.Pk("FormatCellsAction.IsSourceRangeLargerAndWithBorders",new Si.Range(D.top,D.left,D.bottom,D.left,!0,!0));fa.$$mn();){var Ia=fa.$$cu();if(Ia&&Ia.dMa())return ld.ULS.sendTraceTag(537162139,0,50,"FormatCellsAction.ShowInstantaneousFormattingFromRange: no instantenous."),
!0}if(D.height<N.height)for(f=f.Pk("FormatCellsAction.IsSourceRangeLargerAndWithBorders2",new Si.Range(D.top,D.left,D.top,D.right,!0,!0));f.$$mn();)if((D=f.$$cu())&&D.jMa())return ld.ULS.sendTraceTag(537162138,0,50,"FormatCellsAction.ShowInstantaneousFormattingFromRange: no instantenous."),!0;return!1};La.prototype.E5c=function(f,D,N,fa,Ia){for(var pb=D.rM().FirstRow,Wb=D.rM().LastRow,Nc=N.rM().LastRow,kd=pb,Xc=N.rM().FirstRow;Xc<=Nc;Xc++,kd++){kd>Wb&&(kd=pb);var Ie=D.rM();Ie.FirstRow=Ie.LastRow=
kd;var Ze=N.rM();Ze.FirstRow=Ze.LastRow=Xc;this.J7g(f,rj.a.DR(Ie),rj.a.DR(Ze),fa,Ia)}};La.prototype.q2i=function(f,D){var N=this.$.da.Aa(266);return void 0!==N&&null!==N?(N.EXg(f,D.topLeft,Object(Nh.a)(this.N3,this.N3.LNf,"processResults")),!0):!1};La.prototype.$si=function(f,D){var N=f.right-f.left+1;f=f.bottom-f.top+1;var fa=D.right-D.left+1;D=D.bottom-D.top+1;if(fa>N&&D>f){if(!(fa%N&&D%f))return!0}else if(fa===N&&D>f){if(!(D%f))return!0}else if(fa>N&&D===f&&!(fa%N))return!0;return!1};La.prototype.Plh=
function(f){if(ye.EwaSettings.ma(103)){f=We.g(this.$).e2(f).gridView.getRangeInformation(f);f=Cl(f);for(var D=f.next();!D.done;D=f.next())if(D=D.value,Object(td.a)(Th.DynamicArrayRange,D)&&!Object(k.a)(Th.DynamicArrayRange,D).$nc)return!0}return!1};La.prototype.sGe=function(f,D,N,fa,Ia,pb){D=Cl(D);for(var Wb=D.next();!Wb.done;Wb=D.next())Wb=Wb.value,N&&(this.N7g(Wb,Ia),Wb.setCell(!0)),fa&&(pb=this.Z8h(Ia,Wb)),pb||(f.Da.wW(),pb=!0);return pb};La.prototype.mVh=function(f,D,N){D=new Si.Range(D,N,D,N,
!0,!0);return f.rc(D)};La.prototype.J7g=function(f,D,N,fa,Ia){if(N){this.KTa&&N.equals(this.KTa.range)||(Ag.a.Fa(this.KTa),this.KTa=f.Pk("FormatCellsAction.CopyBetweenRows",N));N=this.KTa;N.$$rst();var pb=!1;if(ye.EwaSettings.getBooleanFeatureGate(Cg.a.jJe,!1)){var Wb=D.rM().FirstColumn+1,Nc=D.rM().LastColumn+1;D=D.rM().FirstRow+1;for(var kd=Wb;N.$$mn();){kd>Nc&&(kd=Wb);var Xc=this.mVh(f,D,kd);kd+=1;var Ie=void 0,Ze=N.$$cu().WF?f.WKb(N.$$cu().range):(Ie=new Ab.a,Ie.add(N.$$cu()),Ie);Xc&&(pb=this.sGe(f,
Ze,fa,Ia,Xc,pb));d.lastOrDefault(Ze)}}else for(Wb=f.Pk("FormatCellsAction.CopyBetweenRows2",D);N.$$mn();)Wb.$$mn()||(Wb.$$rst(),Wb.$$mn()),Nc=Wb.$$cu(),D=void 0,kd=N.$$cu().WF?f.WKb(N.$$cu().range):(D=new Ab.a,D.add(N.$$cu()),D),Nc&&(pb=this.sGe(f,kd,fa,Ia,Nc,pb)),d.lastOrDefault(kd)}else ld.ULS.sendTraceTag(537162137,0,50,"FormatCellsAction.CopyBetweenRows: targetRange is null")};La.prototype.m8f=function(){var f=Cf.a.ed(1,0,0,641,0,104573951,"PivotTableContextMenuOperationFailure");Og.a(this.$).zi(f)};
La.prototype.sDi=function(f,D){var N={ValidMembers:32},fa=D.NumberFormat;switch(f){case 1890566896:if(1001===fa||1002===fa||1003===fa){N.NumberFormat=14;N.NumberFormatOptions={};switch(fa){case 1001:N.NumberFormatOptions.TimeType=2;break;case 1002:N.NumberFormatOptions.DateType=7;break;case 1003:N.NumberFormatOptions.DecimalPlaces=0}N.NumberFormatOptions.NumberFormatCategory=this.vOg(fa)}else N.NumberFormat=fa;break;case 1886928607:N.NumberFormat=13;break;case -992833457:N.NumberFormat=11;break;case 218524921:N.NumberFormat=
12;break;case 996232352:N.NumberFormat=14;N.NumberFormatOptions=Object.assign(new zj.a,{DecimalPlaces:0});N.NumberFormatOptions.NumberFormatCategory=6;break;default:return D}return N};La.prototype.formatCells=function(f,D,N,fa,Ia,pb,Wb){fa=void 0===fa?null:fa;Ia=void 0===Ia?null:Ia;pb=void 0===pb?null:pb;Wb=void 0===Wb?null:Wb;var Nc=this.$.Sb.Hc("UserAction","FormatCellsInstantaneous, command = "+$f.b().yi(f)),kd=this.$.Sb.Kh("UserAction","FormatCellsInstantaneousFrame");kd.start();Lf.a(kd);var Xc=
$f.b().yi(f),Ie=this.$,Ze=We.g(Ie),Sf=Ze.ga.va,ag=Ia||Sf.selectedRanges,og=Vb.g(ag,function(Ej){return Ej.OQ});Xc=String.format("{0}, cellCount={1}",Xc,og);We.g(this.$).Ri.t8(1,Nc.id,Xc);ag=af.r(ag,this.$);Sf=Sf.activeCell;Xc=-168056295===N.command;var Vg=og=null;if(Xc){Vg=Ze.Tb.qp(Sf);if(!Vg){this.m8f();return}og=Vg.yda.substring(1,Vg.yda.length-1);Vg=Vg.Hcc();if(!Vg){this.m8f();return}Vg=Vg.Caption}Ze.Lg.xH(!1,!0);var Hh=af.o(Sf,Ie),ji=Ie.na.ta.fc(!0),kj=this.sDi(N.command,D);Xc||this.Kea(Ze,f,
D,!1,fa,Ia);Nc.stop();We.g(this.$).Ri.D1(Nc.id,$h.BasicTelemetryCalculator.$R);N.Qhi=ff.a.Ra.Ob;fa=this.$.Sb.Hc("UserAction","FormatCellsUserAction");this.Lzi(f,N.taskId,D,ag,Sf,fa.id);$f.b().xC(Nc.id,fa.id,"actions","actions");$f.b().xC(kd.id,fa.id,"actions","actions");ye.EwaSettings.uc()?Ie.userOperationManager.jc(new jd(this,ag,Hh,kj,Xc,og,Vg,ji,fa,Nc.id,64,pb,Wb),N):Ie.userOperationManager.jc(new jd(this,ag,Hh,kj,Xc,og,Vg,ji,fa,Nc.id,0,pb,Wb),N)};La.prototype.J3=function(f,D,N,fa,Ia,pb,Wb,Nc,
kd,Xc,Ie){var Ze=this,Sf=this.$;return function(ag,og,Vg){Sf.Qy();ag=[ag,Ze.ZPi];og=[og];Xc&&ag.push(Xc);Ie&&og.push(Ie);return Se.q(Sf.na.ta,f,D,N,fa,Ia,pb,!1,Pg.b.apply(null,ag),Pg.a.apply(null,og),Vg,kd,Wb,Nc)}};La.prototype.T7f=function(f,D,N,fa,Ia,pb,Wb){Wb=void 0===Wb?null:Wb;if(D&&N){var Nc=N.Font,kd=N.HorizontalAlignment,Xc=N.VerticalAlignment;N.ValidMembers&2||(kd=D.horizontalAlignment);N.ValidMembers&1||(Xc=D.verticalAlignment);var Ie=0!==kd;La.Xji(f)&&0===kd&&(kd=this.k3e(D));var Ze=!1;
switch(f){case -394785302:this.Vva.Xdb(D,kd,Ie,0);break;case 1041132226:this.Vva.Xdb(D,kd,Ie,1);break;case -571165336:this.Vva.Xdb(D,kd,Ie,2);break;case -1150205178:case -1142465846:case -286432209:this.Vva.Xdb(D,kd,Ie,Xc,!1,!1);break;case 1650812936:this.setFillColor(D,N,pb);break;case -287251124:D.bold=Nc.Bold;break;case -1690267012:We.g(this.$).ga.va.Wg&&(Nc=ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellUnmergeWithBorderScenariosCse",!1)?Wb?Wb:We.g(this.$).ga.va.xd:We.g(this.$).ga.va.xd,
this.Vva.yLb(D,N,Nc));break;case 1970784898:N=Ea.a.pq(D.color,D.backgroundColor);if(sg.a.compare(N,sg.a.red)&&(Ba.a.f6(D.text)||Ba.a.gaf(D.text)))break;Nc=sg.a.MH(Nc.FontColor);D.color=Ff.c(Ea.a.NG(Nc));break;case -1925065947:D.italic=Nc.Italic;break;case -1293291468:N=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation");this.Nm?(D.QLb(Nc.FontName,N,"ShowInstantaneousFormattingOnCell"),D.M2f(Nc.FontScheme)):D.QLb(Nc.FontName,N,"ShowInstantaneousFormattingOnCell");break;
case 862890474:case 963349338:D.fontSize=Nc.FontSize;this.$.Cf();break;case -1077965542:D.fontSize=Nc.FontSize;break;case 1764140053:D.underline=Nc.Underline;break;case -1685033574:D.doubleUnderline=Nc.DoubleUnderline;break;case -1590502662:D.fontStrikethrough=Nc.Strikethrough;break;case -848953656:case 2045211913:Ze=D.Mrb();break;case 2105621672:Nc=Object(k.a)(hf.a,Ia);if(!Nc)break;N=sg.a.EKh(Nc.color);D.color=Ff.c(Ea.a.NG(N));this.rve(D,Nc.uza);break;case -1409276245:this.rve(D,N.NumberFormatOptions.CustomFormatString);
break;case 1890566896:this.FOg(D,N);break;case -1228228458:D.Mrb();D.clearFormat();this.lZc(D,0);Ze=!0;break;case -730106152:D.clearFormat();this.lZc(D,0);break;case 932244020:this.suj(D,N,pb);break;case -1942512156:case -1920201820:this.kwj(D,N)}fa||(Ze?D.tcb(!0):D.setCell(!0))}else ld.ULS.shipAssertTag(537162135,0,!D,"FormatCellsAction.ShowInstantaneousFormattingOnCell empty cellToFormat"),ld.ULS.shipAssertTag(537162134,0,!N,"FormatCellsAction.ShowInstantaneousFormattingOnCell empty cellFormat")};
La.prototype.N7g=function(f,D){f&&D?(f.Urb(D),f.D3c(D),this.lZc(f,D.cell.Qm)):ld.ULS.sendTraceTag(537162133,0,10,"FormatCellsAction.CopyFormattingBetweenCells:cellToFormat & sourceCell should not be null")};La.prototype.lZc=function(f,D){if(0>D)this.k0("ApplyNumberFormatIndexOnCell",f,!1,"ApplyNumberFormatIndexOnCell: negative format index was supplied");else if(D=new qd(this.Ol,this.uq,D),D.isValid()){var N=this.o4a(f.uJ,D,f.cell.tUa,f.cell.gja);Object(re.b)(N)?this.k0("ApplyNumberFormatIndexOnCell",
f,!1,N.reason):(this.I_a(f,N.value),this.k0("ApplyNumberFormatIndexOnCell",f,!0,void 0,N.value,D))}else this.k0("ApplyNumberFormatIndexOnCell",f,!1,"ApplyNumberFormatIndexOnCell: invalid number format holder")};La.prototype.rve=function(f,D){if(void 0===D||null===D)this.k0("ApplyNumberFormatStringOnCell",f,!1,"ApplyNumberFormatStringOnCell: no format string was supplied");else if(D=new qd(this.Ol,this.uq,void 0,D),D.isValid()){var N=this.o4a(f.uJ,D,f.cell.tUa,f.cell.gja);Object(re.b)(N)?this.k0("ApplyNumberFormatStringOnCell",
f,!1,N.reason):(this.I_a(f,N.value),this.k0("ApplyNumberFormatStringOnCell",f,!0,void 0,N.value,D))}else this.k0("ApplyNumberFormatStringOnCell",f,!1,"ApplyNumberFormatIndexOnCell: invalid number format holder")};La.prototype.FOg=function(f,D){if(D=void 0===D?null:D)if(D=this.l1h(f,D),D.success){var N=this.o4a(f.uJ,D.ooc,f.cell.tUa,f.cell.gja);Object(re.b)(N)?this.k0("ApplyNumberFormatCategoryOnCell",f,!1,N.reason,void 0,D.ooc):(this.I_a(f,N.value),this.k0("ApplyNumberFormatCategoryOnCell",f,!0,void 0,
N.value,D.ooc))}else this.k0("ApplyNumberFormatCategoryOnCell",f,!1,D.reason,void 0,D.ooc);else this.k0("ApplyNumberFormatCategoryOnCell",f,!1,"ApplyNumberFormatCategoryOnCell: no format was supplied")};La.prototype.vOg=function(f){switch(f){case 1004:return 1;case 5:return-1;case 1002:return 4;case 6:case 1001:return 5;case 7:case 1003:return 6;case 8:return 7;case 9:return 8;case 10:return 9}return 10<f?-1:f};La.prototype.l1h=function(f,D){if(!this.Ol||!this.localeInfo||!D)return f=this.Ol?this.localeInfo?
"cellFormat is null":"localeInfo is null":"instantaneousManager is null",new zf(!1,void 0,"GetRibbonNumberFormat: "+f);D=D.NumberFormat;switch(D){case 0:f=zd.cLh;break;case 1:f=zd.eLh;break;case 2:f=zd.aLh;break;case 3:f=zd.ZKh;break;case 4:f=zd.hLh;break;case 5:f=zd.dLh;break;case 6:f=zd.jLh;break;case 7:f=zd.fLh;break;case 8:f=zd.bLh;break;case 9:f=zd.gLh;break;case 10:f=zd.iLh;break;case 11:case 12:return this.Ol.WYe(),this.FSh(f,D);case 13:f=zd.yWg;break;case 1006:f=zd.buttonPercentage;break;
case 1004:f=zd.keyboardNumber;break;case 1005:f=zd.keyboardCurrency;break;case 1002:f=zd.keyboardDate;break;case 1001:f=zd.keyboardTime;break;case 1003:f=zd.keyboardPercentage;break;case 14:return f="GetRibbonNumberFormat: should not be called with NumberFormatDialog!",ld.ULS.shipAssertTag(537162132,0,!1,f),new zf(!1,void 0,f);default:return f="GetRibbonNumberFormat: unknown NumberFormatType!",ld.ULS.shipAssertTag(537162131,0,!1,f),new zf(!1,void 0,f)}if(!f)return new zf(!1,void 0,"GetRibbonNumberFormat: unsupported ribbonFormatKind...");
f=excelOnlineCalc.numfmt.getRibbonFormat(this.localeInfo,f);if(!f)return new zf(!1,void 0,"GetRibbonNumberFormat: ExcelOnlineCalcService.NumberFormatter.GetRibbonNumberFormat unable to get ribbon format...");f=new qd(this.Ol,this.uq,void 0,f);return new zf(!0,f)};La.prototype.FSh=function(f,D){if(!this.calcManager||!this.uq)return D=this.calcManager?"numberFormatter is null":"calcManager is null",new zf(!1,void 0,"GetDecimalChangeNumberFormat: "+D);f=this.calcManager.Sid(new qd(this.Ol,this.uq,f.cell.Qm));
if(!f)return new zf(!1,void 0,"GetDecimalChangeNumberFormat: currentFormat is null");D=this.uq.changeFormatDecimals(f,11===D?1:-1);if(!excelOnlineCalc.util.isSuccess(D))return new zf(!1,void 0,"GetDecimalChangeNumberFormat: NumberFormatter.ChangeFormatDecimals failure");if(void 0===D.value||null===D.value)return new zf(!1,void 0,"GetDecimalChangeNumberFormat: successUndefined result");D=new qd(this.Ol,this.uq,void 0,void 0,D.value);return new zf(!0,D)};La.prototype.k0=function(f,D,N,fa,Ia,pb){fa=
void 0===fa?"":fa;Ia=void 0===Ia?null:Ia;pb=(pb=void 0===pb?null:pb)?pb.HF?pb.HF.toString():Ba.a.Fpb(pb.formatString):"null";var Wb=Ba.a.Fpb(D.uJ.value)||"null";Ia=Ia?Ba.a.Fpb(Ia.text)||"null":"null";f=String.format("FormatCellsAction.LogNumberFormatEdit: {{ caller: '{0}', range: '{1}, {2}', success: '{3}', reason: '{4}', value: '{5}', valueType: '{6}', ifmt: '{7}', prediction: '{8}' }}",f,D.range.top,D.range.left,N,fa,Wb,D.uJ.type,pb,Ia);ld.ULS.sendTraceTag(537162130,0,50,f)};La.prototype.GOg=function(f,
D,N,fa,Ia,pb,Wb,Nc,kd,Xc,Ie){Nc=void 0===Nc?!1:Nc;kd=void 0===kd?!1:kd;var Ze=D.cell;Ze.cV=void 0===Xc?0:Xc;Xc=D.text;Xc!==N&&(Ze.text=N);Ze.C$a=void 0===Ie?null:Ie;Df.e(Xc)?D.formulaBarText=Xc:D.formulaBarText="";f=We.g(f).Tb.fkf(D.range);this.x3b(D,fa,null,Nc,kd,f);Ia&&(D.color=Ff.c(Ea.a.NG(Ia)));D.cell.Qm=pb;D.cell.erc=Wb;D.cell.yWd=pb};La.prototype.Lzi=function(f,D,N,fa,Ia,pb){var Wb={};Wb.a=this.$.ya.UserSessionId;Wb.b=D;Wb.c=fa.Ranges.length;Wb.d=this.Lah(fa.Ranges);Wb.e=Ia.toString();Wb.f=
f;Wb.h=pb;1890566896===f?Wb.g=N.NumberFormat.toString():2105621672===f&&(Wb.g=N.NumberFormatOptions.NumberFormatCategory.toString());$f.b().Te(3,Wb,!0)};La.prototype.Lah=function(f){for(var D=0,N=0,fa=0,Ia=0;Ia<f.length;Ia++){var pb=af.B(f[Ia]).OQ;D+=pb;pb>fa&&(fa=pb,N=Ia)}f=af.B(f[N]).toString();return"TotalCellCount:"+D+"; Max range:"+f+"; MaxRangeSize:"+fa+";"};La.prototype.suj=function(f,D,N){64===(D.ValidMembers&64)&&this.setFillColor(f,D,N);16===(D.ValidMembers&16)&&La.Rvj(f,D);128===(D.ValidMembers&
128)&&this.Vva.yLb(f,D,f.range);if(2===(D.ValidMembers&2)||1===(D.ValidMembers&1)){N=D.VerticalAlignment;D=D.HorizontalAlignment;var fa=0!==D;ye.EwaSettings.isChangeGateEnabled("OfficeVSO:3603507_calculateHorizontalAlignmentOnToggle")&&!fa&&this.k3e(f);this.Vva.Xdb(f,D,fa,N)}};La.prototype.setFillColor=function(f,D,N){(ye.EwaSettings.isChangeGateEnabled("OfficeVSO:3634588_NoFillColorOnConditionalFormattingCell")?f.Mba:f.Mba&&f.rfc&&!f.xyb&&!f.xfc)||(D=-1===D.FillColor?N?Ea.a.NG(sg.a.white):null:Ea.a.NG(sg.a.MH(D.FillColor)),
f.backgroundColor=D?Ff.c(D):null)};La.prototype.kwj=function(f,D){0!==f.horizontalAlignment&&2!==f.horizontalAlignment||f.h8(1,!1);0<=f.indentation+D.IndentationIncrease&&(f.indentation+=D.IndentationIncrease)};La.prototype.k3e=function(f){var D=new qd(this.Ol,this.uq,f.cell.Qm);if(!D.isValid())return 0;f=this.o4a(f.uJ,D,f.cell.tUa,f.cell.gja);return Object(re.b)(f)?0:null!=f.value.horizontalAlignment?f.value.horizontalAlignment:0};La.prototype.uxj=function(f,D,N){this.iB||(this.iB=new Ue(We.g(this.$).Da,
this.$));this.iB.yLb(f,D,N)};La.prototype.Z8h=function(f,D){var N=new ta.a;if(f.cell.formulaBarText&&f.cell.formulaBarText.startsWith("'"))N.Text=f.cell.formulaBarText;else{var fa=f.cellValue;fa&&4!==f.cell.cV||(fa=f.text);N.Text=fa}this.SBa(D,N,!1,void 0,cg.a.Lic(this.$));return!0};La.prototype.LCj=function(f,D){return this.Gb&&!!f&&!!D};La.O4g=function(f,D,N,fa){fa&&D.setCell(!0);0===N&&f.Da.wW()};La.expandRange=function(f,D){D=D.clone();D.height<f.height&&(D.bottom=D.top+f.height-1);D.width<f.width&&
(D.right=D.left+f.width-1);return D};La.Xji=function(f){switch(f){case -1142465846:case -1150205178:case -286432209:case -571165336:case 1041132226:case -394785302:return!0;default:return!1}};La.Rvj=function(f,D){D=D.Font;var N=0!==(D.ValidMembers&16),fa=0!==(D.ValidMembers&16),Ia=0!==(D.ValidMembers&16);f.bold=0!==(D.ValidMembers&4);f.italic=0!==(D.ValidMembers&8);N&&(f.underline=N);fa&&(f.doubleUnderline=fa);Ia&&(f.fontStrikethrough=Ia);N=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation");
f.QLb(D.FontName,N,"SetFont");f.fontSize=D.FontSize;N=Ea.a.pq(f.color,f.backgroundColor);sg.a.compare(N,sg.a.red)&&(Ba.a.f6(f.text)||Ba.a.gaf(f.text))||(D=sg.a.MH(D.FontColor),f.color=Ff.c(Ea.a.NG(D)))};uk.Object.defineProperties(La.prototype,{Vva:{configurable:!0,enumerable:!0,get:function(){return this.zJh}},uq:{configurable:!0,enumerable:!0,get:function(){return void 0===this.calcManager||null===this.calcManager?null:this.calcManager.uq}},localeInfo:{configurable:!0,enumerable:!0,get:function(){return void 0===
this.calcManager||null===this.calcManager?null:this.calcManager.localeInfo}}});La.KHh=36;Object(Jb.a)(La,"FormatCellsAction",null,[749,3]);var mh=lh.a;Am($d,mh);$d.prototype.create=function(){this.Eb(new La(this.$))};$d.ka=function(f){f.da.Ha(18,new $d(f))};Object(Jb.a)($d,"FormatCellsActionFactory",lh.a,[]);Object(Jb.a)(Cd,"FormulaAssistanceUIContext",null,[]);var Qh=lh.a;Am(ed,Qh);ed.prototype.create=function(){var f=this,D=this.$.da.Aa(448);if(D)this.Eb(D);else{var N=mf.GetServiceTaskFactory.Ua(this.$.da,
283,284,this.ub);ud.TaskExtensions.Ba(N,function(){ud.TaskExtensions.Ba(ei.c(N.result.ho.loadScript(f.oqj)),function(){D=f.$.da.Aa(448);if(!D){var fa=Object.assign(new Cd,{isFeedbackAllowed:f.$.isFeedbackEnabled});D=f.$.da.Ha(448,formulaAssistance.FormulaAssistanceUIFactoryGlobal.create(fa));f.$.SBe(function(){var Ia={};Ia.isFeedbackAllowed=f.$.isFeedbackEnabled;D.updateContext(Ia)})}f.Eb(D)},f.$.la,3)},this.$.la,3)}};ed.ka=function(f){f.da.Ha(449,new ed(f))};Object(Jb.a)(ed,"FormulaAssistanceUIControlFactory",
lh.a,[]);var Ji=b(740);Object(Jb.a)(uc,"FreezePanesCommandParameters",null,[]);var Zi=b(183),sj=b(410),Aj=b(278),bi=b(303),fj=b(114);id.prototype.getSheetName=function(){return this.freezeOptions.SheetName};Object(Jb.a)(id,"MacroRecorderSheetPaneFrozenPayload",null,[428]);Lb.prototype.$c=function(f,D){var N=!1;switch(D){case 1844679312:N=1!==f&&!this.gridView.rb.z5}return N};Lb.prototype.executeCommand=function(f,D){f=this.gridView.rb;var N=this.gridView.Ukd();Gg.AFrameworkApplication.sa.Qa.Sz&&this.$.Vla&&
(1844679312===D.command||340334732===D.command||-806625837===D.command)&&Ji.ShyRibbon.QQ(1,2);switch(D.command){case 1844679312:return this.setFreezePanes(D,N,f.jj);case 340334732:return f.Tac?rg.Task.Sa(!1):this.Uvj(D,N);case -806625837:return f.KUa?rg.Task.Sa(!1):this.Vvj(D,N)}return rg.Task.Sa(!1)};Lb.prototype.Mc=function(f,D){f=!1;switch(D.command){case 1844679312:case 340334732:case -806625837:case 1745254833:f=!0}return f};Lb.prototype.nd=function(){return!1};Lb.prototype.setFreezePanes=function(f,
D,N){if(N)return this.Bxc(f,!1,0,0,0,0,D,null);var fa=this.gridView.ga.va;N=fa.activeCell.clone();fa=fa.activeRange;fa.Xf&&(ld.ULS.sendTraceTag(537159585,0,50,"FreezePanesCommandHandler.SetFreezePanes: activeRange is a column. updating firstUnfreezeCell.Top ({0}) and firstUnfreezeCell.Bottom ({1}) to equal topLeftRange.Top ({2})",N.top,N.bottom,D.top),N.top=N.bottom=D.top);fa.isRow&&(ld.ULS.sendTraceTag(537159584,0,50,"FreezePanesCommandHandler.SetFreezePanes: activeRange is a row. updating firstUnfreezeCell.Left ({0}) and firstUnfreezeCell.Right ({1}) to equal topLeftRange.Left ({2})",
N.left,N.right,D.left),N.left=N.right=D.left);N.top===D.top&&N.left===D.left&&(N=Si.Range.kd(N.top+1,N.left));fa=N.top-1;var Ia=N.left-1,pb=fa-(D.top-1),Wb=Ia-(D.left-1);return this.R_j(N,pb,Wb)?this.Bxc(f,!0,fa,Ia,pb,Wb,D,N):(this.$.Cf(),this.tJf(),rg.Task.Sa(!0))};Lb.prototype.Uvj=function(f,D){return this.Bxc(f,!0,0,D.left,0,1,D,null)};Lb.prototype.Vvj=function(f,D){return this.Bxc(f,!0,D.top,0,1,0,D,null)};Lb.prototype.R_j=function(f,D,N){var fa=this.gridView.jg(f),Ia=this.gridView.view.visibleArea;
return!fa||Ia.topLeft.y>fa.bottomRight.y||Ia.topLeft.x>fa.bottomRight.x||Ia.bottomRight.y<fa.bottomRight.y||Ia.bottomRight.x<fa.bottomRight.x?(ld.ULS.sendTraceTag(537159583,0,50,"FreezePanesCommandHandler.ValidateFreezePanesRange: User tried to create freeze pane when active cell not in view, range={0}, rangeViewportArea={1}, visibleArea={2}",f,fa?fa.toString():"null",Ia.toString()),f=Cf.a.ed(1,0,26,1446,0,2105967339,"FreezePaneSelectionNotInViewErr"),ye.EwaSettings.Rz()?new Ih.a(this.$,f):(f=new Vf.ErrorDialog(this.$,
f),f.initialize(),f.pf()),!1):0>=D&&0>=N?(ld.ULS.sendTraceTag(537159582,0,50,"FreezePanesCommandHandler.ValidateFreezePanesRange: User tried to create empty freeze pane"),f=We.g(this.$).rtl?1448:1447,D=We.g(this.$).rtl?-2131054257:-1953454131,f=Cf.a.ed(1,0,26,f,0,D,"FreezePaneA1SelectedErr"),ye.EwaSettings.Rz()?new Ih.a(this.$,f):(f=new Vf.ErrorDialog(this.$,f),f.initialize(),f.pf()),!1):!0};Lb.prototype.Bxc=function(f,D,N,fa,Ia,pb,Wb,Nc){function kd(){return new id(Ie)}var Xc=this;this.VId=Og.a(this.$).z$(5,
"SendFreezePanesRequest","SendFreezePanesRequest");this.gridView.vQ(this.PBf);this.dG.ZBa();this.gridView.xKj(D?"":"UnsetFreezePane");this.myj(f,D,this.gridView.rb);var Ie=Object.assign(new uc,{SheetName:this.$.oa.name,Freeze:D,FrozenRows:Ia,FrozenColumns:pb,FirstRow:N,FirstColumn:fa});ld.ULS.sendTraceTag(573101852,0,50,"FreezePanesCommandHandler.SendFreezePanesRequest: Freeze={0}, FrozenRows={1}, FrozenColumns={2}, FirstRow={3}, FirstColumn={4} ",D,Ia,pb,N,fa);this.Bbc=ff.a.Ra.ke;return Sd.a(this.$.userOperationManager,
function(Ze,Sf,ag){if(ye.EwaSettings.ma(61)){var og=window.performance;og.clearMarks();og.mark("FreezePanes request sent")}og=Xc.gridView.jt;Xc.$.ma(710)&&og?(og=Xc.Jqh(Ie,og,Wb,Nc),Xc.BRj(og)):Xc.$.Qy();og=Xc.$.na.ta;var Vg=og.Ma(9,null);Vg.freezeSettings=Ie;return Se.i(og,"FreezeOrUnfreezePanes",Vg,Ze,Sf,ag,D,0)},function(Ze){return new Mf.a(151,0,Ze,void 0,kd)},f)};Lb.prototype.Jqh=function(f,D,N,fa){ld.ULS.shipAssertTag(537159580,1,!!D,"FreezePaneCommandHandler.EstimatePaneViewDataOnPaneRequest: called with null Sheet Processed Data");
if(!f.Freeze)return null;var Ia=bi.a();Ia.State=1;Ia.IsEstimated=!0;var pb=!1,Wb=!1,Nc=D.bW(Si.Range.kd(N.top,N.left)),kd=f.FrozenRows,Xc=f.FrozenColumns;1!==f.FrozenRows||f.FrozenColumns?f.FrozenRows||1!==f.FrozenColumns?(Xc=D.bW(Si.Range.kd(f.FirstRow+1,f.FirstColumn+1)),D=D.bW(Si.Range.kd(N.top,N.left)),Ia.Width=Xc.km-Nc.km,Ia.Height=Xc.Vm-Nc.Vm,0<f.FrozenRows&&(Ia.AbsoluteTop=Xc.Vm,Wb=!0),0<f.FrozenColumns&&(Ia.AbsoluteLeft=Xc.km,pb=!0),kd=Xc.bM-D.bM,Xc=Xc.jK-D.jK):(Ia.Width=D.Ajd(Zi.a.kd(N.top,
N.left)),fa=Si.Range.kd(N.top,N.left+1),Ia.AbsoluteLeft=Nc.km+Ia.Width,pb=!0):(Ia.Height=D.zjd(Zi.a.kd(N.top,N.left)),fa=Si.Range.kd(N.top+1,N.left),Ia.AbsoluteTop=Nc.Vm+Ia.Height,Wb=!0);Wb&&(Ia.FirstFrozenRow=N.top,Ia.FirstScrollableRow=fa.top);pb&&(Ia.FirstFrozenColumn=N.left,Ia.FirstScrollableColumn=fa.left);Ia.VisibleRows=kd;Ia.VisibleColumns=Xc;return Ia};Lb.prototype.BRj=function(f){var D=this;rg.Task.delay(this.$.ya.GetRangeContentPrefetchDelayInMs).continueWith(function(){D.$.oa&&D.$.ea&&
(D.$.ea.oY(Ya.a.Re,"FreezePaneCommandHandler.TriggerDelayActiveItemPaneChange"),sj.b(D.$.oa,f,-1,void 0,!0))})};Lb.prototype.myj=function(f,D,N){if(!ye.EwaSettings.ma(681))switch(f.command){case 1844679312:if(D||-1===this.XLa&&-1===this.YLa)this.XLa=N.Ix-N.width+this.gridView.scrollLeft,this.YLa=N.Jx-N.height+this.gridView.scrollTop;break;case 340334732:if(D||-1===this.XLa)this.XLa=N.Ix-N.width+this.gridView.scrollLeft;break;case -806625837:if(D||-1===this.YLa)this.YLa=N.Jx-N.height+this.gridView.scrollTop}};
Lb.prototype.Yvc=function(){var f=this.gridView.rb;0<f.width?this.gridView.scrollLeft=fj.a.B2b(this.gridView.domElement,We.g(this.$).rtl,0):-1!==this.XLa&&(this.gridView.scrollLeft=this.XLa,this.XLa=-1);0<f.height?this.gridView.scrollTop=0:-1!==this.YLa&&(this.gridView.scrollTop=this.YLa,this.YLa=-1)};Lb.prototype.tJf=function(){this.dG.cUa();Ag.a.Fa(this.VId);this.VId=null;this.gridView.UL(this.PBf)};Object(Jb.a)(Lb,"FreezePanesCommandHandler",null,[434]);var Qj=Mc.a;Am(vd,Qj);vd.prototype.Qd=function(){var f=
this;ud.TaskExtensions.Ba(mf.GetServiceTaskFactory.Ua(this.$.da,12,477,this.ub),function(D){f.Jd([new Lb(f.$,D.result)])},this.$.la)};vd.ka=function(f){f.da.Ha(116,new vd(f))};Object(Jb.a)(vd,"FreezePanesCommandHandlerFactory",Mc.a,[]);var hk=b(1018),Qi=lh.a;Am(ie,Qi);ie.prototype.create=function(){var f=this,D=mf.GetServiceTaskFactory.create(this.$.da,18,this.la,this.ub),N=mf.GetServiceTaskFactory.create(this.$.da,102,this.la,this.ub);ud.TaskExtensions.Ba(ud.TaskExtensions.we([D,N],this.la),function(){f.Eb(f.$.da.Aa(296)||
f.$.da.Ha(296,new hk.BorderFormatManager(f.$,D.result,N.result)))},this.la,3)};ie.ka=function(f){ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5680290_AddBorderFormatManagerFactory")&&f.da.Ha(468,new ie(f))};Object(Jb.a)(ie,"BorderFormatManagerFactory",lh.a,[]);var Xj=b(1034),bj=b(23),ch=b(94),$i=b(255),ci=b(372),Mj=b(369),Gj=b(99),ik;(function(f){f[f.insert=1]="insert";f[f.delete=2]="delete";f[f.rows=4]="rows";f[f.columns=8]="columns";f[f.cellsShiftHorizontal=16]="cellsShiftHorizontal";f[f.cellsShiftVertical=
32]="cellsShiftVertical";f[f.insertRows=5]="insertRows";f[f.insertColumns=9]="insertColumns";f[f.insertCellsShiftRight=17]="insertCellsShiftRight";f[f.insertCellsShiftDown=33]="insertCellsShiftDown";f[f.deleteRows=6]="deleteRows";f[f.deleteColumns=10]="deleteColumns";f[f.deleteCellsShiftLeft=18]="deleteCellsShiftLeft";f[f.deleteCellsShiftUp=34]="deleteCellsShiftUp"})(ik||(ik={}));Object(Jb.b)("InsertDeleteCellFlags",ik);var jk=b(444);Object(Jb.a)(Zd,"MacroRecorderRangeInsertedOrDeletedPayload",null,
[428]);var zk=b(120),qk=b(264),Hj=b(1214);b(321);Pc.Hhd="GetFontPreviewData";Object(Jb.a)(Pc,"FontWebServiceMethods",null,[]);Sc.prototype.Hhd=function(f,D){var N=this.lv,fa=this.lv.fc(),Ia=Pc.Hhd;fa=N.Ma(5,void 0===fa?null:fa);return Se.i(N,Ia,fa,f,D,null,null,644)};Object(Jb.a)(Sc,"FontServiceManager",null,[]);Ge.prototype.c_e=function(f,D,N,fa){fa=void 0===fa?null:fa;var Ia=Object.assign(new Fh.a,{Id:"FontDropdownMenu"});Ia.MenuSectionList=[];if(this.Nm&&this.themesManager){this.themesManager.edd(fa);
if(null==this.themesManager.qM||this.themesManager.rud)return Ia;fa=Object.assign(new Kg.a,{ControlsId:"ThemeFontsMenuSectionControl",Title:oe.a.instance.fa(1293),ControlList:this.Y3h(f,D,N)});Array.add(Ia.MenuSectionList,fa)}fa=Object.assign(new Kg.a,{ControlsId:"FontsMenuSectionControl"});this.Nm&&(fa.Title=oe.a.instance.fa(1294));fa.ControlList=this.bVh(f,D,N);Array.add(Ia.MenuSectionList,fa);return Ia};Ge.prototype.Y3h=function(f,D,N){var fa,Ia=[],pb=We.g(this.$).ga.Pa.nc;pb=5===(null===(fa=null===
pb||void 0===pb?void 0:pb.floatingObject)||void 0===fa?void 0:fa.type);if(this.themesManager.qM){var Wb=this.themesManager.qM.zuf;var Nc=this.themesManager.qM.Tsf}else ld.ULS.sendTraceTag(525361436,1,15,"ThemeFonts are Null");null!=Nc?(fa=this.VIe(Nc,1,pb,f,D,N),Array.add(Ia,fa)):ld.ULS.sendTraceTag(525361435,1,15,"Major Theme Font is Null");null!=Wb?(f=this.VIe(Wb,2,pb,f,D,N),Array.add(Ia,f)):ld.ULS.sendTraceTag(525361434,1,15,"Minor Theme Font is Null");return Ia};Ge.prototype.VIe=function(f,D,
N,fa,Ia,pb){var Wb=2===D?this.OFi:this.KCi;N=N?Wb:Lg.a.sf(f);Wb=Lg.a.sf(ca.HelperMethods.pec(f,D));f=Lg.a.sf(f);return Object.assign(new Hj.a,{MenuItemId:2===D?"MinorThemeFont":"MajorThemeFont",CommandValueId:N,LabelText:Wb,LabelCss:String.format("font-size:12pt;font-family:{0};",f),Styles:Ge.Bxb(f),AriaLabel:Wb,Alt:Wb,Command:fa.toString(),CommandPreviewId:Ia.toString(),CommandRevertId:pb.toString()})};Ge.prototype.bVh=function(f,D,N){if(Ge.L0c)return Ge.L0c.s8c;var fa=this.Eki&&!this.Rjf,Ia=!1;
Ge.k4a||(Ge.def(),Ia=!0);var pb=this.yHe(f,D,N,Ge.k4a,fa,Ia);pb.ozc&&!Ia&&(ld.ULS.sendTraceTag(523903238,1,15,"FontDropdownHelper.getFontButtonsForMenuSection: ddEntries is Null. Fallback to old Font Dictionary."),Ge.def(),pb=this.yHe(f,D,N,Ge.k4a,fa,pb.ozc));this.tu&&!pb.ozc&&(ce.a.Ti(Ge.styles),Ge.L0c=pb);fa&&gridRenderer.CanvasRendererGlobals.loadPreviewFont(this.pVi);return pb.s8c};Ge.prototype.yHe=function(f,D,N,fa,Ia,pb){var Wb=[],Nc=this.tu&&!pb;var kd=Nc?"msofpNew":"msofp";for(var Xc in fa){var Ie=
Xc,Ze=fa[Xc],Sf=Lg.a.sf(Ie),ag;if(Nc)if(ag=Ge.Zea?Ge.Zea[Ie]:null)ag=Lg.a.sf(ag);else return ld.ULS.sendTraceTag(523903237,1,15,"FontDropdownHelper.getFontButtonsForMenuSection: localizedFontName in supportedFontFamiliesNew is not found for {0}",Ie),{ozc:!0,s8c:[]};else ag=Lg.a.sf(ca.HelperMethods.Zea[Ie]);Ie=Lg.a.sf(Ie);Ia||(Ze=0);Sf=Object.assign(new Hj.a,{MenuItemId:Sf,CommandValueId:Sf,LabelText:Ia&&0<Ze?Lg.a.sf(String.fromCodePoint(Ze)):ag,LabelCss:String.format("font-size:12pt;font-family:{0};",
Ia&&0<Ze?kd:Ie),Styles:Ge.Bxb(Ia&&0<Ze?kd:Ie),AriaLabel:ag,Alt:ag,Command:f.toString(),CommandPreviewId:D.toString(),CommandRevertId:N.toString()});Array.add(Wb,Sf)}return{ozc:pb,s8c:Wb}};Ge.prototype.Jwj=function(f){this.menuId=f};Ge.prototype.kni=function(){return 2!==this.Zvb&&3!==this.Zvb?!1:!0};Ge.prototype.Vkj=function(){this.Zvb=1;this.QYe||(this.QYe=new Sc(this.$.na.lv));this.QYe.Hhd(this.XPi,this.YPi)};Ge.prototype.k5i=function(f){var D=this;if(this.Dti(f)){var N=ca.HelperMethods.Wca(function(){var fa=
f.Result;Ge.styles='@font-face{font-family:"msofpNew";font-style:normal;font-weight:normal;src:url(\''+fa.PreviewUrl+"') format('truetype')}";var Ia=fa.FontFacePropertiesList,pb=fa.FontNameList;Ge.k4a={};Ge.Zea={};pb.forEach(function(Wb,Nc){Ge.k4a[Wb]=Ia[Nc].Codepoint;Ge.styles=D.aOg(Ge.styles,Wb,"https://fs.microsoft.com/fs/"+fa.CatalogVersion+"/rawguids/"+Ia[Nc].FontGuid);Ge.Zea[Wb]=Wb})});10<N&&ld.ULS.sendTraceTag(523903236,1,50,"FontDropdownHelper.prepareFontCodepointMap: Duration for prepareFontCodepointMap the model, duration={0}",
N)}};Ge.prototype.Dti=function(f){if(!f.Result)return ld.ULS.sendTraceTag(523903235,1,15,"FontDropdownHelper.isValidFontPreviewData: Result in EwaResult is Null."),!1;f=f.Result;return f?f.PreviewUrl?f.FontFacePropertiesList?f.FontNameList?0==f.FontFacePropertiesList.length||f.FontFacePropertiesList.length!=f.FontNameList.length?(ld.ULS.sendTraceTag(523903202,1,15,"FontDropdownHelper.isValidFontPreviewData: Mismatch in length of FontFacePropertiesList and FontNameList in fontListPreviewData."),!1):
!0:(ld.ULS.sendTraceTag(523903203,1,15,"FontDropdownHelper.isValidFontPreviewData: FontNameList in fontListPreviewData is Null."),!1):(ld.ULS.sendTraceTag(523903232,1,15,"FontDropdownHelper.isValidFontPreviewData: FontFacePropertiesList in fontListPreviewData is Null."),!1):(ld.ULS.sendTraceTag(523903233,1,15,"FontDropdownHelper.isValidFontPreviewData: PreviewUrl in fontListPreviewData is Null."),!1):(ld.ULS.sendTraceTag(523903234,1,15,"FontDropdownHelper.isValidFontPreviewData: fontListPreviewData is Null."),
!1)};Ge.prototype.aOg=function(f,D,N){return f+('@font-face{font-family:"'+D+'";src:local("'+D+"\"), url('"+N+"')}")};Ge.prototype.IRf=function(){this.menuId&&this.frame.Vv(this.menuId)};Ge.def=function(){var f={};Ge.k4a=(f["Angsana New"]=983046,f["Arial Black"]=983051,f.Arial=983050,f.Batang=983061,f["Book Antiqua"]=983077,f["Browallia New"]=983082,f.Calibri=983085,f.Cambria=983089,f.Candara=983091,f.Century=983095,f["Comic Sans MS"]=983100,f.Consolas=983101,f.Constantia=983102,f.Corbel=983106,f["Cordia New"]=
983107,f["Courier New"]=983109,f.DilleniaUPC=983121,f.Dotum=983123,f.FangSong=983138,f.Garamond=983154,f.Georgia=983156,f.Gulim=983182,f.GungSuh=983186,f.KaiTi=983222,f.JasmineUPC=983218,f["Malgun Gothic"]=983258,f.Mangal=983262,f.Meiryo=983264,f["Microsoft JhengHei"]=983272,f["Microsoft YaHei"]=983284,f.MingLiU=983292,f.MingLiU_HKSCS=983296,f["MS Gothic"]=983245,f["MS Mincho"]=983247,f["MS PGothic"]=983249,f["MS PMincho"]=983251,f.PMingliU=983322,f["PMingLiU-ExtB"]=983324,f.SimHei=983382,f.SimSun=
983384,f["SimSun-ExtB"]=983386,f["Source Sans Pro"]=983396,f.Tahoma=983405,f.THSarabunPSK=983404,f["Times New Roman"]=983415,f["Trebuchet MS"]=983419,f.Verdana=983443,f["Yu Gothic"]=983464,f["Yu Mincho"]=983474,f)};Ge.Bxb=function(f){var D={};D["font-family"]=f;D["font-size"]="12pt";return{optionText:D}};uk.Object.defineProperties(Ge.prototype,{themesManager:{configurable:!0,enumerable:!0,get:function(){this.Ex||(this.Ex=this.$.da.Aa(422));return this.Ex}}});uk.Object.defineProperties(Ge,{Qag:{configurable:!0,
enumerable:!0,get:function(){return Ge.Zea}}});Ge.k4a=null;Ge.Zea=null;Ge.L0c=null;Ge.styles=null;Object(Jb.a)(Ge,"FontDropdownHelper",null,[751]);Ud.oVg=function(f,D){return new Ud(f,D,null,null,null)};Ud.D0c=function(f,D){return new Ud(f,null,D,null,null)};Ud.pVg=function(f,D){return new Ud(f,null,null,D,null)};Ud.nVg=function(f,D,N){return new Ud(f,null,D,null,N)};uk.Object.defineProperties(Ud.prototype,{KKa:{configurable:!0,enumerable:!0,get:function(){return this.Tsg}},formattedText:{configurable:!0,
enumerable:!0,get:function(){return this.Usg}},style:{configurable:!0,enumerable:!0,get:function(){return this.QAg}},size:{configurable:!0,enumerable:!0,get:function(){return this.rYb}},tba:{configurable:!0,enumerable:!0,get:function(){return this.PYe}}});Object(Jb.a)(Ud,"CachedPreviewCellGroup",null,[]);var Ik=b(65);Ne.prototype.AM=function(){var f=this;this.XFc=!1;if(Mh.b(this.lDa,514846606)){this.XFc=!0;ld.ULS.sendTraceTag(537159430,0,50,"Merge cells with multiple values");Ik.a(this.Ef.$).ud.ME(514846606);
if(this.QQb&&this.n3d)window.setTimeout(function(){f.Ef.Vaa(f.Ef.gridView,f.kDa,!0,!0)},0);else return this.D3d=We.g(this.Ef.$).rtl,this.F3d=Cf.a.ed(3,2,0,this.D3d?628:627,0,514846606,"MergeCellsLoseData"),this.qj=Og.a(this.Ef.$).zi(this.F3d).G(),this.qj.isCompleted||(this._state=2,this.qj.xO(this.moveNext)),this.QFc;return this.phb}return this.i2};Ne.prototype.i2=function(){this.Ef.Xpf(this.XFc,this.n3d,this.rlg.scenario,this.QQb);this._state=3};Ne.prototype.phb=function(){return this.i2};Ne.prototype.QFc=
function(){this.TFc=this.qj.Kz();if(0===this.TFc)return ld.ULS.sendTraceTag(537159429,0,50,"MergeCellsLoseData Dialog: Ok pressed"),this.qj=this.Ef.Vaa(this.Ef.gridView,this.kDa,!0,!1).g(),this.qj.isCompleted||(this._state=2,this.qj.xO(this.moveNext)),this.RFc;1===this.TFc&&ld.ULS.sendTraceTag(537159428,0,50,"MergeCellsLoseData Dialog: Cancel pressed");return this.rhb};Ne.prototype.rhb=function(){return this.phb};Ne.prototype.RFc=function(){this.qj.Kz();return this.rhb};Ne.prototype.dispose=function(){};
Object(Jb.a)(Ne,"$$sm_Microsoft$Office$Excel$WebUI$Client$GridCommandHandler$OnMergeCellsWebMethodSuccessOld",null,[3]);Hd.prototype.AM=function(){return Mh.b(this.lDa,514846606)?(ld.ULS.sendTraceTag(537159427,0,50,"Merge cells with multiple values"),Ik.a(this.Ef.$).ud.ME(514846606),this.A3d=We.g(this.Ef.$).rtl,this.B3d=Cf.a.ed(3,2,0,this.A3d?628:627,0,514846606,"MergeCellsLoseData"),this.qj=Og.a(this.Ef.$).zi(this.B3d).G(),this.qj.isCompleted||(this._state=2,this.qj.xO(this.moveNext)),this.ohb):
this.i2};Hd.prototype.i2=function(){this._state=3};Hd.prototype.ohb=function(){this.WFc=this.qj.Kz();if(0===this.WFc)return ld.ULS.sendTraceTag(537159426,0,50,"MergeCellsLoseData Dialog: Ok pressed"),this.qj=this.Ef.Vaa(this.Ef.gridView,this.kDa,!0,this.QQb).g(),this.qj.isCompleted||(this._state=2,this.qj.xO(this.moveNext)),this.Clg;1===this.WFc&&ld.ULS.sendTraceTag(537159425,0,50,"MergeCellsLoseData Dialog: Cancel pressed");return this.qhb};Hd.prototype.qhb=function(){return this.i2};Hd.prototype.Clg=
function(){this.qj.Kz();return this.qhb};Hd.prototype.dispose=function(){};Object(Jb.a)(Hd,"$$sm_Microsoft$Office$Excel$WebUI$Client$GridCommandHandler$OnMergeCellsWebMethodSuccessOldForNonDataLossCSE",null,[3]);var Bj=b(388),Ak=Bj.a;Am(ad,Ak);ad.prototype.mh=function(){1896159024===this.Lp?(this.uo=oe.a.instance.fa(23),this.m9c=0):(this.uo=oe.a.instance.fa(22),this.m9c=1);var f=this.selectedRanges[0].FW&&!this.selectedRanges[0].Y_?0:1;this.lc=1;var D={};f=(D[ad.Cz]=this.Cc,D.dialogToDisplay=this.m9c,
D.defaultSelectedKey=f,D.isRtl=this.isRtl,D);this.initializeAndShow(this.uo,this.uhi,f)};uk.Object.defineProperties(ad.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"InsertDeleteCellsDialog"}}});Object(Jb.a)(ad,"InsertDeleteCellsDialog",Bj.a,[]);Object(Jb.a)(sb,"MacroRecorderRangeFilledPayload",null,[428]);Object(Jb.a)(Ac,"RangeBorders",null,[]);Object(Jb.a)(Ob,"ScenarioInfo",null,[]);hd.prototype.dispose=function(){this.$=null};hd.prototype.Rli=function(f,D){return!(void 0===
D||null===D)&&!!(D.scenario&16384)&&155820588!==f&&this.agf(D,f)};hd.prototype.f4e=function(){var f=Db.a.Ae(),D=We.g(this.$),N=D.ga.va.selectedRanges,fa=0,Ia=0,pb=N.length,Wb=new Ob;if(1<pb)return Wb.scenario=4,Wb;this.rsd&&We.g(this.$).rtl&&(fa|=65536);if(!D.h6(N[0]))if(this.pAb)fa|=32;else return Wb.scenario=32,Wb;if(D=D.Da.k5a(N[0],this.$.activeItemName))for(Wb.W_c=D,D=Cl(D),pb=D.next();!pb.done;pb=D.next())if(Ia+=1,1<Ia){this.pAb?(fa|=256,Wb.scenario=fa):Wb.scenario=256;if(!this.fBb)return Wb;
break}Ia=We.g(this.$).Da.fwa(N[0]);if(!Ia)return Wb.scenario=32768,Wb;D=Ia.length;N=N[0];pb=N.bottom-N.top+1;for(var Nc=N.right-N.left+1,kd=new Ac,Xc=0;Xc<D;Xc++)if(this.ckf&&this.i0h(Ia[Xc],N,kd),fa=fa|(void 0!==Ia[Xc].text&&null!==Ia[Xc].text&&""!==Ia[Xc].text?1:0)|(Ia[Xc].$N?2:0)|(Ia[Xc].$wa?8:0)|(Ia[Xc].vyb?16:0)|(Ia[Xc].$H?64:0)|(Ia[Xc].Mba?128:0),void 0!==Ia[Xc].text&&null!==Ia[Xc].text&&""!==Ia[Xc].text||Ia[Xc].$wa)if(void 0===Wb.CR||null===Wb.CR)Wb.CR=We.g(this.$).rc(Ia[Xc].getRange());else{if(Ia[Xc].getRange().top<
Wb.CR.range.top||Ia[Xc].getRange().top==Wb.CR.range.top&&Ia[Xc].getRange().left<Wb.CR.range.left)Wb.CR=We.g(this.$).rc(Ia[Xc].getRange());fa|=16384}this.ckf&&(kd.IUa===Nc&&(fa|=512),kd.DHa===Nc&&(fa|=2048),kd.JOa===pb&&(fa|=4096),kd.lSa===pb&&(fa|=1024),0<kd.IUa&&kd.IUa<Nc||0<kd.DHa&&kd.DHa<Nc||0<kd.JOa&&kd.JOa<pb||0<kd.lSa&&kd.lSa<pb)&&(fa|=8192);!ye.EwaSettings.isChangeGateEnabled("OfficeVSO:6217608_Add_Entire_Row_Column_Selection_flag")||N.right!==N.maxColumns&&N.bottom!==N.maxRows||(fa|=131072);
f=Db.a.Ae()-f;ld.ULS.sendTraceTag(537159424,0,50,"Execution time of GetMergeCellScenario is : {0}",f);Wb.scenario=fa;return Wb};hd.prototype.euf=function(f,D){var N=f.command;if(void 0===D||null===D)D=this.f4e();if(!this.agf(D,N))return!1;f=We.g(this.$).ga.va.selectedRanges;var fa=We.g(this.$).Da.fwa(f[0]);if(!fa)return!1;if(ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5993850_HandleSingleCellMergeScenario")&&1===fa.length&&!fa[0].$N)return-167499203===N?(fa[0].h8(2,!0),!0):!1;fa=We.g(this.$).ga.va.CB;
var Ia=this.$.oa.sheetName,pb=!0;switch(N){case -167499203:2===(D.scenario&2)&&this.Xic?this.zfg(D.scenario,f,N):pb=this.eFi(D,f);break;case 1097660126:(D=this.fuf(D,f))&&0!=D.length||(pb=!1);break;case 155820588:this.zfg(D.scenario,f,N);break;default:return!1}We.g(this.$).kW(f,fa,Ia,null,f[0],null,null,0,"MergeCellCommandAction");return this.fBb?pb:!0};hd.prototype.agf=function(f,D){var N=this.Iki(f,D);if(!this.gif)return N;var fa=We.g(this.$).ga.va.selectedRanges[0].AB(!1);ld.ULS.sendTraceTag(526149324,
0,50,"Merge Cell Command: {0}; Scenario Number: {1}; IsCSEPossible result: {2}; Range: {3}",D.toString(),f.scenario,N,fa);return N};hd.prototype.Iki=function(f,D){if(-255094134===D)return!1;var N=f.scenario;if(this.rsd&&65536===(N&65536))return!1;if(this.nti(D,f))return this.mti(D,f);this.pAb&&32===(N&32)&&(N&=-33);if(256==(N&256))if(this.ipi(f))N&=-257;else return!1;return 32768===N||4===N||128===(N&128)||!this.pAb&&32===N?!1:-167499203!=D&&1097660126!==D||!this.mqd(f)?void 0!==f.CR&&null!==f.CR&&
f.CR.BT?!1:0===N?!0:16384===(N&16384)?ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellDataLossScenarioCse",!1):1!==(N&1)&&8!==(N&8)||!ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellContentScenarioCse",!1)?!1:!0:this.Yic};hd.prototype.Cmi=function(f){return 131072===(f.scenario&131072)?!0:!1};hd.prototype.ipi=function(f){if(!this.fBb)return!1;var D="Multi block",N=!0;this.mqd(f)&&(D+=" with border",N=!1);this.Cmi(f)&&(N=!1,D+=" with entire row or column selected",
16384===(f.scenario&16384)&&(D+=" and a data loss scenario"));N||ld.ULS.sendTraceTag(523511383,0,50,"CSE for {0}, is not enabled",D);return N};hd.prototype.mqd=function(f){return 16===(f.scenario&16)||this.kmd(f.scenario)||this.Cmd(f.scenario)||this.umd(f.scenario)||this.Emd(f.scenario)||8192===(f.scenario&8192)?!0:!1};hd.prototype.nti=function(f,D){return 155820588===f||(-167499203===f||1097660126===f)&&2===(D.scenario&2)&&this.Xic?!0:!1};hd.prototype.lti=function(f){return this.Emd(f.scenario)||
this.umd(f.scenario)||this.kmd(f.scenario)||this.Cmd(f.scenario)?!0:!1};hd.prototype.mti=function(f,D){if(1097660126===f&&2===(D.scenario&2)||this.Lli&&void 0!==D.CR&&null!==D.CR&&D.CR.BT)return!1;this.pAb&&32===(D.scenario&32)&&(D.scenario&=-33);return 32768===D.scenario||4===D.scenario||256===D.scenario||128===(D.scenario&128)?!1:2===(D.scenario&2)?this.lti(D)?ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellUnmergeWithBorderScenariosCse",!1):ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellUnmergeWithoutBorderScenariosCse",
!1):!1};hd.prototype.i0h=function(f,D,N){var fa=f.getRange();if(fa.top===D.top)if(f.jMa)N.IUa+=fa.right-fa.left+1;else{var Ia=this.iB.GR(fa,0);if(Ia){var pb=Cl(Ia);for(Ia=pb.next();!Ia.done;Ia=pb.next())Ia=Ia.value,Ia.bMa&&(N.IUa+=Ia.getRange().right-Ia.getRange().left+1)}}if(fa.left===D.left)if(f.dMa)N.JOa+=fa.bottom-fa.top+1;else if(Ia=this.iB.GR(fa,2))for(pb=Cl(Ia),Ia=pb.next();!Ia.done;Ia=pb.next())Ia=Ia.value,Ia.hMa&&(N.JOa+=Ia.getRange().bottom-Ia.getRange().top+1);if(fa.bottom===D.bottom)if(f.bMa)N.DHa+=
fa.right-fa.left+1;else if(Ia=this.iB.GR(fa,1))for(pb=Cl(Ia),Ia=pb.next();!Ia.done;Ia=pb.next())Ia=Ia.value,Ia.jMa&&(N.DHa+=Ia.getRange().right-Ia.getRange().left+1);if(fa.right===D.right)if(f.hMa)N.lSa+=fa.bottom-fa.top+1;else if(f=this.iB.GR(fa,3))for(f=Cl(f),Ia=f.next();!Ia.done;Ia=f.next())D=Ia.value,D.dMa&&(N.lSa+=D.getRange().bottom-D.getRange().top+1)};hd.prototype.wej=function(f,D){D=Cl(D.W_c);for(var N=D.next();!N.done;N=D.next()){N=f.We(N.value.yf);N=We.g(this.$).Da.fwa(N);for(var fa=N.length,
Ia=1;Ia<fa;Ia++){var pb=We.g(this.$).rc(N[Ia].getRange());this.Yic?pb.cell.deleteCellFromModel():(pb.Mrb(),pb.clearFormat(),pb.cell.zej());pb.tcb(!0)}}};hd.prototype.fZj=function(f,D){f.backgroundColor=D.backgroundColor;f.color=D.color};hd.prototype.mmg=function(f,D){return{SpansBlocks:!0,OriginRow:f,OriginColumn:D,IsOrigin:!1,Columns:0,Rows:0,Width:0,Height:0,OriginDeltaX:0,OriginDeltaY:0}};hd.prototype.oEg=function(f,D,N,fa,Ia){N=f.We(N.yf);if(!N)return ld.ULS.sendTraceTag(523547158,0,15,"blockRange(intersection of block's range and the selected range) can't be null as the blocks we are checking are returned as the intersecting blocks"),
null;var pb=new Si.Range(f.top,f.left,N.top,N.left,!1,!1);if(N.top==f.top)var Wb=0;else pb.bottom=N.top-1,Wb=D.zjd(pb);N.left==f.left?pb=0:(pb.right=N.left-1,pb=D.Ajd(pb));D=this.mmg(f.top-1,f.left-1);D.OriginDeltaY=Wb;D.OriginDeltaX=pb;D.Rows=N.bottom-N.top;D.Columns=N.right-N.left;D.Height=Ia;D.Width=fa;N.top==f.top&&N.left==f.left&&(D.IsOrigin=!0);f=We.g(this.$).rc(N.topLeft);f.cell.r3f(D);return f};hd.prototype.fSd=function(f,D){var N=[],fa=We.g(this.$).Ff;if(!fa)return N;var Ia=fa.zjd(f),pb=
fa.Ajd(f);if(D.W_c){D=Cl(D.W_c);for(var Wb=D.next();!Wb.done;Wb=D.next())if(Wb=this.oEg(f,fa,Wb.value,pb,Ia))N.push(Wb);else{N=[];break}}return N};hd.prototype.e1h=function(f,D,N,fa){var Ia=N.bottom-N.top,pb=N.right-N.left,Wb=[],Nc=fa.scenario;if(256===(Nc&256)){if(Wb=this.fSd(N,fa),!Wb||0==Wb.length)return Wb}else D.cell.fSd(Ia,pb),Wb.push(D);Ia=this.T3(this.T5(D),!0,0,Nc,"merge");if(void 0!==f&&null!==f){pb=Cl(Wb);for(var kd=pb.next();!kd.done;kd=pb.next()){kd=kd.value;var Xc=f.cell.formattedText,
Ie=Object.assign(new ta.a,{TextRuns:Xc.TextRuns,Fonts:Xc.Fonts});Ie.Text=void 0!==f.cell.originalText&&null!==f.cell.originalText?f.cell.originalText:void 0!==f.cell.userInput&&null!==f.cell.userInput?f.cell.userInput:Xc.Text;Ia=this.T3(this.T5(kd),Ia,1,Nc,"merge");this.Jh.SBa(kd,Ie,!1,null,!0,"MergeCells",void 0,2);Ia=this.T3(this.T5(kd),Ia,2,Nc,"merge");this.rsd?kd.Urb(f):this.fZj(kd,f);Ia=this.T3(this.T5(kd),Ia,3,Nc,"merge");kd.cell.L7g(f.cell);Ia=this.T3(this.T5(kd),Ia,4,Nc,"merge");kd.cell.sEc(!1);
Ia=this.T3(this.T5(kd),Ia,6,Nc,"merge")}}this.wej(N,fa);this.T3(this.T5(D),Ia,5,Nc,"merge");return Wb};hd.prototype.umd=function(f){return 4096===(f&4096)};hd.prototype.Emd=function(f){return 512===(f&512)};hd.prototype.kmd=function(f){return 2048===(f&2048)};hd.prototype.Cmd=function(f){return 1024===(f&1024)};hd.prototype.kcc=function(f,D){for(var N=null,fa=0;fa<f.length;fa++)if(f[fa].BorderPosition===D){N=f[fa];break}return N};hd.prototype.uXh=function(f,D){this.Gjc?(D=this.kcc(D.cell.DN().Borders,
2))&&f.push(D):(D=D.cell.DN().Borders,1<D.length&&(D=[D[1]]),f=[].concat(Jl(D),Jl(f)));return f};hd.prototype.q4h=function(f,D){this.Gjc?(D=this.kcc(D.cell.DN().Borders,0))&&f.push(D):(D=D.cell.DN().Borders,1<D.length&&(D=[D[0]]),f=[].concat(Jl(D),Jl(f)));return f};hd.prototype.uPh=function(f,D){D=this.iB.GR(D.cell.getRange(),1);if(this.Gjc){if(D=D[0].DN().Borders,D=this.kcc(D,0))D.BorderPosition=1,f.push(D)}else{var N=[];0<D.length&&(N=D[0].DN().Borders);N[0].BorderPosition=1;f=[].concat(Jl(N),Jl(f))}return f};
hd.prototype.p1h=function(f,D){D=this.iB.GR(D.cell.getRange(),3);if(this.Gjc){if(D=D[0].DN().Borders,D=this.kcc(D,2))D.BorderPosition=3,f.push(D)}else{var N=[];0<D.length&&(N=D[0].DN().Borders);N[0].BorderPosition=3;f=[].concat(Jl(N),Jl(f))}return f};hd.prototype.j0h=function(f,D,N){this.umd(f.scenario)&&(D=this.uXh(D,N));this.Emd(f.scenario)&&(D=this.q4h(D,N));this.kmd(f.scenario)&&(D=this.uPh(D,N));this.Cmd(f.scenario)&&(D=this.p1h(D,N));return D};hd.prototype.s_=function(f){if(0===f.length)return null;
var D=[0,0,0,0],N=[1,1,1,1],fa=0;f.forEach(function(pb){var Wb=pb.BorderPosition;N[Wb]=pb.BorderLineStyle;var Nc=new sg.a(pb.Color.Red,pb.Color.Green,pb.Color.Blue);D[Wb]=Nc.jY();fa|=ca.HelperMethods.Q4a(pb.BorderPosition)});f={};f.LineStyle=N;f.Color=D;var Ia={};Ia.BorderFormat=f;Ia.Border=fa;return Ia};hd.prototype.l4d=function(f,D,N){N=void 0===N?null:N;var fa=[];fa=null!==N?[].concat(Jl(N)):this.j0h(D,fa,f);D=this.s_(fa);f.cell.ruc(f.cell.getRange());this.iB.ALd(f.cell.getRange());this.Jh.Kea(We.g(this.$),
-1690267012,D,!1,null,[f.cell.getRange()])};hd.prototype.nqi=function(f){return 512===(f.scenario&512)||4096===(f.scenario&4096)||1024===(f.scenario&1024)||2048===(f.scenario&2048)?!0:!1};hd.prototype.r4h=function(f){f=this.iB.GR(f.cell.getRange(),1);return f[0].jMa?(f=f[0].DN().Borders[0],f.BorderPosition=1,f):null};hd.prototype.s4h=function(f){f=this.iB.GR(f.cell.getRange(),3);return f[0].dMa?(f=f[0].DN().Borders[0],f.BorderPosition=3,f):null};hd.prototype.L8h=function(f,D,N,fa,Ia){D.cell.Ahg();
this.nqi(f)?this.l4d(D,f):Ia&&(Ia=[],null!==N&&Ia.push(N),null!==fa&&Ia.push(fa),0<Ia.length?this.l4d(D,f,Ia):(D.cell.ruc(D.cell.getRange()),this.iB.ALd(D.cell.getRange())))};hd.prototype.RWh=function(f,D){return null===f||void 0===f?!0:f.cell.getRange().top===D.topLeft.top&&f.cell.getRange().left===D.topLeft.left&&f.cell.getRange().bottom===D.topLeft.bottom&&f.cell.getRange().right===D.topLeft.right?!0:!1};hd.prototype.eFi=function(f,D){D=this.fuf(f,D);if(this.fBb&&(!D||0==D.length))return!1;for(var N=
0;N<D.length;N++)D[N].h8(2,!0),this.T3(this.T5(D[N]),!0,8,f.scenario,"merge");return!0};hd.prototype.fuf=function(f,D){var N=f.CR,fa=We.g(this.$).rc(D[0]),Ia=null,pb=null;this.Yic&&(Ia=this.r4h(fa),pb=this.s4h(fa));var Wb=this.e1h(N,fa,D[0],f);if(this.fBb&&(!Wb||0==Wb.length))return Wb;We.g(this.$).Da.X$(D[0],this.$.activeItemName).Bhg(D[0],!0);this.T3(this.T5(fa),!0,9,f.scenario,"merge");if(this.Yic&&this.mqd(f))for(D=this.RWh(N,D[0]),N=Cl(Wb),fa=N.next();!fa.done;fa=N.next())this.L8h(f,fa.value,
Ia,pb,D);return Wb};hd.prototype.tOg=function(f,D,N){var fa=this;if(!(1>f.Borders.length)){var Ia=this.s_(f.Borders);N.forEach(function(pb){pb=We.g(fa.$).rc(pb.getRange());fa.Jh.T7f(-1690267012,pb,Ia,!1,null,!1,D)})}};hd.prototype.pUj=function(f,D,N){for(var fa=f.length,Ia=0;Ia<fa;Ia++){f[Ia].cell.sEc();var pb=f[Ia].cell.getRange(),Wb=We.g(this.$).Da.fwa(pb),Nc=Wb.length;if(-167499203===D&&this.Xic){var kd=0;2===f[Ia].cell.fKd||1===f[Ia].cell.cV?kd=3:2===f[Ia].cell.cV&&(kd=1);f[Ia].h8(kd,!1)}for(kd=
1;kd<Nc;kd++)Wb[kd].attachCellToModel(),Wb[kd].Urb(f[Ia]),-167499203===D&&this.Xic&&Wb[kd].h8(null,!1);this.$lf&&N&&this.tOg(N[Ia],pb,Wb)}};hd.prototype.J_e=function(f,D){for(var N=null,fa=0;fa<f.length;fa++)if(f[fa].BorderPosition===D){N=f[fa];break}return N};hd.prototype.tPh=function(f,D){var N=f.cell.DN();f.bMa()&&f.cell.HRa(1);f.hMa()&&f.cell.HRa(3);f=this.iB.GR(D,0);if(f[0].bMa){var fa=f[0].DN().Borders;fa=this.J_e(fa,1);fa.BorderPosition=0;N.Borders.push(fa);f.forEach(function(Ia){Ia.HRa(1)})}D=
this.iB.GR(D,2);D[0].hMa&&(f=D[0].DN().Borders,f=this.J_e(f,3),f.BorderPosition=2,N.Borders.push(f),D.forEach(function(Ia){Ia.HRa(3)}));return N};hd.prototype.zfg=function(f,D,N){var fa=We.g(this.$).Da.ywa(D[0],this.$.activeItemName),Ia=We.g(this.$).Da.X$(D[0],this.$.activeItemName),pb=[];if(void 0!==fa&&null!==fa&&(D=We.g(this.$).xka(D[0],fa),void 0!==D&&null!==D)){D=D.$$ge();for(fa=[];D.$$mn();){var Wb=D.$$cu();if(Wb.WF){pb.push(Wb);this.T3(this.T5(Wb),!0,10,f,"unmerge");Wb.cell.x1g();var Nc=Wb.cell.getRange();
this.T3(this.T5(Wb),!1,11,f,"unmerge");Ia.Bhg(Nc,!1);this.$lf&&(Wb=this.tPh(Wb,Nc),fa.push(Wb))}}0<pb.length&&(Ia.Gf.resetCellLookup(),this.pUj(pb,N,fa))}};hd.prototype.T3=function(f,D,N,fa,Ia){if(this.gif)return f!==D&&ld.ULS.sendTraceTag(526149323,0,50,"Merge Information for resultant cell is unexpectedly changed at step: {0}; Scenario: {1}; Command: {2}; Expected: {3}; Actual: {4}",N,fa,Ia,D?"populated":"empty",f?"populated":"empty"),f};hd.prototype.T5=function(f){return!!f.cell.cell.Merge};Object(Jb.a)(hd,
"MergeCellCommandAction",null,[]);var Nj=b(106),cj=b(491),Jk=b(394),gj=b(906);sc.prototype.loi=function(f){return 1896159024===f||-1554384558===f||-1113896058===f||1554436520===f||1415868706===f||674605324===f||1035996630===f};sc.prototype.$c=function(f,D){return 2054778433===D&&f&1?!ve.a(this.$).Kjc:600686207===D?!1:this.loi(D)&&gg.a.any(this.gridView.ga.va.selectedRanges,function(N){return N.Xf||N.isRow})&&!this.Ukf&&!this.Qkf?!0:this.ckc(f,D)};sc.prototype.executeCommand=function(f,D,N){return this.dc(D,
N)};sc.prototype.Mc=function(f,D,N){if(f=1===f)switch(D.command){case 1457172838:case 2036397036:case -287251124:case -1925065947:case 1764140053:case -1685033574:case -1590502662:case -571165336:case -1142465846:case -1150205178:case 1041132226:case -286432209:case -394785302:case -1116189897:case 1886928607:case -992833457:case 218524921:case 996232352:case -167499203:case -255094134:case -693675336:case 322710748:case 1097660126:case 155820588:case 1896159024:case -1554384558:case 504848446:case 1504715724:case 1872288872:case 41465729:case -1451655532:case 1972143101:case -475861485:case -978843926:case 2098035706:case -2142700828:case 1405660955:case 1983983164:case 478842689:case -798660877:case -653661711:case 862890474:case 963349338:case 1012765228:case 1597684571:case -1832800737:case -1920201820:case -1942512156:case -600086683:case -208772570:case -987339782:case 748067091:case -381232414:case 1696566924:case 894341014:case 165770524:case 277878202:case -844983198:case -2090948892:case 1690991812:case -1770246794:break;
case -1220714308:case -1649235364:case 524773427:case 1886217042:case 928057943:case -1526602249:f=ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextOrientationSlice3",!1);break;case -1077965542:case 909774670:case -1904244080:case -1293291468:case 324978188:case -1428968098:case 1970784898:case -803000997:case -128950598:case 1688184685:case 87208751:case -446735083:case 1650812936:case 673562736:case -1690267012:case -236759591:case -1803452024:case -2118943501:case 1890566896:case -1113896058:case 1415868706:case 1554436520:case 674605324:case 1035996630:case 886009118:case 165054436:case 1981714220:case -556441918:case 942362098:case 622604322:case 1405456548:case 284490184:case 1256700402:case -1756763834:case -1418159950:f=
!!N;break;case 862825906:case 1532790410:case 46555851:case -1522760979:f=!0;break;default:f=!1}return f};sc.prototype.nd=function(f,D,N){switch(D){case "PopulateFontColor":N.MenuItems=this.SB.vcc(1970784898,-803000997,null,-128950598,2036397036,1688184685,862825906,N.MenuId);break;case "PopulateFillColor":N.MenuItems=this.SB.vcc(1650812936,null,87208751,673562736,1457172838,-446735083,1532790410,N.MenuId);break;case "PopulateBorderColor":N.MenuItems=this.SB.vcc(-236759591,-1803452024,void 0,void 0,
void 0,void 0,46555851,N.MenuId);break;case "PopulateBorderStyle":this.borderFormatManager.b9h(N);break;case "PopulateFontDropdown":case "PopulateFontRTFDropdown":if(this.tu&&(this.Ded.Jwj(N.MenuId),!this.Ded.kni()))return!1;N.MenuItems=this.Ded.c_e(-1293291468,324978188,-1428968098,N.MenuId);break;default:return!1}return!0};sc.prototype.ckc=function(f,D){var N=We.g(this.$).ga.va.selectedRanges;return!(new ee.a(this.$.xa)).Tn(f,D,N,this.gridView)};sc.prototype.dc=function(f,D){var N=this,fa=this.gridView,
Ia=f.command,pb=ud.TaskExtensions.Dl(),Wb=!0;switch(Ia){case -1077965542:Wb=this.Y9e(D,f,!1);break;case 909774670:this.brb(Ia);Wb=this.Y9e(D,f,!0);break;case -1293291468:Wb=this.W9e(D,f,!1);break;case 324978188:ye.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&ld.ULS.sendTraceTag(574650248,0,50,"GridCommandHandler.HandleRibbonCommand: Handle font name preview");this.brb(Ia);Wb=this.W9e(D,f,!0);break;case 862890474:case 963349338:Wb=this.z8h(f);break;case -1832800737:Wb=
this.afc(Ia,D,!1,f);break;case 1970784898:Wb=this.afc(Ia,D,!1,f);break;case -803000997:Wb=this.afc(Ia,D,!1,f);break;case -128950598:case 1688184685:this.brb(Ia);Wb=this.afc(Ia,D,!0,f);break;case 1597684571:Wb=this.hyb(Ia,D,!1,f);break;case 87208751:D.Color="-1";D.IntColor=!0;Wb=this.hyb(Ia,D,!1,f);break;case -446735083:this.brb(Ia);D.Color="-1";D.IntColor=!0;Wb=this.hyb(Ia,D,!0,f);break;case 1650812936:Wb=this.hyb(Ia,D,!1,f);break;case 673562736:this.brb(Ia);Wb=this.hyb(Ia,D,!0,f);break;case -1904244080:case -1428968098:case 1457172838:case 2036397036:ye.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&
(f=$f.b().yi(Ia),ld.ULS.sendTraceTag(537159510,0,50,"GridCommandHandler.HandleRibbonCommand: Handle {0}",f));this.RXf(Ia);break;case -287251124:case -1925065947:case 1764140053:case -1685033574:case -1590502662:Wb=this.k8h(Ia,f);break;case -571165336:case -1142465846:case -1150205178:case 1041132226:case -286432209:case -394785302:case -1116189897:Wb=this.w7h(Ia,f);break;case -1803452024:case -236759591:Wb=this.wld(Ia,D,f);break;case -2118943501:Wb=this.borderFormatManager.G7h(D,f);break;case 1012765228:Wb=
this.borderFormatManager.p9h(D,f);break;case 1256700402:Wb=this.borderFormatManager.Bld(f);break;case -1756763834:Wb=this.borderFormatManager.Cld(f);break;case -1418159950:Wb=this.borderFormatManager.J9e(f);break;case -1920201820:case -1942512156:Wb=this.A8h(Ia,f);break;case -1690267012:case -600086683:case 165054436:case 1981714220:case -556441918:Wb=this.borderFormatManager.w9e(D,f);break;case 1890566896:case 1886928607:case -992833457:case 218524921:case 996232352:Wb=this.V8h(Ia,D,f);break;case -693675336:case 322710748:break;
case 1696566924:Wb=this.l8h(f);break;case -167499203:case -255094134:case 1097660126:case 155820588:pb=this.handleMergeCellsCommand(this.gridView,f);break;case 1896159024:case -1554384558:D=this.gridView.ga.va.selectedRanges;if(this.wDj(f,D))ld.ULS.sendTraceTag(574993492,0,50,"GridCommandHandler.HandleRibbonCommand: showing InsertDeleteCellsDialog"),(new ad(this.$,Ia,D)).mh(),Wb=!0;else if(gg.a.any(D,function(kd){return N.gridView.Tb.jya(kd)})){fa="";pb=1461300262;var Nc=-1554384558===Ia&&this.gridView.Tb.oqi(D[0]);
D=D[0].height>D[0].width&&!Nc;switch(Ia){case 1896159024:fa=D?"InsertColumnsTable":"InsertRowsTable";pb=D?622604322:942362098;break;case -1554384558:fa=D?"DeleteColumnsTable":"DeleteRowsTable",pb=D?284490184:1405456548}D=xg.a.fo(sc.xpd,fa,1);new bg.a(pb,1,2,6,null);pb=this.insertOrDeleteCells(D,f,!0)}else pb=this.insertOrDeleteCells(1896159024===Ia?1:2,f,!1);break;case 942362098:case 622604322:case 1405456548:case 284490184:pb=this.insertOrDeleteCells(xg.a.fo(sc.xpd,D[tf.a.od],1),f,!0);break;case -1113896058:case 1415868706:case 1554436520:case 674605324:case 1035996630:pb=
this.insertOrDeleteCells(xg.a.fo(sc.xpd,D[tf.a.od],1),f,!1);break;case 504848446:pb=fa.startEdit(!1,1,D[Bf.a.event],void 0,void 0,!0);break;case 1504715724:if(We.g(this.$).Nz&&this.borderFormatManager.EV.GB)break;pb=fa.startEdit(!0,0,D[Bf.a.event],void 0,void 0,!0);break;case 1872288872:this.Qrb();break;case 41465729:pb=this.fill(fa.ga.va.xd,null,0,1,f);break;case -1451655532:case 1972143101:pb=this.fillDownAbsoluteValueAndStartEdit(fa,D[Bf.a.event],-1451655532===Ia);break;case -475861485:pb=this.fill(fa.ga.va.xd,
null,fa.rtl?1:2,1,f);break;case -978843926:pb=this.fill(fa.ga.va.xd,null,3,1,f);break;case 2098035706:pb=this.fill(fa.ga.va.xd,null,fa.rtl?2:1,1,f);break;case -2142700828:pb=this.fill(fa.ga.sourceRange,fa.ga.va.xd,sc.t2e(fa.ga.va.xd,fa.ga.sourceRange),2,f);break;case 1405660955:pb=this.fill(fa.ga.sourceRange,fa.ga.va.xd,sc.t2e(fa.ga.va.xd,fa.ga.sourceRange),4,f);break;case 1983983164:pb=this.fill(fa.ga.va.xd,null,0,0,f);break;case 478842689:(f=this.$.da.Aa(376))?(f.X8i(),Wb=!0):ld.ULS.sendTraceTag(537159509,
0,15,"gridHighlightBehaviorEventManager is null for TouchAutoFill");break;case -798660877:case -653661711:case 165770524:case 277878202:case -844983198:case -2090948892:case 1690991812:Wb=fa.ga.dc(null,Ia);break;case -208772570:this.R8h();Wb=!0;break;case -987339782:this.O7h();Wb=!0;break;case -1770246794:fa.ga.P7h();Wb=!0;break;case 748067091:case -381232414:this.S7h(Ia);Wb=!0;break;case -1522760979:this.gridView.toggleFormulaView();Wb=!0;break;case 886009118:pb=this.x8h();break;case 894341014:this.C8h();
Wb=!0;break;case 862825906:pb=this.m$e(1970784898,f);break;case 1532790410:pb=this.m$e(1650812936,f);break;case 46555851:pb=this.N8h(f);break;default:Wb=!1}Wb||(pb=be.a(Ia));return pb};sc.prototype.wDj=function(f,D){var N=this,fa=gg.a.all(D,function(Wb){return!N.gridView.Tb.jya(Wb)}),Ia=1<D.length&&!!this.gridView.Tb.pkd(D),pb=gg.a.all(D,function(Wb){return!N.gridView.Tb.Qla(Wb)});D=!gg.a.any(D,function(Wb){return Wb.isRow||Wb.Xf});return 1===f.method&&6===f.ef&&(fa||Ia)&&pb&&D};sc.prototype.fillDownAbsoluteValueAndStartEdit=
function(f,D,N){var fa=this,Ia=f.ga.va.activeCell,pb=af.E(Ia,this.gridView.jt);return f.startEdit(!0,0,D).CWR(function(){var Wb=f.rc(pb),Nc=f.rc(Ia);if(!Wb||!Nc)return ld.ULS.shipAssertTag(537159507,0,!1,"GridCommandHandler.FillDownAbsoluteValueAndStartEdit Cannot get cells for active cell: {0} and above cell: {1}",Ia.toString(),pb.toString()),rg.Task.Sa(!1);fa.gridView.zc.text=N?Wb.U1:Wb.text;fa.gridView.zc.textBox.setCaretPositionToEnd();return rg.Task.Sa(!0)})};sc.prototype.insertOrDeleteCells=
function(f,D,N){function fa(){return new Zd(Xc)}var Ia=this,pb=Sg.a.create().toString(),Wb=Enum.toString(ik,f);this.gridView.Ri.t8(17,pb,Wb);Wb=this.gridView.ga.va.selectedRanges;var Nc=this.Ukf,kd=this.Qkf;if(!this.$.Br(null,!1,void 0,D.ef)&&!kd&&!Nc&&5!==f&&9!==f)return rg.Task.Sa(!0);2===f?f=kd?10:Nc?6:Wb[0].height>Wb[0].width?18:34:1===f?f=kd?9:Nc?5:Wb[0].height>Wb[0].width?17:33:18===f&&Nc?f=34:34===f&&kd&&(f=18);Wb=this.qMg(Wb,f);if((10===f||6===f)&&!this.$.Br(Wb,!0,1,D.ef))return rg.Task.Sa(!0);
var Xc={};Xc.InsertDeleteRangeItems=Array(Wb.length);Xc.SheetName=this.$.oa.sheetName;Xc.IsTableCommand=N;for(N=0;N<Wb.length;N++){Nc=Wb[N];var Ie={},Ze=kd=void 0;f&4?(Ie.FirstRow=Nc.top-1,Ie.LastRow=Ya.a.By,Ie.FirstColumn=0,Ie.LastColumn=Ya.a.yv,kd=Nc.bottom-Nc.top+1,Ze=0,6===f&&(Nc.Xf||(Ie.FirstRow=Nc.bottom),kd=-kd)):f&8?(Ie.FirstRow=0,Ie.LastRow=Ya.a.By,Ie.FirstColumn=Nc.left-1,Ie.LastColumn=Ya.a.yv,kd=0,Ze=Nc.right-Nc.left+1,10===f&&(Nc.isRow||(Ie.FirstColumn=Nc.right),Ze=-Ze)):f&16?(Ie.FirstRow=
Nc.top-1,Ie.LastRow=Nc.bottom-1,Ie.FirstColumn=Nc.left-1,Ie.LastColumn=Ya.a.yv,kd=0,Ze=Nc.right-Nc.left+1,18===f&&(Ie.FirstColumn=Nc.right,Ze=-Ze)):(Ie.FirstRow=Nc.top-1,Ie.LastRow=Ya.a.By,Ie.FirstColumn=Nc.left-1,Ie.LastColumn=Nc.right-1,kd=Nc.bottom-Nc.top+1,Ze=0,34===f&&(Ie.FirstRow=Nc.bottom,kd=-kd));Ie={InsertDeleteRange:Ie};Ie.DeltaRow=kd;Ie.DeltaColumn=Ze;Ie.AdjustedSelectedRange=af.j(Nc);Xc.InsertDeleteRangeItems[N]=Ie}this.gridView.Lg.xH(!1);var Sf=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:4932761_InsertDeleteCellsDecoupled");
Xc.IsDecoupleRecalc=Sf;var ag=this.$.na.ta.fc();return Sd.a(this.$.userOperationManager,function(og,Vg,Hh){Sf&&!ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5316173_RecoverableFromOOM")||Ia.$.Qy();var ji=Ia.$.na.ta;og=Pg.b(og,Ia.HSi);var kj=ji.Ma(41,void 0===ag?null:ag);kj.insertDeleteMultiRangeParameters=Xc;return Se.i(ji,"InsertDeleteCells",kj,og,Vg,Hh,pb,0)},function(og){return new Mf.a(237,0,og,void 0,fa)},D)};sc.prototype.qMg=function(f,D){return D&32?this.s_a(f,function(N){return N.bottom},
function(N){return N.top},function(N,fa){N.bottom=fa},!1,!0):D&16?this.gridView.rtl?this.s_a(f,function(N){return N.left},function(N){return N.right},function(N,fa){N.left=fa},!1,!1):this.s_a(f,function(N){return N.right},function(N){return N.left},function(N,fa){N.right=fa},!1,!1):D&4?this.s_a(f,function(N){return N.bottom},function(N){return N.top},function(N,fa){N.bottom=fa},!0,!0):D&8?this.gridView.rtl?this.s_a(f,function(N){return N.left},function(N){return N.right},function(N,fa){N.left=fa},
!0,!1):this.s_a(f,function(N){return N.right},function(N){return N.left},function(N,fa){N.right=fa},!0,!1):f};sc.prototype.s_a=function(f,D,N,fa,Ia,pb){f=af.d(f);f.sort(function(kd,Xc){return D(Xc)-D(kd)});if(Ia){Ia=[];pb=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5181014_DeletingLastTwoRowsColsFix")?pb?Ya.a.Sh+1:Ya.a.di+1:pb?Ya.a.By:Ya.a.yv;for(var Wb=0;Wb<f.length;Wb++){var Nc=f[Wb];N(Nc)<pb&&(fa(Nc,Math.min(D(Nc),pb-1)),Array.add(Ia,Nc),pb=N(Nc))}f=Ia}return f};sc.prototype.fill=function(f,
D,N,fa,Ia){function pb(){return new sb(kd,Xc,fa,N)}var Wb=this,Nc=this.$;if(!Nc.Br([D],!0))return rg.Task.Sa(!0);var kd=af.v(f,Nc),Xc=D?af.v(D,Nc):kd,Ie=this.$.na.ta.fc();return Sd.a(this.$.userOperationManager,function(Ze,Sf,ag){Wb.$.Qy();var og=Wb.$.na.ta,Vg=og.Ma(9,Ie);Vg.sourceRange=kd;Vg.targetRange=Xc;Vg.fillDirection=N;Vg.fillType=fa;return Se.i(og,"FillRange",Vg,Ze,Sf,ag,null,0)},function(Ze){return new Mf.a(155,0,Ze,void 0,pb)},Ia)};sc.prototype.V8h=function(f,D,N){var fa={ValidMembers:32};
switch(f){case 1890566896:f=parseInt(D[tf.a.od].toString(),10);if(14===f)return N=new bg.a(2105621672,N.method,N.mode,N.ef,N.tabName),D[tf.a.od]=null,this.$.Ka.dc(N,D),ld.ULS.sendTraceTag(537159506,0,50,"GridCommandHandler.HandleNumberFormatCommand: triggered NumberFormatDialog command, with menu item 14."),!0;fa.NumberFormat=f;break;case 1886928607:fa.NumberFormat=13;break;case -992833457:fa.NumberFormat=11;break;case 218524921:fa.NumberFormat=12;break;case 996232352:fa.NumberFormat=1006;break;default:return ld.ULS.shipAssertTag(537159505,
0,!1,"Unexpected number formatting command "+$f.b().yi(N.command)),!1}ld.ULS.sendTraceTag(537159504,0,50,"GridCommandHandler.HandleNumberFormatCommand: triggered {0} command, with menu item {1}.",$f.b().yi(N.command),D[tf.a.od]);this.Jh.formatCells(1890566896,fa,N);this.$.Cf();return!0};sc.prototype.z8h=function(f){var D=this.gridView.rc(this.gridView.ga.va.activeCell);if(this.Gb&&this.gridView.isEditing){D=this.gridView.Uj.j5a(D?Df.a(D).Font:null);if(!D)return ld.ULS.shipAssertTag(537159503,0,!1,
"GridCommandHandler.HandleIncreaseOrDecreaseFontSizeCommand: fontType for range {0} is null while editing",this.gridView.ga.va.activeCell.toString()),!1;var N=D.FontSize}else if(D)N=D.fontSize;else return!1;D=f.command;var fa=0;if(862890474===D)for(;fa<sc.IKa.length-1&&sc.IKa[fa]<=N;)fa++;else if(963349338===D)for(fa=sc.IKa.length-1;0<fa&&sc.IKa[fa]>=N;)fa--;ld.ULS.sendTraceTag(537159501,0,50,"GridCommandHandler.HandleIncreaseOrDecreaseFontSizeCommand: change font from size {0} to size {1}",N,sc.IKa[fa]);
if(N===sc.IKa[fa])return!0;N=sc.Zxc(2);N.Font.FontSize=sc.IKa[fa];this.Gb&&this.gridView.isEditing?(this.Lpb(f,!1,N),this.$.Cf()):this.Jh.formatCells(D,N,f);return!0};sc.prototype.Y9e=function(f,D,N){f=f[f[Xj.a.IsFreeForm]?Xj.a.Value:tf.a.Gg].toString();if(!sc.t4i.test(f))return ld.ULS.sendTraceTag(537159499,0,50,"GridCommandHandler.HandleFontSizeCommand: Font size in command ({0}) is not a number.",f),ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5115068_FontSizeCommandHandledForInvalidParameter")?
!0:!1;f=parseFloat(f);if(8>f||72<f)return ld.ULS.sendTraceTag(537159497,0,50,"GridCommandHandler.HandleFontSizeCommand: Font size in command ({0}) not within expected limits ({1} - {2}).",f,8,72),ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5115068_FontSizeCommandHandledForInvalidParameter")?!0:!1;var fa=Math.round(2*f)/2,Ia=sc.Zxc(2);Ia.Font.FontSize=fa;this.Gb&&this.gridView.isEditing?(this.Lpb(D,N,Ia,!0),fa===f||N||this.$.Cf()):N?this.Jh.Kea(this.gridView,-1077965542,Ia,N):(this.Jh.formatCells(-1077965542,
Ia,D),this.j1a());return!0};sc.prototype.W9e=function(f,D,N){var fa=f[tf.a.Gg];if(this.tu){var Ia=Ge.Qag?Ge.Qag[fa]:null;Ia||(ld.ULS.sendTraceTag(523903201,1,15,"GridCommandHandler.HandleFontFamilyCommand: font in supportedFontFamiliesNew is not found for {0}",fa),Ia=ca.HelperMethods.Zea[fa])}else Ia=ca.HelperMethods.Zea[fa];var pb=0;this.Nm&&(f=f.MenuItemId,"MinorThemeFont"===f?(fa==this.themesManager.qM.zuf&&(Ia=fa),pb=2):"MajorThemeFont"===f&&(fa==this.themesManager.qM.Tsf&&(Ia=fa),pb=1));if(!Ia)return!0;
fa=sc.Zxc(1);fa.Font.FontName=Ia;this.Nm&&(fa.Font.FontScheme=pb);this.Gb&&this.gridView.isEditing?(this.Lpb(D,N,fa),this.$.Cf()):N?this.Jh.Kea(this.gridView,-1293291468,fa,N):(this.Jh.formatCells(-1293291468,fa,D),this.j1a());return!0};sc.prototype.afc=function(f,D,N,fa){var Ia=-803000997===f||1688184685===f?"black":D.Color;this.moreColorsHelper&&(-1832800737===f?Ia=Ba.a.compare(Ia,"WindowText",!0)?this.moreColorsHelper.wIb:"black":N||(this.moreColorsHelper.wIb=Ia,this.moreColorsHelper.Qda(D,Ia,
fa)));f=sc.Zxc(32);f.Font.FontColor=Ea.a.NH(Ia,xg.a.Eg(D,"IntColor"));this.Gb&&this.gridView.isEditing?this.Lpb(fa,N,f,17===fa.ef):N?this.Jh.Kea(this.gridView,1970784898,f,N):(this.qD&&(N=this.getThemeColor(D),D=N.themeColor,N.returnValue&&(f.Font.ThemeFontColor=D,f.Font.ColorTypeOption=1)),this.Jh.formatCells(1970784898,f,fa),this.j1a());return!0};sc.prototype.S7h=function(f){var D=(new Date).format(748067091===f?this.$.ya.ShortDateFormat:this.$.ya.ShortTimeFormat),N=this.gridView.yj?zk.a(this.gridView.$):
this.gridView.zc;f=N.textBox;if(this.gridView.isEditing)N.insertText(D);else{var fa=ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChangeEditingModeAfterInsertDateOrTime",!1)?0:1;this.gridView.startEdit(!0,fa);N.text=D;D=D.length;f.RSa(D);f.caretPosition=D}};sc.prototype.R8h=function(){this.gridView.h6(this.gridView.ga.va.activeCell)||this.gridView.uxc||this.gridView.PNa()||this.gridView.mu(this.gridView.ga.va.activeCell,3,Nj.a.f9e)};sc.prototype.O7h=function(){if(!(this.gridView.uxc||
this.gridView.PNa()||this.gridView.isEditing&&bj.a.isMac)){var f=this.gridView.ga.va.g5;this.gridView.Kg(af.v(f,this.$),f,null,null,60,Nj.a.f9e)}};sc.prototype.l8h=function(f){var D=this;this.tbc=Tc.d(this.$.xa.oa);var N=this.$.da.Aa(254,!0);if(this.gridView.J7a)return this.gridView.Lg.xH(!1),!!N;if(!N)return ld.ULS.sendTraceTag(537159494,0,50,"GridCommandHandler.HandleFormatPainter : copyPasteInfrastructure is null"),!1;this.gridView.ga.oZ(this.Ued);var fa=String.format(Bf.a.Gua,Te.a.current.Bo(84));
this.gridView.Lg.Np(fa);f=new bg.a(-911352779,f.method,f.mode,f.ef,f.tabName);fa={};this.$.Ka.dc(f,(fa[Bf.a.silentClipboardAccessFailures]=!0,fa[Bf.a.isFormatPainter]=!0,fa)).continueWith(function(Ia){(6>Ia.status||6===Ia.status&&!Ia.result)&&D.Qrb()});this.gridView.J7a=!0;N.lKg(this.Qrb);return!0};sc.prototype.hyb=function(f,D,N,fa){var Ia=87208751===f?"-1":D.Color;this.moreColorsHelper&&(1597684571===f?Ia=this.moreColorsHelper.ccb:N||(this.moreColorsHelper.ccb=Ia===sc.notSet?sc.RZd:Ia,this.moreColorsHelper.Qda(D,
Ia,fa)));f={ValidMembers:64};f.FillColor=Ea.a.NH(Ia,xg.a.Eg(D,"IntColor"));N?this.Jh.Kea(this.gridView,1650812936,f,!0):(this.qD&&(N=this.getThemeColor(D),D=N.themeColor,N.returnValue&&(f.ThemeFillColor=D,f.ColorTypeOption=1)),this.Jh.formatCells(1650812936,f,fa),this.j1a());return!0};sc.prototype.C8h=function(){ld.ULS.sendTraceTag(537159493,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell Started handling the command");var f=this.$.da.Aa(221);if(f){var D=this.gridView.Uj;if(D){var N=f.whi(D.text,
D.textBox.caretPosition);var fa=N.Kvf;var Ia=N.WXe;(N=N.returnValue)?(f.isListVisible=!1,D.text=N,D.textBox.selectRange(fa,fa+Ia),ld.ULS.sendTraceTag(587534607,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell InsertFormulaArguments executed successfully")):ld.ULS.sendTraceTag(537159490,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell Can't insert formula arguments with current text and caret position.")}else ld.ULS.shipAssertTag(537159491,0,!1,"GridCommandHandler.HandleInsertFormulaArgumentsInCell No editor object")}else ld.ULS.sendTraceTag(537159492,
0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell No formulaAssistanceControl object")};sc.prototype.k8h=function(f,D){var N=0,fa=this.gridView,Ia=Df.a(fa.rc(null));this.Gb&&fa.isEditing&&(Ia.Font=fa.Uj.j5a(Ia.Font));var pb=Ia.Font;pb||(pb={ValidMembers:0});switch(f){case -287251124:N|=4;qk.e(pb,4)?pb.Bold=!pb.Bold:pb.Bold=!0;break;case -1925065947:N|=8;qk.e(pb,8)?pb.Italic=!pb.Italic:pb.Italic=!0;break;case 1764140053:N|=16;qk.e(pb,16)?pb.Underline=!pb.Underline:pb.Underline=!0;break;case -1685033574:N|=
64;qk.e(pb,64)?pb.DoubleUnderline=!pb.DoubleUnderline:pb.DoubleUnderline=!0;break;case -1590502662:N|=128,qk.e(pb,128)?pb.Strikethrough=!pb.Strikethrough:pb.Strikethrough=!0}if(!N)return!1;pb.ValidMembers=N;Ia.Font=pb;Ia.ValidMembers=16;this.Gb&&this.gridView.isEditing?this.Lpb(D,!1,Ia):(ye.EwaSettings.ma(676)||fa.Lg.xH(!1),this.Jh.formatCells(f,Ia,D));this.$.Cf();return!0};sc.prototype.w7h=function(f,D){var N=0,fa=this.gridView,Ia=Df.a(fa.rc(null));-571165336===f||1041132226===f||-394785302===f?
(N|=1,Ia.VerticalAlignment=xg.a.fo(sc.x_a,f.toString(),2)):sc.Wni(f)?(N|=2,this.u8h(Ia,f)):-1116189897===f&&(N|=8,Ia.Wrap=Ia.ValidMembers&8?!Ia.Wrap:!0);if(!N)return!1;Ia.ValidMembers=N;ye.EwaSettings.ma(676)||fa.Lg.xH(!1);this.Jh.formatCells(f,Ia,D);this.$.Cf();return!0};sc.prototype.u8h=function(f,D){!ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5049785_DisableTextAlignmentCommandFlipInRTL")&&this.$.isChromeRtl&&-1142465846!==D&&(D=-1150205178===D?-286432209:-1150205178);D=xg.a.fo(sc.x_a,D.toString(),
0);f.HorizontalAlignment=D===f.HorizontalAlignment?0:D};sc.prototype.INf=function(f,D,N,fa){var Ia=this,pb=!1;ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellPerfImprovement",!1)&&(pb=this.mnc.euf(D,N))&&We.g(this.$).Ri.D1(this.c$a,$h.BasicTelemetryCalculator.$R);return ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5364656_RefactorOutAwaitsInScriptSharpWithContinueWithAndLogExceptionsMethodV2")?this.Vaa(f,D,!1,pb,function(Wb){Ia.UTi(Wb,N,D,pb,fa)}):this.Vaa(f,D,!1,pb,function(Wb,
Nc,kd){Ia.WTi(Wb,Nc,kd,N,D,pb,fa)})};sc.prototype.handleMergeCellsCommand=function(f,D){var N=this;this.c$a=Sg.a.create().toString();var fa=null;fa=this.mnc.f4e();var Ia=jk.a(D.command),pb=this.mnc.Rli(D.command,fa),Wb=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5855030_MergeCellLogTelemetryForDataLossScenario"),Nc=0;Wb&&pb?Nc=Db.a.Ae():We.g(this.$).Ri.t8(4,this.c$a,Ia+", Scenario = "+fa.scenario.toString());Ia=f.ga.va.selectedRanges;ld.ULS.sendTraceTag(537159459,0,50,"GridCommandHandler.HandleMergeCellsCommand: Merge Command: {0}, Number of ranges: {1}, Ranges: {2}",
$f.b().yi(D.command),Ia.length,af.i(Ia,",",this.$,!1));Ia=ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellPerfImprovement",!1);f.Lg.xH(!1,Ia);if(10===xg.a.fo(sc.guf,D.command.toString(),10))return rg.Task.Sa(!1);var kd=ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellDataLossScenarioCse",!1);if(Ia&&kd)return pb?(Wb?this.UUd(fa,D,!0,!0,Nc):this.UUd(fa,D,!0),rg.Task.Sa(!0)):this.INf(f,D,fa,!1);var Xc=!1;Ia&&(Xc=this.mnc.euf(D,fa))&&We.g(this.$).Ri.D1(this.c$a,
$h.BasicTelemetryCalculator.$R);return ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5364656_RefactorOutAwaitsInScriptSharpWithContinueWithAndLogExceptionsMethodV2")?this.Vaa(f,D,!1,Xc,function(Ie){N.VTi(Ie,D,Xc)}):this.Vaa(f,D,!1,Xc,function(Ie,Ze,Sf){N.XTi(Ie,Ze,Sf,D,Xc)})};sc.prototype.Vaa=function(f,D,N,fa,Ia){function pb(Sf,ag,og){kd.$.Qy();Sf=Ia?Pg.b(Sf,Ia):Sf;Sf=Pg.b(Sf,Wb);return Se.f(kd.$.na.ta,Ie,Ze,N,Sf,ag,og,null,Xc)}function Wb(Sf){var ag=!!Sf&&!!Sf.RequestTelemetryData;We.g(kd.$).Ri.xma(kd.c$a,
Sf.StateId,ag?Sf.RequestTelemetryData.EcsOperationDuration:0,ag?Sf.RequestTelemetryData.EcsRequestDuration:0,ag?Sf.RequestTelemetryData.WfeRequestDuration:0)}function Nc(){return new cb(Ie,Ze)}var kd=this;Ia=void 0===Ia?null:Ia;var Xc=this.$.na.ta.fc(),Ie=xg.a.fo(sc.guf,D.command.toString(),10),Ze=af.r(f.ga.va.selectedRanges,f.$);return fa?ye.EwaSettings.uc()?Sd.a(this.$.userOperationManager,pb,function(Sf){return new Mf.a(156,0,Sf,64,Nc)},D):Sd.a(this.$.userOperationManager,pb,function(Sf){return new Pf.a(156,
0,Sf,void 0,Nc)},D):Sd.a(this.$.userOperationManager,pb,function(Sf){return new Mf.a(156,0,Sf,void 0,Nc)},D)};sc.prototype.UUd=function(f,D,N,fa,Ia){var pb=this;fa=void 0===fa?!1:fa;Ia=void 0===Ia?0:Ia;ld.ULS.sendTraceTag(537159457,0,50,"Merge cells with multiple values. isCalledBeforeCSE :- {0}",N);var Wb=We.g(this.$).rtl,Nc=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5855030_MergeCellLogTelemetryForDataLossScenario");Wb=Cf.a.ed(3,2,0,Wb?628:627,0,514846606,"MergeCellsLoseData");ud.TaskExtensions.Ba(Og.a(this.$).zi(Wb),
function(kd){kd=kd.result;if(fa){var Xc=Db.a.Ae()-Ia;ld.ULS.sendTraceTag(528779355,0,50,"Time taken to show Dialog in Data Loss Scenario is : {0}, and the user action is : {1}",Xc,kd)}0===kd?(ld.ULS.sendTraceTag(537159456,0,50,"MergeCellsLoseData Dialog: Ok pressed"),N?(fa&&Nc&&(kd=jk.a(D.command),We.g(pb.$).Ri.t8(4,pb.c$a,kd+", Scenario = "+f.scenario.toString())),pb.INf(We.g(pb.$),D,f,!0)):pb.Vaa(pb.gridView,D,!0,!1)):1===kd&&ld.ULS.sendTraceTag(537159455,0,50,"MergeCellsLoseData Dialog: Cancel pressed")},
this.$.la,11)};sc.prototype.Xpf=function(f,D,N,fa){D!==f&&ld.ULS.sendTraceTag(537159454,0,15,"MergeCellsLoseData flag as per client and server does not match. MergeCellsLoseData flag as per client is :- {0} and as per server is {1}. The scenario is:- {2}, The CSE is done:- {3}",D,f,N,fa)};sc.prototype.VTi=function(f,D,N){var fa=this;Mh.b(f,514846606)&&(ld.ULS.sendTraceTag(537159453,0,50,"Merge cells with multiple values"),Ik.a(this.$).ud.ME(514846606),f=We.g(this.$).rtl,f=Cf.a.ed(3,2,0,f?628:627,
0,514846606,"MergeCellsLoseData"),ud.TaskExtensions.Ba(Og.a(this.$).zi(f),function(Ia){Ia=Ia.result;0===Ia?(ld.ULS.sendTraceTag(537159452,0,50,"MergeCellsLoseData Dialog: Ok pressed"),fa.Vaa(fa.gridView,D,!0,N)):1===Ia&&ld.ULS.sendTraceTag(537159451,0,50,"MergeCellsLoseData Dialog: Cancel pressed")},this.$.la,11))};sc.prototype.XTi=function(f,D,N,fa,Ia){new Hd(this,f,D,N,fa,Ia)};sc.prototype.UTi=function(f,D,N,fa,Ia){var pb=this,Wb=!1;Mh.b(f,514846606)&&(Wb=!0,Ik.a(this.$).ud.ME(514846606),fa&&Ia?
window.setTimeout(function(){pb.Vaa(pb.gridView,N,!0,!0)},0):this.UUd(D,N,!1));this.Xpf(Wb,Ia,D.scenario,fa)};sc.prototype.WTi=function(f,D,N,fa,Ia,pb,Wb){new Ne(this,f,D,N,fa,Ia,pb,Wb)};sc.prototype.brb=function(f){var D=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation");if(D&&this.I0a!==f&&1461300262!==this.I0a){this.RXf(this.I0a);var N=$f.b().yi(f),fa=$f.b().yi(this.I0a);ld.ULS.sendTraceTag(537159450,0,50,"GridCommandHandler.CacheFontStyles: Style cached during {0} was restored before caching the style for {1} command.",
fa,N)}D&&(this.I0a=f);if(this.Gb&&this.gridView.isEditing)this.F0a||(this.F0a=this.gridView.Uj.formattedText);else if(!this.jB){this.jB=[];D=this.gridView.Daa("GridCommandHandler.CacheFontStyles",this.gridView.ga.va.selectedRanges);try{for(D.$$rst();D.$$mn();){var Ia=D.$$cu(),pb=Ia.cell.hasRichText;if(ye.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")){var Wb=$f.b().yi(f);ld.ULS.sendTraceTag(537159449,0,100,"GridCommandHandler.CacheFontStyles: Add CachedPreviewCellGroup following {0} command. isRichText({1}). Cache size is {2}",
Wb,pb,this.jB.length)}if(pb)Array.add(this.jB,Ud.oVg(Ia,Ia.cell.formattedText));else switch(f){case 673562736:case -446735083:Array.add(this.jB,Ud.D0c(Ia,Ia.backgroundColor));ye.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&!Ia.backgroundColor&&ld.ULS.sendTraceTag(537159448,0,100,"GridCommandHandler.CacheFontStyles: cached empty or null BackgroundColor. isNull({0})",!Ia.backgroundColor);break;case -128950598:case 1688184685:Array.add(this.jB,Ud.D0c(Ia,Ia.color));
ye.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&!Ia.color&&ld.ULS.sendTraceTag(537159447,0,100,"GridCommandHandler.CacheFontStyles: cached empty or null Color. isNull({0})",!Ia.color);break;case 909774670:Array.add(this.jB,Ud.pVg(Ia,Ia.fontSize));if(ye.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")){var Nc=gj.c(Ia.fontSize)?"null or undefined":Ia.fontSize.toString();ld.ULS.sendTraceTag(537159446,0,100,"GridCommandHandler.CacheFontStyles: cached font size is {0}",
Nc)}break;case 324978188:this.Nm?Array.add(this.jB,Ud.nVg(Ia,Ia.fontName,Ia.tba)):Array.add(this.jB,Ud.D0c(Ia,Ia.fontName)),ye.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&(Ia.fontName?ld.ULS.sendTraceTag(537159444,0,50,"GridCommandHandler.CacheFontStyles: cached FontName is ({0}) of length({1}).",gridRenderer.CanvasRendererGlobals.getFontNameForLogging(Ia.fontName),Ia.fontName.length):ld.ULS.sendTraceTag(537159445,0,100,"GridCommandHandler.CacheFontStyles: cached empty or null FontName. isNull({0})",
!Ia.fontName))}}}finally{D&&D.dispose()}}};sc.prototype.QHj=function(){return this.Gb&&this.gridView.isEditing?!this.F0a:!this.jB};sc.prototype.Nki=function(f){return!!this.jB&&this.jB.length>f&&!!this.jB[f].formattedText};sc.prototype.hcc=function(f){return this.jB[f].style};sc.prototype.YPh=function(f){return this.jB[f].size};sc.prototype.XPh=function(f){return this.jB[f].tba};sc.prototype.RXf=function(f){if(this.QHj())ye.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&
ld.ULS.sendTraceTag(537159443,0,100,"GridCommandHandler.RestoreCachedStyles: Nothing to restore following {0} command.",f);else{if(this.Gb&&this.gridView.isEditing)ye.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&(f=$f.b().yi(f),ld.ULS.sendTraceTag(537159442,0,50,"GridCommandHandler.RestoreCachedStyles: Restore style following {0} command. Formatted text is enabledand IsEditing is true.",f)),this.F0a&&(this.gridView.zc.formattedText=this.F0a);else for(var D=this.jB.length,
N=0;N<D;N++){var fa,Ia=this.jB[N].KKa.cell.getRange();if(fa=this.gridView.rc(Ia)){Ia=void 0;var pb=fa.WF?this.gridView.WKb(fa.range):(Ia=new Ab.a,Ia.add(fa),Ia);Ia=Cl(pb);for(pb=Ia.next();!pb.done;pb=Ia.next()){pb=pb.value;if(ye.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")){var Wb=$f.b().yi(f);ld.ULS.sendTraceTag(537159440,0,100,"GridCommandHandler.RestoreCachedStyles: Restore style following {0} command. formattedCell.Cell.HasRichText({1}). Cached item {2}. isMerge({3}). Cache size is {4}",
Wb,pb.cell.hasRichText,N,fa.WF,D)}if(pb.cell.hasRichText&&1457172838!==f)this.Nki(N)&&(pb.cell.formattedText=this.jB[N].formattedText,ye.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&!pb.cell.formattedText&&ld.ULS.sendTraceTag(537159439,0,100,"GridCommandHandler.RestoreCachedStyles: Setting FormattedText to null."));else switch(f){case 1457172838:pb.backgroundColor=this.hcc(N);ye.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&
!pb.backgroundColor&&ld.ULS.sendTraceTag(537159438,0,100,"GridCommandHandler.RestoreCachedStyles: Setting BackgroundColor to be empty or null. isNull({0}).",!pb.backgroundColor);break;case 2036397036:pb.color=this.hcc(N);ye.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&!pb.color&&ld.ULS.sendTraceTag(537159437,0,100,"GridCommandHandler.RestoreCachedStyles: Setting Color to be empty or null. isNull({0}).",!pb.color);break;case -1904244080:pb.fontSize=this.YPh(N);
ye.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&(pb=gj.c(pb.fontSize)?"null or undefined":pb.fontSize.toString(),ld.ULS.sendTraceTag(537159436,0,100,"GridCommandHandler.RestoreCachedStyles: Setting font size to {0}",pb));break;case -1428968098:Wb=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation"),this.Nm?(pb.QLb(this.hcc(N),Wb,"RestoreCachedStyles"),pb.M2f(this.XPh(N))):pb.QLb(this.hcc(N),Wb,"RestoreCachedStyles")}}}else ld.ULS.sendTraceTag(537159441,
0,50,"GridCommandHandler.RestoreCachedStyles: Cell is not supposed to be null. Cell range: {0}",Ia.AB(!1))}ye.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&(this.I0a=1461300262);this.j1a()}};sc.prototype.j1a=function(){this.Gb&&this.gridView.isEditing?this.F0a=null:this.jB=null;ye.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&ld.ULS.sendTraceTag(537159435,0,50,"GridCommandHandler.ClearCachedStyles: Cache cleared.")};sc.prototype.A8h=
function(f,D){var N={IndentationIncrease:0};if(-1942512156===f)N.IndentationIncrease=1;else if(-1920201820===f)N.IndentationIncrease=-1;else return!0;N.ValidMembers=256;this.Jh.formatCells(f,N,D);return!0};sc.prototype.x8h=function(){var f=this,D=We.g(this.$),N=af.r(D.ga.va.selectedRanges,this.$),fa=af.o(D.ga.va.activeCell,this.$);ld.ULS.sendTraceTag(42566215,0,50,"GridCommandHandler: HandleIgnoreErrorCommand Invoked.");return Sd.a(this.$.userOperationManager,function(Ia,pb,Wb){return Se.L(f.$.na.ta,
fa,N,Ia,pb,Wb,null)},function(Ia){return new Mf.a(201,0,Ia)},null)};sc.prototype.m$e=function(f,D){var N=null,fa=We.g(this.$).ga.va.selectedRanges;fa=this.gridView.Daa("MoreColors",fa,1,!0);try{for(fa.$$rst();fa.$$mn();){var Ia=fa.$$cu().cell;if(Ia){var pb=sc.black;if(1970784898===f)pb=Ia.color;else if(1650812936===f){var Wb=Ia.backgroundColor;pb=Ba.a.compare(Wb,sc.RZd,!0)&&Ba.a.compare(Wb,sc.empty,!0)?Ia.backgroundColor:sc.white}if(!N)N=pb;else if(N!==pb){N=sc.black;break}}}}finally{fa&&fa.dispose()}this.Gb&&
this.gridView.isEditing&&1970784898===f&&this.gridView.Uj.textBox.Hxe();return this.moreColorsHelper.Jya(f,D,N)};sc.prototype.N8h=function(f){var D=Lg.a.D5a(this.borderFormatManager.m4);return this.moreColorsHelper.Jya(-236759591,f,D)};sc.prototype.Lpb=function(f,D,N,fa){var Ia=this;fa=void 0===fa?!1:fa;D?this.gridView.Uj.LMf(N.Font):(this.qBi(f),fa?window.requestAnimationFrame(function(){ch.FocusManager.instance().mk($i.AFrame.sja);Ia.gridView.Uj.dZe(N.Font)}):(ch.FocusManager.instance().mk($i.AFrame.sja),
this.gridView.Uj.dZe(N.Font)),this.j1a())};sc.prototype.qBi=function(f){var D=jk.a(f.command);f=ci.a[f.ef]+"_"+Mj.a[f.method];var N=this.gridView.Ac.jBe.toString(),fa=new Map;fa.set("Command",D);fa.set("Source",f);fa.set("Ribbon","React");fa.set("CellTextRuns",N);Gj.Health.instance.recordKpiUsage(Jk.a.BJh,0,cj.a.rYf,fa)};sc.prototype.wld=function(f,D,N){f=this.borderFormatManager.wld(f,D,N);this.moreColorsHelper&&this.moreColorsHelper.Qda(D,this.borderFormatManager.m4,N);return f};sc.prototype.getThemeColor=
function(f){var D={};var N=!1;if((f.SqmControlId||"").includes("ThemeColorPicker")){if(!this.themesManager)return ld.ULS.sendTraceTag(537159433,0,10,"GridCommandHandler.GetThemeColor: Themes Manager is null"),{returnValue:!1,themeColor:D};N=this.themesManager.getThemeColor(f.Color);f=N.themeIndex;var fa=N.pCa;if(N=N.returnValue)D.ThemeColorIndex=f,D.ThemeColorRow=fa}return{returnValue:N,themeColor:D}};sc.Wni=function(f){return-1150205178===f||-1142465846===f||-286432209===f};sc.Zxc=function(f){var D=
{},N={};D.ValidMembers=16;D.Font=N;N.ValidMembers=f;return D};sc.t2e=function(f,D){var N=f.top<D.top?3:f.bottom>D.bottom?0:-1;return N=f.left<D.left?1:f.right>D.right?2:N};uk.Object.defineProperties(sc.prototype,{Ukf:{configurable:!0,enumerable:!0,get:function(){return gg.a.all(this.gridView.ga.va.selectedRanges,function(f){return f.isRow})}},Qkf:{configurable:!0,enumerable:!0,get:function(){return gg.a.all(this.gridView.ga.va.selectedRanges,function(f){return f.Xf})}},themesManager:{configurable:!0,
enumerable:!0,get:function(){this.Ex||(this.Ex=this.$.da.Aa(422));return this.Ex}}});uk.Object.defineProperties(sc,{t4i:{configurable:!0,enumerable:!0,get:function(){return sc.whe||(sc.whe=RegExp("^[0-9]+[.]?[0-9]*$"))}},xpd:{configurable:!0,enumerable:!0,get:function(){var f={};return sc.Uae||(sc.Uae=(f.InsertRows=5,f.InsertColumns=9,f.InsertCellsShiftRight=17,f.InsertCellsShiftDown=33,f.DeleteRows=6,f.DeleteColumns=10,f.DeleteCellsShiftLeft=18,f.DeleteCellsShiftUp=34,f.DeleteRowsTable=6,f.DeleteColumnsTable=
10,f.InsertRowsTable=5,f.InsertColumnsTable=9,f))}},x_a:{configurable:!0,enumerable:!0,get:function(){var f={};return sc.jib||(sc.jib=(f["-394785302"]=0,f["-571165336"]=2,f["1041132226"]=1,f["-1150205178"]=1,f["-1142465846"]=2,f["-286432209"]=3,f))}},guf:{configurable:!0,enumerable:!0,get:function(){var f={};return sc.Lee||(sc.Lee=(f["-167499203"]=2,f["-255094134"]=5,f["1097660126"]=6,f["155820588"]=7,f))}}});sc.RZd="transparent";sc.notSet="-1";sc.black="#000000";sc.empty="";sc.white="#FFFFFF";sc.Uae=
null;sc.jib=null;sc.Lee=null;sc.whe=null;sc.IKa=[8,9,10,11,12,14,16,18,20,24,26,28,36,48,72];Object(Jb.a)(sc,"GridCommandHandler",null,[434]);var hl=Mc.a;Am(Pb,hl);Pb.prototype.Qd=function(){var f=this;if(ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5680290_AddBorderFormatManagerFactory")){var D=mf.GetServiceTaskFactory.create(this.$.da,111,this.la,this.ub),N=mf.GetServiceTaskFactory.create(this.$.da,18,this.la,this.ub),fa=mf.GetServiceTaskFactory.create(this.$.da,397,this.la,this.ub),Ia=mf.GetServiceTaskFactory.Ua(this.$.da,
296,468,this.ub);ud.TaskExtensions.Ba(ud.TaskExtensions.we([D,N,fa,Ia],this.la),function(){f.Jd([new sc(f.$,We.g(f.$),N.result,D.result,Ia.result,fa.result,new Ge(f.$))])},this.la,3)}else{var pb=mf.GetServiceTaskFactory.create(this.$.da,111,this.la,this.ub),Wb=mf.GetServiceTaskFactory.create(this.$.da,18,this.la,this.ub),Nc=mf.GetServiceTaskFactory.create(this.$.da,102,this.la,this.ub),kd=mf.GetServiceTaskFactory.create(this.$.da,397,this.la,this.ub);ud.TaskExtensions.Ba(ud.TaskExtensions.we([pb,
Wb,Nc,kd],this.la),function(){f.Jd([new sc(f.$,We.g(f.$),Wb.result,pb.result,new hk.BorderFormatManager(f.$,Wb.result,Nc.result),kd.result,new Ge(f.$))])},this.la,3)}};Pb.ka=function(f){Mc.a.je(80,new Pb(f))};Object(Jb.a)(Pb,"GridCommandHandlerFactory",Mc.a,[]);var kk=b(30),rk=b(213),al=b(1257);fb.prototype.dispose=function(){var f=this;this.deactivate();this.gridView&&(this.tableManager.MUf(this.qFf),this.gridView.Lgj(this.JCf),this.gridView.Mgj(this.KCf),this.$.xa.Ag(this.Ie),this.$.Ab.Ag(this.Ie),
this.qve(function(D){D.WMd(f.kMa)}));this.gridView=this.tableManager=this.Aha=null};fb.prototype.wCc=function(f,D,N,fa){if(!Tc.b(this.$.oa)||this.$.ea.isNamedObjectViewMode||this.gridView.rb.KUa)return!0;if(!N.length)return!1;var Ia=fa.length;if(fa[Ia-1]<f.left)return!1;var pb=ca.HelperMethods.Nx(new rk.a(fa),0,Ia,f.left,ca.HelperMethods.uD);if(0>pb)return!1;var Wb=f.Vcg,Nc=!!f.C0a&&0<f.C0a.length,kd=!!f.menuModel&&0<f.menuModel.length,Xc=pb,Ie=0;for(Ia=Math.min(Wb.length+pb,Ia);Xc<Ia;Xc++,Ie++)if(pb=
N[Xc],!ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5317457_ToggleHeaderSnapping_JSCrash_Fix")||pb){var Ze=null,Sf=pb.getElementsByClassName(kk.a.Zbd);Sf&&(Ze=Sf[0]);if(Ze&&Ze.innerText){if(Sf=pb.getElementsByClassName(kk.a.Yse))for(var ag=Sf.length-1;0<=ag;ag--)pb.removeChild(Sf[ag]);Sf=fa[Xc];D?(Ze.innerText=Wb[Ie],pb.classList.add(kk.a.DUe),Nc&&f.C0a[Ie]&&(Ze=document.createElement("div"),Ze.innerHTML=f.C0a[Ie],kd&&f.menuModel[Ie]&&this.KFg(f,Ie,Sf),pb.appendChild(Ze.firstChild))):(pb.classList.remove(kk.a.DUe),
Ze.textContent=Si.Range.hV(Sf),this.ymh(Sf))}}f.RTa=D;return!0};fb.prototype.KFg=function(f,D,N){this.$.da.Ya(8,function(fa){fa.zac.fSi(f,D,N)})};fb.prototype.ymh=function(f){this.$.da.Ya(8,function(D){D.zac.gSi(f)})};fb.prototype.C9f=function(f,D,N,fa){for(var Ia=!1,pb=this.R4h(f,D),Wb=this.Aha.length-1;0<=Wb;Wb--){var Nc=this.Aha[Wb];D>=Nc.left&&f<=Nc.right&&(this.wCc(Nc,!1,N,fa),Array.removeAt(this.Aha,Wb),Ia=!0)}f=0;for(D=pb.length;f<D;f++)this.wCc(pb[f],!0,N,fa)&&(Array.add(this.Aha,pb[f]),Ia=
!0);return Ia};fb.prototype.activate=function(){this.qe()&&!this.active&&(this.gridView.view.nt(this.ax),this.active=!0)};fb.prototype.deactivate=function(){this.active&&(this.gridView.view.fr(this.ax),this.active=!1)};fb.prototype.qe=function(){return Tc.b(this.$.oa)&&!this.$.ea.isNamedObjectViewMode&&0>=this.gridView.rb.OP&&0<this.tableManager.rangeList.length};fb.prototype.qve=function(f){var D=ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ApplyHeaderSnappingOnVerticalFreezePane",
!1)?this.gridView.xrc:[this.gridView.a4];D=Cl(D);for(var N=D.next();!N.done;N=D.next()){N=Cl(N.value);for(var fa=N.next();!fa.done;fa=N.next()){fa=Cl(fa.value);for(var Ia=fa.next();!Ia.done;Ia=fa.next())f(Ia.value)}}};fb.prototype.R4h=function(f,D){var N=[];if(!this.active)return N;this.BOa=this.gridView.Ekd();for(var fa=this.tableManager.rangeList.length-1;0<=fa;fa--){var Ia=this.tableManager.rangeList[fa];Ia.bottom>=this.BOa&&this.Dkd(Ia)<=this.BOa&&Ia.left>=f&&Ia.right<=D&&Ia.Pba&&Array.add(N,
Ia)}return N};fb.prototype.Dkd=function(f){var D=this.gridView.Tb.Wj(f);return D&&this.tableManager.aif(f,D.usedRange.topLeft)?f.top+1:f.top};Object(Jb.a)(fb,"HeaderSnappingFeature",null,[3]);var Kk=lh.a;Am(va,Kk);va.prototype.create=function(){var f=this,D=mf.GetServiceTaskFactory.create(this.$.da,134,this.la,this.ub);ud.TaskExtensions.Ba(ud.TaskExtensions.we([D],this.la),function(){f.Eb(f.$.da.Aa(68)||new fb(D.result,We.g(f.$)))},this.la,11)};va.ka=function(f){f.da.Ha(67,new va(f))};Object(Jb.a)(va,
"HeaderSnappingFactory",lh.a,[]);var Zj=b(1310),Bk=b(1039),wg=lh.a;Am(Kc,wg);Kc.prototype.create=function(){var f=this,D=this.$.da,N=mf.GetServiceTaskFactory.create(D,134,this.la,this.ub),fa=mf.GetServiceTaskFactory.Ua(D,213,214,this.ub);ud.TaskExtensions.Ba(ud.TaskExtensions.we([N,fa],this.la),function(){if(ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ServiceInit",!1))f.Eb(Object(Bk.a)(f.$.da,1,function(){var pb=new Zj.CellAutoCompleteControl(f.$,N.result);fa.result.ka(pb);return pb}));
else{var Ia=D.Aa(1);Ia||(Ia=new Zj.CellAutoCompleteControl(f.$,N.result),fa.result.ka(Ia));f.Eb(Ia)}},this.la,3)};Kc.ka=function(f){f.da.Ha(151,new Kc(f))};Object(Jb.a)(Kc,"CellAutoCompleteControlFactory",lh.a,[]);Zc.prototype.dispose=function(){this.O_d();this.$_a=null};Zc.prototype.ka=function(f){f&&(this.$_a=f,f.OXc(this.wFf),f.w3(this.xFf),f.tJg(this.yFf))};Zc.prototype.O_d=function(){this.$_a&&(this.$_a.zMd(this.wFf),this.$_a.dea(this.xFf),this.$_a.Wgj(this.yFf))};Object(Jb.a)(Zc,"CellAutoCompleteReadoutHandler",
null,[757,3]);var wk=lh.a;Am(Uc,wk);Uc.prototype.create=function(){var f=this,D=this.$.da;ud.TaskExtensions.Ba(mf.GetServiceTaskFactory.Ua(D,211,212,this.ub),function(N){if(ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ServiceInit",!1))f.Eb(Object(Bk.a)(D,213,function(){return new Zc(N.result,D)}));else{var fa=D.Aa(213)||new Zc(N.result,D);f.Eb(fa)}},this.la,3)};Uc.ka=function(f){f.da.Ha(214,new Uc(f))};Object(Jb.a)(Uc,"CellAutoCompleteReadoutHandlerFactory",lh.a,[]);ac.Vsh="ewa-dv";
ac.Wsh="ewa-dv-buttonarea";ac.csh="ewa-dlb";ac.iDb="list-table";ac.listItem="list-item";ac.dDb="list-item-selected";ac.jDb="list-table-touch";ac.Ush="ewa-dpb";ac.Nmh="dv-prompt-title";ac.Mmh="dv-prompt-message";Object(Jb.a)(ac,"CssClassNames",null,[]);var Mi=b(562),Lk=b(47),dj=b(459),xk=b(1035),Ki=Vf.ErrorDialog;Am(mb,Ki);mb.prototype.dispose=function(){We.g(this.$).ga.xG(this.ld);Ki.prototype.dispose.call(this)};mb.prototype.setFocus=function(){switch(this.error.Severity){case 0:var f=4;break;case 1:f=
3;break;case 2:f=0;break;default:f=this.closeAction}(f=this.getButton(f))?f.get_element().focus():Ki.prototype.setFocus.call(this)};mb.prototype.isb=function(){var f=We.g(this.$);f.isEditing&&f.zc.endEdit(!1,"DataValidationErrorDeprecatedDialog.CommitAfterClosing",0);4===this.returnValue&&this.GWd(1);if(2===this.returnValue||0===this.returnValue){var D=f.rc(null);if(D){f.Da.wW();var N=Object.assign(new ta.a,{Text:D.originalText});f.setCell(N,D.range,0,63,null)}this.$.ae(-798660877,tf.a.$b,8,null)}Ki.prototype.isb.call(this)};
mb.prototype.Jta=function(){var f=We.g(this.$);f.isEditing&&f.zc.endEdit(!1,"DataValidationErrorDeprecatedDialog.CancelAfterClosing",0);3===this.returnValue&&this.GWd(0);Ki.prototype.Jta.call(this)};mb.prototype.GWd=function(f){var D=We.g(this.$);ud.TaskExtensions.Ba(D.startEdit(!1,f),function(){var N=D.zc.textBox;N.text&&N.selectRange(0,N.text.length)},this.la,11,Vc.a.current)};mb.JR=function(f,D,N){N=D.da.Aa(14).Y4a(N);f.MessageId=-1083021405;f.MessageIdName="DataValidationError";f.MessageIdHash=
Lg.a.sw(f.MessageIdName);f.Severity=N?N.Gad:1;D=(null===N||void 0===N?0:N.YJa)?Lg.a.Rf(N.YJa):null;N=(null===N||void 0===N?0:N.error)?Lg.a.Rf(N.error):String.format("<p>{0}</p><p>{1}</p>",oe.a.instance.fa(877),oe.a.instance.fa(878));switch(f.Severity){case 0:f.Appearance=18;break;case 1:f.Appearance=12;N+=String.format("<p>{0}</p>",oe.a.instance.fa(879));break;default:f.Appearance=3}f.Caption=D;f.Description=N;f.HelpDescription=oe.a.instance.fa(1276);f.HelpTopicId=xk.a.UJe;return f};Object(Jb.a)(mb,
"DataValidationErrorDeprecatedDialog",Vf.ErrorDialog,[]);var yk=b(194),Ck=b(176),Yj=Bj.a;Am(qb,Yj);qb.prototype.dispose=function(){this===this.yb.jq&&(this.yb.jq=null);Ag.a.Fa(this.Hm);this.Hm=null;Yj.prototype.dispose.call(this)};qb.prototype.avj=function(){this.dv&&this.dv.error?this.errorMessage=this.dv.error:this.dv&&this.dv.options&1?(ld.ULS.sendTraceTag(537163289,0,50,"DataValidationErrorDialog.SetDialogProps, Data validation Error opened on a list rule."),this.errorMessage=oe.a.instance.fa(1689),
this.gbf=Te.a.current.Bo(96)):(this.errorMessage=oe.a.instance.fa(1688),this.ASh(this.ZPe));var f=this.dv?this.dv.Gad:1,D={};this.Maa=(D[qb.Cz]=this.Cc,D.errorDescription=this.errorMessage,D.helpImageUri=this.gbf,D);switch(f){case 0:this.lc=1;this.Bc(1,"Retry");this.Maa.dialogIcon=2;this.ykf=!0;break;case 1:this.lc=4;this.Maa.dialogIcon=1;this.Maa.additionalInformation=oe.a.instance.fa(879);break;default:this.lc=1,this.Maa.dialogIcon=3}f={};this.Maa.helpLink=(f.type="AppLinkProps",f[qb.Cz]=this.error.HelpTopicId,
f.text=oe.a.instance.fa(1276),f.handler=this.W$a,f);f=Cf.a.rZc([this.error]);D={};this.NV=(D[Bf.a.kac]=!0,D[Bf.a.Vcd]=f,D[Bf.a.Wcd]=Ck.a(this.$).Rub(this.error.MessageIdHash),D[Bf.a.UV]=this.Cc,D.DismissHandler=this.pDd,D);f={};this.Maa.giveFeedbackLink=(f.type="AppLinkProps",f[qb.Cz]=Bf.a.dld,f.text=oe.a.instance.fa(1725),f.handler=this.$Ri,f)};qb.prototype.ASh=function(f){var D=this.$.na.ta.fc();Se.u(this.$.na.ta,af.q(f,this.$),Pg.b(this.yQi),Pg.a(this.xQi),null,D)};qb.prototype.x1h=function(f){switch(f.RuleType){case 1:switch(f.ConditionType){case 0:var D=
oe.a.instance.Bb(107);return String.format(D,f.LowerBoundary,f.UpperBoundary);case 1:return D=oe.a.instance.Bb(108),String.format(D,f.LowerBoundary,f.UpperBoundary);case 2:return D=oe.a.instance.Bb(109),String.format(D,f.LowerBoundary);case 3:return D=oe.a.instance.Bb(110),String.format(D,f.LowerBoundary);case 4:return D=oe.a.instance.Bb(111),String.format(D,f.LowerBoundary);case 5:return D=oe.a.instance.Bb(112),String.format(D,f.UpperBoundary);case 6:return D=oe.a.instance.Bb(113),String.format(D,
f.LowerBoundary);case 7:return D=oe.a.instance.Bb(114),String.format(D,f.UpperBoundary);default:return"we couldn't get the details"}case 2:switch(f.ConditionType){case 0:return D=oe.a.instance.Bb(115),String.format(D,f.LowerBoundary,f.UpperBoundary);case 1:return D=oe.a.instance.Bb(116),String.format(D,f.LowerBoundary,f.UpperBoundary);case 2:return D=oe.a.instance.Bb(117),String.format(D,f.LowerBoundary);case 3:return D=oe.a.instance.Bb(118),String.format(D,f.LowerBoundary);case 4:return D=oe.a.instance.Bb(119),
String.format(D,f.LowerBoundary);case 5:return D=oe.a.instance.Bb(120),String.format(D,f.UpperBoundary);case 6:return D=oe.a.instance.Bb(121),String.format(D,f.LowerBoundary);case 7:return D=oe.a.instance.Bb(122),String.format(D,f.UpperBoundary);default:return"we couldn't get the details"}case 4:switch(f.ConditionType){case 0:return D=oe.a.instance.Bb(123),String.format(D,f.LowerBoundary,f.UpperBoundary);case 1:return D=oe.a.instance.Bb(124),String.format(D,f.LowerBoundary,f.UpperBoundary);case 2:return D=
oe.a.instance.Bb(125),String.format(D,f.LowerBoundary);case 3:return D=oe.a.instance.Bb(126),String.format(D,f.LowerBoundary);case 4:return D=oe.a.instance.Bb(127),String.format(D,f.LowerBoundary);case 5:return D=oe.a.instance.Bb(128),String.format(D,f.UpperBoundary);case 6:return D=oe.a.instance.Bb(129),String.format(D,f.LowerBoundary);case 7:return D=oe.a.instance.Bb(130),String.format(D,f.UpperBoundary);default:return"we couldn't get the details"}case 5:switch(f.ConditionType){case 0:return D=
oe.a.instance.Bb(131),String.format(D,f.LowerBoundary,f.UpperBoundary);case 1:return D=oe.a.instance.Bb(132),String.format(D,f.LowerBoundary,f.UpperBoundary);case 2:return D=oe.a.instance.Bb(133),String.format(D,f.LowerBoundary);case 3:return D=oe.a.instance.Bb(134),String.format(D,f.LowerBoundary);case 4:return D=oe.a.instance.Bb(135),String.format(D,f.LowerBoundary);case 5:return D=oe.a.instance.Bb(136),String.format(D,f.UpperBoundary);case 6:return D=oe.a.instance.Bb(137),String.format(D,f.LowerBoundary);
case 7:return D=oe.a.instance.Bb(138),String.format(D,f.UpperBoundary);default:return"we couldn't get the details"}case 6:switch(f.ConditionType){case 0:return D=oe.a.instance.Bb(139),String.format(D,f.LowerBoundary,f.UpperBoundary);case 1:return D=oe.a.instance.Bb(140),String.format(D,f.LowerBoundary,f.UpperBoundary);case 2:return D=oe.a.instance.Bb(141),String.format(D,f.LowerBoundary);case 3:return D=oe.a.instance.Bb(142),String.format(D,f.LowerBoundary);case 4:return D=oe.a.instance.Bb(143),String.format(D,
f.LowerBoundary);case 5:return D=oe.a.instance.Bb(144),String.format(D,f.UpperBoundary);case 6:return D=oe.a.instance.Bb(145),String.format(D,f.LowerBoundary);case 7:return D=oe.a.instance.Bb(146),String.format(D,f.UpperBoundary);default:return"we couldn't get the details"}case 3:return D=oe.a.instance.Bb(105),String.format(D,f.LowerBoundary);case 7:return D=oe.a.instance.Bb(106),String.format(D,f.LowerBoundary);default:return"we couldn't get the details"}};qb.prototype.GWd=function(f){var D=We.g(this.$);
ud.TaskExtensions.Ba(D.startEdit(!1,f),function(){var N=D.zc.textBox;N.text&&N.selectRange(0,N.text.length)},this.la,11,Vc.a.current)};qb.JR=function(f,D,N){D=D.da.Aa(14).Y4a(N);f.MessageId=-1083021405;f.MessageIdName="DataValidationError";f.MessageIdHash=Lg.a.sw(f.MessageIdName);f.Severity=D?D.Gad:1;f.HelpDescription=oe.a.instance.fa(1276);f.HelpTopicId=xk.a.UJe;return f};uk.Object.defineProperties(qb.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"DataValidationErrorDialog"}},
la:{configurable:!0,enumerable:!0,get:function(){this.Hm=this.Hm||new yk.a;return this.Hm.token}}});Object(Jb.a)(qb,"DataValidationErrorDialog",Bj.a,[459,460,3,421]);var lk=b(1118),Dk=b(405),mk=lk.a;Am(Sb,mk);Sb.prototype.dispose=function(){this.dataValidationControl=null;mk.prototype.dispose.call(this)};Sb.prototype.Yh=function(f,D){this.dataValidationControl.Za=this.Za;var N=f.keyCode;return 1461300262!==D||16!==N&&17!==N&&18!==N?mk.prototype.Yh.call(this,f,D):!1};Sb.prototype.uCd=function(){this.BW&&
(this.dataValidationControl.Za=this.Za,this.dataValidationControl.show(this.dataValidationControl.hS,!0,!0,bj.a.zp||3===tf.a.$b))};Sb.prototype.Rg=function(){};Sb.prototype.mj=function(){this.dataValidationControl.show(this.dataValidationControl.hS,!0,!0,bj.a.zp||3===tf.a.$b)};Sb.prototype.YId=function(f,D){return this.dataValidationControl.Yh(D)};uk.Object.defineProperties(Sb.prototype,{uAb:{configurable:!0,enumerable:!0,get:function(){return Object(td.a)(qb,this.$.yb.rh)}},BW:{configurable:!0,enumerable:!0,
get:function(){return this.dataValidationControl.isListVisible},set:function(f){this.dataValidationControl.isListVisible=f}},KMa:{configurable:!0,enumerable:!0,get:function(){return!1}},key:{configurable:!0,enumerable:!0,get:function(){return Dk.a.h8c}}});Object(Jb.a)(Sb,"DataValidationListAutoCompleteBehavior",lk.a,[]);var Ek=b(1052),Sk=b(1117),fk=Ek.a;Am(xb,fk);xb.prototype.dispose=function(){fk.prototype.dispose.call(this);this.hDb=this.jnb=null};xb.prototype.lfa=function(f,D,N,fa){if(f&&(!f||
f.length)){this.y8(!1);this.eJa=f;this.QW=[];for(var Ia=0;Ia<f.length;Ia++)this.QW[Ia]=f[Ia]?f[Ia].Name:null;Ia=String.format("<table class='{0}' aria-live='polite'><tbody>",this.Kca);var pb="",Wb="";f=0;var Nc=We.g(this.$).rc(null);fa=this.isEditing?fa?fa.text:this.editText:Nc?Nc.originalText:null;Nc=!fa;var kd=0;Array.clear(this.QGb);var Xc=[],Ie=[],Ze=[],Sf=fa?fa.split(" "):[""];fa=fa.trim();for(var ag={},og=0;og<this.QW.length;ag={fGc:ag.fGc},og++){var Vg=this.QW[og],Hh=void 0;ag.fGc=Vg.split(" ");
Hh=gg.a.all(Sf,function(Ej){return function(Rh){return gg.a.any(Ej.fGc,function(Zk){return Ba.a.kM(Zk,Rh)})}}(ag));var ji=!Vg,kj=Array.contains(Ze,Vg);ji||kj||this.isEditing&&!Hh||(Hh=Vg?Lg.a.Rf(Lg.a.F9b(Vg)):"",Hh=String.format("<tr>\r\n\t<td class='{0}'>{1}</td>\r\n</tr>",this.f0,Hh),Array.add(Ze,Vg),this.isEditing&&Ba.a.kM(Vg,fa)?(pb+=Hh,Array.add(Xc,og)):(Wb+=Hh,Array.add(Ie,og)),!Nc&&Ba.a.equals(fa,Vg,!0)&&(f=this.isEditing?Xc.length-1:kd,Nc=!0),kd++)}this.QOa=kd;Array.addRange(this.QGb,Xc);
Array.addRange(this.QGb,Ie);this.pg.innerHTML=Ia+(pb+Wb+"</tbody></table>");Ia=this.Un=$a.DOMElementExtensions.Ij(this.domElement,this.Kca);this.Vob(Ia,D);this.y8(!0);this.ata(D,N);this.al=0<this.QOa?Ia.rows[f]:null}};xb.prototype.SSa=function(f){var D=!1;this.isEditing&&f&&(D=!this.QOa,f.endEdit(D,"DataValidationListBox.SetCellContent",0));if(!D&&(f=We.g(this.$),D=f.rc(null))){var N=null;this.vea&&-1!==this.vea.SheetId&&-1!==this.vea.Row&&-1!==this.vea.Column&&(N={},N.SheetName=this.vea.SheetId.toString(),
N.FirstRow=this.vea.Row,N.FirstColumn=this.vea.Column,N={ParameterType:6,SourceRange:N});var fa=Object.assign(new ta.a,{Text:this.ve});f.setCell(fa,D.range,0,63,N)}return!0};xb.prototype.ata=function(f,D){var N=f?this.TDb:this.xI;f=f?this.Nlc:this.Olc;0>=this.QOa?this.pg.style.height=ca.HelperMethods.Yb(f):(this.pg.style.height="auto",this.QOa>N?($a.DOMElementExtensions.UG(this.pg,this.DWj?Math.floor(f*N):Math.floor(this.pg.offsetHeight*N/this.QOa)),this.pg.style.overflowY="auto"):(this.pg.style.height=
"auto",this.pg.style.overflowY="hidden"));$a.DOMElementExtensions.nr(this.pg,D);$a.DOMElementExtensions.nr(this.Un,D-(this.QOa>N?fj.a.Mp:0))};uk.Object.defineProperties(xb.prototype,{al:{configurable:!0,enumerable:!0,get:function(){return this.jnb},set:function(f){this.vCa(this.jnb);if(f){this.jnb=f;this.hDb.innerText="";this.vCa(this.jnb);var D=this.QGb[f.rowIndex];this.ve=this.QW[D];this.eJa&&(this.vea=this.eJa[D],ld.ULS.shipAssertTag(537163286,0,!this.QGb.length||!!this.vea,"DataValidationListBox.SelectedRow: Did not find corresponding DataValidationListItem"));
this.hDb.innerText=this.ve;this.$wc(f)}else this.vea=this.ve=null}},isEditing:{configurable:!0,enumerable:!0,get:function(){return We.g(this.$).isEditing}},editText:{configurable:!0,enumerable:!0,get:function(){return We.g(this.$).zc.text}}});Object(Jb.a)(xb,"DataValidationListBox",Ek.a,[]);var ej=b(248),nk=b(108),gi=b(177),Mk=Ug.a;Am(Xb,Mk);Xb.prototype.AXc=function(f){this.get_events().addHandler("ClickButton",f)};Xb.prototype.lMd=function(f){this.get_events().removeHandler("ClickButton",f)};Xb.prototype.NXc=
function(f){this.get_events().addHandler("KeyDown",f)};Xb.prototype.yMd=function(f){this.get_events().removeHandler("KeyDown",f)};Xb.prototype.k0b=function(f){this.get_events().addHandler("PointerOver",f)};Xb.prototype.KMd=function(f){this.get_events().removeHandler("PointerOver",f)};Xb.prototype.j0b=function(f){this.get_events().addHandler("PointerOut",f)};Xb.prototype.JMd=function(f){this.get_events().removeHandler("PointerOut",f)};Xb.prototype.$ob=function(f){this.get_events().addHandler("Blur",
f)};Xb.prototype.hJb=function(f){this.get_events().removeHandler("Blur",f)};Xb.prototype.B$=function(f){this.get_events().addHandler("Focus",f)};Xb.prototype.bea=function(f){this.get_events().removeHandler("Focus",f)};Xb.prototype.enable=function(){this.domElement&&(this.domElement.classList.remove(Mi.a.SZ),this.domElement.style.cursor="",vi.a.instance.qa(hg.a.click,this.domElement,this.dd),nk.KeyInputManager.instance.qa(hg.a.Ub,this.domElement,this.onKeyDown),gi.a.instance.qa(hg.a.pointerOver,this.domElement,
this.$w),gi.a.instance.qa(hg.a.pointerOut,this.domElement,this.HO),this.xc.un("blur")||this.xc.ka("blur",this.onBlur),this.xc.un("focus")||this.xc.ka("focus",this.onFocus),this.domElement.title=this.dph,this.El=!0)};Xb.prototype.disable=function(){this.domElement&&(this.domElement.classList.add(Mi.a.SZ),this.domElement.style.cursor="",this.isEnabled&&(vi.a.instance.za(hg.a.click,this.domElement,this.dd),nk.KeyInputManager.instance.za(hg.a.Ub,this.domElement,this.onKeyDown),gi.a.instance.za(hg.a.pointerOver,
this.domElement,this.$w),gi.a.instance.za(hg.a.pointerOut,this.domElement,this.HO)),this.domElement.title=this.Qjh,this.El=!1)};Xb.prototype.dispose=function(){this.isEnabled&&(vi.a.instance.za(hg.a.click,this.domElement,this.dd),nk.KeyInputManager.instance.za(hg.a.Ub,this.domElement,this.onKeyDown),gi.a.instance.za(hg.a.pointerOver,this.domElement,this.$w),gi.a.instance.za(hg.a.pointerOut,this.domElement,this.HO),this.El=!1);$a.DOMElementExtensions.setVisible(this.domElement,!1);Mk.prototype.dispose.call(this)};
Xb.Cb=function(f,D,N,fa,Ia,pb,Wb,Nc){f.removeAttribute("Href");f.setAttribute(Bf.a.Vd,Bf.a.ks);f.className=D;f.tabIndex=Nc;D=document.createElement("span");D.className=Wb;D.classList.add(N);D.tabIndex=-1;f.appendChild(D);f=document.createElement("img");f.src=Te.a.Ge(fa);f.className=Ia;f.alt=pb;f.tabIndex=-1;D.appendChild(f);return f};uk.Object.defineProperties(Xb.prototype,{ik:{configurable:!0,enumerable:!0,get:function(){return this.IJ}},isEnabled:{configurable:!0,enumerable:!0,get:function(){return this.El}}});
Object(Jb.a)(Xb,"ListButton",Ug.a,[787,3]);var Nk="<p class='"+ac.Nmh+"'>\r\n\t<span class='dv-prompt-titletext'>{0}</span>\r\n</p>",bl="<p class='"+ac.Mmh+"'>\r\n\t<span class='dv-prompt-messagetext'>{0}</span>\r\n</p>",ml=R.a.YQe,cl=R.a.YQe,dl=R.a.h2g,gk=Ug.a;Am(hb,gk);hb.prototype.dispose=function(){this.$&&(this.RNb(!1),this.gridView.ga.VO(this.Th),this.gridView.Nt(this.onContentReady),this.gridView.Ac.sgj(this.SAf),this.$.En(this.rd));this.jIe(!1);this.kIe(!1);Ag.a.tc(this.y7b);this.y7b=this.Eta=
this.pg=this.N0=this.CJ=this.gridView=this.$=null;gk.prototype.dispose.call(this)};hb.prototype.Q9c=function(f){return!!this.Y4a(f)};hb.prototype.Psb=function(f,D){return ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5879568_ReactDataValidationErrorDialog")?new qb(this.$,f,D):new mb(this.$,f,D)};hb.prototype.Y4a=function(f){f=this.gridView.getRangeInformation(f);for(var D=0;D<f.length;D++){var N=f[D];if(Object(td.a)(dj.DataValidationRange,N))return N}return null};hb.prototype.EOh=function(){if(!this.k6a)return"";
var f=this.Caf?String.format("{0} {1}",this.dv.YNf,this.dv.prompt):"",D=this.Cyb?oe.a.instance.fa(825):"";return String.format(oe.a.instance.Bb(17),f,D)};hb.prototype.Yh=function(f){var D=!1;if(this.isListVisible||(-569786022===f||541421805===f)&&this.Cyb||1872288872===f&&this.hS)switch(f){case -569786022:case 541421805:this.show(this.hS,!this.isListVisible,!0,bj.a.zp||3===tf.a.$b);D=!0;break;case 1872288872:this.isListVisible?(this.show(this.hS,!1,!0,!1),D=!0):this.hS?(this.show(!1,!1,!0,!1),D=!0):
this.Za&&(this.Za.endEdit(!1,"DataValidationControl.HandleKeyDown",0),D=!0);break;case -798660877:this.ai.MB(1);D=!0;break;case 137938150:this.ai.MB(-1);D=!0;break;case 2091832999:this.ai.MB(this.ai.xI-1);D=!0;break;case 742457698:this.ai.MB(-(this.ai.xI-1));D=!0;break;case 125627505:case 267796030:D=this.SSa()}return D};hb.prototype.show=function(f,D,N,fa){this.py();if(this.VBb&&this.k6a){var Ia=this.JPa;if(Ia){if(f||D||N)this.isVisible=!0;Pe.d(this.style,this.isGridRtl);N&&this.Cyb&&(this.kIe(!0),
this.whg(Ia,!1));D&&this.Cyb&&this.CTa(fa,Ia);f&&this.Caf&&this.JGj(Ia);this.jti||(this.isVisible=!1)}}};hb.prototype.Dwa=function(f,D){if(!D||!D.cell.Vj)return null;var N=this.gridView.Ac.textBox.domElement;var fa=0<$a.DOMElementExtensions.getHeight(N)&&0<$a.DOMElementExtensions.getWidth(N)&&0<=N.offsetTop&&0<=N.offsetLeft;if(fa)N=$a.DOMElementExtensions.Dwa(N,f.Fj);else{N=f.getCellBounds(D.cell);var Ia=$a.DOMElementExtensions.getBoundingClientRect(f.Fj);N=new Sys.UI.Bounds(N.x-Ia.x,N.y-Ia.y,N.width,
N.height)}if(N)if(fa)2<N.height&&2<N.height&&(N.x+=1,N.y+=1,N.height-=2,N.width-=2);else if(fa=We.g(this.$).BK(D.cell))fa=fa.width+1,Ia=Ba.a.equals(ej.a.X4a(D.cell,f.rtl),"right",!0),f.rtl&&Ia&&(N.x=N.x+N.width-fa),D.Wla&&f.rtl===Ia&&(N.width=fa);else return null;return N};hb.prototype.z7f=function(f){var D=this.k6a;this.RNb(D);D?this.show(!0,f,!0,!1):this.py()};hb.prototype.SSa=function(){var f=!1;this.isListVisible&&(f=this.ai.SSa(this.Za),this.show(this.hS,!1,!0,!1));return f};hb.prototype.py=
function(){this.Uli?(this.isListVisible&&(this.isListVisible=!1),this.gNa&&(this.gNa=!1),this.hS&&(this.hS=!1),this.isVisible&&(this.isVisible=!1)):this.isListVisible=this.gNa=this.hS=this.isVisible=!1;this.msd=this.pqd=this.ftd=!1};hb.prototype.CTa=function(f,D){this.Cyb&&!this.dv.eJa?this.gNa&&this.Rh.disable():(this.jIe(!0),this.ai.lfa(this.dv.eJa,f,this.HXh(D),this.Za),this.JCa(D,!1))};hb.prototype.JGj=function(f){this.dv.prompt&&(this.hS=!0,this.qYj(this.dv.YNf,this.dv.prompt),this.Phg(f,!1))};
hb.prototype.whg=function(f,D){var N=f.y;this.Eta.style.top=ca.HelperMethods.Yb(N);f=this.isGridRtl?f.x-this.Eta.offsetWidth+1:f.x+f.width+1;this.Eta.style.left=ca.HelperMethods.Yb(f);D?this.gNa=this.gridView.Fkc(new Lk.a(f,N))&&this.pqd:this.pqd=!0};hb.prototype.JCa=function(f,D){var N=f.y+f.height;f=this.isGridRtl?f.x+f.width-this.pg.offsetWidth:f.x;this.pg.style.top=ca.HelperMethods.Yb(N);this.pg.style.left=ca.HelperMethods.Yb(f);D?this.isListVisible=this.gridView.Fkc(new Lk.a(f,N))&&this.msd:
this.msd=!0};hb.prototype.Phg=function(f,D){var N=f.y+f.height+5,fa=this.activeCell;fa=fa?fa.width/2:32;f=this.isGridRtl?f.x-this.N0.offsetWidth+fa:f.x+f.width-fa;this.N0.style.top=ca.HelperMethods.Yb(N);this.N0.style.left=ca.HelperMethods.Yb(f);D?this.hS=this.gridView.Fkc(new Lk.a(f,N))&&this.ftd:this.ftd=!0};hb.prototype.qYj=function(f,D){if(D){var N="";f&&(N+=String.format(Nk,Lg.a.Rf(f)));N+=String.format(bl,Lg.a.Rf(D));this.N0.innerHTML=N;f=$a.DOMElementExtensions.Ij(this.N0,"dv-prompt-titletext");
if(D=$a.DOMElementExtensions.Ij(this.N0,"dv-prompt-messagetext"))for(f=f?parseInt(String(Math.max(f.offsetWidth,D.offsetWidth)),10):D.offsetWidth,f+=6,$a.DOMElementExtensions.nr(this.N0,f),D=0,N=this.N0.children.length;D<N;D++)$a.DOMElementExtensions.nr(this.N0.children[D],f)}};hb.prototype.HXh=function(f){return this.Vli?f.width+17-2+1:f.width+this.Eta.clientWidth-2+1};hb.prototype.kIe=function(f){this.$&&!this.VBb||!f?(this.Cag(!1),Ag.a.Fa(this.Rh),this.Rh=null):(this.Rh||(this.Rh=new Xb(this.Eta,
ml,Mi.a.hja,1,cl,oe.a.instance.fa(876),dl,oe.a.instance.fa(875),"",-1),this.Cag(!0)),this.gNa=!0,this.dv.eJa?this.Rh.isEnabled||this.Rh.enable():this.Rh.disable())};hb.prototype.jIe=function(f){this.$&&!this.VBb||!f?(this.gUa(!1),Ag.a.Fa(this.ai),this.ai=null):(this.ai||(this.ai=new xb(this.$,this.pg,this.hDb),this.gUa(!0)),this.isListVisible=!0)};hb.prototype.gUa=function(f){this.ai&&(f&&!this.pS?(this.ai.B$(this.$Cd),this.ai.Z_b(this.GMa),this.ai.qpb(this.Qza),this.pS=!0):!f&&this.pS&&(this.ai.bea(this.$Cd),
this.ai.Zuc(this.GMa),this.ai.xJb(this.Qza),this.pS=!1))};hb.prototype.RNb=function(f){f&&!this.WR?(this.gridView.view.nt(this.Gt),this.WR=!0):!f&&this.WR&&(this.gridView.view.fr(this.Gt),this.WR=!1)};hb.prototype.Cag=function(f){this.Rh&&(f&&!this.M2b?(this.Rh.AXc(this.aQa),this.Rh.NXc(this.aQa),this.Rh.$ob(this.GMa),this.M2b=!0):!f&&this.M2b&&(this.Rh.lMd(this.aQa),this.Rh.yMd(this.aQa),this.Rh.hJb(this.GMa),this.M2b=!1))};hb.prototype.Fhg=function(){if(this.k6a){var f=this.JPa;f&&(this.whg(f,!0),
this.JCa(f,!0),this.Phg(f,!0))}};uk.Object.defineProperties(hb.prototype,{VBb:{configurable:!0,enumerable:!0,get:function(){return!!(this.$.Dd&16)}},jti:{configurable:!0,enumerable:!0,get:function(){return this.isListVisible||this.hS||this.gNa}},isListVisible:{configurable:!0,enumerable:!0,get:function(){return $a.DOMElementExtensions.isVisible(this.pg)},set:function(f){$a.DOMElementExtensions.setVisible(this.pg,f)}},hS:{configurable:!0,enumerable:!0,get:function(){return $a.DOMElementExtensions.isVisible(this.N0)},
set:function(f){$a.DOMElementExtensions.setVisible(this.N0,f)}},gNa:{configurable:!0,enumerable:!0,get:function(){return $a.DOMElementExtensions.isVisible(this.Eta)&&!!this.Rh&&$a.DOMElementExtensions.isVisible(this.Rh.domElement)},set:function(f){$a.DOMElementExtensions.setVisible(this.Eta,f);this.Rh&&$a.DOMElementExtensions.setVisible(this.Rh.domElement,f)}},Za:{configurable:!0,enumerable:!0,get:function(){return this.CJ},set:function(f){this.CJ=f}},k6a:{configurable:!0,enumerable:!0,get:function(){return!!this.activeCell&&
this.Q9c(this.activeCell.range)}},activeCell:{configurable:!0,enumerable:!0,get:function(){return this.gridView.rc(null)}},Caf:{configurable:!0,enumerable:!0,get:function(){return this.k6a&&!!this.dv&&!!(this.dv.options&2)&&!!this.dv.prompt}},Cyb:{configurable:!0,enumerable:!0,get:function(){return this.k6a&&!!this.dv&&!!(this.dv.options&1)}},isGridRtl:{configurable:!0,enumerable:!0,get:function(){return this.gridView.rtl}},dv:{configurable:!0,enumerable:!0,get:function(){return this.Y4a(this.activeCell.range)}},
JPa:{configurable:!0,enumerable:!0,get:function(){var f=this.activeCell;return f?this.Dwa(this.gridView,f):null}}});Object(Jb.a)(hb,"DataValidationControl",Ug.a,[744,3]);var Fk=lh.a;Am(Sa,Fk);Sa.prototype.create=function(){this.Eb(this.$.da.Aa(14)||new hb(this.$))};Object(Jb.a)(Sa,"DataValidationControlFactory",lh.a,[]);db.kcd="!";db.zJf="[";db.yJf="]";db.openParen="(";db.closeParen=")";db.Qkg=" /.(*\\".split("");db.w9b="...";db.$Gb="param_help_link";db.iGd="param_help_udf";db.tfd="function_list_box";
db.UKh="function_param_box";db.vfd="function_reader_description";db.ofd="function_description_box";db.HZe="function_param_table";db.W0i="param_row_";db.jGd="param_set";db.fKf="param_row_0";db.gKf="param_row_1";db.VKh="<div id='{0}' class='{1}'></div>";db.TKh="<div id='{0}' class='{1} {2} {3}'>\r\n\t<table id='{4}'>\r\n\t\t{5}\r\n\t\t{6}\r\n\t</table>\r\n</div> ";db.hKf="<tr>\r\n\t<td id='{0}'>\r\n\t\t<span id='{0}_{1}' class='{2}'></span>\r\n\t\t<a href = '#' id='{0}_{3}' class='{4}'></a>\r\n\t\t<span id ='{0}_{5}'></span>\r\n\t</td>\r\n</tr>";
db.QKh="<div id='{0}' class='{1} {2} {3}'></div>";db.NKh="<div id='{0}' class='{1} {2} {3} {4}'></div>";db.tof="[@";db.a8g=1;db.$7g=3;db.chh=500;db.Ktf=50;Object(Jb.a)(db,"FormulaAssistanceConstants",null,[]);var X=b(70),ya=b(227),kb=b(370),Zb=X.a.Hsh,xc=X.a.TQe,cd=X.a.UQe,dd=X.a.$ad,Qc=X.a.Jsh,Ic=X.a.Nsh,Gd=X.a.PQe,Pd=X.a.XQe,ze=X.a.Lsh,gf=X.a.QQe,uf=yi.a;Am(ma,uf);ma.prototype.initialize=function(){this.Rb.classList.add(X.a.Fsh);this.Rb.innerHTML=ma.zH();this.Pe||(this.ll(),this.s3());uf.prototype.initialize.call(this);
var f=$a.DOMElementExtensions.Ij(this.Rb,gf);this.rtl&&(f.align="right",this.kwb.style.marginLeft="5px");this.Pe&&(f.style.padding="1px");this.functionInfoManager.Lub({Filter:null,FilterType:2,IncludeOneOfEachGroupUI:!0},!0)};ma.prototype.dispose=function(){this.functionInfoManager&&(this.functionInfoManager.oJb(this.onFunctionInfoLoaded),this.functionInfoManager.$.ea.tk(this.fd));Ag.a.tc([this.w3b,this.L6,this.Syb,this.RKa,this.lwb]);uf.prototype.dispose.call(this)};ma.prototype.ll=function(){this.SKa=
$a.DOMElementExtensions.Ij(this.Rb,Zb);this.ika=$a.DOMElementExtensions.Ij(this.Rb,xc);this.SKa.setAttribute(Bf.a.Vd,Bf.a.z1b);this.RKa=new nh.a(this.SKa,!0);this.lwb=new nh.a(this.ika,!0);this.FZe=$a.DOMElementExtensions.Ij(this.Rb,Ic);this.kwb=$a.DOMElementExtensions.Ij(this.Rb,Qc);this.JZe=$a.DOMElementExtensions.Ij(this.Rb,Pd);this.Apf=$a.DOMElementExtensions.Ij(this.Rb,ze);this.GZe=$get(ma.pfd,this.Rb);this.hka=$a.DOMElementExtensions.Ij(this.Rb,Gd);this.Pe&&(this.hka.style.paddingLeft="1px");
this.functionInfoManager.hpb(this.onFunctionInfoLoaded);this.functionInfoManager.$.ea.ek(this.fd)};ma.prototype.XR=function(f){var D=this;this.$.da.Ya(40,function(){D.RKa.XR(f)})};ma.prototype.um=function(){this.Xed?this.formulaAssistanceManager.gMe():this.formulaAssistanceControl.set_visible(!1);uf.prototype.um.call(this);this.Gmd||(this.getButton(0).get_element().disabled=!0)};ma.prototype.setFocus=function(){!this.SKa.disabled&&this.Gmd&&$a.DOMElementExtensions.setFocus(this.SKa)};ma.prototype.commit=
function(){return!0};ma.prototype.isb=function(){var f=this,D=this.Faa.NameDataStrings;if(ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5658291_FormulasTabImprovements")){var N=new bg.a(-433697611,0,this.$.jd,8,null),fa={};fa=(fa[tf.a.od]=D,fa);this.$.Ka.dc(N,fa)}else{D+=db.openParen;N=We.g(this.$);N.view.visibleArea.contains(N.jg(null))||N.mu(N.ga.va.activeCell,3,Nj.a.OKh);var Ia=this.NJa.textBox;if(this.NJa.isEditing&&this.NJa.text){fa=this.NJa.text;var pb=this.a2c?fa.substring(0,this.a2c):"=";
this.NJa.text=pb+D+fa.substring(this.a2c+(Ia.Iv?Ia.Iv.length:0),fa.length);Ia.caretPosition=pb.length+D.length}else ud.TaskExtensions.Ba(N.startEdit(!0,1),function(){f.NJa.text="="+D;var Wb=D.length+1;Ia.RSa(Wb);Ia.caretPosition=Wb},this.la,11,Vc.a.current);N.yj&&(N=N.zc,N.text=Ia.text,N.setCaretPosition(Ia.caretPosition));(N=this.NJa.vZ.get(Dk.a.z4a))&&N.fV(!1)}};ma.prototype.Jta=function(){this.Xed?this.formulaAssistanceManager.iea():this.formulaAssistanceControl.aqb()};ma.prototype.cwa=function(f){this.lwb.clear();
for(var D=ma.pfd+" "+ma.BZe,N=0,fa=f.length;N<fa;++N){var Ia=this.lwb.XM(f[N].NameUI,f[N].FunctionIndex.toString(),!1);bj.a.vv&&Ia.classList.add(dd);Ia.setAttribute(Bf.a.YE,ma.CZe);Ia.setAttribute(Bf.a.aK,D)}this.lwb.selectedIndex=0};ma.prototype.a2f=function(){if(this.Faa){this.kwb.parentNode.className=X.a.QQe+(this.functionInfoManager.Mrd(this.Faa)?"-udf":"");var f=this.Faa.NameDataStrings;this.JZe.innerText=f;this.kwb.innerText=f;this.hka.innerText=this.Faa.Help;f=this.Faa.Params.split(db.kcd);
this.GZe.innerText=db.openParen+(1<f.length?db.w9b:f[0])+db.closeParen}};ma.zH=function(){return String.format("<div class='"+X.a.Gsh+"'>\r\n\t<label for='{6}'>{0}</label>\r\n\t<select id='{6}' class='{9}' disabled='true'></select>\r\n</div>\r\n<div class='"+ai.a.wo+"'>{1}</div>\r\n<div class='"+X.a.OQe+"'>\r\n\t<select id='{16}' class='{17} "+R.a.kp+" "+R.a.il+"' size='{8}'></select>\r\n\t<div class='{11}' >{2}</div>\r\n</div>\r\n<div class='"+X.a.Ksh+"'>\r\n\t<div style='direction:ltr' class='{15}'>\r\n\t\t<span class='{14} "+
R.a.kp+"'>\r\n\t\t\t<span class='"+R.a.Dr+" "+X.a.Msh+"'>\r\n\t\t\t\t<img title='{3}' class='"+R.a.Rzh+"' src='{4}'/>\r\n\t\t\t</span>\r\n\t\t</span>\r\n\t\t<span id='{19}' class='{13}'></span>\r\n\t\t<a tabindex='0' title='{5}' class='{10}'></a>\r\n\t\t<span id='{7}'></span>\r\n\t</div>\r\n\t<div id='{18}' class='{12}'></div>\r\n</div>",oe.a.instance.fa(1005),oe.a.instance.fa(1006),oe.a.instance.fa(723),oe.a.instance.Bb(3),Te.a.Ge(13),oe.a.instance.fa(1007),ma.MKh,ma.pfd,7,Zb,Qc,Ic,Gd,Pd,ze,gf,ma.RKh,
xc+(bj.a.vv?" "+cd:""),ma.BZe,ma.CZe)};uk.Object.defineProperties(ma.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"FunctionDialog"}},Faa:{configurable:!0,enumerable:!0,get:function(){if(!this.ika||!this.ika.firstChild)return null;var f=Number.parseInvariant(this.ika.children[this.ika.selectedIndex].value);return this.functionInfoManager.yVh(f)}}});ma.pfd="function_dialog_param_string";ma.BZe="function_dialog_function_description";ma.CZe="function_dialog_function_name";ma.RKh=
"function_list";ma.MKh="function_category";Object(Jb.a)(ma,"FunctionDialog",yi.a,[]);ua.prototype.$c=function(f,D){if(!ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5658291_FormulasTabImprovements"))return!1;switch(D){case 753860909:case -2060563418:case 917756490:case -1756230110:case -1702465186:case -977299160:case 2135922458:case -1960662393:case -1999560076:case 493672674:case -1031255406:case 548833656:case 641360851:case -433697611:return f=We.g(this.$).Uj,f.KMa||!f.isEditing||0>=f.text.length?
!1:!0;default:return!1}};ua.prototype.executeCommand=function(f,D,N){D=D.command;f=We.g(this.$);switch(D){case 753860909:case -2060563418:ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5658291_FormulasTabImprovements")?(N=f.Uj,f.inRangePicker&&N.$E(!1),this.create(N)):f.rc(null)&&(N=f.Uj,N.KMa||!N.isEditing||0>=N.text.length)&&(f.inRangePicker&&N.$E(!1),this.create(N));break;case -433697611:var fa=N[tf.a.od]+db.openParen;N.UILocation&&this.$.ae(-1075437823,-1,0,null);f.view.visibleArea.contains(f.jg(null))||
f.mu(f.ga.va.activeCell,3,Nj.a.PJh);var Ia=f.Uj,pb=Ia.textBox;N=Ia.textBox.caretPosition;if(Ia.isEditing&&Ia.text){D=Ia.text;var Wb=N?D.substring(0,N):"=";Ia.text=Wb+fa+D.substring(N+(pb.Iv?pb.Iv.length:0),D.length);pb.caretPosition=Wb.length+fa.length}else ud.TaskExtensions.Ba(f.startEdit(!0,1),function(){Ia.text="="+fa;var Nc=fa.length+1;pb.RSa(Nc);pb.caretPosition=Nc},this.$.la,11,Vc.a.current);f.yj&&(f=f.zc,f.text=pb.text,f.setCaretPosition(pb.caretPosition));this.pD?this.formulaAssistanceManager.iea():
(f=Ia.vZ.get(Dk.a.z4a),null===f||void 0===f?void 0:f.fV(!1))}return rg.Task.Sa(!0)};ua.prototype.Mc=function(f,D){switch(D.command){case 753860909:case -2060563418:case -433697611:return!0;default:return!1}};ua.prototype.MLh=function(f,D){D=this.Ta.iq(D);var N=this.Ta.Oc(),fa=this.functionInfoManager.P2e(f);if(!fa)return ld.ULS.sendTraceTag(537162067,0,15,"FormulaAssistanceCommandHandler.GenerateFunctionMenu: functionList is null"),D.BC();for(var Ia=0;Ia<fa.length;++Ia){var pb=fa[Ia].NameUI,Wb=this.Ta.aR(280,
"Formulas."+f+"MenuItem_"+fa[Ia].FunctionIndex.toString(),-433697611,null,1,"None",0,0,pb,!1,0);Wb.label=pb;var Nc=fa[Ia].Params.split(db.kcd);Wb.hT(pb+" "+(db.openParen+(1<Nc.length?db.w9b:Nc[0])+db.closeParen)+"\n"+fa[Ia].Help);Array.add(N.buttons,Wb)}f=this.Ta.Oc();fa=this.Ta.aR(280,"Formulas.MoreFunctionsMenuItem",-2060563418,R.a.yUe,3,"Image16by16",1004,0,"Formulas.MoreFunctionsMenuItem",!1,0);Array.add(f.buttons,fa);Array.add(D.Dc,N);Array.add(D.Dc,f);return D.BC()};ua.prototype.nd=function(f,
D,N){f=this.xVh(D);if(-1===f)return!1;this.menuId=N.MenuId;if(!this.functionInfoManager.Y5)return this.functionInfoManager.Lub({Filter:null,FilterType:2,IncludeOneOfEachGroupUI:!0},!0),!1;f=this.functionInfoManager.AZe[f];this.eN[f]=this.eN[f]||this.MLh(f,N.MenuId);N.MenuItems=this.eN[f];return!0};ua.prototype.create=function(f){(new ma(this.$,f)).pf()};ua.prototype.xVh=function(f){switch(f){case "PopulateFinancialFnsMenu":return 2;case "PopulateLogicalFnsMenu":return 9;case "PopulateTextFnsMenu":return 8;
case "PopulateDateTimeFnsMenu":return 3;case "PopulateLookupReferenceFnsMenu":return 6;case "PopulateMathTrigFnsMenu":return 4;case "PopulateStatisticalFnsMenu":return 5;case "PopulateEngineeringFnsMenu":return 11;case "PopulateCubeFnsMenu":return 12;case "PopulateInformationFnsMenu":return 10;default:return-1}};Object(Jb.a)(ua,"FormulaAssistanceCommandHandler",null,[434]);var jg=Mc.a;Am(T,jg);T.prototype.Qd=function(){var f=this,D=mf.GetServiceTaskFactory.create(this.$.da,102,this.la,this.ub),N=
mf.GetServiceTaskFactory.create(this.$.da,153,this.la,this.ub);ud.TaskExtensions.Ba(ud.TaskExtensions.we([D,N],this.la),function(){f.Jd([new ua(f.$,D.result,N.result)])},this.la,3)};T.ka=function(f){Mc.a.je(92,new T(f))};Object(Jb.a)(T,"FormulaAssistanceCommandHandlerFactory",Mc.a,[]);Wc.prototype.dispose=function(){this.O_d();this.TKa=this.Wva=this.eka=null};Wc.prototype.YZc=function(f){f&&(this.eka=f,this.eka.ire(this.zFf),this.eka.Yre(this.BFf),this.n7a&&this.eka.Xre(this.AFf))};Wc.prototype.ZZc=
function(f){f&&(this.Wva=f,this.DNa&&(this.Wva.gre(this.OBf),this.Wva.ere(this.HBf)),this.ANa&&this.Wva.fre(this.KBf))};Wc.prototype.rwe=function(f){f&&(this.TKa=f,this.TKa.Zre(this.CFf),this.TKa.OXc(this.vFf))};Wc.prototype.O_d=function(){var f,D,N;this.eka&&(this.eka.tUf(this.zFf),this.eka.QUf(this.BFf),this.n7a&&this.eka.PUf(this.AFf));this.TKa&&(this.TKa.RUf(this.CFf),this.TKa.zMd(this.vFf));this.DNa&&(null===(f=this.Wva)||void 0===f?void 0:f.sUf(this.OBf),null===(D=this.Wva)||void 0===D?void 0:
D.qUf(this.HBf));this.ANa&&(null===(N=this.Wva)||void 0===N?void 0:N.rUf(this.KBf))};Wc.prototype.caj=function(f,D){if(D){var N="";this.n7a||(N+=oe.a.instance.Bb(56)+this.ariaLiveNotifier.Uya);for(var fa=0;fa<D.length;fa++)N+=f+this.ariaLiveNotifier.Uya+this.C0c(D[fa])+Wc.mHd(fa,D.length);this.n7a&&(N+=oe.a.instance.fa(864)+this.ariaLiveNotifier.Uya);this.ariaLiveNotifier.readText(N)}};Wc.prototype.baj=function(f,D,N){if(f){var fa="",Ia=0;if(D){for(var pb=0;pb<D.length;pb++)if(N>=f[pb].split(this.$.listSeparator).length)Ia++;
else{var Wb=D[pb].trim();if(!Wb)return;Wb=this.C0c(Wb);var Nc=Wc.mHd(pb-Ia,D.length-Ia);fa+=Wb+Nc;Nc&&(fa+=this.ariaLiveNotifier.Uya)}this.ariaLiveNotifier.readText(fa)}}};Wc.prototype.C0c=function(f){if(!f)return"";var D=f.split(this.$.listSeparator);f="";D=Cl(D);for(var N=D.next();!N.done;N=D.next()){var fa=N.value;Wc.lrd(fa)?f+=fa:(fa=(N=Wc.Cpi(fa))?fa.replace("[","").replace("]",""):fa,f+=String.format(N?oe.a.instance.Bb(58):oe.a.instance.Bb(57),fa));f+=this.ariaLiveNotifier.Uya}return f};Wc.mHd=
function(f,D){if(f>=D||1===D)return ld.ULS.shipAssertTag(537161997,0,f<D,"FormulaAssistanceControl.PositionInList: requested item index >= list length."),""};Wc.lrd=function(f){return Ba.a.contains(f,db.w9b,!0)};Wc.Cpi=function(f){return f.trimStart().startsWith(db.zJf)||f.trimEnd().endsWith(db.yJf)};Object(Jb.a)(Wc,"FormulaAssistanceReadoutHandler",null,[756,3]);var mg=lh.a;Am(Tb,mg);Tb.prototype.create=function(){var f=this,D=this.$.da;ud.TaskExtensions.Ba(mf.GetServiceTaskFactory.Ua(D,211,212,
this.ub),function(N){N=D.Aa(219)||new Wc(N.result,f.$);f.Eb(N)},this.la,3)};Tb.ka=function(f){f.da.Ha(220,new Tb(f))};Object(Jb.a)(Tb,"FormulaAssistanceReadoutHandlerFactory",lh.a,[]);var sh=b(737),Bh=b(111),yh=b(1202);Eb.prototype.kkd=function(f){return this.fSa&&f in this.fSa?this.fSa[f]:null};Eb.prototype.Z$f=function(f,D){this.fSa||(this.fSa={});this.fSa[f]=D};Eb.prototype.J_=function(){this.fSa=null};Object(Jb.a)(Eb,"FormulaAssistanceContextualPreviewCache",null,[]);Ub.prototype.dispose=function(){this.Pd||
(this.$&&(this.$.ea.VD(this.AD),this.$=null),this.xia=this.lHb=null,this.Pd=!0)};Ub.prototype.Qgd=function(f,D,N,fa){var Ia=this;if(D&&0>=D.length)throw Error.argumentNull("GetContextualFormulaPreviewResults - currentFormula is null or empty");if(!f)throw Error.argumentNull("GetContextualFormulaPreviewResults - formulaSubExpressionObject is null");this.calcManager=this.$.da.Aa(266);if(!this.calcManager)throw Error.invalidOperation("GetContextualFormulaPreviewResults failed - No CalcManager");var pb=
"="+D.substring(N.start,N.end);ye.EwaSettings.ma(612)&&(pb=this.calcManager.o3h(We.g(this.$).ga.va.activeCell,f,N));var Wb=this.ERh(pb,N);if(ye.EwaSettings.ma(612)){if(Wb&&!this.calcManager.isFormulaSubExpressionVolatile(f))return Promise.resolve(Wb)}else if(Wb)return Promise.resolve(Wb);return this.GRh(pb,N).then(function(Nc){if(Ia.K2c(fa))throw Error.create("OperationCanceledException");if(!Nc||Nc.Ymj||Nc.goa.startsWith("##UNSUPPORTED:"))return Ia.k1e(D,pb,N,fa);Ia.xia.Z$f(pb,Nc.goa);return Promise.resolve(Nc)})};
Ub.prototype.ERh=function(f,D){return(f=this.xia.kkd(f))?new yh.a(f,D.start,D.end,0):null};Ub.prototype.GRh=function(f,D){if(!f||0>=f.length||!D)throw Error.argument("GetContextualFormulaPreviewResultsFromFormulaInspector failed - Invalid currentFormula or formulaSpan");return this.calcManager.yXg(We.g(this.$).ga.va.activeCell,f,this.cEi,D)};Ub.prototype.k1e=function(f,D,N,fa){var Ia=this;if(!f||0>=f.length||!D||0>=D.length||!N)throw Error.argument("GetContextualFormulaPreviewResultsFromFormulaInspector failed - Invalid currentFormula or formulaSpan");
if(this.qQa)return this.FRh(f,D,N,fa);var pb={};pb.PartialFormula=D;pb.Formula=f;pb.SourceRange=af.v(We.g(this.$).ga.va.activeCell,this.$);return this.qQa=new Promise(function(Wb,Nc){Ia.lHb=new sh.a;Ia.SWf=Ia.$.ea.af;Ia.cbb=gc(Ia.$.na.ta,pb,function(kd){Ia.MZi(D,N,fa,kd,Wb,Nc)},function(kd){Ia.qQa=null;Ia.cbb=null;Nc(kd)},null,null,null);Ia.lHb.token.R(function(){Ia.cZg(Nc)})})};Ub.prototype.MZi=function(f,D,N,fa,Ia,pb){this.cbb=this.qQa=null;if(this.SWf!==this.$.ea.af)pb(Error.create("OperationCanceledException"));
else if(fa.Result)if(fa=Ka.a.ui(fa.Result),!fa||Bh.a.isEmpty(fa))Ia(null);else{for(var Wb in fa)this.xia.Z$f(Wb,fa[Wb]);this.K2c(N)?pb(Error.create("OperationCanceledException")):(f=this.xia.kkd(f))?(""===f&&(f=" "),Ia(new yh.a(f,D.start,D.end,0))):pb(Error.create("SubexpressionNotFoundException"))}else Ia(null)};Ub.prototype.FRh=function(f,D,N,fa){var Ia=this;return new Promise(function(pb,Wb){Ia.qQa.then(function(){Ia.EXf(f,D,N,fa,pb,Wb)}).catch(function(){Ia.EXf(f,D,N,fa,pb,Wb)})})};Ub.prototype.EXf=
function(f,D,N,fa,Ia,pb){if(this.K2c(fa))pb(Error.create("OperationCanceledException"));else{var Wb=this.xia.kkd(D);Wb?Ia(new yh.a(Wb,N.start,N.end,0)):this.k1e(f,D,N,fa).then(function(Nc){Ia(Nc)}).catch(function(Nc){pb(Nc)})}};Ub.prototype.cZg=function(f){this.cbb&&(yf.a.Ku(this.cbb.$t)?(this.qQa=this.cbb=null,f(Error.create("PendingWebReqeuestCancelled"))):ld.ULS.sendTraceTag(537162063,0,10,"Failed to cancel the pending web request!"))};Ub.prototype.J_=function(){this.dZg();this.xia&&this.xia.J_()};
Ub.prototype.dZg=function(){this.lHb&&this.lHb.C()};Ub.prototype.K2c=function(f){return this.Pd||f.$K};Object(Jb.a)(Ub,"FormulaAssistanceContextualPreviewCalculator",null,[3]);var Ri=b(218);tb.vth="ewa-facp-text-box";Object(Jb.a)(tb,"CssClassNames",null,[]);Ha.prototype.dispose=function(){(this.xaa||this.$Q)&&this.rbf();this.Za=this.Dra=null};Ha.prototype.lWj=function(f,D,N,fa){f&&D&&fa&&D.goa&&!(1>D.goa.length)&&(this.Za=f,this.xTf(),this.A3a=D,this.iUa=fa,this.TEj(D,N,fa))};Ha.prototype.rbf=function(){this.Oai();
this.xTf();this.iUa=this.A3a=null};Ha.prototype.TEj=function(f,D,N){var fa=this;if(f.goa&&!(1>f.goa.length)){var Ia=this.Qc.da.Aa(266);if(Ia){var pb=Ia.IXh();pb&&ud.TaskExtensions.Ba(this.nDb,function(){if(D)if(ye.EwaSettings.ma(612)&&fa.Za.isEditing&&0<N.length){fa.ezb(f.NKa,N[0].start,null);var Wb=fa.n7e(N[0],pb),Nc=fa.Za.text.substring(N[0].start,N[0].end).trim();Nc=fa.Za.text.indexOf(Nc);Nc=fa.Za.text.substring(0,Nc).lastIndexOf("\n");fa.ezb(0>Nc||1>=N.length?N[0].start:Nc+1,N[0].end,Wb?String.format(Wb,
.3):null);for(var kd=1;kd<N.length;kd++)Wb=fa.n7e(N[kd],pb),Nc=fa.Za.text.substring(N[kd].start,N[kd].end).trim(),Nc=fa.Za.text.indexOf(Nc),Nc=fa.Za.text.substring(N[kd-1].end,Nc).lastIndexOf("\n"),fa.ezb(0>Nc?N[kd-1].end:Nc+1+N[kd-1].end,N[kd].end,Wb?String.format(Wb,.3):null);Nc=fa.Za.text.substring(N[N.length-1].end,f.Zva).indexOf("\n");fa.ezb(0>Nc?N[N.length-1].end:Nc+1+N[N.length-1].end,f.Zva,null);ld.ULS.sendTraceTag(537162061,0,50,"FormulaAssistanceContextualPreviewControl.ShowContextualFormulaPreviewContainer: Colored highlighting and partial evaluation completed")}else fa.ezb(f.NKa,
f.Zva,null),ld.ULS.sendTraceTag(537162060,0,50,"FormulaAssistanceContextualPreviewControl.ShowContextualFormulaPreviewContainer: Default highlighting and partial evaluation completed");fa.xaa||(fa.xaa=document.createElement(Ri.a.div),fa.Za.textBox.domElement.appendChild(fa.xaa));fa.$Q||(fa.$Q=document.createElement(Ri.a.div),fa.$Q.className=tb.vth,fa.Qc.domElement.appendChild(fa.$Q));Wb=f.Zva;ye.EwaSettings.ma(612)&&fa.Za.isEditing&&N&&0<N.length&&N[0].start<Wb&&N[0].start!==f.NKa&&!fa.Za.textBox.Iv.length&&
(Wb=N[0].start);kd=Ba.a.contains(fa.Za.textBox.qf.id,"FormulaBar",!0)&&Ba.a.contains(fa.Za.text.substring(f.NKa,f.Zva),"\n",!0);Nc=fa.Za.isEditing?fa.Za.textBox.caretPosition:0;Wb=excelOnline.utils.getBoundingRectForText(fa.Za.textBox.qf,kd?Nc:f.NKa,kd?Nc:Wb,ye.EwaSettings.ma(612));fa.$Q.style.left=ca.HelperMethods.Yb(Wb.left);fa.$Q.style.top=ca.HelperMethods.Yb(Wb.top);fa.$Q.style.width=ca.HelperMethods.Yb(Wb.width);fa.$Q.style.height=ca.HelperMethods.Yb(Wb.height);Wb=String.format("FormulaAssistancePreviewToolTip_{0}_{1}",
f.Zva,f.Zva);dialogControls.renderToolTip(fa.xaa,Wb,f.goa,fa.$Q,0,!1,!1,1)},this.Qc.la,3)}}};Ha.prototype.n7e=function(f,D){var N=this.Za.text,fa=N.substring(f.start,f.end);fa=fa.trim();f=N.indexOf(fa,f.start);D=N.indexOf(D,f);fa=N.substring(f,D);fa=fa.trim();return this.Za.colors.getItem(f+"-"+(f+fa.length))};Ha.prototype.Oai=function(){var f=this;this.Za&&this.xaa&&this.$Q&&ud.TaskExtensions.Ba(this.nDb,function(){f.Za.textBox.domElement.contains(f.xaa)&&(dialogControls.clearToolTip(f.xaa),f.Za.textBox.domElement.removeChild(f.xaa),
f.xaa=null);f.Qc.domElement.contains(f.$Q)&&(f.Qc.domElement.removeChild(f.$Q),f.$Q=null)},this.Qc.la,3)};Ha.prototype.ezb=function(f,D,N){if(this.Za&&!(f>=D)){var fa={};this.Za.textBox.formatText(f,D-f,(fa.background=N||"#E3DDCC",fa));this.smd=!0}};Ha.prototype.xTf=function(){if(this.Za&&this.A3a&&this.smd){var f=this.A3a.Zva;ye.EwaSettings.ma(612)&&0<this.iUa.length&&this.iUa[this.iUa.length-1].end>f&&(f=this.iUa[this.iUa.length-1].end);var D={};this.Za.textBox.formatText(this.A3a.NKa,f-this.A3a.NKa,
(D.background=!1,D));this.smd=!1}};uk.Object.defineProperties(Ha.prototype,{nDb:{configurable:!0,enumerable:!0,get:function(){var f=this;if(this.Dra)return this.Dra;var D=new Ah.a;this.Qc.gD(function(N){ud.TaskExtensions.Ba(N.Iwd(),function(){D.setResult(!0)},f.Qc.la,3)});return this.Dra=D.task}}});Object(Jb.a)(Ha,"FormulaAssistanceContextualPreviewControl",null,[3]);var mi=b(46),Ai=b(43);nc.prototype.w7f=function(f,D,N){N?this.Y9g(f,D,N):this.D9e(f,D,N,!0)};nc.prototype.Elj=function(){this.D8=0};
nc.prototype.Y9g=function(f,D,N){var fa=this;this.D8++;var Ia=this.D8;mi.a.instance.create(function(){fa.D9e(f,D,N,Ia===fa.D8)},500,Ai.a.QJh,!0,!0)};nc.prototype.D9e=function(f,D,N,fa){var Ia=this,pb=this.Wed.Qgd(f,D);pb&&pb.then(function(Wb){fa&&Ia.Wed.Xrd(D)&&Ia.Wed.kWj(f,Wb,N)}).catch(function(Wb){Wb=Object(k.a)(Error,Wb);"OperationCanceledException"===Wb.message?ld.ULS.sendTraceTag(537162059,0,50,"GetContextualFormulaPreviewResults - caught exception: {0}",Wb):ld.ULS.sendTraceTag(537162058,0,
10,"GetContextualFormulaPreviewResults - caught exception: {0}",Wb)})};Object(Jb.a)(nc,"FormulaAssistanceContextualPreviewHoverManager",null,[]);Nb.prototype.dispose=function(){this.I1c();Ag.a.tc([this.bwb,this.ubc]);this.vbc=this.ubc=this.bwb=null;this.$&&We.g(this.$).zc.Zn(this.T$a);this.via=this.Za=this.$=null};Nb.prototype.UEj=function(f,D){D&&Df.e(D.text)&&!(D.Sxa||D.textBox.Iv||this.Za&&this.Za.textBox.Iv)&&(this.Za=D,this.calcManager=this.$.da.Aa(266))&&(ld.ULS.sendTraceTag(537162056,0,50,
"FormulaAssistanceContextualPreviewManager.GetContextualPreviewResultsOnHover: Highlighting and partial evaluation initiated"),f=ca.HelperMethods.Lwb(f),f=this.calcManager.l3h(We.g(this.$).ga.va.activeCell,this.Za.text,f.x,f.y),D=this.calcManager.getSubExpressionSpan(f),!D||D.end<=D.start||this.Xrd(D)||(this.via=D,this.vbc.w7f(f,D,!0)))};Nb.prototype.SUd=function(f){if(f&&Df.e(f.text))if(f.textBox.Iv&&f.textBox.Iv.trim()){if(this.Za=f,this.calcManager=this.$.da.Aa(266)){ld.ULS.sendTraceTag(537162054,
0,50,"FormulaAssistanceContextualPreviewManager.GetContextualPreviewResultsOnSelection: Highlighting and partial evaluation initiated");f={};var D=this.Za.textBox.Iv.trim();f.start=this.Za.text.indexOf(D,this.Za.textBox.caretPosition);f.end=f.start+D.length;(D=this.calcManager.getFormulaSubExpressionObject(We.g(this.$).ga.va.activeCell,this.Za.text,this.Za.textBox.Iv))&&!this.Xrd(f)&&(this.via=f,this.vbc.w7f(D,f,!1))}}else this.B6a(!1,!0)};Nb.prototype.B6a=function(f,D){!this.Za||D&&this.Za.textBox.Iv||
(this.via=null,f&&(this.I1c(),this.ubc.J_(),this.vbc.Elj()),this.bwb&&this.bwb.rbf(),this.Za.Sxa||(this.Za.Sxa=!1,this.Za=null))};Nb.prototype.Qgd=function(f,D){if(!this.Za||this.Za.Sxa)return null;this.I1c();this.jtb=new sh.a;return this.ubc.Qgd(f,this.Za.text,D,this.jtb.token)};Nb.prototype.kWj=function(f,D,N){this.jtb=null;!f||!D||!D.goa||0>=D.goa.length?this.B6a(!1,!1):(f=this.calcManager.m3h(We.g(this.$).ga.va.activeCell,f,this.Za.text),this.bwb.lWj(this.Za,D,N,f))};Nb.prototype.Xrd=function(f){return this.via?
f.start===this.via.start&&f.end===this.via.end&&f.pre===this.via.pre&&f.post===this.via.post:!1};Nb.prototype.I1c=function(){this.jtb&&this.jtb.C()};Object(Jb.a)(Nb,"FormulaAssistanceContextualPreviewManager",null,[867,3,868]);var Ti=b(1258),ti=b(984),nj=b(253),wi=b(165);Hc.prototype.Q2f=function(f){this.gU=0;this.ube=f.IsCompatibility;this.set_name(f.NameDataStrings);this.uXa=f.Help};Hc.prototype.wvj=function(f){this.gU=1;this.set_name(f.Name)};Hc.prototype.Xuj=function(f){this.gU=2;this.set_name(f.name);
this.uXa=f.tooltip};Hc.prototype.vwj=function(f){this.gU=3;this.set_name(f.name);this.uXa=f.toolTip};Hc.prototype.q4f=function(f){this.gU=4;this.set_name(f.name)};Hc.prototype.Nyj=function(f){this.gU=5;this.set_name(f.name);this.uXa=f.toolTip};Hc.prototype.Myj=function(f){this.gU=7;this.set_name(f.name)};Hc.prototype.jxj=function(){this.gU=6;this.set_name(oe.a.instance.Bb(182));this.uXa=oe.a.instance.Bb(183)};Hc.prototype.set_name=function(f){return this.Tce=f};Hc.rdh=function(){return Object.assign(new Hc,
{Ace:!0})};uk.Object.defineProperties(Hc.prototype,{itemType:{configurable:!0,enumerable:!0,get:function(){return this.gU}},vli:{configurable:!0,enumerable:!0,get:function(){return this.ube}},name:{configurable:!0,enumerable:!0,get:function(){return this.label}},label:{configurable:!0,enumerable:!0,get:function(){return this.Tce}},hka:{configurable:!0,enumerable:!0,get:function(){return this.uXa}},OBb:{configurable:!0,enumerable:!0,get:function(){return this.Ace}}});Object(Jb.a)(Hc,"AutoCompleteItem",
null,[888]);Object(Jb.a)(Cc,"DefinedNameInfo",null,[]);rc.prototype.MSj=function(f){var D=this.OKe[f.toUpperCase()];if(!D)return{returnValue:!1,sheetName:"",range:null};f=D.sheetName;D=this.X6g(D.namedRange);return{returnValue:!0,sheetName:f,range:D}};rc.prototype.l7g=function(f){if(null!=f&&void 0!=f)return{top:f.top,left:f.left,bottom:f.bottom,right:f.right,maxRows:f.maxRows,maxColumns:f.maxColumns,sheetName:void 0}};rc.prototype.X6g=function(f){if(null!=f&&void 0!=f)return new rj.a(f.top,f.left,
f.bottom,f.right,f.maxRows,f.maxColumns)};rc.prototype.e7g=function(f){switch(f){case 2:return 0;case 3:return 1;default:return-1}};uk.Object.defineProperties(rc.prototype,{NKe:{configurable:!0,enumerable:!0,get:function(){var f=[];if(!this.$.Ab||!this.$.Ab.items)return f;for(var D=0,N=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5951570_sendingNamedObjectsAutocompleteRequest")&&cg.a.pD(this.$),fa=Cl(this.$.Ab.items),Ia=fa.next();!Ia.done;Ia=fa.next())if((Ia=Ia.value)&&(3===Ia.type&&Ia.usedRange||
N&&2===Ia.type)){var pb=new Cc;pb.tooltip=Ia.sheetName+oc.a.exclamation+Ia.usedRange.toString();pb.name=Ia.name;pb.namedRange=this.l7g(Ia.usedRange);pb.sheetName=Ia.sheetName;pb.type=this.e7g(Ia.type);Array.add(f,pb);this.OKe[Ia.name.toUpperCase()]=pb;++D;if(D===db.Ktf){ld.ULS.sendTraceTag(537162076,0,15,"Maximum number of defined names reached for formula assistance: {0}",db.Ktf);break}}return f}}});Object(Jb.a)(rc,"DefinedNameInfoManager",null,[]);var gh=b(125),hi=Sys.EventArgs;Am(jb,hi);Object(Jb.a)(jb,
"FormulaAssistanceFunctionChangedEventArgs",Sys.EventArgs,[]);var Vi=Sys.EventArgs;Am(Va,Vi);Object(Jb.a)(Va,"FormulaAssistanceSelectedParameterChangedEventArgs",Sys.EventArgs,[]);var Oi=Sys.EventArgs;Am(ic,Oi);Object(Jb.a)(ic,"FormulaAssitanceSelectedParameterChangedEventArgs",Sys.EventArgs,[]);var Cj=b(269);rb.prototype.Qe=function(f,D){f=!1;D||(We.g(this.$).Uj.textBox.VK=!0,f=this.formulaAssistanceUIControl.focus(this.iZe));return f};rb.prototype.eg=function(f){var D=this.Kb;return!(void 0===D||
null===D)&&$a.DOMElementExtensions.Se(D,f)};rb.prototype.ji=function(){this.V9e&&this.V9e()};rb.prototype.Xh=function(){};rb.prototype.dispose=function(){Cj.a(this.$).eA(this)};uk.Object.defineProperties(rb.prototype,{canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.v1c},set:function(f){this.v1c!==f&&(f?Cj.a(this.$).Xg(this):Cj.a(this.$).eA(this),this.v1c=f)}},de:{configurable:!0,enumerable:!0,get:function(){return this.grj}},Kb:{configurable:!0,enumerable:!0,get:function(){return this.formulaAssistanceUIControl.getRootElement(this.iZe)}}});
Object(Jb.a)(rb,"FormulaAssistanceFocusManager",null,[451,3]);var Fi=b(1119),xh=di.a;Am(Ta,xh);Ta.prototype.hpb=function(f){this.addHandler("FunctionInfoLoaded",f)};Ta.prototype.oJb=function(f){this.removeHandler("FunctionInfoLoaded",f)};Ta.prototype.XIg=function(f){this.addHandler("FunctionInfoReset",f)};Ta.prototype.Hgj=function(f){this.removeHandler("FunctionInfoReset",f)};Ta.prototype.dispose=function(){var f=this.$.da.Aa(268);f&&f.sMd(this.SBf);this.wb=null;xh.prototype.dispose.call(this)};Ta.prototype.kXf=
function(){this.raiseEvent("FunctionInfoReset")};Ta.prototype.YNd=function(){this.kXf();this.zNc=!1;this.cU=null;this.xNc=!0};Ta.prototype.Lub=function(f,D){var N=this;D=void 0===D?!1:D;if(this.Y5)this.YOf();else{ld.ULS.sendTraceTag(537161991,0,50,"Retrieving the list of function names for culture '{0}' from the server.",this.$.ya.UICultureTag);var fa=null;(fa=this.$.da.Aa(268))||ld.ULS.sendTraceTag(537161990,0,50,"instantaneousSupportInformationManager == null");if((null===fa||void 0===fa?0:fa.jka)&&
0<fa.jka.length)ye.EwaSettings.ma(122)?fa.qJh(this.gCf):this.JKd(fa.jka,!0,!1);else{var Ia=this.$.na.ta.fc();f&&(this.$.ea.sc||D)&&!this.qni&&(D?Sd.a(this.$.userOperationManager,function(pb,Wb,Nc){return Se.x(N.$.na.ta,f,Pg.b(pb,N.iCf),Pg.a(Wb,N.hCf),Nc,f,Ia)},function(pb){return new Mf.a(130,0,pb,16)},null):Se.x(this.$.na.ta,f,this.iCf,this.hCf,null,f,Ia));!this.Y5&&this.$.ea.sc&&(fa?(ld.ULS.sendTraceTag(537161989,0,50,"FunctionInfoManager.EnsureFunctionInfoAsync - Functions not loaded yet, wait for them. IsFullyLoaded={0}, IsSessionActive={1}",
this.Y5,this.$.ea.sc),fa.hre(this.SBf)):(ld.ULS.sendTraceTag(537161988,0,50,"FunctionInfoManager.EnsureFunctionInfoAsync - instantaneousSupportInformationManager is null"),Se.x(this.$.na.ta,{FilterType:0},this.gCf,null,null,null,Ia),this.xNc=!1))}}};Ta.prototype.yVh=function(f){return 0>f||f>=this.cU.length?null:this.cU[f]};Ta.prototype.Qhd=function(f){return xg.a.Fc(this.xfd,f.toUpperCase())};Ta.prototype.P2e=function(f){return xg.a.Fc(this.UKa,f)};Ta.prototype.Mrd=function(f){return!f.GroupUI};
Ta.prototype.VBf=function(f,D,N){var fa=Mh.a(f);ld.ULS.sendTraceTag(537161955,0,50,"FunctionInfoManager.OnFunctionListSuceeded: areNonStatusMessagesPresentInResult={0}",fa);fa?(We.g(this.$).endEdit(!1,"FunctionInfoManager.OnFunctionListSuceeded"),this.$.ea.Hp(f.Errors)):(this.JKd(f.Result,D,N),cg.a.xW()&&!cg.a.pD(this.$)&&this.yYj())};Ta.prototype.JKd=function(f,D,N){ld.ULS.sendTraceTag(537161954,0,50,"FunctionInfoManager.RefreshFunctionList: functionsInfo count = {0}, isCategorized = {1}, partialResult = {2} IsFullyLoaded = {3}",
f.length,D,N,this.Y5);this.Y5||(this.cU=f,this.fUg(D),this.zNc=!N,this.YOf())};Ta.prototype.YOf=function(){this.raiseEvent("FunctionInfoLoaded")};Ta.prototype.yYj=function(){this.pluginScheduler.notifier().setFunctionsInfo(this.sfd)};Ta.prototype.fUg=function(f){function D(Ze,Sf){return Ze.NameUI.localeCompare(Sf.NameUI)}var N=oe.a.instance.fa(1001),fa=[];this.UKa={};this.G9=[];this.UKa[N]=fa;var Ia=oe.a.instance.fa(1002),pb=[];Array.add(this.G9,N);Array.add(this.G9,Ia);N=0;for(var Wb=this.cU.length;N<
Wb;N++){var Nc=this.cU[N];Nc.IsCompatibility||Array.add(pb,Nc);var kd=Nc.NameUI,Xc=Nc.NameDataStrings;this.xfd[Xc.toUpperCase()]||(this.xfd[Xc.toUpperCase()]=Nc);this.LZe[kd.toUpperCase()]||(this.LZe[kd.toUpperCase()]=Nc);if(!this.Mrd(Nc)){if(f){kd=Nc.GroupUI;var Ie=xg.a.Fc(this.UKa,kd);Ie||(Ie=[],this.UKa[kd]=Ie,Array.add(this.G9,kd));Array.add(Ie,Nc)}Nc.IsCommonlyUsed&&Array.add(fa,Nc);Nc.IsCompatibility||Array.add(this.$sg,Xc)}}this.UKa[Ia]=pb;f&&(Ta.MSf(fa,[2,3,0,5,4,9,1,7,8,6]),fa=Array(14),
fa[0]=0,fa[1]=1,fa[2]=7,fa[3]=11,fa[4]=5,fa[5]=2,fa[6]=6,fa[7]=10,fa[8]=9,fa[9]=3,fa[10]=4,fa[11]=13,fa[12]=12,fa[13]=8,Ta.MSf(this.G9,fa),fa=[],Array.addRange(fa,this.G9),Array.removeAt(fa,13),this.G9=fa);this.cU=Array.clone(this.cU);this.cU.sort(function(Ze,Sf){return Ze.NameDataStrings.localeCompare(Sf.NameDataStrings)});fa=1;for(Ia=this.G9.length;fa<Ia&&f;fa++)this.UKa[this.G9[fa]].sort(D);f=0;for(fa=this.cU.length;f<fa;f++)this.cU[f].FunctionIndex=f};Ta.MSf=function(f,D){for(var N=Array.clone(f),
fa=0;fa<N.length&&fa<D.length;fa++)f[fa]=N[D[fa]]};uk.Object.defineProperties(Ta.prototype,{Y5:{configurable:!0,enumerable:!0,get:function(){return this.zNc}},qni:{configurable:!0,enumerable:!0,get:function(){return this.xNc}},sfd:{configurable:!0,enumerable:!0,get:function(){var f=this.cU,D=Fi.a(this.$);if(!D)return f;D=D.MUh();var N=D.length;if(0>=N)return f;var fa=[];Array.addRange(fa,f);for(f=0;f<N;f++){var Ia=D[f],pb={};pb.FunctionIndex=fa.length;pb.HelpId=pb.GroupUI=null;pb.Help=Ia.description;
pb.IsCommonlyUsed=pb.IsCompatibility=!1;pb.NameDataStrings=Ia.name;pb.NameUI=Ia.name;pb.Params=null;pb.ParamsHelp=null;Array.add(fa,pb)}return fa}},AZe:{configurable:!0,enumerable:!0,get:function(){return this.G9}},$:{configurable:!0,enumerable:!0,get:function(){return this.wb}}});Object(Jb.a)(Ta,"FunctionInfoManager",di.a,[742,743,3]);var Ch=b(1198),Bi=Ch.a;Am(pc,Bi);pc.prototype.setVisible=function(f){$a.DOMElementExtensions.setVisible(this.domElement,f);f||(this.domElement.style.top="auto",this.domElement.style.left=
"auto")};pc.prototype.isRtl=function(){return this.rj};pc.prototype.k5e=function(){return this.domElement.parentNode};pc.prototype.fTa=function(f){var D=this.domElement.style;D.cursor="move";D.position=f?"relative":"absolute"};Object(Jb.a)(pc,"FunctionParamBoxDraggableItem",Ch.a,[]);Object(Jb.a)(yb,"FormulaArgumentAssistanceCallbacks",null,[]);Object(Jb.a)(lb,"FormulaArgumentAssistanceRenderingInfo",null,[]);Object(Jb.a)(Cb,"ArgumentAssistanceRequest",null,[]);wc.prototype.ka=function(f){(this.root=
f)&&!this.un&&(this.root.addEventListener("keydown",this.onKeyDown,!0),this.un=!0)};wc.prototype.detach=function(){this.root&&this.un&&(this.root.addEventListener("keydown",this.onKeyDown,!0),this.un=!1)};wc.prototype.W9b=function(){this.root&&(this.target=this.EH.EHf("move",!0),this.TWd=this.target.getBoundingClientRect(),this.F_=!0,this.VTd=!1,this.Gv(),this.Cnc||this.M6c(),this.target.appendChild(this.Cnc))};wc.prototype.Y4=function(f){this.EH.eBf(void 0===f?!1:f);this.F_=!1;this.WLd();this.xLd();
this.TWd=this.target=void 0};wc.prototype.Gv=function(){this.Lr.capture(this.oOa,null);this.pointerInputManager.Mt(hg.a.pointerDown,this.target,this.vHb,!0);this.target.addEventListener("blur",this.onBlur)};wc.prototype.xLd=function(){this.Lr.releaseCapture();this.pointerInputManager.Rt(hg.a.pointerDown,this.target,this.vHb,!0);this.target.removeEventListener("blur",this.onBlur)};wc.prototype.WLd=function(){var f;this.target&&(null===(f=this.Cnc)||void 0===f?void 0:f.parentNode)===this.target&&this.target.removeChild(this.Cnc)};
wc.prototype.K6=function(f,D){var N=this.target.getBoundingClientRect();f+=N.left-this.TWd.left;D+=N.top-this.TWd.top;this.EH.onMove(f,D)};wc.prototype.M6c=function(){this.Cnc=lj.createClusteredImage(24,24,"ShapeQuadArrow_24x24x32","WACMoveArrowIcon",!0,"")};Object(Jb.a)(wc,"FormulaAssistanceMoveAdapter",null,[]);var Ni=b(284);Rb.prototype.fca=function(){return this.un&&!!this.Wka};Rb.prototype.SPa=function(f){this.Wka.style.cursor="grabbing";this.PKj=f.clientPoint.x;this.QKj=f.clientPoint.y;this.EH.EHf("drag");
return!0};Rb.prototype.bna=function(f){this.EH.onMove(f.clientPoint.x-this.PKj,f.clientPoint.y-this.QKj);return!0};Rb.prototype.ana=function(){this.iu()};Rb.prototype.$ma=function(){this.iu()};Rb.prototype.ka=function(f){if(this.Wka=f)this.Wka.style.cursor="grab",Ni.a.instance.Z0(this.Wka,this),this.un=!0};Rb.prototype.detach=function(){this.un&&this.Wka&&(this.Wka.style.cursor="",Ni.a.instance.P8(this.Wka,this),this.un=!1)};Rb.prototype.iu=function(){this.Wka.style.cursor="grab";this.EH.eBf()};Object(Jb.a)(Rb,
"FormulaAssistanceDragAdapter",null,[907]);ib.prototype.ka=function(f,D,N,fa){this.root=f;this.render=N;this.dismiss=fa;this.detach();D&&(this.rNe.ka(D),this.Luf.ka(f.firstChild),this.un=!0)};ib.prototype.detach=function(){this.un&&(this.rNe.detach(),this.Luf.detach(),this.un=!1);$a.DOMElementExtensions.vf(this.placeholder)};ib.prototype.clear=function(){this.wbc.setOverrideTarget(void 0);this.detach();this.JNd()};ib.prototype.EHf=function(f,D){D=void 0===D?!1:D;this.usageCount[f]+=1;this.TAc=this.root.firstChild.getBoundingClientRect();
this.placeholder=this.root.cloneNode(!0);f=this.placeholder.firstChild;f.style.animationDuration="0ms";this.root.parentElement.appendChild(this.placeholder);D&&(this.hId=document.activeElement,f.tabIndex=0,f.focus());this.dismiss();return f};ib.prototype.onMove=function(f,D){f=Math.min(Math.max(f,this.rFc-this.TAc.left),window.innerWidth-this.TAc.right-this.rFc);D=Math.min(Math.max(D,this.rFc-this.TAc.top),window.innerHeight-this.TAc.bottom-this.rFc);this.placeholder.firstChild.style.transform="translate("+
f+"px, "+D+"px)"};ib.prototype.eBf=function(f){var D=this;f=void 0===f?!0:f;var N=this.placeholder.firstChild.getBoundingClientRect(),fa=this.wbc.getDirectionalHint({top:N.top,left:N.left});this.wbc.setOverrideTarget({top:1===fa?N.bottom:N.top,left:N.left});this.render();window.requestAnimationFrame(function(){window.requestAnimationFrame(function(){$a.DOMElementExtensions.vf(D.placeholder);D.hId&&(f&&D.hId.focus(),D.hId=void 0)})})};ib.prototype.JNd=function(){var f=this.formulaAssistanceTelemetryManager.wba,
D=this.usageCount[ii.Drag],N=this.usageCount[ii.Move];0<D&&(f.argumentAssistanceDragCounter+=1,f.argumentAssistanceDragTotalCounter+=D,this.usageCount[ii.Drag]=0);0<N&&(f.argumentAssistanceMoveCounter+=1,f.argumentAssistanceMoveTotalCounter+=N,this.usageCount[ii.Move]=0)};Object(Jb.a)(ib,"FormulaAssistanceDragControl",null,[]);var ii;(function(f){f.Drag="drag";f.Move="move"})(ii||(ii={}));Object(Jb.b)("FormulaAssistanceDragMode",ii);var xi=Ug.a;Am(Da,xi);Da.prototype.ire=function(f){this.addHandler("FAFunctionNameUpdated",
f)};Da.prototype.tUf=function(f){this.removeHandler("FAFunctionNameUpdated",f)};Da.prototype.Yre=function(f){this.addHandler("FAParameterSelectionChangedOld",f)};Da.prototype.QUf=function(f){this.removeHandler("FAParameterSelectionChangedOld",f)};Da.prototype.Xre=function(f){this.addHandler("FAParameterSelectionChanged",f)};Da.prototype.PUf=function(f){this.removeHandler("FAParameterSelectionChanged",f)};Da.prototype.set_visible=function(f){this.Ln?f||this.Utb():Sys.UI.Control.prototype.set_visible.call(this,
f);return f};Da.prototype.Utb=function(){this.formulaAssistanceUIControl&&(this.gr=null,this.dS&&this.EH.detach(),this.formulaAssistanceUIControl.dismiss(this.domElement),this.jma=null,this.Hr.canReceiveFocus=!1)};Da.prototype.show=function(f){this.Ln||(this.formulaAssistanceTelemetryManager.kJ(["argumentAssistanceRender"]),this.c3a.setVisible(!!f),this.formulaAssistanceTelemetryManager.uF(["argumentAssistanceRender"]),this.xZc&&(this.xZc=!1,this.formulaAssistanceTelemetryManager.I9b("argumentAssistanceOverall")))};
Da.prototype.MNd=function(){var f=this;if(!this.cca||this.tTa){this.formulaAssistanceTelemetryManager.kJ(["argumentAssistanceComputation","argumentAssistanceOverall"]);var D=We.g(this.$).Uj;this.pluginScheduler.requester().argumentAssistance(Object.assign(new Cb,{content:D.text,caretPosition:D.textBox.caretPosition})).then(function(N){0===N.kind?N.payload?(f.formulaAssistanceTelemetryManager.uF(["argumentAssistanceComputation"]),f.yEj(f.EHd(N.payload),D.textBox.domElement)):f.Utb():f.formulaAssistanceTelemetryManager.uF(["argumentAssistanceComputation"],
!1);return null})}};Da.prototype.update=function(f,D,N,fa){if(!this.Ln&&f){this.formulaAssistanceTelemetryManager.kJ(["argumentAssistanceComputation","argumentAssistanceOverall"]);this.xZc=!0;var Ia=this.$.listSeparator;try{var pb=$get(db.vfd,this.Fj),Wb=$get(db.ofd,this.Fj);pb.innerText="";Wb.innerText="";var Nc=$get(db.HZe,this.Fj),kd=f.Params.split(db.kcd);pb=[];Wb=0;for(var Xc=Nc.rows.length;Wb<Xc;Wb++){var Ie=Nc.rows[Wb];$a.DOMElementExtensions.setVisible(Ie,Wb<kd.length);var Ze=kd[Wb],Sf=db.W0i+
Wb+"_",ag=f.NameDataStrings;$get(Sf+db.$Gb,Ie).innerText=ag;$get(Sf+db.iGd,Ie).innerText=ag;if(Ze){var og=kd[Wb].split(Ia),Vg=Da.lrd(og[og.length-1]),Hh=Da.Gpi(f);Vg&&(Hh&&(2<og.length?(og[og.length-2]+="1",og[og.length-3]+="1"):ld.ULS.sendTraceTag(537162073,0,50,"pair params formula should have at least 2 params. at UpdateParameterAssistance. formula '{0}', {1} params, currentParameterIndex = {3}.",ag,og.length.toString(),D)),Da.gOg(og,Hh,D,f));Ze=og.join(Ia.toString()+" ");kd[Wb]=Ze;N<og.length?
(pb[Wb]=og[N],ld.ULS.shipAssertTag(537162072,0,!!og[N]&&1<=og[N].length,"Emphasized parameter is too short or empty selectedParameterIndex = {0}, currRowParamsArray.Length = {1}, formula name = {3}, current row = {4}",N,og.length,ag,Wb),og[N]=String.format("{0}{1}{2}","<b>",og[N],"</b>"),Ze=og.join(Ia.toString()+" ")):ld.ULS.shipAssertTag(537162071,0,!1,"the current param index is larger than the param list count. selectedParameterIndex = "+N+"currRowParamsArray.Length = "+og.length+", current row = "+
Wb);fa&&ld.ULS.sendTraceTag(558474578,0,50,"formula '{0}', {1} params, isElipsis = {2}, isPairsParamsFormula = {3}, currentParameterIndex = {4}",ag,og.length,Vg,Hh,D)}$get(Sf+db.jGd,Ie).innerHTML="("+(Ze||"")+")"}fa?this.raiseEvent("FAFunctionNameUpdated",new jb(f.NameDataStrings,kd)):this.raiseEvent("FAParameterSelectionChangedOld",new ic(kd,pb,N));Nc.className=ti.a.$uh+(this.functionInfoManager.Mrd(f)?"-udf":"")}catch(ji){throw ld.ULS.shipAssertTag(558474577,0,!1,"UpdateParameterAssistance Exception. formula '{0}', {1} params. \nException: {4}",
f.NameDataStrings,D,ji),ji;}this.formulaAssistanceTelemetryManager.uF(["argumentAssistanceComputation"])}};Da.prototype.dispose=function(){this.Ln||(this.xc.qB(),Ag.a.Fa(this.xc),We.g(this.$).view.fr(this.Gt),Ag.a.Fa(this.c3a),this.c3a=null);this.Ln&&Ag.a.Fa(this.Hr);this.cca&&We.g(this.$).Ac.Zn(this.Rg);this.functionInfoManager=this.$=null;xi.prototype.dispose.call(this)};Da.prototype.EHd=function(f){var D=new lb;D.functionRenderingInfo=f;D.cardMode=this.D3;this.nLd(D);return D};Da.prototype.nLd=
function(f){f.callbacks=new yb;f.callbacks.onHelpLink=this.Zhd(f.functionRenderingInfo);f.callbacks.onCardModeChange=this.onCardModeChange;f.callbacks.onFeedback=this.ISa;this.cca&&(f.callbacks.onDismissClick=this.onDismissClick)};Da.prototype.yEj=function(f,D){var N=this;if(this.formulaAssistanceUIControl){this.formulaAssistanceTelemetryManager.kJ(["argumentAssistanceRender"]);var fa={};fa.zoomLevel=wa(this.$);this.formulaAssistanceUIControl.updateContext(fa);this.gr=function(){N.formulaAssistanceUIControl.renderArgumentAssistanceCard(N.domElement,
D,f)};this.gr();this.JGd(f);this.dS&&this.EH.ka(this.formulaAssistanceUIControl.getCalloutElement(0),this.formulaAssistanceUIControl.getDraggableElement(0),this.gr,function(){return N.formulaAssistanceUIControl.dismiss(N.domElement)});this.Hr.canReceiveFocus=!0;this.formulaAssistanceTelemetryManager.uF(["argumentAssistanceRender"]);this.formulaAssistanceTelemetryManager.I9b("argumentAssistanceOverall")}};Da.prototype.Zhd=function(f){var D=this;return function(){Ca(D.$,f.helpID,f.isUDF)}};Da.prototype.XRd=
function(){var f=gh.a.get(Bf.a.x1b);this.D3=f?parseInt(f,10):Da.H8c;this.formulaAssistanceTelemetryManager.s1f(this.D3)};Da.prototype.JGd=function(f){var D=f.functionRenderingInfo.functionName;this.jma&&Ba.a.equals(this.jma,D,!0)?(D=gg.a.map(f.functionRenderingInfo.signatures,function(N){var fa="";0<=N.signatureParams.activeParam&&N.signatureParams.activeParam<N.signatureParams.params.length&&(fa=N.signatureParams.params[N.signatureParams.activeParam]);return fa}),this.raiseEvent("FAParameterSelectionChanged",
new Va(D))):(this.jma=D,f=gg.a.map(f.functionRenderingInfo.signatures,function(N){return N.signatureParams.params.join(", ")}),this.raiseEvent("FAFunctionNameUpdated",new jb(D,f)))};Da.prototype.wPb=function(f){this.D3=f;try{gh.a.Mv(Bf.a.x1b,f.toString(),$i.AFrame.jfa)}catch(D){ld.ULS.sendTraceTag(537162070,0,15,"Failed setting ArgumentAssistanceCardCollapseState cookie with error message: {0}",D.message)}};Da.lrd=function(f){return Ba.a.contains(f,db.w9b,!0)};Da.Gpi=function(f){return!!f&&Ba.a.o3a(f.NameDataStrings,
"IFS")};Da.gOg=function(f,D,N,fa){try{if(!f||2>f.length)ld.ULS.shipAssertTag(537162069,0,!1,"Requested not on elipsis function, formula '{0}', {1} params, isPairsParamsFormula = {2}, currentParameterIndex = {3}.",fa.NameDataStrings,f?f.length.toString():"currRowParamsArray == null",D,N);else{for(var Ia=f.pop().toString(),pb=f.length-1;pb<N;pb++){var Wb=f[pb].trim();if(D){var Nc=f[pb-1].trim();f.push(Da.BMh(Nc,Wb))}else{var kd=Da.jdf(Wb);f.push(Da.i_e(kd))}}f.push(Ia)}}catch(Xc){throw ld.ULS.shipAssertTag(537162068,
0,!1,"AppendNewOptionalParameters Exception. formula '{0}', {1} params, isPairsParamsFormula = {2}, currentParameterIndex = {3}. \nException: {4}",fa.NameDataStrings,f?f.length.toString():"currRowParamsArray == null",D,N,Xc),Xc;}};Da.BMh=function(f,D){f=Da.jdf(f);var N=Da.j5e(f);D=Da.j5e(D);return Da.i_e(f,!0,!!N&&!!D&&N!==D)};Da.jdf=function(f){var D=f.match(Da.UBd);f=Ba.a.trimEnd(Ba.a.trimStart(f,db.zJf),db.yJf);if(D&&D.length){D=D[D.length-1];var N=Number.parseLocale(D)+1;f=f.replace(D,N.toString())}else f=
String.format("{0}{1}",f,1);return f};Da.i_e=function(f,D,N){var fa="[{0}]";(void 0===D?0:D)&&(fa=(void 0===N?0:N)?"[{0}":"{0}]");return String.format(fa,f)};Da.j5e=function(f){return(f=f.match(Da.UBd))&&f.length?f[0]:null};Da.XKa=function(f){if(f)return document.createElement("div");f=String.format(db.hKf,db.fKf,db.iGd,ti.a.DRe,db.$Gb,ti.a.CRe,db.jGd);var D=String.format(db.hKf,db.gKf,db.iGd,ti.a.DRe,db.$Gb,ti.a.CRe,db.jGd);f=String.format(db.TKh,db.UKh,ti.a.ASe,ti.a.arh,R.a.kp,db.HZe,f,D);D=document.createElement("div");
D.innerHTML=f;return D.firstChild};Da.UBd=RegExp("\\d+");Da.H8c=0;Object(Jb.a)(Da,"FormulaArgumentAssistanceControlDeprecated",Ug.a,[887]);Object(Jb.a)(Ja,"ParseContext",null,[]);var Vj=b(333),qh=lk.a;Am(pa,qh);pa.prototype.Yh=function(f,D){this.formulaAssistanceControl.Za=this.Za;-1470715894!==D&&-1231471547!==D||this.o7a&&!this.HLe()||(this.BW=!1);return qh.prototype.Yh.call(this,f,D)};pa.prototype.uCd=function(){var f=this.KMa;if(f||this.sUd){this.formulaAssistanceControl.Za=this.Za;if(this.o7a&&
(this.formulaAssistanceTelemetryManager.rqb.formulaAssistanceRequestAttemptedCounter++,!this.HLe())){this.formulaAssistanceTelemetryManager.rqb.formulaAssistanceRequestOptimizedCounter++;return}if(!f&&this.sUd)this.formulaAssistanceControl.$ve();else if(ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AutocompleteTableColumnHeaders",!1)&&this.adi){if(f=this.$.Sb.Hc("LoadingUIShown","FormulaAutoCompleteListAutoCompleteBehavior"),this.formulaAssistanceControl.bwe(),f.stop(),this.mqb.text.endsWith("[")&&
"["!==this.mqb.text.charAt(this.mqb.text.length-2)){var D=""===this.$Ia?this.formulaAssistanceControl.tableManager.Ig:Object(k.a)(Vj.a,this.$.Ab.getItemByName(this.$Ia));ld.ULS.sendTraceTag(575776010,0,50,"FormulaAutoCompleteListAutoCompleteBehavior.OnAutoCompleteTimerTick: AutoComplete List Box for Table Column Headers is shown after user types =[ inside a table with id {0} in {1} ms with cell edit regression time of {2} ms and popup visibility - {3}",D.pj,f.Gc,this.uod,this.BW)}}else this.formulaAssistanceControl.aqb(),
this.bJf&&(this.bJf=this.BW=!1)}else this.BW=!1};pa.prototype.mj=function(){this.Tej||(this.xTa=null,this.sUd&&this.formulaAssistanceControl.t_())};pa.prototype.Rg=function(){this.BW=!1;this.formulaAssistanceControl.set_visible(!1);this.formulaAssistanceControl.Vvc();this.Ln&&this.Mzi()};pa.prototype.YId=function(f,D){return this.formulaAssistanceControl.Yh(f,D)};pa.prototype.Mzi=function(){this.formulaAssistanceControl.XBa&&(this.formulaAssistanceTelemetryManager.PKa.smartSuggestionShownCounter++,
this.formulaAssistanceControl.XBa=!1);this.formulaAssistanceControl.QTa&&(this.formulaAssistanceTelemetryManager.PKa.smartSuggestionSelectedCounter++,this.formulaAssistanceControl.QTa=!1);this.formulaAssistanceControl.vNb&&(this.formulaAssistanceTelemetryManager.PKa.smartSuggestionCommittedCounter++,this.formulaAssistanceControl.vNb=!1)};pa.prototype.wZg=function(f,D){for(var N=0,fa;-1!==N;)if(N=f.indexOf("[",N+1),-1!==N&&N<D&&(fa=f.indexOf("]",N+1),-1===fa||fa>=D))return N;return-1};pa.prototype.HLe=
function(){var f=this.Za.text,D=this.Za.textBox.caretPosition,N=this.formulaAssistanceControl.zOa,fa=this.formulaAssistanceControl.yOa;if(this.BW&&Ba.a.equals(f,N,!0)&&D===fa)return!1;this.formulaAssistanceControl.zOa=f;this.formulaAssistanceControl.yOa=D;return!0};uk.Object.defineProperties(pa.prototype,{uAb:{configurable:!0,enumerable:!0,get:function(){return Object(td.a)(ma,this.$.yb.rh)}},BW:{configurable:!0,enumerable:!0,get:function(){return this.formulaAssistanceControl.isListVisible},set:function(f){this.formulaAssistanceControl.isListVisible=
f}},KMa:{configurable:!0,enumerable:!0,get:function(){return this.Za.KMa}},adi:{configurable:!0,enumerable:!0,get:function(){var f=this.mqb.text,D=!1;if(0>=f.length)return D;var N=this.$.Sb.Hc("LoadingUIShown","FormulaAutoCompleteListAutoCompleteBehavior"),fa=We.g(this.$).ga.va.activeCell.clone(),Ia=f.charCodeAt(0);this.$Ia="";this.jR=this.wZg(f,this.mqb.caretPosition);Ia=61===Ia&&-1!==this.jR;if(!ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5402572_CrossSheetTableReferencing"))Ia&&(D=!0);else if(Ia){if(ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")){Ia=
0;for(var pb=this.jR-1;1<=pb&&!(this.jR-pb>pa.Gtf);pb--)if(Array.contains(pa.Zxe,f.charAt(pb))){Ia=pb;break}Ia=f.substring(Ia+1,this.jR);f=""!==Ia?this.$.Ab.getItemByName(Ia):null;pb=this.jR;for(var Wb=this.jR+1;Wb<=this.Za.textBox.caretPosition;Wb++)if("["===this.Za.text.charAt(Wb))pb=Wb;else break;this.jR=pb}else{Ia=f.lastIndexOf("[");pb=0;for(Wb=Ia-1;1<=Wb&&!(Ia-Wb>pa.Gtf);Wb--)if(Array.contains(pa.Zxe,f.charAt(Wb))){pb=Wb;break}Ia=f.substring(pb+1,Ia);f=""!==Ia?this.$.Ab.getItemByName(Ia):null}f&&
2===f.type?(D=!0,this.$Ia=Ia):We.g(this.$).Tb.Wj(fa)&&(D=!0,this.$Ia="")}N.stop();this.uod=N.Gc;ld.ULS.sendTraceTag(575776011,0,50,"FormulaAutoCompleteListAutoCompleteBehavior.InTableHeaderMode: Regression time in cell edit due to column header mode parsing is {0} milliseconds",this.uod);return D}},key:{configurable:!0,enumerable:!0,get:function(){return Dk.a.z4a}},calcManager:{configurable:!0,enumerable:!0,get:function(){this.rIc||(this.rIc=this.$.da.Aa(266,!1));return this.rIc}},sUd:{configurable:!0,
enumerable:!0,get:function(){if(null!=this.xTa)return this.xTa;if(!ye.EwaSettings.ma(136))return this.xTa=!1;var f=We.g(this.$).ga.va.activeCell.clone();if(1!==f.otf||!f.left||We.g(this.$).ga.va.Zic())return!1;var D=this.formulaAssistanceControl.tableManager.rn(f);if(D)return this.xTa=!1;--f.left;--f.right;if(!f.isValidRange)return!1;D=this.formulaAssistanceControl.tableManager.rn(f);return this.xTa=!!D&&f.top===D.top&&this.formulaAssistanceControl.tableManager.Y7g(D,We.g(this.$))}}});pa.Zxe=" !%&'()*+,-/:;<=>@[]^{|}~".split("");
pa.Gtf=255;Object(Jb.a)(pa,"FormulaAutoCompleteListAutoCompleteBehavior",lk.a,[]);var oj;(function(f){f[f.function=0]="function";f[f.field=1]="field";f[f.definedName=2]="definedName";f[f.letVariable=3]="letVariable";f[f.tableColHeaderName=4]="tableColHeaderName";f[f.tableSpecialStructRef=5]="tableSpecialStructRef";f[f.pendingData=6]="pendingData";f[f.tableNamedObject=7]="tableNamedObject"})(oj||(oj={}));Object(Jb.b)("ItemType",oj);var Ij=b(1260),Tk=b(1259);nb.prototype.execute=function(f){Array.add(f,
this.index)};Object(Jb.a)(nb,"AppendIndexOperation",null,[906]);zb.prototype.execute=function(){};Object(Jb.a)(zb,"NopIndexOperation",null,[906]);gb.prototype.execute=function(f){for(var D=0;D<f.length;D++)f[D]===this.S5i&&(f[D]=this.Ovf)};Object(Jb.a)(gb,"ReplaceIndexOperation",null,[906]);Za.prototype.gIe=function(f,D){var N=new nb(D);if(!this.CNa)return N;f=this.qui(f,D);return null!=f?this.items[f].OBb?new gb(f,D):new zb:N};Za.prototype.qui=function(f,D){var N=this,fa=this.items[D];ld.ULS.shipAssertTag(537162075,
0,!!fa,"Internal error: invalid item index");f=d.where(d.asEnumerable(f),function(Ia){return N.items[Ia].name===fa.name});return d.Ct(f)?d.first(f):null};Object(Jb.a)(Za,"FilterItemOperationFactory",null,[]);Object(Jb.a)(Ma,"CompletionItem",null,[]);var el="<tr>\r\n\t{0}\r\n\t<td id='name_cell{4}' class='{1}'>{2}</td>\r\n\t<td id='description_cell{4}' class='"+R.a.kp+"'>{3}</td>\r\n\t<td id='item_type_cell' class='"+R.a.kp+"'>{5}</td>\r\n</tr>",mj="<tr>\r\n\t{0}\r\n\t<td id='name_cell{1}' class='{3}'>{4}</td>\r\n\t<td id='description_cell{1}' class='"+
R.a.kp+"'></td>\r\n\t<td id='item_type_cell' class='"+R.a.kp+"'>{2}</td>\r\n</tr>",Dj="<td>\r\n\t<div class='"+R.a.Dr+"'>\r\n\t\t<img class='{0}' src='{1}' alt='{2}'/>\r\n\t</div>\r\n</td>",Rj="<tr>\r\n\t<td><b>{0}</b></td>\r\n\t<td id='name_cell{1}' class='{3}'>{4}</td>\r\n\t<td id='description_cell{1}' class='"+R.a.kp+"'>{5}</td>\r\n\t<td id='item_type_cell' class='"+R.a.kp+"'>{2}</td>\r\n</tr>",ui=Ij.a;Am(oa,ui);oa.prototype.Zre=function(f){this.addHandler("FLBSelectedRowChanged",f)};oa.prototype.RUf=
function(f){this.removeHandler("FLBSelectedRowChanged",f)};oa.prototype.OXc=function(f){this.addHandler("ACLBUpdated",f)};oa.prototype.zMd=function(f){this.removeHandler("ACLBUpdated",f)};oa.prototype.dispose=function(){ui.prototype.dispose.call(this);this.vsa=this.IZe=this.jwb=null};oa.prototype.ABc=function(f,D,N,fa){fa=void 0===fa?0:fa;this.ojf||this.y8(!1);var Ia="";N&&(Ia+=String.format("<table aria-live='off' id='{0}'><tr><td class='{1}'>{2}</td></tr></table>","list_column_header",ti.a.o3g,
N));Ia+=String.format("<table class='{0}' aria-live='off'><tbody>",this.Kca);for(var pb=new Ab.a,Wb=0,Nc=this.tX.length;Wb<Nc;Wb++)Ia+=this.t7e(f[this.tX[Wb]],Wb+1,D,fa),this.Ln&&pb.add(this.h1e(f[this.tX[Wb]]));Wb=this.tX.length;Nc=0;for(var kd=this.Cs.length;Nc<kd;Nc++)Array.contains(this.tX,this.Cs[Nc])||(Wb++,Ia+=this.t7e(f[this.Cs[Nc]],Wb,D,fa),this.Ln&&pb.add(this.h1e(f[this.Cs[Nc]])));this.pg.innerHTML=Ia+"</tbody></table>";this.Un=$a.DOMElementExtensions.Ij(this.domElement,this.Kca);this.Ln&&
(this.M4c=pb.toArray());this.ojf?(this.isListVisible=!0,this.vHa.set_visible(!0)):(this.y8(!0),this.hMg(!!N))};oa.prototype.xKa=function(f,D,N,fa,Ia,pb){fa=void 0===fa?"":fa;Ia=void 0===Ia?0:Ia;pb=void 0===pb?!1:pb;if(f){var Wb=[],Nc=[];this.uNb=0;var kd=new Za(this.$,f);if(D){var Xc=!!D&&0<Ia,Ie=Xc&&91===D.charCodeAt(Ia+1)?Ia+2:Ia+1;pb=Xc?D.length===Ie:!1;Xc&&D.length===Ia&&ye.EwaSettings.ma(136)&&(pb=!0);var Ze=null;!pb&&Xc&&D.length>Ia+1&&(Ze=D.substring(Ie,D.length));if(D)for(Xc=0,Ie=f.length;Xc<
Ie;Xc++){var Sf=f[Xc].name;if(!f[Xc].vli){var ag=kd.gIe(Wb,Xc);f[Xc].OBb&&this.uNb++;if(!Ze&&!pb||0===f[Xc].itemType)Nc=this.ZWe(D,Sf,N,ag,Wb,Nc),Wb=Nc.sdf,Nc=Nc.jMf;Ze&&1===f[Xc].itemType&&(Nc=this.ZWe(Ze,Sf,!0,ag,Wb,Nc),Wb=Nc.sdf,Nc=Nc.jMf);pb&&1===f[Xc].itemType&&ag.execute(Wb)}}}else for(N=0;N<f.length;++N)if(f[N].OBb||pb)Ze=kd.gIe(Wb,N),Ze.execute(Wb),Ze.execute(Nc),f[N].OBb&&this.uNb++;this.tX=Nc;this.Cs=Wb;this.ABc(f,D,fa,Ia)}};oa.prototype.CXj=function(f){if(f&&!(1<f.length)){var D=[],N=[];
D.push(0);N.push(0);this.tX=D;this.Cs=N;this.ABc(f,"","",0)}};oa.prototype.jza=function(){this.al&&ui.prototype.jza.call(this)};oa.prototype.j9i=function(f,D){this.raiseEvent("ACLBUpdated",new Tk.a(f,void 0,void 0,D))};oa.prototype.Zhg=function(f){var D=this.Un.rows[f];return(!this.al||this.al!==D)&&f<this.Un.rows.length?(this.al=D,!0):!1};oa.prototype.Bpc=function(f){Yf.g(f.Ca);0===this.mx||2===this.mx||3===this.mx||4===this.mx||5===this.mx||7===this.mx?(this.raiseEvent(Ek.a.T5a),this.jza()):1===
this.mx?this.vHa.oz(!1):(this.vHa.oz(!1),f=We.g(this.$),f.kr(!1),f.focus());return!0};oa.prototype.hMg=function(f){this.ata();if(f){var D=this.Un.offsetWidth+(this.Cs.length>this.xI?fj.a.Mp:0);f=$get("list_column_header");f.offsetWidth>D&&$a.DOMElementExtensions.nr(this.pg,f.offsetWidth);D=this.pg.getElementsByClassName(this.f0);for(var N=0;N<D.length;N++)D[N].style.width=ca.HelperMethods.Yb(f.offsetWidth)}};oa.prototype.t7e=function(f,D,N,fa){if(1===f.itemType){var Ia=Lg.a.Rf(f.name),pb=Lg.a.Rf(fa?
N.substring(fa+1,N.length):N),Wb=0;Ia.substring(0,pb.length).toLowerCase()!==pb.toLowerCase()&&(Wb=oa.vKj(Ia,db.Qkg,pb));N="";N=0<=Wb?N+(Ia.substring(0,Wb)+"<b>"+Ia.substring(Wb,Wb+pb.length)+"</b>"+Ia.substring(Wb+pb.length,Ia.length)):N+Ia;fa=fa?String.format(Dj,R.a.eTe,Lg.a.rW(Te.a.Ge(0)),oe.a.instance.fa(699)):"";return String.format(mj,fa,D,oj[f.itemType],this.f0,N)}if(5===f.itemType)return String.format(Rj,"",D,oj[f.itemType],this.f0,Lg.a.Rf(f.name),Lg.a.Rf(f.hka));if(4===f.itemType)return String.format(Rj,
"(...)",D,oj[f.itemType],this.f0,Lg.a.Rf(f.name));if(6===f.itemType)return fa=fa?String.format(Dj,R.a.eTe,Lg.a.rW(Te.a.Ge(0)),oe.a.instance.fa(699)):"",String.format(el,fa,this.f0,Lg.a.Rf(f.name),Lg.a.Rf(f.hka),D,oj[f.itemType]);fa=String.format(Dj,2===f.itemType||3===f.itemType?R.a.Zyh:R.a.Xyh,Lg.a.rW(Te.a.Ge(0)),oe.a.instance.fa(696));return String.format(el,fa,this.f0,Lg.a.Rf(f.name),Lg.a.Rf(f.hka),D,oj[f.itemType])};oa.prototype.h1e=function(f){var D=new Ma;D.label=f.label;D.textEdit=f.textEdit;
D.kind=oa.oRh(f.itemType);D.type=f.OBb?1:0;if(ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5607789_FunctionShortDescriptions")&&3===D.kind){var N=this.formulaAssistanceControl.zVh(f.label);D.detail=N?N:f.hka}else D.detail=f.hka;return D};oa.prototype.ZWe=function(f,D,N,fa,Ia,pb){Ba.a.equals(D,"Pretend this is the line.",!1)&&0<Ia.length||Ba.a.kM(D,f)?(fa.execute(Ia),fa.execute(pb)):N&&f.length>=db.a8g&&oa.Hhh(D,db.Qkg,f)?fa.execute(Ia):!N&&f.length>=db.$7g&&Ba.a.contains(D,f,!0)&&fa.execute(Ia);
return{sdf:Ia,jMf:pb}};oa.oRh=function(f){switch(f){case 0:return 3;case 2:return 100;case 1:case 6:return 103;case 3:return 102;case 4:return 101;case 5:return 107;case 7:return 106;default:return 3}};oa.Hhh=function(f,D,N){D=Cl(D);for(var fa=D.next();!fa.done;fa=D.next())if(fa=f.split(fa.value),!(2>fa.length)){fa=Cl(fa);for(var Ia=fa.next();!Ia.done;Ia=fa.next())if(Ba.a.kM(Ia.value,N))return!0}return!1};oa.vKj=function(f,D,N){D=Cl(D);for(var fa=D.next();!fa.done;fa=D.next())if(fa=f.toLowerCase().indexOf((fa.value+
N).toLowerCase()),0<fa)return fa+1;return-1};uk.Object.defineProperties(oa.prototype,{dkc:{configurable:!0,enumerable:!0,get:function(){return 0<this.uNb&&this.uNb===this.Cs.length}},isListVisible:{configurable:!0,enumerable:!0,get:function(){return Object(pk.a)(oa.prototype,this,"isListVisible")},set:function(f){Object(pk.b)(oa.prototype,this,"isListVisible",f);f||(this.qxc=0,this.ve=null);0===this.qxc?$a.DOMElementExtensions.setVisible(this.jwb,f&&!this.Ln):$a.DOMElementExtensions.setVisible(this.jwb,
!1)}},al:{configurable:!0,enumerable:!0,get:function(){return this.vsa},set:function(f){this.vCa(this.al);if(f){this.IZe.innerText="";this.vsa=f;var D=this.vCa(this.al),N=f.rowIndex+1,fa=$get("description_cell"+N,f);this.jwb.innerText=fa.innerText;var Ia=$get("item_type_cell",f);this.ve=D=D.innerText;this.qxc="field"===Ia.innerText?1:"definedName"===Ia.innerText?2:"letVariable"===Ia.innerText?3:"tableColHeaderName"===Ia.innerText?4:"tableSpecialStructRef"===Ia.innerText?5:"pendingData"===Ia.innerText?
6:"tableNamedObject"===Ia.innerText?7:0;this.raiseEvent("FLBSelectedRowChanged",new Tk.a(this.Cs.length,N,D,fa.innerText));this.$wc(f)}}},GUa:{configurable:!0,enumerable:!0,get:function(){return this.jwb}},vHa:{configurable:!0,enumerable:!0,get:function(){return this.formulaAssistanceControl}},mx:{configurable:!0,enumerable:!0,get:function(){return this.qxc}}});Object(Jb.a)(oa,"FormulaAutoCompleteListBox",Ij.a,[884]);uk.Object.defineProperties($b.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return this._name}},
toolTip:{configurable:!0,enumerable:!0,get:function(){return this.q$}}});Object(Jb.a)($b,"LETVariableInfo",null,[]);uk.Object.defineProperties(Gb.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return this._name}}});Object(Jb.a)(Gb,"TableColHeaderNameInfo",null,[]);uk.Object.defineProperties(xa.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return this._name}}});Object(Jb.a)(xa,"TableNamedObjectInfo",null,[]);uk.Object.defineProperties(bb.prototype,{name:{configurable:!0,
enumerable:!0,get:function(){return this._name}},toolTip:{configurable:!0,enumerable:!0,get:function(){return this.q$}}});Object(Jb.a)(bb,"TableSpecialStructRefInfo",null,[]);var tj=b(187),uj=b(185);Object(Jb.a)(Ua,"FormulaAutoCompleteCallbacks",null,[]);Object(Jb.a)(ab,"FormulaAutoCompleteRenderingInfo",null,[]);Object(Jb.a)(Fa,"CellMessage",null,[]);Object(Jb.a)(Aa,"FunctionSuggestionRequest",null,[]);Object(Jb.a)(qa,"RunExperimentRequest",null,[]);var Sj=Ti.a;Am(ha,Sj);ha.prototype.gre=function(f){this.addHandler(ha.efd,
f)};ha.prototype.sUf=function(f){this.removeHandler(ha.efd,f)};ha.prototype.ere=function(f){this.addHandler(ha.yed,f)};ha.prototype.qUf=function(f){this.removeHandler(ha.yed,f)};ha.prototype.fre=function(f){this.addHandler("FormulaAutoCompleteShown",f)};ha.prototype.rUf=function(f){this.removeHandler("FormulaAutoCompleteShown",f)};ha.prototype.set_visible=function(f){this.dka.set_visible(f);this.Ln&&!f&&this.R2a();Sys.UI.Control.prototype.set_visible.call(this,f);return f};ha.prototype.EYg=function(f,
D){this.isListVisible&&(f+=db.openParen,D++,this.nGd(f,D));var N=0<D&&f.charAt(D-1)===db.openParen,fa=D===f.length||f.charAt(D)===db.closeParen;if(!N||!fa)return ld.ULS.sendTraceTag(537162053,0,50,"FormulaAssistanceControl.CanInsertFormulaArguments Caret position: {0} is invalid. Is cell empty: {1}. Function exists in cell: {2}",D,!f.length,!!this.iR),!1;N=f.substring(0,D).lastIndexOf(this.$.listSeparator);fa=f.substring(0,D-1).lastIndexOf(db.openParen);f=f.substring(-1===N&&-1===fa?1:Math.max(N,
fa)+1,D-1).trim();return this.functionInfoManager.Qhd(f)?!0:(ld.ULS.sendTraceTag(537162052,0,50,"FormulaAssistanceControl.CanInsertFormulaArguments No valid function name before caret. Function exists in cell: {0}",!!this.iR),!1)};ha.prototype.whi=function(f,D){var N=this.EYg(f,D);if(!N||!this.iR)return ld.ULS.shipAssertTag(537162051,0,!N||N&&!!this.iR,"FormulaAssistanceControl.InsertFormulaArgumentsFromCaretPosition currentFunctionInfo is null"),{returnValue:null,Kvf:0,WXe:0};N=this.iR.Params;N=
N.replace(RegExp("[\\[\\]]","g"),"");var fa=f.charAt(D-1)===db.openParen,Ia=fa?"":"(",pb=D===f.length?")":"";var Wb=this.$.listSeparator;Wb=N.includes(Wb)?N.indexOf(Wb):N.length;return{returnValue:f.substring(0,D)+Ia+N+pb+f.substring(D,f.length),Kvf:fa?D:D+1,WXe:Wb}};ha.prototype.Gt=function(f,D){this.Ln&&void 0!==this.gr&&null!==this.gr&&this.gr();this.Ln||Sj.prototype.Gt.call(this,f,D)};ha.prototype.dispose=function(){if(this.$){this.gUa(!1);var f=We.g(this.$);f&&(f.ga&&(this.Ln?f.ga.xG(this.ld):
f.ga.P7(this.ld),cg.a.xW()&&4!==this.gEb&&f.ga.TAa(this.Qxf)),f.view.fr(this.spc));this.Ln&&this.$.xa&&this.$.xa.Ag(this.li)}this.functionInfoManager&&(this.functionInfoManager.oJb(this.onFunctionInfoLoaded),this.functionInfoManager.Hgj(this.UBf));this.xh&&this.xh.Uuc(this.Eza);this.Ln&&this.Pf&&this.Pf.RUf(this.JGf);cg.a.Ehc&&this.Za&&this.Za.iJb(this.Z6);this.Dag(!1);Ag.a.Fa(this.Pf);Ag.a.Fa(this.J1b);Ag.a.Fa(this.dka);this.zla&&Ag.a.Fa(this.Hr);this.Za=this.functionInfoManager=this.xh=null;Ag.a.tc(this.LKa);
this.Ig=this.i9=this.dka=this.LKa=null;Sj.prototype.dispose.call(this)};ha.prototype.$xa=function(){return!this.Mx};ha.prototype.toi=function(){return!this.wHa};ha.prototype.Yh=function(f,D){if(!this.$xa()){if(this.Ln&&this.cL){if(125627505===D||267796030===D)return this.dca&&this.BDc(D),this.DEe(),!1;if(1872288872===D)return this.Vna(),this.isListVisible=!1,!0;if(this.Pf.dkc&&(-798660877===D||137938150===D))return!1}if(1!==this.Pf.mx||125627505!==D&&267796030!==D)if(6===this.Pf.mx){var N=f.keyCode;
13!==N&&9!==N||this.oz(!1)}else{if(4===this.Pf.mx||5===this.Pf.mx)return Sj.prototype.Yh.call(this,f,D,!0);1===this.Pf.tX.length&&(N=f.keyCode,this.rAe=8===N||127===N||46===N?!0:!1)}else{if(this.oz(!1)&&!this.kla)return We.g(this.$).ga.Yh(f,D);if(125627505===D&&this.kla)return!0}}return Sj.prototype.Yh.call(this,f,D)};ha.prototype.Vvc=function(){this.xh.$cb();this.i9=null;null==this.Qja||this.Qja||this.amc("NoFieldChosen",1,2,1);this.Qja=null;this.D4=0;this.q6=this.Wud=this.Jrc=null};ha.prototype.aqb=
function(){var f=this,D=!!this.Za&&!Tc.f(this.$.oa);if((this.WBa||this.BAc)&&D){var N=this.Za.text;this.pluginScheduler.requester().functionSuggestion(Object.assign(new Aa,{content:N})).then(function(fa){0===fa.kind&&(ld.ULS.shipAssertTag(537162050,0,!!fa&&!!fa.payload.items,"FormulaAssistanceControl.AssistFormula - x10Scheduler returned `null` suggestion"),fa=d.toArray(d.select(d.asEnumerable(fa.payload.items),function(Ia){return ha.U6g(Ia)})),f.BAc&&"="===N&&0<fa.length&&f.gridView.f3a.ywj("="+
fa[0].textEdit.newText),f.WBa&&(f.PTa=fa,Gg.AFrameworkApplication.Pg||f.awe(D,!0)));return null})}this.WBa&&D||this.awe(D,!1)};ha.prototype.s7e=function(){if(ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")){var f=We.g(this.$).yj?this.cwb.jR:this.vrb.jR;"@"===this.Za.text.charAt(f+1)&&this.Za.textBox.caretPosition>f+1?this.Afb=f+2:this.Afb=f+1}else{f=this.Za.text.lastIndexOf(db.tof);var D=this.Za.text.lastIndexOf("[");this.Afb=f+1>=D?f+2:D+1}return this.Za.text.substring(this.Afb,
this.Za.textBox.caretPosition)};ha.prototype.bwe=function(){this.F8f()&&(this.Idh(),this.Mx&&(this.Qja=!1,this.JW=this.s7e(),this.Pf.xKa(this.Mx,this.JW,!0,void 0,void 0,!0),this.show(),ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5516893_fixInTableHeaderModeAccordingToCaretPoisiton")&&this.dka.Utb()))};ha.prototype.$ve=function(){this.F8f()&&(this.J1b&&this.J1b.cancel(),this.xh.FAb?(this.$xa()&&this.WGe(!0),this.get_visible()?this.VWe():this.o5d=tj.AsyncMethodContext.av(this.VWe,db.chh,Ai.a.RJh,
this.J1b)):this.t_())};ha.prototype.F8f=function(){return this.Za?0<this.$.yb.JS||!this.Za.text||!this.Za.isEditing?(this.set_visible(!1),!1):Tc.f(this.$.oa)?!1:!0:!1};ha.prototype.jsb=function(f){this.Za&&this.isListVisible&&(this.Bpd(this.Za.text,f),this.Za.textBox.caretPosition=f.range.start.character+f.newText.length,this.set_visible(!1))};ha.prototype.oz=function(){var f;if(!this.Za||!this.isListVisible)return!1;var D="",N=0,fa=We.g(this.$),Ia=this.Za.text,pb=0,Wb=this.Pf.ve,Nc=!1;if(0===this.Pf.mx||
2===this.Pf.mx||3===this.Pf.mx||7===this.Pf.mx)D+=Ia.substr(0,this.A4a)+this.Pf.ve,0!==this.Pf.mx||this.Pf.ve.endsWith(")")||(D+="("),N=D.toString().length,D+=Ia.substr(this.Fbc),2===this.Pf.mx&&(pb=4,Wb="DefinedName",Nc=!0,this.set_visible(!1));else if(1===this.Pf.mx)if(this.Qja=!0,this.kla){D+=Ia.substr(0,this.D4+2);!D.toString().endsWith(oc.a.BV)&&ye.EwaSettings.ma(136)&&(D+=oc.a.BV);pb=this.Pf.ve;pb=pb.replace("'","''");pb=pb.replace("[","'[");pb=pb.replace("]","']");if(this.S8c||this.mFh(pb))pb=
oc.a.Nwi+pb+oc.a.Snj,Nc=!0;D+=pb;N=D.length;pb=3;uj.a("PulloutFieldAccepted")}else return this.Za.text=this.Pf.ve,this.set_visible(!1),fa.kr(!1),fa.focus(),this.amc("FieldName",1,1,1),uj.a("TableHeaderAutoCompleteSuggestionAccepted"),!0;else if(5===this.Pf.mx)ld.ULS.sendTraceTag(537162048,0,50,"FormulaAssistanceControl.Autocomplete: User selected TableSpecialStructRef listbox item"),D+=Ia.substr(0,this.Afb),Ba.a.equals(this.Pf.ve,"@ - "+this.instantaneousSupportInformationManager.He.ThisRowStructRefString,
!1)?D+="@":(D+=this.Pf.ve,Nc=!0,this.set_visible(!1)),N=D.length;else if(4===this.Pf.mx){ld.ULS.sendTraceTag(575776009,0,50,"FormulaAssistanceControl.Autocomplete: User selected TableColHeaderName listbox item}");D+=Ia.substr(0,this.Afb);Nc="";N=!1;for(var kd=[39,91,93,64,35],Xc=0;Xc<this.Pf.ve.length;Xc++){var Ie=this.Pf.ve.charCodeAt(Xc);Array.contains(kd,Ie)&&(Nc+="'");Nc+=this.Pf.ve.charAt(Xc).toString();N||Ba.a.isNumeral(Ie)||Ba.a.Kif(Ie)||(N=!0)}kd=We.g(this.$).yj?this.cwb.jR:this.vrb.jR;Ia=
ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")?"@"===Ia.charAt(kd+1)&&N:Ia.lastIndexOf(db.tof)+1>=Ia.lastIndexOf("[")&&N;D+=Ia?"["+Nc+"]":Nc;Nc=!0;this.set_visible(!1);N=D.toString().length}else if(6===this.Pf.mx)D+=Ia.substr(0,this.fub);else return ld.ULS.sendTraceTag(537162019,0,10,"Autocomplete item type was not set on AutoComplete ListBox"),!1;this.Za.text=D;this.Za.textBox.caretPosition=N;this.Za.sya()&&(null===(f=fa.vs)||void 0===f?0:f.Yva)&&
fa.vs.iLb(this.Za.text,this.Za.textBox.caretPosition,this.Za.textBox.caretPosition,this.Za.textBox.Iv.length);fa.yj&&(f=fa.zc,f.text=this.Za.text,f.setCaretPosition(this.Za.textBox.caretPosition));Wb=(null==this.Qja?0:this.Qja)?"FieldName":Wb;this.Pf.al.sectionRowIndex>=this.Pf.tX.length?this.amc(Wb,4,pb,0):this.amc(Wb,1,pb,0);Nc||(5===this.Pf.mx||4===this.Pf.mx?this.bwe():this.aqb());return!0};ha.prototype.t_=function(f,D){f=void 0===f?null:f;D=void 0===D?null:D;f?(this.xh.$cb(),this.xh.t_(f,!1,
!1,D)):(f=We.g(this.$),f.ga.va.Wg&&(f=af.v(f.ga.va.xd,this.$),this.xh.t_(f,!0,!0,D)))};ha.prototype.Vna=function(){this.Cga=!1;this.Za.kMe()};ha.prototype.zVh=function(f){f=this.calcManager.getWorksheetFuncId(f);return this.MZe?this.MZe.descriptionsMap.get(f):null};ha.prototype.WGe=function(f){if(this.toi()){if(this.xh.FAb&&this.xh.Rk&&(!this.xh.Rk.length||!this.xh.Rk[0].FieldInfoDataList))return;this.EVj(f)}f=d.asEnumerable(this.wHa);f=d.concat(f,this.zXh(this.Za.text));ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5501880_NamedObjectAutoCompleteDropdown")&&
this.Ln&&(f=d.concat(f,this.JYh()));d.OBc(f,function(D){return D.name},new ef);this.WBa&&(f=d.concat(d.asEnumerable(this.PTa),f),ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5592322_fixSmartAutoCompleteItemsBugs")&&(0<this.PTa.length&&(this.XBa=!0),this.PTa=[]));this.i9=d.toArray(f)};ha.prototype.Idh=function(){var f=this.Za.text;if(ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5402572_CrossSheetTableReferencing")){var D=We.g(this.$).yj?this.cwb.$Ia:this.vrb.$Ia,N=!0;if(ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5962126_tableColHeadersListJSCrashFix")){if(""!==
D&&(this.Ig=Object(k.a)(Vj.a,this.$.Ab.getItemByName(D))),this.Ig||(this.Ig=this.tableManager.Ig,N=!1),!this.Ig){ld.ULS.sendTraceTag(527234895,0,50,"FormulaAssistanceControl.createTableColHeaderAutoCompleteList - current table object is null. Total number of named objects in workbook: %d. Is target table name empty? %d",this.$.Ab.count,""===D);return}}else this.Ig=Object(k.a)(Vj.a,this.$.Ab.getItemByName(D)),this.Ig||(this.Ig=this.tableManager.Ig,N=!1);this.Ig.wP&&this.Ig.wP.IsFullTableHeaders?this.JLf(N):
wi.d(this.Ig)?(ld.ULS.sendTraceTag(537162017,0,50,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList - Getting column headers for table with xluid - %s",this.Ig.pj),Se.I(this.$.na.ta,this.Ig.pj,this.ORi,this.NRi,null,null)):ld.ULS.sendTraceTag(537162018,0,15,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList - Table with xluid %s has header rows turned off.",this.Ig.pj)}else if(this.calcManager&&this.tableManager.Ig)if(D=this.calcManager.M5a(this.tableManager.Ig))if(this.calcManager.VMg(this.tableManager.Ig,
D)){f=d.empty();if(91===this.Za.text.charCodeAt(this.Za.text.length-1)){var fa=this.f2a("@ - "+this.instantaneousSupportInformationManager.He.ThisRowStructRefString);f=d.concat(f,(N=new Ab.a,N.add(fa),N))}f=d.concat(f,d.select(d.asEnumerable(D.toArray()),function(Ia){var pb=new Hc,Wb=new Gb;Wb._name=Ia.toString();pb.q4f(Wb);return pb}));this.i9=d.toArray(f)}else f.endsWith("[")&&"["!==f.charAt(f.length-2)&&ld.ULS.sendTraceTag(572381130,0,50,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList: calcManager.GetTableHeaders returns partial table header data with {0} columns for a table with id {1} of size {2}",
D.count,this.tableManager.Ig.pj,this.tableManager.Ig.usedRange.right-this.tableManager.Ig.usedRange.left+1);else f.endsWith("[")&&"["!==f.charAt(f.length-2)&&ld.ULS.sendTraceTag(573149408,0,50,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList: calcManager.GetTableHeaders returns null inside a table during table column header autocomplete list creation")};ha.prototype.mFh=function(f){if(!f)return!1;var D=f.charCodeAt(0);if(46===D||48<=D&&57>=D||63===D)return!0;for(var N=0;N<f.length;N++,
D=f.charCodeAt(N))if(!((ye.EwaSettings.isChangeGateEnabled("OfficeVSO:4831363_UseUpdatedisLetterCharacterCodeRangesInStringExtensions")?Ba.a.isLetter(D):Ba.a.ksd(D))||92===D||95===D||63===D||48<=D&&57>=D))return!0;return!1};ha.prototype.nGd=function(f,D){var N=!1,fa=!1,Ia=!1,pb=0,Wb=0;this.A4a=0;this.Fbc=D;this.b7b=1;for(var Nc=D-1;0<=Nc;--Nc)switch(f.charCodeAt(Nc)){case 39:fa=!fa;break;case 34:N=!N;break;case 91:++pb;Ia=pb>Wb;break;case 93:++Wb}Ia=Object.assign(new Ja,{Yta:!N,Zta:!fa,Pia:!Ia,aHb:1});
pb=this.r1i(f,D,Ia);D=this.s1i(f,D,Ia.Yta,Ia.Zta,Ia.Pia);this.b7b=pb+D;if(this.aTc=pb-1)this.wzc=!1;this.aGh(f,N,fa,Ia.QFd,Ia.RFd)};ha.prototype.lpd=function(){4!==this.gEb&&We.g(this.$).ga.Wsa(this.Qxf);this.KEb();cg.a.Ehc&&We.g(this.$).Uj.b_a(this.Z6);ha.uPd(this.pluginScheduler);this.WBa&&this.b0g()};ha.prototype.xEh=function(){return this.WBa||this.eWe};ha.prototype.t1i=function(){var f=this.q6;if(!this.JCj||!f)return this.D4=0,this.wHa=this.i9=null,!1;f=f.endsWith(oc.a.BV);var D;if(D=ye.EwaSettings.ma(136)){D=
this.cTj(this.q6.substring(0,this.E4));var N=D.sheetRange;D=D.returnValue}return D&&(D=this.q6.substring(0,this.D4),f&&D!==this.Wud)?(this.Wud=D,this.D4=this.q6.length-(f?1:0),this.t_(N,this.q6),this.Qja=!1,ld.ULS.sendTraceTag(537162015,0,50,"Begin dot notation autocomplete"),!0):!1};ha.prototype.zXh=function(f){var D=new Ab.a;this.calcManager&&ye.EwaSettings.isChangeGateEnabled("OfficeVSO:4986015_LetAutocompleteTelemetry")&&ld.ULS.shipAssertTag(537162014,0,!!this.calcManager.lua(Si.Range.kd(1,1)),
"FormulaAssistanceControl.GetLetVariables() - ConvertToSheetGridCell() is null");if(this.calcManager&&this.eWe&&(f=this.calcManager.extractLetVariables(f,this.Za.textBox.caretPosition))){f=Cl(f);for(var N=f.next();!N.done;N=f.next()){var fa=N.value;N=new $b;N._name=fa;N.q$=oe.a.instance.fa(2153);fa=new Hc;fa.vwj(N);D.add(fa)}}return D};ha.prototype.JYh=function(){for(var f=new Ab.a,D=this.$.Ab.items,N=0,fa=D.length;N<fa;N++){var Ia=D[N];if(Tc.o(Ia)){var pb=new xa;pb._name=Ia.name;Ia=new Hc;Ia.Myj(pb);
f.add(Ia)}}return f};ha.prototype.f2a=function(f){var D=new Hc,N=new bb;N._name=f;D.Nyj(N);return D};ha.prototype.JLf=function(f){var D=new Ab.a,N=this.Za.text.charCodeAt(this.Za.text.length-1),fa=this.Za.textBox.caretPosition-1;if(ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")?91===this.Za.text.charCodeAt(fa):91===N){var Ia=this.f2a("@ - "+this.instantaneousSupportInformationManager.He.ThisRowStructRefString);D.add(Ia)}Ia=Cl(this.Ig.wP.HeadersList);
for(var pb=Ia.next();!pb.done;pb=Ia.next()){pb=pb.value;var Wb=new Hc,Nc=new Gb;Nc._name=pb.Name;Wb.q4f(Nc);D.add(Wb)}Ia=We.g(this.$).yj?this.cwb.jR:this.vrb.jR;pb=this.Za.text.charCodeAt(Ia+1);(ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")?!f||fa!==Ia&&35!==pb:!f||91!==N&&35!==N)||(f=this.f2a("#"+this.instantaneousSupportInformationManager.He.AllStructRefString),D.add(f),f=this.f2a("#"+this.instantaneousSupportInformationManager.He.DataStructRefString),
D.add(f),f=this.f2a("#"+this.instantaneousSupportInformationManager.He.HeadersStructRefString),D.add(f),f=this.f2a("#"+this.instantaneousSupportInformationManager.He.TotalsStructRefString),D.add(f));D&&(this.i9=D.toArray())};ha.prototype.EVj=function(f){var D=d.empty();!f&&this.functionInfoManager.Y5&&(D=d.concat(D,d.select(d.asEnumerable(this.functionInfoManager.sfd),function(N){var fa=new Hc;fa.Q2f(N);return fa})),f=this.M7b.NKe,0<f.length&&(D=d.OBc(d.concat(D,d.select(d.asEnumerable(f),function(N){var fa=
new Hc;fa.Xuj(N);return fa})),function(N){return N.name},new ef)));if(this.xh.FAb&&this.xh.Rk){if(!this.xh.Rk.length||!this.xh.Rk[0].FieldInfoDataList)return;D=d.OBc(d.concat(D,d.select(d.asEnumerable(this.xh.Rk[0].FieldInfoDataList),function(N){var fa=new Hc;fa.wvj(N);return fa})),function(N){return N.name},new ef);this.columnName=this.xh.Rk[0].ColumnName}this.wHa=d.toArray(D)};ha.prototype.KEb=function(){if(1!==this.gEb){var f=We.g(this.$).ga.va.activeCell;if(f){this.formulaAssistanceTelemetryManager.kJ(["convertToSheetGridCell"]);
var D=this.calcManager.lua(f);this.formulaAssistanceTelemetryManager.uF(["convertToSheetGridCell"]);if(D){var N=this.$.xa,fa=D.sheet.index;0>=N.count||0>fa||fa>=N.count||(fa=N=null,this.vBd&&void 0!==this.calcManager&&null!==this.calcManager&&(this.formulaAssistanceTelemetryManager.kJ(["getActiveSheetCellFromRange"]),f=We.g(this.$).Da.Es(f),this.formulaAssistanceTelemetryManager.uF(["getActiveSheetCellFromRange"]),f&&(f=this.calcManager.Tid(f.Qm),void 0!==f&&null!==f&&(N=f.FormatString,fa=f.Builtin))),
2!==this.gEb&&(this.formulaAssistanceTelemetryManager.kJ(["setActiveCell"]),this.pluginScheduler.notifier().setActiveCell(Object.assign(new Fa,{colIndex:D.range.col,rowIndex:D.range.row,sheetIndex:this.$.xa.getItem(D.sheet.index).sheetId,docName:D.sheet.document.name,docPath:D.sheet.document.path,formatString:N,builtIn:fa})),this.formulaAssistanceTelemetryManager.uF(["setActiveCell"])))}}}};ha.prototype.b0g=function(){We.g(this.$).yj?this.cwb.fV(!1):this.vrb.fV(!1)};ha.prototype.imf=function(f){var D=
ye.EwaSettings.isChangeGateEnabled("OfficeVSO:4831363_UseUpdatedisLetterCharacterCodeRangesInStringExtensions")?Ba.a.isLetter(f):Ba.a.ksd(f);return 48<=f&&57>=f||46===f||95===f||D};ha.prototype.show=function(){if(this.Mx){var f=this.Pf.Zhg(0);this.Ln?0<this.Pf.Cs.length?f||this.s8f():this.R2a():((f=0<this.Pf.Cs.length)&&this.formulaAssistanceTelemetryManager.kJ(["autoCompleteRender"]),!this.isListVisible&&this.columnName&&f&&this.Pf.j9i(this.Pf.Cs.length,this.columnName),this.isListVisible=f,this.dka.show(this.iR),
this.JCa(!0),this.Pf.jza(),f&&this.formulaAssistanceTelemetryManager.uF(["autoCompleteRender"]))}};ha.prototype.s1i=function(f,D,N,fa,Ia){for(N=Object.assign(new Ja,{pJf:41,yDe:40,Yta:N,Zta:fa,Pia:Ia});D<f.length&&!this.lKf(f,D,N);++D);return N.aHb};ha.prototype.r1i=function(f,D,N){for(--D;0<=D&&!this.lKf(f,D,N);--D);return N.aHb};ha.prototype.lKf=function(f,D,N){var fa=f.charCodeAt(D);0>=this.E4&&(this.E4=f.substring(0,D).lastIndexOf(oc.a.BV));46===fa&&(D<this.E4?this.E4=D:D>this.fub&&(this.D4=this.fub=
D));if(!this.imf(fa)&&!ha.Lti(fa)&&(!this.kla||D<=this.E4||!ha.Cci(fa,N))){N.iAf&&(N.iAf=!1,this.A4a=D+1);if(N.qEd){N.RFd=D+1;if(this.functionInfoManager.Qhd(f.substring(N.RFd,N.QFd)))return!0;N.qEd=!1}switch(fa){case 39:N.Zta=!N.Zta;break;case 34:N.Yta=!N.Yta;break;case 91:N.Pia=!1;break;case 93:N.Pia=!0}fa===this.$.listSeparator.toString().charCodeAt(0)&&N.Zta&&N.Yta&&!N.q1a&&(!this.kla||N.Pia)&&(D<N.iQd||-1===N.iQd)&&(N.aHb+=1,this.b7b++);fa===N.yDe&&N.Yta&&N.Zta&&(!this.kla||N.Pia)?N.q1a+=1:fa===
N.pJf&&N.Yta&&N.Zta&&(!this.kla||N.Pia)?0<N.q1a?--N.q1a:(N.iQd=N.VXe,N.VXe=D,0<D&&this.imf(f.charCodeAt(D-1))&&(N.qEd=!0,N.QFd=D)):this.kla&&46===fa&&D>this.E4&&(D<this.E4?this.E4=D:D>this.fub&&(this.D4=this.fub=D))}return!1};ha.prototype.aGh=function(f,D,N,fa,Ia){this.Fbc>this.A4a&&0<=this.A4a?D||N||(this.JW=f.substring(this.A4a,this.Fbc)):this.JW=null;fa!==Ia?(f=f.substring(Ia,fa),this.iR&&Ba.a.equals(this.iR.NameDataStrings,f,!0)||(this.wzc=!0),this.iR=this.functionInfoManager.Qhd(f)):(this.wzc=
!1,this.iR=null)};ha.prototype.Dag=function(f){var D=$get(db.fKf+"_"+db.$Gb,this.domElement),N=$get(db.gKf+"_"+db.$Gb,this.domElement);f&&!this.Jfc?(D&&vi.a.instance.qa(hg.a.click,D,this.ida),N&&vi.a.instance.qa(hg.a.click,N,this.ida),this.Jfc=!0):this.Jfc&&(D&&vi.a.instance.za(hg.a.click,D,this.ida),N&&vi.a.instance.za(hg.a.click,N,this.ida),this.Jfc=!1)};ha.prototype.cTj=function(f){var D=this;var N=null;var fa;if(function(){var Nc=af.Z(f,D.$.ea.xa);pb=Nc.sheetName;fa=Nc.range;return Nc}().returnValue&&
fa){if(!pb){var Ia=Object(k.a)(sd.a,this.$.oa);if(!Ia)return{returnValue:!1,sheetRange:N};var pb=Ia.name}N=af.v(fa,this.$);N.SheetName=pb;this.S8c=!1;return{returnValue:!0,sheetRange:N}}var Wb=null;return function(){var Nc=D.M7b.MSj(f);pb=Nc.sheetName;Wb=Nc.range;return Nc}().returnValue?(N=af.v(Wb,this.$),N.SheetName=pb,this.S8c=!0,{returnValue:!0,sheetRange:N}):{returnValue:!1,sheetRange:N}};ha.prototype.sPd=function(f){this.pluginScheduler.requester().runAuthoringExperiment({content:f})};ha.prototype.Egc=
function(){if(1===this.Pf.tX.length&&this.Mx.length){var f=this.Mx[this.Pf.tX[0]];if(1===f.itemType){var D=f.name;f=this.Za.text;D=D.substring(f.length,D.length);D.length&&(this.Za.text=f+D,this.Za.textBox.selectRange(f.length,this.Za.text.length))}}else ld.ULS.shipAssertTag(537162007,0,!1,"InCellAutoComplete should only be called when there is 1 item (number of items: {0})",this.Pf.tX.length)};ha.prototype.amc=function(f,D,N,fa){var Ia={};Ia.a=f;Ia.b=D;Ia.c=N;Ia.d=fa;$f.b().Te(38,Ia,!0)};ha.prototype.awe=
function(f,D){if(!this.functionInfoManager.Y5){if(f)if(this.nGd(this.Za.text,this.Za.textBox.caretPosition),this.WBa||this.JW){var N={};N.Filter=this.JW?this.JW.charAt(0).toString():"";N.FilterType=1;N.IncludeOneOfEachGroupUI=!1;this.functionInfoManager.Lub(N)}else ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AutocompleteTableColumnHeaders",!1)&&this.get_visible()&&this.set_visible(!1);if(!D)return}0<this.$.yb.JS||this.Za&&!this.Za.isEditing?this.set_visible(!1):f&&(this.nGd(this.Za.text,
this.Za.textBox.caretPosition),this.dka.update(this.iR,this.b7b,this.aTc,this.wzc),this.q6=this.Za.text.substring(1,this.Za.textBox.caretPosition),this.E4=this.q6.indexOf(oc.a.BV),this.D4=this.q6.lastIndexOf(oc.a.BV),this.t1i()?(f=new Hc,f.jxj(),this.wHa=this.i9=f=[f],this.Pf.CXj(f),this.show()):((this.xEh()||this.$xa())&&this.WGe(!1),0<this.D4?this.Pf.xKa(this.Mx,this.q6,!1,void 0,this.q6.lastIndexOf(oc.a.BV),!1):this.Pf.xKa(this.Mx,this.JW,!1,void 0,this.D4,!1),this.show(),this.Ln&&(this.Pf.Cs.length||
We.g(this.$).Uj.ML?this.dka.Utb():(this.dka.MNd(),this.Ln&&this.R2a()))))};ha.prototype.s8f=function(){var f=this;if(0<this.Pf.Cs.length){this.formulaAssistanceTelemetryManager.kJ(["autoCompleteRender"]);if(this.formulaAssistanceUIControl){var D={};D.zoomLevel=wa(this.$);this.formulaAssistanceUIControl.updateContext(D);this.gr=function(){f.formulaAssistanceUIControl.renderAutoCompleteMenu(f.Z1b,We.g(f.$).Uj.textBox.domElement,f.Nhd())};this.gr();this.DNa&&this.Pf.dkc&&this.raiseEvent(ha.efd,null);
!this.ANa||this.fqd||this.Pf.dkc||this.raiseEvent("FormulaAutoCompleteShown");this.zla&&(this.Hr.canReceiveFocus=!0);this.fqd=!0}this.formulaAssistanceTelemetryManager.uF(["autoCompleteRender"]);!ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5592322_fixSmartAutoCompleteItemsBugs")&&void 0!==this.PTa&&null!==this.PTa&&0<this.PTa.length&&(this.XBa=!0)}};ha.prototype.axd=function(){this.vJa&&(this.formulaAssistanceTelemetryManager.xZ.selectByArrowKeyCounter++,this.vJa=!1);this.wJa&&(this.formulaAssistanceTelemetryManager.xZ.selectByMouseHoverCounter++,
this.wJa=!1);this.uJa&&(this.formulaAssistanceTelemetryManager.xZ.commitByTabKeyCounter++,this.uJa=!1);this.sJa&&(this.formulaAssistanceTelemetryManager.xZ.commitByEnterKeyCounter++,this.sJa=!1);this.tJa&&(this.formulaAssistanceTelemetryManager.xZ.commitByMouseClickCounter++,this.tJa=!1)};ha.prototype.Nhd=function(){var f=new ab;f.completionItems=this.Pf.M4c;f.activeItemIndex=this.Pf.al?this.Pf.al.rowIndex:-1;this.lLd(f);return f};ha.prototype.lLd=function(f){f.callbacks=new Ua;f.callbacks.onCompletionItemSelected=
this.VCd;f.callbacks.onCompletionItemCommitted=this.UCd;f.callbacks.onFeedback=this.ISa;f.callbacks.onRestoreFocus=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:6178649_FixFormulaBarFocusBug")?this.onRestoreFocus:void 0;ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5818634_PassOnDismissCallbackToAutoCompleteMenu")&&(f.callbacks.onDismiss=this.Yqd?this.onDismiss:this.R2a)};ha.prototype.WHd=function(f){this.Cga=!0;var D=f.textEdit.newText;this.Za.ETa(D.substring(this.Za.text.length-f.textEdit.range.start.character,
D.length))};ha.prototype.DEe=function(){this.oz(!0);this.Cga=this.isListVisible=!1;this.QTa=!0};ha.prototype.Bpd=function(f,D){this.Za.text=f.substring(0,D.range.start.character)+D.newText+f.substring(D.range.end.character,f.length);We.g(this.$).yj&&(We.g(this.$).zc.text=this.Za.text)};ha.uPd=function(f){f.requester().runExperiment(new qa)};ha.U6g=function(f){var D=Hc.rdh(),N={IsCompatibility:!1};N.NameDataStrings=f.label;N.Help=f.detail;D.Q2f(N);D.textEdit=f.textEdit;return D};ha.XKa=function(){var f=
String.format(db.VKh,db.vfd,kk.a.GRe),D=String.format(db.QKh,db.tfd,ti.a.hbd,R.a.il,R.a.kp),N=String.format(db.NKh,db.ofd,ti.a.hbd,R.a.il,ti.a.ASe,R.a.kp);return String.format("{0}\r\n{1}\r\n{2}",f,D,N)};ha.Lti=function(f){return 36===f||58===f||33===f||39===f||32===f};ha.Cci=function(f,D){return 32===f||91===f||!D.Pia};uk.Object.defineProperties(ha.prototype,{au:{configurable:!0,enumerable:!0,get:function(){return this.Pf}},Mx:{configurable:!0,enumerable:!0,get:function(){return this.i9}},$Kb:{configurable:!0,
enumerable:!0,get:function(){return this.Pf.ve}},EZe:{configurable:!0,enumerable:!0,get:function(){return this.Pf}},hZe:{configurable:!0,enumerable:!0,get:function(){return this.dka}},Pf:{configurable:!0,enumerable:!0,get:function(){return this.Vsg}},k2a:{configurable:!0,enumerable:!0,get:function(){return this.WBa?this.Za?this.Za.text:null:this.JW}},isListVisible:{configurable:!0,enumerable:!0,get:function(){return this.au.isListVisible},set:function(f){this.Ln&&!f&&this.R2a();this.au.isListVisible=
f}},tableManager:{configurable:!0,enumerable:!0,get:function(){return this.eBg}},kla:{configurable:!0,enumerable:!0,get:function(){return 0<this.D4}},cL:{configurable:!0,enumerable:!0,get:function(){return this.Cga}},J1b:{configurable:!0,enumerable:!0,get:function(){return this.o5d}},D4:{configurable:!0,enumerable:!0,get:function(){return this.dNe},set:function(f){this.dNe=f;f||(this.E4=0)}},JCj:{configurable:!0,enumerable:!0,get:function(){if(null==this.Jrc){var f=this.$.pc;this.Jrc=!!f&&!f.inEmbedView}return this.Jrc}},
g0f:{configurable:!0,enumerable:!0,get:function(){return this.Pf.M4c[this.Pf.al.rowIndex]}},MZe:{configurable:!0,enumerable:!0,get:function(){!this.wfd&&this.pluginScheduler&&(this.wfd=this.pluginScheduler.getFunctionsShortDescriptions());return this.wfd}}});ha.efd="FACardOpened";ha.yed="FAFocusOnSmartSuggestionsCard";ha.Mnd=null;Object(Jb.a)(ha,"FormulaAssistanceControl",Ti.a,[864,747,3,865,866]);var ok=Ug.a;Am(da,ok);da.prototype.ire=function(f){this.addHandler("FAFunctionNameUpdated",f)};da.prototype.tUf=
function(f){this.removeHandler("FAFunctionNameUpdated",f)};da.prototype.Yre=function(f){this.addHandler("FAParameterSelectionChangedOld",f)};da.prototype.QUf=function(f){this.removeHandler("FAParameterSelectionChangedOld",f)};da.prototype.Xre=function(f){this.addHandler("FAParameterSelectionChanged",f)};da.prototype.PUf=function(f){this.removeHandler("FAParameterSelectionChanged",f)};da.prototype.AIg=function(f){this.addHandler("DC",f)};da.prototype.pgj=function(f){this.removeHandler("DC",f)};da.prototype.dismiss=
function(){this.kw=!1;this.formulaAssistanceUIControl&&(this.gr=null,this.dS&&this.EH.detach(),this.formulaAssistanceUIControl.dismiss(this.domElement),this.jma=null,this.Hr.canReceiveFocus=!1)};da.prototype.show=function(f,D){var N=this;this.kw=!0;var fa=this.EHd(f);this.formulaAssistanceUIControl&&(this.formulaAssistanceTelemetryManager.kJ(["argumentAssistanceRender"]),f={},f.zoomLevel=wa(this.$),this.formulaAssistanceUIControl.updateContext(f),ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5470368_FormulaAssistanceScroll")?
(this.gr=function(){N.formulaAssistanceUIControl.renderArgumentAssistanceCard(N.domElement,D,fa)},this.gr()):this.formulaAssistanceUIControl.renderArgumentAssistanceCard(this.domElement,D,fa),this.JGd(fa),this.dS&&this.EH.ka(this.formulaAssistanceUIControl.getCalloutElement(0),this.formulaAssistanceUIControl.getDraggableElement(0),this.gr,function(){return N.formulaAssistanceUIControl.dismiss(N.domElement)}),this.Hr.canReceiveFocus=!0,this.formulaAssistanceTelemetryManager.uF(["argumentAssistanceRender"]),
this.formulaAssistanceTelemetryManager.I9b("argumentAssistanceOverall"))};da.prototype.dispose=function(){if(this.$){var f=We.g(this.$);f&&(f.ga&&f.ga.xG(this.ld),f.view.fr(this.Gt),this.dS&&f.Ac.Zn(this.Rg))}Ag.a.Fa(this.Hr);this.$=null};da.prototype.EHd=function(f){var D=new lb;D.functionRenderingInfo=f;D.cardMode=this.D3;this.nLd(D);return D};da.prototype.nLd=function(f){f.callbacks=new yb;f.callbacks.onHelpLink=this.Zhd(f.functionRenderingInfo);f.callbacks.onCardModeChange=this.onCardModeChange;
f.callbacks.onFeedback=this.ISa;this.cca&&(f.callbacks.onDismissClick=this.onDismissClick)};da.prototype.Zhd=function(f){var D=this;return function(){Ca(D.$,f.helpID,f.isUDF)}};da.prototype.XRd=function(){var f=gh.a.get(Bf.a.x1b);this.D3=f?parseInt(f,10):da.H8c;this.formulaAssistanceTelemetryManager.s1f(this.D3)};da.prototype.JGd=function(f){var D=f.functionRenderingInfo.functionName;this.jma&&Ba.a.equals(this.jma,D,!0)?(D=gg.a.map(f.functionRenderingInfo.signatures,function(N){var fa="";0<=N.signatureParams.activeParam&&
N.signatureParams.activeParam<N.signatureParams.params.length&&(fa=N.signatureParams.params[N.signatureParams.activeParam]);return fa}),this.raiseEvent("FAParameterSelectionChanged",new Va(D))):(this.jma=D,f=gg.a.map(f.functionRenderingInfo.signatures,function(N){return N.signatureParams.params.join(", ")}),this.raiseEvent("FAFunctionNameUpdated",new jb(D,f)))};da.prototype.wPb=function(f){this.D3=f;try{gh.a.Mv(Bf.a.x1b,f.toString(),$i.AFrame.jfa)}catch(D){ld.ULS.sendTraceTag(537162074,0,15,"Failed setting ArgumentAssistanceCardCollapseState cookie with error message: {0}",
D.message)}};da.XKa=function(){return document.createElement("div")};uk.Object.defineProperties(da.prototype,{visible:{configurable:!0,enumerable:!0,get:function(){return this.kw},set:function(f){f||this.dismiss();this.kw=f}}});da.H8c=0;Object(Jb.a)(da,"FormulaArgumentAssistanceControl",Ug.a,[891]);var K;(function(f){f[f.Dismissed=0]="Dismissed";f[f.Smart=1]="Smart";f[f.Simple=2]="Simple";f[f.Mixed=3]="Mixed"})(K||(K={}));Object(Jb.b)("UIState",K);var na=Ug.a;Am(ka,na);ka.prototype.gre=function(f){this.addHandler("FACardOpened",
f)};ka.prototype.sUf=function(f){this.removeHandler("FACardOpened",f)};ka.prototype.ere=function(f){this.addHandler("FAFocusOnSmartSuggestionsCard",f)};ka.prototype.qUf=function(f){this.removeHandler("FAFocusOnSmartSuggestionsCard",f)};ka.prototype.fre=function(f){this.addHandler("FormulaAutoCompleteShown",f)};ka.prototype.rUf=function(f){this.removeHandler("FormulaAutoCompleteShown",f)};ka.prototype.dispose=function(){if(this.$){var f=We.g(this.$);f&&(f.ga&&f.ga.xG(this.ld),f.Ac&&this.OAb&&f.Ac.Zn(this.Rg),
f.view.fr(this.Gt));this.$.xa&&this.$.xa.Ag(this.li)}this.zla&&Ag.a.Fa(this.Hr);this.$=null};ka.prototype.mIg=function(f){this.addHandler("CVIC",f)};ka.prototype.bgj=function(f){this.removeHandler("CVIC",f)};ka.prototype.Yh=function(f,D){if(!this.visible)return!1;this.dca&&this.BDc(D);var N;return(N=this.d9h(D)).nfc?N.result:this.lCj(D)};ka.prototype.iyb=function(f){if(!this.visible)return!1;var D=!1;switch(f){case 1872288872:this.cL&&this.Vna();this.visible=!1;D=!0;break;case -798660877:this.Ogb(this.Rxb(this.Y7+
1));D=!0;break;case 137938150:this.Ogb(this.Rxb(this.Y7-1));D=!0;break;case 2091832999:this.Ogb(this.Rxb(this.Y7+8));D=!0;break;case 742457698:this.Ogb(this.Rxb(this.Y7-8));D=!0;break;case 125627505:case 267796030:this.jsb(this.Mx.items[this.Y7]),D=!0}return D};ka.prototype.show=function(f){this.Za=We.g(this.$).Uj;this.kw=!0;this.Y7=0;this.Mx=f;0<this.Mx.items.length&&(this.render(),this.Ogb(this.Rxb(this.Y7)),1===this.Mx.items[0].type&&this.OAb&&(this.XBa=!0))};ka.prototype.Vna=function(){this.Cga=
!1;this.Za.kMe()};ka.prototype.lCj=function(f){return[1872288872,-798660877,137938150,2091832999,742457698,125627505,267796030].includes(f)};ka.prototype.d9h=function(f){return this.cL?125627505===f||267796030===f?(this.jsb(this.Mx.items[this.Y7]),{nfc:!0,result:!1}):!this.cJf||-798660877!==f&&137938150!==f?{nfc:!1}:{nfc:!0,result:!1}:{nfc:!1}};ka.prototype.render=function(){var f=this;this.formulaAssistanceTelemetryManager.kJ(["autoCompleteRender"]);if(this.formulaAssistanceUIControl){var D={};D.zoomLevel=
wa(this.$);this.formulaAssistanceUIControl.updateContext(D);this.gr=function(){f.formulaAssistanceUIControl.renderAutoCompleteMenu(f.domElement,f.Za.textBox.domElement,f.Nhd())};this.gr();this.ANa&&(D=this.lPb,this.lPb=this.L4h(this.Mx.items),D!==K.Dismissed&&D!==K.Smart||this.lPb!==K.Simple&&this.lPb!==K.Mixed||this.raiseEvent("FormulaAutoCompleteShown"));this.zla&&(this.Hr.canReceiveFocus=!0);this.formulaAssistanceTelemetryManager.uF(["autoCompleteRender"]);this.formulaAssistanceTelemetryManager.I9b("autoCompleteOverall")}};
ka.prototype.jsb=function(f){if(this.Za&&this.visible){var D=f.textEdit;this.Bpd(this.Za.text,D);this.Za.textBox.caretPosition=D.range.start.character+D.newText.length;this.cL&&(this.Cga=!1,this.OAb&&(this.QTa=!0),this.Za.endEdit(!0,"FormulaAutoCompleteControl.CommitAutoCompletion",0));this.visible=!1;this.raiseEvent("CVIC",{shouldRequestAutocompleteOnCommit:f.shouldRequestAutocompleteOnCommit})}};ka.prototype.IMg=function(){this.XBa&&(this.formulaAssistanceTelemetryManager.PKa.smartSuggestionShownCounter++,
this.XBa=!1);this.QTa&&(this.formulaAssistanceTelemetryManager.PKa.smartSuggestionSelectedCounter++,this.QTa=!1);this.vNb&&(this.formulaAssistanceTelemetryManager.PKa.smartSuggestionCommittedCounter++,this.vNb=!1)};ka.prototype.Nhd=function(){var f=new ab;f.completionItems=this.Mx.items;f.activeItemIndex=this.Y7;this.lLd(f);return f};ka.prototype.lLd=function(f){f.callbacks=new Ua;f.callbacks.onCompletionItemSelected=this.VCd;f.callbacks.onCompletionItemCommitted=this.UCd;f.callbacks.onFeedback=this.ISa;
f.callbacks.onRestoreFocus=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:6178649_FixFormulaBarFocusBug")?this.onRestoreFocus:void 0;ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5818634_PassOnDismissCallbackToAutoCompleteMenu")&&(f.callbacks.onDismiss=this.Yqd?this.KOi:this.dismiss)};ka.prototype.WHd=function(f){this.Cga=!0;var D=f.textEdit.newText;this.Za.ETa(D.substring(this.Za.text.length-f.textEdit.range.start.character,D.length))};ka.prototype.Ogb=function(f){var D=this.Y7;this.Y7=f;var N=this.Mx.items[f];
this.cL&&this.Vna();D!==f&&this.render();1===N.type&&ye.EwaSettings.Gb()&&!We.g(this.$).Uj.text.includes("\n")&&this.WHd(N)};ka.prototype.Rxb=function(f){return 0>f?0:Math.min(f,this.Mx.items.length-1)};ka.prototype.Bpd=function(f,D){this.Za.text=f.substring(0,D.range.start.character)+D.newText+f.substring(D.range.end.character,f.length);We.g(this.$).yj&&(We.g(this.$).zc.text=this.Za.text)};ka.prototype.axd=function(){this.vJa&&(this.formulaAssistanceTelemetryManager.xZ.selectByArrowKeyCounter++,
this.vJa=!1);this.wJa&&(this.formulaAssistanceTelemetryManager.xZ.selectByMouseHoverCounter++,this.wJa=!1);this.uJa&&(this.formulaAssistanceTelemetryManager.xZ.commitByTabKeyCounter++,this.uJa=!1);this.sJa&&(this.formulaAssistanceTelemetryManager.xZ.commitByEnterKeyCounter++,this.sJa=!1);this.tJa&&(this.formulaAssistanceTelemetryManager.xZ.commitByMouseClickCounter++,this.tJa=!1)};ka.prototype.BDc=function(f){switch(f){case -798660877:case 137938150:case 2091832999:case 742457698:this.vJa=!0;break;
case 125627505:this.uJa=!0;break;case 267796030:this.sJa=!0}};ka.XKa=function(){return document.createElement("div")};ka.prototype.L4h=function(f){return f.reduce(function(D,N){return D|=0===N.type?K.Simple:K.Smart},K.Dismissed)};uk.Object.defineProperties(ka.prototype,{visible:{configurable:!0,enumerable:!0,get:function(){return this.kw},set:function(f){f||this.dismiss();this.kw=f}},cL:{configurable:!0,enumerable:!0,get:function(){return this.Cga}},cJf:{configurable:!0,enumerable:!0,get:function(){return 1===
this.Mx.items.length&&1===this.Mx.items[0].type}}});Object(Jb.a)(ka,"FormulaAutoCompleteControl",Ug.a,[890,3,865]);ra.prototype.then=function(f,D){return this.promise.then(f,D)};ra.prototype.resolve=function(f){this.Tyg(f);return null!=f&&"function"===typeof f.then?this.promise.then():void 0};ra.prototype.reject=function(f){this.Cyg(f);return null!=f&&"function"===typeof f.then?this.promise.then():void 0};Object(Jb.a)(ra,"ResolvablePromise",null,[]);ba.prototype.getRichValueFieldListContext=function(f,
D,N,fa){this.vnf&&f!==this.vnf&&this.xh.$cb();this.vnf=f;this.xh.t_(f,N,fa,D);this.oac=new ra;this.xh.FAb?this.oac.resolve(this.xh.Rk):this.xcj();return this.oac.promise};ba.prototype.xcj=function(){this.xh.V_b(this.Eza);this.xh.ZIg(this.bCf)};ba.prototype.kfg=function(){this.xh.Uuc(this.Eza);this.xh.Jgj(this.bCf)};Object(Jb.a)(ba,"ServerDataProvider",null,[889]);ia.prototype.dispose=function(){if(this.$){var f=We.g(this.$);f&&(f.ga&&cg.a.xW()&&f.ga.TAa(this.Th),this.mjf&&f.Da&&f.Da.ar(this.Qg))}this.cca&&
(We.g(this.$).Ac.Zn(this.Rg),this.ira.pgj(this.pyf));this.sga.bgj(this.xyf);this.functionInfoManager&&this.functionInfoManager.oJb(this.onFunctionInfoLoaded);cg.a.Ehc&&this.Za&&this.Za.iJb(this.Z6);Ag.a.Fa(this.ira);Ag.a.Fa(this.sga);this.sga=this.ira=this.functionInfoManager=this.$=null};ia.prototype.nlj=function(){this.yOa=-1;this.zOa=null};ia.prototype.gMe=function(){this.sga.visible=!1;this.ira.visible=!1};ia.prototype.Yh=function(){this.iea();return!1};ia.prototype.iea=function(){if(!this.Za.ML){if(this.o7a&&
(this.formulaAssistanceTelemetryManager.rqb.formulaAssistanceRequestAttemptedCounter++,!this.bDj())){this.formulaAssistanceTelemetryManager.rqb.formulaAssistanceRequestOptimizedCounter++;return}this.functionInfoManager.Y5||(this.functionInfoManager.hpb(this.onFunctionInfoLoaded),this.functionInfoManager.Lub({}));var f=this.Za,D=f.text;f=f.textBox.caretPosition;!this.cca||this.tTa?(this.formulaAssistanceTelemetryManager.kJ(["argumentAssistanceComputation","autoCompleteComputation","argumentAssistanceOverall",
"autoCompleteOverall"]),this.w0f(D,f)):(this.formulaAssistanceTelemetryManager.kJ(["autoCompleteComputation","autoCompleteOverall"]),this.Wkj(D,f))}};ia.prototype.w0f=function(f,D){var N=this;f=this.pluginScheduler.batchRequester().functionSuggestionAndArgumentAssistance({functionSuggestion:{content:f,caretPosition:D},argumentAssistance:{content:f,caretPosition:D}});this.vda+=1;f.then(function(fa){--N.vda;0===fa.kind&&(N.v9e(fa.payload.argumentAssistance),N.$9e(fa.payload.functionSuggestion));return null})};
ia.prototype.Wkj=function(f,D){var N=this;f=this.pluginScheduler.requester().functionSuggestion(Object.assign(new Aa,{content:f,caretPosition:D}));this.vda+=1;f.then(function(fa){--N.vda;0===fa.kind&&N.$9e(fa.payload);return null})};ia.prototype.MNd=function(f,D){var N=this;f=this.pluginScheduler.requester().argumentAssistance({content:f,caretPosition:D});this.vda+=1;f.then(function(fa){--N.vda;0===fa.kind&&N.v9e(fa.payload)})};ia.prototype.bDj=function(){var f=this.Za,D=f.text;f=f.textBox.caretPosition;
if(this.sga.visible&&Ba.a.equals(D,this.zOa,!0)&&f===this.yOa)return!1;this.zOa=D;this.yOa=f;return!0};ia.prototype.uPd=function(){this.pluginScheduler.requester().runExperiment(new qa)};ia.prototype.v9e=function(f){f&&this.Za.isEditing?(this.formulaAssistanceTelemetryManager.uF(["argumentAssistanceComputation"]),this.ira.show(f,this.Za.textBox.domElement)):this.ira.dismiss()};ia.prototype.$9e=function(f){f&&0<f.items.length&&this.Za.isEditing?(this.formulaAssistanceTelemetryManager.uF(["autoCompleteComputation"]),
this.sga.show(f)):this.sga.dismiss()};ia.prototype.sPd=function(f){this.pluginScheduler.requester().runAuthoringExperiment({content:f})};ia.prototype.KEb=function(){var f=We.g(this.$).ga.va.activeCell;if(f){this.formulaAssistanceTelemetryManager.kJ(["convertToSheetGridCell"]);var D=this.calcManager.lua(f);this.formulaAssistanceTelemetryManager.uF(["convertToSheetGridCell"]);if(D){var N=this.$.xa,fa=D.sheet.index;0>=N.count||0>fa||fa>=N.count||(fa=N=null,this.vBd&&void 0!==this.calcManager&&null!==
this.calcManager&&(this.formulaAssistanceTelemetryManager.kJ(["getActiveSheetCellFromRange"]),f=We.g(this.$).Da.Es(f),this.formulaAssistanceTelemetryManager.uF(["getActiveSheetCellFromRange"]),f&&(f=this.calcManager.Tid(f.Qm),void 0!==f&&null!==f&&(N=f.FormatString,fa=f.Builtin))),this.formulaAssistanceTelemetryManager.kJ(["setActiveCell"]),this.pluginScheduler.notifier().setActiveCell(Object.assign(new Fa,{colIndex:D.range.col,rowIndex:D.range.row,sheetIndex:this.$.xa.getItem(D.sheet.index).sheetId,
docName:D.sheet.document.name,docPath:D.sheet.document.path,formatString:N,builtIn:fa})),this.formulaAssistanceTelemetryManager.uF(["setActiveCell"]))}else ld.ULS.sendTraceTag(537162002,0,50,"FormulaAssistanceManager.NotifyActiveCellChanged ISheetGridCell location is null")}};ia.prototype.zYj=function(){this.pluginScheduler.notifier().setFunctionsInfo(this.functionInfoManager.sfd)};ia.prototype.lpd=function(){We.g(this.$).ga.Wsa(this.Th);this.KEb();cg.a.Ehc&&this.Za.b_a(this.Z6);this.uPd();this.sga.mIg(this.xyf);
this.pluginScheduler.setServerDataProvider(new ba(this.xh,this.$));this.iea()};uk.Object.defineProperties(ia.prototype,{Xva:{configurable:!0,enumerable:!0,get:function(){return this.sga}},gZe:{configurable:!0,enumerable:!0,get:function(){return this.ira}},Za:{configurable:!0,enumerable:!0,get:function(){return We.g(this.$).Uj}}});Object(Jb.a)(ia,"FormulaAssistanceManager",null,[863,3]);var Xa=lh.a;Am(aa,Xa);aa.prototype.create=function(){var f=this,D=cg.a.xW(),N=ye.EwaSettings.ma(377),fa=ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.LETAutocomplete",
!1),Ia=cg.a.pD(this.$),pb=this.$.da,Wb=mf.GetServiceTaskFactory.create(pb,134,this.la,this.ub),Nc=mf.GetServiceTaskFactory.Ua(this.$.da,12,477,this.ub);var kd=cg.a.WN(this.$)?mf.GetServiceTaskFactory.create(this.$.da,449,this.$.la,1):rg.Task.Sa(null);var Xc=cg.a.xW()?mf.GetServiceTaskFactory.create(this.$.da,414,this.$.la,1):rg.Task.Sa(null);if(fa||D){var Ie=mf.GetServiceTaskFactory.Ua(pb,266,265,this.ub),Ze=mf.GetServiceTaskFactory.Ua(pb,219,220,this.ub),Sf=mf.GetServiceTaskFactory.Ua(pb,491,492,
this.ub);ud.TaskExtensions.Ba(ud.TaskExtensions.we([Ie,Xc,kd,Ze,Sf],this.la),function(){var Vg=pb.Aa(19)||new Ta(f.$,Xc.result),Hh=Ze.result;if(Ia){var ji=pb.Aa(464);ji||(ji=new ia(f.$,Vg,Ie.result,Xc.result,kd.result,Sf.result,Nc.result.m6c(f.$,Wb.result)),Hh.YZc(ji.gZe),Hh.ZZc(ji.Xva))}else ji=pb.Aa(221),ji||(ji=new ha(f.$,Vg,Wb.result,Ie.result,null,Nc.result,kd.result,Sf.result,Xc.result),Hh.YZc(ji.hZe),Hh.rwe(ji.EZe),Hh.ZZc(ji)),N&&(pb.Aa(317)||new Nb(f.$));f.Eb(Vg)},this.la,3)}else{var ag=mf.GetServiceTaskFactory.Ua(pb,
219,220,this.ub),og=mf.GetServiceTaskFactory.Ua(pb,491,492,this.ub);ud.TaskExtensions.Ba(ud.TaskExtensions.we([ag,kd,Xc],this.la),function(){var Vg=pb.Aa(19)||new Ta(f.$,Xc.result),Hh=ag.result,ji=pb.Aa(221);ji||(ji=new ha(f.$,Vg,Wb.result,null,null,Nc.result,kd.result,og.result,Xc.result),Hh.YZc(ji.hZe),Hh.rwe(ji.EZe),Hh.ZZc(ji));N&&(pb.Aa(317)||new Nb(f.$));f.Eb(Vg)},this.la,3)}};aa.ka=function(f){f.da.Ha(153,new aa(f))};Object(Jb.a)(aa,"FunctionInfoManagerFactory",lh.a,[]);var Qb=b(209),tc=b(75),
md=b(116);J.prototype.c2e=function(){return md.a(ff.a.Ra,this.startTime)};Object(Jb.a)(J,"OngoingAction",null,[]);var Dd=tc.a;Am(P,Dd);P.prototype.Yrc=function(f){ld.ULS.sendTraceTag(537153864,0,50,"ActionAggregator<{0}>.PerformThrottledAction: Start. IsActionOngoing: {1}, AggregatedActionParams not null: {2}",this.tma,this.YMa,this.k7a);this.ypb=this.nDg.R0b(f,this.ypb);this.Lpd()};P.prototype.dispose=function(){this.documentVisibilityObserver&&this.documentVisibilityObserver.kJb(this.Dza);this.DAe();
Dd.prototype.dispose.call(this)};P.prototype.F3f=function(f){this.M0c?(this.pQa=f?new J:null,f?this.startTimer():this.DAe()):this.pQa=f?{}:null};P.prototype.LXe=function(f){f=void 0===f?null:f;this.M0c&&f&&f.$K?ld.ULS.sendTraceTag(537153863,0,50,"ActionAggregator<{0}>.FinishedCallback: timedout, skipping",this.tma):(ld.ULS.sendTraceTag(537153862,0,50,"ActionAggregator<{0}>.FinishedCallback: Start. IsActionOngoing: {1}, AggregatedActionParams not null: {2}",this.tma,this.YMa,this.k7a),this.F3f(!1),
this.Lpd())};P.prototype.Lpd=function(){var f=this;if(!this.QMb()){var D=this.ypb;this.ypb=null;this.F3f(!0);ld.ULS.sendTraceTag(537153857,0,50,"ActionAggregator<{0}>.InternalPerformAction: Calling PerformAction.",this.tma);var N=this.M0c?this.pQa.Qx.token:Qb.a.none;ud.TaskExtensions.Ba(this.mDg.Wrc(D),function(){f.LXe(N)},N,0,this.xP)}};P.prototype.QMb=function(){return!this.k7a||this.YMa?!0:this.documentVisibilityObserver&&this.documentVisibilityObserver.Hi?(ld.ULS.sendTraceTag(593376846,0,50,"ActionAggregator<{0}>.ShouldThrottle: Not Calling PerformAction as document is hidden.",
this.tma),!0):!1};P.prototype.DAe=function(){this.Xqc&&this.Xqc.cancel()};P.prototype.startTimer=function(){this.N0c<=this.bze&&(this.Xqc=mi.a.instance.create(this.tWi,this.OWg,Ai.a.Sne))};uk.Object.defineProperties(P.prototype,{YMa:{configurable:!0,enumerable:!0,get:function(){return!!this.pQa}},k7a:{configurable:!0,enumerable:!0,get:function(){return!!this.ypb}}});Object(Jb.a)(P,"ActionAggregator",tc.a,[844,3]);var ue=b(127),Ce=di.a;Am(I,Ce);I.prototype.yJg=function(f){this.addHandler("KBIS",f)};
I.prototype.ahj=function(f){this.removeHandler("KBIS",f)};I.prototype.dispose=function(){this.firstElement&&ni.a.removeHandler(this.firstElement,hg.a.focus,this.zBf);this.Ys&&this.Ys.detach("focus");this.Eo&&(ni.a.removeHandler(this.Eo,hg.a.focus,this.sDf),ni.a.removeHandler(this.Eo,hg.a.blur,I.onBlur),nk.KeyInputManager.instance.za(hg.a.Ub,this.Eo,this.tDf));nk.KeyInputManager.instance.za(hg.a.Ub,this.$.domElement,this.SIf);this.Ys=this.Eo=this.firstElement=this.$=null;Ce.prototype.dispose.call(this)};
I.prototype.F$g=function(){this.pBj?(this.firstElement=document.documentElement,this.Ys=ue.a.instance.TC(document.parentWindow),this.Ys.ka("focus",this.TZi)):(this.firstElement=I.xHe(),document.body.insertBefore(this.firstElement,document.body.childNodes[0]),ni.a.addHandler(this.firstElement,hg.a.focus,this.zBf))};I.prototype.Cah=function(){this.Eo=I.xHe();this.Eo.id=Bf.a.BOe;this.Eo.setAttribute(Bf.a.Zt,oe.a.instance.fa(845));document.body.appendChild(this.Eo);ni.a.addHandler(this.Eo,hg.a.focus,
this.sDf);ni.a.addHandler(this.Eo,hg.a.blur,I.onBlur);nk.KeyInputManager.instance.qa(hg.a.Ub,this.Eo,this.tDf)};I.prototype.HDh=function(f){this.Jdg(f);return!1};I.prototype.jPi=function(){this.yNa=!0;We.g(this.$).focus();We.g(this.$).ga.T9e();this.raiseEvent("KBIS");return!0};I.prototype.Jdg=function(f){this.yNa?this.yNa=!1:(this.yNa=!0,f&&f.focus())};I.xHe=function(){var f=document.createElement("div");f.tabIndex=0;return f};I.Hbf=function(){document.body.classList.add(R.a.ZQe)};I.onBlur=function(){document.body.classList.remove(R.a.ZQe)};
Object(Jb.a)(I,"EmbedViewFocusControl",di.a,[843,3]);var Kf=b(59),Wg=b(570),Dh=di.a;Am(S,Dh);S.prototype.V_b=function(f){this.addHandler("FieldInfoListContextLoaded",f)};S.prototype.Uuc=function(f){this.removeHandler("FieldInfoListContextLoaded",f)};S.prototype.ZIg=function(f){this.addHandler("GetFieldInfoListContextOperationFailed",f)};S.prototype.Jgj=function(f){this.removeHandler("GetFieldInfoListContextOperationFailed",f)};S.prototype.dispose=function(){this.wb=null;this.$cb();Dh.prototype.dispose.call(this)};
S.prototype.t_=function(f,D,N,fa){fa=void 0===fa?null:fa;if(f){this.F1c();this.n3b();var Ia=null,pb=!1,Wb;if(Wb=!fa)Wb=this.ESj(f,D,N),pb=Wb.Vab,Ia=Wb.Rk,Wb=Wb.returnValue;if(Wb&&(this.t2f(Ia),this.CVb=!0,(this.fQ=Ia)&&0<this.fQ.length&&(this.Nkb=!0,this.qJd()),!pb))return;this.shg(f,fa,D,N,!1)}};S.prototype.shg=function(f,D,N,fa,Ia){if(this.$.ea.sc){this.$.Sb&&(this.dKb=this.$.Sb.Hc("WebServiceCall","GetRichValueFieldInfoListContext"));this.bxb=null;var pb=this.$.na.ta.fc(),Wb=this.$.na.ta,Nc=this.FQi,
kd=this.EQi,Xc=Wb.Ma(1,null);Xc.selectedRange=f;Xc.richValueKeyPath=D;Xc.singleColumn=N;Xc.searchForRange=fa;Xc.calculateMajorityDataType=Ia;this.bxb=Se.i(Wb,"GetRichValueFieldListContextList",Xc,Nc,kd,null,pb,4)}else this.fQ=null};S.prototype.$cb=function(){this.fQ=null;this.Nkb=!1;this.F1c();this.n3b();this.bxb=null;this.oUb=-1};S.prototype.F1c=function(){S.srb(this.bxb)};S.prototype.n3b=function(){S.srb(this.thd)};S.prototype.qJd=function(){this.raiseEvent("FieldInfoListContextLoaded")};S.prototype.rn=
function(f){f=af.D(f);--f.left;--f.right;return this.tableManager.rn(f)};S.prototype.jLa=function(f){var D=this;f.FirstColumn=f.FirstColumn;f.LastColumn=f.LastColumn;f.FirstRow=f.FirstRow;f.LastRow=f.LastRow;this.n3b();this.thd=null;return Sd.a(this.$.userOperationManager,function(N,fa,Ia){return Se.w(D.$.na.ta,f,Pg.b(N,function(pb){D.PQi(pb)}),Pg.a(fa,fa,function(pb){D.OQi(pb)}),Ia,null)},function(N){return new Mf.a(264,0,N,80)},null)};S.prototype.OQi=function(f){f=yf.a.mg(f.data);ld.ULS.sendTraceTag(525336847,
0,10,"FieldInfoManager.OnGetFullTableRangeFailure - Webservice call failed with Errors: {0}",Cf.a.Wc(f))};S.prototype.PQi=function(f){if(Mh.a(f))-315732528!==f.Errors[0].MessageId&&ld.ULS.sendTraceTag(525336846,0,10,"FieldInfoManager.OnGetFullTableRangeSuccess - Webservice call failed with Unexpected error : {0}",Cf.a.Wc(f.Errors));else if(f&&f.Result){f=f.Result;var D=f.HasHeaderRow;D=new Wg.AutofilterRange(f.TableRange.FirstRow+(D?1:0)+1,f.TableRange.FirstColumn+1,f.TableRange.LastRow+1,f.TableRange.LastColumn+
1,null,null,null,0,D);this.oUb=f.TableRange.FirstColumn;(f=this.NNf(!1,!0,D))||ld.ULS.sendTraceTag(525336844,0,50,"FieldInfoManager.OnGetFullTableRangeSuccess - fieldInfoListContextList is null");this.t2f(f)}else ld.ULS.sendTraceTag(525336845,0,10,"FieldInfoManager.OnGetFullTableRangeSuccess - Webservice call returned no result")};S.prototype.ESj=function(f,D,N){var fa=null;var Ia=!1;if(f.SheetName!==this.$.ea.oa.sheetName)return{returnValue:!1,Vab:Ia,jLa:!1,Rk:fa};this.oUb=-1;if(N){var pb=this.rn(f);
if(!pb||!pb.Pba)return{returnValue:!1,Vab:Ia,jLa:!1,Rk:fa};var Wb=We.g(this.$).Tb.k6e(pb);this.R7d=pb;if(ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5167298_ObtainFullRangeOfTableForPopulatingInsertDataDropdownCorrectly")&&Wb&&0<Wb.count)return--f.FirstColumn,--f.LastColumn,this.thd=this.jLa(f),{returnValue:!0,Vab:Ia,jLa:!0,Rk:fa};pb.top+=1;pb.right=af.D(f).right-1}else pb=new Wg.AutofilterRange(f.FirstRow+1,f.FirstColumn+1,f.LastRow+1,f.LastColumn+1,null,null,null,0,!1);if(pb.top>pb.bottom||pb.left>
pb.right)return{returnValue:!0,Vab:Ia,jLa:!1,Rk:fa};f=We.g(this.$);var Nc=f.rb.width,kd=f.rb.height;Wb=f.view.visibleArea;Nc=new Kf.a(Wb.x-Nc,Wb.y-kd,Wb.width+Nc,Wb.height+kd);kd=f.jg(pb);if(!Wb||!kd||!f.Ijc(pb))return{returnValue:!1,Vab:Ia,jLa:!1,Rk:fa};Nc.contains(kd)||(Ia=!0);fa=this.NNf(D,N,pb);return{returnValue:!0,Vab:Ia,jLa:!1,Rk:fa}};S.prototype.t2f=function(f){f&&ld.ULS.sendTraceTag(25264348,0,50,"Retrieved {0} rich value field contexts from block cache",f.length);this.CVb=!0;(this.fQ=f)&&
0<this.fQ.length&&(this.Nkb=!0,this.qJd())};S.prototype.NNf=function(f,D,N){var fa=null;var Ia=N.clone();if(D){D=N.right;for(var pb=0;D>=N.left;--D){Ia.left=D;Ia.right=D;var Wb=this.q2e(Ia,!0,N.left);if(Wb){fa||(fa=[]);fa[pb]=Wb;if(f)break;++pb}}}else if(f=this.q2e(Ia,!1))fa=[],fa[0]=f;return fa};S.prototype.q2e=function(f,D,N){N=void 0===N?0:N;var fa=null;if(ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5723259_StoreRichValueFieldsInDictionary")){var Ia=We.g(this.$).Tb.o1h(f);if(Ia&&0<Ia.count){var pb=
Array(Ia.count),Wb=0;Ia=Cl(Ia.values);for(fa=Ia.next();!fa.done;fa=Ia.next()){var Nc={};Nc.Name=fa.value;pb[Wb]=Nc;++Wb}Wb="";Ia=-1;0<f.top&&D&&(f=new Si.Range(f.top-1,f.left,f.top-1,f.left,!1,!1),Wb=We.g(this.$).rc(f).originalText,Ia=f.left-N);fa={};fa.ColumnName=Wb;fa.ColumnIndex=Ia;fa.FieldInfoDataList=pb}}else if((Ia=We.g(this.$).Tb.k6e(f))&&0<Ia.count){pb=Array(Ia.count);Wb=0;Ia=Cl(Ia);for(fa=Ia.next();!fa.done;fa=Ia.next())Nc={},Nc.Name=fa.value,pb[Wb]=Nc,++Wb;Wb="";Ia=-1;0<f.top&&D&&(f=new Si.Range(f.top-
1,f.left,f.top-1,f.left,!1,!1),Wb=We.g(this.$).rc(f).originalText,Ia=f.left-N);fa={};fa.ColumnName=Wb;fa.ColumnIndex=Ia;fa.FieldInfoDataList=pb}return fa};S.srb=function(f){f&&Gg.AFrameworkApplication.Ld.Ku(f.$t)};uk.Object.defineProperties(S.prototype,{FAb:{configurable:!0,enumerable:!0,get:function(){return this.Nkb}},oyi:{configurable:!0,enumerable:!0,get:function(){return this.CVb}},zZe:{configurable:!0,enumerable:!0,get:function(){return this.oUb}},J7c:{configurable:!0,enumerable:!0,get:function(){return this.R7d}},
$:{configurable:!0,enumerable:!0,get:function(){return this.wb}},Rk:{configurable:!0,enumerable:!0,get:function(){return this.fQ}},nUh:{configurable:!0,enumerable:!0,get:function(){return!!this.bxb}}});Object(Jb.a)(S,"FieldInfoManager",di.a,[842,3]);Am(Z,S);Z.prototype.xUh=function(f,D){this.h3a=D;ld.ULS.sendTraceTag(537153825,0,100,"FilterInfoManager.GetFilterFieldInfoListContextAsync - Retrieving the list of field list context for row, col, row, col ({0}, {1}, {2}, {3})",f.FirstRow,f.FirstColumn,
f.LastRow,f.LastColumn);this.shg(f,null,!0,!1,!0)};uk.Object.defineProperties(Z.prototype,{pH:{configurable:!0,enumerable:!0,get:function(){return this.opg}}});Object(Jb.a)(Z,"FilterInfoManager",S,[841,842,3]);ea.txh="ewa-sharedUi-launchButton";ea.wxh="ewa-sharedUi-launchButtonWithText";ea.uxh="ewa-sharedUi-launchButtonClick";ea.xxh="ewa-sharedUi-launchButtonWithTextClick";ea.vxh="ewa-sharedUi-launchButtonText";Object(Jb.a)(ea,"CssClassNames",null,[]);var Ci=b(294),wj=Ug.a;Am(O,wj);O.prototype.u3=
function(f){this.addHandler(this.wHb,f)};O.prototype.aea=function(f){this.get_events().removeHandler(this.wHb,f)};O.prototype.PJg=function(f){this.addHandler("OnObjectButtonMouseOver",f)};O.prototype.rhj=function(f){this.get_events().removeHandler("OnObjectButtonMouseOver",f)};O.prototype.OJg=function(f){this.addHandler("OnObjectButtonMouseOut",f)};O.prototype.qhj=function(f){this.get_events().removeHandler("OnObjectButtonMouseOut",f)};O.prototype.ygg=function(f){f&&(this.A0a.innerHTML=f)};O.prototype.OVj=
function(f,D,N){this.A0a.innerHTML="";f?f.Zba(D,16,16,this.A0a,16,16,void 0,N):ld.ULS.sendTraceTag(537153824,0,10,"OnObjectButton.UpdateButtonSvgImage: Called without svgIconProvider")};O.prototype.PVj=function(f,D){f&&(this.sOb.innerText=f);this.domElement.title=D};O.prototype.dispose=function(){this.get_isInitialized()&&(this.hide(),this.xc.qB(),Ag.a.tc([this.a_,this.s0a]),vi.a.instance.za(hg.a.click,this.domElement,this.dd),gi.a.instance.za(hg.a.pointerDown,this.domElement,this.yO),this.HTa&&this.HTa.dispose(),
wj.prototype.dispose.call(this))};O.prototype.Ycb=function(){this.n4b&&this.domElement.classList.remove(this.n4b);this.boc&&this.domElement.classList.add(this.boc)};O.prototype.uHb=function(){this.boc&&this.domElement.classList.remove(this.boc);this.n4b&&this.domElement.classList.add(this.n4b);this.u3a()};O.prototype.u3a=function(){this.ekc&&(this.HTa.cancel(),this.O$f(),this.setOpacity(1));this.set_visible(!0)};O.prototype.Qp=function(f,D,N,fa,Ia){Ia=void 0===Ia?!1:Ia;f=Bg.a(fa).Mi(f);D=Bg.a(fa).Mi(D);
Bg.a(fa).Cyc(this.domElement);this.domElement.style.top=ca.HelperMethods.Yb(D);this.domElement.style.left=this.domElement.style.right="";D=f;Ia&&(D=f-this.domElement.offsetWidth);Pe.c(this.domElement.style,N,ca.HelperMethods.Yb(D));this.set_visible(!0);this.setOpacity(1);this.ekc&&(this.GVd=!1,this.tKj(),this.HTa.hr())};O.prototype.hide=function(){this.Ycb();this.set_visible(!1);this.ekc&&(this.O$f(),this.HTa.cancel())};O.prototype.B9b=function(){this.xc.ka("mouseover",this.iG,!0);this.xc.ka("mouseout",
this.GI,!0)};O.prototype.tKj=function(){this.a_.un("mousemove")||this.a_.ka("mousemove",this.dDd)};O.prototype.O$f=function(){this.a_.un("mousemove")&&this.a_.detach("mousemove")};O.prototype.Old=function(f){if(this.domElement.parentNode){var D=Sys.UI.DomElement.getBounds(this.domElement),N=new Sys.UI.Point(Math.round(D.x+D.width),Math.round(D.y+D.height));D=Math.abs(N.x-f.x);f=Math.abs(N.y-f.y);f=D>f?D:f;this.GVd?this.setOpacity(O.QXg(f)):100>=f&&this.eoe()}};O.prototype.eoe=function(){this.GVd=
!0;this.HTa.cancel()};O.prototype.setOpacity=function(f){bj.a.setOpacity(this.domElement,f);this.Inf=ff.a.Ra.Ob};O.QXg=function(f){return 100>=f?1:250<=f?0:.01*(100-(f-100)/150*100)};Object(Jb.a)(O,"OnObjectButton",Ug.a,[800,168,3]);var Jj=b(1004),dk=ea.vxh,vj=tc.a;Am(Q,vj);Q.prototype.dispose=function(){this.Dkh();this.$=null;vj.prototype.dispose.call(this)};Q.prototype.getButton=function(f,D){return this.lwa(f,void 0===D?!0:D)};Q.prototype.lwa=function(f,D){var N=f.toString();N in this.buttons||
this.Eah(f,void 0===D?!0:D);return this.buttons[N]};Q.prototype.Qp=function(f,D,N,fa,Ia,pb){Ia=void 0===Ia?!0:Ia;pb=void 0===pb?!1:pb;this.hide();if(this.$.ea.isNamedObjectViewMode&&Tc.i(this.$.oa)){var Wb=We.g(this.$).cP.domElement,Nc=f+this.buttonWidth-Wb.scrollWidth;Wb=D+this.buttonWidth-Wb.scrollHeight;f=0<Nc?f-Nc:f;D=0<Wb?D-Wb:D}this.lwa(fa,Ia).Qp(f,D,N,this.$,pb)};Q.prototype.hide=function(){var f=this.buttons,D;for(D in f)f[D].hide()};Q.prototype.B9b=function(f,D){!this.jcf&&(D=this.buttons[D.toString()])&&
(this.znc=function(N,fa){f(fa,!0)},D.PJg(this.znc),this.ync=function(N,fa){f(fa,!1)},D.OJg(this.ync),this.jcf=!0,D.B9b())};Q.prototype.Eah=function(f,D){function N(pb,Wb){fa.jNi(Wb,f)}var fa=this;this.xxa=String.format(this.jod===R.a.r$b?'<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>':'<img class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1"/>',Lg.a.Rf(this.jod),Lg.a.Rf(this.iod),"{0}");var Ia=String.format(this.xxa,Lg.a.Rf(this.altText));D=new O(""===
this.buttonText?ea.txh:ea.wxh,""===this.buttonText?ea.uxh:ea.xxh,R.a.Dr,Ia,D,this.wHb,this.buttonText,dk);D.u3(N);this.buttons[f.toString()]=D;this.iQe[f.toString()]=N;Ia=We.g(this.$).Kf(f);Ia.domElement.insertBefore(D.domElement,Ia.domElement.firstChild)};Q.prototype.Dkh=function(){for(var f=Cl(Jj.a(this.buttons)),D=f.next();!D.done;D=f.next()){D=D.value;var N=this.buttons[D];N.aea(this.iQe[D]);Ag.a.Fa(N);delete this.buttons[D];this.znc&&N.rhj(this.znc);this.ync&&N.qhj(this.ync)}};Q.prototype.domElement=
function(f){return this.lwa(f).domElement};Q.prototype.u3a=function(f){this.lwa(f).u3a()};Q.prototype.UPb=function(f,D,N){N=void 0===N?!0:N;this.xxa=String.format('<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>',Lg.a.Rf(this.jod),Lg.a.Rf(this.iod),"{0}");f=String.format(this.xxa,Lg.a.Rf(f));this.lwa(D,N).ygg(f)};Q.prototype.jVa=function(f,D,N){this.lwa(N,!1).PVj(f,D)};Q.prototype.phg=function(){var f=void 0===f?!1:f;this.xxa=String.format('<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>',
"{0}",Lg.a.Rf(this.iod),"{1}");var D=String.format(this.xxa,void 0,Lg.a.Rf(void 0));this.lwa(void 0,f).ygg(D)};Q.prototype.qhg=function(f,D,N){this.lwa(N,!1).OVj(this.svgIconProvider,f,D)};uk.Object.defineProperties(Q.prototype,{Lz:{configurable:!0,enumerable:!0,get:function(){return Bg.a(this.$).ZGa(Ya.a.KUi)}},O3b:{configurable:!0,enumerable:!0,get:function(){return Ya.a.JUi}},buttonWidth:{configurable:!0,enumerable:!0,get:function(){return Bg.a(this.$).ZGa(Ya.a.LUi)}}});Object(Jb.a)(Q,"OnObjectLaunchButton",
tc.a,[786,3]);var hj=b(87),aj=hj.a;Am(U,aj);U.prototype.dispose=function(){Ag.a.Fa(this.pDb);this.pDb=null;aj.prototype.dispose.call(this)};U.prototype.ZBa=function(){Ag.a.Fa(this.pDb);this.pDb=mi.a.instance.create(Object(Nh.a)(this,this.display,"display"),this.xdi,Ai.a.syi)};U.prototype.cUa=function(){Ag.a.Fa(this.pDb);this.hide()};Object(Jb.a)(U,"LoadingIndicatorBehavior",hj.a,[799,3]);Am(H,U);H.prototype.dispose=function(){this.oDb=null;U.prototype.dispose.call(this)};H.prototype.display=function(){this.Hrg(this.oDb)};
H.prototype.hide=function(){this.Iai(this.oDb)};H.prototype.CFg=function(){this.oDb=document.createElement("div");this.domElement.appendChild(this.oDb)};Object(Jb.a)(H,"ShimmerLoadingIndicatorBehavior",U,[]);Am(C,U);C.prototype.dispose=function(){this.TOa=null;U.prototype.dispose.call(this)};C.prototype.display=function(){$a.DOMElementExtensions.setVisible(this.TOa,!0)};C.prototype.hide=function(){$a.DOMElementExtensions.setVisible(this.TOa,!1)};C.prototype.BFg=function(){this.TOa=document.createElement("div");
this.TOa.classList.add(X.a.tvh);var f=document.createElement("div");f.classList.add(X.a.uvh);this.M7c&&""!=this.M7c&&f.classList.add(this.M7c);var D=0===this.ypf?"":oe.a.instance.fa(this.ypf),N=String.format('<div class="'+X.a.vvh+'">{0}</div>',D);this.Dgc?(D=String.format('<img src="{0}" alt="{1}" title="{1}"/>',this.Dgc,D),f.innerHTML=D+N):f.innerHTML=N;this.TOa.appendChild(f);this.domElement.appendChild(this.TOa)};Object(Jb.a)(C,"SpinnerLoadingIndicatorBehavior",U,[]);E.prototype.J6c=function(f,
D,N){return new Ek.a(f,D,N)};E.prototype.t6b=function(f,D,N,fa,Ia,pb,Wb,Nc,kd,Xc){return new Xb(f,D,N,fa,Ia,pb,Wb,Nc,kd,Xc)};E.prototype.d2a=function(f,D,N,fa,Ia){return new C(f,D,N,fa,void 0===Ia?0:Ia)};E.prototype.cjd=function(f){return f.da.Aa(238)||new I(f)};E.prototype.x6b=function(f,D,N,fa,Ia,pb,Wb,Nc){return new Q(f,D,N,fa,Ia,pb,Wb,void 0===Nc?"":Nc)};E.prototype.m6c=function(f,D){return new S(f,D)};E.prototype.A$g=function(f,D,N,fa){return new Z(f,D,N,fa)};E.prototype.X5b=function(f,D,N,fa){return new P(f,
D,N,fa)};Object(Jb.a)(E,"SharedUIControlsFactory",null,[738]);var Gk=lh.a;Am(t,Gk);t.prototype.create=function(){ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ServiceInit",!1)?this.Eb(this.$.da.Aa(12)||new E):this.Eb(new E)};t.ka=function(f){f.da.Ha(477,new t(f))};Object(Jb.a)(t,"SharedUIControlsFactoryServiceFactory",lh.a,[]);var Uk=b(1094),Ok=lh.a;Am(A,Ok);A.prototype.create=function(){var f=this;ld.ULS.sendTraceTag(537154643,0,50,"PluginSchedulerFactory.Create: Loading scheduler slice");
Uk.a.then(this.Xbh(),function(D){f.Eb(D);return!0})};A.prototype.Xbh=function(){var f=this;if(this.z6b)return this.z6b;var D=Zf.a.g2a($f.b(),Qb.a.none,"LoadResource","x10Scheduler loading");if(ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5789323_disableSchedulerForIE")&&bj.a.vv){var N=excelOnlineCalc.PluginSchedulerSingletonGlobal.instance();this.$.da.Ha(413,N);D.setResult(N);return this.z6b=D.task}this.$.da.Ya(266,function(){f.$.da.Ya(283,function(fa){var Ia=excelOnlineCalc.PluginSchedulerSingletonGlobal.instance();
fa=ei.b(rg.Task.Sa(fa.ho));excelOnlineCalc.x10.ensureAllPluginsAttached(fa).then(function(pb){f.$.da.Ha(413,Ia);D.setResult(Ia);ye.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.MockSetActiveCell",0)&&f.$.da.Ya(491,function(Wb){Wb.MSa.anyPluginInitialized=pb})})})});return this.z6b=D.task};A.ka=function(f){f.da.Ha(414,new A(f))};Object(Jb.a)(A,"PluginSchedulerFactory",lh.a,[]);var il=tc.a;Am(v,il);v.prototype.dispose=function(){this.gq.dispose();this.$=null;il.prototype.dispose.call(this)};
v.prototype.domElement=function(f){return this.gq.domElement(f)};v.prototype.getButton=function(f){return this.gq.getButton(f,!1)};v.prototype.UPb=function(f,D){this.gq.UPb(f,D,!1)};v.prototype.PBa=function(f,D){var N=We.g(this.$),fa=N.rb.wj(f);this.gq.UPb(D?oe.a.instance.fa(1691):oe.a.instance.fa(1692),fa);D=this.isMac?D?oe.a.instance.fa(1695):oe.a.instance.fa(1696):D?oe.a.instance.fa(1693):oe.a.instance.fa(1694);var Ia=N.jg(f,fa);f=N.Kf(fa).An;if(Ia&&0<=Ia.x&&0<=Ia.y){var pb=Ia.bottomRight.x+this.Lz;
Ia=Ia.topLeft.y-this.Lz-this.buttonWidth;if(Ia<f.topLeft.y+this.Lz){if(N.rb.KUa){this.hide();return}Ia=f.topLeft.y+this.Lz}this.Qp(pb,Ia,N.rtl,fa);this.ariaLiveNotifier.oRa(D)}else this.hide()};v.prototype.Qp=function(f,D,N,fa){this.gq.Qp(f,D,N,fa,!1)};v.prototype.hide=function(){this.gq.hide()};uk.Object.defineProperties(v.prototype,{Lz:{configurable:!0,enumerable:!0,get:function(){return this.gq.Lz}},buttonWidth:{configurable:!0,enumerable:!0,get:function(){return this.gq.buttonWidth}}});Object(Jb.a)(v,
"PulloutLaunchButton",tc.a,[]);var Vk=tc.a;Am(y,Vk);y.prototype.dispose=function(){this.gridView&&(this.gridView.ga.P7(this.zh),this.gridView.view.fr(this.Gt),this.gridView.zc&&this.gridView.zc.$k(this.mj));if(this.$){var f=this.$;f.Bl(this.vd);f.En(this.rd);f.UD(this.lj);We.g(f).Nt(this.BS)}this.xh&&this.xh.Uuc(this.Eza);Ag.a.Fa(this.$h);this.xh=this.$=this.gridView=this.dqb=this.$h=null;Vk.prototype.dispose.call(this)};y.prototype.py=function(){this.$h.hide()};y.prototype.lea=function(){this.$h?
this.$h.getButton(this.rfa).Ycb():ld.ULS.sendTraceTag(537154142,0,15,"PulloutManager.ResetButtonAppearance: launchButton is null.")};y.prototype.Olj=function(){this.f1=null};y.prototype.ANf=function(){this.$h&&this.$h.hide()};y.prototype.q5h=function(){if(!this.nld||1!==this.selectedRange.width)return null;for(var f=this.selectedRange.clone();this.gridView.V_(f);){f.left+=1;f.right+=1;if(!this.gridView.Kf(this.gridView.rb.wj(f)).nh.We(f))break;if(this.gridView.Da.Es(f)){var D=this.gridView.Pk("PulloutManager.GetValidatedRangeToFill",
f,2);try{if(y.D_j(D))return f}finally{D&&D.dispose()}}}return null};y.prototype.Vvc=function(){this.xh.$cb()};y.prototype.showCallout=function(){var f=this;this.Hxa&&(this.xh.FAb?(this.$h.getButton(this.rfa).uHb(),ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ServiceInit",!1)?ud.TaskExtensions.Ba(mf.GetServiceTaskFactory.Ua(this.$.da,8,9,0),function(D){f.m7f(D.result)},this.$.la,3):this.m7f(this.contextMenuManager)):(this.I0c=!0,this.t_()))};y.prototype.m7f=function(f){f.Ogd("tableFieldList").w1(null,
this.$h.domElement(this.rfa),this.xh,null,!0);this.Vvc()};y.prototype.CXe=function(){if(!this.Hxa||!this.gridView||this.gridView.ga.Pa.nc||!this.gridView.ga.va.Wg)return null;var f=this.gridView.ga.va.activeCell,D=We.g(this.$).rb.wj(f);if(!f)return null;this.uGa=f.clone();var N=this.tableManager.rn(f);this.eOc=!!N;if(this.eO){this.$h.UPb(oe.a.instance.fa(1691),D);this.KP=y.tjg(N);if(!this.KP)return null;D=this.tableManager.zGe(N,this.gridView);f=D.yZ;D=D.returnValue||f;this.aHc=f;if(D)return this.fxc=
new Si.Range(N.top,N.left,N.bottom,N.right,!1,!1),this.qQc=new Si.Range(this.KP.top,this.KP.right+1,this.KP.top,this.KP.right+1,!1,!1),this.KP}else if(this.nld){this.$h.UPb(oe.a.instance.fa(1692),D);this.YYa=this.gridView.ga.va.xd.clone();N=We.g(this.$).Tb.ZNa(this.selectedRange);this.KP=y.tjg(this.selectedRange);if(!N||!this.KP||!this.selectedRange||ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichPivotAll",!1)&&this.tableManager.ALa(this.selectedRange))return null;this.qQc=this.q5h();
if((ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5459087_FixLinkedEntityConvertPulloutButtonVisibilityBounds")?this.gridView.V_(this.selectedRange):this.gridView.V_(this.KP))&&this.rza)return this.fxc=this.KP,N=String.format("PulloutManager:FindSelection, NextRange, {0}, RightColumnHeader, {1}, ActiveCell, {2}",this.rza?this.rza.toString():"null",this.KP?this.KP.toString():"null",f?f.toString():"null"),ld.ULS.sendTraceTag(537154137,0,50,N),this.KP}return null};y.prototype.t_=function(){this.eO?this.xh.t_(af.v(this.rza,
this.$),!1,!0):ye.EwaSettings.ma(136)&&this.xh.t_(af.v(this.selectedRange,this.$),!0,!1)};y.prototype.a8a=function(){return this.$.ea.isNamedObjectViewMode&&Tc.f(this.$.oa)};y.D_j=function(f){for(;f.$$mn();)if(f.$$cu().text||f.$$cu().WF||f.$$cu().Hi||f.to.taf)return!1;return!0};y.tjg=function(f){return f.right===Ya.a.di?null:new Si.Range(f.top,f.right,f.top,f.right,!1,!1)};uk.Object.defineProperties(y.prototype,{Kb:{configurable:!0,enumerable:!0,get:function(){return this.$h.domElement(1)}},rza:{configurable:!0,
enumerable:!0,get:function(){return this.qQc}},selectedRange:{configurable:!0,enumerable:!0,get:function(){return this.YYa}},eO:{configurable:!0,enumerable:!0,get:function(){return this.eOc}},gOf:{configurable:!0,enumerable:!0,get:function(){return this.Uhe}},UCb:{configurable:!0,enumerable:!0,get:function(){var f=this.$h.domElement(this.rfa);return f?$a.DOMElementExtensions.isVisible(f):!1}},Hxa:{configurable:!0,enumerable:!0,get:function(){return this.$.isEditMode&&ye.EwaSettings.ma(136)?!(new ee.a(this.$.xa)).zj:
!1}},$Lg:{configurable:!0,enumerable:!0,get:function(){return this.aHc}},rfa:{configurable:!0,enumerable:!0,get:function(){return this.rza?this.gridView.rb.wj(this.KP):1}}});Object(Jb.a)(y,"PulloutManager",tc.a,[506,3]);var jl=lh.a;Am(B,jl);B.prototype.create=function(){var f=this;Xg.a.Ga(function(D){var N=mf.GetServiceTaskFactory.Ua(D.da,12,477,f.ub),fa=mf.GetServiceTaskFactory.Ua(D.da,66,134,f.ub),Ia=mf.GetServiceTaskFactory.Ua(D.da,211,212,f.ub),pb=null,Wb=!ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ServiceInit",
!1);Wb&&(pb=mf.GetServiceTaskFactory.Ua(D.da,8,9,f.ub));ud.TaskExtensions.Ba(ud.TaskExtensions.we([N,fa,pb,Ia],D.la),function(){Wb?f.Eb(f.$.da.Aa(261)||new y(f.$,N.result,fa.result,pb.result,Ia.result)):f.Eb(f.$.da.Aa(261)||new y(f.$,N.result,fa.result,null,Ia.result))},D.la)})};B.ka=function(f){f.da.Ha(262,new B(f))};Object(Jb.a)(B,"PulloutManagerFactory",lh.a,[]);var pl={average:0,max:0,median:0,P75:0,P95:0},ql={selectByArrowKeyCounter:0,selectByMouseHoverCounter:0,commitByTabKeyCounter:0,commitByEnterKeyCounter:0,
commitByMouseClickCounter:0,commitWhileRequestPending:0},vl={formulaAssistanceRequestAttemptedCounter:0,formulaAssistanceRequestOptimizedCounter:0},wl={argumentAssistanceCardInitialMode:void 0,argumentAssistanceCollapseCounter:0,argumentAssistanceExpandCounter:0,argumentAssistanceLearnMoreCounter:0,argumentAssistanceDismissCounter:0,argumentAssistanceDragCounter:0,argumentAssistanceDragTotalCounter:0,argumentAssistanceMoveCounter:0,argumentAssistanceMoveTotalCounter:0},sl={smartSuggestionShownCounter:0,
smartSuggestionSelectedCounter:0,smartSuggestionCommittedCounter:0},Wk={count:0,countAboveThresholds:void 0,failedCount:0,firstAction:0,includingFirstAction:Object.assign({},pl),excludingFirstAction:Object.assign({},pl)},nl={argumentAssistanceFlight:void 0,autoCompleteUIFlight:void 0,smartFormulaBarAutoCompleteFlight:void 0,anyPluginInitialized:void 0};r.prototype.XTa=function(){this.dnc=ff.a.Ra.ke.m};r.prototype.Aja=function(f){-1!==this.dnc&&(f?(this.Tob(ff.a.Ra.ke.m-this.dnc),this.dnc=-1):this.I0.failedCount++)};
r.prototype.pGh=function(){this.I0.excludingFirstAction=r.fXe(this.l9b);Array.add(this.l9b,this.I0.firstAction);this.I0.includingFirstAction=r.fXe(this.l9b)};r.prototype.Tob=function(f){var D=this;this.I0.count?1E3>this.I0.count&&Array.add(this.l9b,f):this.I0.firstAction=f;this.quf&&this.ruf&&this.ruf.forEach(function(N){f>N&&D.I0.countAboveThresholds[N]++});this.I0.count++};r.fXe=function(f){var D=Object.assign({},pl);0<f.length&&(Vb.i(f),D.median=f[Math.floor(.5*f.length)],D.P75=f[Math.floor(.75*
f.length)],D.P95=f[Math.floor(.95*f.length)],D.max=f[f.length-1],D.average=Vb.g(f,function(N){return N})/f.length);return D};Object(Jb.a)(r,"PerformanceMeasurement",null,[]);var kl=b(40),fl=b(97),rl={},tl=(rl.argumentAssistanceOverall=[50,80,100,130,150,170,200],rl.autoCompleteOverall=[50,80,100,130,150,170,200],rl);w.prototype.kJ=function(f){var D=this;f.forEach(function(N){D.dbb.xb(N)||D.dbb.ia(N,new r(tl[N]));D.dbb.pa(N).XTa()})};w.prototype.uF=function(f,D){var N=this;D=void 0===D?!0:D;f.forEach(function(fa){N.dbb.xb(fa)&&
N.dbb.pa(fa).Aja(D)})};w.prototype.s1f=function(f){var D="Undefined";switch(f){case 1:D="Collapsed";break;case 0:D="Expanded";break;case 2:D="Hidden"}this.wba.argumentAssistanceCardInitialMode=D};w.prototype.I9b=function(f){var D=this;window.requestAnimationFrame(function(){D.uF([f])})};w.prototype.getJsonForLogging=function(){return"{"+this.h4("SessionDetails",this.MSa)+","+this.h4("FormulaAuthoringUsage",this.wba)+","+this.h4("FormulaSuggestionsUsage",this.PKa)+","+this.h4("AutocompleteCardInteraction",
this.xZ)+","+this.h4("AutocompleteRenderOptimization",this.rqb)+","+this.$1h()+"}"};w.prototype.ryj=function(){this.MSa.argumentAssistanceFlight=this.Chd("Microsoft.Office.ExcelOnline.","ArgumentAssistancePlugin");this.MSa.autoCompleteUIFlight=this.Chd("Microsoft.Office.Excel.","AutoCompleteNewUI");this.MSa.smartFormulaBarAutoCompleteFlight=this.Chd("Microsoft.Office.Excel.","SmartFormulaBarAutocompleteFeatureIsEnabled")};w.prototype.$1h=function(){for(var f=new Ab.a,D=Cl(this.dbb),N=D.next();!N.done;N=
D.next())N=N.value,N.value.pGh(),f.add(String.format('"{0}":{1}',N.key,Ka.a.Kc(N.value.I0)));return String.format('"PerfMeasurements": {{{0}}}',f.toArray().join(","))};w.prototype.Chd=function(f,D){return Ba.a.contains(this.$.ya.FlightHolder.FlightId,D,!0)?ye.EwaSettings.getBooleanFeatureGate(f+D,!1)?"T":"C":"None"};w.prototype.h4=function(f,D){return String.format('"{0}":{1}',f.toString(),kl.c(D))};Object(Jb.a)(w,"FormulaAssistanceTelemetryManager",null,[505]);var Xk=lh.a;Am(u,Xk);u.ka=function(f){f.da.Ha(492,
new u(f))};u.prototype.create=function(){var f;this.Eb(null!==(f=this.$.da.Aa(491))&&void 0!==f?f:this.$.da.Ha(491,new w(this.$)))};Object(Jb.a)(u,"FormulaAssistanceTelemetryManagerFactory",lh.a,[]);var Yk=b(407);Object(Jb.a)(h,"GestureAdapterInfo",null,[]);var ol=b(391),ul=b(229);n.prototype.Kxi=function(){if(!this.TJc){var f="hammer.min.js";Gg.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.WordOnline.UseIsServerFlavorAppSetting",!1)&&(f=Gg.AFrameworkApplication.ha.ra("IsServerFlavorDebug")?
"hammer.js":"hammer.min.js");f=Gg.AFrameworkApplication.k1(String.format("{0}",f),5);f=ul.a.create(f,null,null);ol.a.Bja(f);this.TJc=f.z9a}return this.TJc};uk.Object.defineProperties(n,{instance:{configurable:!0,enumerable:!0,get:function(){n.Na||(n.Na=new n);return n.Na}}});n.Na=null;Object(Jb.a)(n,"HammerJsDependencyLoader",null,[551]);var sk;(function(f){f[f.none=-1]="none";f[f.pinch=0]="pinch";f[f.pan=1]="pan";f[f.swipe=2]="swipe"})(sk||(sk={}));Object(Jb.b)("GestureEvent",sk);var G=b(72),ja=
G.a;Am(m,ja);m.create=function(f,D,N,fa,Ia,pb){if(N.rawEvent)if(pb){var Wb=N.rawEvent;Wb=new Sys.UI.Point(Wb.clientX,Wb.clientY)}else Wb=G.a.Mwb(N);else Wb=new Sys.UI.Point(N.clientX,N.clientY);return new m(f,Wb,D,N,fa,Ia,N.shiftKey,N.ctrlKey,pb)};uk.Object.defineProperties(m.prototype,{shiftKey:{configurable:!0,enumerable:!0,get:function(){return this.jha}},ctrlKey:{configurable:!0,enumerable:!0,get:function(){return this.EY}},clientPoint:{configurable:!0,enumerable:!0,get:function(){return this.Oib}},
ewa:{configurable:!0,enumerable:!0,get:function(){return this.etg}}});Object(Jb.a)(m,"GestureEventArgs",G.a,[]);Object(Jb.a)(l,"GestureManagerData",null,[]);e.zng=2;e.Ang=4;e.Bng=8;e.Cng=8;Object(Jb.a)(e,"HammerConstants",null,[]);var Wa=b(207),vb=ni.a;Am(c,vb);c.prototype.FVh=function(){return this.vRc?0:this.qme?1:2};c.prototype.sn=function(f){vb.prototype.sn.call(this,f);this.Wd.ola(this.vXa,f,0,this.amb)};c.prototype.lm=function(f){vb.prototype.lm.call(this,f);this.Wd.lJa(f,this.vXa)};c.prototype.Fcj=
function(f,D,N){var fa=this;N=void 0===N?null:N;var Ia=void 0===Ia?null:Ia;Gg.AFrameworkApplication.cjc()?n.instance.Kxi().continueWith(function(pb){fa.EKj();if(pb.og||pb.Ph)ld.ULS.sendTraceTag(591192778,310,10,"Hammer did not download correctly: {0}",pb.status);else{ld.ULS.sendTraceTag(591192779,310,50,"Hammer download status: {0}",pb.status);if(fa.B6d){pb=window.Hammer;if("undefined"===typeof pb){ld.ULS.sendTraceTag(590901389,310,10,"Hammer does not exist");fa.dBc();return}if("undefined"===typeof pb.inputHandler){ld.ULS.sendTraceTag(590901390,
310,10,"Hammer.inputHandler does not exist");fa.dBc();return}}if(!f)throw fa.dBc(),Error.argumentNull("source element can not be null");pb=Wa.a.Cwa(f,fa.ora);if(void 0===pb||null===pb)pb=new fl.a,Wa.a.geb(f,fa.ora,pb),fa.Gcj(f);var Wb=null;if(!pb.xb(sk[0])){Wb=Object;var Nc=Wb.assign,kd=new h,Xc=sk[0],Ie=Ia;Ie=void 0===Ie?null:Ie;if(void 0===fa||null===fa)throw ld.ULS.sendTraceTag(42256258,310,10,"manager cannot be null"),Error.argumentNull("manager can not be null");var Ze=null;switch(Xc){case hg.a.pinch:Ze=
new Hammer.Pinch(Ie);break;case hg.a.pan:Ze=new Hammer.Pan(Ie)}Ze&&(Ze.manager=fa);Wb=Nc.call(Wb,kd,{Rda:Ze,x_e:D});pb.add(sk[0],Wb)}if(void 0!==N&&null!==N)for(Nc=0;Nc<N.length;Nc++)pb.xb(sk[N[Nc]])&&(kd=pb.pa(sk[N[Nc]]),Wb.Rda.recognizeWith(kd.Rda))}fa.dBc()}):ld.ULS.sendTraceTag(42256219,310,10,"Multi Touch is not enabled either from common BRS or from your app BRS")};c.prototype.EKj=function(){this.JLc&&(this.Ih?this.fUc=this.Ih.Hc("Task","RegisterGestureAdapterAfterLoad"):ld.ULS.sendTraceTag(590387074,
310,10,"_stopwatchBuilder is null"))};c.prototype.dBc=function(){this.JLc&&(this.fUc?this.fUc.stop():ld.ULS.sendTraceTag(590387075,310,10,"_stopwatchForRegisterGestureAdapterAfterLoad is null"))};c.prototype.Gcj=function(f){this.ftg.add(f);this.Wd.ola(this.vXa,f,0,this.amb)};c.prototype.recognize=function(f){for(var D=Array(f.pointers.length),N=0;N<f.pointers.length;N++)D[N]=f.pointers[N].target;N=null;for(this.Kqa=this.XXh(D);void 0!==this.Kqa&&null!==this.Kqa&&(N=Wa.a.Cwa(this.Kqa,this.ora),void 0===
N||null===N);this.Kqa=this.Kqa.parentNode);if(void 0!==N&&null!==N){this.curRecognizer&&this.curRecognizer.state===e.Cng&&(this.curRecognizer=null);D=Cl(N.keys);for(var fa=D.next();!fa.done;fa=D.next()){fa=N.pa(fa.value);void 0!==fa&&null!==fa&&void 0!==fa.Rda&&null!==fa.Rda&&(void 0===this.curRecognizer||null===this.curRecognizer||fa.Rda===this.curRecognizer||fa.Rda.canRecognizeWith(this.curRecognizer))&&fa.Rda.recognize(f);var Ia=fa.Rda.state;this.curRecognizer||e.zng!==Ia&&e.Ang!==Ia&&e.Bng!==
Ia||(this.curRecognizer=fa.Rda)}}};c.prototype.emit=function(f,D){if("hammer.input"!==f){this.H9=!1;D=m.create(f,this.Kqa,D.srcEvent,D,3,this.vRc);var N=Wa.a.Cwa(this.Kqa,this.ora);if(this.Tpi(f))var fa=0;else if(this.Ipi(f))fa=1;else if(this.Esi(f))fa=2;else{ld.ULS.sendTraceTag(42256256,310,15,"Event can not be recognized by current manager");return}N=N.Fc(sk[fa]).value;void 0!==N&&null!==N&&((N=N.x_e,N.Fni())?f.endsWith("start")?this.H9=N.lQi(D):f.endsWith("end")?(N.jQi(D),this.H9=!0):f.endsWith("cancel")?
(N.iQi(D),this.H9=!0):f.endsWith("move")&&(this.H9=N.kQi(D)):ld.ULS.sendTraceTag(42256257,310,50,"App rejected to perform gesture now : {0}",f))}};c.prototype.get=function(f){return Object(k.a)(Hammer.Recognizer,f)};c.prototype.XXh=function(f){if(1>f.length)return null;if(1===f.length)return f[0];for(var D=f[0],N=!0,fa=1;fa<f.length;fa++){if(!f[fa])return null;if(D!==f[fa]){N=!1;break}}if(N)return D;D=this.Q_e(f[0]);N=0;f=Cl(f);for(fa=f.next();!fa.done;fa=f.next()){fa=this.Q_e(fa.value);if(D.pa(D.count-
1)!==fa.pa(fa.count-1))return null;for(var Ia=D.count-2,pb=fa.count-2;Ia>=N&&0<=pb;Ia--,pb--)if(D.pa(Ia)!==fa.pa(pb)){N=Ia+1;break}}return D.pa(N)};c.prototype.Q_e=function(f){for(var D=new Ab.a;void 0!==f&&null!==f;f=f.parentNode)D.add(f);return D};c.prototype.y3e=function(f){switch(f){case hg.a.Mf:case hg.a.Ata:return 1;case hg.a.Dg:case hg.a.A2b:return 2;case hg.a.Ce:case hg.a.Iqb:return 4;case hg.a.KCc:case hg.a.l0c:return 8}return 0};c.prototype.Uza=function(f,D,N){f=this.y3e(f);D=this.GWh(N);
Hammer.inputHandler(this,f,D);this.H9&&N.preventDefault();return this.H9};c.prototype.U$e=function(){return 1<this.iU.count};c.prototype.p3b=function(){ld.ULS.sendTraceTag(594055960,310,50,"CancelPendingPointerEvents");if(this.$nb)for(var f=Cl(this.iU),D=f.next();!D.done;D=f.next())this.ATf(D.value.key);else this.iU=new fl.a;this.session=null};c.prototype.TFg=function(f,D,N){ld.ULS.sendTraceTag(594055959,310,50,"AddOrReplacePointerInCaches: pointerId: {0}",f);if(!this.wmb.xb(f)){try{D.setPointerCapture(f)}catch(fa){ld.ULS.sendTraceTag(594055958,
310,10,"Exception: {0}",fa)}this.wmb.add(f,D)}this.iU.ia(f,N);this.yWa&&1<this.iU.count&&this.hga&&!this.hga.prb&&(this.hga.prb=!0)};c.prototype.ATf=function(f){ld.ULS.sendTraceTag(594055957,310,50,"RemovePointerFromCaches: pointerId: {0}",f);if(this.wmb.xb(f)){try{this.wmb.pa(f).releasePointerCapture(f)}catch(D){ld.ULS.sendTraceTag(594055956,310,10,"Exception: {0}",D)}this.wmb.remove(f)}else ld.ULS.sendTraceTag(594055955,310,10,"RemovePointerFromCaches: pointerId should be in cache: {0}",f);this.iU.remove(f);
this.yWa&&1>=this.iU.count&&this.hga&&this.hga.prb&&(this.hga.prb=!1)};c.prototype.gqc=function(f,D,N){var fa=N.rawEvent.pointerType.toString(),Ia=N.rawEvent.pointerId.toString();if("touch"!==fa)return!1;f=this.y3e(f);if(1!==f&&!this.iU.xb(Ia))return!1;this.H6d&&1===f&&N.rawEvent.isPrimary&&this.iU.count&&(ld.ULS.sendTraceTag(593839564,310,10,"Pointer cache should be empty"),this.p3b());this.$nb?this.TFg(Ia,D,N):this.iU.ia(Ia,N);this.pPc&&2===f&&(!this.CIc||this.CIc&&"function"===typeof N.rawEvent.getCoalescedEvents)&&
(D=N.rawEvent.getCoalescedEvents())&&this.U$e()&&(this.Blb=Math.max(this.Blb,D.length));this.Jie&&(this.H9=!1);fa=this.FWh(this.iU,N,fa);Hammer.inputHandler(this,f,fa);if(4===f||8===f)this.$nb?this.ATf(Ia):this.iU.remove(Ia),this.iU.count||(this.session=null,this.pPc&&-1!==this.Blb&&(ld.ULS.sendTraceTag(593597138,310,50,"Max number of coalesced events: {0}",this.Blb),this.Blb=-1));this.H9&&N.preventDefault();return this.H9};c.prototype.Spc=function(){return!1};c.prototype.GWh=function(f){var D=new l,
N=f.rawEvent,fa=N.touches;N=N.changedTouches;D.pointers=Array.clone(fa);D.pointers=Array.clone(0<fa.length?fa:N);D.changedPointers=Array.clone(N);D.srcEvent=f;D.pointerType="touch";return D};c.prototype.FWh=function(f,D,N){var fa=new l;fa.pointers=d.toArray(f.values);fa.changedPointers=[D];fa.pointerType=N;fa.srcEvent=D;return fa};c.prototype.Tpi=function(f){return Lg.a.startsWith(f,hg.a.pinch)};c.prototype.Ipi=function(f){return Lg.a.startsWith(f,hg.a.pan)};c.prototype.Esi=function(f){return Lg.a.startsWith(f,
hg.a.swipe)};Object(Jb.a)(c,"GestureInputManager",ni.a,[507,508]);a.prototype.hi=function(f){f.register(c,"Common.App.GestureManager.GestureInputManager").as("Common.IGestureInputManager").Ic().Nc(function(){return new c(Ni.a.instance,Gg.AFrameworkApplication.sa.gE)});this.tb=f};a.prototype.init=function(){this.yx||(this.tb.resolve("Common.App.GestureManager.GestureInputManager"),this.yx=!0)};a.prototype.dispose=function(){};a.main=function(){li.a.instance.nj(new a)};uk.Object.defineProperties(a.prototype,
{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.GestureInputManager"}}});Object(Jb.a)(a,"GestureInputManagerPackage",null,[4,5]);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.AutoComplete");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.ContextMenu");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.DataValidation");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.DataValidationEdit");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.FormulaAssistance");
Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.SharedUIControlsFactory");Type.registerNamespace("_Ewa");ce.a.Ti('.ewa-ac{position:absolute;z-index:102;margin-top:1px;width:auto}.ewa-ac .ewa-ac-param{white-space:nowrap;margin-bottom:3px;direction:ltr}.ewa-ac .ewa-ac-param function_param_table{position:absolute}.ewa-ac .ewa-ac-param .ewa-function-help-link{text-decoration:underline}.ewa-lb{position:absolute;border:1px solid #a2a6ab;overflow-x:hidden;overflow-y:auto;cursor:default;background-color:#fff;color:#262626;font-size:12px;font-family:"Segoe UI";z-index:102;height:auto;margin:0 8px;-ms-touch-action:manipulation;touch-action:manipulation;vertical-align:middle}.ewa-lb.ewa-fb-refactor{position:relative;margin:0}.ewa-lb table{left:0;right:0;border-collapse:collapse}.ewa-lb table td{white-space:nowrap}.ewa-lb table td div.clip16x16{margin:0 0 0 2px}.ewa-lb table td.list-item{height:24px;padding:0 8px}.ewa-lb table td.list-item-selected{background-color:#d3f0e0}@media screen and (-ms-high-contrast:active){.ewa-lb table td.list-item-selected{border:2px solid #fff}}.ewa-lb table.list-table-touch td.list-item{height:35px}div#suggested_cells_list_box{margin:0}div#suggested_cells_list_box .list-table .ewa-suggested-cell-name{float:left;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}@font-face{font-family:"Segoe UI Semibold";font-weight:600;src:local("Segoe UI Semibold"),local("Segoe UI")}.ewa-lb table td.columnName-header{color:#666;font-size:12px;font-family:"Segoe UI Semibold";text-align:left;padding:3px 8px;text-overflow:ellipsis}.ewa-tt{background-color:#f7f7f7;border:1px solid #a2a6ab;color:#444;height:auto;vertical-align:middle;width:auto;z-index:102;font-size:8pt;margin:0;padding-bottom:3px;padding-top:2px}.ewa-root-ltr .ewa-tt{text-align:left;padding-left:5px;padding-right:7px}.ewa-root-rtl .ewa-tt{text-align:right;padding-left:7px;padding-right:5px}.ewa-dlg-function-link-container .ewa-fdb-help-link,.ewa-tt-rtl .ewa-fdb-help-link,.ewa-tt-ltr .ewa-fdb-help-link{color:#00f;text-decoration:underline}.ewa-function-link-container .ewa-function-udf-name,.ewa-function-link-container-udf .ewa-function-help-link{display:none}.ewa-root.rtl .ewa-function-link-container{text-align:left}');
Xg.a.Ga(bc.ka);Xg.a.Ga(sf.ka);Type.registerNamespace("Common.App.MultitabControl");Type.registerNamespace("CAUI");Fd.main();ce.a.Ti(".TabsContainer{width:100%}.TabTitlesContainer{width:100%;display:table;table-layout:fixed;padding:0}.TabTitlesContainer>.TabTitle{display:table-cell;text-align:center}.TabTitlesContainer>.TabTitle:hover:not(.TabTitleActive){font-weight:bold}.TabTitleText{text-decoration:none}div#dataFieldCustomLabel,div#dataFieldSourceLabel{font-weight:600;padding-left:10px}div#summarizeValuesByControlBody{background-color:#fff;padding:10px}.valueFielsSettingsControlTitle{font-weight:bold;border-bottom:1px solid #a2a6ab}div#summarizeValuesByControlBody>.summarizeValuesByControlDescription{font-weight:600}div#summarizeValuesByControlBody>select{width:100%}div#showValueAsControlBody{background-color:#fff;padding:10px}select#showValueAsSelect{width:100%;margin-bottom:5px}select#showValueAsBaseFieldSelect{width:100%}select#showValueAsBaseItemSelect{width:100%;overflow:hidden}div#showValueAsControlBody>.showValueAsControlSelectRegion{width:48%;display:inline-block;position:relative}div#showValueAsControlBody>.showValueAsControlSelectRegionSeparator{width:4%;display:inline-block}.showValueAsControlSelectRegion>div{width:100%}input#valueFieldsSettingsFieldName{width:273px}div#valueFieldSettingTabs{width:380px}");
(function(){le.initData();Xg.a.Ga(function(f){xd.ka(f);Ec.ka(f);le.ka(f);Lc.ka(f)})})();ce.a.Ti(".ewa-dv{position:relative;z-index:100;width:auto}.ewa-dv-buttonarea{position:absolute;border:0;padding:1;z-index:100;margin:0;overflow:hidden;width:auto;height:auto}.ewa-dv-listbutton{margin:0;cursor:pointer}.ewa-dv-listbutton span.clip17x17{display:inline-block;margin:0}.ewa-dlb{position:absolute;border:1px solid #a2a6ab;overflow-x:hidden;overflow-y:auto;cursor:default;background-color:#fff;color:#444;font-size:11px;z-index:100;height:auto;margin:0}.ewa-dlb table{left:0;right:0;border-collapse:collapse;empty-cells:show}.ewa-dlb table td{white-space:nowrap;padding:0 2px 0 2px}.ewa-dlb table.list-table td.list-item{height:24px}.ewa-dlb table.list-table td.list-item-selected{height:24px;background-color:#d3f0e0;color:#444}.ewa-dlb table.list-table-touch td.list-item{height:35px}.ewa-dlb table.list-table-touch td.list-item-selected{height:35px;background-color:#d3f0e0;color:#444}@media screen and (-ms-high-contrast:active){.ewa-dlb table.list-table td.list-item-selected{background-color:highlight;-ms-high-contrast-adjust:none;color:highlighttext}}.ewa-dpb{position:absolute;border:1px solid #a2a6ab;cursor:default;background-color:#fff;color:#444;font-size:11px;z-index:99;margin:0;max-width:230px}.ewa-dpb p{padding:0 2px 0 2px;margin:0;border-collapse:collapse;width:230px}.ewa-dv-ltr .ewa-dpb p{text-align:left}.ewa-dv-rtl .ewa-dpb p{text-align:right}.ewa-dpb p.dv-prompt-title{font-weight:bold}.ewa-dpb p.dv-prompt-message{word-wrap:break-word;overflow:hidden}");
ce.a.Ti(".DataValidationDialogPanel{min-width:0}.DataValidationDialogPanel .TabTitlesContainer{width:300px}.DataValidationDialogPanel div#WACDialogBodyPanel{height:312px}.TabTitlesContainer{border-bottom:solid 1px #c3cbd0}.TabTitle{text-align:center;cursor:default}.TabTitleText{display:inline-block}.TabTitleActive{color:#217346;font-weight:bold}.TabTitleActive>.TabTitleText{padding-bottom:10px;border-bottom:solid 4px}.DataValidationEditTabContent{padding-top:7px}.DataValidationButtonPanel{float:none}.AppRtl .DataValidationButtonPanel{float:none}.DataValidationButtonClearAll{float:left;margin-left:0;margin-right:10px}.AppRtl .DataValidationButtonClearAll{float:right;margin-left:10px;margin-right:0}.DataValidationRow{margin-bottom:10px;display:table}.DataValidationNonBorderRow{margin-bottom:8px;display:table}.DataValidationEditElementLabel{width:95px;display:inline-block;margin-top:4px;margin-bottom:4px;vertical-align:top}.DataValidationEditElement{display:inline-block;margin-top:0;margin-bottom:0;padding:1px;font-size:9pt;font:inherit;border:solid 1px #c3cbd0}.DataValidationEditNoBorderElement{display:inline-block;margin-top:0;margin-bottom:0;font-size:9pt;font:inherit;width:210px;height:22px}.DataValidationEditSelect{width:calc(210px + 4px);height:calc(22px + 4px);padding:0;color:#000}.DataValidationEditSelect:disabled{color:graytext}.DataValidationEditSelectFocus:focus{outline:-webkit-focus-ring-color auto 5px !important}.DataValidationEditInput{width:210px;height:22px}.DataValidationEditTextArea{width:210px;height:50px;resize:none;overflow-y:auto;overflow-x:hidden}.DataValidationEditErrorMessage{margin-bottom:-15px;margin-top:-6px;font-size:9pt;color:#d90000;width:300px;height:65px}.DataValidationEditCheckBoxWithText{margin-top:0;margin-bottom:0;display:inline-block}.DataValidationEditCheckBoxNoText{margin-top:6px;margin-bottom:0;display:inline-block}.DataValidationEditRadio{margin-top:0;margin-bottom:0}.DataValidationEditLabel{margin-top:5px;margin-bottom:0;display:inline-block}div#listDescriptionSubDivID{height:37px;width:210px}label#listDescriptionLabelId{font-size:8pt;margin-top:0}div#ignoreBlankCheckboxDivID{margin-bottom:8px}");
Xg.a.Ga(Jf.ka);Xg.a.Ga(zc.ka);Xg.a.Ga($d.ka);ce.a.Ti(".ewa-facp-text-box{position:absolute}");(function(){Xg.a.Ga(function(f){ed.ka(f)})})();(function(){Xg.a.Ga(function(f){vd.ka(f)})})();Xg.a.Ga(Pb.ka);Xg.a.Ga(ie.ka);Xg.a.Ga(va.ka);ce.a.Ti('.ewa-sharedUi-launchButton,.ewa-sharedUi-launchButtonWithText{cursor:pointer;position:absolute;overflow:hidden;z-index:96;border:1px solid #abafb2;background-color:#fff;padding:2px;cursor:default;width:fit-content}.ewa-sharedUi-launchButton:hover{background-color:#c6c6c6}.ewa-sharedUi-launchButtonClick,.ewa-sharedUi-launchButton:active,.ewa-sharedUi-launchButtonWithTextClick{cursor:pointer;position:absolute;overflow:hidden;z-index:96;border:1px solid #abafb2;background-color:#b1b1b1;padding:1px;cursor:default;width:fit-content}@media(forced-colors:active){.ewa-sharedUi-launchButtonClick,.ewa-sharedUi-launchButton:active,.ewa-sharedUi-launchButtonWithTextClick{background-color:Highlight;color:HighlightText;border-color:CanvasText;forced-color-adjust:none}.ewa-sharedUi-launchButtonClick svg>path.OfficeIconColors_HighContrast,.ewa-sharedUi-launchButton:active svg>path.OfficeIconColors_HighContrast,.ewa-sharedUi-launchButtonWithTextClick svg>path.OfficeIconColors_HighContrast{fill:HighlightText}}.ewa-sharedUi-launchButtonWithText .clip16x16,.ewa-sharedUi-launchButtonWithTextClick .clip16x16{float:left}.ewa-sharedUi-launchButton input{cursor:default}.ewa-sharedUi-launchButton .clip16x16,.ewa-sharedUi-launchButtonClick .clip16x16{padding:0}.ewa-sharedUi-launchButtonText{font-family:"Segoe UI",Tahoma,Thonburi,Arial,Verdana,sans-serif;font-size:10pt;overflow:hidden;padding-left:2px;cursor:pointer}');
Xg.a.Ga(Kc.ka);Xg.a.Ga(Uc.ka);(function(){Xg.a.Ga(function(f){f.da.Ha(150,new Sa(f))})})();(function(){Xg.a.Ga(function(f){T.ka(f);Tb.ka(f);aa.ka(f)})})();Xg.a.Ga(t.ka);(function(){Xg.a.Ga(function(f){A.ka(f)})})();(function(){Xg.a.Ga(function(f){f.ma(136)&&B.ka(f)})})();Type.registerNamespace("Common.App.GestureManager");a.main();(function(){Xg.a.Ga(function(f){u.ka(f)})})()},928:function(z,F,b){function a(ba,ra,ka,da,ha,qa,Aa,Fa,ab,Ua,bb,xa){var Gb=ia.call(this)||this;Gb.fnc=!1;Gb.contextMenuController=
null;Gb.nLc=null;Gb.xIc=null;Gb.Erd=!1;Gb.f5j=0;Gb.e5j=0;Gb.Ytb=null;Gb.uwc=null;Gb.XC=function(){Gb.contextMenuController?Gb.contextMenuController.XC():c.ULS.sendTraceTag(537167068,0,10,"ContextMenuBase.DismissFloatie: the context menu controller is null when attempintg to dismiss floatie on KeyDown.");Gb.Lfg()};Gb.wb=ba;Gb.buf=ha;Gb.vSc=Ua;Gb.r4j=ka;Gb.q4j=da;Gb.U3j=ra;Gb.ALf=qa;Gb.populateOnlyOnce=Aa;Gb.F$h=bb;Gb.dSf(xa);return Gb}b.d(F,"a",function(){return a});z=b(0);var c=b(13),e=b(623),l=b(89),
m=b(23),n=b(620),h=b(392),u=b(650),w=b(630),r=b(111),B=b(273),y=b(84),v=b(437),A=b(902);F=b(75);var t=b(17),E=b(5),C=b(1050),H=b(78),U=b(45),Q=b(58),O=b(150),ea=b(120),Z=b(1),S=b(8),I=b(21),P=b(14),J=b(20),aa=b(32),ia=F.a;Am(a,ia);a.prototype.$c=function(ba,ra){ba=!0;switch(ra){case 1651433993:case 1675506831:case 966232027:ba=this.qe(4096)||this.qe(2048);break;case 2045563128:ba=this.qe(4096);break;case 912277356:case 2123758504:case -1793121409:case 1378457149:ba=this.qe(8192)}return!ba};a.prototype.nd=
function(ba,ra,ka){ka.IsShadowMenuOpen||C.h(this.$,C.d);ba=!1;ra===this.It&&(ka.IsShadowMenuOpen||C.h(this.$,C.a),ra=Object.assign(new e.a,{ExternalId:"ContextMenu",UpdateDynamically:!0,MenuSectionList:[]}),this.cHd(ra,ka.IsShadowMenuOpen),ka.MenuItems=ra,ka.IsShadowMenuOpen||C.h(this.$,C.c),ba=!0);ba&&this.fnc&&S.HelperMethods.C2b&&!ka.IsShadowMenuOpen&&C.j(this.$);return ba};a.prototype.cHd=function(ba,ra){(ra=this.QZ(ra))?(this.qcf(ra),Array.addRange(ba.MenuSectionList,ra.BC().MenuSectionList),
this.lGg(ba)):c.ULS.sendTraceTag(537167105,0,10,"ContextMenuBase.PopulateContextMenuProps: CreateRibbonMenu() returned null instead of RibbonMenu instance")};a.prototype.QZ=function(){c.ULS.sendTraceTag(537167104,0,10,"ContextMenuBase.CreateRibbonMenu: This method should not be called if the menu is not ready for React!");return null};a.prototype.w1=function(ba,ra,ka,da,ha){ba=Sys.UI.DomElement.getBounds(ra);ka=new Sys.UI.Point(ba.x,ba.y+ba.height);this.eVa(ka,ra);this.$.isChromeRtl&&(ka.x+=ba.width);
this.Qp(ka,ha)};a.prototype.Qp=function(ba,ra,ka){ka=void 0===ka?0:ka;ra&&(ba=aa.a(this.$).Gka(ba));ra=!0;if(this.F$h){var da;3===ka?(da=this.mLa(3))&&0<da.length?(ra=!1,this.showFloatie(da,new Sys.UI.Bounds(ba.x,ba.y,0,0),ka)):c.ULS.sendTraceTag(537167075,0,10,"ContextMenuBase.ShowAt: A context menu that implements floaties has returned null when generating the touch floatie groups. Context menu ID: {0}",this.menuId):2===ka&&this.$.isEditMode&&((da=this.mLa(2))&&0<da.length?da[0]!==a.lYe?(ra=!1,
this.RUd(da,new Sys.UI.Bounds(ba.x,ba.y,0,0),ka)):c.ULS.sendTraceTag(537167074,0,50,"ContextMenuBase.ShowAt: The context menu does not support floatie. Context menu ID: {0}",this.menuId):c.ULS.sendTraceTag(537167073,0,10,"ContextMenuBase.ShowAt: A context menu that implements floaties has returned null when generating the mouse floatie groups. Context menu ID: {0}",this.menuId))}ra&&this.showContextMenu(new Sys.UI.Bounds(ba.x,ba.y,0,0),ka)};a.prototype.mLa=function(){return null};a.prototype.ujd=
function(ba,ra){var ka="";3===ba?ka="touch":2===ba&&(ka="mouse");ba={};return ba.ContextMenuId=this.menuId,ba.IsEditMode=this.$.isEditMode,ba.IsSLR=!!Q.a.vg&&Q.a.vg.dL,ba.IsReactMLR=!!Q.a.vg&&Q.a.vg.DW,ba.IsNov=this.$.ea.isNamedObjectViewMode,ba.InputType=ka,ba.FloatieGroups=JSON.stringify(void 0===ra?null:ra),ba};a.prototype.showContextMenu=function(ba,ra){ra=void 0===ra?0:ra;var ka=this.ujd(ra);c.ULS.sendTraceTag(595359709,0,50,"ContextMenuBase.ShowContextMenu: rendering a context menu with given arguments: {0}",
JSON.stringify(ka));this.contextMenuController?this.TB!==E.a.QJd&&this.TB!==E.a.RJd||0===ra?this.contextMenuController.QUd(this.TB,ba,H.a.$b):this.contextMenuController.QUd(this.TB,ba,ra):c.ULS.sendTraceTag(537167072,0,10,"ContextMenuBase.ShowContextMenu: the context menu controller is null when attempintg to show context menu.")};a.prototype.showFloatie=function(ba,ra,ka){var da=this.ujd(ka,ba);c.ULS.sendTraceTag(595359710,0,50,"ContextMenuBase.ShowFloatie: rendering a floatie with given arguments: {0}",
JSON.stringify(da));this.contextMenuController?(Z.EwaSettings.isChangeGateEnabled("OfficeVSO:5381730_FloatieDismissal_OnKeyDown_JsCrashFix")&&this.jSf(),this.contextMenuController.Szc(ba,ra,ka)):c.ULS.sendTraceTag(537167071,0,10,"ContextMenuBase.ShowFloatie: the context menu controller is null when attempting to show the floatie with floatieGroups {0}.",JSON.stringify(ba))};a.prototype.RUd=function(ba,ra,ka){var da=this.ujd(ka,ba);c.ULS.sendTraceTag(537167070,0,50,"ContextMenuBase.ShowContextMenuWithFloatie: rendering a floatie with given arguments: {0}",
JSON.stringify(da));this.contextMenuController?(Z.EwaSettings.isChangeGateEnabled("OfficeVSO:5381730_FloatieDismissal_OnKeyDown_JsCrashFix")&&this.jSf(),this.contextMenuController.PUd(ba,ra,ka,this.TB)):c.ULS.sendTraceTag(587335491,0,10,"ContextMenuBase.ShowContextMenuWithFloatie: the context menu controller is null when attempintg to show floatie with ContextMenu.")};a.prototype.dSf=function(ba){this.contextMenuController=ba};a.prototype.dispose=function(){this.$&&this.$.Ka.ucb(this);this.wb=null;
Z.EwaSettings.isChangeGateEnabled("OfficeVSO:5381730_FloatieDismissal_OnKeyDown_JsCrashFix")&&this.Lfg();this.uwc&&(l.a.Fa(this.uwc),this.uwc=null);ia.prototype.dispose.call(this)};a.prototype.ILh=function(ba){var ra=this.$.da.Aa(204);ra&&(ra=ra.pMh(this.buf))&&Array.add(ba.Dc,ra)};a.prototype.eVa=function(ba,ra){ba&&ra&&this.$.ea.pc.isDivSyndicated&&m.a.uf&&(ra=ra.ownerDocument.documentElement,ba.x-=ra.scrollLeft,ba.y-=ra.scrollTop)};a.prototype.qe=function(ba){return(new O.a(this.$.xa)).qe(ba)};
a.prototype.qcf=function(ba){ba=Cl(ba.Dc);for(var ra=ba.next();!ra.done;ra=ba.next())if(ra=ra.value,Object(v.a)(686,ra)){ra.title&&(ra.title=a.Il(ra.title));ra=Cl(ra.buttons);for(var ka=ra.next();!ka.done;ka=ra.next())ka=ka.value,Object(v.a)(642,ka)?(ka.label=a.Il(ka.label),ka.hT(a.Il(ka.alt))):Object(v.a)(691,ka)&&this.qcf(ka.menu)}};a.prototype.Ytf=function(ba,ra){ra=void 0===ra?!1:ra;var ka=[];ba=Cl(ba);for(var da=ba.next();!da.done;da=ba.next())ka.push(this.nV(da.value,ra));return ka};a.prototype.nV=
function(ba){for(var ra=[],ka=Cl(ba.MenuItems),da=ka.next();!da.done;da=ka.next())switch(da=da.value,da.Type){case 3:Array.add(ra,this.i9g(da));break;case 2:Array.add(ra,this.Sdh(da));break;case 1:Array.add(ra,this.K$g(da))}return Object.assign(new n.a,{ControlList:ra,Title:ba.Title,DisplayMode:"Menu16",MenuSectionTitleFocusable:!0,ShowMenuSectionTitleBackground:!0,ShowMenuSectionTitleIcon:!0})};a.prototype.Ifd=function(ba,ra){ra=[this.Ytb,ba.RibbonCommand.toString(),ra?this.b3e(ra):this.b3e(ba.Label),
ba.Disabled?ba.Disabled.toString():"False"];var ka=ba.CommandData;ka=I.a.hashCode(ka).toString();ra.push(ka,ba.Identifier.toString());ra=ra.join("_");ba.IsChecked&&(ra+="_Checked");return ra};a.prototype.qMh=function(ba){var ra=[this.Ytb,I.a.hashCode(ba.Title).toString()];ba=Cl(ba.MenuItems);for(var ka=ba.next();!ka.done;ka=ba.next())ra.push(ka.value.RibbonCommand.toString());return ra.join("_")};a.prototype.b_e=function(ba){var ra=ba.Label;ra=I.a.hashCode(ra).toString();ra=[this.Ytb,ra];Z.EwaSettings.isChangeGateEnabled("OfficeVSO:5139850_FixPivotFilterMenuDuplicatingIdenticalFields")&&
ba.Id&&ra.push(I.a.hashCode(ba.Id).toString());ra=ra.join("_");ba.IsChecked&&(ra+="_Checked");return ra};a.prototype.i9g=function(ba){var ra=this.Mbc(ba,!1);var ka=ra.label;var da=ra.CMa;ra=ra.Lp;var ha=this.Ifd(ba,ka);return Object.assign(new h.a,{Command:ba.Disabled?(-251203935).toString():ra.toString(),ExternalId:ha,Id:ha,Image16by16Class:da,LabelText:ka||ba.Label,MenuItemId:ba.CommandData,CommandValueId:ba.CommandData})};a.prototype.Sdh=function(ba){var ra=this.Mbc(ba,ba.IsChecked);var ka=ra.label;
var da=ra.CMa;ra=ra.Lp;var ha=this.Ifd(ba,ka);return Object.assign(new u.a,{Command:ba.Disabled?(-251203935).toString():ra.toString(),ExternalId:ha,Id:ha,Image16by16Class:da,LabelText:ka||ba.Label,MenuItemId:ba.CommandData,CommandValueId:ba.CommandData,IsChecked:ba.IsChecked})};a.prototype.K$g=function(ba){var ra=this.l_e(ba);var ka=ra.label;ra=ra.CMa;var da=Object.assign(new e.a,{MenuSectionList:[],UpdateDynamically:!0});Array.addRange(da.MenuSectionList,this.Ytf(ba.SubMenu.Sections,!0));var ha=
this.b_e(ba);ba=ka||ba.Label;return Object.assign(new w.a,{ExternalId:ha,Id:ha,LabelText:ba,PopulateOnlyOnce:!1,Menu:da,Image16by16Class:ra,ImageIsVisible:!!ra})};a.prototype.l_e=function(ba){ba=this.Mbc(ba,!0);return{label:ba.label,CMa:ba.CMa,Lp:ba.Lp}};a.prototype.Mbc=function(ba,ra){switch(ba.Identifier){case 26:var ka=912804500;ra=t.a.mUe;ba=P.a.instance.fa(1899);break;case 3:ka=-1902148570;ra=ra?t.a.$aa:null;ba=P.a.instance.fa(1859);break;case 4:ka=-1902148570;ra=ra?t.a.$aa:null;ba=P.a.instance.fa(1860);
break;case 5:ka=-1902148570;ra=ra?t.a.$aa:null;ba=null;break;case 1:ka=-1677817820;ra=t.a.w$b;ba=P.a.instance.fa(231);break;case 2:ka=-1649376918;ra=ba.IsChecked?t.a.Ava:null;ba=P.a.instance.fa(2062);break;case 23:ka=1701016594;ra=ba.IsChecked?t.a.Ava:null;ba=P.a.instance.fa(2062);break;case 6:ka=-87741481;ra=null;ba=P.a.instance.fa(2063);break;case 7:ka=1948650742;ra=t.a.aTe;ba=P.a.instance.fa(1897);break;case 8:ka=1933713114;ra=t.a.$Se;ba=P.a.instance.fa(1898);break;case 14:ka=504133448;ra=t.a.eKa;
ba=P.a.instance.fa(144);break;case 30:ka=504133448;ra=t.a.eKa;ba=P.a.instance.fa(148);break;case 32:ka=504133448;ra=t.a.eKa;ba=P.a.instance.fa(150);break;case 34:ka=504133448;ra=t.a.eKa;ba=P.a.instance.fa(152);break;case 27:ka=1701016594;ra=ra?t.a.y$b:t.a.eKa;ba=P.a.instance.fa(144);break;case 15:ka=-798968736;ra=t.a.fKa;ba=P.a.instance.fa(146);break;case 31:ka=-798968736;ra=t.a.fKa;ba=P.a.instance.fa(149);break;case 33:ka=-798968736;ra=t.a.fKa;ba=P.a.instance.fa(151);break;case 35:ka=-798968736;
ra=t.a.fKa;ba=P.a.instance.fa(153);break;case 28:ka=1701016594;ra=ra?t.a.z$b:t.a.fKa;ba=P.a.instance.fa(146);break;case 21:ka=-2058042992;ra=t.a.I3a;ba=null;break;case 29:ka=1701016594;ra=t.a.I3a;ba=null;break;case 9:ka=1701016594;ba=ra=null;break;case 11:ka=-1494291901;ba=ra=null;break;case 25:ka=-1045020714;ra=ba.IsChecked?t.a.Ava:null;ba=null;break;case 13:ka=1701016594;ra=ba.IsChecked?t.a.Ava:null;ba=P.a.instance.fa(155);break;case 16:ka=1701016594;ra=t.a.dKa;ba=P.a.instance.fa(1035);break;case 17:ka=
1701016594;ra=t.a.yva;ba=null;break;case 18:ka=1701016594;ra=t.a.xva;ba=null;break;case 19:ka=1701016594;ra=t.a.H3a;ba=P.a.instance.fa(1040);break;case 20:ka=1701016594;ra=t.a.sbd;ba=P.a.instance.fa(1041);break;case 24:ka=1675506831;ba=ra=null;break;case 22:ka=ba.RibbonCommand;ra=ba.IsChecked?t.a.$aa:null;ba=null;break;case 36:ka=1461300262;ra=null;ba=P.a.instance.fa(154);break;default:c.ULS.shipAssertTag(537167069,0,!1,"Unable to map menu item: {0}",JSON.stringify(ba)),ka=1461300262,ba=ra=null}return{label:ba,
CMa:ra,Lp:ka}};a.prototype.b3e=function(ba){return Z.EwaSettings.isChangeGateEnabled("OfficeVSO:6130289_FixLoggingColumnNameInButtonId")?I.a.hashCode(ba+S.HelperMethods.Mtj).toString():ba};a.prototype.lGg=function(ba){if(!this.$.ea.amIAlone){var ra=this.$.da.Aa(25);if((void 0!==ra&&null!==ra||!Z.EwaSettings.isChangeGateEnabled("OfficeVSO:5280339_GuardPresenceView"))&&!r.a.isEmpty(ra.SCa)&&(ra=ra.G5h(),!B.a.Qh(ra))){var ka=[];y.a.instance.resolve("Common.App.UI.IPresenceContextMenuSectionBuilder").ich(ra,
ka);Array.addRange(ba.MenuSectionList,ka)}}};a.prototype.jSf=function(){this.Erd||(this.dwb&&this.dwb.a0b(this.XC),this.wrb&&this.wrb.a0b(this.XC),this.Erd=!!this.dwb||!!this.wrb)};a.prototype.Lfg=function(){this.dwb&&this.dwb.avc(this.XC);this.wrb&&this.wrb.avc(this.XC);this.Erd=!1};a.Kqd=function(ba,ra){ra=U.C(ra);ba=J.g(ba).Da.s5a(ra);return!(null===ba||void 0===ba||!ba.Vj)};a.Pgd=function(ba,ra,ka){ra=U.C(ra);var da=J.g(ba).Da.s5a(ra);ra=J.g(ba).getCellBounds(da);var ha=da.aRg;da=da.$Qg;var qa=
ra.x+ha.x;ra=ra.y+ha.y;ka&&Z.EwaSettings.isChangeGateEnabled("OfficeVSO:5554367_NewAutoFilterUXEnabled")&&(J.g(ba).rtl||(qa+=da),ra-=da);return new Sys.UI.Point(qa,ra)};a.oDh=function(ba){try{Object(A.a)(ba.CommandValueId)}catch(ra){}};a.Il=function(ba){var ra=a.$ua.parseFromString(ba,"text/html");return ra?ra.body.innerText:(c.ULS.sendTraceTag(537167066,0,15,"Not able to decode htmlFormattedText"),ba)};uk.Object.defineProperties(a.prototype,{contextMenuRoot:{configurable:!0,enumerable:!0,get:function(){return this.uwc}},
$:{configurable:!0,enumerable:!0,get:function(){return this.wb}},Ta:{configurable:!0,enumerable:!0,get:function(){return this.vSc}},menuId:{configurable:!0,enumerable:!0,get:function(){return this.$.Lb+this.buf}},dwb:{configurable:!0,enumerable:!0,get:function(){this.nLc||(this.nLc=ea.a(this.$));return this.nLc}},wrb:{configurable:!0,enumerable:!0,get:function(){this.xIc||(this.xIc=J.g(this.$).zc);return this.xIc}}});a.$ua=new DOMParser;a.lYe="Unsupported";Object(z.a)(a,"ContextMenuBase",F.a,[434,
789,3])},984:function(z,F,b){function a(){}b.d(F,"a",function(){return a});z=b(0);a.sQe="ewa-ac";a.arh="ewa-ac-param";a.CRe="ewa-function-help-link";a.hbd="ewa-lb";a.fRe="ewa-fb-refactor";a.listItem="list-item";a.dDb="list-item-selected";a.jDb="list-table-touch";a.iDb="list-table";a.kyh="ewa-suggested-cell-name";a.o3g="columnName-header";a.ASe="ewa-tt";a.$uh="ewa-function-link-container";a.DRe="ewa-function-udf-name";a.rtl="rtl";Object(z.a)(a,"CssClassNames",null,[])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.kpae.js.map/6e45402361d034e194d4c530a62661c8/EwaDS.kpae.js.map