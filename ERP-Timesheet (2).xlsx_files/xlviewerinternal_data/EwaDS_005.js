(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[28],{1333:function(z,F,b){function a(){var y=B.call(this)||this;y.NFi=3E4;y.Zfb={};y.e2d={};y.zxe={};y.$jf=!1;y.$jf=m.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PublishToAsha",!1);m.EwaSettings.isChangeGateEnabled("OfficeVSO:6185276_TrackFidelitySessions")&&l.Health.instance.addQosPillar("Fidelity");return y}function c(y){var v=w.call(this)||this;v.$=y;v.Xb();return v}b.r(F);z=b(0);var e=b(13),l=b(99),m=b(1),n=
b(75),h=b(8),u=b(224),w=u.a;Am(c,w);c.prototype.create=function(){var y=b(1333).RenderingFidelityTracker,v=this.$.da.Aa(462);v||(v=this.$.da.Ha(462,new y));this.Eb(v)};Object(z.a)(c,"RenderingFidelityTrackerFactory",u.a,[]);var r=b(44);b.d(F,"RenderingFidelityTracker",function(){return a});var B=n.a;Am(a,B);a.ka=function(y){y.da.Ha(463,new c(y))};a.prototype.oNg=function(y,v,A,t){var E=this;if(!(r.PageLoadTrackingInfo.instance.Hka(new Date)<this.NFi)){var C=h.HelperMethods.Wca(function(){for(var H=
gridRenderer.CanvasRendererGlobals.analyzeLowRenderingFidelity(v),U=Object.keys(H),Q=E.zxe[y],O=0;O<U.length;O++){var ea=U[O];E.e2d[ea]||(null===Q||void 0===Q?0:Q[ea])&&E.Zfb[ea]&&(E.Zfb[ea]-=Q[ea])}E.zxe[y]=H;for(O=0;O<U.length;O++)if(Q=U[O],!E.e2d[Q])if(ea=H[Q],E.Zfb[Q]&&(ea+=E.Zfb[Q]),gridRenderer.CanvasRendererGlobals.hasRenderingFidelityThresholdExceeded(Q,ea)){E.e2d[Q]=!0;E.$jf&&(H=gridRenderer.CanvasRendererGlobals.getErrorTypeForRenderingFidelityProblem(Q),U=gridRenderer.CanvasRendererGlobals.getVetoForRenderingFidelityProblem(Q),
H&&U&&l.Health.instance.recordQosError(H,[U],!1,!0,!0,!1,null));e.ULS.sendTraceTag(527472324,0,50,"Session Vetoed because of : { key:"+Q+", isHC:"+A+", scaleFactor:"+t+"}");break}else E.Zfb[Q]=ea});1<C&&e.ULS.sendTraceTag(527472323,1,50,"RenderingFidelityTracker.AnalyzeModelForLowFidelity: Duration for AnalyzeModelForLowFidelity the model, duration={0}",C)}};Object(z.a)(a,"RenderingFidelityTracker",n.a,[877,3])},1446:function(z,F,b){function a(Ka){var sa=this;this.I$a=function(){sa.OKf(sa.nYe)};this.Qg=
function(){sa.OKf(sa.xSg)};this.$=Ka;this.xSg=new af.a;this.nYe=new af.a;Pf.g(this.$).Da.aq(this.Qg);Pf.g(this.$).Da.Iqe(this.I$a)}function c(Ka,sa,wb){this.e0j=Ka;this.TV=sa;this.name=wb}function e(Ka,sa,wb,Nd,ee,yf,sg){sa=void 0===sa?null:sa;wb=void 0===wb?null:wb;Nd=void 0===Nd?null:Nd;ee=void 0===ee?null:ee;yf=void 0===yf?!1:yf;sg=void 0===sg?null:sg;var bg=Bf.call(this)||this;bg.iDh=[Na.a.Oxe,Na.a.qQe,Na.a.rQe,Na.a.Sgc,Na.a.Vlc,Na.a.qpf,Na.a.renderCachedContent,Na.a.renderServerContent,Na.a.H6b,
Na.a.UZf,Na.a.VZf,Na.a.WZf,Na.a.ktj];bg.ple=null;bg.wYa=null;bg.Ywe=null;bg.hee=null;bg.Ugb=null;bg.ZPb=null;bg.ZDa=null;bg.Umb=null;bg.Mxe=!1;bg.JKf=!1;bg.jkg=null;bg.UNd=null;bg.ijg=null;bg.fjg=null;bg.gjg=null;bg.UFf=function(Yf,xg){for(Yf=0;Yf<xg.entries.length;Yf++){var oe=xg.entries[Yf];oe.url=ae.a.removeParameter(oe.url,we.AFrameworkApplication.sQ);var Gh=ae.a.Xda(oe.url);!Wd.EwaSettings.ma(503)&&bg.Rqi(oe.url,Gh)&&(oe.behavior=1);if("img"===oe.Ju.initiatorType&&Gh.endsWith(Tg.a.KNe)){var rh=
ae.a.m5(oe.url,Tg.a.n$c),Ph=ae.a.m5(oe.url,Tg.a.o$c);oe.Iaa=oe.Iaa+"imageID="+rh+", imgStateID="+Ph}rh=oe.Ju[Na.a.transferSize];Ph=void 0;void 0!==rh&&null!==rh&&(Ph=0===rh);Md.PageLoadTrackingInfo.instance.xGg(Gh,Math.round(oe.Ju.fetchStart),Math.round(oe.Ju.responseEnd),Ph,bg.msi);Je.a.contains(Gh,Na.a.richTextEditor,!0)&&(Gh=$h.TextEditorTelemetry.instance,Gh.QE(Na.a.Amj,Math.round(oe.Ju.fetchStart)),Gh.QE(Na.a.Cmj,Math.round(oe.Ju.responseEnd)))}};bg.bX=function(){var Yf=bg.w8,xg;for(xg in Yf)Yf[xg].h=
!0};bg.Z8=function(Yf,xg){xg&&bg.Je&&xg.cHa.IsWindowHidden!=bg.Je.Hi&&(je.ULS.sendTraceTag(524166240,0,15,"TelemetryManager: document visibility inconsistency, forcing an update. Hidden state: Observer:{0}, Document:{1}",bg.Je.Hi,xg.cHa.IsWindowHidden),bg.Je.vJh())};bg.userSessionId=Ka;bg.V1a=sa=sa||new Dg.a;bg.wh=wb||sf.a.Ra;bg.vLj=Nd||bg;bg.Je=ee;bg.msi=yf;bg.pKe=sa.T9a();bg.na=sg;bg.Je&&bg.Je.IGa(bg.bX);Wd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FixDocumentVisibilityObserverState",
!1)&&bg.na&&bg.na.D$(bg.Z8);return bg}function l(){}function m(){}function n(){}function h(){}function u(){}function w(){}function r(Ka,sa){this.yPd=void 0===sa?1:sa;this.total=Ka}function B(){var Ka=Ah.call(this)||this;Ka.aIi=0;Ka.operation="DOMUpdate";Ka.target=null;Ka.sender=null;return Ka}function y(Ka,sa){function wb(yf,sg){null!=sg&&(Nd[yf]=sg)}var Nd={},ee=null;switch(Ka){case 0:ee="Actions";wb("Id",sa.a);wb("Operation",null==sa.b?null:sa.b);wb("Target",sa.c);wb("StartTime",null==sa.d?null:
sa.d.toString());wb("Duration",null==sa.e?null:sa.e.toString());wb("CorrelationId",sa.f);wb("ParentAction",sa.g);wb("DocumentHidden",null==sa.h?null:sa.h.toString());break;case 1:ee="CorrelationStart";wb("CorrelationId",sa.a);wb("UserSessionId",sa.b);wb("UserAction",sa.c);break;case 2:ee="ReorderSheetOp";wb("UserSessionId",sa.a);wb("IsDragReorder",null==sa.b?null:sa.b.toString());wb("DocumentUp",null==sa.c?null:sa.c.toString());wb("OldIndex",null==sa.d?null:sa.d.toString());wb("NewIndex",null==sa.e?
null:sa.e.toString());wb("TotalSheets",null==sa.f?null:sa.f.toString());break;case 3:ee="FormatCellOp";wb("UserSessionId",sa.a);wb("TaskId",null==sa.b?null:sa.b.toString());wb("NumberOfRanges",null==sa.c?null:sa.c.toString());wb("Ranges",sa.d);wb("ActiveCell",sa.e);wb("ActionId",null==sa.f?null:sa.f.toString());wb("CommandParameters",sa.g);wb("UserActionStopwatchId",sa.h);break;case 4:ee="CopyOp";wb("UserSessionId",sa.a);wb("IsChrome",null==sa.b?null:sa.b.toString());wb("IsIE",null==sa.c?null:sa.c.toString());
wb("IsFromUI",null==sa.d?null:sa.d.toString());wb("IsCopyInLoadedRange",null==sa.e?null:sa.e.toString());wb("IsRepeatedCopy",null==sa.f?null:sa.f.toString());wb("IsClipboarAccessSupported",null==sa.g?null:sa.g.toString());wb("IsClipboarAccessInstallationSupported",null==sa.h?null:sa.h.toString());wb("RibbonCommand",null==sa.i?null:sa.i.toString());wb("CutCopyPasteFlags",null==sa.j?null:sa.j.toString());wb("IsDrag",null==sa.k?null:sa.k.toString());wb("IsIeBeforeAlowDenyPopUp",null==sa.l?null:sa.l.toString());
wb("IsPasteMatchCopy",sa.m);wb("WaitMessageInClipboard",sa.n);wb("CallCount",null==sa.o?null:sa.o.toString());break;case 5:ee="PasteOp";wb("UserSessionId",sa.a);wb("IsChrome",null==sa.b?null:sa.b.toString());wb("IsIE",null==sa.c?null:sa.c.toString());wb("IsCopyActive",null==sa.d?null:sa.d.toString());wb("IsFromUI",null==sa.e?null:sa.e.toString());wb("IsClipboarAccessSupported",null==sa.f?null:sa.f.toString());wb("IsClipboarAccessInstallationSupported",null==sa.g?null:sa.g.toString());wb("RibbonCommand",
null==sa.h?null:sa.h.toString());wb("CutCopyPasteFlags",null==sa.i?null:sa.i.toString());wb("WaitMessageInClipboard",sa.j);wb("PopupDialog",sa.k);wb("SimplePopupMessage",sa.l);wb("DialogCloseButton",sa.m);wb("UserPressedInstallLink",sa.n);wb("CallCount",null==sa.o?null:sa.o.toString());break;case 6:ee="GetNumberViewModelDataOp";wb("UserSessionId",sa.a);wb("NumberFormatOptionsPreviousOutputJson",sa.b);wb("NumberFormatOptionsNewInputJson",sa.c);break;case 7:ee="InstantaneousSetData";wb("Id",sa.a);wb("WasEmpty",
null==sa.b?null:sa.b.toString());wb("ValueNotChanged",null==sa.c?null:sa.c.toString());wb("Source",sa.d);wb("ProcessingCompleted",null==sa.e?null:sa.e.toString());break;case 8:ee="ImmediateSetData";wb("ClientStopwatchId",sa.a);wb("Operation",sa.b);wb("Parameters",sa.c);wb("WasUpdatedByImmediate",null==sa.d?null:sa.d.toString());wb("areHtmlElementsEqualClientComparison",null==sa.e?null:sa.e.toString());wb("WasDecisionMadeByHtmlComparison",null==sa.f?null:sa.f.toString());wb("IsNumeric",null==sa.g?
null:sa.g.toString());wb("IsDateTime",null==sa.h?null:sa.h.toString());wb("HasCurrencySymbol",null==sa.i?null:sa.i.toString());wb("HasPercentSymbol",null==sa.j?null:sa.j.toString());wb("IsFunc",null==sa.k?null:sa.k.toString());wb("DiffInWrappingWhitespace",null==sa.l?null:sa.l.toString());wb("ImmediatePattern",sa.m);wb("TextAlignmentMatch",null==sa.n?null:sa.n.toString());wb("FontColorMatch",null==sa.o?null:sa.o.toString());wb("FormulaTextMatch",null==sa.p?null:sa.p.toString());wb("isFormula",null==
sa.q?null:sa.q.toString());wb("FormulaText",sa.r);wb("InstantaneousPattern",sa.s);wb("AreHtmlInnerTextElementsEqualClientComparison",null==sa.t?null:sa.t.toString());wb("HtmlComparisonDecision",sa.u);break;case 9:ee="DependentCellsCalc";wb("CalcStatus",sa.a);wb("SuccessfullyCalculatedRanges",null==sa.b?null:sa.b.toString());wb("RangesSkipped",null==sa.c?null:sa.c.toString());wb("TotalErrors",null==sa.d?null:sa.d.toString());wb("Partial",null==sa.e?null:sa.e.toString());wb("Canceled",null==sa.f?null:
sa.f.toString());wb("Aggregate",null==sa.g?null:sa.g.toString());wb("Unknown",null==sa.h?null:sa.h.toString());wb("UnavailableData",null==sa.i?null:sa.i.toString());wb("Cycle",null==sa.j?null:sa.j.toString());wb("NotImplemented",null==sa.k?null:sa.k.toString());wb("InvalidInput",null==sa.l?null:sa.l.toString());wb("AreDepCells",null==sa.m?null:sa.m.toString());break;case 10:ee="DependentCellsGraphStat";wb("ParsedFormulas",null==sa.a?null:sa.a.toString());wb("GraphNodes",null==sa.b?null:sa.b.toString());
wb("GraphArcs",null==sa.c?null:sa.c.toString());wb("AnalyzedBlocks",null==sa.d?null:sa.d.toString());wb("IterationId",null==sa.e?null:sa.e.toString());wb("UniqueId",sa.f);wb("Aborted",null==sa.g?null:sa.g.toString());break;case 11:ee="DependentCellsGraphSectionStat";wb("IterationId",null==sa.a?null:sa.a.toString());wb("BlockHash",sa.b);wb("Functions",sa.c);wb("Operators",sa.d);wb("CrossDocRefs",null==sa.e?null:sa.e.toString());wb("CrossSheetRefs",null==sa.f?null:sa.f.toString());wb("ErrRefs",null==
sa.g?null:sa.g.toString());wb("LargeRanges",null==sa.h?null:sa.h.toString());wb("NameRefs",null==sa.i?null:sa.i.toString());wb("ParserErrors",null==sa.j?null:sa.j.toString());wb("RowRefs",null==sa.k?null:sa.k.toString());wb("ColumnRefs",null==sa.l?null:sa.l.toString());wb("TableRefs",null==sa.m?null:sa.m.toString());wb("UniqueId",sa.n);wb("UnreachableReferences",null==sa.o?null:sa.o.toString());break;case 12:ee="GetRangeContentPrefetchFailures";wb("UserSessionId",sa.a);wb("ClientStopwatchId",sa.b);
wb("StateId",null==sa.c?null:sa.c.toString());break;case 13:ee="GridBlockUpdates";wb("UserSessionId",sa.a);wb("CorrelationId",sa.b);wb("Operation",sa.c);wb("PerformanceType",null==sa.d?null:sa.d.toString());wb("BlockHash",sa.e);wb("DurationInMs",null==sa.f?null:sa.f.toString());break;case 14:ee="BrowserAppStart";wb("ScriptExecutionStart",null==sa.a?null:ph.a.kua(sa.a.getTime()));wb("UserSessionId",sa.b);wb("ClockMechanism",sa.c);wb("ScreenDPI",null==sa.d?null:sa.d.toString());wb("NavigationToScriptExecutionDelta",
null==sa.e?null:sa.e.toString());break;case 15:ee="LinkedObjects";wb("ChildId",sa.a);wb("ParentId",sa.b);wb("ChildTable",sa.c);wb("ParentTable",sa.d);break;case 16:ee="LongFrames";wb("StartTime",null==sa.a?null:ph.a.kua(sa.a.getTime()));wb("DurationInMs",null==sa.b?null:sa.b.toString());break;case 17:ee="Task";wb("StopwatchId",sa.a);wb("Status",null==sa.b?null:sa.b.toString());wb("CreateTime",null==sa.c?null:sa.c.toString());wb("TaskId",null==sa.d?null:sa.d.toString());break;case 18:ee="ConflictInEditing";
wb("OtherUserState",sa.a);wb("UserSessionId",sa.b);wb("ConflictTime",null==sa.c?null:ph.a.kua(sa.c.getTime()));break;case 19:ee="IncomingPresenceData";wb("UserSessionId",sa.a);wb("UserId",sa.b);wb("Disconnected",null==sa.c?null:sa.c.toString());wb("ReceivedTime",null==sa.d?null:ph.a.kua(sa.d.getTime()));break;case 20:ee="EditorTableDelay";wb("UserSessionId",sa.a);wb("UserId",sa.b);wb("Received",null==sa.c?null:sa.c.toString());wb("DurationInMs",null==sa.d?null:sa.d.toString());wb("NotAloneAtLogTime",
null==sa.e?null:sa.e.toString());wb("Time",null==sa.f?null:ph.a.kua(sa.f.getTime()));break;case 21:ee="PresenceStartup";wb("UserSessionId",sa.a);wb("EverReceived",null==sa.b?null:sa.b.toString());wb("NotAloneOnOpen",null==sa.c?null:sa.c.toString());wb("NotAloneAtLogTime",null==sa.d?null:sa.d.toString());wb("EditorCount",null==sa.e?null:sa.e.toString());wb("WorkbookOpenToFirstReceivedInMs",null==sa.f?null:sa.f.toString());break;case 22:ee="PresenceDelete";wb("UserSessionId",sa.a);wb("UserId",sa.b);
wb("Context",sa.c);wb("Reason",sa.d);wb("Time",null==sa.e?null:ph.a.kua(sa.e.getTime()));break;case 23:ee="EditorEvent";wb("UserSessionId",sa.a);wb("UserId",sa.b);wb("Context",sa.c);wb("Time",null==sa.d?null:ph.a.kua(sa.d.getTime()));break;case 24:ee="EditorTime";wb("UserSessionId",sa.a);wb("UserId",sa.b);wb("DurationInMs",null==sa.c?null:sa.c.toString());break;case 25:ee="GridScreenReaderOps";wb("UserSessionId",sa.a);wb("CommandTaskId",sa.b);wb("CommandId",null==sa.c?null:sa.c.toString());wb("ClientSideOnly",
null==sa.d?null:sa.d.toString());wb("DurationInMS",null==sa.e?null:sa.e.toString());wb("ReachedMaxReadoutCells",null==sa.f?null:sa.f.toString());wb("RequstedCellCount",null==sa.g?null:sa.g.toString());wb("NonEmptyCellCount",null==sa.h?null:sa.h.toString());wb("Succeeded",null==sa.i?null:sa.i.toString());wb("Canceled",null==sa.j?null:sa.j.toString());wb("ErrorType",sa.k);break;case 26:ee="SendPresenceToService";wb("UserSessionId",sa.a);wb("TotalCount",null==sa.b?null:sa.b.toString());wb("SendCount",
null==sa.c?null:sa.c.toString());break;case 27:ee="IME";wb("UserSessionId",sa.a);break;case 28:ee="FreezePaneFloatingObjects";wb("UserSessionId",sa.a);wb("ObjectType",null==sa.b?null:sa.b.toString());wb("ObjectID",sa.c);wb("SpannedPanesCount",null==sa.d?null:sa.d.toString());break;case 29:ee="CustomizeStatusBar";wb("UserSessionId",sa.a);wb("UIControlName",sa.b);wb("IsControlVisible",null==sa.c?null:sa.c.toString());break;case 30:ee="ClientWebRequests";wb("Path",sa.a);wb("ProxyStopwatchId",sa.b);wb("RequestStatus",
sa.c);wb("ResponseSizeInBytes",null==sa.d?null:sa.d.toString());wb("ClientRequestId",sa.e);wb("StateId",null==sa.f?null:sa.f.toString());break;case 31:ee="ShowCommentTaskPane";wb("UserSessionId",sa.a);wb("IsFromKeyboardShortcut",null==sa.b?null:sa.b.toString());wb("IsShowPane",null==sa.c?null:sa.c.toString());wb("ShowForDeepLink",null==sa.d?null:sa.d.toString());wb("DeepLinkFound",null==sa.e?null:sa.e.toString());break;case 32:ee="ApplyThreadedCommentChange";wb("UserSessionId",sa.a);wb("Operation",
null==sa.b?null:sa.b.toString());wb("CommentId",sa.c);wb("CommentsCount",null==sa.d?null:sa.d.toString());break;case 33:ee="UpgradeLegacyCommentsChange";wb("UserSessionId",sa.a);wb("OperationSuccessful",null==sa.b?null:sa.b.toString());break;case 34:ee="FindNextOrPreviousComment";wb("UserSessionId",sa.a);wb("Succeeded",null==sa.b?null:sa.b.toString());break;case 35:ee="Goto";wb("UserSessionId",sa.a);wb("IsSucceeded",null==sa.b?null:sa.b.toString());wb("IsNOVMode",null==sa.c?null:sa.c.toString());
break;case 36:ee="LaunchOfficeAddInDialog";wb("UserSessionId",sa.a);wb("SourceId",sa.b);wb("SourceLabel",sa.c);wb("Flight",sa.d);wb("Experiment",sa.e);wb("UICultureTag",sa.f);wb("UICultureTagLcid",null==sa.g?null:sa.g.toString());wb("WacHostId",null==sa.h?null:sa.h.toString());break;case 37:ee="RichApiInvocation";wb("UserSessionId",sa.a);wb("Succeeded",null==sa.b?null:sa.b.toString());wb("ErrorType",sa.c);wb("ResultInfo",sa.d);wb("Source",sa.e);break;case 38:ee="FxLibrary";wb("EntityName",sa.a);wb("EntryPoint",
null==sa.b?null:sa.b.toString());wb("Action",null==sa.c?null:sa.c.toString());wb("InsertLocation",null==sa.d?null:sa.d.toString());break;case 39:ee="EmbeddedApiSession";wb("UserSessionId",sa.a);break;case 40:ee="NumberFormattingCalculator";wb("Id",sa.a);wb("CounterName",sa.b);wb("Values",sa.c);break;case 41:ee="RequestDataAfterSend";wb("ClientStopwatchId",sa.a);wb("RequestStatus",sa.b);wb("SendDuration",null==sa.c?null:sa.c.toString());wb("RequestId",null==sa.d?null:sa.d.toString());break;case 42:ee=
"FloatingObjectsStopwatchData";wb("StopMessage",sa.a);wb("Type",null==sa.b?null:sa.b.toString());wb("GUID",sa.c);wb("Pane",null==sa.d?null:sa.d.toString());wb("IsAboveGrid",null==sa.e?null:sa.e.toString());wb("StartCorrelation",sa.f);wb("LoadImageCorrelation",sa.g);wb("SkippedGetEffectsExtents",null==sa.h?null:sa.h.toString());wb("Version",null==sa.i?null:sa.i.toString());break;case 43:ee="Copy";wb("UserSessionId",sa.a);wb("Trigger",sa.b);wb("RibbonCommandName",sa.c);wb("SourceItem",sa.d);wb("SourceRangeCellCount",
null==sa.e?null:sa.e.toString());wb("ClientSideStopwatchId",sa.f);wb("CopyOperationId",sa.g);wb("IsAsync",null==sa.h?null:sa.h.toString());wb("IsFromCache",null==sa.i?null:sa.i.toString());wb("IsSuccessiveCopy",null==sa.j?null:sa.j.toString());wb("IsSelectionAllowed",null==sa.k?null:sa.k.toString());wb("IsSuccess",null==sa.l?null:sa.l.toString());wb("IsExpectedError",null==sa.m?null:sa.m.toString());wb("ExpectedErrorReason",sa.n);wb("ErrorMessage",sa.o);wb("ClientSideCopyTimeInMs",null==sa.p?null:
sa.p.toString());wb("TotalTimeInMs",null==sa.q?null:sa.q.toString());wb("PlainTextPayloadSize",null==sa.r?null:sa.r.toString());wb("CopyPasteTargetType",sa.s);wb("ShadowWorkbookPayloadSize",null==sa.t?null:sa.t.toString());wb("HtmlPayloadSize",null==sa.u?null:sa.u.toString());wb("HtmlSizeExceedsLimit",null==sa.v?null:sa.v.toString());wb("CopyTotalSizeExceedsLimit",null==sa.w?null:sa.w.toString());wb("ErrorReason",null==sa.x?null:sa.x.toString());wb("ErrorName",sa.y);wb("IsSucceededWithAlert",null==
sa.z?null:sa.z.toString());wb("EncounteredDeploymentErrors",null==sa.ba?null:sa.ba.toString());wb("ShadowWorkbookSizeExceedsLimit",null==sa.bb?null:sa.bb.toString());wb("CopyPasteTargetName",sa.bc);wb("CCPSliceName",sa.bd);wb("SyncClipboardItemsKeys",sa.be);wb("AsyncClipboardItemsKeys",sa.bf);wb("CopyPasteHandlerName",sa.bg);wb("SucceededPopulatingSystemClipboardSync",sa.bh);wb("SucceededPopulatingSystemClipboardAsync",sa.bi);wb("Location",sa.bj);wb("CopyContextId",sa.bk);wb("ServerRequestTimeInMs",
null==sa.bl?null:sa.bl.toString());wb("EcsOperationDuration",null==sa.bm?null:sa.bm.toString());wb("EcsRequestDuration",null==sa.bn?null:sa.bn.toString());wb("WfeRequestDuration",null==sa.bo?null:sa.bo.toString());wb("OriginalSourceRangesCountExceedsLimit",null==sa.bp?null:sa.bp.toString());wb("UploadToClipServiceAttempted",null==sa.bq?null:sa.bq.toString());wb("FloatingObjectType",null==sa.br?null:sa.br.toString());break;case 44:ee="Paste";wb("UserSessionId",sa.a);wb("Trigger",sa.b);wb("RibbonCommandName",
sa.c);wb("PasteTypeFlagValue",null==sa.d?null:sa.d.toString());wb("PasteOperationId",sa.e);wb("CopyOperationId",sa.f);wb("ClientSideStopwatchId",sa.g);wb("OriginalDestinationRange",sa.h);wb("ExpandDestinationRange",sa.i);wb("SourceItem",sa.j);wb("SourceRangeCellCount",null==sa.k?null:sa.k.toString());wb("IsSuccess",null==sa.l?null:sa.l.toString());wb("IsExpectedError",null==sa.m?null:sa.m.toString());wb("ClipboardFormatReadTimeInMs",sa.n);wb("ClipboardFormatReadStatus",sa.o);wb("ClipboardReadPermissionPromptShown",
null==sa.p?null:sa.p.toString());wb("AsyncApiReadTimedOut",null==sa.q?null:sa.q.toString());wb("ExpectedErrorReason",sa.r);wb("ErrorMessage",sa.s);wb("TotalTimeInMs",null==sa.t?null:sa.t.toString());wb("PlainTextPayloadSize",null==sa.u?null:sa.u.toString());wb("ShadowWorkbookPayloadSize",null==sa.v?null:sa.v.toString());wb("HtmlPayloadSize",null==sa.w?null:sa.w.toString());wb("CopyPasteTargetType",sa.x);wb("IsLastCopyWasExternal",null==sa.y?null:sa.y.toString());wb("IsClipboardDataContainShadowWorkbook",
null==sa.z?null:sa.z.toString());wb("IsShadowWorkbookParsedSuccessfully",null==sa.ba?null:sa.ba.toString());wb("ActiveSelectionType",sa.bb);wb("PasteResult",sa.bc);wb("ErrorReason",null==sa.bd?null:sa.bd.toString());wb("ErrorName",sa.be);wb("IsSucceededWithAlert",null==sa.bf?null:sa.bf.toString());wb("IsAfterCut",null==sa.bg?null:sa.bg.toString());wb("EncounteredDeploymentErrors",null==sa.bh?null:sa.bh.toString());wb("IsCrossSession",null==sa.bi?null:sa.bi.toString());wb("ShadowWorkbookSizeExceedsLimit",
null==sa.bj?null:sa.bj.toString());wb("ClipboardContainXLOPayload",null==sa.bk?null:sa.bk.toString());wb("CopyPasteTargetName",sa.bl);wb("ChromeExtensionId",sa.bm);wb("PayloadOrigin",sa.bn);wb("PayloadType",sa.bo);wb("CCPSliceName",sa.bp);wb("ClipboardItemsKeys",sa.bq);wb("CopyPasteHandlerName",sa.br);wb("IsSourceItemOriginSameSession",null==sa.bs?null:sa.bs.toString());wb("Location",sa.bt);wb("ExternalAppSource",sa.bu);wb("PasteContextId",sa.bv);wb("ServerRequestTimeInMs",null==sa.bw?null:sa.bw.toString());
wb("IndicationDisplayScheduled",null==sa.bx?null:sa.bx.toString());wb("PasteIndicationDisplayStatus",sa.by);wb("PasteRecoveryUIDisplayed",null==sa.bz?null:sa.bz.toString());wb("IsFromPasteRecoveryUI",null==sa.ca?null:sa.ca.toString());wb("EcsOperationDuration",null==sa.cb?null:sa.cb.toString());wb("EcsRequestDuration",null==sa.cc?null:sa.cc.toString());wb("WfeRequestDuration",null==sa.cd?null:sa.cd.toString());wb("OriginalSourceRangesCountExceedsLimit",null==sa.ce?null:sa.ce.toString());wb("PasteRecoveryUndoStopwatchId",
sa.cf);wb("PasteRecoveryUndoTimeInMs",null==sa.cg?null:sa.cg.toString());wb("PasteCSEPerformed",null==sa.ch?null:sa.ch.toString());wb("CSEStatus",null==sa.ci?null:sa.ci.toString());wb("IsFromEnterShortcut",null==sa.cj?null:sa.cj.toString());wb("pasteDestinationHasMergedCells",null==sa.ck?null:sa.ck.toString());break;case 45:ee="DragDrop";wb("UserSessionId",sa.a);wb("Trigger",sa.b);wb("RibbonCommandName",sa.c);wb("OperationId",sa.d);wb("ClientSideStopwatchId",sa.e);wb("SourceRange",sa.f);wb("DestinationRange",
sa.g);wb("CutCopyType",sa.h);wb("IsShiftKeyDown",null==sa.i?null:sa.i.toString());wb("IsDragInsert",null==sa.j?null:sa.j.toString());wb("IsSuccess",null==sa.k?null:sa.k.toString());wb("IsExpectedError",null==sa.l?null:sa.l.toString());wb("ExpectedErrorReason",sa.m);wb("ErrorMessage",sa.n);wb("TotalTimeInMs",null==sa.o?null:sa.o.toString());wb("ErrorName",sa.p);wb("IsSucceededWithAlert",null==sa.q?null:sa.q.toString());wb("CopyPasteTargetType",sa.r);wb("EncounteredDeploymentErrors",null==sa.s?null:
sa.s.toString());break;case 46:ee="ClearCopyState";wb("UserSessionId",sa.a);wb("ClientSideStopwatchId",sa.b);wb("Trigger",sa.c);wb("IsClearClipboard",null==sa.d?null:sa.d.toString());wb("IsExplicit",null==sa.e?null:sa.e.toString());wb("IsSuccess",null==sa.f?null:sa.f.toString());wb("ErrorMessage",sa.g);wb("ErrorName",sa.h);wb("TotalTimeInMs",null==sa.i?null:sa.i.toString());wb("CopyPasteTargetType",sa.j);break;case 47:ee="WebWorkerRecalcStats";wb("SuccessCount",null==sa.a?null:sa.a.toString());wb("FailureCount",
null==sa.b?null:sa.b.toString());wb("ValueTypeMismatchCount",null==sa.c?null:sa.c.toString());wb("CellValueMismatchCount",null==sa.d?null:sa.d.toString());wb("IfmtMismatchCount",null==sa.e?null:sa.e.toString());wb("FormattedTextMismatchCount",null==sa.f?null:sa.f.toString());wb("CellValueStringMismatchCount",null==sa.g?null:sa.g.toString());wb("CellValueNumberMismatchCount",null==sa.h?null:sa.h.toString());wb("CellValueBooleanMismatchCount",null==sa.i?null:sa.i.toString());wb("CellValueBlankMismatchCount",
null==sa.j?null:sa.j.toString());wb("CellValueErrorMismatchCount",null==sa.k?null:sa.k.toString());wb("FormattedTextStringMismatchCount",null==sa.l?null:sa.l.toString());wb("FormattedTextNumberMismatchCount",null==sa.m?null:sa.m.toString());wb("FormattedTextBooleanMismatchCount",null==sa.n?null:sa.n.toString());wb("FormattedTextBlankMismatchCount",null==sa.o?null:sa.o.toString());wb("FormattedTextErrorMismatchCount",null==sa.p?null:sa.p.toString());wb("StringMismatchCount",null==sa.q?null:sa.q.toString());
wb("NumericMismatchCount",null==sa.r?null:sa.r.toString());wb("ErrorMismatchCount",null==sa.s?null:sa.s.toString());wb("StringValuesCount",null==sa.t?null:sa.t.toString());wb("NumericValuesCount",null==sa.u?null:sa.u.toString());wb("BooleanValuesCount",null==sa.v?null:sa.v.toString());wb("BlankValuesCount",null==sa.w?null:sa.w.toString());wb("ErrorValuesCount",null==sa.x?null:sa.x.toString());wb("NumericValuesDiffAverage",null==sa.y?null:sa.y.toString());wb("NumericEvaluatedValuesMismatchSamples",
sa.z);wb("NumericFormattedTextMismatchSamples",sa.ba);wb("NumericMismatchSamples",sa.bb);wb("CellValueTypeMismatchSamples",sa.bc);wb("IfmtMismatchSamples",sa.bd);wb("BlockHashCode",sa.be);break;case 48:ee="DataValidationEditOpenDialog";wb("ServerCommand",sa.a);wb("SubDialogOpened",null==sa.b?null:sa.b.toString());wb("SubDialogButtonClicked",sa.c);wb("DialogOpened",null==sa.d?null:sa.d.toString());wb("RuleType",sa.e);wb("ConditionType",sa.f);wb("LowerBoundaryFilled",null==sa.g?null:sa.g.toString());
wb("UpperBoundaryFilled",null==sa.h?null:sa.h.toString());wb("IgnoreBlank",null==sa.i?null:sa.i.toString());wb("InCellDropdown",null==sa.j?null:sa.j.toString());wb("ShowInputMessage",null==sa.k?null:sa.k.toString());wb("InputTitleFilled",null==sa.l?null:sa.l.toString());wb("InputMessageFilled",null==sa.m?null:sa.m.toString());wb("ShowErrorAlert",null==sa.n?null:sa.n.toString());wb("AlertBlocking",null==sa.o?null:sa.o.toString());wb("AlertTitleFilled",null==sa.p?null:sa.p.toString());wb("AlertMessageFilled",
null==sa.q?null:sa.q.toString());wb("StopWatchId",sa.r);break;case 49:ee="DataValidationEditSubmitRule";wb("RuleType",sa.a);wb("ConditionType",sa.b);wb("LowerBoundaryFilled",null==sa.c?null:sa.c.toString());wb("UpperBoundaryFilled",null==sa.d?null:sa.d.toString());wb("IgnoreBlank",null==sa.e?null:sa.e.toString());wb("InCellDropdown",null==sa.f?null:sa.f.toString());wb("ShowInputMessage",null==sa.g?null:sa.g.toString());wb("InputTitleFilled",null==sa.h?null:sa.h.toString());wb("InputMessageFilled",
null==sa.i?null:sa.i.toString());wb("ShowErrorAlert",null==sa.j?null:sa.j.toString());wb("AlertBlocking",null==sa.k?null:sa.k.toString());wb("AlertTitleFilled",null==sa.l?null:sa.l.toString());wb("AlertMessageFilled",null==sa.m?null:sa.m.toString());wb("ClearAllPressed",null==sa.n?null:sa.n.toString());wb("ActionStatus",sa.o);wb("Error",sa.p);wb("StopWatchId",sa.q);break;case 50:ee="CustomSort";wb("RangeType",sa.a);wb("HasHeaders",null==sa.b?null:sa.b.toString());wb("SortTopToBottom",null==sa.c?null:
sa.c.toString());wb("ColumnCount",null==sa.d?null:sa.d.toString());wb("RowCount",null==sa.e?null:sa.e.toString());wb("RangeLimitExceeded",null==sa.f?null:sa.f.toString());wb("CaseSensitive",null==sa.g?null:sa.g.toString());wb("GetSortInfoDuration",null==sa.h?null:sa.h.toString());wb("LevelCount",null==sa.i?null:sa.i.toString());wb("SortOnValuesCount",null==sa.j?null:sa.j.toString());wb("SortOnCellColorCount",null==sa.k?null:sa.k.toString());wb("SortOnFontColorCount",null==sa.l?null:sa.l.toString());
wb("SortOnIconCount",null==sa.m?null:sa.m.toString());wb("CustomOrderCount",null==sa.n?null:sa.n.toString());wb("AvgCellColorCount",null==sa.o?null:sa.o.toString());wb("MaxCellColorCount",null==sa.p?null:sa.p.toString());wb("AvgFontColorCount",null==sa.q?null:sa.q.toString());wb("MaxFontColorCount",null==sa.r?null:sa.r.toString());wb("AvgIconsCount",null==sa.s?null:sa.s.toString());wb("MaxIconsCount",null==sa.t?null:sa.t.toString());wb("Executed",null==sa.u?null:sa.u.toString());break;case 51:ee=
"NamedSheetViewUserAction";wb("UserSessionId",sa.a);wb("UserActionName",sa.b);wb("UserActionSource",null==sa.c?null:sa.c.toString());wb("UserActionData",sa.d);wb("OtherData",sa.e);break;case 52:ee="NamedSheetViewTeachingCallout";wb("UserSessionId",sa.a);wb("TeachingCalloutSequence",null==sa.b?null:sa.b.toString());wb("TeachingCalloutIndex",null==sa.c?null:sa.c.toString());wb("UserActionName",null==sa.d?null:sa.d.toString());wb("UserActionData",sa.e);wb("DurationInMs",null==sa.f?null:sa.f.toString());
break;case 53:ee="NamedSheetViewTeachingDialog";wb("UserSessionId",sa.a);wb("UserActionName",sa.b);wb("ButtonClicked",sa.c);wb("DurationInMs",null==sa.d?null:sa.d.toString());wb("IsNewTeachingDialog",null==sa.e?null:sa.e.toString());break;case 54:ee="NamedSheetViewOptionsDialog";wb("UserSessionId",sa.a);wb("OptionsAction",null==sa.b?null:sa.b.toString());wb("OptionsActionData",sa.c);wb("OptionsOtherData",sa.d);wb("DurationInMs",null==sa.e?null:sa.e.toString());break;case 55:ee="NamedSheetViewTempViewApplyDialog";
wb("UserSessionId",sa.a);wb("TriggeredFrom",sa.b);wb("ButtonClicked",sa.c);wb("DurationInMs",null==sa.d?null:sa.d.toString());break;case 56:ee="NamedSheetViewTempViewSaveDialog";wb("UserSessionId",sa.a);wb("TriggeredFrom",sa.b);wb("ButtonClicked",sa.c);wb("NameUpdated",null==sa.d?null:sa.d.toString());wb("DurationInMs",null==sa.e?null:sa.e.toString());break;case 57:ee="TemporaryViewStartedDataRestore";wb("UserSessionId",sa.a);wb("CountOfTempViews",null==sa.b?null:sa.b.toString());break;case 58:ee=
"TemporaryViewFetchedVersion";wb("UserSessionId",sa.a);wb("NumberOfBytes",null==sa.b?null:sa.b.toString());break;case 59:ee="RaiseEventsAndGenerateBlockRequests";wb("ReturnContentStatus",null==sa.a?null:sa.a.toString());wb("CacheState",null==sa.b?null:sa.b.toString());wb("FromXhrCallback",null==sa.c?null:sa.c.toString());wb("AreGeneralErrorsPresent",null==sa.d?null:sa.d.toString());wb("BlockCacheItemHash",sa.e);wb("StopwatchId",sa.f);wb("BlockCacheItemProcessingStopwatchId",sa.g);wb("StateId",null==
sa.h?null:sa.h.toString());wb("IsHighPriority",null==sa.i?null:sa.i.toString());wb("CalcComplete",null==sa.j?null:sa.j.toString());wb("EditedCellsUpdatedByCse",null==sa.k?null:sa.k.toString());wb("DependentCellsUpdatedByCse",null==sa.l?null:sa.l.toString());wb("Revision",null==sa.m?null:sa.m.toString());wb("SheetProcessedDataVersion",null==sa.n?null:sa.n.toString());wb("RefCount",null==sa.o?null:sa.o.toString());wb("ExistsInView",null==sa.p?null:sa.p.toString());wb("ContentSource",null==sa.q?null:
sa.q.toString());break;case 60:ee="LaunchMakerCodeEditor",wb("SessionId",sa.a),wb("Command",sa.b),wb("IsPreviewGallery",null==sa.c?null:sa.c.toString()),wb("MenuItemId",sa.d),wb("ScriptId",sa.e),wb("ShareId",sa.f),wb("IsOwner",null==sa.g?null:sa.g.toString()),wb("PublishedScriptCount",null==sa.h?null:sa.h.toString()),wb("RecentScriptCount",null==sa.i?null:sa.i.toString()),wb("WorkbookScriptCount",null==sa.j?null:sa.j.toString())}Nd.Table=ee;return Sys.Serialization.JavaScriptSerializer.serialize(Nd)}
function v(){this.bra=new A}function A(){}function t(Ka){var sa=Nh.call(this)||this;sa.$=Ka;sa.Xb();return sa}function E(Ka){var sa=Sh.call(this)||this;sa.Dpb=-1;sa.Fvd=0;sa.Iya=new Date(0);sa.CZ=null;sa.jja={};sa.pva=new af.a;sa.j9a=!1;sa.LOd=!1;sa.w4a=null;sa.w$a=0;sa.fCc=0;sa.zMa=0;sa.isSynthetic=!1;sa.rZe=function(){var wb=new Date,Nd=wb.getMinutes(),ee=wb.getSeconds();sa.JCb&&wb.getTime()-sa.JCb.getTime()>sa.EOj?(sa.stop(),sa.jed(wb)):(Nd!==sa.Fvd&&(sa.jed(wb),sa.Fvd=Nd),sa.j9a&&(sa.Je.Hi?sa.CZ[ee]=
E.o8b:(sa.SLe(ee),sa.j9a=!1,sa.pva.clear(),sa.jja={})),sa.CZ[ee]!==E.o8b&&(sa.CZ[ee]++,Nd=wb.getTime()-sa.Iya.getTime(),Nd>sa.lrf&&sa.gAi(sa.Iya,Nd)),sa.Dpb=window.requestAnimationFrame(sa.rZe),sa.Iya=wb)};sa.bX=function(){sa.j9a=!0};sa.iyf=function(){sa.pause()};sa.kyf=function(){sa.LOd&&sa.resume()};sa.Qg=function(){sa.Da.iI()&&sa.NXj()};sa.JCb=new Date;sa.Je=new S;sa.Je.IGa(sa.bX);we.AFrameworkApplication.vXc(sa.iyf);we.AFrameworkApplication.wXc(sa.kyf);sa.$=Ka;sa.lrf=Ka.ya.LongFrameThresholdMs;
sa.IBi="MoreThan_"+sa.lrf.toString()+"_Ms";sa.DOj=Ka.ya.ThresholdToEndOperationTrackingSeconds;sa.EOj=Ka.ya.ThresholdToStopFPSTrackingMS;sa.Da=Pf.g(sa.$).Da;we.AFrameworkApplication.hc&&we.AFrameworkApplication.hc.IsSynthetic&&(sa.isSynthetic=Je.a.compare(we.AFrameworkApplication.hc[rf.a.isSynthetic],"True",!0)?!1:!0);sa.Da.aq(sa.Qg);sa.fOd();sa.hAi=sa.$.Jla&&Wd.EwaSettings.ma(604);return sa}function C(Ka,sa,wb,Nd,ee,yf,sg,bg,Yf,xg){this.Op=null;this.Min=this.Max=this.Avg=this.end=this.start=this.count=
0;this.LFrame=null;this.tfAppInt=this.coauth=this.longFrameCount=0;this.Props=null;this.Op=void 0===Ka?null:Ka;this.count=void 0===sa?0:sa;this.start=void 0===wb?-1:wb;this.end=void 0===Nd?-1:Nd;this.Avg=void 0===ee?0:ee;this.Max=void 0===yf?-1:yf;this.Min=Eh.a.Img;this.longFrameCount=void 0===sg?0:sg;this.coauth=(void 0===bg?-1:bg)||1;this.tfAppInt=void 0===Yf?-1:Yf;this.Props=void 0===xg?null:xg;this.LFrame=null}function H(Ka,sa){this.duration=this.startSecond=0;this.startSecond=void 0===Ka?-1:
Ka;this.duration=void 0===sa?-1:sa}function U(){this.f=null}function Q(Ka){var sa=this;this.HFd={};this.Uha=null;this.Kgb=function(wb,Nd){wb.longFramesOverThresholdOps++;wb.maxLongFrameDuration=Math.max(wb.maxLongFrameDuration,Nd)};this.nf=new O;this.xbh();Ka.da.Ya(276,function(){Yc.a(Ka).t3(sa.nf)})}function O(){this._reportName=null;this.operationsGroups=[];this._reportName="FramePerformanceCanvas"}function ea(Ka){this.name=null;this.count=0;this.minFPS=-1;this.maxFPS=0;this.l1FramePerformanceData=
new Z;this.l2FramePerformanceData=new Z;this.l3FramePerformanceData=new Z;this.name=Ka}function Z(){this.longFramesOverThresholdOpsPercentage=this.longFramesOverThresholdOps=this.fpsUnderThresholdOpsPercentage=this.fpsUnderThresholdOps=0;this.maxLongFrameDuration=-1}function S(){var Ka=zh.call(this)||this;Ka.MM=!1;Ka.ade=null;Ka.bde=null;Ka.gDd=function(){Ka.B0d()};Ka.WUi=function(){Ke.a.Fa(Ka.a_);Ke.a.Fa(Ka.xk)};Ka.a_=We.a.instance.sua();Ka.xk=We.a.instance.TC();Ka.a_.ka("visibilitychange",Ka.gDd);
Ka.xk.ka("pagehide",Ka.WUi);Ka.B0d();return Ka}function I(Ka){var sa=this;this.vKe=!1;this.xKe=null;this.ld=function(){sa.Boj();Pf.g(sa.$).ga&&Pf.g(sa.$).ga.OI(sa.ld)};this.li=function(wb,Nd){Nd.oa&&!sa.vYd.has(Nd.oa.name)&&(sa.vYd.add(Nd.oa.name),Pf.g(sa.$).ga&&(Pf.g(sa.$).ga.OI(sa.ld),Pf.g(sa.$).ga.WE(sa.ld)))};this.$=Ka;this.dcg=new Set;this.vYd=new Set;this.$.xa&&this.$.xa.oa&&this.vYd.add(this.$.xa.oa.name);Pf.g(this.$).ga.WE(this.ld);this.$.xa.Nf(this.li)}function P(Ka){je.ULS.sendTraceTag(537151049,
0,50,"CpuMeterTaskEventRegistrationManager.RegisterCpuMeterTaskEvent: Starting RegisterCpuMeterTaskEvent");nd.TaskExtensions.Ba(Sg.a.lr(Ec.a.instance.qc("Common.ICpuMeterProvider")),function(sa){je.ULS.sendTraceTag(537151048,0,50,"CpuMeterTaskEventRegistrationManager.RegisterCpuMeterTaskEvent: CpuMeterProvider resolved");nd.TaskExtensions.Ba(sa.result.gm.task,function(wb){je.ULS.sendTraceTag(537151047,0,50,"CpuMeterTaskEventRegistrationManager.RegisterCpuMeterTaskEvent: CpuMeter resolved");var Nd=
new J(Ka);wb.result.PWc(0,Object($c.a)(Nd,Nd.kGh,"filterTaskEvent"),Object($c.a)(Nd,Nd.WQj,"traceTaskEvent"))},Ka.la,3)},Ka.la,3)}function J(Ka){var sa=this;this.Je=null;this.OYd=Ka.ya.TimeToReportOnLongWaitingTaskInMsAsWarning;this.NYd=Ka.ya.TimeToReportOnLongWaitingTaskInMsAsMedium;this.MYd=Ka.ya.TimeToReportOnLongRunningTaskInMsAsWarning;this.LYd=Ka.ya.TimeToReportOnLongRunningTaskInMsAsMedium;this.ea=Ka.ea;Ka.da.Ya(291,function(wb){sa.Je=wb});je.ULS.sendTraceTag(537151046,0,50,"TaskEventProcessor initialized with TimeToReportOnLongWaitingTaskInMsAsMedium = {0}, TimeToReportOnLongWaitingTaskInMsAsWarning = {1}, TimeToReportOnLongRunningTaskInMsAsMedium = {2}, TimeToReportOnLongRunningTaskInMsAsWarning = {3}",
this.NYd,this.OYd,this.LYd,this.MYd)}function aa(Ka){this.Ita=[];this.l2c=null;this.yFi=100;this.documentVisibilityObserver=null;this.xFi=Ka}function ia(Ka,sa){this.lcd=0;this.iVe=this.startTime=Se.HelperMethods.kc();this._name=Ka;this.vC=sa}function ba(Ka,sa){this.stopped=!1;this.chainedCallsTracer=Ka;this.Ypg=sa}function ra(Ka){var sa=this;this.aZc="AppUnloadInfo";this.xk=this.$=this.workbookHashedId=this.nz=null;this.Z4d=this.z8d=!1;this.xf=null;this.fdf=0;this.mda=function(wb,Nd){sa.fdf=Nd.oCc};
this.DIf=function(wb,Nd){Nd.D1d.length&&sa.$.UF&&(sa.nz.dataLossInfo=new ka(Nd),sa.nz.wasDataLostDuringUnload=!0,sa.vdb())};this.fh=function(){sa.G0f();sa.$.ea.Kp(sa.fh)};this.NPa=function(){sa.nz.wasUpdatedOnBeforeUnload=!0;sa.nz.inactivityDurationBeforeUnloadSeconds=sa.xf.Pfb<ra.vEi?sa.fdf:sa.xf.Pfb;sa.Dhg()};this.BGb=function(){sa.nz.wasUpdatedOnUnload=!0;sa.Dhg();Sys.Application.remove_unload(sa.BGb)};this.KXi=function(){sa.nz.lastSilentReopenStartTime=sf.a.Ra.Ob;sa.nz.lastSilentReopenEndTime=
null;sa.vdb();sa.$.fl(sa.uHf)};this.uHf=function(){sa.nz.lastSilentReopenEndTime=sf.a.Ra.Ob;sa.vdb();sa.$.Bl(sa.uHf)};this.localStorage=new Ih.a;this.XVf=Wd.EwaSettings.isChangeGateEnabled("OfficeVSO:5618594_OfflineModeUXEnabled");this.localStorage.xg()&&(this.$=Ka,this.workbookHashedId=th.a(this.$),this.nz=new da(this.workbookHashedId,this.$.ya.UserSessionId),this.xk=We.a.instance.TC(),this.xk.ka("beforeunload",this.NPa),this.$.userOperationManager.BLg(this.DIf),Ka.ea.yh?this.G0f():this.$.ea.Gm(this.fh),
this.xf=this.$.ea.xf,this.xf.Zsa(this.mda),Sys.Application.add_unload(this.BGb),Wd.EwaSettings.isChangeGateEnabled("OfficeVSO:5470513_trackSilentReopenUnloads")&&this.$.ea.iYc(this.KXi))}function ka(Ka){this.lostOperationsCount=0;this.mostCommonOperationName=null;this.mostCommonOperationCount=0;this.dataLossReason=null;this.lostOperationsCount=Ka.KDe+Ka.jfg;this.dataLossReason=Ka.Oze;this.xXg(Ka.D1d)}function da(Ka,sa){this.hadConnectivityIssuesDuringUnload=this.wasOfflineDuringUnload=!1;this.timestamp=
0;this.dataLossInfo=null;this.wasDataLostDuringUnload=!1;this.inactivityDurationBeforeUnloadSeconds=0;this.workbookHashedId=null;this.apiBeforeCloseNotificationEnabledOnUnload=this.dialogPromptedOnUnload=!1;this.wacSessionId=null;this.timeFromLastStatusCode0=this.timeFromLastDisconnectionStart=this.timeFromLastConnectivity=0;this.wasUpdatedOnBeforeUnload=this.wasUpdatedOnUnload=!1;this.lastSilentReopenEndTime=this.lastSilentReopenStartTime=this.disconnectionSource=null;this.workbookHashedId=Ka;this.wasUpdatedOnUnload=
this.wasDataLostDuringUnload=this.apiBeforeCloseNotificationEnabledOnUnload=this.dialogPromptedOnUnload=!1;this.wacSessionId=sa}function ha(Ka){var sa=Cf.call(this)||this;sa.tna=null;sa.boa=null;sa.GJe=Array(1);sa.Zxd=null;sa.yPc=null;sa.Vh=function(wb,Nd){Wd.EwaSettings.ma(41)&&(sa.boa=sa.boa||new xa(sa.$,sa.dJ,sa.Kma),sa.boa.Vh(wb,Nd))};sa.Xn=function(wb,Nd){Wd.EwaSettings.ma(41)&&(sa.boa=sa.boa||new xa(sa.$,sa.dJ,sa.Kma),sa.boa.Xn(wb,Nd))};sa.rd=function(wb,Nd){Wd.EwaSettings.ma(41)&&sa.dJ.rd(wb,
Nd)};sa.fh=function(wb,Nd){Wd.EwaSettings.ma(41)&&sa.dJ.fh(wb,Nd)};sa.zkc=function(wb,Nd){Wd.EwaSettings.ma(41)&&sa.dJ.zkc(wb,Nd)};sa.$=Ka;if(!Wd.EwaSettings.ma(41))return sa;Kd.a.yei(sa.$);sa.lO=new Rb(sa.$);sa.Mah();Wd.EwaSettings.ma(605)&&sa.F9a&&(sa.Zxd=new nb(sa.$,sa.F9a));sa.dJ=new qa(sa.$);sa.Kma=new gb(sa.$);sa.$.Gl(sa.rd);sa.$.na.Hq(sa.Vh);sa.$.na.mz(sa.Xn);sa.$.ea.mre(sa.zkc);Wd.EwaSettings.isChangeGateEnabled("OfficeVSO:5638214_UMIIsLinkable")&&sa.$.ea.Gm(sa.fh);return sa}function qa(Ka){this.dirtySessionOnLastRecordedRequest=
this.sWd=!1;this.epf=0;this.maxCoauthorsCount=1;this.everConnectedToOcs=!1;this.$=Ka;this.mob={};this.lob={};this.W7c={}}function Aa(Ka,sa,wb,Nd,ee,yf,sg,bg){this.mode=null;this.dirtySessionOnLastRecordedRequest=this.endedBySplashScreen=this.ocsCapable=!1;this.maxCoauthorsCount=this.loadOnDemandCount=0;this.everConnectedToOcs=!1;this.requests=null;this.mode=Ka;this.ocsCapable=sa;this.endedBySplashScreen=wb;this.dirtySessionOnLastRecordedRequest=Nd;this.loadOnDemandCount=ee;this.maxCoauthorsCount=
yf;this.everConnectedToOcs=sg;Ka=[];for(var Yf in bg)sa=bg[Yf],sa.Cdd(),Ka.push(sa.data);this.requests=Ka}function Fa(Ka){this.data=new ab;this.data.requestName=Ka;this.data.totalCount=0;this.Ucb=[];this.JZd=this.AZd=this.BZd=this.GZd=0;this.data.successfulCalls=0;this.data.unsuccessfulCalls=0;this.data.callsDuringEcsFreeze=0;this.data.longestRequest=null;this.data.requestDurationPercentile25=-1;this.data.requestDurationPercentile50=-1;this.data.requestDurationPercentile75=-1;this.data.requestDurationPercentile95=
-1}function ab(){this.requestName=null;this.averageWfeDuration=this.averageEcsDuration=this.averageEcsOperationDuration=this.averageDuration=this.callsDuringLoadOnDemand=this.callsDuringEcsFreeze=this.unsuccessfulCalls=this.successfulCalls=this.totalCount=0;this.longestRequest=null;this.requestDurationPercentile95=this.requestDurationPercentile75=this.requestDurationPercentile50=this.requestDurationPercentile25=0}function Ua(Ka,sa){this.data=new bb;this.data.operationName=Ka;this.data.isUserOperation=
sa;this.data.totalCount=0;this.t$f=[];this.u$f=[];this.data.longestStartToNextFrame=-1;this.data.longestStartToResponse=-1;this.data.startToNextFramePercentiles="";this.data.startToResponsePercentiles=""}function bb(){this.operationName=null;this.isUserOperation=!1;this.longestStartToResponse=this.longestStartToNextFrame=this.totalCount=0;this.startToResponsePercentiles=this.startToNextFramePercentiles=null}function xa(Ka,sa,wb){this.$=Ka;this.dJ=sa;this.Kma=wb}function Gb(Ka,sa,wb,Nd,ee,yf,sg,bg,
Yf,xg,oe,Gh,rh,Ph,Di,Fg,$f){this.requestName=null;this.isPromotedUTRRequest=this.isFullyLoggedKPIRequest=this.isUserTriggeredRequest=!1;this.TimeFromLastEcsFreeze=this.WfeRequestDuration=this.EcsRequestDuration=this.ecsOperationDuration=this.requestInvokedTime=this.requestTimeInQueue=this.totalOperationDuration=this.requestDuration=0;this.DuringLoadOnDemand=!1;this.errors=this.correlationID=null;this.httpStatus=0;this.requestResourceTiming=null;this.communicationErrorRetryCount=0;this.isDocumentHidden=
this.successfulCall=!1;this.responseSize=this.coauthorsCount=0;this.networkInfoData=null;this.responseToCallbackTime=0;this.requestName=Ka;this.isUserTriggeredRequest=Gb.SWh(Ka);this.isFullyLoggedKPIRequest=Gb.OWh(Ka);this.isPromotedUTRRequest=Gb.PWh(Ka);this.requestDuration=sa;this.totalOperationDuration=wb;this.requestTimeInQueue=Nd;this.requestInvokedTime=ee;this.ecsOperationDuration=yf.EcsOperationDuration;this.EcsRequestDuration=yf.EcsRequestDuration;this.WfeRequestDuration=yf.WfeRequestDuration;
this.TimeFromLastEcsFreeze=yf.TimeFromLastEcsFreeze;this.DuringLoadOnDemand=yf.DuringLoadOnDemand;this.correlationID=sg;this.errors=Gb.V5g(bg);this.httpStatus=Yf;this.requestResourceTiming=xg;this.communicationErrorRetryCount=oe;this.successfulCall=Gh;this.isDocumentHidden=rh;this.coauthorsCount=Ph;this.responseSize=Di;this.networkInfoData=Fg;this.responseToCallbackTime=$f}function $b(Ka,sa){this.messageIdName=null;this.errorCause=0;this.messageIdName=Ka;this.errorCause=sa}function oa(Ka,sa,wb,Nd){var ee=
this;this.framePerformanceTracker=this.EJb=this.G0=this.I1=null;this.fkj=function(){ee.VYc=-1;var yf=Se.HelperMethods.kc();ee.TYj(yf);Wd.EwaSettings.ma(373)&&(ee.UKb&&(je.ULS.sendTraceTag(537153878,1,50,"GroupDetector: Setting current frame operations render duration due to rendering without additional blocks."),ee.PPb(ee.lF,yf),ee.UKb=!1),ee.Pic&&(ee.PPb(ee.CD,yf),ee.UKb||ee.PPb(ee.lF,yf)));window.setTimeout(ee.Nzi,0)};this.Nzi=function(){for(var yf=new af.a,sg=ee.$.ya.OperationToPrevOperationThreshold,
bg=0;bg<ee.lF.count;bg++){var Yf=ee.lF.pa(bg);bg<sg&&yf.add(Yf);ee.CD.add(Yf)}Pf.g(ee.$)&&Pf.g(ee.$).Da?((bg=ee.sessionStatisticsManager.Ygd(0))?je.ULS.sendTraceTag(237798547,1,50,"DOM count: ({0}, {1}, {2}), long tasks: {3}, operations count: {4}, operations: {5}",bg.DFi,bg.uRg,bg.hEi,ee.yDb,ee.lF.count,yf):je.ULS.sendTraceTag(537153876,1,50,"Report Manager NumberOfDomElements does not exist"),ee.lF.count>sg&&je.ULS.sendTraceTag(537153875,1,50,"More than {0} operations are in the operationsList. count: {1}",
sg,ee.lF.count),ee.lF.clear(),ee.yDb.clear()):je.ULS.sendTraceTag(537153877,1,10,"Grid == null or BlockManager == null")};this.Lpc=function(yf,sg){ee.KBi(sg.PPe)};this.$=Ka;this.dJ=sa;this.wh=this.wh||sf.a.Ra;this.CD=new af.a;this.lF=new af.a;this.VYc=this.e9a=-1;this.yDb=new af.a;this.operationsGroupDetector=new Ma;this.UKb=this.Pic=!1;this.Cei();this.iei();this.hei();this.sessionStatisticsManager=wb;this.lO=Nd;this.lO.yre(this.Lpc);this.$.da.Ya(263,function(yf){ee.framePerformanceTracker=yf})}function Ma(){this.operationsGroups=
null;this.gei()}function Za(Ka,sa,wb,Nd,ee,yf,sg,bg,Yf,xg){this.name=null;this.startToResponseRenderEnd=this.startToNextFrame=this.startTime=0;this.isPartOfGroup=this.isGroupBreaking=this.isUserOperation=this.wasHidden=!1;this.operationThatLedToLogging=null;this.startToOperationThatLedToLogging=0;this.name=void 0===Ka?"":Ka;this.startTime=void 0===sa?-1:sa;this.startToNextFrame=void 0===wb?-1:wb;this.startToResponseRenderEnd=void 0===Nd?-1:Nd;this.wasHidden=void 0===ee?!1:ee;this.isUserOperation=
void 0===yf?!0:yf;this.isGroupBreaking=void 0===sg?!0:sg;this.operationThatLedToLogging=void 0===Yf?"":Yf;this.startToOperationThatLedToLogging=void 0===xg?-1:xg;this.isPartOfGroup=void 0===bg?!1:bg}function gb(Ka){var sa=tf.call(this)||this;sa.statusBarManager=null;sa.dXc=!1;sa.Awf=function(){sa.raiseEvent("NetworkInformation")};sa.$=Ka;if(!Wd.EwaSettings.isChangeGateEnabled("OfficeVSO:3539919_AddNetworkInformationTelemetry"))return sa;sa.u0=sa.m_d("connection")||sa.m_d("mozConnection")||sa.m_d("webkitConnection");
sa.u0&&Wd.EwaSettings.ma(481)&&Ka.da.Ya(29,function(wb){sa.statusBarManager=wb;wb.WJ(sa);sa.u0.addEventListener("change",sa.Awf);sa.dXc=!0});return sa}function zb(){this.rttMs=this.bandwidthMps=0;this.effectiveConnection=this.connectionType=null;this.downlinkMaxMps=0}function nb(Ka,sa){var wb=fg.call(this)||this;wb.Je=null;wb.statusBarManager=null;wb.QDf=function(Nd,ee){ee.Wxd&&ee.Wxd.duration>=wb.MBi&&(wb.orf++,wb.Cnf=ee.Wxd.duration)};wb.$=Ka;wb.$.da.Ya(29,function(Nd){wb.statusBarManager=Nd;Nd.WJ(wb)});
wb.$.da.Ya(291,function(Nd){wb.Je=Nd});wb.orf=0;wb.Cnf=0;wb.MBi=Ka.ya.LongTaskThresholdMs;wb.F9a=sa;wb.F9a.IJg(wb.QDf);return wb}function pa(Ka,sa){var wb=this;this.Oa=new Ga.a;this.qOa=this.D6=this.zT=this.Je=null;this.hnf=this.yUd=this.xkc=!1;this.aPa=null;this.maxUsersCount=0;this.Lpc=function(Nd,ee){Nd=ee.PPe.getEntriesByType(rf.a.Vxd);Nd=Cl(Nd);for(ee=Nd.next();!ee.done;ee=Nd.next())if(ee=ee.value,!wb.Je.nD(ee.duration)&&!we.AFrameworkApplication.D8a){wb.zT.uqe(ee.duration);wb.Oa.raiseEvent("lttek",
new Ja(ee));var yf={};yf.LongTaskDuration=ee.duration;yf.LongTaskStartTime=ee.startTime;je.ULS.sendTraceTag(187982418,0,50,JSON.stringify(yf))}};this.fh=function(){wb.yUd=!0;wb.VAc()};this.JI=function(Nd,ee){ee&&(wb.maxUsersCount=Math.max(wb.maxUsersCount,ee.E1d));wb.D6.maxUsersCount=wb.maxUsersCount};this.vd=function(){wb.VAc()};this.rd=function(){wb.U$f()};this.PDf=function(Nd,ee){ee.bhc&&wb.VAc()};this.frf=function(){wb.zT.qXc(Me.getElapsedMilliseconds(wb.qOa,sf.a.Ra.Ob));wb.xWd(!0);var Nd=!1;
wb.D6.postBootWindowData.activeSessionDuration?(!wb.hnf&&Wd.EwaSettings.isChangeGateEnabled("OfficeVSO:4606533_CreateKpi2ForLongJsTask")&&(wb.djg&&Ib.b().nWf(2),jd.Health.instance.recordKpiUsage(ld.a.longJsTask,0,Mc.a.Xui,null),wb.hnf=!0),!wb.D6.isVetoSession&&wb.zT.Pti(wb.Pjg)&&(wb.D6.isVetoSession=!0,Wd.EwaSettings.isChangeGateEnabled("OfficeVSO:4606533_CreateKpi2ForLongJsTask")&&(wb.djg&&Ib.b().oWf(2,wb.JBi),jd.Health.instance.recordKpiFailure(ld.a.longJsTask,"SessionVetoedJsLoadTooSlow",!1,!0,
null))),wb.D6.worstWindowData.Yxd<=wb.zT.Yxd&&(wb.D6.worstWindowData=wb.zT),wb.D6.entireSessionData.kHg(wb.zT)):(wb.D6.postBootWindowData=new ib(wb.zT.activeSessionDuration,wb.zT.longTaskDuration),Nd=!0);var ee={};ee.LastWindowScore=wb.zT;ee.postBootWindow=Nd;ee.CoauthersNumber=wb.$.ea.Om.length;Nd=JSON.stringify(ee);je.ULS.sendTraceTag(20779346,0,50,Nd);wb.zT=new ib};this.Eoc=function(){wb.Je.Hi||we.AFrameworkApplication.D8a||wb.xWd(!1)};this.Doc=function(){wb.zT.qXc(Me.getElapsedMilliseconds(wb.qOa,
sf.a.Ra.Ob));wb.qOa=null;wb.aPa.cancel()};this.$=Ka;this.Pjg=Ka.ya.LongTaskPerformanceVetoThreshold;this.JBi="PercentageOver_"+this.Pjg.toString();this.Xxd=Ka.ya.LongTaskPerformanceWindowDurationInMs;this.lO=sa;this.djg=Wd.EwaSettings.isChangeGateEnabled("OfficeVSO:5142056_use_UTR_in_LongJsTask");this.$.da.Ya(291,function(Nd){wb.Je=Nd;wb.VAc()});this.$.ea.yh?this.fh(this,Sys.EventArgs.Empty):this.$.ea.Gm(this.fh);this.lO.HJg(this.PDf);this.$.fl(this.vd);this.$.Gl(this.rd)}function Ja(Ka){var sa=Jb.call(this)||
this;sa.Wxd=Ka;return sa}function Da(Ka,sa,wb,Nd,ee){this.isVetoSession=!1;this.postBootWindowData=this.worstWindowData=this.entireSessionData=null;this.maxUsersCount=0;this.isVetoSession=Ka;this.entireSessionData=sa;this.worstWindowData=wb;this.postBootWindowData=Nd;this.maxUsersCount=ee}function ib(Ka,sa){this.longTaskDuration=this.activeSessionDuration=0;this.activeSessionDuration=void 0===Ka?0:Ka;this.longTaskDuration=void 0===sa?0:sa}function Rb(Ka){var sa=this;this.Oa=new Ga.a;this.TMc=!1;this.fh=
function(){if(Bc.a.yp){try{void 0!==window.PerformanceObserver&&null!==window.PerformanceObserver&&((new PerformanceObserver(sa.LBi)).observe(new lb([rf.a.Vxd])),sa.TMc=!0)}catch(wb){sa.TMc=!1,je.ULS.sendTraceTag(537153885,0,10,"Exception related to PerformanceObserver: {0}",wb)}sa.Oa.raiseEvent("ltpoiek",new wc(sa.bhc))}};this.LBi=function(wb){sa.Oa.raiseEvent("ltoek",new Cb(wb))};this.$=Ka;this.$.ea.yh?this.fh(this,Sys.EventArgs.Empty):this.$.ea.Gm(this.fh)}function wc(Ka){var sa=Re.call(this)||
this;sa.bhc=Ka;return sa}function Cb(Ka){var sa=de.call(this)||this;sa.PPe=Ka;return sa}function lb(Ka,sa){this.entryTypes=null;this.buffered=!1;this.entryTypes=Ka;this.buffered=void 0===sa?!1:sa}function yb(Ka,sa){var wb=bd.call(this)||this;wb.PJb=!1;wb.imd=!1;wb.r6f=!0;wb.Oa=new Ga.a;wb.yJc=!1;wb.rd=function(){var Nd=bc.a(wb.$).ud.activityState,ee=Dc.a.Eg(Nd,cb.a.Loe);Dc.a.Eg(Nd,cb.a.Dob)||ee||wb.upload()};wb.$=Ka;wb.$wb=sa;wb.ea=Ka.ea;wb.$.Gl(wb.rd);wb.rfg=new Ta;wb.BQa=new ic(Id.a.TPd,Ka.ya.PageGenerationMetrics.TimeToCompleteFirstFlush);
wb.JEc=new pc(wb);return wb}function pc(Ka){this.M4b=[];this.PNg=null;this.sqmManager=Ka}function Ta(){this.Sxd=null;this.C3g=Ta.t9g();this.nXf()}function rb(Ka,sa,wb){this.XTc=Ka.keyCode;this.xLb(Ka.ctrlKey,1);this.xLb(Ka.shiftKey,2);this.xLb(Ka.altKey,4);this.xLb(Qa.b(Ka),8);this.xLb(wb,16);this.XTc=this.jfb|sa<<24}function ic(Ka,sa){this.ISb=null;this.x7b=this.wnd=!1;this.Jje=this.Kje=null;this.F6a=this.E6a=0;this.z_f=Ka;this.Qge=sa}function Va(Ka){var sa=Fd.call(this)||this;sa.NV=Ka;return sa}
function jb(Ka){var sa=fh.call(this)||this;sa.$=Ka;sa.Xb();return sa}function rc(Ka){var sa=this;this.zKa=new Set;this.VNb=null;this.eYe=this.Iag=!1;this.fh=function(){sa.Uyi();sa.VNb=dg.a.instance.create(function(){sa.tDb()},rc.jMj,Ee.a.tDb)};this.rd=function(){sa.tDb()};this.MGb=function(wb,Nd){wb=sa.Eqb.blockedActions.length;var ee=Nd.details?Nd.actionName+"_"+Nd.details:Nd.actionName;Nd=Object.assign(new nc,{order:wb+1,name:ee,componentName:Nd.componentName,timeFromNavigationStart:Nd.timeFromNavigationStart});
Array.add(sa.Eqb.blockedActions,Nd)};this.Eqb=new Nb;this.Eqb.hasBlockedActions=!1;this.tfb=new Cc;this.VFh();this.$=Ka;this.$.ea.Gm(this.fh);this.$.Gl(this.rd);Wd.EwaSettings.isChangeGateEnabled("OfficeVSO:6169701_NonEssentialCookiesOnUserInteractive")&&(this.mGe=new Promise(function(wb){sa.F7g=wb}))}function Cc(){this.successfulActions=[]}function Hc(){var Ka=nc.call(this)||this;Ka.inputMethod=null;Ka.isCommand=!1;return Ka}function Nb(){this.hasBlockedActions=!1;this.blockedActions=[]}function nc(){this.order=
0;this.componentName=this.name=null;this.timeFromNavigationStart=0}function Ha(Ka){var sa=nf.call(this)||this;sa.$=Ka;sa.Xb();return sa}function tb(Ka,sa){this.interactivityTrackerService=this.l$f=this.SId=this.Hbb=this.TId=this.RNf=this.SNf=null;this.q7i=new Set([1,0]);je.ULS.sendTraceTag(537155528,0,50,"JsSelfProfilerManager.Ctor: creating new JsSelfProfilerManager");this.$=Ka;this.interactivityTrackerService=sa;this.pgi();this.ogi();this.Yui=this.$.ya.JsProfilingSampleIntervalInMs;this.profilingIntervalInMs=
Wd.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.JsProfilingWindowDurationInMs",1E4);this.OFe=Wd.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.JsProfilingIdleIntervalInMs",3E5);this.HKj()}function Ub(){this.shouldMakeSerializedCallTreesFullyReconstructible=this.shouldKeepQueryParamsInResourceURLs=this.shouldProcessProfileCapturedWhileUserIsIdle=this.shouldSendProfilesForDeobfuscationImmediately=this.canUseMultipleWebWorkers=this.shouldUseInMemoryLogger=this.featureEnabledChecker=this.deObfuscationRequestQueryParamsRetriever=
this.deObfuscationRequestBodyPropertiesRetriever=this.durationThresholdInMsToLogOperationData=this.shouldAlwaysLogOperationsData=this.shouldUseSendBeaconForSendingCallTrees=this.shouldSendAllCallTreesFromProfileInASingleRequest=this.frameTotalExecutionTimeFilteringThresholdInMs=this.shouldCompressSerializedCallTrees=this.shouldRecordExpandedTimeStamps=this.profilerTraceProcessingWebWorkerSourceURL=this.useMainEventLoopForProfilerTraceProcessing=this.shouldKeepSamplesOutsideOfProfilingInterval=this.shouldProfilingStartInAHiddenDocument=
this.shouldProcessProfileCapturedInAHiddenDocument=this.callTreeFilteringThresholdInMs=this.deObfuscationEndpoint=this.ulsInstance=this.buildVersion=this.appName=null}function gc(){this.samplingIntervalInMs=0;this.idleIntervalInMs=this.profilingIntervalInMs=this.maximumNumberOfSamplesToTake=null}function Eb(Ka,sa){this.YXi=Ka;this.$Xi=sa}function Tb(){}function Wc(){}function T(){this.customProperties=new Map}function ua(Ka){this.zIj=Ka}function ma(Ka){var sa=If.call(this)||this;sa.$=Ka;sa.Xb();return sa}
function wa(Ka){var sa=this;this.YK=null;if(wa.yif)je.ULS.sendTraceTag(537155545,0,50,"InteractivityTrackerService: instance was already created once. skipping initialization.");else{if(Wd.EwaSettings.isChangeGateEnabled("OfficeVSO:5960700_ShouldCreateProfilerAfterInteractivityTracker"))this.initialize(Ka);else{var wb=Rc.GetServiceTaskFactory.Ua(Ka.da,283,284,1);nd.TaskExtensions.Ba(wb,function(){nd.TaskExtensions.Ba(Fe.c(wb.result.ho.loadScript("interactivity")),function(){je.ULS.sendTraceTag(537155544,
0,50,"Interactivity slice is loaded");sa.initialize(Ka)},Ka.la,3)},Ka.la,3)}wa.yif=!0}}function Ca(){this.events=null;this.durationThresholdInMs=0;this.patchTaskScheduling=this.callbacks=null}function db(Ka){this.$=Ka}function Sa(){this.value=this.key=null}function hb(){this.appInfoProperties=this.coAuthCount=this.appState=null}function Xb(Ka){var sa=mc.call(this)||this;sa.Qef=0;sa.fYe=!1;sa.Gvd=Array(Xb.Z9a);sa.c7b=0;sa.$=Ka;sa.ZAb=Wd.EwaSettings.ma(79);sa.Glf=Wd.EwaSettings.isChangeGateEnabled("OfficeVSO:3683664_AddTelemetryForNonCommandActions");
sa.Fpi=Wd.EwaSettings.isChangeGateEnabled("OfficeVSO:5893585_PageLoadEngagementInfo");sa.iki=Wd.EwaSettings.isChangeGateEnabled("OfficeVSO:6144058_AsyncLogInteractivityRecord");sa.r5j=Uf.a.IZh();sa.R5={};Xb.HZb||(Xb.HZb=new Tf.a(ug.a.Uk()),Xb.Fei(Xb.HZb));xb.vfi();if(Wd.EwaSettings.isChangeGateEnabled("OfficeVSO:5151293_ReportLastOperationsOnFeedback"))for(Ka=0;Ka<Xb.Z9a;Ka++)sa.Gvd[Ka]="NA";return sa}function xb(){this.commandSurface=this.triggerMethod=Uf.a.ygb}function Sb(Ka,sa,wb){Ka=qb.call(this,
Ka.operation,Ka.properties,Ka.correlations)||this;Ka.timeFromAppInteractive=0;Ka.timeFromNavigationStart=0;Ka.timeFromAppInteractive=sa;Ka.timeFromNavigationStart=wb;return Ka}function qb(Ka,sa,wb){this.correlations=this.properties=this.operation=null;this.operation=Ka;this.properties=sa;this.correlations=wb}function mb(Ka){var sa=wf.call(this)||this;sa.WEe=!1;sa.$=Ka;Wd.EwaSettings.isChangeGateEnabled("OfficeVSO:6198510_AddServiceCreatedEvent")&&sa.Xb();return sa}function ac(Ka,sa,wb){var Nd=se.call(this,
sa,wb)||this;Nd.Oa=new Fc.a;Nd.Ebi=function(ee){if(Wd.EwaSettings.isChangeGateEnabled("OfficeVSO:3449424_AgaveValidateHost")){var yf=ee.Values.m_Origin;we.AFrameworkApplication.wopiHostOriginFromPostMessage||(we.AFrameworkApplication.wopiHostOriginFromPostMessage=yf)}switch(ee.MessageId){case xf.a.Dnd:lf.a(Nd.$).h$e(ee);break;case xf.a.Rwd:xd.a.ltas(null);break;case xf.a.mgc:Nd.mSi();break;case xf.a.Ind:Nd.lSi(ee)}};Nd.$=Ka;wb!==vf.a.L$&&Nd.AGa(wb);Nd.rgi();Nd.Efi();Ka=Nd.Ebi;Nd.Vl(xf.a.Dnd,Ka);Nd.Vl(xf.a.Rwd,
Ka);Nd.Vl(xf.a.mgc,Ka);Nd.Vl(xf.a.Ind,Ka);return Nd}function Uc(){}function Zc(){}function Kc(Ka){this.Gx=[];this.qTb=[];this._count=void 0===Ka?1:Ka}function va(Ka){this.fjb=null;this.gm=new te.a;this.HM=Ka}function fb(Ka,sa,wb,Nd,ee){this.YFa=0;this.fH=null;this.FXb=this.ile=0;this.vje=!1;this.hXa=0;this.Skb=!1;this.Ura=null;this.QUb=0;this.lge=new Fc.a;this.JYb=[];this.HM=Ka;this.zPc=sa;this.vLc=wb;this.uee=Nd;we.AFrameworkApplication.ha&&we.AFrameworkApplication.ha.ra("WrapSetTimeoutForTelemetryIsEnabled")&&
this.pvd();this.osg=ee;this.wLc=new Ne(100);this.kwg=sc.K4a(1,5,new Pb)}function Pb(Ka){Ka=void 0===Ka?null:Ka;this.cn=null;this.reset();this.$mb=Ka}function sc(Ka,sa,wb,Nd,ee,yf,sg){yf=void 0===yf?!0:yf;sg=void 0===sg?null:sg;this.IY=this.wle=this.Fce=!1;this.re=null;if(!Ka)throw Mb.a.argument("taskManagerLazy");if(!ee)throw Mb.a.argument("dataAggregator");this.iBg=Ka;this.FQc=sa;this._id=wb;this.$ae=6E4*Nd;this.iTb=ee;this.Iie=yf;this.$mb=sg;hd.Z5h().xb(this._id.toString())&&(this.IY=!0)}function hd(){}
function Ob(){}function Ac(){}function sb(Ka){var sa=jf.call(this)||this;sa.Mvf=Ka;return sa}function ad(){}function Hd(){}function Ne(Ka,sa){var wb=this;this.JMc=!1;this.AEa={};this.IVb=void 0===Ka?0:Ka;this.SVb=void 0===sa?0:sa;this.fVc=0;pd.a.addHandler(window.self,ge.a.GMg,function(){wb.JMc=!0});pd.a.addHandler(window.self,ge.a.HMg,function(){wb.JMc=!1})}function Ud(){this.S=this.T=this.M=this.C=0}function Ge(){this.KWa=[];this.E7d=this.vJc=0;this.Yfa=null;this.$a=new Fc.a}function Sc(Ka,sa){var wb=
rd.call(this)||this;wb.FOj=Ka;wb.actualValue=sa;return wb}function Pc(){this.tb=null}function Zd(Ka,sa,wb,Nd,ee){wb=void 0===wb?null:wb;Nd=void 0===Nd?null:Nd;ee=void 0===ee?100:ee;this.gOc=!1;this.ej=null;this.gjb=0;this.$a=new Fc.a;this.lib=null;this.eU=!1;this.kme=0;this.re=Ka;this.g8d=0;this.j1d=this;this.eKc=new Cd(wb);this.Uu=sa;Nd&&(this.lib=new vd(null,Nd,ee))}function ie(Ka){var sa=pe.call(this)||this;sa.entries=Ka;return sa}function vd(Ka,sa,wb){this.f5d=Ka;this.vYb=void 0===sa?null:sa;
this.hib={};this.Vpg=void 0===wb?100:wb}function Lb(Ka,sa){this.Iaa=null;this.TUc=Ka;this.behavior=sa;this.url=this.Ju.name}function id(Ka,sa,wb){this.ni=Ka;this.j1d=this;this.jtg=(void 0===sa?null:sa)||function(){return window.location.href};this.eKc=new Cd(void 0===wb?null:wb)}function uc(Ka,sa){function wb(yf,sg){null!=sg&&(Nd[yf]=sg)}var Nd={},ee=null;switch(Ka){case 0:ee="ResourceTiming";wb("Url",sa.a);wb("InitiatorType",sa.b);wb("RedirectStart",null==sa.c?null:sa.c.toString());wb("RedirectEnd",
null==sa.d?null:sa.d.toString());wb("FetchStart",null==sa.e?null:sa.e.toString());wb("DomainLookupStart",null==sa.f?null:sa.f.toString());wb("DomainLookupEnd",null==sa.g?null:sa.g.toString());wb("ConnectStart",null==sa.h?null:sa.h.toString());wb("ConnectEnd",null==sa.i?null:sa.i.toString());wb("SecureConnectionStart",null==sa.j?null:sa.j.toString());wb("RequestStart",null==sa.k?null:sa.k.toString());wb("ResponseStart",null==sa.l?null:sa.l.toString());wb("ResponseEnd",null==sa.m?null:sa.m.toString());
wb("CustomText",sa.n);wb("DecodedBodySize",null==sa.o?null:sa.o.toString());wb("EncodedBodySize",null==sa.p?null:sa.p.toString());wb("TransferSize",null==sa.q?null:sa.q.toString());break;case 1:ee="PerformanceTiming",wb("Url",sa.a),wb("NavigationStart",null==sa.b?null:sa.b.toString()),wb("UnloadEventStart",null==sa.c?null:sa.c.toString()),wb("UnloadEventEnd",null==sa.d?null:sa.d.toString()),wb("RedirectStart",null==sa.e?null:sa.e.toString()),wb("RedirectEnd",null==sa.f?null:sa.f.toString()),wb("FetchStart",
null==sa.g?null:sa.g.toString()),wb("DomainLookupStart",null==sa.h?null:sa.h.toString()),wb("DomainLookupEnd",null==sa.i?null:sa.i.toString()),wb("ConnectStart",null==sa.j?null:sa.j.toString()),wb("ConnectEnd",null==sa.k?null:sa.k.toString()),wb("SecureConnectionStart",null==sa.l?null:sa.l.toString()),wb("RequestStart",null==sa.m?null:sa.m.toString()),wb("ResponseStart",null==sa.n?null:sa.n.toString()),wb("ResponseEnd",null==sa.o?null:sa.o.toString()),wb("DomLoading",null==sa.p?null:sa.p.toString()),
wb("DomInteractive",null==sa.q?null:sa.q.toString()),wb("DomContentLoadedEventStart",null==sa.r?null:sa.r.toString()),wb("DomContentLoadedEventEnd",null==sa.s?null:sa.s.toString()),wb("DomComplete",null==sa.t?null:sa.t.toString()),wb("LoadEventStart",null==sa.u?null:sa.u.toString()),wb("LoadEventEnd",null==sa.v?null:sa.v.toString()),wb("CustomText",sa.w)}Nd.Table=ee;return Sys.Serialization.JavaScriptSerializer.serialize(Nd)}function ed(Ka,sa){this.Iaa=null;this.TUc=Ka;this.url=sa}function Cd(Ka){this.gHc=
Ka}function $d(){}function La(){}function od(){this.Version=this.Name=null}function ne(){this.WinOrientation=this.DocElemClientHeight=this.DocElemClientWidth=this.DocElemOffsetHeight=this.DocElemOffsetWidth=this.ScreenAvailWidth=this.ScreenAvailHeight=this.ScreenLogicalYdpi=this.ScreenLogicalXdpi=this.ScreenDeviceYdpi=this.ScreenDeviceXdpi=this.CalculatedDevicePixelRatio=this.WinDevicePixelRatio=this.WinOuterWidth=this.WinOuterHeight=this.WinInnerHeight=this.WinInnerWidth=this.ScreenHeight=this.ScreenWidth=
0;this.SupportsTouch=!1;this.Error=this.NavLanguage=this.NavAppVersion=this.NavAppName=this.NavPlatform=this.NavUserAgent=this.NavPlugins=null}function qd(Ka){Ka=Ka.replace(/-.*/g,function(){return""});Ka=Td.get(Ka);return null!==Ka&&void 0!==Ka?Ka:"other"}function He(Ka){return Ka[0].toUpperCase()+Ka.slice(1).replace(/_[a-z]/g,function(sa){return sa[1].toUpperCase()})}function Ue(Ka){Hf(Ka,De)}function zf(Ka){Hf(Ka,Ae)}function Hf(Ka,sa){var wb,Nd,ee=null===(wb=null===Ka||void 0===Ka?void 0:Ka.actionProps)||
void 0===wb?void 0:wb.name;Ka=null===(Nd=null===Ka||void 0===Ka?void 0:Ka.actionProps)||void 0===Nd?void 0:Nd.appState;if(ee&&Ka){var yf=qd(ee);"other"!==yf&&"grid_menu"!==yf&&"steady"===Ka&&(Wd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InteractivityMetricKpiUseRequestIdleCallback",!1)?window.requestIdleCallback(function(){sa(yf)},fe):sa(yf))}else je.ULS.sendTraceTag(526463695,0,15,"InteractivityTrackerService.reportResponsivenessMetricKpi action or appState are undefined")}function De(Ka){jd.Health.instance.recordKpiFailure("NonResponsiveActions"+
He(Ka),"SlowAction",!1,!0,null)}function Ae(Ka){jd.Health.instance.recordKpiUsage("NonResponsiveActions"+He(Ka),0,"xloint",null)}b.r(F);var yd=b(0),je=b(13);Object(yd.a)(ne,"BrowserInfo",null,[]);Object(yd.a)(od,"PluginInfo",null,[]);var we=b(4),Bc=b(23);La.Wzi=function(){if(we.AFrameworkApplication.ha.ra("LogBrowserInfoIsEnabled")){var Ka=La.kLh();try{var sa=JSON.stringify(Ka);je.ULS.sendTraceTag(6903563,102,50,sa)}catch(wb){je.ULS.sendTraceTag(6903564,102,15,wb.message)}}else je.ULS.sendTraceTag(6903562,
102,50,"Detailed browser info logging is turned off")};La.k_h=function(){var Ka=window.navigator.plugins;if(!Ka||!Ka.length)return null;for(var sa=[],wb=0;wb<Ka.length;wb++){var Nd=Ka[wb].name,ee=Ka[wb].version;Array.add(sa,Object.assign(new od,{Name:Nd,Version:ee}))}return sa};La.kLh=function(){var Ka=new ne,sa=new Sys.StringBuilder;La.At(function(wb){Ka.DocElemClientHeight=wb},function(){return document.documentElement.clientHeight},sa);La.At(function(wb){Ka.DocElemClientWidth=wb},function(){return document.documentElement.clientWidth},
sa);La.At(function(wb){Ka.DocElemOffsetHeight=wb},function(){return document.documentElement.offsetHeight},sa);La.At(function(wb){Ka.DocElemOffsetWidth=wb},function(){return document.documentElement.offsetWidth},sa);La.At(function(wb){Ka.ScreenAvailHeight=wb},function(){return window.screen.availHeight},sa);La.At(function(wb){Ka.ScreenAvailWidth=wb},function(){return window.screen.availWidth},sa);La.At(function(wb){Ka.ScreenWidth=wb},function(){return window.screen.width},sa);La.At(function(wb){Ka.ScreenHeight=
wb},function(){return window.screen.height},sa);La.At(function(wb){Ka.ScreenLogicalXdpi=wb},function(){return window.screen.logicalXDPI},sa);La.At(function(wb){Ka.ScreenLogicalYdpi=wb},function(){return window.screen.logicalYDPI},sa);La.At(function(wb){Ka.ScreenDeviceXdpi=wb},function(){return window.screen.deviceXDPI},sa);La.At(function(wb){Ka.ScreenDeviceYdpi=wb},function(){return window.screen.deviceYDPI},sa);La.At(function(wb){Ka.WinInnerHeight=wb},function(){return window.self.innerHeight},sa);
La.At(function(wb){Ka.WinInnerWidth=wb},function(){return window.self.innerWidth},sa);La.At(function(wb){Ka.WinOuterHeight=wb},function(){return window.self.outerHeight},sa);La.At(function(wb){Ka.WinOuterWidth=wb},function(){return window.self.outerWidth},sa);La.At(function(wb){Ka.WinOrientation=wb},function(){return window.self.orientation},sa);La.At(function(wb){Ka.WinDevicePixelRatio=wb},function(){return window.self.devicePixelRatio},sa);La.At(function(wb){Ka.SupportsTouch=wb},function(){return Bc.a.wBc},
sa);La.At(function(wb){Ka.NavAppName=wb},function(){return window.navigator.appName},sa);La.At(function(wb){Ka.NavAppVersion=wb},function(){return window.navigator.appVersion},sa);La.At(function(wb){Ka.NavLanguage=wb},function(){return window.navigator.browserLanguage||window.navigator.language},sa);La.At(function(wb){Ka.NavUserAgent=wb},function(){return window.navigator.userAgent},sa);La.At(function(wb){Ka.NavPlatform=wb},function(){return window.navigator.platform},sa);La.At(function(wb){Ka.NavPlugins=
wb},La.k_h,sa);La.At(function(wb){Ka.CalculatedDevicePixelRatio=wb},function(){return La.devicePixelRatio},sa);Ka.Error=sa.toString();return Ka};La.At=function(Ka,sa,wb){try{var Nd=sa();Ka(Nd)}catch(ee){wb.isEmpty()||wb.append(" | "),wb.append(ee.message||"null")}};uk.Object.defineProperties(La,{devicePixelRatio:{configurable:!0,enumerable:!0,get:function(){var Ka=window.devicePixelRatio;return isNaN(Ka)?window.screen.deviceXDPI/window.screen.logicalXDPI:Ka}}});Object(yd.a)(La,"BrowserInfoLogger",
null,[]);var Od=b(254);$d.prototype.hi=function(){};$d.prototype.init=function(){La.Wzi()};$d.prototype.dispose=function(){};$d.main=function(){Od.a.instance.nj(new $d)};uk.Object.defineProperties($d.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.BrowserInfoLogger"}}});Object(yd.a)($d,"BrowserInfoLoggerPackage",null,[4,5]);var ae=b(79);Cd.prototype.Xgf=function(Ka){if(!this.gHc)return!0;Ka=ae.a.aid(Ka);if(!Ka)return!1;Ka=Ka.toLowerCase();for(var sa=0;sa<this.gHc.length;sa++)if(Ka.endsWith(this.gHc[sa]))return!0;
return!1};Object(yd.a)(Cd,"DomainAllowListManager",null,[]);ed.prototype.aZd=function(){var Ka={},sa=this.Ju;Ka.a=this.k1d;Ka.b=this.round(sa.navigationStart);Ka.c=this.round(sa.unloadEventStart);Ka.d=this.round(sa.unloadEventEnd);Ka.e=this.round(sa.redirectStart);Ka.f=this.round(sa.redirectEnd);Ka.g=this.round(sa.fetchStart);Ka.h=this.round(sa.domainLookupStart);Ka.i=this.round(sa.domainLookupEnd);Ka.j=this.round(sa.connectStart);Ka.k=this.round(sa.connectEnd);Ka.l=void 0!==sa.secureConnectionStart&&
null!==sa.secureConnectionStart?this.round(sa.secureConnectionStart):0;Ka.m=this.round(sa.requestStart);Ka.n=this.round(sa.responseStart);Ka.o=this.round(sa.responseEnd);Ka.q=this.round(sa.domInteractive);Ka.r=this.round(sa.domContentLoadedEventStart);Ka.s=this.round(sa.domContentLoadedEventEnd);Ka.t=this.round(sa.domComplete);Ka.u=this.round(sa.loadEventStart);Ka.v=this.round(sa.loadEventEnd);Ka.w=this.Iaa;return Ka};ed.prototype.round=function(Ka){return Math.round(1E3*Ka)/1E3};uk.Object.defineProperties(ed.prototype,
{k1d:{configurable:!0,enumerable:!0,get:function(){return ae.a.Xda(this.url)}},Ju:{configurable:!0,enumerable:!0,get:function(){return this.TUc}}});Object(yd.a)(ed,"PerformanceTimingEntry",null,[]);var Ad=b(57),Ve=b(221),kf=b(332);id.prototype.run=function(){if(id.JQ(window.performance))try{var Ka=this.jtg();if(id.VBg.exec(Ka)&&this.eKc.Xgf(Ka)){var sa=new ed(window.performance.timing,Ka);kf.a.instance.Taj(sa.Ju.fetchStart);kf.a.instance.Uaj(sa.Ju.navigationStart);kf.a.instance.XDb(Ad.a.fKh,"connectStart",
"requestStart");kf.a.instance.XDb(Ad.a.pKh,"requestStart","responseStart");kf.a.instance.XDb(Ad.a.sKh,"responseStart","responseEnd");this.j1d.Te(1,sa.aZd());this.ni.Jn(Ad.a.u4a,sa.Ju.fetchStart);this.ni.Jn(Ad.a.lKh,sa.Ju.domainLookupStart);this.ni.Jn(Ad.a.kKh,sa.Ju.domainLookupEnd);this.ni.Jn(Ad.a.hKh,sa.Ju.connectStart);this.ni.Jn(Ad.a.tKh,sa.Ju.secureConnectionStart);this.ni.Jn(Ad.a.gKh,sa.Ju.connectEnd);this.ni.Jn(Ad.a.qKh,sa.Ju.requestStart);this.ni.Jn(Ad.a.hfd,sa.Ju.responseStart);this.ni.Jn(Ad.a.mKh,
sa.Ju.responseEnd-sa.Ju.responseStart);this.ni.Jn(Ad.a.rKh,sa.Ju.responseStart-sa.Ju.requestStart);var wb=0,Nd=0,ee=0,yf=this.ZSj(Ka);wb=yf.transferSize;Nd=yf.S$c;ee=yf.x8c;yf.returnValue&&(this.ni.Jn(Ad.a.uKh,wb),this.ni.Jn(Ad.a.iKh,ee),this.ni.Jn(Ad.a.nKh,Nd));this.ni.Jn(Ad.a.oKh,sa.Ju.navigationStart)}}catch(sg){je.ULS.sendTraceTag(4551814,306,10,"Exception caught in PerformanceTimingLogger.Run: {0}",sg)}};id.prototype.ZSj=function(Ka){var sa,wb;var Nd=wb=sa=-1;if(void 0===window.performance.getEntriesByName||
null===window.performance.getEntriesByName)return{returnValue:!1,transferSize:sa,S$c:wb,x8c:Nd};Ka=window.performance.getEntriesByName(Ka,"navigation");if(void 0===Ka||null===Ka||1!==Ka.length)return{returnValue:!1,transferSize:sa,S$c:wb,x8c:Nd};Ka=Ka[0];var ee=Ka.transferSize;void 0!==sa&&null!==sa&&(sa=ee);ee=Ka.decodedBodySize;void 0!==ee&&null!==ee&&(Nd=ee);Ka=Ka.encodedBodySize;void 0!==Ka&&null!==Ka&&(wb=Ka);return{returnValue:!0,transferSize:sa,S$c:wb,x8c:Nd}};id.prototype.Te=function(Ka,sa){je.ULS.sendTraceTag(4551815,
306,50,uc(Ka,sa))};id.JQ=function(Ka){return!(void 0===Ka||null===Ka)&&!(void 0===Ka.timing||null===Ka.timing)};uk.Object.defineProperties(id,{instance:{configurable:!0,enumerable:!0,get:function(){return id.Na||(id.Na=new id(Ve.a.instance,null,we.AFrameworkApplication.ha.ra("PerfTimingLoggerFilterDomainsIsEnabled")?we.AFrameworkApplication.ha.Jw("ResourceLoggerDomainAllowList"):null))}}});id.Na=null;id.VBg=RegExp("^https?://.*","i");Object(yd.a)(id,"PerformanceTimingLogger",null,[797]);var Fc=b(96),
fd=b(81);Lb.prototype.aZd=function(){var Ka={},sa=this.Ju;Ka.a=this.k1d;Ka.b=sa.initiatorType;Ka.c=this.round(sa.redirectStart);Ka.d=this.round(sa.redirectEnd);Ka.e=this.round(sa.fetchStart);Ka.f=this.round(sa.domainLookupStart);Ka.g=this.round(sa.domainLookupEnd);Ka.h=this.round(sa.connectStart);Ka.i=this.round(sa.connectEnd);Ka.j=void 0!==sa.secureConnectionStart&&null!==sa.secureConnectionStart?this.round(sa.secureConnectionStart):0;Ka.k=this.round(sa.requestStart);Ka.l=this.round(sa.responseStart);
Ka.m=this.round(sa.responseEnd);Ka.o=this.round(Lb.G5a(sa,"decodedBodySize"));Ka.p=this.round(Lb.G5a(sa,"encodedBodySize"));Ka.q=this.round(Lb.G5a(sa,"transferSize"));Ka.n=this.Iaa;return Ka};Lb.prototype.round=function(Ka){return Math.round(1E3*Ka)/1E3};Lb.G5a=function(Ka,sa){return Ka[sa]};uk.Object.defineProperties(Lb.prototype,{k1d:{configurable:!0,enumerable:!0,get:function(){return 2===this.behavior?this.url:ae.a.Xda(this.url)}},Ju:{configurable:!0,enumerable:!0,get:function(){return this.TUc}}});
Object(yd.a)(Lb,"ResourceTimingEntry",null,[820]);var jd=b(99),zd=b(134),zc=b(40),$e=b(111),Xe=b(355);vd.prototype.rSj=function(Ka){var sa=Ka.name.toLowerCase(),wb=ae.a.Hwa(sa);this.Dmj(wb,sa)&&(wb in this.hib?je.ULS.sendTraceTag(51652509,306,50,"AppStaticResourceManager: file downloaded multiple times {0}",wb):(sa={},sa.fetchstart=Ka.fetchStart,sa.responseend=Ka.responseEnd,sa.iscached=this.cti(Ka),sa.encodedsize=Lb.G5a(Ka,"encodedBodySize"),sa.decodedsize=Lb.G5a(Ka,"decodedBodySize"),this.hib[wb]=
sa))};vd.prototype.Dmj=function(Ka,sa){if(this.f5d)return Array.contains(this.f5d,Ka);if(this.vYb)for(Ka=ae.a.HN(sa),sa=0;sa<this.vYb.length;sa++)if(this.vYb[sa]&&Ka.endsWith(this.vYb[sa]))return!0;return!1};vd.prototype.cti=function(Ka){try{var sa=Lb.G5a(Ka,"transferSize");if(sa)return!sa;je.ULS.sendTraceTag(51652510,306,50,"AppStaticResourceManager: No transfersize found, basing cache status from duration");return Ka.responseEnd-Ka.fetchStart<this.Vpg}catch(wb){je.ULS.sendTraceTag(51652511,306,
50,"AppStaticResourceManager: Error attempting to get cache value of resource [error: {0}]",wb.message)}return!1};vd.prototype.lbj=function(){if($e.a.Qh(this.hib))je.ULS.sendTraceTag(575931855,306,15,"Aggregated Static Resource Metric Dictionary is null or empty");else{var Ka=we.AFrameworkApplication.CF?we.AFrameworkApplication.CF.split(";"):[],sa=Object.assign(new Xe.a,{extendedProperties:zd.a.us()});sa.extendedProperties.set("Flights",zc.c(Ka));this.cAi(sa,this.hib,jd.Health.instance)}};vd.prototype.cAi=
function(Ka,sa,wb){if(sa){var Nd=0,ee=0,yf=0,sg=0,bg=0,Yf=0,xg=0,oe=0,Gh=0,rh=0,Ph=0,Di;for(Di in sa){var Fg=sa[Di];try{var $f=Object(fd.a)(Object,Fg);if($f){var Bg=$f.iscached?Boolean.parse($f.iscached.toString()):!1,uh=$f.fetchstart?this.parseFloat($f.fetchstart.toString()):0,ei=($f.responseend?this.parseFloat($f.responseend.toString()):0)-uh,cg=$f.encodedsize?this.parseFloat($f.encodedsize.toString()):0,Gf=$f.decodedsize?this.parseFloat($f.decodedsize.toString()):0;Nd+=ei;sg+=cg;xg+=Gf;rh++;Bg?
(yf+=ei,Yf+=cg,Gh+=Gf,Ph++):(ee+=ei,bg+=cg,oe+=Gf)}}catch(Zf){je.ULS.sendTraceTag(575931856,306,10,"AppStaticResourceManager: Error attempting to log KPI [error: {0}]",Zf.message)}}Ka.extendedProperties.set("StaticResources",zc.c(sa));Ka.extendedProperties.set("TotalResourceDownloadLatency",Nd.toString());Ka.extendedProperties.set("TotalResourceDownloadLatencyForCacheMiss",ee.toString());Ka.extendedProperties.set("TotalResourceDownloadLatencyForCacheHit",yf.toString());Ka.extendedProperties.set("TotalSizeOfEncodedDataDownloaded",
sg.toString());Ka.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheMiss",bg.toString());Ka.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheHit",Yf.toString());Ka.extendedProperties.set("TotalSizeOfDecodedDataDownloaded",xg.toString());Ka.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheMiss",oe.toString());Ka.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheHit",Gh.toString());Ka.extendedProperties.set("TotalNumberOfResourcesDownloaded",
rh.toString());Ka.extendedProperties.set("TotalNumberOfCachedResourcesDownloaded",Ph.toString());wb.recordKpiUsageForAlertableKpi("StaticResourceDownloadLatencyAggregated","wacbootmonitoring",null);wb.recordKpiSuccess("StaticResourceDownloadLatencyAggregated",Ka)}};vd.prototype.parseFloat=function(Ka){if(!Ka)return 0;Ka=parseFloat(Ka);return isNaN(Ka)?0:Ka};Object(yd.a)(vd,"AppStaticResourceManager",null,[]);var pe=Sys.EventArgs;Am(ie,pe);Object(yd.a)(ie,"EntriesAvailableEventArgs",Sys.EventArgs,
[]);var Jf=b(107);Zd.prototype.HIg=function(Ka){this.$a.addHandler(Zd.xad,Ka)};Zd.prototype.ugj=function(Ka){this.$a.removeHandler(Zd.xad,Ka)};Zd.prototype.hi=function(Ka,sa){var wb=this.SYd!==Ka;this.kme=Ka;this.isActive&&this.re&&wb&&(this.kq(),this.$g());this.g8d=sa};Zd.prototype.activate=function(){!this.isActive&&this.kye&&(this.$g(),this.eU=!0)};Zd.prototype.deactivate=function(Ka){this.isActive&&(this.kq(),Ka&&this.flush(),this.eU=!1)};Zd.prototype.flush=function(){if(this.isActive&&this.kye)try{var Ka=
window.performance.getEntriesByType("resource");0<Ka.length-this.gjb&&je.ULS.sendTraceTag(19506833,306,100,"ResourceTimingLogger.Flush: Start executing command. Number of new entries to flash: {0}",Ka.length-this.gjb);var sa=!(void 0===window.performance.clearResourceTimings||null===window.performance.clearResourceTimings);sa&&(window.performance.clearResourceTimings(),this.gjb=0);for(var wb=[],Nd=this.gjb;Nd<Ka.length;Nd++)this.eKc.Xgf(Ka[Nd].name)&&(this.lib&&this.lib.rSj(Ka[Nd]),wb.push(new Lb(Ka[Nd],
this.sgh)));sa||(this.gjb=Ka.length);this.$a.raiseEvent(Zd.xad,new ie(wb));for(Ka=0;Ka<wb.length;Ka++)0!==wb[Ka].behavior&&2!==wb[Ka].behavior||this.j1d.Te(0,wb[Ka].aZd());0<wb.length&&je.ULS.sendTraceTag(19506834,306,100,"ResourceTimingLogger.Flush: Successfully ended. Number of new logged entries: {0}",wb.length)}catch(ee){je.ULS.sendTraceTag(4310803,306,10,"Exception caught in ResourceTimingLogger.Flush: {0}",ee)}};Zd.prototype.Te=function(Ka,sa){je.ULS.sendTraceTag(4310804,306,50,uc(Ka,sa))};
Zd.prototype.Saj=function(){this.lib.lbj()};Zd.prototype.$g=function(){var Ka=this;this.re&&0<this.SYd&&(this.ej=new Jf.a(3,2,1E3*this.SYd,function(){Ka.flush()},5),this.re.$g(this.ej),this.gOc=!0)};Zd.prototype.kq=function(){this.gOc&&(this.re.kq(this.ej),this.ej=null,this.gOc=!1)};uk.Object.defineProperties(Zd.prototype,{kye:{configurable:!0,enumerable:!0,get:function(){try{return!(void 0===this.Uu||null===this.Uu)&&!(void 0===this.Uu.getEntriesByType||null===this.Uu.getEntriesByType)}catch(Ka){return je.ULS.sendTraceTag(50873240,
306,10,"Exception caught in ResourceTimingLogger.BrowserSupportsPerformanceTimeline: {0}",Ka),!1}}},sgh:{configurable:!0,enumerable:!0,get:function(){return this.g8d}},isActive:{configurable:!0,enumerable:!0,get:function(){return this.eU}},SYd:{configurable:!0,enumerable:!0,get:function(){return this.kme}}});Zd.xad="EntriesAvailable";Object(yd.a)(Zd,"ResourceTimingLogger",null,[777,797]);var kc=b(117);Pc.prototype.init=function(){this.tb.resolve("Common.NetworkTiming.IResourceTimingLogger");id.instance.run()};
Pc.prototype.dispose=function(){};Pc.prototype.hi=function(Ka){this.tb=Ka;var sa=null;if(we.AFrameworkApplication.ha.ra("ResourceLoggerFilterDomainsIsEnabled"))try{sa=we.AFrameworkApplication.ha.Jw("ResourceLoggerDomainAllowList")}catch(ee){je.ULS.sendTraceTag(51652512,306,50,"ResourceTimingPackage - failed to get logger domain allowlist")}var wb=[];wb.push(ae.a.HN(kc.a.lM).toLowerCase());wb.push(ae.a.HN(kc.a.ueb).toLowerCase());var Nd=we.AFrameworkApplication.ha.Cd("AppStaticResourceMonitorCacheThresholdInMs",
100);Ka.register(777,"Common.NetworkTiming.IResourceTimingLogger").Ic().Nc(function(){return new Zd(we.AFrameworkApplication.Yi,window.performance,sa,wb,Nd)})};Pc.main=function(){Od.a.instance.nj(new Pc)};uk.Object.defineProperties(Pc.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.ResourceTiming"}}});Object(yd.a)(Pc,"ResourceTimingPackage",null,[4,5]);var $c=b(82),rd=Sys.EventArgs;Am(Sc,rd);Object(yd.a)(Sc,"CpuMeterMonitorThresholdExceededEventArgs",Sys.EventArgs,[]);
var me=b(169);Ge.prototype.init=function(Ka,sa,wb){this.Yfa=Ka;this.vJc=sa;this.E7d=wb;this.Yfa.Gre(Object($c.a)(this,this.gOi,"onCpuMeterFrameAvailable"));this.YJg(Object($c.a)(this,this.f8g,"cpuPercentThresholdExceeded"))};Ge.prototype.gOi=function(Ka,sa){sa.Mvf&&(Array.enqueue(this.KWa,sa.Mvf.CP),this.KWa.length>this.E7d&&(Array.dequeue(this.KWa),this.Y_g()))};Ge.prototype.Y_g=function(){for(var Ka=this.KWa.length,sa=0,wb=0;wb<Ka;wb++){var Nd=Array.dequeue(this.KWa);sa+=Nd;Array.enqueue(this.KWa,
Nd)}Ka=sa/Ka;Ka>this.vJc&&this.$a.raiseEvent("CPTTE",new Sc(this.vJc,Ka))};Ge.prototype.f8g=function(Ka,sa){me.a(16782158,306,50,"CpuMeter KPI Average Threshold Exceeded: [{0}]",this.h$g(sa.FOj,sa.actualValue))};Ge.prototype.YJg=function(Ka){this.$a.addHandler("CPTTE",Ka)};Ge.prototype.h$g=function(Ka,sa){var wb={};wb.ThresholdValue=Ka;wb.ActualValue=sa;return wb};Object(yd.a)(Ge,"CpuMeterMonitor",null,[827]);var te=b(161);Object(yd.a)(Ud,"ProfileInformation",null,[]);var ge=b(12),pd=b(41),jc=b(274);
Ne.prototype.bte=function(Ka,sa,wb){var Nd=Ne.generateKey(sa,wb);Nd in this.AEa?sa=this.AEa[Nd]:(sa=new Ud,sa.S=wb?1:0,this.AEa[Nd]=sa,this.fVc++);sa.C++;sa.M=Ka>sa.M?Ka:sa.M;sa.T+=Ka};Ne.prototype.v_a=function(Ka,sa){this.bte(Ka,sa,!1);this.JMc&&this.bte(Ka,sa,!0)};Ne.prototype.getData=function(){if(0<this.SVb&&this.fVc>this.SVb)return this.bSh();var Ka=0<this.IVb,sa={},wb=this.AEa,Nd;for(Nd in wb){var ee=Nd,yf=wb[Nd];this.DYf(yf);Ka&&yf.T>=this.IVb&&(sa[ee]=yf)}return Ka?$e.a.Qh(sa)?null:sa:this.AEa};
Ne.prototype.bSh=function(){var Ka=0<this.IVb,sa=[],wb=this.AEa;for(yf in wb){var Nd={key:yf,value:wb[yf]},ee=Nd.value;(!Ka||ee.T>=this.IVb)&&Array.add(sa,Nd)}if(sa.length>this.SVb)sa.sort(function(sg,bg){return bg.value.T-sg.value.T}),sa=sa.slice(0,this.SVb);else if(!sa.length)return null;Ka={};sa=Cl(sa);for(wb=sa.next();!wb.done;wb=sa.next()){wb=wb.value;var yf=wb.value;this.DYf(yf);Ka[wb.key]=yf}return Ka};Ne.prototype.DYf=function(Ka){Ka.M=jc.a.g1(Ka.M,0);Ka.T=jc.a.g1(Ka.T,0)};Ne.prototype.reset=
function(){this.AEa={};this.fVc=0};Ne.generateKey=function(Ka,sa){return sa?Ka+" [it]":Ka};Object(yd.a)(Ne,"FunctionCallAggregator",null,[259]);Hd.PRg="BatchedOperation";Hd.replication="Replication";Hd.BTj="25";Hd.Kjj="9_"+Hd.PRg+"_"+Hd.replication;Object(yd.a)(Hd,"CpuMeterConstants",null,[]);Object(yd.a)(ad,"CpuMeterFrame",null,[]);var jf=Sys.EventArgs;Am(sb,jf);Object(yd.a)(sb,"CpuMeterFrameAvailableEventArgs",Sys.EventArgs,[]);Object(yd.a)(Ac,"MiniTaskItemInfo",null,[]);Object(yd.a)(Ob,"TaskItemInfo",
null,[]);var dc=b(613),za=b(97);hd.Z5h=function(){if(!hd.WRb&&(hd.WRb=new za.a,we.AFrameworkApplication.ha&&we.AFrameworkApplication.ha.wz("AggregatorIdDisabledList")))for(var Ka=we.AFrameworkApplication.ha.Jw("AggregatorIdDisabledList"),sa=0;sa<Ka.length;sa++)hd.WRb.ia(Ka[sa],!0);return hd.WRb};hd.WRb=null;Object(yd.a)(hd,"DisabledAggregatorListStore",null,[]);var Mb=b(277);sc.prototype.track=function(Ka,sa){sa=void 0===sa?null:sa;this.IY||(this.nqh(),this.cqj(),this.iTb.v_a(Ka,sa))};sc.prototype.cqj=
function(){!this.Fce&&0<this.$ae&&(this.Fce=!0,this.s_f())};sc.prototype.s_f=function(){var Ka=this,sa=new Jf.a(5,1,this.$ae,function(){Ka.isj()},19,this._id.toString());this.taskManager.$g(sa)};sc.prototype.isj=function(){!this.$mb||this.$mb.wBj()?this.z0f():this.Iie&&this.iTb.reset();this.s_f()};sc.prototype.z0f=function(){var Ka=this.iTb.getData();if(Ka){var sa=parseInt(String(Ka.length));if(isNaN(sa)||0<sa)this.Exc(Ka),this.Iie&&this.iTb.reset()}};sc.prototype.Exc=function(Ka){var sa={};je.ULS.sendTraceTag(7079840,
335,50,"Aggregator: {0}",(sa.ID=this._id.toString(),sa.Data=Ka,sa))};sc.prototype.nqh=function(){var Ka=this;this.wle||(this.FQc(function(){Ka.z0f()}),this.wle=!0)};sc.CN=function(Ka,sa,wb,Nd,ee){return new sc(new dc.a(function(){return we.AFrameworkApplication.Yi}),we.AFrameworkApplication.TNb,Ka,sa,wb,Nd,ee)};sc.K4a=function(Ka,sa,wb){return sc.CN(Ka,sa,wb,!0,null)};uk.Object.defineProperties(sc.prototype,{taskManager:{configurable:!0,enumerable:!0,get:function(){return this.re||(this.re=this.iBg.value)}}});
Object(yd.a)(sc,"Aggregator",null,[261]);Pb.prototype.v_a=function(Ka,sa){if(!this.$mb||this.$mb.wBj())sa in this.cn||(this.cn[sa]=[]),this.cn[sa].push(Ka)};Pb.prototype.getData=function(){return $e.a.count(this.cn)?this.cn:null};Pb.prototype.reset=function(){this.cn={}};Object(yd.a)(Pb,"NamedValuesAggregator",null,[259]);var hc=b(273);fb.prototype.Gre=function(Ka){this.lge.addHandler("OnCpuMeterFrameAvailable",Ka)};fb.prototype.Gbb=function(Ka,sa,wb,Nd){wb=(Nd=void 0===Nd?null:Nd)?Nd.priority:7;
var ee=this.HM();this.start(sa,wb);try{Ka()}finally{this.stop(sa,Nd),Ka=this.HM()-ee,this.uee.track(Ka,sa)}};fb.prototype.u7=function(Ka,sa){var wb=this.HM();try{Ka()}finally{Ka=this.HM()-wb,this.vLc.v_a(Ka,sa),0<this.YFa&&this.wLc.v_a(Ka,sa),this.uee.track(Ka,sa)}};fb.prototype.hFd=function(Ka){var sa=new Ob;sa.TN=Ka.qmc;sa.TP=Ka.priority;this.wPf(1,sa)};fb.prototype.W9a=function(Ka){this.QUb|=Ka};fb.prototype.start=function(Ka,sa){if(!this.YFa){this.wLc.reset();var wb=this.fmf(Ka);wb&&this.Yyd(1);
this.fH=new Ob;this.fH.TN=Ka;this.fH.TP=sa;this.fH.ST=(new Date).toISOString();this.fH.STS=jc.a.g1(this.HM(),2);wb?this.fH.UI=1:this.cpi(Ka)?this.fH.UI=2:this.fH.UI=0}this.YFa++};fb.prototype.Yyd=function(Ka){this.hXa|=Ka};fb.prototype.b3c=function(Ka,sa){this.hXa=void 0===Ka||Ka?0:this.hXa&~(void 0===sa?0:sa)};fb.prototype.stop=function(Ka,sa){sa=void 0===sa?null:sa;this.YFa--;if(0>=this.YFa&&this.fH){var wb=this.HM()-this.fH.STS;this.FXb+=wb;this.zPc.v_a(wb,Ka);this.fmf(Ka)&&this.b3c(!1,1);this.fH.TRT=
jc.a.g1(wb,2);sa&&(this.fH.TQT=jc.a.g1(sa.A8i,2),this.fH.TDT=jc.a.g1(sa.qnf,2));this.osg&&(this.wPf(0,this.fH),this.rkj());this.YFa=0}0<=Ka.indexOf(Hd.BTj)&&this.W9a(2);0<=Ka.indexOf(Hd.Kjj)&&this.W9a(4);1===(this.hXa&1)&&this.W9a(1);2===(this.hXa&2)&&this.W9a(8)};fb.prototype.rkj=function(){var Ka=this.fH.TRT;if(750<Ka){var sa=this.wLc.getData();if(sa){var wb={},Nd;for(Nd in sa){var ee=sa[Nd],yf=Nd;yf.startsWith("SiOp_")||(wb[yf]=jc.a.g1(100*ee.T/Ka,2))}sa=wb}Ka=Object.assign(new Ac,{T:Ka,S:sa});
this.kwg.track(Ka,this.fH.TN)}};fb.prototype.QIj=function(){var Ka=this.HM()-this.ile,sa=jc.a.g1(this.FXb/Ka*100,2);Ka=new ad;Ka.CP=sa;Ka.II=this.QUb;sa=this.zPc.getData();$e.a.count(sa)&&(Ka.LRT=sa);sa=this.vLc.getData();$e.a.count(sa)&&(Ka.FP=sa);this.lge.raiseEvent("OnCpuMeterFrameAvailable",new sb(Ka));this.e$f()};fb.prototype.e$f=function(){this.zPc.reset();this.vLc.reset();this.FXb=this.YFa=0;this.ile=this.HM();this.QUb=0;this.fH=null};fb.prototype.run=function(){this.vje?this.QIj():(this.e$f(),
this.vje=!0);this.Ura?this.Ura(Object($c.a)(this,this.run,"run"),1E3):window.setTimeout(Object($c.a)(this,this.run,"run"),1E3)};fb.prototype.PWc=function(Ka,sa,wb){var Nd=Array(2);Nd[0]=sa;Nd[1]=wb;this.JYb[Ka]||(this.JYb[Ka]=[]);this.JYb[Ka].push(Nd)};fb.prototype.wPf=function(Ka,sa){Ka=this.JYb[Ka];if(!hc.a.Qh(Ka))for(var wb=0;wb<Ka.length;wb++){var Nd=Ka[wb],ee=Nd[0];Nd=Nd[1];ee&&!ee(sa)||Nd(sa)}};fb.prototype.pvd=function(){if(!this.Skb){var Ka=window.setTimeout;this.Ura=function(sa,wb){return Ka(sa,
wb)};this.Skb=!0}};fb.prototype.fmf=function(Ka){return Ka.startsWith("key")||Ka.startsWith("input")};fb.prototype.cpi=function(Ka){return Ka.startsWith("click")||Ka.startsWith("mouse")||Ka.startsWith("pointer")};Object(yd.a)(fb,"CpuMeter",null,[69]);va.prototype.initialize=function(Ka,sa,wb,Nd){this.fjb||(this.fjb=new fb(this.HM,Ka,sa,wb,void 0===Nd?!1:Nd),this.gm.setResult(this.fjb));return this.fjb};Object(yd.a)(va,"CpuMeterProvider",null,[826]);Kc.prototype.YGh=function(){for(var Ka=0,sa=0;sa<
this.Gx.length;sa++)this.Gx[sa]<this.Gx[Ka]&&(Ka=sa);return Ka};Kc.prototype.v_a=function(Ka,sa){Ka=jc.a.g1(Ka,2);if(this.Gx.length<this._count)Array.add(this.Gx,Ka),Array.add(this.qTb,sa);else{var wb=this.YGh();Ka>this.Gx[wb]&&(this.Gx[wb]=Ka,this.qTb[wb]=sa)}};Kc.prototype.getData=function(){if(!this.Gx.length)return null;var Ka={};return Ka.Vals=this.Gx,Ka.Desc=this.qTb,Ka};Kc.prototype.reset=function(){this.Gx=[];this.qTb=[]};Object(yd.a)(Kc,"MaxDataAggregator",null,[259]);var cc=b(37),Ec=b(84);
Zc.prototype.hi=function(Ka){Ka.register(va,"Common.App.CpuMeter.CpuMeterProvider").as("Common.ICpuMeterProvider").Ic().Nc(function(){return new va(cc.a.Ae)});Ka.register(Ge,"Common.App.CpuMeter.CpuMeterMonitor").as("Common.App.CpuMeter.ICpuMeterMonitor").Ic().Nc(function(){return new Ge})};Zc.prototype.init=function(){var Ka=we.AFrameworkApplication.ha;if(Ka.ra("CpuMeterIsEnabled")){var sa=Ec.a.instance.resolve("Common.App.CpuMeter.CpuMeterProvider");kf.a.instance.Yte.continueWith(function(){Zc.gfi(Ka,
sa)})}};Zc.prototype.dispose=function(){};Zc.gfi=function(Ka,sa){var wb=sc.K4a(10,5,new Ne(Ka.Cd("TaskManagerLoggingThreshold",0),Ka.Cd("CpuMeterMaximumEntriesToLog",0)));sa=sa.initialize(new Kc(5),new Ne,wb,Ka.ra("CPUMeterExposeTaskDetailsIsEnabled"));sa.run();Ka.ra("CpuMeterMonitorIsEnabled")&&Ec.a.instance.resolve("Common.App.CpuMeter.ICpuMeterMonitor").init(sa,Ka.rwa("CpuMeterAverageCpuPercentThreshold",80),Ka.Cd("CpuMeterRollingAverageFramesCount",15));me.a(16827671,306,50,"Initializing CpuMeter")};
Zc.main=function(){Od.a.instance.nj(new Zc)};uk.Object.defineProperties(Zc.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.CpuMeter"}}});Object(yd.a)(Zc,"CpuMeterPackage",null,[4,5]);var Lc=b(1148);Uc.prototype.hi=function(){};Uc.prototype.init=function(){Lc.a.instance.init()};Uc.prototype.dispose=function(){};Uc.main=function(){Od.a.instance.nj(new Uc)};uk.Object.defineProperties(Uc.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.EventsCachePackage"}}});
Object(yd.a)(Uc,"EventsCachePackage",null,[4,5]);var he=b(10),qe=b(224),Af=b(1318),xf=b(166),fc=b(390),Gc=b(206),xd=b(159),Id=b(58),le=b(95),Wd=b(1),Je=b(21),lf=b(176),vf=b(971),se=Af.a;Am(ac,se);ac.prototype.dispose=function(){this.$=null;se.prototype.dispose.call(this)};ac.prototype.rgi=function(){this.mo(xf.a.Qze);this.mo(xf.a.Dnd);this.mo(xf.a.mgc);this.mo(xf.a.Ind);this.HWc(xf.a.Rwd);this.mo(xf.a.Hnd)};ac.prototype.Efi=function(){this.Fha(xf.a.kob);this.Fha(xf.a.Zua);this.Fha("App_CloseTab");
this.Fha(xf.a.FVa);this.Fha(xf.a.GVa);this.Fha(xf.a.ynd);this.Fha(xf.a.jgc)};ac.prototype.mSi=function(){var Ka={};Ka.hostMessageReceived=(new Date).getTime();je.ULS.sendTraceTag(537162883,0,50,"EwaHostMessenger.OnHostUnload");we.AFrameworkApplication.Wtd=!0;Ka.appUnloadStart=(new Date).getTime();Ka.sendBeaconFlight=we.AFrameworkApplication.ha.ra("SendBeaconOnShuttingDownRequestsEnabled");Ka.sendBeaconSupported=Id.a.yea();Id.a.hue();Ka.appUnloadEnd=(new Date).getTime();Ka.appMessageSent=(new Date).getTime();
this.Nj(xf.a.QNg,Ka)};ac.prototype.lSi=function(Ka){je.ULS.sendTraceTag(537162882,0,50,"EwaHostMessenger.OnHostSwitchMode");Ka.Values&&fc.a.UAd in Ka.Values&&Je.a.equals(Ka.Values[fc.a.UAd],Gc.a.edit,!0)&&!this.$.isEditMode&&(je.ULS.sendTraceTag(537162881,0,50,"EwaHostMessenger.OnHostSwitchMode: Switching to {0}",Ka.Values[fc.a.UAd]),Ka=new le.a(-8805455,0,1,0,null),this.$.Ka.dc(Ka))};Object(yd.a)(ac,"EwaHostMessenger",Af.a,[833,64,3]);var wf=qe.a;Am(mb,wf);mb.prototype.create=function(){var Ka=this,
sa=this.$.da,wb=Ec.a.instance;if(!this.WEe){this.WEe=!0;var Nd=Wd.EwaSettings.isChangeGateEnabled("OfficeVSO:5135167_PostMessageOriginFixup")?this.$.ya.DocumentHostInfo.PostMessageOrigin||vf.a.L$:we.AFrameworkApplication.rHd||vf.a.L$;wb.register(ac,"Microsoft.Office.Excel.WebUI.Client.PostMessage.EwaHostMessenger").as("Postmessage.IHostPostmessenger").Ic().Nc(function(){return new ac(Ka.$,window.parent,Nd,we.AFrameworkApplication.ha.ra("HostSendReadyToAcceptPostMessage"))})}this.Eb(sa.Aa(21)||sa.Ha(21,
wb.resolve("Postmessage.IHostPostmessenger")))};Object(yd.a)(mb,"HostMessengerFactory",qe.a,[]);var Uf=b(122),Wf=b(153),Tf=b(893),ug=b(614),Le=b(75),Qd=b(131),Of=b(490),Ee=b(43),Eg=b(328),lg=b(369),Ef=b(372),eg=b(539),Na=b(5),Ib=b(49);qb.mEh=function(Ka,sa,wb){var Nd={},ee=Ib.b();switch(Ka.command){case -1537138325:Nd.Action=sa.LabelText;break;case -1104934572:Nd.PrevTab=ee.yi(parseInt(sa.OldContextCommand,10));Nd.NextTab=ee.yi(parseInt(sa.NewContextCommand,10));break;case 802602464:Nd.Origin=sa[Na.a.UV];
break;case -1027730316:case -1059615499:Nd.MenuType=sa.launcherId;break;case -236759591:case 1650812936:case 1970784898:case 1378078823:case -400966242:case 467002767:Wd.EwaSettings.isChangeGateEnabled("OfficeVSO:5197543_AddColorPickerMenuSectionInfoToLogs")&&"SqmControlId"in sa&&(Nd.SqmControlId=sa.SqmControlId)}Nd.InputMethod=lg.a[Ka.method];Nd.Location=Ef.a[Ka.ef];Nd.Mode=eg.a[Ka.mode];Nd.IsSystemInitiated="IsSystemInitiated"in sa?sa.IsSystemInitiated:!1;Nd.NoReporting="NoReporting"in sa?sa.NoReporting:
!1;Ka=Cl(Object.keys(wb));for(sa=Ka.next();!sa.done;sa=Ka.next())sa=sa.value,Nd[sa]=wb[sa];return Nd};Object(yd.a)(qb,"InteractivityRecord",null,[]);Am(Sb,qb);Object(yd.a)(Sb,"FirstUserInteractivityRecord",qb,[]);var vc=b(736);xb.vfi=function(){xb.d4a||(xb.d4a=new vc.a(ug.a.Uk()),xb.d4a.add("InputMethod"),xb.d4a.add("Location"),xb.d4a.add("Mode"))};xb.d4a=null;Object(yd.a)(xb,"ExcelUserAction",null,[]);var Yc=b(217),Md=b(44),Ed=b(461),ke=b(261),mc=Le.a;Am(Xb,mc);Xb.prototype.dispose=function(){this.$=
this.R5=null;mc.prototype.dispose.call(this)};Xb.prototype.WVf=function(Ka,sa,wb){if(this.ZAb){var Nd=Ib.b().yi(Ka.command);Nd||je.ULS.sendTraceTag(537155555,3,50,"InteractivityLogger.ReportCommand: command name is null or empty. commandName: {0}, command: {1}, commandInfo: {2}",Nd,Ka.command,Ka);sa=qb.mEh(Ka,sa,wb);wb=!!sa&&(!("IsSystemInitiated"in sa)||!sa.IsSystemInitiated);this.$&&this.$.ea.yh&&wb&&Lc.a.instance.ZQf("OtelUserAction",new Ed.a(Nd,Ka.tabName,Date.now()));this.kWf(Nd,sa,null,!0,!0)}};
Xb.prototype.he=function(Ka,sa,wb,Nd){this.ZAb&&this.kWf(Ka,sa,void 0===wb?null:wb,!1,void 0===Nd?!1:Nd)};Xb.prototype.LWd=function(Ka){if(this.ZAb)if(this.R5){++this.Qef;this.R5[Ka]||(this.R5[Ka]=[]);var sa=this.Qef.toString();this.R5[Ka].push(sa);je.ULS.sendTraceTag(537155553,0,50,"StartInteractivityCorrellation - '{0}', correlation={1}",Ka,sa)}else je.ULS.shipAssertTag(537155554,0,!1,"StartInteractivityCorrellation - InteractivityCorrelations  is null or InteractivityCorrelations[{0}] == null",
Ka)};Xb.prototype.ZWd=function(Ka){if(this.ZAb)if(this.R5&&this.R5[Ka]){var sa=this.R5[Ka],wb=sa.pop().toString();sa.length||delete this.R5[Ka];je.ULS.sendTraceTag(537155551,0,50,"StopInteractivityCorrellation - '{0}', correlation={1}",Ka,wb)}else je.ULS.shipAssertTag(537155552,0,!1,"StopInteractivityCorrellation - InteractivityCorrelations  is null or InteractivityCorrelations[{0}] == null",Ka)};Xb.prototype.eR=function(Ka,sa,wb){var Nd=this;wb=void 0===wb?!1:wb;return this.ZAb?Eg.a(function(ee){Nd.he(Ka,
ee(),void 0,wb)},Xb.HOj,this.la,Ee.a.vii,!1,!sa):null};Xb.prototype.yNd=function(){for(var Ka="",sa=0;sa<Xb.Z9a;sa++)Ka+=this.Gvd[(this.c7b+Xb.Z9a-sa-1)%Xb.Z9a]+",";je.ULS.sendTraceTag(557188890,0,15,"Last operations {0}",Ka)};Xb.prototype.xXj=function(Ka){Ka&&(this.Gvd[this.c7b]=Ka,this.c7b=(this.c7b+1)%Xb.Z9a)};Xb.prototype.oqf=function(Ka,sa,wb){we.AFrameworkApplication.P9b();var Nd=Ka.operation,ee=Ka.properties;void 0!==wb?Of.a(this.$,432,433,0,function(yf){yf.mbj(Nd,ee,wb)}):this.ITj(Ka);this.JTj(Ka);
this.a0i(sa,ee,Nd)};Xb.prototype.ITj=function(Ka){this.OHj(Ka)||(this.fYe=!0,Ka=new Sb(Ka,Md.PageLoadTrackingInfo.instance.Hka(new Date),Md.PageLoadTrackingInfo.Jz()),Ka=Sys.Serialization.JavaScriptSerializer.serialize(Ka),je.ULS.sendTraceTag(458261331,0,50,"{0}",Ka))};Xb.prototype.OHj=function(Ka){var sa=Ka.properties;Ka=Ka.operation;return this.fYe||void 0===Ka||null===Ka||Ka===Qd.a.mWc||Ka===Qd.a.DQd||Ka===Qd.a.QHd||Id.a.htd(Ka)||!!sa&&"IsSystemInitiated"in sa&&sa.IsSystemInitiated};Xb.prototype.JTj=
function(Ka){Wd.EwaSettings.isChangeGateEnabled("OfficeVSO:5151293_ReportLastOperationsOnFeedback")&&this.xXj(Ka.operation);Ka=Sys.Serialization.JavaScriptSerializer.serialize(Ka);je.ULS.sendTraceTag(21542793,0,50,"{0}",Ka)};Xb.prototype.a0i=function(Ka,sa,wb){Uf.a.$la()&&(sa?"NoReporting"in sa&&sa.NoReporting||"IsSystemInitiated"in sa&&sa.IsSystemInitiated||!Ka&&!this.Glf||((Ka=Uf.a.gl(sa,Xb.HZb,xb.d4a))?(sa=Xb.uEh(sa))?Wf.a.sendUserActionEvent(Uf.a.F6b(wb,null,sa.triggerMethod,sa.commandSurface,
Ka)):je.ULS.sendTraceTag(537155550,0,50,"user action was null"):je.ULS.sendTraceTag(537155549,0,15,"OtelUtils.DictionaryToDataFields returned null")):je.ULS.sendTraceTag(537155548,0,50,"Not logging action telemetry because adction data was null, actionName: {0}",wb))};Xb.prototype.kWf=function(Ka,sa,wb,Nd,ee){var yf=this,sg=Yc.a(this.$);if(this.Glf){var bg=null;Je.a.equals(Ka,Qd.a.rxc,!0)&&sa&&"InputMethod"in sa&&(bg=Qd.a.bZe(Ka,sa.InputMethod));sg.NJb(bg||Ka,wb)}else Je.a.equals(Ka,Qd.a.rxc,!0)&&
sa&&"InputMethod"in sa&&(Ka=Qd.a.bZe(Ka,sa.InputMethod)),sg.NJb(Ka,wb);sa&&(sa.IsCommand=Nd);var Yf=void 0;this.Fpi&&(Yf="ActionRelativeTime"in sa?sa.ActionRelativeTime:Md.PageLoadTrackingInfo.Jz());this.iki?Object(ke.b)(function(){var xg=new qb(Ka,sa,yf.R5);yf.oqf(xg,ee,Yf)},this.$.la,50):(wb=new qb(Ka,sa,this.R5),this.oqf(wb,ee,Yf))};Xb.uEh=function(Ka){if(!Ka)return null;var sa=new xb;"InputMethod"in Ka&&(sa.triggerMethod=Ka.InputMethod);"Location"in Ka&&(sa.commandSurface=Ka.Location);return sa};
Xb.Fei=function(Ka){Ka?(Ka.add("Origin",2),Ka.add("InputMethod",2),Ka.add("ButtonType",2),Ka.add("selectedRange",2),Ka.add("SelectedRanges",2),Ka.add("editRange",2),Ka.add("Location",2),Ka.add("Mode",2),Ka.add("CurrentSelectionMode",2),Ka.add("Action",2),Ka.add("type",2),Ka.add("floatingObjectType",2),Ka.add("PrevTab",2),Ka.add("NextTab",2),Ka.add("DialogName",2),Ka.add("dx",3),Ka.add("dy",3),Ka.add("NumberOfSelectedRanges",3),Ka.add("IsCommand",1),Ka.add("IsInFormulaBarEdit",1),Ka.add("isLink",1),
Ka.add("isSheetRef",1),Ka.add("isEmptyText",1),Ka.add("isFormula",1),Ka.add("IsResizingHiddenHeader",1)):je.ULS.sendTraceTag(537155547,0,15,"InitTypeSpecifier was passed in a null dictionary")};Xb.HOj=1E3;Xb.Z9a=40;Xb.HZb=null;Object(yd.a)(Xb,"InteractivityLogger",Le.a,[10]);var Rc=b(51),nd=b(35);Object(yd.a)(hb,"CurrentAppInfo",null,[]);var Td=new Map;[{name:"keyboard_selection",actions:new Set("move_down move_left move_right move_up extend_down extend_left extend_right extend_up cell_text_move_down cell_text_move_left cell_text_move_right cell_text_move_up cell_text_extend_down cell_text_extend_left cell_text_extend_right cell_text_extend_up formulaBar_extend_left formulaBar_extend_right formulaBar_extend_down formulaBar_extend_up formulaBar_move_right formulaBar_move_down formulaBar_move_left formulaBar_move_up commit_down commit_right formulaBar_commit_down formulaBar_commit_right cell_text_commit_right cell_text_commit_down".split(" "))},
{name:"cell_edit",actions:new Set("commit_down_end_edit commit_right_end_edit formulaBar_commit_down_end_edit formulaBar_commit_right_end_edit cell_text_commit_down_end_edit cell_text_commit_right_end_edit cell_text_edit_end cell_text_edit_type cell_text_edit_typing cell_text_start_edit cell_text_start_edit_replace formulaBar_start_edit_replace formulaBar_start_edit formulaBar_end_edit_ok_cancel_btn cell_text_end_edit_ok_cancel_btn formulaBar_end_edit_sheet_changed cell_text_end_edit_sheet_changed move_down_end_edit move_left_end_edit move_right_end_edit move_up_end_edit extend_down_end_edit extend_left_end_edit extend_right_end_edit extend_up_end_edit cell_text_move_down_end_edit cell_text_move_left_end_edit cell_text_move_right_end_edit cell_text_move_up_end_edit cell_text_extend_down_end_edit cell_text_extend_left_end_edit cell_text_extend_right_end_edit cell_text_extend_up_end_edit active_cell_selection_change_end_edit cell_text_active_cell_selection_change_end_edit formulaBar_active_cell_selection_change_end_edit formulaBar_edit_type formulaBar_move_left_end_edit formulaBar_move_down_end_edit formulaBar_extend_left_end_edit formulaBar_move_right_end_edit formulaBar_move_up_end_edit formulaBar_extend_up_end_edit formulaBar_extend_right_end_edit formulaBar_extend_down_end_edit".split(" "))},
{name:"active_cell_selection",actions:new Set(["active_cell_selection_change","cell_text_active_cell_selection_change","formulaBar_active_cell_selection_change"])}].forEach(function(Ka){Ka.actions.forEach(function(sa){Td.set(sa,Ka.name)})});Object(yd.a)(Sa,"AppInfoProperty",null,[]);db.prototype.getAppState=function(){var Ka=Md.PageLoadTrackingInfo.instance.Hka(new Date);return-1===Ka?"boot":3E4>Ka?"postboot":"steady"};db.prototype.isChangeGateEnabled=function(Ka){return Wd.EwaSettings.isChangeGateEnabled(Ka)};
db.prototype.getBooleanFeatureGate=function(Ka,sa){return Wd.EwaSettings.getBooleanFeatureGate(Ka,sa)};db.prototype.getCurrentAppInfo=function(){return Object.assign(new hb,{appState:this.getAppState(),appInfoProperties:[Object.assign(new Sa,{key:"coauthCount",value:this.$.ea.Om.length.toString()})]})};db.prototype.sendBeaconTraceTag=function(Ka,sa,wb,Nd){this.$.sendBeaconTraceTag(Ka,sa,wb,Nd)};db.prototype.getActionBucket=function(Ka){return qd(Ka)};Object(yd.a)(db,"InteractivityTrackerCallbacks",
null,[813]);Object(yd.a)(Ca,"InteractivityTrackerOptions",null,[]);var Fe=b(290),fe={timeout:2E3},ef=b(249);wa.prototype.initialize=function(Ka){je.ULS.sendTraceTag(555360983,0,15,"InteractivityTrackerService: starting InteractivityTracker");if(this.YK=interactivity.InteractivityTrackerFactoryGlobal.create()){var sa=new Ca;sa.events=wa.sMj;sa.durationThresholdInMs=wa.durationThresholdInMs;sa.callbacks=new db(Ka);sa.patchTaskScheduling=Wd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PatchClientTaskScheduling",
!1);Ka=this.YK.start(sa);Ka.started?je.ULS.sendTraceTag(537155543,0,50,"InteractivityTrackerService: InteractivityTracker started"):je.ULS.sendTraceTag(537155542,0,15,"InteractivityTrackerService InteractivityTracker start failed: "+Ka.failureReason);Wd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InteractivityMetricKpi",!1)&&(this.YK.addEventListener(1,Ue),this.YK.addEventListener(0,zf))}else je.ULS.sendTraceTag(537155541,0,15,"InteractivityTrackerService: InteractivityTracker not created")};
wa.prototype.NUa=function(Ka,sa,wb){var Nd=sa;Wd.EwaSettings.Zxa()&&wb&&(Nd=Object(ef.a)(Nd,wb));this.YK?this.YK.track(Ka,Nd,void 0):je.ULS.sendTraceTag(537155540,0,50,"InteractivityTrackerService.TrackInputEventPerf: interactivityTracker not initialized. Discarding userAction: {0}",sa)};wa.prototype.MUa=function(Ka,sa,wb){Wd.EwaSettings.Zxa()&&wb&&(sa=Object(ef.a)(sa,wb));this.YK?this.YK.track(Ka,sa,void 0):je.ULS.sendTraceTag(524326924,0,50,"InteractivityTrackerService.TrackInputEventPerf: interactivityTracker not initialized. Discarding userAction: "+
sa)};wa.prototype.LIe=function(){return this.YK?this.YK.createActionsRetriever():(je.ULS.sendTraceTag(537155539,0,15,"InteractivityTrackerService.CreateSlowActionsRetriever: interactivityTracker not initialized."),null)};wa.prototype.dispose=function(){this.YK&&(this.YK.stop(),this.YK=null,Wd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InteractivityMetricKpi",!1)&&(this.YK.removeEventListener(1,Ue),this.YK.removeEventListener(0,zf)))};wa.durationThresholdInMs=100;wa.sMj="click mousedown contextmenu keypress keydown dblclick".split(" ");
wa.yif=!1;Object(yd.a)(wa,"InteractivityTrackerService",null,[469]);var If=qe.a;Am(ma,If);ma.prototype.create=function(){var Ka=this;if(Wd.EwaSettings.isChangeGateEnabled("OfficeVSO:5960700_ShouldCreateProfilerAfterInteractivityTracker")){var sa=Rc.GetServiceTaskFactory.Ua(this.$.da,283,284,this.ub);nd.TaskExtensions.Ba(sa,function(){nd.TaskExtensions.Ba(Fe.c(sa.result.ho.loadScript("interactivity")),function(){Ka.Eb(Ka.$.da.Aa(443)||new wa(Ka.$))},Ka.$.la,3)},this.$.la,3)}else this.Eb(this.$.da.Aa(443)||
this.$.da.Ha(443,new wa(this.$)))};ma.ka=function(Ka){Ka.da.Ha(444,new ma(Ka))};Object(yd.a)(ma,"InteractivityTrackerServiceFactory",qe.a,[]);var Ke=b(89),ng=b(408),rf=b(9),dg=b(46),qf=b(54);ua.prototype.getCustomProperties=function(Ka){var sa=new Map;if(Ka.hasOwnProperty("startTimeInMs")&&Ka.hasOwnProperty("totalExecutionTimeInMs")){var wb=Ka.startTimeInMs;Ka=this.zIj.retrieveSlowActionsBetweenTimeRange(wb,wb+Ka.totalExecutionTimeInMs);sa.set("actions",qf.a.Kc(Ka))}return sa};Object(yd.a)(ua,"CallTreeCustomPropertiesRetriever",
null,[807]);T.prototype.addCustomProperty=function(Ka,sa){this.customProperties.set(Ka,sa)};T.prototype.getCustomProperties=function(){return this.customProperties};Object(yd.a)(T,"CustomPropertiesRetriever",null,[806]);Wc.prototype.isFeatureEnabled=function(Ka,sa){return Wd.EwaSettings.getBooleanFeatureGate(Ka,sa)};Object(yd.a)(Wc,"ExcelFeatureChecker",null,[805]);Tb.prototype.isProfilingEnabled=function(){return!0};Object(yd.a)(Tb,"ExcelProfilingFeatureChecker",null,[804]);Eb.prototype.onProfilerEvent=
function(Ka){switch(Ka.eventId){case 1:this.YXi(Wd.EwaSettings.isChangeGateEnabled("OfficeVSO:6144046_KeepOldCollectedActions"));break;case 0:this.$Xi();break;default:je.ULS.sendTraceTag(537155529,0,15,"JSCPUIJSCPUProfilerObserver.OnProfilerEvent: got unhandled profilerEventId {0}",Ka.eventId)}};Object(yd.a)(Eb,"JSCPUProfilerObserver",null,[803]);Object(yd.a)(gc,"JSCPUProfilerInitOptions",null,[]);Object(yd.a)(Ub,"JSCPUProfilingPackageInitOptions",null,[]);var $g=b(74);tb.prototype.dispose=function(){je.ULS.sendTraceTag(537155527,
0,50,"JsSelfProfilerManager.Dispose");Ke.a.Fa(this.l$f);this.SId=this.$=null;this.TId.clear();this.Hbb.clear()};tb.prototype.YJj=function(){var Ka=this,sa=Math.random()*this.OFe;je.ULS.sendTraceTag(537155526,0,50,"JsSelfProfilerManager.Ctor: starting ContinuousSessionProfiler in: {0}",sa);this.l$f=dg.a.instance.create(function(){Ka.djd("ExcelOnlineContinuousSessionProfiler",2).start()},sa,Ee.a.MAj,!0)};tb.prototype.jKj=function(){je.ULS.sendTraceTag(537155525,0,50,"JsSelfProfilerManager.StartFullSessionProfiler: Starting a new profiler");
this.djd("ExcelOnlineFullSessionProfiler",3).start()};tb.prototype.qKj=function(Ka){var sa=void 0===sa?1E4:sa;je.ULS.sendTraceTag(537155524,0,50,"JsSelfProfilerManager.StartManualProfiler: Starting a new profiler");this.Xjf(Ka)?this.djd(Ka,0,sa).start():je.ULS.shipAssertTag(537155523,0,!1,"JsSelfProfilerManager.StartManualProfiler: Profiler name is invalid.")};tb.prototype.nLj=function(Ka){this.Xjf(Ka)?(Ka=this.G5e(Ka))&&Ka.stop():je.ULS.shipAssertTag(537155522,0,!1,"JsSelfProfilerManager.StopManualProfiler: Profiler name is invalid.")};
tb.prototype.RId=function(Ka){return this.Hbb.has(Ka)};tb.prototype.HKj=function(){Wd.EwaSettings.j6e()||(Wd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FullSessionJSProfiler",!1)?this.jKj():this.YJj())};tb.prototype.createProfiler=function(Ka,sa,wb,Nd,ee,yf){je.ULS.sendTraceTag(537155521,0,50,"JsSelfProfilerManager.CreateProfiler: Creating a new profiler");var sg=new gc;sg.samplingIntervalInMs=sa;sg.maximumNumberOfSamplesToTake=wb;sg.idleIntervalInMs=Nd;sg.profilingIntervalInMs=ee;
return this.gch(Ka,yf,sg)};tb.prototype.ogi=function(){var Ka=new Tb,sa=new Ub;sa.ulsInstance=new ng.a;sa.deObfuscationEndpoint="ProfilerReporting.ashx";sa.shouldCompressSerializedCallTrees=!1;sa.shouldKeepSamplesOutsideOfProfilingInterval=!1;sa.shouldSendAllCallTreesFromProfileInASingleRequest=!Wd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShouldSendEachCallTreeIndividuallyFromProfile",!1);sa.shouldUseSendBeaconForSendingCallTrees=Wd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShouldUseSendBeaconForSendingCallTrees",
!1);sa.callTreeFilteringThresholdInMs=Wd.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.JsProfilerCallTreeFilteringThresholdInMs",1);sa.deObfuscationRequestQueryParamsRetriever=this.W9g();sa.deObfuscationRequestBodyPropertiesRetriever=this.V9g();sa.featureEnabledChecker=new Wc;sa.useMainEventLoopForProfilerTraceProcessing=!1;sa.profilerTraceProcessingWebWorkerSourceURL=this.$.ya.JSProfilerProcessingWebWorkerJsScriptUrl;sa.shouldProcessProfileCapturedWhileUserIsIdle=Wd.EwaSettings.isChangeGateEnabled("OfficeVSO:6144063_ShouldProcessProfileCapturedWhileUserIsIdle");
this.SId=this.SNf.retrievePackage(Ka,sa).retrieveProfilerFactory()};tb.prototype.W9g=function(){var Ka=new T;Ka.addCustomProperty(rf.a.COf,we.AFrameworkApplication.userType);Ka.addCustomProperty(we.AFrameworkApplication.Xgb,we.AFrameworkApplication.userSessionId);Ka.addCustomProperty(rf.a.bwf,this.$.ya.SkipAuthentication?rf.a.cwf:null);Ka.addCustomProperty(rf.a.kJd,this.$.ya.MachineCluster);return Ka};tb.prototype.V9g=function(){var Ka=new T;Ka.addCustomProperty("appName","Excel");Ka.addCustomProperty("buildVersion",
we.AFrameworkApplication.buildVersion);Ka.addCustomProperty("shouldUseSourceMaps","true");Ka.addCustomProperty("shouldFilterSensitiveResources","true");Ka.addCustomProperty("shouldUseJSSelfProfilerSpecificDeobfuscator",this.iEj().toString());return Ka};tb.prototype.gch=function(Ka,sa,wb){var Nd=new T;Nd.addCustomProperty("ProfilerName",Ka);this.RNf.set(Ka,Nd);sa=this.SId.createProfiler(sa,wb,Nd);this.Hbb.set(Ka,sa);Wd.EwaSettings.isChangeGateEnabled("OfficeVSO:5786153_JsProfilerAddSlowActionsRetriever")&&
(Ka=this.xah(Ka),sa.subscribeProfilerObserver(Ka,this.q7i));return sa};tb.prototype.G5e=function(Ka){return this.RId(Ka)?this.Hbb.get(Ka):(je.ULS.shipAssertTag(537155520,0,!1,"JsSelfProfilerManager.GetProfiler: Profiler with such name ({0}) does not exist",Ka),null)};tb.prototype.djd=function(Ka,sa,wb){wb=void 0===wb?null:wb;if(this.RId(Ka))return this.G5e(Ka);var Nd=this.Yui;return this.createProfiler(Ka,Nd,null!=wb&&0<Nd?wb/Nd:2E6,2===sa?this.OFe:null,0===sa?null:this.profilingIntervalInMs,sa)};
tb.prototype.xah=function(Ka){var sa=Wd.EwaSettings.isChangeGateEnabled("OfficeVSO:5960700_ShouldCreateProfilerAfterInteractivityTracker")?this.interactivityTrackerService:ef.b(this.$);if(sa){var wb=sa.LIe();if(wb){sa=this.Hbb.get(Ka);var Nd=new ua(wb);sa.subscribeCallTreeCustomPropertiesRetriever(Nd);sa=new Eb(function(ee){wb.startCollectingSlowActions(ee)},Object($c.a)(wb,wb.stopCollectingSlowActions,"stopCollectingSlowActions"));this.TId.set(Ka,sa);return sa}je.ULS.sendTraceTag(537155491,0,15,
"JsSelfProfilerManager.CreateInteractivityTrackerObserver: CreateSlowActionsRetriever returned null");return null}je.ULS.sendTraceTag(537155490,0,15,"JsSelfProfilerManager.CreateInteractivityTrackerObserver: call to InteractivityTracker returned null");return null};tb.prototype.pgi=function(){this.SNf=officeOnlineCpuProfiling.getJSCPUProfilingPackageRetriever();this.RNf=new Map;this.TId=new Map;this.Hbb=new Map};tb.prototype.Xjf=function(Ka){return!!Ka};tb.prototype.iEj=function(){return Wd.EwaSettings.isChangeGateEnabled("OfficeVSO:6175394_UsingOldDeobfuscatorWithEs2015")?
!$g.a(this.$.ya,34):!0};Object(yd.a)(tb,"JsSelfProfilerManager",null,[785,3]);var nf=qe.a;Am(Ha,nf);Ha.prototype.create=function(){var Ka=this;je.ULS.sendTraceTag(537155489,0,50,"JsSelfProfilerManagerFactory.Create: loading officeOnlineCpuProfiling script");var sa=Rc.GetServiceTaskFactory.Ua(this.$.da,283,284,this.ub);nd.TaskExtensions.Ba(sa,function(){Wd.EwaSettings.isChangeGateEnabled("OfficeVSO:5960700_ShouldCreateProfilerAfterInteractivityTracker")?Ka.$.da.Ya(443,function(wb){Ka.NHe(sa.result,
wb)}):Ka.NHe(sa.result)},this.$.la,3)};Ha.prototype.NHe=function(Ka,sa){var wb=this;nd.TaskExtensions.Ba(Fe.c(Ka.ho.loadScript("officeOnlineCpuProfiling")),function(){wb.Eb(wb.$.da.Aa(437)||new tb(wb.$,sa))},this.$.la,3)};Ha.ka=function(Ka){Ka.da.Ha(438,new Ha(Ka))};Object(yd.a)(Ha,"JsSelfProfilerManagerFactory",qe.a,[]);Object(yd.a)(nc,"ActionData",null,[]);Object(yd.a)(Nb,"BlockedEngagementInfo",null,[]);Am(Hc,nc);Object(yd.a)(Hc,"SuccessfulActionData",nc,[]);Object(yd.a)(Cc,"SuccessfulEngagementInfo",
null,[]);var Qe=b(42);rc.prototype.dispose=function(){this.$.ea&&this.$.ea.Kp(this.fh);this.$.En(this.rd);Ke.a.Fa(this.VNb);this.$=this.VNb=null};rc.prototype.mbj=function(Ka,sa,wb){if(void 0!==Ka&&null!==Ka&&sa){var Nd=this.tfb.successfulActions.length+1,ee="InputMethod"in sa?sa.InputMethod:"",yf="IsCommand"in sa&&sa.IsCommand;if(this.uti(Ka,sa,ee,yf)){if(Wd.EwaSettings.isChangeGateEnabled("OfficeVSO:6169701_NonEssentialCookiesOnUserInteractive")){var sg=!yf&&Ka;this.eYe||sg===Qd.a.$jg||sg===Qd.a.akg||
sg===Qd.a.Xjg||sg===Qd.a.Yjg||(this.eYe=!0,this.F7g(void 0))}Nd>rc.stf||(Ka=Object.assign(new Hc,{order:Nd,name:Ka,componentName:"Location"in sa?sa.Location:"",timeFromNavigationStart:wb,inputMethod:ee,isCommand:yf}),Array.add(this.tfb.successfulActions,Ka),1===Nd?this.Hzi():Nd===rc.stf&&this.tDb())}}};rc.prototype.$aj=function(Ka){Qe.a(this.$).i0b(this.MGb);this.Eqb.hasBlockedActions=!0;this.MGb(null,Ka)};rc.prototype.Uyi=function(){je.ULS.sendTraceTag(254546634,0,50,"{0}",zc.c(this.Eqb))};rc.prototype.Hzi=
function(){Md.PageLoadTrackingInfo.instance.Hka(new Date)>rc.gGh?je.ULS.sendTraceTag(537154758,0,50,"First user interaction was filtered: {0}",zc.c(this.tfb.successfulActions[0])):je.ULS.sendTraceTag(254563592,0,50,"{0}",zc.c(this.tfb.successfulActions[0]))};rc.prototype.tDb=function(){!this.Iag&&this.tfb.successfulActions.length&&(this.Iag=!0,Ke.a.Fa(this.VNb),this.VNb=null,this.$.sendBeaconTraceTag(254559496,50,!1,zc.c(this.tfb)))};rc.prototype.VFh=function(){this.zKa.add(Qd.a.mWc);this.zKa.add(Qd.a.DQd);
this.zKa.add(Qd.a.QHd);this.zKa.add(Qd.a.vMf);this.zKa.add(Qd.a.xMf);this.zKa.add(Qd.a.zMf)};rc.prototype.uti=function(Ka,sa,wb,Nd){wb=!wb||"unknown"===wb;var ee="IsSystemInitiated"in sa&&sa.IsSystemInitiated;sa="NoReporting"in sa&&sa.NoReporting;var yf=this.zKa.has(Ka);Ka=Je.a.equals(Ka,Qd.a.rxc,!0)&&wb;return!ee&&!sa&&!yf&&!Ka&&!(Nd&&wb)};rc.stf=10;rc.gGh=6E4;rc.jMj=12E4;Object(yd.a)(rc,"PageLoadEngagementInfo",null,[784]);var fh=qe.a;Am(jb,fh);jb.prototype.create=function(){this.Eb(this.$.da.Aa(432)||
this.$.da.Ha(432,new rc(this.$)))};jb.ka=function(Ka){Ka.da.Ha(433,new jb(Ka))};Object(yd.a)(jb,"PageLoadEngagementInfoFactory",qe.a,[]);var Rg=b(50),ah=b(140),pg=b(560),Ga=b(36),Hb=b(393),Dc=b(34),Bd=b(234),Fd=Sys.EventArgs;Am(Va,Fd);Object(yd.a)(Va,"ErrorDataArgs",Sys.EventArgs,[]);var Be=b(741),Me=b(110),sf=b(27);ic.prototype.dyj=function(Ka){this.x7b||(this.Kje=Ka,this.Jje=Me.toUtc(this.OKb))};ic.prototype.Kbi=function(Ka){if(Ka.Values&&(!this.E6a||!this.F6a))try{fc.a.ccf in Ka.Values&&(this.E6a=
parseInt(Ka.Values[fc.a.ccf].toString(),10));fc.a.dcf in Ka.Values&&(this.F6a=parseInt(Ka.Values[fc.a.dcf].toString(),10));var sa=kf.a.instance;0<this.E6a&&(this.mqf(this.E6a,"PageLoadFromHostClick"),sa.obj(this.E6a));0<this.F6a&&(this.mqf(this.F6a,"PageLoadFromHostFrameCreation"),sa.pbj(this.F6a));var wb=Ka.Values[fc.a.Nbi]||0,Nd=Ka.Values[fc.a.Lbi]||Ka.Values[fc.a.Mbi]||0;0<Nd&&sa.bbj(Nd);sa.cbj(wb)}catch(ee){}};ic.prototype.Wlj=function(){this.z_f=this.bDe=sf.a.Ra.Ob;this.Qge=0;this.wnd=this.x7b=
!1};ic.prototype.Ize=function(Ka){var sa=this.bDe.getTime();return sa>=Ka?0:Ka-sa+this.MJf};ic.prototype.mqf=function(Ka,sa){if(Ka){var wb=Ib.b();wb.INb("UserAction",sa,sa,sf.a.ODb(Ka),Be.EcmaDateClock.instance.appStart);wb.Iub(sa,Me.toTimestamp(this.OKb))}};uk.Object.defineProperties(ic.prototype,{MJf:{configurable:!0,enumerable:!0,get:function(){return this.Qge}},OKb:{configurable:!0,enumerable:!0,get:function(){return this.Kje}},y_f:{configurable:!0,enumerable:!0,get:function(){return this.Jje}},
Wui:{configurable:!0,enumerable:!0,get:function(){return this.Ize(this.z_f.getTime())}},O0i:{configurable:!0,enumerable:!0,get:function(){return this.Ize(this.y_f.getTime())}},p6f:{configurable:!0,enumerable:!0,get:function(){return!(this.x7b||void 0===window.bsqmXLSPageLoadStartTime)}},bDe:{configurable:!0,enumerable:!0,get:function(){try{return this.ISb||(this.ISb=Me.toUtc(window.bsqmXLSPageLoadStartTime)),this.ISb}catch(Ka){return null}},set:function(Ka){this.ISb=Ka}}});Object(yd.a)(ic,"PageLoadPerfInfo",
null,[]);var Qa=b(71);rb.prototype.xLb=function(Ka,sa){Ka&&(this.XTc=this.jfb|sa<<16)};uk.Object.defineProperties(rb.prototype,{jfb:{configurable:!0,enumerable:!0,get:function(){return this.XTc}},keyCode:{configurable:!0,enumerable:!0,get:function(){return this.jfb&65535}}});Object(yd.a)(rb,"ShortcutSqmData",null,[]);Ta.prototype.oZg=function(Ka,sa,wb){0===wb&&(wb=this.C3g[sa.toString()]);return Ta.o6f(Ka,wb)&&(Ka=new rb(Ka,wb,Bc.a.isMac),!Dc.a.Eg(this.Sxd,Ka.jfb.toString()))?(this.Sxd[Ka.jfb.toString()]=
!0,Ka):null};Ta.prototype.nXf=function(){this.Sxd={}};Ta.t9g=function(){var Ka={};return Ka["0"]=0,Ka["1"]=1,Ka["2"]=2,Ka["4"]=3,Ka["8"]=4,Ka["16"]=5,Ka["32"]=6,Ka};Ta.Bni=function(Ka){return 112<=Ka&&123>=Ka||61440<=Ka&&61451>=Ka};Ta.Noi=function(Ka){return 17!==Ka&&18!==Ka&&16!==Ka&&91!==Ka&&93!==Ka};Ta.o6f=function(Ka,sa){var wb=Ka.ctrlKey||Ka.altKey||Qa.b(Ka);Ka=Ka.keyCode;wb=Ta.Bni(Ka)||wb;wb=Ta.Noi(Ka)&&wb;return 0!==sa&&wb};Object(yd.a)(Ta,"UnhandledShortcutLogger",null,[]);pc.prototype.p_b=
function(Ka){Array.add(this.M4b,Ka)};pc.prototype.Mca=function(Ka,sa,wb){try{if(sa)sa.endTime=wb,this.sqmManager.fpe(sa);else{sa=0;for(var Nd=this.M4b.length;sa<Nd;sa++){var ee=this.M4b[sa];Ka?(ee.endTime=ee.startTime,ee.jEe=0):ee.endTime=wb;this.sqmManager.fpe(ee)}}}catch(yf){}finally{Array.clear(this.M4b)}};Object(yd.a)(pc,"UserInteractionPerfInfo",null,[]);var cb=b(33),bc=b(65),yc=b(233),bd=Le.a;Am(yb,bd);yb.prototype.DXc=function(Ka){this.Oa.addHandler("EREK",Ka)};yb.prototype.qMd=function(Ka){this.Oa.removeHandler("EREK",
Ka)};yb.prototype.dispose=function(){this.Veh&&we.AFrameworkApplication.Ym&&we.AFrameworkApplication.Ym.disable();this.$&&this.$.En(this.rd);this.$=this.JEc=this.BQa=this.VU=null;bd.prototype.dispose.call(this)};yb.prototype.h$e=function(Ka){this.BQa.Kbi(Ka);this.Qzi()};yb.prototype.oRd=function(Ka){this.setDw(9415,Ka)};yb.prototype.p_b=function(Ka){this.JEc.p_b(Ka)};yb.prototype.Mca=function(Ka,sa,wb){this.JEc.Mca(Ka,sa,wb)};yb.prototype.txd=function(Ka){if(this.O3){var sa=this.ea.isNamedObjectViewMode&&
1===this.workbookContext.NovMode;Ka=this.$.isEditMode||Ka&&this.ea.workbookContext.Options&512?2:sa?9:this.ea.pc.inEmbedView?14:1;this.setDw(8721,Ka);this.aIh(Ka);this.yJc=!1}};yb.prototype.Aqf=function(){var Ka=this.BQa;this.O3&&Ka.p6f&&(this.setDw(9450,Ka.MJf),this.setDw(9085,Ka.Wui))};yb.prototype.Bqf=function(Ka){if(!this.PJb){this.PJb=!0;var sa=this.BQa,wb=0;this.O3&&sa.p6f?(sa.dyj(Ka),this.JEc.PNg=sa.y_f,this.setDw(9086,sa.O0i),sa.x7b=!0,wb=this.BQa.OKb.getTime()):wb=Ka.getTime();nd.TaskExtensions.Ba(this.$wb.value,
function(Nd){var ee={};Nd.result.Nj(xf.a.INg,(ee[fc.a.JNg]=wb,ee))},this.la,3)}};yb.prototype.fpe=function(Ka){this.O3&&Ka&&1!==Ka.Pea&&this.Lha(8327,Bd.b(Ka),Bd.n(Ka),Bd.a(Ka),2,Ka.jEe,Bd.o(Ka),Bd.d(Ka),Bd.e(Ka))};yb.prototype.vNd=function(Ka,sa){Ka&&Ka.MessageIdHash&&this.uNd(Ka.MessageIdHash,Ka.MessageIdName,Ka.MessageId,Ka.ErrorCause?Ka.ErrorCause:Rg.a.iDc,!1,sa,Ka,null)};yb.prototype.uNd=function(Ka,sa,wb,Nd,ee,yf,sg,bg){yb.appEncounteredFirstError||(yb.appEncounteredFirstError=!0,ah.a.get_instance().isCompleted(13)||
(ah.a.get_instance().Jv(13),je.ULS.sendTraceTag(537151323,0,50,"App encountered its first error so updating app init status")));Ka=this.Rub(Ka);var Yf=!!sg,xg={};xg.ErrorName=sa;xg.ErrorHashCode=Ka.toString();xg.ErrorId=wb.toString();xg.ErrorCause=Nd.toString();xg.ErrorType=0===yf?"ErrorDialog":"BusinessBar";xg.BusinessBarEntryName=bg||"null";xg.ServerCorrelationId=Yf?sg.CorrelationId:"null";xg.WebMethodName=Yf?sg.WebMethodName:"null";xg.SessionHostingEcs=this.ea.workbookContext?this.ea.workbookContext.EcsServerName:
"null";xg.WfeServerId=Yf?sg.WfeServerId:"null";sa=qf.a.Kc(xg);this.Oa.raiseEvent("EREK",new Va(xg));je.ULS.sendTraceTag(1881314,0,15,sa);this.O3&&(zd.a.aRf(Ka.toString()),this.Lha(9134,Ka,Nd,Rg.a.J_d),this.ea.uu||ee||(this.setDw(10459,Ka),this.txd(!0),this.imd=!0,this.upload(),this.Vdf()))};yb.prototype.Rub=function(Ka){return 5439488|(Ka>>>16^Ka&65535)&65535};yb.prototype.Lxd=function(Ka,sa,wb){Ka=this.rfg.oZg(Ka,sa,wb);this.O3&&Ka&&this.Lha(11007,Ka.jfb)};yb.prototype.upload=function(){!this.O3||
!this.PJb&&!this.imd||Bc.a.Hf&&we.AFrameworkApplication.Pg?Bc.a.Hf&&we.AFrameworkApplication.Pg&&je.ULS.sendTraceTag(537151320,0,15,"SqmManager.Upload: skipped UploadWsaData"):(this.VU.XPb(),this.yJc=!0);we.AFrameworkApplication.Ym=this.VU=null;this.BQa.Wlj();this.PJb=!1;we.AFrameworkApplication.Ym=this.VU=this.qPe();this.rfg.nXf()};yb.prototype.Qzi=function(){var Ka=this.BQa;if(this.O3&&!Ka.wnd){var sa=Ka.E6a,wb=Ka.F6a,Nd=Ka.OKb.getTime();we.AFrameworkApplication.oR=Ka.OKb;sa&&this.setDw(10324,sa>
Nd?0:Nd-sa);wb&&this.setDw(10325,wb>Nd?0:Nd-wb);Ka.wnd=!0}};yb.prototype.Lha=function(Ka,sa){for(var wb=[],Nd=1;Nd<arguments.length;++Nd)wb[Nd-1]=arguments[Nd];this.O3&&this.VU.Lha.apply(this.VU,[Ka].concat(Jl(wb)))};yb.prototype.setDw=function(Ka,sa){this.O3&&this.VU.setDw(Ka,sa)};yb.prototype.qPe=function(){Hb.a.MPe(this.$.ya);return we.AFrameworkApplication.Ym};yb.prototype.aIh=function(Ka){try{var sa=Object(fd.a)(Object,qf.a.ui(we.AFrameworkApplication.ha.appSettings.SessionStartInfoJson))}catch(ee){je.ULS.sendTraceTag(537151311,
0,15,"Couldn't parse SessionStartInfoJson. Message: {0}",ee.message);return}if(sa){var wb=Object(fd.a)(String,sa.ApplicationModeExtended),Nd=Object(fd.a)(String,sa.ApplicationMode);wb&&Nd&&(wb=wb.toUpperCase(),2!==Ka&&16!==Ka||"VIEW"!==wb&&"UNIFIED"!==wb?1!==Ka||"EDIT"!==wb&&"UNIFIED"!==wb||(wb="VIEW",Nd="View"):(wb="EDIT",Nd="Edit"),sa.ApplicationModeExtended=wb,sa.ApplicationMode=Nd,we.AFrameworkApplication.ha.appSettings.SessionStartInfoJson=qf.a.Kc(sa))}};yb.prototype.Vdf=function(){var Ka=this.$.ya;
this.VU.HW=!0;this.VU.OPb(Ka.BWsaStartTime);this.setDw(59,83);this.PJb=!1;if(this.O3){var sa=Ka.DocumentHostInfo;this.xdh();this.setDw(8491,this.$.sJ);this.setDw(9236,Ka.RequestedUILcid);this.setDw(8473,Ka.WacHostId);this.setDw(9902,Bd.c(sa.ClusterId));Wd.EwaSettings.ma(463)?this.VU.x2f(""):this.VU.x2f(Ka.FlightHolder?Ka.FlightHolder.FlightId:"");this.oRd(this.ea.pc.inEmbedView?1:0);this.imd=!1;this.setDw(9104,Bd.c(sa.FileSourceId));this.setDw(10309,this.bii);this.eAj();we.AFrameworkApplication.Ib.nSf(pg.a.getInstance(!1))}};
yb.prototype.eAj=function(){kf.a.instance.Lei(this.VU);if(this.r6f){var Ka=kf.a.instance;Ka.Xaj();Ka.kbj();Ka.jbj();Ka.ibj();Ka.ebj();this.r6f=!1}};yb.prototype.xdh=function(){this.createStream(8327,1,yc.a.Ogh,yc.a.D2a);this.createStream(9134,1,3,yc.a.D2a);this.createStream(11007,1,1,yc.a.D2a)};yb.prototype.createStream=function(Ka,sa,wb,Nd){this.VU.createStream(Ka,sa,wb,Nd)};uk.Object.defineProperties(yb.prototype,{Veh:{configurable:!0,enumerable:!0,get:function(){return this.yJc}},bii:{configurable:!0,
enumerable:!0,get:function(){return this.$.frame.GW?rf.a.dii:rf.a.cii}},workbookContext:{configurable:!0,enumerable:!0,get:function(){return this.$.workbookContext}},VU:{configurable:!0,enumerable:!0,get:function(){yb.tib||(yb.tib=this.qPe());yb.r0c||(yb.r0c=!0,this.Vdf());return yb.tib},set:function(Ka){yb.tib=Ka;yb.tib||(yb.r0c=!1)}},O3:{configurable:!0,enumerable:!0,get:function(){return $g.a(this.$.ya,3)}}});yb.tib=null;yb.r0c=!1;yb.appEncounteredFirstError=!1;Object(yd.a)(yb,"SqmManager",Le.a,
[452,736]);var Kd=b(951);Object(yd.a)(lb,"PerformanceObserverInit",null,[]);var de=Sys.EventArgs;Am(Cb,de);Object(yd.a)(Cb,"LongTaskObservedEventArgs",Sys.EventArgs,[]);var Re=Sys.EventArgs;Am(wc,Re);Object(yd.a)(wc,"LongTaskPerformanceObserverInitializedEventArgs",Sys.EventArgs,[]);Rb.prototype.yre=function(Ka){this.Oa.addHandler("ltoek",Ka)};Rb.prototype.khj=function(Ka){this.Oa.removeHandler("ltoek",Ka)};Rb.prototype.HJg=function(Ka){this.Oa.addHandler("ltpoiek",Ka)};Rb.prototype.lhj=function(Ka){this.Oa.removeHandler("ltpoiek",
Ka)};Rb.prototype.dispose=function(){this.$.ea.Kp(this.fh);Ke.a.Fa(this.Oa);this.$=this.Oa=null};uk.Object.defineProperties(Rb.prototype,{bhc:{configurable:!0,enumerable:!0,get:function(){return this.TMc}}});Object(yd.a)(Rb,"LongTaskPerformanceObserver",null,[3]);var ce=b(187);ib.prototype.Pti=function(Ka){return 100*this.Yxd>Ka};ib.prototype.kHg=function(Ka){this.uqe(Ka.longTaskDuration);this.qXc(Ka.activeSessionDuration)};ib.prototype.uqe=function(Ka){this.longTaskDuration+=Ka};ib.prototype.qXc=
function(Ka){this.activeSessionDuration+=Ka};uk.Object.defineProperties(ib.prototype,{Yxd:{configurable:!0,enumerable:!0,get:function(){return this.activeSessionDuration?this.longTaskDuration/this.activeSessionDuration:0}}});Object(yd.a)(ib,"LongTaskPerformanceData",null,[]);uk.Object.defineProperties(Da.prototype,{reportName:{configurable:!0,enumerable:!0,get:function(){return"LongTaskPerformance"}}});uk.Object.defineProperties(Da,{Roh:{configurable:!0,enumerable:!0,get:function(){return new Da(!1,
new ib,new ib,new ib,0)}}});Object(yd.a)(Da,"LongTaskPerformanceDataStatistics",null,[464]);var Jb=Sys.EventArgs;Am(Ja,Jb);Object(yd.a)(Ja,"LongTaskTrackedEventArgs",Sys.EventArgs,[]);var Mc=b(491),ld=b(394);pa.prototype.IJg=function(Ka){this.Oa.addHandler("lttek",Ka)};pa.prototype.mhj=function(Ka){this.Oa.removeHandler("lttek",Ka)};pa.prototype.dispose=function(){this.yUd=!1;this.U$f();this.$.Bl(this.vd);this.$.En(this.rd);this.lO.lhj(this.PDf);Ke.a.Fa(this.aPa);this.lO=this.$=this.aPa=null;void 0!==
this.Je&&null!==this.Je&&Ke.a.Fa(this.Je)};pa.prototype.VAc=function(){void 0===this.Je||null===this.Je?je.ULS.sendTraceTag(537153884,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but visibilityObserver is not ready yet"):this.lO.bhc?this.xkc?je.ULS.sendTraceTag(537153882,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but we already tracking"):this.yUd?(this.xkc=!0,this.D6=Da.Roh,this.zT=new ib,this.$.ea.Qha(this.JI),
this.maxUsersCount=this.$.ea.Om.length,this.lO.yre(this.Lpc),this.Je.IGa(this.Doc),this.Je.dpb(this.Eoc),we.AFrameworkApplication.vXc(this.Doc),we.AFrameworkApplication.wXc(this.Eoc),this.aPa=dg.a.instance.create(this.frf,this.Xxd,Ee.a.rqf,!1),Yc.a(this.$).t3(this.D6),this.Je.Hi||we.AFrameworkApplication.D8a||this.xWd(!0),je.ULS.sendTraceTag(537153880,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: Start tracking")):je.ULS.sendTraceTag(537153881,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but we still not ready to start tracking"):
je.ULS.sendTraceTag(537153883,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but longTaskPerformanceObserver InitializedSuccessfully")};pa.prototype.U$f=function(){this.xkc&&(this.xkc=!1,this.$.ea.Kp(this.fh),this.lO.khj(this.Lpc),this.$.ea.eea(this.JI),void 0!==this.Je&&null!==this.Je&&(this.Je.Bcb(this.Doc),this.Je.kJb(this.Eoc)),we.AFrameworkApplication.TTf(this.Doc),we.AFrameworkApplication.UTf(this.Eoc),this.aPa.cancel(),this.qOa=this.zT=this.D6=null,
this.maxUsersCount=0)};pa.prototype.xWd=function(Ka){Ka||void 0===this.qOa||null===this.qOa?(this.qOa=sf.a.Ra.Ob,this.aPa=ce.AsyncMethodContext.Bbh(this.frf,Ka?this.Xxd:this.Xxd-this.zT.activeSessionDuration,Ee.a.rqf,this.aPa)):je.ULS.sendTraceTag(589875356,0,15,"LongTaskPerformanceTracker:StampLastAppAwakeAndDocumentUnhiddenEcmaDateAndRestartTimer lastAppAwakeAndDocumentUnhiddenEcmaDate is not null when resuming a window")};Object(yd.a)(pa,"LongTaskPerformanceTracker",null,[3]);var fg=Ga.a;Am(nb,
fg);nb.prototype.Gq=function(Ka){this.addHandler("LTSCEK",Ka)};nb.prototype.er=function(Ka){this.removeHandler("LTSCEK",Ka)};nb.prototype.Xz=function(){this.wn("QueryLongTasksCount")&&this.raiseEvent("LTSCEK")};nb.prototype.Bs=function(Ka,sa){if("QueryLongTasksCount"!==Ka)return!1;this.k9h(sa);return!0};nb.prototype.wn=function(){return Wd.EwaSettings.ma(605)};nb.prototype.dispose=function(){this.statusBarManager&&(this.statusBarManager.tG(this),this.statusBarManager=null);this.F9a.mhj(this.QDf);
fg.prototype.dispose.call(this)};nb.prototype.k9h=function(Ka){Ka.Value=String.format("Long Tasks: {0} | Last Task Duration: {1}ms",this.orf,Math.round(this.Cnf))};Object(yd.a)(nb,"LongTasksStatusBarManager",Ga.a,[3,533,299]);var Se=b(8);Object(yd.a)(zb,"NetworkInfoData",null,[]);var tf=Ga.a;Am(gb,tf);gb.prototype.Gq=function(Ka){this.addHandler("NetworkInformation",Ka)};gb.prototype.er=function(Ka){this.removeHandler("NetworkInformation",Ka)};gb.prototype.t5a=function(){return this.u0?Object.assign(new zb,
{bandwidthMps:this.u0.downlink,rttMs:this.u0.rtt,connectionType:this.u0.type,effectiveConnection:this.u0.effectiveType,downlinkMaxMps:this.u0.downlinkMax}):null};gb.prototype.Bs=function(Ka,sa){if("QueryNetworkInformation"!==Ka)return!1;this.l9h(sa);return!0};gb.prototype.wn=function(){return this.dXc};gb.prototype.dispose=function(){this.dXc&&(this.statusBarManager&&(this.statusBarManager.tG(this),this.statusBarManager=null),this.u0&&this.u0.removeEventListener("change",this.Awf));this.$=null;tf.prototype.dispose.call(this)};
gb.prototype.m_d=function(Ka){return Se.HelperMethods.rm(window.navigator,Ka)?window.navigator[Ka]:null};gb.prototype.l9h=function(Ka){Ka.Value="Network: "+this.u0.downlink.toString()+" Mbps, "+this.u0.rtt.toString()+" ms"};Object(yd.a)(gb,"NetworkInformationManager",Ga.a,[533,299]);var af=b(199),Pf=b(20);Object(yd.a)(Za,"OperationStatisticsData",null,[]);var Sd=b(73);Ma.prototype.isGroup=function(Ka,sa,wb){var Nd=new af.a;Nd.addRange(Ka);Nd.addRange(sa);for(var ee=0;ee<this.operationsGroups.count;ee++)if(this.aqi(this.operationsGroups.pa(ee),
Nd,wb))return je.ULS.sendTraceTag(595194768,1,50,"OperationsGroupDetector: Operation '{0}' is part of a group ( operationsList: {1} , frameOperationsList: {2})",wb,this.xJf(Ka),this.xJf(sa)),!0;je.ULS.sendTraceTag(595194767,1,50,"OperationsGroupDetector: Operation '{0}' is NOT part of a group.",wb);return!1};Ma.prototype.aqi=function(Ka,sa,wb){for(var Nd=0,ee=0;ee<sa.count;ee++)if(sa.pa(ee).isGroupBreaking){if(Ka.count<=Nd||!Je.a.equals(sa.pa(ee).name,Ka.pa(Nd),!0))return!1;Nd++}return Ka.count>Nd&&
Je.a.equals(wb,Ka.pa(Nd),!0)};Ma.prototype.xJf=function(Ka){Ka=Sd.select(Ka,function(sa){return sa.name});return String.format("[{0}]",Sd.toArray(Ka).join(", "))};Ma.prototype.gei=function(){this.operationsGroups=new af.a;var Ka;this.UZa((Ka=new af.a,Ka.add("Paste"),Ka.add("SelectingRange_unknown"),Ka));var sa;this.UZa((sa=new af.a,sa.add("AutoSum"),sa.add("SelectingRange_unknown"),sa));var wb;this.UZa((wb=new af.a,wb.add("ChangeSheetDirection"),wb.add("ActiveItemChanged"),wb));var Nd;this.UZa((Nd=
new af.a,Nd.add("InsertSheet"),Nd.add("ActiveItemChanged"),Nd.add("SelectingRange_unknown"),Nd));var ee;this.UZa((ee=new af.a,ee.add("DeleteSheet"),ee.add("DialogButtonClick"),ee.add("ActiveItemChanged"),ee.add("SelectingRange_unknown"),ee));var yf;this.UZa((yf=new af.a,yf.add("EditBoxEndEdit"),yf.add("SetCell"),yf.add("SelectingRange_keyboard"),yf.add("MoveDownWithinSelectionOrCommitEdit"),yf))};Ma.prototype.UZa=function(Ka){this.operationsGroups.add(Ka)};Object(yd.a)(Ma,"OperationsGroupDetector",
null,[]);var Mf=b(26);oa.prototype.NJb=function(Ka,sa){var wb=Se.HelperMethods.kc(),Nd=Wd.EwaSettings.ma(373)?this.operationsGroupDetector.isGroup(this.CD,this.lF,Ka):!1;this.Pic=this.yjf(Ka);Wd.EwaSettings.ma(373)?this.Pic&&0<this.CD.count&&!Nd&&(this.XXj(),this.Hhg(Ka,wb),this.vYe()):0<this.CD.count&&this.yjf(Ka)&&(this.Hhg(Ka,wb),this.vYe());this.e9a=-1;if(Pf.g(this.$)&&Pf.g(this.$).Da){var ee=!this.I1.contains(Ka);wb=new Za(Ka,wb,void 0,void 0,void 0,ee,this.Pic,Nd);this.lF.add(wb);this.framePerformanceTracker&&
this.framePerformanceTracker.yKj(wb.name,sa);Wd.EwaSettings.ma(373)&&!this.UKb&&this.EJb.contains(Ka)&&(this.UKb=!0);-1===this.VYc&&(this.VYc=window.requestAnimationFrame(this.fkj))}else je.ULS.sendTraceTag(537153879,1,10,"Grid == null or BlockManager == null")};oa.prototype.Dvc=function(){this.e9a=Se.HelperMethods.kc()};oa.prototype.Kvc=function(){this.CD.count||this.lF.count?(this.PPb(this.lF,this.e9a),this.PPb(this.CD,this.e9a)):je.ULS.sendTraceTag(0,1,50,"ReportOnBlockCacheConsistant when no operations in the list. Last block render time: {0}",
this.e9a);this.e9a=-1};oa.prototype.yjf=function(Ka){return!this.G0.contains(Ka)&&!Ka.includes("Menu")&&!Ka.includes("TellMe")};oa.prototype.vYe=function(){for(var Ka=0;Ka<this.CD.count;Ka++){var sa=this.CD.pa(Ka);this.dJ.hDg(sa);this.rAi(sa)}this.CD.clear()};oa.prototype.TYj=function(Ka){for(var sa=0;sa<this.lF.count;sa++)this.lF.pa(sa).startToNextFrame=this.Yid(this.lF.pa(sa).startTime,Ka),this.lF.pa(sa).wasHidden=Kd.a.nD(this.lF.pa(sa).startToNextFrame)};oa.prototype.Hhg=function(Ka,sa){for(var wb=
0;wb<this.CD.count;wb++)-1===this.CD.pa(wb).startToResponseRenderEnd&&(this.CD.pa(wb).operationThatLedToLogging=Ka,this.CD.pa(wb).startToOperationThatLedToLogging=this.Yid(this.CD.pa(wb).startTime,sa))};oa.prototype.XXj=function(){for(var Ka=!1,sa=Cl(this.CD),wb=sa.next();!wb.done;wb=sa.next())if(wb.value.isPartOfGroup){Ka=!0;break}if(Ka)for(Ka=0;Ka<this.CD.count;Ka++)this.CD.pa(Ka).isPartOfGroup=this.CD.pa(Ka).isGroupBreaking};oa.prototype.PPb=function(Ka,sa){for(var wb=0;wb<Ka.count;wb++)Ka.pa(wb).startToResponseRenderEnd=
this.Yid(Ka.pa(wb).startTime,sa),Ka.pa(wb).wasHidden=Kd.a.nD(Ka.pa(wb).startToResponseRenderEnd)};oa.prototype.rAi=function(Ka){je.ULS.sendTraceTag(2020372336,1,50,"{0}",Ka)};oa.prototype.Yid=function(Ka,sa){return-1===Ka?-1:-1===sa?-2:sa-Ka};oa.prototype.KBi=function(Ka){Ka=Ka.getEntriesByType(rf.a.Vxd);for(var sa=0;sa<Ka.length;sa++)if(30>this.yDb.count)if(this.lF.count)this.yDb.add(this.t2i(Ka[sa]));else{var wb=Ka[sa];if(null===wb||void 0===wb?0:wb.attribution)void 0!==wb.attribution.containerSrc&&
null!==wb.attribution.containerSrc&&(wb.attribution.containerSrc=""),void 0!==wb.attribution.containerId&&null!==wb.attribution.containerId&&(wb.attribution.containerId=""),void 0!==wb.attribution.containerName&&null!==wb.attribution.containerName&&(wb.attribution.containerName="");je.ULS.sendTraceTag(40777251,1,50,"LongTaskObserverAction: long task occur when operations list was empty. {0}",wb)}else{je.ULS.sendTraceTag(537153874,1,50,"More then {0} long tasks are in the longTaskList. entries length: {1} First long task: {2}",
30,Ka.length,this.yDb.pa(0));break}};oa.prototype.t2i=function(Ka){return String.format("name:{0}, startTime:{1}, duration:{2}",Ka.name,Ka.startTime,Ka.duration)};oa.prototype.Cei=function(){this.I1||(this.I1=new vc.a(ug.a.Uk()),this.I1.add("ActiveItemChanged"),this.I1.add(Ib.b().yi(-1398645260)),this.I1.add(Ib.b().yi(722290388)),this.I1.add(Ib.b().yi(974713501)),this.I1.add(Mf.a.PR(Mf.a.B4b)),this.I1.add(Mf.a.PR(Mf.a.A4b)),this.I1.add(Mf.a.PR(Mf.a.$rb)),this.I1.add(Mf.a.PR(Mf.a.kOf)),this.I1.add(Mf.a.PR(Mf.a.hoa)))};
oa.prototype.iei=function(){this.G0||(this.G0=new vc.a(ug.a.Uk()),this.G0.add("PromptEditInBrowser"),this.G0.add(Ib.b().yi(-1398645260)),this.G0.add(Ib.b().yi(722290388)),this.G0.add(Ib.b().yi(974713501)),this.G0.add(Mf.a.PR(Mf.a.B4b)),this.G0.add(Mf.a.PR(Mf.a.A4b)),this.G0.add(Mf.a.PR(Mf.a.$rb)),this.G0.add(Mf.a.PR(Mf.a.kOf)),this.G0.add(Mf.a.PR(Mf.a.hoa)))};oa.prototype.hei=function(){this.EJb||(this.EJb=new vc.a(ug.a.Uk()),this.EJb.add("SelectingRange_keyboard"),this.EJb.add("SelectingRange_mouse"))};
Object(yd.a)(oa,"OperationStatistics",null,[]);var mf=b(640);Object(yd.a)($b,"RequestError",null,[]);Gb.V5g=function(Ka){if(!Ka)return[];var sa=[];Ka=Cl(Ka);for(var wb=Ka.next();!wb.done;wb=Ka.next())wb=wb.value,sa.push(new $b(wb.MessageIdName,wb.ErrorCause));return sa};Gb.SWh=function(Ka){return!Gb.JIi.contains(Ka)};Gb.dZh=function(){var Ka=new vc.a(ug.a.Uk());Ka.add("CheckPersistedContentUpdate");Ka.add("GetContentBundle");Ka.add("GetSessionStatus");Ka.add("GetStatusBarAggregates");Ka.add("PollSessionStatus");
Ka.add("UpdatePresenceUsers");Ka.add("UploadLatencyTelemetry");return Ka};Gb.OWh=function(Ka){return Gb.IKh.contains(Ka)};Gb.PWh=function(Ka){return Gb.v7i.contains(Ka)};Gb.wVh=function(){var Ka=new vc.a(ug.a.Uk());Ka.add("SetRichTextCell");Ka.add("Copy");Ka.add("FormatCells");Ka.add("PasteRange");Ka.add("FindCell");Ka.add("ApplyToRangesV2");Ka.add("ResizeRowsColumns");Ka.add("InsertDeleteCells");Ka.add("FillRange");Ka.add("PasteHtmlContent");Ka.add("ApplyFilter");Ka.add("PasteString");Ka.add("Undo");
Ka.add("LineageUpdateView");Ka.add("FindAll");Ka.add("ApplyHyperlink");Ka.add("AutoFit");Ka.add("GetPrintSettings");Ka.add("GetEdgeCell");Ka.add("Paste");Ka.add("MoveAndResizeFloatingObject");Ka.add("FindRange");Ka.add("SetCustomFilter");Ka.add("RenameSheet");Ka.add("ApplyThreadedComment");Ka.add("SortFilterColumn");Ka.add("InsertCopiedCutCells");Ka.add("InsertSheet");Ka.add("ToggleAutoFilter");Ka.add("ReorderSheets");Ka.add("SetOutlineLevel");Ka.add("RefreshAll");Ka.add("LineageOpenPaneOrChangeFilter");
Ka.add("ApplySlicerSelection");Ka.add("GetCardViewCardByCell");Ka.add("AutoSum");Ka.add("LineageClosePane");Ka.add("Sort");Ka.add("ClearAutoFilter");Ka.add("DeleteSheet");Ka.add("Redo");Wd.EwaSettings.isChangeGateEnabled("OfficeVSO:5317483_AdditionalOperationsInXlreqKPI")&&(Ka.add("RemovePageBreak"),Ka.add("InsertPageBreak"),Ka.add("SetPrintArea"),Ka.add("ClearPrintArea"));return Ka};Gb.QWh=function(){var Ka=new vc.a(ug.a.Uk());Ka.add("DeleteConditionalFormattingRules");Ka.add("GetConditionalFormattingRules");
Ka.add("AddConditionalFormattingRule");Ka.add("QuickEditConditionalFormattingRule");Ka.add("GetPrintSettings");Ka.add("UpdatePresenceUsers");Ka.add("GetThemeInfo");Wd.EwaSettings.isChangeGateEnabled("OfficeVSO:5738374_UTR_xlreq_lineage")&&(Ka.add("LineageOpenPaneOrChangeFilter"),Ka.add("LineageUpdateView"),Ka.add("LineageRefreshView"),Ka.add("LineageLoadMore"));Wd.EwaSettings.isChangeGateEnabled("OfficeVSO:6069680_UTR_xlreq_InsertCopiedCutCellsPasteRange")&&(Ka.add("InsertCopiedCutCells"),Ka.add("PasteRange"));
return Ka};Gb.JIi=Gb.dZh();Gb.IKh=Gb.wVh();Gb.v7i=Gb.QWh();Object(yd.a)(Gb,"RequestStatisticsData",null,[]);xa.prototype.Ovc=function(Ka,sa,wb,Nd,ee,yf,sg,bg,Yf,xg,oe,Gh,rh,Ph){Gh=mf.a(Gh);Ka=new Gb(Ka,sa,wb,Nd,ee,yf,sg,bg,Yf,Gh,xg,oe,Kd.a.nD(sa),this.xid(null),rh,this.Kma.t5a(),Ph);this.LNd(Ka)};xa.prototype.Vh=function(Ka,sa){Ka="UnknownMethodName";var wb=-1;void 0!==sa.context&&null!==sa.context&&(Ka=sa.context.methodName,wb=sa.context.communicationErrorRetryCount);var Nd={EcsOperationDuration:-1,
EcsRequestDuration:-1,WfeRequestDuration:-1,TimeFromLastEcsFreeze:-1,DuringLoadOnDemand:!1};if(sa.qd){var ee=sa.qd.Errors||[];this.dJ.Xjj(sa.qd.EditSessionIsDirty);void 0!==sa.qd.RequestTelemetryData&&null!==sa.qd.RequestTelemetryData&&(Nd=sa.qd.RequestTelemetryData)}else ee=[];var yf=sa.duration,sg=mf.a(sa.url);sa=new Gb(Ka,yf,sa.totalOperationDuration,sa.HYd,sa.TF,Nd,sa.aRd,ee,sa.httpStatus,sg,wb,!0,Kd.a.nD(yf),this.xid(sa.qd),sa.responseSize,this.Kma.t5a(),sa.responseToCallbackTime);this.LNd(sa)};
xa.prototype.Xn=function(Ka,sa){Ka="UnknownMethodName";var wb=-1;void 0!==sa.context&&null!==sa.context&&(Ka=sa.context.methodName,wb=sa.context.communicationErrorRetryCount);var Nd=sa.duration,ee=mf.a(sa.url);sa=new Gb(Ka,Nd,sa.totalOperationDuration,sa.HYd,sa.TF,{EcsOperationDuration:-1,EcsRequestDuration:-1,WfeRequestDuration:-1,TimeFromLastEcsFreeze:-1,DuringLoadOnDemand:!1},sa.aRd,sa.errors||[],sa.httpStatus,ee,wb,!1,Kd.a.nD(Nd),this.xid(null),-1,this.Kma.t5a(),sa.responseToCallbackTime);this.LNd(sa)};
xa.prototype.LNd=function(Ka){this.dJ.KMg(Ka);if(Wd.EwaSettings.ma(230)){var sa=Ka.requestName;if(sa!==rf.a.BLa&&"SetCell"!==sa&&"FindRange"!==sa&&"FindAll"!==sa&&"FindCell"!==sa)return}sa=Wd.EwaSettings.isChangeGateEnabled("OfficeVSO:5514802_UTRBasedOnULS_xlreq")&&!(void 0===Ka.requestName||null===Ka.requestName)&&Ka.isPromotedUTRRequest;xa.Dmh(Ka,sa);this.dJ.iDg(Ka)};xa.prototype.xid=function(Ka){var sa;if(null===(sa=null===Ka||void 0===Ka?void 0:Ka.CollaborationResult)||void 0===sa?0:sa.Users)return Ka.CollaborationResult.Users.length;
Ka=this.$.ea.Om.length;return 0<Ka?Ka:1};xa.Dmh=function(Ka,sa){sa?Ib.b().Fxc(388829456,0,15,Ka):(sa=Sys.Serialization.JavaScriptSerializer.serialize(Ka),je.ULS.sendTraceTag(388829456,0,50,sa));if(Wd.EwaSettings.isChangeGateEnabled("OfficeVSO:5294200_ReportXlreqKPI")&&void 0!==Ka.requestName&&null!==Ka.requestName&&Ka.isFullyLoggedKPIRequest){sa=new Map;sa.set("isUserTriggeredRequest",Ka.isUserTriggeredRequest.toString());sa.set("requestDuration",Ka.requestDuration.toString());sa.set("totalOperationDuration",
Ka.totalOperationDuration.toString());sa.set("requestTimeInQueue",Ka.requestTimeInQueue.toString());sa.set("requestInvokedTime",Ka.requestInvokedTime.toString());sa.set("ecsOperationDuration",Ka.ecsOperationDuration.toString());sa.set("ecsRequestDuration",Ka.EcsRequestDuration.toString());sa.set("wfeRequestDuration",Ka.WfeRequestDuration.toString());sa.set("timeFromLastEcsFreeze",Ka.TimeFromLastEcsFreeze.toString());sa.set("duringLoadOnDemand",Ka.DuringLoadOnDemand.toString());sa.set("correlationID",
Ka.correlationID);sa.set("errors",Ka.errors.toString());sa.set("httpStatus",Ka.httpStatus.toString());if(Ka.networkInfoData){var wb=Ka.networkInfoData;sa.set("networkInfoData_bandwidthMps",void 0===wb.bandwidthMps||null===wb.bandwidthMps?"NA":wb.bandwidthMps.toString());sa.set("networkInfoData_rttMs",void 0===wb.rttMs||null===wb.rttMs?"NA":wb.rttMs.toString());sa.set("networkInfoData_effectiveConnection",void 0===wb.effectiveConnection||null===wb.effectiveConnection?"NA":wb.effectiveConnection)}Ka.requestResourceTiming&&
(wb=Ka.requestResourceTiming,sa.set("requestResourceTiming_fetchStart",void 0===wb.downloadDuration||null===wb.downloadDuration?"NA":wb.downloadDuration.toString()));sa.set("communicationErrorRetryCount",Ka.communicationErrorRetryCount.toString());sa.set("successfulCall",Ka.successfulCall.toString());sa.set("isDocumentHidden",Ka.isDocumentHidden.toString());sa.set("coauthorsCount",Ka.coauthorsCount.toString());sa.set("responseSize",Ka.responseSize.toString());sa.set("responseToCallbackTime",Ka.responseToCallbackTime.toString());
Ib.b().Lvc(Ka.requestName,Ka.successfulCall,sa)}};Object(yd.a)(xa,"RequestStatistics",null,[]);var ud=b(208),Vf=b(83),Ih=b(323);Object(yd.a)(bb,"OperationTypeStatisticsData",null,[]);Ua.prototype.he=function(Ka){this.data.totalCount<Ua.j$c&&(Array.add(this.t$f,Ka.startToNextFrame),Array.add(this.u$f,Ka.startToResponseRenderEnd));this.data.totalCount++;this.data.longestStartToNextFrame<Ka.startToNextFrame&&(this.data.longestStartToNextFrame=Ka.startToNextFrame);this.data.longestStartToResponse<Ka.startToResponseRenderEnd&&
(this.data.longestStartToResponse=Ka.startToResponseRenderEnd)};Ua.prototype.Cdd=function(){0<this.data.totalCount&&(this.data.startToNextFramePercentiles=this.n5e(this.t$f),this.data.startToResponsePercentiles=this.n5e(this.u$f))};Ua.prototype.n5e=function(Ka){Ka.sort(Se.HelperMethods.uD);var sa="("+Kd.a.swa(Ka,25).toString();sa=sa+", "+Kd.a.swa(Ka,50).toString();sa=sa+", "+Kd.a.swa(Ka,75).toString();sa=sa+", "+Kd.a.swa(Ka,95).toString();return sa+")"};Ua.j$c=1E3;Object(yd.a)(Ua,"OperationTypeStatistics",
null,[]);Object(yd.a)(ab,"RequestTypeStatisticsData",null,[]);Fa.prototype.Ekj=function(Ka){this.data.totalCount<Fa.j$c&&Array.add(this.Ucb,Ka.requestDuration);this.data.totalCount++;this.GZd+=Ka.requestDuration;this.BZd+=Fa.bgd(Ka.ecsOperationDuration);this.AZd+=Fa.bgd(Ka.EcsRequestDuration);this.JZd+=Fa.bgd(Ka.WfeRequestDuration);0<Ka.TimeFromLastEcsFreeze&&Ka.TimeFromLastEcsFreeze<Fa.yKh&&this.data.callsDuringEcsFreeze++;Ka.successfulCall?this.data.successfulCalls++:this.data.unsuccessfulCalls++;
Ka.DuringLoadOnDemand&&this.data.callsDuringLoadOnDemand++;if(void 0===this.data.longestRequest||null===this.data.longestRequest||this.data.longestRequest.requestDuration<Ka.requestDuration)this.data.longestRequest=Ka};Fa.prototype.Cdd=function(){0<this.data.totalCount&&(this.data.averageDuration=Math.floor(this.GZd/this.data.totalCount),0<this.data.successfulCalls?(this.data.averageEcsOperationDuration=Math.floor(this.BZd/this.data.successfulCalls),this.data.averageEcsDuration=Math.floor(this.AZd/
this.data.successfulCalls),this.data.averageWfeDuration=Math.floor(this.JZd/this.data.successfulCalls)):(this.data.averageEcsOperationDuration=0,this.data.averageEcsDuration=0,this.data.averageWfeDuration=0),this.Ucb.sort(Se.HelperMethods.uD),this.data.requestDurationPercentile25=Kd.a.swa(this.Ucb,25),this.data.requestDurationPercentile50=Kd.a.swa(this.Ucb,50),this.data.requestDurationPercentile75=Kd.a.swa(this.Ucb,75),this.data.requestDurationPercentile95=Kd.a.swa(this.Ucb,95))};Fa.bgd=function(Ka){return 0>
Ka?0:Ka};Fa.yKh=3E3;Fa.j$c=1E3;Object(yd.a)(Fa,"RequestTypeStatistics",null,[]);Object(yd.a)(Aa,"SessionStatisticsData",null,[]);qa.prototype.rd=function(){var Ka=this.weh();Id.a.yea()?this.$.voa(ud.a.y2j,{xlendJson:Ka},!1):Vf.qb(this.$.na.ta,Ka,null,null,null,null,null);Ka=this.xeh();Id.a.yea()?this.$.voa(ud.a.z2j,{xlenoJson:Ka},!1):je.ULS.sendTraceTag(388776782,0,50,Ka);Wd.EwaSettings.ma(70)&&(Ka=this.S9g(),Id.a.yea()?this.$.voa(ud.a.x2j,{xlencJson:Ka},!1):je.ULS.sendTraceTag(388776770,0,50,Ka));
this.klj()};qa.prototype.zkc=function(){this.everConnectedToOcs=this.$.ea.N8a||this.everConnectedToOcs;jd.Health.instance&&jd.Health.instance.addOrUpdatePartCDimension("IsOcsSession",this.everConnectedToOcs.toString())};qa.prototype.fh=function(){var Ka=new Ih.a,sa="",wb=!this.$.isAnonymousUser(),Nd=Ka.xg();if(Nd){if(wb){Ka.xyc("UMI_Linkable","true");return}sa=Ka.o5a("UMI_Linkable")}wb||je.ULS.sendTraceTag(537153870,0,50,"SessionStatistics.OnCommandUIGeneratedAndGridInteractive: IsLocalStorageSupported:{0}, UMIIsLinkable:{1}",
Nd,!!sa)};qa.prototype.Scb=function(){this.sWd=!0};qa.prototype.Xjj=function(Ka){this.dirtySessionOnLastRecordedRequest=Ka};qa.prototype.KMg=function(Ka){this.maxCoauthorsCount=Math.max(this.maxCoauthorsCount,Ka.coauthorsCount);jd.Health.instance&&jd.Health.instance.addOrUpdatePartCDimension("MaxNumEditors",this.maxCoauthorsCount.toString())};qa.prototype.iDg=function(Ka){if(!(Ka.requestName in this.mob)){var sa=new Fa(Ka.requestName);this.mob[Ka.requestName]=sa}this.mob[Ka.requestName].Ekj(Ka)};
qa.prototype.hDg=function(Ka){if(!(Ka.name in this.lob)){var sa=new Ua(Ka.name,Ka.isUserOperation);this.lob[Ka.name]=sa}this.lob[Ka.name].he(Ka)};qa.prototype.t3=function(Ka){this.W7c[Ka.reportName]=Ka};qa.prototype.klj=function(){this.dirtySessionOnLastRecordedRequest=this.sWd=!1;this.epf=this.$.ea.Mwd;this.maxCoauthorsCount=1;this.everConnectedToOcs=!1;this.mob={};this.lob={};this.W7c={}};qa.prototype.weh=function(){var Ka=new Aa(this.$.isEditMode?"edit":"view",this.$.ea.ocsCapable,this.sWd,this.dirtySessionOnLastRecordedRequest,
this.$.ea.Mwd-this.epf,this.maxCoauthorsCount,this.everConnectedToOcs,this.mob);return Sys.Serialization.JavaScriptSerializer.serialize(Ka)};qa.prototype.xeh=function(){var Ka=new af.a,sa=this.lob,wb;for(wb in sa){var Nd=sa[wb];Nd.Cdd();Ka.add(Nd.data)}Ka=Ka.toArray();return Sys.Serialization.JavaScriptSerializer.serialize(Ka)};qa.prototype.S9g=function(){return Sys.Serialization.JavaScriptSerializer.serialize(this.W7c)};Object(yd.a)(qa,"SessionStatistics",null,[]);var Cf=Le.a;Am(ha,Cf);ha.prototype.dispose=
function(){this.$&&Wd.EwaSettings.ma(41)&&(this.$.En(this.rd),this.$.na.Rr(this.Vh),this.$.na.fA(this.Xn),this.$.ea.xUf(this.zkc),Wd.EwaSettings.isChangeGateEnabled("OfficeVSO:5638214_UMIIsLinkable")&&this.$.ea.Kp(this.fh));Ke.a.Fa(this.Kma);Ke.a.Fa(this.F9a);this.yPc=null;Ke.a.Fa(this.lO);this.lO=null;Ke.a.Fa(this.Zxd);this.$=this.Zxd=null;Cf.prototype.dispose.call(this)};ha.prototype.Scb=function(){Wd.EwaSettings.ma(41)&&this.dJ.Scb()};ha.prototype.Ovc=function(Ka,sa,wb,Nd,ee,yf,sg,bg,Yf,xg,oe,
Gh,rh,Ph){Wd.EwaSettings.ma(41)&&(this.boa=this.boa||new xa(this.$,this.dJ,this.Kma),this.boa.Ovc(Ka,sa,wb,Nd,ee,yf,sg,bg,Yf,xg,oe,Gh,rh,Ph))};ha.prototype.NJb=function(Ka,sa){Wd.EwaSettings.ma(41)&&(this.tna=this.tna||new oa(this.$,this.dJ,this,this.lO),this.tna.NJb(Ka,sa))};ha.prototype.Dvc=function(){Wd.EwaSettings.ma(41)&&(this.tna=this.tna||new oa(this.$,this.dJ,this,this.lO),this.tna.Dvc())};ha.prototype.Kvc=function(){Wd.EwaSettings.ma(41)&&(this.tna=this.tna||new oa(this.$,this.dJ,this,this.lO),
this.tna.Kvc())};ha.prototype.t3=function(Ka){Wd.EwaSettings.ma(41)&&this.dJ.t3(Ka)};ha.prototype.Ygd=function(Ka){return Wd.EwaSettings.ma(41)?this.GJe[Ka]:null};ha.prototype.e2f=function(Ka){Ka&&(this.GJe[Ka.type]=Ka)};ha.prototype.t5a=function(){return this.Kma.t5a()};ha.prototype.Mah=function(){Bc.a.yp&&void 0!==window.PerformanceObserver&&null!==window.PerformanceObserver&&(this.yPc=new pa(this.$,this.lO))};uk.Object.defineProperties(ha.prototype,{F9a:{configurable:!0,enumerable:!0,get:function(){return this.yPc}}});
Object(yd.a)(ha,"SessionStatisticsManager",Le.a,[735]);var ye=b(100),be=b(1281),Pg=b(116),We=b(127);da.prototype.VPj=function(){return qf.a.Kc(this)};Object(yd.a)(da,"AppUnloadInfo",null,[]);var Zh=b(904),hh=b(124),rg=b(625);ka.prototype.xXg=function(Ka){var sa=new Zh.a(rg.a.LK()),wb=0,Nd=0;Ka=Cl(Ka);for(var ee=Ka.next();!ee.done;ee=Ka.next()){ee=ee.value;sa.xb(ee)||sa.ia(ee,0);var yf=sa.ia(ee,sa.pa(ee)+1);yf>wb&&(wb=yf,Nd=ee)}wb>this.mostCommonOperationCount&&(this.mostCommonOperationName=hh.a(Nd),
this.mostCommonOperationCount=wb)};Object(yd.a)(ka,"DataLossInfo",null,[]);var th=b(56);ra.prototype.dispose=function(){this.$&&this.$.userOperationManager&&this.$.userOperationManager.Mij(this.DIf);this.xf&&(this.xf.YAa(this.mda),this.xf=null);this.xk.qB();this.$=this.xk=null};ra.prototype.Dhg=function(){this.Wyj();this.vdb()};ra.prototype.Wyj=function(){this.nz.wasOfflineDuringUnload=this.$.tf.zW;this.nz.timeFromLastConnectivity=Pg.a(sf.a.Ra,this.$.tf.Znf);this.nz.timeFromLastDisconnectionStart=
Pg.a(sf.a.Ra,this.$.tf.Fvi);this.nz.disconnectionSource=Enum.toString(be.a,this.$.tf.disconnectionSource);this.XVf&&(this.nz.hadConnectivityIssuesDuringUnload=this.$.tf.Ela,this.nz.timeFromLastStatusCode0=Pg.a(sf.a.Ra,this.$.tf.Ynf))};ra.prototype.vdb=function(){this.nz.timestamp=Date.now();this.localStorage.xyc(this.aZc,this.nz.VPj())};ra.prototype.G0f=function(){var Ka=this.localStorage.o5a(this.aZc);if(Ka)try{var sa=qf.a.ui(Ka);this.localStorage.PLd(this.aZc);var wb=this.WCi(sa);je.ULS.sendTraceTag(574677456,
0,50,wb)}catch(Nd){je.ULS.sendTraceTag(537151056,0,15,"AppUnloadTelemetryManager.SendLogFromLocalStorage: Exception message: {0}",Nd.message)}else je.ULS.sendTraceTag(574677457,0,50,"AppUnloadTelemetryManager.SendLogFromLocalStorage: No previous app-unload information")};ra.prototype.WCi=function(Ka){var sa={};sa.WACSessionID=Ka.wacSessionId;sa.wasRefreshed=this.n0g(Ka,this.$.ya.MaxAppReloadDurationIndicatingRefresh);sa.closedWithDialogConfirmation=Ka.dialogPromptedOnUnload;sa.wasOfflineDuringUnload=
Ka.wasOfflineDuringUnload;sa.TimeFromLastConnectivityMs=Ka.timeFromLastConnectivity;sa.TimeFromLastDisconnectionStart=Ka.timeFromLastDisconnectionStart;sa.wasDataLostDuringUnload=Ka.wasDataLostDuringUnload;sa.DataLossInfo=Ka.dataLossInfo;sa.flushedOnUnload=Ka.wasUpdatedOnUnload;sa.flushedOnBeforeUnload=Ka.wasUpdatedOnBeforeUnload;sa.InactivityDurationBeforeUnload=Ka.inactivityDurationBeforeUnloadSeconds;sa.DisconnectionSource=Ka.disconnectionSource;Wd.EwaSettings.isChangeGateEnabled("OfficeVSO:5144186_LogBeforeCloseNotificationApiStatusOnUnload")&&
(sa.ApiBeforeCloseNotificationEnabledOnUnload=Ka.apiBeforeCloseNotificationEnabledOnUnload);this.XVf&&(sa.hadConnectivityIssuesDuringUnload=Ka.hadConnectivityIssuesDuringUnload,sa.TimeFromLastStatusCode0=Ka.timeFromLastStatusCode0);Wd.EwaSettings.isChangeGateEnabled("OfficeVSO:5470513_trackSilentReopenUnloads")&&(sa.LastSilentReopenStartTime=Ka.lastSilentReopenStartTime,sa.LastSilentReopenEndTime=Ka.lastSilentReopenEndTime);return zc.c(sa)};ra.prototype.n0g=function(Ka,sa){var wb=window.performance.timing.navigationStart-
Ka.timestamp;(Ka=this.workbookHashedId===Ka.workbookHashedId&&wb<sa)&&je.ULS.sendTraceTag(537151055,0,50,"AppUnloadTelemetryManager.CheckRefresh: Session is after refresh");return Ka};ra.ka=function(Ka){Ka.ea.pc.inWebPart||Ka.da.Ha(410,new ra(Ka))};uk.Object.defineProperties(ra.prototype,{dialogPromptedOnUnload:{configurable:!0,enumerable:!0,get:function(){return this.z8d},set:function(Ka){this.z8d=Ka;this.nz?(this.nz.dialogPromptedOnUnload=Ka,this.vdb()):this.localStorage.xg()&&je.ULS.sendTraceTag(537151058,
0,10,"AppUnloadTelemetryManager.DialogPromptedOnUnload.set: AppUnloadInfo is null. isLocalStorageSupported: {0}",this.localStorage.xg())}},apiBeforeCloseNotificationEnabledOnUnload:{configurable:!0,enumerable:!0,get:function(){return this.Z4d},set:function(Ka){this.Z4d=Ka;this.nz?(this.nz.apiBeforeCloseNotificationEnabledOnUnload=Ka,this.vdb()):this.localStorage.xg()&&je.ULS.sendTraceTag(537151057,0,10,"AppUnloadTelemetryManager.DialogPromptedOnUnload.set: AppUnloadInfo is null. isLocalStorageSupported: {0}",
this.localStorage.xg())}}});ra.vEi=10;Object(yd.a)(ra,"AppUnloadTelemetryManager",null,[879,3]);var Oh=b(186),Xg=b(109);ba.prototype.N$f=function(){je.ULS.shipAssertTag(537151050,1,!this.stopped,"ChainedCallsTracer.CallMeasureContext.StopMeasuring: Calling stop after object was already stopped.");this.stopped||(this.stopped=!0,this.chainedCallsTracer.oLj(this))};ba.prototype.dispose=function(){this.N$f()};uk.Object.defineProperties(ba.prototype,{call:{configurable:!0,enumerable:!0,get:function(){return this.Ypg}}});
Object(yd.a)(ba,"CallMeasureContext",null,[897,3]);ia.prototype.H6g=function(){this.iVe=Se.HelperMethods.kc()};ia.prototype.K$f=function(){this.lcd+=Se.HelperMethods.kc()-this.iVe};ia.prototype.xWh=function(){return Se.HelperMethods.kc()-this.startTime};ia.prototype.hLj=function(){this.K$f();return this.lcd};uk.Object.defineProperties(ia.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return this._name}},type:{configurable:!0,enumerable:!0,get:function(){return this.vC}}});Object(yd.a)(ia,
"MeasuredCall",null,[]);aa.prototype.i$f=function(Ka,sa){this.gbh();this.kLj();Ka=new ia(Ka,sa);this.Ita.push(Ka);return new ba(this,Ka)};aa.prototype.gbh=function(){0<this.Ita.length?je.ULS.shipAssertTag(537151054,1,!!this.l2c,"ChainedCallsTracer.CreateNewChainIdIfNeeded: callsChain has items but chainId is null or empty."):this.l2c=Oh.a.create().toString()};aa.prototype.oLj=function(Ka){var sa=this.Ita.pop();if(Ka.call!==sa)je.ULS.sendTraceTag(537151053,0,10,"ChainedCallsTracer.StopMeasuringCall: Popped call is not the same as the topmost call in the chain. Popped call ID: {0} Topmost in the chain: {1}",
Ka.call.name,sa?sa.name:"null"),this.Ita=[];else{Ka=sa.xWh();var wb=sa.hLj();je.ULS.shipAssertTag(537151052,1,!!this.documentVisibilityObserver,"ChainedCallsTracer.IsInProximityToDocumentHidden: documentVisibilityObserver is null");var Nd=this.documentVisibilityObserver?this.documentVisibilityObserver.nD(Ka+this.yFi):null;this.zzi(sa,Ka,wb,Nd);this.I6g()}};aa.prototype.kLj=function(){var Ka=this.K3e();Ka&&Ka.K$f()};aa.prototype.I6g=function(){var Ka=this.K3e();Ka&&Ka.H6g()};aa.prototype.K3e=function(){return this.Ita.length?
this.Ita[this.Ita.length-1]:null};aa.prototype.zzi=function(Ka,sa,wb,Nd){if(!(sa<this.xFi)){var ee=Xg.f(this.Ita,function(yf){return yf.name}).join();je.ULS.sendTraceTag(537151051,0,50,"ChainedCallsTracer: Inclusive duration: {0} Exclusive duration: {1} Chain ID: {2} Call ID: {3} Type: {4} Document hidden: {5} Call chain: {6}",sa.toFixed(2),wb.toFixed(2),this.l2c,Ka.name,Ka.type,Nd,ee)}};aa.ka=function(Ka){if(Wd.EwaSettings.ma(703)){var sa=new aa(Ka.ya.ChainedCallsTracerMinThresholdToLogInMs);Ka.da.Ya(291,
function(wb){sa.documentVisibilityObserver=wb});Ka.da.Ha(425,sa);Ga.a.tuj(sa)}};Object(yd.a)(aa,"ChainedCallsTracer",null,[878]);var Sg=b(565);J.prototype.WQj=function(Ka){var sa={};sa=(sa.TaskName=Ka.TN,sa.TotalRunInMs=Ka.TRT,sa.TotalDelayInMs=Ka.TDT,sa.TotalQueueInMs=Ka.TQT,sa.TaskPriority=Ka.TP,sa.CoauthorsCount=this.ea.Om.length,sa);Ka.TDT>this.OYd||Ka.TRT>this.MYd?je.ULS.sendTraceTag(321938518,0,15,$e.a.toJSON(sa)):(Ka.TDT>this.NYd||Ka.TRT>this.LYd)&&je.ULS.sendTraceTag(321938508,0,50,$e.a.toJSON(sa))};
J.prototype.kGh=function(Ka){return this.Je.nD(Ka.TRT+Ka.TQT+3E3)?!1:Ka.TDT>Math.min(this.NYd,this.OYd)||Ka.TRT>Math.min(this.LYd,this.MYd)};Object(yd.a)(J,"TaskEventProcessor",null,[]);var gg=b(14);I.prototype.dispose=function(){this.$=null};I.prototype.Boj=function(){this.xKe||this.FXg();var Ka=Pf.c(Pf.g(this.$));if(!this.vKe){var sa=gg.a.instance.Va(279).split(",");Array.addRange(Ka,sa);this.vKe=!0}Ka=Cl(Ka);for(sa=Ka.next();!sa.done;sa=Ka.next())(sa=sa.value)&&!this.dcg.has(sa)&&(this.Kzi(sa),
this.dcg.add(sa))};I.prototype.Kzi=function(Ka){this.CYg(Ka)};I.prototype.FXg=function(){this.xKe=I.i5a("monospace");I.i5a("sans-serif");I.i5a("serif")};I.prototype.CYg=function(Ka){I.i5a(String.format("{0},{1}",Ka,"monospace"));I.i5a(String.format("{0},{1}",Ka,"sans-serif"));I.i5a(String.format("{0},{1}",Ka,"serif"))};I.ka=function(Ka){if(Wd.EwaSettings.ma(63)){var sa=new I(Ka);Ka.da.Ha(210,sa)}};I.i5a=function(Ka){var sa=document.createElement("div"),wb=document.createElement("div");sa.style.cssText=
"position: absolute; overflow: auto; visibility: hidden;";I.Hyj(wb,Ka);document.body.appendChild(sa);sa.appendChild(wb);wb.innerHTML="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ01234567890~!@#$%^&*()-+";Ka=wb.offsetWidth+"x"+wb.offsetHeight;document.body.removeChild(wb.parentNode);return Ka};I.Hyj=function(Ka,sa){Ka.style.cssText="display: inline; visibility: hidden;";Ka.style.fontSize="100px";Ka.style.fontWeight="normal";Ka.style.fontStyle="normal";Ka.style.letterSpacing="normal";Ka.style.lineHeight=
"normal";Ka.style.whiteSpace="nowrap";Ka.style.fontFamily=sa};Object(yd.a)(I,"FontTelemetryManager",null,[3]);var di=b(237),Jg=b(164),Mh;(function(Ka){Ka[Ka.legacyMultiLineRibbon=0]="legacyMultiLineRibbon";Ka[Ka.reactSingleLineRibbon=1]="reactSingleLineRibbon";Ka[Ka.reactMultiLineRibbon=2]="reactMultiLineRibbon";Ka[Ka.invalid=3]="invalid"})(Mh||(Mh={}));Object(yd.b)("RibbonMode",Mh);var $h=b(104),zh=Ga.a;Am(S,zh);S.prototype.IGa=function(Ka){this.addHandler("ekdh",Ka)};S.prototype.Bcb=function(Ka){this.removeHandler("ekdh",
Ka)};S.prototype.dpb=function(Ka){this.addHandler("ekduh",Ka)};S.prototype.kJb=function(Ka){this.removeHandler("ekduh",Ka)};S.prototype.nD=function(Ka){return this.Hi?!0:this.dlc?Me.getElapsedMilliseconds(this.dlc,sf.a.Ra.Ob)<Ka:!1};S.prototype.vJh=function(){this.B0d()};S.prototype.dispose=function(){Ke.a.Fa(this.a_);Ke.a.Fa(this.xk);zh.prototype.dispose.call(this)};S.prototype.B0d=function(){this.MM="hidden"===window.document.visibilityState;this.Hi?(this.raiseEvent("ekdh"),this.ade=sf.a.Ra.Ob):
(this.raiseEvent("ekduh"),this.bde=sf.a.Ra.Ob)};uk.Object.defineProperties(S.prototype,{Hi:{configurable:!0,enumerable:!0,get:function(){return this.MM}},rnf:{configurable:!0,enumerable:!0,get:function(){return this.ade}},dlc:{configurable:!0,enumerable:!0,get:function(){return this.bde}}});Object(yd.a)(S,"DocumentVisibilityObserver",Ga.a,[845,3]);Object(yd.a)(Z,"FramePerformanceData",null,[]);Object(yd.a)(ea,"FramePerformanceDataGroup",null,[]);uk.Object.defineProperties(O.prototype,{reportName:{configurable:!0,
enumerable:!0,get:function(){return this._reportName}}});Object(yd.a)(O,"FramePerformanceSessionEndsReport",null,[464]);Q.prototype.xbh=function(){this.Uha=new ea("AllGridOperationsData");this.nf.operationsGroups.push(this.Uha);this.Tsb("Selection","SelectingRange_keyboard SelectingRange_mouse WidgetSelectAll SelectAll ExtendDown ExtendEnd ExtendLeft ExtendRight ExtendRowEnd ExtendRowStart ExtendScreenDown ExtendScreenUp ExtendSelectionToA1 ExtendSelectionToUsedRangeEnd ExtendStart ExtendToBottomEdge ExtendToLeftEdge ExtendToRightEdge ExtendToTopEdge ExtendUp MoveRight MoveUp MoveLeft MoveDown MoveToRightEdge MoveToLeftEdge MoveToBottomEdge Goto GotoA1 GotoRowStart GotoUsedRangeEnd MoveRightWithinSelectionOrFunctionAutoComplete MoveLeftWithinSelection".split(" "));
this.Tsb("DragScroll",["DragScroll"]);this.Tsb("Scroll",["ViewportVerticalScroll","ViewportHorizontalScroll"]);this.Tsb("Typing",["GridTypingKeyPressed","FormulaBarTypingKeyPressed","EditBoxStartEdit"]);this.Tsb("FloatingObjects",["SelectingFloatingObject","FloatingObjectMove","FloatingObjectResize"])};Q.prototype.xkj=function(Ka,sa,wb,Nd){var ee=this.sVh(Ka);ee&&(Xg.b(this.nf.operationsGroups,function(yf){return Je.a.equals(yf.name,ee.name,!1)})||this.nf.operationsGroups.push(ee),ee.count++,this.eEc(sa,
ee),this.aEc(wb,ee),this.Uha.count++,this.eEc(sa,this.Uha),this.aEc(wb,this.Uha),0<Nd&&this.FXj(Nd,ee),0<=sa&&this.aXj(sa,ee))};Q.prototype.fYj=function(){for(var Ka=Cl(this.nf.operationsGroups),sa=Ka.next();!sa.done;sa=Ka.next())Q.eXj(sa.value)};Q.prototype.Tsb=function(Ka,sa){Ka=new ea(Ka);sa=Cl(sa);for(var wb=sa.next();!wb.done;wb=sa.next())this.HFd[wb.value]=Ka};Q.prototype.sVh=function(Ka){return Ka in this.HFd?this.HFd[Ka]:null};Q.prototype.aXj=function(Ka,sa){30>Ka&&this.e0d(function(wb){wb.l1FramePerformanceData.fpsUnderThresholdOps++},
sa);15>Ka&&this.e0d(function(wb){wb.l2FramePerformanceData.fpsUnderThresholdOps++},sa);5>Ka&&this.e0d(function(wb){wb.l3FramePerformanceData.fpsUnderThresholdOps++},sa)};Q.prototype.FXj=function(Ka,sa){100<=Ka&&(this.Lgb(sa.l1FramePerformanceData,Ka,this.Kgb),this.Lgb(this.Uha.l1FramePerformanceData,Ka,this.Kgb));300<=Ka&&(this.Lgb(sa.l2FramePerformanceData,Ka,this.Kgb),this.Lgb(this.Uha.l2FramePerformanceData,Ka,this.Kgb));600<=Ka&&(this.Lgb(sa.l3FramePerformanceData,Ka,this.Kgb),this.Lgb(this.Uha.l3FramePerformanceData,
Ka,this.Kgb))};Q.prototype.e0d=function(Ka,sa){sa&&(Ka(sa),Ka(this.Uha))};Q.prototype.Lgb=function(Ka,sa,wb){Ka&&wb(Ka,sa)};Q.prototype.eEc=function(Ka,sa){sa.minFPS=-1===sa.minFPS?Ka:Math.min(sa.minFPS,Ka)};Q.prototype.aEc=function(Ka,sa){sa.maxFPS=Math.max(sa.maxFPS,Ka)};Q.eXj=function(Ka){Q.F0d(Ka.l1FramePerformanceData,Ka.count);Q.F0d(Ka.l2FramePerformanceData,Ka.count);Q.F0d(Ka.l3FramePerformanceData,Ka.count)};Q.F0d=function(Ka,sa){Ka.fpsUnderThresholdOpsPercentage=100*Ka.fpsUnderThresholdOps/
sa;Ka.longFramesOverThresholdOpsPercentage=100*Ka.longFramesOverThresholdOps/sa};Object(yd.a)(Q,"FramePerformanceSessionEndsReportManager",null,[]);Object(yd.a)(U,"FpsDataWrapper",null,[]);Object(yd.a)(H,"LongFrameData",null,[]);var Eh=b(357);Object(yd.a)(C,"OperationFPSData",null,[]);var Xh=b(32),Fh=b(291),Kg=b(1004),Sh=Le.a;Am(E,Sh);E.prototype.start=function(){this.LOd=!0;this.resume()};E.prototype.stop=function(){this.LOd=!1;this.pause()};E.prototype.dispose=function(){this.stop();this.Je.Bcb(this.bX);
we.AFrameworkApplication.TTf(this.iyf);we.AFrameworkApplication.UTf(this.kyf);Ke.a.Fa(this.Je);this.Da.ar(this.Qg);Sh.prototype.dispose.call(this)};E.prototype.yKj=function(Ka,sa){var wb=Ka in this.jja?this.jja[Ka]:null;this.JCb=new Date;this.start();var Nd=this.JCb.getSeconds(),ee=Nd+this.DOj;wb&&Nd<=wb.end?(wb.count++,wb.end=ee):(wb&&Nd>wb.end&&this.pva.add(wb),this.jja[Ka]=new C(Ka,1,Nd,ee,void 0,void 0,void 0,this.$.ea.Om.length,Md.PageLoadTrackingInfo.instance.Hka(this.JCb),sa))};E.prototype.Q$g=
function(){this.w4a||(this.jed(new Date),this.w4a=new Q(this.$))};E.prototype.resume=function(){this.uhf()||!this.Da.yG||this.isSynthetic||(this.j9a=this.Je.Hi,this.Iya=new Date,this.Fvd=this.Iya.getMinutes(),this.fOd(),this.SLe(this.Iya.getSeconds()),this.Dpb=window.requestAnimationFrame(this.rZe))};E.prototype.uhf=function(){return 0<=this.Dpb};E.prototype.pause=function(){this.uhf()&&(this.j9a||(this.TLe((new Date).getSeconds()),je.ULS.sendTraceTag(21280654,0,50,"FPS : {0}",this.CZ.toString())),
window.cancelAnimationFrame(this.Dpb),this.Dpb=-1)};E.prototype.jed=function(Ka){if(Ka.getTime()-this.Iya.getTime()<E.vFi&&(this.j9a&&this.TLe(this.Iya.getSeconds()),this.iph(),0<this.pva.count&&(Ka={},Ka.NonEmptyCellsCount=this.w$a,Ka.TextCellsCount=this.fCc,Ka.xlfpsJson=Object.assign(new U,{f:this.pva.toArray()}),Ka.memoryInfo=this.IEi(),Ka.zoom=Xh.a(this.$)?Xh.a(this.$).zoom:1,Ka.HtmlOverlayDomCount=this.zMa,Ka.RibbonMode=Jg.a(this.$)?Mh[Jg.a(this.$).NX]:E.invalid,Ka.deviceMemory=navigator.deviceMemory||
0,Ka.hardwareConcurrency=navigator.hardwareConcurrency||0,Ka=JSON.stringify(Ka),je.ULS.sendTraceTag(537151044,0,50,"FPS : {0}",this.CZ.toString()),!this.isSynthetic))){Id.a.yea()?this.$.voa(ud.a.A2j,{xlfpsJson:Ka},!1):je.ULS.sendTraceTag(388781010,0,50,"{0}",Ka);if(this.hAi)for(var sa=Cl(this.pva),wb=sa.next();!wb.done;wb=sa.next()){wb=wb.value;var Nd=1E3>=this.w$a?"0_1000":3E3>=this.w$a?"1000_3000":"3000_inf",ee=new Map;ee.set("Operation",wb.Op);ee.set("BucketOfRenderedCells",Nd);jd.Health.instance.recordKpiUsage(ld.a.longFrame,
0,Mc.a.canvas,ee);0<wb.longFrameCount&&jd.Health.instance.recordKpiFailure(ld.a.longFrame,"LongFrame",!1,!0,Object.assign(new Fh.a,{extendedProperties:ee}));3E4<wb.tfAppInt&&(0<wb.longFrameCount?Ib.b().lWf(0,this.IBi,ee):Ib.b().mWf(0,ee))}je.ULS.sendTraceTag(537151043,0,50,"Operations message length: {0}",Ka.length)}this.reset()};E.prototype.IEi=function(){var Ka={};if(window.performance){var sa=window.performance.memory;sa&&(Ka.jsHeapSizeLimit=sa.jsHeapSizeLimit,Ka.usedJSHeapSize=sa.usedJSHeapSize,
Ka.totalJSHeapSize=sa.totalJSHeapSize)}return Ka};E.prototype.reset=function(){this.pva.clear();this.jja={};this.fOd()};E.prototype.iph=function(){var Ka=!0;Ka=void 0===Ka?!0:Ka;if(this.CZ){for(var sa=Cl(Kg.a(this.jja)),wb=sa.next();!wb.done;wb=sa.next())wb=this.jja[wb.value],wb.end=Math.min(this.CZ.length-1,wb.end),this.pva.add(wb);this.RXg(this.pva,this.CZ,Ka)}};E.prototype.RXg=function(Ka,sa,wb){wb=void 0===wb?!0:wb;Ka=Cl(Ka);for(var Nd=Ka.next();!Nd.done;Nd=Ka.next()){Nd=Nd.value;var ee=0,yf=
0;if(Nd.end<sa.length){for(var sg=Nd.start;sg<=Nd.end;sg++){var bg=sa[sg];0<=bg&&(Nd.Max=Math.round(Math.max(Nd.Max,bg)),Nd.Min=Math.round(Math.min(Nd.Min,bg)),ee+=bg,yf++)}0<yf&&(Nd.Avg=Math.round(ee/yf));wb&&this.w4a&&this.w4a.xkj(Nd.Op,Nd.Min,Nd.Max,Nd.LFrame?Nd.LFrame.duration:-1);Nd.Props&&(this.XSj(Nd),Nd.Props=null)}}wb&&this.w4a&&this.w4a.fYj()};E.prototype.fOd=function(){this.CZ=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0]};E.prototype.SLe=function(Ka){Ka++;for(var sa=0;sa<Ka;sa++)this.CZ[sa]=E.o8b};E.prototype.TLe=function(Ka){for(;60>Ka;Ka++)this.CZ[Ka]=E.o8b};E.prototype.gAi=function(Ka,sa){Ka=Ka.getSeconds();var wb=Kg.a(this.jja);if(0<wb.length){wb=Cl(wb);for(var Nd=wb.next();!Nd.done;Nd=wb.next())if(Nd=this.jja[Nd.value],Ka>=Nd.start&&Ka<Nd.end)Nd.LFrame?Nd.LFrame.duration<sa&&(Nd.LFrame.startSecond=Ka,Nd.LFrame.duration=sa,Nd.longFrameCount++):(Nd.LFrame=new H(Ka,sa),Nd.longFrameCount++)}};E.prototype.NXj=
function(){this.zMa=this.fCc=this.w$a=0;for(var Ka=Cl(Pf.g(this.$).zn),sa=Ka.next();!sa.done;sa=Ka.next()){sa=sa.value.XCa;for(var wb in sa){var Nd=this.Da.kl(sa[wb].hashCode);if(null===Nd||void 0===Nd?0:Nd.Vj)this.w$a+=Nd.ye.NonEmptyCellsCount,this.fCc+=Nd.ye.TextValueCellsCount,this.zMa+=Nd.zMa}}};E.prototype.XSj=function(Ka){var sa=Ka.Props;if(Na.a.EMb in sa&&sa[Na.a.EMb]&&Na.a.uOb in sa){var wb;(wb=Object(fd.a)(di.a,sa[Na.a.uOb]))&&wb.continueWith(function(Nd){$h.TextEditorTelemetry.instance.wFg(Ka.Op,
Ka.Min,!!Ka.LFrame,Ka.LFrame?Ka.LFrame.duration:0,Nd.result)})}};E.o8b=-1;E.vFi=6E4;E.invalid="Invalid";Object(yd.a)(E,"FramePerformanceTracker",Le.a,[895,3]);var Nh=qe.a;Am(t,Nh);t.prototype.create=function(){var Ka=this.$.da.Aa(263);Ka||(Ka=this.$.da.Ha(263,new E(this.$)));this.Eb(Ka)};t.ka=function(Ka){Ka.da.Ha(264,new t(Ka))};Object(yd.a)(t,"FramePerformanceTrackerFactory",qe.a,[]);var Gg=b(1333),vh=b(1145);A.prototype.Kh=function(Ka,sa){return new vh.a(Ka,sa)};A.prototype.Hc=function(Ka,sa){Ka=
this.Kh(Ka,sa);Ka.start();return Ka};Object(yd.a)(A,"DefaultStopwatchBuilder",null,[334]);v.prototype.Kh=function(Ka,sa){return this.bra.Kh(Ka,sa)};v.prototype.Hc=function(Ka,sa){return this.bra.Hc(Ka,sa)};Object(yd.a)(v,"StopwatchBuilder",null,[334]);var Hi=b(437),Tg=b(1006),ph=b(1132),Ag;(function(Ka){Ka[Ka.actions=0]="actions";Ka[Ka.correlationStart=1]="correlationStart";Ka[Ka.reorderSheetOp=2]="reorderSheetOp";Ka[Ka.formatCellOp=3]="formatCellOp";Ka[Ka.copyOp=4]="copyOp";Ka[Ka.pasteOp=5]="pasteOp";
Ka[Ka.getNumberViewModelDataOp=6]="getNumberViewModelDataOp";Ka[Ka.instantaneousSetData=7]="instantaneousSetData";Ka[Ka.immediateSetData=8]="immediateSetData";Ka[Ka.dependentCellsCalc=9]="dependentCellsCalc";Ka[Ka.dependentCellsGraphStat=10]="dependentCellsGraphStat";Ka[Ka.dependentCellsGraphSectionStat=11]="dependentCellsGraphSectionStat";Ka[Ka.getRangeContentPrefetchFailures=12]="getRangeContentPrefetchFailures";Ka[Ka.gridBlockUpdates=13]="gridBlockUpdates";Ka[Ka.browserAppStart=14]="browserAppStart";
Ka[Ka.linkedObjects=15]="linkedObjects";Ka[Ka.longFrames=16]="longFrames";Ka[Ka.task=17]="task";Ka[Ka.conflictInEditing=18]="conflictInEditing";Ka[Ka.incomingPresenceData=19]="incomingPresenceData";Ka[Ka.editorTableDelay=20]="editorTableDelay";Ka[Ka.presenceStartup=21]="presenceStartup";Ka[Ka.presenceDelete=22]="presenceDelete";Ka[Ka.editorEvent=23]="editorEvent";Ka[Ka.editorTime=24]="editorTime";Ka[Ka.gridScreenReaderOps=25]="gridScreenReaderOps";Ka[Ka.sendPresenceToService=26]="sendPresenceToService";
Ka[Ka.IME=27]="IME";Ka[Ka.freezePaneFloatingObjects=28]="freezePaneFloatingObjects";Ka[Ka.customizeStatusBar=29]="customizeStatusBar";Ka[Ka.clientWebRequests=30]="clientWebRequests";Ka[Ka.showCommentTaskPane=31]="showCommentTaskPane";Ka[Ka.applyThreadedCommentChange=32]="applyThreadedCommentChange";Ka[Ka.upgradeLegacyCommentsChange=33]="upgradeLegacyCommentsChange";Ka[Ka.findNextOrPreviousComment=34]="findNextOrPreviousComment";Ka[Ka.goto=35]="goto";Ka[Ka.launchOfficeAddInDialog=36]="launchOfficeAddInDialog";
Ka[Ka.richApiInvocation=37]="richApiInvocation";Ka[Ka.fxLibrary=38]="fxLibrary";Ka[Ka.embeddedApiSession=39]="embeddedApiSession";Ka[Ka.numberFormattingCalculator=40]="numberFormattingCalculator";Ka[Ka.requestDataAfterSend=41]="requestDataAfterSend";Ka[Ka.floatingObjectsStopwatchData=42]="floatingObjectsStopwatchData";Ka[Ka.copy=43]="copy";Ka[Ka.paste=44]="paste";Ka[Ka.dragDrop=45]="dragDrop";Ka[Ka.clearCopyState=46]="clearCopyState";Ka[Ka.webWorkerRecalcStats=47]="webWorkerRecalcStats";Ka[Ka.dataValidationEditOpenDialog=
48]="dataValidationEditOpenDialog";Ka[Ka.dataValidationEditSubmitRule=49]="dataValidationEditSubmitRule";Ka[Ka.customSort=50]="customSort";Ka[Ka.namedSheetViewUserAction=51]="namedSheetViewUserAction";Ka[Ka.namedSheetViewTeachingCallout=52]="namedSheetViewTeachingCallout";Ka[Ka.namedSheetViewTeachingDialog=53]="namedSheetViewTeachingDialog";Ka[Ka.namedSheetViewOptionsDialog=54]="namedSheetViewOptionsDialog";Ka[Ka.namedSheetViewTempViewApplyDialog=55]="namedSheetViewTempViewApplyDialog";Ka[Ka.namedSheetViewTempViewSaveDialog=
56]="namedSheetViewTempViewSaveDialog";Ka[Ka.temporaryViewStartedDataRestore=57]="temporaryViewStartedDataRestore";Ka[Ka.temporaryViewFetchedVersion=58]="temporaryViewFetchedVersion";Ka[Ka.raiseEventsAndGenerateBlockRequests=59]="raiseEventsAndGenerateBlockRequests";Ka[Ka.launchMakerCodeEditor=60]="launchMakerCodeEditor"})(Ag||(Ag={}));Object(yd.b)("UsageTable",Ag);var oh=b(444),Zg=b(518),Dg=b(692),li=b(743),zg=b(278),Ah=Sys.EventArgs;Am(B,Ah);Object(yd.a)(B,"CalculatedAverageUpdatedEventArgs",Sys.EventArgs,
[]);r.prototype.u3g=function(Ka){return new r(this.total+Ka.total,this.yPd+Ka.yPd)};r.RUg=function(Ka,sa){return String.format("{0}_{1}",Ka,sa)};uk.Object.defineProperties(r.prototype,{average:{configurable:!0,enumerable:!0,get:function(){return this.total/this.yPd}}});Object(yd.a)(r,"StopwatchAverage",null,[]);var Qg;(function(Ka){Ka[Ka.longFrame=0]="longFrame";Ka[Ka.longGetRange=1]="longGetRange";Ka[Ka.longJsTask=2]="longJsTask";Ka[Ka.viewportCalculationLoops=3]="viewportCalculationLoops"})(Qg||
(Qg={}));Object(yd.b)("UtrKpiVeto",Qg);w.O5a=function(Ka){return Enum.toString(Qg,Ka)};w.uVa="UTR";Object(yd.a)(w,"KpiConstants",null,[]);u.kjg="UTRVetoName";u.cjg="UTRErrorName";u.p_j="UTROperationName";u.I1d="UTRDuration";u.q_j="UTREndedInPhase";u.hjg="UTRMessage";u.jjg="UtrUnavailabilityType";u.operationName="OperationName";u.duration="Duration";u.message="Message";Object(yd.a)(u,"UtrAdditionalData",null,[]);h.A0j="VetoLike";h.jnh="E2EOperationPerf";h.alj="RequestPerf";h.QTj="UnavailabilityDurations";
Object(yd.a)(h,"UtrTypes",null,[]);n.prototype.MJb=function(Ka,sa,wb){wb=void 0===wb?null:wb;Wd.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||(wb=wb?Object.assign(new Fh.a,{extendedProperties:wb}):null,Ka=w.O5a(Ka),jd.Health.instance.recordKpiImpliedFailure("UTR_Veto_"+Ka,sa,!1,!0,"",wb))};n.prototype.oLb=function(Ka,sa,wb,Nd,ee,yf){yf[w.uVa]=h.A0j;yf[u.kjg]=w.O5a(Nd);yf[u.cjg]=ee;je.ULS.sendTraceTag(Ka,sa,wb,qf.a.Kc(yf));delete yf[w.uVa];delete yf[u.kjg];delete yf[u.cjg]};
Object(yd.a)(n,"UtrKpiVetoReporter",null,[]);m.prototype.JNd=function(Ka,sa){sa=void 0===sa?null:sa;Wd.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||jd.Health.instance.recordKpiUsage("UTR_Veto_Usage_"+w.O5a(Ka),0,"",sa)};m.prototype.MJb=function(Ka,sa,wb){wb=void 0===wb?null:wb;Wd.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||(Ka=w.O5a(Ka),jd.Health.instance.recordKpiFailure("UTR_Veto_Usage_"+Ka,sa,!1,!0,this.S5c(wb)))};m.prototype.kkj=function(Ka,
sa){sa=void 0===sa?null:sa;Wd.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||jd.Health.instance.recordKpiImpliedSuccess("UTR_Veto_Usage_"+w.O5a(Ka),"",this.S5c(sa))};m.prototype.jkj=function(Ka,sa,wb){wb=void 0===wb?null:wb;Wd.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||(Ka=w.O5a(Ka),jd.Health.instance.recordKpiImpliedFailure("UTR_Veto_Usage_"+Ka,sa,!1,!0,"",this.S5c(wb)))};m.prototype.S5c=function(Ka){return Ka?Object.assign(new Fh.a,{extendedProperties:Ka}):
null};Object(yd.a)(m,"UtrKpiVetoUsageReporter",null,[]);l.prototype.Evc=function(Ka,sa,wb){wb=void 0===wb?null:wb;Wd.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||jd.Health.instance.recordKpiImpliedSuccess("UTR_Perf_E2EOperation_"+Ka,"",Object.assign(new Fh.a,{extendedProperties:wb,durationMs:sa}))};l.prototype.Lvc=function(Ka,sa,wb){wb=void 0===wb?null:wb;Wd.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||(sa?jd.Health.instance.recordKpiImpliedSuccess("UTR_Perf_Request_"+
Ka,"",Object.assign(new Fh.a,{extendedProperties:wb})):jd.Health.instance.recordKpiImpliedFailure("UTR_Perf_Request_"+Ka,"",!1,!1,"",Object.assign(new Fh.a,{extendedProperties:wb})))};l.prototype.lLb=function(Ka,sa,wb,Nd,ee,yf,sg,bg){for(var Yf=[],xg=7;xg<arguments.length;++xg)Yf[xg-7]=arguments[xg];Yf=String.format.apply(null,[sg].concat(Yf));xg={};xg[w.uVa]=h.jnh;xg[u.p_j]=Nd;xg[u.q_j]=ee;xg[u.I1d]=yf;xg[u.hjg]=Yf;je.ULS.sendTraceTag(Ka,sa,wb,qf.a.Kc(xg))};l.prototype.nLb=function(Ka,sa,wb,Nd,ee,
yf){this.x4f(yf,Nd,ee);je.ULS.sendTraceTag(Ka,sa,wb,qf.a.Kc(yf));this.Fhh(yf)};l.prototype.mLb=function(Ka,sa,wb,Nd,ee,yf,sg){for(var bg=[],Yf=6;Yf<arguments.length;++Yf)bg[Yf-6]=arguments[Yf];bg=String.format.apply(null,[yf].concat(bg));Yf={};this.x4f(Yf,Nd,ee,bg);je.ULS.sendTraceTag(Ka,sa,wb,qf.a.Kc(Yf))};l.prototype.Fxc=function(Ka,sa,wb,Nd){Nd[w.uVa]=h.alj;je.ULS.sendTraceTag(Ka,sa,wb,qf.a.Kc(Nd));delete Nd[w.uVa]};l.prototype.x4f=function(Ka,sa,wb,Nd){Nd=void 0===Nd?null:Nd;Ka[w.uVa]=h.QTj;Ka[u.jjg]=
sa;Ka[u.I1d]=wb;Nd&&(Ka[u.hjg]=Nd)};l.prototype.Fhh=function(Ka){delete Ka[w.uVa];delete Ka[u.jjg];delete Ka[u.I1d]};Object(yd.a)(l,"UtrOperationPerfReporter",null,[]);var Bf=Ga.a;Am(e,Bf);e.prototype.NWd=function(Ka,sa,wb){this.INb(Ka,sa,wb,sf.a.ODb(sf.a.Ra.Ob.getTime()))};e.prototype.INb=function(Ka,sa,wb,Nd,ee){ee=void 0===ee?null:ee;if(this.w8[wb])throw Error.invalidOperation("The specified stopwatchId is already in use.");this.w8[wb]=this.OIe(Ka,sa,wb,Nd,ee)};e.prototype.cad=function(Ka){this.Iub(Ka,
sf.a.ODb(sf.a.Ra.Ob.getTime()))};e.prototype.Iub=function(Ka,sa){var wb=this.w8[Ka];wb&&(this.TEe(wb,sa),this.FVj(wb),delete this.w8[Ka])};e.prototype.HTf=function(Ka){delete this.w8[Ka]};e.prototype.v$f=function(Ka,sa){this.Ugb||this.k$f(Ka,sa)};e.prototype.f$f=function(){this.v$f(e.old,this.wh.ke)};e.prototype.hPe=function(Ka,sa){sa=void 0===sa?!1:sa;if(this.Ugb){if(this.ZDa===e.bGd||this.ZDa===e.old){var wb=kf.a.instance;wb.userSessionId=this.userSessionId;if(this.ZDa===e.bGd){this.Mxe||(this.Nca(Ka.m,
Object($c.a)(wb,wb.Waj,"recordContentFetchEnd")),this.Mxe=!0);if(sa){this.JKf||(this.Nca(Ka.m,Object($c.a)(wb,wb.fbj,"recordPerceivedContentDisplayed")),this.JKf=!0);return}this.Nca(Ka.m,Object($c.a)(wb,wb.Vaj,"recordContentDisplayed"))}else this.ZDa===e.old&&(sa=this.w8[this.ZPb])&&this.Nca(zg.a(Ka,sa.s),Object($c.a)(wb,wb.dbj,"recordInteractivityContentDisplayed"),!1)}this.Iub(this.ZPb,Ka);this.ZPb=this.ZDa=this.Ugb=null}};e.prototype.Nca=function(Ka,sa,wb){wb=void 0===wb?!0:wb;kf.a.JQ&&Object(Hi.a)(li.PerformanceClock,
sf.a.Ra)&&wb&&(Ka+=window.performance.timing.navigationStart);sa(Ka)};e.prototype.yi=function(Ka){return oh.a(Ka)};e.prototype.Te=function(Ka,sa,wb){wb=void 0===wb?!1:wb;try{this.jrf[Ag[Ka]]=!0,wb&&je.ULS.sendTraceTag(3704927,0,50,y(Ka,sa))}catch(Nd){je.ULS.sendTraceTag(3704928,0,10,"Error when serializing usage table: {0} exception: {1}",Ka,Nd)}};e.prototype.Z$c=function(Ka,sa,wb){if(this.Urc){var Nd=this.wYa[Ka+sa];Nd&&(Nd.e=wb,this.Ddd(Nd));delete this.wYa[Ka+sa]}};e.prototype.dxd=function(Ka,
sa){Ag[Ka]in this.jrf||this.Te(Ka,sa)};e.prototype.D2i=function(){this.wh.appStart&&this.k$f(e.bGd,this.wh.appStart)};e.prototype.lBi=function(Ka){var sa={};sa.a=Ka.i;sa.b=Ka.o;sa.c=Ka.t;sa.d=zg.a(Ka.s,Ka.p||this.wh.appStart);sa.e=zg.a(Ka.e,Ka.s);sa.f=Ka.c;sa.g=Ka.a;sa.h=Ka.h;this.Te(0,sa,this.Bpi(sa.b,sa.c))};e.prototype.Bpi=function(Ka,sa){return Array.contains(["CommandTask","QueuedTask","Task"],Ka)&&!Array.contains(this.iDh,sa)?!1:!0};e.prototype.xC=function(Ka,sa,wb,Nd,ee){if(Ka&&sa){var yf=
{};yf.a=Ka;yf.b=sa;yf.c=wb.toString();yf.d=Nd.toString();this.Te(15,yf,void 0===ee?!0:ee)}};e.prototype.Xqf=function(Ka,sa,wb,Nd){var ee={};Ka&&(ee.c=zg.a(Ka,this.wh.appStart));ee.b=sa;ee.a=wb;ee.d=Nd;this.Te(17,ee)};e.prototype.dispose=function(){var Ka=this;this.bSa.execute(function(sa){sa.deactivate(!0);sa.ugj(Ka.UFf)});this.Je&&this.Je.Bcb(this.bX);this.na&&this.na.fea(this.Z8);Bf.prototype.dispose.call(this)};e.prototype.m8e=function(){return this.jkg=this.jkg||new v};e.prototype.OIe=function(Ka,
sa,wb,Nd,ee){var yf={};yf.o=Ka;yf.t=sa;yf.p=void 0===ee?null:ee;yf.s=(void 0===Nd?null:Nd)||this.wh.ke;this.ipd(yf,void 0===wb?null:wb);return yf};e.prototype.TEe=function(Ka,sa){Ka&&(Ka.e=(void 0===sa?null:sa)||this.wh.ke,Ka.i=Ka.i||this.V1a.T9a(),Ka.c=Ka.c||this.uJe,Ka.a=Ka.a||this.AJe,Ka.h=void 0!==Ka.h&&null!==Ka.h?Ka.h:this.Je?this.Je.Hi:!1,this.Ddd(Ka))};e.prototype.erf=function(Ka){var sa=Ka.context;Ka.duration>e.Kmh&&(sa.methodName===rf.a.Ixb||sa.methodName===rf.a.BLa)&&this.Ivc(1,e.n0h);
if("GetSessionStatus"!==sa.methodName){var wb={};wb.a=sa.methodName;wb.b=sa.stopwatch.id;wb.c=Ka.Uvc;wb.d=Ka.responseSize;wb.e=sa.s4b;wb.f=Ka.qd?Ka.qd.StateId:rf.a.F_d;this.Te(30,wb,!0);this.xC(wb.b,Ka.qd.ServerCorrelationId,"clientWebRequests","ServerActions")}};e.prototype.X$f=function(){if(this.Urc){var Ka=this.wYa.LoadingUIShownSplashScreen;Ka&&Md.PageLoadTrackingInfo.instance.Ewj(Ka.s)}};e.prototype.Ivc=function(Ka,sa){this.ejg.MJb(Ka,sa,null)};e.prototype.mWf=function(Ka,sa){this.MEc.kkj(Ka,
void 0===sa?null:sa)};e.prototype.lWf=function(Ka,sa,wb){this.MEc.jkj(Ka,sa,void 0===wb?null:wb)};e.prototype.nWf=function(Ka){this.MEc.JNd(Ka,null)};e.prototype.oWf=function(Ka,sa){this.MEc.MJb(Ka,sa,null)};e.prototype.Evc=function(Ka,sa,wb){this.Ygb.Evc(Ka,sa,void 0===wb?null:wb)};e.prototype.Lvc=function(Ka,sa,wb){this.Ygb.Lvc(Ka,sa,void 0===wb?null:wb)};e.prototype.sendDNMTraceTag=function(Ka,sa,wb,Nd,ee){for(var yf=[],sg=4;sg<arguments.length;++sg)yf[sg-4]=arguments[sg];Wd.EwaSettings.ma(219)&&
je.ULS.sendTraceTag.apply(null,[Ka,sa,wb,Nd].concat(yf))};e.prototype.lLb=function(Ka,sa,wb,Nd,ee,yf,sg,bg){for(var Yf=[],xg=7;xg<arguments.length;++xg)Yf[xg-7]=arguments[xg];var oe;(oe=this.Ygb).lLb.apply(oe,[Ka,sa,wb,Nd,ee,yf,sg].concat(Yf))};e.prototype.nLb=function(Ka,sa,wb,Nd,ee,yf){this.Ygb.nLb(Ka,sa,wb,Nd,ee,yf)};e.prototype.mLb=function(Ka,sa,wb,Nd,ee,yf,sg){for(var bg=[],Yf=6;Yf<arguments.length;++Yf)bg[Yf-6]=arguments[Yf];var xg;(xg=this.Ygb).mLb.apply(xg,[Ka,sa,wb,Nd,ee,yf].concat(bg))};
e.prototype.oLb=function(Ka,sa,wb,Nd,ee,yf){this.ejg.oLb(Ka,sa,wb,Nd,ee,yf)};e.prototype.Fxc=function(Ka,sa,wb,Nd){this.Ygb.Fxc(Ka,sa,wb,Nd)};e.prototype.Ddd=function(Ka){this.vLj.lBi(Ka)};e.prototype.E2i=function(){if(this.Urc){Stw.swpc=null;var Ka=this.Urc,sa;for(sa in Ka)this.ipd(Ka[sa])}};e.prototype.sGh=function(){var Ka=this,sa=window[Zg.a.namespace];if(sa){var wb=sa[Zg.a.ZDe];wb&&(delete sa[Zg.a.ZDe],wb.forEach(function(Nd){Ka.ipd(Nd);Ka.Ddd(Nd)}))}};e.prototype.Rqi=function(Ka,sa){if("about:blank"===
Ka||"renamehandler.ashx"===sa&&"2"===ae.a.fD(Ka,"u"))return!0;for(Ka=0;Ka<this.UNd.length;Ka++)if(sa.endsWith(this.UNd[Ka]))return!0;return!1};e.prototype.Vyi=function(){var Ka=this;this.bSa.execute(function(sa){sa.hi(e.fRg,0);sa.HIg(Ka.UFf);sa.activate()})};e.prototype.Nyi=function(){var Ka={};Ka.a=new Date(Be.EcmaDateClock.instance.appStart.m);Ka.b=this.userSessionId;Ka.c=this.wh.Rcg;Ka.d=e.tgh*La.devicePixelRatio;Ka.e=sf.a.Ra.appStart.m;this.Te(14,Ka,!0);this.Nca(sf.a.Ra.appStart.m,Object($c.a)(kf.a.instance,
kf.a.instance.Oaj,"recordAppInitStart"))};e.prototype.k$f=function(Ka,sa){this.Ugb=this.V1a.T9a();this.ZPb=this.V1a.T9a();this.ZDa=Ka;this.INb("UserAction",Ka,this.ZPb,sa);this.Wpf(Ka,this.Ugb)};e.prototype.ENj=function(){var Ka=this,sa=window[Zg.a.namespace];sa&&!e.hHe&&(sa[Zg.a.sKj]=function(wb,Nd){return Ka.OIe(wb,Nd)},sa[Zg.a.kph]=function(wb){Ka.TEe(wb)},e.hHe=!0)};e.prototype.FVj=function(Ka){var sa=r.RUg(Ka.o,Ka.t),wb=new r(zg.a(Ka.e,Ka.s)),Nd=sa in this.dXd?this.dXd[sa].u3g(wb):wb;this.dXd[sa]=
Nd;if(wb===Nd||wb.average!==Nd.average)Ka=Object.assign(new B,{operation:Ka.o,target:Ka.t,aIi:Nd.average,sender:this}),this.raiseEvent(sa,Ka)};e.prototype.Wpf=function(Ka,sa){var wb={};wb.a=sa;wb.b=this.userSessionId;wb.c=Ka;this.Te(1,wb,!0)};e.prototype.rfi=function(){this.UNd=[rf.a.gej,rf.a.getSessionStatus,rf.a.BLa,rf.a.h3g,rf.a.V_g,rf.a.hVa,rf.a.Gdc,rf.a.getObjectMetadata,rf.a.setRichTextCell,rf.a.ILa,rf.a.EZj,rf.a.pollSessionStatus,rf.a.$2h,rf.a.n1h,rf.a.JWh]};e.prototype.ipd=function(Ka,sa){Ka.i=
(void 0===sa?null:sa)||this.V1a.T9a();Ka.a=this.AJe;Ka.c=this.uJe;Ka.h=this.Je?this.Je.Hi:!1};e.ka=function(Ka){var sa=new S;Ka.da.Ha(291,sa);sa=new e(Ka.ya.UserSessionId,void 0,void 0,void 0,sa,!0,Ka.na);sa.Wpf(e.awf,sa.pKe);je.ULS.sendTraceTag(524166239,0,50,"TelemetryManager: Activating BrowserResourceTiming Telemetry logs");sa.Vyi();sa.ENj();sa.D2i();sa.Nyi();sa.sGh();sa.E2i();sa.rfi();e.Auj(Ka);ye.a.ij.Ha(41,sa)};e.Auj=function(Ka){var sa=La.devicePixelRatio;1<sa&&Ka.pc.nx(!0,2<=sa?8388608:4194304)};
uk.Object.defineProperties(e.prototype,{w8:{configurable:!0,enumerable:!0,get:function(){return this.ple||(this.ple={})}},uJe:{configurable:!0,enumerable:!0,get:function(){return this.Ugb||this.pKe}},AJe:{configurable:!0,enumerable:!0,get:function(){return this.ZDa||e.awf}},dXd:{configurable:!0,enumerable:!0,get:function(){return this.Ywe=this.Ywe||{}}},Urc:{configurable:!0,enumerable:!0,get:function(){return this.wYa||"undefined"===typeof Stw?this.wYa:this.wYa=Stw.swpc}},jrf:{configurable:!0,enumerable:!0,
get:function(){return this.hee=this.hee||{}}},bSa:{configurable:!0,enumerable:!0,get:function(){return this.Umb||(this.Umb=Ec.a.instance.qc("Common.NetworkTiming.IResourceTimingLogger"))}},ejg:{configurable:!0,enumerable:!0,get:function(){return this.fjg||(this.fjg=new n)}},Ygb:{configurable:!0,enumerable:!0,get:function(){return this.ijg||(this.ijg=new l)}},MEc:{configurable:!0,enumerable:!0,get:function(){return this.gjg||(this.gjg=new m)}}});e.awf="UnassignedUserAction";e.bGd="PageLoad";e.old=
"GridUpdateOperation";e.Kmh=5E3;e.n0h="MoreThan_5000_Ms";e.tgh=96;e.fRg=30;e.hHe=!1;Object(yd.a)(e,"TelemetryManager",Ga.a,[730,731,732,733]);var Gi=b(200),Uh=b(103);Object(yd.a)(c,"Validation",null,[]);a.prototype.YWc=function(Ka,sa,wb,Nd,ee){if(Ka&&Nd){var yf=Gi.a.Bz(sa,wb);this.t_b(function(){return!!Uh.a(Ka).Mq(yf)},Nd.StateId,ee)}};a.prototype.t_b=function(Ka,sa,wb){this.uHg(this.nYe,Ka,sa,wb)};a.prototype.uHg=function(Ka,sa,wb,Nd){Ka&&sa&&wb!==rf.a.Re&&Ka.add(new c(sa,wb,Nd))};a.prototype.OKf=
function(Ka){if(Ka){for(var sa=new af.a,wb=Cl(Ka),Nd=wb.next();!Nd.done;Nd=wb.next()){Nd=Nd.value;if(Nd.TV===this.$.ea.af)try{Nd.e0j()||je.ULS.sendTraceTag(537151010,0,15,"ValidationTelemetryManager.PerformAndRemoveValidations: Validation result is false. Validation Name: [{0}]",Nd.name)}catch(ee){je.ULS.sendTraceTag(537151009,0,10,"ValidationTelemetryManager.PerformAndRemoveValidations: Validation has caused an exception to be thrown. Validation Name: [{0}]. Exception: [{1}]",Nd.name,ee)}sa.add(Nd)}sa=
Cl(sa);for(Nd=sa.next();!Nd.done;Nd=sa.next())Ka.remove(Nd.value)}else je.ULS.shipAssertTag(537151011,0,!!Ka,"ValidationTelemetryManager.PerformAndRemoveValidations: Validation list is null")};a.prototype.dispose=function(){Pf.g(this.$)&&Pf.g(this.$).Da&&(Pf.g(this.$).Da.ar(this.Qg),Pf.g(this.$).Da.iMd(this.I$a));this.$=null};a.ka=function(Ka){var sa=new a(Ka);Ka.da.Ha(277,sa)};Object(yd.a)(a,"ValidationTelemetryManager",null,[734,3]);Type.registerNamespace("_Ewa");Type.registerNamespace("Common.App.BrowserInfoLogger");
$d.main();Type.registerNamespace("CNT");Pc.main();Type.registerNamespace("CACPU");Zc.main();Type.registerNamespace("Common.App.EventsCacheManager");Uc.main();(function(){he.a.Ga(function(Ka){Ka.da.Ha(137,new mb(Ka))})})();(function(){he.a.Ga(function(Ka){Ka.da.Ha(37,new Xb(Ka))})})();(function(){he.a.Ga(function(Ka){ma.ka(Ka)})})();(function(){he.a.Ga(function(Ka){Ha.ka(Ka)})})();(function(){he.a.Ga(function(Ka){jb.ka(Ka)})})();(function(){he.a.Ga(function(Ka){Ka.da.Ha(40,new yb(Ka,new dc.a(function(){return Rc.GetServiceTaskFactory.create(Ka.da,
137,Ka.la,1)})))})})();(function(){he.a.Ga(function(Ka){Ka.da.Ha(276,new ha(Ka))})})();(function(){he.a.Ga(function(Ka){ye.a.ij.Ya(135,function(){e.ka(Ka);I.ka(Ka);a.ka(Ka);t.ka(Ka);Wd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UnregisterCpuMeter",!1)||P(Ka);ra.ka(Ka);aa.ka(Ka);Wd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RenderingFidelityMetric",!1)&&Gg.RenderingFidelityTracker.ka(Ka)})})})()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.tm.js.map/80b395f93cd39f046098b7483b6e5758/EwaDS.tm.js.map