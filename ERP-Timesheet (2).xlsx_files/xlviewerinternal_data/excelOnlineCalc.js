var excelOnlineCalc=function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=284)}([function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a})),r.d(t,"c",(function(){return o})),r.d(t,"d",(function(){return s})),r.d(t,"e",(function(){return u})),r.d(t,"f",(function(){return c}));var n=r(7),i=(n.result.ReasonKind,n.result.ResultKind),a=n.result.failure,o=n.result.isSuccess,s=n.result.javaScriptError,u=n.result.success,c=n.result.successUndefined},function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a})),r.d(t,"c",(function(){return o})),r.d(t,"d",(function(){return s})),r.d(t,"e",(function(){return u})),r.d(t,"f",(function(){return c}));var n=r(3),i=n.signature.OperatorId,a=n.signature.WorksheetFuncId,o=n.signature.getOperatorType,s=(n.signature.getWorksheetFuncEnglishName,n.signature.getWorksheetFuncType),u=(n.signature.higherOrderFunctionType,n.signature.operatorStrings),c=n.signature.unknownFunctionType},function(e,t,r){"use strict";r.r(t),r.d(t,"__extends",(function(){return i})),r.d(t,"__assign",(function(){return a})),r.d(t,"__rest",(function(){return o})),r.d(t,"__decorate",(function(){return s})),r.d(t,"__param",(function(){return u})),r.d(t,"__metadata",(function(){return c})),r.d(t,"__awaiter",(function(){return l})),r.d(t,"__generator",(function(){return d})),r.d(t,"__createBinding",(function(){return f})),r.d(t,"__exportStar",(function(){return p})),r.d(t,"__values",(function(){return m})),r.d(t,"__read",(function(){return h})),r.d(t,"__spread",(function(){return v})),r.d(t,"__spreadArrays",(function(){return g})),r.d(t,"__spreadArray",(function(){return b})),r.d(t,"__await",(function(){return S})),r.d(t,"__asyncGenerator",(function(){return y})),r.d(t,"__asyncDelegator",(function(){return O})),r.d(t,"__asyncValues",(function(){return C})),r.d(t,"__makeTemplateObject",(function(){return P})),r.d(t,"__importStar",(function(){return R})),r.d(t,"__importDefault",(function(){return k})),r.d(t,"__classPrivateFieldGet",(function(){return T})),r.d(t,"__classPrivateFieldSet",(function(){return E})),r.d(t,"__classPrivateFieldIn",(function(){return _}));var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var a=function(){return(a=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function o(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}function s(e,t,r,n){var i,a=arguments.length,o=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,r,o):i(t,r))||o);return a>3&&o&&Object.defineProperty(t,r,o),o}function u(e,t){return function(r,n){t(r,n,e)}}function c(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function l(e,t,r,n){return new(r||(r=Promise))((function(i,a){function o(e){try{u(n.next(e))}catch(e){a(e)}}function s(e){try{u(n.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}u((n=n.apply(e,t||[])).next())}))}function d(e,t){var r,n,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(i=2&a[0]?n.return:a[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,a[1])).done)return i;switch(n=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,n=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],n=0}finally{r=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}}var f=Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};function p(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||f(t,e,r)}function m(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function h(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,a=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=a.next()).done;)o.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(i)throw i.error}}return o}function v(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(h(arguments[t]));return e}function g(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),i=0;for(t=0;t<r;t++)for(var a=arguments[t],o=0,s=a.length;o<s;o++,i++)n[i]=a[o];return n}function b(e,t,r){if(r||2===arguments.length)for(var n,i=0,a=t.length;i<a;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))}function S(e){return this instanceof S?(this.v=e,this):new S(e)}function y(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,i=r.apply(e,t||[]),a=[];return n={},o("next"),o("throw"),o("return"),n[Symbol.asyncIterator]=function(){return this},n;function o(e){i[e]&&(n[e]=function(t){return new Promise((function(r,n){a.push([e,t,r,n])>1||s(e,t)}))})}function s(e,t){try{(r=i[e](t)).value instanceof S?Promise.resolve(r.value.v).then(u,c):l(a[0][2],r)}catch(e){l(a[0][3],e)}var r}function u(e){s("next",e)}function c(e){s("throw",e)}function l(e,t){e(t),a.shift(),a.length&&s(a[0][0],a[0][1])}}function O(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,i){t[n]=e[n]?function(t){return(r=!r)?{value:S(e[n](t)),done:"return"===n}:i?i(t):t}:i}}function C(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=m(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,i){(function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)})(n,i,(t=e[r](t)).done,t.value)}))}}}function P(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var N=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function R(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&f(t,e,r);return N(t,e),t}function k(e){return e&&e.__esModule?e:{default:e}}function T(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function E(e,t,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(e,r):i?i.value=r:t.set(e,r),r}function _(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.styleServiceTypes=t.testUtil=t.printServiceTypes=t.printService=t.mathpackIEEE=t.relabel=t.visitor=t.mathpack=t.signature=t.literalParse=t.resolveServiceTypes=t.resolveService=t.util=t.numfmt=t.formulaModule=t.datepack=t.mathpackXL=t.config=t.cellParse=t.cellFormat=t.annotations=t.adjust=t.worksheetFuncTypesModule=t.getCharCodeBits=t.location=t.value=t.types=t.PackageName=void 0,t.PackageName="excel-online-calc-lang",t.types=r(96),t.value=r(109),t.location=r(75);var n=r(216);Object.defineProperty(t,"getCharCodeBits",{enumerable:!0,get:function(){return n.getCharCodeBits}}),t.worksheetFuncTypesModule=r(175),t.adjust=r(334),t.annotations=r(336),t.cellFormat=r(141),t.cellParse=r(176),t.config=r(219),t.mathpackXL=r(224),t.datepack=r(221),t.formulaModule=r(69),t.numfmt=r(177),t.util=r(86),t.resolveService=r(178),t.resolveServiceTypes=r(143),t.literalParse=r(217),t.signature=r(128),t.mathpack=r(225),t.visitor=r(129),t.relabel=r(343),t.mathpackIEEE=r(344),t.printService=r(345),t.printServiceTypes=r(226),t.testUtil=r(347),t.styleServiceTypes=r(348)},function(e,t,r){"use strict";r.d(t,"q",(function(){return i})),r.d(t,"t",(function(){return a})),r.d(t,"r",(function(){return o})),r.d(t,"s",(function(){return s})),r.d(t,"d",(function(){return u})),r.d(t,"h",(function(){return c})),r.d(t,"k",(function(){return l})),r.d(t,"l",(function(){return d})),r.d(t,"u",(function(){return f})),r.d(t,"o",(function(){return p})),r.d(t,"n",(function(){return m})),r.d(t,"e",(function(){return h})),r.d(t,"f",(function(){return v})),r.d(t,"m",(function(){return g})),r.d(t,"c",(function(){return b})),r.d(t,"b",(function(){return S})),r.d(t,"a",(function(){return y})),r.d(t,"g",(function(){return O})),r.d(t,"v",(function(){return C})),r.d(t,"p",(function(){return P})),r.d(t,"i",(function(){return N})),r.d(t,"j",(function(){return R}));var n=r(7),i=(n.core.makeNewtypeIso,n.core.staticAssertExtends),a=n.core.staticAssertSame,o=n.core.staticAssertIs,s=n.core.staticAssertIsOptional,u=n.core.identity,c=n.core.makeStringMap,l=(n.core.cloneStringMap,n.core.numEnumArray),d=n.core.numEnumMap,f=n.core.strEnumArray,p=n.core.safePush,m=n.core.safeConcat,h=n.core.isDefined,v=n.core.isNone,g=(n.core.filterOutNones,n.core.pair),b=n.core.fastMin,S=n.core.fastMax,y=n.core.fastAbs,O=n.core.makeStringCompareCI,C=n.core.typedInstanceCreator,P=n.core.singleton,N=n.core.mapFromArrayOfPairs,R=n.core.now},function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return u})),r.d(t,"k",(function(){return c})),r.d(t,"l",(function(){return l})),r.d(t,"m",(function(){return d})),r.d(t,"o",(function(){return f})),r.d(t,"e",(function(){return p})),r.d(t,"p",(function(){return m})),r.d(t,"i",(function(){return h})),r.d(t,"j",(function(){return v})),r.d(t,"h",(function(){return g})),r.d(t,"g",(function(){return b})),r.d(t,"f",(function(){return O})),r.d(t,"n",(function(){return C})),r.d(t,"c",(function(){return S})),r.d(t,"d",(function(){return y}));var n=r(2),i=r(4),a=r(9),o=r(32),s={GetSheetNames:"GetSheetNames",GetRange:"GetRange",Delay:"Delay",GetCell:"GetCell",GetContainingTable:"GetContainingTable",GetTableHeaders:"GetTableHeaders",GetIntersectingTables:"GetIntersectingTables",GetIformat:"GetIformat",ParseCellFormula:"ParseCellFormula",ParseEdit:"ParseEdit",ParseNumberFormat:"ParseNumberFormat",PrintFormula:"PrintFormula",GetActiveCell:"GetActiveCell",GetConfig:"GetConfig",AwaitPromise:"AwaitPromise",GetFunctionsInfo:"GetFunctionsInfo",GetFunctionInfo:"GetFunctionInfo",GetCorrelationId:"GetCorrelationId",SetActiveCell:"SetActiveCell",ParseActiveCell:"ParseActiveCell",GetRichValueFieldListContext:"GetRichValueFieldListContext",GetHiddenRows:"GetHiddenRows",GetHiddenCols:"GetHiddenCols",GetDefinedNamesInfo:"GetDefinedNamesInfo",GetDefinedNameInfo:"GetDefinedNameInfo",ResolveReferences:"ResolveReferences",EvalOnClonedModel:"EvalOnClonedModel",EvalFormula:"EvalFormula"};Object(i.q)(),Object(i.q)(),Object(i.q)();var u;o.a.setActiveCell,o.a.doNothing,o.a.setFunctionsInfo,o.a.setDefinedNamesInfo;function c(e){function t(e){return function(t){Object(i.f)(t)||e(t)}}return{doNothing:t((function(t){return e.doNotify(o.a.doNothing,[t])})),setActiveCell:t((function(t){return e.doNotify(o.a.setActiveCell,[t])})),setFunctionsInfo:t((function(t){return e.doNotify(o.a.setFunctionsInfo,[t])})),setDefinedNamesInfo:t((function(t){return e.doNotify(o.a.setDefinedNamesInfo,[t])}))}}function l(e){var t=function(t){return function(r){return Object(i.f)(r)?Promise.resolve(null):Promise.resolve(e.doRequest(t,r))}};Object(i.q)();for(var r={},n=0,a=Object(i.u)(u);n<a.length;n++){var o=a[n];r[o]=t(o)}return r}function d(e){return{formulaHighlighting:function(t){return Object(i.f)(t)?null:e.doSyncRequest(u.formulaHighlighting,t)}}}function f(e,t){var r;return Object(n.__generator)(this,(function(i){switch(i.label){case 0:return[4,Object(n.__assign)({kind:e},t)];case 1:if("RequestFailure"===(r=i.sent()).kind)throw"RequestFailure: typedRequest got error response";return Object(a.g)("Response kind coincides with request kind",r.kind===e),[2,r]}}))}function p(e){var t;return Object(n.__generator)(this,(function(r){switch(r.label){case 0:return[4,{kind:s.AwaitPromise,promise:e}];case 1:return t=r.sent(),Object(a.g)("Response kind coincides with request kind",t.kind===s.AwaitPromise),[2,t.result]}}))}function m(e){var t,r,i,o;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return r=void 0!==t?e.next(t):e.next(),[4,{kind:s.AwaitPromise,promise:r}];case 1:return i=n.sent(),Object(a.g)("Response kind coincides with request kind",i.kind===s.AwaitPromise),!0===(o=i.result).done?[2,o.value]:[4,o.value];case 2:return t=n.sent(),[3,0];case 3:return[2]}}))}function h(e){return f(s.GetRange,{range:e})}function v(){return f(s.GetSheetNames,{})}function g(e){return f(s.GetCell,{cell:e})}function b(){return f(s.Delay,{})}Object(i.t)(),Object(i.q)(),Object(i.q)(),function(e){e.functionSuggestion="functionSuggestion",e.formulaHighlighting="formulaHighlighting",e.argumentAssistance="argumentAssistance",e.runExperiment="runExperiment",e.runAuthoringExperiment="runAuthoringExperiment",e.runTest="runTest"}(u||(u={})),Object(i.q)(),Object(i.q)(),Object(i.q)(),Object(i.q)();var S,y,O={kind:s.Delay};function C(e,t,r){return void 0===r&&(r=!1),f(s.ParseCellFormula,{cell:e,formula:t,useEnglishLocaleInfo:r})}!function(e){e[e.NoOpRequest=0]="NoOpRequest",e[e.AsyncRequest=1]="AsyncRequest",e[e.SyncRequest=2]="SyncRequest",e[e.StepPlugin=3]="StepPlugin",e[e.StopPlugins=4]="StopPlugins"}(S||(S={})),function(e){e.DevOnly="DevOnly",e.StableOnly="StableOnly",e.Both="Both",e.SyncDevOnly="SyncDevOnly",e.SyncStableOnly="SyncStableOnly",e.SyncBoth="SyncBoth"}(y||(y={})),Object(i.q)(),Object(i.q)(),Object(i.q)()},function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a})),r.d(t,"c",(function(){return o})),r.d(t,"d",(function(){return s})),r.d(t,"e",(function(){return u})),r.d(t,"f",(function(){return c})),r.d(t,"g",(function(){return l})),r.d(t,"h",(function(){return d})),r.d(t,"i",(function(){return f})),r.d(t,"j",(function(){return p})),r.d(t,"k",(function(){return m})),r.d(t,"l",(function(){return h})),r.d(t,"m",(function(){return v})),r.d(t,"n",(function(){return g})),r.d(t,"o",(function(){return b})),r.d(t,"p",(function(){return S})),r.d(t,"q",(function(){return y})),r.d(t,"r",(function(){return O})),r.d(t,"s",(function(){return C})),r.d(t,"t",(function(){return P})),r.d(t,"u",(function(){return N})),r.d(t,"v",(function(){return R})),r.d(t,"w",(function(){return k})),r.d(t,"x",(function(){return T})),r.d(t,"y",(function(){return E})),r.d(t,"z",(function(){return _})),r.d(t,"A",(function(){return F})),r.d(t,"B",(function(){return I})),r.d(t,"C",(function(){return A})),r.d(t,"D",(function(){return M})),r.d(t,"E",(function(){return w})),r.d(t,"F",(function(){return D})),r.d(t,"G",(function(){return j})),r.d(t,"H",(function(){return x})),r.d(t,"I",(function(){return L})),r.d(t,"J",(function(){return B})),r.d(t,"K",(function(){return U})),r.d(t,"L",(function(){return G})),r.d(t,"M",(function(){return K})),r.d(t,"N",(function(){return V})),r.d(t,"O",(function(){return W})),r.d(t,"P",(function(){return H})),r.d(t,"Q",(function(){return q})),r.d(t,"R",(function(){return z})),r.d(t,"S",(function(){return Q})),r.d(t,"T",(function(){return J})),r.d(t,"U",(function(){return Y})),r.d(t,"V",(function(){return $})),r.d(t,"W",(function(){return Z})),r.d(t,"X",(function(){return X})),r.d(t,"Y",(function(){return ee})),r.d(t,"Z",(function(){return te}));var n=r(3),i=n.util.LangReasonKind,a=n.util.ReasonKind,o=n.util.createFailureErrorClass,s=n.util.forEachCellInRange,u=n.util.forEachTileInRange,c=n.util.getArgType,l=n.util.getArguments,d=(n.util.getBoundName,n.util.getSubExpressionFromPosition),f=(n.util.getUserDefinedFuncName,n.util.getWorksheetFuncId,n.util.gridCellImplicitIsect),p=n.util.gridCellRange,m=n.util.gridRangeAnchor,h=n.util.gridRangeCompare,v=n.util.gridRangeExcept,g=n.util.gridRangeIsect,b=n.util.gridRangeIsects,S=n.util.gridRangeJoin,y=n.util.gridRangeJoinOpt,O=n.util.gridRangeSize,C=n.util.gridRangesJoin,P=n.util.internal,N=n.util.isArrayOper,R=n.util.isBlankOper,k=(n.util.isBooleanNode,n.util.isBooleanOper),T=(n.util.isCommaOpClosed,n.util.isCommaOpNoBadOrMissing,n.util.isCommaOpRefWellFormed,n.util.isDocumentLocEqual),E=n.util.isErrorOper,_=n.util.isGridCell,F=n.util.isGridCellEqual,I=n.util.isGridRangeEqual,A=(n.util.isMissingNode,n.util.isMissingOper),M=n.util.isNameScopeEqual,w=n.util.isNumberNode,D=n.util.isNumberOper,j=n.util.isOperatorNode,x=n.util.isPrimitiveOper,L=(n.util.isRangeOpClosed,n.util.isRangeOpNoMissing,n.util.isRangeOper),B=n.util.isReadOperEqual,U=n.util.isRichOper,G=n.util.isSheetGridCell,K=n.util.isSheetGridCellEqual,V=n.util.isSheetGridRange,W=n.util.isSheetGridRangeEqual,H=n.util.isSheetIndex,q=n.util.isSheetIndexEqual,z=n.util.isStringOper,Q=n.util.isUnqualifiedNameNode,J=n.util.isValidArgsLength,Y=n.util.isWSFNode,$=n.util.isWellFormed,Z=n.util.isWriteOper,X=(n.util.normalizeCommaOpRef,n.util.notImplemented),ee=n.util.sheetGridRangeAnchor,te=(n.util.shouldFieldRefBeBracketed,n.util.unavailable)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.revocableSingleton=t.testUtils=t.pledge=t.machine=t.testConfig=t.arrayLogger=t.wrapIntoAsyncModule=t.unicode=t.result=t.mixin=t.promise=t.stopwatch=t.resolvablePromise=t.config=t.codePoint=t.asyncLoopModule=t.async=t.arrayUtils=t.utils=t.table=t.split=t.rTree=t.ringBuffer=t.rbTree=t.rbMapTree=t.productSet=t.priorityQueue=t.interval=t.histogram=t.hashTable=t.hashSet=t.dictionary=t.deque=t.bspSet=t.binaryHeap=t.arrayMapTree=t.testUtil=t.core=t.featureConfiguration=t.assertions=t.util=t.anonymizer=t.findIsomorphicSubtrees=t.JSF32=t.fnv1a=t.PackageName=void 0,t.PackageName="excel-online-calc-common";var n=r(287);Object.defineProperty(t,"fnv1a",{enumerable:!0,get:function(){return n.fnv1a}});var i=r(206);Object.defineProperty(t,"JSF32",{enumerable:!0,get:function(){return i.JSF32}});var a=r(288);Object.defineProperty(t,"findIsomorphicSubtrees",{enumerable:!0,get:function(){return a.findIsomorphicSubtrees}});var o=r(168);t.anonymizer=o;var s=r(169);t.util=s;var u=r(101);t.assertions=u;var c=r(126);t.featureConfiguration=c;var l=r(74);t.core=l;var d=r(307);t.testUtil=d;var f=r(308);t.arrayMapTree=f;var p=r(209);t.binaryHeap=p;var m=r(210);t.bspSet=m;var h=r(309);t.deque=h;var v=r(310);t.dictionary=v;var g=r(311);t.hashSet=g;var b=r(312);t.hashTable=b;var S=r(313);t.histogram=S;var y=r(211);t.interval=y;var O=r(314);t.priorityQueue=O;var C=r(315);t.productSet=C;var P=r(316);t.rbMapTree=P;var N=r(212);t.rbTree=N;var R=r(317);t.ringBuffer=R;var k=r(318);t.rTree=k;var T=r(319);t.split=T;var E=r(127);t.table=E;var _=r(172);t.utils=_,t.arrayUtils=r(320),t.async=r(321),t.asyncLoopModule=r(322),t.codePoint=r(323),t.config=r(324),t.resolvablePromise=r(214),t.stopwatch=r(213),t.promise=r(173);var F=r(326);Object.defineProperty(t,"mixin",{enumerable:!0,get:function(){return F.mixin}}),t.result=r(174),t.unicode=r(327),t.wrapIntoAsyncModule=r(328),t.arrayLogger=r(329),t.testConfig=r(330),t.machine=r(215),t.pledge=r(331),t.testUtils=r(332),t.revocableSingleton=r(333)},function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a})),r.d(t,"c",(function(){return o})),r.d(t,"d",(function(){return s})),r.d(t,"e",(function(){return u})),r.d(t,"f",(function(){return c})),r.d(t,"g",(function(){return l})),r.d(t,"h",(function(){return d})),r.d(t,"i",(function(){return f})),r.d(t,"j",(function(){return p})),r.d(t,"m",(function(){return m})),r.d(t,"l",(function(){return h})),r.d(t,"k",(function(){return v})),r.d(t,"n",(function(){return g})),r.d(t,"o",(function(){return b})),r.d(t,"p",(function(){return S})),r.d(t,"q",(function(){return y})),r.d(t,"r",(function(){return O})),r.d(t,"s",(function(){return C})),r.d(t,"t",(function(){return P})),r.d(t,"u",(function(){return N})),r.d(t,"v",(function(){return R})),r.d(t,"w",(function(){return k})),r.d(t,"x",(function(){return T})),r.d(t,"y",(function(){return E})),r.d(t,"z",(function(){return _}));var n=r(3),i=n.location.LexicalKind,a=n.location.NameSource,o=n.location.allSheetsRange,s=n.location.documentLoc,u=n.location.documentScope,c=n.location.gridCell,l=n.location.gridRange,d=(n.location.isGridCell,n.location.isSheetGridCell,n.location.isSheetGridRange,n.location.isSheetIndex,n.location.lexicalSourceCell),f=n.location.lexicalSourceGrid,p=n.location.lexicalSourceName,m=n.location.lexicalSourceWSF,h=n.location.lexicalSourceUDF,v=n.location.lexicalSourceRange,g=n.location.nameLoc,b=n.location.nameScope,S=n.location.originCell,y=n.location.sheetCols,O=n.location.sheetGridCell,C=n.location.sheetGridCube,P=n.location.sheetGridRange,N=n.location.sheetIndex,R=n.location.sheetRange,k=n.location.sheetRangeIndexes,T=n.location.sheetRows,E=n.location.structRefColumnLoc,_=(n.location.unsafeGridRange,n.location.userDefinedFuncLoc)},function(e,t,r){"use strict";r.d(t,"h",(function(){return i})),r.d(t,"g",(function(){return a})),r.d(t,"a",(function(){return o})),r.d(t,"d",(function(){return s})),r.d(t,"c",(function(){return u})),r.d(t,"b",(function(){return c})),r.d(t,"e",(function(){return l})),r.d(t,"f",(function(){return d}));var n=r(7),i=n.assertions.ulsLogger,a=n.assertions.assertTrue,o=n.assertions.assertFalse,s=n.assertions.assertNever,u=n.assertions.assertNatural,c=n.assertions.assertIndex,l=(n.assertions.assertInteger,n.assertions.assertPositiveInteger),d=n.assertions.assertPositiveLength},function(e,t,r){"use strict";r.d(t,"l",(function(){return u})),r.d(t,"h",(function(){return c})),r.d(t,"m",(function(){return l})),r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return i})),r.d(t,"i",(function(){return g})),r.d(t,"e",(function(){return d})),r.d(t,"k",(function(){return S})),r.d(t,"f",(function(){return p})),r.d(t,"g",(function(){return m})),r.d(t,"c",(function(){return h})),r.d(t,"d",(function(){return v})),r.d(t,"j",(function(){return y}));var n,i,a=r(2),o=r(14),s=r(9);function u(e,t){return{sheet:e,set:t}}function c(e){return u(e.sheet,Object(o.f)(e.range))}function l(e,t){return{sheet:e,range:t}}!function(e){e.PrecisionTest="PrecisionTest",e.EditedCell="EditedCell",e.DependentCell="DependentCell",e.EvalFormula="EvalFormula",e.ParseEdit="ParseEdit"}(n||(n={})),function(e){e.EditedCell="EditedCell",e.DependentCell="DependentCell",e.IndependentCell="IndependentCell",e.UnknownNonEditedCell="UnknownNonEditedCell"}(i||(i={}));var d,f,p,m,h,v,g={calculatedCellCount:{},changedCellCount:{},continueCount:0,editFinishedCount:0,stateTimedOut:!1,recalcFinishedCount:0};function b(e,t){var r,n;return Object(a.__assign)(Object(a.__assign)({},e),((r={})[t]=(null!==(n=e[t])&&void 0!==n?n:0)+1,r))}function S(e,t){switch(t.message){case d.ChangedCell:return Object(a.__assign)(Object(a.__assign)({},e),{changedCellCount:b(e.changedCellCount,t.cellKind),calculatedCellCount:b(e.calculatedCellCount,t.cellKind)});case d.UnchangedCell:return Object(a.__assign)(Object(a.__assign)({},e),{calculatedCellCount:b(e.calculatedCellCount,t.cellKind)});case d.ContinueComputation:return Object(a.__assign)(Object(a.__assign)({},e),{continueCount:e.continueCount+1});case d.StateTimedOut:return Object(a.__assign)(Object(a.__assign)({},e),{stateTimedOut:!0});case d.EditFinished:return Object(a.__assign)(Object(a.__assign)({},e),{editFinishedCount:e.editFinishedCount+1});case d.RecalcFinished:return Object(a.__assign)(Object(a.__assign)({},e),{recalcFinishedCount:e.recalcFinishedCount+1});default:return Object(s.d)("calc.calc.partialWorkbookMessages.mergeRecalcStatistics",t)}}function y(e){return"object"==typeof e}!function(e){e.ChangedCell="ChangedCell",e.UnchangedCell="UnchangedCell",e.ContinueComputation="ContinueComputation",e.EditFinished="EditFinished",e.StateTimedOut="StateTimedOut",e.RecalcFinished="RecalcFinished"}(d||(d={})),function(e){e.SetSheetNames="SetSheetNames",e.SetRefStyle="SetRefStyle",e.SetLocaleInfo="SetLocaleInfo",e.SetNumberFormats="SetNumberFormats",e.WriteNamedObject="WriteNamedObject",e.WriteUndefinedNames="WriteUndefinedNames",e.PromoteNamedObjects="PromoteNamedObjects",e.ExtendUnusedRange="ExtendUnusedRange",e.WriteHiddenRows="WriteHiddenRows",e.WriteInFilterMode="WriteInFilterMode",e.SetCellContents="SetCellContents",e.SetRangeFormula="SetRangeFormula",e.PromoteCellContents="PromoteCellContents"}(f||(f={})),function(e){e.Unavailable="Unavailable",e.Weak="Weak",e.ClientValueUnknown="ClientValueUnknown",e.Origin="Origin",e.Inferred="Inferred"}(p||(p={})),function(e){e.Unavailable="Unavailable",e.Weak="Weak",e.Blank="Blank"}(m||(m={})),function(e){e.EvalFormula="eval-formula",e.ServerCellFormula="server-cell-formula",e.EditCellFormula="edit-cell-formula",e.ServerNamedFormula="server-named-formula",e.EditNamedFormula="edit-named-formula"}(h||(h={})),function(e){e.StateAdvanced="StateAdvanced",e.CellWrite="CellWrite",e.RangeWrite="RangeWrite",e.NameFailure="NameFailure",e.RangeFailure="RangeFailure",e.NumberFormatFailure="NumberFormatFailure",e.PrintFormulaFailure="PrintFormulaFailure",e.InferFormatFailure="InferFormatFailure",e.FormatValueFailure="FormatValueFailure",e.UnhandledFailure="UnhandledFailure",e.UpdateRequest="UpdateRequest",e.UpdateNamesRequest="UpdateNamesRequest",e.GarbageCollected="GarbageCollected",e.RecalcStatistics="RecalcStatistics",e.WorkbookStatistics="WorkbookStatistics",e.ExperimentRunResult="ExperimentRunResult"}(v||(v={}))},function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a})),r.d(t,"c",(function(){return o})),r.d(t,"d",(function(){return s})),r.d(t,"e",(function(){return u})),r.d(t,"f",(function(){return c})),r.d(t,"g",(function(){return l})),r.d(t,"h",(function(){return d})),r.d(t,"i",(function(){return f})),r.d(t,"j",(function(){return p})),r.d(t,"k",(function(){return m})),r.d(t,"l",(function(){return h})),r.d(t,"m",(function(){return v})),r.d(t,"n",(function(){return g})),r.d(t,"o",(function(){return b})),r.d(t,"p",(function(){return S})),r.d(t,"q",(function(){return y})),r.d(t,"r",(function(){return O})),r.d(t,"s",(function(){return C})),r.d(t,"t",(function(){return P})),r.d(t,"u",(function(){return N})),r.d(t,"v",(function(){return R})),r.d(t,"w",(function(){return k})),r.d(t,"x",(function(){return T})),r.d(t,"y",(function(){return E})),r.d(t,"z",(function(){return _})),r.d(t,"A",(function(){return F})),r.d(t,"B",(function(){return I})),r.d(t,"C",(function(){return A})),r.d(t,"D",(function(){return M})),r.d(t,"E",(function(){return w})),r.d(t,"F",(function(){return D})),r.d(t,"G",(function(){return j})),r.d(t,"H",(function(){return x})),r.d(t,"I",(function(){return L})),r.d(t,"J",(function(){return B})),r.d(t,"K",(function(){return U})),r.d(t,"L",(function(){return G})),r.d(t,"M",(function(){return K})),r.d(t,"N",(function(){return V})),r.d(t,"O",(function(){return W})),r.d(t,"P",(function(){return H})),r.d(t,"Q",(function(){return q})),r.d(t,"R",(function(){return z})),r.d(t,"S",(function(){return Q})),r.d(t,"T",(function(){return J})),r.d(t,"U",(function(){return Y})),r.d(t,"V",(function(){return $})),r.d(t,"W",(function(){return Z})),r.d(t,"X",(function(){return X})),r.d(t,"Y",(function(){return ee})),r.d(t,"Z",(function(){return te})),r.d(t,"ab",(function(){return re})),r.d(t,"bb",(function(){return ne})),r.d(t,"cb",(function(){return ie})),r.d(t,"db",(function(){return ae})),r.d(t,"eb",(function(){return oe})),r.d(t,"fb",(function(){return se})),r.d(t,"gb",(function(){return ue})),r.d(t,"hb",(function(){return ce})),r.d(t,"ib",(function(){return le})),r.d(t,"jb",(function(){return de})),r.d(t,"kb",(function(){return fe})),r.d(t,"lb",(function(){return pe})),r.d(t,"mb",(function(){return me}));var n=r(3),i=n.formulaModule.AnnotationKind,a=n.formulaModule.BadType,o=n.formulaModule.CellRefKind,s=n.formulaModule.NamePartKind,u=n.formulaModule.NodeKind,c=n.formulaModule.PosKind,l=n.formulaModule.QualifierKind,d=n.formulaModule.RefStyle,f=n.formulaModule.SpecialRefId,p=n.formulaModule.StructRefKind,m=n.formulaModule.appHeadNameAnnotation,h=n.formulaModule.appNode,v=n.formulaModule.arrayNode,g=n.formulaModule.badNode,b=n.formulaModule.badQualifier,S=n.formulaModule.badRef,y=n.formulaModule.cellRefBad,O=n.formulaModule.cellRefCol,C=n.formulaModule.cellRefError,P=n.formulaModule.cellRefNamePart,N=n.formulaModule.cellRefNode,R=n.formulaModule.cellRefRange,k=n.formulaModule.cellRefRow,T=n.formulaModule.cellRefSingle,E=n.formulaModule.columnRef,_=n.formulaModule.commaOpRef,F=n.formulaModule.documentQualifier,I=n.formulaModule.errorQualifier,A=n.formulaModule.fieldRef,M=n.formulaModule.fieldRefNamePart,w=n.formulaModule.fieldRefNode,D=n.formulaModule.flattenLambdaArgs,j=n.formulaModule.flattenLetArgs,x=n.formulaModule.flattenNameParts,L=n.formulaModule.formula,B=n.formulaModule.formulaRootAnnotation,U=n.formulaModule.formulaSpan,G=n.formulaModule.headNamePart,K=n.formulaModule.identNamePart,V=n.formulaModule.identQualifier,W=n.formulaModule.indexedArg,H=n.formulaModule.lambdaNode,q=n.formulaModule.lambdaParam,z=n.formulaModule.letNode,Q=n.formulaModule.letVar,J=n.formulaModule.literalNode,Y=n.formulaModule.localNameDeclAnnotation,$=n.formulaModule.localNameUseAnnotation,Z=n.formulaModule.missingRef,X=n.formulaModule.nameNode,ee=n.formulaModule.operatorNode,te=n.formulaModule.paramDefault,re=n.formulaModule.paramName,ne=n.formulaModule.paramNode,ie=n.formulaModule.parenNode,ae=n.formulaModule.pos,oe=n.formulaModule.rangeOpRef,se=n.formulaModule.relativeQualifier,ue=n.formulaModule.sheetQualifier,ce=n.formulaModule.sheetRangeQualifier,le=n.formulaModule.specialRef,de=n.formulaModule.structRef,fe=n.formulaModule.structRefNode,pe=n.formulaModule.thisRowOpRef,me=n.formulaModule.wsfNode;n.formulaModule.getDepthUpperBound},function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a})),r.d(t,"c",(function(){return o})),r.d(t,"d",(function(){return s})),r.d(t,"e",(function(){return u})),r.d(t,"f",(function(){return c})),r.d(t,"g",(function(){return l})),r.d(t,"h",(function(){return d})),r.d(t,"i",(function(){return f})),r.d(t,"j",(function(){return p})),r.d(t,"k",(function(){return m})),r.d(t,"l",(function(){return h})),r.d(t,"m",(function(){return v})),r.d(t,"n",(function(){return g})),r.d(t,"o",(function(){return b})),r.d(t,"p",(function(){return S})),r.d(t,"q",(function(){return y})),r.d(t,"r",(function(){return O})),r.d(t,"s",(function(){return C})),r.d(t,"u",(function(){return P})),r.d(t,"v",(function(){return N})),r.d(t,"t",(function(){return R})),r.d(t,"w",(function(){return k})),r.d(t,"x",(function(){return T})),r.d(t,"y",(function(){return E}));var n=r(3),i=n.config.Country,a=n.config.LCID,o=n.config.LogCategory,s=n.config.NulLogger,u=n.config.PictureColor,c=n.config.PictureDbnum,l=n.config.PictureSingle,d=n.config.PictureSpecial,f=n.config.TraceLevel,p=n.config.calcConfig,m=n.config.createWorksheetFuncNameCallbacks,h=n.config.englishErrorNames,v=n.config.englishErrorTypeToName,g=n.config.englishOperatorIdToName,b=(n.config.englishPictureColor,n.config.englishPictureDbnum,n.config.englishPictureSingle,n.config.englishPictureSpecial,n.config.englishSpecialRefNames,n.config.englishSysDateFormat,n.config.englishSysTimeFormat,n.config.englishWorksheetFuncIdToName),S=n.config.getEnglishLocaleInfo,y=n.config.getEnglishWorksheetFuncIdToName,O=n.config.getGetNumberShape,C=(n.config.getNumberShapeOld,n.config.getNumberShapeNew,n.config.getGetOrdinal),P=(n.config.getOrdinalOld,n.config.getOrdinalNew,n.config.isIdentContinue),N=n.config.isIdentStart,R=n.config.getIsNumeral,k=(n.config.isNumeralOld,n.config.isNumeralNew,n.config.localeInfo),T=n.config.operatorIdToName,E=n.config.ulsLogger},function(e,t,r){"use strict";r.d(t,"c",(function(){return i})),r.d(t,"i",(function(){return a})),r.d(t,"j",(function(){return o})),r.d(t,"g",(function(){return s})),r.d(t,"d",(function(){return u})),r.d(t,"a",(function(){return c})),r.d(t,"h",(function(){return l})),r.d(t,"b",(function(){return d})),r.d(t,"e",(function(){return f})),r.d(t,"f",(function(){return p}));var n=r(7),i=n.productSet.createFromProduct,a=n.productSet.project,o=n.productSet.unionProduct,s=n.productSet.intersectProduct,u=n.productSet.exceptProduct,c=n.productSet.compareProduct,l=n.productSet.meetsProduct,d=n.productSet.complementProduct,f=(n.productSet.symmetricDiffProduct,n.productSet.getSubspaces,n.productSet.forEachProduct),p=n.productSet.getSubspaceCount;n.productSet.ProductSetSerializer,n.productSet.productSetSerializer},function(e,t,r){"use strict";var n,i=r(8),a=r(6),o=r(7),s=o.interval.ivlJoin,u=(o.interval.ivlMeet,o.interval.ivlDistance,o.interval.ivlMeets,o.interval.ivlMeetsOrTouches,o.interval.ivlExcept,o.interval.ivlCompare,r(16)),c=(o.split.boundedPareto,o.split.boundedParetoSplitter,o.split.boundedParetoSetOperations),l=r(13);r.d(t,"d",(function(){return h})),r.d(t,"f",(function(){return v})),r.d(t,"e",(function(){return g})),r.d(t,"c",(function(){return b})),r.d(t,"b",(function(){return S})),r.d(t,"a",(function(){return y})),r.d(t,"j",(function(){return O})),r.d(t,"h",(function(){return C})),r.d(t,"i",(function(){return P})),r.d(t,"g",(function(){return N})),r.d(t,"k",(function(){return R})),function(e){e[e.AvailableSet=0]="AvailableSet",e[e.AvailableRead=1]="AvailableRead"}(n||(n={}));var d=[n.AvailableSet,n.AvailableRead+1],f=[0,i.x],p=[0,i.q],m={availability:c(1,d[0]+1,d[1],d,"Availability operations, alpha = 1"),row:c(.2,f[0]+1,f[1],f,"Row operations, alpha = 0.2"),col:c(.35,p[0]+1,p[1],p,"Col operations, alpha = 0.35")},h={availability:Object(u.b)(m.availability),row:Object(u.b)(m.row),col:Object(u.b)(m.col)};function v(e){return Object(l.c)({row:h.row([e.row,e.row+e.rows]),col:h.col([e.col,e.col+e.cols])})}function g(e){if(e!==u.d){var t,r,n=e===u.c?void 0:e.root.bounds.row,a=e===u.c?void 0:e.root.bounds.col,o=void 0===n?m.row.top:(t=Object(u.g)(m.row,n),r=[],O(t,(function(e){return r.push(e),!0})),r.reduce(s)),c=o[0],l=o[1],d=void 0===a?m.col.top:function(e){var t=[];return C(e,(function(e){return t.push(e),!0})),t.reduce(s)}(Object(u.g)(m.col,a)),f=d[0],p=d[1];return Object(i.g)(c,f,l-c,p-f)}}var b=Object(l.c)({availability:h.availability([n.AvailableSet,n.AvailableSet+1])}),S=Object(l.c)({availability:h.availability([n.AvailableRead,n.AvailableRead+1])}),y=Object(l.c)({availability:h.availability([n.AvailableSet,n.AvailableRead+1])});function O(e,t){return e!==u.c?Object(u.f)(e,t):t(m.row.top)}function C(e,t){return e!==u.c?Object(u.f)(e,t):t(m.col.top)}function P(e,t){return Object(l.e)(e,(function(e){return O(e.row,(function(r){var n=r[0],a=r[1];return C(e.col,(function(e){var r=e[0],o=e[1];return t(Object(i.g)(n,r,a-n,o-r))}))}))}),"row","col")}function N(e,t){return P(e,(function(e){return Object(a.d)(e,t)}))}function R(e,t,r){var n=u.d;return Object(l.e)(e,(function(e){var i=u.d;O(e.row,(function(e){var r=e[0],n=e[1];return i=Object(u.j)(i,h.row([r+t,n+t])),!0}));var a=u.d;C(e.col,(function(e){var t=e[0],n=e[1];return a=Object(u.j)(a,h.col([t+r,n+r])),!0}));var o=Object(l.c)({row:i,col:a,availability:e.availability});return n=Object(l.j)(n,o),!0}),"row","col","availability"),n}},function(e,t,r){"use strict";r.d(t,"nb",(function(){return a})),r.d(t,"r",(function(){return o})),r.d(t,"G",(function(){return s})),r.d(t,"Q",(function(){return u})),r.d(t,"fb",(function(){return c})),r.d(t,"j",(function(){return l})),r.d(t,"s",(function(){return d})),r.d(t,"cb",(function(){return f})),r.d(t,"D",(function(){return p})),r.d(t,"C",(function(){return m})),r.d(t,"o",(function(){return h})),r.d(t,"V",(function(){return v})),r.d(t,"gb",(function(){return g})),r.d(t,"eb",(function(){return b})),r.d(t,"k",(function(){return S})),r.d(t,"m",(function(){return y})),r.d(t,"e",(function(){return O})),r.d(t,"kb",(function(){return C})),r.d(t,"Y",(function(){return P})),r.d(t,"Z",(function(){return N})),r.d(t,"X",(function(){return R})),r.d(t,"c",(function(){return k})),r.d(t,"h",(function(){return T})),r.d(t,"i",(function(){return E})),r.d(t,"g",(function(){return _})),r.d(t,"ib",(function(){return F})),r.d(t,"P",(function(){return I})),r.d(t,"I",(function(){return A})),r.d(t,"N",(function(){return M})),r.d(t,"p",(function(){return w})),r.d(t,"O",(function(){return D})),r.d(t,"H",(function(){return j})),r.d(t,"J",(function(){return x})),r.d(t,"L",(function(){return L})),r.d(t,"M",(function(){return B})),r.d(t,"hb",(function(){return U})),r.d(t,"K",(function(){return G})),r.d(t,"U",(function(){return K})),r.d(t,"n",(function(){return V})),r.d(t,"lb",(function(){return W})),r.d(t,"F",(function(){return H})),r.d(t,"z",(function(){return q})),r.d(t,"B",(function(){return z})),r.d(t,"A",(function(){return Q})),r.d(t,"y",(function(){return J})),r.d(t,"T",(function(){return Y})),r.d(t,"f",(function(){return $})),r.d(t,"W",(function(){return Z})),r.d(t,"q",(function(){return X})),r.d(t,"E",(function(){return ee})),r.d(t,"l",(function(){return te})),r.d(t,"R",(function(){return re})),r.d(t,"d",(function(){return ne})),r.d(t,"S",(function(){return ie})),r.d(t,"ab",(function(){return ae})),r.d(t,"u",(function(){return oe})),r.d(t,"x",(function(){return se})),r.d(t,"v",(function(){return ue})),r.d(t,"w",(function(){return ce})),r.d(t,"t",(function(){return le})),r.d(t,"jb",(function(){return fe})),r.d(t,"db",(function(){return pe})),r.d(t,"bb",(function(){return me})),r.d(t,"mb",(function(){return he})),r.d(t,"a",(function(){return de}));var n=r(4),i=r(77);r.d(t,"b",(function(){return i.a}));var a=Object(n.v)()((function(e,t){return{functionId:e,functionName:t}})),o=Object(n.v)()((function(e,t){return{errorType:e,errorName:t}})),s=Object(n.v)()((function(e,t,r,n,i,a,o,s,u,c,l,d,f,p,m,h,v,g,b,S,y,O,C,P,N,R,k,T,E,_,F,I,A,M,w,D,j,x,L,B,U,G,K,V,W,H,q,z,Q,J,Y){return{worksheetFunctionNames:e,errorTypeNames:t,specialRefNames:Q,trueName:r,falseName:n,rowLetter:i,columnLetter:a,leftBrace:o,rightBrace:s,leftBracket:u,rightBracket:c,decimalSeparator:l,listSeparator:d,columnSeparator:f,rowSeparator:p,thousandsData:m,thousandsSeparator:h,lcid:v,country:g,numberDecimals:b,isExpSepBySpace:S,fractionSeparator:y,isPercentSepBySpace:O,currencyFormat:C,isCurrencySymbolLead:P,isCurrencySepBySpace:N,currencySymbol:R,currencyDecimals:k,dateOrder:T,dateSeparator:E,dateAltSeparator:_,year4Digits:F,month2Digits:I,day2Digits:A,longDateFormat:M,timeSeparator:w,timeAltSeparator:D,hour2Digits:j,clock24Hour:x,isAMPMSepBySpace:L,ampmSymbols:B,dayNameShort:U,dayNameLong:G,monthNameShort:K,monthNameLong:V,pictureSpecial:W,pictureSingle:H,pictureColor:q,pictureDbnum:z,sysDateFormat:J,sysTimeFormat:Y}})),u=Object(n.v)()((function(e,t,r){return{iformat:e,formatString:t,builtIn:r}})),c=Object(n.v)()((function(e,t){return{sheetId:e,sheetName:t}})),l={kind:"Blank"},d=Object(n.v)()((function(e){return{kind:"Error",type:e}})),f=Object(n.v)()((function(e){return{kind:"Rich",fields:e}}));function p(e){return"object"==typeof e?e.kind:typeof e}function m(e){return"object"==typeof e?e.kind:typeof e}var h=Object(n.v)()((function(e,t){return{row:e,column:t}})),v=Object(n.v)()((function(e,t,r,n){return{row:e,column:t,lastRow:r,lastColumn:n}})),g=Object(n.v)()((function(e,t,r,n,i){return{sheetId:e,row:t,column:r,lastRow:n,lastColumn:i}})),b=Object(n.v)()((function(e,t,r){return{sheetId:e,row:t,column:r,lastRow:void 0,lastColumn:void 0}})),S=Object(n.v)()((function(e,t,r,n,i){return{formulaBarText:e,value:t,iformat:r,failureReason:n,kind:i}}));function y(e,t,r,n){return S(e,t,r,n,"CellFormula")}function O(e,t,r){return S(void 0,e,t,r,"ArrayFormula")}function C(e,t,r,n){return S(e,t,r,n,"Value")}var P=Object(n.v)()((function(e,t,r,n,i){return{range:e,data:t,fromStateId:r,excludeRows:n,excludeColumns:i}})),N=Object(n.v)()((function(e,t,r,n){return P(e,t,void 0,r,n)}));function R(e,t,r,n){return P(e,void 0,t,r,n)}var k=Object(n.v)()((function(e,t){return{isSpilled:e,formulaBarText:t}})),T=Object(n.v)()((function(e,t,r){return{range:e,data:t,fromStateId:r}}));function E(e,t){return T(e,t,void 0)}function _(e,t){return T(e,void 0,t)}var F=Object(n.v)()((function(e,t){return{sheetId:e,usedRange:t}})),I=Object(n.v)()((function(e){return{kind:"NamedValue",value:e}})),A=Object(n.v)()((function(e){return{kind:"NamedFormula",formulaBarText:e}})),M=Object(n.v)()((function(e){return{kind:"NamedRange",range:e}})),w=Object(n.v)()((function(e,t){return{column:e,name:t}})),D=Object(n.v)()((function(e,t,r,n){return{kind:"NamedTable",range:e,hasHeadersRow:t,hasTotalsRow:r,columns:n}})),j=Object(n.v)()((function(e,t){return{kind:"NamedFailure",failureReason:e,objectKind:t}})),x=Object(n.v)()((function(e,t){return{name:e,data:t}})),L=Object(n.v)()((function(e,t,r){return{scope:e,objects:t,fromStateId:r}}));function B(e,t){return L(e,t,void 0)}function U(e){return L(e,void 0,void 0)}function G(e,t){return L(e,void 0,t)}var K=function(e,t,r,n,i,a){return void 0===a&&(a="Inferred"),{range:Array.isArray(e)?e:[e],formulaBarText:t,value:r,origin:n,viewport:i,kind:a}};function V(e,t,r,n){return K(e,t,void 0,r,n,"CellFormula")}function W(e,t,r,n){return K(e,t,r,void 0,n,"Value")}function H(e,t,r,n){return K(e,t,void 0,r,n,"Inferred")}var q=Object(n.v)()((function(e,t,r,n){return{kind:e,format:t,ribbon:r,changeDecimals:n}}));function z(e){return q("SetFormat",e,void 0,void 0)}function Q(e){return q("RibbonFormat",void 0,e,void 0)}function J(e){return q("ChangeDecimals",void 0,void 0,e)}var Y=Object(n.v)()((function(e,t,r,n){return{range:e,operation:t,origin:r,viewport:n}})),$=Object(n.v)()((function(e,t,r,n){return{range:e,formulaBarText:t,origin:r,viewport:n}})),Z=Object(n.v)()((function(e,t,r,n){return{kind:e,target:t,source:r,viewport:n}}));function X(e,t,r){var n=b(e.sheetId,e.row,e.column);return Z("CopyPaste",n,t,r)}var ee=Object(n.v)()((function(e,t,r){return{format:e,category:t,decimals:r}})),te=Object(n.v)()((function(e,t,r,n,i){return{formulaBarText:e,value:t,format:r,formatted:n,hasHyperlink:i}})),re=Object(n.v)()((function(e,t){return{range:e,data:t}})),ne=Object(n.v)()((function(e,t){return{range:e,data:t}})),ie=Object(n.v)()((function(e,t){return{range:e,reason:t}})),ae=Object(n.v)()((function(e,t,r,n,i,a){return{stateId:e,priorityGroup:t,isFinished:r,rangeDeltas:n,arrayDeltas:i,rangeFailures:a}})),oe=Object(n.v)()((function(e,t){return{kind:e,iformat:t}}));function se(){return oe("Origin")}function ue(e){return oe("Iformat",e)}function ce(){return oe("Inferred")}function le(e,t){return{value:e,formatted:t}}var de,fe=Object(n.v)()((function(e,t,r){return{rangeUpdateRanges:e,arrayUpdateRanges:t,namesUpdateScopes:r}})),pe=Object(n.v)()((function(e,t){return{name:e,param:t}})),me=Object(n.v)()((function(e,t,r,n,i,a,o,s,u,c,l,d){return void 0===l&&(l=null==c?void 0:c/(c>=1?1:10)),{totalEvalTimeMs:e,samplePrecisionEvalRate:t,samplePrecisionPrintFormulaRate:c,samplePrecisionPrintValueRate:l,sampleRecalcStatisticsRate:s,sampleWorkbookStatisticsRate:n,sampleRecalcEditedStopwatchRate:i,sampleRecalcViewportStopwatchRate:a,sampleCellEvalStopwatchRate:o,rngSeed:r,volatileMode:d,runExperiments:u}})),he=Object(n.v)()((function(e,t,r){return{date1904:e,dateCompatibility:t,timezone:r}}));!function(e){e.Thread="Thread",e.Local="Local",e.ThreadOrLocal="ThreadOrLocal"}(de||(de={}))},function(e,t,r){"use strict";r.d(t,"b",(function(){return i})),r.d(t,"g",(function(){return a})),r.d(t,"j",(function(){return o})),r.d(t,"i",(function(){return s})),r.d(t,"e",(function(){return u})),r.d(t,"a",(function(){return c})),r.d(t,"c",(function(){return l})),r.d(t,"d",(function(){return d})),r.d(t,"h",(function(){return f})),r.d(t,"f",(function(){return p}));var n=r(7),i=(n.bspSet.SetKind,n.bspSet.cacheKeySplitting,n.bspSet.createFromKey),a=n.bspSet.fromUntyped,o=n.bspSet.union,s=(n.bspSet.unionUntyped,n.bspSet.intersect),u=(n.bspSet.intersectUntyped,n.bspSet.meets,n.bspSet.meetsUntyped,n.bspSet.except),c=(n.bspSet.exceptUntyped,n.bspSet.compare),l=(n.bspSet.combineCmp,n.bspSet.compareUntyped,n.bspSet.dense),d=n.bspSet.empty,f=(n.bspSet.lazy,n.bspSet.symmetricDiff,n.bspSet.complement,n.bspSet.getNodeCount),p=n.bspSet.forEachKey;n.bspSet.forEachKeyUntyped},function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a})),r.d(t,"c",(function(){return o})),r.d(t,"d",(function(){return s})),r.d(t,"e",(function(){return u})),r.d(t,"f",(function(){return c})),r.d(t,"g",(function(){return l})),r.d(t,"h",(function(){return d})),r.d(t,"i",(function(){return f})),r.d(t,"j",(function(){return p})),r.d(t,"k",(function(){return m})),r.d(t,"l",(function(){return h})),r.d(t,"m",(function(){return v})),r.d(t,"n",(function(){return g})),r.d(t,"o",(function(){return b})),r.d(t,"p",(function(){return S})),r.d(t,"q",(function(){return y})),r.d(t,"r",(function(){return O})),r.d(t,"s",(function(){return C})),r.d(t,"t",(function(){return P})),r.d(t,"u",(function(){return N})),r.d(t,"v",(function(){return R})),r.d(t,"w",(function(){return k})),r.d(t,"x",(function(){return T})),r.d(t,"y",(function(){return E})),r.d(t,"z",(function(){return _})),r.d(t,"A",(function(){return F})),r.d(t,"B",(function(){return I})),r.d(t,"C",(function(){return A})),r.d(t,"D",(function(){return M})),r.d(t,"E",(function(){return w})),r.d(t,"F",(function(){return D})),r.d(t,"G",(function(){return j})),r.d(t,"H",(function(){return x})),r.d(t,"I",(function(){return L})),r.d(t,"J",(function(){return B})),r.d(t,"K",(function(){return U})),r.d(t,"L",(function(){return G}));var n=r(22),i=n.serviceTypes.Alignment,a=n.serviceTypes.BidiDate,o=n.serviceTypes.Clip,s=n.serviceTypes.CultureTag,u=n.serviceTypes.EditKind,c=n.serviceTypes.FormatCurrency,l=n.serviceTypes.FormatReasonKind,d=n.serviceTypes.FormatValueType,f=n.serviceTypes.FormattedUnitKind,p=n.serviceTypes.GetTimeKind,m=n.serviceTypes.NamedColor,h=n.serviceTypes.NumberFormatSource,v=n.serviceTypes.ReasonKind,g=n.serviceTypes.createFormatGlobals,b=n.serviceTypes.dateOverflow,S=n.serviceTypes.evalFormatLocalsGrid,y=n.serviceTypes.formattedUnitBlank,O=n.serviceTypes.formattedUnitFlexible,C=n.serviceTypes.formattedUnitGeneral,P=n.serviceTypes.formattedUnitString,N=n.serviceTypes.formattedValue,R=n.serviceTypes.formulaEdit,k=n.serviceTypes.fractionOverflow,T=n.serviceTypes.hashesValue,E=(n.serviceTypes.isFormatCultureEqual,n.serviceTypes.isHashesValue),_=(n.serviceTypes.isSystemCultureTag,n.serviceTypes.memoizedRenderCallback),F=n.serviceTypes.noFormatPart,I=n.serviceTypes.notFormatString,A=n.serviceTypes.notValueString,M=n.serviceTypes.numberEdit,w=n.serviceTypes.otherEdit,D=n.serviceTypes.previousFormatFailure,j=n.serviceTypes.renderCallback,x=n.serviceTypes.renderInfiniteWidth,L=n.serviceTypes.renderedValue,B=n.serviceTypes.renderedValueToString,U=n.serviceTypes.stringEdit,G=n.serviceTypes.tooWide},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TelemetryCollector=t.initStopwatchFactory=t.ewaUtils=t.initEwaUtils=t.ConsoleLogger=t.NulLogger=t.perfWatch=t.browserSupport=t.LogCategory=t.TraceLevel=t.ULS=t.utils=t.TextAreaInputMode=t.TextAreaVirtualKeyboardPolicy=t.getNewGuid=void 0;var n=r(289);t.utils=n;var i=r(154);Object.defineProperty(t,"ULS",{enumerable:!0,get:function(){return i.ULS}}),Object.defineProperty(t,"TraceLevel",{enumerable:!0,get:function(){return i.TraceLevel}}),Object.defineProperty(t,"LogCategory",{enumerable:!0,get:function(){return i.LogCategory}}),Object.defineProperty(t,"NulLogger",{enumerable:!0,get:function(){return i.NulLogger}}),Object.defineProperty(t,"ConsoleLogger",{enumerable:!0,get:function(){return i.ConsoleLogger}});var a=r(290);t.browserSupport=a;var o=r(291);t.perfWatch=o;var s=r(292);Object.defineProperty(t,"initEwaUtils",{enumerable:!0,get:function(){return s.initEwaUtils}}),Object.defineProperty(t,"ewaUtils",{enumerable:!0,get:function(){return s.ewaUtils}});var u=r(296);Object.defineProperty(t,"initStopwatchFactory",{enumerable:!0,get:function(){return u.initStopwatchFactory}});var c=r(297);Object.defineProperty(t,"TelemetryCollector",{enumerable:!0,get:function(){return c.TelemetryCollector}});var l=r(298);Object.defineProperty(t,"getNewGuid",{enumerable:!0,get:function(){return l.getNewGuid}});var d=r(299);Object.defineProperty(t,"TextAreaVirtualKeyboardPolicy",{enumerable:!0,get:function(){return d.TextAreaVirtualKeyboardPolicy}}),Object.defineProperty(t,"TextAreaInputMode",{enumerable:!0,get:function(){return d.TextAreaInputMode}})},function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a})),r.d(t,"c",(function(){return o})),r.d(t,"d",(function(){return s})),r.d(t,"f",(function(){return u})),r.d(t,"g",(function(){return c})),r.d(t,"h",(function(){return l})),r.d(t,"i",(function(){return d})),r.d(t,"j",(function(){return f})),r.d(t,"k",(function(){return p})),r.d(t,"l",(function(){return m})),r.d(t,"m",(function(){return h})),r.d(t,"n",(function(){return v})),r.d(t,"o",(function(){return g})),r.d(t,"p",(function(){return b})),r.d(t,"q",(function(){return S})),r.d(t,"r",(function(){return y})),r.d(t,"s",(function(){return O})),r.d(t,"t",(function(){return C})),r.d(t,"e",(function(){return P})),r.d(t,"u",(function(){return N})),r.d(t,"v",(function(){return R})),r.d(t,"w",(function(){return k})),r.d(t,"x",(function(){return T})),r.d(t,"y",(function(){return E}));var n=r(25),i=n.serviceTypes.CellKind,a=n.serviceTypes.Interrupt,o=n.serviceTypes.LimitKind,s=n.serviceTypes.ReasonKind,u=(n.serviceTypes.StepAction,n.serviceTypes.cellCycle),c=n.serviceTypes.cellFormula,l=n.serviceTypes.cellWellFormedFormula,d=n.serviceTypes.compileLocalsGrid,f=n.serviceTypes.compileLocalsName,p=n.serviceTypes.createCompileGlobals,m=n.serviceTypes.evalGlobals,h=n.serviceTypes.evalLocals,v=n.serviceTypes.finalValue,g=n.serviceTypes.getEvalFailureReason,b=n.serviceTypes.illFormedFormula,S=n.serviceTypes.interval,y=n.serviceTypes.limitExceeded,O=n.serviceTypes.nameCycle,C=n.serviceTypes.paused,P=n.serviceTypes.breaked,N=n.serviceTypes.pendingValue,R=n.serviceTypes.previousFailure,k=n.serviceTypes.previousNameFailure,T=n.serviceTypes.stopped,E=n.serviceTypes.userDefinedFunc},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.util=t.tokenizeFormulaModule=t.token=t.parseStructRefModule=t.parserState=t.parserService=t.parseResultHelperModule=t.parseResultHelper_old=t.parseRefModule=t.parser=t.parseQualifierModule=t.parseOperators=t.parseLiteralModule=t.parseFormulaModule=t.parseFieldRefModule=t.parseCommon=t.parseServiceTypes=t.analyzeServiceTypes=t.diagnostics=t.checker=t.autocorrect=t.analyzeService=t.PackageName=void 0,t.PackageName="excel-online-calc-syntax",t.analyzeService=r(349),t.autocorrect=r(228),t.checker=r(227),t.diagnostics=r(180),t.analyzeServiceTypes=r(231),t.parseServiceTypes=r(232),t.parseCommon=r(97),t.parseFieldRefModule=r(184),t.parseFormulaModule=r(233),t.parseLiteralModule=r(236),t.parseOperators=r(115),t.parseQualifierModule=r(235),t.parser=r(89),t.parseRefModule=r(234),t.parseResultHelper_old=r(238),t.parseResultHelperModule=r(355),t.parserService=r(356),t.parserState=r(98),t.parseStructRefModule=r(237),t.token=r(79),t.tokenizeFormulaModule=r(239),t.util=r(240)},function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a})),r.d(t,"c",(function(){return o})),r.d(t,"d",(function(){return s})),r.d(t,"e",(function(){return u}));var n=r(3),i=n.types.FunctionFlags,a=n.types.OperKind,o=n.types.SignatureType,s=n.types.SpecialPrecs,u=n.types.functionType},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.util=t.unicode=t.testData=t.serviceTypes=t.ribbonFormat=t.render=t.parsedate=t.parseconst=t.parse=t.localeData=t.knownFormat=t.impl=t.formulaBar=t.formatService=t.eval=t.edit=t.PackageName=void 0,t.PackageName="excel-online-calc-numfmt",t.edit=r(186),t.eval=r(243),t.formatService=r(364),t.formulaBar=r(247),t.impl=r(245),t.knownFormat=r(132),t.localeData=r(246),t.parse=r(249),t.parseconst=r(187),t.parsedate=r(190),t.render=r(192),t.ribbonFormat=r(367),t.serviceTypes=r(90),t.testData=r(368),t.unicode=r(147),t.util=r(248)},function(e,t,r){"use strict";r.d(t,"c",(function(){return f})),r.d(t,"e",(function(){return h})),r.d(t,"b",(function(){return b})),r.d(t,"d",(function(){return S}));var n=r(26);r.d(t,"a",(function(){return n.c}));var i,a,o=r(9),s=r(12),u=r(4),c=r(5),l=r(37),d=r(82),f=((i={})[n.c.TestPlugin]=c.b.runTest,i[n.c.AutocompletePlugin]=c.b.functionSuggestion,i[n.c.DragPlugin]=c.b.functionSuggestion,i[n.c.ConfigTestPlugin]=c.b.runTest,i[n.c.FeatureGateTestPlugin]=c.b.runTest,i[n.c.ChangeGateTestPlugin]=c.b.runTest,i[n.c.ArgumentAssistancePlugin]=c.b.argumentAssistance,i[n.c.FormulaRepairPlugin]=c.b.functionSuggestion,i[n.c.FormulaCollectionPlugin]=c.b.functionSuggestion,i[n.c.DNMTraceTagTestPlugin]=c.b.runTest,i[n.c.AutocompletePrecisionMeasurements]=c.b.runExperiment,i[n.c.AutocompleteAuthoringPrecisionMeasurements]=c.b.runAuthoringExperiment,i[n.c.AutocompleteGroundTruthMeasurements]=c.b.runExperiment,i[n.c.AutocompleteDataTypesMeasurements]=c.b.runExperiment,i[n.c.ParenthesesCouplingPlugin]=c.b.formulaHighlighting,i[n.c.ColoredReferencesPlugin]=c.b.formulaHighlighting,i[n.c.SlowTestPlugin]=c.b.functionSuggestion,i[n.c.EvalOnCloneTestPlugin]=c.b.runTest,i[n.c.EvalFormulaTestPlugin]=c.b.runTest,i[n.c.AutocompleteFunctionPlugin]=c.b.functionSuggestion,i[n.c.AutocompleteLetPlugin]=c.b.functionSuggestion,i[n.c.AutocompleteRichValuePlugin]=c.b.functionSuggestion,i[n.c.AutocompleteNamedObjectsPlugin]=c.b.functionSuggestion,i[n.c.ParserPerformanceMeasurements]=c.b.runExperiment,i[n.c.AutocompleteTableHeadersPlugin]=c.b.functionSuggestion,i);Object(u.q)(),Object(u.q)(),Object(u.q)();var p=((a={})[n.c.ParenthesesCouplingPlugin]=c.d.SyncBoth,a[n.c.ColoredReferencesPlugin]=c.d.SyncBoth,a);Object(u.q)(),Object(u.q)();var m="Main";function h(e){m=e}var v=Object(u.h)(),g=Object(u.h)();function b(e,t){var r=(t===d.a.Stable?v:g)[e];if(!r){var i="x10arch.getPluginFactory: ".concat(n.c[e]," has not been registered on ").concat(m);throw o.h.ULS.traceTag(557056858,s.c.msoulscat_ES_EWAJS,s.i.Error,i),new Error(i)}return r}function S(e){var t,r,i=e.factoryName,a=p,u=null!==(t=v[i])&&void 0!==t?t:g[i];if(void 0!==u&&u!==e){var d="x10arch.registerPluginFactory: ".concat(n.c[i]," is already registered on ").concat(m);if(o.h.ULS.traceTag(557056859,s.c.msoulscat_ES_EWAJS,s.i.Error,d),!Object(l.b)("Microsoft.Office.Excel.x10DoNotThrowOnDoublePluginRegistration"))throw new Error(d)}var f=null!==(r=a[i])&&void 0!==r?r:c.d.Both;switch(f){case c.d.Both:case c.d.SyncBoth:g[i]=e,v[i]=e;break;case c.d.StableOnly:case c.d.SyncStableOnly:v[i]=e;break;case c.d.DevOnly:case c.d.SyncDevOnly:g[i]=e;break;default:Object(o.d)("x10arch.registerPluginFactory: ".concat(n.c[i],", unknown compatibility: ").concat(f),f)}var h="x10arch.registerPluginFactory: registered ".concat(n.c[i]," on ").concat(m);o.h.ULS.traceTag(571246212,s.c.msoulscat_ES_EWAJS,s.i.Info,h)}},function(e,t,r){"use strict";var n,i=r(2),a=r(19),o=r(6),s=r(8),u=r(30),c=r(1),l=r(10),d=r(9),f=r(14),p=r(27),m=r(4),h=r(46),v=r(7),g=r(13),b=(v.stopwatch.initStopwatch,v.stopwatch.ulsStopwatchFactory),S=r(18),y=r(155);!function(e){e[e.Back=0]="Back",e[e.Front=1]="Front"}(n||(n={}));var O,C,P,N,R=function(){function e(){this.minPriority=0,this.taskDeqs=[]}return e.prototype.deleteTasks=function(e,t){var r=this.taskDeqs[e];if(r)for(var n;n=r.popFront();)"function"!=typeof n&&n.onDeleted&&n.onDeleted(t)},e.prototype.addTask=function(e,t,r){var i,a=null!==(i=this.taskDeqs[e])&&void 0!==i?i:this.taskDeqs[e]=new y.a;t===n.Back?a.pushBack(r):a.pushFront(r),e<this.minPriority&&(this.minPriority=e)},e.prototype.runTask=function(){for(var e,t=this.minPriority;t<this.taskDeqs.length;t+=1){this.minPriority=t;var r=null===(e=this.taskDeqs[t])||void 0===e?void 0:e.popFront();if(r)return"function"==typeof r?r():r.onRun(),!0}return!1},e.prototype.getCount=function(e){var t,r;return void 0!==e?null!==(r=null===(t=this.taskDeqs[e])||void 0===t?void 0:t.getCount())&&void 0!==r?r:0:this.taskDeqs.reduce((function(e,t){return t?e+t.getCount():e}),0)},e}(),k=r(17),T=r(47),E=r(0),_=r(28),F=r(83),I=r(16),A=r(25),M=(A.machine.ArrayMachine,A.machine.MachineCallKind,A.machine.ThenMachine,A.machine.isMachineCall,A.machine.machineCall,A.machine.nextOnSuccessReceiver,A.machine.callMachineTransition,A.machine.nextTransition,A.machine.breakTransition,A.machine.MachineRuntime),w=(A.machine.readOperType,A.machine.refToVal,A.machine.singleReadOperType,r(42)),D=r(39),j=r(12),x=r(78),L=r(21),B=(v.machine.AllMachine,v.machine.MachineCycle,v.machine.MachineRuntime,v.machine.TransitionKind);v.machine.callMachineTransition,v.machine.nextOnSuccessReceiver,v.machine.nextTransition,v.machine.breakTransition;function U(e,t){switch(t.kind){case L.b.Number:return{kind:"n",magnitude:Object(F.b)(e.toNumber(t))};case L.b.String:return{kind:"s"};case L.b.Boolean:return{kind:"b"};case L.b.Error:return{kind:"e",type:Object(j.m)(t.type)};case L.b.Rich:return{kind:"r"};case L.b.Array:return{kind:"a"};case L.b.Blank:return{kind:"z"};default:return Object(d.d)("calc.calc.precisionValue",t)}}function G(e,t){var r=e[t.sheet.index];return void 0!==r&&Object(g.h)(r,Object(f.f)(t.range))}function K(e,t){var r,n=null!==(r=e[t.sheet.index])&&void 0!==r?r:I.d;e[t.sheet.index]=Object(g.j)(n,Object(f.f)(t.range))}!function(e){e.EvalStatistics="EvalStatistics",e.PrintFormulaStatistics="PrintFormulaStatistics",e.UnhandledFailure="UnhandledFailure"}(P||(P={})),function(e){e.Success="Success",e.Timeout="Timeout"}(N||(N={}));var V=((O={})[c.a.Add]=.05,O[c.a.Sub]=.069,O[c.a.Eq]=.097,O[c.a.Mul]=.1,O[c.a.Div]=.11,O[c.a.Concat]=.36,O[c.a.Gt]=.65,O[c.a.Ne]=.79,O[c.a.Lt]=.89,O[c.a.Le]=1.6,O[c.a.Ge]=1.9,O[c.a.Percent]=2.9,O[c.a.At]=6.2,O[c.a.Pow]=13,O[c.a.Range]=67,O),W=((C={})[c.b.IF]=.076,C[c.b.SUM]=.11,C[c.b.IFERROR]=.5,C[c.b.COUNTIF]=.77,C[c.b.AND]=.82,C[c.b.VLOOKUP]=1.5,C[c.b.AVERAGE]=1.5,C[c.b.HOUR]=1.9,C[c.b.MINUTE]=1.9,C[c.b.TEXT]=2,C[c.b.OR]=2,C[c.b.NOW]=2.1,C[c.b.ISBLANK]=2.3,C[c.b.CONCATENATE]=2.6,C[c.b.SUMIF]=2.7,C[c.b.COUNTIFS]=3.3,C[c.b.LEFT]=3.4,C[c.b.ISNUMBER]=3.7,C[c.b.MID]=3.9,C[c.b.COUNTA]=4,C[c.b.MONTH]=4.2,C[c.b.SECOND]=4.3,C[c.b.LEN]=4.9,C[c.b.WEEKNUM]=5,C[c.b.DAY]=5.2,C[c.b.ROUND]=5.4,C[c.b.FIND]=5.8,C[c.b.NETWORKDAYS]=6.2,C[c.b.COUNT]=6.2,C[c.b.YEAR]=6.3,C[c.b.INT]=6.4,C[c.b.RIGHT]=6.7,C[c.b.ABS]=7,C[c.b.CONCAT]=7.2,C[c.b.CHAR]=7.4,C[c.b.MAX]=8,C[c.b.ROW]=8.1,C[c.b.WEEKDAY]=9.1,C[c.b.DAYS]=9.2,C[c.b.MIN]=9.8,C[c.b.SEARCH]=9.8,C[c.b.WORKDAY]=11,C[c.b.DATEDIF]=12,C[c.b.TIME]=13,C[c.b.HYPERLINK]=13,C[c.b.IFS]=13,C[c.b.ISERROR]=13,C[c.b.COUNTBLANK]=14,C[c.b.TODAY]=14,C[c.b.VALUE]=18,C[c.b.ROUNDUP]=18,C[c.b.MATCH]=19,C[c.b.DATE]=20,C[c.b.SUBSTITUTE]=20,C[c.b.INDIRECT]=22,C[c.b.INDEX]=23,C[c.b.TRIM]=24,C[c.b.UPPER]=25,C[c.b.SUMIFS]=28,C[c.b.EXACT]=29,C[c.b.NOT]=32,C[c.b.PRODUCT]=35,C[c.b.ROUNDDOWN]=37,C[c.b.AVERAGEIF]=38,C[c.b.ISTEXT]=40,C[c.b.ISOWEEKNUM]=41,C[c.b.EOMONTH]=42,C[c.b.MROUND]=45,C[c.b.COLUMN]=45,C[c.b.ROWS]=46,C[c.b.TIMEVALUE]=52,C[c.b.TRUNC]=53,C[c.b.LOOKUP]=59,C[c.b.NA]=59,C[c.b.DAYS360]=61,C[c.b.RANK]=67,C[c.b.EDATE]=72,C[c.b.MOD]=82,C[c.b.OFFSET]=83,C[c.b.STDEV]=87,C[c.b.SUBTOTAL]=91,C),H=Object(_.f)(Object(i.__assign)(Object(i.__assign)({},Object(_.h)(.01)),{nameNode:function(){return 1},operatorNode:function(e){var t;return null!==(t=V[e])&&void 0!==t?t:100},wsfNode:function(e){var t;return null!==(t=W[e])&&void 0!==t?t:100}}),m.b);var q=function(){function e(e){var t,r,n,i,a=this;this.sampledSets={},this.precisionWrongSets={},this.log=[],this.result=void 0,this.testEval=function(e){var t=e.cell,r=e.p;return a.resumeToPledge((function(){return a.docs.evaluate(l.a.EditedCell,[t],h.b.PrecisionTest)}),r)},this.testPrint=function(e){var t=e.cell,r=e.p;return w.a.try((function(){var e=a.getFormula(t);if(!Object(E.c)(e))return a.onUnavailableObject(e.reason);var n,i=e.value,o=i[0],s=i[1];if(void 0===s.compiledFmla){var u=a.docs.getServerValue(t);if(!Object(E.c)(u))return a.onUnavailableObject(u.reason);n=a.docs.renderValueBarText(t,u.value.oper,s.fmla)}else{var c=s.compiledFmla.getValue();n=Object(E.c)(c)?a.docs.printFormulaBarText(o,s.origin,c.value):c}if(Object(E.c)(n)){var l=Object(F.a)(s.fmla),d=n.value===s.fmla?{expected:l,p:r}:{expected:l,sampled:Object(F.a)(n.value),p:r};a.log.push({kind:P.PrintFormulaStatistics,stats:{samples:[d],failures:[]}})}else a.log.push({kind:P.PrintFormulaStatistics,stats:{samples:[],failures:[n.reason]}})}))},this.config={samplePrecisionEvalRate:null!==(t=e.samplePrecisionEvalRate)&&void 0!==t?t:0,samplePrecisionPrintFormulaRate:null!==(r=e.samplePrecisionPrintFormulaRate)&&void 0!==r?r:0,samplePrecisionPrintValueRate:null!==(n=e.samplePrecisionPrintValueRate)&&void 0!==n?n:0,rngSeed:null!==(i=e.rngSeed)&&void 0!==i?i:0|Object(m.j)()},this.rng=new v.JSF32(this.config.rngSeed)}return Object.defineProperty(e.prototype,"done",{get:function(){return void 0!==this.result},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"resultLogMessage",{get:function(){return this.createResultLogMessage(N.Success)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"failedLogMessage",{get:function(){return this.createResultLogMessage(N.Timeout)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"readonlyDebugLog",{get:function(){return this.log},enumerable:!1,configurable:!0}),e.prototype.setContext=function(e){var t=this;this.stateId=e.stateId,this.docs=e.documents,this.docs.reconfigure({yieldIntervalMs:e.stepBudget/2,totalTimeMs:e.totalBudget},this.docs.limits,this.docs.maxDereferenceCells,this.docs.isServerWorkbookLoad),this.runtime=new M(this.sampleCells().bind((function(e){var r=e.evalCells,n=e.printCells;return w.a.all(Object(i.__spreadArray)(Object(i.__spreadArray)([],r.map(t.testEval),!0),n.map(t.testPrint),!0))})).catch((function(e){t.log.push({kind:P.UnhandledFailure,reason:e})})))},e.prototype.step=function(){if(!this.result){var e=this.runtime.step();this.result=e.kind===B.Break||e.kind===B.Next?void 0:e}},e.prototype.sampleCells=function(){var e=this,t=[],r=[],n=[];return this.docs.getServerAvailableCells().forEach((function(i){var a=i.sheetIdx;return n.push(w.a.try((function(){e.docs.forEachServerNonBlankCellInSet(a,I.c,(function(n){var i=Object(s.r)(a,n),o=e.config,u=o.samplePrecisionEvalRate,c=o.samplePrecisionPrintFormulaRate,l=o.samplePrecisionPrintValueRate;if(u>0){var d=e.getWeight(i);void 0!==(p=void 0===d?void 0:u>=1?1:Object(m.c)(1,u*d))&&e.rng.next()<p&&(K(e.sampledSets,i),t.push({cell:i,p:p}))}var f=Object(m.b)(c,l);if(f>0){var p,h=e.rng.next();if(h<f)h<(p=e.isValueCell(i)?l:c)&&r.push({cell:i,p:p})}return!0}))}))),!0})),w.a.all(n).bind((function(){return{evalCells:t,printCells:r}}))},e.prototype.getWeight=function(e){var t=this.getFormula(e);if(!Object(E.c)(t))return this.onUnavailableObject(t.reason);var r=t.value[1];return void 0!==r.compiledFmla?function(e){return Object(E.c)(e)?Object(_.j)(H,e.value):1}(r.compiledFmla.getValue()):void 0},e.prototype.isValueCell=function(e){var t=this.getFormula(e);return Object(E.c)(t)?void 0===t.value[1].compiledFmla:(this.onUnavailableObject(t.reason),!1)},e.prototype.resumeToPledge=function(e,t){var r=this;return w.a.try((function(){try{r.p=t;var n=e();return Array.isArray(n)?n:r.resumeToPledge(n.resume,t)}finally{r.p=void 0}}))},e.prototype.getFormula=function(e){var t,r=this.docs.getEditedFormula(e);if(!Object(E.c)(r))return r;var n=null!==(t=r.value)&&void 0!==t?t:[e.range,D.d],i=n[0],a=n[1],o=Object(s.i)(a.lexicalKind,Object(s.t)(e.sheet,i));return Object(E.e)([o,a])},e.prototype.onRangeFailure=function(e,t,r,n,i){var a={samples:[],failures:[t]};this.log.push({kind:P.EvalStatistics,stats:a})},e.prototype.onNameFailure=function(){},e.prototype.onNumberFormatFailure=function(){},e.prototype.onInferFormatFailure=function(){},e.prototype.onReturnCellValue=function(){},e.prototype.onUnavailableObject=function(e){var t=Object(o.Z)([e]);this.onUnavailable(t)},e.prototype.onUnavailable=function(e){this.log.push({kind:P.UnhandledFailure,reason:e})},e.prototype.hasWrongPrecedent=function(e){var t=this;return e.cells.some((function(e){return G(t.precisionWrongSets,e)}))},e.prototype.onSetCellValue=function(e,t,r,n,i){var a=this.getFormula(e);if(!Object(E.c)(a))return this.onUnavailableObject(a.reason);var o=a.value,s=o[0],u=o[1],c=this.hasWrongPrecedent(r);return this.logPrecisionResult(e,t,s,u,c)},e.prototype.onSetCellValues=function(e,t,r,n,i){var a=this,u=this.getFormula(Object(o.Y)(e));if(!Object(E.c)(u))return this.onUnavailableObject(u.reason);var c=u.value,l=c[0],d=c[1],f=this.hasWrongPrecedent(r);Object(o.d)(e.range,(function(r,n,i){return a.logPrecisionResult(Object(s.r)(e.sheet,r),t[n][i],l,d,f),!0}))},e.prototype.logPrecisionResult=function(e,t,r,n,i){var a=this.docs.allServerAvailable(e);if(!Object(E.c)(a))return this.onUnavailableObject(a.reason);if(!0===a.value){var o=this.docs.getServerValue(e);if(!Object(E.c)(o))return this.onUnavailableObject(o.reason);var s=G(this.sampledSets,e),u=this.precisionResult(t,o.value.oper,r,n,s,i);(function(e){return void 0===e.sampled})(u)||K(this.precisionWrongSets,e);var c={samples:[u],failures:[]};this.log.push({kind:P.EvalStatistics,stats:c})}},e.prototype.precisionResult=function(e,t,r,n,i,a){var s=this.p,u=this.docs.config.mathpack,c=U(u,t),l=this.docs.anonymizeFormula(r,n),d=l[0],f=l[1];if(Object(o.J)(u,e,t,!0))return{expected:c,formula:d,functions:f,root:i,cascaded:a,p:s};var p=U(u,e);if(Object(o.F)(t)&&Object(o.F)(e)){var m=u.toNumber(t),h=u.toNumber(e);return{expected:c,sampled:p,relMagnitude:Object(F.b)(0===m?h:(h-m)/m),formula:d,functions:f,root:i,cascaded:a,p:s}}return{expected:c,sampled:p,formula:d,functions:f,root:i,cascaded:a,p:s}},e.prototype.createResultLogMessage=function(e){var t,r;if(0!==this.log.length||e!==N.Success){for(var n={samples:[],failures:{}},i={samples:[],failures:{}},a={},o=0,s=this.log;o<s.length;o++){var u=s[o];switch(u.kind){case P.EvalStatistics:(t=n.samples).push.apply(t,u.stats.samples);for(var c=0,l=u.stats.failures;c<l.length;c++){var f=l[c];Object(x.b)(n.failures,f)}break;case P.PrintFormulaStatistics:(r=i.samples).push.apply(r,u.stats.samples);for(var p=0,m=u.stats.failures;p<m.length;p++){f=m[p];Object(x.b)(i.failures,f)}break;case P.UnhandledFailure:Object(x.b)(a,u.reason);break;default:Object(d.d)("calc.calc.PrecisionExperiment.createResultMessage",u)}}return["PrecisionExperiment",e,"stateId = ".concat(this.stateId),"evalStats = ".concat(JSON.stringify(n)),"printStats = ".concat(JSON.stringify(i)),"unhandledFailures = ".concat(JSON.stringify(a))].join(", ")}},e}(),z=r(84),Q=r(64),J=r(29),Y=r(35);r.d(t,"e",(function(){return $})),r.d(t,"b",(function(){return ie})),r.d(t,"c",(function(){return ae})),r.d(t,"a",(function(){return ne})),r.d(t,"d",(function(){return oe}));var $,Z=2*s.q,X=Object(s.g)(0,0,s.x,s.q);!function(e){e.DocumentLoc="DocumentLoc",e.SheetId="SheetId",e.SheetNames="SheetNames",e.GridRange="GridRange",e.GridRangeSize="GridRangeSize",e.CellFormat="CellFormat",e.CellStyle="CellStyle",e.HiddenRows="HiddenRows",e.HiddenCols="HiddenCols",e.InFilterMode="InFilterMode",e.CellFormula="CellFormula",e.CellMissingFormula="CellMissingFormula",e.CellEvaluatingValue="CellEvaluatingValue",e.ClientFailure="ClientFailure",e.NumberFormat="NumberFormat",e.StyleId="StyleId",e.FontId="FontId",e.FillId="FillId",e.BorderId="BorderId",e.NameLoc="NameLoc",e.VolatileFunction="VolatileFunction",e.TimeGranularity="TimeGranularity",e.GetTimeKind="GetTimeKind",e.ColumnName="ColumnName",e.ContainingTable="ContainingTable",e.NamedRanges="NamedRanges"}($||($={}));var ee,te=Object(_.f)(Object(i.__assign)(Object(i.__assign)({},Object(_.h)(!1)),{wsfNode:function(e){return e===c.b.HYPERLINK}}),(function(e,t){return e||t}));!function(e){e.EvalFinished="EvalFinished",e.EvalTimedOut="EvalTimedOut",e.StateIdAdvanced="StateIdAdvanced",e.EditReceived="EditReceived",e.SetSheetNames="SetSheetNames",e.SetLangConfig="SetLangConfig"}(ee||(ee={}));var re,ne,ie=function(e){this.cloneLazy=new J.a((function(){return e.createSnapshotSync()})),this.resultsPromise=new Q.a,this.stateId=-1},ae=function(e){this.resultsPromise=new Q.a,this.stateId=-1,this.cloneLazy=new J.a((function(){return e.clone(h.c,ne.Client)}))};!function(e){e[e.ServerUpdate=0]="ServerUpdate",e[e.ClientEdit=1]="ClientEdit",e[e.EvalFormula=2]="EvalFormula",e[e.BeforeCompute=3]="BeforeCompute",e[e.ComputeCellValue=4]="ComputeCellValue",e[e.AfterCompute=5]="AfterCompute",e[e.ComputeEvalOnClone=6]="ComputeEvalOnClone",e[e.ComputeEvalFormula=7]="ComputeEvalFormula",e[e.RecalcFinished=8]="RecalcFinished",e[e.CompleteDataQuery=9]="CompleteDataQuery",e[e.MaybeCollectGarbage=10]="MaybeCollectGarbage",e[e.RunExperiment=11]="RunExperiment",e[e.TestAdvanceState=12]="TestAdvanceState"}(re||(re={})),function(e){e[e.Server=0]="Server",e[e.Client=1]="Client"}(ne||(ne={}));var oe=function(){function e(e,t){void 0===t&&(t={});var r,n,i=this;this.scheduler=new R,this.outputMessageLog=[],this.stateId=-1/0,this.stateChangesSinceLastGC=0,this.stateChanges=0,this.stateEvalTime=0,this.numPrecisionFailures=0,this.printFormulaProperties=function(e){var t=Object(o.Y)(e),r=i.getAvailableFormula(t);if(Object(E.c)(r)){var n=r.value,a=n[0],s=n[1],u=s.compiledFmla.getValue(),c=Object(E.c)(u)?i.docs.printFormulaBarText(a,t.range,u.value):u;return{formulaBarText:c.kind===E.a.Success?c.value:void i.outputMessageLog.push({kind:l.d.PrintFormulaFailure,stateId:i.stateId,range:e,reason:c.reason}),hasHyperlink:i.formulaHasHyperlink(s),isFormula:!0}}i.onUnavailableObject(r.reason)},this.printValueProperties=function(e,t){var r,n,a=i.docs.getEditedFormula(e);if(Object(E.c)(a)){var o=null!==(n=null===(r=a.value)||void 0===r?void 0:r[1].fmla)&&void 0!==n?n:"",s=i.docs.renderValueBarText(e,t,o);return{formulaBarText:Object(E.c)(s)?s.value:void i.outputMessageLog.push({kind:l.d.PrintFormulaFailure,stateId:i.stateId,range:e,reason:s.reason}),hasHyperlink:!1,isFormula:!1}}i.onUnavailableObject(a.reason)},this.scheduleAvailableFormulas=function(e,t){var r=i.docs.forEachEditedNonBlankCellInSet(e.sheet,e.set,(function(r){var n=Object(s.r)(e.sheet,r),a=i.docs.getEditedFormula(n);return a.kind===E.a.Failure?(i.onUnavailableObject(a.reason),!0):(void 0!==a.value&&void 0!==a.value[1].compiledFmla&&i.enqueueComputeCellValue(n,t),!0)}));Object(E.c)(r)||i.onUnavailableObject(r.reason)},this.scheduleAvailableValues=function(e,t){var r=i.docs.forEachEditedCellInSet(e.sheet,e.set,(function(r){var n=Object(s.r)(e.sheet,r),a=i.docs.getEditedFormula(n);return a.kind===E.a.Failure?(i.onUnavailableObject(a.reason),!0):(void 0!==a.value&&void 0!==a.value[1].compiledFmla||i.enqueueReturnCellValue(n,t),!0)}));Object(E.c)(r)||i.onUnavailableObject(r.reason)},this.docs=new h.a(e,this,t,t,null!==(r=t.maxDereferenceCells)&&void 0!==r?r:Z,null!==(n=t.isServerWorkbookLoad)&&void 0!==n&&n),this.reconfigure(t)}return e.prototype.reconfigure=function(e){var t,r;this.config=e,this.rng=new v.JSF32(void 0!==e.rngSeed?e.rngSeed:0),this.docs.reconfigure(e,e,null!==(t=e.maxDereferenceCells)&&void 0!==t?t:Z,null!==(r=e.isServerWorkbookLoad)&&void 0!==r&&r)},e.prototype.setWorksheetFuncOverrides=function(e){this.docs.setWorksheetFuncOverrides(e)},e.prototype.onNameFailure=function(e,t,r){r.computeKind!==l.a.EvalFormula&&this.outputMessageLog.push({kind:l.d.NameFailure,stateId:this.stateId,name:e,reason:t})},e.prototype.onRangeFailure=function(e,t,r,n,i){i.computeKind!==l.a.EvalFormula&&this.outputMessageLog.push({kind:l.d.RangeFailure,stateId:this.stateId,cellKind:n,range:e,reason:t})},e.prototype.onNumberFormatFailure=function(e){this.outputMessageLog.push({kind:l.d.NumberFormatFailure,stateId:this.stateId,reason:e})},e.prototype.onInferFormatFailure=function(e,t){this.outputMessageLog.push({kind:l.d.InferFormatFailure,stateId:this.stateId,range:e,reason:t})},e.prototype.onUnavailableObject=function(e){var t=Object(o.Z)([e]);this.onUnavailable(t)},e.prototype.onUnavailable=function(e){this.outputMessageLog.push({kind:l.d.UnhandledFailure,stateId:this.stateId,reason:e})},e.prototype.onSetCellValue=function(e,t,r,n,a){if(a.computeKind!==l.a.EvalFormula){var o=this.outputCell(e,t,n,this.printFormulaProperties);void 0!==o?(this.outputMessageLog.push({kind:l.d.RecalcStatistics,message:l.e.ChangedCell,stateId:this.stateId,cellKind:n}),n!==l.b.EditedCell&&n!==l.b.DependentCell||this.outputMessageLog.push(Object(i.__assign)(Object(i.__assign)({kind:l.d.CellWrite,stateId:this.stateId,cellKind:n,cell:e},o),{formatted:this.formatValue(n,e,t)}))):this.outputMessageLog.push({kind:l.d.RecalcStatistics,message:l.e.UnchangedCell,stateId:this.stateId,cellKind:n})}},e.prototype.onSetCellValues=function(e,t,r,n,a){var o=this;if(a.computeKind!==l.a.EvalFormula){var u=this.outputRange(e,t,n);void 0!==u&&(n!==l.b.EditedCell&&n!==l.b.DependentCell||this.outputMessageLog.push(Object(i.__assign)(Object(i.__assign)({kind:l.d.RangeWrite,stateId:this.stateId,cellKind:n,range:e},u),{formatted:t.map((function(t,r){return t.map((function(t,i){return o.formatValue(n,Object(s.r)(e.sheet,Object(s.f)(e.range.row+r,e.range.col+i)),t)}))}))})))}},e.prototype.onReturnCellValue=function(e,t,r){var n=this,a=this.outputCell(e,t,r,(function(){return n.printValueProperties(e,t)}));void 0!==a?(this.outputMessageLog.push({kind:l.d.RecalcStatistics,message:l.e.ChangedCell,stateId:this.stateId,cellKind:l.b.EditedCell}),r===l.b.EditedCell&&this.outputMessageLog.push(Object(i.__assign)(Object(i.__assign)({kind:l.d.CellWrite,stateId:this.stateId,cellKind:l.b.EditedCell,cell:e},a),{formatted:this.formatValue(r,e,t)}))):this.outputMessageLog.push({kind:l.d.RecalcStatistics,message:l.e.UnchangedCell,stateId:this.stateId,cellKind:l.b.EditedCell})},e.prototype.createSnapshot=function(e){var t=this;return void 0===e&&(e=ne.Client),new Promise((function(r){t.scheduler.addTask(re.CompleteDataQuery,n.Back,{onRun:function(){r(t.docs.clone(h.c,e))},onDeleted:function(){r(void 0)}})}))},e.prototype.createSnapshotSync=function(e){return void 0===e&&(e=ne.Client),this.docs.clone(h.c,e)},e.prototype.outputCell=function(e,t,r,n){var i;if(r===l.b.EditedCell||r===l.b.DependentCell){var a=this.docs.testAndSetClientValue(e,t);i=Object(E.c)(a)?a.value?t:void 0:void this.onUnavailableObject(a.reason)}var o=this.outputFormat(e,r),s=this.outputFormulaProperties(e,r,n);return void 0!==i||void 0!==o||void 0!==s?{value:t,format:o,formulaBarText:null==s?void 0:s.formulaBarText,hasHyperlink:null==s?void 0:s.hasHyperlink}:void 0},e.prototype.outputRange=function(e,t,r){var n=this;if(r===l.b.EditedCell||r===l.b.DependentCell){var i=this.docs.setClientValue(e,t);Object(E.c)(i)||this.onUnavailableObject(i.reason)}var a=t.map((function(t,i){return t.map((function(t,a){return n.outputFormat(Object(s.r)(e.sheet,Object(s.f)(e.range.row+i,e.range.col+a)),r)}))})),o=this.outputFormulaProperties(e,r,this.printFormulaProperties);return{values:t,formats:a,formulaBarText:null==o?void 0:o.formulaBarText}},e.prototype.outputFormat=function(e,t){if(t===l.b.EditedCell){var r=this.docs.getEditedFormat(e);if(Object(E.c)(r)){var n=this.docs.testAndSetClientFormat(e,r.value);if(Object(E.c)(n)){if(n.value){var i=r.value;if(i===l.f.Unavailable)return{format:Object(o.Z)([{kind:$.CellFormat}]),valueType:k.h.Custom,decimals:0};var a=this.docs.resolveCellFormat(e.sheet.document,i);return Object(E.c)(a)?{format:"number"==typeof i?i:i.formatString,valueType:a.value.valueType,decimals:a.value.decimals}:void 0}}else this.onUnavailableObject(n.reason)}else this.onUnavailableObject(r.reason)}},e.prototype.outputFormulaProperties=function(e,t,r){if(t===l.b.EditedCell){var n=r(e);if(void 0!==n){var i=n.formulaBarText,a=n.hasHyperlink,o=n.isFormula,s=this.docs.testAndSetClientFormula(e,i,a);if(Object(E.c)(s)){var u=s.value,c=u.hasFmlaChanged,d=u.hasHyperlinkChanged;return c||d?{formulaBarText:c?i:void 0,hasHyperlink:d?a:void 0,isFormula:o}:void 0}this.onUnavailableObject(s.reason)}}},e.prototype.formatValue=function(e,t,r){var n=this.docs.formatValueCell(t,r);if(Object(E.c)(n))return n.value;this.outputMessageLog.push({kind:l.d.FormatValueFailure,stateId:this.stateId,cellKind:e,range:t,reason:n.reason})},e.prototype.getAvailableFormula=function(e){var t=this.docs.getEditedFormula(e);if(!Object(E.c)(t))return t;if(void 0===t.value)return Object(E.b)({kind:$.CellMissingFormula});var r=t.value,n=r[0],i=r[1];if(void 0===i.compiledFmla)return Object(E.b)({kind:$.CellEvaluatingValue});var a=Object(s.i)(i.lexicalKind,Object(s.t)(e.sheet,n));return Object(E.e)([a,i])},e.prototype.formulaHasHyperlink=function(e){if(e.lexicalKind!==s.a.Cell)return!1;var t=null==e?void 0:e.compiledFmla.getValue();return Object(E.c)(t)?Object(_.j)(te,t.value):void 0},e.prototype.handleSetCellContents=function(e,t,r,n,i,a,u,c,f,p,m){var h,v,g,b,S=void 0!==f?Object(o.Z)([{kind:$.ClientFailure,reason:f}]):void 0,y=u;void 0!==n?(v=n,Object(d.g)("calc.calc.PartialWorkbook.handleSetCellContents: formula edit",void 0!==i),g=i):void 0===r?(Object(d.g)("calc.calc.PartialWorkbook.handleSetCellContents: format edit",!e&&void 0===i&&void 0!==u&&void 0===S),v=!1,g=void 0):(Object(d.g)("calc.calc.PartialWorkbook.handleSetCellContents: inferred edit",!e&&void 0===S&&y===l.f.Weak),v=(h=this.parseInferredEdit(t,r,a,S,y,m)).isFormula,g=h.oper,S=h.cellFailure,y=h.cellFormat,b=h.inferredFormat);var O=void 0!==m?m.cloneLazy.getValue():this.docs,C=O.setCellContents(e,t,r,v,a,g,S,y,c,p);if(C.kind===E.a.Failure)return this.onUnavailableObject(C.reason);if(O.onCellModified(e),!e){var P=Object(s.r)(t.sheet,a),N=void 0===r?Object(E.e)(void 0):v?O.inferFormulaFormat(P):void 0!==b&&b!==T.d.General?O.resolveValueFormat(t.sheet.document,b):Object(E.e)(void 0);N.kind!==E.a.Success&&(this.onInferFormatFailure(P,N.reason),N=Object(E.e)(l.f.Unavailable)),void 0!==N.value&&O.fillInferredFormat(t,N.value),void 0!==m?(m.stateId=this.stateId,this.enqueueEvalFormulaComputeCellValuesOnDocs(t,O,m)):this.enqueueBeforeCompute(p)}},e.prototype.parseInferredEdit=function(e,t,r,n,i,a){var o=a?a.cloneLazy.getValue().parseInferredEdit(Object(s.r)(e.sheet,r),t,this.getVolatileMode()):this.docs.parseInferredEdit(Object(s.r)(e.sheet,r),t,this.getVolatileMode());if(!Object(E.c)(o))return{isFormula:!1,oper:u.d,cellFailure:o.reason,cellFormat:l.f.Unavailable};var c=t.length>0?t.charAt(0):"";switch("="!==c&&"+"!==c&&"-"!==c||o.value.kind!==k.e.Formula&&o.value.kind!==k.e.Number||d.h.ULS.dnmTraceTag(541189698,S.LogCategory.msoulscat_ES_EWAJS,S.TraceLevel.Info,JSON.stringify({startChar:c,editKind:String(o.value.kind)})),o.value.kind){case k.e.Formula:return{isFormula:!0,oper:u.d,cellFailure:n,cellFormat:i};case k.e.String:case k.e.Other:return{isFormula:!1,oper:o.value.value,cellFailure:n,cellFormat:i};case k.e.Number:return{isFormula:!1,oper:o.value.value,cellFailure:n,cellFormat:i,inferredFormat:o.value.format}}},e.prototype.handleSetRangeFormula=function(e,t,r,n,i){var a=Object(p.z)(r);Object(d.g)("calc.calc.PartialWorkbook: handleSetRangeFormula",""===r&&!e||a);var o=e?void 0:u.d,s=e?void 0:l.f.Weak,c=e?void 0:l.g.Weak,f=this.docs.setRangeFormula(e,t,r,n,o,s,c,i);if(f.kind===E.a.Failure)return this.onUnavailableObject(f.reason);this.docs.onCellModified(e),e||this.enqueueBeforeCompute(i)},e.prototype.handleEditPaste=function(e,t,r,n){var i=Object(s.t)(t.sheet,Object(s.g)(t.range.row,t.range.col,r.range.rows,r.range.cols)),a=this.docs.copyRange(r);if(a.kind===E.a.Failure)return this.onUnavailableObject(a.reason);var o=this.docs.pasteRange(i,a.value);if(o.kind===E.a.Failure)return this.onUnavailableObject(o.reason);this.docs.onCellModified(!1),this.enqueueBeforeCompute(n)},e.prototype.evalFormula=function(e,t,r,i,o){var s=this;return new Promise((function(u){var c=function(){return u({value:Object(E.b)(a.x)})};s.scheduler.deleteTasks(re.EvalFormula,void 0),s.scheduler.addTask(re.EvalFormula,n.Back,{onRun:function(){if(!o&&!s.trySetStateId(re.EvalFormula,e))return c();s.enqueueComputeEvalFormula(t,r,i,o,u)},onDeleted:c}),s.enqueueRecalcFinished()}))},e.prototype.enqueueBeforeCompute=function(e){var t=this;this.scheduler.deleteTasks(re.BeforeCompute,void 0),this.scheduler.addTask(re.BeforeCompute,n.Back,(function(){t.enqueueAfterCompute(),t.restrictToViewport(t.docs.getNonDirtyEditedCells(),e,l.a.EditedCell,t.scheduleAvailableValues),t.restrictToViewport(t.docs.getDirtyEditedCells(),e,l.a.EditedCell,t.scheduleAvailableFormulas),t.restrictToViewport(t.docs.getDirtyDependentCells(),e,l.a.DependentCell,t.scheduleAvailableFormulas)}))},e.prototype.withEvalTiming=function(e){var t=this.docs.schedulerConfig.totalTimeMs;if(void 0===t)return e();var r,n=Object(m.j)();try{r=e()}finally{this.stateEvalTime+=Object(m.b)(1,Object(m.j)()-n),this.stateEvalTime>=t&&(this.deleteComputeTasks(ee.EvalTimedOut),this.outputMessageLog.push({kind:l.d.RecalcStatistics,stateId:this.stateId,message:l.e.StateTimedOut}),r=[])}return r},e.prototype.enqueueEvalFormulaComputeCellValuesOnDocs=function(e,t,r){var i=this,o=[];Object(f.g)(e.set,(function(t){return o.push(Object(s.r)(e.sheet,t)),!0}));var u=function(){return t.evaluate(l.a.EvalFormula,o,i.getVolatileMode())},c={onRun:function(){var e=i.withEvalTiming(u);if(Array.isArray(e)){var t=e.map((function(e,t){return e.kind===E.a.Failure?Object(E.b)({kind:e.reason.kind}):Object(E.e)(Object(m.m)(o[t].range,e.value))}));r.resultsPromise.resolve({stateId:r.stateId,results:t})}else u=e.resume,i.scheduler.addTask(re.ComputeEvalOnClone,n.Front,c)},onDeleted:function(){return r.resultsPromise.resolve({stateId:r.stateId,results:Object(Y.a)(new Array(o.length),Object(E.b)(a.x))})}};this.scheduler.addTask(re.ComputeEvalOnClone,n.Front,c)},e.prototype.enqueueComputeCellValue=function(e,t){var r,i=this,a=t===l.a.EditedCell&&this.shouldSample(this.config.sampleRecalcEditedStopwatchRate)?b("calc.calc.PartialWorkbook: recalc edited"):void 0,o=!0,s=function(){return i.docs.evaluate(t,[e],i.getVolatileMode())},u=function(){if(o){o=!1,r=i.shouldSample(i.config.sampleCellEvalStopwatchRate)?b("calc.calc.PartialWorkbook: cell eval"):void 0;var t=i.docs.getEditedFormula(e);if(!Object(E.c)(t))return i.onUnavailableObject(t.reason);if(void 0===t.value)return}else i.outputMessageLog.push({kind:l.d.RecalcStatistics,stateId:i.stateId,message:l.e.ContinueComputation});var c=i.withEvalTiming(s);if(Array.isArray(c))return null==r||r.stop(),void(null==a||a.stop());s=c.resume,i.scheduler.addTask(re.ComputeCellValue,n.Front,u)};this.scheduler.addTask(re.ComputeCellValue,n.Back,u)},e.prototype.enqueueComputeEvalFormula=function(e,t,r,i,o){var s=this;void 0===i&&(i=this.docs);var u=this.getVolatileMode(),c=function(){return i.evalFormula(e,t,r,u)},l={onRun:function(){var e=c();e.kind===E.a.Paused||e.kind===E.a.Breaked?(c=e.resume,s.scheduler.addTask(re.ComputeEvalFormula,n.Front,l)):o(e.value)},onDeleted:function(){return o({value:Object(E.b)(a.x)})}};this.scheduler.addTask(re.ComputeEvalFormula,n.Back,l)},e.prototype.enqueueReturnCellValue=function(e,t){var r=this,i=this.getVolatileMode();this.scheduler.addTask(re.ComputeCellValue,n.Back,(function(){r.docs.evalValue(e,t,i)}))},e.prototype.enqueueAfterCompute=function(){var e=this;this.scheduler.deleteTasks(re.AfterCompute,ee.EditReceived);var t=this.shouldSample(this.config.sampleRecalcViewportStopwatchRate)?b("calc.calc.PartialWorkbook: recalc viewport"):void 0;this.scheduler.addTask(re.AfterCompute,n.Back,{onRun:function(){null==t||t.stop(ee.EvalFinished),e.outputMessageLog.push({kind:l.d.RecalcStatistics,message:l.e.EditFinished,stateId:e.stateId})},onDeleted:function(e){null==t||t.stop(e)}})},e.prototype.enqueueRecalcFinished=function(){var e=this;this.scheduler.deleteTasks(re.RecalcFinished,void 0),this.scheduler.addTask(re.RecalcFinished,n.Back,(function(){e.outputMessageLog.push({kind:l.d.RecalcStatistics,message:l.e.RecalcFinished,stateId:e.stateId})}))},e.prototype.promoteCellContents=function(e,t,r,i){var a=this;this.scheduler.addTask(re.ServerUpdate,n.Back,(function(){if(a.trySetStateId(re.ServerUpdate,e)){var n=a.docs.promoteServerAvailability(r,i);if(n.kind===E.a.Failure)return a.onUnavailableObject(n.reason);a.docs.onCellModified(!0),n.value||a.outputMessageLog.push({kind:l.d.UpdateRequest,stateId:a.stateId,range:t})}}))},e.prototype.writeCellContents=function(e,t,r,i,a,o,s,u,c,l){var d=this;this.scheduler.addTask(re.ServerUpdate,n.Back,(function(){(l||d.trySetStateId(re.ServerUpdate,e))&&d.handleSetCellContents(!0,t,r,i,o,a,s,u,c,void 0,l)}))},e.prototype.editCellContents=function(e,t,r,i,a,o,c,d){var f=this;void 0===o&&(o=u.d),void 0===c&&(c=Object(s.t)(t.sheet,X)),this.lastViewport=c,this.scheduler.addTask(re.ClientEdit,n.Back,(function(){f.trySetStateId(re.ClientEdit,e)&&f.handleSetCellContents(!1,t,r,i,o,a,l.f.Weak,l.g.Weak,void 0,c,d)})),this.enqueueRecalcFinished()},e.prototype.editCellContentsOnClone=function(e,t,r,n,i){this.editCellContents(this.stateId,e,t,r,n,void 0,void 0,i)},e.prototype.editCellFormats=function(e,t,r,i,a){var o=this;void 0===a&&(a=Object(s.t)(t.sheet,X)),this.lastViewport=a,this.scheduler.addTask(re.ClientEdit,n.Back,(function(){if(o.trySetStateId(re.ClientEdit,e)){var n="SetFormat"===r.kind?o.docs.resolveEditFormat(t.sheet.document,r.format):"RibbonFormat"===r.kind?o.docs.resolveRibbonFormat(t.sheet.document,r.ribbon,Object(s.r)(t.sheet,i)):"ChangeDecimals"===r.kind?o.docs.resolveChangeDecimals(t.sheet.document,r.changeDecimals,Object(s.r)(t.sheet,i)):Object(d.d)("calc.calc.PartialWorkbook: editCellFormats",r);Object(E.c)(n)||Object(f.i)(t.set,(function(e){return o.onInferFormatFailure(Object(s.t)(t.sheet,e),n.reason),!0})),Object(E.c)(n)&&void 0===n.value||o.handleSetCellContents(!1,t,void 0,void 0,void 0,Object(s.f)(0,0),Object(E.c)(n)?n.value:l.f.Unavailable,void 0,void 0,a)}})),this.enqueueRecalcFinished()},e.prototype.writeArrayFormula=function(e,t,r,i,a){var s=this;void 0===i&&(i=Object(o.k)(t.range)),void 0===a&&(a=!1),this.scheduler.addTask(re.ServerUpdate,n.Back,(function(){s.trySetStateId(re.ServerUpdate,e)&&s.handleSetRangeFormula(!0,t,r,i,void 0)}))},e.prototype.editArrayFormula=function(e,t,r,i,a){var u=this;void 0===i&&(i=Object(o.k)(t.range)),void 0===a&&(a=Object(s.t)(t.sheet,X)),this.lastViewport=a,this.scheduler.addTask(re.ClientEdit,n.Back,(function(){u.trySetStateId(re.ClientEdit,e)&&u.handleSetRangeFormula(!1,t,r,i,a)})),this.enqueueRecalcFinished()},e.prototype.editPaste=function(e,t,r,i,a){var o=this;void 0===a&&(a=Object(s.t)(r.sheet,X)),this.scheduler.addTask(re.ClientEdit,n.Back,(function(){o.trySetStateId(re.ClientEdit,e)&&o.handleEditPaste(t,r,i,a)})),this.enqueueRecalcFinished()},e.prototype.testAdvanceState=function(e){var t=this;this.scheduler.addTask(re.TestAdvanceState,n.Back,(function(){t.trySetStateId(re.TestAdvanceState,e)}))},e.prototype.step=function(){if(!this.scheduler.runTask())return{queueEmpty:!0,messages:[]};var e=this.outputMessageLog;return this.outputMessageLog=[],{queueEmpty:!1,messages:e}},e.prototype.trySetStateId=function(t,r){var n,i,a,o,s,u=this;if(r<this.stateId)return!1;if(t===re.ClientEdit&&(this.deleteComputeTasks(ee.EditReceived),this.stateEvalTime=0),r>this.stateId){if(this.stateId!==-1/0){var c=this.config.sampleWorkbookStatisticsRate;void 0!==c&&this.shouldSample(c)&&this.outputMessageLog.push({kind:l.d.WorkbookStatistics,stateId:this.stateId,stats:this.getStatistics(),p:c})}1===this.stateChanges&&this.enqueueRunExperiments(z.a.OneShot),this.stateChanges>=1&&0===this.scheduler.getCount(re.RunExperiment)&&this.enqueueRunExperiments(z.a.Recurring);var d=null!==(n=this.config.samplePrecisionEvalRate)&&void 0!==n?n:0,f=null!==(i=this.config.samplePrecisionPrintFormulaRate)&&void 0!==i?i:0,p=null!==(a=this.config.samplePrecisionPrintValueRate)&&void 0!==a?a:0;if(this.stateChanges>=1&&(d>0||f>0||p>0)&&this.numPrecisionFailures<e.maxPrecisionFailures&&0===this.scheduler.getCount(re.RunExperiment)){var m=this.config.experimentFactories,h=null!==(o=null==m?void 0:m.stepBudget)&&void 0!==o?o:10,v=null!==(s=null==m?void 0:m.totalBudget)&&void 0!==s?s:1e4,g=new q({samplePrecisionEvalRate:d,samplePrecisionPrintFormulaRate:f,samplePrecisionPrintValueRate:p}),b={stateId:this.stateId,documents:this.docs.clone(g),stepBudget:h,totalBudget:v,viewport:this.lastViewport};g.setContext(b),this.enqueueRunExperiment("PrecisionExperiment",h,v,z.a.Precision,g,(function(){return u.numPrecisionFailures=0}),(function(){return u.numPrecisionFailures+=1}))}this.deleteComputeTasks(ee.StateIdAdvanced),this.lastViewport=void 0;var S=this.stateId;this.stateId=r,this.docs.advanceState(S),this.outputMessageLog.push({kind:l.d.StateAdvanced,stateId:this.stateId}),this.stateEvalTime=0,this.stateChangesSinceLastGC+=1,this.stateChanges+=1,this.enqueueMaybeCollectGarbage()}return!0},e.prototype.deleteComputeTasks=function(e){this.scheduler.deleteTasks(re.BeforeCompute,void 0),this.scheduler.deleteTasks(re.ComputeCellValue,void 0),this.scheduler.deleteTasks(re.AfterCompute,e),e!==ee.EvalTimedOut&&this.scheduler.deleteTasks(re.ComputeEvalFormula,void 0)},e.prototype.enqueueRunExperiment=function(e,t,r,i,a,o,s){var u=this,c=0,d=0,f=function(t,r,n,o){var s=a.failedLogMessage;void 0!==s&&u.outputMessageLog.push({experimentName:e,kind:l.d.ExperimentRunResult,experimentKind:i,logMessage:s,timeoutReason:{budgetType:t,budget:r,elapsedTime:n,stepsCount:o}})},p=function(){if(a.done){var h=a.resultLogMessage;return void 0!==h&&u.outputMessageLog.push({experimentName:e,kind:l.d.ExperimentRunResult,experimentKind:i,logMessage:h}),void o()}for(var v=Object(m.j)(),g=v,b=0;b<1e3&&g===v;b+=1){a.step(),d+=1;var S=Object(m.j)(),y=S-g;if(y>=t&&!a.done)return f("stepBudget",t,y,d),void s();g=S}if((c+=g>v?g-v:1)>=r&&!a.done)return f("totalBudget",r,c,d),void s();u.scheduler.addTask(re.RunExperiment,n.Front,p)};this.scheduler.addTask(re.RunExperiment,n.Back,p)},e.prototype.enqueueRunExperiments=function(e){var t;if(this.config.experimentFactories){var r=this.config.experimentFactories,n=r.stepBudget,i=r.totalBudget,a=r.factories.filter((function(t){var r,n;return t.kind===e&&(null!==(r=t.numFailures)&&void 0!==r?r:0)<(null!==(n=t.maxFailures)&&void 0!==n?n:3)}));if(0!==a.length)for(var o={stateId:this.stateId,documents:this.docs.clone(h.c,e===z.a.OneShot?ne.Server:ne.Client),stepBudget:n,totalBudget:i,viewport:this.lastViewport},s=function(r){var a=r.create();if(!a)return"continue";a.setContext(o),u.enqueueRunExperiment(r.experimentName,null!==(t=r.stepBudget)&&void 0!==t?t:n,i,e,a,(function(){return r.numFailures=0}),(function(){var e;return r.numFailures=(null!==(e=r.numFailures)&&void 0!==e?e:0)+1}))},u=this,c=0,l=a;c<l.length;c++){s(l[c])}}},e.prototype.setSheetNames=function(e,t,r){var i=this;this.scheduler.addTask(re.ServerUpdate,n.Back,(function(){if(i.trySetStateId(re.ServerUpdate,r)){var n=i.docs.setSheetNames(e,t);n.kind===E.a.Failure&&i.onUnavailableObject(n.reason),i.deleteComputeTasks(ee.SetSheetNames)}}))},e.prototype.setLangConfig=function(e,t){var r=this;this.scheduler.addTask(re.ServerUpdate,n.Back,(function(){if(r.trySetStateId(re.ServerUpdate,e)){var n=r.docs.config.localeInfo!==t.localeInfo,i=r.docs.config.refStyle!==t.refStyle;r.docs.setConfig(t),n&&r.docs.clearCompiledNumberFormats(),(n||i)&&(r.docs.clearCompiledFormulas(),r.deleteComputeTasks(ee.SetLangConfig))}}))},e.prototype.setNumberFormats=function(e,t,r,i){var a=this;this.scheduler.addTask(re.ServerUpdate,n.Back,(function(){if(a.trySetStateId(re.ServerUpdate,i)){var n=a.docs.setNumberFormats(e,t,r);return n.kind===E.a.Failure?a.onUnavailable(n.reason):void 0}}))},e.prototype.writeNamedObject=function(e,t,r,i){var a=this;this.scheduler.addTask(re.ServerUpdate,n.Back,(function(){if(a.trySetStateId(re.ServerUpdate,e)){var n=a.docs.setNamedObject(!0,Object(s.n)(t,r),i);return n.kind===E.a.Failure?a.onUnavailable(n.reason):void 0}}))},e.prototype.writeUndefinedNames=function(e,t){var r=this;this.scheduler.addTask(re.ServerUpdate,n.Back,(function(){if(r.trySetStateId(re.ServerUpdate,e)){var n=r.docs.setUndefinedNames(t);return n.kind===E.a.Failure?r.onUnavailable(n.reason):void 0}}))},e.prototype.promoteNamedObjects=function(e,t,r){var i=this;this.scheduler.addTask(re.ServerUpdate,n.Back,(function(){if(i.trySetStateId(re.ServerUpdate,e)){var n=i.docs.promoteNamedObjects(t,r);if(n.kind===E.a.Failure)return i.onUnavailable(n.reason);n.value||i.outputMessageLog.push({kind:l.d.UpdateNamesRequest,stateId:i.stateId,scope:t})}}))},e.prototype.extendUnusedRange=function(e,t){var r=this;this.scheduler.addTask(re.ServerUpdate,n.Back,(function(){if(r.trySetStateId(re.ServerUpdate,t)){var n=r.docs.extendServerUnused(e.sheet,e.range);if(n.kind===E.a.Failure)return r.onUnavailableObject(n.reason);r.docs.onCellModified(!0)}}))},e.prototype.writeHiddenRows=function(e,t){var r=this;this.scheduler.addTask(re.ServerUpdate,n.Back,(function(){if(r.trySetStateId(re.ServerUpdate,e)){var n=r.docs.writeHiddenRows(t.sheet,t.range,t.hidden);return n.kind===E.a.Failure?r.onUnavailableObject(n.reason):void 0}}))},e.prototype.writeHiddenCols=function(e,t){var r=this;this.scheduler.addTask(re.ServerUpdate,n.Back,(function(){if(r.trySetStateId(re.ServerUpdate,e)){var n=r.docs.writeHiddenCols(t.sheet,t.range,t.hidden);return n.kind===E.a.Failure?r.onUnavailableObject(n.reason):void 0}}))},e.prototype.writeInFilterMode=function(e,t){var r=this;this.scheduler.addTask(re.ServerUpdate,n.Back,(function(){if(r.trySetStateId(re.ServerUpdate,e)){var n=r.docs.writeInFilterMode(t.sheet,t.inFilterMode);return n.kind===E.a.Failure?r.onUnavailableObject(n.reason):void 0}}))},e.prototype.getStatistics=function(){return{queueSize:this.scheduler.getCount(),totalGridStatistics:this.docs.getGridStatistics(),totalNameStatistics:this.docs.getNameStatistics()}},e.prototype.enqueueMaybeCollectGarbage=function(){var e=this;this.scheduler.deleteTasks(re.MaybeCollectGarbage,void 0),this.scheduler.addTask(re.MaybeCollectGarbage,n.Back,(function(){if(!(e.stateChangesSinceLastGC<17)){var t=e.stateId-17;e.docs.collectGarbage(t),e.outputMessageLog.push({kind:l.d.GarbageCollected,minStateIdKept:t}),e.stateChangesSinceLastGC=0}}))},e.prototype.shouldSample=function(e){return void 0!==e&&this.rng.next()<=e},e.prototype.restrictToViewport=function(e,t,r,n){if(void 0!==t)for(var i=t.sheet,a=t.range,s=Object(f.f)(a),u=0,c=e;u<c.length;u++){var d=c[u];Object(o.Q)(i,d.sheet)&&n(Object(l.l)(i,Object(g.g)(d.set,s)),r)}else for(var p=0,m=e;p<m.length;p++){n(d=m[p],r)}},e.prototype.getVolatileMode=function(){var e;return null!==(e=this.config.volatileMode)&&void 0!==e?e:h.b.Estimation},e.maxPrecisionFailures=3,e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wildcard=t.webFuncs=t.volatileFuncs=t.funcsUtil=t.funcsTestUtils=t.stringFuncs=t.referenceFuncs=t.reduce=t.recordFuncs=t.rangeFuncs=t.predicateFuncs=t.numfmtFuncs=t.mathFuncs=t.lookupFuncs=t.logicalFuncs=t.lambdaFuncs=t.informationFuncs=t.getWorksheetFuncModule=t.engineeringFuncs=t.dateTimeFuncs=t.criteria=t.aggregationFuncs=t.visitedMap=t.value=t.util=t.testUtils=t.term=t.subexpressionEvaluation=t.serviceTypes=t.rtree=t.machine=t.extensionTypes=t.evaluatorService=t.evalTypes=t.evalRuntime=t.evalFunction=t.dereferenceModule=t.compilerService=t.coerce=t.calcChain=t.PackageName=void 0,t.PackageName="excel-online-calc-runtime",t.calcChain=r(369),t.coerce=r(194),t.compilerService=r(195),t.dereferenceModule=r(197),t.evalFunction=r(253),t.evalRuntime=r(199),t.evalTypes=r(52),t.evaluatorService=r(373),t.extensionTypes=r(138),t.machine=r(71),t.rtree=r(250),t.serviceTypes=r(105),t.subexpressionEvaluation=r(374),t.term=r(137),t.testUtils=r(375),t.util=r(54),t.value=r(119),t.visitedMap=r(117),t.aggregationFuncs=r(260),t.criteria=r(261),t.dateTimeFuncs=r(264),t.engineeringFuncs=r(266),t.getWorksheetFuncModule=r(259),t.informationFuncs=r(267),t.lambdaFuncs=r(268),t.logicalFuncs=r(269),t.lookupFuncs=r(270),t.mathFuncs=r(204),t.numfmtFuncs=r(271),t.predicateFuncs=r(272),t.rangeFuncs=r(273),t.recordFuncs=r(274),t.reduce=r(263),t.referenceFuncs=r(275),t.stringFuncs=r(276),t.funcsTestUtils=r(384),t.funcsUtil=r(106),t.volatileFuncs=r(277),t.webFuncs=r(278),t.wildcard=r(152)},function(e,t,r){"use strict";var n,i,a,o,s,u;r.d(t,"c",(function(){return a})),r.d(t,"d",(function(){return o})),r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return u})),function(e){e[e.FunctionMessage=0]="FunctionMessage"}(n||(n={})),function(e){e[e.Insert=0]="Insert",e[e.Delete=1]="Delete",e[e.Replace=2]="Replace"}(i||(i={})),function(e){e[e.TestPlugin=0]="TestPlugin",e[e.AutocompletePlugin=1]="AutocompletePlugin",e[e.DragPlugin=2]="DragPlugin",e[e.ConfigTestPlugin=3]="ConfigTestPlugin",e[e.ArgumentAssistancePlugin=4]="ArgumentAssistancePlugin",e[e.FeatureGateTestPlugin=5]="FeatureGateTestPlugin",e[e.FormulaRepairPlugin=6]="FormulaRepairPlugin",e[e.DNMTraceTagTestPlugin=7]="DNMTraceTagTestPlugin",e[e.ParenthesesCouplingPlugin=8]="ParenthesesCouplingPlugin",e[e.AutocompleteFunctionPlugin=9]="AutocompleteFunctionPlugin",e[e.AutocompleteLetPlugin=10]="AutocompleteLetPlugin",e[e.AutocompleteRichValuePlugin=11]="AutocompleteRichValuePlugin",e[e.AutocompleteNamedObjectsPlugin=12]="AutocompleteNamedObjectsPlugin",e[e.AutocompleteTableHeadersPlugin=13]="AutocompleteTableHeadersPlugin",e[e.ColoredReferencesPlugin=14]="ColoredReferencesPlugin",e[e.AutocompletePrecisionMeasurements=1e3]="AutocompletePrecisionMeasurements",e[e.AutocompleteGroundTruthMeasurements=1002]="AutocompleteGroundTruthMeasurements",e[e.AutocompleteDataTypesMeasurements=1003]="AutocompleteDataTypesMeasurements",e[e.FormulaCollectionPlugin=1004]="FormulaCollectionPlugin",e[e.ParserPerformanceMeasurements=1005]="ParserPerformanceMeasurements",e[e.AutocompleteAuthoringPrecisionMeasurements=1006]="AutocompleteAuthoringPrecisionMeasurements",e[e.ChangeGateTestPlugin=2e3]="ChangeGateTestPlugin",e[e.SlowTestPlugin=2001]="SlowTestPlugin",e[e.EvalOnCloneTestPlugin=2002]="EvalOnCloneTestPlugin",e[e.EvalFormulaTestPlugin=2003]="EvalFormulaTestPlugin"}(a||(a={})),function(e){e[e.Done=0]="Done",e[e.Superseded=1]="Superseded"}(o||(o={})),function(e){e[e.CellRef=0]="CellRef",e[e.StructRef=1]="StructRef",e[e.NamedRange=2]="NamedRange",e[e.Parentheses=3]="Parentheses"}(s||(s={})),function(e){e[e.Disabled=0]="Disabled",e[e.MockNotifyActiveCellChanged=1]="MockNotifyActiveCellChanged",e[e.MockSetActiveCellNotification=2]="MockSetActiveCellNotification",e[e.MockSetActiveCellImpl=3]="MockSetActiveCellImpl",e[e.MockActiveCellEventRegistration=4]="MockActiveCellEventRegistration"}(u||(u={}))},function(e,t,r){"use strict";r.d(t,"y",(function(){return f})),r.d(t,"w",(function(){return h})),r.d(t,"x",(function(){return v})),r.d(t,"C",(function(){return g})),r.d(t,"A",(function(){return b})),r.d(t,"a",(function(){return O})),r.d(t,"m",(function(){return E})),r.d(t,"g",(function(){return _})),r.d(t,"d",(function(){return w})),r.d(t,"B",(function(){return x})),r.d(t,"z",(function(){return L})),r.d(t,"v",(function(){return U})),r.d(t,"e",(function(){return G})),r.d(t,"k",(function(){return K})),r.d(t,"s",(function(){return W})),r.d(t,"r",(function(){return Z})),r.d(t,"p",(function(){return ie})),r.d(t,"c",(function(){return oe})),r.d(t,"t",(function(){return se})),r.d(t,"i",(function(){return ye})),r.d(t,"j",(function(){return Oe})),r.d(t,"o",(function(){return Re})),r.d(t,"n",(function(){return Te})),r.d(t,"b",(function(){return Ee})),r.d(t,"l",(function(){return Fe})),r.d(t,"h",(function(){return Ue})),r.d(t,"u",(function(){return Ve})),r.d(t,"f",(function(){return We})),r.d(t,"q",(function(){return qe}));var n,i=r(4),a=r(21),o=r(8),s=r(47),u=r(12),c=r(11),l=r(35),d=r(77);function f(e,t){var r;e[t]=(null!==(r=e[t])&&void 0!==r?r:0)+1}function p(e,t,r){return e.push("".concat(t.join("."),": expected ").concat(r)),!1}function m(e,t){return function(r,n,a){return Object(i.e)(r)&&e(r)||p(n,a,t)}}function h(e,t,r,n){for(var i=[],a=t(e,i,[n]),o=0,s=i;o<s.length;o++){f(r,s[o])}return a}function v(e,t,r,n){if(!h(e,D,r,n))return[];var i="".concat(n,".<index>");return e.filter((function(e){return h(e,t,r,i)}))}function g(e){return function(t,r,n){return!!Object(i.f)(t)||e(t,r,n)}}function b(e){return function(t,r,n){if(Object(i.f)(t))return p(r,n,"non-null object");var a=n.length;try{var o=!0;for(var s in e)n[a]=s,o=o&&e[s](t[s],r,n);return o}finally{n.length=a}}}function S(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t,r,n){return e.reduce((function(e,i){return e&&i(t,r,n)}),!0)}}function y(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return function(r,n,i){return t.reduce((function(e,t){return e&&t(r)(r,n,i)}),e(r,n,i))}}function O(e){return function(t,r,n){if(!Array.isArray(t))return p(r,n,"Array");n.push("<index>");try{return t.reduce((function(t,i){return t&&e(i,r,n)}),!0)}finally{n.pop()}}}function C(e){var t="one of ".concat(JSON.stringify(Object.getOwnPropertyNames(e).sort()));return function(r,n,a){if(Object(i.f)(r))return p(n,a,"non-null object");var o=a.length;try{var s="string"==typeof r.kind||"number"==typeof r.kind?e[r.kind]:void 0;return Object(i.f)(s)?(a.push("kind"),p(n,a,t)):s(r,n,a)}finally{a.length=o}}}function P(e){var t="typeof one of ".concat(JSON.stringify(Object.getOwnPropertyNames(e).sort()));return function(r,n,a){var o=e[typeof r];return Object(i.f)(o)?p(n,a,t):o(r,n,a)}}function N(e){return"number"==typeof e&&e>-1/0&&e<1/0}function R(e){return(0|e)===e||Math.floor(e)===e}function k(e,t,r){return void 0===r&&(r=0!==e?"integer >= ".concat(e," and < ").concat(t):"natural < ".concat(t)),m((function(r){return"number"==typeof r&&r>=e&&r<t&&R(r)}),r)}var T=m((function(e){return!1}),"never"),E=m((function(e){return"number"==typeof e&&!isNaN(e)}),"number (non-NaN)"),_=m(N,"finite number"),F=m((function(e){return N(e)&&R(e)}),"integer"),I=k(0,1/0,"natural"),A=m((function(e){return"string"==typeof e}),"string"),M=m((function(e){return"string"==typeof e&&e.length>0}),"nonempty string"),w=m((function(e){return"boolean"==typeof e}),"boolean"),D=m((function(e){return Array.isArray(e)}),"Array");function j(e){return m((function(t){return t===e}),JSON.stringify(e))}function x(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r={},n=0,i=e;n<i.length;n++){var a=i[n];r[a]=!0}var o="one of ".concat(JSON.stringify(e.sort()));return m((function(e){return"string"==typeof e&&!0===r[e]}),o)}function L(e){return"="===e[0]||"+"===e[0]||"-"===e[0]}var B=m((function(e){return"string"==typeof e&&L(e)}),"formula text"),U=b({functionId:I,functionName:M}),G=b({errorType:I,errorName:m((function(e){return"string"==typeof e&&e.length>1&&Object(l.e)(e,"#")}),"error name")}),K=b({iformat:I,formatString:A,builtIn:w}),V=m((function(e){return"string"==typeof e||N(e)}),"string or finite number"),W=b({sheetId:V,sheetName:A}),H=k(0,o.x),q=k(0,o.q),z=b({row:H,column:q}),Q=m((function(e){return null==e.lastRow||e.lastRow>=e.row}),"lastRow >= row"),J=m((function(e){return null==e.lastColumn||e.lastColumn>=e.column}),"lastColumn >= column"),Y=y(S(z,b({lastRow:g(H),lastColumn:g(q)})),(function(e){return Q}),(function(e){return J})),$=S(Y,b({sheetId:V})),Z=S($,b({lastRow:g(T),lastColumn:g(T)})),X=b({kind:j("Blank")}),ee=b({kind:j("Error"),type:I}),te=P({number:_,string:A,boolean:w,object:C({Blank:X,Error:ee})}),re=P({number:I,string:A}),ne=S(b({value:te,iformat:I,failureReason:g(A)}),C({CellFormula:b({formulaBarText:B}),ArrayFormula:b({formulaBarText:g(T)}),Value:b({formulaBarText:A})})),ie=b({range:$,excludeRows:g(O(H)),excludeColumns:g(O(q)),data:g(ne),fromStateId:g(F)}),ae=b({isSpilled:w,formulaBarText:B}),oe=b({range:$,data:g(ae),fromStateId:g(F)}),se=b({sheetId:V,usedRange:g(Y)}),ue=P({number:_,string:A,boolean:w,object:C({Error:ee})}),ce=b({kind:j("NamedValue"),value:ue}),le=b({kind:j("NamedFormula"),formulaBarText:B}),de=b({kind:j("NamedRange"),range:$}),fe=b({column:I,name:M}),pe=function(e){var t;return(null!==(t=e.lastRow)&&void 0!==t?t:e.row)-e.row+1},me=function(e){var t;return(null!==(t=e.lastColumn)&&void 0!==t?t:e.column)-e.column+1},he=m((function(e){return(!e.hasHeadersRow||e.range.row>0)&&(!e.hasTotalsRow||e.range.row+pe(e.range)<o.x)}),"enough rows for headers and totals"),ve=m((function(e){var t=e.range.column,r=e.range.column+me(e.range);return e.columns.every((function(e){return e.column>=t&&e.column<r}))}),"column names in range"),ge=y(b({kind:j("NamedTable"),range:$,hasHeadersRow:w,hasTotalsRow:w,columns:O(fe)}),(function(e){return he}),(function(e){return ve})),be=b({kind:j("NamedFailure"),failureReason:A,objectKind:g(x("NamedValue","NamedFormula","NamedRange","NamedTable"))}),Se=b({name:A,data:g(C({NamedValue:ce,NamedFormula:le,NamedRange:de,NamedTable:ge,NamedFailure:be}))}),ye=function(e){return y(Se,(function(t){return function(e){return m((function(t){var r;return"NamedTable"!==(null===(r=t.data)||void 0===r?void 0:r.kind)||null==e}),"NamedTable at global scope")}(e)}))},Oe=b({scope:g(V),objects:g(D),fromStateId:g(F)}),Ce=m((function(e){return e.length>0}),"a non-empty array"),Pe=m((function(e){return e.every((function(t){return t.sheetId===e[0].sheetId}))}),"ranges on the same sheet"),Ne=y(O($),(function(e){return Ce}),(function(e){return Pe})),Re=S(b({range:Ne,origin:g(z),viewport:g($)}),C({CellFormula:b({formulaBarText:B,value:g(T)}),Value:b({formulaBarText:A,value:te}),Inferred:b({formulaBarText:A,value:g(T)})})),ke=C({SetFormat:b({format:re}),RibbonFormat:b({ribbon:x.apply(void 0,Object(i.u)(d.a))}),ChangeDecimals:b({changeDecimals:k(-20,20)})}),Te=b({range:Ne,operation:ke,origin:g(z),viewport:g($)}),Ee=b({range:$,formulaBarText:m((function(e){return"string"==typeof e&&(0===e.length||L(e))}),"empty string or text denoting formula"),origin:g(z),viewport:g($)}),_e=m((function(e){var t=me(e.source),r=pe(e.source);return e.target.column+t<=o.q&&e.target.row+r<=o.x}),"(target,source) in range"),Fe=y(b({kind:x("CopyPaste"),target:Z,source:$,viewport:g($)}),(function(e){return _e})),Ie=m((function(e){return 2===e.length}),"2 AM/PM symbols"),Ae=m((function(e){return 7===e.length}),"7 day symbols"),Me=m((function(e){return 12===e.length}),"12 month symbols");function we(e){var t=Object(i.l)(e,i.d);return m((function(e){return e.every((function(e,r){return null==e||r in t}))}),"indexes in enum")}var De=we(c.i),je=we(u.h),xe=we(u.g),Le=we(u.e),Be=we(u.f),Ue=b({worksheetFunctionNames:D,thousandsData:O(I),errorTypeNames:D,specialRefNames:y(O(g(M)),(function(e){return De})),trueName:M,falseName:M,rowLetter:M,columnLetter:M,leftBrace:M,rightBrace:M,leftBracket:M,rightBracket:M,decimalSeparator:M,listSeparator:M,columnSeparator:M,rowSeparator:M,thousandsSeparator:A,lcid:I,country:I,numberDecimals:I,isExpSepBySpace:w,fractionSeparator:M,isPercentSepBySpace:w,currencyFormat:x(s.b.Paren,s.b.Lead,s.b.Intern,s.b.Trail),isCurrencySymbolLead:w,isCurrencySepBySpace:w,currencySymbol:A,currencyDecimals:I,dateOrder:x(s.c.MDY,s.c.DMY,s.c.YMD,s.c.MYD,s.c.DYM,s.c.YDM),dateSeparator:A,dateAltSeparator:A,year4Digits:w,month2Digits:w,day2Digits:w,longDateFormat:w,timeSeparator:A,timeAltSeparator:g(A),hour2Digits:w,clock24Hour:w,isAMPMSepBySpace:w,ampmSymbols:y(O(A),(function(e){return Ie})),dayNameShort:y(O(A),(function(e){return Ae})),dayNameLong:y(O(A),(function(e){return Ae})),monthNameShort:y(O(A),(function(e){return Me})),monthNameLong:y(O(A),(function(e){return Me})),pictureSpecial:y(O(g(M)),(function(e){return je})),pictureSingle:y(O(g(M)),(function(e){return xe})),pictureColor:y(O(g(M)),(function(e){return Le})),pictureDbnum:y(O(g(M)),(function(e){return Be})),sysDateFormat:A,sysTimeFormat:A}),Ge=b({yr:F,mon:k(1,13),dom:k(1,6),wdy:k(1,8),hour:k(0,24),min:k(0,60),sec:k(0,60),fracSec:j(0),rounding:k(0,4)}),Ke=y(b({bias:_,standardDate:g(Ge),standardBias:_,daylightDate:g(Ge),daylightBias:_}),(function(e){return m((function(e){return Object(i.f)(e.standardDate)===Object(i.f)(e.daylightDate)}),"standardDate iff daylightDate")})),Ve=b({date1904:g(w),dateCompatibility:g(w),timezone:g(Ke)}),We=g(C({Origin:b({value:g(T)}),Iformat:b({value:g(I)}),Inferred:b({value:g(T)})})),He=((n={})[a.b.Number]=!0,n[a.b.String]=!0,n[a.b.Boolean]=!0,n[a.b.Error]=!0,n[a.b.Array]=!1,n[a.b.Blank]=!0,n[a.b.Rich]=!1,n),qe=m((function(e){return He[e.kind]}),"supported ReadOper")},function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a})),r.d(t,"c",(function(){return o})),r.d(t,"d",(function(){return s})),r.d(t,"e",(function(){return u})),r.d(t,"f",(function(){return c})),r.d(t,"g",(function(){return l})),r.d(t,"h",(function(){return d})),r.d(t,"i",(function(){return f})),r.d(t,"j",(function(){return p})),r.d(t,"k",(function(){return m})),r.d(t,"l",(function(){return h})),r.d(t,"m",(function(){return v})),r.d(t,"n",(function(){return g})),r.d(t,"o",(function(){return b})),r.d(t,"p",(function(){return S})),r.d(t,"q",(function(){return y})),r.d(t,"r",(function(){return O}));var n=r(3),i=n.visitor.BinaryVisitor,a=n.visitor.ComposeVisitor,o=n.visitor.ConstVisitor,s=n.visitor.DelegatingVisitor,u=n.visitor.IdentityVisitor,c=(n.visitor.PledgeReducer,n.visitor.ZipVisitor,n.visitor.binaryVisitor),l=(n.visitor.bindVisitor,n.visitor.composeVisitor),d=n.visitor.constVisitor,f=(n.visitor.depthVisitor,n.visitor.identityVisitor),p=n.visitor.reduceBottomUp,m=(n.visitor.reduceBottomUp_CPS,n.visitor.reduceBottomUp_MaxDepth,n.visitor.reduceBottomUp_Pledge,n.visitor.reduceBottomUp_Recursive,n.visitor.reducePledge),h=(n.visitor.reduceTopDown_Pledge,n.visitor.visitAppHeadNode),v=n.visitor.visitCellRef,g=n.visitor.visitFormulaNode,b=n.visitor.visitOperatorNode,S=n.visitor.visitQualifier,y=n.visitor.visitWSFNode,O=n.visitor.voidVisitor;n.visitor.zipVisitor},function(e,t,r){"use strict";r.d(t,"a",(function(){return d})),r.d(t,"b",(function(){return f})),r.d(t,"d",(function(){return p})),r.d(t,"c",(function(){return m})),r.d(t,"e",(function(){return h}));var n=r(9),i=r(21),a=r(0),o=r(45),s=r(17),u=r(46),c=r(6),l=r(24),d=function(){function e(e){this.valueCreationFunc=e,this.value=void 0}return e.prototype.getValue=function(){return void 0===this.value&&(this.value=this.valueCreationFunc()),this.value},e.prototype.reset=function(){this.value=void 0},e}();function f(e){return new d(e)}function p(e){var t=e.value;if(Object(a.c)(t)){var r=t.value;switch(typeof r){case"object":switch(r.kind){case"Blank":return i.b.Blank;case"Error":return i.b.Error;case"Rich":return i.b.Rich;default:Object(n.d)("calc.calc.extractResultValue",r)}case"boolean":return i.b.Boolean;case"number":return i.b.Number;case"string":return i.b.String;default:return Object(n.d)("calc.calc.extractResultValue",r)}}}function m(e){var t=e.value;if(!Object(a.c)(t))return t.reason.kind}function h(e,t,r,i){switch(void 0===i&&(i=u.b.Estimation),i){case u.b.PrecisionTest:return Object(a.b)(Object(c.Z)([{kind:l.e.GetTimeKind,getTimeKind:r}]));case u.b.Estimation:switch(r){case s.j.NonVolatile:return Object(a.b)(Object(c.Z)([{kind:l.e.GetTimeKind,getTimeKind:r}]));case s.j.ValueCell:case s.j.Volatile:}break;case u.b.GroundTruth:}var d=e.mathpack,f=e.datepack,p=new Date,m=f.utcToLocal(e,Object(o.d)(p.getUTCFullYear(),p.getUTCMonth()+1,p.getUTCDate(),p.getUTCHours(),p.getUTCMinutes(),p.getUTCSeconds(),p.getUTCDay()+1,p.getUTCMilliseconds(),o.a.Round1000ths),e.timezone);Object(n.g)("calc.calc.PartialWorkbookDocumentCollection: to local",!1!==m);var h=m.yr,v=m.rounding,g=m.mon,b=m.dom,S=m.hour,y=m.min,O=m.sec,C=m.fracSec;t<o.c.Instant&&(C=0,O=0,y=0,S=0),t<o.c.Day&&(b=1,g=1);var P=Object(o.d)(h,g,b,S,y,O,1,C,v),N=f.toNum(e,P);Object(n.g)("calc.calc.PartialWorkbookDocumentCollection: toNum",!Object(c.y)(N));var R=d.toNumber(N);if(i===u.b.GroundTruth)return Object(a.e)(N);var k=f.toNum(e,m);Object(n.g)("calc.calc.PartialWorkbookDocumentCollection: toNum",!Object(c.y)(k));var T,E=d.toNumber(k);switch(t){case o.c.Instant:T=E;break;case o.c.Day:T=R+1;break;case o.c.Year:var _=Object(o.d)(h+1,g,b,S,y,O,1,C,v),F=f.toNum(e,_);Object(n.g)("calc.calc.PartialWorkbookDocumentCollection: toNum",!Object(c.y)(F)),T=d.toNumber(F)}return E<R+10/1440||E>T-10/1440?Object(a.b)(Object(c.Z)([{kind:l.e.TimeGranularity,granularity:t}])):Object(a.e)(N)}},function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a})),r.d(t,"c",(function(){return o})),r.d(t,"d",(function(){return s})),r.d(t,"e",(function(){return u})),r.d(t,"f",(function(){return c})),r.d(t,"g",(function(){return l})),r.d(t,"h",(function(){return d})),r.d(t,"i",(function(){return f})),r.d(t,"j",(function(){return p})),r.d(t,"k",(function(){return m})),r.d(t,"l",(function(){return h})),r.d(t,"m",(function(){return v})),r.d(t,"n",(function(){return g})),r.d(t,"o",(function(){return b})),r.d(t,"p",(function(){return S})),r.d(t,"q",(function(){return y})),r.d(t,"r",(function(){return O})),r.d(t,"s",(function(){return C})),r.d(t,"t",(function(){return P})),r.d(t,"u",(function(){return N})),r.d(t,"v",(function(){return R}));var n=r(3),i=n.value.ErrorType,a=n.value.PrecsBound,o=n.value.arrayOper,s=n.value.blankOper,u=n.value.booleanOper,c=(n.value.cellStringLimit,n.value.div0ErrorOper),l=n.value.errorOper,d=n.value.falseOper,f=n.value.fieldErrorOper,p=n.value.gettingDataErrorOper,m=n.value.missingOper,h=n.value.naErrorOper,v=n.value.nameErrorOper,g=n.value.nullErrorOper,b=n.value.numErrorOper,S=n.value.precedents,y=n.value.range3DOper,O=n.value.rangeSeqOper,C=n.value.refErrorOper,P=n.value.stringOper,N=n.value.trueOper,R=n.value.valueErrorOper},function(e,t,r){"use strict";r.d(t,"d",(function(){return y})),r.d(t,"g",(function(){return O})),r.d(t,"p",(function(){return P})),r.d(t,"k",(function(){return N})),r.d(t,"q",(function(){return R})),r.d(t,"l",(function(){return k})),r.d(t,"n",(function(){return T})),r.d(t,"m",(function(){return E})),r.d(t,"o",(function(){return _})),r.d(t,"f",(function(){return F})),r.d(t,"c",(function(){return I})),r.d(t,"b",(function(){return A})),r.d(t,"j",(function(){return M})),r.d(t,"h",(function(){return w})),r.d(t,"i",(function(){return D})),r.d(t,"a",(function(){return j})),r.d(t,"e",(function(){return x}));var n=r(2),i=r(4),a=r(12),o=r(8),s=r(15),u=r(14),c=r(39),l=r(10),d=r(30),f=r(6),p=r(16),m=r(13),h=r(9),v=r(27),g=r(50),b=r(21),S=r(11);function y(e,t){var r=Object(i.g)("en-US"),o=function(e,t,r){var n=Object(a.q)().slice();return Object(v.x)(t,v.v,r,"localeData.worksheetFunctionNames").forEach((function(e){return n[e.functionId]=e.functionName})),Object(a.k)(e,n)}(r,e.worksheetFunctionNames,t),s=o.getWorksheetFuncId,u=o.getWorksheetFuncName,c=function(e){if(Object(i.f)(e))return function(e){return e>0&&e%3==0};if(0===e.length||0===e[0])return function(){return!1};if(2===e.length&&0===e[1]){var t=e[0];return function(e){return e>0&&e%t==0}}var r=0===e[e.length-1]&&e.length>=2;return function(t){if(t<=0)return!1;for(var n=t,i=0;i<e.length&&!((n-=e[i])<=0);i+=1);return n>0&&r?n%e[e.length-2]==0:0===n}}(e.thousandsData),l=function(e,t){var r=a.l.slice();return Object(v.x)(e,v.e,t,"localeData.errorTypeNames").forEach((function(e){return r[e.errorType]=e.errorName})),r}(e.errorTypeNames,t),d=e.lcid,f=d===a.b.Thailand,p=d===a.b.Korea,m=d===a.b.Japan,h=d===a.b.ChinaT||d===a.b.HongKong,g=d===a.b.China,b=p||m||g||h,S=d===a.b.Hindi||d===a.b.Tamil,y=d===a.b.Thailand||d===a.b.Vietnam||S,O=(d&a.b.LANG)==(a.b.Hebrew&a.b.LANG)||(d&a.b.LANG)==(a.b.Arabic&a.b.LANG)||d===a.b.Syriac||y,C=Object(a.t)(),P=Object(a.s)(),N=Object(a.r)();return Object(n.__assign)(Object(n.__assign)({},e),{getWorksheetFuncId:s,getWorksheetFuncName:u,isNumeral:C,getOrdinal:P,getNumberShape:N,isThousandsPosition:c,isIdentStart:a.v,isIdentContinue:a.u,stringCompareCI:r,errorNames:l,isThai:f,isEastAsia:b,isKorea:p,isJapan:m,isChinaT:h,isChinaS:g,isComplexScript:O})}function O(e){return y(e,{})}function C(e,t){return Object(i.f)(t)?{index:e,length:1}:{index:e,length:Object(i.a)(t-e)+1}}function P(e,t){var r=C(t.row,t.lastRow),n=r.index,i=r.length,a=C(t.column,t.lastColumn),s=a.index,u=a.length;return Object(o.t)(Object(o.u)(e,t.sheetId),Object(o.g)(n,s,i,u))}function N(e,t){var r=t.row,n=t.column;return Object(o.r)(Object(o.u)(e,t.sheetId),Object(o.f)(r,n))}function R(e,t){var r=t.sheetId,a=t.usedRange;return Object(i.e)(a)?P(e,Object(n.__assign)({sheetId:r},a)):Object(l.m)(Object(o.u)(e,r),c.i)}function k(e,t,r){return{sheet:e.sheet,set:function(e,t,r){var n=Object(m.c)({row:t}),i=Object(m.c)({col:r}),a=Object(m.j)(n,i);return Object(m.d)(Object(u.f)(e),a)}(e.range,t,r)}}function T(e,t){return{sheet:e.sheet,range:e.range,hidden:t}}function E(e,t){return{sheet:e.sheet,range:e.range,hidden:t}}function _(e){return Object(f.L)(e)?Object(s.gb)(e.sheet.index,e.range.row,e.range.col):Object(s.gb)(e.sheet.index,e.range.row,e.range.col,e.range.row+e.range.rows-1,e.range.col+e.range.cols-1)}function F(e){return{row:e.row,column:e.col}}function I(e,t,r,n){var a=p.d;if(Object(i.f)(n))return a;for(var o=0;o<n.length;o+=1){var s=n[o];if(e<=s&&s<e+t){for(var u=1;o+u<n.length&&n[o+u]===s+u;)u+=1;o+=u-1,a=Object(p.j)(a,r(Object(i.m)(s,s+u)))}}return a}function A(e,t){switch(typeof t){case"string":return Object(d.t)(t);case"boolean":return Object(d.e)(t);case"number":return e.fromNumber(t)}switch(t.kind){case"Blank":return d.d;case"Error":return Object(d.g)(t.type);default:return}}function M(e,t){switch(t.kind){case b.b.String:case b.b.Boolean:return t.value;case b.b.Number:return e.toNumber(t);case b.b.Error:return Object(s.s)(t.type);case b.b.Blank:return s.j;default:return}}function w(e,t,r,n){if(!Object(i.f)(n))switch(n.kind){case"NamedValue":switch(typeof n.value){case"string":return Object(g.j)(Object(d.t)(n.value));case"boolean":return Object(g.j)(Object(d.e)(n.value));case"number":return Object(g.j)(e.fromNumber(n.value))}return"Error"===n.value.kind?Object(g.j)(Object(d.g)(n.value.type)):Object(h.d)("calc.calc.namedObjectDataToNamedObject: NamedValue",n.value.kind);case"NamedFormula":return Object(g.g)(n.formulaBarText);case"NamedRange":var a=P(r,n.range);return Object(g.h)(Object(d.q)(a.sheet,a.range));case"NamedTable":var o=P(r,n.range);return Object(g.i)(o,n.hasHeadersRow,n.hasTotalsRow,n.columns,t);case"NamedFailure":return Object(g.f)(n.failureReason,Object(i.f)(n.objectKind)?void 0:n.objectKind);default:return Object(h.d)("calc.calc.namedObjectDataToNamedObject: kind",n)}}function D(e,t,r){if(r)switch(r.kind){case"NamedValue":switch(r.value.kind){case b.b.Number:return Object(s.P)(e.toNumber(r.value));case b.b.String:case b.b.Boolean:return Object(s.P)(r.value.value);case b.b.Error:return Object(s.P)(r.value.type);default:return}case"NamedFormula":return Object(s.I)(r.fmla);case"NamedRange":var n=Object(o.t)(Object(o.u)(t,r.value.sheets.index),r.value.ranges[0]);return Object(s.N)(_(n));case"NamedTable":var i=r.specialRefRanges[S.i.Data],a=[];return r.columnIndexes.forEach((function(e,t){return a.push(Object(s.p)(e,t)),!0})),Object(s.O)(_(i),r.hasHeadersRow,r.hasTotalsRow,a);case"NamedFailure":return r;default:return Object(h.d)("calc.calc.namedObjectToNamedObjectData: kind",r)}}function j(e){if(void 0!==e)return Object(l.j)(e.format)?Object(s.E)({kind:e.format.kind},e.valueType,e.decimals):Object(s.E)(e.format,e.valueType,e.decimals)}function x(e){if(null!=e)switch(e.kind){case"Origin":return l.f.Origin;case"Iformat":return Object(h.g)("calc.calc.evalFormulaFormatToUnion: iformat","number"==typeof e.iformat),e.iformat;case"Inferred":return l.f.Inferred;default:return Object(h.d)("calc.calc.evalFormulaFormatToUnion: kind",e.kind)}}},function(e,t,r){"use strict";var n;r.d(t,"a",(function(){return n})),function(e){e.setActiveCell="setActiveCell",e.doNothing="doNothing",e.setA1ReferenceStyle="setA1ReferenceStyle",e.setLocale="setLocale",e.setWorkbookProps="setWorkbookProps",e.updateSheetNames="updateSheetNames",e.updateNamedObjects="updateNamedObjects",e.setFunctionsInfo="setFunctionsInfo",e.conflictResolverEarlyTermination="conflictResolverEarlyTermination",e.setDefinedNamesInfo="setDefinedNamesInfo"}(n||(n={}))},function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a})),r.d(t,"c",(function(){return o})),r.d(t,"d",(function(){return s})),r.d(t,"e",(function(){return u})),r.d(t,"f",(function(){return c})),r.d(t,"g",(function(){return l})),r.d(t,"h",(function(){return d})),r.d(t,"i",(function(){return f})),r.d(t,"j",(function(){return p})),r.d(t,"k",(function(){return m})),r.d(t,"l",(function(){return h})),r.d(t,"m",(function(){return v})),r.d(t,"n",(function(){return g})),r.d(t,"o",(function(){return b})),r.d(t,"p",(function(){return S})),r.d(t,"q",(function(){return y})),r.d(t,"r",(function(){return O}));var n=r(3),i=n.resolveServiceTypes.InvalidCellRefReason,a=n.resolveServiceTypes.InvalidQualifierReason,o=n.resolveServiceTypes.InvalidStructRefReason,s=n.resolveServiceTypes.ResolveReasonKind,u=n.resolveServiceTypes.ResolvedKind,c=n.resolveServiceTypes.emptyIntersection,l=n.resolveServiceTypes.invalidCellRef,d=n.resolveServiceTypes.invalidQualifier,f=n.resolveServiceTypes.invalidStructRef,p=n.resolveServiceTypes.noOriginSheet,m=n.resolveServiceTypes.resolveLocalsGrid,h=n.resolveServiceTypes.resolvedCellRef,v=n.resolveServiceTypes.resolvedDottedName,g=n.resolveServiceTypes.resolvedLocalName,b=n.resolveServiceTypes.resolvedName,S=n.resolveServiceTypes.resolvedNever,y=n.resolveServiceTypes.resolvedStructRef,O=n.resolveServiceTypes.resolvedUserDefinedFunc},function(e,t,r){"use strict";r.d(t,"d",(function(){return c})),r.d(t,"c",(function(){return l})),r.d(t,"b",(function(){return d})),r.d(t,"e",(function(){return f})),r.d(t,"a",(function(){return p}));var n=r(2),i=r(49),a=r(29),o=r(64),s=r(122),u=r(37),c=new o.a,l=Object(a.b)((function(){return Object(n.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(n.__generator)(this,(function(t){switch(t.label){case 0:return e=i.c.instance(),m.getValue()?[4,s.a.getValue()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[4,e.recalcServiceAttached()];case 3:return t.sent(),[2,e]}}))}))})),d=Object(a.b)((function(){return Object(n.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(n.__generator)(this,(function(t){switch(t.label){case 0:return[4,c];case 1:return e=t.sent(),[2,Object(i.d)(e)]}}))}))})),f=Object(a.b)((function(){return Object(n.__awaiter)(void 0,void 0,void 0,(function(){return Object(n.__generator)(this,(function(e){switch(e.label){case 0:return[4,d.getValue()];case 1:return[2,e.sent().createPluginThread("worker")]}}))}))})),p=Object(a.b)((function(){return Object(n.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(n.__generator)(this,(function(t){switch(t.label){case 0:return Object(u.b)("Microsoft.Office.Excel.AutoCompleteOnMainThread")?[4,d.getValue()]:[3,2];case 1:return e=t.sent(),[3,4];case 2:return[4,f.getValue()];case 3:e=t.sent(),t.label=4;case 4:return[2,e]}}))}))})),m=new a.a((function(){return!Object(u.b)("Microsoft.Office.Excel.FormulaAssistanceRedesign")&&Object(u.b)("Microsoft.Office.ExcelOnline.ArgumentAssistancePlugin")}))},function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a})),r.d(t,"c",(function(){return o})),r.d(t,"d",(function(){return s})),r.d(t,"e",(function(){return u}));var n=r(7),i=n.util.arrayFill,a=n.util.isInteger,o=(n.util.mathLog2,n.util.messageFromError),s=(n.util.partialArray,n.util.prependErrorMessage,n.util.repeat,n.util.stringEndsWith),u=n.util.stringStartsWith;n.util.values},function(e,t,r){"use strict";var n,i,a,o,s;r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return i})),function(e){e[e.Function=3]="Function",e[e.NamedRange=100]="NamedRange",e[e.TableHeader=101]="TableHeader",e[e.LetVariable=102]="LetVariable",e[e.RichEntity=103]="RichEntity",e[e.Lambda=104]="Lambda",e[e.CustomFunction=105]="CustomFunction",e[e.Table=106]="Table",e[e.TableSpecialStructRef=107]="TableSpecialStructRef"}(n||(n={})),function(e){e[e.Simple=0]="Simple",e[e.Smart=1]="Smart"}(i||(i={})),function(e){e[e.Error=1]="Error",e[e.Warning=2]="Warning",e[e.Information=3]="Information",e[e.Hint=4]="Hint"}(a||(a={})),function(e){e[e.Unnecessary=1]="Unnecessary",e[e.Deprecated=2]="Deprecated"}(o||(o={})),function(e){e[e.Empty=0]="Empty",e[e.QuickFix=1]="QuickFix",e[e.Refactor=2]="Refactor",e[e.RefactorExtract=3]="RefactorExtract",e[e.RefactorInline=4]="RefactorInline",e[e.RefactorRewrite=5]="RefactorRewrite",e[e.Source=6]="Source",e[e.SourceOrganizeImports=7]="SourceOrganizeImports",e[e.SourceFixAll=8]="SourceFixAll"}(s||(s={}))},function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"c",(function(){return a})),r.d(t,"b",(function(){return o})),r.d(t,"d",(function(){return s}));var n=r(7),i=(r(41),n.featureConfiguration.FeatureName),a=(n.featureConfiguration.initFeatureConfiguration,n.featureConfiguration.isFeatureEnabled),o=(n.featureConfiguration.getFeatures,n.featureConfiguration.getTypedFeatureGate),s=n.featureConfiguration.isTypedChangeGateEnabled},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSheetGridRange=t.isSheetGridCellEqual=t.isSheetGridCell=t.isRichOper=t.isReadOperEqual=t.isRangeOper=t.isRangeOpNoMissing=t.isRangeOpClosed=t.isPrimitiveOper=t.isOperatorNode=t.isNumberOper=t.isNumberNode=t.isNameScopeEqual=t.isMissingOper=t.isMissingNode=t.isGridRangeEqual=t.isGridCellEqual=t.isGridCell=t.isErrorOper=t.isDocumentLocEqual=t.isCommaOpRefWellFormed=t.isCommaOpNoBadOrMissing=t.isCommaOpClosed=t.isBooleanOper=t.isBooleanNode=t.isBlankOper=t.isArrayOper=t.internal=t.gridRangesJoin=t.gridRangeSize=t.gridRangeJoinOpt=t.gridRangeJoin=t.gridRangeIsects=t.gridRangeIsect=t.gridRangeExcept=t.gridRangeCompare=t.gridRangeAnchor=t.gridCellRange=t.gridCellImplicitIsect=t.getWorksheetFuncId=t.getUserDefinedFuncName=t.getSubExpressionFromPosition=t.getBoundName=t.getArguments=t.getArgType=t.forEachTileInRange=t.forEachCellInRange=t.createFailureErrorClass=t.ReasonKind=t.LangReasonKind=void 0,t.applyComparison=t.unavailable=t.shouldFieldRefBeBracketed=t.sheetGridRangeAnchor=t.notImplemented=t.normalizeCommaOpRef=t.isWriteOper=t.isWellFormed=t.isWSFNode=t.isValidArgsLength=t.isUnqualifiedNameNode=t.isStringOper=t.isSheetIndexEqual=t.isSheetIndex=t.isSheetGridRangeEqual=void 0;var n=r(3);t.LangReasonKind=n.util.LangReasonKind,t.ReasonKind=n.util.ReasonKind,t.createFailureErrorClass=n.util.createFailureErrorClass,t.forEachCellInRange=n.util.forEachCellInRange,t.forEachTileInRange=n.util.forEachTileInRange,t.getArgType=n.util.getArgType,t.getArguments=n.util.getArguments,t.getBoundName=n.util.getBoundName,t.getSubExpressionFromPosition=n.util.getSubExpressionFromPosition,t.getUserDefinedFuncName=n.util.getUserDefinedFuncName,t.getWorksheetFuncId=n.util.getWorksheetFuncId,t.gridCellImplicitIsect=n.util.gridCellImplicitIsect,t.gridCellRange=n.util.gridCellRange,t.gridRangeAnchor=n.util.gridRangeAnchor,t.gridRangeCompare=n.util.gridRangeCompare,t.gridRangeExcept=n.util.gridRangeExcept,t.gridRangeIsect=n.util.gridRangeIsect,t.gridRangeIsects=n.util.gridRangeIsects,t.gridRangeJoin=n.util.gridRangeJoin,t.gridRangeJoinOpt=n.util.gridRangeJoinOpt,t.gridRangeSize=n.util.gridRangeSize,t.gridRangesJoin=n.util.gridRangesJoin,t.internal=n.util.internal,t.isArrayOper=n.util.isArrayOper,t.isBlankOper=n.util.isBlankOper,t.isBooleanNode=n.util.isBooleanNode,t.isBooleanOper=n.util.isBooleanOper,t.isCommaOpClosed=n.util.isCommaOpClosed,t.isCommaOpNoBadOrMissing=n.util.isCommaOpNoBadOrMissing,t.isCommaOpRefWellFormed=n.util.isCommaOpRefWellFormed,t.isDocumentLocEqual=n.util.isDocumentLocEqual,t.isErrorOper=n.util.isErrorOper,t.isGridCell=n.util.isGridCell,t.isGridCellEqual=n.util.isGridCellEqual,t.isGridRangeEqual=n.util.isGridRangeEqual,t.isMissingNode=n.util.isMissingNode,t.isMissingOper=n.util.isMissingOper,t.isNameScopeEqual=n.util.isNameScopeEqual,t.isNumberNode=n.util.isNumberNode,t.isNumberOper=n.util.isNumberOper,t.isOperatorNode=n.util.isOperatorNode,t.isPrimitiveOper=n.util.isPrimitiveOper,t.isRangeOpClosed=n.util.isRangeOpClosed,t.isRangeOpNoMissing=n.util.isRangeOpNoMissing,t.isRangeOper=n.util.isRangeOper,t.isReadOperEqual=n.util.isReadOperEqual,t.isRichOper=n.util.isRichOper,t.isSheetGridCell=n.util.isSheetGridCell,t.isSheetGridCellEqual=n.util.isSheetGridCellEqual,t.isSheetGridRange=n.util.isSheetGridRange,t.isSheetGridRangeEqual=n.util.isSheetGridRangeEqual,t.isSheetIndex=n.util.isSheetIndex,t.isSheetIndexEqual=n.util.isSheetIndexEqual,t.isStringOper=n.util.isStringOper,t.isUnqualifiedNameNode=n.util.isUnqualifiedNameNode,t.isValidArgsLength=n.util.isValidArgsLength,t.isWSFNode=n.util.isWSFNode,t.isWellFormed=n.util.isWellFormed,t.isWriteOper=n.util.isWriteOper,t.normalizeCommaOpRef=n.util.normalizeCommaOpRef,t.notImplemented=n.util.notImplemented,t.sheetGridRangeAnchor=n.util.sheetGridRangeAnchor,t.shouldFieldRefBeBracketed=n.util.shouldFieldRefBeBracketed,t.unavailable=n.util.unavailable,t.applyComparison=n.util.applyComparison},function(e,t,r){"use strict";r.d(t,"c",(function(){return y})),r.d(t,"k",(function(){return O})),r.d(t,"b",(function(){return b})),r.d(t,"d",(function(){return C})),r.d(t,"f",(function(){return P})),r.d(t,"l",(function(){return R})),r.d(t,"e",(function(){return k})),r.d(t,"g",(function(){return T})),r.d(t,"n",(function(){return E})),r.d(t,"m",(function(){return F})),r.d(t,"j",(function(){return D})),r.d(t,"h",(function(){return x})),r.d(t,"o",(function(){return L})),r.d(t,"i",(function(){return B})),r.d(t,"a",(function(){return V}));var n=r(2),i=r(19),a=r(6),o=r(8),s=r(30),u=r(14),c=r(61),l=r(4),d=r(16),f=r(13),p=r(24),m=r(10),h=r(0),v=r(35);function g(e){return Array.isArray(e)}var b,S,y=0,O=function(e){return 0===e};!function(e){e.ClientValueUnknown="ClientValueUnknown"}(b||(b={})),function(e){e[e.ClientValueUnknown=0]="ClientValueUnknown"}(S||(S={}));var C={fmla:"",lexicalKind:o.a.Cell,origin:Object(o.f)(0,0),compiledFmla:void 0,hasHyperlink:!1};Object(l.q)();var P={fmla:"",lexicalKind:o.a.Range,origin:Object(o.f)(0,0),compiledFmla:void 0,hasHyperlink:!1};Object(l.q)();var N,R=function(e,t){return""===e&&!t},k=C;!function(e){e.ClientValueUnknown="ClientValueUnknown"}(N||(N={}));var T={kind:N.ClientValueUnknown};function E(e){return e.kind===N.ClientValueUnknown}var _={oper:s.d,failure:void 0};function F(e,t){return Object(a.v)(e)&&void 0===t}function I(e,t,r){return e.setValue(t,r,(function(e){return e.fmla!==r.fmla||e.lexicalKind!==r.lexicalKind||void 0!==e.compiledFmla&&!Object(a.A)(e.origin,r.origin)||null==e.compiledFmla!=(null==r.compiledFmla)}))}function A(e,t){return e.forEachMeets(t,(function(t,r){if(r.fmla.length>0){var n=r.lexicalKind===o.a.Cell?C:P;e=e.setValue(t,n)}return!0})),e}function M(e,t){return e.forEachMeets(t,(function(t,r){return(r.fmla===S.ClientValueUnknown||r.fmla.length>0)&&(e=e.setValue(t,k)),!0})),e}function w(e,t,r,n){var i=Object(f.g)(t,u.b),a=Object(f.i)(Object(f.g)(r,i),"row","col");return Object(u.g)(Object(f.d)(t,a),(function(t){return e=e.setValue(t,n),!0})),e}Object(l.q)();var D={hidden:[],available:[]},j={values:Object(c.a)(),formats:Object(c.a)(),styles:Object(c.a)(),formulae:Object(c.a)(),dirty:d.d},x={serverFormulaeNodeCount:0,serverFormatsNodeCount:0,serverStylesNodeCount:0,serverValuesNodeCount:0,serverDirtySetSubspaceCount:0,editedFormulaeNodeCount:0,editedFormatsNodeCount:0,editedStylesNodeCount:0,editedValuesNodeCount:0,editedDirtySetSubspaceCount:0,clientFormulaeNodeCount:0,clientFormatsNodeCount:0,clientValuesNodeCount:0,recalcValuesNodeCount:0,recalcDirtySetSubspaceCount:0,recalcFailuresSetSubspaceCount:0,recalcTaintSetSubspaceCount:0,availabilitySetSubspaceCount:0,availabilityHistorySize:0,hiddenRowsNodeCount:0,hiddenColsNodeCount:0};function L(e,t){return{serverFormulaeNodeCount:e.serverFormulaeNodeCount+t.serverFormulaeNodeCount,serverFormatsNodeCount:e.serverFormatsNodeCount+t.serverFormatsNodeCount,serverStylesNodeCount:e.serverStylesNodeCount+t.serverStylesNodeCount,serverValuesNodeCount:e.serverValuesNodeCount+t.serverValuesNodeCount,serverDirtySetSubspaceCount:e.serverDirtySetSubspaceCount+t.serverDirtySetSubspaceCount,editedFormulaeNodeCount:e.editedFormulaeNodeCount+t.editedFormulaeNodeCount,editedFormatsNodeCount:e.editedFormatsNodeCount+t.editedFormatsNodeCount,editedStylesNodeCount:e.editedStylesNodeCount+t.editedStylesNodeCount,editedValuesNodeCount:e.editedValuesNodeCount+t.editedValuesNodeCount,editedDirtySetSubspaceCount:e.editedDirtySetSubspaceCount+t.editedDirtySetSubspaceCount,clientFormulaeNodeCount:e.clientFormulaeNodeCount+t.clientFormulaeNodeCount,clientFormatsNodeCount:e.clientFormatsNodeCount+t.clientFormatsNodeCount,clientValuesNodeCount:e.clientValuesNodeCount+t.clientValuesNodeCount,recalcValuesNodeCount:e.recalcValuesNodeCount+t.recalcValuesNodeCount,recalcDirtySetSubspaceCount:e.recalcDirtySetSubspaceCount+t.recalcDirtySetSubspaceCount,recalcFailuresSetSubspaceCount:e.recalcFailuresSetSubspaceCount+t.recalcFailuresSetSubspaceCount,recalcTaintSetSubspaceCount:e.recalcTaintSetSubspaceCount+t.recalcTaintSetSubspaceCount,availabilitySetSubspaceCount:e.availabilitySetSubspaceCount+t.availabilitySetSubspaceCount,availabilityHistorySize:e.availabilityHistorySize+t.availabilityHistorySize,hiddenRowsNodeCount:e.hiddenRowsNodeCount+t.hiddenRowsNodeCount,hiddenColsNodeCount:e.hiddenColsNodeCount+t.hiddenColsNodeCount}}var B=void 0,U=Object(o.g)(0,0,o.x,o.q);function G(e,t){return e===B?t:t===B?e:Object(a.p)(e,t)}function K(e,t){return e===B||t===B?B:Object(a.n)(e,t)}var V=function(){function e(e,t,r,n,i,a,o,s,u,l){void 0===e&&(e=j),void 0===t&&(t=d.d),void 0===r&&(r=U),void 0===n&&(n=d.d),void 0===i&&(i=d.d),void 0===a&&(a=d.d),void 0===o&&(o=d.d),void 0===s&&(s=Object(c.a)()),void 0===u&&(u=!1),void 0===l&&(l=!1),this.oldAvailabilities={},this.availabilityHistorySize=0,this.serverContents=e,this.serverAvailability=t,this.serverUsed=r,this.hiddenRows=n,this.hiddenRowsAvailability=i,this.hiddenCols=a,this.hiddenColsAvailability=o,this.mergeCells=s,this.inFilterMode=u,this.filterModeAvailable=l,this.rollBackToServerState()}return e.create=function(){return new e},e.prototype.clone=function(t){void 0===t&&(t=p.a.Server);var r=new e(this.serverContents,this.serverAvailability,this.serverUsed,this.hiddenRows,this.hiddenRowsAvailability,this.hiddenCols,this.hiddenColsAvailability,this.mergeCells,this.inFilterMode,this.filterModeAvailable);return t===p.a.Client&&(r.editedContents=this.editedContents,r.clientContents=this.clientContents,r.recalcValues=this.recalcValues,r.recalcDirty=this.recalcDirty,r.recalcFailures=this.recalcFailures,r.editedTaint=this.editedTaint,r.recalcTaint=this.recalcTaint,r.editedAvailability=this.editedAvailability),r},e.prototype.advanceState=function(e){this.oldAvailabilities[e]=this.serverAvailability,this.availabilityHistorySize+=1,this.serverAvailability=d.d,this.serverUsed=U,this.hiddenRows=this.hiddenRowsAvailability=d.d,this.hiddenCols=this.hiddenColsAvailability=d.d,this.inFilterMode=this.filterModeAvailable=!1,this.rollBackToServerState()},e.prototype.rollBackToServerState=function(){this.editedContents=this.serverContents,this.editedAvailability=this.serverAvailability,this.editedUsed=this.serverUsed,this.editedTaint=d.d,this.rollBackToEditedState()},e.prototype.rollBackToEditedState=function(){this.clientContents=this.editedContents,this.recalcValues=this.editedContents.values,this.recalcFailures=d.d,this.recalcDirty=this.editedContents.dirty,this.recalcTaint=this.editedTaint},e.prototype.allServerAvailable=function(e){return this.allAvailable(e,this.serverAvailability)},e.prototype.allEditedAvailable=function(e){return this.allAvailable(e,this.editedAvailability)},e.prototype.allAvailable=function(e,t){var r=Object(u.f)(e),n=Object(f.g)(r,u.b),i=Object(f.g)(t,n),a=Object(f.i)(Object(f.d)(n,i),"row","col"),o=Object(f.a)(i,n);return!!(void 0!==o&&o>=0)||a},e.prototype.forEachRecalcDirty=function(e,t){return Object(u.g)(Object(f.g)(this.recalcDirty,Object(u.f)(e)),t)},e.prototype.hasRecalcDirty=function(e){return Object(f.h)(this.recalcDirty,Object(u.f)(e))},e.prototype.hasRecalcFailure=function(e){return Object(f.h)(this.recalcFailures,Object(u.f)(e))},e.prototype.hasEditedEditTaint=function(e){return Object(f.h)(this.editedTaint,Object(u.f)(e))},e.prototype.hasRecalcEditTaint=function(e){return Object(f.h)(this.recalcTaint,Object(u.f)(e))},e.prototype.getEditedUsedRange=function(){return this.editedUsed},e.prototype.getServerUsedRange=function(){return this.serverUsed},e.prototype.getServerAvailability=function(){return this.serverAvailability},e.prototype.getHiddenRows=function(e,t){var r=u.d.row(Object(l.m)(e,t)),n=Object(d.i)(this.hiddenRowsAvailability,r),a=[];Object(u.j)(n,(function(e){var t=e[0],r=e[1];return a.push(Object(i.q)(t,r)),!0}));var o=[];return Object(u.j)(Object(d.i)(this.hiddenRows,n),(function(e){var t=e[0],r=e[1];return o.push(Object(i.q)(t,r)),!0})),{hidden:o,available:a}},e.prototype.tryGetHiddenRows=function(e,t){var r=this.getHiddenRows(e,t);return 1===r.available.length&&r.available[0].start===e&&r.available[0].end===t?Object(h.e)(r.hidden):Object(h.b)({kind:p.e.HiddenRows})},e.prototype.setHiddenRows=function(e,t){var r=u.d.row(Object(l.m)(e.row,e.row+e.rows));this.hiddenRows=Object(d.j)(Object(d.e)(this.hiddenRows,r),Object(d.i)(t,r)),this.hiddenRowsAvailability=Object(d.j)(this.hiddenRowsAvailability,r)},e.prototype.getHiddenCols=function(e,t){var r=u.d.col(Object(l.m)(e,t)),n=Object(d.i)(this.hiddenColsAvailability,r),a=[];Object(u.h)(n,(function(e){var t=e[0],r=e[1];return a.push(Object(i.q)(t,r)),!0}));var o=[];return Object(u.h)(Object(d.i)(this.hiddenCols,n),(function(e){var t=e[0],r=e[1];return o.push(Object(i.q)(t,r)),!0})),{hidden:o,available:a}},e.prototype.tryGetHiddenCols=function(e,t){var r=this.getHiddenCols(e,t);return 1===r.available.length&&r.available[0].start===e&&r.available[0].end===t?Object(h.e)(r.hidden):Object(h.b)({kind:p.e.HiddenCols})},e.prototype.setHiddenCols=function(e,t){var r=u.d.col(Object(l.m)(e.col,e.col+e.cols));this.hiddenCols=Object(d.j)(Object(d.e)(this.hiddenCols,r),Object(d.i)(t,r)),this.hiddenColsAvailability=Object(d.j)(this.hiddenColsAvailability,r)},e.prototype.setMergeCell=function(e){this.mergeCells=this.mergeCells.setValue(e,!0)},e.prototype.getMergeCell=function(e){var t;return this.mergeCells.forEachGe(e,(function(e){return t=e,!0})),t},e.prototype.isInFilterMode=function(){return this.filterModeAvailable?Object(h.e)(this.inFilterMode):Object(h.b)({kind:p.e.InFilterMode})},e.prototype.setInFilterMode=function(e){this.inFilterMode=e,this.filterModeAvailable=!0},e.prototype.forEachNonBlankSetCellInSet=function(e,t,r,n){var i=Object(f.g)(e,u.c);return Object(u.i)(Object(f.g)(r,i),(function(e){return n.formulae.forEachMeets(e,(function(r,n){return!!R(n.fmla,void 0!==n.compiledFmla)||Object(a.d)(Object(a.n)(e,r),t)}))}))},e.prototype.forEachReadableCellInSet=function(e,t,r){var n=Object(f.g)(e,u.b);return Object(u.i)(Object(f.g)(r,n),(function(e){return Object(a.d)(e,t)}))},e.prototype.forEachEditedNonBlankCellInSet=function(e,t){return this.forEachNonBlankSetCellInSet(e,t,this.editedAvailability,this.editedContents)},e.prototype.forEachServerNonBlankCellInSet=function(e,t){return this.forEachNonBlankSetCellInSet(e,t,this.serverAvailability,this.serverContents)},e.prototype.forEachEditedCellInSet=function(e,t){return this.forEachReadableCellInSet(e,t,this.editedAvailability)},e.prototype.promoteServerAvailability=function(e,t){var r=Object(f.g)(e,u.c),n=this.oldAvailabilities[t];if(void 0===n)return!1;var i=Object(f.a)(n,r);return void 0!==i&&i>=0&&(this.unionAvailability(!0,Object(f.g)(e,u.a)),this.unionTaint(!0,d.d),this.unionUsed(!0,Object(u.e)(e)),!0)},e.prototype.extendServerUnused=function(e){var t=e===B?d.d:Object(u.f)(e),r=Object(f.b)(t),n=this.serverContents,i=n.values,a=n.formats,o=n.styles,s=n.formulae,c=n.dirty;Object(u.i)(r,(function(e){return i.forEachLe(e,(function(e,t){return F(t.oper,t.failure)||(i=i.setValue(e,_)),!0})),a.forEachLe(e,(function(e,t){return O(t)||(a=a.setValue(e,y)),!0})),o.forEachLe(e,(function(e,t){return t!==m.g.Blank&&(o=o.setValue(e,m.g.Blank)),!0})),!0})),Object(u.i)(r,(function(e){return s=A(s,e),!0})),c=Object(f.d)(c,r),this.setContents(!0,{values:i,formats:a,styles:o,formulae:s,dirty:c});var l=Object(f.g)(r,u.b);this.serverAvailability=this.editedAvailability=Object(f.j)(this.serverAvailability,l),this.editedTaint=this.recalcTaint=d.d;var p=this.serverUsed;p=K(p,e),this.serverUsed=this.editedUsed=p},e.prototype.setRecalcFailure=function(e){this.recalcFailures=Object(f.j)(this.recalcFailures,e)},e.prototype.setRecalcEditTaint=function(e){this.recalcTaint=Object(f.j)(this.recalcTaint,e)},e.prototype.setRecalcValue=function(e,t){var r=this;Object(a.d)(e,(function(e,n,i){return r.recalcValues=r.recalcValues.setValue(e,{oper:g(t)?t[n][i]:t,failure:void 0}),!0})),this.recalcDirty=Object(f.d)(this.recalcDirty,Object(u.f)(e))},e.prototype.setClientValue=function(e,t){var r=this.clientContents.values;Object(a.d)(e,(function(e,n,i){return r=r.setValue(e,{oper:g(t)?t[n][i]:t,failure:void 0}),!0})),this.clientContents=Object(n.__assign)(Object(n.__assign)({},this.clientContents),{values:r})},e.prototype.setClientFormula=function(e,t,r){var i=this.clientContents.formulae;i=M(i,e),void 0!==t?i=i.setValue(t,r):Object(a.d)(e,(function(e){return i=i.setValue(e,r),!0})),this.clientContents=Object(n.__assign)(Object(n.__assign)({},this.clientContents),{formulae:i})},e.prototype.setClientFormat=function(e,t){var r=this.clientContents.formats;Object(a.d)(e,(function(e){return r=r.setValue(e,t),!0})),this.clientContents=Object(n.__assign)(Object(n.__assign)({},this.clientContents),{formats:r})},e.prototype.getRecalcValues=function(e){for(var t=e.row,r=e.col,n=e.rows,i=e.cols,a=new Array(n),o=0;o<n;o+=1)a[o]=Object(v.a)(new Array(i),_);return this.recalcValues.forEachLe(e,(function(e,n){return a[e.row-t][e.col-r]=n,!0})),a},e.prototype.getClientValue=function(e){var t=this.clientContents.values.getValue(e);return null!=t?t:_},e.prototype.getServerValue=function(e){var t=this.serverContents.values.getValue(e);return null!=t?t:_},e.prototype.getEditedValue=function(e){var t=this.editedContents.values.getValue(e);return null!=t?t:_},e.prototype.forEachEditedValue=function(e,t){return this.editedContents.values.forEachMeets(e,t)},e.prototype.getServerFormula=function(e){return this.getFormula(e,this.serverContents.formulae)},e.prototype.getClientFormula=function(e){return this.getFormula(e,this.clientContents.formulae)},e.prototype.setEditedFormat=function(e,t){this.editedContents=Object(n.__assign)(Object(n.__assign)({},this.editedContents),{formats:this.editedContents.formats.setValue(e,t)})},e.prototype.getEditedFormat=function(e){var t=this.editedContents.formats.getValue(e);return null!=t?t:y},e.prototype.forEachEditedFormat=function(e,t){return this.editedContents.formats.forEachMeets(e,t)},e.prototype.getServerFormat=function(e){var t=this.serverContents.formats.getValue(e);return null!=t?t:y},e.prototype.getEditedStyle=function(e){var t=this.editedContents.styles.getValue(e);return null!=t?t:m.g.Blank},e.prototype.getServerStyle=function(e){var t=this.serverContents.styles.getValue(e);return null!=t?t:m.g.Blank},e.prototype.getClientFormat=function(e){var t=this.clientContents.formats.getValue(e);return null!=t?t:y},e.prototype.getEditedFormula=function(e){return this.getFormula(e,this.editedContents.formulae)},e.prototype.forEachEditedFormula=function(e,t){return this.editedContents.formulae.forEachMeets(e,t)},e.prototype.getFormula=function(e,t){var r=void 0;return t.forEachGe(e,(function(e,t){return!!R(t.fmla,void 0!==t.compiledFmla)||(r=[e,t],!1)})),r},e.prototype.setContents=function(e,t){e&&(this.serverContents=t),this.editedContents=t,e&&(this.clientContents=this.editedContents),this.recalcValues=this.editedContents.values,this.recalcDirty=this.editedContents.dirty,this.recalcFailures=d.d},e.prototype.unionAvailability=function(e,t){var r=e?this.serverAvailability:this.editedAvailability;r=Object(f.j)(r,t),e&&(this.serverAvailability=r),this.editedAvailability=r},e.prototype.unionTaint=function(e,t){this.editedTaint=e?d.d:Object(f.j)(this.editedTaint,t),this.recalcTaint=this.editedTaint},e.prototype.unionUsed=function(e,t){var r=e?this.serverUsed:this.editedUsed;r=G(r,t),e&&(this.serverUsed=r),this.editedUsed=r},e.prototype.setCellContents=function(e,t,r,n,i,a,o,s){this.setCommon(e,t,void 0,r,n,i,a,o,s)},e.prototype.setRangeFormula=function(e,t,r,n,i,a,o){var s=Object(u.f)(t);this.setCommon(e,s,t,r,n,void 0,i,a,o)},e.prototype.setCommon=function(e,t,r,i,a,o,s,c,l){var p=this,h=e?this.serverContents:this.editedContents,v=h.values,g=h.formats,b=h.styles,S=h.formulae,C=h.dirty,P=void 0===i&&void 0!==a||void 0!==(null==i?void 0:i.compiledFmla),N=i;void 0!==i&&(Object(u.i)(t,(function(e){return S=A(S,e),!0})),R(i.fmla,void 0!==i.compiledFmla)&&(N=void 0));var k=void 0!==N&&void 0===r?i:void 0,E=void 0!==N&&void 0!==r?i:void 0,M=a;void 0!==a&&F(a,o)&&(Object(u.i)(t,(function(e){return v.forEachLe(e,(function(e,t){return F(t.oper,t.failure)||(v=v.setValue(e,_)),!0})),!0})),C=P?Object(f.j)(C,t):Object(f.d)(C,t),M=void 0);var D=void 0!==M?{oper:M,failure:o}:void 0,j=s;void 0!==s&&O(s)&&(Object(u.i)(t,(function(e){return g.forEachLe(e,(function(e,t){return O(t)||(g=g.setValue(e,y)),!0})),!0})),j=void 0);var x=j===m.f.Weak?void 0:j,L=j===m.f.Weak?j:void 0,B=c;void 0!==c&&c===m.g.Blank&&(Object(u.i)(t,(function(e){return b.forEachLe(e,(function(e,t){return t!==m.g.Blank&&(b=b.setValue(e,m.g.Blank)),!0})),!0})),B=void 0);var U=B===m.g.Weak?void 0:B,G=B===m.g.Weak?B:void 0,K=t;if(!e){var V=Object(f.g)(t,u.c),W=Object(f.i)(Object(f.g)(this.editedAvailability,V),"row","col"),H=Object(f.g)(t,void 0!==l?Object(u.f)(l):d.d);K=Object(f.j)(W,H)}if(void 0===k&&void 0===x&&void 0===U&&void 0===D||(Object(u.g)(K,(function(e){return void 0!==k&&(S=I(S,e,k)),void 0!==x&&(g=g.setValue(e,x)),void 0!==U&&(b=b.setValue(e,U)),void 0!==D&&(v=v.setValue(e,D)),!0})),void 0===k&&void 0===D||(C=P?Object(f.j)(C,K):Object(f.d)(C,K))),void 0!==E){S=I(S,r,E);var q=Object(u.f)(r);C=P?Object(f.j)(C,q):Object(f.d)(C,q)}void 0!==L&&(g=w(g,K,e?this.serverAvailability:this.editedAvailability,m.f.Unavailable)),void 0!==G&&(b=function(e,t,r){var n=Object(f.g)(t,u.b),i=Object(f.i)(Object(f.g)(r,n),"row","col");return Object(u.g)(Object(f.d)(t,i),(function(t){return e=e.setValue(t,m.g.Unavailable),!0})),e}(b,K,e?this.serverAvailability:this.editedAvailability));var z=void 0===a?d.d:K,Q=void 0===i?d.d:K,J=void 0===s?d.d:K,Y=void 0===a&&void 0===s?d.d:K;e||(Object(u.i)(z,(function(e){return p.setClientValue(e,T),!0})),void 0!==i&&(void 0!==r?this.setClientFormula(r,r,i):Object(u.i)(Q,(function(e){return p.setClientFormula(e,void 0,i),!0}))),s===m.f.Weak?this.clientContents=Object(n.__assign)(Object(n.__assign)({},this.clientContents),{formats:w(this.clientContents.formats,J,this.editedAvailability,m.f.ClientValueUnknown)}):Object(u.i)(J,(function(e){return p.setClientFormat(e,m.f.ClientValueUnknown),!0}))),this.setContents(e,{values:v,formats:g,styles:b,formulae:S,dirty:C}),this.unionAvailability(e,Object(f.g)(z,u.a)),e||(this.editedAvailability=Object(f.d)(this.editedAvailability,Object(f.d)(t,K))),this.unionTaint(e,Y),this.unionUsed(e,Object(u.e)(t))},e.prototype.copyRange=function(e){function t(t,r){return t.forEachLe(e,(function(e,t){return r=r.setValue(e,t),!0})),r}var r=j.values,n=j.formats,i=j.styles,o=j.formulae,s=this.editedContents,c=s.values,l=s.formats,d=s.styles,p=s.formulae;r=t(c,r),n=t(l,n),i=t(d,i),p.forEachMeets(e,(function(t,r){return o=o.setValue(Object(a.n)(t,e),r),!0}));var m=Object(a.k)(e),h=Object(f.g)(this.editedAvailability,Object(u.f)(e)),v=K(this.editedUsed,e);return{origin:m,formats:n,styles:i,values:r,formulae:o,availability:h,used:v}},e.prototype.pasteRange=function(e,t){var r=Object(u.f)(e),i=Object(o.g)(t.origin.row,t.origin.col,e.rows,e.cols),a=this.editedContents,s=a.values,c=a.formats,l=a.styles,p=a.formulae,h=a.dirty,v=this.editedUsed,g=e.row-t.origin.row,O=e.col-t.origin.col;function P(e){return Object(o.g)(e.row+g,e.col+O,e.rows,e.cols)}function N(t,r,n){return r.forEachMeets(e,(function(e,t){return r=r.setValue(e,n),!0})),t.forEachLe(i,(function(e,t){return r=r.setValue(P(e),t),!0})),r}var R=G(v,t.used!==B?P(t.used):B),k=K(R,e);s=N(t.values,s,_),k!==B&&this.setClientValue(k,T),c=N(t.formats,c,y),l=N(t.styles,l,m.g.Blank),k!==B&&this.setClientFormat(k,m.f.ClientValueUnknown),p=N(t.formulae,p,C),h=Object(f.d)(h,r);var E=this.clientContents.formulae;E=M(E,e),p.forEachLe(e,(function(e,t){var r=t.origin,n=t.compiledFmla;return void 0!==n&&(h=Object(f.j)(h,Object(u.f)(e))),E=E.setValue(e,{fmla:S.ClientValueUnknown,origin:r,compiledFmla:n,hasHyperlink:b.ClientValueUnknown}),!0})),this.clientContents=Object(n.__assign)(Object(n.__assign)({},this.clientContents),{formulae:E});var F;this.setContents(!1,{values:s,formats:c,styles:l,formulae:p,dirty:h}),this.editedAvailability=Object(f.d)(this.editedAvailability,r),this.unionAvailability(!1,(F=t.availability,Object(u.k)(F,g,O))),this.unionTaint(!1,k===B?d.d:Object(u.f)(k)),this.unionUsed(!1,R)},e.prototype.getDirtyEditedCells=function(){return Object(f.g)(this.recalcDirty,this.editedTaint)},e.prototype.getNonDirtyEditedCells=function(){return Object(f.d)(this.editedTaint,this.recalcDirty)},e.prototype.getDirtyDependentCells=function(){return Object(f.d)(this.recalcDirty,this.editedTaint)},e.prototype.onCellModified=function(e){var t=e?this.serverContents:this.editedContents;this.setContents(e,t),this.unionAvailability(e,d.d),this.unionTaint(e,d.d),this.unionUsed(e,B)},e.prototype.clearCompiledFormulas=function(){for(var e=0,t=[this.serverContents.formulae,this.editedContents.formulae];e<t.length;e++){t[e].forEach((function(e,t){return void 0!==t.compiledFmla&&t.compiledFmla.reset(),!0}))}},e.prototype.getStatistics=function(){return{serverFormulaeNodeCount:this.serverContents.formulae.getCount(),serverFormatsNodeCount:this.serverContents.formats.getCount(),serverStylesNodeCount:this.serverContents.styles.getCount(),serverValuesNodeCount:this.serverContents.values.getCount(),serverDirtySetSubspaceCount:Object(f.f)(this.serverContents.dirty),editedFormulaeNodeCount:this.editedContents.formulae.getCount(),editedFormatsNodeCount:this.editedContents.formats.getCount(),editedStylesNodeCount:this.editedContents.styles.getCount(),editedValuesNodeCount:this.editedContents.values.getCount(),editedDirtySetSubspaceCount:Object(f.f)(this.editedContents.dirty),clientFormulaeNodeCount:this.clientContents.formulae.getCount(),clientFormatsNodeCount:this.clientContents.formats.getCount(),clientValuesNodeCount:this.clientContents.values.getCount(),recalcValuesNodeCount:this.recalcValues.getCount(),recalcDirtySetSubspaceCount:Object(f.f)(this.recalcDirty),recalcFailuresSetSubspaceCount:Object(f.f)(this.recalcFailures),recalcTaintSetSubspaceCount:Object(f.f)(this.recalcTaint),availabilityHistorySize:this.availabilityHistorySize,availabilitySetSubspaceCount:Object(f.f)(this.editedAvailability),hiddenRowsNodeCount:Object(d.h)(this.hiddenRows)+Object(d.h)(this.hiddenRowsAvailability),hiddenColsNodeCount:Object(d.h)(this.hiddenCols)+Object(d.h)(this.hiddenColsAvailability)}},e.prototype.collectGarbage=function(e){var t=d.d;for(var r in this.oldAvailabilities)if(this.oldAvailabilities.hasOwnProperty(r)){var n=Number(r);if(n>=e){t=Object(f.j)(t,this.oldAvailabilities[n]);continue}delete this.oldAvailabilities[n],this.availabilityHistorySize-=1}function i(e){return Object(f.h)(Object(f.g)(Object(u.f)(e),u.c),t)}function a(e,t){return!R(t.fmla,void 0!==t.compiledFmla)&&i(e)}function o(e,t){return!O(t)&&i(e)}function s(e,t){return t!==m.g.Blank&&i(e)}function c(e,t){return!(!E(t.oper)&&F(t.oper,t.failure))&&i(e)}var l=Object(f.i)(t,"row","col");this.serverContents={formulae:this.serverContents.formulae.filter(a),formats:this.serverContents.formats.filter(o),styles:this.serverContents.styles.filter(s),values:this.serverContents.values.filter(c),dirty:Object(f.g)(this.serverContents.dirty,l)},this.editedContents={formulae:this.editedContents.formulae.filter(a),formats:this.editedContents.formats.filter(o),styles:this.editedContents.styles.filter(s),values:this.editedContents.values.filter(c),dirty:Object(f.g)(this.editedContents.dirty,l)},this.clientContents={formulae:this.clientContents.formulae.filter(a),formats:this.clientContents.formats.filter(o),values:this.clientContents.values.filter(c)},this.recalcValues=this.recalcValues.filter(c),this.recalcDirty=Object(f.g)(this.recalcDirty,l)},e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.valueErrorOper=t.trueOper=t.stringOper=t.refErrorOper=t.rangeSeqOper=t.range3DOper=t.precedents=t.numErrorOper=t.nullErrorOper=t.nameErrorOper=t.naErrorOper=t.missingOper=t.gettingDataErrorOper=t.fieldErrorOper=t.falseOper=t.errorOper=t.div0ErrorOper=t.cellStringLimit=t.booleanOper=t.blankOper=t.arrayOper=t.PrecsBound=t.ErrorType=void 0;var n=r(3);t.ErrorType=n.value.ErrorType,t.PrecsBound=n.value.PrecsBound,t.arrayOper=n.value.arrayOper,t.blankOper=n.value.blankOper,t.booleanOper=n.value.booleanOper,t.cellStringLimit=n.value.cellStringLimit,t.div0ErrorOper=n.value.div0ErrorOper,t.errorOper=n.value.errorOper,t.falseOper=n.value.falseOper,t.fieldErrorOper=n.value.fieldErrorOper,t.gettingDataErrorOper=n.value.gettingDataErrorOper,t.missingOper=n.value.missingOper,t.naErrorOper=n.value.naErrorOper,t.nameErrorOper=n.value.nameErrorOper,t.nullErrorOper=n.value.nullErrorOper,t.numErrorOper=n.value.numErrorOper,t.precedents=n.value.precedents,t.range3DOper=n.value.range3DOper,t.rangeSeqOper=n.value.rangeSeqOper,t.refErrorOper=n.value.refErrorOper,t.stringOper=n.value.stringOper,t.trueOper=n.value.trueOper,t.valueErrorOper=n.value.valueErrorOper},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2);n.__exportStar(r(170),t),n.__exportStar(r(303),t),n.__exportStar(r(171),t),n.__exportStar(r(304),t),n.__exportStar(r(305),t),n.__exportStar(r(306),t)},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(7),i=n.pledge.Pledge},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.assertPositiveLength=t.assertPositiveInteger=t.assertInteger=t.assertIndex=t.assertNatural=t.assertNever=t.assertFalse=t.assertTrue=t.ulsLogger=void 0;var n=r(7);t.ulsLogger=n.assertions.ulsLogger,t.assertTrue=n.assertions.assertTrue,t.assertFalse=n.assertions.assertFalse,t.assertNever=n.assertions.assertNever,t.assertNatural=n.assertions.assertNatural,t.assertIndex=n.assertions.assertIndex,t.assertInteger=n.assertions.assertInteger,t.assertPositiveInteger=n.assertions.assertPositiveInteger,t.assertPositiveLength=n.assertions.assertPositiveLength},function(e,t,r){"use strict";r.r(t);var n=r(2);function i(e){return a(e)&&"WorkerError"===e.name&&"object"==typeof e.info}function a(e){if(null==e)return!1;if(e instanceof Error)return!0;var t=e;return"string"==typeof t.name&&"string"==typeof t.message&&(null==t.stack||"string"==typeof t.stack)}function o(e){return a(e)?e:new Error("(non-Error object) ".concat(function(e){var t=typeof e;switch(t){case"function":case"symbol":case"undefined":return"<".concat(t,">");case"object":return JSON.stringify(e);default:return"".concat(e)}}(e)))}function s(e){return{name:e.name,message:i(e)?e.baseMessage:e.message,stack:e.stack,info:i(e)?(t=e.info,Object(n.__assign)(Object(n.__assign)({},t),{error:t.error?s(t.error):void 0})):void 0};var t}function u(e){return a(e)?{isError:!0,value:s(e)}:{isError:!1,value:e}}var c=function(e){function t(t,r){var i,a=this.constructor,o=this;(o=e.call(this,"".concat(t,"; info = ").concat(JSON.stringify(Object(n.__assign)(Object(n.__assign)({},r),{error:null===(i=r.error)||void 0===i?void 0:i.message}))))||this).baseMessage=t,o.info=r,o.name="WorkerError";var s=a.prototype;return Object.getPrototypeOf(o)!==s&&(null!=Object.setPrototypeOf?Object.setPrototypeOf(o,s):o.__proto__=s),o}return Object(n.__extends)(t,e),t.isWorkerError=i,t}(Error);var l={Error:Error,EvalError:EvalError,RangeError:RangeError,ReferenceError:ReferenceError,SyntaxError:SyntaxError,TypeError:TypeError,URIError:URIError};function d(e){var t;if("WorkerError"===e.name)t=new c(e.message,function(e){return Object(n.__assign)(Object(n.__assign)({},e),{error:e.error?d(e.error):void 0})}(e.info));else{var r=l[e.name];r?t=new r(e.message):(t=new Error(e.message)).name=e.name}return null!=e.stack&&(t.stack=e.stack),t}function f(e){return e.isError?d(e.value):e.value}var p;function m(){return"undefined"!=typeof Blob&&"undefined"!=typeof URL&&void 0!==URL.createObjectURL&&void 0!==URL.revokeObjectURL&&"undefined"!=typeof Worker}function h(e){if(p)throw new TypeError("setConfig has already been called");p=e}function v(){var e=null!=p?p:{};return{createTimeout:e.createTimeout,createMode:e.createMode,importScriptUrls:e.importScriptUrls?Object(n.__spreadArray)([],e.importScriptUrls,!0):void 0,typedWorkersUrl:e.typedWorkersUrl,typedWorkersName:e.typedWorkersName,importScriptsMaxRetries:e.importScriptsMaxRetries}}function g(e){setTimeout((function(){throw e}))}function b(){return"undefined"!=typeof self&&"__typed_workers_thread"in self?self:void 0}function S(e){var t=b();if(void 0!==t){var r={kind:1,error:u(e)};t.postMessage(r)}else console.warn(e)}function y(e){var t;try{(null!==(t=null==p?void 0:p.onWorkerError)&&void 0!==t?t:S)(e)}catch(t){console.warn(e),g(t)}}function O(e){var t=b();if(void 0!==t){var r={kind:2,stats:e};t.postMessage(r)}}function C(e){var t;try{(null!==(t=null==p?void 0:p.onCreateWorker)&&void 0!==t?t:O)(e)}catch(e){g(e)}}var P=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return P.transfer.apply(P,Object(n.__spreadArray)([e,void 0],t,!1))};P.transfer=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return{def:e,args:r,transferables:null!=t?t:[]}};var N=r(41),R=Object(N.makeTypedIsChangeGateEnabled)(["OfficeVSO:WINum_CGExample","OfficeVSO:5592319_TypedWorkersProxyPromiseFix"]);Object(N.makeGetTypedFeatureGate)({"Microsoft.Office.Shared.FGExample":!0});function k(e,t){return e.then((function(e){return t(),e}),(function(e){return t(),Promise.reject(e)}))}var T;function E(e,t,r){if(e>1<<30)return r;var n=setTimeout(t,Math.max(0,e));return{resolve:function(e){clearTimeout(n),r.resolve(e)},reject:function(e){clearTimeout(n),r.reject(e)}}}function _(){var e=Object.create(null);return e.key=void 0,delete e.key,e}function F(){return null!=T?T:T=function(){try{return"function"==typeof Proxy&&!0===new Proxy({},{get:function(){return!0}}).k}catch(e){return!1}}()}function I(e,t){var r=_(),n=R("OfficeVSO:5592319_TypedWorkersProxyPromiseFix")?function(t,r){var n;return"then"===r?void 0:null!==(n=t[r])&&void 0!==n?n:t[r]=e(r)}:function(t,r){var n;return null!==(n=t[r])&&void 0!==n?n:t[r]=e(r)};return t?(t.forEach((function(e){return n(r,e)})),r):new Proxy(r,{get:n})}function A(e){throw e}var M=-1,w=function(){function e(e,t){var r,n,i=this;this.idInfo=e,this.port=t,this.isClosed=!1,this.exports={},this.unresolvedCalls=_();var a=function(){var e;return null===(e=i.onClose)||void 0===e?void 0:e.call(i)},o=((r={})[0]=this.onInvoke.bind(this),r[1]=this.onResult.bind(this),r[2]=function(e){var t,r=e.funcNames;null===(t=i.onImports)||void 0===t||t.call(i,I(i.createPostProxy.bind(i),r),I(i.createCallProxy.bind(i),r))},r[3]=a,r),s=((n={})[0]=this.onSendInvokeFailed.bind(this),n[1]=this.onSendResultFailed.bind(this),n[2]=a,n[3]=a,n);this.port.onmessage=function(e){var t=e.data;return o[t.kind](t)},this.port.onmessageerror=function(e){var t=e.data;return s[t.kind](t)}}return e.prototype.setExports=function(e){this.exports=e;var t={kind:2,funcNames:F()?void 0:function(e){for(var t=_();null!=e;){for(var r=0,n=Object.getOwnPropertyNames(e);r<n.length;r++){var i=n[r];try{"function"==typeof e[i]&&(t[i]=!0)}catch(e){}}e=Object.getPrototypeOf(e)}return Object.getOwnPropertyNames(t)}(e)};this.port.postMessage(t)},e.prototype.close=function(){if(!this.isClosed){this.isClosed=!0;for(var e in this.port.postMessage({kind:3}),this.port.close(),this.unresolvedCalls){var t=this.unresolvedCalls[e],r=t.reject,n=t.funcName,i={cause:"Connection",idInfo:this.idInfo,funcName:n};r(new c("Importing Endpoint closed while waiting for ".concat(n," result"),i))}}},e.prototype.onInvoke=function(e){var t=this,r=e.callId,n=e.funcName,i=e.args,a=Promise.resolve().then((function(){var e=t.exports[n];if(e)return e.apply(t.exports,i);var a=r>=0?"call":"post",o={cause:"Connection",idInfo:t.idInfo,callId:r,funcName:n};throw new c("Exporting Endpoint received a ".concat(a," to unknown function ").concat(n),o)}));r>=0?a.then((function(e){return t.sendResult(r,n,!0,e)}),(function(e){return t.sendResult(r,n,!1,e)})):a.catch((function(e){var i=o(e),a={cause:"UnhandledError",idInfo:t.idInfo,error:i,callId:r,funcName:n};y(new c("Exporting Endpoint's ".concat(n," implementation threw or rejected"),a))}))},e.prototype.sendResult=function(e,t,r,n){var i={kind:1,callId:e,funcName:t,isFulfilled:r,resultValue:u(n)};try{this.port.postMessage(i,void 0)}catch(e){this.onSendResultFailed(i,o(e))}},e.prototype.onSendResultFailed=function(e,t){var r=e.callId,n=e.funcName,i=e.resultValue,a=t?"Exporting Endpoint failed to send ".concat(n," result"):"Importing Endpoint failed to deserialize ".concat(n," result"),o={cause:"MessageError",idInfo:this.idInfo,error:t,callId:r,funcName:n},s=new c(a,o);i.isError?y(s):this.sendResult(r,n,!1,s)},e.prototype.takeCallbacks=function(e){var t=this.unresolvedCalls[e];return t&&delete this.unresolvedCalls[e],t},e.prototype.setCallTimeout=function(e,t,r,n){var i=this;if(r>1<<30)return n;return E(r,(function(){var n=i.takeCallbacks(e);if(n){var a={cause:"Timeout",idInfo:i.idInfo,timeout:r,callId:e,funcName:t};n.reject(new c("Importing Endpoint's call to ".concat(t," timed out"),a))}}),n)},e.prototype.sendCall=function(e,t,r,i){var a=this;return new Promise((function(s,u){var l=M+=1,d={kind:0,callId:l,funcName:e,args:t};a.unresolvedCalls[l]=Object(n.__assign)(Object(n.__assign)({},a.setCallTimeout(l,e,r,{resolve:s,reject:u})),{funcName:e});try{a.port.postMessage(d,i)}catch(t){var f=a.takeCallbacks(l);if(f){var p=o(t),m={cause:"MessageError",idInfo:a.idInfo,error:p,callId:l,funcName:e};f.reject(new c("Importing Endpoint failed to send call to ".concat(e),m))}}}))},e.prototype.sendPost=function(e,t,r,n){var i={kind:0,callId:-1,funcName:e,args:t};try{this.port.postMessage(i,n)}catch(t){var a=o(t),s={cause:"MessageError",idInfo:this.idInfo,error:a,callId:-1,funcName:e};r(new c("Importing Endpoint failed to post to ".concat(e),s))}},e.prototype.onSendInvokeFailed=function(e){var t,r=e.callId,n=e.funcName,i=r>=0?"call":"post",a={cause:"MessageError",idInfo:this.idInfo,callId:r,funcName:n},o=new c("Exporting Endpoint failed to deserialize ".concat(i," to ").concat(n),a),s=r>=0?this.takeCallbacks(r):void 0;(null!==(t=null==s?void 0:s.reject)&&void 0!==t?t:y)(o)},e.prototype.onResult=function(e){var t=e.callId,r=e.funcName,n=e.isFulfilled,i=e.resultValue;if(t>=0){var a=this.takeCallbacks(t);if(a)(n?a.resolve:a.reject)(f(i))}else{var o={cause:"InternalError",idInfo:this.idInfo,callId:t,funcName:r};y(new c("Exporting Endpoint sent a result for a post to ".concat(r),o))}},e.prototype.createPostProxy=function(e){var t=this,r=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.transfer.apply(r,Object(n.__spreadArray)([void 0],e,!1))};return r.transfer=function(n){for(var i,a,o,s=[],u=1;u<arguments.length;u++)s[u-1]=arguments[u];if(!t.isClosed){var c=null!==(o=null!==(i=r.onPostMessageError)&&void 0!==i?i:null===(a=t.getOnPostMessageError)||void 0===a?void 0:a.call(t))&&void 0!==o?o:A;t.sendPost(e,s,c,n)}},r},e.prototype.createCallProxy=function(e){var t=this,r=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.transfer.apply(r,Object(n.__spreadArray)([void 0],e,!1))};return r.transfer=function(n){for(var i,a,o,s=[],u=1;u<arguments.length;u++)s[u-1]=arguments[u];if(t.isClosed){var l={cause:"Connection",idInfo:t.idInfo,funcName:e};return Promise.reject(new c("".concat(t.idInfo.side," Endpoint's call.").concat(e," called after close"),l))}var d=null!==(o=null!==(i=r.callTimeout)&&void 0!==i?i:null===(a=t.getCallTimeout)||void 0===a?void 0:a.call(t))&&void 0!==o?o:1/0;return t.sendCall(e,s,d,n)},r.callTimeout=void 0,r},e}();var D=function(){function e(e,t,r){this.callTimeout=1/0,this.onPostMessageError=A,this._idInfo=e,this._state=t,this.createMode=r;var n=function(t){return function(){var r="Outside"===e.side?"inside":"outside",n={cause:"Connection",idInfo:e};throw new c("".concat(e.side," Endpoint's ").concat(t," referenced before the ").concat(r," Endpoint started"),n)}};Object.defineProperties(this,{post:{configurable:!0,enumerable:!1,get:n("post")},call:{configurable:!0,enumerable:!1,get:n("call")}})}return e._create=function(t,r,n){var i,a,o=r.port,s=r.options,u=r.createMode,l={type:"Endpoint",side:t,id:null==s?void 0:s.id};try{i=new w(l,o),a=new e(l,i,u)}catch(e){return Promise.reject(e)}return new Promise((function(e,r){var o;i.getCallTimeout=function(){return a.callTimeout},i.getOnPostMessageError=function(){return a.onPostMessageError},i.onImports=function(e,t){Object.defineProperties(a,{post:{configurable:!0,enumerable:!1,writable:!1,value:e},call:{configurable:!0,enumerable:!1,writable:!1,value:t}}),f.resolve()},i.onClose=function(){return a.close("Force")};var u,d=function(e){var t,r;return null!==(r=null!==(t=null==e?void 0:e.createTimeout)&&void 0!==t?t:null==p?void 0:p.createTimeout)&&void 0!==r?r:3e5}(s),f=E(d,(function(){var e="Outside"===t?"inside":"outside",r={cause:"Timeout",idInfo:l,timeout:d},n=new c("".concat(t," Endpoint timed out waiting for the ").concat(e," to start"),r);f.reject(n)}),{resolve:e,reject:r});a._closedDuringCreate=function(){f.resolve()};try{u=n(a)}catch(e){return f.reject(e)}null===(o=a._state)||void 0===o||o.setExports(u)})).then((function(){return a._closedDuringCreate=void 0,a}),(function(e){return a._closedDuringCreate=void 0,a.close(),Promise.reject(e)}))},e.prototype.hasBeenClosed=function(){return void 0===this._state},e.prototype.close=function(e){var t,r;if(this._state){if(this._closedDuringCreate){if("Force"!==e){var n={cause:"Connection",idInfo:this._idInfo};throw new c("".concat(this._idInfo.side," Endpoint's close called during creation"),n)}this._closedDuringCreate()}var i=this._state;this._state=void 0;try{i.close(),null===(t=this._onClose)||void 0===t||t.call(this),null===(r=this.onClose)||void 0===r||r.call(this)}catch(e){n={cause:"Connection",idInfo:this._idInfo,error:o(e)};y(new c("".concat(this._idInfo.side," Endpoint's close threw an error"),n))}}},e.createOutside=function(t,r){return void 0===r&&(r=function(){}),e._create("Outside",t,r)},e.createInside=function(t,r){return e._create("Inside",t,r)},e}(),j='!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=12)}([function(e,t,r){"use strict";r.r(t),r.d(t,"__extends",(function(){return o})),r.d(t,"__assign",(function(){return i})),r.d(t,"__rest",(function(){return a})),r.d(t,"__decorate",(function(){return u})),r.d(t,"__param",(function(){return c})),r.d(t,"__metadata",(function(){return f})),r.d(t,"__awaiter",(function(){return l})),r.d(t,"__generator",(function(){return s})),r.d(t,"__createBinding",(function(){return d})),r.d(t,"__exportStar",(function(){return p})),r.d(t,"__values",(function(){return y})),r.d(t,"__read",(function(){return v})),r.d(t,"__spread",(function(){return _})),r.d(t,"__spreadArrays",(function(){return g})),r.d(t,"__spreadArray",(function(){return b})),r.d(t,"__await",(function(){return h})),r.d(t,"__asyncGenerator",(function(){return m})),r.d(t,"__asyncDelegator",(function(){return w})),r.d(t,"__asyncValues",(function(){return O})),r.d(t,"__makeTemplateObject",(function(){return j})),r.d(t,"__importStar",(function(){return S})),r.d(t,"__importDefault",(function(){return P})),r.d(t,"__classPrivateFieldGet",(function(){return T})),r.d(t,"__classPrivateFieldSet",(function(){return x})),r.d(t,"__classPrivateFieldIn",(function(){return E}));var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var i=function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function a(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}function u(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a}function c(e,t){return function(r,n){t(r,n,e)}}function f(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function l(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function u(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,u)}c((n=n.apply(e,t||[])).next())}))}function s(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}}var d=Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};function p(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||d(t,e,r)}function y(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function v(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function _(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(v(arguments[t]));return e}function g(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,u=i.length;a<u;a++,o++)n[o]=i[a];return n}function b(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))}function h(e){return this instanceof h?(this.v=e,this):new h(e)}function m(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(e,t||[]),i=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(e){o[e]&&(n[e]=function(t){return new Promise((function(r,n){i.push([e,t,r,n])>1||u(e,t)}))})}function u(e,t){try{(r=o[e](t)).value instanceof h?Promise.resolve(r.value.v).then(c,f):l(i[0][2],r)}catch(e){l(i[0][3],e)}var r}function c(e){u("next",e)}function f(e){u("throw",e)}function l(e,t){e(t),i.shift(),i.length&&u(i[0][0],i[0][1])}}function w(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,o){t[n]=e[n]?function(t){return(r=!r)?{value:h(e[n](t)),done:"return"===n}:o?o(t):t}:o}}function O(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=y(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,o){(function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)})(n,o,(t=e[r](t)).done,t.value)}))}}}function j(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var G=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function S(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&d(t,e,r);return G(t,e),t}function P(e){return e&&e.__esModule?e:{default:e}}function T(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function x(e,t,r,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(e,r):o?o.value=r:t.set(e,r),r}function E(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use \'in\' operator on non-object");return"function"==typeof e?t===e:e.has(t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFeatureGateDictionaryGetter=t.getIntFeatureGate=t.getNumberFeatureGate=t.getBooleanFeatureGate=t.getStringFeatureGate=t.getFeatureGateDictionary=void 0;var n=r(4),o={};function i(){return"undefined"==typeof __get_feature_gate_dictionary_variable?o:__get_feature_gate_dictionary_variable()}function a(e,t){var r;return null!==(r=i()[e])&&void 0!==r?r:t}t.getFeatureGateDictionary=i,t.getStringFeatureGate=a,t.getBooleanFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim().toLowerCase();return"true"===n||"false"!==n&&t},t.getNumberFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim().toLowerCase();if(void 0===n)return t;if("infinity"===n||"+infinity"===n)return 1/0;if("-infinity"===n)return-1/0;var o=parseFloat(n);return isNaN(o)?t:o},t.getIntFeatureGate=function(e,t){var r,n=null===(r=a(e))||void 0===r?void 0:r.trim();if(void 0===n)return t;var o=parseInt(n,10);return isNaN(o)?t:o},t.setFeatureGateDictionaryGetter=function(e){var t=n.globalThis.__get_feature_gate_dictionary_variable;return n.globalThis.__get_feature_gate_dictionary_variable=e,t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setChangeGateDictionaryGetter=t.isChangeGateEnabled=t.getChangeGateDictionary=void 0;var n=r(4);function o(){return"undefined"==typeof __get_change_gate_dictionary_variable?null:__get_change_gate_dictionary_variable()}t.getChangeGateDictionary=o,t.isChangeGateEnabled=function(e){var t,r=o();return null!==r&&(null===(t=r[e])||void 0===t||t)},t.setChangeGateDictionaryGetter=function(e){var t=n.globalThis.__get_change_gate_dictionary_variable;return n.globalThis.__get_change_gate_dictionary_variable=e,t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0);n.__exportStar(r(1),t),n.__exportStar(r(8),t),n.__exportStar(r(2),t),n.__exportStar(r(9),t),n.__exportStar(r(10),t),n.__exportStar(r(11),t)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.globalThis=void 0;var n=r(5);t.globalThis=n},function(e,t,r){"use strict";e.exports=r(6)()?globalThis:r(7)},function(e,t,r){"use strict";e.exports=function(){return"object"==typeof globalThis&&(!!globalThis&&globalThis.Array===Array)}},function(e,t){var r=function(){if("object"==typeof self&&self)return self;if("object"==typeof window&&window)return window;throw new Error("Unable to resolve global `this`")};e.exports=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(e){return r()}try{return __global__||r()}finally{delete Object.prototype.__global__}}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetTypedFeatureGate=void 0;var n=r(1);t.makeGetTypedFeatureGate=function(e){return function(t){var r=e[t];switch(typeof r){case"boolean":return(0,n.getBooleanFeatureGate)(t,r);case"number":return(0,n.getNumberFeatureGate)(t,r);case"string":return(0,n.getStringFeatureGate)(t,r);default:throw new Error("Wrong defaultValue type")}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeTypedIsChangeGateEnabled=void 0;var n=r(2);t.makeTypedIsChangeGateEnabled=function(e){return function(e){return(0,n.isChangeGateEnabled)(e)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedChangeGates=t.overrideChangeGates=void 0;var n=r(0),o=r(2);function i(e){var t=(0,o.setChangeGateDictionaryGetter)(void 0);return void 0===t?(0,o.setChangeGateDictionaryGetter)(void 0):(0,o.setChangeGateDictionaryGetter)((function(){var r=t();return null===r?null:n.__assign(n.__assign({},r),e)})),t}t.overrideChangeGates=i,t.overrideTypedChangeGates=function(e,t){return i(t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedFeatureGates=t.overrideFeatureGates=void 0;var n=r(0),o=r(1);function i(e){for(var t,r,i={},a=0,u=Object.keys(e);a<u.length;a++){var c=u[a];i[c]=null===(t=e[c])||void 0===t?void 0:t.toString()}var f=null!==(r=(0,o.setFeatureGateDictionaryGetter)(void 0))&&void 0!==r?r:function(){return{}};return(0,o.setFeatureGateDictionaryGetter)((function(){return n.__assign(n.__assign({},f()),i)})),f}t.overrideFeatureGates=i,t.overrideTypedFeatureGates=function(e,t){return i(t)}},function(e,t,r){"use strict";r.r(t);var n=r(0);function o(e){return i(e)&&"WorkerError"===e.name&&"object"==typeof e.info}function i(e){if(null==e)return!1;if(e instanceof Error)return!0;var t=e;return"string"==typeof t.name&&"string"==typeof t.message&&(null==t.stack||"string"==typeof t.stack)}function a(e){return i(e)?e:new Error("(non-Error object) ".concat(function(e){var t=typeof e;switch(t){case"function":case"symbol":case"undefined":return"<".concat(t,">");case"object":return JSON.stringify(e);default:return"".concat(e)}}(e)))}function u(e){return{name:e.name,message:o(e)?e.baseMessage:e.message,stack:e.stack,info:o(e)?(t=e.info,Object(n.__assign)(Object(n.__assign)({},t),{error:t.error?u(t.error):void 0})):void 0};var t}function c(e){throw new ReferenceError("".concat(e," is not defined"))}function f(e,t,r){void 0===r&&(r=c);try{for(var n=t.split("."),o=0,i=n;o<i.length;o++){e=e[i[o]]}return null!=e?e:r(t)}catch(e){return r(t)}}var l=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return l.transfer.apply(l,Object(n.__spreadArray)([e,void 0],t,!1))};l.transfer=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return{def:e,args:r,transferables:null!=t?t:[]}};var s="undefined"!=typeof performance&&void 0!==performance.timeOrigin?function(){return performance.now()+performance.timeOrigin}:function(){return Date.now()};function d(e,t,r){"Pending"===e.status&&(e.status=t,e.end=Math.max(e.start,null!=r?r:s()))}function p(e,t,r){var n=e.indexOf("?");if(n<0)return"".concat(e,"?").concat(t,"=").concat(r);for(var o=e.slice(0,n+1),i=e.slice(n+1).split("&"),a=0;a<i.length&&("="!==i[a][t.length]||i[a].slice(0,t.length)!==t);a+=1);return i[a]="".concat(t,"=").concat(r),o+i.join("&")}function y(e,t){for(var r,n=0;n<=t;n+=1)try{return void importScripts(n>0?p(e,"retries",String(n)):e)}catch(e){r=e}throw r}function v(e,t){if(0!==t)for(var r=0,n=e;r<n.length;r++){y(n[r],t)}else importScripts.apply(void 0,e)}var _=r(3);self.onmessage=function(e){var t,r,c=e.data,l=c.config,p=c.port,y=c.options,g=c.script,b=c.args,h=c.featureGateDictionary,m=c.changeGateDictionary;self.onmessage=null,self.__typed_workers_thread=!0,Object(_.setFeatureGateDictionaryGetter)((function(){return h})),Object(_.setChangeGateDictionaryGetter)((function(){return m}));var w,O=null!==(r=null!==(t=y.importScriptsMaxRetries)&&void 0!==t?t:l.importScriptsMaxRetries)&&void 0!==r?r:0;function j(){var e;if(w)return w;if(void 0===l.typedWorkersUrl)throw new TypeError("importTypedWorkers: typedWorkersUrl is not defined");return v([l.typedWorkersUrl],O),(w=f(self,null!==(e=l.typedWorkersName)&&void 0!==e?e:"typedWorkers")).setConfig(l),w}var G={status:"Pending",start:s()};function S(e,t){var r,n={kind:0,error:e?void 0:i(r=a(t))?{isError:!0,value:u(r)}:{isError:!1,value:r},stopwatch:G};self.postMessage(n),e||setTimeout(self.close.bind(self),6e4)}try{(function(e,t){function r(t){throw d(e,o(t)&&"Timeout"===t.info.cause?"Timeout":"Error"),t}try{return t().then((function(t){var r;return null!==(r=d(e,"Success"))&&void 0!==r?r:t}),r)}catch(e){r(e)}})(G,(function(){var e,t;return v(Object(n.__spreadArray)(Object(n.__spreadArray)([],null!==(t=null!==(e=null==y?void 0:y.importScriptUrls)&&void 0!==e?e:l.importScriptUrls)&&void 0!==t?t:[],!0),void 0!==g.scriptUrl?[g.scriptUrl]:[],!0),O),f(self,g.insideInitName).apply(void 0,Object(n.__spreadArray)([{config:l,importTypedWorkers:j,connection:{port:p,options:y,createMode:"Thread"}}],b,!1))})).then((function(){return S(!0)}),(function(e){return S(!1,e)}))}catch(e){S(!1,e)}}}]);',x=-1;var L=function(){function e(e,t){var r,n;try{var i;r=function(e){var t="def"in e?e:P(e),r=t.def,n=t.args,i=t.transferables;if("function"!=typeof r)return[r,n,i,void 0];var a="__generatedInsideInit".concat(x+=1);return[{scriptUrl:void 0,insideInitName:a},n,i,"var ".concat(a," = ").concat(r.toString(),";")]}(t),this.script=r[0],this.args=r[1],this.transferables=r[2];var a=void 0===(i=r[3])?[j]:[i,"\n\n",j];this.blobUrl=URL.createObjectURL(new Blob(a,{type:"application/javascript"}));var o={};null!=e.id&&(o.name=e.id),this.worker=new Worker(this.blobUrl,o)}catch(e){throw null===(n=this.worker)||void 0===n||n.terminate(),this.revokeBlobUrl(),e}}return e.prototype.revokeBlobUrl=function(){void 0!==this.blobUrl&&(URL.revokeObjectURL(this.blobUrl),this.blobUrl=void 0)},e.prototype.createInside=function(e,t){var r=this,o=e.port,s=e.options,u={type:"Thread",side:"Outside",id:s.id},l=this.worker;return k(new Promise((function(e,d){r.createCallbacks={resolve:e,reject:d};var p={config:v(),port:o,options:s,script:r.script,args:r.args,featureGateDictionary:Object(N.getFeatureGateDictionary)(),changeGateDictionary:Object(N.getChangeGateDictionary)()};l.postMessage(p,Object(n.__spreadArray)([o],r.transferables,!0)),l.onerror=function(e){e.preventDefault();var t=function(e,t,r){if(a(r.error)){if(i(r.error))return r.error;var n={cause:"UnhandledError",idInfo:e,error:r.error};return new c("".concat(t," received an unhandled error"),n)}if(null==r.message){var o={cause:"UnhandledError",idInfo:e};return new c("".concat(t," received a non-error (worker script fetch probably failed)"),o)}var s={cause:"UnhandledError",idInfo:e},u="".concat(r.message," at ").concat(r.filename,":").concat(r.lineno,":").concat(r.colno);return new c("".concat(t," received an unhandled error: ").concat(u),s)}(u,"worker.onerror",e);r.createCallbacks?r.createCallbacks.reject(t):y(t)},l.onmessage=function(e){var n,i,a=e.data;switch(a.kind){case 0:return t.insideInit=a.stopwatch,void 0===a.error?null===(n=r.createCallbacks)||void 0===n?void 0:n.resolve():null===(i=r.createCallbacks)||void 0===i?void 0:i.reject(f(a.error));case 1:return y(f(a.error));case 2:return C(a.stats)}}})),(function(){r.createCallbacks=void 0}))},e.prototype.terminate=function(){var e;if(this.worker){var t=this.worker;this.worker=void 0,null===(e=this.createCallbacks)||void 0===e||e.resolve(),t.terminate(),this.revokeBlobUrl()}},e}(),B="undefined"!=typeof performance&&void 0!==performance.timeOrigin?function(){return performance.now()+performance.timeOrigin}:function(){return Date.now()};function U(){return{status:"Pending",start:B()}}function G(e,t,r){"Pending"===e.status&&(e.status=t,e.end=Math.max(e.start,null!=r?r:B()))}function K(e,t){function r(t){throw G(e,i(t)&&"Timeout"===t.info.cause?"Timeout":"Error"),t}try{return t().then((function(t){var r;return null!==(r=G(e,"Success"))&&void 0!==r?r:t}),r)}catch(e){r(e)}}function V(e){return Math.round(1e3*e)/1e3}function W(e,t,r){return e<t?t:e>r?r:e}function H(e,t,r){var n,i,a,o=W(null!==(n=null==e?void 0:e.start)&&void 0!==n?n:1/0,t,r),s=W(null!==(i=null==e?void 0:e.end)&&void 0!==i?i:1/0,t,r);return{status:null!==(a=null==e?void 0:e.status)&&void 0!==a?a:"Pending",start:V(o-t),end:V(s-t),duration:V(s-o)}}var q=function(){return r(44)};function z(e,t,r,n,i){var a,o=new MessageChannel,s=o.port1,u=o.port2;return Promise.all([n({port:s,options:e,createMode:t}),K(r.createOutside=U(),(function(){return D.createOutside({port:u,options:e,createMode:t},(function(e){return i(a=e)}))}))]).then((function(){return a}),(function(e){return a?a.close("Force"):u.close(),Promise.reject(e)}))}function Q(e,t,r,i){return z(e,"Local",t,(function(e){return function(e,t,r){var i="def"in r?r:P(r),a=i.def,o=i.args;if("function"!=typeof a){var s={cause:"InternalError",idInfo:{type:"Endpoint",side:"Inside",id:e.options.id}};return Promise.reject(new c("Loading an InsideScript to create a local worker is unimplemented",s))}return Promise.resolve().then((function(){return K(t.insideInit=U(),(function(){return a.apply(void 0,Object(n.__spreadArray)([{config:v(),importTypedWorkers:q,connection:e}],o,!1)).then((function(){}))}))}))}(e,t,r)}),i)}function J(e,t,r,n){var i;t.createThread=U();try{i=new L(e,r)}catch(e){return G(t.createThread,"Error"),Promise.reject(e)}return G(t.createThread,"Success"),z(e,"Thread",t,(function(e){return i.createInside(e,t)}),n).then((function(e){return e.hasBeenClosed()?i.terminate():e._onClose=i.terminate.bind(i),e}),(function(e){return i.terminate(),Promise.reject(e)}))}function Y(e,t,r){void 0===r&&(r=function(){});var n=function(e){var t,r,n=null!==(r=null!==(t=null==e?void 0:e.createMode)&&void 0!==t?t:null==p?void 0:p.createMode)&&void 0!==r?r:"Thread";return"ThreadOrLocal"===n?m()?"Thread":"Local":n}(e),i="local"in t?"Local"===n?t.local:t.thread:t,a="Local"===n?Q:J,o={id:e.id,createMode:n,createWorker:U()};return k(K(o.createWorker,(function(){return a(function(e){return{id:e.id,createTimeout:e.createTimeout,createMode:e.createMode,importScriptUrls:e.importScriptUrls,importScriptsMaxRetries:e.importScriptsMaxRetries}}(e),o,i,r)})),(function(){var e=function(e){var t=e.id,r=e.createMode,n=e.createWorker,i=e.insideInit,a=e.createOutside,o=e.createThread,s=n.status,u=n.start,c=n.end;if("Pending"!==s&&void 0!==c)return{id:t,createMode:r,createWorker:{status:s,absStart:u,duration:V(c-u)},createThread:"Thread"===r?H(o,u,c):void 0,createOutside:H(a,u,c),insideInit:H(i,u,c)}}(o);e&&C(e)}))}function $(e,t,r){var n=e.indexOf("?");if(n<0)return"".concat(e,"?").concat(t,"=").concat(r);for(var i=e.slice(0,n+1),a=e.slice(n+1).split("&"),o=0;o<a.length&&("="!==a[o][t.length]||a[o].slice(0,t.length)!==t);o+=1);return a[o]="".concat(t,"=").concat(r),i+a.join("&")}function Z(e,t){for(var r,n=0;n<=t;n+=1)try{return void importScripts(n>0?$(e,"retries",String(n)):e)}catch(e){r=e}throw r}function X(e,t){if(0!==t)for(var r=0,n=e;r<n.length;r++){Z(n[r],t)}else importScripts.apply(void 0,e)}function ee(){return"undefined"!=typeof WorkerGlobalScope}function te(){return self.name}r.d(t,"WorkerError",(function(){return c})),r.d(t,"isThreadingSupported",(function(){return m})),r.d(t,"setConfig",(function(){return h})),r.d(t,"dispatchWorkerError",(function(){return y})),r.d(t,"paramInsideDef",(function(){return P})),r.d(t,"Endpoint",(function(){return D})),r.d(t,"createWorker",(function(){return Y})),r.d(t,"importScriptsWithRetry",(function(){return X})),r.d(t,"isWorkerThread",(function(){return ee})),r.d(t,"workerName",(function(){return te}))},function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a})),r.d(t,"c",(function(){return o})),r.d(t,"d",(function(){return s})),r.d(t,"e",(function(){return u})),r.d(t,"f",(function(){return c})),r.d(t,"g",(function(){return l}));var n=r(3),i=n.datepack.Rounding,a=n.datepack.TimeDivision,o=n.datepack.TimeGranularity,s=n.datepack.dateTime,u=n.datepack.tzData,c=n.datepack.tzUTC,l=n.datepack.xlDatepack},function(e,t,r){"use strict";var n=r(2),i=r(24),a=r(6),o=r(4),s=r(39),u=r(14),c=r(10),l=r(0),d=r(13),f=r(167),p=r(161),m=function(){function e(e,t,r,n,i,a,o,s){void 0===i&&(i=new p.a(e,t)),void 0===s&&(s=new f.a(e,t)),this.document=e,this.stringCompareCI=t,this.formats=r,this.styles=n,this.sheets=i,this.grids=a,this.oldGrids=o,this.nameManager=s}return e.prototype.clone=function(t){var r;if(void 0===t&&(t=i.a.Server),this.grids)for(var n in r=Object(o.h)(),this.grids){var a=this.grids[n];r[n]=a.clone(t)}return new e(this.document,this.stringCompareCI,this.formats.clone(),this.styles.clone(),this.sheets.clone(),r,void 0,this.nameManager.clone())},e.prototype.setClientValue=function(e,t){var r=this.getGridById(e.sheet.index);return r.kind===l.a.Failure?r:Object(l.e)(r.value.setClientValue(e.range,t))},e.prototype.setClientFormula=function(e,t){var r=this.getGridById(e.sheet.index);return r.kind===l.a.Failure?r:Object(l.e)(r.value.setClientFormula(e.range,e.range,t))},e.prototype.setRecalcFailure=function(e,t){var r=this.getGridById(e);return r.kind===l.a.Failure?r:Object(l.e)(r.value.setRecalcFailure(t))},e.prototype.setRecalcEditTaint=function(e,t){var r=this.getGridById(e);return r.kind===l.a.Failure?r:Object(l.e)(r.value.setRecalcEditTaint(t))},e.prototype.setRecalcValue=function(e,t){var r=this.getGridById(e.sheet.index);return r.kind===l.a.Failure?r:Object(l.e)(r.value.setRecalcValue(e.range,t))},e.prototype.setEditedFormat=function(e,t){var r=this.getGridById(e.sheet.index);return r.kind===l.a.Failure?r:Object(l.e)(r.value.setEditedFormat(e.range,t))},e.prototype.setClientFormat=function(e,t){var r=this.getGridById(e.sheet.index);return r.kind===l.a.Failure?r:Object(l.e)(r.value.setClientFormat(e.range,t))},e.prototype.setHiddenRows=function(e,t,r){var n=this.getGridById(e);return n.kind===l.a.Failure?n:Object(l.e)(n.value.setHiddenRows(t,r))},e.prototype.setHiddenCols=function(e,t,r){var n=this.getGridById(e);return n.kind===l.a.Failure?n:Object(l.e)(n.value.setHiddenCols(t,r))},e.prototype.setMergeCell=function(e){var t=this.getGridById(e.sheet.index);return t.kind===l.a.Failure?t:Object(l.e)(t.value.setMergeCell(e.range))},e.prototype.setInFilterMode=function(e,t){var r=this.getGridById(e);return r.kind===l.a.Failure?r:Object(l.e)(r.value.setInFilterMode(t))},e.prototype.setCellContents=function(e,t,r,n,i,o,s,u){var c=this.getGridById(t.sheet.index);if(c.kind===l.a.Failure)return c;var d=void 0!==u&&Object(a.Q)(t.sheet,u.sheet)?u.range:void 0;return Object(l.e)(c.value.setCellContents(e,t.set,r,n,i,o,s,d))},e.prototype.setRangeFormula=function(e,t,r,n,i,o,s){var u=this.getGridById(t.sheet.index);if(u.kind===l.a.Failure)return u;var c=void 0!==s&&Object(a.Q)(t.sheet,s.sheet)?s.range:void 0;return Object(l.e)(u.value.setRangeFormula(e,t.range,r,n,i,o,c))},e.prototype.copyRange=function(e){var t=this.getGridById(e.sheet.index);return t.kind===l.a.Failure?t:Object(l.e)(t.value.copyRange(e.range))},e.prototype.pasteRange=function(e,t){var r=this.getGridById(e.sheet.index);return r.kind===l.a.Failure?r:Object(l.e)(r.value.pasteRange(e.range,t))},e.prototype.getDirtyEditedCells=function(){var e=[];return this.forEachSheet((function(t,r){e.push(Object(c.l)(t.sheetIndex,r.getDirtyEditedCells()))})),e},e.prototype.getNonDirtyEditedCells=function(){var e=[];return this.forEachSheet((function(t,r){e.push(Object(c.l)(t.sheetIndex,r.getNonDirtyEditedCells()))})),e},e.prototype.getDirtyDependentCells=function(){var e=[];return this.forEachSheet((function(t,r){e.push(Object(c.l)(t.sheetIndex,r.getDirtyDependentCells()))})),e},e.prototype.setNamedObject=function(e,t,r,n){return this.nameManager.setNamedObject(e,t,r,n)},e.prototype.setUndefinedNames=function(e){return this.nameManager.setUndefinedNames(e)},e.prototype.promoteNamedObjects=function(e,t){return this.nameManager.promoteNamedObjects(e,t)},e.prototype.setSheetNames=function(t){for(var r,n,i=null!==(r=this.grids)&&void 0!==r?r:this.oldGrids,a=Object(o.h)(),u=0,c=t;u<c.length;u++){var l=c[u].sheetId;a[l]=null!==(n=null==i?void 0:i[l])&&void 0!==n?n:s.a.create()}return new e(this.document,this.stringCompareCI,this.formats,this.styles,this.sheets.setSheetNames(t),a,void 0,this.nameManager.setSheetNames(t))},e.prototype.extendServerUnused=function(e,t){var r=this.getGridById(e);return r.kind===l.a.Failure?r:Object(l.e)(r.value.extendServerUnused(t))},e.prototype.promoteServerAvailability=function(e,t,r){var n=this.getGridById(e);return n.kind===l.a.Failure?n:Object(l.e)(n.value.promoteServerAvailability(t,r))},e.prototype.getNameLoc=function(e,t,r){return this.nameManager.getNameLoc(e,t,r)},e.prototype.getNameFormula=function(e,t){return this.nameManager.getNameFormula(e,t)},e.prototype.hasRecalcNameFailure=function(e){return this.nameManager.hasRecalcNameFailure(e)},e.prototype.setRecalcNameFailure=function(e){return this.nameManager.setRecalcNameFailure(e)},e.prototype.getContainingTable=function(e){var t=this.nameManager.getContainingTable(e);if(t.kind===l.a.Failure||void 0!==t.value)return t;var r=this.getGridById(e.sheet.index);if(r.kind===l.a.Failure)return Object(l.b)(Object(a.Z)([r.reason]));var n=Object(d.g)(Object(u.f)(e.range),u.c);return Object(d.h)(n,r.value.getServerAvailability())?l.f:Object(l.b)(Object(a.Z)([{kind:i.e.ContainingTable,range:e}]))},e.prototype.getNamedRanges=function(e){var t=this.nameManager.getNamedRanges(e);if(t.kind===l.a.Failure||void 0!==t.value)return t;var r=this.getGridById(e.sheet.index);if(r.kind===l.a.Failure)return Object(l.b)(Object(a.Z)([r.reason]));var n=Object(d.g)(Object(u.f)(e.range),u.c);return Object(d.h)(n,r.value.getServerAvailability())?Object(l.e)([]):Object(l.b)(Object(a.Z)([{kind:i.e.NamedRanges,range:e}]))},e.prototype.getIntersectingTables=function(e){return this.nameManager.getIntersectingTables(e)},e.prototype.getStructRefColumn=function(e,t){return this.nameManager.getStructRefColumn(e,t)},e.prototype.getStructRefSpecialRef=function(e,t){return this.nameManager.getStructRefSpecialRef(e,t)},e.prototype.getEditedFormula=function(e){var t=this.getGridById(e.sheet.index);return t.kind===l.a.Failure?t:Object(l.e)(t.value.getEditedFormula(e.range))},e.prototype.forEachEditedFormula=function(e,t){var r=this.getGridById(e.sheet.index);return r.kind===l.a.Failure?r:Object(l.e)(r.value.forEachEditedFormula(e.range,t))},e.prototype.getEditedValue=function(e){var t=this.getGridById(e.sheet.index);return t.kind===l.a.Failure?t:Object(l.e)(t.value.getEditedValue(e.range))},e.prototype.forEachEditedValue=function(e,t){var r=this.getGridById(e.sheet.index);return r.kind===l.a.Failure?r:Object(l.e)(r.value.forEachEditedValue(e.range,t))},e.prototype.getEditedFormat=function(e){var t=this.getGridById(e.sheet.index);return t.kind===l.a.Failure?t:Object(l.e)(t.value.getEditedFormat(e.range))},e.prototype.forEachEditedFormat=function(e,t){var r=this.getGridById(e.sheet.index);return r.kind===l.a.Failure?r:Object(l.e)(r.value.forEachEditedFormat(e.range,t))},e.prototype.getEditedStyle=function(e){var t=this.getGridById(e.sheet.index);return t.kind===l.a.Failure?t:Object(l.e)(t.value.getEditedStyle(e.range))},e.prototype.isInFilterMode=function(e){var t=this.getGridById(e);return t.kind===l.a.Failure?t:t.value.isInFilterMode()},e.prototype.getHiddenRows=function(e,t,r){var n=this.getGridById(e);return n.kind===l.a.Failure?s.j:n.value.getHiddenRows(t,r)},e.prototype.tryGetHiddenRows=function(e,t,r){var n=this.getGridById(e);return n.kind===l.a.Failure?n:n.value.tryGetHiddenRows(t,r)},e.prototype.getHiddenCols=function(e,t,r){var n=this.getGridById(e);return n.kind===l.a.Failure?s.j:n.value.getHiddenCols(t,r)},e.prototype.tryGetHiddenCols=function(e,t,r){var n=this.getGridById(e);return n.kind===l.a.Failure?n:n.value.tryGetHiddenCols(t,r)},e.prototype.getMergeCell=function(e){var t=this.getGridById(e.sheet.index);return t.kind===l.a.Failure?t:Object(l.e)(t.value.getMergeCell(e.range))},e.prototype.getServerFormat=function(e){var t=this.getGridById(e.sheet.index);return t.kind===l.a.Failure?t:Object(l.e)(t.value.getServerFormat(e.range))},e.prototype.getServerStyle=function(e){var t=this.getGridById(e.sheet.index);return t.kind===l.a.Failure?t:Object(l.e)(t.value.getServerStyle(e.range))},e.prototype.getClientFormat=function(e){var t=this.getGridById(e.sheet.index);return t.kind===l.a.Failure?t:Object(l.e)(t.value.getClientFormat(e.range))},e.prototype.getClientValue=function(e){var t=this.getGridById(e.sheet.index);return t.kind===l.a.Failure?t:Object(l.e)(t.value.getClientValue(e.range))},e.prototype.getRecalcValues=function(e){var t=this.getGridById(e.sheet.index);return t.kind===l.a.Failure?t:Object(l.e)(t.value.getRecalcValues(e.range))},e.prototype.getServerValue=function(e){var t=this.getGridById(e.sheet.index);return t.kind===l.a.Failure?t:Object(l.e)(t.value.getServerValue(e.range))},e.prototype.getServerFormula=function(e){var t=this.getGridById(e.sheet.index);return t.kind===l.a.Failure?t:Object(l.e)(t.value.getServerFormula(e.range))},e.prototype.getClientFormula=function(e){var t=this.getGridById(e.sheet.index);return t.kind===l.a.Failure?t:Object(l.e)(t.value.getClientFormula(e.range))},e.prototype.getServerUsedRange=function(e){var t=this.getGridById(e);return t.kind===l.a.Failure?t:Object(l.e)(t.value.getServerUsedRange())},e.prototype.allServerAvailable=function(e){var t=this.getGridById(e.sheet.index);return t.kind===l.a.Failure?t:Object(l.e)(t.value.allServerAvailable(e.range))},e.prototype.allEditedAvailable=function(e){var t=this.getGridById(e.sheet.index);return t.kind===l.a.Failure?t:Object(l.e)(t.value.allEditedAvailable(e.range))},e.prototype.forEachRecalcDirty=function(e,t){var r=this.getGridById(e.sheet.index);return r.kind===l.a.Failure?r:Object(l.e)(r.value.forEachRecalcDirty(e.range,t))},e.prototype.hasRecalcDirty=function(e){var t=this.getGridById(e.sheet.index);return t.kind===l.a.Failure?t:Object(l.e)(t.value.hasRecalcDirty(e.range))},e.prototype.hasRecalcFailure=function(e){var t=this.getGridById(e.sheet.index);return t.kind===l.a.Failure?t:Object(l.e)(t.value.hasRecalcFailure(e.range))},e.prototype.hasEditedEditTaint=function(e){var t=this.getGridById(e.sheet.index);return t.kind===l.a.Failure?t:Object(l.e)(t.value.hasEditedEditTaint(e.range))},e.prototype.hasRecalcEditTaint=function(e){var t=this.getGridById(e.sheet.index);return t.kind===l.a.Failure?t:Object(l.e)(t.value.hasRecalcEditTaint(e.range))},e.prototype.forEachEditedNonBlankCellInSet=function(e,t,r){var n=this.getGridById(e);return n.kind===l.a.Failure?n:Object(l.e)(n.value.forEachEditedNonBlankCellInSet(t,r))},e.prototype.forEachServerNonBlankCellInSet=function(e,t,r){var n=this.getGridById(e);return n.kind===l.a.Failure?n:Object(l.e)(n.value.forEachServerNonBlankCellInSet(t,r))},e.prototype.forEachEditedCellInSet=function(e,t,r){var n=this.getGridById(e);return n.kind===l.a.Failure?n:Object(l.e)(n.value.forEachEditedCellInSet(t,r))},e.prototype.getSheetIndex=function(e){var t=this.sheets.getSheetByName(e);return t.kind===l.a.Failure||void 0===t.value?t:Object(l.e)(t.value.sheetIndex)},e.prototype.getSheetName=function(e){var t=this.sheets.getSheetById(e);return t.kind===l.a.Failure?t:Object(l.e)(t.value.name)},e.prototype.getEditedUsedRange=function(e){var t=this.getGridById(e);return t.kind===l.a.Failure?t:Object(l.e)(t.value.getEditedUsedRange())},e.prototype.getSheetRangeIds=function(e){return this.sheets.getSheetRangeIds(e)},e.prototype.getIformat=function(e){return this.formats.getIformat(e)},e.prototype.getIformats=function(){return this.formats.getIformats()},e.prototype.getKnownFormat=function(e){return this.formats.getKnownFormat(e)},e.prototype.getFormatString=function(e){return this.formats.getFormatString(e)},e.prototype.resolveCellStyle=function(e){return this.styles.resolveCellStyle(e)},e.prototype.setNumberFormats=function(e,t){this.formats.setNumberFormats(e,t)},e.prototype.setStyles=function(e,t){this.styles.setStyles(e,t)},e.prototype.setFonts=function(e,t){this.styles.setFonts(e,t)},e.prototype.setFills=function(e,t){this.styles.setFills(e,t)},e.prototype.setBorders=function(e,t){this.styles.setBorders(e,t)},e.prototype.onCellModified=function(e){this.forEachSheet((function(t,r){r.onCellModified(e)})),this.nameManager.onCellModified(e)},e.prototype.collectGarbage=function(e){this.forEachSheet((function(t,r){r.collectGarbage(e)})),this.nameManager.collectGarbage(e)},e.prototype.advanceState=function(e){this.forEachSheet((function(t,r){r.advanceState(e)})),this.nameManager.advanceState(e),this.sheets.advanceState(e),this.oldGrids=this.grids,this.grids=void 0},e.prototype.clearCompiledFormulas=function(){this.forEachSheet((function(e,t){t.clearCompiledFormulas()})),this.nameManager.resetLazyData()},e.prototype.clearCompiledNumberFormats=function(){this.formats.clearCompiledNumberFormats()},e.prototype.getGridStatistics=function(){var e=s.h;return this.forEachSheet((function(t,r){return e=Object(s.o)(e,r.getStatistics())})),e},e.prototype.getNameStatistics=function(){return this.nameManager.getNameStatistics()},e.prototype.getServerAvailableCells=function(){var e=[];return this.forEachSheet((function(t,r){e.push({sheetIdx:t.sheetIndex,availableCells:r.getServerAvailability()})})),e},e.prototype.forEachSheet=function(e){var t=this.grids;t&&this.sheets.forEachSheet((function(r,n){var i=t[n];i&&e(r,i)}))},e.prototype.getGridById=function(e){var t=this.grids;if(!t)return Object(l.b)({kind:i.e.SheetNames});var r=t[e];return void 0===r?Object(l.b)({kind:i.e.SheetId,document:this.document,sheetId:e}):Object(l.e)(r)},e}(),h=r(8),v=r(12),g=r(30),b=r(93),S=r(55),y=r(19),O=r(73),C=r(108),P=r(158),N=r(11),R=r(29),k=r(1),T=r(162),E=r(9),_=r(159),F=r(94),I=r(100),A=r(83),M=r(3).adjust.adjustFormulaOrigin,w=r(17),D=r(120),j=r(157),x=r(21),L=r(33),B=r(7),U=r(47),G=r(50),K=function(){function e(e){this.iformats=[],this.formatStrings=Object(o.h)(),this.knownFormats=e}return e.prototype.clone=function(){var t=this,r=new e(this.knownFormats);return Object.keys(this.iformats).map(Number).forEach((function(e){r.iformats[e]=t.iformats[e]})),Object.keys(this.formatStrings).forEach((function(e){r.formatStrings[e]=t.formatStrings[e]})),r},e.prototype.clearCompiledNumberFormats=function(){var e=this;this.iformats.forEach((function(e){e.compiledFormat.reset()})),Object.keys(this.knownFormats).map((function(e){return Number(e)})).forEach((function(t){e.knownFormats[t].reset()})),this.formatStrings=Object(o.h)(),Object.keys(this.iformats).map(Number).forEach((function(t){var r=e.iformats[t];e.formatStrings[r.formatString]=t}))},e.prototype.getIformat=function(e){var t=this.iformats[e];return void 0===t?Object(l.b)({kind:i.e.NumberFormat,iformat:e}):Object(l.e)(t.compiledFormat)},e.prototype.getIformats=function(){return this.iformats},e.prototype.getKnownFormat=function(e){return Object(l.e)(this.knownFormats[e])},e.prototype.getFormatString=function(e){return Object(l.e)(this.formatStrings[e])},e.prototype.setNumberFormats=function(e,t){var r=this;t||(this.iformats=[],this.formatStrings=Object(o.h)()),Object.keys(e).map(Number).forEach((function(t){var n=r.iformats[t];void 0!==n&&delete r.formatStrings[n.formatString];var i=e[t];r.iformats[t]=i,r.formatStrings[i.formatString]=t}))},e}(),V=r(125),W=r(35),H=r(28),q=r(121),z=r(77);r.d(t,"b",(function(){return Y})),r.d(t,"c",(function(){return Z})),r.d(t,"a",(function(){return X}));var Q=Object(h.f)(0,0),J=function(e){function t(){var t=e.call(this,void 0)||this;return t.fns=[],t}return Object(n.__extends)(t,e),t.prototype.wsfNode=function(e){this.fns.push(Object(v.o)(e))},t.prototype.operatorNode=function(e){this.fns.push(Object(v.n)(e))},t}(H.c);var Y,$=Object(g.p)([],[],[],x.d.None,g.b.Exact);!function(e){e.GroundTruth="GroundTruth",e.Estimation="Estimation",e.PrecisionTest="PrecisionTest"}(Y||(Y={}));var Z={onNameFailure:function(){},onRangeFailure:function(){},onNumberFormatFailure:function(){},onInferFormatFailure:function(){},onUnavailableObject:function(){},onUnavailable:function(){},onSetCellValue:function(){},onSetCellValues:function(){},onReturnCellValue:function(){}},X=function(){function e(e,t,r,n,o,s){var u=this;this.cb=t,this.schedulerConfig=r,this.limits=n,this.maxDereferenceCells=o,this.isServerWorkbookLoad=s,this.random=new B.JSF32(4294967296*Math.random()),this.worksheetFuncOverrides={},this.userDefinedFuncOverrides={},this.interruptToken=[y.b.Continue],this.getCellValue=this.makeGetCellValues(this.tryGetCellValue.bind(this)),this.getCellValues=this.makeGetCellValues(this.tryGetCellValues.bind(this)),this.compileNamedObject=function(e,t,r){var n=e?c.c.ServerNamedFormula:c.c.EditNamedFormula;switch(r.kind){case"NamedFormula":var o=r.fmla,s=u.parser.parseFormula(Object(O.d)(h.a.NameManager,Q),o);Object(E.g)("calc.calc.PartialWorkbookDocumentCollection.compileNamedObject: isServerUpdate",e);var d=e&&u.isServerWorkbookLoad,f=Object(S.b)(Object(h.p)(Object(h.e)(u.documentLoc),Q),void 0,d),p=s,m=u.checkFormula(f,p,o,n);return u.compileFormula(Object(y.j)(Q),m);case"NamedValue":case"NamedRange":case"NamedTable":var v;s=void 0;if("NamedRange"===r.kind){var g=r.value;Object(E.g)("calc.calc.PartialWorkbookDocumentCollection.compileNamedObject: bad range",Object(a.x)(r.value.sheets.document,t.scope.document));var b=g.sheets,C=u.getDocument(b.document);if(!Object(l.c)(C))return u.cb.onUnavailableObject(C.reason),Object(l.b)(Object(a.Z)([C.reason]));var P=C.value.getSheetName(b.index);if(!Object(l.c)(P))return u.cb.onUnavailable(P.reason),P;var R=r.value.ranges[0];s=Object(N.I)(Object(N.u)(Object(N.v)(Object(N.x)(Object(N.db)(N.f.Abs,R.row),Object(N.db)(N.f.Abs,R.col)),Object(N.x)(Object(N.db)(N.f.Abs,R.row+R.rows-1),Object(N.db)(N.f.Abs,R.col+R.cols-1))),Object(N.gb)(P.value)),[],[],1),v=Object(h.r)(b,Q)}else"NamedTable"===r.kind?(s=Object(N.I)(Object(N.kb)(Object(N.X)(t.name),Object(N.jb)(void 0)),[],[],1),v=Object(h.p)(Object(h.e)(u.documentLoc),Q)):(s=Object(N.I)(Object(N.T)(r.value,!0),[],[],1),v=Object(h.p)(Object(h.e)(u.documentLoc),Q));m=u.analyzer.checkFormula(Object(S.b)(v),s);return Object(l.c)(m)&&Object(a.V)(m.value)?u.compileFormula(Object(y.j)(Q),Object(l.e)(m.value)):Object(E.a)("calc.calc.PartialWorkbookDocumentCollection.compileNamedObject: constructed ill-formed formula ".concat(Object(I.a)(u.config,s,Object(h.j)(t))));case"NamedFailure":return Object(l.b)(Object(a.Z)([{kind:i.e.ClientFailure,reason:r.failureReason}]));default:return Object(E.d)("calc.calc.partialWorkbookDocumentCollection.compileNamedFmla",r)}},this.config=e,this.parser=Object(C.a)(this),this.printer=Object(I.b)(this),this.analyzer=Object(b.a)(this),this.formatter=Object(D.a)(this),this.compiler=Object(P.a)(this),this.evaluator=Object(_.a)(this)}return e.prototype.clone=function(t,r){var n;void 0===t&&(t=Z),void 0===r&&(r=i.a.Server);var a=new e(this.config,t,this.schedulerConfig,this.limits,this.maxDereferenceCells,this.isServerWorkbookLoad);return a.documentLoc=this.documentLoc,a.document=null===(n=this.document)||void 0===n?void 0:n.clone(r),a.worksheetFuncOverrides=this.worksheetFuncOverrides,a.userDefinedFuncOverrides=this.userDefinedFuncOverrides,a},e.prototype.reconfigure=function(e,t,r,n){this.schedulerConfig=e,this.limits=t,this.maxDereferenceCells=r,this.isServerWorkbookLoad=n},e.prototype.setConfig=function(e){this.config=e},e.prototype.forEachDocument=function(e){void 0!==this.document&&e(this.document)},e.prototype.getDocumentLoc=function(e,t){var r=this.documentLoc;return void 0===r||void 0!==e&&e!==r.path||0!==this.config.localeInfo.stringCompareCI(t,r.name)?Object(l.b)(Object(a.Z)([{kind:i.e.DocumentLoc,document:Object(h.d)(e,t)}])):Object(l.e)(r)},e.prototype.getNameLoc=function(e,t,r){var n=this.getDocument(e.document);return n.kind===l.a.Failure?Object(l.b)(Object(a.Z)([n.reason])):n.value.getNameLoc(e.index,t,r)},e.prototype.getUserDefinedFuncLoc=function(e,t){if(void 0!==this.userDefinedFuncOverrides[t]){var r=Object(h.z)(e,t);return Object(l.e)([r])}return Object(l.b)(Object(a.X)(["call UDF"]))},e.prototype.getCellFormat=function(e){var t=this.allEditedAvailable(e);if(t.kind===l.a.Failure)return Object(l.b)(Object(a.Z)([t.reason]));if(!0!==t.value)return Object(l.b)(Object(a.Z)([{kind:i.e.GridRange,unavailableCells:t.value,range:e}]));var r=this.getEditedFormat(e);return r.kind===l.a.Failure?Object(l.b)(Object(a.Z)([r.reason])):r.value===c.f.Unavailable?Object(l.b)(Object(a.Z)([{kind:i.e.CellFormat}])):Object(l.e)(r.value)},e.prototype.getCellStyle=function(e){var t=this.allEditedAvailable(e);if(!Object(l.c)(t))return Object(l.b)(Object(a.Z)([t.reason]));if(!0!==t.value)return Object(l.b)(Object(a.Z)([{kind:i.e.GridRange,unavailableCells:t.value,range:e}]));var r=this.getEditedStyle(e);return Object(l.c)(r)?r.value===c.g.Unavailable?Object(l.b)(Object(a.Z)([{kind:i.e.CellStyle}])):this.resolveCellStyle(e.sheet.document,r.value):Object(l.b)(Object(a.Z)([r.reason]))},e.prototype.getIformat=function(e,t){var r=this.getDocument(e);if(r.kind===l.a.Failure)return Object(l.b)(Object(a.Z)([r.reason]));var n=r.value.getIformat(t);if(n.kind===l.a.Failure)return Object(l.b)(Object(a.Z)([n.reason]));var i=n.value.getValue();return i.kind===l.a.Failure?Object(l.b)(Object(w.F)()):i},e.prototype.getIformats=function(e,t,r){var n=this.getDocument(e);if(n.kind===l.a.Failure)return Object(l.b)(Object(a.Z)([n.reason]));for(var i=n.value.getIformats(),s=[],u=t,c=Object(o.c)(i.length,r);u<c;u+=1){var d=i[u];void 0!==d&&s.push({iformat:u,formatString:d.formatString,builtIn:d.builtIn})}return Object(l.e)(s)},e.prototype.getKnownFormat=function(e,t){var r=this.getDocument(e);if(r.kind===l.a.Failure)return Object(l.b)(Object(a.Z)([r.reason]));var n=r.value.getKnownFormat(t);if(n.kind===l.a.Failure)return Object(l.b)(Object(a.Z)([n.reason]));var i=n.value.getValue();return i.kind===l.a.Failure?Object(l.b)(Object(w.F)()):i},e.prototype.getFormatString=function(e,t){var r=this.getDocument(e);if(r.kind===l.a.Failure)return Object(l.b)(Object(a.Z)([r.reason]));var n=r.value.getFormatString(t);return n.kind===l.a.Failure?Object(l.b)(Object(a.Z)([n.reason])):n},e.prototype.getNameFormula=function(e,t){var r=this.getDocument(e.scope.document);if(r.kind===l.a.Failure)return Object(l.b)(Object(a.Z)([r.reason]));var n=r.value.getNameFormula(e,t);if(n.kind===l.a.Failure)return n;if(void 0===n.value)return Object(l.e)(void 0);var i=n.value.lazyData.getValue();if(Object(l.c)(i))return i;var o=this.hasRecalcNameFailure(e);return Object(l.c)(o)?o.value||this.setNameFailure(e,i.reason):this.cb.onUnavailable(o.reason),Object(l.b)(Object(y.w)(e))},e.prototype.getCellFormula=function(e){var t=this.getEditedFormula(e);if(t.kind===l.a.Failure)return Object(l.b)(Object(a.Z)([t.reason]));if(void 0===t.value)return Object(l.e)(void 0);var r=t.value,n=r[0],i=r[1];if(void 0===i.compiledFmla)return Object(l.e)(void 0);var o=Object(h.t)(e.sheet,n),s=this.readCompiledFmla(o,i.compiledFmla);return Object(l.c)(s)?Object(l.e)(Object(y.g)(Object(h.i)(i.lexicalKind,o),s.value)):s},e.prototype.setCellValue=function(e,t,r){var n=this.setRecalcValue(e,t);if(n.kind===l.a.Failure)return this.cb.onUnavailableObject(n.reason);var i=this.propagateEditTaint(e,r);if(i.kind===l.a.Failure)return this.cb.onUnavailableObject(i.reason);this.cb.onSetCellValue(e,t,r,i.value,this.evalParams)},e.prototype.setCellValues=function(e,t,r){var n=this.setClientValue(e,t);if(n.kind===l.a.Failure)return this.cb.onUnavailableObject(n.reason);var i=this.setRecalcValue(e,t);if(i.kind===l.a.Failure)return this.cb.onUnavailableObject(i.reason);var a=this.propagateEditTaint(e,r);if(a.kind===l.a.Failure)return this.cb.onUnavailableObject(a.reason);this.cb.onSetCellValues(e,t,r,a.value,this.evalParams)},e.prototype.getWorksheetFunc=function(e){var t;if(0!=(Object(k.d)(e).staticPrecs&(x.d.Time|x.d.Calc))){var r=!1,n=this.evalParams.volatileMode;switch(e){case k.b.RAND:case k.b.RANDBETWEEN:case k.b.RANDARRAY:case k.b.NOW:r=n===Y.GroundTruth;break;case k.b.TODAY:r=n===Y.GroundTruth||n===Y.Estimation;break;default:r=void 0===k.b[e]}if(!r)return Object(l.b)(Object(a.Z)([{kind:i.e.VolatileFunction,name:Object(v.o)(e)}]))}var o=null!==(t=this.worksheetFuncOverrides[e])&&void 0!==t?t:Object(T.a)(e);return null!=o?Object(l.e)(o):Object(l.b)(Object(a.X)([Object(v.o)(e)]))},e.prototype.getUserDefinedFunc=function(e){var t=e.id;return void 0!==this.userDefinedFuncOverrides[t]?Object(l.e)(this.userDefinedFuncOverrides[t]):Object(l.b)(Object(a.X)(["call UDF"]))},e.prototype.getSheetRangeIndexes=function(e){return this.getSheetRangeIds(e)},e.prototype.setCellFailure=function(e,t,r){var n=this.setRecalcFailure(e.sheet,Object(u.f)(e.range));if(n.kind===l.a.Failure)return this.cb.onUnavailableObject(n.reason);var i=this.setClientValue(e,s.g);if(i.kind===l.a.Failure)return this.cb.onUnavailableObject(i.reason);var a=this.setRecalcValue(e,g.d);if(a.kind===l.a.Failure)return this.cb.onUnavailableObject(a.reason);var o=this.propagateEditTaint(e,r);if(o.kind===l.a.Failure)return this.cb.onUnavailableObject(o.reason);this.cb.onRangeFailure(e,t,r,o.value,this.evalParams)},e.prototype.getUsedRange=function(e){var t=this.getEditedUsedRange(e);return t.kind===l.a.Failure?Object(l.b)(Object(a.Z)([t.reason])):t},e.prototype.getSheetName=function(e,t){var r=this.getDocument(e);if(r.kind===l.a.Failure)return Object(l.b)(Object(a.Z)([r.reason]));var n=r.value.getSheetName(t);return n.kind===l.a.Failure||void 0===n.value?n:Object(l.e)(n.value)},e.prototype.getSheetIndex=function(e,t){var r=this.getDocument(e);if(r.kind===l.a.Failure)return Object(l.b)(Object(a.Z)([r.reason]));var n=r.value.getSheetIndex(t);return n.kind===l.a.Failure||void 0===n.value?n:Object(l.e)(n.value.index)},e.prototype.getContainingTable=function(e){var t=this.getDocument(e.sheet.document);return t.kind===l.a.Failure?Object(l.b)(Object(a.Z)([t.reason])):t.value.getContainingTable(e)},e.prototype.getNamedRanges=function(e){var t=this.getDocument(e.sheet.document);return t.kind===l.a.Failure?Object(l.b)(Object(a.Z)([t.reason])):t.value.getNamedRanges(e)},e.prototype.getStructRefColumn=function(e,t){var r=this.getDocument(e.scope.document);return r.kind===l.a.Failure?Object(l.b)(Object(a.Z)([r.reason])):r.value.getStructRefColumn(e,t)},e.prototype.getStructRefSpecialRef=function(e,t){var r=this.getDocument(e.scope.document);return r.kind===l.a.Failure?Object(l.b)(Object(a.Z)([r.reason])):r.value.getStructRefSpecialRef(e,t)},e.prototype.getIntersectingTables=function(e){var t=this.getDocument(e.sheet.document);return t.kind===l.a.Failure?Object(l.b)(Object(a.Z)([t.reason])):t.value.getIntersectingTables(e)},e.prototype.getNamedObject=function(e,t){var r,n=this.getDocument(e.scope.document);if(n.kind===l.a.Failure)return Object(l.b)(Object(a.Z)([n.reason]));var i=n.value.getNameFormula(e,t);return i.kind===l.a.Failure?i:Object(l.e)(null===(r=i.value)||void 0===r?void 0:r.obj)},e.prototype.getHiddenRows=function(e,t,r){var n=this.getDocument(e.document);return n.kind===l.a.Failure?s.j:n.value.getHiddenRows(e.index,t,r)},e.prototype.tryGetHiddenRows=function(e,t,r){var n=this.getDocument(e.document);if(n.kind===l.a.Failure)return Object(l.b)(Object(a.Z)([n.reason]));var i=n.value.tryGetHiddenRows(e.index,t,r);return i.kind===l.a.Failure?Object(l.b)(Object(a.Z)([i.reason])):i},e.prototype.getHiddenCols=function(e,t,r){var n=this.getDocument(e.document);return n.kind===l.a.Failure?s.j:n.value.getHiddenCols(e.index,t,r)},e.prototype.tryGetHiddenCols=function(e,t,r){var n=this.getDocument(e.document);if(n.kind===l.a.Failure)return Object(l.b)(Object(a.Z)([n.reason]));var i=n.value.tryGetHiddenCols(e.index,t,r);return i.kind===l.a.Failure?Object(l.b)(Object(a.Z)([i.reason])):i},e.prototype.getMergeCell=function(e){var t=this.allEditedAvailable(e);if(t.kind===l.a.Failure)return Object(l.b)(Object(a.Z)([t.reason]));if(!0!==t.value)return Object(l.b)(Object(a.Z)([{kind:i.e.GridRange,unavailableCells:t.value,range:e}]));var r=this.getDocument(e.sheet.document);if(r.kind===l.a.Failure)return Object(l.b)(Object(a.Z)([r.reason]));var n=r.value.getMergeCell(e);return n.kind===l.a.Failure?Object(l.b)(Object(a.Z)([n.reason])):n},e.prototype.isInFilterMode=function(e){var t=this.getDocument(e.document);if(t.kind===l.a.Failure)return Object(l.b)(Object(a.Z)([t.reason]));var r=t.value.isInFilterMode(e.index);return r.kind===l.a.Failure?Object(l.b)(Object(a.Z)([r.reason])):r},e.prototype.getRandom=function(){return Object(E.g)("calc.calc.PartialWorkbookDocumentCollection: getRandom",this.evalParams.volatileMode===Y.GroundTruth),Object(l.e)(this.config.mathpack.fromNumber(this.random.next()))},e.prototype.getTime=function(e,t){return Object(R.e)(this.config,e,t,this.evalParams.volatileMode)},e.prototype.withEvalParams=function(e,t){var r=this,n=this.evalParams;this.evalParams=e;try{var i=t();return Array.isArray(i)?i:i.kind===l.a.Paused?Object(y.t)((function(){return r.withEvalParams(e,i.resume)})):Object(y.e)((function(){return r.withEvalParams(e,i.resume)}))}finally{this.evalParams=n}},e.prototype.withEvalParamsEvalFormula=function(e,t){var r=this,n=this.evalParams;this.evalParams=e;try{var i=t();return i.kind===l.a.Paused?Object(y.t)((function(){return r.withEvalParamsEvalFormula(e,i.resume)})):i.kind===l.a.Breaked?Object(y.e)((function(){return r.withEvalParamsEvalFormula(e,i.resume)})):i}finally{this.evalParams=n}},e.prototype.evaluate=function(e,t,r){var n=this;return this.withEvalParams({computeKind:e,computeCells:t,volatileMode:r},(function(){return n.evaluator.evalCells({},t)}))},e.prototype.evalFormula=function(e,t,r,n){var i=this,a={lexicalKind:h.a.Other,originGridCell:Object(l.e)(t.range),originSheet:Object(l.e)(t.sheet),allowRelativeQualifier:!1,allowUnqualifiedCell:!0,allowImplicitTable:!0,wrapCellReferences:!1,workbookLoad:!1,emitStepInfo:!1},o={lexicalSource:{kind:h.a.Other},originGridCell:Object(l.e)(t.range),originSheet:Object(l.e)(t.sheet),calcingArray:!1,reflectionGridCell:Object(l.e)(t.range),reflectionSheet:Object(l.e)(t.sheet),implicitIntersect:!1,allowUnqualifiedCell:!0,wrapCellReferences:!1,followHyperlinks:Object(l.e)(!1)},s=function(e,n){if(n.kind===l.a.Paused)return Object(y.t)((function(){return s(e,n.resume())}));if(n.kind===l.a.Breaked)return Object(y.e)((function(){return s(e,n.resume())}));if(!Object(l.c)(n))return Object(l.e)({value:n});var a=i.evalFormulaFormat(t,e,n.value,r);return Object(l.e)({value:Object(l.e)(n.value),formatted:a})};return this.withEvalParamsEvalFormula({computeKind:c.a.EvalFormula,computeCells:[t],volatileMode:n},(function(){var t=i.parser.parseFormula(a,e),r=i.checkFormula(a,t,e,c.c.EvalFormula),n=i.compileFormula(a,r);return Object(l.c)(n)?s(n.value,i.evaluator.evalFormula(o,n.value)):Object(l.e)({value:n})}))},e.prototype.evalFormulaFormat=function(e,t,r,n){if(void 0!==n){if(n===c.f.Origin){var o=this.allEditedAvailable(e);return Object(l.c)(o)?!0!==o.value?Object(l.b)(Object(a.Z)([{kind:i.e.GridRange,unavailableCells:o.value,range:e}])):this.formatValueCell(e,r):void this.cb.onUnavailableObject(o.reason)}if(n===c.f.Inferred){var s={lexicalSource:{kind:h.a.Other},originGridCell:Object(l.e)(e.range),originSheet:Object(l.e)(e.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!1},u=this.formatter.evalFormat(s,t);return Object(l.c)(u)?void 0===u.value?this.formatValueKnownFormat(e.sheet.document,U.d.General,r):"number"==typeof u.value?this.formatValueIformat(e.sheet.document,u.value,r):this.formatter.applyFormat(u.value,r,!0):u}return this.formatValueIformat(e.sheet.document,n,r)}},e.prototype.evalValue=function(e,t,r){var n,i=this.evalParams;this.evalParams={computeKind:t,computeCells:[e],volatileMode:r};try{var a=this.getEditedFormula(e);if(!Object(l.c)(a))return this.cb.onUnavailableObject(a.reason);if(void 0!==(null===(n=a.value)||void 0===n?void 0:n[1].compiledFmla))return;var o=this.hasRecalcDirty(e);if(!Object(l.c)(o))return this.cb.onUnavailableObject(o.reason);if(o.value)return;var s=this.tryGetCellValue(e.range,e.sheet);if(void 0===s)return;Object(E.g)("calc.calc.PartialWorkbookDocumentCollection.evalValue",s.kind===y.a.FinalValue),this.cb.onReturnCellValue(e,s.oper,c.b.EditedCell)}finally{this.evalParams=i}},e.prototype.setUserDefinedFuncOverrides=function(e){this.userDefinedFuncOverrides=e},e.prototype.setWorksheetFuncOverrides=function(e){this.worksheetFuncOverrides=e},e.prototype.setSheetNames=function(e,t){var r=this.ensureDocument(e);return r.kind===l.a.Failure?r:(this.document=r.value.setSheetNames(t),Object(l.e)(void 0))},e.prototype.advanceState=function(e){void 0!==this.document&&this.document.advanceState(e)},e.prototype.onCellModified=function(e){if(void 0!==this.document)return this.document.onCellModified(e)},e.prototype.getServerDocument=function(){return this.documentLoc},e.prototype.allServerAvailable=function(e){var t=this.getDocument(e.sheet.document);return t.kind===l.a.Failure?t:t.value.allServerAvailable(e)},e.prototype.forEachEditedNonBlankCellInSet=function(e,t,r){var n=e.index,i=e.document,a=this.getDocument(i);return a.kind===l.a.Failure?a:a.value.forEachEditedNonBlankCellInSet(n,t,r)},e.prototype.forEachServerNonBlankCellInSet=function(e,t,r){var n=e.index,i=e.document,a=this.getDocument(i);return a.kind===l.a.Failure?a:a.value.forEachServerNonBlankCellInSet(n,t,r)},e.prototype.forEachEditedCellInSet=function(e,t,r){var n=e.index,i=e.document,a=this.getDocument(i);return a.kind===l.a.Failure?a:a.value.forEachEditedCellInSet(n,t,r)},e.prototype.clearCompiledFormulas=function(){if(void 0!==this.document)return this.document.clearCompiledFormulas()},e.prototype.clearCompiledNumberFormats=function(){if(void 0!==this.document)return this.document.clearCompiledNumberFormats()},e.prototype.getGridStatistics=function(){return void 0!==this.document?this.document.getGridStatistics():s.h},e.prototype.getNameStatistics=function(){return void 0!==this.document?this.document.getNameStatistics():G.b},e.prototype.collectGarbage=function(e){if(void 0!==this.document)return this.document.collectGarbage(e)},e.prototype.getEditedFormula=function(e){var t=this.getDocument(e.sheet.document);return t.kind===l.a.Failure?t:t.value.getEditedFormula(e)},e.prototype.forEachEditedFormula=function(e,t){var r=this.getDocument(e.sheet.document);return r.kind===l.a.Failure?r:r.value.forEachEditedFormula(e,t)},e.prototype.getEditedValue=function(e){var t=this.getDocument(e.sheet.document);return t.kind===l.a.Failure?t:t.value.getEditedValue(e)},e.prototype.forEachEditedValue=function(e,t){var r=this.getDocument(e.sheet.document);return r.kind===l.a.Failure?r:r.value.forEachEditedValue(e,t)},e.prototype.getEditedFormat=function(e){var t=this.getDocument(e.sheet.document);return t.kind===l.a.Failure?t:t.value.getEditedFormat(e)},e.prototype.forEachEditedFormat=function(e,t){var r=this.getDocument(e.sheet.document);return r.kind===l.a.Failure?r:r.value.forEachEditedFormat(e,t)},e.prototype.getEditedStyle=function(e){var t=this.getDocument(e.sheet.document);return t.kind===l.a.Failure?t:t.value.getEditedStyle(e)},e.prototype.getServerFormat=function(e){var t=this.getDocument(e.sheet.document);return t.kind===l.a.Failure?t:t.value.getServerFormat(e)},e.prototype.getServerStyle=function(e){var t=this.getDocument(e.sheet.document);return t.kind===l.a.Failure?t:t.value.getServerStyle(e)},e.prototype.getClientFormat=function(e){var t=this.getDocument(e.sheet.document);return t.kind===l.a.Failure?t:t.value.getClientFormat(e)},e.prototype.getClientValue=function(e){var t=this.getDocument(e.sheet.document);return t.kind===l.a.Failure?t:t.value.getClientValue(e)},e.prototype.getRecalcValues=function(e){var t=this.getDocument(e.sheet.document);return t.kind===l.a.Failure?t:t.value.getRecalcValues(e)},e.prototype.getServerValue=function(e){var t=this.getDocument(e.sheet.document);return t.kind===l.a.Failure?t:t.value.getServerValue(e)},e.prototype.getServerFormula=function(e){var t=this.getDocument(e.sheet.document);return t.kind===l.a.Failure?t:t.value.getServerFormula(e)},e.prototype.getClientFormula=function(e){var t=this.getDocument(e.sheet.document);return t.kind===l.a.Failure?t:t.value.getClientFormula(e)},e.prototype.getServerUsedRange=function(e){var t=this.getDocument(e.document);if(t.kind===l.a.Failure)return t;var r=t.value.getServerUsedRange(e.index);return r.kind===l.a.Failure||void 0===r.value?r:Object(l.e)(Object(h.t)(e,r.value))},e.prototype.getServerAvailableCells=function(){var e=[];return this.forEachDocument((function(t){Object(o.o)(e,t.getServerAvailableCells())})),e},e.prototype.promoteServerAvailability=function(e,t){var r=e.sheet,n=e.set,i=this.getDocument(r.document);return i.kind===l.a.Failure?i:i.value.promoteServerAvailability(r.index,n,t)},e.prototype.extendServerUnused=function(e,t){var r=this.getDocument(e.document);return r.kind===l.a.Failure?r:r.value.extendServerUnused(e.index,t)},e.prototype.setCellContents=function(e,t,r,n,i,a,o,u,c,d){var f=this.getDocument(t.sheet.document);if(f.kind===l.a.Failure)return f;var p=void 0===r?void 0:n?this.compileFmla(e,h.a.Cell,Object(h.r)(t.sheet,i),void 0,r):""===r?s.d:{fmla:r,lexicalKind:h.a.Cell,origin:i,compiledFmla:void 0,hasHyperlink:s.b.ClientValueUnknown};return f.value.setCellContents(e,t,p,a,o,u,c,d)},e.prototype.setRangeFormula=function(e,t,r,n,i,o,u,c){var d=this.getDocument(t.sheet.document);if(d.kind===l.a.Failure)return d;var f=""===r?s.f:this.compileFmla(e,h.a.Range,Object(h.r)(t.sheet,n),Object(a.k)(t.range),r);return d.value.setRangeFormula(e,t,f,i,o,u,c)},e.prototype.copyRange=function(e){var t=this.getDocument(e.sheet.document);return t.kind===l.a.Failure?t:t.value.copyRange(e)},e.prototype.pasteRange=function(e,t){var r=this.getDocument(e.sheet.document);return r.kind===l.a.Failure?r:r.value.pasteRange(e,t)},e.prototype.getDirtyEditedCells=function(){return this.document?this.document.getDirtyEditedCells():[]},e.prototype.getNonDirtyEditedCells=function(){return this.document?this.document.getNonDirtyEditedCells():[]},e.prototype.getDirtyDependentCells=function(){return this.document?this.document.getDirtyDependentCells():[]},e.prototype.setNamedObject=function(e,t,r){var n=this.getDocument(t.scope.document);return n.kind===l.a.Failure?Object(l.b)(Object(a.Z)([n.reason])):n.value.setNamedObject(e,t,r,this.compileNamedObject)},e.prototype.setUndefinedNames=function(e){var t=this.getDocument(e.document);return t.kind===l.a.Failure?Object(l.b)(Object(a.Z)([t.reason])):t.value.setUndefinedNames(e)},e.prototype.promoteNamedObjects=function(e,t){var r=this.getDocument(e.document);return r.kind===l.a.Failure?Object(l.b)(Object(a.Z)([r.reason])):r.value.promoteNamedObjects(e,t)},e.prototype.setNumberFormats=function(e,t,r){var n=this,i=this.ensureDocument(e);if(i.kind===l.a.Failure)return Object(l.b)(Object(a.Z)([i.reason]));var o=[];return t.forEach((function(e){var t=e.iformat,r=e.formatString,i=e.builtIn,a=n.compileNumberFormat(r,i);o[t]={formatString:r,builtIn:i,compiledFormat:a}})),Object(l.e)(i.value.setNumberFormats(o,r))},e.prototype.setStyles=function(e,t,r){var n=this.ensureDocument(e);return n.kind===l.a.Failure?n:Object(l.e)(n.value.setStyles(t,r))},e.prototype.setFonts=function(e,t,r){var n=this.ensureDocument(e);return n.kind===l.a.Failure?n:Object(l.e)(n.value.setFonts(t,r))},e.prototype.setFills=function(e,t,r){var n=this.ensureDocument(e);return n.kind===l.a.Failure?n:Object(l.e)(n.value.setFills(t,r))},e.prototype.setBorders=function(e,t,r){var n=this.ensureDocument(e);return n.kind===l.a.Failure?n:Object(l.e)(n.value.setBorders(t,r))},e.prototype.writeHiddenRows=function(e,t,r){var n=this.getDocument(e.document);return n.kind===l.a.Failure?n:n.value.setHiddenRows(e.index,t,r)},e.prototype.writeHiddenCols=function(e,t,r){var n=this.getDocument(e.document);return n.kind===l.a.Failure?n:n.value.setHiddenCols(e.index,t,r)},e.prototype.writeMergeCell=function(e){var t=this.getDocument(e.sheet.document);return t.kind===l.a.Failure?t:t.value.setMergeCell(e)},e.prototype.writeInFilterMode=function(e,t){var r=this.getDocument(e.document);return r.kind===l.a.Failure?r:r.value.setInFilterMode(e.index,t)},e.prototype.resolveCellFormat=function(e,t){if("number"!=typeof t)return Object(l.e)(t);var r=this.getDocument(e);if(!Object(l.c)(r))return Object(l.b)(Object(a.Z)([r.reason]));var n=r.value.getIformat(t);return Object(l.c)(n)?n.value.getValue():Object(l.b)(Object(a.Z)([n.reason]))},e.prototype.resolveCellStyle=function(e,t){var r=this.getDocument(e);if(!Object(l.c)(r))return Object(l.b)(Object(a.Z)([r.reason]));var n=r.value.resolveCellStyle(t);return Object(l.c)(n)?Object(l.e)(n.value):Object(l.b)(Object(a.Z)([n.reason]))},e.prototype.resolveValueFormat=function(e,t){var r;if("string"==typeof t)return this.resolveStringFormat(e,t);var n=this.getKnownFormat(e,t);if(!Object(l.c)(n))return n;var i=this.getFormatString(e,n.value.formatString);return Object(l.c)(i)?Object(l.e)(null!==(r=i.value)&&void 0!==r?r:n.value):i},e.prototype.resolveStringFormat=function(e,t){var r=this.getFormatString(e,t);return Object(l.c)(r)?void 0!==r.value?Object(l.e)(r.value):this.formatter.createFormat(t,!1):r},e.prototype.resolveObjectFormat=function(e,t){var r=this.getFormatString(e,t.formatString);return Object(l.c)(r)?void 0!==r.value?Object(l.e)(r.value):Object(l.e)(t):r},e.prototype.resolveEditFormat=function(e,t){return"number"==typeof t?Object(l.e)(t):this.resolveStringFormat(e,t)},e.prototype.resolveRibbonFormat=function(e,t,r){var n;switch(t){case z.a.GalleryShortDate:case z.a.GalleryLongDate:var i=this.getCellFormat(r);if(!Object(l.c)(i))return i;var a=this.resolveCellFormat(r.sheet.document,i.value);if(!Object(l.c)(a))return a;n=a.value}var o=Object(z.b)(this.config.localeInfo,t,n);return this.resolveStringFormat(e,o)},e.prototype.resolveChangeDecimals=function(e,t,r){var n=this.getCellFormat(r);if(!Object(l.c)(n))return n;var i=this.resolveCellFormat(r.sheet.document,n.value);if(!Object(l.c)(i))return i;var a=this.formatter.changeFormatDecimals(i.value,t);return Object(l.c)(a)?void 0===a.value?l.f:this.resolveObjectFormat(e,a.value):a},e.prototype.parseInferredEdit=function(e,t,r){var n=this.getCellFormat(e);if(!Object(l.c)(n))return n;var i=this.resolveCellFormat(e.sheet.document,n.value);if(!Object(l.c)(i))return i;var a=this.evalParams;this.evalParams={computeKind:c.a.ParseEdit,computeCells:[e],volatileMode:r};try{return this.formatter.parseEdit(t,i.value)}finally{this.evalParams=a}},e.prototype.inferFormulaFormat=function(e){var t=this.getEditedFormula(e);if(!Object(l.c)(t))return Object(l.e)(void this.cb.onUnavailableObject(t.reason));if(void 0===t.value||void 0===t.value[1].compiledFmla)return Object(l.e)(void this.cb.onUnavailableObject({kind:i.e.CellEvaluatingValue}));var r=t.value[1].compiledFmla.getValue();if(!Object(l.c)(r))return r;var n=Object(h.i)(t.value[1].lexicalKind,Object(h.t)(e.sheet,t.value[0])),a=r.value;return this.formatter.evalFormat(Object(w.p)(n),a)},e.prototype.fillInferredFormat=function(e,t){var r=this,n=t,i=t===c.f.Unavailable?Object(l.e)(c.f.Unavailable):this.resolveCellFormat(e.sheet.document,t);if(!Object(l.c)(i)){var a=i.reason;Object(u.i)(e.set,(function(t){var n=Object(h.t)(e.sheet,t);return r.cb.onInferFormatFailure(n,a),!0})),i=Object(l.e)(c.f.Unavailable),n=c.f.Unavailable}var o=i.value;Object(u.g)(e.set,(function(t){var i=Object(h.r)(e.sheet,t),a=r.getEditedFormat(i);if(!Object(l.c)(a))return r.cb.onUnavailableObject(a.reason),!0;if(a.value===c.f.Unavailable)return!0;var s=r.resolveCellFormat(e.sheet.document,a.value);if(!Object(l.c)(s))return r.cb.onInferFormatFailure(i,s.reason),!0;if(Object(j.a)(o===c.f.Unavailable?void 0:o,s.value)){var u=r.setEditedFormat(i,n);Object(l.c)(u)||r.cb.onUnavailableObject(u.reason)}return!0}))},e.prototype.anonymizeFormula=function(e,t){var r,n,i,a=null===(r=t.compiledFmla)||void 0===r?void 0:r.getValue();return void 0!==a&&Object(l.c)(a)?[Object(I.a)(this.config,a.value,e),(n=a.value,i=new J,Object(H.j)(i,n),i.fns)]:[Object(A.a)(t.fmla),[]]},e.prototype.compileFmla=function(e,t,r,n,i){var a=this;return{fmla:i,lexicalKind:t,origin:null!=n?n:r.range,compiledFmla:new R.a((function(){var o=a.parser.parseFormula(Object(O.d)(t,r.range),i),s=e?o:a.autocorrectFormula(Object(S.a)(t,r),o),u=e&&a.isServerWorkbookLoad,l=a.checkFormula(Object(S.a)(t,r,void 0,u),s,i,e?c.c.ServerCellFormula:c.c.EditCellFormula),d=a.adjustFormulaOrigin(l,r,n);return a.compileFormula(Object(y.i)(t,r.range),d)})),hasHyperlink:s.b.ClientValueUnknown}},e.prototype.compileFormula=function(e,t){return Object(l.c)(t)?this.compiler.compileFormula(e,t.value):t},e.prototype.checkFormula=function(e,t,r,n){if(!Object(l.c)(t))return t;var i=this.analyzer.checkFormulaWithDiagnostics(e,t.value);if(!Object(l.c)(i))return i;if(!Object(a.V)(i.value[0])){var o="calc.PartialWorkbook.checkFormula: expected well-formed formula; given "+Object(A.a)(r);return Object(l.b)(Object(y.p)(o,n,Object(S.e)(i.value[1])))}return Object(l.e)(i.value[0])},e.prototype.autocorrectFormula=function(e,t){return Object(l.c)(t)?this.analyzer.autocorrectFormula(e,t.value):t},e.prototype.adjustFormulaOrigin=function(e,t,r){if(!Object(l.c)(e)||void 0===r)return e;var n=Object(L.k)(t);return M(this,n,r,e.value)},e.prototype.compileNumberFormat=function(e,t){var r=this;return new R.a((function(){var n=r.formatter.createFormat(e,t);return Object(l.c)(n)||r.cb.onNumberFormatFailure(n.reason),n}))},e.prototype.compileKnownFormats=function(){var e=this;return Object(o.l)(U.d,(function(t){return e.compileNumberFormat(Object(V.b)(e.config.localeInfo,t),!1)}))},e.prototype.printFormulaBarText=function(e,t,r){return this.printer.printFormula(Object(F.b)(e,Object(h.r)(e.range.sheet,t)),r)},e.prototype.renderValueBarText=function(e,t,r){var n=this.getEditedResolvedFormat(e);return Object(l.c)(n)?this.formatter.renderFormulaBar(e.sheet.document,t,n.value,Object(W.e)(r,"'")):n},e.prototype.formatValueCell=function(e,t){if(Object(a.v)(t))return Object(l.e)(Object(w.u)([],void 0,w.a.Left,w.c.All));var r=this.getEditedResolvedFormat(e);if(!Object(l.c)(r))return r;return this.formatter.applyFormat(r.value,t,!0)},e.prototype.formatValueIformat=function(e,t,r){var n=this.getIformat(e,t);return Object(l.c)(n)?this.formatter.applyFormat(n.value,r,!0):n},e.prototype.formatValueKnownFormat=function(e,t,r){var n=this.getKnownFormat(e,t);return Object(l.c)(n)?this.formatter.applyFormat(n.value,r,!0):n},e.prototype.getEditedResolvedFormat=function(e){var t=this.getEditedFormat(e);return Object(l.c)(t)?t.value===c.f.Unavailable?Object(l.b)(Object(a.Z)([{kind:i.e.CellFormat}])):this.resolveCellFormat(e.sheet.document,t.value):Object(l.b)(Object(a.Z)([t.reason]))},e.prototype.getDocument=function(e){return void 0!==this.documentLoc&&void 0!==this.document&&Object(a.x)(this.documentLoc,e)?Object(l.e)(this.document):Object(l.b)({kind:i.e.DocumentLoc,document:e})},e.prototype.ensureDocument=function(e){return void 0===this.documentLoc&&void 0===this.document&&(this.documentLoc=e,this.document=new m(e,this.config.localeInfo.stringCompareCI,new K(this.compileKnownFormats()),new q.a)),this.getDocument(e)},e.prototype.tryGetCellValues=function(e,t){var r=this,n=Object(h.t)(t,e),o=e.row,s=e.col,u=e.rows,c=e.cols,d=this.getRecalcValues(n);if(d.kind!==l.a.Failure){for(var f=!1,p=0;p<u;p+=1)for(var m=d.value[p],v=0;v<c;v+=1){var g=m[v].failure;void 0!==g&&(this.setCellFailure(Object(h.r)(t,Object(h.f)(o+p,s+v)),g,$),f=!0)}if(!f){var b=function(e){return Object(y.n)(e.oper)},S=d.value.map((function(e){return e.map(b)})),O=this.forEachRecalcDirty(n,(function(e){var n=Object(h.r)(t,e),u=r.getEditedFormula(n);if(u.kind===l.a.Failure)return r.cb.onUnavailableObject(u.reason),!1;if(void 0===u.value)return r.setCellFailure(n,Object(a.Z)([{kind:i.e.CellMissingFormula}]),$),f=!0,!0;var c=u.value,d=c[0],p=c[1];if(void 0===p.compiledFmla)return r.cb.onUnavailableObject({kind:i.e.CellEvaluatingValue}),!1;var m=r.readCompiledFmla(Object(h.t)(t,d),p.compiledFmla);return Object(l.c)(m)?(S[e.row-o][e.col-s]=Object(y.u)(Object(h.r)(t,Object(a.k)(d))),!0):(f=!0,!0)}));if(Object(l.c)(O)){if(O.value&&!f)return S}else this.cb.onUnavailableObject(O.reason)}}else this.cb.onUnavailableObject(d.reason)},e.prototype.tryGetCellValue=function(e,t){var r=this.tryGetCellValues(e,t);return void 0===r?void 0:r[0][0]},e.prototype.makeGetCellValues=function(e){var t=this;return function(r){var n=t.allEditedAvailable(r);if(n.kind===l.a.Failure)return Object(l.b)(Object(a.Z)([n.reason]));if(!0!==n.value)return Object(l.b)(Object(a.Z)([{kind:i.e.GridRange,range:r,unavailableCells:n.value}]));var o=t.hasRecalcFailure(r);if(o.kind===l.a.Failure)return Object(l.b)(Object(a.Z)([o.reason]));if(o.value)return Object(l.b)(Object(y.v)(r));if(Object(a.r)(r.range)>t.maxDereferenceCells)return Object(l.b)(Object(a.Z)([{kind:i.e.GridRangeSize,range:r}]));var s=e(r.range,r.sheet);return void 0===s?Object(l.b)(Object(y.v)(r)):Object(l.e)(s)}},e.prototype.readCompiledFmla=function(e,t){var r=t.getValue();if(Object(l.c)(r))return r;if(this.setCellFailure(e,r.reason,$),r.reason.kind===y.d.Unavailable){r.reason;return r}return Object(l.b)(Object(a.Z)([{kind:i.e.CellFormula,reason:r.reason}]))},e.prototype.getEditedUsedRange=function(e){var t=this.getDocument(e.document);if(t.kind===l.a.Failure)return t;var r=t.value.getEditedUsedRange(e.index);return r.kind===l.a.Failure||void 0===r.value?r:Object(l.e)(Object(h.t)(e,r.value))},e.prototype.getSheetRangeIds=function(e){var t=this.getDocument(e.document);return t.kind===l.a.Failure?Object(l.b)(Object(a.Z)([t.reason])):t.value.getSheetRangeIds(e)},e.prototype.allEditedAvailable=function(e){var t=this.getDocument(e.sheet.document);return t.kind===l.a.Failure?t:t.value.allEditedAvailable(e)},e.prototype.forEachRecalcDirty=function(e,t){var r=this.getDocument(e.sheet.document);return r.kind===l.a.Failure?r:r.value.forEachRecalcDirty(e,t)},e.prototype.hasRecalcDirty=function(e){var t=this.getDocument(e.sheet.document);return t.kind===l.a.Failure?t:t.value.hasRecalcDirty(e)},e.prototype.hasRecalcFailure=function(e){var t=this.getDocument(e.sheet.document);return t.kind===l.a.Failure?t:t.value.hasRecalcFailure(e)},e.prototype.hasEditedEditTaint=function(e){var t=this.getDocument(e.sheet.document);return t.kind===l.a.Failure?t:t.value.hasEditedEditTaint(e)},e.prototype.hasRecalcEditTaint=function(e){var t=this.getDocument(e.sheet.document);return t.kind===l.a.Failure?t:t.value.hasRecalcEditTaint(e)},e.prototype.setEditedFormat=function(e,t){var r=this.getDocument(e.sheet.document);return r.kind===l.a.Failure?r:r.value.setEditedFormat(e,t)},e.prototype.setClientFormat=function(e,t){var r=this.getDocument(e.sheet.document);return r.kind===l.a.Failure?r:r.value.setClientFormat(e,t)},e.prototype.setRecalcFailure=function(e,t){var r=this.getDocument(e.document);return r.kind===l.a.Failure?r:r.value.setRecalcFailure(e.index,t)},e.prototype.testAndSetClientValue=function(e,t){var r=this.getClientValue(e);if(r.kind===l.a.Failure)return r;var n=Object(s.n)(r.value.oper)||!Object(a.J)(this.config.mathpack,r.value.oper,t,!0);if(n){var i=this.setClientValue(e,t);if(i.kind===l.a.Failure)return i}return Object(l.e)(n)},e.prototype.testAndSetClientFormat=function(e,t){var r=this.getClientFormat(e);if(r.kind===l.a.Failure)return r;var n=t!==r.value;if(n){var i=this.setClientFormat(e,t);if(i.kind===l.a.Failure)return i}return Object(l.e)(n)},e.prototype.testAndSetClientFormula=function(e,t,r){var n,i=this.getClientFormula(Object(a.Y)(e));if(i.kind===l.a.Failure)return i;var o=null!==(n=i.value)&&void 0!==n?n:[e.range,s.e],u=o[0],c=o[1],d=Object(a.k)(e.range),f=void 0!==t&&t!==c.fmla||void 0!==c.compiledFmla&&!Object(a.A)(d,c.origin),p=void 0!==r&&r!==c.hasHyperlink;if(f||p){var m=c.compiledFmla,v=this.setClientFormula(Object(h.t)(e.sheet,u),{fmla:null!=t?t:c.fmla,compiledFmla:m,origin:void 0!==t?d:c.origin,hasHyperlink:null!=r?r:c.hasHyperlink});if(v.kind===l.a.Failure)return v}return Object(l.e)({hasFmlaChanged:f,hasHyperlinkChanged:p})},e.prototype.setRecalcEditTaint=function(e,t){var r=this.getDocument(e.document);return r.kind===l.a.Failure?r:r.value.setRecalcEditTaint(e.index,t)},e.prototype.propagateEditTaint=function(e,t){var r=this.hasEditedEditTaint(e);if(r.kind===l.a.Failure)return r;if(r.value)return Object(l.e)(c.b.EditedCell);for(var n=0,i=t.cells;n<i.length;n++){var a,o=i[n],s=this.hasRecalcEditTaint(o);if(s.kind===l.a.Failure)return s;if(s.value)return(a=this.setRecalcEditTaint(e.sheet,Object(u.f)(e.range))).kind===l.a.Failure?a:Object(l.e)(c.b.DependentCell)}return 0!=(t.special&(x.d.Calc|x.d.Time))?(a=this.setRecalcEditTaint(e.sheet,Object(u.f)(e.range))).kind===l.a.Failure?a:Object(l.e)(c.b.DependentCell):t.bound===g.b.Exact||void 0!==this.evalParams&&this.evalParams.computeKind===c.a.EditedCell?Object(l.e)(c.b.IndependentCell):Object(l.e)(c.b.UnknownNonEditedCell)},e.prototype.setClientValue=function(e,t){var r=this.getDocument(e.sheet.document);return r.kind===l.a.Failure?r:r.value.setClientValue(e,t)},e.prototype.setRecalcValue=function(e,t){var r=this.getDocument(e.sheet.document);return r.kind===l.a.Failure?r:r.value.setRecalcValue(e,t)},e.prototype.setClientFormula=function(e,t){var r=this.getDocument(e.sheet.document);return r.kind===l.a.Failure?r:r.value.setClientFormula(e,t)},e.prototype.hasRecalcNameFailure=function(e){var t=this.getDocument(e.scope.document);return t.kind===l.a.Failure?Object(l.b)(Object(a.Z)([t.reason])):t.value.hasRecalcNameFailure(e)},e.prototype.setRecalcNameFailure=function(e){var t=this.getDocument(e.scope.document);return t.kind===l.a.Failure?Object(l.b)(Object(a.Z)([t.reason])):t.value.setRecalcNameFailure(e)},e.prototype.setNameFailure=function(e,t){var r=this.setRecalcNameFailure(e);if(r.kind===l.a.Failure)return this.cb.onUnavailable(r.reason);this.cb.onNameFailure(e,t,this.evalParams)},e}()},function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a})),r.d(t,"c",(function(){return o})),r.d(t,"d",(function(){return s})),r.d(t,"e",(function(){return u}));var n=r(3),i=n.numfmt.Calendar,a=n.numfmt.CurrencyFormat,o=n.numfmt.DateOrder,s=n.numfmt.KnownFormat,u=n.numfmt.NumberShape},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.functionType=t.SpecialPrecs=t.SignatureType=t.OperKind=t.FunctionFlags=void 0;var n=r(3);t.FunctionFlags=n.types.FunctionFlags,t.OperKind=n.types.OperKind,t.SignatureType=n.types.SignatureType,t.SpecialPrecs=n.types.SpecialPrecs,t.functionType=n.types.functionType},function(e,t,r){"use strict";var n={};r.r(n),r.d(n,"getExcelOnlineCalcNewPackagesNames",(function(){return q})),r.d(n,"checkRequest",(function(){return Q})),r.d(n,"ResponseState",(function(){return $}));var i={};r.r(i),r.d(i,"InternalSchedulerResponseKind",(function(){return Y})),r.d(i,"wrapSyncRequest",(function(){return Z})),r.d(i,"wrapRequest",(function(){return X})),r.d(i,"checkSyncRequest",(function(){return te}));var a={};r.r(a),r.d(a,"PrefetchingCache",(function(){return ft}));var o={};r.r(o),r.d(o,"createGridProvider",(function(){return ht})),r.d(o,"createGridImportManager",(function(){return vt})),r.d(o,"createPrefetchingCacheFactory",(function(){return gt})),r.d(o,"timelineQueueProcessorFactory",(function(){return bt})),r.d(o,"createFormulaBarScheduler",(function(){return St})),r.d(o,"createExperimentFormulaBarScheduler",(function(){return yt})),r.d(o,"createDynamicPluginLoader",(function(){return Ot})),r.d(o,"createRecalcSideGrid",(function(){return Ct})),r.d(o,"dynamicPluginLoaderInsideInit",(function(){return xe})),r.d(o,"createIGridFromRecalcService",(function(){return Pt})),r.d(o,"Cache",(function(){return Nt})),r.d(o,"SchedulerMessages",(function(){return Rt})),r.d(o,"PluginMessages",(function(){return kt}));var s={};r.r(s),r.d(s,"createGridProvider",(function(){return ht})),r.d(s,"createGridImportManager",(function(){return vt})),r.d(s,"createPrefetchingCacheFactory",(function(){return gt})),r.d(s,"timelineQueueProcessorFactory",(function(){return bt})),r.d(s,"createFormulaBarScheduler",(function(){return St})),r.d(s,"createExperimentFormulaBarScheduler",(function(){return yt})),r.d(s,"createDynamicPluginLoader",(function(){return Ot})),r.d(s,"createRecalcSideGrid",(function(){return Ct})),r.d(s,"dynamicPluginLoaderInsideInit",(function(){return xe})),r.d(s,"createIGridFromRecalcService",(function(){return Pt})),r.d(s,"Cache",(function(){return Nt})),r.d(s,"SchedulerMessages",(function(){return Rt})),r.d(s,"PluginMessages",(function(){return kt}));var u=r(2),c=r(37),l=r(4),d=r(8),f=r(26),p=r(9),m=r(12),h=r(5),v=r(32),g=r(23),b=r(0),S=r(67),y=r(68),O=r(36),C=r(63),P=r(163),N={runTest:k,runExperiment:k,runAuthoringExperiment:k,formulaHighlighting:function(e){var t;if(e.length>0){for(var r=[],n=0,i=e;n<i.length;n++){var a=i[n],o=(a[0],null===(t=a[1].formulaHighlights)||void 0===t?void 0:t.filter(l.e));void 0!==o&&(r=r.concat(o))}return r.sort(P.a),{formulaHighlights:r}}return null},functionSuggestion:function(e){for(var t=[],r=[],n=0,i=e;n<i.length;n++){var a=i[n],o=a[0],s=a[1];c(o)===O.b.Smart?Object(l.e)(s.items)&&s.items.filter(l.e).filter((function(e){return Object(l.e)(e.textEdit)||Object(l.e)(e.label)})).forEach((function(e){return t.push(Object(u.__assign)(Object(u.__assign)({},e),{type:O.b.Smart}))})):Object(l.e)(s.items)&&s.items.filter(l.e).filter((function(e){return Object(l.e)(e.textEdit)||Object(l.e)(e.label)})).forEach((function(e){return r.push(Object(u.__assign)(Object(u.__assign)({},e),{type:O.b.Simple}))}))}return{items:Object(u.__spreadArray)(Object(u.__spreadArray)([],t,!0),r.sort((function(e,t){if(Object(l.e)(e.label)&&Object(l.e)(t.label)){if(Object(l.e)(e.isPrefixed)&&Object(l.e)(t.isPrefixed)&&e.isPrefixed!==t.isPrefixed)return e.isPrefixed?-1:1;if(R.includes(e.kind)&&R.includes(t.kind)){var r=Object(C.b)(e),n=Object(C.b)(t);if(r!==n)return n-r}return e.label.toLocaleLowerCase()>t.label.toLocaleLowerCase()?1:-1}return Object(l.e)(e.label)?1:Object(l.e)(t.label)?-1:0})),!0)};function c(e){switch(e){case f.c.AutocompletePlugin:case f.c.FormulaRepairPlugin:case f.c.FormulaCollectionPlugin:return O.b.Smart;case f.c.DragPlugin:case f.c.SlowTestPlugin:case f.c.AutocompleteFunctionPlugin:case f.c.AutocompleteLetPlugin:case f.c.AutocompleteRichValuePlugin:case f.c.AutocompleteNamedObjectsPlugin:case f.c.AutocompleteTableHeadersPlugin:return O.b.Simple;default:Object(p.d)("unknown plugin factory name: ".concat(e),e)}}},argumentAssistance:function(e){if(0===e.length)return null;if(1===e.length)return e[0][1];throw new Error("Conflict resolver: argumentAssistance: ".concat(e.length," results received, while only one active plugin is currently supported"))}},R=[O.a.TableHeader,O.a.TableSpecialStructRef];function k(e){for(var t=[],r=0,n=e;r<n.length;r++){var i=n[r],a=(i[0],i[1].results);Object(l.e)(a)&&t.push.apply(t,a.filter(l.e))}return{results:t}}var T,E,_=r(64);!function(e){e.FunctionSuggestionAndArgumentAssistance="FunctionSuggestionAndArgumentAssistance"}(E||(E={}));var F,I=((T={})[E.FunctionSuggestionAndArgumentAssistance]=[h.b.functionSuggestion,h.b.argumentAssistance],T);function A(e){return!(Object(l.e)(e)&&Object(l.e)(e.items)&&e.items.length>0)}Object(l.q)(),Object(l.q)(),Object(l.q)(),Object(l.q)(),Object(l.q)();var M=function(){function e(){this.argumentAssistanceResult=null,this.functionSuggestionResult=null,this.argumentAssistanceSet=!1,this.functionSuggestionSet=!1,this.promise=new _.a}return e.prototype.consumeResult=function(e){var t;switch(e.kind){case h.b.functionSuggestion:if(Object(p.g)("functionSuggestionSet should be false when receiving functionSuggestion request",!this.functionSuggestionSet),Object(l.e)(e.result)&&Object(l.e)(e.result.items)&&e.result.items.length>0&&(null===(t=e.result.items[e.result.items.length-1])||void 0===t?void 0:t.type)===O.b.Simple)return this.promise.resolve({functionSuggestion:e.result,argumentAssistance:null});if(this.argumentAssistanceSet)return null!==this.argumentAssistanceResult?this.promise.resolve({functionSuggestion:null,argumentAssistance:this.argumentAssistanceResult}):A(e.result)?this.promise.resolve({functionSuggestion:null,argumentAssistance:null}):this.promise.resolve({functionSuggestion:e.result,argumentAssistance:null});A(e.result)||(this.functionSuggestionResult=e.result),this.functionSuggestionSet=!0;break;case h.b.argumentAssistance:if(Object(p.g)("argumentAssistanceSet should be false when receiving argumentAssistance request",!this.argumentAssistanceSet),this.functionSuggestionSet)return null!==e.result?this.promise.resolve({functionSuggestion:null,argumentAssistance:e.result}):this.promise.resolve({functionSuggestion:this.functionSuggestionResult,argumentAssistance:null});this.argumentAssistanceResult=e.result,this.argumentAssistanceSet=!0;break;default:Object(p.d)("unknown result: ".concat(e),e)}},e.create=function(){return new e},e}();Object(l.q)();var w=((F={})[E.FunctionSuggestionAndArgumentAssistance]=M,F);Object(l.q)();var D,j=r(164),x=r(122),L=r(35),B=r(7),U=r(3),G=r(20),K=r(22),V=r(25),W=r(282),H="".concat(B.PackageName,", ").concat(U.PackageName,",\n  ").concat(G.PackageName,", ").concat(K.PackageName,", ").concat(V.PackageName,", ").concat(W.PackageName);function q(){return H}var z=((D={})[h.a.GetSheetNames]=!0,D[h.a.GetRange]=!0,D[h.a.Delay]=!0,D[h.a.GetCell]=!0,D[h.a.GetContainingTable]=!0,D[h.a.GetTableHeaders]=!0,D[h.a.GetIntersectingTables]=!0,D[h.a.GetIformat]=!0,D[h.a.ParseCellFormula]=!0,D[h.a.ParseEdit]=!0,D[h.a.ParseActiveCell]=!0,D[h.a.ParseNumberFormat]=!0,D[h.a.PrintFormula]=!0,D[h.a.GetActiveCell]=!0,D[h.a.GetConfig]=!0,D[h.a.AwaitPromise]=!0,D[h.a.GetFunctionsInfo]=!0,D[h.a.GetFunctionInfo]=!0,D[h.a.GetCorrelationId]=!0,D[h.a.SetActiveCell]=!0,D[h.a.GetRichValueFieldListContext]=!0,D[h.a.GetHiddenRows]=!0,D[h.a.GetHiddenCols]=!0,D[h.a.GetDefinedNameInfo]=!0,D[h.a.GetDefinedNamesInfo]=!0,D[h.a.ResolveReferences]=!0,D[h.a.EvalOnClonedModel]=!0,D[h.a.EvalFormula]=!0,D);function Q(e){return!0===z[e.kind]}Object(l.t)(),Object(l.q)(),Object(l.q)();var J,Y,$=function(){function e(e){this.pluginKind=e,this.numPlugins=0,this.numSyncPlugins=0}return Object.defineProperty(e.prototype,"uiMessageFrame",{get:function(){return this._uiMessageFrame},enumerable:!1,configurable:!0}),e.prototype.createUIMessageFrame=function(e,t,r,n){var i=new _.a,a=this.pluginKind;return this._uiMessageFrame={correlationId:e,cache:t,config:r,startTime:n,successfulResults:{kind:a,results:[]},resolvable:i,numFailures:0},i},e.prototype.closeUIMessageFrame=function(e,t){var r,n=this.uiMessageFrame;if(n&&(this._uiMessageFrame=void 0,n.resolvable.resolve("UIMessage"===e?{kind:f.d.Superseded}:{kind:f.d.Done,payload:n.successfulResults}),null===(r=n.cache)||void 0===r||r.close(),this.numPlugins>0)){var i=this.pluginKind,a=this.numPlugins,o=n.correlationId,s=n.startTime,u={correlationId:o,pluginKind:i,numPlugins:a,numSent:n.successfulResults.results.length,stopReason:e,startTime:s,stopTime:t};m.y.ULS.traceTag(553734789,m.c.msoulscat_ES_EWAJS,m.i.Info,"x10arch.ResponseState.closeUIMessageFrame: ".concat(JSON.stringify(u)))}},e.prototype.stop=function(e,t){void 0!==this.uiMessageFrame&&this.closeUIMessageFrame(e,t)},e}();function Z(e,t){switch(e.kind){case h.a.Delay:case h.a.GetActiveCell:case h.a.GetConfig:case h.a.GetCorrelationId:case h.a.GetFunctionInfo:case h.a.GetFunctionsInfo:case h.a.GetDefinedNameInfo:case h.a.GetDefinedNamesInfo:case h.a.SetActiveCell:return{kind:h.c.NoOpRequest,request:e,computation:t};case h.a.GetSheetNames:case h.a.GetTableHeaders:case h.a.ParseCellFormula:case h.a.ParseNumberFormat:case h.a.PrintFormula:case h.a.ParseActiveCell:case h.a.ResolveReferences:return{kind:h.c.SyncRequest,request:e,computation:t};default:Object(p.d)("unknown request: ".concat(e),e)}}function X(e,t){switch(e.kind){case h.a.GetRange:case h.a.GetCell:case h.a.GetContainingTable:case h.a.GetIntersectingTables:case h.a.GetIformat:case h.a.AwaitPromise:case h.a.ParseEdit:case h.a.GetRichValueFieldListContext:case h.a.GetHiddenRows:case h.a.GetHiddenCols:case h.a.EvalOnClonedModel:case h.a.EvalFormula:return{kind:h.c.AsyncRequest,request:e,computation:t};default:return Z(e,t)}}!function(e){e[e.FirstStep=0]="FirstStep",e[e.NormalResponse=1]="NormalResponse",e[e.RequestFailure=2]="RequestFailure",e[e.AsyncException=3]="AsyncException"}(Y||(Y={})),Object(l.q)(),Object(l.q)(),Object(l.q)(),Object(l.q)();var ee=((J={})[h.a.Delay]=!0,J[h.a.ParseCellFormula]=!0,J[h.a.ParseActiveCell]=!0,J[h.a.ParseNumberFormat]=!0,J[h.a.PrintFormula]=!0,J[h.a.GetActiveCell]=!0,J[h.a.GetSheetNames]=!0,J[h.a.GetConfig]=!0,J[h.a.GetFunctionsInfo]=!0,J[h.a.GetFunctionInfo]=!0,J[h.a.GetDefinedNamesInfo]=!0,J[h.a.GetDefinedNameInfo]=!0,J[h.a.GetCorrelationId]=!0,J[h.a.GetTableHeaders]=!0,J[h.a.SetActiveCell]=!0,J[h.a.ResolveReferences]=!0,J);function te(e){return!0===ee[e.kind]}Object(l.t)();var re,ne=r(100),ie=r(94),ae=((re={})[h.a.Delay]=function(){return Object(b.e)({})},re[h.a.AwaitPromise]=function(e){var t=e.request.promise;return Object(u.__awaiter)(void 0,void 0,void 0,(function(){var e,r;return Object(u.__generator)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,t];case 1:return e=n.sent(),[2,Object(b.e)({result:e})];case 2:return r=n.sent(),[2,Object(b.b)(r)];case 3:return[2]}}))}))},re[h.a.GetCell]=function(e){var t=e.request.cell,r=e.cache;return Object(u.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(u.__generator)(this,(function(n){switch(n.label){case 0:return void 0===r?[2,Object(b.b)(void 0)]:[4,r.getCell(t)];case 1:return e=n.sent(),[2,Object(b.e)({result:e})]}}))}))},re[h.a.GetContainingTable]=function(e){var t=e.request.cell,r=e.cache;return Object(u.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(u.__generator)(this,(function(n){switch(n.label){case 0:return void 0===r?[2,Object(b.b)(void 0)]:[4,r.getContainingTable(t)];case 1:return e=n.sent(),[2,Object(b.e)({result:e})]}}))}))},re[h.a.GetTableHeaders]=function(e){var t=e.request.tableName,r=e.cache;if(void 0===r)return Object(b.b)(void 0);var n=r.getTableHeaders(t);return Object(b.e)({result:n})},re[h.a.GetIntersectingTables]=function(e){var t=e.request.range,r=e.cache;return Object(u.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(u.__generator)(this,(function(n){switch(n.label){case 0:return void 0===r?[2,Object(b.b)(void 0)]:[4,r.getIntersectingTables(t)];case 1:return e=n.sent(),[2,Object(b.e)({result:e})]}}))}))},re[h.a.GetRange]=function(e){var t=e.request,r=t.range,n=t.layers,i=e.cache;return Object(u.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(u.__generator)(this,(function(t){switch(t.label){case 0:return void 0===i?[2,Object(b.b)(void 0)]:[4,i.getRange(r,n)];case 1:return e=t.sent(),[2,Object(b.e)({localSheetGrid:e})]}}))}))},re[h.a.GetSheetNames]=function(e){var t=e.cache;return void 0===t?Object(b.b)(void 0):t.getSheetNames()},re[h.a.GetIformat]=function(e){var t=e.request,r=t.document,n=t.iformat,i=e.cache;return Object(u.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(u.__generator)(this,(function(t){switch(t.label){case 0:return void 0===i?[2,Object(b.b)(void 0)]:[4,i.getIformat(r,n)];case 1:return e=t.sent(),[2,Object(b.e)({result:e})]}}))}))},re[h.a.ParseCellFormula]=function(e){var t=e.request,r=t.cell,n=t.formula,i=t.useEnglishLocaleInfo,a=e.cache;return void 0===a?Object(b.b)(void 0):Object(b.e)(a.parseCellFormula(r,n,i))},re[h.a.ParseEdit]=function(e){var t=e.request,r=t.cell,n=t.formulaBarText,i=e.cache;return Object(u.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(u.__generator)(this,(function(t){switch(t.label){case 0:return void 0===i?[2,Object(b.b)(void 0)]:(e=b.e,[4,i.parseEdit(r,n)]);case 1:return[2,e.apply(void 0,[t.sent()])]}}))}))},re[h.a.ParseActiveCell]=function(e){var t=e.request.formulaText,r=e.schedulerState,n=r.activeCell,i=r.activeCellFormat,a=e.cache;return void 0===a||Object(l.f)(n)||Object(l.f)(i)?Object(b.b)(void 0):Object(b.e)(a.parseEditSync(n,t,i))},re[h.a.ParseNumberFormat]=function(e){var t=e.request,r=t.formatString,n=t.builtIn,i=e.cache;return void 0===i?Object(b.b)(void 0):Object(b.e)(i.parseNumberFormat(r,n))},re[h.a.PrintFormula]=function(e){var t=e.request,r=t.formula,n=t.origin,i=e.config;if(void 0===i)return Object(b.b)([]);var a=Object(ne.b)(Object(ie.a)(i)).printFormula(Object(ie.b)(Object(d.i)(d.a.Cell,n),n),r);return Object(b.e)({result:a})},re[h.a.GetActiveCell]=function(e){var t=e.schedulerState.activeCell;return void 0===t?Object(b.b)(void 0):Object(b.e)({activeCell:t})},re[h.a.GetConfig]=function(e){var t=e.config;return void 0===t?Object(b.b)(void 0):Object(b.e)({config:t})},re[h.a.GetFunctionsInfo]=function(e){var t=e.schedulerState.functionsInfoMap;if(void 0===t)return Object(b.b)(void 0);var r=Object.keys(t).map((function(e){return t[e]}));return Object(b.e)({functionsInfo:r})},re[h.a.GetFunctionInfo]=function(e){var t=e.request.functionName,r=e.schedulerState;if(void 0===r.functionsInfoMap)return Object(b.b)(void 0);var n=r.functionsInfoMap[t.toUpperCase()];return void 0===n?Object(b.b)(void 0):Object(b.e)({functionInfo:n})},re[h.a.GetDefinedNamesInfo]=function(e){var t=e.schedulerState.definedNamesInfoMap;if(void 0===t)return Object(b.b)(void 0);var r=Object.keys(t).map((function(e){return t[e]}));return Object(b.e)({definedNamesInfo:r})},re[h.a.GetDefinedNameInfo]=function(e){var t=e.request.definedName,r=e.schedulerState;if(void 0===r.definedNamesInfoMap)return Object(b.b)(void 0);var n=r.definedNamesInfoMap[t.toUpperCase()];return Object(b.e)({definedNameInfo:n})},re[h.a.EvalOnClonedModel]=function(e){var t=e.cache,r=e.request;return Object(u.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(u.__generator)(this,(function(n){switch(n.label){case 0:return[4,null==t?void 0:t.evalOnClonedModel(r.updates,r.edits)];case 1:return void 0===(e=n.sent())||e.kind!==b.a.Success?[2,Object(b.b)(void 0)]:[2,Object(b.e)({result:e.value})]}}))}))},re[h.a.EvalFormula]=function(e){var t=e.cache,r=e.request;return Object(u.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(u.__generator)(this,(function(n){switch(n.label){case 0:return[4,null==t?void 0:t.evalFormula(r.formula,r.origin)];case 1:return void 0===(e=n.sent())||e.kind!==b.a.Success?[2,Object(b.b)(void 0)]:[2,Object(b.e)({result:e.value})]}}))}))},re[h.a.GetCorrelationId]=function(e){var t=e.correlationId;return Object(b.e)({correlationId:t})},re[h.a.SetActiveCell]=function(e){return e.schedulerState=Object(u.__assign)(Object(u.__assign)({},e.schedulerState),{activeCell:e.request.activeCell,activeCellFormat:e.request.activeCellFormat}),Object(b.e)({})},re[h.a.GetRichValueFieldListContext]=function(e){var t=e.schedulerState,r=e.request,n=r.rangeToQuery,i=r.dotNotationPath,a=r.singleColumn,o=r.findRange;return Object(u.__awaiter)(void 0,void 0,void 0,(function(){var e,r;return Object(u.__generator)(this,(function(s){switch(s.label){case 0:return e=t.serverDataProvider,Object(l.f)(e)?[2,Object(b.b)(void 0)]:[4,e.getRichValueFieldListContext(n,i,a,o)];case 1:return r=s.sent(),Object(l.f)(r)?[2,Object(b.b)(void 0)]:[2,Object(b.e)({result:r.filter(l.e)})]}}))}))},re[h.a.GetHiddenRows]=function(e){var t=e.cache,r=e.request;return Object(u.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(u.__generator)(this,(function(n){switch(n.label){case 0:return void 0===t?[2,Object(b.b)([])]:[4,t.getHiddenRows(r.sheet,r.start,r.endExclusive)];case 1:return e=n.sent(),[2,Object(b.e)({result:e})]}}))}))},re[h.a.GetHiddenCols]=function(e){var t=e.cache,r=e.request;return Object(u.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(u.__generator)(this,(function(n){switch(n.label){case 0:return void 0===t?[2,Object(b.b)([])]:[4,t.getHiddenCols(r.sheet,r.start,r.endExclusive)];case 1:return e=n.sent(),[2,Object(b.e)({result:e})]}}))}))},re[h.a.ResolveReferences]=function(e){var t=e.cache,r=e.request,n=r.locals,i=r.nodes;if(void 0===t||void 0===n||void 0===i)return Object(b.b)(void 0);var a=t.resolveReferences(n,i);return Object(b.e)({resolverResults:a})},re);function oe(e,t,r,n,i){var a={request:t,correlationId:r.info.correlationId,cache:n,config:i,schedulerState:r.schedulerState},o=(0,e[t.kind])(a);return o.kind!==b.a.Success?Object(b.b)(void 0):(r.schedulerState=a.schedulerState,Object(b.e)(Object(u.__assign)({kind:t.kind},o.value)))}var se,ue=r(99),ce=r(29),le=r(123),de=r(31),fe=r(15),pe=r(161),me=r(167),he=r(6),ve=function(){},ge=function(){function e(){this.dataTransformer=new le.a,this.stateId=-1/0,this.stateChangesSinceLastGC=0,this.config=this.dataTransformer.getLangConfig(),this.configNotifications=[],this.sheets=new pe.a(this.dataTransformer.document,this.config.localeInfo.stringCompareCI),this.nameManager=new me.a(this.dataTransformer.document,this.config.localeInfo.stringCompareCI)}return Object.defineProperty(e.prototype,"document",{get:function(){return this.dataTransformer.document},enumerable:!1,configurable:!0}),e.prototype.getStateAsNotifications=function(){return Object(u.__spreadArray)(Object(u.__spreadArray)(Object(u.__spreadArray)([],this.configNotifications,!0),this.getSheetStateAsNotifications(),!0),this.getNameStateAsNotifications(),!0)},e.prototype.getSheetStateAsNotifications=function(){var e=[];return this.sheets.forEachSheet((function(t,r){e.push(Object(fe.fb)(r,t.name))})),e.length>0?[[v.a.updateSheetNames,[this.stateId,e]]]:[]},e.prototype.getNameStateAsNotifications=function(){var e=this,t=[],r=function(r){var n=[];r.forEachAvailableName((function(t,r){var i=Object(de.i)(e.config.mathpack,e.dataTransformer.document,null==r?void 0:r.obj);return n.push(Object(fe.J)(t,i)),!0})),n.length>0&&t.push(Object(fe.M)(r.scope.index,n)),r.allAvailable()&&t.push(Object(fe.hb)(r.scope.index))},n=this.nameManager.getNamesBySheetId(void 0);return Object(b.c)(n)&&r(n.value),this.nameManager.forEachSheetScope((function(e){r(e)})),t.length>0?[[v.a.updateNamedObjects,[this.stateId,t]]]:[]},e.prototype.trySetStateId=function(e,t){if(t<this.stateId)return!1;if(t>this.stateId){var r=this.stateId;if(this.stateId=t,this.sheets.advanceState(r),this.nameManager.advanceState(r),this.stateChangesSinceLastGC+=1,this.stateChangesSinceLastGC>=17){this.stateChangesSinceLastGC=0;var n=this.stateId-17;this.nameManager.collectGarbage(n)}}return!0},e.prototype.clearCompiledFormulas=function(){this.nameManager.resetLazyData()},e.prototype.clearCompiledNumberFormats=function(){},e.prototype.setA1ReferenceStyle=function(e){this.configNotifications.push([v.a.setA1ReferenceStyle,[e]]),this.dataTransformer.setA1ReferenceStyle(this,this.stateId,e)},e.prototype.setLocale=function(e){this.configNotifications.push([v.a.setLocale,[e]]);this.dataTransformer.setLocaleInfo(this,this.stateId,e,{})},e.prototype.setWorkbookProps=function(e){this.configNotifications.push([v.a.setWorkbookProps,[e]]);this.dataTransformer.setWorkbookProps(this,this.stateId,e,{})},e.prototype.updateSheetNames=function(e,t){this.dataTransformer.updateSheetNames(this,e,t,{})},e.prototype.updateNamedObjects=function(e,t){this.dataTransformer.updateNamedObjects(this,e,t,{})},e.prototype.setLangConfig=function(e,t){if(this.trySetStateId(!0,e)){var r=this.config.localeInfo!==t.localeInfo,n=this.config.refStyle!==t.refStyle;this.config=t,r&&this.clearCompiledNumberFormats(),(r||n)&&this.clearCompiledFormulas()}},e.prototype.setSheetNames=function(e,t,r){this.trySetStateId(!0,r)&&(this.sheets=this.sheets.setSheetNames(t),this.nameManager=this.nameManager.setSheetNames(t))},e.prototype.writeNamedObject=function(e,t,r,n){if(this.trySetStateId(!0,e)){var i=this.nameManager.setNamedObject(!0,Object(d.n)(t,r),n,ve);Object(b.c)(i)}},e.prototype.writeUndefinedNames=function(e,t){if(this.trySetStateId(!0,e)){var r=this.nameManager.setUndefinedNames(t);Object(b.c)(r)}},e.prototype.promoteNamedObjects=function(e,t,r){if(this.trySetStateId(!0,e)){var n=this.nameManager.promoteNamedObjects(t,r);Object(b.c)(n)&&n.value}},e.prototype.getDocumentLoc=function(e,t){var r=this.dataTransformer.document;return void 0!==e&&e!==r.path||0!==this.config.localeInfo.stringCompareCI(t,r.name)?Object(b.b)(Object(he.Z)([Object(d.d)(e,t)])):Object(b.e)(r)},e.prototype.getSheetIndex=function(e,t){var r=this.sheets.getSheetByName(t);return Object(b.c)(r)?void 0===r.value?r:Object(b.e)(r.value.sheetIndex.index):r},e.prototype.getSheetName=function(e,t){var r=this.sheets.getSheetById(t);return Object(b.c)(r)?Object(b.e)(r.value.name):r},e.prototype.getNameLoc=function(e,t,r){return this.nameManager.getNameLoc(e.index,t,r)},e.prototype.getUserDefinedFuncLoc=function(e,t){return Object(b.b)(Object(he.X)(["call UDF"]))},e.prototype.getSheetRangeIndexes=function(e){return this.sheets.getSheetRangeIds(e)},e.prototype.getContainingTable=function(e){return this.nameManager.getContainingTable(e)},e.prototype.getStructRefColumn=function(e,t){return this.nameManager.getStructRefColumn(e,t)},e.prototype.getStructRefSpecialRef=function(e,t){return this.nameManager.getStructRefSpecialRef(e,t)},e.prototype.getTime=function(){return Object(b.b)(Object(he.Z)(["getTime"]))},e}(),be=r(124),Se=function(){function e(){this.current=0}return e.prototype.create=function(){return this.current+=1},e}(),ye=function(){function e(){this.subscribers=[]}return e.prototype.next=function(e){for(var t=0,r=this.subscribers;t<r.length;t++){(0,r[t])(e)}},e.prototype.subscribe=function(e){this.subscribers.push(e)},e}(),Oe=function(e){function t(t){var r=e.call(this)||this;return r.initializeSubscriber=t,r}return Object(u.__extends)(t,e),t.prototype.subscribe=function(t){e.prototype.subscribe.call(this,t),this.initializeSubscriber().map(t)},t}(ye),Ce={kind:"RequestFailure"},Pe={kind:Y.FirstStep},Ne=function(){function e(e,t,r,n,i){var a;void 0===r&&(r=Object(u.__assign)({},j.a)),void 0===n&&(n=S.b);var o,s=this;this.createPrefetchingCache=t,this.pluginResultWindows=r,this.timer=n,this.parent=i,this.responseStates=Object(l.i)(Object(l.u)(h.b).map((function(e){return[e,new $(e)]}))),this.uiMessages=Object(l.i)(Object(l.u)(h.b).map((function(e){return[e,new ye]}))),this.syncUIMessages=Object(l.i)(Object(l.u)(h.b).map((function(e){return[e,new ye]}))),this.syncMessageQueue=new ue.a((function(){return 0})),this.doNotifyStatelessSubject=new ye,this.doNotifyStatefulSubject=new Oe((function(){return s.syncDataModel.getStateAsNotifications()})),this.requestWithCorrelationIdSubject=new ye,this.syncDataModel=new ge,this.idFactory=new Se,this.state={activeCell:void 0,activeCellFormat:void 0,asyncGrid:void 0,definedNamesInfoMap:void 0,functionsInfoMap:void 0,serverDataProvider:void 0},this.notificationProcessorMap=((a={})[v.a.setActiveCell]=this.setActiveCellImpl.bind(this),a[v.a.setA1ReferenceStyle]=this.syncDataModel.setA1ReferenceStyle.bind(this.syncDataModel),a[v.a.setLocale]=this.syncDataModel.setLocale.bind(this.syncDataModel),a[v.a.setWorkbookProps]=this.syncDataModel.setWorkbookProps.bind(this.syncDataModel),a[v.a.updateSheetNames]=this.syncDataModel.updateSheetNames.bind(this.syncDataModel),a[v.a.updateNamedObjects]=this.syncDataModel.updateNamedObjects.bind(this.syncDataModel),a[v.a.doNothing]=function(){},a[v.a.setFunctionsInfo]=this.setFunctionInfo.bind(this),a[v.a.conflictResolverEarlyTermination]=function(e,t){return s.stopPlugins(e,t,"ConflictResolverEarlyTermination")},a[v.a.setDefinedNamesInfo]=this.setDefinedNamesInfo.bind(this),a),this.notifierObject=Object(h.k)(this),this.requesterObject=Object(h.l)(this),this.syncRequesterObject=Object(h.m)(this),this.batchRequesterObject=(o=this,{functionSuggestionAndArgumentAssistance:function(e){if(Object(l.f)(e))return Promise.resolve(null);var t=e.functionSuggestion,r=e.argumentAssistance;return Object(l.f)(t)||Object(l.f)(r)?Promise.resolve(null):o.doBatchRequest({strategy:E.FunctionSuggestionAndArgumentAssistance,functionSuggestion:t,argumentAssistance:r})}}),this.logThreshold=Object(c.b)("Microsoft.Office.Excel.x10SetActiveCellImplLogThreshold"),this.recalcServiceAttachedPromise=new _.a,this.activeCellInitializedPromise_DEPRECATED=new _.a,this.totalPluginCount=0,this.warmupParse=Object(ce.b)((function(){return Object(u.__awaiter)(s,void 0,void 0,(function(){var e,t,r;return Object(u.__generator)(this,(function(n){return(e=this.createPrefetchingCache(this.syncDataModel,-1))&&(t=Object(d.d)(void 0,""),r=Object(d.r)(Object(d.u)(t,0),Object(d.f)(1,1)),e.parseEditSync(r,"=sum(5,7)",{formatString:"'GENERAL",builtIn:!0})),[2]}))}))})),p.h.ULS.traceTag(537796811,m.c.msoulscat_ES_EWAJS,m.i.Info,"x10arch.excelOnlineCalcPackages:  ".concat(kt.getExcelOnlineCalcNewPackagesNames())),this.processor=e(this.consumeMessage.bind(this)),this.avoidUsingActiveCellPromise=Object(c.b)("Microsoft.Office.Excel.x10AvoidUsingActiveCellPromise"),this.isSetActiveCellImplNoSpreadEnabled=Object(c.b)("Microsoft.Office.Excel.x10SetActiveCellImplNoSpread"),this.isSetActiveCellImplTimingEnabled=Object(c.b)("Microsoft.Office.Excel.x10SetActiveCellImplTiming"),this.IsMockSetActiveCellImplEperimentEnabled=Object(c.b)("Microsoft.Office.Excel.MockSetActiveCell")===f.b.MockSetActiveCellImpl,this.setActiveCellTimeline=new be.a("setActiveCellImpl",this.logThreshold,this.isSetActiveCellImplTimingEnabled)}return e.prototype.setFunctionInfo=function(e){if(!Object(l.f)(e)){for(var t={},r=0,n=e;r<n.length;r++){var i=n[r];Object(l.e)(i)&&(t[i.NameDataStrings]=i)}this.state=Object(u.__assign)(Object(u.__assign)({},this.state),{functionsInfoMap:t})}},e.prototype.setDefinedNamesInfo=function(e){if(!Object(l.f)(e)){for(var t={},r=0,n=e;r<n.length;r++){var i=n[r];Object(l.e)(i)&&Object(l.e)(i.name)&&(t[i.name.toUpperCase()]=i)}this.state=Object(u.__assign)(Object(u.__assign)({},this.state),{definedNamesInfoMap:t})}},e.prototype.getPluginResponseWindows=function(){return this.pluginResultWindows},e.prototype.setPluginResponseWindow=function(e,t,r){this.pluginResultWindows[e]={startDelta:t,stopDelta:r}},e.prototype.consumeMessage=function(e){switch(e.kind){case h.c.StepPlugin:this.stepPlugin(e.computation,e.payload);break;case h.c.NoOpRequest:case h.c.SyncRequest:case h.c.AsyncRequest:var t=this.timer.now();this.processRequest(e.computation,e.request),e.computation.info.schedulerTime+=this.timer.now()-t;break;case h.c.StopPlugins:this.stopPlugins(e.correlationId,e.pluginKind,"Timeout");break;default:Object(p.d)("unknown message: ".concat(e),e)}},e.prototype.enqueueMessage=function(t,r){var n=e.abstractStepCosts[t.kind];this.processor.enqueue(t,n,r)},e.prototype.stepPlugin=function(e,t){var r=this.responseStates[e.info.pluginKind].uiMessageFrame;if(e.info.correlationId===(null==r?void 0:r.correlationId))try{var n=this.timer.now(),i=Re(e.generator,t);if(e.info.pluginTime+=this.timer.now()-n,!0!==i.done){var a=i.value;this.enqueueMessage(X(a,e))}else p.h.ULS.traceTag(553734790,m.c.msoulscat_ES_EWAJS,m.i.Info,"x10arch.stepPlugin: plugin completed in time. ".concat(JSON.stringify(e.info))),this.addResult(e.info.pluginFactoryName,Object(b.e)(i.value))}catch(t){this.addResult(e.info.pluginFactoryName,Object(b.b)(void 0)),p.h.ULS.traceTag(553734791,m.c.msoulscat_ES_EWAJS,m.i.Warning,"x10arch.stepPlugin: plugin threw exception: ".concat(t," during computation. ").concat(JSON.stringify(e.info)))}},e.prototype.addResult=function(e,t){var r,n,i=g.c[e],a=this.responseStates[i].uiMessageFrame;void 0!==a&&(this.parent&&this.parent.addResult(e,t),t.kind===b.a.Success?(r=a.successfulResults.results.push([e,t.value]),n=a.numFailures):(r=a.successfulResults.results.length,n=a.numFailures+=1),r+n===this.responseStates[i].numPlugins&&this.stopPlugins(a.correlationId,i,"Done"))},e.prototype.processRequest=function(e,t){var r,n,i=this,a=this.responseStates[e.info.pluginKind],o=a.uiMessageFrame;if(e.info.correlationId===(null==o?void 0:o.correlationId)){var s=this.timer.now(),c=function(e,t,r,n,i){var a=r.info.correlationId,o=r.schedulerState,s=e[t.kind],c={request:t,correlationId:a,cache:n,config:i,schedulerState:o},l=s(c);return Object(y.a)(l,(function(e){return e.kind!==b.a.Success?Object(b.b)(void 0):(r.schedulerState=c.schedulerState,Object(b.e)(Object(u.__assign)({kind:t.kind},e.value)))}))}(ae,t,e,null===(r=a.uiMessageFrame)||void 0===r?void 0:r.cache,null===(n=a.uiMessageFrame)||void 0===n?void 0:n.config);Object(y.a)(c,(function(r){if(i.addProcessingTime(e,t.kind,s),r.kind!==b.a.Success)return i.enqueueMessage({kind:h.c.StepPlugin,computation:e,payload:{kind:Y.RequestFailure}}),void p.h.ULS.traceTag(538788238,m.c.msoulscat_ES_EWAJS,m.i.Warning,"x10arch.processRequest: request returned a scheduler-side failure: ".concat(JSON.stringify(Object(u.__assign)(Object(u.__assign)({},e.info),{failedRequest:t.kind}))));i.enqueueMessage({kind:h.c.StepPlugin,computation:e,payload:{kind:Y.NormalResponse,response:r.value}})}),(function(r){i.addProcessingTime(e,t.kind,s),i.enqueueMessage({kind:h.c.StepPlugin,computation:e,payload:{kind:Y.AsyncException,error:r}}),p.h.ULS.traceTag(540611209,m.c.msoulscat_ES_EWAJS,m.i.Warning,"x10arch.processRequest: request processor threw ".concat(JSON.stringify(Object(u.__assign)(Object(u.__assign)({},e.info),{failedRequest:t.kind,error:Object(L.c)(r)}))))}))}},e.prototype.addProcessingTime=function(e,t,r){var n=this.timer.now(),i=e.info.requestTimes[t];return i?(i.requestDuration=i.requestDuration+n-r,i.timeSinceLastRequest=n-e.lastTimestamp):e.info.requestTimes[t]={requestDuration:n-r,timeSinceLastRequest:n-e.lastTimestamp},e.lastTimestamp=n,n},e.prototype.stopPlugins=function(e,t,r){var n,i=this.responseStates[t];e===(null===(n=i.uiMessageFrame)||void 0===n?void 0:n.correlationId)&&i.stop(r,this.timer.now())},e.prototype.recalcServiceAttached=function(){return this.recalcServiceAttachedPromise.toPromise()},e.prototype.activeCellInitialized=function(){return this.activeCellInitializedPromise_DEPRECATED.toPromise()},e.prototype.getFunctionsShortDescriptions=function(){return x.b.getValue()},e.prototype.doNotify=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=t[0],i=t[1];switch((e=this.notificationProcessorMap)[n].apply(e,i),n){case v.a.setA1ReferenceStyle:case v.a.setLocale:case v.a.setWorkbookProps:case v.a.updateSheetNames:case v.a.updateNamedObjects:this.doNotifyStatefulSubject.next(t);break;default:this.doNotifyStatelessSubject.next(t)}},e.prototype.requestWithCorrelationId=function(e,t,r){var n=this.timer.now(),i=this.responseStates[e];i.closeUIMessageFrame("UIMessage",n);var a=this.createPrefetchingCache(this.syncDataModel,r),o=i.createUIMessageFrame(r,a,this.syncDataModel.config,n);return p.h.ULS.traceTag(553734792,m.c.msoulscat_ES_EWAJS,m.i.Info,"x10arch.FormulaBarScheduler.request: ".concat(JSON.stringify({correlationId:r,requestKind:e}))),this.uiMessages[e].next(t),this.enqueueMessage({kind:h.c.StopPlugins,correlationId:r,pluginKind:e},n+this.pluginResultWindows[e].stopDelta),this.requestWithCorrelationIdSubject.next([e,t,r]),o},e.prototype.syncRequestWithCorrelationId=function(e,t,r){var n=this.timer.now(),i=this.createPrefetchingCache(this.syncDataModel,r);p.h.ULS.traceTag(538581025,m.c.msoulscat_ES_EWAJS,m.i.Info,"x10arch.FormulaBarScheduler.syncRequest: ".concat(JSON.stringify({correlationId:r,requestKind:e}))),this.syncUIMessages[e].next([t,r]);var a=n+this.pluginResultWindows[e].stopDelta,o=this.runToCompletion(i,this.syncDataModel.config,a),s=o[0],u=o[1],c={startTime:n,stopTime:this.timer.now(),pluginKind:e,correlationId:r,numPlugins:this.responseStates[e].numSyncPlugins,numSent:u.length,stopReason:s};return p.h.ULS.traceTag(538581026,m.c.msoulscat_ES_EWAJS,m.i.Info,"x10arch.FormulaBarScheduler.syncRequestWithCorrelationId: ".concat(JSON.stringify(c))),{kind:e,results:u}},e.prototype.runToCompletion=function(e,t,r){for(var n=[],i=this.timer.now(),a=this.syncMessageQueue.pop();void 0!==a&&i<r;a=this.syncMessageQueue.pop(),i=this.timer.now()){var o=void 0;switch(a.kind){case h.c.StepPlugin:var s=a.computation,c=a.payload;try{var l=Re(s.generator,c);if(s.info.pluginTime+=this.timer.now()-i,!0!==l.done){var d=l.value;this.syncMessageQueue.enqueue(Z(d,s))}else p.h.ULS.traceTag(538581027,m.c.msoulscat_ES_EWAJS,m.i.Info,"x10arch.FormulaBarScheduler.runToCompletion: plugin completed in time. ".concat(JSON.stringify(s.info))),n.push([s.info.pluginFactoryName,l.value])}catch(e){p.h.ULS.traceTag(538581056,m.c.msoulscat_ES_EWAJS,m.i.Warning,"x10arch.FormulaBarScheduler.runToCompletion: plugin threw exception during computation. ".concat(JSON.stringify(s.info)))}break;case h.c.NoOpRequest:case h.c.SyncRequest:var f=oe(ae,a.request,a.computation,e,t);o=this.addProcessingTime(a.computation,a.request.kind,i),a.computation.info.schedulerTime+=o-i,f.kind===b.a.Success?this.syncMessageQueue.enqueue({kind:h.c.StepPlugin,computation:a.computation,payload:{kind:Y.NormalResponse,response:f.value}}):(p.h.ULS.traceTag(538469328,m.c.msoulscat_ES_EWAJS,m.i.Warning,"x10arch.FormulaBarScheduler.runToCompletion: request returned a scheduler-side failure: ".concat(JSON.stringify(Object(u.__assign)(Object(u.__assign)({},a.computation.info),{failedRequest:a.request.kind})))),this.syncMessageQueue.enqueue({kind:h.c.StepPlugin,computation:a.computation,payload:{kind:Y.RequestFailure}}));break;default:Object(p.d)("unknown message: ".concat(a),a)}}return this.syncMessageQueue.clear(),[i<r?"Done":"Timeout",n]},e.prototype.doRequest=function(e,t){return this.doRequestUntyped(e,t)},e.prototype.doRequestUntyped=function(e,t){return Object(u.__awaiter)(this,void 0,void 0,(function(){var r,n,i;return Object(u.__generator)(this,(function(a){switch(a.label){case 0:return 0===this.responseStates[e].numPlugins?(p.h.ULS.traceTag(553734793,m.c.msoulscat_ES_EWAJS,m.i.Info,"x10arch.FormulaBarScheduler.doRequest: no plugins attached"),(r=new _.a).resolve({kind:f.d.Done,payload:{kind:e,results:[]}})):(n=this.idFactory.create(),r=this.requestWithCorrelationId(e,t,n)),[4,this.resolveConflicts(r)];case 1:return(i=a.sent()).kind===f.d.Superseded?[2,i]:[2,Object(u.__assign)(Object(u.__assign)({},i),{payload:i.payload.result})]}}))}))},e.prototype.doSyncRequest=function(e,t){return this.doSyncRequestUntyped(e,t)},e.prototype.doSyncRequestUntyped=function(e,t){var r;if(0===this.responseStates[e].numSyncPlugins)p.h.ULS.traceTag(538581057,m.c.msoulscat_ES_EWAJS,m.i.Info,"x10arch.FormulaBarScheduler.doSyncRequest: no plugins attached"),r={kind:e,results:[]};else{var n=this.idFactory.create();r=this.syncRequestWithCorrelationId(e,t,n)}return this.syncResolveConflicts(r).result},e.prototype.resolveConflicts=function(e){return Object(u.__awaiter)(this,void 0,void 0,(function(){var t;return Object(u.__generator)(this,(function(r){switch(r.label){case 0:return[4,e];case 1:return(t=r.sent()).kind===f.d.Superseded?[2,t]:[2,{kind:f.d.Done,payload:this.syncResolveConflicts(t.payload)}]}}))}))},e.prototype.syncResolveConflicts=function(e){var t=e.results.filter((function(e){var t=e[1];return Object(l.e)(t)}));return{kind:e.kind,result:N[e.kind](t)}},e.prototype.doBatchRequest=function(e){return Object(u.__awaiter)(this,void 0,void 0,(function(){var t,r,n,i,a,o,s,c,l,d,h;return Object(u.__generator)(this,(function(u){switch(u.label){case 0:for(t=this.idFactory.create(),r=I[e.strategy],n=w[e.strategy].create(),i=r.map((function(){return!0})),a=new _.a,o=function(o){var u=r[o],c=e[u],l=s.requestWithCorrelationId(u,c,t);s.resolveConflicts(l).then((function(e){if(i[o]=!1,e.kind===f.d.Superseded)a.resolve({kind:f.d.Superseded});else{var t=e.payload;n.consumeResult(t)}}),(function(){p.h.ULS.traceTag(553734794,m.c.msoulscat_ES_EWAJS,m.i.Error,'x10arch.doBatchRequest: Custom conflict resolver "'.concat(e.strategy,'" got an exception for plugin kind "').concat(u,'". Skipping kind.')),i[o]=!1,n.consumeResult({kind:u,result:null})}))},s=this,d=0;d<r.length;d+=1)o(d);return c=Object(y.a)(n.promise,(function(e){return{kind:f.d.Done,payload:e}})),[4,Promise.race([a,c])];case 1:for(l=u.sent(),d=0;d<r.length;d+=1)h=r[d],i[d]&&this.doNotify(v.a.conflictResolverEarlyTermination,[t,h]);return[2,l]}}))}))},e.prototype.notifier=function(){return this.notifierObject},e.prototype.requester=function(){return this.requesterObject},e.prototype.syncRequester=function(){return this.syncRequesterObject},e.prototype.batchRequester=function(){return this.batchRequesterObject},e.prototype.setServerDataProvider=function(e){Object(l.f)(e)||(this.state=Object(u.__assign)(Object(u.__assign)({},this.state),{serverDataProvider:e}))},e.prototype.setActiveCellImpl=function(e){if(!this.IsMockSetActiveCellImplEperimentEnabled||0!==this.totalPluginCount){if(this.setActiveCellTimeline.stamp("CellMessageCheck"),Object(l.f)(e.docName)||Object(l.f)(e.sheetIndex))return p.h.ULS.traceTag(553734796,m.c.msoulscat_ES_EWAJS,m.i.Warning,"x10arch.setSelectedCell early exit, some of the arguments is None"),void this.setActiveCellTimeline.log("End-Early");this.setActiveCellTimeline.stamp("DocumentLoc");var t=Object(d.d)(void 0,"");this.setActiveCellTimeline.stamp("SheetGridCell");var r=Object(d.r)(Object(d.u)(t,e.sheetIndex),Object(d.f)(e.rowIndex,e.colIndex));if(this.avoidUsingActiveCellPromise||(this.setActiveCellTimeline.stamp("ActiveCellPromise"),this.activeCellInitializedPromise_DEPRECATED.resolve(void 0)),this.isSetActiveCellImplNoSpreadEnabled){var n=this.state.activeCellFormat;this.setActiveCellTimeline.stamp("ActiveCellFormatCheck"),Object(l.f)(e.formatString)||Object(l.f)(e.builtIn)||(this.setActiveCellTimeline.stamp("Set-ActiveCellFormat"),n={formatString:e.formatString,builtIn:e.builtIn}),this.setActiveCellTimeline.stamp("Set-State"),this.state={activeCell:r,activeCellFormat:n,asyncGrid:this.state.asyncGrid,definedNamesInfoMap:this.state.definedNamesInfoMap,functionsInfoMap:this.state.functionsInfoMap,serverDataProvider:this.state.serverDataProvider}}else this.setActiveCellTimeline.stamp("Assign-ActiveCell"),this.state=Object(u.__assign)(Object(u.__assign)({},this.state),{activeCell:r}),this.setActiveCellTimeline.stamp("ActiveCellFormatCheck"),Object(l.f)(e.formatString)||Object(l.f)(e.builtIn)||(this.setActiveCellTimeline.stamp("Assign-ActiveCellFormat"),this.state=Object(u.__assign)(Object(u.__assign)({},this.state),{activeCellFormat:{formatString:e.formatString,builtIn:e.builtIn}}));this.setActiveCellTimeline.log("End")}},e.prototype.getConfig=function(){return this.syncDataModel.config},e.prototype.createAndAttachPlugin=function(e,t){var r=this;this.parent&&this.warmupParse.getValue();var n=e.create(t),i=g.c[e.factoryName];this.uiMessages[i].subscribe((function(t){var a=r.responseStates[i].uiMessageFrame;Object(p.g)("`frame` should be always defined at this point",void 0!==a);var o=n.run(t,Q);r.enqueueMessage({kind:h.c.StepPlugin,computation:{info:{correlationId:a.correlationId,pluginKind:i,pluginFactoryName:e.factoryName,pluginTime:0,schedulerTime:0,requestTimes:{}},generator:o,schedulerState:r.state,lastTimestamp:r.timer.now()},payload:Pe},a.startTime+r.pluginResultWindows[i].startDelta)})),p.h.ULS.traceTag(545378970,m.c.msoulscat_ES_EWAJS,m.i.Info,"x10arch.FormulaBarScheduler.createAndAttachPlugin: ".concat(f.c[e.factoryName]," was attached.")),this.addToPluginCount(i,1)},e.prototype.createAndAttachSyncPlugin=function(e,t){var r=this,n=e.create(t),i=g.c[e.factoryName];this.syncUIMessages[i].subscribe((function(t){var a=t[0],o=t[1],s=n.run(a,te);r.syncMessageQueue.enqueue({kind:h.c.StepPlugin,computation:{info:{correlationId:o,pluginKind:i,pluginFactoryName:e.factoryName,pluginTime:0,schedulerTime:0,requestTimes:{}},generator:s,schedulerState:r.state,lastTimestamp:r.timer.now()},payload:Pe})})),p.h.ULS.traceTag(538581058,m.c.msoulscat_ES_EWAJS,m.i.Info,"x10arch.FormulaBarScheduler.createAndAttachSyncPlugin: ".concat(f.c[e.factoryName]," was attached.")),this.responseStates[i].numSyncPlugins+=1},e.prototype.addToPluginCount=function(e,t){this.parent&&this.parent.addToPluginCount(e,t),this.responseStates[e].numPlugins+=t,this.totalPluginCount+=t},e.prototype.registerAsyncGrid=function(){this.recalcServiceAttachedPromise.resolve(void 0)},e.abstractStepCosts=((se={})[h.c.NoOpRequest]=.01,se[h.c.AsyncRequest]=.1,se[h.c.SyncRequest]=.5,se[h.c.StepPlugin]=1,se[h.c.StopPlugins]=.01,se),e}();function Re(e,t){switch(t.kind){case Y.FirstStep:return e.next();case Y.NormalResponse:return e.next(t.response);case Y.AsyncException:case Y.RequestFailure:return e.next(Ce);default:Object(p.d)("x10arch: FormulaBarScheduler.stepPlugin: unknown payload",t)}}var ke=r(44),Te=r(18),Ee=r(56),_e=function(){function e(e){this.onGridReady=e,this.gridService=void 0}return e.prototype.getGrid=function(){var e;return null===(e=this.gridService)||void 0===e?void 0:e.call},e.prototype.createIGridImportEndpoint=function(e){return Object(u.__awaiter)(this,void 0,void 0,(function(){var t,r=this;return Object(u.__generator)(this,(function(n){switch(n.label){case 0:return this.onGridExporterClosed(),[4,ke.Endpoint.createOutside(e,(function(e){r.gridService={call:void 0,close:function(){return e.close("Force")}}}))];case 1:return(t=n.sent()).hasBeenClosed()||(this.gridService=t,this.onGridReady(this.gridService.call)),[2]}}))}))},e.prototype.onGridExporterClosed=function(){if(this.gridService){var e=this.gridService;this.gridService=void 0,e.close()}},e}();function Fe(e,t,r){var n=new MessageChannel,i=n.port1,a=n.port2;Promise.all([e.createIGridImportEndpoint({port:a,options:r}),t.createIGridExportEndpoint({port:i,options:r},(function(){return e.onGridExporterClosed()}))]).catch((function(t){p.h.ULS.traceTag(540674071,Te.LogCategory.msoulscat_ES_EWAJS,Te.TraceLevel.Warning,"x10arch.connectGridImporterExporter: ".concat(Object(L.c)(t)));try{e.onGridExporterClosed()}catch(t){p.h.ULS.traceTag(540644190,Te.LogCategory.msoulscat_ES_EWAJS,Te.TraceLevel.Warning,"x10arch.connectGridImporterExporter: importer threw ".concat(Object(L.c)(t)))}}))}var Ie=function(){function e(e){this.timeout=e,this.exporter=void 0,this.importers=[]}return e.prototype.onGridExporterCreated=function(e){this.exporter=e;for(var t=0,r=this.importers;t<r.length;t++){var n=r[t];Fe(n.importer,e,{id:n.id,createTimeout:this.timeout})}},e.prototype.onGridImporterCreated=function(e,t){this.importers.push({importer:e,id:t}),this.exporter&&Fe(e,this.exporter,{id:t,createTimeout:this.timeout})},e}(),Ae=r(82),Me=Ae.a.Stable,we=function(){function e(e,t){if(this.threadId=e,!(t instanceof Ne))throw new TypeError("DynamicPluginLoaderBase.constructor: unknown IFormulaBarScheduler class: ".concat(JSON.stringify(t)));this.scheduler=t}return e.prototype.loadPluginScriptTrace=function(e,t){var r="x10arch.loadPluginScript: ".concat(e," loaded on ").concat(this.threadId,", time to load ").concat(t);p.h.ULS.traceTag(553734797,Te.LogCategory.msoulscat_ES_EWAJS,Te.TraceLevel.Info,r)},e.prototype.createAndAttachPlugin=function(e,t){return Object(u.__awaiter)(this,void 0,void 0,(function(){var r;return Object(u.__generator)(this,(function(n){return r=Object(g.b)(e,Me),this.scheduler.createAndAttachPlugin(r,t),[2]}))}))},e.prototype.createAndAttachSyncPlugin=function(e,t){return Object(u.__awaiter)(this,void 0,void 0,(function(){var r;return Object(u.__generator)(this,(function(n){return r=Object(g.b)(e,Me),this.scheduler.createAndAttachSyncPlugin(r,t),[2]}))}))},e}(),De=function(e){function t(t,r,n,i){var a=e.call(this,"Main",n)||this;a.threadEntryPoint=t,a.gridManager=r,a.loader=i;var o=i.getConfig();return a.resolveScript=o.resolveScript,a}return Object(u.__extends)(t,e),t.prototype.loadPluginScript=function(e,t){return Object(u.__awaiter)(this,void 0,void 0,(function(){var r,n,i;return Object(u.__generator)(this,(function(a){switch(a.label){case 0:return Object(l.f)(e)||Object(l.f)(t)?[2]:(r=S.b,n=r.now(),[4,this.loader.loadScript(e)]);case 1:return a.sent(),i=r.now()-n,this.loadPluginScriptTrace(e,i),[2]}}))}))},t.prototype.isThreadingSupported=function(){return ke.isThreadingSupported()&&void 0!==Object(Ee.a)()},t.prototype.createPluginThread=function(e){return Object(u.__awaiter)(this,void 0,void 0,(function(){var r,n,i,a,o,s,c,l=this;return Object(u.__generator)(this,(function(u){switch(u.label){case 0:return r="DynamicPluginLoaderThread-".concat(t.lastThreadNum+=1,"-").concat(e),n="".concat(r,"-IGrid"),[4,Ee.d];case 1:return u.sent(),[4,ke.createWorker({createMode:"Thread",id:r},ke.paramInsideDef({scriptUrl:Object(Ee.b)(),insideInitName:this.threadEntryPoint},{pluginResponseWindows:this.scheduler.getPluginResponseWindows()}),(function(){return{addResult:l.scheduler.addResult.bind(l.scheduler),addToPluginCount:l.scheduler.addToPluginCount.bind(l.scheduler),resolveScript:l.resolveScript}}))];case 2:i=u.sent(),u.label=3;case 3:return u.trys.push([3,5,,6]),a=function(){},i.onClose=function(){a();var e="x10arch.DynamicPluginLoader: ".concat(r," closed");p.h.ULS.traceTag(553734798,Te.LogCategory.msoulscat_ES_EWAJS,Te.TraceLevel.Info,e)},[4,Object(Ee.f)(i)];case 4:return o=u.sent(),a=function(){return o.close()},this.scheduler.doNotifyStatelessSubject.subscribe((function(e){var t;return(t=i.post).doNotify.apply(t,e)})),this.scheduler.requestWithCorrelationIdSubject.subscribe((function(e){var t;return(t=i.post).requestWithCorrelationId.apply(t,e)})),this.scheduler.doNotifyStatefulSubject.subscribe((function(e){var t;return(t=i.post).doNotify.apply(t,e)})),s={createIGridImportEndpoint:function(e){return i.call.createIGridImportEndpoint.transfer([e.port],e)},onGridExporterClosed:i.post.onGridExporterClosed},this.gridManager.onGridImporterCreated(s,n),[2,new je(i)];case 5:throw c=u.sent(),i.close(),c;case 6:return[2]}}))}))},t.lastThreadNum=0,t}(we),je=function(){function e(e){this.outside=e}return e.prototype.loadPluginScript=function(e,t){return this.outside.call.loadPluginScript(e,t)},e.prototype.createAndAttachPlugin=function(e,t){return this.outside.call.createAndAttachPlugin(e,t)},e.prototype.createAndAttachSyncPlugin=function(e,t){return this.outside.call.createAndAttachSyncPlugin(e,t)},e.prototype.recalcServiceAttached=function(){return this.outside.call.recalcServiceAttached()},e.prototype.close=function(){this.outside.close()},e}(),xe=function(e,t){var r=e.config,n=e.connection,i=t.pluginResponseWindows;return Object(u.__awaiter)(void 0,void 0,void 0,(function(){return Object(u.__generator)(this,(function(e){return[2,ke.Endpoint.createInside(n,(function(e){var t={addResult:function(){for(var t,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return(t=e.post).addResult.apply(t,r)},addToPluginCount:function(){for(var t,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return(t=e.post).addToPluginCount.apply(t,r)}},a=new _e((function(){return o.registerAsyncGrid()})),o=new Ne(bt(void 0),gt(a),i,void 0,t);return new Le(String(n.options.id),a,o,r,e)}))]}))}))},Le=function(e){function t(t,r,n,i,a){var o=e.call(this,t,n)||this;return o.gridImporter=r,o.twConfig=i,o.inside=a,o.loadedScripts=Object(l.h)(),o.initCalcThreadInside=function(e,t,r){return Object(u.__awaiter)(o,void 0,void 0,(function(){return Object(u.__generator)(this,(function(n){switch(n.label){case 0:return[4,Object(Ee.e)(e,t,r,this.twConfig)];case 1:return n.sent(),[2]}}))}))},o.createIGridImportEndpoint=o.gridImporter.createIGridImportEndpoint.bind(o.gridImporter),o.onGridExporterClosed=o.gridImporter.onGridExporterClosed.bind(o.gridImporter),o.doNotify=o.scheduler.doNotify.bind(o.scheduler),o.requestWithCorrelationId=o.scheduler.requestWithCorrelationId.bind(o.scheduler),Object(g.e)(t),o}return Object(u.__extends)(t,e),t.prototype.loadPluginScript=function(e,t){return Object(u.__awaiter)(this,void 0,void 0,(function(){var r,n,i,a,o;return Object(u.__generator)(this,(function(s){switch(s.label){case 0:return Object(l.f)(e)||Object(l.f)(t)||!0===this.loadedScripts[e]?[2]:(r=S.b,n=r.now(),a=(i=ke).importScriptsWithRetry,[4,this.inside.call.resolveScript({identifier:e,isLocalized:t})]);case 1:return a.apply(i,[[s.sent()],Ee.h]),o=r.now()-n,this.loadedScripts[e]=!0,this.loadPluginScriptTrace(e,o),[2]}}))}))},t.prototype.recalcServiceAttached=function(){return this.scheduler.recalcServiceAttached()},t}(we),Be=r(139),Ue=r(53),Ge=r(14),Ke=r(13),Ve=r(16),We=r(21),He=function(){function e(t,r,n,i){this.formats=void 0,this.values=void 0,this.formulae=void 0,this.valueAvailabilitySet=void 0,this.formatAvailabilitySet=void 0,this.formulaAvailabilitySet=void 0,Object(b.c)(r)&&(this.values=e.buildSparseMatrix(r.value.nonEmptyCells,(function(e){return e})),this.valueAvailabilitySet=e.unionRanges(r.value.availableRanges)),Object(b.c)(i)&&(this.formats=e.buildSparseMatrix(i.value.nonEmptyCells,(function(e){return e})),this.formatAvailabilitySet=e.unionRanges(i.value.availableRanges)),Object(b.c)(n)&&(this.formulae=e.buildSparseMatrix(n.value.nonEmptyCells,(function(e){return e})),this.formulaAvailabilitySet=e.unionRanges(n.value.availableRanges))}return e.buildSparseMatrix=function(e,t){for(var r=[],n=0,i=e;n<i.length;n++)for(var a=i[n],o=a[0],s=o[0],u=o[1],c=o[2],l=void 0===c?1:c,d=o[3],f=void 0===d?1:d,p=a.slice(1),m=p.length,h=u,v=0;h<u+f;h+=1)for(var g=s;g<s+l;g+=1,v=(v+1)%m)void 0===r[g]&&(r[g]=[]),r[g][h]=t(p[v],g,h);return r},e.forEachInSparseMatrix=function(e,t,r){void 0===r&&(r=function(){return!1});var n=!0;return e.forEach((function(e,i){n&&e.forEach((function(e,a){n&&(r(e)||t(Object(d.f)(i,a),e)||(n=!1))}))})),n},e.unionRanges=function(e){return e.map(Ge.f).reduce(Ke.j,Ve.d)},e.prototype.getCellValue=function(e,t){return this.isAvailable(e,t,"value")?void 0!==this.values&&void 0!==this.values[e]&&void 0!==this.values[e][t]?Object(b.e)(this.values[e][t]):Object(b.e)(Ue.d):Object(b.b)(Object(he.Z)(["getCellValue"]))},e.prototype.getCellFormat=function(e,t){return this.isAvailable(e,t,"format")?void 0!==this.formats&&void 0!==this.formats[e]&&void 0!==this.formats[e][t]?Object(b.e)(this.formats[e][t]):Object(b.e)(Ue.b):Object(b.b)(Object(he.Z)(["getCellFormat"]))},e.prototype.getCellFormula=function(e,t){return this.isAvailable(e,t,"formula")?void 0!==this.formulae&&void 0!==this.formulae[e]&&void 0!==this.formulae[e][t]?Object(b.e)(this.formulae[e][t]):Object(b.e)(Ue.c):Object(b.b)(Object(he.Z)(["getCellFormula"]))},e.prototype.foreachNonBlankCellValue=function(t){return void 0===this.values||e.forEachInSparseMatrix(this.values,t,(function(e){return e.kind===We.b.Blank}))},e.prototype.foreachNonBlankCellFormula=function(t){return void 0===this.formulae||e.forEachInSparseMatrix(this.formulae,t,(function(e){return e.kind===Ue.c.kind&&e.formulaBarText===Ue.c.formulaBarText}))},e.prototype.isAvailable=function(e,t,r){var n,i;switch(r){case"value":i=this.valueAvailabilitySet;break;case"formula":i=this.formulaAvailabilitySet;break;case"format":i=this.formatAvailabilitySet;break;default:Object(p.d)("isAvailable",r)}return void 0!==i&&(null!==(n=Object(Ke.a)(Object(Ge.f)(Object(d.f)(e,t)),i))&&void 0!==n?n:1)<=0},e}();Object(l.q)();var qe=r(61),ze=r(95),Qe=r(17),Je=r(120),Ye=r(73),$e=r(55),Ze=r(108),Xe=r(93),et=r(19),tt=r(11),rt=r(107);function nt(e){var t=e.hasHeadersRow,r=e.hasTotalsRow,n=e.dataRange;return Object(d.g)(n.row-Number(t),n.col,n.rows+Number(t)+Number(r),n.cols)}function it(e,t,r,n){for(var i=t.name,a=t.hasHeadersRow,o=t.hasTotalsRow,s=t.dataRange,u=t.columns,c=a?Object(d.g)(s.row-1,s.col,1,s.cols):void 0,l=o?Object(d.g)(s.row+s.rows,s.col,1,s.cols):void 0,f={},p=ze.a.create(e.stringCompareCI),m=0,h=u;m<h.length;m++){var v=h[m];f[v.column]=v,p=p.setValue(v.name,v)}return{name:i,sheet:r,dataRange:s,headersRange:c,totalsRange:l,allRange:n,indexToColumn:f,nameToColumn:p,allColumnNamesAvailable:u.length===s.cols}}function at(e,t){var r;return(null!==(r=Object(Ke.a)(Object(Ge.f)(t),e))&&void 0!==r?r:1)<=0}var ot=Object(b.b)(Object(he.Z)(["getCell"])),st=Object(b.b)(Object(he.Z)(["getContainingTable"])),ut=Object(b.b)(Object(he.Z)(["getIntersectingTables"])),ct=Object(b.b)(Object(he.Z)(["getIformats"])),lt=Object(b.b)(Object(he.Z)(["getTableHeaders"]));function dt(e,t){var r=Object.create(e);for(var n in t)r[n]=t[n];return r}var ft=function(){function e(e,t,r){this.grid=e,this.syncDataStore=t,this.correlationId=r,this.sheet2contents=Object(l.h)(),this.currentDocumentLoc=Object(d.d)(void 0,""),this.formatPages=[],this.formulaCache=new Map,this.englishFormulaCache=new Map,this.builtInFormatCache=new Map,this.customFormatCache=new Map,this.parser=Object(Ze.a)(t),this.analyzer=Object(Xe.a)(t),this.formatter=Object(Je.a)(t),this.resolver=Object(rt.a)(t);var n=dt(t,{config:dt(t.config,{localeInfo:Object(m.p)()})});this.englishParser=Object(Ze.a)(n),this.englishAnalyzer=Object(Xe.a)(n)}return e.getOrFetchTile=function(t,r,n){var i=r.range.row>>>e.tileHeightPow,a=r.range.col>>>e.tileWidthPow;void 0===t[i]&&(t[i]=[]);var o=t[i][a];return void 0===o?n(Object(d.t)(r.sheet,Object(d.g)(i<<e.tileHeightPow,a<<e.tileWidthPow,1<<e.tileHeightPow,1<<e.tileWidthPow))).then((function(e){return t[i][a]=e})):o},e.create=function(t,r,n){return new e(t,r,n)},e.prototype.getSheetContents=function(e){var t;return null!==(t=this.sheet2contents[e])&&void 0!==t?t:this.sheet2contents[e]={cellTiles:[],tables:Object(qe.a)(),tableTiles:[],hiddenRows:Ve.d,hiddenRowsAvailability:Ve.d,hiddenCols:Ve.d,hiddenColsAvailability:Ve.d}},e.prototype.getCurrentDocumentLoc=function(){return this.currentDocumentLoc},e.prototype.getSheetNames=function(){if(void 0===this.sheetNames){var e=[];this.syncDataStore.sheets.forEachSheet((function(t){e.push({sheetIndex:t.sheetIndex,sheetName:t.name})}));for(var t={},r=ze.a.create(this.syncDataStore.config.localeInfo.stringCompareCI),n=0;n<e.length;n+=1){var i=e[n],a=i.sheetIndex,o=i.sheetName;t[a.index]=n,r=r.setValue(o,n)}var s=this.getCurrentDocumentLoc();this.sheetNames={document:s,sheets:e,idToIndex:t,nameToIndex:r}}return Object(b.e)(this.sheetNames)},e.prototype.getRangeValues=function(e){return this.grid.getRangeValues(this.correlationId,e)},e.prototype.getRangeFormulae=function(e){return this.grid.getRangeFormulae(this.correlationId,e)},e.prototype.getRangeFormats=function(e){return this.grid.getRangeFormats(this.correlationId,e)},e.prototype.getHiddenRows=function(e,t,r){return Object(u.__awaiter)(this,void 0,void 0,(function(){var n,i,a,o,s,c;return Object(u.__generator)(this,(function(u){switch(u.label){case 0:return n=this.getSheetContents(e.index),i=Ge.d.row([t,r]),a=Object(Ve.a)(i,n.hiddenRowsAvailability),0===a||-1===a?[3,2]:[4,this.grid.getHiddenRows(this.correlationId,e,Object(l.b)(0,t-10),Object(l.c)(d.x,r+10))];case 1:o=u.sent(),n.hiddenRows=o.hidden.reduce((function(e,t){var r=t.start,n=t.end;return Object(Ve.j)(e,Ge.d.row([r,n]))}),n.hiddenRows),n.hiddenRowsAvailability=o.available.reduce((function(e,t){var r=t.start,n=t.end;return Object(Ve.j)(e,Ge.d.row([r,n]))}),n.hiddenRowsAvailability),u.label=2;case 2:return s=[],Object(Ge.j)(Object(Ve.i)(n.hiddenRowsAvailability,i),(function(e){var t=e[0],r=e[1];return s.push(Object(et.q)(t,r)),!0})),c=[],Object(Ge.j)(Object(Ve.i)(n.hiddenRows,i),(function(e){var t=e[0],r=e[1];return c.push(Object(et.q)(t,r)),!0})),[2,{available:s,hidden:c}]}}))}))},e.prototype.getHiddenCols=function(e,t,r){return Object(u.__awaiter)(this,void 0,void 0,(function(){var n,i,a,o,s,c;return Object(u.__generator)(this,(function(u){switch(u.label){case 0:return n=this.getSheetContents(e.index),i=Ge.d.col([t,r]),a=Object(Ve.a)(i,n.hiddenColsAvailability),0===a||-1===a?[3,2]:[4,this.grid.getHiddenCols(this.correlationId,e,Object(l.b)(0,t-10),Object(l.c)(d.q,r+10))];case 1:o=u.sent(),n.hiddenCols=o.hidden.reduce((function(e,t){var r=t.start,n=t.end;return Object(Ve.j)(e,Ge.d.col([r,n]))}),n.hiddenCols),n.hiddenColsAvailability=o.available.reduce((function(e,t){var r=t.start,n=t.end;return Object(Ve.j)(e,Ge.d.col([r,n]))}),n.hiddenColsAvailability),u.label=2;case 2:return s=[],Object(Ge.h)(Object(Ve.i)(n.hiddenColsAvailability,i),(function(e){var t=e[0],r=e[1];return s.push(Object(et.q)(t,r)),!0})),c=[],Object(Ge.h)(Object(Ve.i)(n.hiddenCols,i),(function(e){var t=e[0],r=e[1];return c.push(Object(et.q)(t,r)),!0})),[2,{available:s,hidden:c}]}}))}))},e.prototype.getRange=function(e,t){return Object(u.__awaiter)(this,void 0,void 0,(function(){var r,n,i,a,o,s,c,l;return Object(u.__generator)(this,(function(u){switch(u.label){case 0:return r=void 0===t||t.indexOf("values")>-1,n=void 0===t||t.indexOf("formulae")>-1,i=void 0===t||t.indexOf("formats")>-1,a=Object(b.b)(Object(he.Z)(["getRange"])),[4,Promise.all([r?this.getRangeValues(e):a,n?this.getRangeFormulae(e):a,i?this.getRangeFormats(e):a])];case 1:return o=u.sent(),s=o[0],c=o[1],l=o[2],[2,new He(e.sheet,s,c,l)]}}))}))},e.prototype.getCell=function(t){var r=this,n=this.getSheetContents(t.sheet.index),i=e.getOrFetchTile(n.cellTiles,t,(function(e){return Object(u.__awaiter)(r,void 0,void 0,(function(){var r,n,i,a,o;return Object(u.__generator)(this,(function(s){switch(s.label){case 0:return[4,this.grid.getRangeValues(this.correlationId,e)];case 1:return o=[s.sent()],[4,this.grid.getRangeFormulae(this.correlationId,e)];case 2:return o=o.concat([s.sent()]),[4,this.grid.getRangeFormats(this.correlationId,e)];case 3:return r=o.concat([s.sent()]),n=r[0],i=r[1],a=r[2],Object(b.c)(n)&&Object(b.c)(i)&&Object(b.c)(a)?[2,new He(t.sheet,n,i,a)]:[2,"unavailable"]}}))}))}));return Object(y.a)(i,(function(e){if("unavailable"===e)return ot;var r=e.getCellValue(t.range.row,t.range.col),n=e.getCellFormula(t.range.row,t.range.col),i=e.getCellFormat(t.range.row,t.range.col);return Object(b.c)(r)&&Object(b.c)(n)&&Object(b.c)(i)?Object(b.e)({value:r.value,formula:n.value,format:i.value}):ot}))},e.prototype.getTableHeaders=function(e){var t=this.syncDataStore.nameManager;if(!t)return lt;var r=t.getAllDocumentNames().find((function(t){return t.name===e}));if(!r)return lt;var n=t.getAvailableTableColumns(r);return Object(b.e)(n)},e.prototype.getContainingTable=function(t){return Object(u.__awaiter)(this,void 0,void 0,(function(){var r,n,i=this;return Object(u.__generator)(this,(function(a){return r=this.getSheetContents(t.sheet.index),n=e.getOrFetchTile(r.tableTiles,t,(function(e){return Object(u.__awaiter)(i,void 0,void 0,(function(){var n,i,a,o,s,c;return Object(u.__generator)(this,(function(u){switch(u.label){case 0:return[4,this.grid.getIntersectingTables(this.correlationId,e)];case 1:if(n=u.sent(),!Object(b.c)(n))return[2,"unavailable"];for(i=n.value.availableRanges.map(Ge.f).reduce(Ke.j,Ve.d),a=0,o=n.value.tables;a<o.length;a++)s=o[a],c=nt(s),r.tables.getValue(c)||(r.tables=r.tables.setValue(c,it(this.syncDataStore.config.localeInfo,s,t.sheet,c)));return[2,i]}}))}))})),[2,Object(y.a)(n,(function(e){return"unavailable"===e?st:(r.tables.forEachGe(t.range,(function(e,t){return n=t,!1})),void 0!==n||at(e,t.range)?Object(b.e)(n):st);var n}))]}))}))},e.prototype.getIntersectingTables=function(t){return Object(u.__awaiter)(this,void 0,void 0,(function(){var r,n,i,a,o,s,c,l,f,p,m=this;return Object(u.__generator)(this,(function(u){switch(u.label){case 0:r=this.getSheetContents(t.sheet.index),n=Ve.d,i=t.range.row,a=t.range.row+t.range.rows,u.label=1;case 1:if(!(i<a))return[3,8];o=t.range.col,s=t.range.col+t.range.cols,u.label=2;case 2:return o<s?(c=e.getOrFetchTile(r.tableTiles,Object(d.r)(t.sheet,Object(d.f)(i,o)),(function(e){return m.fetchTableTile(e.sheet,r,e)})),Object(y.b)(c)?[4,c]:[3,4]):[3,7];case 3:return f=u.sent(),[3,5];case 4:f=c,u.label=5;case 5:if("unavailable"===(l=f))return[2,ut];n=Object(Ke.j)(n,l),u.label=6;case 6:return o+=1<<e.tileWidthPow,[3,2];case 7:return i+=1<<e.tileHeightPow,[3,1];case 8:return p=[],r.tables.forEachMeets(t.range,(function(e,t){return p.push(t),n=Object(Ke.j)(n,Object(Ge.f)(e)),!0})),[2,at(n,t.range)?Object(b.e)(p):ut]}}))}))},e.prototype.fetchTableTile=function(e,t,r){return Object(u.__awaiter)(this,void 0,void 0,(function(){var n,i,a,o,s,c;return Object(u.__generator)(this,(function(u){switch(u.label){case 0:return[4,this.grid.getIntersectingTables(this.correlationId,r)];case 1:if(n=u.sent(),!Object(b.c)(n))return[2,"unavailable"];for(i=n.value.availableRanges.map(Ge.f).reduce(Ke.j,Ve.d),a=0,o=n.value.tables;a<o.length;a++)s=o[a],c=nt(s),t.tables.getValue(c)||(t.tables=t.tables.setValue(c,it(this.syncDataStore.config.localeInfo,s,e,c)));return[2,i]}}))}))},e.prototype.getIformat=function(t,r){return Object(u.__awaiter)(this,void 0,void 0,(function(){var n,i,a,o,s,c,l,d,f,p;return Object(u.__generator)(this,(function(u){switch(u.label){case 0:return n=r>>>e.formatPagePow,i=n<<e.formatPagePow,a=i+(1<<e.formatPagePow),void 0!==(o=this.formatPages[n])?[3,2]:[4,this.grid.getIformats(this.correlationId,t,i,a)];case 1:if(s=u.sent(),Object(b.c)(s)){for(c=[],l=0,d=s.value.availableFormats;l<d.length;l++)(f=d[l]).iformat<i||f.iformat>=a||(c[f.iformat-i]=f);o=this.formatPages[n]=c}else o=this.formatPages[n]="unavailable";u.label=2;case 2:return"unavailable"===o||void 0===(p=o[r-i])?[2,ct]:[2,Object(b.e)(p)]}}))}))},e.prototype.parseCellFormula=function(t,r,n){return{result:e.cachedParseFormula(n?this.englishFormulaCache:this.formulaCache,n?this.englishParser:this.parser,n?this.englishAnalyzer:this.analyzer,t,r)}},e.prototype.parseEdit=function(e,t){var r;return Object(u.__awaiter)(this,void 0,void 0,(function(){var n;return Object(u.__generator)(this,(function(i){switch(i.label){case 0:return[4,this.getEditFormat(e)];case 1:return n=null!==(r=i.sent())&&void 0!==r?r:{valueType:Qe.h.General,bidiDate:void 0,culture:void 0},[2,this.parseEditInternal(e,t,n)]}}))}))},e.prototype.parseEditSync=function(e,t,r){var n,i=this.parseNumberFormat(r.formatString,r.builtIn).result;return n=Object(b.c)(i)?i.value:{valueType:Qe.h.General,bidiDate:void 0,culture:void 0},this.parseEditInternal(e,t,n)},e.prototype.resolveReferences=function(e,t){var r=this;return t.map((function(t){switch(t.kind){case tt.e.StructRef:return r.resolveStructRefSync(e,t).result;case tt.e.CellRef:return r.resolveCellRefNodeSync(e,t).result}}))},e.prototype.parseEditInternal=function(t,r,n){var i=this.formatter.parseEdit(r,n);if(!Object(b.c)(i))return{result:i};if(i.value.kind!==Qe.e.Formula)return{result:Object(b.e)(i.value)};var a=e.parseCheckedFormula(this.parser,this.analyzer,t,i.value.fmla,t.range);return Object(b.c)(a)?{result:Object(b.e)({kind:Qe.e.Formula,fmla:i.value.fmla,formula:a.value})}:{result:a}},e.prototype.getEditFormat=function(e){return Object(u.__awaiter)(this,void 0,void 0,(function(){var t,r,n,i,a,o;return Object(u.__generator)(this,(function(s){switch(s.label){case 0:return[4,this.getCell(e)];case 1:return t=s.sent(),Object(b.c)(t)?"string"!=typeof t.value.format?[3,2]:(r=this.parseNumberFormat(t.value.format,!1).result,[3,4]):[2,void 0];case 2:return[4,this.getIformat(e.sheet.document,t.value.format)];case 3:if(n=s.sent(),!Object(b.c)(n))return[2,void 0];i=n.value,a=i.formatString,o=i.builtIn,r=this.parseNumberFormat(a,o).result,s.label=4;case 4:return[2,Object(b.c)(r)?r.value:void 0]}}))}))},e.cachedParseFormula=function(t,r,n,i,a){var o,s=t.get(a);if(void 0!==s)return s;var u=e.parseWellFormedFormula(r,n,i,a.formulaBarText,null!==(o=a.origin)&&void 0!==o?o:i.range);return t.set(a,u),u},e.parseWellFormedFormula=function(t,r,n,i,a){var o=e.parseCheckedFormula(t,r,n,i,a);return Object(b.c)(o)?Object(he.V)(o.value)?Object(b.e)(o.value):Object(b.b)(Object(et.p)("ill-formed formula")):o},e.parseCheckedFormula=function(e,t,r,n,i){var a=e.parseFormula(Object(Ye.d)(d.a.Cell,i),n);if(!Object(b.c)(a))return a;var o=t.checkFormula(Object($e.a)(d.a.Cell,Object(d.r)(r.sheet,i)),a.value);return Object(b.c)(o)?Object(b.e)(o.value):o},e.prototype.parseNumberFormat=function(e,t){return{result:this.cachedParseNumberFormat(e,t)}},e.prototype.evalOnClonedModel=function(e,t){return this.grid.evalClonedModelOnSnapshot(this.correlationId,e,t)},e.prototype.evalFormula=function(e,t){return this.grid.evalFormulaOnSnapshot(this.correlationId,e,t)},e.prototype.cachedParseNumberFormat=function(e,t){var r=t?this.builtInFormatCache.get(e):this.customFormatCache.get(e);if(void 0!==r)return r;var n=this.formatter.createFormat(e,t);return t?this.builtInFormatCache.set(e,n):this.customFormatCache.set(e,n),n},e.prototype.resolveStructRefSync=function(e,t){return{result:this.resolver.resolveStructRef(e,t)}},e.prototype.resolveCellRefNodeSync=function(e,t){return{result:this.resolver.resolveCellRef(e,t)}},e.prototype.close=function(){this.grid.discardSnapshot(this.correlationId).catch((function(e){var t="x10arch.PrefetchingCache.close: ".concat(Object(L.c)(e));p.h.ULS.traceTag(553734788,m.c.msoulscat_ES_EWAJS,m.i.Warning,t)}))},e.tileWidthPow=2,e.tileHeightPow=4,e.formatPagePow=6,e}(),pt=function(){function e(e){this.consumeMessage=e,this.queue=new ue.a((function(){return 0}))}return e.prototype.enqueue=function(e,t,r){Object(l.e)(r)&&e.kind===h.c.StopPlugins||this.queue.enqueue(e)},e.prototype.step=function(){var e=this.queue.pop();Object(l.e)(e)&&this.consumeMessage(e)},Object.defineProperty(e.prototype,"done",{get:function(){return 0===this.queue.getCount()},enumerable:!1,configurable:!0}),e}();Object(l.q)();var mt,ht=function(e){return new _e(e)},vt=function(e){return new Ie(e)},gt=function(e){return function(){for(var t,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var i=e.getGrid();if(void 0!==i)return(t=ft).create.apply(t,Object(u.__spreadArray)([i],r,!1))}},bt=function(e){return function(t){return new S.a((function(e,t){return e.kind-t.kind}),t,void 0,e)}},St=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return new(Ne.bind.apply(Ne,Object(u.__spreadArray)([void 0,bt(t[1]),gt(e)],t,!1)))},yt=function(e){for(var t,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var i=function(e){return t=new pt(e)},a=new(Ne.bind.apply(Ne,Object(u.__spreadArray)([void 0,i,gt(e)],r,!1)));if(void 0===t)throw"not initialized";return[a,t]},Ot=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return new(De.bind.apply(De,Object(u.__spreadArray)([void 0,e],t,!1)))},Ct=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new(Be.a.bind.apply(Be.a,Object(u.__spreadArray)([void 0],e,!1)))},Pt=function(){throw new Error("createIGridFromRecalcService: unimplemented in dev")},Nt=a,Rt=i,kt=n;r.d(t,"b",(function(){return Et})),r.d(t,"c",(function(){return _t})),r.d(t,"d",(function(){return Ft})),r.d(t,"a",(function(){return It})),r.d(t,"f",(function(){return wt})),r.d(t,"e",(function(){return xe})),r.d(t,"g",(function(){return xe}));var Tt=Object(l.p)((function(){var e=wt().createGridProvider((function(){return _t.instance().registerAsyncGrid()}));return Et.instance().onGridImporterCreated(e,"Main-IGrid"),e})),Et=Object(l.p)((function(){return wt().createGridImportManager()})),_t=Object(l.p)((function(){return wt().createFormulaBarScheduler(Tt.instance())}));function Ft(e){return wt().createDynamicPluginLoader(Et.instance(),_t.instance(),e)}Object(l.q)();var It=function(){function e(){}return e.create=function(e){return Ft(e)},e}();Object(l.q)();var At={createFormulaBarScheduler:St,createDynamicPluginLoader:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Ot.apply(s,Object(u.__spreadArray)(["excelOnlineCalc.x10.devDynamicPluginLoaderInsideInit"],e,!1))},createRecalcSideGrid:Ct,createGridImportManager:vt,createGridProvider:ht,createExperimentFormulaBarScheduler:yt},Mt={createFormulaBarScheduler:St,createDynamicPluginLoader:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Ot.apply(o,Object(u.__spreadArray)(["excelOnlineCalc.x10.stableDynamicPluginLoaderInsideInit"],e,!1))},createRecalcSideGrid:Ct,createGridImportManager:vt,createGridProvider:ht,createExperimentFormulaBarScheduler:yt};function wt(e){return void 0===e&&(e=Object(c.b)("Microsoft.Office.Excel.SmartFormulaBarUseDevScheduler")?Ae.a.Dev:Ae.a.Stable),e===Ae.a.Dev?At:Mt}if(Object(c.b)("TESTING_ONLY_SCHEDULER_IMPORTSCRIPTS_FAIL")&&(self.__retries=(null!==(mt=self.__retries)&&void 0!==mt?mt:-1)+1,0===self.__retries))throw""},function(e,t,r){"use strict";r.d(t,"j",(function(){return h})),r.d(t,"h",(function(){return v})),r.d(t,"i",(function(){return b})),r.d(t,"e",(function(){return S})),r.d(t,"g",(function(){return y})),r.d(t,"f",(function(){return O})),r.d(t,"b",(function(){return N})),r.d(t,"d",(function(){return R})),r.d(t,"c",(function(){return k})),r.d(t,"a",(function(){return E}));var n=r(2),i=r(160),a=r(24),o=r(8),s=r(4),u=r(29),c=r(95),l=r(0),d=r(11),f=r(6),p=r(9),m=r(61),h=Object(s.v)()((function(e){return{kind:"NamedValue",value:e}})),v=Object(s.v)()((function(e){return{kind:"NamedRange",value:e}})),g=c.a.create((function(e,t){return e-t}));function b(e,t,r,n,i){var a,s=e.sheet,u=e.range,l=t?Object(o.g)(u.row-1,u.col,1,u.cols):void 0,m=r?Object(o.g)(u.row+u.rows,u.col,1,u.cols):void 0,h=Object(f.q)(Object(f.q)(l,e.range),m),v=n.reduce((function(t,r){return Object(p.g)("calc.calc.namedTable: column names in range",r.column>=e.range.col&&r.column<e.range.col+e.range.cols),t.setValue(r.column,r.name)}),g),b=c.a.create(i);v.forEach((function(e,t){return b=b.setValue(t,e),!0}));var S=v.getCount()===e.range.cols;return{kind:"NamedTable",specialRefRanges:(a={},a[d.i.Data]=e,a[d.i.Headers]=l?Object(o.t)(s,l):void 0,a[d.i.Totals]=m?Object(o.t)(s,m):void 0,a[d.i.All]=Object(o.t)(s,h),a),columnNames:b,columnIndexes:v,allColumnNamesAvailable:S,hasHeadersRow:t,hasTotalsRow:r}}function S(e,t){var r=e.columnNames,i=e.columnIndexes;t.columnIndexes.forEach((function(t,n){var i=e.columnIndexes.getValue(t);return void 0!==i&&(r=r.remove(i)),!0})),t.columnIndexes.forEach((function(e,t){return r=r.setValue(t,e),i=i.setValue(e,t),!0}));var a=i.getCount()===t.specialRefRanges[d.i.All].range.cols;return Object(n.__assign)(Object(n.__assign)({},t),{columnNames:r,columnIndexes:i,allColumnNamesAvailable:a})}var y=Object(s.v)()((function(e){return{kind:"NamedFormula",fmla:e}})),O=Object(s.v)()((function(e,t){return{kind:"NamedFailure",failureReason:e,objectKind:t}})),C=Object(m.a)(),P=Object(m.a)(),N={namesCount:0,tablesCount:0,rangesCount:0,recalcFailuresCount:0,scopes:0,allAvailableScopes:0};function R(e,t){return{namesCount:e.namesCount+t.namesCount,tablesCount:e.tablesCount+t.tablesCount,rangesCount:e.rangesCount+t.rangesCount,recalcFailuresCount:e.recalcFailuresCount+t.recalcFailuresCount,scopes:e.scopes+t.scopes,allAvailableScopes:e.allAvailableScopes+t.allAvailableScopes}}function k(e,t){return Object(f.O)(e.specialRefRanges[d.i.Data],t.specialRefRanges[d.i.Data])&&e.hasHeadersRow===t.hasHeadersRow&&e.hasTotalsRow===t.hasTotalsRow}var T=function(){function e(e,t,r,n){this.names=e,this.allAvailable=t,this.tables=r,this.ranges=n}return e.create=function(t){return new e(c.a.create(t),!1,C,P)},e.prototype.update=function(t,r,n,i){return t!==this.names||r!==this.allAvailable||n!==this.tables||i!==this.ranges?new e(t,r,n,i):this},e.prototype.getEntry=function(e,t,r){var n=this.names.getEntry(t);return void 0===n?this.allAvailable?Object(l.e)(void 0):Object(l.b)(Object(f.Z)([{kind:a.e.NameLoc,name:Object(o.n)(e,t),source:r}])):Object(l.e)(!1!==n.value?n:void 0)},e.prototype.getEntryIfDefined=function(e){var t=this.names.getEntry(e);if(void 0!==t)return!1!==t.value?t:void 0},e.prototype.setValue=function(e,t){return this.update(this.names.setValue(e,t),this.allAvailable,this.tables,this.ranges)},e.prototype.remove=function(e){return this.update(this.allAvailable?this.names.remove(e):this.names.setValue(e,!1),this.allAvailable,this.tables,this.ranges)},e.prototype.getContainingTable=function(e){var t;return this.tables.forEachGe(e,(function(e,r){return t=r,!1})),t},e.prototype.getIntersectingTables=function(e){var t=[];return this.tables.forEachMeets(e,(function(e,r){return t.push(r),!0})),t},e.prototype.getNamedRanges=function(e){var t;return null!==(t=this.ranges.getValue(e))&&void 0!==t?t:[]},e.prototype.getAvailableNames=function(e){var t=[];return this.names.forEach((function(r,n){return!1!==n&&t.push(Object(o.n)(e,r)),!0})),t},e.prototype.forEachAvailableName=function(e){return this.names.forEach((function(t,r){return e(t,!1===r?void 0:r)}))},e.prototype.setUndefined=function(){return this.update(this.names,!0,this.tables,this.ranges)},e.prototype.getStatistics=function(e){return{namesCount:this.names.getCount(),tablesCount:this.tables.getCount(),rangesCount:this.ranges.getCount(),recalcFailuresCount:e,scopes:1,allAvailableScopes:this.allAvailable?1:0}},e.prototype.collectGarbage=function(){return this.update(this.allAvailable?this.names.filter((function(e,t){return!1!==t})):this.names,this.allAvailable,this.tables,this.ranges)},e.prototype.resetLazyData=function(){this.names.forEach((function(e,t){return!1!==t&&t.lazyData.reset(),!0}))},e.prototype.onWriteNamedTable=function(e,t,r){var n=t.specialRefRanges[d.i.All].range;return this.update(this.names,this.allAvailable,"remove"===r?this.tables.remove(n):this.tables.setValue(n,e),this.ranges)},e.prototype.onWriteNamedRange=function(e,t,r){var i,a=t.value.ranges[0],o=null!==(i=this.ranges.getValue(a))&&void 0!==i?i:[],s="remove"===r?o.filter((function(t){return Object(f.D)(e.scope,t.scope)&&e.name===t.name})):Object(n.__spreadArray)(Object(n.__spreadArray)([],o,!0),[e],!1);return this.update(this.names,this.allAvailable,this.tables,0===s.length?this.ranges.remove(a):this.ranges.setValue(a,s))},e}(),E=function(){function e(e,t){this.stringCompareCI=e,this.scope=t,this.isCurrent=!1,this.isChanged=!1,this.oldContents=this.contents=this.emptyContents=T.create(e),this.emptyRecalcFailures=this.recalcFailures=i.a.create(e)}return e.prototype.clone=function(){var t=new e(this.stringCompareCI,this.scope);return t.contents=this.contents,t},e.prototype.advanceState=function(e){this.oldContents=this.contents,this.oldStateId=this.isCurrent?e:void 0,this.contents=this.emptyContents,this.isCurrent=this.isChanged=!1,this.recalcFailures=this.emptyRecalcFailures},e.prototype.getStatistics=function(){return this.contents.getStatistics(this.recalcFailures.getCount())},e.prototype.collectGarbage=function(e){void 0===this.oldStateId||this.oldStateId<e?(this.oldContents=this.emptyContents,this.oldStateId=void 0):this.oldContents=this.oldContents.collectGarbage(),this.contents=this.contents.collectGarbage()},e.prototype.getNameLoc=function(e,t){var r=this.contents.getEntry(this.scope,e,t);return Object(l.c)(r)?Object(l.e)(void 0!==r.value?Object(o.n)(this.scope,r.value.key):void 0):r},e.prototype.getNameFormula=function(e,t){var r=this.contents.getEntry(this.scope,e,t);return Object(l.c)(r)?Object(l.e)(void 0!==r.value?r.value.value:void 0):r},e.prototype.getContainingTable=function(e){return this.contents.getContainingTable(e)},e.prototype.getIntersectingTables=function(e){return this.contents.getIntersectingTables(e)},e.prototype.getNamedRanges=function(e){return this.contents.getNamedRanges(e)},e.prototype.allAvailable=function(){return this.contents.allAvailable},e.prototype.getAvailableNames=function(e){return this.contents.getAvailableNames(e)},e.prototype.hasRecalcFailure=function(e){return this.recalcFailures.contains(e)},e.prototype.setRecalcFailure=function(e){this.recalcFailures=this.recalcFailures.setValue(e,!0)},e.prototype.onCellModified=function(e){this.recalcFailures=this.emptyRecalcFailures},e.prototype.resetLazyData=function(){this.contents.resetLazyData(),this.oldContents!==this.contents&&this.oldContents.resetLazyData()},e.prototype.setNamedObject=function(e,t,r,n,i){var a,s=this.contents.getEntryIfDefined(t.name);if(void 0!==s&&(a=i(Object(o.n)(this.scope,s.key),s.value.obj,"remove")).kind===l.a.Failure)return a;if((this.contents=void 0===r?this.contents.remove(t.name):this.contents.setValue(t.name,{obj:r,lazyData:new u.a((function(){return n(e,t,r)}))}),this.isCurrent=this.isChanged=!0,void 0!==r)&&(a=i(t,r,"add")).kind===l.a.Failure)return a;return l.f},e.prototype.setUndefinedNames=function(){this.contents=this.contents.setUndefined(),this.isCurrent=this.isChanged=!0},e.prototype.promoteNamedObjects=function(e,t){var r=this;if(this.isChanged||e!==this.oldStateId)return Object(l.e)(!1);this.contents=this.oldContents,this.isCurrent=!0;var n=Object(l.e)(!0);return this.contents.forEachAvailableName((function(e,i){if(void 0===i)return!0;var a=t(Object(o.n)(r.scope,e),i.obj,"add");return a.kind===l.a.Success||(n=a,!1)})),n},e.prototype.onWriteNamedTable=function(e,t,r){this.contents=this.contents.onWriteNamedTable(e,t,r)},e.prototype.onWriteNamedRange=function(e,t,r){this.contents=this.contents.onWriteNamedRange(e,t,r)},e.prototype.forEachAvailableName=function(e){return this.contents.forEachAvailableName(e)},e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.userDefinedFuncLoc=t.unsafeGridRange=t.structRefColumnLoc=t.sheetRows=t.sheetRangeIndexes=t.sheetRange=t.sheetIndex=t.sheetGridRange=t.sheetGridCube=t.sheetGridCell=t.sheetCols=t.originCell=t.nameScope=t.nameLoc=t.lexicalSourceUDF=t.lexicalSourceWSF=t.lexicalSourceRange=t.lexicalSourceName=t.lexicalSourceGrid=t.lexicalSourceCell=t.isSheetIndex=t.isSheetGridRange=t.isSheetGridCell=t.isGridCell=t.gridRange=t.gridCell=t.documentScope=t.documentLoc=t.allSheetsRange=t.NameSource=t.LexicalKind=void 0;var n=r(3);t.LexicalKind=n.location.LexicalKind,t.NameSource=n.location.NameSource,t.allSheetsRange=n.location.allSheetsRange,t.documentLoc=n.location.documentLoc,t.documentScope=n.location.documentScope,t.gridCell=n.location.gridCell,t.gridRange=n.location.gridRange,t.isGridCell=n.location.isGridCell,t.isSheetGridCell=n.location.isSheetGridCell,t.isSheetGridRange=n.location.isSheetGridRange,t.isSheetIndex=n.location.isSheetIndex,t.lexicalSourceCell=n.location.lexicalSourceCell,t.lexicalSourceGrid=n.location.lexicalSourceGrid,t.lexicalSourceName=n.location.lexicalSourceName,t.lexicalSourceRange=n.location.lexicalSourceRange,t.lexicalSourceWSF=n.location.lexicalSourceWSF,t.lexicalSourceUDF=n.location.lexicalSourceUDF,t.nameLoc=n.location.nameLoc,t.nameScope=n.location.nameScope,t.originCell=n.location.originCell,t.sheetCols=n.location.sheetCols,t.sheetGridCell=n.location.sheetGridCell,t.sheetGridCube=n.location.sheetGridCube,t.sheetGridRange=n.location.sheetGridRange,t.sheetIndex=n.location.sheetIndex,t.sheetRange=n.location.sheetRange,t.sheetRangeIndexes=n.location.sheetRangeIndexes,t.sheetRows=n.location.sheetRows,t.structRefColumnLoc=n.location.structRefColumnLoc,t.unsafeGridRange=n.location.unsafeGridRange,t.userDefinedFuncLoc=n.location.userDefinedFuncLoc},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ES5IterableStackFrame=t.ES5IterableStackValue=t.stackFrameList=t.stackMapList=t.emptyStackEnv=t.LazyOper=t.evalLocalsSlice=t.evalLocalsLambda=t.evalLocalsName=t.evalLocalsGrid=t.evalUsage=t.bottomEvalPrecedents=t.isLambdaCall=t.lambdaCall=t.LambdaCallKind=t.handleEvaluationError=t.throwEvaluationError=t.EvaluationError=t.unevaluated=t.RuntimeInternalReasonKind=void 0;var n,i,a=r(2),o=r(105),s=r(38),u=r(51),c=r(43),l=r(40),d=r(71),f=r(48),p=r(60),m=r(149);function h(e){throw new t.EvaluationError(e)}!function(e){e.Unevaluated="Unevaluated"}(n=t.RuntimeInternalReasonKind||(t.RuntimeInternalReasonKind={})),t.unevaluated=function(e){return 0===e.length&&(0,c.assertFalse)("calc.runtime.unevaluated: expected nonempty array"),{kind:n.Unevaluated,anchors:e}},t.EvaluationError=(0,s.createFailureErrorClass)("EvaluationError"),t.throwEvaluationError=h,t.handleEvaluationError=function(e,t,r){var i;switch(r.kind){case n.Unevaluated:if(t.map.getCount()+1>(null!==(i=e.globals.limits.maxCellChain)&&void 0!==i?i:1/0))return(0,p.failure)((0,o.limitExceeded)(o.LimitKind.CellChain));var a=r.anchors.map((function(r){return e.createCellEvaluationMachine(e,void 0,t,r,!0)}));return(0,d.callMachineTransition)(new d.AllMachine(a),(0,d.nextOnSuccessReceiver)());default:return(0,p.failure)(r)}},function(e){e.LambdaCall="LambdaCall"}(i=t.LambdaCallKind||(t.LambdaCallKind={})),t.lambdaCall=function(e,t,r){return(0,c.assertTrue)("calc.runtime.lambdaCall",t.length>=e.minArity&&t.length<=e.maxArity),{kind:i.LambdaCall,lambda:e,args:t,caller:r}},t.isLambdaCall=function(e){return e.kind===i.LambdaCall},t.bottomEvalPrecedents=function(){return(0,l.precedents)([],[],[],f.SpecialPrecs.None,l.PrecsBound.Lower)},t.evalUsage=function(e,t){return{lambdaCalls:e,lambdaDepth:t}},t.evalLocalsGrid=function(e){var t=(0,s.sheetGridRangeAnchor)(e.range),r=(0,p.success)(t.range),n=(0,p.success)(t.sheet);return(0,o.evalLocals)(e,r,n,e.kind===u.LexicalKind.Range,r,n,e.kind===u.LexicalKind.Cell,!0,!1,(0,p.success)(!1))},t.evalLocalsName=function(e,t){var r,n=e.name.scope;if(void 0!==n.index)r=(0,p.success)(n);else{var i=t.originSheet;if(!(0,p.isSuccess)(i))return h(i.reason);r=(0,s.isDocumentLocEqual)(i.value.document,n.document)?i:(0,p.success)(n)}var a=t.originGridCell;return(0,o.evalLocals)(e,a,r,t.calcingArray,a,r,!1,!1,!0,(0,p.success)(!1))},t.evalLocalsLambda=function(e,t){return(0,o.evalLocals)(e.lexicalSource,e.originGridCell,e.originSheet,t.calcingArray,t.reflectionGridCell,t.reflectionSheet,t.implicitIntersect,e.allowUnqualifiedCell,e.wrapCellReferences,(0,p.success)(!1))},t.evalLocalsSlice=function(e){var t=e.lexicalSource,r=e.originGridCell,n=e.originSheet,i=e.calcingArray,a=e.reflectionGridCell,s=e.reflectionSheet,u=e.implicitIntersect,c=e.allowUnqualifiedCell,l=e.wrapCellReferences,d=e.followHyperlinks;return(0,o.evalLocals)(t,r,n,i,a,s,u,c,l,d)};var v=function(){function e(e){this.fallback=e}return Object.defineProperty(e.prototype,"value",{get:function(){return void 0===this._value?this.fallback():this._value},set:function(e){this._value=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"valueOrUndefined",{get:function(){return this._value},enumerable:!1,configurable:!0}),e}();t.LazyOper=v,t.emptyStackEnv=m.RedBlackMapTree.create((function(e,t){return e-t})),t.stackMapList=function(e,t,r){return{labels:e,numPushed:t,next:r}},t.stackFrameList=function(e,t,r,n,i){var a;return{stackDepth:1+(null!==(a=null==i?void 0:i.stackDepth)&&void 0!==a?a:0),lexicalSource:e,lexicalPosition:t,localValues:new g(r,n),caller:i}};var g=function(){function e(e,t){this.stackEnv=e,this.stackMap=t}return e.prototype.iterator=function(){var e,t,r,n,i,s;return a.__generator(this,(function(a){switch(a.label){case 0:e=this.stackEnv.getCount()-1,t=this.stackMap,a.label=1;case 1:if(void 0===t)return[3,6];r=t.numPushed-1,a.label=2;case 2:return r>=0?(n=t.labels[r],i=this.stackEnv.getValue(e--),void 0===n||void 0===i||void 0===(s=i instanceof v?i.valueOrUndefined:i)?[3,4]:[4,(0,o.stackValue)(n,s)]):[3,5];case 3:a.sent(),a.label=4;case 4:return r--,[3,2];case 5:return t=t.next,[3,1];case 6:return[2]}}))},e}();t.ES5IterableStackValue=g;var b=function(){function e(e){this.leafFrame=e}return e.prototype.iterator=function(){var e;return a.__generator(this,(function(t){switch(t.label){case 0:e=this.leafFrame,t.label=1;case 1:return void 0===e?[3,4]:[4,e];case 2:t.sent(),t.label=3;case 3:return e=e.caller,[3,1];case 4:return[2]}}))},e}();t.ES5IterableStackFrame=b},function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"d",(function(){return u})),r.d(t,"c",(function(){return c})),r.d(t,"b",(function(){return l})),r.d(t,"e",(function(){return d}));var n,i=r(2),a=r(8),o=r(30),s=r(4);!function(e){e.Value="Value",e.CellFormula="CellFormula"}(n||(n={}));var u=o.d,c={kind:n.Value,formulaBarText:"",origin:Object(a.f)(0,0)};Object(s.q)();var l=0;function d(e,t){return{evalClonedModelOnSnapshot:function(r){for(var n=[],a=1;a<arguments.length;a++)n[a-1]=arguments[a];var o=e.evalClonedModelOnSnapshot.apply(e,Object(i.__spreadArray)([r],n,!1));return t(r),o},discardSnapshot:e.discardSnapshot.bind(e),getRangeFormats:function(r){for(var n=[],a=1;a<arguments.length;a++)n[a-1]=arguments[a];var o=e.getRangeFormats.apply(e,Object(i.__spreadArray)([r],n,!1));return t(r),o},getRangeValues:function(r){for(var n=[],a=1;a<arguments.length;a++)n[a-1]=arguments[a];var o=e.getRangeValues.apply(e,Object(i.__spreadArray)([r],n,!1));return t(r),o},getRangeFormulae:function(r){for(var n=[],a=1;a<arguments.length;a++)n[a-1]=arguments[a];var o=e.getRangeFormulae.apply(e,Object(i.__spreadArray)([r],n,!1));return t(r),o},getSheetNames:function(r){for(var n=[],a=1;a<arguments.length;a++)n[a-1]=arguments[a];var o=e.getSheetNames.apply(e,Object(i.__spreadArray)([r],n,!1));return t(r),o},getIntersectingTables:function(r){for(var n=[],a=1;a<arguments.length;a++)n[a-1]=arguments[a];var o=e.getIntersectingTables.apply(e,Object(i.__spreadArray)([r],n,!1));return t(r),o},getIformats:function(r){for(var n=[],a=1;a<arguments.length;a++)n[a-1]=arguments[a];var o=e.getIformats.apply(e,Object(i.__spreadArray)([r],n,!1));return t(r),o},getHiddenRows:function(r){for(var n=[],a=1;a<arguments.length;a++)n[a-1]=arguments[a];var o=e.getHiddenRows.apply(e,Object(i.__spreadArray)([r],n,!1));return t(r),o},getHiddenCols:function(r){for(var n=[],a=1;a<arguments.length;a++)n[a-1]=arguments[a];var o=e.getHiddenCols.apply(e,Object(i.__spreadArray)([r],n,!1));return t(r),o},evalFormulaOnSnapshot:function(r){for(var n=[],a=1;a<arguments.length;a++)n[a-1]=arguments[a];var o=e.evalFormulaOnSnapshot.apply(e,Object(i.__spreadArray)([r],n,!1));return t(r),o}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.arrayLift=t.makeStrict=t.gridRangeAnchorHash=t.broadcastWriteOper=t.isEmptyStringOper=t.emptyStringOper=t.traceErrorOper=t.writeOperType=t.singleWriteOperType=void 0;var n=r(81),i=r(40),a=r(38),o=r(51),s=r(62),u=r(71),c=r(48),l=r(43),d=r(135);t.singleWriteOperType=c.OperKind.Number|c.OperKind.String|c.OperKind.Boolean|c.OperKind.Error|c.OperKind.Rich,t.writeOperType=t.singleWriteOperType|c.OperKind.Array,t.traceErrorOper=function(e,t,r){var n="".concat(e,": generated Excel error, type ").concat(t,"; ").concat(r);l.ulsLogger.ULS.traceTag(596120270,d.LogCategory.msoulscat_ES_EWAJS,d.TraceLevel.Verbose,n)},t.emptyStringOper=(0,i.stringOper)(""),t.isEmptyStringOper=function(e){return(0,a.isStringOper)(e)&&""===e.value},t.broadcastWriteOper=function(e,t,r){var o=(0,a.isArrayOper)(r)?(0,n.broadcastArray)(r.rows,r.cols,e,t,r.opers,i.naErrorOper):(0,n.constantArray)(e,t,r);return(0,i.arrayOper)(e,t,o)},t.gridRangeAnchorHash=function(e){return o.sheetCols*e.row+e.col},t.makeStrict=function(e){var t=function(e){return e&~(c.OperKind.Array|c.OperKind.Range)};return(0,c.functionType)(e.minArgs,e.maxArgs,e.headTypes.map(t),e.restTypes.map(t),e.tailTypes.map(t),e.returnType,e.staticPrecs,e.flags)},t.arrayLift=function(e,t,r,o){for(var l=0,d=0,f=0;f<o.length;f+=1){var p=o[f];(0,a.isArrayOper)(p)&&0==((0,a.getArgType)(t,f,o.length)&c.OperKind.Array)?(l=(0,s.fastMax)(l,p.rows),d=(0,s.fastMax)(d,p.cols)):(l=(0,s.fastMax)(l,1),d=(0,s.fastMax)(d,1))}var m=o.map((function(r,o,s){return function(e,t,r,a,o){switch(a.kind){case c.OperKind.Missing:case c.OperKind.Blank:return(0,n.constantArray2D)(t,r,e.zero);case c.OperKind.Array:return 0!=(o&c.OperKind.Array)?(0,n.constantArray2D)(t,r,a):(0,n.broadcastArray2D)(t,r,new n.StrictArray2D(a.rows,a.cols,a.opers),i.naErrorOper);case c.OperKind.Range:default:return(0,n.constantArray2D)(t,r,a)}}(e.mathpack,l,d,r,(0,a.getArgType)(t,o,s.length))}));return(0,u.machineCall)(new u.ArrayMachine(e,l,d,(function(e,t){return r(m.map((function(r){return r.get(e,t)})))})))}},function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a})),r.d(t,"c",(function(){return o})),r.d(t,"d",(function(){return s})),r.d(t,"e",(function(){return u}));var n=r(20),i=n.analyzeServiceTypes.analyzeLocalsGrid,a=n.analyzeServiceTypes.analyzeLocalsName,o=n.analyzeServiceTypes.createAnalyzeGlobals,s=n.analyzeServiceTypes.diagnostics,u=n.analyzeServiceTypes.summarizeFormulaDiagnostics},function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a})),r.d(t,"c",(function(){return o})),r.d(t,"d",(function(){return s})),r.d(t,"e",(function(){return u})),r.d(t,"f",(function(){return c})),r.d(t,"g",(function(){return l})),r.d(t,"h",(function(){return d}));var n=r(7),i=n.config.getCalcAbsUrl,a=n.config.getCalcAbsUrlOrThrow,o=n.config.initCalc,s=n.config.initCalcCalled,u=n.config.initCalcInThread,c=n.config.initCalcThread,l=n.config.isCalcInit,d=n.config.maxRetriesForLoadingScript},function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a})),r.d(t,"c",(function(){return o})),r.d(t,"d",(function(){return s})),r.d(t,"e",(function(){return u})),r.d(t,"f",(function(){return c})),r.d(t,"g",(function(){return l}));var n=r(3),i=n.styleServiceTypes.BorderLineType,a=n.styleServiceTypes.FillKind,o=n.styleServiceTypes.FontUnderline,s=n.styleServiceTypes.FontVerticalAlignment,u=n.styleServiceTypes.HorizontalAlignment,c=n.styleServiceTypes.PatternType,l=n.styleServiceTypes.VerticalAlignment},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.now=t.mapFromArrayOfPairs=t.singleton=t.typedInstanceCreator=t.makeStringCompareCI=t.fastAbs=t.fastMax=t.fastMin=t.pair=t.filterOutNones=t.isNone=t.isDefined=t.safeConcat=t.safePush=t.strEnumArray=t.numEnumMap=t.numEnumArray=t.cloneStringMap=t.makeStringMap=t.identity=t.staticAssertIsOptional=t.staticAssertIs=t.staticAssertSame=t.staticAssertExtends=t.makeNewtypeIso=void 0;var n=r(7);t.makeNewtypeIso=n.core.makeNewtypeIso,t.staticAssertExtends=n.core.staticAssertExtends,t.staticAssertSame=n.core.staticAssertSame,t.staticAssertIs=n.core.staticAssertIs,t.staticAssertIsOptional=n.core.staticAssertIsOptional,t.identity=n.core.identity,t.makeStringMap=n.core.makeStringMap,t.cloneStringMap=n.core.cloneStringMap,t.numEnumArray=n.core.numEnumArray,t.numEnumMap=n.core.numEnumMap,t.strEnumArray=n.core.strEnumArray,t.safePush=n.core.safePush,t.safeConcat=n.core.safeConcat,t.isDefined=n.core.isDefined,t.isNone=n.core.isNone,t.filterOutNones=n.core.filterOutNones,t.pair=n.core.pair,t.fastMin=n.core.fastMin,t.fastMax=n.core.fastMax,t.fastAbs=n.core.fastAbs,t.makeStringCompareCI=n.core.makeStringCompareCI,t.typedInstanceCreator=n.core.typedInstanceCreator,t.singleton=n.core.singleton,t.mapFromArrayOfPairs=n.core.mapFromArrayOfPairs,t.now=n.core.now},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.nameNode=t.missingRef=t.localNameUseAnnotation=t.localNameDeclAnnotation=t.literalNode=t.letVar=t.letNode=t.lambdaParam=t.lambdaNode=t.indexedArg=t.identQualifier=t.identNamePart=t.headNamePart=t.formulaSpan=t.formulaRootAnnotation=t.formula=t.flattenNameParts=t.flattenLetArgs=t.flattenLambdaArgs=t.fieldRefNode=t.fieldRefNamePart=t.fieldRef=t.errorQualifier=t.documentQualifier=t.commaOpRef=t.columnRef=t.cellRefSingle=t.cellRefRow=t.cellRefRange=t.cellRefNode=t.cellRefNamePart=t.cellRefError=t.cellRefCol=t.cellRefBad=t.badRef=t.badQualifier=t.badNode=t.arrayNode=t.appNode=t.appHeadNameAnnotation=t.StructRefKind=t.SpecialRefId=t.RefStyle=t.QualifierKind=t.PosKind=t.NodeKind=t.NamePartKind=t.CellRefKind=t.BadType=t.AnnotationKind=void 0,t.getDepthUpperBound=t.wsfNode=t.thisRowOpRef=t.structRefNode=t.structRef=t.specialRef=t.sheetRangeQualifier=t.sheetQualifier=t.relativeQualifier=t.rangeOpRef=t.pos=t.parenNode=t.paramNode=t.paramName=t.paramDefault=t.operatorNode=void 0;var n=r(3);t.AnnotationKind=n.formulaModule.AnnotationKind,t.BadType=n.formulaModule.BadType,t.CellRefKind=n.formulaModule.CellRefKind,t.NamePartKind=n.formulaModule.NamePartKind,t.NodeKind=n.formulaModule.NodeKind,t.PosKind=n.formulaModule.PosKind,t.QualifierKind=n.formulaModule.QualifierKind,t.RefStyle=n.formulaModule.RefStyle,t.SpecialRefId=n.formulaModule.SpecialRefId,t.StructRefKind=n.formulaModule.StructRefKind,t.appHeadNameAnnotation=n.formulaModule.appHeadNameAnnotation,t.appNode=n.formulaModule.appNode,t.arrayNode=n.formulaModule.arrayNode,t.badNode=n.formulaModule.badNode,t.badQualifier=n.formulaModule.badQualifier,t.badRef=n.formulaModule.badRef,t.cellRefBad=n.formulaModule.cellRefBad,t.cellRefCol=n.formulaModule.cellRefCol,t.cellRefError=n.formulaModule.cellRefError,t.cellRefNamePart=n.formulaModule.cellRefNamePart,t.cellRefNode=n.formulaModule.cellRefNode,t.cellRefRange=n.formulaModule.cellRefRange,t.cellRefRow=n.formulaModule.cellRefRow,t.cellRefSingle=n.formulaModule.cellRefSingle,t.columnRef=n.formulaModule.columnRef,t.commaOpRef=n.formulaModule.commaOpRef,t.documentQualifier=n.formulaModule.documentQualifier,t.errorQualifier=n.formulaModule.errorQualifier,t.fieldRef=n.formulaModule.fieldRef,t.fieldRefNamePart=n.formulaModule.fieldRefNamePart,t.fieldRefNode=n.formulaModule.fieldRefNode,t.flattenLambdaArgs=n.formulaModule.flattenLambdaArgs,t.flattenLetArgs=n.formulaModule.flattenLetArgs,t.flattenNameParts=n.formulaModule.flattenNameParts,t.formula=n.formulaModule.formula,t.formulaRootAnnotation=n.formulaModule.formulaRootAnnotation,t.formulaSpan=n.formulaModule.formulaSpan,t.headNamePart=n.formulaModule.headNamePart,t.identNamePart=n.formulaModule.identNamePart,t.identQualifier=n.formulaModule.identQualifier,t.indexedArg=n.formulaModule.indexedArg,t.lambdaNode=n.formulaModule.lambdaNode,t.lambdaParam=n.formulaModule.lambdaParam,t.letNode=n.formulaModule.letNode,t.letVar=n.formulaModule.letVar,t.literalNode=n.formulaModule.literalNode,t.localNameDeclAnnotation=n.formulaModule.localNameDeclAnnotation,t.localNameUseAnnotation=n.formulaModule.localNameUseAnnotation,t.missingRef=n.formulaModule.missingRef,t.nameNode=n.formulaModule.nameNode,t.operatorNode=n.formulaModule.operatorNode,t.paramDefault=n.formulaModule.paramDefault,t.paramName=n.formulaModule.paramName,t.paramNode=n.formulaModule.paramNode,t.parenNode=n.formulaModule.parenNode,t.pos=n.formulaModule.pos,t.rangeOpRef=n.formulaModule.rangeOpRef,t.relativeQualifier=n.formulaModule.relativeQualifier,t.sheetQualifier=n.formulaModule.sheetQualifier,t.sheetRangeQualifier=n.formulaModule.sheetRangeQualifier,t.specialRef=n.formulaModule.specialRef,t.structRef=n.formulaModule.structRef,t.structRefNode=n.formulaModule.structRefNode,t.thisRowOpRef=n.formulaModule.thisRowOpRef,t.wsfNode=n.formulaModule.wsfNode,t.getDepthUpperBound=n.formulaModule.getDepthUpperBound},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.successUndefined=t.success=t.javaScriptError=t.isSuccess=t.failure=t.ResultKind=t.ReasonKind=void 0;var n=r(7);t.ReasonKind=n.result.ReasonKind,t.ResultKind=n.result.ResultKind,t.failure=n.result.failure,t.isSuccess=n.result.isSuccess,t.javaScriptError=n.result.javaScriptError,t.success=n.result.success,t.successUndefined=n.result.successUndefined},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(25),i=(n.rtree.gridRangeDistance,n.rtree.makeGridRangeTable)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.now=t.mapFromArrayOfPairs=t.singleton=t.typedInstanceCreator=t.makeStringCompareCI=t.fastAbs=t.fastMax=t.fastMin=t.pair=t.filterOutNones=t.isNone=t.isDefined=t.safeConcat=t.safePush=t.strEnumArray=t.numEnumMap=t.numEnumArray=t.cloneStringMap=t.makeStringMap=t.identity=t.staticAssertIsOptional=t.staticAssertIs=t.staticAssertSame=t.staticAssertExtends=t.makeNewtypeIso=void 0;var n=r(7);t.makeNewtypeIso=n.core.makeNewtypeIso,t.staticAssertExtends=n.core.staticAssertExtends,t.staticAssertSame=n.core.staticAssertSame,t.staticAssertIs=n.core.staticAssertIs,t.staticAssertIsOptional=n.core.staticAssertIsOptional,t.identity=n.core.identity,t.makeStringMap=n.core.makeStringMap,t.cloneStringMap=n.core.cloneStringMap,t.numEnumArray=n.core.numEnumArray,t.numEnumMap=n.core.numEnumMap,t.strEnumArray=n.core.strEnumArray,t.safePush=n.core.safePush,t.safeConcat=n.core.safeConcat,t.isDefined=n.core.isDefined,t.isNone=n.core.isNone,t.filterOutNones=n.core.filterOutNones,t.pair=n.core.pair,t.fastMin=n.core.fastMin,t.fastMax=n.core.fastMax,t.fastAbs=n.core.fastAbs,t.makeStringCompareCI=n.core.makeStringCompareCI,t.typedInstanceCreator=n.core.typedInstanceCreator,t.singleton=n.core.singleton,t.mapFromArrayOfPairs=n.core.mapFromArrayOfPairs,t.now=n.core.now},function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return u}));var n=r(18),i=r(9),a=r(4),o=r(36);function s(e,t,r,n){void 0===n&&(n=!1);var i=[],o=[],s=e.toLocaleLowerCase();return""===e?{prefixedSuggestions:t,notPrefixedSuggestions:o}:(t.forEach((function(e){var t=r?r(e).toLocaleLowerCase():"string"==typeof e?e.toLocaleLowerCase():void 0;if(void 0!==t)if(t.startsWith(s))i.push(e);else if(n){var u=t.split(" ");Object(a.e)(u.find((function(e){return e.startsWith(s)})))&&o.push(e)}else s.length>2&&t.includes(s)&&o.push(e)})),{prefixedSuggestions:i,notPrefixedSuggestions:o})}var u=function(e){var t,r,s,u,c=e.kind===o.a.TableHeader?1:null!==(r=null===(t=e.label)||void 0===t?void 0:t.startsWith("#"))&&void 0!==r&&r?0:null!==(u=null===(s=e.label)||void 0===s?void 0:s.startsWith("@"))&&void 0!==u&&u?2:void 0;return Object(a.f)(c)?(i.h.ULS.traceTag(526411872,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,"conflictResolver: trying to rank a structRef completion item with unexpected fields. item = ".concat(JSON.stringify(e))),0):c}},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(7),i=n.resolvablePromise.ResolvablePromise},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.assertPositiveLength=t.assertPositiveInteger=t.assertInteger=t.assertIndex=t.assertNatural=t.assertNever=t.assertFalse=t.assertTrue=t.ulsLogger=void 0;var n=r(7);t.ulsLogger=n.assertions.ulsLogger,t.assertTrue=n.assertions.assertTrue,t.assertFalse=n.assertions.assertFalse,t.assertNever=n.assertions.assertNever,t.assertNatural=n.assertions.assertNatural,t.assertIndex=n.assertions.assertIndex,t.assertInteger=n.assertions.assertInteger,t.assertPositiveInteger=n.assertions.assertPositiveInteger,t.assertPositiveLength=n.assertions.assertPositiveLength},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.successUndefined=t.success=t.javaScriptError=t.isSuccess=t.failure=t.ResultKind=t.ReasonKind=void 0;var n=r(7);t.ReasonKind=n.result.ReasonKind,t.ResultKind=n.result.ResultKind,t.failure=n.result.failure,t.isSuccess=n.result.isSuccess,t.javaScriptError=n.result.javaScriptError,t.success=n.result.success,t.successUndefined=n.result.successUndefined},function(e,t,r){"use strict";var n,i,a=r(2),o=r(4),s=r(99),u=r(9),c={setImmediate:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return setImmediate.apply(void 0,e)},setTimeout:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return setTimeout.apply(void 0,e)},clearImmediate:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return clearImmediate.apply(void 0,e)},clearTimeout:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return clearTimeout.apply(void 0,e)}};function l(e,t){return{kind:e,handle:t}}function d(e){return void 0!==e?(e.kind=n.NoWorkScheduled,e.handle=void 0,e):l(n.NoWorkScheduled,void 0)}!function(e){e[e.NoWorkScheduled=0]="NoWorkScheduled",e[e.PromiseScheduled=1]="PromiseScheduled",e[e.ImmediateScheduled=2]="ImmediateScheduled",e[e.FutureScheduled=3]="FutureScheduled"}(n||(n={})),Object(o.q)(),function(e){e.Sync="Sync",e.MicroTask="MicroTask",e.MacroTask="MacroTask"}(i||(i={}));var f=Promise.resolve(),p=function(){function e(e,t){void 0===t&&(t=c);var r=this;this.timer=t,this.handleState=d(),this.clearHandleClosureAndRunBody=function(){var t;switch(r.handleState.kind){case n.NoWorkScheduled:t=i.Sync;break;case n.PromiseScheduled:t=i.MicroTask;break;case n.ImmediateScheduled:case n.FutureScheduled:t=i.MacroTask;break;default:Object(u.d)("Unknown handle state",r.handleState)}r.handleState=d(r.handleState),e(t)},this.promiseClosure=function(){r.handleState.kind===n.PromiseScheduled&&r.clearHandleClosureAndRunBody()}}return e.prototype.runNextSynchronously=function(){switch(this.handleState.kind){case n.ImmediateScheduled:this.timer.clearImmediate(this.handleState.handle);break;case n.FutureScheduled:this.timer.clearTimeout(this.handleState.handle)}this.clearHandleClosureAndRunBody()},e.prototype.runNextAsMicrotask=function(){switch(this.handleState.kind){case n.PromiseScheduled:return;case n.ImmediateScheduled:this.timer.clearImmediate(this.handleState.handle);break;case n.FutureScheduled:this.timer.clearTimeout(this.handleState.handle)}var e;this.handleState=void 0!==(e=this.handleState)?(e.kind=n.PromiseScheduled,e.handle=void 0,e):l(n.PromiseScheduled,void 0),f.then(this.promiseClosure)},e.prototype.runNextAsMacrotask=function(){switch(this.handleState.kind){case n.ImmediateScheduled:return;case n.FutureScheduled:this.timer.clearTimeout(this.handleState.handle)}var e,t;this.handleState=(e=this.timer.setImmediate(this.clearHandleClosureAndRunBody),void 0!==(t=this.handleState)?(t.kind=n.ImmediateScheduled,t.handle=e,t):l(n.ImmediateScheduled,e))},e.prototype.runNextInFuture=function(e){switch(this.handleState.kind){case n.FutureScheduled:this.timer.clearTimeout(this.handleState.handle);break;case n.ImmediateScheduled:this.timer.clearImmediate(this.handleState.handle)}var t,r;this.handleState=(t=this.timer.setTimeout(this.clearHandleClosureAndRunBody,e),void 0!==(r=this.handleState)?(r.kind=n.FutureScheduled,r.handle=t,r):l(n.FutureScheduled,t))},e.prototype.clear=function(){switch(this.handleState.kind){case n.FutureScheduled:this.timer.clearTimeout(this.handleState.handle);break;case n.ImmediateScheduled:this.timer.clearImmediate(this.handleState.handle)}this.handleState=d(this.handleState)},e}();r.d(t,"b",(function(){return m})),r.d(t,"a",(function(){return h}));var m=Object(a.__assign)(Object(a.__assign)({},c),{now:o.j}),h=function(){function e(e,t,r,n){void 0===n&&(n=m);var a,o,u=this;this.cmp=e,this.consumeMessage=t,this.timer=n,this.startTime=void 0,this.totalSyncCost=0,this.maxWitnessedNow=0,this.lastFutureAbsoluteTime=void 0,this.queue=new s.a((function(t,r){var n=t.delayUntil-r.delayUntil;return 0!==n?n:e(t.payload,r.payload)})),this.costThreshold=null!==(a=null==r?void 0:r.costThreshold)&&void 0!==a?a:1,this.timeThreshold=null!==(o=null==r?void 0:r.timeThreshold)&&void 0!==o?o:10,this.scheduler=new p((function(e){u.totalSyncCost=0,u.lastFutureAbsoluteTime=void 0,e===i.MacroTask&&(u.startTime=void 0),u.continue()}),n)}return e.prototype.enqueue=function(e,t,r){void 0===r&&(r=this.maxWitnessedNow),this.queue.enqueue({delayUntil:r,payload:e,abstractCost:t}),this.continue()},e.prototype.push=function(e,t,r){void 0===r&&(r=this.maxWitnessedNow),this.queue.push({delayUntil:r,payload:e,abstractCost:t}),this.continue()},e.prototype.pop=function(){var e;return 1===this.queue.getCount()&&this.scheduler.clear(),null===(e=this.queue.pop())||void 0===e?void 0:e.payload},e.prototype.peek=function(){return this.queue.peek()},e.prototype.getCount=function(){return this.queue.getCount()},e.prototype.continue=function(){var e;for(this.startTime=null!==(e=this.startTime)&&void 0!==e?e:this.now();this.totalSyncCost<this.costThreshold;){var t=this.queue.peek();if(void 0===t)return;if(t.delayUntil>this.maxWitnessedNow&&this.tryRunNextInFuture(t.delayUntil,this.now()))return;this.queue.pop(),this.totalSyncCost+=t.abstractCost,this.consumeMessage(t.payload)}var r=this.queue.peek();if(void 0!==r){var n=this.now();n-this.startTime<this.timeThreshold&&r.delayUntil<=n?this.scheduler.runNextAsMicrotask():this.tryRunNextInFuture(r.delayUntil,n)||this.scheduler.runNextAsMacrotask()}},e.prototype.tryRunNextInFuture=function(e,t){return e>t&&(this.lastFutureAbsoluteTime!==e&&(this.lastFutureAbsoluteTime=e,this.scheduler.runNextInFuture(e-t)),!0)},e.prototype.now=function(){return this.maxWitnessedNow=this.timer.now()},e}()},function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a})),r.d(t,"c",(function(){return o})),r.d(t,"d",(function(){return s}));var n=r(7),i=n.promise.bindMaybeThenable,a=(n.promise.collapseThenable,n.promise.isThenable),o=(n.promise.newPromise,n.promise.promiseFinally),s=n.promise.promiseLoop},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fieldRefNamePart=t.cellRefNamePart=t.identNamePart=t.nameNode=t.parenNode=t.wsfNode=t.operatorNode=t.lambdaNode=t.lambdaParam=t.paramNode=t.paramDefault=t.paramName=t.flattenLambdaArgs=t.letNode=t.letVar=t.indexedArg=t.flattenLetArgs=t.appNode=t.arrayNode=t.literalNode=t.localNameDeclAnnotation=t.localNameUseAnnotation=t.formulaSpan=t.formula=t.cellRefBad=t.cellRefCol=t.cellRefRow=t.cellRefRange=t.cellRefSingle=t.cellRefError=t.pos=t.badQualifier=t.sheetRangeQualifier=t.identQualifier=t.sheetQualifier=t.documentQualifier=t.relativeQualifier=t.errorQualifier=t.BadType=t.StructRefKind=t.SpecialRefId=t.NamePartKind=t.NodeKind=t.formulaRootAnnotation=t.appHeadNameAnnotation=t.AnnotationKind=t.PosKind=t.CellRefKind=t.QualifierKind=t.RefStyle=void 0,t.getDepthUpperBound=t.badNode=t.structRef=t.badRef=t.missingRef=t.thisRowOpRef=t.commaOpRef=t.rangeOpRef=t.columnRef=t.specialRef=t.structRefNode=t.fieldRef=t.fieldRefNode=t.cellRefNode=t.headNamePart=t.flattenNameParts=void 0;var n,i,a,o,s,u,c,l,d=r(2),f=r(70),p=r(58),m=r(58);function h(e){return Array.isArray(e)}function v(e){return void 0!==e.kind}function g(e){for(var t=[],r=0,n=e;r<n.length;r++){var i=n[r],a=i.arg,o=i.index;(0,f.assertIndex)("calc.lang.flattenNumberedArgs: idx",o,e.length),(0,f.assertTrue)("calc.lang.flattenNumberedArgs: repetition",void 0===t[o]),t[o]=a}return t}function b(e,t,r){return g((0,m.safeConcat)(d.__spreadArray(d.__spreadArray([],void 0===t?[]:[t],!0),r,!0),e.map((function(e){return[e.name,e.binder]}))))}function S(e,t){return{arg:e,index:t}}function y(e,t){return{name:e,binder:t}}function O(e,t,r){return void 0===r&&(r=[]),g(d.__spreadArray(d.__spreadArray(d.__spreadArray([],e.map((function(e){return e.name})),!0),void 0===t?[]:[t],!0),r,!0))}function C(e,t,r,n){return void 0===r&&(r=!0),void 0===n&&(n=0),{label:n,name:e,isBracketed:t,isClosed:r}}function P(e,t,r){return void 0===r&&(r=0),{kind:o.Param,label:r,name:e,whole:e.name.kind===o.Name?e.name.whole:void 0,def:t,isOptional:e.isBracketed||void 0!==t}}function N(e){return{name:e}}function R(e,t,r){void 0===r&&(r=0);var n="string"==typeof e?e:e.asWhole,i="string"==typeof e?k(e,!0):e;return{kind:o.Name,label:r,whole:n,parts:i,qualifier:t}}function k(e,t,r,n){return void 0===t&&(t=!0),void 0===r&&(r=0),void 0===n&&(n=0),{kind:s.IdentNamePart,label:r,qualifiedLabel:n,asWhole:e,canDenoteNamedObject:t}}function T(e,t,r,n){return void 0===t&&(t=!1),void 0===r&&(r=!0),void 0===n&&(n=0),(0,f.assertTrue)("calc.lang.fieldRef","string"==typeof e||e.kind!==o.Name||void 0===e.qualifier),{label:n,field:"string"==typeof e?R(e):e,isBracketed:t,isClosed:r}}!function(e){e[e.R1C1=1]="R1C1",e[e.A1=2]="A1"}(t.RefStyle||(t.RefStyle={})),function(e){e.Error="Error",e.Relative="Relative",e.Document="Document",e.Sheet="Sheet",e.Ident="Ident",e.SheetRange="SheetRange",e.Bad="Bad"}(n=t.QualifierKind||(t.QualifierKind={})),function(e){e.Error="Error",e.Single="Single",e.Range="Range",e.Row="Row",e.Col="Col",e.Bad="Bad"}(i=t.CellRefKind||(t.CellRefKind={})),function(e){e.Abs="Abs",e.Rel="Rel"}(t.PosKind||(t.PosKind={})),function(e){e.LocalNameUse="LocalNameUse",e.LocalNameDecl="LocalNameDecl",e.AppHeadName="AppHeadName",e.FormulaRoot="FormulaRoot"}(a=t.AnnotationKind||(t.AnnotationKind={})),t.appHeadNameAnnotation={kind:a.AppHeadName},t.formulaRootAnnotation={kind:a.FormulaRoot},function(e){e.Literal="Literal",e.Array="Array",e.App="App",e.Let="Let",e.Lambda="Lambda",e.Paren="Paren",e.Name="Name",e.CellRef="CellRef",e.FieldRef="FieldRef",e.StructRef="StructRef",e.Bad="Bad",e.Operator="Operator",e.WSF="WSF",e.Param="Param"}(o=t.NodeKind||(t.NodeKind={})),function(e){e.IdentNamePart="IdentNamePart",e.CellRefNamePart="CellRefNamePart",e.FieldRefNamePart="FieldRefNamePart"}(s=t.NamePartKind||(t.NamePartKind={})),function(e){e[e.All=1]="All",e[e.Data=2]="Data",e[e.Headers=3]="Headers",e[e.Totals=4]="Totals",e[e.ThisRow=5]="ThisRow"}(u=t.SpecialRefId||(t.SpecialRefId={})),function(e){e.SpecialRef="SpecialRef",e.ColumnRef="ColumnRef",e.RangeOpRef="RangeOpRef",e.CommaOpRef="CommaOpRef",e.ThisRowOpRef="ThisRowOpRef",e.MissingRef="MissingRef",e.BadRef="BadRef"}(c=t.StructRefKind||(t.StructRefKind={})),function(e){e.Unexpected="Unexpected",e.Qualifier="Qualifier",e.NumberLiteral="NumberLiteral",e.StringLiteral="StringLiteral",e.ErrorLiteral="ErrorLiteral",e.FieldName="FieldName",e.ParamName="ParamName",e.Missing="Missing",e.Sequence="Sequence",e.StructRef="StructRef",e.FieldRef="FieldRef"}(l=t.BadType||(t.BadType={})),t.errorQualifier=function(e){return void 0===e&&(e=0),{kind:n.Error,isQuoted:!1,label:e}},t.relativeQualifier=function(e){return void 0===e&&(e=0),{kind:n.Relative,isQuoted:!1,label:e}},t.documentQualifier=function(e,t,r,i){return void 0===r&&(r=!1),void 0===i&&(i=0),{kind:n.Document,isQuoted:r,label:i,document:e,path:t}},t.sheetQualifier=function(e,t,r,i){return void 0===r&&(r=!1),void 0===i&&(i=0),{kind:n.Sheet,isQuoted:r,label:i,sheet:e,document:t}},t.identQualifier=function(e,t,r){return void 0===t&&(t=!1),void 0===r&&(r=0),{kind:n.Ident,isQuoted:t,label:r,name:e}},t.sheetRangeQualifier=function(e,t,r,i,a){return void 0===i&&(i=!1),void 0===a&&(a=0),{kind:n.SheetRange,isQuoted:i,label:a,sheet1:e,sheet2:t,document:r}},t.badQualifier=function(e,t,r){return void 0===t&&(t=!1),void 0===r&&(r=0),{kind:n.Bad,isQuoted:t,label:r,chars:e}},t.pos=function(e,t){return{kind:e,index:t}},t.cellRefError=function(e){return void 0===e&&(e=0),{kind:i.Error,label:e,isBracketed:!1}},t.cellRefSingle=function(e,t,r,n){return void 0===r&&(r=!1),void 0===n&&(n=0),{kind:i.Single,label:n,row:e,col:t,isBracketed:r}},t.cellRefRange=function(e,t,r){void 0===r&&(r=0);var n=e.isBracketed||t.isBracketed;return{kind:i.Range,label:r,ref1:e,ref2:t,isBracketed:n}},t.cellRefRow=function(e,t,r,n){return void 0===r&&(r=!1),void 0===n&&(n=0),{kind:i.Row,label:n,row1:e,row2:t,isBracketed:r}},t.cellRefCol=function(e,t,r,n){return void 0===r&&(r=!1),void 0===n&&(n=0),{kind:i.Col,label:n,col1:e,col2:t,isBracketed:r}},t.cellRefBad=function(e,t,r){return void 0===t&&(t=!1),void 0===r&&(r=0),{kind:i.Bad,label:r,chars:e,isBracketed:t}},t.formula=function(e,t,r,n){return{node:e,spans:t,annotations:r,depthUpperBound:null!=n?n:E(e)}},t.formulaSpan=function(e,t,r,n){return(0,f.assertNatural)("calc.lang.formulaSpan",e),(0,f.assertInteger)("calc.lang.formulaSpan",t),t<e&&(0,f.assertFalse)("calc.lang.formulaSpan: expected end >= ".concat(e,"; given ").concat(t)),{start:e,end:t,pre:r,post:n}},t.localNameUseAnnotation=function(e,t,r){return{kind:a.LocalNameUse,name:e,whole:t,label:r}},t.localNameDeclAnnotation=function(e,t,r){return void 0===r&&(r=[]),{kind:a.LocalNameDecl,name:e,whole:t,uses:r}},t.literalNode=function(e,t,r){return void 0===t&&(t=!0),void 0===r&&(r=0),{kind:o.Literal,label:r,oper:e,isClosed:t}},t.arrayNode=function(e,t,r){return void 0===t&&(t=!0),void 0===r&&(r=0),{kind:o.Array,label:r,nodes:e,isClosed:t}},t.appNode=function(e,t,r,n){return void 0===r&&(r=!0),void 0===n&&(n=0),{kind:o.App,label:n,head:e,args:t,isClosed:r}},t.flattenLetArgs=b,t.indexedArg=S,t.letVar=y,t.letNode=function(e,t,r,n,i,a){void 0===n&&(n=[]),void 0===i&&(i=!0),void 0===a&&(a=0),(0,f.assertTrue)("calc.lang.letNode",t.every((function(e){return void 0===(h(e)?e[0]:e.name.arg).qualifier})));var s=t.map((function(e,t){return h(e)?y(S(e[0],2*t),S(e[1],2*t+1)):e})).sort((function(e,t){return e.name.index-t.name.index})),u=void 0!==r&&v(r)?S(r,2*t.length):r,c=b(s,u,n);return{kind:o.Let,label:a,head:e,args:c,isClosed:i,vars:s,body:u,badArgs:n}},t.flattenLambdaArgs=O,t.paramName=C,t.paramDefault=function(e,t){return void 0===t&&(t=0),{label:t,rhs:e}},t.paramNode=P,t.lambdaParam=N,t.lambdaNode=function(e,t,r,n,i,a){void 0===n&&(n=[]),void 0===i&&(i=!0),void 0===a&&(a=0),(0,f.assertTrue)("calc.lang.lambdaNode",t.every((function(e){var t=v(e)?e:e.name.arg,r=t.kind===o.Name?t:t.name.name;return r.kind!==o.Name||void 0===r.qualifier})));var s=t.map((function(e,t){return v(e)?e.kind===o.Name?N(S(P(C(e,!1),void 0),t)):N(S(e,t)):e})).sort((function(e,t){return e.name.index-t.name.index})),u=void 0!==r&&v(r)?S(r,t.length):r,c=O(s,u,n);return{kind:o.Lambda,label:a,head:e,args:c,isClosed:i,params:s,body:u,badArgs:n}},t.operatorNode=function(e,t){return void 0===t&&(t=0),{kind:o.Operator,label:t,id:e}},t.wsfNode=function(e,t,r){return void 0===r&&(r=0),{kind:o.WSF,label:r,id:e,whole:t}},t.parenNode=function(e,t,r){return void 0===t&&(t=!0),void 0===r&&(r=0),{kind:o.Paren,label:r,node:e,isClosed:t}},t.nameNode=R,t.identNamePart=k,t.cellRefNamePart=function(e,t,r,n){return void 0===r&&(r=0),void 0===n&&(n=0),{kind:s.CellRefNamePart,label:r,qualifiedLabel:n,asWhole:t,canDenoteNamedObject:!1,ref:e}},t.fieldRefNamePart=function(e,t,r,n,i){var a,u;void 0===r&&(r=!0),void 0===n&&(n=0),void 0===i&&(i=0);var c="string"==typeof t?T(t,!1,!0):t;return(0,f.assertTrue)("calc.lang.fieldRefNamePart",(null===(a=null==c?void 0:c.isClosed)||void 0===a||a)&&!(null!==(u=null==c?void 0:c.isBracketed)&&void 0!==u&&u)),{kind:s.FieldRefNamePart,label:n,qualifiedLabel:i,asWhole:e.asWhole+"."+(void 0===c?"":c.field.kind===o.Name?c.field.whole:c.field.contents),canDenoteNamedObject:r,lhs:e,rhs:c}},t.flattenNameParts=function(e){for(var t=[e],r=t[0];r.kind===s.FieldRefNamePart;)t.push(r.lhs),r=r.lhs;return t.reverse(),{kind:r.kind,parts:t}},t.headNamePart=function(e){for(var t=e;t.kind===s.FieldRefNamePart;)t=t.lhs;return t},t.cellRefNode=function(e,t,r){return void 0===r&&(r=0),{kind:o.CellRef,label:r,ref:e,qualifier:t}},t.fieldRefNode=function(e,t,r,n){return void 0===r&&(r=!1),void 0===n&&(n=0),{kind:o.FieldRef,label:n,lhs:e,rhs:t,shouldBeBracketed:r}},t.fieldRef=T,t.structRefNode=function(e,t,r){return void 0===r&&(r=0),{kind:o.StructRef,label:r,lhs:e,rhs:t}},t.specialRef=function(e,t,r,n){return void 0===t&&(t=!1),void 0===r&&(r=!0),void 0===n&&(n=0),{kind:c.SpecialRef,label:n,id:e,isBracketed:t,isClosed:r}},t.columnRef=function(e,t,r,n){return void 0===t&&(t=!1),void 0===r&&(r=!0),void 0===n&&(n=0),{kind:c.ColumnRef,label:n,name:e,isBracketed:t,isClosed:r}},t.rangeOpRef=function(e,t,r){return void 0===r&&(r=0),{kind:c.RangeOpRef,label:r,lhs:e,rhs:t}},t.commaOpRef=function(e,t){var r;void 0===t&&(t=0);for(var n=((r={})[u.All]=!1,r[u.Data]=!1,r[u.Headers]=!1,r[u.Totals]=!1,r[u.ThisRow]=!1,r),i=[],a=0,o=e;a<o.length;a++){var s=o[a];switch(s.kind){case c.SpecialRef:n[s.id]=!0;break;case c.ColumnRef:case c.RangeOpRef:i.push(s)}}return{kind:c.CommaOpRef,label:t,refs:e,specialRefs:n,columnRefs:i}},t.thisRowOpRef=function(e,t){return void 0===t&&(t=0),{kind:c.ThisRowOpRef,label:t,ref:e}},t.missingRef=function(e){return void 0===e&&(e=0),{kind:c.MissingRef,label:e}},t.badRef=function(e,t,r,n){return void 0===t&&(t=!1),void 0===r&&(r=!0),void 0===n&&(n=0),{kind:c.BadRef,contents:e,isBracketed:t,isClosed:r,label:n}},t.structRef=function(e,t,r){return void 0===t&&(t=!0),void 0===r&&(r=0),{label:r,isClosed:t,innerRef:e}},t.badNode=function(e,t,r){return void 0===r&&(r=0),{kind:o.Bad,label:r,type:e,contents:t}};function E(e){return function e(t,r){if(r>50)return 1/0;switch(t.kind){case o.Array:for(var n=0,i=0,a=t.nodes;i<a.length;i++)for(var s=0,u=a[i];s<u.length;s++){var c=u[s];n=(0,p.fastMax)(n,e(c,r+1))}return n+1;case o.Param:return void 0===t.def?1:e(t.def.rhs,r+1)+1;case o.Let:case o.Lambda:case o.App:n=e(t.head,r+1);for(var d=0,m=t.args;d<m.length;d++){var h=m[d];n=(0,p.fastMax)(n,e(h,r+1))}return n+1;case o.Paren:return e(t.node,r+1)+1;case o.FieldRef:return e(t.lhs,r+1)+1;case o.Name:case o.CellRef:case o.StructRef:case o.Literal:case o.Operator:case o.WSF:return 1;case o.Bad:switch(t.type){case l.Sequence:case l.StructRef:case l.FieldRef:n=0;for(var v=0,g=t.contents;v<g.length;v++){var b=g[v];n=(0,p.fastMax)(n,e(b,r+1))}return n+1;default:return"string"==typeof t.contents?1:(0,f.assertNever)("calc.lang.getDepthUpperBound",t.contents)}default:return(0,f.assertNever)("calc.lang.getDepthUpperBound",t)}}(e,0)}t.getDepthUpperBound=E},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.assertPositiveLength=t.assertPositiveInteger=t.assertInteger=t.assertIndex=t.assertNatural=t.assertNever=t.assertFalse=t.assertTrue=t.ulsLogger=void 0;var n=r(7);t.ulsLogger=n.assertions.ulsLogger,t.assertTrue=n.assertions.assertTrue,t.assertFalse=n.assertions.assertFalse,t.assertNever=n.assertions.assertNever,t.assertNatural=n.assertions.assertNatural,t.assertIndex=n.assertions.assertIndex,t.assertInteger=n.assertions.assertInteger,t.assertPositiveInteger=n.assertions.assertPositiveInteger,t.assertPositiveLength=n.assertions.assertPositiveLength},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.refToVal=t.ArrayMachine=t.ThenMachine=t.isMachineCall=t.machineCall=t.MachineCallKind=t.readOperType=t.singleReadOperType=void 0;var n,i=r(2),a=r(40),o=r(43),s=r(251),u=r(38),c=r(60),l=r(48);function d(e){return e.kind===n.MachineCall}i.__exportStar(r(251),t),t.singleReadOperType=l.OperKind.Number|l.OperKind.String|l.OperKind.Boolean|l.OperKind.Error|l.OperKind.Blank|l.OperKind.Rich,t.readOperType=t.singleReadOperType|l.OperKind.Array,function(e){e.MachineCall="MachineCall"}(n=t.MachineCallKind||(t.MachineCallKind={})),t.machineCall=function(e){return{kind:n.MachineCall,machine:e}},t.isMachineCall=d;var f=function(){function e(e,t,r){this.context=e,this.f1=t,this.f2=r,this.runStatus=!1,this.oper1=void 0,this.oper2=void 0}return e.prototype.next=function(){var e;try{if(void 0===this.oper1){var t=this.f1();if(d(t))return(0,s.callMachineTransition)(t.machine,this);this.oper1=t}if(void 0===this.oper2){var r=this.f2(this.oper1);if(d(r))return(0,s.callMachineTransition)(r.machine,this);this.oper2=r}return(0,c.success)(this.oper2)}catch(t){return null!==(e=this.context.handleEvaluationError(t))&&void 0!==e?e:(0,c.failure)((0,c.javaScriptError)(t))}},e.prototype.receiveResult=function(e){return(0,c.isSuccess)(e)?(void 0===this.oper1?this.oper1=e.value:void 0===this.oper2&&(this.oper2=e.value),this.next()):e},e}();t.ThenMachine=f;var p=function(){function e(e,t,r,n){this.context=e,this.rows=t,this.cols=r,this.func=n,this.runStatus=!1,this.toDeref=void 0,this.row=[],this.opers=[]}return e.prototype.next=function(){var e;try{if(void 0!==this.toDeref){var r=this.context.coerceOper(m(this.context,this.toDeref,!0),t.readOperType);(0,o.assertTrue)("calc.runtime.ArrayMachine.next",!(0,u.isMissingOper)(r)&&!(0,u.isRangeOper)(r)),(0,u.isArrayOper)(r)&&(r=r.opers[0][0]),this.row.push(r),this.row.length===this.cols&&(this.opers.push(this.row),this.row=[]),this.toDeref=void 0}if(this.opers.length>=this.rows)return(0,c.success)((0,a.arrayOper)(this.rows,this.cols,this.opers));var n=this.func(this.opers.length,this.row.length);return d(n)?(0,s.callMachineTransition)(n.machine,this):(this.toDeref=n,s.nextTransition)}catch(t){return null!==(e=this.context.handleEvaluationError(t))&&void 0!==e?e:(0,c.failure)((0,c.javaScriptError)(t))}},e.prototype.receiveResult=function(e){return(0,c.isSuccess)(e)?(this.toDeref=e.value,this.next()):e},e}();function m(e,t,r){if(!(0,u.isRangeOper)(t))return t;if(!(0,u.isSheetIndex)(t.sheets))return a.valueErrorOper;if(!r)return 1===t.ranges.length&&(0,u.isGridCell)(t.ranges[0])?e.dereferenceOper(t,l.SignatureType.All&~l.OperKind.Range):e.dereferenceOper(t,l.OperKind.Array);var n=e.dereferenceOper(t,l.SignatureType.All&~(l.OperKind.Range|l.OperKind.Array));return(0,u.isArrayOper)(n)?a.naErrorOper:n}t.ArrayMachine=p,t.refToVal=m},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unknownFunctionType=t.operatorStrings=t.higherOrderFunctionType=t.getWorksheetFuncType=t.getWorksheetFuncEnglishName=t.getOperatorType=t.WorksheetFuncId=t.OperatorId=void 0;var n=r(3);t.OperatorId=n.signature.OperatorId,t.WorksheetFuncId=n.signature.WorksheetFuncId,t.getOperatorType=n.signature.getOperatorType,t.getWorksheetFuncEnglishName=n.signature.getWorksheetFuncEnglishName,t.getWorksheetFuncType=n.signature.getWorksheetFuncType,t.higherOrderFunctionType=n.signature.higherOrderFunctionType,t.operatorStrings=n.signature.operatorStrings,t.unknownFunctionType=n.signature.unknownFunctionType},function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a})),r.d(t,"c",(function(){return o})),r.d(t,"d",(function(){return s}));var n=r(20),i=n.parseServiceTypes.ReasonKind,a=n.parseServiceTypes.createParseGlobals,o=n.parseServiceTypes.notFormulaString,s=n.parseServiceTypes.parseLocals},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mapFromArrayOfPairs=t.singleton=t.now=t.typedInstanceCreator=t.makeStringCompareCI=t.fastAbs=t.fastMax=t.fastMin=t.pair=t.filterOutNones=t.isNone=t.isDefined=t.safeConcat=t.safePush=t.strEnumArray=t.numEnumMap=t.numEnumArray=t.cloneStringMap=t.makeStringMap=t.identity=t.staticAssertIsOptional=t.staticAssertIs=t.staticAssertSame=t.staticAssertExtends=t.makeNewtypeIso=void 0;var n=r(126);function i(){return function(e){return e}}function a(){var e=Object.create(null);return e.___=void 0,delete e.___,e}function o(e){return Object.keys(e).map((function(e){return Number(e)})).filter((function(e){return!isNaN(e)}))}function s(e,t){for(var r=0,n=t;r<n.length;r++){var i=n[r];e.push(i)}return e}function u(e){return null!=e}t.makeNewtypeIso=function(e,t){return{wrap:e,unwrap:t}},t.staticAssertExtends=function(){},t.staticAssertSame=function(){},t.staticAssertIs=i,t.staticAssertIsOptional=function(e){return e},t.identity=function(e){return e},t.makeStringMap=a,t.cloneStringMap=function(e){var t=a();for(var r in e)t[r]=e[r];return t},t.numEnumArray=o,t.numEnumMap=function(e,t){for(var r={},n=0,i=o(e);n<i.length;n++){var a=i[n];r[a]=t(a)}return r},t.strEnumArray=function(e){return Object.keys(e).map((function(e){return e})).map((function(t){return e[t]})).sort()},t.safePush=s,t.safeConcat=function(e,t){var r=[];s(r,e);for(var n=0,i=t;n<i.length;n++){s(r,i[n])}return r},t.isDefined=u,t.isNone=function(e){return null==e},t.filterOutNones=function(e){return e.filter(u)};t.pair=function(e,t){return[e,t]},t.fastMin=function(e,t){return e<t?e:t},t.fastMax=function(e,t){return e<t?t:e},t.fastAbs=function(e){return e<0?-e:e},t.makeStringCompareCI=function(e){try{var t=new Intl.Collator(function(e){var t=[e],r=e.indexOf("-");return r>0&&t.push(e.substring(0,r)),"en"!==t[t.length-1]&&t.push("en"),t}(e),{sensitivity:"accent"});return t.compare.bind(t)}catch(e){return function(e,t){return e===t?0:e.toLocaleUpperCase().localeCompare(t.toLocaleUpperCase())}}},t.typedInstanceCreator=function(){return function(e){return e}};var c="undefined"!=typeof self&&null!=self.performance&&null!=self.performance.now?function(){return self.performance.now()}:"undefined"!=typeof process&&null!=process.hrtime?function(){var e=process.hrtime();return 1e3*e[0]+e[1]/1e6}:function(){return Date.now()},l="undefined"!=typeof self&&null!=self.performance&&null!=self.performance.now?function(){return self.performance.now()}:function(){return Date.now()};t.now=(0,n.isTypedChangeGateEnabled)("Microsoft.Office.Excel.ChangeGate.PreciseNowForNodeJS")?c:l,t.singleton=function(e){return function(){function t(){}return t.instance=function(){return void 0===t.value&&(t.value=e()),t.value},t.prototype.instance=function(){return t.instance()},t.value=void 0,t}()},t.mapFromArrayOfPairs=function(e){return e.reduce((function(e,t){var r=t[0],n=t[1];return e[r]=n,e}),{})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSheetGridCell=t.isSheetGridRange=t.isGridCell=t.isSheetIndex=t.userDefinedFuncLoc=t.nameLoc=t.nameScope=t.documentScope=t.originCell=t.sheetGridCell=t.sheetGridRange=t.sheetGridCube=t.gridCell=t.gridRange=t.unsafeGridRange=t.sheetRangeIndexes=t.allSheetsRange=t.sheetIndex=t.sheetRange=t.structRefColumnLoc=t.documentLoc=t.sheetCols=t.sheetRows=t.lexicalSourceUDF=t.lexicalSourceWSF=t.lexicalSourceName=t.lexicalSourceGrid=t.lexicalSourceRange=t.lexicalSourceCell=t.NameSource=t.LexicalKind=void 0;var n,i=r(7),a=i.assertions.assertIndex,o=i.assertions.assertPositiveLength,s=i.assertions.assertFalse;function u(e){return{kind:n.Cell,range:e}}function c(e){return{kind:n.Range,range:e}}function l(e,t,r){return{document:e,index:t,index2:r}}function d(e,t){return l(e,t,t)}function f(e,t,r,n){return{row:e,col:t,rows:r,cols:n}}function p(e,t){return{sheet:e,range:t}}function m(e){return{document:e,index:void 0}}function h(e){return e.index===e.index2}function v(e){return 1===e.rows&&1===e.cols}function g(e){return v(e.range)}!function(e){e[e.Cell=1]="Cell",e[e.Range=2]="Range",e[e.NameManager=3]="NameManager",e[e.CondFormatting=4]="CondFormatting",e[e.DataValidation=5]="DataValidation",e[e.Indirect=6]="Indirect",e[e.WSF=7]="WSF",e[e.UDF=8]="UDF",e[e.Other=9]="Other"}(n=t.LexicalKind||(t.LexicalKind={})),function(e){e.AppHead="AppHead",e.Plain="Plain",e.StructRef="StructRef",e.Indirect="Indirect"}(t.NameSource||(t.NameSource={})),t.lexicalSourceCell=u,t.lexicalSourceRange=c,t.lexicalSourceGrid=function(e,t){switch(e){case n.Cell:return g(t)?u(t):s("calc.lang.lexicalSourceGrid: expected cell");case n.Range:return c(t)}},t.lexicalSourceName=function(e){return{kind:n.NameManager,name:e}},t.lexicalSourceWSF=function(e){return{kind:n.WSF,id:e}},t.lexicalSourceUDF=function(e){return{kind:n.UDF,udf:e}},t.sheetRows=1<<20,t.sheetCols=16384,t.documentLoc=function(e,t){return{path:e,name:t}},t.structRefColumnLoc=function(e,t,r,n){return{name:e,range:t,hasHeadersRow:r,hasTotalsRow:n}},t.sheetRange=l,t.sheetIndex=d,t.allSheetsRange=function(e){return{document:e,index:void 0,index2:void 0}},t.sheetRangeIndexes=function(e,t){return{sheets:e,position:t}},t.unsafeGridRange=f,t.gridRange=function(e,r,n,i){return a("calc.lang.gridRange",e,t.sheetRows),a("calc.lang.gridRange",r,t.sheetCols),o("calc.lang.gridRange",n,t.sheetRows-e),o("calc.lang.gridRange",i,t.sheetCols-r),f(e,r,n,i)},t.gridCell=function(e,r){return a("calc.lang.gridCell",e,t.sheetRows),a("calc.lang.gridCell",r,t.sheetCols),f(e,r,1,1)},t.sheetGridCube=p,t.sheetGridRange=p,t.sheetGridCell=p,t.originCell=p,t.documentScope=m,t.nameScope=function(e,t){return void 0===t?m(e):d(e,t)},t.nameLoc=function(e,t){return{scope:e,name:t}},t.userDefinedFuncLoc=function(e,t){return{document:e,id:t}},t.isSheetIndex=h,t.isGridCell=v,t.isSheetGridRange=function(e){return h(e.sheet)},t.isSheetGridCell=g},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.successUndefined=t.success=t.javaScriptError=t.isSuccess=t.failure=t.ResultKind=t.ReasonKind=void 0;var n=r(7);t.ReasonKind=n.result.ReasonKind,t.ResultKind=n.result.ResultKind,t.failure=n.result.failure,t.isSuccess=n.result.isSuccess,t.javaScriptError=n.result.javaScriptError,t.success=n.result.success,t.successUndefined=n.result.successUndefined},function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a}));var n=r(22),i=n.ribbonFormat.RibbonFormat,a=n.ribbonFormat.getRibbonFormat},function(e,t,r){"use strict";var n=r(2),i=r(44),a=r(18),o=r(4),s=r(56),u=r(8),c=r(15),l=r(14),d=r(24),f=r(39),p=r(10),m=r(30),h=r(6),v=r(16),g=r(13),b=r(9),S=r(19),y=r(7),O=y.asyncLoopModule.asyncLoop,C=r(27),P=r(68),N=r(35),R=r(84),k=r(17),T=r(45),E=r(46);var _,F=r(0),I=r(37),A=r(49),M=r(165),w=r(73),D=r(31),j=r(123);r.d(t,"b",(function(){return x})),r.d(t,"a",(function(){return U})),r.d(t,"c",(function(){return K}));function x(e,t){var r,n;switch(t.kind){case S.d.NotImplemented:for(var i=0,a=t.features;i<a.length;i++){var o=a[i];Object(C.y)(e,"".concat(S.d.NotImplemented," ").concat(o))}break;case S.d.IllFormedFormula:Object(C.y)(e,"".concat(S.d.IllFormedFormula," ").concat(null!==(r=t.mode)&&void 0!==r?r:""," ").concat(JSON.stringify({diagnostics:null!==(n=t.diagnostics)&&void 0!==n?n:{},message:t.mode===p.c.ServerCellFormula||t.mode===p.c.ServerNamedFormula?t.message:void 0})));break;case S.d.Unavailable:for(var s=0,u=t.objects;s<u.length;s++){var c=u[s],l=[S.d.Unavailable];if("string"==typeof c.kind&&c.kind in d.e){var f=c;switch(l.push(f.kind),f.kind){case d.e.SheetId:l.push(f.sheetId);break;case d.e.NameLoc:l.push(f.source),l.push(void 0===f.name.scope.index?"global":"sheet");break;case d.e.ClientFailure:l.push(f.reason);break;case d.e.VolatileFunction:l.push(f.name);break;case d.e.TimeGranularity:l.push(T.c[f.granularity]);break;case d.e.GetTimeKind:l.push(f.getTimeKind)}}else l.push(JSON.stringify(c));Object(C.y)(e,l.join(" "))}break;case S.d.LimitExceeded:Object(C.y)(e,"".concat(t.kind," ").concat(S.c[t.limit]));break;case k.g.NotFormatString:case k.g.NotValueString:Object(C.y)(e,"".concat(t.kind," ").concat(t.message));break;case S.d.InvalidQualifier:case S.d.InvalidCellRef:case S.d.InvalidStructRef:Object(C.y)(e,"".concat(t.kind," ").concat(t.reason));break;case S.d.Internal:Object(C.y)(e,"".concat(t.kind," ").concat(t.message));break;case S.d.JavaScriptError:case w.a.NotFormulaString:case S.d.CellCycle:case S.d.NameCycle:case S.d.Stopped:case S.d.PreviousFailure:case S.d.PreviousNameFailure:case k.g.PreviousFormatFailure:Object(C.y)(e,t.kind);break;default:Object(b.d)("calc.calc.incrementFailure",t)}}var L=function(){function e(e,t,r){this.onRecalcResults=e,this.onUpdateRequest=t,this.currentOutputStateId=r,this.editedRangeDeltas=[],this.dependentRangeDeltas=[],this.editedRangeFailures=[],this.dependentRangeFailures=[],this.rangeUpdateRequests=[],this.namesUpdateRequests=[],this.recalcFinished=!1}return e.prototype.setOutputStateId=function(e){e<=this.currentOutputStateId||(this.flush(),this.currentOutputStateId=e)},e.prototype.pushCellWrite=function(e,t){(e!==p.b.DependentCell?this.editedRangeDeltas:this.dependentRangeDeltas).push(t)},e.prototype.pushRangeWrite=function(e,t){Object(o.o)(e!==p.b.DependentCell?this.editedRangeDeltas:this.dependentRangeDeltas,t)},e.prototype.pushRangeFailure=function(e,t){(e!==p.b.DependentCell?this.editedRangeFailures:this.dependentRangeFailures).push(t)},e.prototype.pushUpdateRequest=function(e){this.rangeUpdateRequests.push(e)},e.prototype.pushUpdateNameRequest=function(e){this.namesUpdateRequests.push(e.index)},e.prototype.pushRecalcFinished=function(e){this.recalcFinished=this.recalcFinished||e},e.prototype.isRecalcFinished=function(){return this.recalcFinished},e.prototype.flush=function(){(this.rangeUpdateRequests.length>0||this.namesUpdateRequests.length>0)&&(this.onUpdateRequest(Object(c.jb)(this.rangeUpdateRequests,[],this.namesUpdateRequests)),this.rangeUpdateRequests=[],this.namesUpdateRequests=[]),(this.editedRangeDeltas.length>0||this.editedRangeFailures.length>0)&&(this.sendRecalcResults("Edited",this.editedRangeDeltas,[],this.editedRangeFailures),this.editedRangeDeltas=[],this.editedRangeFailures=[]),(this.dependentRangeDeltas.length>0||this.dependentRangeFailures.length>0)&&(this.sendRecalcResults("Dependents",this.dependentRangeDeltas,[],this.dependentRangeFailures),this.dependentRangeDeltas=[],this.dependentRangeFailures=[]),this.recalcFinished&&(this.onRecalcResults(Object(c.ab)(this.currentOutputStateId,"Dependents",!0,[],[],[])),this.recalcFinished=!1)},e.prototype.sendRecalcResults=function(e,t,r,n){for(var i=0;i<Object(o.b)(Object(o.b)(t.length,r.length),n.length);i+=10)this.onRecalcResults(Object(c.ab)(this.currentOutputStateId,e,!1,t.slice(i,i+10),r.slice(i,i+10),n.slice(i,i+10)))},e}();function B(e){return{kind:e.kind}}var U=function(){function e(e,t,r,i,a){void 0===i&&(i={}),void 0===a&&(a="Local");var o=this;this.onRecalcResults=e,this.onUpdateRequest=t,this.onGC=r,this.twConfig=i,this.dataTransformer=new j.a,this.currentInputStateId=-1/0,this.currentOutputStateId=-1/0,this.lastRecalcStatsStateId=-1/0,this.recalcStatistics=p.i,this.nameFailures=[],this.rangeFailures=[],this.numberFormatFailures=[],this.printFormulaFailures=[],this.inferFormatFailures=[],this.formatValueFailures=[],this.unhandledFailures=[],this.ignoredInputStats={},this.ignoredOutputStats={},this.initCalcThreadInside=function(e,t,r){return Object(n.__awaiter)(o,void 0,void 0,(function(){return Object(n.__generator)(this,(function(n){return[2,Object(s.e)(e,t,r,this.twConfig)]}))}))},this.setConfig({}),this.dataModel=new d.d(this.dataTransformer.getLangConfig(),this.config)}return Object.defineProperty(e.prototype,"document",{get:function(){return this.dataTransformer.document},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mathpack",{get:function(){return this.dataTransformer.getLangConfig().mathpack},enumerable:!1,configurable:!0}),e.prototype.ping=function(){},e.prototype.setInputStateId=function(e,t){var r=e-this.currentInputStateId;return r<0?(this.logInputStateIdDecrease(t),!1):(0!==r&&(this.flushInputLogs(),this.currentInputStateId=e),!0)},e.prototype.setOutputStateId=function(e){var t=e-this.currentOutputStateId;return t<0?(this.logOutputStateIdDecrease(),!1):(0!==t&&(this.flushOutputLogs(),this.currentOutputStateId=e),!0)},e.prototype.clearAsyncResumeRecalc=function(){void 0!==this.recalcLoop&&this.recalcLoop.stop()},e.prototype.resumeRecalc=function(){var e=this;this.flushInputLogs(),this.clearAsyncResumeRecalc(),this.recalcLoop=O((function(){var t=e.dataModel.step(),r=t.messages,n=t.queueEmpty;return r.length>0&&e.processRecalcResults(r),n?void 0:1}),{costThreshold:1,timeThreshold:this.config.yieldIntervalMs});var t=this.recalcLoop;return Object(P.c)(this.recalcLoop.promise,(function(){e.recalcLoop===t&&(e.recalcLoop=void 0)}))},e.prototype.testResumeRecalc=function(e){return Object(n.__awaiter)(this,void 0,void 0,(function(){var t;return Object(n.__generator)(this,(function(r){switch(r.label){case 0:return[4,this.resumeRecalc()];case 1:return r.sent(),void 0!==e&&(t="calc.calc.RecalcService: resumeRecalc finished; resumeId = ".concat(e),b.h.ULS.traceTag(574128980,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,t)),[2]}}))}))},e.prototype.processRecalcResults=function(e){for(var t=new L(this.onRecalcResults,this.onUpdateRequest,this.currentOutputStateId),r=0,n=e;r<n.length;r++){var i=n[r];if(i.kind!==p.d.GarbageCollected)if(i.kind!==p.d.ExperimentRunResult){if(this.setOutputStateId(i.stateId))switch(t.setOutputStateId(i.stateId),i.kind){case p.d.CellWrite:var a=i.cell,s=i.value,u=i.format,c=i.cellKind,l=i.formulaBarText,d=i.formatted,f=i.hasHyperlink,m=a.sheet,h=a.range,v=this.cellWriteToRangeDelta(m.index,h.row,h.col,s,u,l,d,f,"messages.<index>.value");Object(o.e)(v)&&t.pushCellWrite(c,v);break;case p.d.RangeWrite:var g=i.range,S=i.values,y=(c=i.cellKind,l=i.formulaBarText,d=i.formatted,i.formats);m=g.sheet,h=g.range;t.pushRangeWrite(c,this.rangeWriteToRangeDeltas(m.index,h,S,y,l,d,"messages.<index>.values"));break;case p.d.NameFailure:this.nameFailures.push(i);break;case p.d.RangeFailure:g=i.range,c=i.cellKind;var O=i.reason;t.pushRangeFailure(c,this.rangeFailure(g,O)),this.rangeFailures.push(i);break;case p.d.NumberFormatFailure:this.numberFormatFailures.push(i);break;case p.d.PrintFormulaFailure:this.printFormulaFailures.push(i);break;case p.d.InferFormatFailure:this.inferFormatFailures.push(i);break;case p.d.FormatValueFailure:g=i.range,c=i.cellKind,O=i.reason;t.pushRangeFailure(c,this.rangeFailure(g,O)),this.formatValueFailures.push(i);break;case p.d.UnhandledFailure:this.unhandledFailures.push(i);break;case p.d.UpdateRequest:t.pushUpdateRequest(Object(D.o)(i.range));break;case p.d.UpdateNamesRequest:t.pushUpdateNameRequest(i.scope);break;case p.d.RecalcStatistics:t.pushRecalcFinished(i.message===p.e.RecalcFinished),this.recalcStatistics=Object(p.k)(this.recalcStatistics,i);break;case p.d.WorkbookStatistics:this.logWorkbookStats(i.stateId,i.stats,i.p);break;case p.d.StateAdvanced:break;default:return Object(b.d)("calc.calc.RecalcServiceImpl.processRecalcResults",i)}}else this.logExperimentRunResult(i.experimentName,JSON.stringify({message:i.logMessage,timeoutReason:i.timeoutReason}));else this.onGC(i.minStateIdKept)}t.isRecalcFinished()&&this.flushOutputLogs(),t.flush()},e.prototype.logExperimentRunResult=function(e,t){b.h.ULS.traceTag(594409422,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"calc.calc.RecalcService: ".concat(e," done; ").concat(t)),"UnitExperiment"===e&&b.h.ULS.traceTag(538567681,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"calc.calc.RecalcService: UnitExperiment done: ".concat(t))},e.prototype.logAllFailureStats=function(){var e=this.nameFailures;this.nameFailures=[];var t=this.rangeFailures;this.rangeFailures=[];var r=this.numberFormatFailures;this.numberFormatFailures=[];var n=this.printFormulaFailures;this.printFormulaFailures=[];var i=this.inferFormatFailures;this.inferFormatFailures=[];var o=this.formatValueFailures;this.formatValueFailures=[];var s=this.unhandledFailures;this.unhandledFailures=[],this.logGenFailureStats(e,595194337,"name",a.TraceLevel.Info),this.logCellFailureStats(t,595658722,"range",a.TraceLevel.Info),this.logGenFailureStats(r,590484946,"format",a.TraceLevel.Info),this.logGenFailureStats(n,592730065,"print-formula",a.TraceLevel.Info),this.logGenFailureStats(i,590484947,"infer-format",a.TraceLevel.Info),this.logCellFailureStats(o,590484948,"format-value",a.TraceLevel.Info),this.logGenFailureStats(s,595194338,"unhandled",a.TraceLevel.Warning)},e.prototype.logGenFailureStats=function(e,t,r,n){if(0!==e.length){for(var i={},o=0,s=e;o<s.length;o++){x(i,s[o].reason)}var u="calc.calc.RecalcService: recalc ".concat(r," failures; stateId = ").concat(this.currentOutputStateId,", stats = ").concat(JSON.stringify(i));b.h.ULS.traceTag(t,a.LogCategory.msoulscat_ES_EWAJS,n,u),this.logJavaScriptFailures(e,r)}},e.prototype.logCellFailureStats=function(e,t,r,n){var i,o=this;if(0!==e.length){for(var s={},u=0,c=e;u<c.length;u++){var l=c[u],d=l.reason,f=l.cellKind;x(null!==(i=s[f])&&void 0!==i?i:s[f]={},d)}Object.getOwnPropertyNames(s).sort().forEach((function(e){var i=s[e],u="calc.calc.RecalcService: recalc ".concat(r," failures; stateId = ").concat(o.currentOutputStateId,", cell kind = ").concat(e,", stats = ").concat(JSON.stringify(i));b.h.ULS.traceTag(t,a.LogCategory.msoulscat_ES_EWAJS,n,u)})),this.logJavaScriptFailures(e,r)}},e.prototype.logJavaScriptFailures=function(e,t){for(var r=0,n=e;r<n.length;r++){var i=n[r].reason;if(i.kind===S.d.JavaScriptError){var o=Object(N.c)(i.error),s="calc.calc.RecalcService: recalc ".concat(t," JavaScript error: ").concat(o);b.h.ULS.traceTag(595658721,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,s)}}},e.prototype.logIgnoredStats=function(e,t,r,n){if(0!==Object.getOwnPropertyNames(n).length){var i="stateId = ".concat(t,", stats = ").concat(JSON.stringify(n)),o="calc.calc.RecalcService: ignored ".concat(r," data; ").concat(i);b.h.ULS.traceTag(e,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,o)}},e.prototype.logIgnoredInputStats=function(){this.logIgnoredStats(595658723,this.currentInputStateId,"input",this.ignoredInputStats),this.ignoredInputStats={}},e.prototype.logIgnoredOutputStats=function(){this.logIgnoredStats(595658752,this.currentOutputStateId,"output",this.ignoredOutputStats),this.ignoredOutputStats={}},e.prototype.logRecalcStats=function(){if(this.currentOutputStateId!==-1/0&&(this.lastRecalcStatsStateId!==this.currentOutputStateId||this.recalcStatistics!==p.i)){var e=this.recalcStatistics;this.recalcStatistics=p.i,this.lastRecalcStatsStateId=this.currentOutputStateId;var t=this.config.sampleRecalcStatisticsRate;if(this.dataModel.shouldSample(t)){var r="stateId = ".concat(this.currentOutputStateId,", stats = ").concat(JSON.stringify(e),", p = ").concat(JSON.stringify(t)),n="calc.calc.RecalcService: recalc statistics; ".concat(r);b.h.ULS.traceTag(595654593,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,n)}}},e.prototype.logUnavailableStats=function(){if(this.currentOutputStateId!==-1/0&&0!==this.rangeFailures.length){var e=function(e){for(var t,r,n,i,a,s,u,c=Object(o.h)(),f=Object(o.h)(),p=0,m=e;p<m.length;p++){var b=m[p],S=b.range;if(b.reason.kind===h.a.Unavailable)for(var y=0,O=b.reason.objects;y<O.length;y++){var C=O[y];C.kind===d.e.GridRange&&(Object(h.Q)(C.range.sheet,S.sheet)?c[C.range.sheet.index]=Object(g.j)(null!==(t=c[C.range.sheet.index])&&void 0!==t?t:v.d,!0!==C.unavailableCells?C.unavailableCells:v.d):f[C.range.sheet.index]=Object(g.j)(null!==(r=f[C.range.sheet.index])&&void 0!==r?r:v.d,!0!==C.unavailableCells?C.unavailableCells:v.d))}}var P=0,N=0,R=0,k=Object(o.h)();for(var T in c){var E=null!==(n=c[T])&&void 0!==n?n:v.d;k[T]=Object(g.j)(null!==(i=k[T])&&void 0!==i?i:v.d,E),Object(l.i)(E,(function(e){return P+=e.rows*e.cols,!0}))}for(var T in f){E=null!==(a=f[T])&&void 0!==a?a:v.d;k[T]=Object(g.j)(null!==(s=k[T])&&void 0!==s?s:v.d,E),Object(l.i)(E,(function(e){return N+=e.rows*e.cols,!0}))}for(var T in k){E=null!==(u=k[T])&&void 0!==u?u:v.d;Object(l.i)(E,(function(e){return R+=e.rows*e.cols,!0}))}return{numOfUnavailableCellsInTheSameSheet:P,numOfUnavailableCellsInDifferentSheet:N,totalNumOfUnavailableCells:R}}(this.rangeFailures);if(0!==e.numOfUnavailableCellsInTheSameSheet||0!==e.numOfUnavailableCellsInDifferentSheet||0!==e.totalNumOfUnavailableCells){var t="stateId = ".concat(this.currentOutputStateId,", stats = ").concat(JSON.stringify(e)),r="calc.calc.RecalcService: unavailable cells statistics; ".concat(t);b.h.ULS.traceTag(589632004,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,r)}}},e.prototype.logWorkbookStats=function(e,t,r){var n="stateId = ".concat(e,", stats = ").concat(JSON.stringify(t),", p = ").concat(JSON.stringify(r)),i="calc.calc.RecalcService: workbook statistics; ".concat(n);b.h.ULS.traceTag(595359882,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,i)},e.prototype.logInputStateIdDecrease=function(e){Object(C.y)(this.ignoredInputStats,"".concat(e,": input stateId went backwards"))},e.prototype.logOutputStateIdDecrease=function(){Object(C.y)(this.ignoredOutputStats,"output stateId went backwards")},e.prototype.flushInputLogs=function(){this.logIgnoredInputStats()},e.prototype.flushOutputLogs=function(){this.logUnavailableStats(),this.logAllFailureStats(),this.logIgnoredOutputStats(),this.logRecalcStats()},e.prototype.cellWriteToRangeDelta=function(e,t,r,n,i,a,s,u,l){if(Object(C.w)(n,C.q,this.ignoredOutputStats,l)){var d=Object(D.j)(this.mathpack,n),f=Object(D.a)(i);return Object(o.e)(a)||Object(o.e)(d)||Object(o.e)(f)||Object(o.e)(s)||Object(o.e)(u)?Object(c.R)(Object(c.gb)(e,t,r),Object(c.l)(a,d,f,s,u)):void 0}},e.prototype.rangeWriteToRangeDeltas=function(e,t,r,n,i,a,s){for(var u="".concat(s,".<index>.<index>"),c=t.row,l=t.col,d=t.rows,f=t.cols,p=[],m=0;m<d;m+=1)for(var h=0;h<f;h+=1){var v=this.cellWriteToRangeDelta(e,c+m,l+h,r[m][h],n[m][h],0===m&&0===h?i:void 0,a[m][h],void 0,u);Object(o.e)(v)&&p.push(v)}return p},e.prototype.rangeFailure=function(e,t){return Object(c.S)(Object(D.o)(e),B(t))},e.prototype.setA1ReferenceStyle=function(e){this.clearAsyncResumeRecalc(),this.dataTransformer.setA1ReferenceStyle(this.dataModel,this.currentInputStateId,e)},e.prototype.setLocale=function(e){this.clearAsyncResumeRecalc(),this.dataTransformer.setLocaleInfo(this.dataModel,this.currentInputStateId,e,this.ignoredInputStats)},e.prototype.setWorkbookProps=function(e){this.clearAsyncResumeRecalc(),this.dataTransformer.setWorkbookProps(this.dataModel,this.currentInputStateId,e,this.ignoredInputStats)},e.prototype.setNumberFormats=function(e,t){this.clearAsyncResumeRecalc(),this.dataModel.setNumberFormats(this.document,Object(C.x)(e,C.k,this.ignoredInputStats,"numberFormats"),t,this.currentInputStateId)},e.prototype.updateSheetNames=function(e,t){this.setInputStateId(e,"sheetNames")&&(this.clearAsyncResumeRecalc(),this.dataTransformer.updateSheetNames(this.dataModel,e,t,this.ignoredInputStats))},e.prototype.updateNamedObjects=function(e,t){this.setInputStateId(e,"namedObjectsUpdates")&&(this.clearAsyncResumeRecalc(),this.dataTransformer.updateNamedObjects(this.dataModel,e,t,this.ignoredInputStats))},e.prototype.updateUnusedCells=function(e,t){if(this.setInputStateId(e,"unusedCellsUpdates")){this.clearAsyncResumeRecalc();for(var r=0,n=Object(C.x)(t,C.t,this.ignoredInputStats,"unusedCellsUpdates");r<n.length;r++){var i=n[r];this.dataModel.extendUnusedRange(Object(D.q)(this.document,i),e)}}},e.prototype.updateRanges=function(e,t){this.setInputStateId(e,"rangeUpdates")&&(this.clearAsyncResumeRecalc(),this.applyRangeUpdates(e,t))},e.prototype.updateArrays=function(e,t){if(this.setInputStateId(e,"arrayUpdates")){this.clearAsyncResumeRecalc();for(var r=0,n=Object(C.x)(t,C.c,this.ignoredInputStats,"arrayUpdates");r<n.length;r++){var i=n[r],a=i.range,s=i.data,u=i.fromStateId,c=Object(D.p)(this.document,a);if(Object(o.e)(s)){var l=s.formulaBarText,d=s.isSpilled,f=Object(h.k)(c.range);this.dataModel.writeArrayFormula(e,c,l,f,d)}else Object(o.e)(u)}}},e.prototype.editRangeFormulas=function(e,t){this.setInputStateId(e,"rangeFormulaEdits")&&(this.clearAsyncResumeRecalc(),this.applyRangeFormulaEdits(t,e))},e.prototype.evalOnClonedModel=function(e,t){return this.evalOnClonedModelOnSnapshot(e,t)},e.prototype.evalOnClonedModelOnSnapshot=function(e,t,r){void 0===r&&(r=void 0),Object(b.e)("edits array should not be empty",t.length);var n=void 0===r?new d.b(this.dataModel):new d.c(r);return this.applyRangeUpdates(-1,e,n),this.applyRangeFormulaEdits(t,-1,n),n.resultsPromise.toPromise()},e.prototype.applyRangeUpdates=function(e,t,r){for(var n,i,a=0,s=Object(C.x)(t,C.p,this.ignoredInputStats,"rangeUpdates");a<s.length;a++){var u=s[a],c=u.range,d=u.excludeRows,v=u.excludeColumns,g=u.data,S=u.fromStateId,y=Object(D.p)(this.document,c),O=y.range,P=Object(D.c)(O.row,O.rows,l.d.row,d),N=Object(D.c)(O.col,O.cols,l.d.col,v),R=Object(D.l)(y,P,N),k=Object(o.e)(g)?Object(D.b)(this.mathpack,g.value):m.d;Object(b.g)("calc.calc.RecalcService: updateRanges oper",null!=k);var T=Object(h.k)(O);if(Object(o.e)(g)){var E=g.iformat,_="ArrayFormula"===g.kind?void 0:null!==(n=g.formulaBarText)&&void 0!==n?n:void 0,F=null!==(i=g.failureReason)&&void 0!==i?i:void 0,I="CellFormula"===g.kind;this.dataModel.writeCellContents(e,R,_,I,T,k,E,p.g.Blank,F,r)}else if(Object(o.f)(S))this.dataModel.writeCellContents(e,R,"",!1,T,m.d,f.c,void 0,void 0,r);else{if(r)throw new Error("Promote cell data is unsupported for cloned models.");this.dataModel.promoteCellContents(e,y,R,S)}r||(this.dataModel.writeHiddenRows(e,Object(D.n)(y,P)),this.dataModel.writeHiddenCols(e,Object(D.m)(y,N)))}},e.prototype.applyRangeFormulaEdits=function(e,t,r){for(var n=this,i=Object(C.x)(e,C.o,this.ignoredInputStats,"rangeFormulaEdits"),a=function(e){var i=e.kind,a=e.range,c=e.formulaBarText,d=e.value,f=e.origin,m=e.viewport,S=v.d;a.forEach((function(e){S=Object(g.j)(S,Object(l.f)(Object(D.p)(n.document,e).range))}));var y=Object(D.p)(s.document,a[0]),O=Object(o.e)(f)?Object(u.f)(f.row,f.column):Object(h.k)(y.range),C=Object(o.e)(m)?Object(D.p)(s.document,m):void 0,P=void 0;Object(o.e)(d)?(P=Object(D.b)(s.mathpack,d),Object(b.g)("calc.calc.RecalcService: editRangeFormulas oper",null!=P)):P=void 0;var N="CellFormula"===i||"Value"!==i&&void 0;r?s.dataModel.editCellContentsOnClone(Object(p.l)(y.sheet,S),c,N,O,r):s.dataModel.editCellContents(t,Object(p.l)(y.sheet,S),c,N,O,P,C)},s=this,c=0,d=i;c<d.length;c++){a(d[c])}},e.prototype.editRangeFormats=function(e,t){var r=this;if(this.setInputStateId(e,"rangeFormatEdits")){this.clearAsyncResumeRecalc();for(var n=Object(C.x)(t,C.n,this.ignoredInputStats,"rangeFormatEdits"),i=function(t){var n=t.range,i=t.operation,s=t.origin,c=t.viewport,d="SetFormat"!==i.kind||Object(o.f)(i.format)?"RibbonFormat"!==i.kind||Object(o.f)(i.ribbon)?"ChangeDecimals"!==i.kind||Object(o.f)(i.changeDecimals)?void 0:{kind:i.kind,changeDecimals:i.changeDecimals}:{kind:i.kind,ribbon:i.ribbon}:{kind:i.kind,format:i.format};Object(b.g)("calc.calc.RecalcService: editRangeFormats operation",null!=d);var f=v.d;n.forEach((function(e){f=Object(g.j)(f,Object(l.f)(Object(D.p)(r.document,e).range))}));var m=Object(D.p)(a.document,n[0]),S=null!=s?Object(u.f)(s.row,s.column):Object(h.k)(m.range),y=Object(o.e)(c)?Object(D.p)(a.document,c):void 0;a.dataModel.editCellFormats(e,Object(p.l)(m.sheet,f),d,S,y)},a=this,s=0,c=n;s<c.length;s++){i(c[s])}}},e.prototype.editArrayFormulas=function(e,t){if(this.setInputStateId(e,"arrayFormulaEdits")){this.clearAsyncResumeRecalc();for(var r=0,n=Object(C.x)(t,C.b,this.ignoredInputStats,"arrayFormulaEdits");r<n.length;r++){var i=n[r],a=i.range,s=i.formulaBarText,c=i.origin,l=i.viewport,d=Object(D.p)(this.document,a),f=Object(o.e)(c)?Object(u.f)(c.row,c.column):Object(u.f)(a.row,a.column),p=Object(o.e)(l)?Object(D.p)(this.document,l):void 0;this.dataModel.editArrayFormula(e,d,s,f,p)}}},e.prototype.editRangePaste=function(e,t){if(this.setInputStateId(e,"editRangePaste")){this.clearAsyncResumeRecalc();for(var r=0,n=Object(C.x)(t,C.l,this.ignoredInputStats,"pasteEdits");r<n.length;r++){var i=n[r],a=i.kind,s=i.source,u=i.target,c=i.viewport,l=Object(D.p)(this.document,s),d=Object(D.k)(this.document,u),f=Object(o.e)(c)?Object(D.p)(this.document,c):void 0;this.dataModel.editPaste(e,a,d,l,f)}}},e.prototype.setConfig=function(e){var t,r,n,i,a,o,s,c,l,d,f,p,m=Array.isArray(e.runExperiments)?{stepBudget:null!==(t=e.experimentStepBudget)&&void 0!==t?t:10,totalBudget:null!==(r=e.experimentTotalBudget)&&void 0!==r?r:1e4,factories:Object(R.b)(e.runExperiments)}:void 0;this.config={yieldIntervalMs:10,totalTimeMs:null!==(n=e.totalEvalTimeMs)&&void 0!==n?n:1e4,maxCellChain:2*u.q,maxNameChain:128,maxLambdaCalls:1e4,maxLambdaDepth:1e3,samplePrecisionEvalRate:null!==(i=e.samplePrecisionEvalRate)&&void 0!==i?i:.02,samplePrecisionPrintFormulaRate:null!==(a=e.samplePrecisionPrintFormulaRate)&&void 0!==a?a:.001,samplePrecisionPrintValueRate:null!==(o=e.samplePrecisionPrintValueRate)&&void 0!==o?o:1e-4,sampleRecalcStatisticsRate:null!==(s=e.sampleRecalcStatisticsRate)&&void 0!==s?s:.2,sampleWorkbookStatisticsRate:null!==(c=e.sampleWorkbookStatisticsRate)&&void 0!==c?c:.1,sampleCellEvalStopwatchRate:null!==(l=e.sampleCellEvalStopwatchRate)&&void 0!==l?l:.003,sampleRecalcEditedStopwatchRate:null!==(d=e.sampleRecalcEditedStopwatchRate)&&void 0!==d?d:1,sampleRecalcViewportStopwatchRate:null!==(f=e.sampleRecalcViewportStopwatchRate)&&void 0!==f?f:1,rngSeed:null!==(p=e.rngSeed)&&void 0!==p?p:1e3*Date.now(),volatileMode:null!=e.volatileMode?E.b[e.volatileMode]:E.b.Estimation,experimentFactories:m}},e.prototype.reconfigure=function(e){this.setConfig(e),this.dataModel.reconfigure(this.config)},e.prototype.clearCache=function(){this.clearAsyncResumeRecalc(),this.dataModel=new d.d(this.dataTransformer.getLangConfig(),this.config),this.recalcStatistics=p.i,this.nameFailures=[],this.rangeFailures=[],this.numberFormatFailures=[],this.unhandledFailures=[],this.ignoredInputStats={},this.ignoredOutputStats={},this.currentInputStateId=this.currentOutputStateId=this.lastRecalcStatsStateId=-1/0},e.prototype.evalFormula=function(e,t,r,n){var i=this;return Object(C.w)(r,C.r,this.ignoredInputStats,"origin")?Object(C.w)(n,C.f,this.ignoredInputStats,"format")?this.dataModel.evalFormula(e,t,Object(D.k)(this.document,r),Object(D.e)(n)).then((function(e){var t,r,n=e.value,a=e.formatted;if(Object(F.c)(n)){if(!Object(C.w)(n.value,C.q,i.ignoredOutputStats,"evalFormula"))throw new Error("ignored output");var o=Object(D.j)(i.mathpack,n.value);Object(b.g)("calc.calc.RecalcService.evalFormula",void 0!==o),t=Object(F.e)(o)}else t=Object(F.b)(B(n.reason));return r=void 0===a?void 0:Object(F.c)(a)?a:Object(F.b)(B(a.reason)),Object(c.t)(t,r)})):Promise.reject(new Error("ignored format")):Promise.reject(new Error("ignored input"))},e.prototype.evalFormulaOnSnapshot=function(e,t,r,n){return this.dataModel.evalFormula(-1,e,t,r,n)},e.prototype.testAdvanceState=function(e){this.setInputStateId(e,"testAdvanceState")&&(this.dataModel.testAdvanceState(e),this.clearAsyncResumeRecalc())},e.prototype.getMissingJSFeatures=function(){return Object(M.a)()},e}(),G=Object(y.mixin)(U,(function(e){return Object(A.f)().createRecalcSideGrid(e)}),["getSheetNames","getRangeValues","getRangeFormats","getRangeFormulae","getIntersectingTables","getIformats","discardSnapshot","createIGridExportEndpoint","getHiddenRows","getHiddenCols","evalClonedModelOnSnapshot","evalFormulaOnSnapshot"]);if(Object(I.b)("TESTING_ONLY_RECALC_SERVICE_IMPORTSCRIPTS_FAIL")&&(self.__retries=(null!==(_=self.__retries)&&void 0!==_?_:-1)+1,0===self.__retries))throw"";var K=function(e){var t=e.config,r=e.connection;return i.Endpoint.createInside(r,(function(e){return new G((function(){for(var t,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return(t=e.post).onRecalcResults.apply(t,r)}),(function(){for(var t,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return(t=e.post).onUpdateRequest.apply(t,r)}),(function(){for(var t,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return(t=e.post).onGC.apply(t,r)}),t,r.createMode)}))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.poundOperatorToken=t.atOperatorToken=t.rangeOperatorToken=t.geOperatorToken=t.leOperatorToken=t.neOperatorToken=t.gtOperatorToken=t.ltOperatorToken=t.eqOperatorToken=t.concatOperatorToken=t.percentOperatorToken=t.powOperatorToken=t.divOperatorToken=t.mulOperatorToken=t.subOperatorToken=t.addOperatorToken=t.operatorToken=t.identOrBooleanToken=t.literalToken=t.cellRefR1C1Token=t.cellRefA1Token=t.specialRefToken=t.assignSepToken=t.dotSepToken=t.qualSepToken=t.rowSepToken=t.colSepToken=t.listSepToken=t.rightSQuoteToken=t.rightBraceToken=t.rightBracketToken=t.rightParenToken=t.leftSQuoteToken=t.leftBraceToken=t.leftBracketToken=t.leftParenToken=t.identToken=t.escapeToken=t.unexpectedToken=t.spacesToken=t.endToken=t.badErrorOper=t.isBadErrorOper=t.badNumberOper=t.isNumberLikeOper=t.isBadNumberOper=t.TokenOperKind=t.SepId=t.DelimId=t.TokenKind=void 0,t.appendToken=void 0;var n,i,a,o,s=r(104),u=r(59),c=r(88),l=r(103),d=r(114),f=r(145),p=r(146),m=f.codePointAsterisk,h=f.codePointMinusSign,v=f.codePointPlusSign,g=f.codePointSlash,b=f.codePointSpace;function S(e){return e.kind===o.BadNumber||e.kind===l.OperKind.Number}function y(e,t,r,n){return{kind:e,start:t,chars:r,isIdentContinue:n}}!function(e){e[e.End=1]="End",e[e.Left=2]="Left",e[e.Right=3]="Right",e[e.Sep=4]="Sep",e[e.Operator=5]="Operator",e[e.Spaces=6]="Spaces",e[e.Ident=7]="Ident",e[e.CellRef=8]="CellRef",e[e.Literal=9]="Literal",e[e.SpecialRef=10]="SpecialRef",e[e.Unexpected=11]="Unexpected",e[e.Escape=12]="Escape"}(n=t.TokenKind||(t.TokenKind={})),function(e){e[e.Paren=1]="Paren",e[e.Bracket=2]="Bracket",e[e.Brace=3]="Brace",e[e.SQuote=4]="SQuote"}(i=t.DelimId||(t.DelimId={})),function(e){e[e.List=1]="List",e[e.Row=2]="Row",e[e.Col=3]="Col",e[e.Qual=4]="Qual",e[e.Dot=5]="Dot",e[e.Assign=6]="Assign"}(a=t.SepId||(t.SepId={})),function(e){e.BadNumber="BadNumber",e.BadError="BadError"}(o=t.TokenOperKind||(t.TokenOperKind={})),t.isBadNumberOper=function(e){return e.kind===o.BadNumber},t.isNumberLikeOper=S,t.badNumberOper={kind:o.BadNumber},t.isBadErrorOper=function(e){return e.kind===o.BadError},t.badErrorOper={kind:o.BadError};t.endToken=function(e){return y(n.End,e,"",!1)};t.spacesToken=function(e,t){return y(n.Spaces,e,t,!1)};t.unexpectedToken=function(e,t){return y(n.Unexpected,e,t,!1)};t.escapeToken=function(e,t){return y(n.Escape,e,t,!1)};function O(e,t,r,n){return{kind:e,start:t,chars:r,isIdentContinue:!1,value:n}}t.identToken=function(e,t){return y(n.Ident,e,t,!0)};t.leftParenToken=function(e){return O(n.Left,e,"(",i.Paren)};t.leftBracketToken=function(e,t){return O(n.Left,e,t,i.Bracket)};t.leftBraceToken=function(e,t){return O(n.Left,e,t,i.Brace)};t.leftSQuoteToken=function(e){return O(n.Left,e,"'",i.SQuote)};t.rightParenToken=function(e){return O(n.Right,e,")",i.Paren)};t.rightBracketToken=function(e,t){return O(n.Right,e,t,i.Bracket)};t.rightBraceToken=function(e,t){return O(n.Right,e,t,i.Brace)};t.rightSQuoteToken=function(e){return O(n.Right,e,"'",i.SQuote)};t.listSepToken=function(e,t){return O(n.Sep,e,t,a.List)};t.colSepToken=function(e,t){return O(n.Sep,e,t,a.Col)};t.rowSepToken=function(e,t){return O(n.Sep,e,t,a.Row)};t.qualSepToken=function(e){return O(n.Sep,e,"!",a.Qual)};t.dotSepToken=function(e){return O(n.Sep,e,".",a.Dot)};t.assignSepToken=function(e){return O(n.Sep,e,":=",a.Assign)};function C(e,t,r,i,a,o,s){return{kind:n.CellRef,start:e,chars:t,isIdentContinue:r,row:i,col:a,refStyle:o,isBadLocale:s}}function P(e,t,r,i){void 0===i&&(i=!0);var a=r.kind===l.OperKind.Boolean||S(r)&&function(e){for(var t=0,r=(0,d.codePointIterator)(e);t<r.length;t++){var n=r[t];if(n===v||n===h||n===m||n===b||n===g)return!1}return!0}(t);return{kind:n.Literal,start:e,chars:t,isIdentContinue:a,oper:r,hasRight:i}}function N(e,t,r){return{kind:n.Operator,start:e,chars:t,isIdentContinue:!1,value:r}}function R(e){var t=s.operatorStrings[e];if(null==t)throw new Error("operatorTokenMaker: invalid operator ".concat(e));return function(r){return N(r,t,e)}}t.specialRefToken=function(e,t,r){return O(n.SpecialRef,e,t,r)},t.cellRefA1Token=function(e,t,r,n){return C(e,t,(null==r||"object"==typeof r&&r.kind===u.PosKind.Rel)&&(null==n||"object"==typeof n&&n.kind===u.PosKind.Rel),r,n,u.RefStyle.A1,!1)},t.cellRefR1C1Token=function(e,t,r,n,i){return void 0===i&&(i=!1),C(e,t,!(r!==p.SpecialPos.RCNoNum&&null!=r&&r.kind!==u.PosKind.Abs||n!==p.SpecialPos.RCNoNum&&null!=n&&n.kind!==u.PosKind.Abs),r,n,u.RefStyle.R1C1,i)},t.literalToken=P,t.identOrBooleanToken=function(e,r,n){return 0===e.stringCompareCI(e.falseName,n)?P(r,n,c.falseOper):0===e.stringCompareCI(e.trueName,n)?P(r,n,c.trueOper):(0,t.identToken)(r,n)},t.operatorToken=N,t.addOperatorToken=R(s.OperatorId.Add),t.subOperatorToken=R(s.OperatorId.Sub),t.mulOperatorToken=R(s.OperatorId.Mul),t.divOperatorToken=R(s.OperatorId.Div),t.powOperatorToken=R(s.OperatorId.Pow),t.percentOperatorToken=R(s.OperatorId.Percent),t.concatOperatorToken=R(s.OperatorId.Concat),t.eqOperatorToken=R(s.OperatorId.Eq),t.ltOperatorToken=R(s.OperatorId.Lt),t.gtOperatorToken=R(s.OperatorId.Gt),t.neOperatorToken=R(s.OperatorId.Ne),t.leOperatorToken=R(s.OperatorId.Le),t.geOperatorToken=R(s.OperatorId.Ge),t.rangeOperatorToken=R(s.OperatorId.Range),t.atOperatorToken=R(s.OperatorId.At),t.poundOperatorToken=R(s.OperatorId.Pound),t.appendToken=function(e,t,r){return r.push(t),t.start+e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSheetGridRange=t.isSheetGridCellEqual=t.isSheetGridCell=t.isRichOper=t.isReadOperEqual=t.isRangeOper=t.isRangeOpNoMissing=t.isRangeOpClosed=t.isPrimitiveOper=t.isOperatorNode=t.isNumberOper=t.isNumberNode=t.isNameScopeEqual=t.isMissingOper=t.isMissingNode=t.isGridRangeEqual=t.isGridCellEqual=t.isGridCell=t.isErrorOper=t.isDocumentLocEqual=t.isCommaOpRefWellFormed=t.isCommaOpNoBadOrMissing=t.isCommaOpClosed=t.isBooleanOper=t.isBooleanNode=t.isBlankOper=t.isArrayOper=t.internal=t.gridRangesJoin=t.gridRangeSize=t.gridRangeJoinOpt=t.gridRangeJoin=t.gridRangeIsects=t.gridRangeIsect=t.gridRangeExcept=t.gridRangeCompare=t.gridRangeAnchor=t.gridCellRange=t.gridCellImplicitIsect=t.getWorksheetFuncId=t.getUserDefinedFuncName=t.getSubExpressionFromPosition=t.getBoundName=t.getArguments=t.getArgType=t.forEachTileInRange=t.forEachCellInRange=t.createFailureErrorClass=t.ReasonKind=t.LangReasonKind=void 0,t.applyComparison=t.unavailable=t.shouldFieldRefBeBracketed=t.sheetGridRangeAnchor=t.notImplemented=t.normalizeCommaOpRef=t.isWriteOper=t.isWellFormed=t.isWSFNode=t.isValidArgsLength=t.isUnqualifiedNameNode=t.isStringOper=t.isSheetIndexEqual=t.isSheetIndex=t.isSheetGridRangeEqual=void 0;var n=r(3);t.LangReasonKind=n.util.LangReasonKind,t.ReasonKind=n.util.ReasonKind,t.createFailureErrorClass=n.util.createFailureErrorClass,t.forEachCellInRange=n.util.forEachCellInRange,t.forEachTileInRange=n.util.forEachTileInRange,t.getArgType=n.util.getArgType,t.getArguments=n.util.getArguments,t.getBoundName=n.util.getBoundName,t.getSubExpressionFromPosition=n.util.getSubExpressionFromPosition,t.getUserDefinedFuncName=n.util.getUserDefinedFuncName,t.getWorksheetFuncId=n.util.getWorksheetFuncId,t.gridCellImplicitIsect=n.util.gridCellImplicitIsect,t.gridCellRange=n.util.gridCellRange,t.gridRangeAnchor=n.util.gridRangeAnchor,t.gridRangeCompare=n.util.gridRangeCompare,t.gridRangeExcept=n.util.gridRangeExcept,t.gridRangeIsect=n.util.gridRangeIsect,t.gridRangeIsects=n.util.gridRangeIsects,t.gridRangeJoin=n.util.gridRangeJoin,t.gridRangeJoinOpt=n.util.gridRangeJoinOpt,t.gridRangeSize=n.util.gridRangeSize,t.gridRangesJoin=n.util.gridRangesJoin,t.internal=n.util.internal,t.isArrayOper=n.util.isArrayOper,t.isBlankOper=n.util.isBlankOper,t.isBooleanNode=n.util.isBooleanNode,t.isBooleanOper=n.util.isBooleanOper,t.isCommaOpClosed=n.util.isCommaOpClosed,t.isCommaOpNoBadOrMissing=n.util.isCommaOpNoBadOrMissing,t.isCommaOpRefWellFormed=n.util.isCommaOpRefWellFormed,t.isDocumentLocEqual=n.util.isDocumentLocEqual,t.isErrorOper=n.util.isErrorOper,t.isGridCell=n.util.isGridCell,t.isGridCellEqual=n.util.isGridCellEqual,t.isGridRangeEqual=n.util.isGridRangeEqual,t.isMissingNode=n.util.isMissingNode,t.isMissingOper=n.util.isMissingOper,t.isNameScopeEqual=n.util.isNameScopeEqual,t.isNumberNode=n.util.isNumberNode,t.isNumberOper=n.util.isNumberOper,t.isOperatorNode=n.util.isOperatorNode,t.isPrimitiveOper=n.util.isPrimitiveOper,t.isRangeOpClosed=n.util.isRangeOpClosed,t.isRangeOpNoMissing=n.util.isRangeOpNoMissing,t.isRangeOper=n.util.isRangeOper,t.isReadOperEqual=n.util.isReadOperEqual,t.isRichOper=n.util.isRichOper,t.isSheetGridCell=n.util.isSheetGridCell,t.isSheetGridCellEqual=n.util.isSheetGridCellEqual,t.isSheetGridRange=n.util.isSheetGridRange,t.isSheetGridRangeEqual=n.util.isSheetGridRangeEqual,t.isSheetIndex=n.util.isSheetIndex,t.isSheetIndexEqual=n.util.isSheetIndexEqual,t.isStringOper=n.util.isStringOper,t.isUnqualifiedNameNode=n.util.isUnqualifiedNameNode,t.isValidArgsLength=n.util.isValidArgsLength,t.isWSFNode=n.util.isWSFNode,t.isWellFormed=n.util.isWellFormed,t.isWriteOper=n.util.isWriteOper,t.normalizeCommaOpRef=n.util.normalizeCommaOpRef,t.notImplemented=n.util.notImplemented,t.sheetGridRangeAnchor=n.util.sheetGridRangeAnchor,t.shouldFieldRefBeBracketed=n.util.shouldFieldRefBeBracketed,t.unavailable=n.util.unavailable,t.applyComparison=n.util.applyComparison},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.strictArray2D=t.singletonArray2D=t.rowArray2D=t.jaggedArray=t.constantArray2D=t.constantArray=t.colArray2D=t.broadcastArray2D=t.broadcastArray=t.array2DToJaggedArray=t.array2DForall2=t.array2DForall=t.StrictSparseArray2D=t.StrictArray2D=t.NonstrictSparseArray2D=t.NonstrictArray2D=void 0;var n=r(7);t.NonstrictArray2D=n.arrayUtils.NonstrictArray2D,t.NonstrictSparseArray2D=n.arrayUtils.NonstrictSparseArray2D,t.StrictArray2D=n.arrayUtils.StrictArray2D,t.StrictSparseArray2D=n.arrayUtils.StrictSparseArray2D,t.array2DForall=n.arrayUtils.array2DForall,t.array2DForall2=n.arrayUtils.array2DForall2,t.array2DToJaggedArray=n.arrayUtils.array2DToJaggedArray,t.broadcastArray=n.arrayUtils.broadcastArray,t.broadcastArray2D=n.arrayUtils.broadcastArray2D,t.colArray2D=n.arrayUtils.colArray2D,t.constantArray=n.arrayUtils.constantArray,t.constantArray2D=n.arrayUtils.constantArray2D,t.jaggedArray=n.arrayUtils.jaggedArray,t.rowArray2D=n.arrayUtils.rowArray2D,t.singletonArray2D=n.arrayUtils.singletonArray2D,t.strictArray2D=n.arrayUtils.strictArray2D},function(e,t,r){"use strict";var n;r.d(t,"a",(function(){return n})),function(e){e.Dev="Dev",e.Stable="Stable"}(n||(n={}))},function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a}));var n=r(7),i=(n.anonymizer.anonymize,n.anonymizer.anonymizeFormulaString),a=n.anonymizer.anonymizeMagnitude;n.anonymizer.kindAnonymizers},function(e,t,r){"use strict";var n=r(18),i=r(9),a=r(4),o=r(2),s=r(8),u=r(281),c=r(7),l=r(85),d=r(83),f=r(12),p=r(0);var m=function(){function e(e){void 0===e&&(e=75),this.timeLimitMS=e,this.result=void 0}return Object.defineProperty(e.prototype,"done",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.setContext=function(e){var t=e.documents;try{i.h.ULS.traceTag(578588694,f.c.msoulscat_ES_EWAJS,f.i.Info,"calc.calc.RecalcService: ExceLint experiment setContext started");var r=function(e){for(var t,r,n,i,a=e.getServerDocument(),u=[],d=0,f=e.getServerAvailableCells();d<f.length;d++){var m=f[d],h="UndefinedSheet";if(void 0!==a){var v=e.getSheetName(a,m.sheetIdx.index);v.kind===p.a.Success&&(h=v.value)}var g=e.getServerUsedRange(m.sheetIdx);if(g.kind!==p.a.Failure&&void 0!==g.value){var b=g.value.sheet,S=Object(o.__assign)({},g.value.range);S.cols=Math.min(S.cols,75),S.rows=Math.min(S.rows,1e3);for(var y=[],O=[],C=[],P=0,N=S.row,R=S.row+S.rows-1;N<=R;N+=1){for(var k=[],T=[],E=[],_=S.col,F=S.col+S.cols-1;_<=F;_+=1){var I=Object(s.r)(b,Object(s.f)(N,_)),A=e.getServerValue(I),M=A.kind===p.a.Success?JSON.stringify(A.value):"";T.push(M);var w=e.getServerFormat(I),D=w.kind===p.a.Success?Object(c.fnv1a)(JSON.stringify(w.value)).toString():"";E.push(D);var j=e.getServerFormula(I),x=j.kind===p.a.Success?null===(r=null===(t=j.value)||void 0===t?void 0:t[1].compiledFmla)||void 0===r?void 0:r.getValue():void 0,L=(null==x?void 0:x.kind)===p.a.Success&&null!==(i=null===(n=j.value)||void 0===n?void 0:n[1].fmla)&&void 0!==i?i:"";""!==L&&(P+=1),k.push(L)}y.push(k),O.push(T),C.push(E)}if(0!==P){var B={sheetName:h,usedRangeAddress:Object(l.e)(e.config.localeInfo,S,h),values:O,formulas:y,styles:C};u.push(B)}}}return{workbookName:"PartialWorkbook",worksheets:u}}(t);this.result=Object(u.detect_errors)(r,void 0,void 0,this.timeLimitMS)}catch(e){this.result="ExceLint experiment crashed with error: ".concat(e)}},e.prototype.step=function(){},Object.defineProperty(e.prototype,"report",{get:function(){var e=this;return void 0===this.result||"string"==typeof this.result?[]:Object.keys(this.result.worksheets).map((function(t){var r=e.result.worksheets[t],n=r.exampleFixes.map((function(e,t){var n=r.proposedFixes[t][0],i=e.rangeSizes,a=i.reduce((function(e,t){return e+t}),0);return{anomalousnessIndex:n,categories:e.bin,sizeOfCellRange:a,sizeOfEachSFRRange:i,redactedFormulaForEachSFR:e.formulas.map(d.a),stylesDiffer:!e.sameFormat,operatorsDiffer:null,direction:e.direction}})),i=n.map((function(e){return e.sizeOfEachSFRRange.length})).reduce((function(e,t){return e+t}),0);return{totalFormulas:r.numFormulaCells,totalSimilarFormulaRanges:i,numberOfAdjacentSFRs:n.length,numberOfAnomalousRanges:r.suspiciousRanges,numberOfCellsInAnomalousRanges:r.suspiciousCells,anomalies:n,elapsedTimeSeconds:r.elapsedTimeSeconds,proposedFixesTimeSeconds:r.proposedFixesTimeSeconds,adjustProposedFixesTimeSeconds:r.adjustProposedFixesTimeSeconds,adjustFormatProposedFixesTimeSeconds:r.adjustFormatProposedFixesTimeSeconds,exampleFixesTimeSeconds:r.exampleFixesTimeSeconds,numCountingTimeSeconds:r.numCountingTimeSeconds,columns:r.columns,rows:r.rows}})).filter((function(e){return e.totalFormulas>0}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"resultLogMessage",{get:function(){return"string"==typeof this.result?this.result:void 0===this.result?"ExceLint experiment return <undefined>":"ExceLint experiment done. Result: ".concat(JSON.stringify(this.report))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"failedLogMessage",{get:function(){return this.resultLogMessage+" BTW, experiment ran out of time budget"},enumerable:!1,configurable:!0}),e}(),h=r(166),v=r(41);r.d(t,"a",(function(){return g})),r.d(t,"b",(function(){return y})),r.d(t,"c",(function(){return O}));var g,b=function(){function e(e){this.stepDelay=e,this.done=!1,this.resultLogMessage="TestExperiment",this.failedLogMessage="TestExperiment exceeded budget",this.iters=0}return e.create=function(t){if("number"==typeof t)return new e(t);var r="calc.calc.TestExperiment: expected number; given ".concat(t);i.h.ULS.traceTag(591974878,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,r)},e.prototype.setContext=function(){},e.prototype.step=function(){for(var e=Object(a.j)();Object(a.j)()<e+this.stepDelay;);this.iters+=1,this.iters>1&&(this.done=!0)},e}();!function(e){e.OneShot="OneShot",e.Recurring="Recurring",e.Precision="Precision"}(g||(g={}));var S={TestExperiment:function(e){return{experimentName:"TestExperiment",kind:g.OneShot,create:function(){return b.create(e)}}},ExceLintExperiment:function(){return{experimentName:"ExceLintExperiment",kind:g.OneShot,create:function(){return new m}}},UnitExperiment:function(){return{experimentName:"UnitExperiment",kind:g.OneShot,create:function(){return new h.a},stepBudget:Object(v.getNumberFeatureGate)("Microsoft.Office.Excel.UnitStepBudget")}}};function y(e){return e.map((function(e){var t,r=e.name,n=e.param;return null===(t=S[r])||void 0===t?void 0:t.call(S,n)})).filter((function(e){return void 0!==e}))}function O(e,t){S[e]=t}},function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a})),r.d(t,"c",(function(){return o})),r.d(t,"d",(function(){return s})),r.d(t,"e",(function(){return u})),r.d(t,"f",(function(){return c})),r.d(t,"g",(function(){return l}));var n=r(3),i=(n.cellFormat.canonicaliseBrackets,n.cellFormat.canonicaliseCellPos,n.cellFormat.canonicaliseCol,n.cellFormat.canonicaliseColRange,n.cellFormat.canonicaliseRangePos,n.cellFormat.canonicaliseRow,n.cellFormat.canonicaliseRowRange,n.cellFormat.columnName),a=n.cellFormat.formatCellPos,o=n.cellFormat.formatCol,s=n.cellFormat.formatColRange,u=n.cellFormat.formatGridRangeA1,c=(n.cellFormat.formatQualifier,n.cellFormat.formatRangePos,n.cellFormat.formatRow),l=n.cellFormat.formatRowRange;n.cellFormat.quoteQualifier,n.cellFormat.resolvePosition,n.cellFormat.shouldQuoteQualifier},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.LangReasonKind=t.isReadOperEqual=t.isWriteOper=t.isPrimitiveOper=t.isRichOper=t.isBlankOper=t.isMissingOper=t.isArrayOper=t.isRangeOper=t.isErrorOper=t.isBooleanOper=t.isStringOper=t.isNumberOper=t.shouldFieldRefBeBracketed=t.isValidArgsLength=t.getArgType=t.isBooleanNode=t.isNumberNode=t.isMissingNode=t.isUnqualifiedNameNode=t.isWSFNode=t.isOperatorNode=t.getArguments=t.getSubExpressionFromPosition=t.gridCellRange=t.sheetGridRangeAnchor=t.gridRangeAnchor=t.isSheetGridRangeEqual=t.isSheetGridCellEqual=t.isGridRangeEqual=t.isGridCellEqual=t.isNameScopeEqual=t.isSheetIndexEqual=t.isDocumentLocEqual=t.gridRangeSize=t.gridRangeExcept=t.gridRangeCompare=t.gridCellImplicitIsect=t.gridRangeIsects=t.gridRangeIsect=t.gridRangesJoin=t.gridRangeJoinOpt=t.gridRangeJoin=t.forEachTileInRange=t.forEachCellInRange=t.isWellFormed=t.isSheetGridRange=t.isSheetIndex=t.isSheetGridCell=t.isGridCell=void 0,t.applyComparison=t.normalizeCommaOpRef=t.isRangeOpNoMissing=t.isRangeOpClosed=t.isCommaOpNoBadOrMissing=t.isCommaOpClosed=t.isCommaOpRefWellFormed=t.getBoundName=t.getUserDefinedFuncName=t.getWorksheetFuncId=t.createFailureErrorClass=t.internal=t.unavailable=t.notImplemented=t.ReasonKind=void 0;var i=r(2),a=r(70),o=r(75);Object.defineProperty(t,"isGridCell",{enumerable:!0,get:function(){return o.isGridCell}}),Object.defineProperty(t,"isSheetGridCell",{enumerable:!0,get:function(){return o.isSheetGridCell}});var s=r(69),u=r(96),c=r(110),l=r(58),d=r(335),f=r(128),p=r(75);function m(e,t){var r=e.row,n=e.col,i=e.rows,a=e.cols,s=t.row,u=t.col,c=t.rows,d=t.cols,f=(0,l.fastMin)(r,s),p=(0,l.fastMin)(n,u),m=(0,l.fastMax)(r+i,s+c)-f,h=(0,l.fastMax)(n+a,u+d)-p;return(0,o.unsafeGridRange)(f,p,m,h)}function h(e,t){return e===t||e.name===t.name&&e.path===t.path}function v(e,t){return h(e.document,t.document)&&e.index===t.index}function g(e,t){return e.row===t.row&&e.col===t.col}function b(e,t){return e.row===t.row&&e.col===t.col&&e.rows===t.rows&&e.cols===t.cols}function S(e){return(0,o.isGridCell)(e)?e:(0,o.unsafeGridRange)(e.row,e.col,1,1)}Object.defineProperty(t,"isSheetIndex",{enumerable:!0,get:function(){return p.isSheetIndex}}),Object.defineProperty(t,"isSheetGridRange",{enumerable:!0,get:function(){return p.isSheetGridRange}}),t.isWellFormed=function(e){return e.isWellFormed},t.forEachCellInRange=function(e,t){if((0,o.isGridCell)(e))return t(e,0,0);for(var r=e.row,n=e.rows,i=e.col,a=e.cols,s=0;s<n;s+=1)for(var u=0;u<a;u+=1)if(!t((0,o.gridCell)(r+s,i+u),s,u))return!1;return!0},t.forEachTileInRange=function(e,t,r){var n=e.row,i=e.rows,s=e.col,u=e.cols;(0,a.assertPositiveInteger)("calc.lang.forEachTileInRange",t),(0,a.assertIndex)("calc.lang.forEachTileInRange",n,o.sheetRows),(0,a.assertIndex)("calc.lang.forEachTileInRange",s,o.sheetCols),(0,a.assertPositiveLength)("calc.lang.forEachTileInRange",i,o.sheetRows-n),(0,a.assertPositiveLength)("calc.lang.forEachTileInRange",u,o.sheetCols-s);for(var c=n;c<n+i;c+=t)for(var d=s;d<s+u;d+=t)if(!r((0,o.unsafeGridRange)(c,d,(0,l.fastMin)(t,i+n-c),(0,l.fastMin)(t,u+s-d))))return!1;return!0},t.gridRangeJoin=m,t.gridRangeJoinOpt=function(e,t){return e?t?m(e,t):e:t},t.gridRangesJoin=function(e){return 0===e.length&&(0,a.assertFalse)("calc.runtime.gridRangesJoin: expected nonempty range array"),e.reduce(m)},t.gridRangeIsect=function(e,t){var r=e.row,n=e.col,i=e.rows,a=e.cols,s=t.row,u=t.col,c=t.rows,d=t.cols,f=(0,l.fastMax)(r,s),p=(0,l.fastMax)(n,u),m=(0,l.fastMin)(r+i,s+c)-f,h=(0,l.fastMin)(n+a,u+d)-p;if(!(m<=0||h<=0))return(0,o.unsafeGridRange)(f,p,m,h)},t.gridRangeIsects=function(e,t){var r=e.row,n=e.col,i=e.rows,a=e.cols,o=t.row,s=t.col,u=t.rows,c=t.cols;return(0,l.fastMax)(r,o)<(0,l.fastMin)(r+i,o+u)&&(0,l.fastMax)(n,s)<(0,l.fastMin)(n+a,s+c)},t.gridCellImplicitIsect=function(e,t){var r=e.row,n=e.col,i=t.row,a=t.col,s=t.rows,u=t.cols,c=i<=r&&r<i+s,l=a<=n&&n<a+u;return c&&l?(0,o.gridCell)(r,n):c&&1===u?(0,o.gridCell)(r,a):l&&1===s?(0,o.gridCell)(i,n):1===u&&1===s?(0,o.gridCell)(i,a):void 0},t.gridRangeCompare=function(e,t){var r=e.row,n=e.col,i=e.rows,a=e.cols,o=t.row,s=t.col,u=r+i,c=o+t.rows,l=n+a,d=s+t.cols;return r===o&&u===c&&n===s&&l===d?0:r<=o&&u>=c&&n<=s&&l>=d?1:r>=o&&u<=c&&n>=s&&l<=d?-1:void 0},t.gridRangeExcept=function(e,t){var r=[e.row,e.row+e.rows],n=[e.col,e.col+e.cols],i=[t.row,t.row+t.rows],a=[t.col,t.col+t.cols],s=(0,d.ivlCompare)(r,i),u=(0,d.ivlCompare)(n,a);if(void 0!==s&&s<=0){var c=(0,d.ivlExcept)(n,a);if(void 0!==c)return(0,o.gridRange)(e.row,c[0],e.rows,c[1]-c[0])}if(void 0!==u&&u<=0){var l=(0,d.ivlExcept)(r,i);if(void 0!==l)return(0,o.gridRange)(l[0],e.col,l[1]-l[0],e.cols)}},t.gridRangeSize=function(e){return e.rows*e.cols},t.isDocumentLocEqual=h,t.isSheetIndexEqual=v,t.isNameScopeEqual=function(e,t){return h(e.document,t.document)&&e.index===t.index},t.isGridCellEqual=g,t.isGridRangeEqual=b,t.isSheetGridCellEqual=function(e,t){return v(e.sheet,t.sheet)&&g(e.range,t.range)},t.isSheetGridRangeEqual=function(e,t){return v(e.sheet,t.sheet)&&b(e.range,t.range)},t.gridRangeAnchor=S,t.sheetGridRangeAnchor=function(e){return(0,o.isSheetGridCell)(e)?e:(0,o.sheetGridCell)(e.sheet,S(e.range))},t.gridCellRange=function(e,t){var r=e.row,n=e.col,i=t.row,a=t.col;return(0,o.unsafeGridRange)((0,l.fastMin)(r,i),(0,l.fastMin)(n,a),Math.abs(i-r)+1,Math.abs(a-n)+1)},t.getSubExpressionFromPosition=function(e,t){function r(r){var n=e.spans[r.label];return void 0!==n&&n.start<=t&&t<n.end}for(var n=e.node,i=!0;i;)switch(i=!1,n.kind){case s.NodeKind.Array:for(var o=n.nodes,u=o.length-1;!i&&u>=0;u-=1)for(var c=o[u],l=c.length-1;!i&&l>=0;l-=1){r(f=c[l])&&(n=f,i=!0)}break;case s.NodeKind.App:case s.NodeKind.Let:case s.NodeKind.Lambda:var d=n.args.map((function(e){return e.kind===s.NodeKind.Param?e.name.name:e}));for(l=d.length-1;!i&&l>=0;l-=1){r(f=d[l])&&(n=f,i=!0)}break;case s.NodeKind.Paren:var f;r(f=n.node)&&(n=f,i=!0);break;case s.NodeKind.Bad:case s.NodeKind.Name:case s.NodeKind.CellRef:case s.NodeKind.StructRef:case s.NodeKind.Literal:break;case s.NodeKind.FieldRef:r(n.lhs)&&(n=n.lhs,i=!0);break;default:(0,a.assertNever)("getSubExpressionFromPosition",n)}return n};var y=[];function O(e){return e.kind===s.NodeKind.Literal&&R(e.oper)}function C(e){return e.kind===s.NodeKind.Literal&&N(e.oper)}function P(e){return e.kind===u.OperKind.Number}function N(e){return e.kind===u.OperKind.Boolean}function R(e){return e.kind===u.OperKind.Missing}t.getArguments=function(e){return 0===function(e){return 1===e.args.length&&O(e.args[0])?0:e.args.length}(e)?y:e.args},t.isOperatorNode=function(e){return e.kind===s.NodeKind.Operator},t.isWSFNode=function(e){return e.kind===s.NodeKind.WSF},t.isUnqualifiedNameNode=function(e){return e.kind===s.NodeKind.Name&&void 0===e.qualifier},t.isMissingNode=O,t.isNumberNode=function(e){return e.kind===s.NodeKind.Literal&&P(e.oper)},t.isBooleanNode=C,t.getArgType=function(e,t,r){var n=e.maxArgs,i=e.headTypes,o=e.restTypes,s=e.tailTypes;if((0,a.assertPositiveInteger)("calc.runtime.getArgType: n",r),(0,a.assertIndex)("calc.runtime.getArgType: i",t,r),t>=n)return u.SignatureType.None;if(t<i.length)return i[t];if(0===o.length)return u.SignatureType.None;if(t<i.length+o.length)return o[t-i.length];var c=(r-i.length)%o.length;return c>s.length?u.SignatureType.None:t>=r-c?s[t-(r-c)]:o[(t-i.length)%o.length]},t.isValidArgsLength=function(e,t){var r=e.minArgs,n=e.maxArgs,i=e.headTypes,a=e.restTypes,o=e.tailTypes;return!(t<r||t>n)&&(t<=i.length+a.length||0!==a.length&&(t-i.length)%a.length<=o.length)},t.shouldFieldRefBeBracketed=function(e,t,r){return r.length>0&&t.field.kind===s.NodeKind.Name&&(C(e)||e.kind===s.NodeKind.Name||e.kind===s.NodeKind.CellRef)},t.isNumberOper=P,t.isStringOper=function(e){return e.kind===u.OperKind.String},t.isBooleanOper=N,t.isErrorOper=function(e){return e.kind===u.OperKind.Error},t.isRangeOper=function(e){return e.kind===u.OperKind.Range},t.isArrayOper=function(e){return e.kind===u.OperKind.Array},t.isMissingOper=R,t.isBlankOper=function(e){return e.kind===u.OperKind.Blank},t.isRichOper=function(e){return e.kind===u.OperKind.Rich};var k=u.OperKind.Number|u.OperKind.String|u.OperKind.Boolean;t.isPrimitiveOper=function(e){return 0!=(e.kind&k)};var T,E=k|u.OperKind.Error|u.OperKind.Array|u.OperKind.Rich;t.isWriteOper=function(e){return 0!=(e.kind&E)},t.isReadOperEqual=function e(t,r,n,i){if(n.kind!==r.kind)return!1;switch(n.kind){case u.OperKind.Boolean:case u.OperKind.String:return n.value===r.value;case u.OperKind.Number:return 0===t.cond2(n,r);case u.OperKind.Error:return n.type===r.type;case u.OperKind.Rich:return i;case u.OperKind.Array:var o=r;if(n.cols!==o.cols||n.rows!==o.rows)return!1;for(var s=0;s<n.rows;s+=1)for(var c=n.opers[s],l=o.opers[s],d=0;d<n.cols;d+=1)if(!e(t,l[d],c[d],i))return!1;return!0;case u.OperKind.Blank:return!0;default:return(0,a.assertNever)("calc.lang.readOperEq",n)}},function(e){e.NotImplemented="NotImplemented",e.Unavailable="Unavailable",e.Internal="Internal"}(T=t.LangReasonKind||(t.LangReasonKind={})),t.ReasonKind=i.__assign(i.__assign({},c.ReasonKind),T),t.notImplemented=function(e){return{kind:t.ReasonKind.NotImplemented,features:e}},t.unavailable=function(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];return 0===e.length&&(0,a.assertFalse)("calc.lang.unavailable: expected nonempty array"),{kind:t.ReasonKind.Unavailable,objects:e}},t.internal=function(e){return{kind:t.ReasonKind.Internal,message:e}},t.createFailureErrorClass=function(e){var t=function(t){this.reason=t,this.name=e,this.stack=e,this.message=t.kind};return(t.prototype=Object.create(Error.prototype)).constructor=t,t};var _="_xlfn.",F="_xlws.";t.getWorksheetFuncId=function(e,t){var r=t;return r.length>_.length&&0===e.stringCompareCI(r.substring(0,_.length),_)&&(r=r.substring(_.length)).length>F.length&&0===e.stringCompareCI(r.substring(0,F.length),F)&&(r=r.substring(F.length)),e.getWorksheetFuncId(r)};t.getUserDefinedFuncName=function(e,t){var r=t;return r.length>"_xludf.".length&&0===e.stringCompareCI(r.substring(0,"_xludf.".length),"_xludf.")&&(r=r.substring("_xludf.".length)),r};var I="_xlpm.";function A(e){return e.kind!==s.StructRefKind.SpecialRef&&e.kind!==s.StructRefKind.BadRef||e.isBracketed}function M(e){return e.kind===s.StructRefKind.MissingRef||e.kind===s.StructRefKind.BadRef}function w(e){switch(e.kind){case s.StructRefKind.SpecialRef:case s.StructRefKind.ColumnRef:return e.isClosed;case s.StructRefKind.RangeOpRef:return w(e.lhs)&&w(e.rhs);case s.StructRefKind.MissingRef:return!0;case s.StructRefKind.BadRef:return e.isClosed}}t.getBoundName=function(e,t){var r=t;return r.length>I.length&&0===e.stringCompareCI(r.substring(0,I.length),I)&&(r=r.substring(I.length)),r},t.isCommaOpRefWellFormed=function(e){return e.columnRefs.length<=1&&e.refs.every(A)&&function(e){var t=e.specialRefs,r=Object.keys(t).reduce((function(e,r){return e+(t[Number(r)]?1:0)}),0);return 1===r||2===r&&t[s.SpecialRefId.Data]&&(t[s.SpecialRefId.Headers]||t[s.SpecialRefId.Totals])}(e)},t.isCommaOpClosed=function(e){return e.refs.every(w)},t.isCommaOpNoBadOrMissing=function(e){return!e.refs.some(M)},t.isRangeOpClosed=function(e){return w(e.lhs)&&w(e.rhs)},t.isRangeOpNoMissing=function(e){return!M(e.lhs)&&!M(e.rhs)};var D=((n={})[s.SpecialRefId.All]=1,n[s.SpecialRefId.Headers]=2,n[s.SpecialRefId.Data]=3,n[s.SpecialRefId.Totals]=4,n[s.SpecialRefId.ThisRow]=5,n),j=function(e){return e.kind===s.StructRefKind.MissingRef?7:e.kind!==s.StructRefKind.SpecialRef?6:D[e.id]};function x(e,t){return j(e)-j(t)}t.normalizeCommaOpRef=function(e){for(var t={},r=[],n=0,i=e.refs;n<i.length;n++){var a=i[n];a.kind!==s.StructRefKind.SpecialRef?r.push(a):void 0===t[a.id]&&(t[a.id]=!0,r.push(a))}return r.sort(x),r},t.applyComparison=function(e,t){switch(e){case f.OperatorId.Eq:return 0===t;case f.OperatorId.Ne:return 0!==t;case f.OperatorId.Lt:return t<0;case f.OperatorId.Gt:return t>0;case f.OperatorId.Le:return t<=0;case f.OperatorId.Ge:return t>=0}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSheetGridRange=t.isSheetGridCellEqual=t.isSheetGridCell=t.isRichOper=t.isReadOperEqual=t.isRangeOper=t.isRangeOpNoMissing=t.isRangeOpClosed=t.isPrimitiveOper=t.isOperatorNode=t.isNumberOper=t.isNumberNode=t.isNameScopeEqual=t.isMissingOper=t.isMissingNode=t.isGridRangeEqual=t.isGridCellEqual=t.isGridCell=t.isErrorOper=t.isDocumentLocEqual=t.isCommaOpRefWellFormed=t.isCommaOpNoBadOrMissing=t.isCommaOpClosed=t.isBooleanOper=t.isBooleanNode=t.isBlankOper=t.isArrayOper=t.internal=t.gridRangesJoin=t.gridRangeSize=t.gridRangeJoinOpt=t.gridRangeJoin=t.gridRangeIsects=t.gridRangeIsect=t.gridRangeExcept=t.gridRangeCompare=t.gridRangeAnchor=t.gridCellRange=t.gridCellImplicitIsect=t.getWorksheetFuncId=t.getUserDefinedFuncName=t.getSubExpressionFromPosition=t.getBoundName=t.getArguments=t.getArgType=t.forEachTileInRange=t.forEachCellInRange=t.createFailureErrorClass=t.ReasonKind=t.LangReasonKind=void 0,t.unavailable=t.shouldFieldRefBeBracketed=t.sheetGridRangeAnchor=t.notImplemented=t.normalizeCommaOpRef=t.isWriteOper=t.isWellFormed=t.isWSFNode=t.isValidArgsLength=t.isUnqualifiedNameNode=t.isStringOper=t.isSheetIndexEqual=t.isSheetIndex=t.isSheetGridRangeEqual=void 0;var n=r(3);t.LangReasonKind=n.util.LangReasonKind,t.ReasonKind=n.util.ReasonKind,t.createFailureErrorClass=n.util.createFailureErrorClass,t.forEachCellInRange=n.util.forEachCellInRange,t.forEachTileInRange=n.util.forEachTileInRange,t.getArgType=n.util.getArgType,t.getArguments=n.util.getArguments,t.getBoundName=n.util.getBoundName,t.getSubExpressionFromPosition=n.util.getSubExpressionFromPosition,t.getUserDefinedFuncName=n.util.getUserDefinedFuncName,t.getWorksheetFuncId=n.util.getWorksheetFuncId,t.gridCellImplicitIsect=n.util.gridCellImplicitIsect,t.gridCellRange=n.util.gridCellRange,t.gridRangeAnchor=n.util.gridRangeAnchor,t.gridRangeCompare=n.util.gridRangeCompare,t.gridRangeExcept=n.util.gridRangeExcept,t.gridRangeIsect=n.util.gridRangeIsect,t.gridRangeIsects=n.util.gridRangeIsects,t.gridRangeJoin=n.util.gridRangeJoin,t.gridRangeJoinOpt=n.util.gridRangeJoinOpt,t.gridRangeSize=n.util.gridRangeSize,t.gridRangesJoin=n.util.gridRangesJoin,t.internal=n.util.internal,t.isArrayOper=n.util.isArrayOper,t.isBlankOper=n.util.isBlankOper,t.isBooleanNode=n.util.isBooleanNode,t.isBooleanOper=n.util.isBooleanOper,t.isCommaOpClosed=n.util.isCommaOpClosed,t.isCommaOpNoBadOrMissing=n.util.isCommaOpNoBadOrMissing,t.isCommaOpRefWellFormed=n.util.isCommaOpRefWellFormed,t.isDocumentLocEqual=n.util.isDocumentLocEqual,t.isErrorOper=n.util.isErrorOper,t.isGridCell=n.util.isGridCell,t.isGridCellEqual=n.util.isGridCellEqual,t.isGridRangeEqual=n.util.isGridRangeEqual,t.isMissingNode=n.util.isMissingNode,t.isMissingOper=n.util.isMissingOper,t.isNameScopeEqual=n.util.isNameScopeEqual,t.isNumberNode=n.util.isNumberNode,t.isNumberOper=n.util.isNumberOper,t.isOperatorNode=n.util.isOperatorNode,t.isPrimitiveOper=n.util.isPrimitiveOper,t.isRangeOpClosed=n.util.isRangeOpClosed,t.isRangeOpNoMissing=n.util.isRangeOpNoMissing,t.isRangeOper=n.util.isRangeOper,t.isReadOperEqual=n.util.isReadOperEqual,t.isRichOper=n.util.isRichOper,t.isSheetGridCell=n.util.isSheetGridCell,t.isSheetGridCellEqual=n.util.isSheetGridCellEqual,t.isSheetGridRange=n.util.isSheetGridRange,t.isSheetGridRangeEqual=n.util.isSheetGridRangeEqual,t.isSheetIndex=n.util.isSheetIndex,t.isSheetIndexEqual=n.util.isSheetIndexEqual,t.isStringOper=n.util.isStringOper,t.isUnqualifiedNameNode=n.util.isUnqualifiedNameNode,t.isValidArgsLength=n.util.isValidArgsLength,t.isWSFNode=n.util.isWSFNode,t.isWellFormed=n.util.isWellFormed,t.isWriteOper=n.util.isWriteOper,t.normalizeCommaOpRef=n.util.normalizeCommaOpRef,t.notImplemented=n.util.notImplemented,t.sheetGridRangeAnchor=n.util.sheetGridRangeAnchor,t.shouldFieldRefBeBracketed=n.util.shouldFieldRefBeBracketed,t.unavailable=n.util.unavailable},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.valueErrorOper=t.trueOper=t.stringOper=t.refErrorOper=t.rangeSeqOper=t.range3DOper=t.precedents=t.numErrorOper=t.nullErrorOper=t.nameErrorOper=t.naErrorOper=t.missingOper=t.gettingDataErrorOper=t.fieldErrorOper=t.falseOper=t.errorOper=t.div0ErrorOper=t.cellStringLimit=t.booleanOper=t.blankOper=t.arrayOper=t.PrecsBound=t.ErrorType=void 0;var n=r(3);t.ErrorType=n.value.ErrorType,t.PrecsBound=n.value.PrecsBound,t.arrayOper=n.value.arrayOper,t.blankOper=n.value.blankOper,t.booleanOper=n.value.booleanOper,t.cellStringLimit=n.value.cellStringLimit,t.div0ErrorOper=n.value.div0ErrorOper,t.errorOper=n.value.errorOper,t.falseOper=n.value.falseOper,t.fieldErrorOper=n.value.fieldErrorOper,t.gettingDataErrorOper=n.value.gettingDataErrorOper,t.missingOper=n.value.missingOper,t.naErrorOper=n.value.naErrorOper,t.nameErrorOper=n.value.nameErrorOper,t.nullErrorOper=n.value.nullErrorOper,t.numErrorOper=n.value.numErrorOper,t.precedents=n.value.precedents,t.range3DOper=n.value.range3DOper,t.rangeSeqOper=n.value.rangeSeqOper,t.refErrorOper=n.value.refErrorOper,t.stringOper=n.value.stringOper,t.trueOper=n.value.trueOper,t.valueErrorOper=n.value.valueErrorOper},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.concat=t.flatten=t.middle=t.right=t.left=t.tuple=t.many1=t.many=t.reduce=t.applyTake=t.takePeek=t.peek=t.take=t.fails=t.succeeds=t.opt=t.any=t.withState=t.apply=t.bind=t.parseFail=t.parseSucceed=t.warnSucceedOrFail=t.setDebugging=t.lazy=t.runParser=void 0;var n=r(18),i=r(65),a=r(102),o=r(66),s=r(113);t.runParser=function(e,t,r,s){var u;if(function(e){for(var t=e;null!=t;)t=t()}(e(t,r,s,(function(e,t){u=(0,o.success)({output:e,index:t})}),(function(){u=(0,o.failure)(void 0)}))),null==u){var c=(0,a.anonymize)(t),l="calc.parse.runParser: internal error: parser did not call resolve or reject on ".concat(c);return i.ulsLogger.ULS.assertTag(595980827,n.LogCategory.msoulscat_ES_EWAJS,!1,l)}return u},t.lazy=function(e){var t;return function(r,n,i,a,o){var s=null!=t?t:t=e();return function(){return s(r,n,i,a,o)}}};var u=!1;function c(e){return function(t,r,n,i,a){return i(e,r)}}t.setDebugging=function(e){u=e},t.warnSucceedOrFail=function(e,t){return function(r,n,i,a,o){return e(r,n,i,(function(e,n){return u&&console.warn("".concat(t," succeeded, returning index ").concat(n," (of ").concat(r.length,") with"),e),a(e,n)}),(function(){return u&&console.warn("".concat(t," failed at index ").concat(n," (of ").concat(r.length,")")),o}))}},t.parseSucceed=c;var l=function(e,t,r,n,i){return i};function d(){return l}function f(e,t){return function(r,n,i,a,o){return e(r,n,i,(function(e,n){return t(i,e)(r,n,i,a,o)}),o)}}function p(e,t){return function(r,n,i,a,o){return e(r,n,i,(function(e,r){return a(t(i,e),r)}),o)}}function m(e,t){return function(r,n,i,a,o){return e(r,n,i,a,(function(){return t(r,n,i,a,o)}))}}function h(e,t){return function(r,n,i,a,o){var s=r[n];if(null==s)return o;var u=e(i,s);return null==u?o:a(u,n+t)}}function v(e,t,r){return function(o,s,u,c,l){var d=r,f=s;function p(){return e(o,f,u,m,h)}function m(e,r){if(r<=f){var s=(0,a.anonymize)(o),c="calc.parse.reduce: internal error: no progress made at index ".concat(f," on ").concat(s);return i.ulsLogger.ULS.assertTag(595980829,n.LogCategory.msoulscat_ES_EWAJS,!1,c)}return d=t(u,e,d),f=r,p}function h(){return c(d,f)}return p}}function g(e,t){return v(e,(function(e,t,r){return r.push(t),r}),t)}function b(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(0===e.length)return c([]);if(1===e.length)return p(e[0],(function(e,t){return[t]}));var r=e.length;return function(t,n,i,a,o){var s=n,u=[];function c(){return e[u.length](t,s,i,l,o)}function l(e,t){return s=t,u.push(e),u.length<r?c:a(u,s)}return c}}function S(e){return p(e,(function(e,t){return(0,s.safeConcat)([],t)}))}t.parseFail=d,t.bind=f,t.apply=p,t.withState=function(e){return function(t,r,n,i,a){return e(n)(t,r,n,i,a)}},t.any=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 0===e.length?d():e.reduce(m)},t.opt=function(e,t){return function(r,n,i,a,o){return e(r,n,i,a,(function(){return a(t,n)}))}},t.succeeds=function(e){return function(t,r,n,i,a){return e(t,r,n,(function(){return i(!0,r)}),a)}},t.fails=function(e){return function(t,r,n,i,a){return e(t,r,n,a,(function(){return i(!0,r)}))}},t.take=function(e){return h(e,1)},t.peek=function(e){return h(e,0)},t.takePeek=function(e){return function(t,r,n,i,a){var o=t[r],s=t[r+1];if(null==o||null==s)return a;var u=e(n,o,s);return null==u?a:i(u,r+1)}},t.applyTake=function(e,t){return function(r,n,i,a,o){return e(r,n,i,(function(e,r){var n=t(i,e);return null==n?o:a(n,r)}),o)}},t.reduce=v,t.many=function(e,t){return void 0===t?function(t,r,n,i,a){return g(e,[])(t,r,n,i,a)}:function(r,n,i,a,o){return e(r,n,i,(function(e,n){return g(t,[e])(r,n,i,a,o)}),(function(){return a([],n)}))}},t.many1=function(e,t){return void 0===t&&(t=e),f(e,(function(e,r){return g(t,[r])}))},t.tuple=b,t.left=function(e,t){return p(b(e,t),(function(e,t){return t[0]}))},t.right=function(e,t){return p(b(e,t),(function(e,t){return t[1]}))},t.middle=function(e,t,r){return p(b(e,t,r),(function(e,t){return t[1]}))},t.flatten=S,t.concat=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return S(b.apply(void 0,e))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.evalFormatLocalsGrid=t.createFormatGlobals=t.NumberFormatSource=t.otherEdit=t.numberEdit=t.stringEdit=t.formulaEdit=t.EditKind=t.renderedValueToString=t.renderInfiniteWidth=t.memoizedRenderCallback=t.renderCallback=t.isHashesValue=t.renderedValue=t.formattedValue=t.hashesValue=t.formattedUnitFlexible=t.formattedUnitBlank=t.formattedUnitString=t.formattedUnitGeneral=t.FormattedUnitKind=t.Clip=t.GetTimeKind=t.Alignment=t.NamedColor=t.FormatCurrency=t.isFormatCultureEqual=t.isSystemCultureTag=t.CultureTag=t.BidiDate=t.FormatValueType=t.previousFormatFailure=t.fractionOverflow=t.dateOverflow=t.tooWide=t.noFormatPart=t.notFormatString=t.notValueString=t.ReasonKind=t.FormatReasonKind=void 0;var n,i,a,o,s,u,c=r(2),l=r(80),d=r(131),f=r(76);function p(e,t,r,n){return{units:e,color:t,alignment:r,clip:n}}function m(e,t,r){return{renderWidth:e,bestFit:r,getTextWidth:t}}!function(e){e.NotValueString="NotValueString",e.NotFormatString="NotFormatString",e.NoFormatPart="NoFormatPart",e.TooWide="TooWide",e.DateOverflow="DateOverflow",e.FractionOverflow="FractionOverflow",e.PreviousFormatFailure="PreviousFormatFailure"}(n=t.FormatReasonKind||(t.FormatReasonKind={})),t.ReasonKind=c.__assign(c.__assign({},l.LangReasonKind),n),t.notValueString=function(e){return{kind:t.ReasonKind.NotValueString,message:e}},t.notFormatString=function(e){return{kind:t.ReasonKind.NotFormatString,message:e}},t.noFormatPart={kind:t.ReasonKind.NoFormatPart},t.tooWide=function(e){return{kind:t.ReasonKind.TooWide,clip:e}},t.dateOverflow={kind:t.ReasonKind.DateOverflow},t.fractionOverflow={kind:t.ReasonKind.FractionOverflow},t.previousFormatFailure=function(){return{kind:t.ReasonKind.PreviousFormatFailure}},function(e){e.General="General",e.Number="Number",e.Currency="Currency",e.Accounting="Accounting",e.Date="Date",e.Time="Time",e.Percentage="Percentage",e.Fraction="Fraction",e.Scientific="Scientific",e.Text="Text",e.Custom="Custom"}(t.FormatValueType||(t.FormatValueType={})),function(e){e.English="English",e.Lunar="Lunar"}(t.BidiDate||(t.BidiDate={})),function(e){e.SysDate="sysdate",e.SysTime="systime",e.Euro1="euro1",e.Euro2="euro2",e.GenLower="genlower",e.GenUpper="genupper",e.NomLower="nomlower",e.Bitcoin1="xbt1",e.Bitcoin2="xbt2",e.Gannen="gannen"}(i=t.CultureTag||(t.CultureTag={})),t.isSystemCultureTag=function(e){return e===i.SysDate||e===i.SysTime},t.isFormatCultureEqual=function(e,t){return e.culture===t.culture&&e.numberShape===t.numberShape&&e.nationalNumberInput===t.nationalNumberInput&&e.calendar===t.calendar&&e.localCalendarInput===t.localCalendarInput&&e.tag===t.tag},function(e){e[e.LocaleInfo=0]="LocaleInfo"}(t.FormatCurrency||(t.FormatCurrency={})),function(e){e.Black="Black",e.White="White",e.Red="Red",e.Green="Green",e.Blue="Blue",e.Yellow="Yellow",e.Magenta="Magenta",e.Cyan="Cyan"}(t.NamedColor||(t.NamedColor={})),function(e){e.Left="Left",e.Center="Center",e.Right="Right"}(a=t.Alignment||(t.Alignment={})),function(e){e.ValueCell="ValueCell",e.Volatile="Volatile",e.NonVolatile="NonVolatile"}(t.GetTimeKind||(t.GetTimeKind={})),function(e){e[e.MaxChars=2]="MaxChars",e[e.CellWidth=4]="CellWidth",e[e.None=0]="None",e[e.All=6]="All"}(o=t.Clip||(t.Clip={})),function(e){e.String="String",e.Blank="Blank",e.General="General",e.Flexible="Flexible"}(s=t.FormattedUnitKind||(t.FormattedUnitKind={})),t.formattedUnitGeneral=function(e,t,r,n,i,a){return{kind:s.General,num:e,decimalSeparator:t,includeSign:r,numberShape:n,expNumberShape:i,builtin:a}},t.formattedUnitString=function(e){return{kind:s.String,str:e}},t.formattedUnitBlank=function(e){return{kind:s.Blank,str:e}},t.formattedUnitFlexible=function(e){return{kind:s.Flexible,str:e}},t.hashesValue=function(e,t){return p(e,t,a.Center,o.All)},t.formattedValue=p,t.renderedValue=p,t.isHashesValue=function(e){return!Array.isArray(e.units)},t.renderCallback=m,t.memoizedRenderCallback=function(e){var t=(0,d.makeStringMap)();return m(e.renderWidth,(function(r){if(null!=t[r])return t[r];var n=e.getTextWidth(r);return t[r]=n,n}),e.bestFit)},t.renderInfiniteWidth={renderWidth:1/0,bestFit:!1,getTextWidth:function(e){return e.length}},t.renderedValueToString=function(e){for(var t="",r=0,n=e.units;r<n.length;r++){var i=n[r];switch(i.kind){case s.String:t+=i.str;break;case s.Blank:for(var a=0;a<i.str.length;a+=1)t+=" "}}return t},function(e){e.Formula="Formula",e.String="String",e.Number="Number",e.Other="Other"}(u=t.EditKind||(t.EditKind={})),t.formulaEdit=function(e){return{kind:u.Formula,fmla:e}},t.stringEdit=function(e,t){return{kind:u.String,value:e,tick:t}},t.numberEdit=function(e,t){return{kind:u.Number,value:e,format:t}},t.otherEdit=function(e){return{kind:u.Other,value:e}},function(e){e.Builtin="Builtin",e.CustomString="CustomString",e.CustomBytecode="CustomBytecode",e.System="System"}(t.NumberFormatSource||(t.NumberFormatSource={})),t.createFormatGlobals=function(e,t){return{config:e,getTime:t}},t.evalFormatLocalsGrid=function(e,t){var r=(0,l.sheetGridRangeAnchor)(e.range);return{config:null!=t?t:void 0,lexicalSource:e,originGridCell:(0,f.success)(r.range),originSheet:(0,f.success)(r.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!1}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NumberShape=t.KnownFormat=t.DateOrder=t.CurrencyFormat=t.Calendar=void 0;var n=r(3);t.Calendar=n.numfmt.Calendar,t.CurrencyFormat=n.numfmt.CurrencyFormat,t.DateOrder=n.numfmt.DateOrder,t.KnownFormat=n.numfmt.KnownFormat,t.NumberShape=n.numfmt.NumberShape},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.assertPositiveLength=t.assertPositiveInteger=t.assertInteger=t.assertIndex=t.assertNatural=t.assertNever=t.assertFalse=t.assertTrue=t.ulsLogger=void 0;var n=r(7);t.ulsLogger=n.assertions.ulsLogger,t.assertTrue=n.assertions.assertTrue,t.assertFalse=n.assertions.assertFalse,t.assertNever=n.assertions.assertNever,t.assertNatural=n.assertions.assertNatural,t.assertIndex=n.assertions.assertIndex,t.assertInteger=n.assertions.assertInteger,t.assertPositiveInteger=n.assertions.assertPositiveInteger,t.assertPositiveLength=n.assertions.assertPositiveLength},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(20),i=n.analyzeService.createAnalyzer},function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a})),r.d(t,"c",(function(){return o}));var n=r(3),i=n.printServiceTypes.createSimplePrintGlobals,a=n.printServiceTypes.printLocalsGrid,o=n.printServiceTypes.printLocalsName},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(7),i=n.rbMapTree.RedBlackMapTree},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.functionType=t.FunctionFlags=t.SpecialPrecs=t.SignatureType=t.OperKind=void 0;var n=r(7),i=n.assertions.assertNatural,a=n.assertions.assertFalse,o=n.assertions.assertIndex;!function(e){e[e.Number=1]="Number",e[e.String=2]="String",e[e.Boolean=4]="Boolean",e[e.Error=8]="Error",e[e.Range=16]="Range",e[e.Array=32]="Array",e[e.Missing=64]="Missing",e[e.Blank=128]="Blank",e[e.Rich=256]="Rich"}(t.OperKind||(t.OperKind={})),function(e){e[e.None=0]="None",e[e.Goto=512]="Goto",e[e.Ref3D=1024]="Ref3D",e[e.All=2047]="All"}(t.SignatureType||(t.SignatureType={})),function(e){e[e.None=0]="None",e[e.OwnDoc=1]="OwnDoc",e[e.OwnSheet=2]="OwnSheet",e[e.OwnRow=4]="OwnRow",e[e.OwnCol=8]="OwnCol",e[e.OwnRowCopy=16]="OwnRowCopy",e[e.OwnColCopy=32]="OwnColCopy",e[e.OwnDocSheets=64]="OwnDocSheets",e[e.CellProps=128]="CellProps",e[e.AllCells=256]="AllCells",e[e.AllNames=512]="AllNames",e[e.Time=1024]="Time",e[e.Calc=2048]="Calc",e[e.InFilterMode=4096]="InFilterMode",e[e.RefStyle=8192]="RefStyle",e[e.All=16383]="All"}(t.SpecialPrecs||(t.SpecialPrecs={})),function(e){e[e.None=0]="None",e[e.Dark=1]="Dark",e[e.Macro=2]="Macro",e[e.OnlyParsedDuringLoad=4]="OnlyParsedDuringLoad",e[e.Internal=8]="Internal",e[e.Allow3dRef=16]="Allow3dRef"}(t.FunctionFlags||(t.FunctionFlags={})),t.functionType=function(e,t,r,n,s,u,c,l){if(i("calc.lang.functionType",t),o("calc.lang.functionType",e,t+1),0===n.length?0!==s.length:s.length>=n.length){var d=JSON.stringify(s);a("calc.lang.functionType: expected tailTypes.length < restTypes.length; given ".concat(d))}if(0===n.length&&r.length+s.length<t){d=JSON.stringify(r);a("calc.lang.functionType: expected headTypes.length + tailTypes.length >= ".concat(t,"; given ").concat(d))}return{minArgs:e,maxArgs:t,headTypes:r,restTypes:n,tailTypes:s,returnType:u,staticPrecs:c,flags:l}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseBracketedTokens=t.parseIdentContinue=t.parseEnd=t.parseEscape=t.parseAtOp=t.parseRangeOp=t.parseDotSepTokenNotFollowedByLeftBracket=t.parseRightBracket=t.parseLeftBracket=t.parseRightSQuote=t.parseLeftSQuote=t.parseRightBrace=t.parseLeftBrace=t.parseRightParen=t.parseLeftParen=t.parseAssignToken=t.parseDotSepToken=t.parseQualSep=t.parseColSep=t.parseRowSep=t.parseListSep=t.parseCharIndex=t.parseSpaces=t.isBracketToken=t.isRightBracketToken=t.isLeftBracketToken=t.isRefErrorToken=t.isAtOpToken=t.isRangeOpToken=t.isListSepToken=t.isDotSepToken=void 0;var n=r(18),i=r(102),a=r(65),o=r(88),s=r(104),u=r(79),c=r(89),l=r(103);function d(e){return e.kind===u.TokenKind.Sep&&e.value===u.SepId.Dot}function f(e){return e.kind===u.TokenKind.Operator&&e.value===s.OperatorId.Range}function p(e){return e.kind===u.TokenKind.Operator&&e.value===s.OperatorId.At}function m(e){return e.kind===u.TokenKind.Left&&e.value===u.DelimId.Bracket}function h(e){return(e.kind===u.TokenKind.Left||e.kind===u.TokenKind.Right)&&e.value===u.DelimId.Bracket}t.isDotSepToken=d,t.isListSepToken=function(e){return e.kind===u.TokenKind.Sep&&e.value===u.SepId.List},t.isRangeOpToken=f,t.isAtOpToken=p,t.isRefErrorToken=function(e){return e.kind===u.TokenKind.Literal&&e.oper.kind===l.OperKind.Error&&e.oper.type===o.ErrorType.REF},t.isLeftBracketToken=m,t.isRightBracketToken=function(e){return e.kind===u.TokenKind.Right&&e.value===u.DelimId.Bracket},t.isBracketToken=h,t.parseSpaces=(0,c.opt)((0,c.take)((function(e,t){return t.kind===u.TokenKind.Spaces?t.chars:void 0})),"");function v(e){return(0,c.take)((function(t,r){return r.kind===u.TokenKind.Sep&&r.value===e?r:void 0}))}function g(e){return(0,c.take)((function(t,r){return r.kind===u.TokenKind.Left&&r.value===e?r:void 0}))}function b(e){return(0,c.take)((function(t,r){return r.kind===u.TokenKind.Right&&r.value===e?r:void 0}))}t.parseCharIndex=function(e,t,r,o,s){var u=e[t];if(null==u){var c="calc.parse.pStart: internal error: expected token at ".concat(t," in ").concat((0,i.anonymize)(e));return a.ulsLogger.ULS.assertTag(589825166,n.LogCategory.msoulscat_ES_EWAJS,!1,c)}return o(u.start,t)},t.parseListSep=v(u.SepId.List),t.parseRowSep=v(u.SepId.Row),t.parseColSep=v(u.SepId.Col),t.parseQualSep=v(u.SepId.Qual),t.parseDotSepToken=v(u.SepId.Dot),t.parseAssignToken=v(u.SepId.Assign),t.parseLeftParen=g(u.DelimId.Paren),t.parseRightParen=b(u.DelimId.Paren),t.parseLeftBrace=g(u.DelimId.Brace),t.parseRightBrace=b(u.DelimId.Brace),t.parseLeftSQuote=g(u.DelimId.SQuote),t.parseRightSQuote=b(u.DelimId.SQuote),t.parseLeftBracket=g(u.DelimId.Bracket),t.parseRightBracket=b(u.DelimId.Bracket),t.parseDotSepTokenNotFollowedByLeftBracket=(0,c.takePeek)((function(e,t,r){return d(t)&&!m(r)?t:void 0})),t.parseRangeOp=(0,c.take)((function(e,t){return f(t)?t:void 0})),t.parseAtOp=(0,c.take)((function(e,t){return p(t)?t:void 0})),t.parseEscape=(0,c.take)((function(e,t){return t.kind===u.TokenKind.Escape?t:void 0})),t.parseEnd=(0,c.take)((function(e,t){return t.kind===u.TokenKind.End?t:void 0})),t.parseIdentContinue=(0,c.apply)((0,c.many1)((0,c.take)((function(e,t){return t.isIdentContinue?t:void 0}))),(function(e,t){var r=t[0];return 1===t.length?r:(0,u.identToken)(r.start,t.map((function(e){return e.chars})).join(""))}));var S=(0,c.take)((function(e,t){return h(t)||t.kind===u.TokenKind.End?void 0:t})),y=(0,c.lazy)((function(){return(0,c.flatten)((0,c.many)((0,c.any)((0,c.many1)(S),(0,c.concat)((0,c.tuple)(t.parseLeftBracket),y,(0,c.opt)((0,c.tuple)(t.parseRightBracket),[])))))}));t.parseBracketedTokens=(0,c.apply)((0,c.tuple)(t.parseLeftBracket,y,t.parseCharIndex,(0,c.opt)(t.parseRightBracket,void 0)),(function(e,t){t[0];var r=t[1],n=t[2],i=t[3];return r.push((0,u.endToken)(n)),[r,void 0!==i]}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.cellRefMustBeCellRefNode=t.withDelim=t.addSpan=t.getSpan=t.getNodeSpan=t.makeState=t.ListSep=void 0;var n,i=r(102),a=r(65),o=r(59);function s(e,t,r){return function(n,i,a,o,s){var u=e(a);return r(n,i,a,(function(e,r){return t(a,u),o(e,r)}),(function(){return t(a,u),s}))}}!function(e){e[e.Union=1]="Union",e[e.Arg=2]="Arg"}(n=t.ListSep||(t.ListSep={})),t.makeState=function(e,t,r,i,a){return{localeInfo:e,mathpack:t,refStyle:r,lexicalKind:i,origin:a,delim:{delimId:void 0,listSep:n.Union},cellRefMustBeCellRefNode:!1,label:1,spans:[]}},t.getNodeSpan=function(e,t){var r=e.spans[t.label];if(null==r){var n="calc.parse.getNodeSpan: internal error: expected node to have a span; given ".concat((0,i.anonymize)(t));(0,a.assertFalse)(n)}return r},t.getSpan=function(e,t){var r=e.spans[t];return(0,a.assertTrue)("calc.parse.getSpan: internal error: expected label to have a span",null!=r),r},t.addSpan=function(e,t,r,n,i){var a=e.label;return e.label+=1,e.spans[a]=(0,o.formulaSpan)(t,r,n,i),a},t.withDelim=function(e,t){return s((function(t){var r=t.delim;return t.delim=e,r}),(function(e,t){return e.delim=t}),t)},t.cellRefMustBeCellRefNode=function(e){return s((function(e){var t=e.cellRefMustBeCellRefNode;return e.cellRefMustBeCellRefNode=!0,t}),(function(e,t){return e.cellRefMustBeCellRefNode=t}),e)}},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(7),i=n.priorityQueue.PriorityQueue},function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a}));var n=r(3),i=n.printService.anonymizeFormula,a=n.printService.createPrinter},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.assertPositiveLength=t.assertIndex=t.assertPositiveInteger=t.assertNatural=t.assertInteger=t.assertTrue=t.assertFalse=t.assertNever=t.ulsLogger=void 0;var n=r(18),i=r(169),a=r(168);function o(e,t){return function(r,n,i,a){if(e(r,n,i,a),!i)throw new Error("".concat(t," ").concat(r," ").concat(n," ").concat(a))}}function s(e){return{shipAssertTag:o(e.shipAssertTag.bind(e),"shipAssertTag"),assertTag:o(e.assertTag.bind(e),"assertTag"),traceTag:e.traceTag.bind(e),debugTraceTag:e.debugTraceTag.bind(e),dnmTraceTag:e.dnmTraceTag.bind(e)}}function u(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];try{return e.apply(void 0,t)}catch(e){}}}var c=function(){function e(){this.callBufferCapacity=100,this.callBuffer=[],this.shipAssertTag=this.createBufferingCallback("shipAssertTag"),this.assertTag=this.createBufferingCallback("assertTag"),this.traceTag=this.createBufferingCallback("traceTag"),this.dnmTraceTag=this.createBufferingCallback("dnmTraceTag"),this.debugTraceTag=this.createBufferingCallback("debugTraceTag")}return e.prototype.createBufferingCallback=function(e){var t=this;return function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];t.callBuffer.length<t.callBufferCapacity&&t.callBuffer.push({method:e,args:r})}},e.prototype.invokeBufferedCalls=function(){var e;if(0!==this.callBuffer.length){var r=this.callBuffer;this.callBuffer=[];var i="calc.common.DefaultLogger.invokeBufferedCalls: ".concat(r.length," calls before initLogger");t.ulsLogger.ULS.traceTag(579736781,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,i);for(var a=0,o=r;a<o.length;a++){var s=o[a];(e=t.ulsLogger.noThrowLogger)[s.method].apply(e,s.args)}}},e}(),l=function(){function e(){this.logger=new c,this.ULS=s(this.logger),this.noThrowLogger=this.logger}return e.prototype.setLogger=function(e){var t=this.logger;this.logger=e,this.ULS=s(e),this.noThrowLogger=function(e){return{shipAssertTag:u(e.shipAssertTag.bind(e)),assertTag:u(e.assertTag.bind(e)),traceTag:u(e.traceTag.bind(e)),debugTraceTag:u(e.debugTraceTag.bind(e)),dnmTraceTag:u(e.dnmTraceTag.bind(e))}}(e),t instanceof c&&t.invokeBufferedCalls()},e}();function d(e){return t.ulsLogger.ULS.assertTag(595980873,n.LogCategory.msoulscat_ES_EWAJS,!1,e)}t.ulsLogger=new l,t.assertNever=function(e,r){var i=(0,a.anonymize)(r),o="".concat(e,": code should be unreachable because a value has type 'never'; given ").concat(i);return t.ulsLogger.ULS.assertTag(595980872,n.LogCategory.msoulscat_ES_EWAJS,!1,o)},t.assertFalse=d,t.assertTrue=function(e,t){t||d("".concat(e,": expected condition to be true"))},t.assertInteger=function(e,t){(0,i.isInteger)(t)||d("".concat(e,": expected integer; given ").concat((0,a.anonymize)(t)))},t.assertNatural=function(e,t){(!(0,i.isInteger)(t)||t<0)&&d("".concat(e,": expected natural number; given ").concat((0,a.anonymize)(t)))},t.assertPositiveInteger=function(e,t){(!(0,i.isInteger)(t)||t<=0)&&d("".concat(e,": expected positive integer; given ").concat((0,a.anonymize)(t)))},t.assertIndex=function(e,t,r){(!(0,i.isInteger)(t)||t<0||t>=r)&&d("".concat(e,": expected natural number less than ").concat((0,a.anonymize)(r),"; given ").concat((0,a.anonymize)(t)))},t.assertPositiveLength=function(e,t,r){(!(0,i.isInteger)(t)||t<=0||t>r)&&d("".concat(e,": expected positive integer at most ").concat((0,a.anonymize)(r),"; given ").concat((0,a.anonymize)(t)))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.kindAnonymizers=t.anonymizeMagnitude=t.anonymizeFormulaString=t.anonymize=void 0;var n=r(7);t.anonymize=n.anonymizer.anonymize,t.anonymizeFormulaString=n.anonymizer.anonymizeFormulaString,t.anonymizeMagnitude=n.anonymizer.anonymizeMagnitude,t.kindAnonymizers=n.anonymizer.kindAnonymizers},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.functionType=t.SpecialPrecs=t.SignatureType=t.OperKind=t.FunctionFlags=void 0;var n=r(3);t.FunctionFlags=n.types.FunctionFlags,t.OperKind=n.types.OperKind,t.SignatureType=n.types.SignatureType,t.SpecialPrecs=n.types.SpecialPrecs,t.functionType=n.types.functionType},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unknownFunctionType=t.operatorStrings=t.higherOrderFunctionType=t.getWorksheetFuncType=t.getWorksheetFuncEnglishName=t.getOperatorType=t.WorksheetFuncId=t.OperatorId=void 0;var n=r(3);t.OperatorId=n.signature.OperatorId,t.WorksheetFuncId=n.signature.WorksheetFuncId,t.getOperatorType=n.signature.getOperatorType,t.getWorksheetFuncEnglishName=n.signature.getWorksheetFuncEnglishName,t.getWorksheetFuncType=n.signature.getWorksheetFuncType,t.higherOrderFunctionType=n.signature.higherOrderFunctionType,t.operatorStrings=n.signature.operatorStrings,t.unknownFunctionType=n.signature.unknownFunctionType},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getEvalFailureReason=t.breaked=t.paused=t.limitExceeded=t.previousNameFailure=t.previousFailure=t.cellCycle=t.nameCycle=t.evalLocals=t.evalGlobals=t.userDefinedFunc=t.stopped=t.cellFormula=t.cellWellFormedFormula=t.pendingValue=t.finalValue=t.illFormedFormula=t.LimitKind=t.StepAction=t.stackValue=t.Interrupt=t.CellKind=t.interval=t.compileLocalsName=t.compileLocalsGrid=t.createCompileGlobals=t.ReasonKind=void 0;var n,i,a,o=r(2),s=r(43),u=r(62),c=r(38),l=r(51),d=r(134),f=r(60),p=r(193);!function(e){e.Timeout="Timeout",e.Breakpoint="Breakpoint",e.Stopped="Stopped",e.NameCycle="NameCycle",e.CellCycle="CellCycle",e.PreviousFailure="PreviousFailure",e.PreviousNameFailure="PreviousNameFailure",e.LimitExceeded="LimitExceeded",e.IllFormedFormula="IllFormedFormula"}(n||(n={})),t.ReasonKind=o.__assign(o.__assign(o.__assign(o.__assign({},c.ReasonKind),n),d.FormatReasonKind),p.ResolveReasonKind),t.createCompileGlobals=function(e){return{config:e}},t.compileLocalsGrid=function(e,t,r){return{config:null!=r?r:void 0,lexicalKind:e,originGridCell:(0,f.success)(t),allowUnqualifiedCell:!0,emitStepInfo:!1}},t.compileLocalsName=function(e,t){return{config:null!=t?t:void 0,lexicalKind:l.LexicalKind.NameManager,originGridCell:(0,f.success)(e),allowUnqualifiedCell:!1,emitStepInfo:!1}},t.interval=(0,u.typedInstanceCreator)()((function(e,t){return(0,s.assertPositiveInteger)("calc.runtime.interval: end",t),(0,s.assertIndex)("calc.runtime.interval: start",e,t),{start:e,end:t}})),function(e){e.FinalValue="FinalValue",e.PendingValue="PendingValue"}(i=t.CellKind||(t.CellKind={})),function(e){e[e.Continue=1]="Continue",e[e.Stop=2]="Stop"}(a=t.Interrupt||(t.Interrupt={})),t.stackValue=(0,u.typedInstanceCreator)()((function(e,t){return{label:e,value:t}})),function(e){e.Continue="Continue",e.Break="Break"}(t.StepAction||(t.StepAction={})),function(e){e[e.CellChain=0]="CellChain",e[e.NameChain=1]="NameChain",e[e.LambdaCalls=2]="LambdaCalls",e[e.LambdaDepth=3]="LambdaDepth"}(t.LimitKind||(t.LimitKind={})),t.illFormedFormula=function(e,r,n){return{kind:t.ReasonKind.IllFormedFormula,message:e,mode:r,diagnostics:n}},t.finalValue=function(e){return{kind:i.FinalValue,oper:e}},t.pendingValue=function(e){return{kind:i.PendingValue,anchor:e}},t.cellWellFormedFormula=function(e,t){return{source:e,formula:t}},t.cellFormula=function(e,t){return{source:e,formula:t}},t.stopped={kind:t.ReasonKind.Stopped},t.userDefinedFunc=function(e,t){return{arity:e,func:t}},t.evalGlobals=function(e,t,r,n,i,o,s,u,l,d,p,m,h,v,g,b,S,y,O,C,P,N,R,k,T,E,_,F,I,A){return{config:e,getDocumentLoc:t,getSheetIndex:r,getSheetName:n,getSheetRangeIndexes:i,getNameLoc:o,getUserDefinedFuncLoc:s,getCellValue:u,getCellValues:l,getWorksheetFunc:d,getUserDefinedFunc:p,getNameFormula:m,getCellFormula:h,getUsedRange:v,interruptToken:[a.Continue],tryGetHiddenRows:g,tryGetHiddenCols:b,isInFilterMode:S,getKnownFormat:y,getIformat:O,getFormatString:C,getRandom:P,getTime:N,schedulerConfig:null!=I?I:{},limits:null!=A?A:{},setCellValue:R,setCellValues:k,setCellFailure:T,getContainingTable:E,getStructRefColumn:_,getStructRefSpecialRef:F,getIntersectingTables:function(){return(0,f.failure)((0,c.notImplemented)(["getIntersectingTables"]))}}},t.evalLocals=(0,u.typedInstanceCreator)()((function(e,t,r,n,i,a,o,s,u,c){return{lexicalSource:e,originGridCell:t,originSheet:r,calcingArray:n,reflectionGridCell:i,reflectionSheet:a,implicitIntersect:o,allowUnqualifiedCell:s,wrapCellReferences:u,followHyperlinks:c}})),t.nameCycle=function(e){return{kind:t.ReasonKind.NameCycle,names:e}},t.cellCycle=function(e){return{kind:t.ReasonKind.CellCycle,cells:e}},t.previousFailure=function(e){return{kind:t.ReasonKind.PreviousFailure,range:e}},t.previousNameFailure=function(e){return{kind:t.ReasonKind.PreviousNameFailure,name:e}},t.limitExceeded=function(e){return{kind:t.ReasonKind.LimitExceeded,limit:e}},t.paused=function(e){return{kind:f.ResultKind.Paused,reason:t.ReasonKind.Timeout,resume:e}},t.breaked=function(e){return{kind:f.ResultKind.Breaked,resume:e}},t.getEvalFailureReason=function(e){if(e.kind===f.ResultKind.Failure)return e.reason.kind}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.numMod=t.validDateRange=t.chkNumMultiOper=t.chkDateOper=t.atpm1904to1900Days=t.chkNumOper=t.assertString=t.assertNumber=t.wrap2=t.wrap1=void 0;var n=r(40),i=r(71),a=r(43),o=r(38),s=r(81),u=r(48),c=r(60);t.wrap1=function(e){return function(t,r){return e(t)(r[0])}},t.wrap2=function(e){return function(t,r){return e(t)(r[0],r[1])}};t.assertNumber=function(e){return(0,o.isNumberOper)(e)?e:(0,a.assertFalse)("calc.funcs.assertNumber")};function l(e,t){var r=(0,i.refToVal)(e,t,!1),s=(0,o.isRichOper)(r)?r.getFallback():r;switch(s.kind){case u.OperKind.Number:return s;case u.OperKind.Boolean:return n.valueErrorOper;case u.OperKind.String:var c=e.coerceOper(s,u.OperKind.Number);return(0,o.isNumberOper)(c)?c:n.valueErrorOper;case u.OperKind.Error:return s;case u.OperKind.Array:return n.valueErrorOper;case u.OperKind.Missing:return n.naErrorOper;case u.OperKind.Blank:return e.mathpack.zero;default:return(0,a.assertNever)("calc.funcs.chkNumOper",s)}}t.assertString=function(e){return(0,o.isStringOper)(e)?e:(0,a.assertFalse)("calc.funcs.assertString")},t.chkNumOper=l,t.atpm1904to1900Days=1462,t.chkDateOper=function(e,r){var i=l(e,r);if((0,o.isErrorOper)(i))return i;var a=e.mathpack;return a.cond(i)<0?n.numErrorOper:d(e,i=a.floor(i))?(e.config.date1904&&!(0,o.isStringOper)(r)&&(i=a.add(a.fromNumber(t.atpm1904to1900Days),i)),i):n.numErrorOper},t.chkNumMultiOper=function e(t,r){switch(r.kind){case u.OperKind.Number:return(0,c.success)(new s.StrictSparseArray2D(1,1,1,1,[[r]],n.blankOper));case u.OperKind.String:var a=t.coerceOper(r,u.OperKind.Number);return(0,o.isErrorOper)(a)?(0,c.failure)(n.valueErrorOper):(0,c.success)(new s.StrictSparseArray2D(1,1,1,1,[[a]],n.blankOper));case u.OperKind.Blank:return(0,c.success)(new s.StrictSparseArray2D(1,1,1,1,[[t.mathpack.zero]],n.blankOper));case u.OperKind.Missing:return(0,c.failure)(n.naErrorOper);case u.OperKind.Error:return(0,c.failure)(r);case u.OperKind.Range:return e(t,(0,i.refToVal)(t,r,!1));case u.OperKind.Array:return(0,c.success)(new s.StrictSparseArray2D(r.rows,r.cols,r.rows,r.cols,r.opers,n.blankOper));default:return(0,c.failure)(n.valueErrorOper)}};function d(e,t){var r,n,i=e.mathpack.lfix(t);return e.config.date1904?(r=0,n=2957003):(r=0,n=2958465),i>=r&&i<=n}t.validDateRange=d,t.numMod=function(e,t,r){var n=e.div(t,r);if((0,o.isErrorOper)(n))return n;var i=e.mul(e.trunc(n),r);if((0,o.isErrorOper)(i))return i;var a=e.sub(t,i);return!(0,o.isErrorOper)(a)&&e.cond(t)<0?e.abs(a):a}},function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a}));var n=r(3),i=n.resolveService.createResolver,a=n.resolveService.resolveGridRef},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(20),i=n.parserService.createParser},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.falseOper=t.trueOper=t.blankOper=t.missingOper=t.range3DOper=t.rangeSeqOper=t.arrayOper=t.fieldErrorOper=t.gettingDataErrorOper=t.naErrorOper=t.numErrorOper=t.nameErrorOper=t.refErrorOper=t.valueErrorOper=t.div0ErrorOper=t.nullErrorOper=t.errorOper=t.stringOper=t.booleanOper=t.precedents=t.ErrorType=t.cellStringLimit=t.PrecsBound=void 0;var i,a=r(7),o=a.assertions.assertNatural,s=a.assertions.assertPositiveInteger,u=a.assertions.assertFalse,c=a.util.partialArray,l=r(96);function d(e){return{kind:l.OperKind.Error,type:e}}!function(e){e[e.Lower=-1]="Lower",e[e.Exact=0]="Exact",e[e.Upper=1]="Upper"}(t.PrecsBound||(t.PrecsBound={})),t.cellStringLimit=32767,function(e){e[e.NULL=1]="NULL",e[e.DIV0=2]="DIV0",e[e.VALUE=3]="VALUE",e[e.REF=4]="REF",e[e.NAME=5]="NAME",e[e.NUM=6]="NUM",e[e.NA=7]="NA",e[e.GETTING_DATA=8]="GETTING_DATA",e[e.FIELD=13]="FIELD"}(i=t.ErrorType||(t.ErrorType={})),t.precedents=function(e,t,r,n,i){return{cells:e,names:t,udfs:r,special:n,bound:i}},t.booleanOper=function(e){return e?t.trueOper:t.falseOper},t.stringOper=function(e){return{kind:l.OperKind.String,value:e}},t.errorOper=function(e){var t=f[e];return void 0!==t?t:d(e)},t.nullErrorOper=d(i.NULL),t.div0ErrorOper=d(i.DIV0),t.valueErrorOper=d(i.VALUE),t.refErrorOper=d(i.REF),t.nameErrorOper=d(i.NAME),t.numErrorOper=d(i.NUM),t.naErrorOper=d(i.NA),t.gettingDataErrorOper=d(i.GETTING_DATA),t.fieldErrorOper=d(i.FIELD);var f=c(((n={})[i.NULL]=t.nullErrorOper,n[i.DIV0]=t.div0ErrorOper,n[i.VALUE]=t.valueErrorOper,n[i.REF]=t.refErrorOper,n[i.NAME]=t.nameErrorOper,n[i.NUM]=t.numErrorOper,n[i.NA]=t.naErrorOper,n[i.GETTING_DATA]=t.gettingDataErrorOper,n[i.FIELD]=t.fieldErrorOper,n));t.arrayOper=function(e,t,r){return o("calc.lang.arrayOper",e),o("calc.lang.arrayOper",t),r.length!==e?u("calc.lang.arrayOper: Inconsistent row number"):{kind:l.OperKind.Array,rows:e,cols:t,opers:r}},t.rangeSeqOper=function(e,t){return s("calc.lang.rangeSeqOper",t.length),{kind:l.OperKind.Range,sheets:e,ranges:t}},t.range3DOper=function(e,t){return{kind:l.OperKind.Range,sheets:e,ranges:[t]}},t.missingOper={kind:l.OperKind.Missing},t.blankOper={kind:l.OperKind.Blank},t.trueOper={kind:l.OperKind.Boolean,value:!0},t.falseOper={kind:l.OperKind.Boolean,value:!1}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.successUndefined=t.success=t.javaScriptError=t.isSuccess=t.failure=t.ResultKind=t.ReasonKind=void 0;var n=r(7);t.ReasonKind=n.result.ReasonKind,t.ResultKind=n.result.ResultKind,t.failure=n.result.failure,t.isSuccess=n.result.isSuccess,t.javaScriptError=n.result.javaScriptError,t.success=n.result.success,t.successUndefined=n.result.successUndefined},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.values=t.stringStartsWith=t.stringEndsWith=t.repeat=t.prependErrorMessage=t.partialArray=t.messageFromError=t.mathLog2=t.isInteger=t.arrayFill=void 0;var n=r(7);t.arrayFill=n.util.arrayFill,t.isInteger=n.util.isInteger,t.mathLog2=n.util.mathLog2,t.messageFromError=n.util.messageFromError,t.partialArray=n.util.partialArray,t.prependErrorMessage=n.util.prependErrorMessage,t.repeat=n.util.repeat,t.stringEndsWith=n.util.stringEndsWith,t.stringStartsWith=n.util.stringStartsWith,t.values=n.util.values},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.surrogatePairToCodePoint=t.stringFromCodePoint=t.stringCodePointAt=t.scanCodePointsBack=t.scanCodePoints=t.numCodeUnits=t.makeGetCharCodeBits=t.isLowSurrogate=t.isHighSurrogate=t.isAnySurrogate=t.forEachClassInterval=t.countCodePoints=t.codePointIterator=t.CharCodeBits=void 0;var n=r(7);t.CharCodeBits=n.unicode.CharCodeBits,t.codePointIterator=n.unicode.codePointIterator,t.countCodePoints=n.unicode.countCodePoints,t.forEachClassInterval=n.unicode.forEachClassInterval,t.isAnySurrogate=n.unicode.isAnySurrogate,t.isHighSurrogate=n.unicode.isHighSurrogate,t.isLowSurrogate=n.unicode.isLowSurrogate,t.makeGetCharCodeBits=n.unicode.makeGetCharCodeBits,t.numCodeUnits=n.unicode.numCodeUnits,t.scanCodePoints=n.unicode.scanCodePoints,t.scanCodePointsBack=n.unicode.scanCodePointsBack,t.stringCodePointAt=n.unicode.stringCodePointAt,t.stringFromCodePoint=n.unicode.stringFromCodePoint,t.surrogatePairToCodePoint=n.unicode.surrogatePairToCodePoint},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.now=t.mapFromArrayOfPairs=t.singleton=t.typedInstanceCreator=t.makeStringCompareCI=t.fastAbs=t.fastMax=t.fastMin=t.pair=t.filterOutNones=t.isNone=t.isDefined=t.safeConcat=t.safePush=t.strEnumArray=t.numEnumMap=t.numEnumArray=t.cloneStringMap=t.makeStringMap=t.identity=t.staticAssertIsOptional=t.staticAssertIs=t.staticAssertSame=t.staticAssertExtends=t.makeNewtypeIso=void 0;var n=r(7);t.makeNewtypeIso=n.core.makeNewtypeIso,t.staticAssertExtends=n.core.staticAssertExtends,t.staticAssertSame=n.core.staticAssertSame,t.staticAssertIs=n.core.staticAssertIs,t.staticAssertIsOptional=n.core.staticAssertIsOptional,t.identity=n.core.identity,t.makeStringMap=n.core.makeStringMap,t.cloneStringMap=n.core.cloneStringMap,t.numEnumArray=n.core.numEnumArray,t.numEnumMap=n.core.numEnumMap,t.strEnumArray=n.core.strEnumArray,t.safePush=n.core.safePush,t.safeConcat=n.core.safeConcat,t.isDefined=n.core.isDefined,t.isNone=n.core.isNone,t.filterOutNones=n.core.filterOutNones,t.pair=n.core.pair,t.fastMin=n.core.fastMin,t.fastMax=n.core.fastMax,t.fastAbs=n.core.fastAbs,t.makeStringCompareCI=n.core.makeStringCompareCI,t.typedInstanceCreator=n.core.typedInstanceCreator,t.singleton=n.core.singleton,t.mapFromArrayOfPairs=n.core.mapFromArrayOfPairs,t.now=n.core.now},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.surrogatePairToCodePoint=t.stringFromCodePoint=t.stringCodePointAt=t.scanCodePointsBack=t.scanCodePoints=t.numCodeUnits=t.makeGetCharCodeBits=t.isLowSurrogate=t.isHighSurrogate=t.isAnySurrogate=t.forEachClassInterval=t.countCodePoints=t.codePointIterator=t.CharCodeBits=void 0;var n=r(7);t.CharCodeBits=n.unicode.CharCodeBits,t.codePointIterator=n.unicode.codePointIterator,t.countCodePoints=n.unicode.countCodePoints,t.forEachClassInterval=n.unicode.forEachClassInterval,t.isAnySurrogate=n.unicode.isAnySurrogate,t.isHighSurrogate=n.unicode.isHighSurrogate,t.isLowSurrogate=n.unicode.isLowSurrogate,t.makeGetCharCodeBits=n.unicode.makeGetCharCodeBits,t.numCodeUnits=n.unicode.numCodeUnits,t.scanCodePoints=n.unicode.scanCodePoints,t.scanCodePointsBack=n.unicode.scanCodePointsBack,t.stringCodePointAt=n.unicode.stringCodePointAt,t.stringFromCodePoint=n.unicode.stringFromCodePoint,t.surrogatePairToCodePoint=n.unicode.surrogatePairToCodePoint},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.runOperatorPrecedenceParser=t.isWSFNode=t.maybeWSFTerm=t.structRefTerm=t.fieldRefTerm=t.argsTerm=t.lambdaArgsTerm=t.TermKind=void 0;var i,a=r(2),o=r(18),s=r(102),u=r(65),c=r(59),l=r(104),d=r(88),f=r(79),p=r(89),m=r(98),h=r(87),v=r(97),g=r(66),b=r(116);function S(e,t,r,n){return{kind:i.FieldRefTerm,hasDotPreSpace:e,rhs:t,start:r,end:n}}function y(e){return e.kind!==f.TokenKind.Operator&&e.kind!==f.TokenKind.Sep&&e.kind!==f.TokenKind.End&&e.kind!==f.TokenKind.Spaces&&!(e.kind in i)}function O(e,t){return y(t=t.kind===i.MaybeWSFTerm?t.node:t)?(0,m.getNodeSpan)(e,t).start:t.start}!function(e){e.LambdaArgsTerm="LambdaArgsTerm",e.ArgsTerm="ArgsTerm",e.FieldRefTerm="FieldRefTerm",e.StructRefTerm="StructRefTerm",e.MaybeWSFTerm="MaybeWSFTerm"}(i=t.TermKind||(t.TermKind={})),t.lambdaArgsTerm=function(e,t,r,n){return{kind:i.LambdaArgsTerm,nodes:e,isClosed:t,start:r,end:n}},t.argsTerm=function(e,t,r,n){return{kind:i.ArgsTerm,nodes:e,isClosed:t,start:r,end:n}},t.fieldRefTerm=S,t.structRefTerm=function(e,t,r){return{kind:i.StructRefTerm,rhs:e,start:t,end:r}},t.maybeWSFTerm=function(e,t){return{kind:i.MaybeWSFTerm,node:e,whole:t}};var C=(0,p.opt)((0,p.take)((function(e,t){return t.kind===f.TokenKind.Spaces?t.chars:void 0})),""),P=function(e,t,r,n,i){var a=e[t];if(null==a){var c="calc.parse.pStart: internal error: expected term at ".concat(t," in ").concat((0,s.anonymize)(e));return u.ulsLogger.ULS.assertTag(589825160,o.LogCategory.msoulscat_ES_EWAJS,!1,c)}return n(O(r,a),t)};function N(e){return(0,p.apply)((0,p.tuple)(C,P,(0,p.take)(e),P,C),(function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4];return(0,c.operatorNode)(i,(0,m.addSpan)(e,n,a,r,o))}))}function R(e){return(0,p.apply)((0,p.tuple)(C,P,(0,p.take)(e),P),(function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3];return(0,c.operatorNode)(i,(0,m.addSpan)(e,n,a,r,""))}))}function k(e){return(0,p.apply)((0,p.tuple)(P,(0,p.take)(e),P,C),(function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3];return(0,c.operatorNode)(n,(0,m.addSpan)(e,r,i,"",a))}))}var T=N((function(e,t){return t.kind!==f.TokenKind.Operator||t.value!==l.OperatorId.Add&&t.value!==l.OperatorId.Sub?void 0:t.value})),E=k((function(e,t){if(t.kind===f.TokenKind.Operator){if(t.value===l.OperatorId.Add)return l.OperatorId.Pos;if(t.value===l.OperatorId.Sub)return l.OperatorId.Neg}})),_=k((function(e,t){return t.kind===f.TokenKind.Operator&&t.value===l.OperatorId.At?t.value:void 0})),F=R((function(e,t){return t.kind===f.TokenKind.Operator&&t.value===l.OperatorId.Pound?t.value:void 0})),I=(0,p.take)((function(e,t){return t.kind===i.StructRefTerm?t:void 0})),A=N((function(e,t){return t.kind!==f.TokenKind.Operator||t.value!==l.OperatorId.Mul&&t.value!==l.OperatorId.Div?void 0:t.value})),M=N((function(e,t){return t.kind===f.TokenKind.Operator&&t.value===l.OperatorId.Pow?t.value:void 0})),w=R((function(e,t){return t.kind===f.TokenKind.Operator&&t.value===l.OperatorId.Percent?t.value:void 0})),D=N((function(e,t){return t.kind===f.TokenKind.Operator&&t.value===l.OperatorId.Concat?t.value:void 0})),j=N((function(e,t){return t.kind===f.TokenKind.Operator&&t.value>=l.OperatorId.Eq&&t.value<=l.OperatorId.Ge?t.value:void 0})),x=N((function(e,t){return t.kind===f.TokenKind.Operator&&t.value===l.OperatorId.Range?t.value:void 0})),L=N((function(e,t){return t.kind===f.TokenKind.Operator&&t.value===l.OperatorId.Union?t.value:void 0})),B=(0,p.takePeek)((function(e,t,r){if(t.kind===f.TokenKind.Spaces&&r.kind!==f.TokenKind.End&&(r.kind!==f.TokenKind.Operator||r.value===l.OperatorId.At)&&!(0,v.isDotSepToken)(r)){var n=(0,m.addSpan)(e,t.start,O(e,r),t.chars,"");return(0,c.operatorNode)(l.OperatorId.Isect,n)}})),U=(0,p.take)((function(e,t){return(0,v.isDotSepToken)(t)?t:void 0})),G=(0,p.take)((function(e,t){return t.kind===i.ArgsTerm?t:void 0})),K=(0,p.take)((function(e,t){return t.kind===i.LambdaArgsTerm?t:void 0})),V=(0,p.take)((function(e,t){return t.kind===i.ArgsTerm||t.kind===i.FieldRefTerm?t:void 0})),W=((n={})[l.WorksheetFuncId.LETREC]=b.FeatureName.CalcLetRecFunction,n[l.WorksheetFuncId.LAMBDA]=b.FeatureName.CalcLambdaFunction,n);function H(e,t){if(t.kind===i.MaybeWSFTerm&&void 0!==t.whole){var r=(0,h.getWorksheetFuncId)(e,t.whole);if(void 0===r)return;(0,u.assertTrue)("calc.parse.parseWSFName: unexpected UDF",r!==l.WorksheetFuncId._UDF);var n=W[r];if(void 0!==n&&!(0,b.isFeatureEnabled)(n))return;return(0,c.wsfNode)(r,t.whole,t.node.label)}}t.isWSFNode=H;var q=(0,p.take)((function(e,t){return H(e.localeInfo,t)})),z=(0,p.take)((function(e,t){var r=H(e.localeInfo,t);return(null==r?void 0:r.id)===l.WorksheetFuncId.LAMBDA?r:void 0}));var Q=(0,p.apply)((0,p.tuple)(z,K),(function(e,t){for(var r,n=t[0],i=t[1],a=(0,m.getNodeSpan)(e,n).start,o=i.nodes,s=(n.id,[]),u=[],l=0;l<o.length;l+=1){var d=o[l];d.kind===c.NodeKind.Param?s.push((0,c.lambdaParam)((0,c.indexedArg)(d,l))):l===o.length-1?r=(0,c.indexedArg)(d,l):u.push((0,c.indexedArg)(d,l))}var f=(0,m.addSpan)(e,a,i.end,"","");return(0,c.lambdaNode)(n,s,r,u,i.isClosed,f)})),J=(0,p.apply)((0,p.tuple)(q,G),(function(e,t){var r,n,i=t[0],a=t[1],o=(0,m.getNodeSpan)(e,i).start,s=a.nodes;switch(i.id){case l.WorksheetFuncId.LET:case l.WorksheetFuncId.LETREC:i.id;for(var d=[],f=[],p=void 0,v=0;v<s.length;v+=1){var g=s[v];v!==s.length-1?!(v+1<s.length&&(0,h.isUnqualifiedNameNode)(g))||v+3<s.length&&(r=e.refStyle,n=s[v+2],!((0,h.isUnqualifiedNameNode)(n)||r===c.RefStyle.A1&&n.kind===c.NodeKind.CellRef&&void 0===n.qualifier&&n.ref.kind===c.CellRefKind.Single&&n.ref.col.kind===c.PosKind.Rel&&n.ref.row.kind===c.PosKind.Rel))&&(0,h.isUnqualifiedNameNode)(s[v+1])?f.push((0,c.indexedArg)(g,v)):(d.push((0,c.letVar)((0,c.indexedArg)(g,v),(0,c.indexedArg)(s[v+1],v+1))),v+=1):p=(0,c.indexedArg)(g,v)}var b=(0,m.addSpan)(e,o,a.end,"","");return(0,c.letNode)(i,d,p,f,a.isClosed,b);case l.WorksheetFuncId.LAMBDA:return(0,u.assertFalse)("calc.parse.parseWSFApp: unexpected LAMBDA+ArgTerm")}return X(e,i,s,a.isClosed,o,a.end)}));function Y(e,t,r){return(0,p.apply)((0,p.tuple)((0,p.many)(e),t),(function(e,t){var n=t[0],i=t[1];return n.reduceRight(r(e),i)}))}function $(e,t,r){return(0,p.apply)((0,p.tuple)(e,(0,p.many)(t)),(function(e,t){var n=t[0];return t[1].reduce(r(e),n)}))}function Z(e){return function(t,r){var n=r[0],i=r[1],a=(0,m.getNodeSpan)(e,t).start,o=(0,m.getNodeSpan)(e,i).end,s=(0,m.addSpan)(e,a,o,"","");return(0,c.appNode)(n,[t,i],!0,s)}}function X(e,t,r,n,i,a){var o=(0,m.addSpan)(e,i,a,"","");return(0,c.appNode)(t,r,n,o)}function ee(e){return function(t,r){var n=(0,m.getNodeSpan)(e,t).start;switch(r.kind){case i.ArgsTerm:return X(e,t,r.nodes,r.isClosed,n,r.end);case i.FieldRefTerm:var a=(0,m.addSpan)(e,n,r.end,"",""),o=(0,m.getNodeSpan)(e,r.rhs),s=o.start,u=o.end,l=o.pre,f=o.post;if((0,h.isNumberNode)(t)){var p=(0,m.addSpan)(e,s,s,"",""),v=(0,c.literalNode)(d.missingOper,!0,p),g=(0,m.addSpan)(e,s,u,l,f),b=(0,m.addSpan)(e,s,u,"",""),S=(0,c.fieldRef)(r.rhs.field,r.rhs.isBracketed,r.rhs.isClosed,b);return(0,c.badNode)(c.BadType.FieldRef,[t,(0,c.fieldRefNode)(v,S,!1,g)],a)}var y=!r.rhs.isBracketed&&(0,h.shouldFieldRefBeBracketed)(t,r.rhs,l);return(0,c.fieldRefNode)(t,r.rhs,y,a);case i.StructRefTerm:a=(0,m.addSpan)(e,n,r.end,"","");return t.kind===c.NodeKind.Name||(0,h.isMissingNode)(t)?(0,c.structRefNode)(t.kind===c.NodeKind.Name?t:void 0,r.rhs,a):(0,c.badNode)(c.BadType.StructRef,[t,(0,c.structRefNode)(void 0,r.rhs,(0,m.addSpan)(e,r.start,r.end,"",""))],a);case c.NodeKind.Operator:return X(e,r,[t],!0,n,(0,m.getNodeSpan)(e,r).end)}}}function te(e){var t=!0;return function(r,n){var i=(0,m.getNodeSpan)(e,n).start,a=(0,m.getNodeSpan)(e,r).end,o=(0,m.addSpan)(e,i,a,"","");if((n.id===l.OperatorId.Pos||n.id===l.OperatorId.Neg)&&t&&(t=!1,(0,h.isNumberNode)(r)&&""===(0,m.getNodeSpan)(e,n).post)){var s=n.id===l.OperatorId.Pos?r.oper:e.mathpack.neg(r.oper);return(0,c.literalNode)(s,!0,o)}return(0,c.appNode)(n,[r],!0,o)}}var re=(0,p.take)((function(e,t){return t.kind===i.MaybeWSFTerm?t.node:y(t)?t:void 0})),ne=(0,p.apply)((0,p.tuple)(C,U,P,C),(function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3];return(0,c.badNode)(c.BadType.Unexpected,n.chars,(0,m.addSpan)(e,n.start,i,r,a))})),ie=(0,p.apply)((0,p.tuple)(P,C,U,P),(function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=(0,m.addSpan)(e,a,a,"",""),s=(0,m.addSpan)(e,i.start,a,n,""),u=(0,c.fieldRef)((0,c.badNode)(c.BadType.Missing,"",o),!1,!0,s);return S(n.length>0,u,r,a)})),ae=(0,p.lazy)((function(){return(0,p.apply)((0,p.tuple)(P,(0,p.many)((0,p.any)(Q,J,re,ne),(0,p.any)(Q,J,re,(0,p.right)((0,p.succeeds)(_),le))),P),(function(e,t){var r=t[0],n=t[1],i=t[2];if(1===n.length)return n[0];var a=(0,m.addSpan)(e,r,i,"","");return 0===n.length?(0,c.literalNode)(d.missingOper,!0,a):(0,c.badNode)(c.BadType.Sequence,n,a)}))})),oe=$((0,p.lazy)((function(){return(0,p.any)((0,p.right)((0,p.succeeds)(_),le),(0,p.right)((0,p.succeeds)(E),fe),ae)})),(0,p.any)(F,I),ee),se=$(oe,(0,p.tuple)(x,oe),Z),ue=$(se,(0,p.tuple)(B,se),Z),ce=$(ue,(0,p.any)(V,ie),ee),le=Y(_,ce,te),de=$(le,(0,p.tuple)(L,le),Z),fe=Y(E,de,te),pe=$(fe,w,ee),me=$(pe,(0,p.tuple)(M,pe),Z),he=$(me,(0,p.tuple)(A,me),Z),ve=$(he,(0,p.tuple)(T,he),Z),ge=$(ve,(0,p.tuple)(D,ve),Z),be=$(ge,(0,p.tuple)(j,ge),Z);t.runOperatorPrecedenceParser=function(e,t){var r=t.length-1;if(1===r&&y(t[0]))return t[0];if(r<1){var n="calc.parse.runTermParser: internal error: expected at least 1 term";return u.ulsLogger.ULS.assertTag(589825161,o.LogCategory.msoulscat_ES_EWAJS,!1,n)}if(t[0].kind===f.TokenKind.Spaces){n="calc.parse.runTermParser: internal error: array[0].kind === Spaces in ".concat((0,s.anonymize)(t));return u.ulsLogger.ULS.assertTag(589825162,o.LogCategory.msoulscat_ES_EWAJS,!1,n)}if(r-1>=0&&t[r-1].kind===f.TokenKind.Spaces){n="calc.parse.runTermParser: internal error: array[n-1].kind === Spaces in ".concat((0,s.anonymize)(t));return u.ulsLogger.ULS.assertTag(589825163,o.LogCategory.msoulscat_ES_EWAJS,!1,n)}if(t[r].kind!==f.TokenKind.End){n="calc.parse.runTermParser: internal error: array[n].kind !== End in ".concat((0,s.anonymize)(t));return u.ulsLogger.ULS.assertTag(589825164,o.LogCategory.msoulscat_ES_EWAJS,!1,n)}for(;;){var i=(0,p.runParser)(be,t,0,e);if((0,g.isSuccess)(i)&&i.value.index>=r)return i.value.output;if(!(0,g.isSuccess)(i)||0===i.value.index||1===i.value.index&&y(t[0])){var c=(0,g.isSuccess)(i)?i.value.index:0;n="calc.parse.runTermParser: internal error: consumed ".concat(c," out of ").concat(r," in ").concat((0,s.anonymize)(t));return u.ulsLogger.ULS.assertTag(589825165,o.LogCategory.msoulscat_ES_EWAJS,!1,n)}r=(t=a.__spreadArray([i.value.output],t.slice(i.value.index),!0)).length-1}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFeatureGateDictionaryGetter=t.overrideTypedFeatureGates=t.isTypedChangeGateEnabled=t.getTypedFeatureGate=t.getFeatures=t.isFeatureEnabled=t.initFeatureConfiguration=t.FeatureName=void 0;var n=r(7);t.FeatureName=n.featureConfiguration.FeatureName,t.initFeatureConfiguration=n.featureConfiguration.initFeatureConfiguration,t.isFeatureEnabled=n.featureConfiguration.isFeatureEnabled,t.getFeatures=n.featureConfiguration.getFeatures,t.getTypedFeatureGate=n.featureConfiguration.getTypedFeatureGate,t.isTypedChangeGateEnabled=n.featureConfiguration.isTypedChangeGateEnabled;var i=r(41);Object.defineProperty(t,"overrideTypedFeatureGates",{enumerable:!0,get:function(){return i.overrideTypedFeatureGates}}),Object.defineProperty(t,"setFeatureGateDictionaryGetter",{enumerable:!0,get:function(){return i.setFeatureGateDictionaryGetter}})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.recordNameCycle=t.appendVisitedName=t.emptyVisitedNames=t.recordCellCycle=t.appendVisitedCell=t.emptyVisitedCells=void 0;var n=r(149),i=r(105),a=r(43);function o(e,t,r){return void 0===e?void 0===t?0:-1:void 0===t?1:r(e,t)}function s(e,t){return e<t?-1:e===t?0:1}function u(e,t){return"string"==typeof e?"string"!=typeof t?1:s(e,t):"string"==typeof t||e<t?-1:e===t?0:1}function c(e,t){var r;return 0!==(r=s(e.name,t.name))?r:o(e.path,t.path,s)}function l(e,t){return{current:e,map:t}}function d(e,t){return{current:e,map:t}}t.emptyVisitedCells=l(void 0,n.RedBlackMapTree.create((function(e,t){var r;return 0!=(r=e.range.col-t.range.col)||0!=(r=e.range.row-t.range.row)||0!==(r=u(e.sheet.index,t.sheet.index))?r:c(e.sheet.document,t.sheet.document)}))),t.appendVisitedCell=function(e,t){return(0,a.assertTrue)("calc.runtime.appendVisitedCell",t.previous===e.current),l(t,e.map.setValue(t.cell,t))},t.recordCellCycle=function(e,t){for(var r=[],n=(0,i.cellCycle)(r),a=t;r.push(a.cell),a.cycle=n,a!==e;a=a.previous);return r.reverse(),n},t.emptyVisitedNames=d(void 0,n.RedBlackMapTree.create((function(e,t){var r;return 0!==(r=s(e.name,t.name))||0!==(r=o(e.scope.index,t.scope.index,u))?r:c(e.scope.document,t.scope.document)}))),t.appendVisitedName=function(e,t){var r={name:t,previous:e.current};return d(r,e.map.setValue(t,r))},t.recordNameCycle=function(e,t){for(var r=[],n=t;r.push(n.name),n!==e;n=n.previous);return r.reverse(),(0,i.nameCycle)(r)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.nameNode=t.missingRef=t.localNameUseAnnotation=t.localNameDeclAnnotation=t.literalNode=t.letVar=t.letNode=t.lambdaParam=t.lambdaNode=t.indexedArg=t.identQualifier=t.identNamePart=t.headNamePart=t.formulaSpan=t.formulaRootAnnotation=t.formula=t.flattenNameParts=t.flattenLetArgs=t.flattenLambdaArgs=t.fieldRefNode=t.fieldRefNamePart=t.fieldRef=t.errorQualifier=t.documentQualifier=t.commaOpRef=t.columnRef=t.cellRefSingle=t.cellRefRow=t.cellRefRange=t.cellRefNode=t.cellRefNamePart=t.cellRefError=t.cellRefCol=t.cellRefBad=t.badRef=t.badQualifier=t.badNode=t.arrayNode=t.appNode=t.appHeadNameAnnotation=t.StructRefKind=t.SpecialRefId=t.RefStyle=t.QualifierKind=t.PosKind=t.NodeKind=t.NamePartKind=t.CellRefKind=t.BadType=t.AnnotationKind=void 0,t.getDepthUpperBound=t.wsfNode=t.thisRowOpRef=t.structRefNode=t.structRef=t.specialRef=t.sheetRangeQualifier=t.sheetQualifier=t.relativeQualifier=t.rangeOpRef=t.pos=t.parenNode=t.paramNode=t.paramName=t.paramDefault=t.operatorNode=void 0;var n=r(3);t.AnnotationKind=n.formulaModule.AnnotationKind,t.BadType=n.formulaModule.BadType,t.CellRefKind=n.formulaModule.CellRefKind,t.NamePartKind=n.formulaModule.NamePartKind,t.NodeKind=n.formulaModule.NodeKind,t.PosKind=n.formulaModule.PosKind,t.QualifierKind=n.formulaModule.QualifierKind,t.RefStyle=n.formulaModule.RefStyle,t.SpecialRefId=n.formulaModule.SpecialRefId,t.StructRefKind=n.formulaModule.StructRefKind,t.appHeadNameAnnotation=n.formulaModule.appHeadNameAnnotation,t.appNode=n.formulaModule.appNode,t.arrayNode=n.formulaModule.arrayNode,t.badNode=n.formulaModule.badNode,t.badQualifier=n.formulaModule.badQualifier,t.badRef=n.formulaModule.badRef,t.cellRefBad=n.formulaModule.cellRefBad,t.cellRefCol=n.formulaModule.cellRefCol,t.cellRefError=n.formulaModule.cellRefError,t.cellRefNamePart=n.formulaModule.cellRefNamePart,t.cellRefNode=n.formulaModule.cellRefNode,t.cellRefRange=n.formulaModule.cellRefRange,t.cellRefRow=n.formulaModule.cellRefRow,t.cellRefSingle=n.formulaModule.cellRefSingle,t.columnRef=n.formulaModule.columnRef,t.commaOpRef=n.formulaModule.commaOpRef,t.documentQualifier=n.formulaModule.documentQualifier,t.errorQualifier=n.formulaModule.errorQualifier,t.fieldRef=n.formulaModule.fieldRef,t.fieldRefNamePart=n.formulaModule.fieldRefNamePart,t.fieldRefNode=n.formulaModule.fieldRefNode,t.flattenLambdaArgs=n.formulaModule.flattenLambdaArgs,t.flattenLetArgs=n.formulaModule.flattenLetArgs,t.flattenNameParts=n.formulaModule.flattenNameParts,t.formula=n.formulaModule.formula,t.formulaRootAnnotation=n.formulaModule.formulaRootAnnotation,t.formulaSpan=n.formulaModule.formulaSpan,t.headNamePart=n.formulaModule.headNamePart,t.identNamePart=n.formulaModule.identNamePart,t.identQualifier=n.formulaModule.identQualifier,t.indexedArg=n.formulaModule.indexedArg,t.lambdaNode=n.formulaModule.lambdaNode,t.lambdaParam=n.formulaModule.lambdaParam,t.letNode=n.formulaModule.letNode,t.letVar=n.formulaModule.letVar,t.literalNode=n.formulaModule.literalNode,t.localNameDeclAnnotation=n.formulaModule.localNameDeclAnnotation,t.localNameUseAnnotation=n.formulaModule.localNameUseAnnotation,t.missingRef=n.formulaModule.missingRef,t.nameNode=n.formulaModule.nameNode,t.operatorNode=n.formulaModule.operatorNode,t.paramDefault=n.formulaModule.paramDefault,t.paramName=n.formulaModule.paramName,t.paramNode=n.formulaModule.paramNode,t.parenNode=n.formulaModule.parenNode,t.pos=n.formulaModule.pos,t.rangeOpRef=n.formulaModule.rangeOpRef,t.relativeQualifier=n.formulaModule.relativeQualifier,t.sheetQualifier=n.formulaModule.sheetQualifier,t.sheetRangeQualifier=n.formulaModule.sheetRangeQualifier,t.specialRef=n.formulaModule.specialRef,t.structRef=n.formulaModule.structRef,t.structRefNode=n.formulaModule.structRefNode,t.thisRowOpRef=n.formulaModule.thisRowOpRef,t.wsfNode=n.formulaModule.wsfNode,t.getDepthUpperBound=n.formulaModule.getDepthUpperBound},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LambdaOper=t.RecordOper=void 0;var n=r(40),i=r(48),a=function(){function e(e,t){void 0===t&&(t=n.valueErrorOper),this._fields=e,this._fallback=t,this.kind=i.OperKind.Rich}return e.prototype.getFallback=function(){return this._fallback},e.prototype.getField=function(e){return this._fields.getValue(e)},e}();t.RecordOper=a;var o=function(){function e(e,t,r,n,a,o,s,u){this.minArity=e,this.maxArity=t,this.paramLabels=r,this.locals=n,this.stackEnv=a,this.stackMap=o,this.defIdxs=s,this.defsAndBody=u,this.kind=i.OperKind.Rich}return e.prototype.getFallback=function(){return n.valueErrorOper},e.prototype.getField=function(e){},e}();t.LambdaOper=o},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(22),i=n.formatService.createNumberFormatter},function(e,t,r){"use strict";r.d(t,"b",(function(){return u})),r.d(t,"a",(function(){return c}));var n=r(24),i=r(0),a=r(57),o=r(10),s={type:a.a.None,color:{argb:"00000000"}},u={font:{name:"Calibri",bold:!1,italic:!1,underline:a.c.None,strikethrough:!1,verticalAlign:a.d.None,size:11,color:{argb:"ff000000"}},fill:{kind:a.b.Pattern,pattern:a.f.None,fgColor:{argb:"00000000"},bgColor:{argb:"00000000"}},border:{top:s,bottom:s,left:s,right:s},alignment:{horizontal:a.e.Automatic,vertical:a.g.Bottom,textRotation:0,wrapText:!1,indent:0,relativeIndent:0,shrinkToFit:!1,readingOrder:0}},c=function(){function e(){this.styles=[],this.fonts=[],this.fills=[],this.borders=[]}return e.prototype.clone=function(){function t(e,t){Object.keys(e).map(Number).forEach((function(r){t[r]=e[r]}))}var r=new e;return t(this.styles,r.styles),t(this.fonts,r.fonts),t(this.fills,r.fills),t(this.borders,r.borders),r},e.prototype.resolveCellStyle=function(e){if(e===o.g.Blank)return Object(i.e)(u);var t=this.styles[e];if(void 0===t)return Object(i.b)({kind:n.e.StyleId,styleId:e});var r=t.fontId,a=t.fillId,s=t.borderId,c=t.alignment,l=void 0!==r?this.fonts[r]:u.font;if(void 0===l)return Object(i.b)({kind:n.e.FontId,fontId:r});var d=void 0!==a?this.fills[a]:u.fill;if(void 0===d)return Object(i.b)({kind:n.e.FillId,fillId:a});var f=void 0!==s?this.borders[s]:u.border;return void 0===f?Object(i.b)({kind:n.e.BorderId,borderId:s}):Object(i.e)({font:l,fill:d,border:f,alignment:c})},e.prototype.setStyles=function(e,t){var r=this;t||(this.styles=[]),Object.keys(e).map(Number).forEach((function(t){r.styles[t]=e[t]}))},e.prototype.setFonts=function(e,t){var r=this;t||(this.fonts=[]),Object.keys(e).map(Number).forEach((function(t){r.fonts[t]=e[t]}))},e.prototype.setFills=function(e,t){var r=this;t||(this.fills=[]),Object.keys(e).map(Number).forEach((function(t){r.fills[t]=e[t]}))},e.prototype.setBorders=function(e,t){var r=this;t||(this.borders=[]),Object.keys(e).map(Number).forEach((function(t){r.borders[t]=e[t]}))},e}()},function(e,t,r){"use strict";r.d(t,"b",(function(){return c})),r.d(t,"a",(function(){return l}));var n=r(2),i=r(1),a=r(29),o=r(34),s=r(9),u=r(18),c=new a.a((function(){try{for(var e=new Map,t=0,r=Object.keys(i.b);t<r.length;t++){var n=r[t],a=Number(n);isNaN(Number(a))||e.set(a,FormulaAuthoringStrings[i.b[a]+"ShortDescription"])}return{descriptionsMap:e}}catch(e){return s.h.ULS.traceTag(538792415,u.LogCategory.msoulscat_ES_EWAJS,u.TraceLevel.Info,"failed to get functionShortDescriptionsMap with exception ".concat(e)),{}}})),l=Object(a.b)((function(){return Object(n.__awaiter)(void 0,void 0,void 0,(function(){return Object(n.__generator)(this,(function(e){switch(e.label){case 0:return[4,o.b.getValue()];case 1:return[4,e.sent().loadPluginScript("formula-authoring-strings",!0)];case 2:return e.sent(),[2]}}))}))}))},function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var n=r(2),i=r(8),a=r(4),o=r(12),s=r(27),u=r(31),c=r(11),l=r(156),d=r(45),f={localeInfo:Object(o.p)(),mathpack:l.a,refStyle:c.h.A1,timezone:d.f,date1904:!1,dateCompatibility:!0,datepack:d.g},p=function(){function e(){this.document=Object(i.d)(void 0,""),this.langConfig=f}return e.prototype.getLangConfig=function(){return this.langConfig},e.prototype.setA1ReferenceStyle=function(e,t,r){this.langConfig=Object(n.__assign)(Object(n.__assign)({},this.langConfig),{refStyle:r?c.h.A1:c.h.R1C1}),e.setLangConfig(t,this.langConfig)},e.prototype.setLocaleInfo=function(e,t,r,i){Object(s.w)(r,s.h,i,"localeData")&&(this.langConfig=Object(n.__assign)(Object(n.__assign)({},this.langConfig),{localeInfo:Object(u.d)(r,i)}),e.setLangConfig(t,this.langConfig))},e.prototype.setWorkbookProps=function(e,t,r,i){var a,o,u;Object(s.w)(r,s.u,i,"workbookProps")&&(this.langConfig=Object(n.__assign)(Object(n.__assign)({},this.langConfig),{date1904:null!==(a=r.date1904)&&void 0!==a?a:f.date1904,dateCompatibility:null!==(o=r.dateCompatibility)&&void 0!==o?o:f.dateCompatibility,timezone:null!==(u=r.timezone)&&void 0!==u?u:f.timezone}),e.setLangConfig(t,this.langConfig))},e.prototype.updateSheetNames=function(e,t,r,n){e.setSheetNames(this.document,Object(s.x)(r,s.s,n,"sheetNames"),t)},e.prototype.updateNamedObjects=function(e,t,r,n){for(var o=0,c=Object(s.x)(r,s.j,n,"namedObjectsUpdates");o<c.length;o++){var l=c[o],d=l.scope,f=l.objects,p=l.fromStateId,m=Object(i.o)(this.document,Object(a.e)(d)?d:void 0);if(Object(a.e)(f))for(var h=0,v=Object(s.x)(f,Object(s.i)(d),n,"namedObjectsUpdates.<index>.objects");h<v.length;h++){var g=v[h],b=g.name,S=g.data;e.writeNamedObject(t,m,b,Object(u.h)(this.langConfig.mathpack,this.langConfig.localeInfo.stringCompareCI,this.document,S))}else Object(a.e)(p)?e.promoteNamedObjects(t,m,p):e.writeUndefinedNames(t,m)}},e}()},function(e,t,r){"use strict";r.d(t,"b",(function(){return l})),r.d(t,"a",(function(){return d}));var n=r(2),i=r(4),a=r(67),o=r(18),s=r(9),u=r(44);function c(e,t){for(var r=0,n=0;n<t;){var a=e.indexOf("\n",n),o=e.indexOf("\r",n),s=a<0?o:o<0?a:Object(i.c)(a,o);if(s<0||s>=t)break;r+=1,n=s+1+(s===o&&s+1<t&&10===e.charCodeAt(s+1)?1:0)}return{line:r,character:t-n}}function l(e,t,r){return{start:c(e,t),end:c(e,r)}}var d=function(){function e(e,t,r){void 0===r&&(r=!0),this.name=e,this.logThreshold=t,this.enabled=r,this.timestamps=new Map,this.timer=a.b,this.workerInfo={isWorkerThread:Object(u.isWorkerThread)(),workerName:Object(u.workerName)()},s.h.ULS.traceTag(526223315,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"Timeline[".concat(this.name,"]: Initializing, ").concat(JSON.stringify(this.workerInfo)))}return e.prototype.stamp=function(e){this.enabled&&!this.timestamps.has(e)&&this.timestamps.set(e,this.timer.now())},e.prototype.log=function(e){if(this.enabled){this.stamp(e);var t={},r=this.timer.now(),i=0;this.timestamps.forEach((function(e,n){r=Math.min(r,e),i=Math.max(i,e),t[n]=e})),i-r>this.logThreshold&&s.h.ULS.traceTag(526234881,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Info,"Timeline[".concat(this.name,"]: ").concat(JSON.stringify(Object(n.__assign)(Object(n.__assign)({},t),this.workerInfo)))),this.timestamps.clear()}},e}()},function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a})),r.d(t,"c",(function(){return o}));var n=r(22),i=(n.knownFormat.buildCurrencyFormat,n.knownFormat.buildFractionFormat,n.knownFormat.buildMMDDYYFormat,n.knownFormat.buildNumberFormat,n.knownFormat.buildPercentFormat,n.knownFormat.buildScientificFormat,n.knownFormat.buildSingle,n.knownFormat.englishXLSXKnownFormat),a=(n.knownFormat.getColor,n.knownFormat.getKnownFormat),o=(n.knownFormat.getSingle,n.knownFormat.getSpecial,n.knownFormat.isKnownFormatDefined)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isTypedChangeGateEnabled=t.setFeatureGateDictionaryGetter=t.overrideTypedFeatureGates=t.getTypedFeatureGate=t.getFeatures=t.isFeatureEnabled=t.initFeatureConfiguration=t.FeatureName=void 0;var n,i=r(101),a=r(18),o=r(41);!function(e){e.FeatureCheckingEnabled="FeatureCheckingEnabled",e.CalcPreventSpillingHack="CalcPreventSpillingHack",e.CalcLegacyImplicitIntersection="CalcLegacyImplicitIntersection",e.CalcRecordFunctions="CalcRecordFunctions",e.CalcNestedRecordFunction="CalcNestedRecordFunction",e.CalcLetRecFunction="CalcLetRecFunction",e.CalcLambdaFunction="CalcLambdaFunction",e.CalcLambdaBasicFunctions="CalcLambdaBasicFunctions",e.CalcLambdaHelperFunctions="CalcLambdaHelperFunctions",e.CalcLambdaOptionalParameters="CalcLambdaOptionalParameters",e.CalcLambdaDefaultParameters="CalcLambdaDefaultParameters",e.CalcLambdaCellValues="CalcLambdaCellValues",e.CalcLambdaArrayLifting="CalcLambdaArrayLifting",e.CalcWebWorkerTest="CalcWebWorkerTest",e["OfficeVSO:3852168_CalcNFFracFix"]="OfficeVSO:3852168_CalcNFFracFix",e["OfficeVSO:3594447_InvalidQualifier"]="OfficeVSO:3594447_InvalidQualifier",e["OfficeVSO:3594447_InvalidQualifier2"]="OfficeVSO:3594447_InvalidQualifier2",e["OfficeVSO:3594447_R1C0_Fix"]="OfficeVSO:3594447_R1C0_Fix",e["OfficeVSO:5484395_SafeParseResultHelper"]="OfficeVSO:5484395_SafeParseResultHelper",e["OfficeVSO:3594447_A1_BadDollar"]="OfficeVSO:3594447_A1_BadDollar",e["OfficeVSO:3594447_NameCell_BadQual"]="OfficeVSO:3594447_NameCell_BadQual"}(n=t.FeatureName||(t.FeatureName={}));var s=function(e){var t="calc.common.isFeatureEnabledCallback: called with ".concat(e," before initCalc");return i.ulsLogger.ULS.traceTag(526989323,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,t),!1},u={};function c(e){return void 0===u[e]&&(u[e]=s(e)),u[e]}t.initFeatureConfiguration=function(e){"function"==typeof e&&(s=e)},t.isFeatureEnabled=c,t.getFeatures=function(){var e={};for(var t in n){var r=n[t];null!=r&&(e[r]=c(r))}return e};t.getTypedFeatureGate=(0,o.makeGetTypedFeatureGate)({"Microsoft.Office.Excel.ProseFormulaRepairExperimentIsEnabled":!1,"Microsoft.Office.Excel.CalcTSDemoFeatureGateString":"DummyStringValue","Microsoft.Office.Excel.CalcTSDemoFeatureGateInt":42,"Microsoft.Office.Excel.CalcTSDemoFeatureGateBoolean":!1,"Microsoft.Office.Excel.CalcTSAutocompleteExperimentIsEnabled":!1,"Microsoft.Office.Excel.CalcTSUnitExperimentIsEnabled":!1,"Microsoft.Office.Excel.CalcTSExceLintExperimentIsEnabled":!1,"Microsoft.Office.Excel.SmartFormulaBarAutocompleteIsEnabled":!1,"Microsoft.Office.Excel.SmartFormulaBarUseDevScheduler":!1,"Microsoft.Office.Excel.x10DoNotThrowOnDoublePluginRegistration":!0,"Microsoft.Office.Excel.ProductSetBugFixFromPR1043532":!0,"Microsoft.Office.ExcelOnline.ArgumentAssistancePlugin":!1,"Microsoft.Office.Excel.x10AutocompletionPrecisionMeasurementsIsEnabled":!1,"Microsoft.Office.Excel.x10AutocompletionAuthoringPrecisionMeasurementsIsEnabled":!1,"Microsoft.Office.Excel.x10AutocompleteGroundTruthMeasurementsIsEnabled":!1,"Microsoft.Office.Excel.x10AutocompleteDataTypesMeasurements":!1,TESTING_ONLY_RECALC_SERVICE_IMPORTSCRIPTS_FAIL:!1,TESTING_ONLY_SCHEDULER_IMPORTSCRIPTS_FAIL:!1,TESTING_ONLY_TEST_PLUGIN_IMPORTSCRIPTS_FAIL:!1,"Microsoft.Office.Excel.FormulaAssistanceRedesign":!1,"Microsoft.Office.Excel.ParenthesesCoupling":!1,"Microsoft.Office.Excel.ColoredReferences":!1,"Microsoft.Office.Excel.FormulaCollection":!1,"Microsoft.Office.Excel.x10ParserPerformanceMeasurements":!1,"Microsoft.Office.Excel.x10AvoidUsingActiveCellPromise":!1,"Microsoft.Office.Excel.x10SetActiveCellImplNoSpread":!1,"Microsoft.Office.Excel.x10SetActiveCellImplTiming":!1,"Microsoft.Office.Excel.CalcNewIsNumeral":!1,"Microsoft.Office.Excel.x10SetActiveCellImplLogThreshold":10,"Microsoft.Office.Excel.ArgumentAssistanceOnMainThread":!1,"Microsoft.Office.Excel.AutoCompleteOnMainThread":!1,"Microsoft.Office.Excel.MockSetActiveCell":0});var l=r(41);Object.defineProperty(t,"overrideTypedFeatureGates",{enumerable:!0,get:function(){return l.overrideTypedFeatureGates}}),Object.defineProperty(t,"setFeatureGateDictionaryGetter",{enumerable:!0,get:function(){return l.setFeatureGateDictionaryGetter}}),t.isTypedChangeGateEnabled=(0,o.makeTypedIsChangeGateEnabled)(["OfficeVSO:XXX_TestChangeGate","Microsoft.Office.Excel.ChangeGate.PreciseNowForNodeJS","OfficeVSO:5818445_AttachDataTypesExperiment","Microsoft.Office.Excel.ChangeGate.ParseTrailingNameDot","Microsoft.Office.Excel.ChangeGate.ResolveSheetTable"])},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.entry=t.makeEmptyTable=void 0;var n={getCount:function(){return 0},getValue:function(){},getEntry:function(){},contains:function(){return!1},forEach:function(){return!0}};t.makeEmptyTable=function(){return n},t.entry=function(e,t){return{key:e,value:t}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getWorksheetFuncEnglishName=t.getWorksheetFuncType=t.getOperatorType=t.operatorStrings=t.OperatorId=t.higherOrderFunctionType=t.unknownFunctionType=t.WorksheetFuncId=void 0;var n=r(96),i=r(175);Object.defineProperty(t,"WorksheetFuncId",{enumerable:!0,get:function(){return i.WorksheetFuncId}});var a,o=r(140);t.unknownFunctionType=(0,n.functionType)(0,254,[],[n.SignatureType.All],[],n.SignatureType.All,n.SpecialPrecs.All,n.FunctionFlags.None),t.higherOrderFunctionType=function(){var e=n.OperKind.Number|n.OperKind.String|n.OperKind.Boolean|n.OperKind.Rich|n.OperKind.Error|n.OperKind.Blank|((0,o.isFeatureEnabled)(o.FeatureName.CalcLambdaCellValues)?0:n.OperKind.Range)|((0,o.isFeatureEnabled)(o.FeatureName.CalcLambdaArrayLifting)?0:n.OperKind.Array),t=n.OperKind.Number|n.OperKind.String|n.OperKind.Boolean|n.OperKind.Rich|n.OperKind.Error|n.OperKind.Blank|n.OperKind.Missing|n.OperKind.Array|n.OperKind.Range;return(0,n.functionType)(1,255,[e],[t],[],n.SignatureType.All,n.SpecialPrecs.None,n.FunctionFlags.Allow3dRef)},function(e){e[e.Add=1]="Add",e[e.Sub=2]="Sub",e[e.Mul=3]="Mul",e[e.Div=4]="Div",e[e.Pow=5]="Pow",e[e.Percent=6]="Percent",e[e.Neg=7]="Neg",e[e.Pos=8]="Pos",e[e.Concat=9]="Concat",e[e.Eq=10]="Eq",e[e.Ne=11]="Ne",e[e.Lt=12]="Lt",e[e.Le=13]="Le",e[e.Gt=14]="Gt",e[e.Ge=15]="Ge",e[e.Range=16]="Range",e[e.Isect=17]="Isect",e[e.Union=18]="Union",e[e.And=19]="And",e[e.Or=20]="Or",e[e.Xor=21]="Xor",e[e.Min=22]="Min",e[e.Max=23]="Max",e[e.At=24]="At",e[e.Pound=25]="Pound"}(a=t.OperatorId||(t.OperatorId={})),t.operatorStrings=[void 0,"+","-","*","/","^","%","-","+","&","=","<>","<","<=",">",">=",":",void 0,void 0,"&&","||","^^",void 0,void 0,"@","#"];var s=n.OperKind.Number|n.OperKind.String|n.OperKind.Boolean|n.OperKind.Blank,u=n.OperKind.Number|n.OperKind.String|n.OperKind.Boolean|n.OperKind.Blank,c=(0,n.functionType)(2,2,[n.OperKind.Number,n.OperKind.Number],[],[],n.OperKind.Number,n.SpecialPrecs.None,n.FunctionFlags.None),l=(0,n.functionType)(1,1,[n.OperKind.Number],[],[],n.OperKind.Number,n.SpecialPrecs.None,n.FunctionFlags.None),d=(0,n.functionType)(1,1,[s],[],[],s,n.SpecialPrecs.None,n.FunctionFlags.None),f=(0,n.functionType)(2,2,[n.OperKind.String,n.OperKind.String],[],[],n.OperKind.String,n.SpecialPrecs.None,n.FunctionFlags.None),p=(0,n.functionType)(2,2,[u,u],[],[],n.OperKind.Boolean,n.SpecialPrecs.None,n.FunctionFlags.None),m=(0,n.functionType)(2,2,[n.OperKind.Range,n.OperKind.Range],[],[],n.OperKind.Range,n.SpecialPrecs.AllCells,n.FunctionFlags.None),h=(0,n.functionType)(2,2,[n.OperKind.Range,n.OperKind.Range],[],[],n.OperKind.Range,n.SpecialPrecs.None,n.FunctionFlags.None),v=(0,n.functionType)(2,2,[n.OperKind.Boolean,n.OperKind.Boolean],[],[],n.OperKind.Boolean,n.SpecialPrecs.None,n.FunctionFlags.None),g=[];function b(e,t){var r=i.worksheetFuncTypes[e];null!=r&&(r.staticPrecs=t)}g[a.Add]=c,g[a.Sub]=c,g[a.Mul]=c,g[a.Div]=c,g[a.Pow]=c,g[a.Percent]=l,g[a.Neg]=l,g[a.At]=i.worksheetFuncTypes[i.WorksheetFuncId.SINGLE],g[a.Pound]=i.worksheetFuncTypes[i.WorksheetFuncId.ANCHORARRAY],g[a.Pos]=d,g[a.Concat]=f,g[a.Eq]=p,g[a.Ne]=p,g[a.Lt]=p,g[a.Le]=p,g[a.Gt]=p,g[a.Ge]=p,g[a.Range]=m,g[a.Isect]=h,g[a.Union]=h,g[a.And]=v,g[a.Or]=v,g[a.Xor]=v,g[a.Min]=c,g[a.Max]=c,t.getOperatorType=function(e){var r=g[e];return null!=r?r:t.unknownFunctionType},t.getWorksheetFuncType=function(e){var r=i.worksheetFuncTypes[e];return null!=r?r:t.unknownFunctionType},t.getWorksheetFuncEnglishName=function(e){return i.worksheetFuncEnglishNames[e]},b(i.WorksheetFuncId.ROW,n.SpecialPrecs.OwnRow),b(i.WorksheetFuncId.COLUMN,n.SpecialPrecs.OwnCol),b(i.WorksheetFuncId.SHEET,n.SpecialPrecs.OwnDocSheets),b(i.WorksheetFuncId.SHEETS,n.SpecialPrecs.OwnDocSheets),b(i.WorksheetFuncId.OFFSET,n.SpecialPrecs.AllCells),b(i.WorksheetFuncId.INDIRECT,n.SpecialPrecs.AllCells),b(i.WorksheetFuncId.SUMIF,n.SpecialPrecs.AllCells),b(i.WorksheetFuncId.AVERAGEIF,n.SpecialPrecs.AllCells),b(i.WorksheetFuncId.LOOKUP,n.SpecialPrecs.AllCells),b(i.WorksheetFuncId.ADDRESS,n.SpecialPrecs.RefStyle),b(i.WorksheetFuncId.FORMULATEXT,n.SpecialPrecs.RefStyle),b(i.WorksheetFuncId.NOW,n.SpecialPrecs.Time),b(i.WorksheetFuncId.TODAY,n.SpecialPrecs.Time),b(i.WorksheetFuncId.RAND,n.SpecialPrecs.Calc),b(i.WorksheetFuncId.RANDBETWEEN,n.SpecialPrecs.Calc),b(i.WorksheetFuncId.RANDARRAY,n.SpecialPrecs.Calc),b(i.WorksheetFuncId.SUBTOTAL,n.SpecialPrecs.CellProps),b(i.WorksheetFuncId.CELL,n.SpecialPrecs.CellProps|n.SpecialPrecs.AllCells),b(i.WorksheetFuncId.INFO,n.SpecialPrecs.None)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.reducePledge=t.reduceTopDown_Pledge=t.reduceBottomUp=t.reduceBottomUp_MaxDepth=t.reduceBottomUp_Pledge=t.PledgeReducer=t.reduceBottomUp_CPS=t.reduceBottomUp_Recursive=t.zipVisitor=t.ZipVisitor=t.depthVisitor=t.composeVisitor=t.ComposeVisitor=t.binaryVisitor=t.BinaryVisitor=t.DelegatingVisitor=t.voidVisitor=t.constVisitor=t.ConstVisitor=t.identityVisitor=t.IdentityVisitor=t.bindVisitor=t.visitCellRef=t.visitQualifier=t.visitAppHeadNode=t.visitWSFNode=t.visitOperatorNode=t.visitFormulaNode=void 0;var n=r(2),i=r(70),a=r(58),o=r(218),s=r(69);function u(e,t){switch(t.kind){case s.NodeKind.Literal:var r=t.oper,n=t.isClosed,a=t.label;return e.literalNode(r,n,a);case s.NodeKind.Array:var o=t.nodes;n=t.isClosed,a=t.label;return e.arrayNode(o,n,a);case s.NodeKind.App:var u=t.head,c=t.args;n=t.isClosed,a=t.label;return e.appNode(u,c,n,a);case s.NodeKind.Let:u=t.head;var l=t.vars,d=t.body,f=t.badArgs;n=t.isClosed,a=t.label;return e.letNode(u,l,d,f,n,a);case s.NodeKind.Lambda:u=t.head;var p=t.params;d=t.body,f=t.badArgs,n=t.isClosed,a=t.label;return e.lambdaNode(u,p,d,f,n,a);case s.NodeKind.Paren:var m=t.node;n=t.isClosed,a=t.label;return e.parenNode(m,n,a);case s.NodeKind.Name:var h=t.parts,v=t.qualifier;a=t.label;return e.nameNode(h,v,a);case s.NodeKind.CellRef:var g=t.ref;v=t.qualifier,a=t.label;return e.cellRefNode(g,v,a);case s.NodeKind.FieldRef:var b=t.lhs,S=t.rhs,y=t.shouldBeBracketed;a=t.label;return e.fieldRefNode(b,S,y,a);case s.NodeKind.StructRef:b=t.lhs,S=t.rhs,a=t.label;return e.structRefNode(b,S,a);case s.NodeKind.Bad:a=t.label;switch(t.type){case s.BadType.Sequence:case s.BadType.StructRef:case s.BadType.FieldRef:return e.badSequenceNode(t.type,t.contents,a);default:return e.badStringNode(t.type,t.contents,a)}default:return(0,i.assertNever)("calc.lang.visitFormulaNode",t)}}function c(e,t){var r=t.id,n=t.label;return e.operatorNode(r,n)}function l(e,t){var r=t.id,n=t.whole,i=t.label;return e.wsfNode(r,n,i)}function d(e,t){switch(t.kind){case s.NodeKind.Operator:return c(e,t);case s.NodeKind.WSF:return l(e,t);default:return u(e,t)}}function f(e){return{literalNode:e.literalNode.bind(e),arrayNode:e.arrayNode.bind(e),appNode:e.appNode.bind(e),letNode:e.letNode.bind(e),lambdaNode:e.lambdaNode.bind(e),parenNode:e.parenNode.bind(e),nameNode:e.nameNode.bind(e),cellRefNode:e.cellRefNode.bind(e),fieldRefNode:e.fieldRefNode.bind(e),structRefNode:e.structRefNode.bind(e),badSequenceNode:e.badSequenceNode.bind(e),badStringNode:e.badStringNode.bind(e),operatorNode:e.operatorNode.bind(e),wsfNode:e.wsfNode.bind(e)}}t.visitFormulaNode=u,t.visitOperatorNode=c,t.visitWSFNode=l,t.visitAppHeadNode=d,t.visitQualifier=function(e,t){switch(t.kind){case s.QualifierKind.Error:var r=t.label;return e.errorQualifier(r);case s.QualifierKind.Relative:r=t.label;return e.relativeQualifier(r);case s.QualifierKind.Document:var n=t.document,a=t.path,o=t.isQuoted;r=t.label;return e.documentQualifier(n,a,o,r);case s.QualifierKind.Sheet:var u=t.sheet,c=t.document;o=t.isQuoted,r=t.label;return e.sheetQualifier(u,c,o,r);case s.QualifierKind.Ident:var l=t.name;o=t.isQuoted,r=t.label;return e.identQualifier(l,o,r);case s.QualifierKind.SheetRange:var d=t.sheet1,f=t.sheet2,p=t.document;o=t.isQuoted,r=t.label;return e.sheetRangeQualifier(d,f,p,o,r);case s.QualifierKind.Bad:var m=t.chars;o=t.isQuoted,r=t.label;return e.badQualifier(m,o,r);default:return(0,i.assertNever)("calc.lang.visitQualifier",t)}},t.visitCellRef=function(e,t){switch(t.kind){case s.CellRefKind.Error:var r=t.label;return e.cellRefError(r);case s.CellRefKind.Single:var n=t.row,a=t.col,o=t.isBracketed;r=t.label;return e.cellRefSingle(n,a,o,r);case s.CellRefKind.Range:var u=t.ref1,c=t.ref2;r=t.label;return e.cellRefRange(u,c,r);case s.CellRefKind.Row:var l=t.row1,d=t.row2;o=t.isBracketed,r=t.label;return e.cellRefRow(l,d,o,r);case s.CellRefKind.Col:var f=t.col1,p=t.col2;o=t.isBracketed,r=t.label;return e.cellRefCol(f,p,o,r);case s.CellRefKind.Bad:var m=t.chars;o=t.isBracketed,r=t.label;return e.cellRefBad(m,o,r);default:return(0,i.assertNever)("calc.lang.visitCellRef",t)}},t.bindVisitor=f;var p=function(){function e(){}return e.prototype.literalNode=function(e,t,r){return(0,s.literalNode)(e,t,r)},e.prototype.arrayNode=function(e,t,r){return(0,s.arrayNode)(e,t,r)},e.prototype.appNode=function(e,t,r,n){return(0,s.appNode)(e,t,r,n)},e.prototype.letNode=function(e,t,r,n,i,a){return(0,s.letNode)(e,t,r,n,i,a)},e.prototype.lambdaNode=function(e,t,r,n,i,a){return(0,s.lambdaNode)(e,t,r,n,i,a)},e.prototype.parenNode=function(e,t,r){return(0,s.parenNode)(e,t,r)},e.prototype.nameNode=function(e,t,r){return(0,s.nameNode)(e,t,r)},e.prototype.cellRefNode=function(e,t,r){return(0,s.cellRefNode)(e,t,r)},e.prototype.fieldRefNode=function(e,t,r,n){return(0,s.fieldRefNode)(e,t,r,n)},e.prototype.structRefNode=function(e,t,r){return(0,s.structRefNode)(e,t,r)},e.prototype.badSequenceNode=function(e,t,r){return(0,s.badNode)(e,t,r)},e.prototype.badStringNode=function(e,t,r){return(0,s.badNode)(e,t,r)},e.prototype.operatorNode=function(e,t){return(0,s.operatorNode)(e,t)},e.prototype.wsfNode=function(e,t,r){return(0,s.wsfNode)(e,t,r)},e}();t.IdentityVisitor=p,t.identityVisitor=f(new p);var m=function(){function e(e){this.value=e}return e.prototype.literalNode=function(e,t,r){return this.value},e.prototype.arrayNode=function(e,t,r){return this.value},e.prototype.appNode=function(e,t,r,n){return this.value},e.prototype.letNode=function(e,t,r,n,i,a){return this.value},e.prototype.lambdaNode=function(e,t,r,n,i,a){return this.value},e.prototype.parenNode=function(e,t,r){return this.value},e.prototype.nameNode=function(e,t,r){return this.value},e.prototype.cellRefNode=function(e,t,r){return this.value},e.prototype.fieldRefNode=function(e,t,r,n){return this.value},e.prototype.structRefNode=function(e,t,r){return this.value},e.prototype.badSequenceNode=function(e,t,r){return this.value},e.prototype.badStringNode=function(e,t,r){return this.value},e.prototype.operatorNode=function(e,t){return this.value},e.prototype.wsfNode=function(e,t,r){return this.value},e}();function h(e){return f(new m(e))}t.ConstVisitor=m,t.constVisitor=h,t.voidVisitor=h(void 0);var v=function(){function e(e){this.visitor=e}return e.prototype.literalNode=function(e,t,r){return this.visitor.literalNode(e,t,r)},e.prototype.arrayNode=function(e,t,r){return this.visitor.arrayNode(e,t,r)},e.prototype.appNode=function(e,t,r,n){return this.visitor.appNode(e,t,r,n)},e.prototype.letNode=function(e,t,r,n,i,a){return this.visitor.letNode(e,t,r,n,i,a)},e.prototype.lambdaNode=function(e,t,r,n,i,a){return this.visitor.lambdaNode(e,t,r,n,i,a)},e.prototype.parenNode=function(e,t,r){return this.visitor.parenNode(e,t,r)},e.prototype.nameNode=function(e,t,r){return this.visitor.nameNode(e,t,r)},e.prototype.cellRefNode=function(e,t,r){return this.visitor.cellRefNode(e,t,r)},e.prototype.fieldRefNode=function(e,t,r,n){return this.visitor.fieldRefNode(e,t,r,n)},e.prototype.structRefNode=function(e,t,r){return this.visitor.structRefNode(e,t,r)},e.prototype.badSequenceNode=function(e,t,r){return this.visitor.badSequenceNode(e,t,r)},e.prototype.badStringNode=function(e,t,r){return this.visitor.badStringNode(e,t,r)},e.prototype.operatorNode=function(e,t){return this.visitor.operatorNode(e,t)},e.prototype.wsfNode=function(e,t,r){return this.visitor.wsfNode(e,t,r)},e}();t.DelegatingVisitor=v;var g=function(e){function t(t,r){var n=e.call(this,t)||this;return n.reducer=function(e,t){return r(e,t)},n}return n.__extends(t,e),t.prototype.arrayNode=function(e,t,r){var n=this;return(0,i.assertTrue)("calc.lang.binaryVisitor: non-empty array",e.length>0&&e[0].length>0),e.map((function(e){return e.reduce(n.reducer)})).reduce(this.reducer)},t.prototype.appNode=function(e,t,r,n){return t.reduce(this.reducer,e)},t.prototype.letNode=function(e,t,r,i,a,o){return n.__spreadArray(n.__spreadArray(n.__spreadArray([],t.map((function(e){return e.binder.arg})),!0),void 0===r?[]:[r.arg],!0),i.map((function(e){return e.arg})),!0).reduce(this.reducer,e)},t.prototype.lambdaNode=function(e,t,r,i,o,s){return n.__spreadArray(n.__spreadArray(n.__spreadArray([],t.map((function(e){var t;return null===(t=e.name.arg.def)||void 0===t?void 0:t.rhs})).filter(a.isDefined),!0),void 0===r?[]:[r.arg],!0),i.map((function(e){return e.arg})),!0).reduce(this.reducer,e)},t.prototype.parenNode=function(e,t,r){return e},t.prototype.fieldRefNode=function(e,t,r,n){return e},t.prototype.badSequenceNode=function(e,t,r){return(0,i.assertTrue)("calc.lang.binaryVisitor: non-empty bad-sequence",t.length>0),t.reduce(this.reducer)},t}(v);function b(e,t){return f(new g(e,t))}t.BinaryVisitor=g,t.binaryVisitor=b;var S=function(){function e(e,t){this.a=e,this.b=t}return e.prototype.literalNode=function(e,t,r){return this.b(this.a.literalNode(e,t,r))},e.prototype.arrayNode=function(e,t,r){return this.b(this.a.arrayNode(e,t,r))},e.prototype.appNode=function(e,t,r,n){return this.b(this.a.appNode(e,t,r,n))},e.prototype.letNode=function(e,t,r,n,i,a){return this.b(this.a.letNode(e,t,r,n,i,a))},e.prototype.lambdaNode=function(e,t,r,n,i,a){return this.b(this.a.lambdaNode(e,t,r,n,i,a))},e.prototype.parenNode=function(e,t,r){return this.b(this.a.parenNode(e,t,r))},e.prototype.nameNode=function(e,t,r){return this.b(this.a.nameNode(e,t,r))},e.prototype.cellRefNode=function(e,t,r){return this.b(this.a.cellRefNode(e,t,r))},e.prototype.fieldRefNode=function(e,t,r,n){return this.b(this.a.fieldRefNode(e,t,r,n))},e.prototype.structRefNode=function(e,t,r){return this.b(this.a.structRefNode(e,t,r))},e.prototype.badSequenceNode=function(e,t,r){return this.b(this.a.badSequenceNode(e,t,r))},e.prototype.badStringNode=function(e,t,r){return this.b(this.a.badStringNode(e,t,r))},e.prototype.operatorNode=function(e,t){return this.b(this.a.operatorNode(e,t))},e.prototype.wsfNode=function(e,t,r){return this.b(this.a.wsfNode(e,t,r))},e}();function y(e,t){return f(new S(e,t))}t.ComposeVisitor=S,t.composeVisitor=y,t.depthVisitor=y(b(h(0),a.fastMax),(function(e){return e+1}));var O=function(){function e(e){this.visitors=e,this.keys=Object.keys(e)}return e.prototype.literalNode=function(e,t,r){for(var n={},i=0,a=this.keys;i<a.length;i++){var o=a[i];n[o]=this.visitors[o].literalNode(e,t,r)}return n},e.prototype.arrayNode=function(e,t,r){for(var n={},i=0,a=this.keys;i<a.length;i++){var o=a[i];n[o]=this.visitors[o].arrayNode(e,t,r)}return n},e.prototype.appNode=function(e,t,r,n){for(var i={},a=0,o=this.keys;a<o.length;a++){var s=o[a];i[s]=this.visitors[s].appNode(e,t,r,n)}return i},e.prototype.letNode=function(e,t,r,n,i,a){for(var o={},s=0,u=this.keys;s<u.length;s++){var c=u[s];o[c]=this.visitors[c].letNode(e,t,r,n,i,a)}return o},e.prototype.lambdaNode=function(e,t,r,n,i,a){for(var o={},s=0,u=this.keys;s<u.length;s++){var c=u[s];o[c]=this.visitors[c].lambdaNode(e,t,r,n,i,a)}return o},e.prototype.parenNode=function(e,t,r){for(var n={},i=0,a=this.keys;i<a.length;i++){var o=a[i];n[o]=this.visitors[o].parenNode(e,t,r)}return n},e.prototype.nameNode=function(e,t,r){for(var n={},i=0,a=this.keys;i<a.length;i++){var o=a[i];n[o]=this.visitors[o].nameNode(e,t,r)}return n},e.prototype.cellRefNode=function(e,t,r){for(var n={},i=0,a=this.keys;i<a.length;i++){var o=a[i];n[o]=this.visitors[o].cellRefNode(e,t,r)}return n},e.prototype.fieldRefNode=function(e,t,r,n){for(var i={},a=0,o=this.keys;a<o.length;a++){var s=o[a];i[s]=this.visitors[s].fieldRefNode(e,t,r,n)}return i},e.prototype.structRefNode=function(e,t,r){for(var n={},i=0,a=this.keys;i<a.length;i++){var o=a[i];n[o]=this.visitors[o].structRefNode(e,t,r)}return n},e.prototype.badSequenceNode=function(e,t,r){for(var n={},i=0,a=this.keys;i<a.length;i++){var o=a[i];n[o]=this.visitors[o].badSequenceNode(e,t,r)}return n},e.prototype.badStringNode=function(e,t,r){for(var n={},i=0,a=this.keys;i<a.length;i++){var o=a[i];n[o]=this.visitors[o].badStringNode(e,t,r)}return n},e.prototype.operatorNode=function(e,t){for(var r={},n=0,i=this.keys;n<i.length;n++){var a=i[n];r[a]=this.visitors[a].operatorNode(e,t)}return r},e.prototype.wsfNode=function(e,t,r){for(var n={},i=0,a=this.keys;i<a.length;i++){var o=a[i];n[o]=this.visitors[o].wsfNode(e,t,r)}return n},e}();function C(e,t){var r=function(t){switch(t.kind){case s.NodeKind.Literal:var n=t.oper,a=t.isClosed,o=t.label;return e.literalNode(n,a,o);case s.NodeKind.Array:var u=t.nodes;a=t.isClosed,o=t.label;return e.arrayNode(u.map((function(e){return e.map(r)})),a,o);case s.NodeKind.App:var d=t.head,f=t.args;a=t.isClosed,o=t.label;return e.appNode(function(t){switch(t.kind){case s.NodeKind.Operator:return c(e,t);case s.NodeKind.WSF:return l(e,t);default:return r(t)}}(d),f.map(r),a,o);case s.NodeKind.Let:d=t.head;var p=t.vars,m=t.body,h=t.badArgs;a=t.isClosed,o=t.label;return e.letNode(l(e,d),p.map((function(e){var t=e.name,n=e.binder;return(0,s.letVar)(t,(0,s.indexedArg)(r(n.arg),n.index))})),void 0===m?void 0:(0,s.indexedArg)(r(m.arg),m.index),h.map((function(e){return(0,s.indexedArg)(r(e.arg),e.index)})),a,o);case s.NodeKind.Lambda:d=t.head;var v=t.params;m=t.body,h=t.badArgs,a=t.isClosed,o=t.label;return e.lambdaNode(l(e,d),v.map((function(e){var t=e.name;return void 0===t.arg.def?(0,s.lambdaParam)(t):(0,s.lambdaParam)((0,s.indexedArg)((0,s.paramNode)(t.arg.name,(0,s.paramDefault)(r(t.arg.def.rhs),t.arg.def.label),t.arg.label),t.index))})),void 0===m?void 0:(0,s.indexedArg)(r(m.arg),m.index),h.map((function(e){return(0,s.indexedArg)(r(e.arg),e.index)})),a,o);case s.NodeKind.Paren:var g=t.node;a=t.isClosed,o=t.label;return e.parenNode(r(g),a,o);case s.NodeKind.Name:var b=t.parts,S=t.qualifier;o=t.label;return e.nameNode(b,S,o);case s.NodeKind.CellRef:var y=t.ref;S=t.qualifier,o=t.label;return e.cellRefNode(y,S,o);case s.NodeKind.FieldRef:var O=t.lhs,C=t.rhs,P=t.shouldBeBracketed;o=t.label;return e.fieldRefNode(r(O),C,P,o);case s.NodeKind.StructRef:O=t.lhs,C=t.rhs,o=t.label;return e.structRefNode(O,C,o);case s.NodeKind.Bad:o=t.label;switch(t.type){case s.BadType.Sequence:case s.BadType.StructRef:case s.BadType.FieldRef:return e.badSequenceNode(t.type,t.contents.map(r),o);default:return e.badStringNode(t.type,t.contents,o)}default:return(0,i.assertNever)("calc.lang.reduceBottomUp_Recursive",t)}};return r(t)}function P(e,t,r,n){var i=[],a=function(e){return i.push(e),o},o=function(){return i.length<t.length?r(e,t[i.length],a):n(i)};return o}function N(e,t,r){return P(e,t,F,r)}function R(e,t,r,n){return function(){return void 0!==t?r(e,t,n):n(void 0)}}function k(e,t,r){var n=t.id,i=t.whole,a=t.label;return function(){return r(e.wsfNode(n,i,a))}}function T(e,t,r){var n=t.name,i=t.binder;return F(e,i.arg,(function(e){return r((0,s.letVar)(n,(0,s.indexedArg)(e,i.index)))}))}function E(e,t,r){var n=t.name,i=n.arg;return void 0===i.def?function(){return r((0,s.lambdaParam)(n))}:F(e,i.def.rhs,(function(e){return r((0,s.lambdaParam)((0,s.indexedArg)((0,s.paramNode)(i.name,(0,s.paramDefault)(e,i.def.label),i.label),n.index)))}))}function _(e,t,r){var n=t.arg,i=t.index;return F(e,n,(function(e){return r((0,s.indexedArg)(e,i))}))}function F(e,t,r){switch(t.kind){case s.NodeKind.Literal:var n=t.oper,a=t.isClosed,o=t.label;return function(){return r(e.literalNode(n,a,o))};case s.NodeKind.Array:var u=t.nodes,c=t.isClosed,l=t.label;return P(e,u,N,(function(t){return r(e.arrayNode(t,c,l))}));case s.NodeKind.App:var d=t.head,f=t.args,p=t.isClosed,m=t.label;return function(){return function(e,t,r){switch(t.kind){case s.NodeKind.Operator:var n=t.id,i=t.label;return function(){return r(e.operatorNode(n,i))};case s.NodeKind.WSF:return k(e,t,r);default:return F(e,t,r)}}(e,d,(function(t){return N(e,f,(function(n){return r(e.appNode(t,n,p,m))}))}))};case s.NodeKind.Let:var h=t.head,v=t.vars,g=t.body,b=t.badArgs,S=t.isClosed,y=t.label;return function(){return k(e,h,(function(t){return P(e,v,T,(function(n){return R(e,g,_,(function(i){return P(e,b,_,(function(a){return r(e.letNode(t,n,i,a,S,y))}))}))}))}))};case s.NodeKind.Lambda:var O=t.head,C=t.params,I=t.body,A=t.badArgs,M=t.isClosed,w=t.label;return function(){return k(e,O,(function(t){return function(){return P(e,C,E,(function(n){return R(e,I,_,(function(i){return P(e,A,_,(function(a){return r(e.lambdaNode(t,n,i,a,M,w))}))}))}))}}))};case s.NodeKind.Paren:var D=t.node,j=t.isClosed,x=t.label;return function(){return F(e,D,(function(t){return function(){return r(e.parenNode(t,j,x))}}))};case s.NodeKind.Name:var L=t.parts,B=t.qualifier,U=t.label;return function(){return r(e.nameNode(L,B,U))};case s.NodeKind.CellRef:var G=t.ref,K=t.qualifier,V=t.label;return function(){return r(e.cellRefNode(G,K,V))};case s.NodeKind.FieldRef:var W=t.lhs,H=t.rhs,q=t.shouldBeBracketed,z=t.label;return function(){return F(e,W,(function(t){return function(){return r(e.fieldRefNode(t,H,q,z))}}))};case s.NodeKind.StructRef:var Q=t.lhs,J=t.rhs,Y=t.label;return function(){return r(e.structRefNode(Q,J,Y))};case s.NodeKind.Bad:var $=t.label;switch(t.type){case s.BadType.Sequence:case s.BadType.StructRef:case s.BadType.FieldRef:var Z=t.type,X=t.contents;return N(e,X,(function(t){return r(e.badSequenceNode(Z,t,$))}));default:var ee=t.type,te=t.contents;return function(){return r(e.badStringNode(ee,te,$))}}default:return(0,i.assertNever)("calc.lang.reduceBottomUp_CPS",t)}}function I(e,t){var r;return function(e){for(var t=e;null!=t;)t=t()}(F(e,t,(function(e){r=e}))),r}t.ZipVisitor=O,t.zipVisitor=function(e){return f(new O(e))},t.reduceBottomUp_Recursive=C,t.reduceBottomUp_CPS=I;var A=function(){function e(e){var t=this;this.visitor=e,this.visitFormulaNode=function(e){return u(t,e)},this.lazyVisitFormulaNode=function(e){return o.Pledge.resolve(e).bind(t.visitFormulaNode)},this.visitAppHeadNode=function(e){return d(t,e)},this.lazyVisitAppHeadNode=function(e){return o.Pledge.resolve(e).bind(t.visitAppHeadNode)},this.visitWSFNode=function(e){return l(t,e)},this.lazyVisitWSFNode=function(e){return o.Pledge.resolve(e).bind(t.visitWSFNode)},this.lazyVisitVar=function(e){var r=e.name,n=e.binder;return t.lazyVisitFormulaNode(n.arg).bind((function(e){return(0,s.letVar)(r,(0,s.indexedArg)(e,n.index))}))},this.lazyVisitParam=function(e){var r=e.name,n=r.arg;return void 0===n.def?o.Pledge.resolve((0,s.lambdaParam)(r)):t.lazyVisitFormulaNode(n.def.rhs).bind((function(e){return(0,s.lambdaParam)((0,s.indexedArg)((0,s.paramNode)(n.name,(0,s.paramDefault)(e,n.def.label),n.label),r.index))}))},this.lazyVisitIndexedArg=function(e){var r=e.arg,n=e.index;return t.lazyVisitFormulaNode(r).bind((function(e){return(0,s.indexedArg)(e,n)}))}}return e.prototype.literalNode=function(e,t,r){var n=this;return o.Pledge.try((function(){return n.visitor.literalNode(e,t,r)}))},e.prototype.arrayNode=function(e,t,r){var n=this;return o.Pledge.all(e.map((function(e){return o.Pledge.all(e.map(n.lazyVisitFormulaNode))}))).bind((function(e){return n.visitor.arrayNode(e,t,r)}))},e.prototype.appNode=function(e,t,r,n){var i=this;return this.lazyVisitAppHeadNode(e).bind((function(e){return o.Pledge.all(t.map(i.lazyVisitFormulaNode)).bind((function(t){return i.visitor.appNode(e,t,r,n)}))}))},e.prototype.letNode=function(e,t,r,n,i,a){var s=this;return this.lazyVisitWSFNode(e).bind((function(e){return o.Pledge.all(t.map(s.lazyVisitVar)).bind((function(t){return(void 0===r?o.Pledge.resolve(void 0):s.lazyVisitIndexedArg(r)).bind((function(r){return o.Pledge.all(n.map(s.lazyVisitIndexedArg)).bind((function(n){return s.visitor.letNode(e,t,r,n,i,a)}))}))}))}))},e.prototype.lambdaNode=function(e,t,r,n,i,a){var s=this;return this.lazyVisitWSFNode(e).bind((function(e){return o.Pledge.all(t.map(s.lazyVisitParam)).bind((function(t){return(void 0===r?o.Pledge.resolve(void 0):s.lazyVisitIndexedArg(r)).bind((function(r){return o.Pledge.all(n.map(s.lazyVisitIndexedArg)).bind((function(n){return s.visitor.lambdaNode(e,t,r,n,i,a)}))}))}))}))},e.prototype.parenNode=function(e,t,r){var n=this;return this.lazyVisitFormulaNode(e).bind((function(e){return n.visitor.parenNode(e,t,r)}))},e.prototype.nameNode=function(e,t,r){var n=this;return o.Pledge.try((function(){return n.visitor.nameNode(e,t,r)}))},e.prototype.cellRefNode=function(e,t,r){var n=this;return o.Pledge.try((function(){return n.visitor.cellRefNode(e,t,r)}))},e.prototype.fieldRefNode=function(e,t,r,n){var i=this;return this.lazyVisitFormulaNode(e).bind((function(e){return i.visitor.fieldRefNode(e,t,r,n)}))},e.prototype.structRefNode=function(e,t,r){var n=this;return o.Pledge.try((function(){return n.visitor.structRefNode(e,t,r)}))},e.prototype.badSequenceNode=function(e,t,r){var n=this;return o.Pledge.all(t.map(this.lazyVisitFormulaNode)).bind((function(t){return n.visitor.badSequenceNode(e,t,r)}))},e.prototype.badStringNode=function(e,t,r){var n=this;return o.Pledge.try((function(){return n.visitor.badStringNode(e,t,r)}))},e.prototype.operatorNode=function(e,t){var r=this;return o.Pledge.try((function(){return r.visitor.operatorNode(e,t)}))},e.prototype.wsfNode=function(e,t,r){var n=this;return o.Pledge.try((function(){return n.visitor.wsfNode(e,t,r)}))},e}();t.PledgeReducer=A,t.reduceBottomUp_Pledge=function(e,t){return w(new A(e),t)};function M(e,t,r){return r<=50?C(e,t):I(e,t)}function w(e,t){return o.Pledge.settleOrThrow(o.Pledge.resolve(u(e,t)))}t.reduceBottomUp_MaxDepth=M,t.reduceBottomUp=function(e,t){return M(e,t.node,t.depthUpperBound)},t.reduceTopDown_Pledge=w,t.reducePledge=function(e,t){return w(e,t.node)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.values=t.stringStartsWith=t.stringEndsWith=t.repeat=t.prependErrorMessage=t.partialArray=t.messageFromError=t.mathLog2=t.isInteger=t.arrayFill=void 0;var n=r(7);t.arrayFill=n.util.arrayFill,t.isInteger=n.util.isInteger,t.mathLog2=n.util.mathLog2,t.messageFromError=n.util.messageFromError,t.partialArray=n.util.partialArray,t.prependErrorMessage=n.util.prependErrorMessage,t.repeat=n.util.repeat,t.stringEndsWith=n.util.stringEndsWith,t.stringStartsWith=n.util.stringStartsWith,t.values=n.util.values},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.now=t.mapFromArrayOfPairs=t.singleton=t.typedInstanceCreator=t.makeStringCompareCI=t.fastAbs=t.fastMax=t.fastMin=t.pair=t.filterOutNones=t.isNone=t.isDefined=t.safeConcat=t.safePush=t.strEnumArray=t.numEnumMap=t.numEnumArray=t.cloneStringMap=t.makeStringMap=t.identity=t.staticAssertIsOptional=t.staticAssertIs=t.staticAssertSame=t.staticAssertExtends=t.makeNewtypeIso=void 0;var n=r(7);t.makeNewtypeIso=n.core.makeNewtypeIso,t.staticAssertExtends=n.core.staticAssertExtends,t.staticAssertSame=n.core.staticAssertSame,t.staticAssertIs=n.core.staticAssertIs,t.staticAssertIsOptional=n.core.staticAssertIsOptional,t.identity=n.core.identity,t.makeStringMap=n.core.makeStringMap,t.cloneStringMap=n.core.cloneStringMap,t.numEnumArray=n.core.numEnumArray,t.numEnumMap=n.core.numEnumMap,t.strEnumArray=n.core.strEnumArray,t.safePush=n.core.safePush,t.safeConcat=n.core.safeConcat,t.isDefined=n.core.isDefined,t.isNone=n.core.isNone,t.filterOutNones=n.core.filterOutNones,t.pair=n.core.pair,t.fastMin=n.core.fastMin,t.fastMax=n.core.fastMax,t.fastAbs=n.core.fastAbs,t.makeStringCompareCI=n.core.makeStringCompareCI,t.typedInstanceCreator=n.core.typedInstanceCreator,t.singleton=n.core.singleton,t.mapFromArrayOfPairs=n.core.mapFromArrayOfPairs,t.now=n.core.now},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.englishXLSXKnownFormat=t.isKnownFormatDefined=t.getKnownFormat=t.buildMMDDYYFormat=t.buildSingle=t.buildCurrencyFormat=t.buildFractionFormat=t.buildScientificFormat=t.buildPercentFormat=t.buildNumberFormat=t.getColor=t.getSingle=t.getSpecial=void 0;var i=r(2),a=r(91),o=r(133),s=r(147),u=r(92),c=r(130),l=r(358);function d(e,t){var r,n=null!==(r=e.pictureSpecial[t])&&void 0!==r?r:o.englishPictureSpecial[t];return(0,u.assertTrue)("calc.numfmt.knownFormat: getSpecial",void 0!==n),n}function f(e,t){var r,n=null!==(r=e.pictureSingle[t])&&void 0!==r?r:o.englishPictureSingle[t];return(0,u.assertTrue)("calc.numfmt.knownFormat: getSingle",void 0!==n),n}function p(e,t){var r,n=null!==(r=e.pictureColor[t])&&void 0!==r?r:o.englishPictureColor[t];return(0,u.assertTrue)("calc.numfmt.knownFormat: getColor",void 0!==n),n}function m(e,t,r,n){var i="";if(r>1){var a=(0,c.repeat)(f(e,o.PictureSingle.Hash),r-1);i+=t?(0,s.insertCommas)({isThousandsPosition:function(e){return e>0&&e%3==0},thousandsSeparator:f(e,o.PictureSingle.Comma)},a,1):a}return i+="0",n>0&&(i+=f(e,o.PictureSingle.Decimal),i+=(0,c.repeat)("0",n)),i}function h(e,t){var r="";return r+="0",t>0&&(r+=f(e,o.PictureSingle.Decimal),r+=(0,c.repeat)("0",t)),e.isPercentSepBySpace&&(r+=f(e,o.PictureSingle.Space)),r+=f(e,o.PictureSingle.Percent)}function v(e,t,r,n){var i="";return i+=m(e,!1,t,r),e.isExpSepBySpace&&(i+=f(e,o.PictureSingle.Space)),i+=f(e,o.PictureSingle.E),i+="+",i+=(0,c.repeat)("0",n)}function g(e,t){var r=f(e,o.PictureSingle.Quote);return r+t+r}function b(e,t){var r="";r+=f(e,o.PictureSingle.Hash);var n=e.fractionSeparator;return n===f(e,o.PictureSingle.Comma)&&(0,l.isFeatureEnabled)(l.FeatureName["OfficeVSO:3852168_CalcNFFracFix"])?r+=g(e,n):r+=" "===n?f(e,o.PictureSingle.Space):g(e,n),r+=(0,c.repeat)(f(e,o.PictureSingle.Question),t),r+=f(e,o.PictureSingle.Slash),r+=(0,c.repeat)(f(e,o.PictureSingle.Question),t)}function S(e,t,r,n,i,s,u){void 0===u&&(u=!1);for(var l=e.isCurrencySymbolLead,h=e.currencyFormat,v=e.isCurrencySepBySpace,b=u?0:i?3:1,S=m(e,!0,4,r),O="",C=function(u){0!==u&&(O+=f(e,o.PictureSingle.Sep)),1===u&&t&&(O+=f(e,o.PictureSingle.ColorStart)+p(e,o.PictureColor.Red)+f(e,o.PictureSingle.ColorEnd));var m=function(){return 2===u?function(e,t){var r="";return r+=g(e,"-"),t>0&&(r+=(0,c.repeat)(f(e,o.PictureSingle.Question),t)),r}(e,r):3===u?f(e,o.PictureSingle.Text):S},b=function(){return 3!==u?y(e,o.PictureSingle.Star,o.PictureSingle.Space):""},C=function(){return 1===u?f(e,o.PictureSingle.OpenParen):""},P=function(){return 3!==u||l?1===u?f(e,o.PictureSingle.CloseParen):y(e,o.PictureSingle.Underscore,o.PictureSingle.CloseParen):""},N=function(){var t="";if(1!==u)switch(h){case a.CurrencyFormat.Intern:l||3===u||(t+=y(e,o.PictureSingle.Underscore,o.PictureSingle.Minus));break;case a.CurrencyFormat.Lead:case a.CurrencyFormat.Trail:if(h===a.CurrencyFormat.Lead&&!i)break;t+=y(e,o.PictureSingle.Underscore,o.PictureSingle.Minus)}else t+=f(e,o.PictureSingle.Minus);return i&&!l&&h===a.CurrencyFormat.Lead&&(t+=b()),t},R=function(){var t="";return n&&!l&&v&&(t+=f(e,o.PictureSingle.Space)),n&&(t+=null!=s?s:d(e,o.PictureSpecial.Currency)),l&&v&&(t+=f(e,o.PictureSingle.Space)),t},k=function(){var e="";return 3!==u&&(l?(n&&(e+=R()),i&&(e+=b())):e+=R()),e};if(i&&(O+=function(){var t="";if(l)switch(h){case a.CurrencyFormat.Paren:t+=y(e,o.PictureSingle.Underscore,o.PictureSingle.OpenParen);break;case a.CurrencyFormat.Trail:t+=y(e,o.PictureSingle.Underscore,o.PictureSingle.Minus);break;case a.CurrencyFormat.Intern:t+=y(e,o.PictureSingle.Underscore,o.PictureSingle.Space)}else{switch(h){case a.CurrencyFormat.Trail:t+=y(e,o.PictureSingle.Underscore,o.PictureSingle.Minus);break;case a.CurrencyFormat.Paren:case a.CurrencyFormat.Intern:t+=y(e,o.PictureSingle.Underscore,o.PictureSingle.Space)}h!==a.CurrencyFormat.Lead&&(t+=b())}return t}()),l)switch(h){case a.CurrencyFormat.Paren:i||(O+=C()),O+=k(),i&&(O+=C()),O+=m(),O+=P();break;case a.CurrencyFormat.Lead:O+=N(),O+=k(),O+=m();break;case a.CurrencyFormat.Intern:O+=k(),O+=N(),O+=m();break;case a.CurrencyFormat.Trail:O+=k(),O+=m(),O+=N()}else switch(h){case a.CurrencyFormat.Paren:O+=C(),O+=m(),i&&(O+=P()),O+=k(),i||(O+=P());break;case a.CurrencyFormat.Lead:O+=N(),O+=m(),O+=k();break;case a.CurrencyFormat.Intern:O+=m(),O+=N(),O+=k();break;case a.CurrencyFormat.Trail:O+=m(),O+=k(),O+=N()}i&&(O+=function(){if(l)switch(h){case a.CurrencyFormat.Lead:return y(e,o.PictureSingle.Underscore,o.PictureSingle.Minus);case a.CurrencyFormat.Intern:return y(e,o.PictureSingle.Underscore,o.PictureSingle.Space)}else switch(h){case a.CurrencyFormat.Lead:return y(e,o.PictureSingle.Underscore,o.PictureSingle.Minus);case a.CurrencyFormat.Paren:case a.CurrencyFormat.Intern:return y(e,o.PictureSingle.Underscore,o.PictureSingle.Space)}return""}())},P=0;P<=b;P+=1)C(P);return O}function y(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return t.map((function(t){return"string"==typeof t?t:f(e,t)})).join("")}t.getSpecial=d,t.getSingle=f,t.getColor=p,t.buildNumberFormat=m,t.buildPercentFormat=h,t.buildScientificFormat=v,t.buildFractionFormat=b,t.buildCurrencyFormat=S,t.buildSingle=y;var O=((n={})[a.DateOrder.MDY]=[1,0,2],n[a.DateOrder.DMY]=[0,1,2],n[a.DateOrder.YMD]=[2,1,0],n[a.DateOrder.MYD]=[1,2,0],n[a.DateOrder.DYM]=[0,2,1],n[a.DateOrder.YDM]=[2,0,1],n);function C(e,t){return y(e,(t?e.hour2Digits&&!e.clock24Hour:e.hour2Digits)?o.PictureSingle.Hour:"",o.PictureSingle.Hour,o.PictureSingle.Colon,o.PictureSingle.Minute,o.PictureSingle.Minute)}function P(e,t){return C(e,t)+y(e,o.PictureSingle.Colon,o.PictureSingle.Second,o.PictureSingle.Second)}function N(e){var t="";return e.isAMPMSepBySpace&&(t+=f(e,o.PictureSingle.Space)),t+=d(e,o.PictureSpecial.AP1)}function R(e,t){void 0===t&&(t=!1);for(var r=e.month2Digits,n=e.day2Digits,i=t||e.year4Digits,a=y(e,i?o.PictureSingle.Year:"",i?o.PictureSingle.Year:"",o.PictureSingle.Year,o.PictureSingle.Year),s=y(e,r?o.PictureSingle.Month:"",o.PictureSingle.Month),u=[y(e,n?o.PictureSingle.Day:"",o.PictureSingle.Day),s,a],c=O[e.dateOrder],l="",d=0;d<3;d+=1)l+=u[c[d]],d<2&&(l+=f(e,o.PictureSingle.DateSep));return l}function k(e,t,r){var n=e.day2Digits,i=e.country===o.Country.GER,a="/"===e.dateSeparator&&" "!==e.dateAltSeparator,s="";return t&&(s+=y(e,n?o.PictureSingle.Day:"",o.PictureSingle.Day),a?s+=e.dateAltSeparator:(s+=f(e,o.PictureSingle.DateSep),i&&(s+=f(e,o.PictureSingle.Space)))),s+=y(e,o.PictureSingle.Month,o.PictureSingle.Month,o.PictureSingle.Month),r&&(s+=a?e.dateAltSeparator:f(e,i?o.PictureSingle.Space:o.PictureSingle.DateSep),s+=y(e,o.PictureSingle.Year,o.PictureSingle.Year)),s}t.buildMMDDYYFormat=R,t.getKnownFormat=function(e,t){switch(t){case a.KnownFormat.General:return d(e,o.PictureSpecial.General);case a.KnownFormat.NoComFixed0:return m(e,!1,1,0);case a.KnownFormat.NoComFixed:return m(e,!1,1,2);case a.KnownFormat.Fixed0:return m(e,!0,4,0);case a.KnownFormat.Fixed:return m(e,!0,4,2);case a.KnownFormat.Currency:return S(e,!1,0,!0,!1);case a.KnownFormat.CoCurrency:return S(e,!0,0,!0,!1);case a.KnownFormat.CurrencyDec:return S(e,!1,2,!0,!1);case a.KnownFormat.CoCurrencyDec:return S(e,!0,2,!0,!1);case a.KnownFormat.Pct0:return h(e,0);case a.KnownFormat.Pct:return h(e,2);case a.KnownFormat.Exp:return v(e,1,2,2);case a.KnownFormat.Fract:return b(e,1);case a.KnownFormat.FractBond:return b(e,2);case a.KnownFormat.MMDDYY:return R(e);case a.KnownFormat.DDMMMYY:return k(e,!0,!0);case a.KnownFormat.DDMMM:return k(e,!0,!1);case a.KnownFormat.MMMYY:return k(e,!1,!0);case a.KnownFormat.HHMMAP:return C(e,!0)+N(e);case a.KnownFormat.HHMMSSAP:return P(e,!0)+N(e);case a.KnownFormat.HHMM:return C(e,!1);case a.KnownFormat.HHMMSS:return P(e,!1);case a.KnownFormat.MDYHMS:return y(e,R(e),o.PictureSingle.Space,C(e,!1));case a.KnownFormat.USCoCurrency:case a.KnownFormat.USCoCurrencyDec:return S(i.__assign(i.__assign({},e),{isCurrencySymbolLead:!0,isCurrencySepBySpace:!1,currencyFormat:a.CurrencyFormat.Paren}),!0,t===a.KnownFormat.USCoCurrencyDec?2:0,!0,!1,e.isChinaT?g(e,"US$"):"$");case a.KnownFormat.Currency2:return S(e,!1,0,!1,!1);case a.KnownFormat.CoCurrency2:return S(e,!0,0,!1,!1);case a.KnownFormat.CurrencyDec2:return S(e,!1,2,!1,!1);case a.KnownFormat.CoCurrencyDec2:return S(e,!0,2,!1,!1);case a.KnownFormat.Acct:return S(e,!1,0,!1,!0);case a.KnownFormat.AcctDec:return S(e,!1,2,!1,!0);case a.KnownFormat.AcctCur:return S(e,!1,0,!0,!0);case a.KnownFormat.AcctDecCur:return S(e,!1,2,!0,!0);case a.KnownFormat.MMSS:return y(e,o.PictureSingle.Minute,o.PictureSingle.Minute,o.PictureSingle.Colon,o.PictureSingle.Second,o.PictureSingle.Second);case a.KnownFormat.AbsHMMSS:return y(e,o.PictureSingle.ColorStart,o.PictureSingle.Hour,o.PictureSingle.ColorEnd,o.PictureSingle.Colon,o.PictureSingle.Minute,o.PictureSingle.Minute,o.PictureSingle.Colon,o.PictureSingle.Second,o.PictureSingle.Second);case a.KnownFormat.SS0:return y(e,o.PictureSingle.Minute,o.PictureSingle.Minute,o.PictureSingle.Colon,o.PictureSingle.Second,o.PictureSingle.Second,o.PictureSingle.Decimal,"0");case a.KnownFormat.Eng:return v(e,3,1,1);case a.KnownFormat.Text:return f(e,o.PictureSingle.Text)}},t.isKnownFormatDefined=function(e,t){switch(e){case a.KnownFormat.USCoCurrency:case a.KnownFormat.USCoCurrencyDec:return t.isEastAsia;default:return!0}},t.englishXLSXKnownFormat={0:a.KnownFormat.General,1:a.KnownFormat.NoComFixed0,2:a.KnownFormat.NoComFixed,3:a.KnownFormat.Fixed0,4:a.KnownFormat.Fixed,5:a.KnownFormat.Currency,6:a.KnownFormat.CoCurrency,7:a.KnownFormat.CurrencyDec,8:a.KnownFormat.CoCurrencyDec,9:a.KnownFormat.Pct0,10:a.KnownFormat.Pct,11:a.KnownFormat.Exp,12:a.KnownFormat.Fract,13:a.KnownFormat.FractBond,14:a.KnownFormat.MMDDYY,15:a.KnownFormat.DDMMMYY,16:a.KnownFormat.DDMMM,17:a.KnownFormat.MMMYY,18:a.KnownFormat.HHMMAP,19:a.KnownFormat.HHMMSSAP,20:a.KnownFormat.HHMM,21:a.KnownFormat.HHMMSS,22:a.KnownFormat.MDYHMS,37:a.KnownFormat.Currency2,38:a.KnownFormat.CoCurrency2,39:a.KnownFormat.CurrencyDec2,40:a.KnownFormat.CoCurrencyDec2,41:a.KnownFormat.Acct,42:a.KnownFormat.AcctCur,43:a.KnownFormat.AcctDec,44:a.KnownFormat.AcctDecCur,45:a.KnownFormat.MMSS,46:a.KnownFormat.AbsHMMSS,47:a.KnownFormat.SS0,48:a.KnownFormat.Eng,49:a.KnownFormat.Text}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ulsLogger=t.operatorIdToName=t.localeInfo=t.isNumeralNew=t.isNumeralOld=t.getIsNumeral=t.isIdentStart=t.isIdentContinue=t.getOrdinalNew=t.getOrdinalOld=t.getGetOrdinal=t.getNumberShapeNew=t.getNumberShapeOld=t.getGetNumberShape=t.getEnglishWorksheetFuncIdToName=t.getEnglishLocaleInfo=t.englishWorksheetFuncIdToName=t.englishSysTimeFormat=t.englishSysDateFormat=t.englishSpecialRefNames=t.englishPictureSpecial=t.englishPictureSingle=t.englishPictureDbnum=t.englishPictureColor=t.englishOperatorIdToName=t.englishErrorTypeToName=t.englishErrorNames=t.createWorksheetFuncNameCallbacks=t.calcConfig=t.TraceLevel=t.PictureSpecial=t.PictureSingle=t.PictureDbnum=t.PictureColor=t.NulLogger=t.LogCategory=t.LCID=t.Country=void 0;var n=r(3);t.Country=n.config.Country,t.LCID=n.config.LCID,t.LogCategory=n.config.LogCategory,t.NulLogger=n.config.NulLogger,t.PictureColor=n.config.PictureColor,t.PictureDbnum=n.config.PictureDbnum,t.PictureSingle=n.config.PictureSingle,t.PictureSpecial=n.config.PictureSpecial,t.TraceLevel=n.config.TraceLevel,t.calcConfig=n.config.calcConfig,t.createWorksheetFuncNameCallbacks=n.config.createWorksheetFuncNameCallbacks,t.englishErrorNames=n.config.englishErrorNames,t.englishErrorTypeToName=n.config.englishErrorTypeToName,t.englishOperatorIdToName=n.config.englishOperatorIdToName,t.englishPictureColor=n.config.englishPictureColor,t.englishPictureDbnum=n.config.englishPictureDbnum,t.englishPictureSingle=n.config.englishPictureSingle,t.englishPictureSpecial=n.config.englishPictureSpecial,t.englishSpecialRefNames=n.config.englishSpecialRefNames,t.englishSysDateFormat=n.config.englishSysDateFormat,t.englishSysTimeFormat=n.config.englishSysTimeFormat,t.englishWorksheetFuncIdToName=n.config.englishWorksheetFuncIdToName,t.getEnglishLocaleInfo=n.config.getEnglishLocaleInfo,t.getEnglishWorksheetFuncIdToName=n.config.getEnglishWorksheetFuncIdToName,t.getGetNumberShape=n.config.getGetNumberShape,t.getNumberShapeOld=n.config.getNumberShapeOld,t.getNumberShapeNew=n.config.getNumberShapeNew,t.getGetOrdinal=n.config.getGetOrdinal,t.getOrdinalOld=n.config.getOrdinalOld,t.getOrdinalNew=n.config.getOrdinalNew,t.isIdentContinue=n.config.isIdentContinue,t.isIdentStart=n.config.isIdentStart,t.getIsNumeral=n.config.getIsNumeral,t.isNumeralOld=n.config.isNumeralOld,t.isNumeralNew=n.config.isNumeralNew,t.localeInfo=n.config.localeInfo,t.operatorIdToName=n.config.operatorIdToName,t.ulsLogger=n.config.ulsLogger},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tooWide=t.stringEdit=t.renderedValueToString=t.renderedValue=t.renderInfiniteWidth=t.renderCallback=t.previousFormatFailure=t.otherEdit=t.numberEdit=t.notValueString=t.notFormatString=t.noFormatPart=t.memoizedRenderCallback=t.isSystemCultureTag=t.isHashesValue=t.isFormatCultureEqual=t.hashesValue=t.fractionOverflow=t.formulaEdit=t.formattedValue=t.formattedUnitString=t.formattedUnitGeneral=t.formattedUnitFlexible=t.formattedUnitBlank=t.evalFormatLocalsGrid=t.dateOverflow=t.createFormatGlobals=t.ReasonKind=t.NumberFormatSource=t.NamedColor=t.GetTimeKind=t.FormattedUnitKind=t.FormatValueType=t.FormatReasonKind=t.FormatCurrency=t.EditKind=t.CultureTag=t.Clip=t.BidiDate=t.Alignment=void 0;var n=r(22);t.Alignment=n.serviceTypes.Alignment,t.BidiDate=n.serviceTypes.BidiDate,t.Clip=n.serviceTypes.Clip,t.CultureTag=n.serviceTypes.CultureTag,t.EditKind=n.serviceTypes.EditKind,t.FormatCurrency=n.serviceTypes.FormatCurrency,t.FormatReasonKind=n.serviceTypes.FormatReasonKind,t.FormatValueType=n.serviceTypes.FormatValueType,t.FormattedUnitKind=n.serviceTypes.FormattedUnitKind,t.GetTimeKind=n.serviceTypes.GetTimeKind,t.NamedColor=n.serviceTypes.NamedColor,t.NumberFormatSource=n.serviceTypes.NumberFormatSource,t.ReasonKind=n.serviceTypes.ReasonKind,t.createFormatGlobals=n.serviceTypes.createFormatGlobals,t.dateOverflow=n.serviceTypes.dateOverflow,t.evalFormatLocalsGrid=n.serviceTypes.evalFormatLocalsGrid,t.formattedUnitBlank=n.serviceTypes.formattedUnitBlank,t.formattedUnitFlexible=n.serviceTypes.formattedUnitFlexible,t.formattedUnitGeneral=n.serviceTypes.formattedUnitGeneral,t.formattedUnitString=n.serviceTypes.formattedUnitString,t.formattedValue=n.serviceTypes.formattedValue,t.formulaEdit=n.serviceTypes.formulaEdit,t.fractionOverflow=n.serviceTypes.fractionOverflow,t.hashesValue=n.serviceTypes.hashesValue,t.isFormatCultureEqual=n.serviceTypes.isFormatCultureEqual,t.isHashesValue=n.serviceTypes.isHashesValue,t.isSystemCultureTag=n.serviceTypes.isSystemCultureTag,t.memoizedRenderCallback=n.serviceTypes.memoizedRenderCallback,t.noFormatPart=n.serviceTypes.noFormatPart,t.notFormatString=n.serviceTypes.notFormatString,t.notValueString=n.serviceTypes.notValueString,t.numberEdit=n.serviceTypes.numberEdit,t.otherEdit=n.serviceTypes.otherEdit,t.previousFormatFailure=n.serviceTypes.previousFormatFailure,t.renderCallback=n.serviceTypes.renderCallback,t.renderInfiniteWidth=n.serviceTypes.renderInfiniteWidth,t.renderedValue=n.serviceTypes.renderedValue,t.renderedValueToString=n.serviceTypes.renderedValueToString,t.stringEdit=n.serviceTypes.stringEdit,t.tooWide=n.serviceTypes.tooWide},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ulsLogger=t.operatorIdToName=t.localeInfo=t.isNumeralNew=t.isNumeralOld=t.getIsNumeral=t.isIdentStart=t.isIdentContinue=t.getOrdinalNew=t.getOrdinalOld=t.getGetOrdinal=t.getNumberShapeNew=t.getNumberShapeOld=t.getGetNumberShape=t.getEnglishWorksheetFuncIdToName=t.getEnglishLocaleInfo=t.englishWorksheetFuncIdToName=t.englishSysTimeFormat=t.englishSysDateFormat=t.englishSpecialRefNames=t.englishPictureSpecial=t.englishPictureSingle=t.englishPictureDbnum=t.englishPictureColor=t.englishOperatorIdToName=t.englishErrorTypeToName=t.englishErrorNames=t.createWorksheetFuncNameCallbacks=t.calcConfig=t.TraceLevel=t.PictureSpecial=t.PictureSingle=t.PictureDbnum=t.PictureColor=t.NulLogger=t.LogCategory=t.LCID=t.Country=void 0;var n=r(3);t.Country=n.config.Country,t.LCID=n.config.LCID,t.LogCategory=n.config.LogCategory,t.NulLogger=n.config.NulLogger,t.PictureColor=n.config.PictureColor,t.PictureDbnum=n.config.PictureDbnum,t.PictureSingle=n.config.PictureSingle,t.PictureSpecial=n.config.PictureSpecial,t.TraceLevel=n.config.TraceLevel,t.calcConfig=n.config.calcConfig,t.createWorksheetFuncNameCallbacks=n.config.createWorksheetFuncNameCallbacks,t.englishErrorNames=n.config.englishErrorNames,t.englishErrorTypeToName=n.config.englishErrorTypeToName,t.englishOperatorIdToName=n.config.englishOperatorIdToName,t.englishPictureColor=n.config.englishPictureColor,t.englishPictureDbnum=n.config.englishPictureDbnum,t.englishPictureSingle=n.config.englishPictureSingle,t.englishPictureSpecial=n.config.englishPictureSpecial,t.englishSpecialRefNames=n.config.englishSpecialRefNames,t.englishSysDateFormat=n.config.englishSysDateFormat,t.englishSysTimeFormat=n.config.englishSysTimeFormat,t.englishWorksheetFuncIdToName=n.config.englishWorksheetFuncIdToName,t.getEnglishLocaleInfo=n.config.getEnglishLocaleInfo,t.getEnglishWorksheetFuncIdToName=n.config.getEnglishWorksheetFuncIdToName,t.getGetNumberShape=n.config.getGetNumberShape,t.getNumberShapeOld=n.config.getNumberShapeOld,t.getNumberShapeNew=n.config.getNumberShapeNew,t.getGetOrdinal=n.config.getGetOrdinal,t.getOrdinalOld=n.config.getOrdinalOld,t.getOrdinalNew=n.config.getOrdinalNew,t.isIdentContinue=n.config.isIdentContinue,t.isIdentStart=n.config.isIdentStart,t.getIsNumeral=n.config.getIsNumeral,t.isNumeralOld=n.config.isNumeralOld,t.isNumeralNew=n.config.isNumeralNew,t.localeInfo=n.config.localeInfo,t.operatorIdToName=n.config.operatorIdToName,t.ulsLogger=n.config.ulsLogger},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.kindAnonymizers=t.anonymizeMagnitude=t.anonymizeFormulaString=t.anonymize=void 0;var n=r(7);t.anonymize=n.anonymizer.anonymize,t.anonymizeFormulaString=n.anonymizer.anonymizeFormulaString,t.anonymizeMagnitude=n.anonymizer.anonymizeMagnitude,t.kindAnonymizers=n.anonymizer.kindAnonymizers},function(e,t,r){"use strict";var n,i;Object.defineProperty(t,"__esModule",{value:!0}),t.transformBottomUp=t.isOperTerm=t.postStepTerm=t.callLambdaTerm=t.callNameTerm=t.noopTerm=t.conditionalTerm=t.readStackTerm=t.structRefTerm=t.cellRefTerm=t.udfTerm=t.nameTerm=t.appTerm=t.letTerm=t.lambdaTerm=t.arrayTerm=t.isOperatorName=t.worksheetFunctionNameToId=t.worksheetFunctionIdToName=t.operatorNameToId=t.operatorIdToName=t.TermKind=void 0;var a,o=r(2),s=r(62),u=r(43),c=r(196);function l(e,t){return{kind:e,data:void 0,children:void 0,lexicalPosition:t}}function d(e,t,r,n){var i=l(a.Array,n);return i.children=r,i.data={rows:e,cols:t},i}function f(e,t,r,n,i,o){(0,u.assertTrue)("calc.runtime.lambdaTerm",i.length===n.length+1),(0,u.assertTrue)("calc.runtime.lambdaTerm",r.length===t);var s=l(a.Lambda,o);return s.children=i,s.data={maxArity:t,minArity:e,paramLabels:r,defIdxs:n},s}function p(e,t,r,n,i){(0,u.assertTrue)("calc.runtime.letTerm",e.length===r.length);var s=l(a.Let,i);return s.children=o.__spreadArray(o.__spreadArray([],e,!0),[n],!1),s.data={rec:t,varLabels:r},s}function m(e,t,r,n,i){var o=l(a.App,i);return o.children=n,o.data={funName:e,funType:t,isFormulaRoot:r},o}function h(e,t,r,n,i){var o=l(a.Name,i);return o.data={name:e,qualifier:t,source:r},o.children=n,o}function v(e,t,r,n){var i=l(a.Udf,n);return i.data={name:e,qualifier:t},i.children=r,i}function g(e,t,r,n,i,s){var u=l(a.Conditional,s);return u.children=o.__spreadArray([n],i,!0),u.data={funName:e,funType:t,isFormulaRoot:r},u}function b(e,t){var r=l(a.Noop,t);return r.children=e,r}function S(e){return e.kind>0}!function(e){e[e.Array=-2147483648]="Array",e[e.Lambda=-2147483647]="Lambda",e[e.Let=-2147483646]="Let",e[e.App=-2147483645]="App",e[e.Name=-2147483644]="Name",e[e.Udf=-2147483643]="Udf",e[e.CellRef=-2147483642]="CellRef",e[e.ReadStack=-2147483641]="ReadStack",e[e.Conditional=-2147483640]="Conditional",e[e.StructRef=-2147483639]="StructRef",e[e.Noop=-2147483638]="Noop",e[e.CallLambda=-2147483637]="CallLambda",e[e.CallName=-2147483636]="CallName",e[e.PostStep=-2147483635]="PostStep"}(a=t.TermKind||(t.TermKind={})),t.operatorIdToName=(n=(0,s.makeNewtypeIso)(s.identity,s.identity)).wrap,t.operatorNameToId=n.unwrap,t.worksheetFunctionIdToName=(i=(0,s.makeNewtypeIso)((function(e){return-e}),(function(e){return-e}))).wrap,t.worksheetFunctionNameToId=i.unwrap,t.isOperatorName=function(e){return e>0},t.arrayTerm=d,t.lambdaTerm=f,t.letTerm=p,t.appTerm=m,t.nameTerm=h,t.udfTerm=v,t.cellRefTerm=function(e,t,r){var n=l(a.CellRef,r);return n.data={ref:e,qualifier:t},n},t.structRefTerm=function(e,t){var r=l(a.StructRef,t);return r.data=e,r},t.readStackTerm=function(e,t){var r=l(a.ReadStack,t);return r.data=e,r},t.conditionalTerm=g,t.noopTerm=b,t.callNameTerm=function(e,t,r){var n=l(a.CallName,r);return n.children=t,n.data={loc:e},n},t.callLambdaTerm=function(e,t,r,n,i){var o=l(a.CallLambda,void 0);return o.children=i,o.data={capturedLocals:e,capturedStackEnv:t,capturedStackMap:r,caller:n},o},t.postStepTerm=l(a.PostStep,void 0),t.isOperTerm=S,t.transformBottomUp=function(e,t){function r(e){if(S(e))return c.Pledge.resolve(e);switch(e.kind){case a.Let:return c.Pledge.all(e.children.map(n)).bind((function(t){return p(t.slice(0,t.length-1),e.data.rec,e.data.varLabels,t[t.length-1],e.lexicalPosition)}));case a.App:return c.Pledge.all(e.children.map(n)).bind((function(t){return m(e.data.funName,e.data.funType,e.data.isFormulaRoot,t,e.lexicalPosition)}));case a.Conditional:return c.Pledge.all(e.children.map(n)).bind((function(t){var r=t[0],n=t.slice(1);return g(e.data.funName,e.data.funType,e.data.isFormulaRoot,r,n,e.lexicalPosition)}));case a.Lambda:return c.Pledge.all(e.children.map(n)).bind((function(t){return f(e.data.minArity,e.data.maxArity,e.data.paramLabels,e.data.defIdxs,t,e.lexicalPosition)}));case a.Array:return c.Pledge.all(e.children.map((function(e){return c.Pledge.all(e.map(n))}))).bind((function(t){return d(e.data.rows,e.data.cols,t,e.lexicalPosition)}));case a.Name:return(void 0===e.children?c.Pledge.resolve(void 0):n(e.children)).bind((function(t){return h(e.data.name,e.data.qualifier,e.data.source,t,e.lexicalPosition)}));case a.Udf:return(void 0===e.children?c.Pledge.resolve(void 0):n(e.children)).bind((function(t){return v(e.data.name,e.data.qualifier,t,e.lexicalPosition)}));case a.CellRef:case a.StructRef:case a.ReadStack:return c.Pledge.resolve(e);case a.Noop:return n(e.children).bind((function(t){return b(t,e.lexicalPosition)}));default:return(0,u.assertNever)("calc.runtime.transformBottomUp",e)}}function n(e){return c.Pledge.resolve(e).bind(r).bind(t)}return c.Pledge.settleOrThrow(n(e))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isRangeValues=t.rangeValues=t.DerefOperKind=t.machine=void 0;var n,i=r(71);t.machine=i,function(e){e.RangeValues="RangeValues"}(n=t.DerefOperKind||(t.DerefOperKind={})),t.rangeValues=function(e){return{kind:n.RangeValues,arrays:e}},t.isRangeValues=function(e){return e.kind===n.RangeValues}},function(e,t,r){"use strict";r.d(t,"a",(function(){return g}));var n=r(2),i=r(4),a=r(0),o=r(8),s=r(6),u=r(53),c=r(14),l=r(13),d=r(11),f=r(10),p=r(39),m=r(44),h=r(15),v=r(31);Object(i.t)(),Object(i.t)(),Object(i.t)(),Object(i.t)();var g=function(){function e(e){this.calcGrid=e,this.snapshotPromises=[]}return e.prototype.createIGridExportEndpoint=function(e){return Object(n.__awaiter)(this,void 0,void 0,(function(){var t=this;return Object(n.__generator)(this,(function(r){switch(r.label){case 0:return[4,m.Endpoint.createInside(e,(function(){return t}))];case 1:return r.sent(),[2]}}))}))},e.prototype.discardSnapshot=function(e){return void 0!==this.snapshotPromises[e]&&(delete this.snapshotPromises[e],!0)},e.prototype.evalClonedModelOnSnapshot=function(e,t,r){return Object(n.__awaiter)(this,void 0,void 0,(function(){var o,u,c,l,d;return Object(n.__generator)(this,(function(f){switch(f.label){case 0:return[4,this.getOrCreateSnapshot(e)];case 1:return void 0===(o=f.sent())?[2,Object(a.b)(Object(s.Z)(["evalOnClonedModel"]))]:(p=t,m=o.config.mathpack,u=p.map((function(e){if(!Object(i.e)(e.data))return{data:void 0,range:Object(v.o)(e.range)};var t=Object(v.j)(m,e.data.value);return{data:{kind:e.data.kind,formulaBarText:e.data.formulaBarText,value:null!=t?t:h.j,iformat:e.data.iformat,failureReason:void 0===t?"unsupported Oper serialization":void 0},range:Object(v.o)(e.range)}})),c=function(e,t){return e.map((function(e){var r=e.range,a=r[0],o=r.slice(1),s=Object(n.__spreadArray)([Object(v.o)(a)],o.map((function(e){return Object(v.o)(e)})),!0);return{kind:e.kind,range:s,formulaBarText:e.formulaBarText,value:Object(i.e)(e.value)?Object(v.j)(t,e.value):void 0,origin:Object(i.e)(e.origin)?Object(v.f)(e.origin):void 0}}))}(r,o.config.mathpack),l=this.calcGrid.evalOnClonedModelOnSnapshot(u,c,o),this.calcGrid.resumeRecalc(),d=a.e,[4,l]);case 2:return[2,d.apply(void 0,[f.sent()])]}var p,m}))}))},e.prototype.evalFormulaOnSnapshot=function(e,t,r){return Object(n.__awaiter)(this,void 0,void 0,(function(){var i,o,u;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return[4,this.getOrCreateSnapshot(e)];case 1:return void 0===(i=n.sent())?[2,Object(a.b)(Object(s.Z)(["evalFormula"]))]:(o=this.calcGrid.evalFormulaOnSnapshot(t,r,f.f.Origin,i),this.calcGrid.resumeRecalc(),u=a.e,[4,o]);case 2:return[2,u.apply(void 0,[n.sent()])]}}))}))},e.prototype.getSheetNames=function(e){return Object(n.__awaiter)(this,void 0,void 0,(function(){var t,r,i,u,c,l,d;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return[4,this.getOrCreateSnapshot(e)];case 1:if(void 0===(t=n.sent()))return[2,Object(a.b)(Object(s.Z)(["getSheetNames"]))];if(r={document:this.calcGrid.document,sheets:new Array},i=t.getSheetRangeIndexes(Object(o.c)(this.calcGrid.document)),!Object(a.c)(i))return[2,i];for(u=0,c=i.value.sheets;u<c.length;u++){if(l=c[u],d=t.getSheetName(this.calcGrid.document,l),!Object(a.c)(d))return[2,d];r.sheets.push({sheetIndex:Object(o.u)(this.calcGrid.document,l),sheetName:d.value})}return[2,Object(a.e)(r)]}}))}))},e.prototype.getOrCreateSnapshot=function(e){return Object(n.__awaiter)(this,void 0,void 0,(function(){return Object(n.__generator)(this,(function(t){return void 0===this.snapshotPromises[e]&&(this.snapshotPromises[e]=this.calcGrid.dataModel.createSnapshot(),this.calcGrid.resumeRecalc().catch((function(e){setTimeout((function(){throw e}))}))),[2,this.snapshotPromises[e]]}))}))},e.prototype.getRangeFormats=function(e,t){return this.getRangeData(e,t,"formats")},e.prototype.getRangeValues=function(e,t){return this.getRangeData(e,t,"values")},e.prototype.getRangeFormulae=function(e,t){return this.getRangeData(e,t,"formulae")},e.prototype.getRangeData=function(e,t,r){return Object(n.__awaiter)(this,void 0,void 0,(function(){var i,d,m,h,v,g,b;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return[4,this.getOrCreateSnapshot(e)];case 1:return void 0===(i=n.sent())?[2,Object(a.b)(Object(s.Z)(["getRangeData/getOrCreateSnapshot"]))]:(d=i.allEditedAvailable(t)).kind!==a.a.Success?[2,Object(a.b)(Object(s.Z)(["getRangeData/allEditedAvailable"]))]:(m=Object(c.f)(t.range),!0!==d.value&&(m=Object(l.d)(m,d.value)),h=function(e){var r=[];return Object(c.i)(m,(function(n){var i=e(Object(o.t)(t.sheet,n),(function(e){m=Object(l.d)(m,Object(c.f)(e))}),(function(e,t){r.push([[e.row,e.col],t])}));return i.kind===a.a.Success&&i.value}))?Object(a.e)(r):Object(a.b)(Object(s.Z)(["getRangeData/extractData"]))},v={formulae:function(){return h((function(e,t,r){return i.forEachEditedFormula(e,(function(e,n){var i=n.lexicalKind,a=n.compiledFmla,c=n.fmla,l=n.origin;return i!==o.a.Range&&Object(s.z)(e)?Object(p.l)(c,void 0!==a)||r(e,{kind:void 0!==a?u.a.CellFormula:u.a.Value,formulaBarText:c,origin:Object(s.A)(l,e)?void 0:l}):t(e),!0}))}))},formats:function(){return h((function(e,t,r){return i.forEachEditedFormat(e,(function(e,n){return n===f.f.Unavailable?t(e):Object(p.k)(n)||r(e,"number"==typeof n?n:n.formatString),!0}))}))},values:function(){return h((function(e,t,r){return i.forEachEditedValue(e,(function(e,n){return void 0!==n.failure?t(e):Object(p.m)(n.oper,n.failure)||r(e,n.oper),!0}))}))}}[r](),(g=v).kind!==a.a.Success?[2,g]:(b=[],Object(c.i)(m,(function(e){return b.push(e),!0})),[2,Object(a.e)({nonEmptyCells:g.value,availableRanges:b})]))}}))}))},e.prototype.getIntersectingTables=function(e,t){var r;return Object(n.__awaiter)(this,void 0,void 0,(function(){var i,u,f,p,m,h,v,g,b,S,y,O;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return[4,this.getOrCreateSnapshot(e)];case 1:if(void 0===(i=n.sent()))return[2,Object(a.b)(Object(s.Z)(["getIntersectingTables/getOrCreateSnapshot"]))];if((u=i.allServerAvailable(t)).kind!==a.a.Success)return[2,Object(a.b)(Object(s.Z)(["getIntersectingTables/allServerAvailable"]))];if(f=i.getIntersectingTables(t),!Object(a.c)(f))return[2,Object(a.b)(Object(s.Z)(["getIntersectingTables/getIntersectingTables"]))];for(p=[],m=function(e){var t=i.getNamedObject(e,o.b.Plain);if(t.kind!==a.a.Success)return{value:t};if("NamedTable"!==(null===(r=t.value)||void 0===r?void 0:r.kind))return"continue";var n=[];t.value.columnIndexes.forEach((function(e,t){return n.push({column:e,name:t}),!0})),p.push({name:e.name,dataRange:t.value.specialRefRanges[d.i.Data].range,hasHeadersRow:t.value.hasHeadersRow,hasTotalsRow:t.value.hasTotalsRow,columns:n})},h=0,v=f.value;h<v.length;h++)if(g=v[h],"object"==typeof(b=m(g)))return[2,b.value];return S=Object(c.f)(t.range),y=!0===u.value?S:Object(l.d)(S,u.value),O=[],Object(c.i)(y,(function(e){return O.push(e),!0})),[2,Object(a.e)({tables:p,availableRanges:O})]}}))}))},e.prototype.getIformats=function(e,t,r,i){return Object(n.__awaiter)(this,void 0,void 0,(function(){var o,u;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return[4,this.getOrCreateSnapshot(e)];case 1:return void 0===(o=n.sent())?[2,Object(a.b)(Object(s.Z)(["getIformats/getOrCreateSnapshot"]))]:(u=o.getIformats(t,r,i),Object(a.c)(u)?[2,Object(a.e)({availableFormats:u.value})]:[2,Object(a.b)(Object(s.Z)(["getIformats/getIntersectingTables"]))])}}))}))},e.prototype.getHiddenRows=function(e,t,r,i){return Object(n.__awaiter)(this,void 0,void 0,(function(){var a;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return[4,this.getOrCreateSnapshot(e)];case 1:return void 0===(a=n.sent())?[2,p.j]:[2,a.getHiddenRows(t,r,i)]}}))}))},e.prototype.getHiddenCols=function(e,t,r,i){return Object(n.__awaiter)(this,void 0,void 0,(function(){var a;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return[4,this.getOrCreateSnapshot(e)];case 1:return void 0===(a=n.sent())?[2,p.j]:[2,a.getHiddenCols(t,r,i)]}}))}))},e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFeatureGateDictionaryGetter=t.overrideTypedFeatureGates=t.isTypedChangeGateEnabled=t.getTypedFeatureGate=t.getFeatures=t.isFeatureEnabled=t.initFeatureConfiguration=t.FeatureName=void 0;var n=r(7);t.FeatureName=n.featureConfiguration.FeatureName,t.initFeatureConfiguration=n.featureConfiguration.initFeatureConfiguration,t.isFeatureEnabled=n.featureConfiguration.isFeatureEnabled,t.getFeatures=n.featureConfiguration.getFeatures,t.getTypedFeatureGate=n.featureConfiguration.getTypedFeatureGate,t.isTypedChangeGateEnabled=n.featureConfiguration.isTypedChangeGateEnabled;var i=r(41);Object.defineProperty(t,"overrideTypedFeatureGates",{enumerable:!0,get:function(){return i.overrideTypedFeatureGates}}),Object.defineProperty(t,"setFeatureGateDictionaryGetter",{enumerable:!0,get:function(){return i.setFeatureGateDictionaryGetter}})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatGridRangeA1=t.quoteQualifier=t.formatQualifier=t.shouldQuoteQualifier=t.canonicaliseRangePos=t.formatRangePos=t.canonicaliseCellPos=t.formatCellPos=t.canonicaliseColRange=t.canonicaliseRowRange=t.formatColRange=t.formatRowRange=t.canonicaliseCol=t.canonicaliseRow=t.formatCol=t.formatRow=t.resolvePosition=t.canonicaliseBrackets=t.columnName=void 0;var n=r(75),i=r(69),a=r(176),o=r(70),s=r(142),u=r(112),c=r(111),l=(0,i.pos)(i.PosKind.Abs,0),d=(0,i.pos)(i.PosKind.Abs,n.sheetRows-1),f=s.codePointCapitalA,p=s.codePointFullStop;function m(e){for(var t=e+1,r="";t>0;){var n=(t-1)%26;r=String.fromCharCode(f+n)+r,t=Math.floor((t-n)/26)}return r}function h(e,t,r,n){if(t.kind===i.PosKind.Abs)return t.index;if(n)return(0,a.wrapPosition)(e,t.index,r);var o=e+t.index;return 0<=o&&o<r?o:void 0}function v(e,t,r,n,a,o){var s=h(r,n,a,o);if(void 0!==s){if(n.kind===i.PosKind.Abs)return t+(s+1).toFixed();var u=s-r;return 0===u?t:t+e.leftBracket+u.toFixed()+e.rightBracket}}function g(e,t,r,a,o){return t===i.RefStyle.A1?function(e,t,r){var a=h(e,t,n.sheetRows,r);if(void 0!==a){var o=(a+1).toFixed();return t.kind===i.PosKind.Abs?"$"+o:o}}(r,a,o):v(e,e.rowLetter,r,a,n.sheetRows,o)}function b(e,t,r,a,o){return t===i.RefStyle.A1?function(e,t,r){var a=h(e,t,n.sheetCols,r);if(void 0!==a){var o=m(a);return t.kind===i.PosKind.Abs?"$"+o:o}}(r,a,o):v(e,e.columnLetter,r,a,n.sheetCols,o)}function S(e,t,r,n){if(r.kind===i.PosKind.Abs)return r;var a=h(t,r,e,n);if(void 0!==a){var o=a-t;return o===r.index?r:(0,i.pos)(i.PosKind.Rel,o)}}function y(e,t,r,n,i){var a=h(e,t,n,i),o=h(e,r,n,i);if(void 0!==a&&void 0!==o)return a<=o?[t,r,a,o]:[r,t,o,a]}function O(e,t,r,n,a,o,s,u,c){var l=y(o,s,u,r,c);if(void 0!==l){var d=l[0],f=l[1],p=l[2],m=l[3];if(void 0!==t&&0===p&&m===r-1&&s.kind===u.kind)return t(n,a,c);var h=e(n,a,o,d,c);if(void 0!==h){if(a===i.RefStyle.R1C1&&d.kind===f.kind&&d.index===f.index)return h;var v=e(n,a,o,f,c);if(void 0!==v)return h+":"+v}}}function C(e,t,r,n,i,a){var o=y(r,n,i,t,a);if(void 0!==o){var s=o[0],u=o[1],c=o[2],l=o[3];if(void 0!==e&&0===c&&l===t-1&&n.kind===i.kind)return e;var d=S(t,r,s,a),f=S(t,r,u,a);if(void 0!==d&&void 0!==f)return[!1,d,f]}}function P(e,t,r,n,a,o){var s=g(e,t,r.row,n,o),u=b(e,t,r.col,a,o);if(void 0!==s&&void 0!==u)return t===i.RefStyle.A1?u+s:s+u}function N(e,r,i,a,o,s,u,c){var l=y(i.row,a,s,n.sheetRows,c),d=y(i.col,o,u,n.sheetCols,c);if(void 0!==l&&void 0!==d){var f=l[0],p=l[1],m=l[2],h=l[3],v=d[0],g=d[1],b=d[2],S=d[3];if(0===b&&S===n.sheetCols-1&&o.kind===u.kind)return(0,t.formatRowRange)(e,r,i.row,f,p,c);if(0===m&&h===n.sheetRows-1&&a.kind===s.kind)return(0,t.formatColRange)(e,r,i.col,v,g,c);var O=P(e,r,i,f,v,c),C=P(e,r,i,p,g,c);if(void 0!==O&&void 0!==C)return O+":"+C}}function R(e,t){return t===p||e.isIdentContinue(t)}t.columnName=m,t.canonicaliseBrackets=function(e,t){return e===i.RefStyle.R1C1&&t.kind===i.PosKind.Rel&&0!==t.index},t.resolvePosition=h,t.formatRow=g,t.formatCol=b,t.canonicaliseRow=S.bind(void 0,n.sheetRows),t.canonicaliseCol=S.bind(void 0,n.sheetCols),t.formatRowRange=O.bind(void 0,g,void 0,n.sheetRows),t.formatColRange=O.bind(void 0,b,(function(e,r,n){return(0,t.formatRowRange)(e,r,0,l,d,n)}),n.sheetCols),t.canonicaliseRowRange=C.bind(void 0,void 0,n.sheetRows),t.canonicaliseColRange=C.bind(void 0,[!0,l,d],n.sheetCols),t.formatCellPos=P,t.canonicaliseCellPos=function(e,r,n,i){var a=(0,t.canonicaliseRow)(e.row,r,i),o=(0,t.canonicaliseCol)(e.col,n,i);if(void 0!==a&&void 0!==o)return{row:a,col:o}},t.formatRangePos=N,t.canonicaliseRangePos=function(e,r,i,a,o,s){var u=y(e.row,r,a,n.sheetRows,s),c=y(e.col,i,o,n.sheetCols,s);if(void 0!==u&&void 0!==c){var l=u[0],d=u[1],f=u[2],p=u[3],m=c[0],h=c[1],v=c[2],g=c[3],b=(0,t.canonicaliseRow)(e.row,l,s),S=(0,t.canonicaliseCol)(e.col,m,s),O=(0,t.canonicaliseRow)(e.row,d,s),C=(0,t.canonicaliseCol)(e.col,h,s);if(void 0!==b&&void 0!==S&&void 0!==O&&void 0!==C)return 0===v&&g===n.sheetCols-1&&i.kind===o.kind?{row1:b,row2:O,col1:void 0,col2:void 0}:0===f&&p===n.sheetRows-1&&r.kind===a.kind?{col1:S,col2:C,row1:void 0,row2:void 0}:{row1:b,col1:S,row2:O,col2:C}}};var k=/'/g;function T(e,t){if(0===t.length)return!1;var r=0,n=(0,u.stringCodePointAt)(t,r);if(!e.isIdentStart(n))return!1;r+=(0,u.numCodeUnits)(n);for(var i=0,a=(0,u.codePointIterator)(t,r);i<a.length;i++){if(!R(e,a[i]))return!1}return!0}var E=(0,n.gridCell)(0,0);function _(e,t,r){if(0===e.stringCompareCI(r,e.trueName))return!0;if(0===e.stringCompareCI(r,e.falseName))return!0;var n=(0,a.parseCellRef)(e,t,E,r,0);if(void 0!==n)if(n.refStyle===i.RefStyle.A1){var o=n.i;if(o>=r.length&&void 0===e.getWorksheetFuncId(r.substring(0,o)))return!0}else if(!(0,a.isR1C1IdentStart)(n.row,n.col))return!0;return!T(e,r)&&(!function(e,t){var r=0;if(!(0,c.stringStartsWith)(t,e.leftBracket,r))return!1;if((r+=e.leftBracket.length)===t.length)return!1;var n=(0,u.stringCodePointAt)(t,r);if(!R(e,n))return!1;for(r+=(0,u.numCodeUnits)(n);;){if((0,c.stringStartsWith)(t,e.rightBracket,r)){r+=e.rightBracket.length;break}if(r===t.length)return!1;var i=(0,u.stringCodePointAt)(t,r);if(!R(e,i))return!1;r+=(0,u.numCodeUnits)(i)}var a=t.indexOf(":",r);return a<0?T(e,t.substring(r)):T(e,t.substring(r,a))&&T(e,t.substring(a+1))}(e,r)&&!function(e,t){var r=e.leftBracket.length,n=e.rightBracket.length;return!(t.length<r+n)&&(t.substring(0,r)===e.leftBracket&&(t.substring(t.length-n)===e.rightBracket&&T(e,t.substring(r,t.length-n))))}(e,r))}function F(e,t,r){return _(e,t,r)?I(r):r}function I(e){return"'".concat(e.replace(k,"''"),"'")}t.shouldQuoteQualifier=_,t.formatQualifier=F,t.quoteQualifier=I,t.formatGridRangeA1=function(e,t,r){var a=1===t.cols&&1===t.rows?P(e,i.RefStyle.A1,(0,n.gridCell)(0,0),(0,i.pos)(i.PosKind.Rel,t.row),(0,i.pos)(i.PosKind.Rel,t.col),!1):N(e,i.RefStyle.A1,(0,n.gridCell)(0,0),(0,i.pos)(i.PosKind.Rel,t.row),(0,i.pos)(i.PosKind.Rel,t.col),(0,i.pos)(i.PosKind.Rel,t.row+t.rows-1),(0,i.pos)(i.PosKind.Rel,t.col+t.cols-1),!1);return(0,o.assertTrue)("calc.lang.formatGridRangeA1",void 0!==a),void 0===r?a:F(e,i.RefStyle.A1,r)+"!"+a}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.codePointExclamationMark=t.codePointEuroSign=t.codePointEqualsSign=t.codePointDoubleQuote=t.codePointDollarSign=t.codePointDigitZero=t.codePointDigitTwo=t.codePointDigitThree=t.codePointDigitSix=t.codePointDigitSeven=t.codePointDigitOne=t.codePointDigitNine=t.codePointDigitFour=t.codePointDigitFive=t.codePointDigitEight=t.codePointComma=t.codePointColon=t.codePointCircumflexAccent=t.codePointCapitalZ=t.codePointCapitalY=t.codePointCapitalX=t.codePointCapitalW=t.codePointCapitalV=t.codePointCapitalU=t.codePointCapitalT=t.codePointCapitalS=t.codePointCapitalR=t.codePointCapitalQ=t.codePointCapitalP=t.codePointCapitalO=t.codePointCapitalN=t.codePointCapitalM=t.codePointCapitalL=t.codePointCapitalK=t.codePointCapitalJ=t.codePointCapitalI=t.codePointCapitalH=t.codePointCapitalG=t.codePointCapitalF=t.codePointCapitalE=t.codePointCapitalD=t.codePointCapitalC=t.codePointCapitalB=t.codePointCapitalA=t.codePointCR=t.codePointBacktick=t.codePointBackslash=t.codePointAtSign=t.codePointAsterisk=t.codePointAmpersand=void 0,t.codePointSmallW=t.codePointSmallV=t.codePointSmallU=t.codePointSmallT=t.codePointSmallS=t.codePointSmallR=t.codePointSmallQ=t.codePointSmallP=t.codePointSmallO=t.codePointSmallN=t.codePointSmallM=t.codePointSmallL=t.codePointSmallK=t.codePointSmallJ=t.codePointSmallI=t.codePointSmallH=t.codePointSmallG=t.codePointSmallF=t.codePointSmallE=t.codePointSmallD=t.codePointSmallC=t.codePointSmallB=t.codePointSmallA=t.codePointSlash=t.codePointSingleQuote=t.codePointSemicolon=t.codePointRightSquareBracket=t.codePointRightParen=t.codePointRightCurlyBracket=t.codePointQuestionMark=t.codePointPlusSign=t.codePointPipe=t.codePointPercentSign=t.codePointMinusSign=t.codePointLessThanSign=t.codePointLeftSquareBracket=t.codePointLeftParen=t.codePointLeftCurlyBracket=t.codePointLF=t.codePointInvertedQuestionMark=t.codePointInvertedExclamationMark=t.codePointHash=t.codePointGreaterThanSign=t.codePointFullwidthLatinSmallZ=t.codePointFullwidthLatinSmallA=t.codePointFullwidthLatinCapitalZ=t.codePointFullwidthLatinCapitalA=t.codePointFullwidthDigitZero=t.codePointFullwidthDigitNine=t.codePointFullStop=void 0,t.codePointUnderscore=t.codePointTilde=t.codePointThaiDigitZero=t.codePointThaiDigitNine=t.codePointTab=t.codePointSpace=t.codePointSmallZ=t.codePointSmallY=t.codePointSmallX=void 0;var n=r(7);t.codePointAmpersand=n.codePoint.codePointAmpersand,t.codePointAsterisk=n.codePoint.codePointAsterisk,t.codePointAtSign=n.codePoint.codePointAtSign,t.codePointBackslash=n.codePoint.codePointBackslash,t.codePointBacktick=n.codePoint.codePointBacktick,t.codePointCR=n.codePoint.codePointCR,t.codePointCapitalA=n.codePoint.codePointCapitalA,t.codePointCapitalB=n.codePoint.codePointCapitalB,t.codePointCapitalC=n.codePoint.codePointCapitalC,t.codePointCapitalD=n.codePoint.codePointCapitalD,t.codePointCapitalE=n.codePoint.codePointCapitalE,t.codePointCapitalF=n.codePoint.codePointCapitalF,t.codePointCapitalG=n.codePoint.codePointCapitalG,t.codePointCapitalH=n.codePoint.codePointCapitalH,t.codePointCapitalI=n.codePoint.codePointCapitalI,t.codePointCapitalJ=n.codePoint.codePointCapitalJ,t.codePointCapitalK=n.codePoint.codePointCapitalK,t.codePointCapitalL=n.codePoint.codePointCapitalL,t.codePointCapitalM=n.codePoint.codePointCapitalM,t.codePointCapitalN=n.codePoint.codePointCapitalN,t.codePointCapitalO=n.codePoint.codePointCapitalO,t.codePointCapitalP=n.codePoint.codePointCapitalP,t.codePointCapitalQ=n.codePoint.codePointCapitalQ,t.codePointCapitalR=n.codePoint.codePointCapitalR,t.codePointCapitalS=n.codePoint.codePointCapitalS,t.codePointCapitalT=n.codePoint.codePointCapitalT,t.codePointCapitalU=n.codePoint.codePointCapitalU,t.codePointCapitalV=n.codePoint.codePointCapitalV,t.codePointCapitalW=n.codePoint.codePointCapitalW,t.codePointCapitalX=n.codePoint.codePointCapitalX,t.codePointCapitalY=n.codePoint.codePointCapitalY,t.codePointCapitalZ=n.codePoint.codePointCapitalZ,t.codePointCircumflexAccent=n.codePoint.codePointCircumflexAccent,t.codePointColon=n.codePoint.codePointColon,t.codePointComma=n.codePoint.codePointComma,t.codePointDigitEight=n.codePoint.codePointDigitEight,t.codePointDigitFive=n.codePoint.codePointDigitFive,t.codePointDigitFour=n.codePoint.codePointDigitFour,t.codePointDigitNine=n.codePoint.codePointDigitNine,t.codePointDigitOne=n.codePoint.codePointDigitOne,t.codePointDigitSeven=n.codePoint.codePointDigitSeven,t.codePointDigitSix=n.codePoint.codePointDigitSix,t.codePointDigitThree=n.codePoint.codePointDigitThree,t.codePointDigitTwo=n.codePoint.codePointDigitTwo,t.codePointDigitZero=n.codePoint.codePointDigitZero,t.codePointDollarSign=n.codePoint.codePointDollarSign,t.codePointDoubleQuote=n.codePoint.codePointDoubleQuote,t.codePointEqualsSign=n.codePoint.codePointEqualsSign,t.codePointEuroSign=n.codePoint.codePointEuroSign,t.codePointExclamationMark=n.codePoint.codePointExclamationMark,t.codePointFullStop=n.codePoint.codePointFullStop,t.codePointFullwidthDigitNine=n.codePoint.codePointFullwidthDigitNine,t.codePointFullwidthDigitZero=n.codePoint.codePointFullwidthDigitZero,t.codePointFullwidthLatinCapitalA=n.codePoint.codePointFullwidthLatinCapitalA,t.codePointFullwidthLatinCapitalZ=n.codePoint.codePointFullwidthLatinCapitalZ,t.codePointFullwidthLatinSmallA=n.codePoint.codePointFullwidthLatinSmallA,t.codePointFullwidthLatinSmallZ=n.codePoint.codePointFullwidthLatinSmallZ,t.codePointGreaterThanSign=n.codePoint.codePointGreaterThanSign,t.codePointHash=n.codePoint.codePointHash,t.codePointInvertedExclamationMark=n.codePoint.codePointInvertedExclamationMark,t.codePointInvertedQuestionMark=n.codePoint.codePointInvertedQuestionMark,t.codePointLF=n.codePoint.codePointLF,t.codePointLeftCurlyBracket=n.codePoint.codePointLeftCurlyBracket,t.codePointLeftParen=n.codePoint.codePointLeftParen,t.codePointLeftSquareBracket=n.codePoint.codePointLeftSquareBracket,t.codePointLessThanSign=n.codePoint.codePointLessThanSign,t.codePointMinusSign=n.codePoint.codePointMinusSign,t.codePointPercentSign=n.codePoint.codePointPercentSign,t.codePointPipe=n.codePoint.codePointPipe,t.codePointPlusSign=n.codePoint.codePointPlusSign,t.codePointQuestionMark=n.codePoint.codePointQuestionMark,t.codePointRightCurlyBracket=n.codePoint.codePointRightCurlyBracket,t.codePointRightParen=n.codePoint.codePointRightParen,t.codePointRightSquareBracket=n.codePoint.codePointRightSquareBracket,t.codePointSemicolon=n.codePoint.codePointSemicolon,t.codePointSingleQuote=n.codePoint.codePointSingleQuote,t.codePointSlash=n.codePoint.codePointSlash,t.codePointSmallA=n.codePoint.codePointSmallA,t.codePointSmallB=n.codePoint.codePointSmallB,t.codePointSmallC=n.codePoint.codePointSmallC,t.codePointSmallD=n.codePoint.codePointSmallD,t.codePointSmallE=n.codePoint.codePointSmallE,t.codePointSmallF=n.codePoint.codePointSmallF,t.codePointSmallG=n.codePoint.codePointSmallG,t.codePointSmallH=n.codePoint.codePointSmallH,t.codePointSmallI=n.codePoint.codePointSmallI,t.codePointSmallJ=n.codePoint.codePointSmallJ,t.codePointSmallK=n.codePoint.codePointSmallK,t.codePointSmallL=n.codePoint.codePointSmallL,t.codePointSmallM=n.codePoint.codePointSmallM,t.codePointSmallN=n.codePoint.codePointSmallN,t.codePointSmallO=n.codePoint.codePointSmallO,t.codePointSmallP=n.codePoint.codePointSmallP,t.codePointSmallQ=n.codePoint.codePointSmallQ,t.codePointSmallR=n.codePoint.codePointSmallR,t.codePointSmallS=n.codePoint.codePointSmallS,t.codePointSmallT=n.codePoint.codePointSmallT,t.codePointSmallU=n.codePoint.codePointSmallU,t.codePointSmallV=n.codePoint.codePointSmallV,t.codePointSmallW=n.codePoint.codePointSmallW,t.codePointSmallX=n.codePoint.codePointSmallX,t.codePointSmallY=n.codePoint.codePointSmallY,t.codePointSmallZ=n.codePoint.codePointSmallZ,t.codePointSpace=n.codePoint.codePointSpace,t.codePointTab=n.codePoint.codePointTab,t.codePointThaiDigitNine=n.codePoint.codePointThaiDigitNine,t.codePointThaiDigitZero=n.codePoint.codePointThaiDigitZero,t.codePointTilde=n.codePoint.codePointTilde,t.codePointUnderscore=n.codePoint.codePointUnderscore},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolvedDottedName=t.resolvedNever=t.resolvedStructRef=t.resolvedLocalName=t.resolvedUserDefinedFunc=t.resolvedCellRef=t.resolvedName=t.ResolvedKind=t.emptyIntersection=t.invalidStructRef=t.InvalidStructRefReason=t.invalidCellRef=t.InvalidCellRefReason=t.invalidQualifier=t.InvalidQualifierReason=t.noOriginSheet=t.ResolveReasonKind=t.resolveLocalsGrid=void 0;var n,i,a=r(110),o=r(58);t.resolveLocalsGrid=function(e){return{originGridCell:(0,a.success)(e.range),originSheet:(0,a.success)(e.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!1}},function(e){e.NoOriginSheet="NoOriginSheet",e.InvalidQualifier="InvalidQualifier",e.InvalidCellRef="InvalidCellRef",e.InvalidStructRef="InvalidStructRef",e.EmptyIntersection="EmptyIntersection"}(n=t.ResolveReasonKind||(t.ResolveReasonKind={})),t.noOriginSheet=function(e){return{kind:n.NoOriginSheet,origin:e}},function(e){e.UndefinedDocument="UndefinedDocument",e.UndefinedSheetName="UndefinedSheetName",e.SheetRangeName="SheetRangeName",e.DocumentCellRef="DocumentCellRef",e.BadQualifier="BadQualifier"}(t.InvalidQualifierReason||(t.InvalidQualifierReason={})),t.invalidQualifier=function(e){return{kind:n.InvalidQualifier,reason:e}},function(e){e.BadCellRef="BadCellRef"}(t.InvalidCellRefReason||(t.InvalidCellRefReason={})),t.invalidCellRef=function(e){return{kind:n.InvalidCellRef,reason:e}},function(e){e.UndefinedColumnName="UndefinedColumnName",e.UndefinedTableName="UndefinedTableName",e.InvalidOriginSheet="InvalidOriginSheet",e.InvalidOp="InvalidOp",e.MissingTableName="MissingTableName",e.NamedObjectNotTable="NamedObjectNotTable"}(t.InvalidStructRefReason||(t.InvalidStructRefReason={})),t.invalidStructRef=function(e){return{kind:n.InvalidStructRef,reason:e}},t.emptyIntersection={kind:n.EmptyIntersection},function(e){e.ResolvedName="ResolvedName",e.ResolvedCellRef="ResolvedCellRef",e.ResolvedUserDefinedFunc="ResolvedUserDefinedFunc",e.ResolvedLocalName="ResolvedLocalName",e.ResolvedStructRef="ResolvedStructRef",e.ResolvedNever="ResolvedNever",e.ResolvedDottedName="ResolvedDottedName"}(i=t.ResolvedKind||(t.ResolvedKind={})),t.resolvedName=(0,o.typedInstanceCreator)()((function(e,t,r){return{kind:i.ResolvedName,node:e,resolution:t,precedents:r}})),t.resolvedCellRef=(0,o.typedInstanceCreator)()((function(e,t){return{kind:i.ResolvedCellRef,node:e,resolution:t}})),t.resolvedUserDefinedFunc=(0,o.typedInstanceCreator)()((function(e,t,r,n){return{kind:i.ResolvedUserDefinedFunc,node:e,resolution:t,precedents:r,name:n}})),t.resolvedLocalName=(0,o.typedInstanceCreator)()((function(e,t){return{kind:i.ResolvedLocalName,node:e,resolution:t}})),t.resolvedStructRef=(0,o.typedInstanceCreator)()((function(e,t,r,n){return{kind:i.ResolvedStructRef,node:e,table:t,resolution:r,precedents:n}})),t.resolvedNever=(0,o.typedInstanceCreator)()((function(e){return{kind:i.ResolvedNever,node:e,resolution:a.successUndefined}})),t.resolvedDottedName=(0,o.typedInstanceCreator)()((function(e,t,r){return{kind:i.ResolvedDottedName,resolved:e,fields:t,precedents:r}}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.stackSave=t.stackRestore=t.stackAlloc=t.setThrew=t.memory=t._start=t.__growWasmMemory=t.__errno_location=t.Mathpack_Zero=t.Mathpack_ViewRound=t.Mathpack_Trunc=t.Mathpack_TenTo=t.Mathpack_Tan=t.Mathpack_TakeMathError=t.Mathpack_Sub=t.Mathpack_Sqrt=t.Mathpack_Sin=t.Mathpack_SFloat=t.Mathpack_SFix=t.Mathpack_RoundUp=t.Mathpack_RoundDown=t.Mathpack_Round=t.Mathpack_Power=t.Mathpack_Pi=t.Mathpack_Pack=t.Mathpack_One=t.Mathpack_Neg=t.Mathpack_Mul=t.Mathpack_Log=t.Mathpack_Ln=t.Mathpack_LFix=t.Mathpack_GetExp32=t.Mathpack_FormatScientific=t.Mathpack_FormatGetSign=t.Mathpack_FormatGetExponent=t.Mathpack_FormatGeneral=t.Mathpack_FormatFixed=t.Mathpack_Floor=t.Mathpack_Float=t.Mathpack_Fix=t.Mathpack_Exp=t.Mathpack_Equal=t.Mathpack_Div=t.Mathpack_Cos=t.Mathpack_Cond2=t.Mathpack_Cond=t.Mathpack_Compare=t.Mathpack_Ceil=t.Mathpack_Atan2=t.Mathpack_Atan=t.Mathpack_Asin=t.Mathpack_Add=t.Mathpack_Acos=t.Mathpack_Abs=t.Dtr_Yr=t.Dtr_Write=t.Dtr_Wdy=t.Dtr_UtcToLocal=t.Dtr_ToTime=t.Dtr_ToNumWithDuration=t.Dtr_ToNum=t.Dtr_ToDays=t.Dtr_Sec=t.Dtr_Rounding=t.Dtr_Mon=t.Dtr_Min=t.Dtr_Hour=t.Dtr_FromNum=t.Dtr_FracSec=t.Dtr_DaysPerMonth=t.Dtr_Days=t.Dtr_DOM=t.Base_StrBufSize=t.Base_StrBuf=void 0;var n=r(339),i=r(340),a=r(341),o=new ArrayBuffer(8),s=new Int32Array(o),u=(new Float32Array(o),new Float64Array(o));function c(e){return s[e]}function l(e,t){s[e]=t}function d(){return u[0]}function f(e){u[0]=e}var p,m=new ArrayBuffer(65536),h=(p=new Uint8Array(m),function(e,t){var r,n;if("undefined"==typeof Buffer)for(r=atob(t),n=0;n<r.length;n++)p[e+n]=r.charCodeAt(n);else for(r=Buffer.from(t,"base64"),n=0;n<r.length;n++)p[e+n]=r[n]});h(1024,"GAwAAAEAAAACAAAAAwAAAAAAAAAE"),h(1056,"6AsAAPALAAD4CwAAAAwAAB8dHx4fHh8fHh8eHx8cHx4fHh8fHh8eHx8cHx4fHh8fHh8eHx8cHx4fHh8fHh8eHx8cHx4fHh8fHh8eHx8dHx4fHh8fHh8eHw=="),h(1152,"sAsAAMgLAADACwAA0As="),h(1199,"AQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQECAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsAAAAAHwA8AFsAeQCYALYA1QD0ABIBMQFPAW4B"),h(1599,"AQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwAAAAAAHwA7AFoAeACXALUA1ADzABEBMAFOAW0B"),h(1975,"oAQ="),h(1991,"yAc="),h(2007,"+go="),h(2022,"QJwO"),h(2038,"UMMR"),h(2054,"JPQU"),h(2069,"gJaYGA=="),h(2085,"ILy+Gw=="),h(2101,"KGvuHg=="),h(2117,"+QKVIg=="),h(2132,"QLdDuiU="),h(2148,"EKXU6Cg="),h(2164,"KueEkSw="),h(2179,"gPQg5rUv"),h(2195,"oDGpX+My"),h(2211,"BL/JG442AAAAAAAAAJ61cCuorcWdawAAAAAAAADXlUMOBY0pr6AAAAAAAAAA1abP/0kfeMLVAAAAAAAAAPz32oePeufXCgEAAAAAAACjFJvFFquz7z8BAAAAAAAAnjIjmcCtD4V1AQAAAAAAAOCM6YDJR7qTqgEAAAAAAADnptOoxbkCpN8BAAAAAAAAqhfmfyuhFrYUAgAAAAAAAJO/m4WRoijKSQIAAAAAAABrVSc5jfdw4H4CAAAAAAAARmGCNzUMLvmzAgAAAAAAADDJPOP/llKK6QIAAAAAAABmF7/W86aRmR4DAAAAAAAAjt75nfvrfqpTAwAAAAAAAM3MzMzMzMzM/f///wAAAAAK16NwPQrXo/r///8AAAAAO99PjZduEoP3////AAAAACxlGeJYF7fR8////wAAAAAjhEcbR6zFp/D///8AAAAAtmlsrwW9N4bt////AAAAALxCeuXVlL/W6f///wAAAAD9zmGEEXfMq+b///8AAAAAl6W0NkFfcInj////AAAAAL/V7b3O/ubb3////wAAAAD/qiTLC//rr9z///8AAAAAzIhQbwnMvIzZ////AAAAABMOtEtCEy7h1f///wAAAAAP2FwJNdwktNL///8AAAAA2aywOvd8HZDP////AAAAAFvhTcS+lJXmy////wAAAAC6lDlFrR6xz5b///8AAAAAWcF+sVN8Erth////AAAAAKXpOaUn6n+oLP///wAAAACmGQlrumDFl/f+//8AAAAAm1N1/fcCtIjC/v//AAAAAH3TZfC8NUP2jP7//wAAAACh5LxkfEbQ3Vf+//8AAAAAyYJTfG66ysci/v//AAAAAJOgc9uT4PSz7f3//wAAAAAwAMs42ycXorj9//8AAAAABswjVHeD/5GD/f//AAAAAGC8pD2p3oCDTv3//wAAAAC+TjFK7Dzl7Bj9//8AAAAA1+Eyz81fYNXj/P//AAAAADoZemMlQzHArvz//wAAAAAYLURU+yEJQAAAAAAAAOA/AAAAAAAAAEAYLURU+yH5PwAAAAAAAPA/"),h(3014,"WUAAAAAAAAAkQAAAAAAAQI9AAAAAAAAAOEAAAAAAAABOQClRzqDIRdg+IXQL5wZroz41IN+kpBFvPvZNfx3q2jg+AADA////30EAAAAAAADgwQQEAAAQBA=="),h(3728,"ME8=");var v=function(e,t,r){var n=new e.Int8Array(r),i=new e.Int16Array(r),a=new e.Int32Array(r),o=new e.Uint8Array(r),u=new e.Uint16Array(r),p=new e.Uint32Array(r),m=(new e.Float32Array(r),new e.Float64Array(r)),h=e.Math.imul,v=(e.Math.fround,e.Math.abs),g=e.Math.clz32,b=e.Math.min,S=(e.Math.max,e.Math.floor),y=e.Math.ceil,O=e.Math.sqrt,C=t.abort,P=(e.NaN,e.Infinity,t.Base_LocaleIsNumeral),N=t.Base_LocaleGetOrdinal,R=t.Base_LocaleDecimalSeparator,k=t.Math_log10,T=t.Math_log,E=(O=t.Math_sqrt,t.Math_sin),_=t.Math_cos,F=t.Math_tan,I=t.Math_atan,A=t.Math_exp,M=t.proc_exit,w=20112,D=0;function j(){}function x(e,t,r){e:if(e>>>0<=t>>>0){if(!r)break e;for(;n[0|e]=o[0|t],e=e+1|0,t=t+1|0,r=r+-1|0;);}else if(r)for(e=e+r|0,t=t+r|0;t=t+-1|0,n[0|(e=e+-1|0)]=o[0|t],r=r+-1|0;);}function L(e,t){var r,s,l=0,d=0,p=0,h=0;if(d=3680,w=r=w-48|0,a[r+40>>2]=0,i[r+30>>1]=0,i[r+32>>1]=0,m[460]=e,s=q(e),m[460]=s,Se(s,r+40|0,r,15),u[r+42>>1]){l=(0|(l=de(t)<<16))<0?100:l>>16,f(+t),p=0|c(1),c(0),(h=-65536&p)&&(2146435072!=(2146435072&p)?l=(0|h)<1?0-l|0:l:a[922]=1);e:{if(!((0|(l=i[r+40>>1]+l|0))>=i[r+42>>1])){if((0|l)<1){d=3e3;break e}(255&l)>>>0>=o[r+30|0]||(n[r+30|0]=l)}be(3100,3680,r)}e=m[d>>3]}return w=r+48|0,e}function B(e,t){var r,n=0,i=0,o=0;if(m[460]=e,f(+e),i=0|c(1),c(0),o=i,i=0,(n=-65536&o)&&(2146435072!=(2146435072&o)?i=(0|n)<1:(a[922]=1,i=0)),a[921]=2147483647&o,te(m[374]),n=-65536&(o=a[921]))if(2146435072!=(2146435072&o)){if(!((0|n)<1))return z(8),0}else a[922]=1;r=re(m[374],e),m[460]=re(m[372],r),ne(r),me();e:{t:{if((n=a[921])>>>0>=65536){if(2146435072!=(2146435072&n))break t;a[922]=1}if(t){if(a[920]=0,a[921]=0,!i)break e;return t=a[741],a[920]=a[740],a[921]=t,m[460]}if(n=a[747],a[920]=a[746],a[921]=n,t=n,1^i|n>>>0<65536)break e;return a[921]=-2147483648^t,m[460]}Ce(e),he(),t&&(m[460]=re(m[373],m[460]))}return m[460]}function U(e,t,r,n){var s,c=0,l=0,d=0,f=0,p=0,m=0,v=0;if(c=a[e+4>>2],p=-2146827284,!((0|(s=(l=u[e>>1])+(e=(0|(d=i[e+2>>1]))>=1?(d+-1|0)/12|0:(0|d)/-12^-1)<<16>>16))>9999|((r?1900:-9999)+(t?4:0)|0)>(0|s)||((d=d+h(e,-12)<<16>>16)+-1&65535)>>>0>11|(!c|1900==(0|s)&2==(0|d)&29==(0|c)?!r:0))){if(m=(0|(e=(f=(0|(l=s+1e4|0))/4|0)<<2))%100|0,v=(0|e)%400|0,c=(((f=h(f,1461)+c|0)+((0|(c=e+-1|0))/-100|0)|0)+((0|c)/400|0)|0)-1|0,l=(h(l-e|0,12)+d|0)-1|0)for(l=l+(e=v?m?0:12:0)|0;c=o[e+1072|0]+c|0,(0|l)!=(0|(e=e+1|0)););e:if(r||t){if(e=c+-4346385|0,!((0|s)>1900|(0|d)>=3))break e;e=c+-4346384|0}else e=c+-4346384|0;e>>>0>2958465||(a[n>>2]=e,p=0)}return p}function G(e,t,r){var n,s,u,c=0,l=0,d=0;l=d=Te(e,t,711573504,201),a[r+28>>2]=(l+1>>>0)%7,c=l+h(n=(l>>>0)/146097|0,-146097)|0,s=(h(c,100)+75>>>0)/3652425|0,c=((u=h(s,-36524)+c|0)>>>0)/1461|0,l=(((l+(((c=((h(s,100)+h(n,400)|0)+(c<<2)|0)+((h(u+h(c,-1461)|0,100)+75>>>0)/36525|0)|0)>>>0)/100|0)|0)-(c>>>2)|0)-((c>>>0)/400|0)|0)+h(c,-365)|0,d=ke(d,D,-864e5,-1),e=Te(e,t,1e4,0)+d|0,d=!(((t=c+1|0)>>>0)%100)|3&t&&(t>>>0)%400|0?1936+((t=o[l+1568|0])<<1)|0:1536+((t=o[l+1168|0])<<1)|0,a[r+12>>2]=(e>>>0)/36e5,a[r+4>>2]=t+1,a[r>>2]=c+1601,t=(e>>>0)/1e3|0,a[r+20>>2]=(t>>>0)%60,a[r+16>>2]=((e>>>0)/6e4>>>0)%60,a[r+24>>2]=e-h(t,1e3),a[r+8>>2]=1+(l-i[d>>1]|0)}function K(e,t){var r=0,n=0,o=0,s=0,u=0,c=0,l=0,d=0,f=0,p=0,m=0,v=0;return(0|(s=a[e+4>>2]))<1||(d=s+-1|0)>>>0>11||(n=(r=a[e>>2])+-1601|0)>>>0>29226||(0|(u=a[e+8>>2]))<1||(o=1536,((c=65535&r)>>>0)%400&&(o=3&r?1936:(c>>>0)%100|0?1536:1936),(f=a[e+24>>2])>>>0>999||(c=a[e+20>>2])>>>0>59||(p=a[e+16>>2])>>>0>59||(m=a[e+12>>2])>>>0>23||(u=u+-1|0)>>>0>=i[o+(s<<1)>>1]-i[o+(d<<1)>>1]>>>0||(o=n>>>2,s=h(n,365),n=((e=65535&n)>>>0)/400|0,v=(e>>>0)/100|0,((l=65535&(r=r+-1600|0))>>>0)%400&&(e=1936,!((l>>>0)%100)|3&r)||(e=1536),l=1,r=(r=h(h(h(m,60)+p|0,60)+c|0,1e3)+f|0)+(n=ke(e=i[(d<<1)+e>>1]+(n+((u+(s+o|0)|0)-v|0)|0)|0,e>>31,864e5,0))|0,e=D,a[t>>2]=ke(r,r>>>0<n>>>0?e+1|0:e,1e4,0),a[t+4>>2]=D)),l}function V(e,t,r,n){var i,o=0,s=0,u=0,c=0;w=i=w-112|0,G(r,n,i+80|0);e:{if(a[e>>2]){if(!K(e,t))break e}else{if((0|(s=a[e+8>>2]))>5|!s)break e;if(r=a[e+4>>2],n=a[e+28>>2],o=a[i+80>>2],a[i+56>>2]=1,a[i+52>>2]=r,a[i+48>>2]=o,a[i+60>>2]=a[e+12>>2],a[i+64>>2]=a[e+16>>2],a[i+68>>2]=a[e+20>>2],e=a[e+24>>2],a[i+76>>2]=0,a[i+72>>2]=e,!K(i+48|0,i+8|0)){o=0;break e}e=n+8|0,r=n+1|0,u=(0|s)<2,G(a[i+8>>2],a[i+12>>2],i+16|0),c=i;t:{if((0|n)<(0|(o=a[i+44>>2])))e=e-o|0;else{if(e=1,(0|n)<=(0|o))break t;e=r-o|0}a[c+56>>2]=e}t:if(!u&&(r=e+7|0,a[i+56>>2]=r,o=1,K(i+48|0,i+8|0)))for(;;){if(G(a[i+8>>2],a[i+12>>2],i+16|0),e=a[i+24>>2],(0|s)==(0|(o=o+1|0)))break t;if(r=r+7|0,a[i+56>>2]=r,!K(i+48|0,i+8|0))break}if(a[i+56>>2]=e,!K(i+48|0,i+8|0)){o=0;break e}e=a[i+12>>2],a[t>>2]=a[i+8>>2],a[t+4>>2]=e}o=1}return w=i+112|0,o}function W(e,t,r){var n,o=0,s=0,c=0,l=0,d=0;if(w=n=w-16|0,r&&(c=r>>31,c^=c+r))for(r=(0|r)>0?1952:2448;(o=15&c)&&(s=i[(o=(o<<4)+r|0)+8>>1],d=H(m[e>>3],m[o>>3],n),t=t+s|0,i[n+14>>1]<=0?(o=u[n+6>>1],s=u[n+8>>1]):(s=a[n+4>>2],o=u[n+6>>1]<<1,i[n+6>>1]=o,l=a[n+8>>2],a[n+12>>2]=a[n+12>>2]<<1|l>>>31,s=l<<1|s>>>31,a[n+8>>2]=s,t=t+-1|0),(65535&o|1&s|0!=(0|d))>>>0<32769||(s=(o=a[n+8>>2])+1|0,a[n+8>>2]=s,s>>>0>=o>>>0||(s=(o=a[n+12>>2])+1|0,a[n+12>>2]=s,s>>>0>=o>>>0||(a[n+12>>2]=-2147483648,t=t+1|0))),o=a[n+12>>2],a[e>>2]=a[n+8>>2],a[e+4>>2]=o),r=r+240|0,c>>=4;);return w=n+16|0,t}function H(e,t,r){var n,a,o,s=0,u=0,l=0,d=0,p=0,m=0,v=0,g=0,b=0,S=0,y=0,O=0;return f(+t),d=0|c(1),p=65535&(u=0|c(0)),f(+e),S=0|c(1),s=0|c(0),l=S,a=h(g=65535&s,p),i[r>>1]=a,o=((65535&(y=h(b=s>>>16,p)))+(a>>>16)|0)+(65535&(v=h(u>>>=16,g)))|0,i[r+2>>1]=o,y=(((m=((65535&(s=h(n=65535&l,p)))+(y>>>16)|0)+(v>>>16)|0)+(65535&(v=h(u,b)))|0)+(65535&(O=h(S=65535&d,g)))|0)+(o>>>16)|0,i[r+4>>1]=y,v=(((((((65535&(m=h(d>>>=16,g)))+(s>>>16)|0)+(65535&(l=h(s=l>>>16,p)))|0)+(v>>>16)|0)+(O>>>16)|0)+(65535&(p=h(S,b)))|0)+(65535&(g=h(u,n)))|0)+(y>>>16)|0,i[r+6>>1]=v,b=((((((O=(l>>>16)+(m>>>16)|0)+(65535&(l=h(d,b)))|0)+(p>>>16)|0)+(g>>>16)|0)+(65535&(m=h(s,u)))|0)+(65535&(u=h(S,n)))|0)+(v>>>16)|0,i[r+8>>1]=b,m=((u=(((65535&(p=h(d,n)))+(l>>>16)|0)+(m>>>16)|0)+(u>>>16)|0)+(65535&(l=h(s,S)))|0)+(b>>>16)|0,i[r+10>>1]=m,s=(((65535&(d=h(s,d)))+(p>>>16)|0)+(l>>>16)|0)+(m>>>16)|0,i[r+12>>1]=s,i[r+14>>1]=(s>>>16)+(d>>>16),65535&(a|o|y)}function q(e){var t,r,n=0,i=0,o=0,s=0,u=0,l=0;return w=t=w-16|0,m[t+8>>3]=e,f(+e),n=0|c(1),i=0|c(0),r=n,(n&=2146435072)&&(a[t+8>>2]=i<<11,a[t+12>>2]=r<<11|i>>>21|-2147483648,s=(n=h(i=(n>>>20)-1022|0,39457)>>17)+-14|0,o=W(t+8|0,i,14-n|0),i=a[t+8>>2],(0|o)>=(0|(p[t+12>>2]<(i>>>0<2147477094?-1243209483:-1243209484)>>>0?48:47))||(o=W(t+8|0,o,1),i=a[t+8>>2],s=n+-15|0),n=s,s=(s=i)+(i=-2147483648>>>(31&o))|0,a[t+8>>2]=s,s>>>0>=i>>>0||(l=(u=a[t+12>>2])+1|0,a[t+12>>2]=l,l>>>0>=u>>>0||(a[t+12>>2]=-2147483648,o=o+1|0)),a[t+8>>2]=s&0-(i<<1),o=W(t+8|0,o,n),3071&(n=a[t+8>>2])?(i=n+1024|0,a[t+8>>2]=i,n>>>0<4294966272||(s=(n=a[t+12>>2])+1|0,a[t+12>>2]=s,o=(s>>>0<n>>>0)+o|0)):i=n,(0|o)<=-1023?(a[t+8>>2]=0,a[t+12>>2]=0):(0|(n=1071644672+(o<<20)|0))<=-1||(o=a[t+12>>2],a[t+8>>2]=o<<21|i>>>11,a[t+12>>2]=o>>>11&1048575|n|-2147483648&r),e=m[t+8>>3]),w=t+16|0,e}function z(e){var t;return t=a[922],a[922]=e,t}function Q(){var e,t,r;return e=a[920],t=a[921],X(1048576),X(2146435072),i[1843]<0?(a[920]=e,a[921]=t,-2147483648):(r=le(),a[920]=e,a[921]=t,-2147483648^r)}function J(e){var t,r=0,n=0,i=0,a=0;if(f(+e),r=0|c(1),t=0|c(0),a=r,i=0,!((r=2047&(n=r>>>20))>>>0<1023||(i=e,r>>>0>1075))){if(n=-1<<(19-n&31),r>>>0>=1044)return l(0,n&t),l(1,0|a),+d();a&=n,l(0,0),l(1,0|a),i=+d()}return i}function Y(e){var t=0,r=0,n=0;if(e+307>>>0<=615)return a[920]=0,a[921]=-2147483648,n=W(3680,1,e),r=a[920],e=a[921],3071&r&&(t=a[921],(e=a[920]+1024|0)>>>0<1024&&(t=t+1|0),a[920]=e,a[921]=t,r=e,e=t),a[920]=e<<21|r>>>11,void(a[921]=1071644672+(e>>>11&1048575|n<<20));(0|e)>=309&&(a[922]=1),a[920]=0,a[921]=0}function $(e,t,r,n){var o=0,s=0,c=0;e:{t:{r:{n:{if(!n){if(u[e>>1]<=52)break n;break t}if(!((0|n)<1)&&(0|n)<15)break r}return a[t>>2]=1,void(a[r>>2]=0)}if(u[(n<<1)+e>>1]<=52)break e;for(;;){if(c=u[(s=((o=n+-1|0)<<1)+e|0)>>1]+1|0,i[s>>1]=c,58!=(65535&c))break e;if(!(n=o))break}}return i[e>>1]=49,a[t>>2]=a[t>>2]+1,void(a[r>>2]=1)}for(;t=n,(0|n)>=2&&48==u[((n=t+-1|0)<<1)+e>>1];);a[r>>2]=t}function Z(){var e=0,t=0,r=0;e:{if(r=a[920],t=-65536&(e=a[921])){if(2146435072==(2146435072&e))return a[922]=1,void ve();if((0|t)<1)break e}return void ve()}ve(),(0|r)==a[920]&&a[921]==(0|e)||te(1)}function X(e){m[460]=ee(m[460],e)}function ee(e,t){var r;return f(+(e+=t)),r=0|c(1),c(0),2146435072==(2146435072&r)&&(a[922]=1,e=m[375]),e}function te(e){m[460]=re(m[460],e)}function re(e,t){var r;return f(+(e-=t)),r=0|c(1),c(0),2146435072==(2146435072&r)&&(a[922]=1,e=m[375]),e}function ne(e){m[460]=ie(m[460],e)}function ie(e,t){var r,n=0,i=0,o=0;return f(+e*t),n=0|c(1),r=0|c(0),0|2146435072!=(0|(i=2146435072&n))?(o=(i=!(i|o))?a[750]:r,n=i?a[751]:n,l(0,0|o),l(1,0|n),+d()):(a[922]=1,n=a[751],l(0,a[750]),l(1,0|n),+d())}function ae(e){m[460]=oe(m[460],e)}function oe(e,t){var r=0,n=0,i=0,o=0;if(f(+t),r=0|c(1),c(0),2146435072&r){if(n=1,f(+e/t),r=0|c(1),i=0|c(0),!(!0&2146435072==(0|(o=2146435072&r))))return i=(n=!(0|o))?a[750]:i,r=n?a[751]:r,l(0,0|i),l(1,0|r),+d()}else n=4;return a[922]=n,r=a[751],l(0,a[750]),l(1,0|r),+d()}function se(e){m[460]=e>>>0}function ue(e){m[460]=0|e}function ce(){var e,t;e=+T(+m[460]),m[460]=e,f(+e),t=0|c(1),c(0),2146435072==(2146435072&t)&&(a[922]=8)}function le(){return de(m[460])}function de(e){var t,r=0,n=0,i=0,a=0;return f(+e),a=1106247680==(0|(i=2146435072&(r=0|c(1))))&a>>>0<0|i>>>0<1106247680,t=r&=2147483647,l(0,0|(n=0|c(0))),l(1,0|r),(e=+d())<0x10000000000000000&e>=0?(i=v(e)>=1?e>0?~~b(S(e/4294967296),4294967295)>>>0:~~y((e-+(~~e>>>0>>>0))/4294967296)>>>0:0,r=~~e>>>0):(i=0,r=0),n=a?r:n,!(r=a?i:t)&n>>>0<4294967295|r>>>0<0?n:-1}function fe(){return pe(m[460])}function pe(e){var t=0,r=0;return f(+e),t=0|c(1),c(0),r=1105199104==(0|(t&=2145386496))&r>>>0<0|t>>>0<1105199104,t=v(e)<2147483648?~~e:-2147483648,r?t:-2147483648}function me(){var e,t;e=+O(+m[460]),m[460]=e,f(+e),t=0|c(1),c(0),2146435072==(2146435072&t)&&(a[922]=8)}function he(){var e,t;e=+I(+m[460]),m[460]=e,f(+e),t=0|c(1),c(0),2146435072==(2146435072&t)&&(a[922]=8)}function ve(){m[460]=J(m[460])}function ge(){var e,t;e=+A(+m[460]),m[460]=e,f(+e),t=0|c(1),c(0),2146435072==(2146435072&t)&&(a[922]=1)}function be(e,t,r){return function(e,t,r){var n=0,s=0,l=0,d=0;if(n=o[r+30|0]){for(s=r;d=10*d+ +(0|_e[a[a[e>>2]+4>>2]](e,u[s>>1])),s=s+2|0,l=(0|n)>1,n=n+-1|0,l;);if(f(+d),n=0|c(1),e=0|c(0),a[t>>2]=e<<11,a[t+4>>2]=2147481600&((2097151&n)<<11|e>>>21)|e>>>21|-2147483648,n=W(t,(n>>>20&2047)-1022|0,((32767&u[r+32>>1])-o[r+30|0]|0)-16384|0),3071&(s=a[t>>2])?(e=s+1024|0,a[t>>2]=e,s>>>0<4294966272||(l=(s=a[t+4>>2])+1|0,a[t+4>>2]=l,n=(l>>>0<s>>>0)+n|0)):e=s,!((0|n)<=-1022))return(0|(s=1071644672+(n<<20)|0))<0?1:(n=a[t+4>>2],a[t>>2]=n<<21|e>>>11,a[t+4>>2]=-2147483648&i[r+32>>1]|s|n>>>11&1048575,0)}return a[t>>2]=0,a[t+4>>2]=0,0}(e,t,r)}function Se(e,t,r,o){!function(e,t,r,o){var s,l,d=0,p=0,v=0,g=0,b=0,S=0,y=0,O=0,C=0,P=0;w=s=w-16|0,m[s+8>>3]=e,l=t,f(+e),p=0|c(1),v=0|c(0),g=d=p;e:if(p=2146435072&d){if(p=h(b=(p>>>20)-1022|0,39457)>>17,i[r+32>>1]=p+16385|d>>>16&32768,(0|o)<=14){if((0|(o=1+(o+p|0)|0))<=-1){n[r+30|0]=0,i[r+32>>1]=0,i[t+2>>1]=0,t=0;break e}o=(0|o)<15?o:15}if(a[s+8>>2]=v<<11,a[s+12>>2]=g<<11|v>>>21|-2147483648,(0|(d=W(s+8|0,b,-1^p)))>=1)for(v=r+32|0;p=u[v>>1],i[v>>1]=p+1&32767|32768&p,(0|(d=W(s+8|0,d,-1)))>0;);if(d?(p=(v=a[s+12>>2])>>>(g=0-d|0),a[s+12>>2]=p,d=v<<d+32|a[s+8>>2]>>>g,a[s+8>>2]=d):(d=a[s+8>>2],p=a[s+12>>2]),d=(v=p>>>0<(d>>>0<2576980377?429496730:429496729)>>>0?922:9223)+d|0,a[s+8>>2]=d,d>>>0<v>>>0&&(p=p+1|0,a[s+12>>2]=p),(0|o)<1)v=r;else{for(S=d>>>16,y=u[s+14>>1],O=r+32|0,P=15==(0|o),v=r,g=1;;){b=o;t:{r:{for(;;){if(o=h(S,10)+(h(65535&d,10)>>>16)>>>16,C=h(y,10)+(o+h(65535&p,10)>>>16)>>>16|48,i[v>>1]=C,y=(p=o+h(p,10)|0)>>>16,S=(d=h(d,10))>>>16,1&(-1^g|48!=(0|C)))break r;if(o=u[O>>1],i[O>>1]=o+-1&32767|32768&o,!P)break}g=1;break t}v=v+2|0,g=0}if(o=b+-1|0,!((0|b)>1))break}a[s+12>>2]=p,a[s+8>>2]=d}d=(o=v-r|0)>>1;t:{if((0|o)<=29){if((0|p)<=-1){i[v>>1]=57,p=d+1|0;break t}i[v>>1]=48}for(;;){if(p=d,(0|d)<1)break t;if(d=p+-1|0,48!=u[(v=v+-2|0)>>1])break}}n[r+30|0]=p,i[t+2>>1]=p,t=(32767&u[r+32>>1])-16384|0}else n[r+30|0]=0,i[r+32>>1]=0,i[t+2>>1]=0,t=0;i[l>>1]=t,w=s+16|0}(e,t,r,o)}function ye(e){return re(m[460],e)}function Oe(e){return oe(m[460],e)}function Ce(e){m[460]=oe(e,m[460])}function Pe(e,t){m[460]=oe(e,t)}function C(){M(1),C()}function Ne(e,t){var r,n;r=0|e,n=0|t,s[0]=r,s[1]=n}function Re(e,t,r,n){var i=0,a=0;return r=function(e,t,r,n){var i=0,a=0,o=0,s=0,u=0,c=0,l=0,d=0,f=0,p=0;e:{t:{r:{n:{i:{a:{o:{s:{u:{c:{if(o=t){if(!(i=r))break c;if(!(a=n))break u;if((i=g(a)-g(o)|0)>>>0<=31)break s;break t}if(1==(0|n)&r>>>0>=0|n>>>0>1)break t;return Ne(e-h(t=(e>>>0)/(r>>>0)|0,r)|0,0),D=0,t}if(i=n,!e)break o;if(!i)break a;if((a=i+-1|0)&i)break a;return Ne(e,o&a),e=o>>>(31&Ee(i)),D=0,e}if(!((a=i+-1|0)&i))break i;u=(g(i)+33|0)-g(o)|0,c=0-u|0;break r}u=i+1|0,c=63-i|0;break r}return Ne(0,o-h(e=(o>>>0)/(i>>>0)|0,i)|0),D=0,e}if((i=g(i)-g(o)|0)>>>0<31)break n;break t}if(Ne(e&a,0),1==(0|i))break e;return r=Ee(i),n=e,e=31&r,32<=(63&r)>>>0?(i=0,e=t>>>e):(i=t>>>e,e=((1<<e)-1&t)<<32-e|n>>>e),D=i,e}u=i+1|0,c=63-i|0}if(a=t,f=e,o=31&(i=63&u),32<=(63&i)>>>0?(i=0,s=a>>>o):(i=a>>>o,s=((1<<o)-1&a)<<32-o|f>>>o),a=i,o=e,e=31&(i=63&c),32<=(63&i)>>>0?(i=o<<e,e=0):(i=(1<<e)-1&o>>>32-e|t<<e,e=o<<e),t=i,u)for(i=n+-1|0,(o=r+-1|0)>>>0<4294967295&&(i=i+1|0),c=i;i=a<<1|s>>>31,a=s<<1,f=i,i=(s=c-((o>>>0<(a|=t>>>31)>>>0)+i|0)|0)>>31,s=(d=a)-(a=r&(l=s>>31))|0,a=f-((n&i)+(d>>>0<a>>>0)|0)|0,i=t<<1|e>>>31,e=p|e<<1,t=0|i,d=0,p=l&=1,u=u+-1|0;);return Ne(s,a),D=(i=t<<1|e>>>31)|d,e=l|e<<1}Ne(e,t),e=0,t=0}return D=t,e}((e^=i=t>>31)-i|0,a=((a=t>>31)^t)-((e>>>0<i>>>0)+a|0)|0,(r^=e=n>>31)-e|0,((i=n>>31)^n)-((r>>>0<e>>>0)+i|0)|0),D=((e=(t^=n)>>31)^D)-(((r^=t>>=31)>>>0<t>>>0)+e|0)|0,n=r-t|0}function ke(e,t,r,n){return e=function(e,t,r,n){var i,a,o,s,u=0,c=0;return s=h(u=r>>>16,c=e>>>16),u=(65535&(c=((o=h(i=65535&r,a=65535&e))>>>16)+h(c,i)|0))+h(u,a)|0,e=(((h(t,r)+s|0)+h(e,n)|0)+(c>>>16)|0)+(u>>>16)|0,D=e,t=65535&o|u<<16}(e,t,r,n)}function Te(e,t,r,n){return e=Re(e,t,r,n)}function Ee(e){return e?31-g(e+-1^e)|0:32}var _e=[null,function(e,t){return 0,0!=(0|P(0|(t|=0)))|0},function(e,t){return 0,0|N(0|(t|=0))},function(e){return 0,0|R()},function(e,t){return 0,(t|=0)+-48|0},j];return{memory:Object.create(Object.prototype,{grow:{},buffer:{get:function(){return r}}}),Base_StrBuf:function(){return 3104},Base_StrBufSize:function(){return 255},Dtr_DaysPerMonth:function(e,t,r){return 0|function(e,t,r){var n=0;n=3&t;e:if(r){if(n|(0|t)<2100)break e;n=!((t>>>0)%100)&0!=((t>>>0)%400|0)}else n||(n=!((0|t)%100)&0!=((0|t)%400|0));return o[1072+(((h(n,12)+e|0)-1|0)%48|0)|0]}(e|=0,t|=0,0!=(0|(r|=0)))},Dtr_FromNum:function(e,t,r,n,s){return e=+e,t|=0,n|=0,s|=0,r=h(r|=0,20)+3616|0,i[r>>1]=0,t=function(e,t,r,n,s){var p=0,v=0,g=0,b=0,S=0,y=0,O=0,C=0,P=0;e:if(!u[e>>1]){if(m[460]=t,f(+t),p=0|c(1),g=0|c(0),y=p,P=-65536&p)if(2146435072!=(2146435072&p)){if(!((0|P)>=1))return-2147467259}else a[922]=1;S=a[770],O=a[771],b=-1;t:{if(!((0|p)<(0|(v=O))||(b=1,(0|p)>(0|v)))){if((0|S)==(0|(v=g)))break t;b=v>>>0<S>>>0?-1:1}if(v=-2147467259,1==(0|((y&O)>-1?b:0-b|0)))break e}t:{if(S=a[772],v=a[773],O=v,b=-1,!((0|p)<(0|v)||(b=1,(0|p)>(0|O)))){if((0|g)==(0|S))break t;b=g>>>0<S>>>0?-1:1}if(S=b,-1==(0|((v&y)>-1?S:0-S|0)))return-2147467259}t:{r:{if(!(s|!P))if(2146435072!=(2146435072&p)){if((0|P)<1)break r}else a[922]=1;X(m[a[1056+(r<<2)>>2]>>3]),C=m[460];break t}Z(),te(t),y=a[921],g=y,l(0,0|(p=a[920])),l(1,0|g),C=+d(),a[750]==(0|p)&&a[751]==(0|g)||(v=a[921])>>>0<65536||(a[921]=-2147483648^v,f(+(C=m[460])),g=0|c(1),p=0|c(0)),y=g,S=g,g=a[1056+(r<<2)>>2],O=a[g+4>>2],v=a[g>>2],b=-1;r:{if(!((0|S)<(0|(g=O))||(b=1,(0|S)>(0|g)))){if((0|p)==(0|v)){m[460]=t;break r}b=p>>>0<v>>>0?-1:1}if(S=b,m[460]=t,-1==(0|((y&O)>-1?S:0-S|0)))break t}te(m[374])}if(i[e+18>>1]=r,p=fe(),v=-2147467259,!z(0)){if(n){if((0|p)>2957003)break e;p=p+1462|0}else if(p+4346018>>>0>7304483)break e;if(i[e+14>>1]=1+((p+6|0)%7|0),!s|p)if(p){if((0|p)<=-1?(g=-4-((n=(-1^p)/1461|0)<<2)|0,v=1461+(h(n,1461)+p|0)|0):(g=(n=(p+-1|0)/1461|0)<<2,v=h(n,-1461)+p|0),!(s&&(0|g)<=199))if((0|(v=(((0|(n=g+-101|0))/100|0)-((0|n)/400|0)|0)+v|0))>=1462){p=3&(n=g+1900|0);t:if(s){if(p|(0|g)<200)break t;p=!((n>>>0)%100)&0!=((n>>>0)%400|0)}else p||(p=!((0|n)%100)&0!=((0|n)%400|0));g=g+4|0,v=(12==(0|h(p,12))?-1460:-1461)+v|0}else(0|v)>0||(g=g+-4|0,v=v+1461|0);p=3&(n=g+1900|0);t:if(s){if(p|(0|g)<200)break t;p=!((n>>>0)%100)&0!=((n>>>0)%400|0)}else p||(p=!((0|n)%100)&0!=((0|n)%400|0));for(y=h(p,12),p=y;s=p,p=p+1|0,(0|(v=(n=v)-o[s+1072|0]|0))>0;);s=((v=s)-((0|y)<(0|(s=s+-11|0))?y:s)>>>0)/12|0,i[e>>1]=1900+(s+g|0),i[e+2>>1]=(h(s,-12)+p|0)-y}else a[e>>2]=788331,n=30;else a[e>>2]=67436;if(a[e+4>>2]=n,m[460]=C,ve(),(n=a[921])>>>0>=65536&&(a[921]=-2147483648^n),X(C),ne(m[379]),t=m[460],n=le(),i[e+8>>1]=n,se(n<<16>>16),(n=a[921])>>>0>=65536&&(a[921]=-2147483648^n),X(t),ne(m[380]),t=m[460],n=le(),i[e+10>>1]=n,se(n<<16>>16),(n=a[921])>>>0>=65536&&(a[921]=-2147483648^n),X(t),ne(m[380]),!r)return r=le(),i[e+16>>1]=0,i[e+12>>1]=r,0;t=m[460],n=le(),i[e+12>>1]=n,se(n<<16>>16),(n=a[921])>>>0>=65536&&(a[921]=-2147483648^n),X(t),ne(m[a[1152+(r<<2)>>2]>>3]),m[460]=q(m[460]),i[e+16>>1]=le(),v=0}}return v}(r,e,t,0!=(0|n),0!=(0|s)),a[922]=0,0|t},Dtr_Yr:function(e){return i[h(e|=0,20)+3616>>1]},Dtr_Mon:function(e){return i[h(e|=0,20)+3618>>1]},Dtr_DOM:function(e){return a[h(e|=0,20)+3620>>2]},Dtr_Hour:function(e){return i[h(e|=0,20)+3624>>1]},Dtr_Min:function(e){return i[h(e|=0,20)+3626>>1]},Dtr_Sec:function(e){return i[h(e|=0,20)+3628>>1]},Dtr_Wdy:function(e){return i[h(e|=0,20)+3630>>1]},Dtr_FracSec:function(e){return i[h(e|=0,20)+3632>>1]},Dtr_Rounding:function(e){return i[h(e|=0,20)+3634>>1]},Dtr_Write:function(e,t,r,n,o,s,u,c,l,d){e|=0,t|=0,r|=0,n|=0,o|=0,s|=0,u|=0,c|=0,l|=0,d=h(d|=0,20),i[d+3634>>1]=l,i[d+3632>>1]=c,i[d+3630>>1]=u,i[d+3628>>1]=s,i[d+3626>>1]=o,i[d+3624>>1]=n,a[d+3620>>2]=r,i[d+3618>>1]=t,i[d+3616>>1]=e},Dtr_ToNum:function(e,t,r){return e|=0,t|=0,r|=0,a[920]=0,a[921]=0,function(e,t,r){var n,o=0;w=n=w-16|0;e:{t:{r:{if((u[e+2>>1]+-32767&65535)>>>0>1){if(i[e+18>>1]>=1?(ue(i[e+16>>1]),o=Oe(m[a[1152+(i[e+18>>1]<<2)>>2]>>3]),ue(i[e+12>>1]),X(o)):ue(i[e+12>>1]),o=Oe(m[380]),ue(i[e+10>>1]),X(o),o=Oe(m[380]),ue(i[e+8>>1]),X(o),o=Oe(m[379]),!((0|U(e,t,r,n+12|0))<0)){if(e=a[n+12>>2],!t)break r;if(ue(e+-1462|0),!((0|e)<1462)){if(e=a[921],!(t=-65536&e))break t;if(2146435072==(2146435072&e)){a[922]=1;break t}if((0|t)>=1)break t}}a[920]=0,a[921]=0}a[920]=0,a[921]=0,z(8);break e}se(e)}X(o)}w=n+16|0}(h(e,20)+3616|0,0!=(0|t),0!=(0|r)),+m[460]},Dtr_ToNumWithDuration:function(e,t,r,n,o){return e|=0,t|=0,r|=0,n|=0,o|=0,a[920]=0,a[921]=0,function(e,t,r,n,o){var s,c=0;w=s=w-16|0;e:{t:{r:{if((u[e+2>>1]+-32767&65535)>>>0>1){n:if(i[e+18>>1]>=1){if(ue(i[e+16>>1]),ae(m[a[1152+(i[e+18>>1]<<2)>>2]>>3]),c=m[460],2==(0|o)){m[460]=n,X(c);break n}ue(i[e+12>>1]),X(c)}else 2!=(0|o)?ue(i[e+12>>1]):m[460]=n;if(ae(m[380]),c=m[460],1!=(0|o)?ue(i[e+10>>1]):m[460]=n,X(c),ae(m[380]),c=m[460],o?ue(i[e+8>>1]):m[460]=n,X(c),ae(m[379]),n=m[460],!((0|U(e,t,r,s+12|0))<0)){if(e=a[s+12>>2],!t)break r;if(ue(e+-1462|0),!((0|e)<1462)){if(e=a[921],!(t=-65536&e))break t;if(2146435072==(2146435072&e)){a[922]=1;break t}if((0|t)>=1)break t}}a[920]=0,a[921]=0}a[920]=0,a[921]=0,z(8);break e}se(e)}X(n)}w=s+16|0}(h(e,20)+3616|0,0!=(0|t),0!=(0|r),+(0|o),n),+m[460]},Dtr_Days:function(){return a[919]},Dtr_ToDays:function(e,t,r){return t|=0,r|=0,0|U(h(e|=0,20)+3616|0,0!=(0|t),0!=(0|r),3676)},Dtr_ToTime:function(e,t,r){return function(e,t,r){m[460]=e,X(m[a[1056+(r<<2)>>2]>>3]);e:{if(t>>>0<=1){if(t-1)break e}else ne(m[380]);ne(m[380])}ne(m[379]),ve()}(e=+e,t|=0,r|=0),+m[460]},Dtr_UtcToLocal:function(e,t,r,n,o,s,c,l){var d;return e|=0,t|=0,r|=0,n|=0,o|=0,s|=0,c|=0,l|=0,w=d=w-32|0,a[d+24>>2]=s,a[d+16>>2]=n,a[d+8>>2]=t,a[d+20>>2]=(0|o)>-1?h(o,20)+3616|0:0,a[d+12>>2]=(0|r)>-1?h(r,20)+3616|0:0,e=function(e,t,r,n){var o,s=0;w=o=w-32|0,function(e,t,r){var n,o=0,s=0,c=0,l=0,d=0,f=0,p=0,m=0,v=0,g=0,b=0,S=0;if(w=n=w-96|0,a[n+64>>2]=i[t>>1],a[n+68>>2]=i[t+2>>1],a[n+72>>2]=a[t+4>>2],a[n+76>>2]=i[t+8>>1],a[n+80>>2]=i[t+10>>1],a[n+84>>2]=i[t+12>>1],a[n+92>>2]=i[t+14>>1]+-1,(o=i[t+18>>1])>>>0<=3){e:{t:switch(o-1|0){case 0:o=h(i[t+16>>1],100);break e;case 1:o=h(i[t+16>>1],10);break e;case 2:break t;default:break e}o=i[t+16>>1]}a[n+88>>2]=o}t=0;e:if(K(n- -64|0,n+40|0)){if(c=ke(c=h(a[e>>2],60),c>>31,1e7,0),d=D,(s=a[e+4>>2])&&(l=a[e+12>>2])){if(a[n+64>>2]=i[s>>1],a[n+68>>2]=i[s+2>>1],a[n+72>>2]=a[s+4>>2],a[n+76>>2]=i[s+8>>1],a[n+80>>2]=i[s+10>>1],a[n+84>>2]=i[s+12>>1],a[n+92>>2]=i[s+14>>1]+-1,(o=i[s+18>>1])>>>0<=3){t:{r:switch(o-1|0){case 0:o=h(i[s+16>>1],100);break t;case 1:o=h(i[s+16>>1],10);break t;case 2:break r;default:break t}o=i[s+16>>1]}a[n+88>>2]=o}if(a[n+8>>2]=i[l>>1],a[n+12>>2]=i[l+2>>1],a[n+16>>2]=a[l+4>>2],a[n+20>>2]=i[l+8>>1],a[n+24>>2]=i[l+10>>1],a[n+28>>2]=i[l+12>>1],a[n+36>>2]=i[l+14>>1]+-1,(o=i[l+18>>1])>>>0<=3){t:{r:switch(o-1|0){case 0:o=h(i[l+16>>1],100);break t;case 1:o=h(i[l+16>>1],10);break t;case 2:break r;default:break t}o=i[l+16>>1]}a[n+32>>2]=o}if(s=a[n+44>>2],l=s,o=a[n+40>>2],!V(n- -64|0,n+56|0,o,s))break e;if(!V(n+8|0,n+48|0,o,l))break e;v=a[n+40>>2],p=a[n+44>>2],g=c,b=e+16|0,S=e+8|0,m=(l=d)+a[n+52>>2]|0,(f=(o=c)+a[n+48>>2]|0)>>>0<o>>>0&&(m=m+1|0),s=f,o=h(a[e+8>>2],60),f=ke(o,o>>31,1e7,0),o=D+m|0,m=s=s+f|0,f=o=s>>>0<f>>>0?o+1|0:o,s=d+a[n+60>>2]|0,(d=c+a[n+56>>2]|0)>>>0<c>>>0&&(s=s+1|0),e=h(a[e+16>>2],60),c=ke(e,e>>31,1e7,0),e=D+s|0,e=(d=c+d|0)>>>0<c>>>0?e+1|0:e,c=d,e=ke(e=h(a[((e=(0|o)<(0|e)||(0|o)<=(0|e)&&!(m>>>0>=c>>>0)?((0|p)<(0|e)?1:(0|p)<=(0|e)?v>>>0>=c>>>0?0:1:0)&((0|p)>(0|f)?1:(0|p)>=(0|f)?v>>>0<m>>>0?0:1:0):((0|p)<(0|e)?1:(0|p)<=(0|e)?v>>>0>=c>>>0?0:1:0)|((0|p)>(0|f)?1:(0|p)>=(0|f)?v>>>0<m>>>0?0:1:0))?b:S)>>2],60),e>>31,1e7,0),o=D+l|0,d=o=(c=g+e|0)>>>0<e>>>0?o+1|0:o}e=a[n+40>>2],o=a[n+44>>2]-(d+(e>>>0<c>>>0)|0)|0,c=e-c|0,(0|(e=o))<0||(0|e)<=0&&!(c>>>0>=0)||(G(c,e,n- -64|0),i[r>>1]=a[n+64>>2],i[r+2>>1]=a[n+68>>2],a[r+4>>2]=a[n+72>>2],t=1,i[r+14>>1]=u[n+92>>1]+1,i[r+8>>1]=a[n+76>>2],i[r+10>>1]=a[n+80>>2],i[r+12>>1]=a[n+84>>2],e=a[n+88>>2],i[r+18>>1]=3,i[r+16>>1]=e)}return w=n+96|0,t}(n,e,o+8|0)&&(n=a[o+12>>2],a[e>>2]=a[o+8>>2],a[e+4>>2]=n,a[e+16>>2]=a[o+24>>2],n=a[o+20>>2],a[e+8>>2]=a[o+16>>2],a[e+12>>2]=n,n=e,(0|U(e,t,r,o+28|0))>=0?e=1+((a[o+28>>2]+6|0)%7|0)|0:(a[o+28>>2]=-1,e=6),i[n+14>>1]=e,s=1);return w=o+32|0,s}(h(e,20)+3616|0,0!=(0|c),0!=(0|l),d+8|0),w=d+32|0,0|e},Mathpack_Zero:function(){return+m[375]},Mathpack_One:function(){return+m[374]},Mathpack_Pi:function(){return+m[370]},Mathpack_Div:function(e,t){return+oe(e=+e,t=+t)},Mathpack_Mul:function(e,t){return+ie(e=+e,t=+t)},Mathpack_Sub:function(e,t){return+re(e=+e,t=+t)},Mathpack_Add:function(e,t){return+ee(e=+e,t=+t)},Mathpack_Power:function(e,t){return+function(e,t){var r=0,n=0,o=0,s=0;m[460]=t,f(+t),r=0|c(1),c(0),o=r,a[921]=2147483647&r,t=m[460];e:{if(f(+ye(m[371])),r=0|c(1),n=0|c(0),65535==(0|r)&n>>>0<=4294967295|r>>>0<65535)m[460]=e,me();else if(ve(),f(+ye(t)),r=0|c(1),n=0|c(0),65535==(0|r)&n>>>0>4294967295|r>>>0>65535||-1==(0|(r=le()))){if(m[460]=e,f(+e),n=0|c(1),c(0),(0|(n=(r=n)>>>16<<16))>=1)ce(),ne(t),ge();else if(!((0|n)>-1)){if(Pe(m[374],t),s=q(m[460]),m[460]=s,ve(),f(+ye(s)),65535==(0|(n=0|c(1)))&c(0)>>>0>4294967295|n>>>0>65535)break e;if(2147483647==(0|(n=fe()))|!(1&n))break e;m[460]=e,a[921]=2147483647&r,ce(),ne(t),ge(),(r=a[921])>>>0<65536||(a[921]=-2147483648^r)}}else m[460]=e,function(e){var t,r=0;if(!((t=i[1843])|e))return void(a[922]=4&a[922]?4:64);if(!((0|t)<1)&&10==(0|le())){if(r=m[460],ve(),te(r),!u[1843])return void Y(e);m[460]=r}r=1;for(;1&e&&(r=ie(m[460],r)),e>>>=1;)ne(m[460]);m[460]=r}(r);if(o>>>16<<16>>16<=-1){if(1&(o=a[922]))return a[920]=0,a[921]=0,a[922]=-2&o,m[460];Ce(m[374])}return m[460]}return a[922]=8,m[460]}(e=+e,t=+t)},Mathpack_Cond:function(e){var t,r;return f(+(e=+e)),t=0|c(1),c(0),(r=-65536&t)?2146435072==(2146435072&t)?(a[922]=1,0):0|((0|r)<1?-1:1):0},Mathpack_Cond2:function(e,t){t=+t;var r,n,i,a,o=0,s=0,u=0;f(+(e=+e)),o=0|c(1),r=0|c(0),n=o,a=o,f(+t),i=0|c(1),o=0|c(0),u=-1;e:{if(!((0|n)<(0|(s=i))||(u=1,(0|a)>(0|s)))){if(s=0,(0|o)==(0|r))break e;u=r>>>0<o>>>0?-1:1}o=u,s=(i&n)>-1?o:0-o|0}return 0|s},Mathpack_TakeMathError:function(){var e;return e=a[922],a[922]=0,0|e},Mathpack_Trunc:function(e){return+J(e=+e)},Mathpack_Ceil:function(e){return e=+e,m[460]=e,function(){var e=0,t=0,r=0;e:{if(r=a[920],e=a[921],t=-65536&e){if(2146435072==(2146435072&e))return a[922]=1,void ve();if((0|t)>0)break e}return void ve()}ve(),(0|r)==a[920]&&a[921]==(0|e)||X(1)}(),+m[460]},Mathpack_Floor:function(e){return e=+e,m[460]=e,Z(),+m[460]},Mathpack_Abs:function(e){var t=0;return f(+(e=+e)),t=0|c(1),t&=2147483647,l(0,0|(0|c(0))),l(1,0|t),+d()},Mathpack_Neg:function(e){var t,r,n,i;return f(+(e=+e)),n=-2147483648^(t=0|c(1)),l(0,0|(r=0|c(0))),l(1,0|n),i=+d(),+(65535==(0|t)&r>>>0>4294967295|t>>>0>65535?i:e)},Mathpack_Float:function(e){return+((e|=0)>>>0)},Mathpack_SFloat:function(e){return+(0|(e|=0))},Mathpack_Fix:function(e){return 0|de(e=+e)},Mathpack_LFix:function(e){return 0|pe(e=+e)},Mathpack_SFix:function(e){return e=+e,m[460]=e,0|Q()},Mathpack_Round:function(e,t){return+function(e,t){var r,o=0,s=0,l=0,d=0;w=r=w+-64|0,a[r+56>>2]=0,i[r+46>>1]=0,i[r+48>>1]=0,m[460]=e,f(+e),o=0|c(1),c(0);e:if(s=-65536&o)if(2146435072!=(2146435072&o)){(0|s)>0||(d=32768,o>>>0<65536||(a[921]=-2147483648^o,e=m[460])),Se(e,r+56|0,r+16|0,15),u[r+58>>1]||(i[r+56>>1]=1),m[460]=t,o=(0|(o=Q()))<0?100:o;t:{if(s=a[921],l=-65536&s)if(2146435072!=(2146435072&s)){if(!((0|l)>0)){if((o=a[921])>>>0>=65536&&(a[921]=-2147483648^o),(0|(o=Q()))<=-1)break t;o=0-o|0}}else a[922]=1;s=i[r+56>>1],l=o+s|0,o=i[r+58>>1],(0|l)<(0|o)&&(a[r+12>>2]=o,a[r+8>>2]=s,$(r+16|0,r+8|0,r+12|0,l),o=a[r+12>>2],i[r+58>>1]=o,s=a[r+8>>2],i[r+56>>1]=s),n[r+46|0]=o,i[r+48>>1]=s+16384&32767|d,be(3100,3680,r+16|0),e=m[460];break e}e=m[375]}else a[922]=1;return w=r- -64|0,e}(e=+e,t=+t)},Mathpack_RoundUp:function(e,t){return+function(e,t){var r=0,n=0,i=0,o=0,s=0;f(+e),r=0|c(1),c(0);(n=-65536&r)&&(2146435072!=(2146435072&r)?s=(0|n)<1?-1:1:a[922]=1);if(i=L(e,t),m[460]=e,m[460]=q(e),te(i),(r=a[921])>>>0>=65536){if(2146435072==(2146435072&r))return a[922]=1,i;if(r=(0|(r=de(t)<<16))<0?309:r>>16,f(+t),n=0|c(1),c(0),(o=-65536&n)&&(2146435072!=(2146435072&n)?r=(0|o)<1?0-r|0:r:a[922]=1),(0|r)<=-309)return z(8),0;Y(0-r|0),(0|s)>-1||(r=a[921])>>>0<65536||(a[921]=-2147483648^r),X(i),i=m[460]}return i}(e=+e,t=+t)},Mathpack_RoundDown:function(e,t){var r;return f(+(e=L(e=+e,t=+t))),r=0|c(1),c(0),2146435072==(2146435072&r)&&(a[922]=1,e=-1),+e},Mathpack_TenTo:function(e){return Y(e|=0),+m[460]},Mathpack_Compare:function(e,t){return+(0|function(e,t){var r,n=0,i=0,o=0,s=0,u=0;w=r=w-16|0,m[r+8>>3]=e,m[r>>3]=t,f(+e),n=0|c(1),i=0|c(0),o=n,f(+t),n=0|c(1),s=0|c(0),u=n;e:{if((0|i)!=(0|s)||(0|o)!=(0|n)){if((u+2097152&2146435072)-(2146435072&o)>>>0<=5242879&&(e=q(e),m[r+8>>3]=e,f(+e),n=0|c(1),c(0),o=n,e=q(t),m[r>>3]=e,f(+e),n=0|c(1),c(0),u=n),n=1,o=a[(s=(i=(u&o)>-1)?r+8|0:r)+4>>2],u=a[(i=i?r:r+8|0)+4>>2],(0|o)>(0|u))break e;if((0|o)<(0|u)){n=-1;break e}if(s=a[s>>2],i=a[i>>2],s>>>0>i>>>0)break e;if(n=-1,s>>>0<i>>>0)break e}n=0}return w=r+16|0,n}(e=+e,t=+t))},Mathpack_GetExp32:function(e){var t;return f(+(e=+e)),t=0|c(1),c(0),2146435072&t},Mathpack_Equal:function(e,t){t=+t;var r,n,i=0;return f(+(e=+e)),i=0|c(1),r=0|c(0),f(+t),n=0|c(1),0|(i=(0|r)==(0|c(0))?(0|i)==(0|n):0)},Mathpack_ViewRound:function(e){var t;return f(+(e=+e)),t=0|c(1),c(0),2146435072==(2146435072&t)?(a[922]=1,-1):+q(e)},Mathpack_Sqrt:function(e){return e=+e,m[460]=e,me(),+m[460]},Mathpack_Exp:function(e){return e=+e,m[460]=e,ge(),+m[460]},Mathpack_Ln:function(e){return e=+e,m[460]=e,ce(),+m[460]},Mathpack_Log:function(e){return e=+e,m[460]=e,function(){var e,t;e=+k(+m[460]),m[460]=e,f(+e),t=0|c(1),c(0),2146435072==(2146435072&t)&&(a[922]=8)}(),+m[460]},Mathpack_Sin:function(e){return e=+e,m[460]=e,function(){var e=0,t=0;f(+(t=m[460])),e=0|c(1),c(0),1101004799==(0|(e&=2145386496))&!0|e>>>0<1101004799&&(t=+E(+t),m[460]=t,f(+t),e=0|c(1),c(0),2146435072!=(2146435072&e))||(a[922]=8)}(),+m[460]},Mathpack_Cos:function(e){return e=+e,m[460]=e,function(){var e=0,t=0;f(+(t=m[460])),e=0|c(1),c(0),1101004799==(0|(e&=2145386496))&!0|e>>>0<1101004799&&(t=+_(+t),m[460]=t,f(+t),e=0|c(1),c(0),2146435072!=(2146435072&e))||(a[922]=8)}(),+m[460]},Mathpack_Tan:function(e){return e=+e,m[460]=e,function(){var e=0,t=0,r=0;r=8,f(+(t=m[460])),e=0|c(1),c(0);1101004799==(0|(e&=2145386496))&!0|e>>>0<1101004799&&(t=+F(+t),m[460]=t,r=4,f(+t),e=0|c(1),c(0),2146435072!=(2146435072&e))||(a[922]=r)}(),+m[460]},Mathpack_Asin:function(e){return+B(e=+e,0)},Mathpack_Acos:function(e){return+B(e=+e,1)},Mathpack_Atan:function(e){return e=+e,m[460]=e,he(),+m[460]},Mathpack_Atan2:function(e,t){return+function(e,t){var r=0,n=0,i=0,o=0,s=0,u=0;m[460]=e;e:{if(f(+e),r=0|c(1),c(0),r>>>0>=65536){if(2146435072!=(2146435072&r))break e;a[922]=1}m[460]=t;t:{if(f(+t),r=0|c(1),c(0),n=-65536&r){if(2146435072!=(2146435072&r))break t;a[922]=1}return z(4),0}return ue((0|n)<1?-1:1),ne(m[370]),ae(m[372]),m[460]}e:if((0|r)<=-1){f(+t),r=0|c(1),c(0);t:{if(n=-65536&r)if(2146435072!=(2146435072&r)){if((0|n)<1)break t}else a[922]=1;i=m[370];break e}f(+(i=m[370])),r=0|c(1),n=0|c(0),o=-2147483648^r,l(0,0|n),l(1,0|o),s=+d(),u=i,i=65535==(0|r)&n>>>0>4294967295|r>>>0>65535?s:u}else i=m[375];return Pe(t,e),he(),X(i),m[460]}(e=+e,t=+t)},Mathpack_FormatGeneral:function(e,t){t|=0;var r,n,o,s=0,l=0;return f(+(e=+e)),r=0|c(1),o=0|c(0),2146435072==(2146435072&r)?(a[922]=1,-1):(m[460]=e,s=3104,(n=-65536&(l=r))&&(2146435072!=(2146435072&l)?(s=3104,(0|n)>0||(l>>>0>=65536&&(a[921]=-2147483648^l),s=3104,!o&-2147483648==(0|r)||(i[1552]=45,s=3106))):(a[922]=1,s=3104)),l=s,t=(0|t)<255?t:255,t=function(e,t,r,n){var o;w=o=w-16|0,e=0|_e[a[a[e>>2]+8>>2]](e),a[o+8>>2]=0;e:if(r<<1>>>0<=33){if((0|r)<1)break e;i[t>>1]=0}else Se(m[460],o+8|0,t,15),t=function(e,t,r,n,o,s){var c,l,d,f=0,p=0,m=0,v=0,g=0;w=l=w-16|0,c=(t<<1)+e|0,d=l+12|0;t:{r:{n:{i:if(!(m=(0|r)<5&(p=o?n:1)+3>>>0<8)){a:if(!((0|p)>(0|r))){if((0|(n=r+p|0))>=3){if((0|r)<5|(0|p)>-4)break i;if((n+-2|0)<(0|o))break a;break i}if((0|r)<5)break i}if(v=1,n=1,(0|r)<7)break n;n=r-(p+97>>>0>196?6:5)|0;break n}(1!=(0|r)||(n=0,p))&&(n=r-((0|p)<(0|r)?(0|p)<1?2-p|0:1:0)|0)}n:{if((0|n)<(0|o)){f=1,o=0;i:if(!((0|t)<1)){a:{o:{if(!n){if(u[e>>1]>52)break o;break i}if((0|n)<1|(0|n)>=(0|t))break i;if(u[(n<<1)+e>>1]<=52)break a;for(;;){if(g=u[(f=((o=n+-1|0)<<1)+e|0)>>1]+1|0,i[f>>1]=g,58!=(65535&g))break a;if(n=o,!o)break}}i[e>>1]=49,o=1,f=p+1|0;break i}for(;(0|(o=n))>=2&&48==u[((n=o+-1|0)<<1)+e>>1];);f=p}if((-1^m)&(0|f)>(0|r)|v)break n;break r}if(f=p,!v)break r}if(a[d>>2]=32768,r=e+2|0,(0|o)<2||(n=r+(o<<1)|0)>>>0>=c>>>0?n=r:(o=o+-1|0,a[d>>2]=32768|o,e=e+4|0,(t<<1)-4>>1>>>0<o>>>0&&C(),x(e,r,o<<1),i[r>>1]=s),n>>>0<c>>>0&&(i[n>>1]=69,n=n+2|0),n>>>0>=c>>>0?o=n:(o=n+2|0,(0|f)<=0?(i[n>>1]=45,f=1-f|0):(i[n>>1]=43,f=f+-1|0)),(0|f)<100|o>>>0>=c>>>0||(e=(f>>>0)/100|0,i[o>>1]=e+48,f=f-h(e,100)|0,o=o+2|0),o>>>0<c>>>0&&(i[o>>1]=48+((0|f)/10|0),o=o+2|0),o>>>0>=c>>>0)break t;i[o>>1]=48+((0|f)%10|0),o=o+2|0;break t}if((0|o)<0|(0|o)>(0|f))if(r=o-f|0,a[d>>2]=r,(0|f)>=1){if(!((r=(n=((m=(r=(p=(0|f)>(0|t)?t:f)<<1)+e|0)+(o<<1)|0)-r|0)+-2|0)>>>0<e>>>0|n>>>0>=c>>>0))for(;i[n>>1]=u[r>>1],n=n+-2|0,(r=r+-2|0)>>>0>=m>>>0;);(0|f)<(0|t)&&(i[m>>1]=s),o=m+(((0|(e=c-m>>1))>(0|(t=o-p|0))?t+1|0:e)<<1)|0}else{if(!((n=2+((e-(f<<1)|0)+(o<<1)|0)|0)>>>0>=c>>>0||(o=((o<<1)+e|0)-2|0)>>>0<e>>>0))for(;i[n>>1]=u[o>>1],n=n+-2|0,(o=o+-2|0)>>>0>=e>>>0;);if((0|t)>=1&&(i[e>>1]=48,e=e+2|0),e>>>0<c>>>0&&(i[e>>1]=s,e=e+2|0),n=c-e>>1,f&&(t=(0|n)<(0|(t=0-f|0))?n:t))for(o=0;i[(o<<1)+e>>1]=48,(0|t)!=(0|(o=o+1|0)););o=(((0|n)<(0|r)?n:r)<<1)+e|0}else{if(r=(n=(0|f)>(0|t)?t:f)-o|0)for(t=(o<<1)+e|0,o=0;i[t+(o<<1)>>1]=48,(0|r)!=(0|(o=o+1|0)););o=(n<<1)+e|0}}return w=l+16|0,o}(t,r,n,i[o+8>>1],i[o+10>>1],e);return w=o+16|0,t}(a[256],l,3614-l>>1,(0|t)>0?t:0),a[920]=0,a[921]=0,t-3104>>1)},Mathpack_FormatGetExponent:function(){return a[924]},Mathpack_FormatGetSign:function(){return a[925]},Mathpack_FormatFixed:function(e,t,r){t|=0,r|=0;var n,o=0,s=0;return w=n=w+-64|0,f(+(e=+e)),o=0|c(1),c(0),2146435072!=(2146435072&o)?(a[n+56>>2]=0,i[n+46>>1]=0,i[n+48>>1]=0,Se(e,n+56|0,n+16|0,(o=t+r|0)>>>0<15?o:15),s=i[n+56>>1],o=i[n+58>>1],a[n+8>>2]=o,t=t+s|0,a[n+12>>2]=t,(0|(t=t+r|0))<(0|o)&&($(n+16|0,n+12|0,n+8|0,t),o=a[n+8>>2]),o?((0|(r=r+(t=a[n+12>>2])|0))<(0|o)&&(a[n+8>>2]=r,o=r),(0|o)>-1||(a[922]=1)):(o=0,a[n+12>>2]=0,t=0),a[924]=t,a[925]=u[n+48>>1]>>>15^1,r=o,o>>>0>=256&&(C(),r=a[n+8>>2]),x(3104,n+16|0,o<<1)):(a[922]=1,r=-1),w=n- -64|0,0|r},Mathpack_FormatScientific:function(e,t,r){t|=0,r|=0;var n,o=0,s=0,l=0;if(w=n=w+-64|0,f(+(e=+e)),s=0|c(1),c(0),2146435072!=(2146435072&s)){if(a[n+56>>2]=0,i[n+46>>1]=0,i[n+48>>1]=0,Se(e,n+56|0,n+16|0,15),l=i[n+56>>1],a[n+12>>2]=l,s=i[n+58>>1],a[n+8>>2]=s,(0|(o=t))>=2&&(o=(0|l)%(0|t)|0,o=((0|l)<1?t:o?0:t)+o|0),!((0|(o=r+o|0))>=(0|s))){for($(n+16|0,n+12|0,n+8|0,o),o=(0|o)<(0|(s=a[n+8>>2]))?o:s;s=o,(0|o)>=1&&48==u[(n+16|0)+((o=s+-1|0)<<1)>>1];);a[n+8>>2]=s,(0|t)<2||(0|(o=a[n+12>>2]))!=(0|l)&&((((l=r)+(r=(0|o)%(0|t)|0)|0)+((0|o)<1?t:r?0:t)|0)>=(0|s)||(C(),s=a[n+8>>2]))}(0|s)<=-1&&(a[922]=1),a[924]=a[n+12>>2],a[925]=u[n+48>>1]>>>15^1,(o=s)>>>0>=256&&(C(),o=a[n+8>>2]),x(3104,n+16|0,s<<1)}else a[922]=1,o=-1;return w=n- -64|0,0|o},Mathpack_Pack:function(e,t,r){var o;return e|=0,t|=0,r|=0,w=o=w-48|0,n[o+39|0]=0,x(o+8|0,3104,(r=(0|r)<15?r:15)<<1),i[o+40>>1]=t+16384&32767|!e<<15,n[o+38|0]=r,a[o>>2]=0,a[o+4>>2]=0,be(a[256],o,o+8|0)&&(a[922]=1),w=o+48|0,+m[o>>3]},_start:j,__errno_location:function(){return 3712},setThrew:function(e,t){e|=0,t|=0,a[926]||(a[927]=t,a[926]=e)},stackSave:function(){return 0|w},stackAlloc:function(e){return w=e=w-(e|=0)&-16,0|e},stackRestore:function(e){w=e|=0},__growWasmMemory:function(e){return 0,0|C()}}}({Math:n.Math,Int8Array:Int8Array,Uint8Array:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array,NaN:NaN,Infinity:1/0},{abort:function(){throw new Error("abort")},Base_LocaleIsNumeral:i.Base_LocaleIsNumeral,Base_LocaleGetOrdinal:i.Base_LocaleGetOrdinal,Base_LocaleDecimalSeparator:i.Base_LocaleDecimalSeparator,Math_log10:i.Math_log10,Math_log:i.Math_log,Math_sqrt:i.Math_sqrt,Math_sin:i.Math_sin,Math_cos:i.Math_cos,Math_tan:i.Math_tan,Math_atan:i.Math_atan,Math_exp:i.Math_exp,proc_exit:a.proc_exit},m),g=v.memory;t.memory=g;var b=v.Base_StrBuf;t.Base_StrBuf=b;var S=v.Base_StrBufSize;t.Base_StrBufSize=S;var y=v.Dtr_DaysPerMonth;t.Dtr_DaysPerMonth=y;var O=v.Dtr_FromNum;t.Dtr_FromNum=O;var C=v.Dtr_Yr;t.Dtr_Yr=C;var P=v.Dtr_Mon;t.Dtr_Mon=P;var N=v.Dtr_DOM;t.Dtr_DOM=N;var R=v.Dtr_Hour;t.Dtr_Hour=R;var k=v.Dtr_Min;t.Dtr_Min=k;var T=v.Dtr_Sec;t.Dtr_Sec=T;var E=v.Dtr_Wdy;t.Dtr_Wdy=E;var _=v.Dtr_FracSec;t.Dtr_FracSec=_;var F=v.Dtr_Rounding;t.Dtr_Rounding=F;var I=v.Dtr_Write;t.Dtr_Write=I;var A=v.Dtr_ToNum;t.Dtr_ToNum=A;var M=v.Dtr_ToNumWithDuration;t.Dtr_ToNumWithDuration=M;var w=v.Dtr_Days;t.Dtr_Days=w;var D=v.Dtr_ToDays;t.Dtr_ToDays=D;var j=v.Dtr_ToTime;t.Dtr_ToTime=j;var x=v.Dtr_UtcToLocal;t.Dtr_UtcToLocal=x;var L=v.Mathpack_Zero;t.Mathpack_Zero=L;var B=v.Mathpack_One;t.Mathpack_One=B;var U=v.Mathpack_Pi;t.Mathpack_Pi=U;var G=v.Mathpack_Div;t.Mathpack_Div=G;var K=v.Mathpack_Mul;t.Mathpack_Mul=K;var V=v.Mathpack_Sub;t.Mathpack_Sub=V;var W=v.Mathpack_Add;t.Mathpack_Add=W;var H=v.Mathpack_Power;t.Mathpack_Power=H;var q=v.Mathpack_Cond;t.Mathpack_Cond=q;var z=v.Mathpack_Cond2;t.Mathpack_Cond2=z;var Q=v.Mathpack_TakeMathError;t.Mathpack_TakeMathError=Q;var J=v.Mathpack_Trunc;t.Mathpack_Trunc=J;var Y=v.Mathpack_Ceil;t.Mathpack_Ceil=Y;var $=v.Mathpack_Floor;t.Mathpack_Floor=$;var Z=v.Mathpack_Abs;t.Mathpack_Abs=Z;var X=v.Mathpack_Neg;t.Mathpack_Neg=X;var ee=v.Mathpack_Float;t.Mathpack_Float=ee;var te=v.Mathpack_SFloat;t.Mathpack_SFloat=te;var re=v.Mathpack_Fix;t.Mathpack_Fix=re;var ne=v.Mathpack_LFix;t.Mathpack_LFix=ne;var ie=v.Mathpack_SFix;t.Mathpack_SFix=ie;var ae=v.Mathpack_Round;t.Mathpack_Round=ae;var oe=v.Mathpack_RoundUp;t.Mathpack_RoundUp=oe;var se=v.Mathpack_RoundDown;t.Mathpack_RoundDown=se;var ue=v.Mathpack_TenTo;t.Mathpack_TenTo=ue;var ce=v.Mathpack_Compare;t.Mathpack_Compare=ce;var le=v.Mathpack_GetExp32;t.Mathpack_GetExp32=le;var de=v.Mathpack_Equal;t.Mathpack_Equal=de;var fe=v.Mathpack_ViewRound;t.Mathpack_ViewRound=fe;var pe=v.Mathpack_Sqrt;t.Mathpack_Sqrt=pe;var me=v.Mathpack_Exp;t.Mathpack_Exp=me;var he=v.Mathpack_Ln;t.Mathpack_Ln=he;var ve=v.Mathpack_Log;t.Mathpack_Log=ve;var ge=v.Mathpack_Sin;t.Mathpack_Sin=ge;var be=v.Mathpack_Cos;t.Mathpack_Cos=be;var Se=v.Mathpack_Tan;t.Mathpack_Tan=Se;var ye=v.Mathpack_Asin;t.Mathpack_Asin=ye;var Oe=v.Mathpack_Acos;t.Mathpack_Acos=Oe;var Ce=v.Mathpack_Atan;t.Mathpack_Atan=Ce;var Pe=v.Mathpack_Atan2;t.Mathpack_Atan2=Pe;var Ne=v.Mathpack_FormatGeneral;t.Mathpack_FormatGeneral=Ne;var Re=v.Mathpack_FormatGetExponent;t.Mathpack_FormatGetExponent=Re;var ke=v.Mathpack_FormatGetSign;t.Mathpack_FormatGetSign=ke;var Te=v.Mathpack_FormatFixed;t.Mathpack_FormatFixed=Te;var Ee=v.Mathpack_FormatScientific;t.Mathpack_FormatScientific=Ee;var _e=v.Mathpack_Pack;t.Mathpack_Pack=_e;var Fe=v._start;t._start=Fe;var Ie=v.__errno_location;t.__errno_location=Ie;var Ae=v.setThrew;t.setThrew=Ae;var Me=v.stackSave;t.stackSave=Me;var we=v.stackAlloc;t.stackAlloc=we;var De=v.stackRestore;t.stackRestore=De;var je=v.__growWasmMemory;t.__growWasmMemory=je},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.codePointExclamationMark=t.codePointEuroSign=t.codePointEqualsSign=t.codePointDoubleQuote=t.codePointDollarSign=t.codePointDigitZero=t.codePointDigitTwo=t.codePointDigitThree=t.codePointDigitSix=t.codePointDigitSeven=t.codePointDigitOne=t.codePointDigitNine=t.codePointDigitFour=t.codePointDigitFive=t.codePointDigitEight=t.codePointComma=t.codePointColon=t.codePointCircumflexAccent=t.codePointCapitalZ=t.codePointCapitalY=t.codePointCapitalX=t.codePointCapitalW=t.codePointCapitalV=t.codePointCapitalU=t.codePointCapitalT=t.codePointCapitalS=t.codePointCapitalR=t.codePointCapitalQ=t.codePointCapitalP=t.codePointCapitalO=t.codePointCapitalN=t.codePointCapitalM=t.codePointCapitalL=t.codePointCapitalK=t.codePointCapitalJ=t.codePointCapitalI=t.codePointCapitalH=t.codePointCapitalG=t.codePointCapitalF=t.codePointCapitalE=t.codePointCapitalD=t.codePointCapitalC=t.codePointCapitalB=t.codePointCapitalA=t.codePointCR=t.codePointBacktick=t.codePointBackslash=t.codePointAtSign=t.codePointAsterisk=t.codePointAmpersand=void 0,t.codePointSmallW=t.codePointSmallV=t.codePointSmallU=t.codePointSmallT=t.codePointSmallS=t.codePointSmallR=t.codePointSmallQ=t.codePointSmallP=t.codePointSmallO=t.codePointSmallN=t.codePointSmallM=t.codePointSmallL=t.codePointSmallK=t.codePointSmallJ=t.codePointSmallI=t.codePointSmallH=t.codePointSmallG=t.codePointSmallF=t.codePointSmallE=t.codePointSmallD=t.codePointSmallC=t.codePointSmallB=t.codePointSmallA=t.codePointSlash=t.codePointSingleQuote=t.codePointSemicolon=t.codePointRightSquareBracket=t.codePointRightParen=t.codePointRightCurlyBracket=t.codePointQuestionMark=t.codePointPlusSign=t.codePointPipe=t.codePointPercentSign=t.codePointMinusSign=t.codePointLessThanSign=t.codePointLeftSquareBracket=t.codePointLeftParen=t.codePointLeftCurlyBracket=t.codePointLF=t.codePointInvertedQuestionMark=t.codePointInvertedExclamationMark=t.codePointHash=t.codePointGreaterThanSign=t.codePointFullwidthLatinSmallZ=t.codePointFullwidthLatinSmallA=t.codePointFullwidthLatinCapitalZ=t.codePointFullwidthLatinCapitalA=t.codePointFullwidthDigitZero=t.codePointFullwidthDigitNine=t.codePointFullStop=void 0,t.codePointUnderscore=t.codePointTilde=t.codePointThaiDigitZero=t.codePointThaiDigitNine=t.codePointTab=t.codePointSpace=t.codePointSmallZ=t.codePointSmallY=t.codePointSmallX=void 0;var n=r(7);t.codePointAmpersand=n.codePoint.codePointAmpersand,t.codePointAsterisk=n.codePoint.codePointAsterisk,t.codePointAtSign=n.codePoint.codePointAtSign,t.codePointBackslash=n.codePoint.codePointBackslash,t.codePointBacktick=n.codePoint.codePointBacktick,t.codePointCR=n.codePoint.codePointCR,t.codePointCapitalA=n.codePoint.codePointCapitalA,t.codePointCapitalB=n.codePoint.codePointCapitalB,t.codePointCapitalC=n.codePoint.codePointCapitalC,t.codePointCapitalD=n.codePoint.codePointCapitalD,t.codePointCapitalE=n.codePoint.codePointCapitalE,t.codePointCapitalF=n.codePoint.codePointCapitalF,t.codePointCapitalG=n.codePoint.codePointCapitalG,t.codePointCapitalH=n.codePoint.codePointCapitalH,t.codePointCapitalI=n.codePoint.codePointCapitalI,t.codePointCapitalJ=n.codePoint.codePointCapitalJ,t.codePointCapitalK=n.codePoint.codePointCapitalK,t.codePointCapitalL=n.codePoint.codePointCapitalL,t.codePointCapitalM=n.codePoint.codePointCapitalM,t.codePointCapitalN=n.codePoint.codePointCapitalN,t.codePointCapitalO=n.codePoint.codePointCapitalO,t.codePointCapitalP=n.codePoint.codePointCapitalP,t.codePointCapitalQ=n.codePoint.codePointCapitalQ,t.codePointCapitalR=n.codePoint.codePointCapitalR,t.codePointCapitalS=n.codePoint.codePointCapitalS,t.codePointCapitalT=n.codePoint.codePointCapitalT,t.codePointCapitalU=n.codePoint.codePointCapitalU,t.codePointCapitalV=n.codePoint.codePointCapitalV,t.codePointCapitalW=n.codePoint.codePointCapitalW,t.codePointCapitalX=n.codePoint.codePointCapitalX,t.codePointCapitalY=n.codePoint.codePointCapitalY,t.codePointCapitalZ=n.codePoint.codePointCapitalZ,t.codePointCircumflexAccent=n.codePoint.codePointCircumflexAccent,t.codePointColon=n.codePoint.codePointColon,t.codePointComma=n.codePoint.codePointComma,t.codePointDigitEight=n.codePoint.codePointDigitEight,t.codePointDigitFive=n.codePoint.codePointDigitFive,t.codePointDigitFour=n.codePoint.codePointDigitFour,t.codePointDigitNine=n.codePoint.codePointDigitNine,t.codePointDigitOne=n.codePoint.codePointDigitOne,t.codePointDigitSeven=n.codePoint.codePointDigitSeven,t.codePointDigitSix=n.codePoint.codePointDigitSix,t.codePointDigitThree=n.codePoint.codePointDigitThree,t.codePointDigitTwo=n.codePoint.codePointDigitTwo,t.codePointDigitZero=n.codePoint.codePointDigitZero,t.codePointDollarSign=n.codePoint.codePointDollarSign,t.codePointDoubleQuote=n.codePoint.codePointDoubleQuote,t.codePointEqualsSign=n.codePoint.codePointEqualsSign,t.codePointEuroSign=n.codePoint.codePointEuroSign,t.codePointExclamationMark=n.codePoint.codePointExclamationMark,t.codePointFullStop=n.codePoint.codePointFullStop,t.codePointFullwidthDigitNine=n.codePoint.codePointFullwidthDigitNine,t.codePointFullwidthDigitZero=n.codePoint.codePointFullwidthDigitZero,t.codePointFullwidthLatinCapitalA=n.codePoint.codePointFullwidthLatinCapitalA,t.codePointFullwidthLatinCapitalZ=n.codePoint.codePointFullwidthLatinCapitalZ,t.codePointFullwidthLatinSmallA=n.codePoint.codePointFullwidthLatinSmallA,t.codePointFullwidthLatinSmallZ=n.codePoint.codePointFullwidthLatinSmallZ,t.codePointGreaterThanSign=n.codePoint.codePointGreaterThanSign,t.codePointHash=n.codePoint.codePointHash,t.codePointInvertedExclamationMark=n.codePoint.codePointInvertedExclamationMark,t.codePointInvertedQuestionMark=n.codePoint.codePointInvertedQuestionMark,t.codePointLF=n.codePoint.codePointLF,t.codePointLeftCurlyBracket=n.codePoint.codePointLeftCurlyBracket,t.codePointLeftParen=n.codePoint.codePointLeftParen,t.codePointLeftSquareBracket=n.codePoint.codePointLeftSquareBracket,t.codePointLessThanSign=n.codePoint.codePointLessThanSign,t.codePointMinusSign=n.codePoint.codePointMinusSign,t.codePointPercentSign=n.codePoint.codePointPercentSign,t.codePointPipe=n.codePoint.codePointPipe,t.codePointPlusSign=n.codePoint.codePointPlusSign,t.codePointQuestionMark=n.codePoint.codePointQuestionMark,t.codePointRightCurlyBracket=n.codePoint.codePointRightCurlyBracket,t.codePointRightParen=n.codePoint.codePointRightParen,t.codePointRightSquareBracket=n.codePoint.codePointRightSquareBracket,t.codePointSemicolon=n.codePoint.codePointSemicolon,t.codePointSingleQuote=n.codePoint.codePointSingleQuote,t.codePointSlash=n.codePoint.codePointSlash,t.codePointSmallA=n.codePoint.codePointSmallA,t.codePointSmallB=n.codePoint.codePointSmallB,t.codePointSmallC=n.codePoint.codePointSmallC,t.codePointSmallD=n.codePoint.codePointSmallD,t.codePointSmallE=n.codePoint.codePointSmallE,t.codePointSmallF=n.codePoint.codePointSmallF,t.codePointSmallG=n.codePoint.codePointSmallG,t.codePointSmallH=n.codePoint.codePointSmallH,t.codePointSmallI=n.codePoint.codePointSmallI,t.codePointSmallJ=n.codePoint.codePointSmallJ,t.codePointSmallK=n.codePoint.codePointSmallK,t.codePointSmallL=n.codePoint.codePointSmallL,t.codePointSmallM=n.codePoint.codePointSmallM,t.codePointSmallN=n.codePoint.codePointSmallN,t.codePointSmallO=n.codePoint.codePointSmallO,t.codePointSmallP=n.codePoint.codePointSmallP,t.codePointSmallQ=n.codePoint.codePointSmallQ,t.codePointSmallR=n.codePoint.codePointSmallR,t.codePointSmallS=n.codePoint.codePointSmallS,t.codePointSmallT=n.codePoint.codePointSmallT,t.codePointSmallU=n.codePoint.codePointSmallU,t.codePointSmallV=n.codePoint.codePointSmallV,t.codePointSmallW=n.codePoint.codePointSmallW,t.codePointSmallX=n.codePoint.codePointSmallX,t.codePointSmallY=n.codePoint.codePointSmallY,t.codePointSmallZ=n.codePoint.codePointSmallZ,t.codePointSpace=n.codePoint.codePointSpace,t.codePointTab=n.codePoint.codePointTab,t.codePointThaiDigitNine=n.codePoint.codePointThaiDigitNine,t.codePointThaiDigitZero=n.codePoint.codePointThaiDigitZero,t.codePointTilde=n.codePoint.codePointTilde,t.codePointUnderscore=n.codePoint.codePointUnderscore},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wrapPosition=t.parseGridRangeA1=t.parseGridCellA1=t.parseCellRef=t.isR1C1IdentStart=t.SpecialPos=void 0;var n=r(3);t.SpecialPos=n.cellParse.SpecialPos,t.isR1C1IdentStart=n.cellParse.isR1C1IdentStart,t.parseCellRef=n.cellParse.parseCellRef,t.parseGridCellA1=n.cellParse.parseGridCellA1,t.parseGridRangeA1=n.cellParse.parseGridRangeA1,t.wrapPosition=n.cellParse.wrapPosition},function(e,t,r){"use strict";var n,i;Object.defineProperty(t,"__esModule",{value:!0}),t.insertCommas=t.convertNumberShape=t.convertDigitsShape=void 0;var a=r(80),o=r(92),s=r(189),u=r(148),c=r(91),l=r(76),d=u.codePointDigitZero,f=u.codePointDigitNine,p=u.codePointDigitOne,m=((n={})[c.NumberShape.ArabicIndic]={zero:1632,one:1633},n[c.NumberShape.ExtendedArabicIndic]={zero:1776,one:1777},n[c.NumberShape.Devanagari]={zero:2406,one:2407},n[c.NumberShape.Bengali]={zero:2534,one:2535},n[c.NumberShape.Gurmukhi]={zero:2662,one:2663},n[c.NumberShape.Gujarati]={zero:2790,one:2791},n[c.NumberShape.Oriya]={zero:2918,one:2919},n[c.NumberShape.Tamil]={zero:48,one:3047},n[c.NumberShape.Telugu]={zero:3174,one:3175},n[c.NumberShape.Kannada]={zero:3302,one:3303},n[c.NumberShape.Malayalam]={zero:3430,one:3431},n[c.NumberShape.Thai]={zero:3664,one:3665},n[c.NumberShape.Lao]={zero:3792,one:3793},n[c.NumberShape.Tibetan]={zero:3872,one:3873},n[c.NumberShape.Myanmar]={zero:4160,one:4161},n[c.NumberShape.Ethiopic]={zero:48,one:4969},n[c.NumberShape.Khmer]={zero:6112,one:6113},n[c.NumberShape.Mongolian]={zero:6160,one:6161},n),h=((i={})[c.NumberShape.Japanese1]={digits:[12295,19968,20108,19977,22235,20116,20845,19971,20843,20061],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20740,trillion:20806},i[c.NumberShape.Japanese2]={digits:[12295,22769,24336,21442,22235,20237,20845,19971,20843,20061],ten:25342,hundred:30334,thousand:38433,tenThousand:33836,hundredMillion:20740,trillion:20806},i[c.NumberShape.Japanese3]={digits:[65296,65297,65298,65299,65300,65301,65302,65303,65304,65305],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20740,trillion:20806},i[c.NumberShape.Korean1]={digits:[65296,19968,20108,19977,22235,20116,63953,19971,20843,20061],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20740,trillion:20806},i[c.NumberShape.Korean2]={digits:[63922,22777,36019,63851,22235,20237,63953,19971,20843,20061],ten:63859,hundred:30334,thousand:38433,tenThousand:33836,hundredMillion:20740,trillion:20806},i[c.NumberShape.Korean3]={digits:[65296,65297,65298,65299,65300,65301,65302,65303,65304,65305],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20740,trillion:20806},i[c.NumberShape.Korean4]={digits:[50689,51068,51060,49340,49324,50724,50977,52832,54036,44396],ten:49901,hundred:48177,thousand:52380,tenThousand:47564,hundredMillion:50613,trillion:51312},i[c.NumberShape.ChineseSimp1]={digits:[9675,19968,20108,19977,22235,20116,20845,19971,20843,20061],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20159,trillion:20806},i[c.NumberShape.ChineseSimp2]={digits:[38646,22777,36144,21441,32902,20237,38470,26578,25420,29590],ten:25342,hundred:20336,thousand:20191,tenThousand:19975,hundredMillion:20159,trillion:20806},i[c.NumberShape.ChineseSimp3]={digits:[65296,65297,65298,65299,65300,65301,65302,65303,65304,65305],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20159,trillion:20806},i[c.NumberShape.ChineseTrad1]={digits:[9675,19968,20108,19977,22235,20116,20845,19971,20843,20061],ten:21313,hundred:30334,thousand:21315,tenThousand:33836,hundredMillion:20740,trillion:20806},i[c.NumberShape.ChineseTrad2]={digits:[38646,22777,36019,21443,32902,20237,38520,26578,25420,29590],ten:25342,hundred:20336,thousand:20191,tenThousand:33836,hundredMillion:20740,trillion:20806},i[c.NumberShape.ChineseTrad3]={digits:[65296,65297,65298,65299,65300,65301,65302,65303,65304,65305],ten:21313,hundred:30334,thousand:21315,tenThousand:33836,hundredMillion:20740,trillion:20806},i);function v(e,t){if(t===c.NumberShape.ASCII)return e;switch(t){case c.NumberShape.ArabicIndic:case c.NumberShape.ExtendedArabicIndic:case c.NumberShape.Devanagari:case c.NumberShape.Bengali:case c.NumberShape.Gurmukhi:case c.NumberShape.Gujarati:case c.NumberShape.Oriya:case c.NumberShape.Tamil:case c.NumberShape.Telugu:case c.NumberShape.Kannada:case c.NumberShape.Malayalam:case c.NumberShape.Thai:case c.NumberShape.Lao:case c.NumberShape.Tibetan:case c.NumberShape.Myanmar:case c.NumberShape.Ethiopic:case c.NumberShape.Khmer:case c.NumberShape.Mongolian:for(var r="",n=m[t],i=0;i<e.length;i+=1){var a=e.charCodeAt(i);(0,o.assertTrue)("calc.numfmt.convertDigitsShape",d<=a&&a<=f),r+=a===d?(0,s.stringFromCodePoint)(n.zero):(0,s.stringFromCodePoint)(n.one+(a-p))}return r;case c.NumberShape.Unknown:return e;case c.NumberShape.ChineseTrad1:case c.NumberShape.ChineseTrad2:case c.NumberShape.ChineseTrad3:case c.NumberShape.ChineseSimp1:case c.NumberShape.ChineseSimp2:case c.NumberShape.ChineseSimp3:case c.NumberShape.Japanese1:case c.NumberShape.Japanese2:case c.NumberShape.Japanese3:case c.NumberShape.Korean1:case c.NumberShape.Korean2:case c.NumberShape.Korean3:case c.NumberShape.Korean4:for(r="",n=h[t],i=0;i<e.length;i+=1){a=e.charCodeAt(i);(0,o.assertTrue)("calc.numfmt.convertDigitsShape",d<=a&&a<=f),r+=(0,s.stringFromCodePoint)(n.digits[a-d])}return r}}t.convertDigitsShape=v,t.convertNumberShape=function(e,t,r){var n=e.decimalSeparator;if(r===c.NumberShape.ASCII)return(0,l.success)(t);switch(r){case c.NumberShape.ArabicIndic:case c.NumberShape.ExtendedArabicIndic:case c.NumberShape.Devanagari:case c.NumberShape.Bengali:case c.NumberShape.Gurmukhi:case c.NumberShape.Gujarati:case c.NumberShape.Oriya:case c.NumberShape.Tamil:case c.NumberShape.Telugu:case c.NumberShape.Kannada:case c.NumberShape.Malayalam:case c.NumberShape.Thai:case c.NumberShape.Lao:case c.NumberShape.Tibetan:case c.NumberShape.Myanmar:case c.NumberShape.Ethiopic:case c.NumberShape.Khmer:case c.NumberShape.Mongolian:var i=t.indexOf(n),s=v(t.substring(0,i<0?void 0:i),r),u=i<0?"":n,d=i<0?"":v(t.substring(i+n.length),r);return(0,l.success)(s+u+d);case c.NumberShape.Unknown:return(0,l.success)(t);case c.NumberShape.ChineseTrad1:case c.NumberShape.ChineseTrad2:case c.NumberShape.ChineseTrad3:case c.NumberShape.ChineseSimp1:case c.NumberShape.ChineseSimp2:case c.NumberShape.ChineseSimp3:case c.NumberShape.Japanese1:case c.NumberShape.Japanese2:case c.NumberShape.Japanese3:case c.NumberShape.Korean1:case c.NumberShape.Korean2:case c.NumberShape.Korean3:case c.NumberShape.Korean4:return(0,l.failure)((0,a.notImplemented)(["convertNumberShape: ideographic shape ".concat(String(r))]));default:return(0,o.assertNever)("calc.numfmt.convertNumberShape",r)}},t.insertCommas=function(e,t,r){if(""===t)return"";for(var n=(0,s.countCodePoints)(t,0,t.length),i="",a=0,o=0;a<t.length;){var u=(0,s.stringCodePointAt)(t,a),c=(0,s.numCodeUnits)(u);i+=t.substring(a,a+c),a+=c,o+=1,e.isThousandsPosition(r+(n-o))&&(i+=e.thousandsSeparator)}return i}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.codePointExclamationMark=t.codePointEuroSign=t.codePointEqualsSign=t.codePointDoubleQuote=t.codePointDollarSign=t.codePointDigitZero=t.codePointDigitTwo=t.codePointDigitThree=t.codePointDigitSix=t.codePointDigitSeven=t.codePointDigitOne=t.codePointDigitNine=t.codePointDigitFour=t.codePointDigitFive=t.codePointDigitEight=t.codePointComma=t.codePointColon=t.codePointCircumflexAccent=t.codePointCapitalZ=t.codePointCapitalY=t.codePointCapitalX=t.codePointCapitalW=t.codePointCapitalV=t.codePointCapitalU=t.codePointCapitalT=t.codePointCapitalS=t.codePointCapitalR=t.codePointCapitalQ=t.codePointCapitalP=t.codePointCapitalO=t.codePointCapitalN=t.codePointCapitalM=t.codePointCapitalL=t.codePointCapitalK=t.codePointCapitalJ=t.codePointCapitalI=t.codePointCapitalH=t.codePointCapitalG=t.codePointCapitalF=t.codePointCapitalE=t.codePointCapitalD=t.codePointCapitalC=t.codePointCapitalB=t.codePointCapitalA=t.codePointCR=t.codePointBacktick=t.codePointBackslash=t.codePointAtSign=t.codePointAsterisk=t.codePointAmpersand=void 0,t.codePointSmallW=t.codePointSmallV=t.codePointSmallU=t.codePointSmallT=t.codePointSmallS=t.codePointSmallR=t.codePointSmallQ=t.codePointSmallP=t.codePointSmallO=t.codePointSmallN=t.codePointSmallM=t.codePointSmallL=t.codePointSmallK=t.codePointSmallJ=t.codePointSmallI=t.codePointSmallH=t.codePointSmallG=t.codePointSmallF=t.codePointSmallE=t.codePointSmallD=t.codePointSmallC=t.codePointSmallB=t.codePointSmallA=t.codePointSlash=t.codePointSingleQuote=t.codePointSemicolon=t.codePointRightSquareBracket=t.codePointRightParen=t.codePointRightCurlyBracket=t.codePointQuestionMark=t.codePointPlusSign=t.codePointPipe=t.codePointPercentSign=t.codePointMinusSign=t.codePointLessThanSign=t.codePointLeftSquareBracket=t.codePointLeftParen=t.codePointLeftCurlyBracket=t.codePointLF=t.codePointInvertedQuestionMark=t.codePointInvertedExclamationMark=t.codePointHash=t.codePointGreaterThanSign=t.codePointFullwidthLatinSmallZ=t.codePointFullwidthLatinSmallA=t.codePointFullwidthLatinCapitalZ=t.codePointFullwidthLatinCapitalA=t.codePointFullwidthDigitZero=t.codePointFullwidthDigitNine=t.codePointFullStop=void 0,t.codePointUnderscore=t.codePointTilde=t.codePointThaiDigitZero=t.codePointThaiDigitNine=t.codePointTab=t.codePointSpace=t.codePointSmallZ=t.codePointSmallY=t.codePointSmallX=void 0;var n=r(7);t.codePointAmpersand=n.codePoint.codePointAmpersand,t.codePointAsterisk=n.codePoint.codePointAsterisk,t.codePointAtSign=n.codePoint.codePointAtSign,t.codePointBackslash=n.codePoint.codePointBackslash,t.codePointBacktick=n.codePoint.codePointBacktick,t.codePointCR=n.codePoint.codePointCR,t.codePointCapitalA=n.codePoint.codePointCapitalA,t.codePointCapitalB=n.codePoint.codePointCapitalB,t.codePointCapitalC=n.codePoint.codePointCapitalC,t.codePointCapitalD=n.codePoint.codePointCapitalD,t.codePointCapitalE=n.codePoint.codePointCapitalE,t.codePointCapitalF=n.codePoint.codePointCapitalF,t.codePointCapitalG=n.codePoint.codePointCapitalG,t.codePointCapitalH=n.codePoint.codePointCapitalH,t.codePointCapitalI=n.codePoint.codePointCapitalI,t.codePointCapitalJ=n.codePoint.codePointCapitalJ,t.codePointCapitalK=n.codePoint.codePointCapitalK,t.codePointCapitalL=n.codePoint.codePointCapitalL,t.codePointCapitalM=n.codePoint.codePointCapitalM,t.codePointCapitalN=n.codePoint.codePointCapitalN,t.codePointCapitalO=n.codePoint.codePointCapitalO,t.codePointCapitalP=n.codePoint.codePointCapitalP,t.codePointCapitalQ=n.codePoint.codePointCapitalQ,t.codePointCapitalR=n.codePoint.codePointCapitalR,t.codePointCapitalS=n.codePoint.codePointCapitalS,t.codePointCapitalT=n.codePoint.codePointCapitalT,t.codePointCapitalU=n.codePoint.codePointCapitalU,t.codePointCapitalV=n.codePoint.codePointCapitalV,t.codePointCapitalW=n.codePoint.codePointCapitalW,t.codePointCapitalX=n.codePoint.codePointCapitalX,t.codePointCapitalY=n.codePoint.codePointCapitalY,t.codePointCapitalZ=n.codePoint.codePointCapitalZ,t.codePointCircumflexAccent=n.codePoint.codePointCircumflexAccent,t.codePointColon=n.codePoint.codePointColon,t.codePointComma=n.codePoint.codePointComma,t.codePointDigitEight=n.codePoint.codePointDigitEight,t.codePointDigitFive=n.codePoint.codePointDigitFive,t.codePointDigitFour=n.codePoint.codePointDigitFour,t.codePointDigitNine=n.codePoint.codePointDigitNine,t.codePointDigitOne=n.codePoint.codePointDigitOne,t.codePointDigitSeven=n.codePoint.codePointDigitSeven,t.codePointDigitSix=n.codePoint.codePointDigitSix,t.codePointDigitThree=n.codePoint.codePointDigitThree,t.codePointDigitTwo=n.codePoint.codePointDigitTwo,t.codePointDigitZero=n.codePoint.codePointDigitZero,t.codePointDollarSign=n.codePoint.codePointDollarSign,t.codePointDoubleQuote=n.codePoint.codePointDoubleQuote,t.codePointEqualsSign=n.codePoint.codePointEqualsSign,t.codePointEuroSign=n.codePoint.codePointEuroSign,t.codePointExclamationMark=n.codePoint.codePointExclamationMark,t.codePointFullStop=n.codePoint.codePointFullStop,t.codePointFullwidthDigitNine=n.codePoint.codePointFullwidthDigitNine,t.codePointFullwidthDigitZero=n.codePoint.codePointFullwidthDigitZero,t.codePointFullwidthLatinCapitalA=n.codePoint.codePointFullwidthLatinCapitalA,t.codePointFullwidthLatinCapitalZ=n.codePoint.codePointFullwidthLatinCapitalZ,t.codePointFullwidthLatinSmallA=n.codePoint.codePointFullwidthLatinSmallA,t.codePointFullwidthLatinSmallZ=n.codePoint.codePointFullwidthLatinSmallZ,t.codePointGreaterThanSign=n.codePoint.codePointGreaterThanSign,t.codePointHash=n.codePoint.codePointHash,t.codePointInvertedExclamationMark=n.codePoint.codePointInvertedExclamationMark,t.codePointInvertedQuestionMark=n.codePoint.codePointInvertedQuestionMark,t.codePointLF=n.codePoint.codePointLF,t.codePointLeftCurlyBracket=n.codePoint.codePointLeftCurlyBracket,t.codePointLeftParen=n.codePoint.codePointLeftParen,t.codePointLeftSquareBracket=n.codePoint.codePointLeftSquareBracket,t.codePointLessThanSign=n.codePoint.codePointLessThanSign,t.codePointMinusSign=n.codePoint.codePointMinusSign,t.codePointPercentSign=n.codePoint.codePointPercentSign,t.codePointPipe=n.codePoint.codePointPipe,t.codePointPlusSign=n.codePoint.codePointPlusSign,t.codePointQuestionMark=n.codePoint.codePointQuestionMark,t.codePointRightCurlyBracket=n.codePoint.codePointRightCurlyBracket,t.codePointRightParen=n.codePoint.codePointRightParen,t.codePointRightSquareBracket=n.codePoint.codePointRightSquareBracket,t.codePointSemicolon=n.codePoint.codePointSemicolon,t.codePointSingleQuote=n.codePoint.codePointSingleQuote,t.codePointSlash=n.codePoint.codePointSlash,t.codePointSmallA=n.codePoint.codePointSmallA,t.codePointSmallB=n.codePoint.codePointSmallB,t.codePointSmallC=n.codePoint.codePointSmallC,t.codePointSmallD=n.codePoint.codePointSmallD,t.codePointSmallE=n.codePoint.codePointSmallE,t.codePointSmallF=n.codePoint.codePointSmallF,t.codePointSmallG=n.codePoint.codePointSmallG,t.codePointSmallH=n.codePoint.codePointSmallH,t.codePointSmallI=n.codePoint.codePointSmallI,t.codePointSmallJ=n.codePoint.codePointSmallJ,t.codePointSmallK=n.codePoint.codePointSmallK,t.codePointSmallL=n.codePoint.codePointSmallL,t.codePointSmallM=n.codePoint.codePointSmallM,t.codePointSmallN=n.codePoint.codePointSmallN,t.codePointSmallO=n.codePoint.codePointSmallO,t.codePointSmallP=n.codePoint.codePointSmallP,t.codePointSmallQ=n.codePoint.codePointSmallQ,t.codePointSmallR=n.codePoint.codePointSmallR,t.codePointSmallS=n.codePoint.codePointSmallS,t.codePointSmallT=n.codePoint.codePointSmallT,t.codePointSmallU=n.codePoint.codePointSmallU,t.codePointSmallV=n.codePoint.codePointSmallV,t.codePointSmallW=n.codePoint.codePointSmallW,t.codePointSmallX=n.codePoint.codePointSmallX,t.codePointSmallY=n.codePoint.codePointSmallY,t.codePointSmallZ=n.codePoint.codePointSmallZ,t.codePointSpace=n.codePoint.codePointSpace,t.codePointTab=n.codePoint.codePointTab,t.codePointThaiDigitNine=n.codePoint.codePointThaiDigitNine,t.codePointThaiDigitZero=n.codePoint.codePointThaiDigitZero,t.codePointTilde=n.codePoint.codePointTilde,t.codePointUnderscore=n.codePoint.codePointUnderscore},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RedBlackMapTree=void 0;var n=r(7);t.RedBlackMapTree=n.rbMapTree.RedBlackMapTree},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFeatureGateDictionaryGetter=t.overrideTypedFeatureGates=t.isTypedChangeGateEnabled=t.getTypedFeatureGate=t.getFeatures=t.isFeatureEnabled=t.initFeatureConfiguration=t.FeatureName=void 0;var n=r(7);t.FeatureName=n.featureConfiguration.FeatureName,t.initFeatureConfiguration=n.featureConfiguration.initFeatureConfiguration,t.isFeatureEnabled=n.featureConfiguration.isFeatureEnabled,t.getFeatures=n.featureConfiguration.getFeatures,t.getTypedFeatureGate=n.featureConfiguration.getTypedFeatureGate,t.isTypedChangeGateEnabled=n.featureConfiguration.isTypedChangeGateEnabled;var i=r(41);Object.defineProperty(t,"overrideTypedFeatureGates",{enumerable:!0,get:function(){return i.overrideTypedFeatureGates}}),Object.defineProperty(t,"setFeatureGateDictionaryGetter",{enumerable:!0,get:function(){return i.setFeatureGateDictionaryGetter}})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.values=t.stringStartsWith=t.stringEndsWith=t.repeat=t.prependErrorMessage=t.partialArray=t.messageFromError=t.mathLog2=t.isInteger=t.arrayFill=void 0;var n=r(7);t.arrayFill=n.util.arrayFill,t.isInteger=n.util.isInteger,t.mathLog2=n.util.mathLog2,t.messageFromError=n.util.messageFromError,t.partialArray=n.util.partialArray,t.prependErrorMessage=n.util.prependErrorMessage,t.repeat=n.util.repeat,t.stringEndsWith=n.util.stringEndsWith,t.stringStartsWith=n.util.stringStartsWith,t.values=n.util.values},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WildExp=void 0;var n,i=r(203),a=r(262);!function(e){e[e.OP_DOT=-1]="OP_DOT",e[e.OP_DOTSTAR=-2]="OP_DOTSTAR"}(n||(n={}));var o=i.codePointTilde,s=i.codePointQuestionMark,u=i.codePointAsterisk,c=function(){function e(e,t,r){void 0===r&&(r=!1),this.localeInfo=e,this.source=t,this.appendWildcard=r,this.bytecode=[],this.blocks=[];for(var n="",i=0;i<t.length;i+=1){var c=t.charCodeAt(i);if(c===o&&i+1<t.length){var l=(0,a.stringCodePointAt)(t,i+1);n+=(0,a.stringFromCodePoint)(l),i+=(0,a.numCodeUnits)(l)}else c!==o&&(c!==s&&c!==u?n+=t.charAt(i):(this.pushBlock(n),n="",this.pushMeta(c)))}0===this.bytecode.length&&(this.simplePattern=n),this.pushBlock(n),r&&this.pushMeta(u)}return e.prototype.pushBlock=function(e){if(""!==e){var t=this.blocks.length;this.blocks.push(e),this.bytecode.push(t);for(var r=1;r<e.length;r+=1)this.bytecode.push(n.OP_DOT)}},e.prototype.pushMeta=function(e){e===s?this.bytecode.push(n.OP_DOT):this.bytecode.push(n.OP_DOTSTAR)},e.prototype.test=function(e){if(void 0!==this.simplePattern)return this.testSimple(e,this.simplePattern);var t=Object.create(null);this.addState(t,0);for(var r=0;r<e.length;r+=1){var i=Object.keys(t);if(t=Object.create(null),0===i.length)return!1;for(var a=0;a<i.length;a+=1){var o=Number(i[a]);if(o!==this.bytecode.length){var s=this.bytecode[o];switch(s){case n.OP_DOT:this.addState(t,o+1);break;case n.OP_DOTSTAR:this.addState(t,o);break;default:var u=this.blocks[s];r+u.length<=e.length&&0===this.localeInfo.stringCompareCI(u,e.substring(r,r+u.length))&&this.addState(t,o+1)}}}}return this.bytecode.length in t},e.prototype.addState=function(e,t){e[t]=!0;for(var r=this.bytecode,i=t;i<r.length&&r[i]===n.OP_DOTSTAR;i+=1)e[i+1]=!0},e.prototype.testSimple=function(e,t){return t.length<=e.length&&(t.length===e.length||this.appendWildcard)&&0===this.localeInfo.stringCompareCI(t,e.substring(0,t.length))},e}();t.WildExp=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.watchdog=void 0;var n,i,a=(0,r(205).createPerf)();t.watchdog=(n=1/0,(i=function(e){if(void 0===e&&(e=""),a.now()>n)throw new Error("Time limit exceeded with message: ".concat(e))}).arm=function(e){n=a.now()+e},i)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NulLogger=t.ConsoleLogger=t.ULS=t.LogCategory=t.TraceLevel=void 0,function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(t.TraceLevel||(t.TraceLevel={})),function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS"}(t.LogCategory||(t.LogCategory={})),t.ULS={getFromExternalLogger:function(e){var t=e;return{ULS:{trace:function(e,r,n){return t.traceTag(0,e,r,n)},traceTag:function(e,r,n,i){return t.traceTag(e,r,n,i)},debugTrace:function(e,r,n){return t.debugTraceTag(0,e,r,n)},debugTraceTag:function(e,r,n,i){return t.debugTraceTag(e,r,n,i)},assert:function(e,r,n){return t.assertTag(0,e,r,n)},assertTag:function(e,r,n,i){return t.assertTag(e,r,n,i)},shipAssert:function(e,r,n){return t.shipAssertTag(0,e,r,n)},shipAssertTag:function(e,r,n,i){return t.shipAssertTag(e,r,n,i)},dnmTrace:function(e,r,n){return t.dnmTraceTag(0,e,r,n)},dnmTraceTag:function(e,r,n,i){return t.dnmTraceTag(e,r,n,i)}}}}};var n=function(){function e(){}return e.prototype.shipAssertTag=function(e,t,r,n){console.assert(r,"shipAssertTag:",e,t,n)},e.prototype.assertTag=function(e,t,r,n){console.assert(r,"assertTag",e,t,n)},e.prototype.traceTag=function(e,t,r,n){console.log("traceTag",e,n,t,r)},e.prototype.dnmTraceTag=function(e,t,r,n){console.log("dnmTraceTag",e,n,t,r)},e.prototype.debugTraceTag=function(e,t,r,n){console.log("debugTraceTag",e,n,t,r)},e}();t.ConsoleLogger=n;var i=function(){function e(){}return e.prototype.shipAssertTag=function(){},e.prototype.assertTag=function(){},e.prototype.traceTag=function(){},e.prototype.debugTraceTag=function(){},e.prototype.dnmTraceTag=function(){},e}();t.NulLogger=i},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(7),i=n.deque.Deque},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(3),i=n.mathpackXL.xlMathpack},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(22),i=(n.edit.parseEdit,n.edit.shouldInstallFormat)},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(25),i=(n.compilerService.compiledFormula,n.compilerService.compiledFormulaTerm,n.compilerService.createCompiler)},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(25),i=n.evaluatorService.createEvaluator},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(7),i=(n.arrayMapTree.floorToPowerOf2,n.arrayMapTree.ArrayMapTree);n.arrayMapTree.RootPointer,n.arrayMapTree.enumerateInOrder,n.arrayMapTree.enumerateKeysInOrder},function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r(2),i=r(160),a=r(24),o=r(4),s=r(8),u=r(0),c=r(6),l=function(){function e(e,t,r,n,i,a){this.document=e,this.stringCompareCI=t,this.sheetPosToId=r,this.sheetNameToId=n,this.data=i,this.oldData=a}return e.prototype.clone=function(){return new e(this.document,this.stringCompareCI,this.sheetPosToId,this.sheetNameToId,this.data,void 0)},e.prototype.setSheetNames=function(t){for(var r,a=null!==(r=this.data)&&void 0!==r?r:this.oldData,u=Object(o.h)(),c=[],l=[],d=0;d<t.length;d+=1){var f=t[d],p=f.sheetName,m=f.sheetId;c[d]=m,l.push([p,m]);var h=null==a?void 0:a[m];if(void 0===h){var v=Object(s.u)(this.document,m);u[m]={pos:d,name:p,sheetIndex:v}}else u[m]=Object(n.__assign)(Object(n.__assign)({},h),{pos:d,name:p})}var g=i.a.create(this.stringCompareCI).setValues(l);return new e(this.document,this.stringCompareCI,c,g,u,void 0)},e.prototype.advanceState=function(e){this.oldData=this.data,this.sheetPosToId=void 0,this.sheetNameToId=void 0,this.data=void 0},e.prototype.getSheetRangeIds=function(e){var t,r;if(!this.sheetPosToId)return Object(u.b)(Object(c.Z)([{kind:a.e.SheetNames}]));if(void 0===e.index)t=0,r=this.sheetPosToId.length;else{var n=this.getSheetById(e.index);if(!Object(u.c)(n))return n;var i=this.getSheetById(e.index2);if(!Object(u.c)(i))return i;t=Object(o.c)(n.value.pos,i.value.pos),r=Object(o.b)(n.value.pos,i.value.pos)+1}for(var l=[],d=t;d<r;d+=1)l.push(this.sheetPosToId[d]);return Object(u.e)(Object(s.w)(l,t))},e.prototype.getSheetById=function(e){if(!this.data)return Object(u.b)(Object(c.Z)([{kind:a.e.SheetNames}]));var t=this.data[e];return void 0===t?Object(u.b)(Object(c.Z)([{kind:a.e.SheetId,document:this.document,sheetId:e}])):Object(u.e)(t)},e.prototype.getSheetByName=function(e){if(!this.sheetNameToId)return Object(u.b)(Object(c.Z)([{kind:a.e.SheetNames}]));var t=this.sheetNameToId.getValue(e);return void 0===t?Object(u.e)(void 0):this.getSheetById(t)},e.prototype.forEachSheet=function(e){if(this.sheetPosToId&&this.data)for(var t=0,r=this.sheetPosToId;t<r.length;t++){var n=r[t],i=this.data[n];i&&e(i,n)}},e}()},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(25),i=n.getWorksheetFuncModule.getWorksheetFunc},function(e,t,r){"use strict";r.d(t,"b",(function(){return a})),r.d(t,"a",(function(){return o}));var n=r(4),i=r(1);function a(e,t){return t.length>e.end&&t.charAt(e.end)===i.e[i.a.Pound]}function o(e,t){return Object(n.e)(e.span)&&Object(n.e)(t.span)?e.span.start-t.span.start:Object(n.e)(e.span)?1:Object(n.e)(t.span)?-1:0}},function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n,i=r(5),a=r(4),o=((n={})[i.b.functionSuggestion]={startDelta:5,stopDelta:2e3},n[i.b.formulaHighlighting]={startDelta:5,stopDelta:2e3},n[i.b.argumentAssistance]={startDelta:5,stopDelta:2e3},n[i.b.runExperiment]={startDelta:0,stopDelta:15e3},n[i.b.runAuthoringExperiment]={startDelta:0,stopDelta:15e3},n[i.b.runTest]={startDelta:0,stopDelta:15e3},n);Object(a.q)(),Object(a.q)(),Object(a.q)(),Object(a.q)()},function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return u}));var n=r(9),i=r(12),a=r(35),o=[{name:"self",test:function(){return"undefined"!=typeof self}},{name:"fetch",test:function(){return"function"==typeof fetch}},{name:"Set",test:function(){return"function"==typeof Set}},{name:"Map",test:function(){return"function"==typeof Map}},{name:"WeakMap",test:function(){return"function"==typeof WeakMap}},{name:"Symbol",test:function(){return"function"==typeof Symbol}},{name:"WebAssembly",test:function(){return"object"==typeof WebAssembly}},{name:"Atomics",test:function(){return"object"==typeof Atomics}},{name:"BigInt",test:function(){return"function"==typeof BigInt}},{name:"String.startsWith",test:function(){return"function"==typeof"".startsWith}},{name:"String.codePointAt",test:function(){return"function"==typeof"".codePointAt}},{name:"Object.assign",test:function(){return"function"==typeof Object.assign}},{name:"Object.setPrototypeOf",test:function(){return"function"==typeof Object.setPrototypeOf}},{name:"Number.EPSILON",test:function(){return"number"==typeof Number.EPSILON}},{name:"Number.isFinite",test:function(){return"function"==typeof Number.isFinite}},{name:"Number.parseInt",test:function(){return"function"==typeof Number.parseInt}},{name:"Math.acosh",test:function(){return"function"==typeof Math.acosh}},{name:"Math.hypot",test:function(){return"function"==typeof Math.hypot}},{name:"Math.log1p",test:function(){return"function"==typeof Math.log1p}},{name:"Math.trunc",test:function(){return"function"==typeof Math.trunc}},{name:"Promise.finally",test:function(){return"function"==typeof Promise.resolve().finally}},{name:"RegExp_flags",test:function(){return new RegExp("x","i"),!0}},{name:"RegExp.flags",test:function(){return"string"==typeof/x/.flags}},{name:"Array.of",test:function(){return"function"==typeof Array.of}},{name:"Array.entries",test:function(){return"function"==typeof[].entries}},{name:"Array.find",test:function(){return"function"==typeof[].find}},{name:"performance",test:function(){return"object"==typeof performance}},{name:"performance.now",test:function(){return"function"==typeof performance.now}},{name:"performance.timeOrigin",test:function(){return"number"==typeof performance.timeOrigin}},{name:"performance.memory",test:function(){return"object"==typeof performance.memory}}];function s(){return o.map((function(e){var t=e.name,r=e.test;try{return r()?"":t}catch(e){return t}})).filter((function(e){return e.length>0}))}function u(e){e().then((function(e){var t={main:s(),worker:e},r="calc.calc.logMissingJSFeatures: missing = ".concat(JSON.stringify(t));n.h.ULS.traceTag(561534152,i.c.msoulscat_ES_EWAJS,i.i.Info,r)})).catch((function(e){var t="calc.calc.logMissingJSFeatures: threw ".concat(Object(a.c)(e));n.h.ULS.traceTag(561534153,i.c.msoulscat_ES_EWAJS,i.i.Info,t)}))}},function(e,t,r){"use strict";var n,i=r(2),a=r(9),o=r(8),s=r(1),u=r(11),c=r(33),l=r(107);function d(e,t){for(var r in e)if(!t(r,e[r]))return!1;return!0}!function(e){e.Root="calc.exp.UnitExperiment",e.Default="uninitialised",e.Initialised="init",e.Failure="fail",e.UnifyBound="unifyBound"}(n||(n={}));var f=function(e,t){return d(e.consts,t)};function p(e,t){var r=0;!function(e,t){for(var r in e)t(r,e[r])}(t.vars,(function(){return r+=1})),Object(a.g)(e,void 0===t.name||1===t.varCount),Object(a.g)(e,t.varCount===r)}function m(e,t,r){var i={varCount:e,vars:t,consts:r,name:void 0};return p(n.Root,i),i}function h(){}function v(){return new h}var g=v();function b(){return m(0,{},v())}function S(e){return m(0,{},e)}function y(e){var t,r=m(1,((t={})[e]=1,t),g);return r.name=e,r}var O=function(){return!1};function C(e){if(0===e.varCount)return!0;if(void 0!==e.name)return!0;if(1===e.varCount&&(e.consts===g||f(e,O))){var t=function(e,t){for(var r in e.vars)return t===e.vars[r]?r:void 0}(e,1);return void 0!==t&&(e.name=t,!0)}return!1}function P(e,t){return r=function(e,r){return t.vars[e]===r},d(e.vars,r)&&f(e,(function(e,r){return t.consts[e]===r}));var r}function N(e,t){var r,i,a=b(),o=e.vars,s=e.consts,u=t.vars,c=t.consts;for(var l in o){0!==(d=o[l]+(null!==(r=u[l])&&void 0!==r?r:0))&&(a.vars[l]=d,a.varCount+=1)}for(var l in s){var d;0!==(d=s[l]+(null!==(i=c[l])&&void 0!==i?i:0))&&(a.consts[l]=d)}for(var l in u)void 0===o[l]&&(a.vars[l]=u[l],a.varCount+=1);for(var l in c)void 0===s[l]&&(a.consts[l]=c[l]);return p(n.Root,a),a}function R(e,t,r){var n=t.vars,i=t.consts,a=n[e];if(void 0===a)return t;var o=0,s=b(),u=s.vars,c=s.consts;for(var l in n){var d=r.vars[l],f=void 0===d?0:d;0!==(p=(l===e?0:n[l])+f*a)&&(o+=1,u[l]=p)}for(var l in r.vars){void 0===n[l]&&(o+=1,u[l]=a*r.vars[l])}for(var l in i){var p,h=r.consts[l];0!==(p=i[l]+a*(void 0===h?0:h))&&(c[l]=p)}for(var l in r.consts){void 0===i[l]&&(c[l]=a*r.consts[l])}return m(o,u,c)}var k=function(){},T={kind:1,substitution:k},E=function(e){return{kind:1,substitution:e}},_={kind:0},F=function(e){return e<0?-e:e};function I(e,t,r){var n={};return r===k?t:t===k?r:function(i){var a=n[i];if(void 0!==a)return a;var o=r(i);return n[i]=void 0===o?t(i):e(t,o)}}function A(e,t){return function(r){return e===r?t:void 0}}var M=function(e,t,r){return function e(t,r,i){if(t>=100)return Object(a.a)(n.UnifyBound);if(0===i.varCount)return f(i,O)?T:_;if(1===i.varCount){var o;for(var s in i.vars){o=s;break}Object(a.g)(n.Root,void 0!==o);var u=i.vars[o],c={};for(var l in i.consts){if((y=i.consts[l])%u!=0)return _;c[l]=-y/u}return E(A(o,S(c)))}var d,p=0,h=void 0,v=i.vars,g=i.consts,b=i.varCount;for(var l in v){var y=v[l],C=F(y);(void 0===h||C<h)&&(p=y,h=C,d=l)}Object(a.g)(n.Root,void 0!==d),Object(a.g)(n.Root,0!==p);var P={},N={};for(var l in v)if(l===d)P[l]=1;else{y=v[l];P[l]=-Math.floor(y/p)}for(var l in g){y=g[l];N[l]=-Math.floor(y/p)}var k=m(b,P,N),M=e(t+1,r,R(d,i,k));return 0===M.kind?M:E(I(r,M.substitution,A(d,k)))}(0,e,function(e,t){var r,i,a=b(),o=e.vars,s=e.consts,u=t.vars,c=t.consts;for(var l in o){0!==(d=o[l]-(null!==(r=u[l])&&void 0!==r?r:0))&&(a.vars[l]=d,a.varCount+=1)}for(var l in s){var d;0!==(d=s[l]-(null!==(i=c[l])&&void 0!==i?i:0))&&(a.consts[l]=d)}for(var l in u)void 0===o[l]&&(a.vars[l]=-u[l],a.varCount+=1);for(var l in c)void 0===s[l]&&(a.consts[l]=-c[l]);return p(n.Root,a),a}(t,r))},w=r(6),D=r(21);function j(e,t){return void 0===t&&(t=void 0),{kind:0,flags:e,unit:t}}function x(e){return{kind:1,reference:e,resolution:void 0}}function L(e,t){return{kind:2,elementType:e,dimensions:t}}function B(e){return{kind:3,flags:e}}function U(e){var t;switch(e.kind){case 1:var r=null===(t=e.resolution)||void 0===t?void 0:t.range;return void 0!==r&&(!!Object(w.z)(r)||{rows:r.rows,columns:r.cols,exact:!0});case 2:return e.dimensions;case 0:return!0;case 3:return!1}}function G(e,t){return function(e,t){if("object"==typeof e)return"object"==typeof t?{rows:Math.max(e.rows,t.rows),columns:Math.max(e.columns,t.columns),exact:e.exact&&t.exact}:Object(i.__assign)(Object(i.__assign)({},e),{exact:e.exact&&t});if("object"==typeof t)return Object(i.__assign)(Object(i.__assign)({},t),{exact:t.exact&&e});return e&&t}(U(e),U(t))}function K(e,t){return!0===t?e:L(e,t)}var V,W=j(D.b.Boolean),H=j(D.b.String),q=j(D.b.Number),z=S({}),Q=j(D.b.Number,z),J=j(D.b.Error),Y=j(D.b.Missing|D.b.Blank),$=B(D.c.None),Z=B(D.c.All),X=j(D.b.Number|D.b.Boolean|D.b.String),ee=function(e){return j(D.b.Number|D.b.Boolean|D.b.String,e)};!function(e){e[e.Checking=0]="Checking",e[e.SolvingSimple=1]="SolvingSimple",e[e.SolvingFull=2]="SolvingFull"}(V||(V={}));var te,re=function(){function e(){this.roots=[],this.backlinks=[],this.descriptors=[],this.ranks=[]}return e.prototype.makePoint=function(e){var t=this.roots.length;return this.roots.push(t),this.backlinks.push(t),this.descriptors.push(e),this.ranks.push(0),t},e.prototype.find=function(e){for(var t=this.roots,r=e;t[r]!==r;)t[r]=t[t[r]],r=t[r];return r},e.prototype.findWithDescriptor=function(e){var t=this.find(e);return[t,this.descriptors[t]]},e.prototype.union=function(e,t,r){void 0===r&&(r=!1);var n=this.find(e),i=this.find(t);if(n!==i){var a=this.roots,o=this.backlinks,s=this.ranks;if(r){var u=o[i];return o[i]=o[n],o[n]=u,a[i]=n,void(s[n]<=s[i]&&(s[n]=s[i]+1))}if(s[n]<s[i]){u=o[n];o[n]=o[i],o[i]=u,a[n]=i}else{u=o[i];o[i]=o[n],o[n]=u,a[i]=n,s[n]===s[i]&&(s[n]+=1)}}},e.prototype.forEachInClass=function(e,t){var r=this.backlinks,n=e;for(t(n);r[n]!==e;)t(n=r[n])},e}(),ne=r(14),ie=r(10),ae=r(13),oe=r(17),se=r(0),ue={kind:0},ce=function(e){return{kind:2,constraint:e}},le=S({error:1}),de=S({}),fe=S({currency:1}),pe=S({date:1}),me=S({time:1});function he(e,t,r){var n,i=new re,a=i.makePoint(le),o=(n=le,function(e,t){if(0===t.varCount||e===k)return t;var r=t;for(var i in t.vars){var a=e(i);if(a===n)return n;void 0!==a&&(r=R(i,r,a))}return r});return{symbolContext:e,typeContext:t,stats:r,uf:i,errorPoint:a,errorUnit:le,apply:o}}function ve(e,t){return void 0===t.link&&(t.link=e.uf.makePoint(t.unit)),t.link}function ge(e,t,r,i){return Object(a.g)(n.Root,0===r.varCount),e.uf.union(void 0===i?e.uf.makePoint(r):i,t,!0),ue}function be(e,t,r,i,o){return t===e.errorUnit?(Object(a.g)(n.Root,r===e.errorPoint),void 0!==o&&e.uf.union(e.errorPoint,o,!0),ue):i===e.errorUnit?(Object(a.g)(n.Root,o===e.errorPoint),void 0!==r&&e.uf.union(e.errorPoint,r,!0),ue):0===t.varCount?0===i.varCount?P(s=t,u=i)&&P(u,s)?ue:(void 0!==r&&e.uf.union(e.errorPoint,r,!0),void 0!==o&&e.uf.union(e.errorPoint,o,!0),{kind:1,error:[t,i]}):(Object(a.g)(n.Root,void 0!==o),ge(e,o,t,r)):1===i.varCount?(Object(a.g)(n.Root,void 0!==r),Object(a.g)(n.Root,void 0!==o),e.uf.union(r,o),ue):(Object(a.g)(n.Root,void 0!==r),ge(e,r,i,o));var s,u}function Se(e,t,r){if(!C(t))return ce({kind:2,unit:t,target:r});var i=ve(e,r),o=e.uf.findWithDescriptor(i),s=o[0],u=o[1];if(1===t.varCount){Object(a.g)(n.Root,void 0!==t.name);var c=e.symbolContext.getTable().getValue(t.name);Object(a.g)(n.Root,void 0!==c);var l=e.uf.findWithDescriptor(ve(e,c)),d=l[0];return be(e,l[1],d,u,s)}return be(e,t,void 0,u,s)}function ye(e,t){if(t===ie.f.Unavailable||0===t)return!1;var r=Ce(e,t);if(void 0===r)return!1;var n=null==r?void 0:r.valueType;return void 0!==n&&n!==oe.h.General&&(n!==oe.h.Currency&&n!==oe.h.Accounting||void 0!==r.currencySymbol)}function Oe(e,t,r,n){var i,a,o;if(n?r.referencedFormatCells+=1:r.allFormatCells+=1,Me.LogDNM){var s=Ce(e,t),u=n?r.enriched.referencedFormatTypes:r.enriched.allFormatTypes,c=null==s?void 0:s.valueType;if(void 0!==c&&(u[c]=(null!==(i=u[c])&&void 0!==i?i:0)+1),c===oe.h.Currency||c===oe.h.Accounting){var l=n?r.enriched.referencedCurrencyTypes:r.enriched.allCurrencyTypes,d=null==s?void 0:s.currencySymbol,f=null===(a=null==s?void 0:s.culture)||void 0===a?void 0:a.culture,p=void 0===d?"none":d===oe.f.LocaleInfo?"defaultSymbol":d+"_"+f;l[p]=(null!==(o=l[p])&&void 0!==o?o:0)+1}}}function Ce(e,t){if("number"==typeof t){var r=e.getIformat(t);return Object(se.c)(r)?r.value:void 0}return t}function Pe(e,t,r){var i=e.typeContext.types[t.index];if(void 0===i)return Object(a.a)(n.Root);var s=i.getValue(r);if(void 0===s){var u=Object(o.r)(t,r),c=e.typeContext.formats(u);if(Object(se.c)(c)){if(!ye(e.typeContext,c.value)||e.typeContext.isStringValue(u)){var l=e.symbolContext.freshSymbol().unit;return e.typeContext.types[t.index]=i.setValue(r,ee(l)),l}var d=Ne(e,c.value);return void 0===d?d=e.symbolContext.freshSymbol().unit:Oe(e.typeContext,c.value,e.stats,!0),e.typeContext.types[t.index]=i.setValue(r,ee(d)),d}var f=e.symbolContext.freshSymbol().unit;return e.typeContext.types[t.index]=i.setValue(r,ee(f)),f}return 0===s.kind?s.unit:void 0}function Ne(e,t){var r=function(e,t){var r;return null===(r=Ce(e,t))||void 0===r?void 0:r.valueType}(e.typeContext,t);if(void 0!==r)switch(r){case oe.h.Currency:case oe.h.Accounting:return fe;case oe.h.Percentage:return de;case oe.h.Date:return Me.UnitlessTimeAndDate?de:pe;case oe.h.Time:return Me.UnitlessTimeAndDate?de:me;default:return}}var Re=((te={})[2]=function(e,t){return Se(e,t.unit,t.target)},te[3]=function(e,t){var r=Ne(e,t.format);if(void 0===r)return ue;var i=Pe(e,t.cell.sheet,t.cell.range);if(void 0===i)return ue;if(!C(i))return ce(t);if(1===i.varCount){Object(a.g)(n.Root,void 0!==i.name);var o=e.symbolContext.getTable().getValue(i.name);Object(a.g)(n.Root,void 0!==o);var s=e.uf.findWithDescriptor(ve(e,o)),u=s[0];return be(e,s[1],u,r,void 0)}return be(e,i,void 0,r,void 0)},te[0]=function(e,t){var r=t.type.resolution;if(!Object(w.P)(r.sheet))return ue;if(Object(w.z)(r.range)){var n=Pe(e,r.sheet,r.range);return void 0===n?ue:Se(e,n,t.target)}var i=e.typeContext.available[r.sheet.index];if(void 0===i)return ue;var a=i.usedRange;if(void 0===a)return ue;var o=Object(w.n)(r.range,a);if(void 0===o)return ue;var s=Object(ae.g)(Object(ae.g)(Object(ne.f)(o),ne.b),i.availableCells),u=[];return Object(ne.g)(s,(function(e){return u.push(e),!0})),{kind:3,constraint:{kind:1,cursor:0,index:i.sheetIdx,cells:u,target:t.target},output:void 0}},te[1]=function(e,t){var r=t.cursor,n=t.cells;if(r>=n.length)return ue;var i=n[r],a=Pe(e,t.index,i),o=void 0===a?ue:Se(e,a,t.target);return t.cursor+=1,{kind:3,constraint:t,output:o}},te);function ke(e){return e.kind===V.SolvingSimple?e.constraintCursor===e.constraints.length?function(e){var t,r,n=e.context,i=n.apply,a=n.errorUnit,o={kind:V.SolvingFull,context:e.context,stats:e.stats,constraints:e.deferred,constraintCursor:0,unifyNF:function(e,t){var r=i(o.substitution,e);if(r!==a){var n=i(o.substitution,t);if(n!==a){var s=M(i,r,n);1!==s.kind?(o.stats.errorCount+=1,Me.LogDNM&&o.stats.enriched.errors.push({error:[i(o.substitution,e),i(o.substitution,t)]})):o.substitution=I(i,s.substitution,o.substitution)}}},substitution:(t=e.context,r=t.symbolContext.getTable(),function(e){var n=r.getValue(e);if(void 0!==n&&void 0!==n.link)return void 0===n.ufSubstitution&&(n.ufSubstitution=t.uf.findWithDescriptor(n.link)[1]),n.ufSubstitution})};return o}(e):function(e){var t=e.constraints,r=e.context,n=e.constraintCursor,i=e.deferred,a=t[n],o=Re[a.kind](r,a);switch(o.kind){case 2:i.push(o.constraint);break;case 1:e.stats.errorCount+=1,Me.LogDNM&&e.stats.enriched.errors.push({error:o.error});break;case 3:if(t[n]=o.constraint,void 0!==o.output)switch(o.output.kind){case 2:i.push(o.output.constraint);break;case 1:e.stats.errorCount+=1,Me.LogDNM&&e.stats.enriched.errors.push({error:o.output.error})}return e}return e.constraintCursor+=1,e}(e):function(e){var t=e.constraints,r=e.context,i=e.constraintCursor,o=e.unifyNF,s=t[i];switch(s.kind){case 2:o(s.unit,s.target.unit);break;case 3:var u=Ne(r,s.format);if(void 0===u)break;var c=Pe(r,s.cell.sheet,s.cell.range);if(void 0===c)break;o(u,c);break;default:return e.constraintCursor+=1,Object(a.d)(n.Root,s)}return e.constraintCursor+=1,e}(e)}var Te=r(95),Ee=r(35),_e=r(61),Fe=r(28),Ie=r(42),Ae=r(41);r.d(t,"a",(function(){return Me}));var Me=function(){function e(){this.isDone=!1,this.lastStepMessage="before started",e.IgnoreDivMul=Object(Ae.getBooleanFeatureGate)("Microsoft.Office.Excel.UnitExpIgnoreDivMul",!1),e.UnitlessTimeAndDate=Object(Ae.getBooleanFeatureGate)("Microsoft.Office.Excel.UnitlessTimeAndDate",!1),e.LogDNM=Object(Ae.getBooleanFeatureGate)("Microsoft.Office.Excel.UnitExpLogDNM",!1)}return Object.defineProperty(e.prototype,"done",{get:function(){return this.isDone},enumerable:!1,configurable:!0}),e.prototype.freshCheckingState=function(e){var t=this;this.lastStepMessage="freshCheckingState";var r=[],n={};e.getServerAvailableCells().forEach((function(a){var o,s=e.getServerUsedRange(a.sheetIdx);if(s.kind!==se.a.Success)return t.isDone=!0,void(t.statsMessage="Unit experiment: getServerUsedRange failed");var u=Object(i.__assign)(Object(i.__assign)({},a),{usedRange:null===(o=s.value)||void 0===o?void 0:o.range});n[a.sheetIdx.index]=u,r.push(u)}));var a=void 0===e.getServerDocument()?function(){return Object(se.b)(void 0)}:function(t){return e.getIformat(e.getServerDocument(),t)};return{kind:V.Checking,locale:e.config.localeInfo,mathpack:e.config.mathpack,resolver:Object(l.a)(e),documentTypeContext:{formats:function(t){return e.getServerFormat(t)},types:{},available:n,getIformat:a,isStringValue:function(t){if(void 0===e.getServerDocument())return!1;var r=e.getServerValue(t);return r.kind===se.a.Success&&r.value.oper.kind===D.b.String}},constraints:[],stats:{formulaCells:0,referencedFormatCells:0,allFormatCells:0,totalCells:0,errorCount:0,enriched:{errors:[],referencedFormatTypes:{},allFormatTypes:{},referencedCurrencyTypes:{},allCurrencyTypes:{}}},sheets:r,mutableState:{symbolContext:we.init(),ranges:void 0,cells:void 0,sheetCursor:0,rangeCursor:0,cellCursor:0}}},e.prototype.freshSolvingState=function(e){return this.lastStepMessage="freshSolvingState",{kind:V.SolvingSimple,stats:e.stats,context:he(e.mutableState.symbolContext,e.documentTypeContext,e.stats),constraints:e.constraints,constraintCursor:0,deferred:[]}},e.prototype.step=function(){if(!this.isDone){if(void 0===this.documentContext)return this.isDone=!0,Object(a.d)("".concat(n.Root,".").concat(n.Initialised),this.documentContext);void 0===this.state&&(this.state=this.freshCheckingState(this.documentContext));try{var e=this.state;switch(e.kind){case V.Checking:return e.mutableState.sheetCursor<e.sheets.length?void(this.state=this.runCheckStep(this.documentContext,e)):void(this.state=this.freshSolvingState(e));case V.SolvingSimple:return this.lastStepMessage="SolvingSimple",void(this.state=ke(e));case V.SolvingFull:return e.constraintCursor<e.constraints.length?(this.lastStepMessage="SolvingFull",void(this.state=ke(e))):(this.lastStepMessage="done SolvingFull",this.isDone=!0,void(this.statsMessage=this.statsForLogging(e.stats)))}}catch(e){return this.statsMessage="".concat(n.Root,".").concat(n.Failure,": ").concat(Object(Ee.c)(e)),void(this.isDone=!0)}}},e.prototype.setContext=function(e){var t=e.documents;this.documentContext=t},e.prototype.initialiseSheetStep=function(e){this.lastStepMessage="initialiseSheetStep";var t=e.mutableState,r=e.sheets[t.sheetCursor],n=r.usedRange,i=[];if(void 0!==n){var a=Object(ae.g)(r.availableCells,ne.b);Object(ne.i)(a,(function(e){var t=Object(w.n)(e,n);if(void 0!==t){if(Object(w.r)(t)<250)return i.push(t),!0;Object(w.e)(t,15,(function(e){return i.push(e),!0}))}return!0}))}return t.ranges=i,t.rangeCursor=0,e.documentTypeContext.types[r.sheetIdx.index]=Object(_e.a)(),e},e.prototype.initialiseRangeCells=function(e,t){this.lastStepMessage="initialiseRangeCells";var r=t.mutableState,n=t.stats,i=t.sheets,a=r.sheetCursor,s=[],u=i[a],c=r.ranges[r.rangeCursor];return e.forEachServerNonBlankCellInSet(u.sheetIdx,Object(ne.f)(c),(function(r){var i,a=Object(o.r)(u.sheetIdx,r),c=e.getServerFormula(a);c.kind===se.a.Success&&void 0!==(null===(i=c.value)||void 0===i?void 0:i[1].compiledFmla)&&(s.push(c.value[1]),n.formulaCells+=1);var l=e.getServerFormat(a);return l.kind===se.a.Success&&ye(t.documentTypeContext,l.value)&&Oe(t.documentTypeContext,l.value,n,!1),n.totalCells+=1,!0})),r.cells=s,r.cellCursor=0,t},e.prototype.checkCell=function(e,t){this.lastStepMessage="checkCell";var r=t.sheets,i=t.constraints,s=t.stats,u=t.mutableState,c=u.cells,l=u.sheetCursor,d=u.cellCursor,f=r[l],p=c[d],m=p.compiledFmla.getValue();if(m.kind===se.a.Success){var h=Object(o.r)(f.sheetIdx,p.origin),v=function(e,t,r){var i=e.constraints,o=e.locale,s=e.mathpack,u=e.resolver,c=e.documentTypeContext,l=c.types[t.sheet.index],d=e.mutableState.symbolContext.copy(),f={origin:t,locale:o,mathpack:s,resolver:u,symbolContext:d,pushConstraint:function(e){return void 0!==e&&(i.push(e),!0)}},p=function(e,t){return Object(Fe.k)(new Ke(e),t)}(f,r),m=Le(f,p),h=function e(t,r){switch(r.kind){case 0:if(void 0===r.unit){var i=t.symbolContext.freshSymbol();return j(r.flags,i.unit)}return r;case 2:for(var o=r,s=[];2===o.kind;)s.push(o.dimensions),o=o.elementType;var u=e(t,o);return s.reduceRight(L,u);case 1:case 3:return r;default:return Object(a.d)(n.Root,r)}}(f,void 0===m?Z:m);if(1===h.kind){var v=d.freshSymbol(),g={kind:0,type:h,target:v};h=ee(v.unit),i.push(g)}if(e.mutableState.symbolContext=d,2===h.kind)return l;return l.setValue(t.range,h)}(t,h,m.value);t.documentTypeContext.types[f.sheetIdx.index]=v;var g=e.getServerFormat(h);g.kind===se.a.Success&&ye(t.documentTypeContext,g.value)&&(i.push({kind:3,cell:h,format:g.value}),Oe(t.documentTypeContext,g.value,s,!0))}return t.mutableState.cellCursor+=1,t},e.prototype.runCheckStep=function(e,t){if(!function(e){return void 0!==e.mutableState.ranges}(t))return this.initialiseSheetStep(t);var r=t.mutableState;return r.rangeCursor===r.ranges.length?(r.ranges=void 0,r.sheetCursor+=1,t):function(e){return void 0!==e.mutableState.cells}(t)?r.cellCursor<t.mutableState.cells.length?this.checkCell(e,t):(r.cells=void 0,r.rangeCursor+=1,t):this.initialiseRangeCells(e,t)},e.prototype.statsForLogging=function(t){if(e.LogDNM||void 0===t)return JSON.stringify(t);var r=t.formulaCells,n=t.referencedFormatCells,i=t.totalCells,a=t.errorCount;return JSON.stringify({formulaCells:r,referencedFormatCells:n,totalCells:i,errorCount:a})},Object.defineProperty(e.prototype,"resultLogMessage",{get:function(){var e;return null!==(e=this.statsMessage)&&void 0!==e?e:"".concat(n.Root,".").concat(n.Default)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"failedLogMessage",{get:function(){var e,t,r,n,i,a=null===(e=this.state)||void 0===e?void 0:e.kind,o=(null===(t=this.state)||void 0===t?void 0:t.kind)===V.Checking&&0===(null===(r=this.state)||void 0===r?void 0:r.mutableState.cellCursor);return"Units experiment timed out. Last step: ".concat(this.lastStepMessage,". Experiment state: ").concat(void 0!==a?V[a]:"NotStarted",". isCellCursorZero: ").concat(o,". Number of constraints: ").concat(null===(n=this.state)||void 0===n?void 0:n.constraints.length,". Stats: ").concat(this.statsForLogging(null===(i=this.state)||void 0===i?void 0:i.stats))},enumerable:!1,configurable:!0}),e.IgnoreDivMul=!1,e.UnitlessTimeAndDate=!1,e.LogDNM=!1,e}(),we=function(){function e(e,t){this.seed=e,this.table=t}return e.init=function(){return new e(0,Te.a.create((function(e,t){return e.localeCompare(t)})))},e.prototype.getTable=function(){return this.table},e.prototype.freshSymbol=function(e){var t="".concat(void 0===e?"gen":e,"@").concat(this.seed+=1),r={unit:y(t),link:void 0,ufSubstitution:void 0};return this.table=this.table.setValue(t,r),r},e.prototype.copy=function(){return new e(this.seed,this.table)},e}();function De(e,t,r){switch(e.kind){case 2:if(1===e.elementType.kind)return;return r?De(e.elementType,t,!1):void 0;case 1:return{kind:0,type:e,target:t};case 0:return void 0===e.unit?void 0:{kind:2,unit:e.unit,target:t};case 3:return;default:return Object(a.d)(n.Root,e)}}function je(e,t,r){switch(t.kind){case 2:if(1===t.elementType.kind)return;return r?je(e,t.elementType,!1):void 0;case 1:var i=e.symbolContext.freshSymbol(),o={kind:0,type:t,target:i};return[i.unit,o];case 0:return void 0===t.unit?void 0:[t.unit,void 0];case 3:return;default:return Object(a.d)(n.Root,t)}}function xe(e){var t=e.length;if(0===t)return Z;for(var r,n,i=$,a=e[0].length,o=0;o<e.length;o+=1)for(var s=e[o],u=0;u<s.length;u+=1)r=i,n=s[u],i=r===$?n:n===$||r===Z?r:n===Z?n:0===r.kind&&0===n.kind&&void 0===r.unit&&void 0===n.unit?j(r.flags|n.flags):Z;return L(i,{rows:t,columns:a,exact:!0})}function Le(e,t){if(1===t.kind&&void 0===t.resolution){var r=function(e,t){var r=Object(c.k)(e.origin),n=e.resolver.resolveCellRef(r,t.reference).resolution;return!!Object(se.c)(n)&&(!n.value||n.value)}(e,t);return"object"==typeof r?function(e,t){var r=x(e);return r.resolution=t,r}(t.reference,r):r?J:void 0}if(2===t.kind){var n=Le(e,t.elementType);return void 0===n?n:n===t.elementType?t:L(n,t.dimensions)}return t}function Be(e,t,r,n,i){var a=e.symbolContext.freshSymbol(),o=De(t,a,n),s=De(r,a,n);if(void 0!==o&&void 0!==s||i&&(void 0!==o||void 0!==s))return e.pushConstraint(o),e.pushConstraint(s),a}function Ue(e,t,r){if(r.length<2)return Z;var i=Le(e,r[0][0]),o=Le(e,r[1][0]);if(void 0===i||void 0===o)return Z;var u=G(i,o);if(!1===u)return Z;var c="object"==typeof u;switch(t){case s.a.Add:case s.a.Sub:case s.a.Min:case s.a.Max:var l=Be(e,i,o,c,!0);return K(void 0===l?q:j(D.b.Number,l.unit),u);case s.a.Eq:case s.a.Ne:case s.a.Lt:case s.a.Le:case s.a.Gt:case s.a.Ge:return Be(e,i,o,c,!1),K(W,u);case s.a.Mul:case s.a.Div:if(Me.IgnoreDivMul)return q;var d=e.symbolContext.freshSymbol(),f=e.symbolContext.freshSymbol(),m=De(i,d,c),h=De(o,f,c);if(e.pushConstraint(m),e.pushConstraint(h),void 0===m&&void 0===h)return K(q,u);var v=t===s.a.Mul?N(d.unit,f.unit):N(d.unit,function(e){var t=b(),r=e.vars,i=e.consts;for(var a in r)t.vars[a]=-r[a];for(var a in i)t.consts[a]=-i[a];return t.varCount=e.varCount,p(n.Root,t),t}(f.unit));return K(j(D.b.Number,v),u);case s.a.Pow:var g=r[1][1];if(Object(w.E)(g)){var S=e.mathpack.toNumber(g.oper);if(Object(Ee.b)(S)){var y=je(e,i,"object"==typeof u);return void 0===y?K(q,u):(e.pushConstraint(y[1]),K(j(D.b.Number,function(e,t,r){if(0===t)return r;var i=b(),a=e.vars,o=e.consts;for(var s in a)i.vars[s]=a[s]*t;for(var s in o)i.consts[s]=o[s]*t;return i.varCount=e.varCount,p(n.Root,i),i}(y[0],S,z)),u))}}return Z;case s.a.Range:case s.a.Isect:case s.a.Union:return Z;case s.a.Concat:return K(H,u);case s.a.And:case s.a.Or:case s.a.Xor:return K(W,u);default:return Object(a.d)(n.Root,t)}}function Ge(e,t,r){switch(t){case s.a.Add:case s.a.Sub:case s.a.Mul:case s.a.Div:case s.a.Pow:case s.a.Eq:case s.a.Ne:case s.a.Lt:case s.a.Le:case s.a.Gt:case s.a.Ge:case s.a.Range:case s.a.Isect:case s.a.Union:case s.a.Concat:case s.a.And:case s.a.Or:case s.a.Xor:case s.a.Min:case s.a.Max:return Ue(e,t,r);case s.a.Percent:case s.a.Neg:case s.a.Pos:case s.a.At:case s.a.Pound:return function(e,t,r){if(r.length<1)return Z;var i=Le(e,r[0][0]);if(void 0===i)return Z;var o=U(i);if(!1===o)return Z;switch(t){case s.a.Percent:return K(Q,o);case s.a.Neg:case s.a.Pos:var u=je(e,i,"object"==typeof o);return void 0===u?K(q,o):(e.pushConstraint(u[1]),K(j(D.b.Number,u[0]),o));case s.a.At:case s.a.Pound:return Z;default:return Object(a.d)(n.Root,t)}}(e,t,r);default:return Object(a.d)(n.Root,t)}}var Ke=function(){function e(e){var t=this;this.context=e,this.visitFormulaNode=function(e){return Object(Fe.n)(t,e)},this.lazyVisitFormulaNode=function(e){return Ie.a.resolve(e).bind(t.visitFormulaNode)}}return e.prototype.literalNode=function(e){return Ie.a.resolve(function(e){switch(e.kind){case D.b.Number:return q;case D.b.String:return H;case D.b.Boolean:return W;case D.b.Error:return J;default:return Y}}(e))},e.prototype.arrayNode=function(e){var t=this;return Ie.a.all(e.map((function(e){return Ie.a.all(e.map(t.lazyVisitFormulaNode))}))).bind(xe)},e.prototype.appNode=function(e,t){var r=this;return e.kind===u.e.Operator?Ie.a.all(t.map((function(e){return r.lazyVisitFormulaNode(e).bind((function(t){return[t,e]}))}))).bind((function(t){return Ge(r.context,e.id,t)})):e.kind===u.e.WSF?Ie.a.all(t.map(this.lazyVisitFormulaNode)).bind((function(t){return function(e,t,r){switch(t){case s.b.SUM:case s.b.AVERAGE:case s.b.MAX:case s.b.MIN:if(0===r.length)return Z;var n=e.symbolContext.freshSymbol(),i=!0;return r.forEach((function(t){var r=Le(e,t);r&&e.pushConstraint(De(r,n,!0))&&(i=!1)})),i?q:j(D.b.Number,n.unit);case s.b.IF:if(r.length<2)return Z;var a=Le(e,r[0]),o=Le(e,r[1]),u=Le(e,void 0===r[2]?W:r[2]);if(void 0===a)return void 0!==o&&void 0!==u&&Be(e,o,u,!0,!1),Z;var c=U(a),l="object"==typeof c;if(void 0===o||void 0===u)return Z;var d=Be(e,o,u,!0,!0),f=d?ee(d.unit):X;return l?L(f,c):f;default:return Z}}(r.context,e.id,t)})):Ie.a.resolve(Z)},e.prototype.letNode=function(e,t,r,n){return Ie.a.resolve(Z)},e.prototype.lambdaNode=function(e,t,r,n){return Ie.a.resolve(Z)},e.prototype.parenNode=function(e){return this.lazyVisitFormulaNode(e)},e.prototype.nameNode=function(e,t){return Ie.a.resolve(Z)},e.prototype.cellRefNode=function(e,t){return Ie.a.resolve(x(Object(u.u)(e,t)))},e.prototype.fieldRefNode=function(e,t){return Ie.a.resolve(Z)},e.prototype.structRefNode=function(e,t){return Ie.a.resolve(Z)},e.prototype.badSequenceNode=function(e,t){return Ie.a.resolve(Z)},e.prototype.badStringNode=function(e,t){return Ie.a.resolve(Z)},e.prototype.operatorNode=function(e,t){return Ie.a.resolve(Object(u.Y)(e,t))},e.prototype.wsfNode=function(e,t,r){return Ie.a.resolve(Object(u.mb)(e,t,r))},e}()},function(e,t,r){"use strict";var n=r(24),i=r(8),a=r(4),o=r(0),s=r(11),u=r(6),c=r(9),l=r(50),d=r(33),f=r(7),p=(f.table.makeEmptyTable,f.table.entry);r.d(t,"a",(function(){return m}));var m=function(){function e(e,t,r,n,a){var d=this;this.document=e,this.stringCompareCI=t,this.sheetScopedNames=r,this.oldSheetScopedNames=n,this.onWriteNamedObject=function(e,t,r){if("NamedRange"===t.kind){var n=t.value;if(Object(c.g)("calc.calc.PartialWorkbookDocument.onWriteNamedObject: bad range",Object(u.x)(t.value.sheets.document,e.scope.document)),(i=d.getNamesBySheetId(n.sheets.index)).kind===o.a.Failure)return i;i.value.onWriteNamedRange(e,t,r)}if("NamedTable"===t.kind){var i;if((i=d.getNamesBySheetId(t.specialRefRanges[s.i.All].sheet.index)).kind===o.a.Failure)return i;i.value.onWriteNamedTable(e,t,r)}return o.f},this.globalNames=null!=a?a:new l.a(t,Object(i.e)(e))}return e.prototype.clone=function(){var t;if(this.sheetScopedNames)for(var r in t=Object(a.h)(),this.sheetScopedNames){var n=this.sheetScopedNames[r];t[r]=n.clone()}return new e(this.document,this.stringCompareCI,t,void 0,this.globalNames.clone())},e.prototype.setNamedObject=function(e,t,r,n){var a=this.getNameFormula(t,i.b.StructRef);void 0!==r&&"NamedTable"===r.kind&&Object(o.c)(a)&&void 0!==a.value&&"NamedTable"===a.value.obj.kind&&Object(l.c)(a.value.obj,r)&&(r=Object(l.e)(a.value.obj,r));var s=this.getNamesBySheetId(t.scope.index);return s.kind===o.a.Failure?s:s.value.setNamedObject(e,t,r,n,this.onWriteNamedObject)},e.prototype.setUndefinedNames=function(e){var t=this.getNamesBySheetId(e.index);return t.kind===o.a.Failure?t:Object(o.e)(t.value.setUndefinedNames())},e.prototype.promoteNamedObjects=function(e,t){var r=this.getNamesBySheetId(e.index);return r.kind===o.a.Failure?r:r.value.promoteNamedObjects(t,this.onWriteNamedObject)},e.prototype.setSheetNames=function(t){for(var r,n,o=null!==(r=this.sheetScopedNames)&&void 0!==r?r:this.oldSheetScopedNames,s=Object(a.h)(),u=0,c=t;u<c.length;u++){var d=c[u].sheetId;s[d]=null!==(n=null==o?void 0:o[d])&&void 0!==n?n:new l.a(this.stringCompareCI,Object(i.u)(this.document,d))}return new e(this.document,this.stringCompareCI,s,void 0,this.globalNames)},e.prototype.getNameLoc=function(e,t,r){var n=this.getNamesBySheetId(e);if(n.kind===o.a.Failure)return n;var i=n.value.getNameLoc(t,r);return i.kind,o.a.Failure,i},e.prototype.getAvailableNamesInScope=function(e){var t=this.getAllDocumentNames(),r=this.getNamesBySheetId(e);return r.kind===o.a.Success&&Object(a.o)(t,r.value.getAvailableNames(Object(i.o)(this.document,e))),t},e.prototype.getAllDocumentNames=function(){return this.globalNames.getAvailableNames(Object(i.e)(this.document))},e.prototype.getAvailableTableColumns=function(e){var t=this.getNameFormula(e,i.b.StructRef),r=[];return t.kind!==o.a.Success||void 0===t.value||"NamedTable"!==t.value.obj.kind||t.value.obj.columnNames.forEach((function(e){return r.push(e),!0})),r},e.prototype.getNameFormula=function(e,t){var r=this.getNamesBySheetId(e.scope.index);return r.kind===o.a.Failure?r:r.value.getNameFormula(e.name,t)},e.prototype.hasRecalcNameFailure=function(e){var t=this.getNamesBySheetId(e.scope.index);return t.kind===o.a.Failure?t:Object(o.e)(t.value.hasRecalcFailure(e.name))},e.prototype.setRecalcNameFailure=function(e){var t=this.getNamesBySheetId(e.scope.index);return t.kind===o.a.Failure?t:Object(o.e)(t.value.setRecalcFailure(e.name))},e.prototype.getNamesBySheetId=function(e){if(void 0===e)return Object(o.e)(this.globalNames);if(!this.sheetScopedNames)return Object(o.b)(Object(u.Z)([{kind:n.e.SheetNames}]));var t=this.sheetScopedNames[e];return void 0===t?Object(o.b)(Object(u.Z)([{kind:n.e.SheetId,document:this.document,sheetId:e}])):Object(o.e)(t)},e.prototype.getContainingTable=function(e){var t=this.getNamesBySheetId(e.sheet.index);return t.kind===o.a.Failure?t:Object(o.e)(t.value.getContainingTable(e.range))},e.prototype.getNamedRanges=function(e){var t=this.getNamesBySheetId(e.sheet.index);return t.kind===o.a.Failure?t:Object(o.e)(t.value.getNamedRanges(e.range))},e.prototype.getIntersectingTables=function(e){var t=this.getNamesBySheetId(e.sheet.index);return t.kind===o.a.Failure?t:Object(o.e)(t.value.getIntersectingTables(e.range))},e.prototype.getStructRefColumn=function(e,t){var r=this.getNameFormula(e,i.b.StructRef);if(r.kind===o.a.Failure)return r;if(void 0===r.value)return Object(o.e)(void 0);if("NamedTable"!==r.value.obj.kind)return Object(o.b)(Object(d.i)(d.c.NamedObjectNotTable));var a,c=r.value.obj;if("string"==typeof t)a=c.columnNames.getEntry(t);else{var l=c.columnIndexes.getValue(t);a=void 0===l?void 0:p(l,t)}if(void 0===a)return c.allColumnNamesAvailable?Object(o.e)(void 0):Object(o.b)(Object(u.Z)([{kind:n.e.ColumnName,table:e,columnNameOrIndex:t}]));var f=c.specialRefRanges[s.i.Data],m=f.sheet,h=f.range,v=Object(i.t)(m,Object(i.g)(h.row,a.value,h.rows,1));return Object(o.e)(Object(i.y)(a.key,v,c.hasHeadersRow,c.hasTotalsRow))},e.prototype.getStructRefSpecialRef=function(e,t){var r=this.getNameFormula(e,i.b.StructRef);return r.kind===o.a.Failure?r:void 0===r.value?Object(o.e)(void 0):"NamedTable"!==r.value.obj.kind?Object(o.b)(Object(d.i)(d.c.NamedObjectNotTable)):Object(o.e)(r.value.obj.specialRefRanges[t])},e.prototype.onCellModified=function(e){this.forEachSheetScope((function(t){t.onCellModified(e)})),this.globalNames.onCellModified(e)},e.prototype.collectGarbage=function(e){this.forEachSheetScope((function(t){t.collectGarbage(e)})),this.globalNames.collectGarbage(e)},e.prototype.advanceState=function(e){this.forEachSheetScope((function(t){t.advanceState(e)})),this.globalNames.advanceState(e),this.oldSheetScopedNames=this.sheetScopedNames,this.sheetScopedNames=void 0},e.prototype.resetLazyData=function(){this.forEachSheetScope((function(e){e.resetLazyData()})),this.globalNames.resetLazyData()},e.prototype.getNameStatistics=function(){var e=this.globalNames.getStatistics();return this.forEachSheetScope((function(t){return e=Object(l.d)(e,t.getStatistics())})),e},e.prototype.forEachSheetScope=function(e){for(var t in this.sheetScopedNames){if(Object.prototype.hasOwnProperty.call(this.sheetScopedNames,t))e(this.sheetScopedNames[t])}},e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.anonymizeFormulaString=t.anonymizeMagnitude=t.kindAnonymizers=t.anonymize=void 0;var n=r(207);function i(e){return e}function a(e,r){if("string"==typeof r&&null!=o[r])return e;var n=function(e){if("object"==typeof e&&null!==e){var t=e.kind;if("string"==typeof t)return t}}(e),i=void 0!==n?t.kindAnonymizers[n]:void 0;return void 0===i&&(i=s[function(e){var t=typeof e;if("object"===t){if(null===e)return"null";if(Array.isArray(e))return"Array"}return t}(e)]),void 0!==i?i(e,r):"<unexpected>"}t.anonymize=function(e){try{return String(JSON.stringify(a(e,void 0)))}catch(e){if(null==e||"object"!=typeof e)return"<error: ".concat(String(JSON.stringify(e)),">");var t=String(e.name),r=String(e.message);return r.indexOf(t)>=0?"<error ".concat(r,">"):"<error ".concat(t,": ").concat(r,">")}};var o={kind:!0,type:!0,index:!0,length:!0,row:!0,col:!0,rows:!0,cols:!0},s={boolean:i,symbol:function(e){return"symbol"!=typeof e?"<unexpected>":"<symbol ".concat(String(e),">")},undefined:i,null:i,number:function(e){return"number"!=typeof e?"<unexpected>":isFinite(e)?"<number>":e},bigint:function(e){return"bigint"!=typeof e?"<unexpected>":"<bigint>"},string:function(e){return"string"!=typeof e?"<unexpected>":e.length>0?"<string>":e},function:function(e){if("function"!=typeof e)return"<unexpected>";var t=e.name;return"string"==typeof t&&t.length>0?"<function ".concat(t,">"):"<function>"},object:function(e){if("object"!=typeof e)return"<unexpected>";var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=a(e[r],r));return t},Array:function(e){return"object"==typeof e&&Array.isArray(e)?e.map(a):"<unexpected>"}};t.kindAnonymizers=Object.create(null),t.anonymizeMagnitude=function(e){var t=Math.abs(e);return 0===t?-1e4:Math.floor((0,n.mathLog2)(t))};var u=new RegExp("[^=\\[\\]\\.\\\\\\/%@#\\-_\\+,;\\(\\):?\"&<>'!\\{\\}~\\^\\*$¢£¤¥₠₡₢₣₤₥₦₧₨₩₪₫€₭₮₯₰₱₲₳₴₵₶₷₸₹\\sꃂd]","g"),c=/[0-9]/g,l=/d/g;t.anonymizeFormulaString=function(e){return e.toLowerCase().replace(l,"w").replace(c,"d").replace(u,"w")}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.values=t.prependErrorMessage=t.messageFromError=t.partialArray=t.arrayFill=t.repeat=t.stringEndsWith=t.stringStartsWith=t.isInteger=t.mathLog2=void 0;var n=r(168),i=r(207);Object.defineProperty(t,"mathLog2",{enumerable:!0,get:function(){return i.mathLog2}}),t.isInteger=function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},t.stringStartsWith=function(e,t,r){return void 0===r&&(r=0),r+t.length<=e.length&&e.substring(r,r+t.length)===t},t.stringEndsWith=function(e,t){return t.length<=e.length&&e.substring(e.length-t.length,e.length)===t},t.repeat=function(e,t){return Array(t+1).join(e)},t.arrayFill=function(e,t){for(var r=0;r<e.length;r+=1)e[r]=t;return e},t.partialArray=function(e){var t=[];return Object.keys(e).map(Number).forEach((function(r){return t[r]=e[r]})),t},t.messageFromError=function(e){if(null==e||"object"!=typeof e)return(0,n.anonymize)(e);var t=e,r=String(t.name),i=String(t.message);if(null!=t.stack){var a=String(t.stack);return a.indexOf(i)>=0&&a.indexOf(r)>=0?a:"".concat(r,": ").concat(i,"\n").concat(a)}return i.indexOf(r)>=0?i:"".concat(r,": ").concat(i)},t.prependErrorMessage=function(e,t){if(null==e||"object"!=typeof e)return e;var r=e;return r.message="".concat(t," ").concat(String(r.message)),r},t.values=function(e){var t=[];for(var r in e)Object.hasOwnProperty.call(e,r)&&t.push(e[r]);return t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFeatureGateDictionaryGetter=t.getIntFeatureGate=t.getNumberFeatureGate=t.getBooleanFeatureGate=t.getStringFeatureGate=t.getFeatureGateDictionary=void 0;var n=r(208),i={};function a(){return"undefined"==typeof __get_feature_gate_dictionary_variable?i:__get_feature_gate_dictionary_variable()}function o(e,t){var r;return null!==(r=a()[e])&&void 0!==r?r:t}t.getFeatureGateDictionary=a,t.getStringFeatureGate=o,t.getBooleanFeatureGate=function(e,t){var r,n=null===(r=o(e))||void 0===r?void 0:r.trim().toLowerCase();return"true"===n||"false"!==n&&t},t.getNumberFeatureGate=function(e,t){var r,n=null===(r=o(e))||void 0===r?void 0:r.trim().toLowerCase();if(void 0===n)return t;if("infinity"===n||"+infinity"===n)return 1/0;if("-infinity"===n)return-1/0;var i=parseFloat(n);return isNaN(i)?t:i},t.getIntFeatureGate=function(e,t){var r,n=null===(r=o(e))||void 0===r?void 0:r.trim();if(void 0===n)return t;var i=parseInt(n,10);return isNaN(i)?t:i},t.setFeatureGateDictionaryGetter=function(e){var t=n.globalThis.__get_feature_gate_dictionary_variable;return n.globalThis.__get_feature_gate_dictionary_variable=e,t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setChangeGateDictionaryGetter=t.isChangeGateEnabled=t.getChangeGateDictionary=void 0;var n=r(208);function i(){return"undefined"==typeof __get_change_gate_dictionary_variable?null:__get_change_gate_dictionary_variable()}t.getChangeGateDictionary=i,t.isChangeGateEnabled=function(e){var t,r=i();return null!==r&&(null===(t=r[e])||void 0===t||t)},t.setChangeGateDictionaryGetter=function(e){var t=n.globalThis.__get_change_gate_dictionary_variable;return n.globalThis.__get_change_gate_dictionary_variable=e,t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logCollision=void 0;var n=r(18),i=r(101),a={},o=0;t.logCollision=function(e){var t=a[e];a[e]=(void 0===t?0:t)+1,(o+=1)%100==0&&(i.ulsLogger.ULS.traceTag(595858520,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"calc.common.hashUtils.logCollision: ".concat(JSON.stringify(a),".")),a={})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.collapseThenable=t.bindMaybeThenable=t.isThenable=t.promiseLoop=t.newPromise=t.promiseFinally=void 0;var n=r(74);function i(e){return(0,n.isDefined)(e)&&"function"==typeof e.then}t.promiseFinally=function(e,t){return e.then((function(e){return t(),e}),(function(e){return t(),Promise.reject(e)}))},t.newPromise=function(){var e;return[new Promise((function(t,r){return e=[t,r]})),e]},t.promiseLoop=function(e,t){var r;return new Promise((function(n,i){Promise.resolve(t).then((function t(a){if(void 0!==a){r=a;try{Promise.resolve(e(r)).then(t,i)}catch(e){i(e)}}else n(r)}),i)}))},t.isThenable=i,t.bindMaybeThenable=function(e,t,r){return i(e)?e.then(t,r):t(e)},t.collapseThenable=function(e){return e}},function(e,t,r){"use strict";var n,i;function a(e){return{kind:n.Success,value:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.javaScriptError=t.ReasonKind=t.isSuccess=t.failure=t.successUndefined=t.success=t.ResultKind=void 0,function(e){e.Success="Success",e.Failure="Failure",e.Paused="Paused",e.Breaked="Breaked"}(n=t.ResultKind||(t.ResultKind={})),t.success=a,t.successUndefined=a(void 0),t.failure=function(e){return{kind:n.Failure,reason:e}},t.isSuccess=function(e){return e.kind===n.Success},function(e){e.JavaScriptError="JavaScriptError"}(i=t.ReasonKind||(t.ReasonKind={})),t.javaScriptError=function(e){return{kind:i.JavaScriptError,error:e}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.worksheetFuncTypes=t.worksheetFuncEnglishNames=t.WorksheetFuncId=void 0;var n=r(96);!function(e){e[e.COUNT=0]="COUNT",e[e.IF=1]="IF",e[e.ISNA=2]="ISNA",e[e.ISERROR=3]="ISERROR",e[e.SUM=4]="SUM",e[e.AVERAGE=5]="AVERAGE",e[e.MIN=6]="MIN",e[e.MAX=7]="MAX",e[e.ROW=8]="ROW",e[e.COLUMN=9]="COLUMN",e[e.NA=10]="NA",e[e.NPV=11]="NPV",e[e.STDEV=12]="STDEV",e[e.DOLLAR=13]="DOLLAR",e[e.FIXED=14]="FIXED",e[e.SIN=15]="SIN",e[e.COS=16]="COS",e[e.TAN=17]="TAN",e[e.ATAN=18]="ATAN",e[e.PI=19]="PI",e[e.SQRT=20]="SQRT",e[e.EXP=21]="EXP",e[e.LN=22]="LN",e[e.LOG10=23]="LOG10",e[e.ABS=24]="ABS",e[e.INT=25]="INT",e[e.SIGN=26]="SIGN",e[e.ROUND=27]="ROUND",e[e.LOOKUP=28]="LOOKUP",e[e.INDEX=29]="INDEX",e[e.REPT=30]="REPT",e[e.MID=31]="MID",e[e.LEN=32]="LEN",e[e.VALUE=33]="VALUE",e[e.TRUE=34]="TRUE",e[e.FALSE=35]="FALSE",e[e.AND=36]="AND",e[e.OR=37]="OR",e[e.NOT=38]="NOT",e[e.MOD=39]="MOD",e[e.DCOUNT=40]="DCOUNT",e[e.DSUM=41]="DSUM",e[e.DAVERAGE=42]="DAVERAGE",e[e.DMIN=43]="DMIN",e[e.DMAX=44]="DMAX",e[e.DSTDEV=45]="DSTDEV",e[e.VAR=46]="VAR",e[e.DVAR=47]="DVAR",e[e.TEXT=48]="TEXT",e[e.LINEST=49]="LINEST",e[e.TREND=50]="TREND",e[e.LOGEST=51]="LOGEST",e[e.GROWTH=52]="GROWTH",e[e.GOTO=53]="GOTO",e[e.HALT=54]="HALT",e[e.RETURN=55]="RETURN",e[e.PV=56]="PV",e[e.FV=57]="FV",e[e.NPER=58]="NPER",e[e.PMT=59]="PMT",e[e.RATE=60]="RATE",e[e.MIRR=61]="MIRR",e[e.IRR=62]="IRR",e[e.RAND=63]="RAND",e[e.MATCH=64]="MATCH",e[e.DATE=65]="DATE",e[e.TIME=66]="TIME",e[e.DAY=67]="DAY",e[e.MONTH=68]="MONTH",e[e.YEAR=69]="YEAR",e[e.WEEKDAY=70]="WEEKDAY",e[e.HOUR=71]="HOUR",e[e.MINUTE=72]="MINUTE",e[e.SECOND=73]="SECOND",e[e.NOW=74]="NOW",e[e.AREAS=75]="AREAS",e[e.ROWS=76]="ROWS",e[e.COLUMNS=77]="COLUMNS",e[e.OFFSET=78]="OFFSET",e[e.ABSREF=79]="ABSREF",e[e.RELREF=80]="RELREF",e[e.ARGUMENT=81]="ARGUMENT",e[e.SEARCH=82]="SEARCH",e[e.TRANSPOSE=83]="TRANSPOSE",e[e.ERROR=84]="ERROR",e[e.STEP=85]="STEP",e[e.TYPE=86]="TYPE",e[e.ECHO=87]="ECHO",e[e.SET_NAME=88]="SET_NAME",e[e.CALLER=89]="CALLER",e[e.DEREF=90]="DEREF",e[e.WINDOWS=91]="WINDOWS",e[e.SERIES=92]="SERIES",e[e.DOCUMENTS=93]="DOCUMENTS",e[e.ACTIVE_CELL=94]="ACTIVE_CELL",e[e.SELECTION=95]="SELECTION",e[e.RESULT=96]="RESULT",e[e.ATAN2=97]="ATAN2",e[e.ASIN=98]="ASIN",e[e.ACOS=99]="ACOS",e[e.CHOOSE=100]="CHOOSE",e[e.HLOOKUP=101]="HLOOKUP",e[e.VLOOKUP=102]="VLOOKUP",e[e.LINKS=103]="LINKS",e[e.INPUT=104]="INPUT",e[e.ISREF=105]="ISREF",e[e.GET_FORMULA=106]="GET_FORMULA",e[e.GET_NAME=107]="GET_NAME",e[e.SET_VALUE=108]="SET_VALUE",e[e.LOG=109]="LOG",e[e.EXEC=110]="EXEC",e[e.CHAR=111]="CHAR",e[e.LOWER=112]="LOWER",e[e.UPPER=113]="UPPER",e[e.PROPER=114]="PROPER",e[e.LEFT=115]="LEFT",e[e.RIGHT=116]="RIGHT",e[e.EXACT=117]="EXACT",e[e.TRIM=118]="TRIM",e[e.REPLACE=119]="REPLACE",e[e.SUBSTITUTE=120]="SUBSTITUTE",e[e.CODE=121]="CODE",e[e.NAMES=122]="NAMES",e[e.DIRECTORY=123]="DIRECTORY",e[e.FIND=124]="FIND",e[e.CELL=125]="CELL",e[e.ISERR=126]="ISERR",e[e.ISTEXT=127]="ISTEXT",e[e.ISNUMBER=128]="ISNUMBER",e[e.ISBLANK=129]="ISBLANK",e[e.T=130]="T",e[e.N=131]="N",e[e.FOPEN=132]="FOPEN",e[e.FCLOSE=133]="FCLOSE",e[e.FSIZE=134]="FSIZE",e[e.FREADLN=135]="FREADLN",e[e.FREAD=136]="FREAD",e[e.FWRITELN=137]="FWRITELN",e[e.FWRITE=138]="FWRITE",e[e.FPOS=139]="FPOS",e[e.DATEVALUE=140]="DATEVALUE",e[e.TIMEVALUE=141]="TIMEVALUE",e[e.SLN=142]="SLN",e[e.SYD=143]="SYD",e[e.DDB=144]="DDB",e[e.GET_DEF=145]="GET_DEF",e[e.REFTEXT=146]="REFTEXT",e[e.TEXTREF=147]="TEXTREF",e[e.INDIRECT=148]="INDIRECT",e[e.REGISTER=149]="REGISTER",e[e.CALL=150]="CALL",e[e.ADD_BAR=151]="ADD_BAR",e[e.ADD_MENU=152]="ADD_MENU",e[e.ADD_COMMAND=153]="ADD_COMMAND",e[e.ENABLE_COMMAND=154]="ENABLE_COMMAND",e[e.CHECK_COMMAND=155]="CHECK_COMMAND",e[e.RENAME_COMMAND=156]="RENAME_COMMAND",e[e.SHOW_BAR=157]="SHOW_BAR",e[e.DELETE_MENU=158]="DELETE_MENU",e[e.DELETE_COMMAND=159]="DELETE_COMMAND",e[e.GET_CHART_ITEM=160]="GET_CHART_ITEM",e[e.DIALOG_BOX=161]="DIALOG_BOX",e[e.CLEAN=162]="CLEAN",e[e.MDETERM=163]="MDETERM",e[e.MINVERSE=164]="MINVERSE",e[e.MMULT=165]="MMULT",e[e.FILES=166]="FILES",e[e.IPMT=167]="IPMT",e[e.PPMT=168]="PPMT",e[e.COUNTA=169]="COUNTA",e[e.CANCEL_KEY=170]="CANCEL_KEY",e[e.FOR=171]="FOR",e[e.WHILE=172]="WHILE",e[e.BREAK=173]="BREAK",e[e.NEXT=174]="NEXT",e[e.INITIATE=175]="INITIATE",e[e.REQUEST=176]="REQUEST",e[e.POKE=177]="POKE",e[e.EXECUTE=178]="EXECUTE",e[e.TERMINATE=179]="TERMINATE",e[e.RESTART=180]="RESTART",e[e.HELP=181]="HELP",e[e.GET_BAR=182]="GET_BAR",e[e.PRODUCT=183]="PRODUCT",e[e.FACT=184]="FACT",e[e.GET_CELL=185]="GET_CELL",e[e.GET_WORKSPACE=186]="GET_WORKSPACE",e[e.GET_WINDOW=187]="GET_WINDOW",e[e.GET_DOCUMENT=188]="GET_DOCUMENT",e[e.DPRODUCT=189]="DPRODUCT",e[e.ISNONTEXT=190]="ISNONTEXT",e[e.GET_NOTE=191]="GET_NOTE",e[e.NOTE=192]="NOTE",e[e.STDEVP=193]="STDEVP",e[e.VARP=194]="VARP",e[e.DSTDEVP=195]="DSTDEVP",e[e.DVARP=196]="DVARP",e[e.TRUNC=197]="TRUNC",e[e.ISLOGICAL=198]="ISLOGICAL",e[e.DCOUNTA=199]="DCOUNTA",e[e.DELETE_BAR=200]="DELETE_BAR",e[e.UNREGISTER=201]="UNREGISTER",e[e.USDOLLAR=204]="USDOLLAR",e[e.FINDB=205]="FINDB",e[e.SEARCHB=206]="SEARCHB",e[e.REPLACEB=207]="REPLACEB",e[e.LEFTB=208]="LEFTB",e[e.RIGHTB=209]="RIGHTB",e[e.MIDB=210]="MIDB",e[e.LENB=211]="LENB",e[e.ROUNDUP=212]="ROUNDUP",e[e.ROUNDDOWN=213]="ROUNDDOWN",e[e.ASC=214]="ASC",e[e.DBCS=215]="DBCS",e[e.RANK=216]="RANK",e[e.ADDRESS=219]="ADDRESS",e[e.DAYS360=220]="DAYS360",e[e.TODAY=221]="TODAY",e[e.VDB=222]="VDB",e[e.ELSE=223]="ELSE",e[e.ELSE_IF=224]="ELSE_IF",e[e.END_IF=225]="END_IF",e[e.FOR_CELL=226]="FOR_CELL",e[e.MEDIAN=227]="MEDIAN",e[e.SUMPRODUCT=228]="SUMPRODUCT",e[e.SINH=229]="SINH",e[e.COSH=230]="COSH",e[e.TANH=231]="TANH",e[e.ASINH=232]="ASINH",e[e.ACOSH=233]="ACOSH",e[e.ATANH=234]="ATANH",e[e.DGET=235]="DGET",e[e.CREATE_OBJECT=236]="CREATE_OBJECT",e[e.VOLATILE=237]="VOLATILE",e[e.LAST_ERROR=238]="LAST_ERROR",e[e.CUSTOM_UNDO=239]="CUSTOM_UNDO",e[e.CUSTOM_REPEAT=240]="CUSTOM_REPEAT",e[e.FORMULA_CONVERT=241]="FORMULA_CONVERT",e[e.GET_LINK_INFO=242]="GET_LINK_INFO",e[e.TEXT_BOX=243]="TEXT_BOX",e[e.INFO=244]="INFO",e[e.GROUP=245]="GROUP",e[e.GET_OBJECT=246]="GET_OBJECT",e[e.DB=247]="DB",e[e.PAUSE=248]="PAUSE",e[e.RESUME=251]="RESUME",e[e.FREQUENCY=252]="FREQUENCY",e[e.ADD_TOOLBAR=253]="ADD_TOOLBAR",e[e.DELETE_TOOLBAR=254]="DELETE_TOOLBAR",e[e._UDF=255]="_UDF",e[e.RESET_TOOLBAR=256]="RESET_TOOLBAR",e[e.EVALUATE=257]="EVALUATE",e[e.GET_TOOLBAR=258]="GET_TOOLBAR",e[e.GET_TOOL=259]="GET_TOOL",e[e.SPELLING_CHECK=260]="SPELLING_CHECK",e[e.ERROR_TYPE=261]="ERROR_TYPE",e[e.APP_TITLE=262]="APP_TITLE",e[e.WINDOW_TITLE=263]="WINDOW_TITLE",e[e.SAVE_TOOLBAR=264]="SAVE_TOOLBAR",e[e.ENABLE_TOOL=265]="ENABLE_TOOL",e[e.PRESS_TOOL=266]="PRESS_TOOL",e[e.REGISTER_ID=267]="REGISTER_ID",e[e.GET_PROJECT=268]="GET_PROJECT",e[e.AVEDEV=269]="AVEDEV",e[e.BETADIST=270]="BETADIST",e[e.GAMMALN=271]="GAMMALN",e[e.BETAINV=272]="BETAINV",e[e.BINOMDIST=273]="BINOMDIST",e[e.CHIDIST=274]="CHIDIST",e[e.CHIINV=275]="CHIINV",e[e.COMBIN=276]="COMBIN",e[e.CONFIDENCE=277]="CONFIDENCE",e[e.CRITBINOM=278]="CRITBINOM",e[e.EVEN=279]="EVEN",e[e.EXPONDIST=280]="EXPONDIST",e[e.FDIST=281]="FDIST",e[e.FINV=282]="FINV",e[e.FISHER=283]="FISHER",e[e.FISHERINV=284]="FISHERINV",e[e.FLOOR=285]="FLOOR",e[e.GAMMADIST=286]="GAMMADIST",e[e.GAMMAINV=287]="GAMMAINV",e[e.CEILING=288]="CEILING",e[e.HYPGEOMDIST=289]="HYPGEOMDIST",e[e.LOGNORMDIST=290]="LOGNORMDIST",e[e.LOGINV=291]="LOGINV",e[e.NEGBINOMDIST=292]="NEGBINOMDIST",e[e.NORMDIST=293]="NORMDIST",e[e.NORMSDIST=294]="NORMSDIST",e[e.NORMINV=295]="NORMINV",e[e.NORMSINV=296]="NORMSINV",e[e.STANDARDIZE=297]="STANDARDIZE",e[e.ODD=298]="ODD",e[e.PERMUT=299]="PERMUT",e[e.POISSON=300]="POISSON",e[e.TDIST=301]="TDIST",e[e.WEIBULL=302]="WEIBULL",e[e.SUMXMY2=303]="SUMXMY2",e[e.SUMX2MY2=304]="SUMX2MY2",e[e.SUMX2PY2=305]="SUMX2PY2",e[e.CHITEST=306]="CHITEST",e[e.CORREL=307]="CORREL",e[e.COVAR=308]="COVAR",e[e.FORECAST=309]="FORECAST",e[e.FTEST=310]="FTEST",e[e.INTERCEPT=311]="INTERCEPT",e[e.PEARSON=312]="PEARSON",e[e.RSQ=313]="RSQ",e[e.STEYX=314]="STEYX",e[e.SLOPE=315]="SLOPE",e[e.TTEST=316]="TTEST",e[e.PROB=317]="PROB",e[e.DEVSQ=318]="DEVSQ",e[e.GEOMEAN=319]="GEOMEAN",e[e.HARMEAN=320]="HARMEAN",e[e.SUMSQ=321]="SUMSQ",e[e.KURT=322]="KURT",e[e.SKEW=323]="SKEW",e[e.ZTEST=324]="ZTEST",e[e.LARGE=325]="LARGE",e[e.SMALL=326]="SMALL",e[e.QUARTILE=327]="QUARTILE",e[e.PERCENTILE=328]="PERCENTILE",e[e.PERCENTRANK=329]="PERCENTRANK",e[e.MODE=330]="MODE",e[e.TRIMMEAN=331]="TRIMMEAN",e[e.TINV=332]="TINV",e[e.MOVIE_COMMAND=334]="MOVIE_COMMAND",e[e.GET_MOVIE=335]="GET_MOVIE",e[e.CONCATENATE=336]="CONCATENATE",e[e.POWER=337]="POWER",e[e.SPREADBASE_DATA_FIELD=338]="SPREADBASE_DATA_FIELD",e[e.GET_VIEW=339]="GET_VIEW",e[e.GET_FIELD=340]="GET_FIELD",e[e.GET_ITEM=341]="GET_ITEM",e[e.RADIANS=342]="RADIANS",e[e.DEGREES=343]="DEGREES",e[e.SUBTOTAL=344]="SUBTOTAL",e[e.SUMIF=345]="SUMIF",e[e.COUNTIF=346]="COUNTIF",e[e.COUNTBLANK=347]="COUNTBLANK",e[e.SCENARIO_GET=348]="SCENARIO_GET",e[e.OPTIONS_LISTS=349]="OPTIONS_LISTS",e[e.ISPMT=350]="ISPMT",e[e.DATEDIF=351]="DATEDIF",e[e.DATESTRING=352]="DATESTRING",e[e.NUMBERSTRING=353]="NUMBERSTRING",e[e.ROMAN=354]="ROMAN",e[e.OPENDIALOG=355]="OPENDIALOG",e[e.SAVEDIALOG=356]="SAVEDIALOG",e[e.VIEW_GET=357]="VIEW_GET",e[e.GETPIVOTDATA=358]="GETPIVOTDATA",e[e.HYPERLINK=359]="HYPERLINK",e[e.FURIGANA=360]="FURIGANA",e[e.AVERAGEA=361]="AVERAGEA",e[e.MAXA=362]="MAXA",e[e.MINA=363]="MINA",e[e.STDEVPA=364]="STDEVPA",e[e.VARPA=365]="VARPA",e[e.STDEVA=366]="STDEVA",e[e.VARA=367]="VARA",e[e.BAHTTEXT=368]="BAHTTEXT",e[e.THAIDOW=369]="THAIDOW",e[e.THAIDIGIT=370]="THAIDIGIT",e[e.THAIMOY=371]="THAIMOY",e[e.THAINUMSOUND=372]="THAINUMSOUND",e[e.THAINUMSTRING=373]="THAINUMSTRING",e[e.THAISTRINGLENGTH=374]="THAISTRINGLENGTH",e[e.ISTHAIDIGIT=375]="ISTHAIDIGIT",e[e.ROUNDBAHTDOWN=376]="ROUNDBAHTDOWN",e[e.ROUNDBAHTUP=377]="ROUNDBAHTUP",e[e.THAIYEAR=378]="THAIYEAR",e[e.RTD=379]="RTD",e[e.CUBEVALUE=380]="CUBEVALUE",e[e.CUBEMEMBER=381]="CUBEMEMBER",e[e.CUBEMEMBERPROPERTY=382]="CUBEMEMBERPROPERTY",e[e.CUBERANKEDMEMBER=383]="CUBERANKEDMEMBER",e[e.HEX2BIN=384]="HEX2BIN",e[e.HEX2DEC=385]="HEX2DEC",e[e.HEX2OCT=386]="HEX2OCT",e[e.DEC2BIN=387]="DEC2BIN",e[e.DEC2HEX=388]="DEC2HEX",e[e.DEC2OCT=389]="DEC2OCT",e[e.OCT2BIN=390]="OCT2BIN",e[e.OCT2HEX=391]="OCT2HEX",e[e.OCT2DEC=392]="OCT2DEC",e[e.BIN2DEC=393]="BIN2DEC",e[e.BIN2OCT=394]="BIN2OCT",e[e.BIN2HEX=395]="BIN2HEX",e[e.IMSUB=396]="IMSUB",e[e.IMDIV=397]="IMDIV",e[e.IMPOWER=398]="IMPOWER",e[e.IMABS=399]="IMABS",e[e.IMSQRT=400]="IMSQRT",e[e.IMLN=401]="IMLN",e[e.IMLOG2=402]="IMLOG2",e[e.IMLOG10=403]="IMLOG10",e[e.IMSIN=404]="IMSIN",e[e.IMCOS=405]="IMCOS",e[e.IMEXP=406]="IMEXP",e[e.IMARGUMENT=407]="IMARGUMENT",e[e.IMCONJUGATE=408]="IMCONJUGATE",e[e.IMAGINARY=409]="IMAGINARY",e[e.IMREAL=410]="IMREAL",e[e.COMPLEX=411]="COMPLEX",e[e.IMSUM=412]="IMSUM",e[e.IMPRODUCT=413]="IMPRODUCT",e[e.SERIESSUM=414]="SERIESSUM",e[e.FACTDOUBLE=415]="FACTDOUBLE",e[e.SQRTPI=416]="SQRTPI",e[e.QUOTIENT=417]="QUOTIENT",e[e.DELTA=418]="DELTA",e[e.GESTEP=419]="GESTEP",e[e.ISEVEN=420]="ISEVEN",e[e.ISODD=421]="ISODD",e[e.MROUND=422]="MROUND",e[e.ERF=423]="ERF",e[e.ERFC=424]="ERFC",e[e.BESSELJ=425]="BESSELJ",e[e.BESSELK=426]="BESSELK",e[e.BESSELY=427]="BESSELY",e[e.BESSELI=428]="BESSELI",e[e.XIRR=429]="XIRR",e[e.XNPV=430]="XNPV",e[e.PRICEMAT=431]="PRICEMAT",e[e.YIELDMAT=432]="YIELDMAT",e[e.INTRATE=433]="INTRATE",e[e.RECEIVED=434]="RECEIVED",e[e.DISC=435]="DISC",e[e.PRICEDISC=436]="PRICEDISC",e[e.YIELDDISC=437]="YIELDDISC",e[e.TBILLEQ=438]="TBILLEQ",e[e.TBILLPRICE=439]="TBILLPRICE",e[e.TBILLYIELD=440]="TBILLYIELD",e[e.PRICE=441]="PRICE",e[e.YIELD=442]="YIELD",e[e.DOLLARDE=443]="DOLLARDE",e[e.DOLLARFR=444]="DOLLARFR",e[e.NOMINAL=445]="NOMINAL",e[e.EFFECT=446]="EFFECT",e[e.CUMPRINC=447]="CUMPRINC",e[e.CUMIPMT=448]="CUMIPMT",e[e.EDATE=449]="EDATE",e[e.EOMONTH=450]="EOMONTH",e[e.YEARFRAC=451]="YEARFRAC",e[e.COUPDAYBS=452]="COUPDAYBS",e[e.COUPDAYS=453]="COUPDAYS",e[e.COUPDAYSNC=454]="COUPDAYSNC",e[e.COUPNCD=455]="COUPNCD",e[e.COUPNUM=456]="COUPNUM",e[e.COUPPCD=457]="COUPPCD",e[e.DURATION=458]="DURATION",e[e.MDURATION=459]="MDURATION",e[e.ODDLPRICE=460]="ODDLPRICE",e[e.ODDLYIELD=461]="ODDLYIELD",e[e.ODDFPRICE=462]="ODDFPRICE",e[e.ODDFYIELD=463]="ODDFYIELD",e[e.RANDBETWEEN=464]="RANDBETWEEN",e[e.WEEKNUM=465]="WEEKNUM",e[e.AMORDEGRC=466]="AMORDEGRC",e[e.AMORLINC=467]="AMORLINC",e[e.CONVERT=468]="CONVERT",e[e.ACCRINT=469]="ACCRINT",e[e.ACCRINTM=470]="ACCRINTM",e[e.WORKDAY=471]="WORKDAY",e[e.NETWORKDAYS=472]="NETWORKDAYS",e[e.GCD=473]="GCD",e[e.MULTINOMIAL=474]="MULTINOMIAL",e[e.LCM=475]="LCM",e[e.FVSCHEDULE=476]="FVSCHEDULE",e[e.CUBEKPIMEMBER=477]="CUBEKPIMEMBER",e[e.CUBESET=478]="CUBESET",e[e.CUBESETCOUNT=479]="CUBESETCOUNT",e[e.IFERROR=480]="IFERROR",e[e.COUNTIFS=481]="COUNTIFS",e[e.SUMIFS=482]="SUMIFS",e[e.AVERAGEIF=483]="AVERAGEIF",e[e.AVERAGEIFS=484]="AVERAGEIFS",e[e.AGGREGATE=485]="AGGREGATE",e[e.BINOM_DIST=486]="BINOM_DIST",e[e.BINOM_INV=487]="BINOM_INV",e[e.CONFIDENCE_NORM=488]="CONFIDENCE_NORM",e[e.CONFIDENCE_T=489]="CONFIDENCE_T",e[e.CHISQ_TEST=490]="CHISQ_TEST",e[e.F_TEST=491]="F_TEST",e[e.COVARIANCE_P=492]="COVARIANCE_P",e[e.COVARIANCE_S=493]="COVARIANCE_S",e[e.EXPON_DIST=494]="EXPON_DIST",e[e.GAMMA_DIST=495]="GAMMA_DIST",e[e.GAMMA_INV=496]="GAMMA_INV",e[e.MODE_MULT=497]="MODE_MULT",e[e.MODE_SNGL=498]="MODE_SNGL",e[e.NORM_DIST=499]="NORM_DIST",e[e.NORM_INV=500]="NORM_INV",e[e.PERCENTILE_EXC=501]="PERCENTILE_EXC",e[e.PERCENTILE_INC=502]="PERCENTILE_INC",e[e.PERCENTRANK_EXC=503]="PERCENTRANK_EXC",e[e.PERCENTRANK_INC=504]="PERCENTRANK_INC",e[e.POISSON_DIST=505]="POISSON_DIST",e[e.QUARTILE_EXC=506]="QUARTILE_EXC",e[e.QUARTILE_INC=507]="QUARTILE_INC",e[e.RANK_AVG=508]="RANK_AVG",e[e.RANK_EQ=509]="RANK_EQ",e[e.STDEV_S=510]="STDEV_S",e[e.STDEV_P=511]="STDEV_P",e[e.T_DIST=512]="T_DIST",e[e.T_DIST_2T=513]="T_DIST_2T",e[e.T_DIST_RT=514]="T_DIST_RT",e[e.T_INV=515]="T_INV",e[e.T_INV_2T=516]="T_INV_2T",e[e.VAR_S=517]="VAR_S",e[e.VAR_P=518]="VAR_P",e[e.WEIBULL_DIST=519]="WEIBULL_DIST",e[e.NETWORKDAYS_INTL=520]="NETWORKDAYS_INTL",e[e.WORKDAY_INTL=521]="WORKDAY_INTL",e[e.ECMA_CEILING=522]="ECMA_CEILING",e[e.ISO_CEILING=523]="ISO_CEILING",e[e.BETA_DIST=525]="BETA_DIST",e[e.BETA_INV=526]="BETA_INV",e[e.CHISQ_DIST=527]="CHISQ_DIST",e[e.CHISQ_DIST_RT=528]="CHISQ_DIST_RT",e[e.CHISQ_INV=529]="CHISQ_INV",e[e.CHISQ_INV_RT=530]="CHISQ_INV_RT",e[e.F_DIST=531]="F_DIST",e[e.F_DIST_RT=532]="F_DIST_RT",e[e.F_INV=533]="F_INV",e[e.F_INV_RT=534]="F_INV_RT",e[e.HYPGEOM_DIST=535]="HYPGEOM_DIST",e[e.LOGNORM_DIST=536]="LOGNORM_DIST",e[e.LOGNORM_INV=537]="LOGNORM_INV",e[e.NEGBINOM_DIST=538]="NEGBINOM_DIST",e[e.NORM_S_DIST=539]="NORM_S_DIST",e[e.NORM_S_INV=540]="NORM_S_INV",e[e.T_TEST=541]="T_TEST",e[e.Z_TEST=542]="Z_TEST",e[e.ERF_PRECISE=543]="ERF_PRECISE",e[e.ERFC_PRECISE=544]="ERFC_PRECISE",e[e.GAMMALN_PRECISE=545]="GAMMALN_PRECISE",e[e.CEILING_PRECISE=546]="CEILING_PRECISE",e[e.FLOOR_PRECISE=547]="FLOOR_PRECISE",e[e.ACOT=548]="ACOT",e[e.ACOTH=549]="ACOTH",e[e.COT=550]="COT",e[e.COTH=551]="COTH",e[e.CSC=552]="CSC",e[e.CSCH=553]="CSCH",e[e.SEC=554]="SEC",e[e.SECH=555]="SECH",e[e.IMTAN=556]="IMTAN",e[e.IMCOT=557]="IMCOT",e[e.IMCSC=558]="IMCSC",e[e.IMCSCH=559]="IMCSCH",e[e.IMSEC=560]="IMSEC",e[e.IMSECH=561]="IMSECH",e[e.BITAND=562]="BITAND",e[e.BITOR=563]="BITOR",e[e.BITXOR=564]="BITXOR",e[e.BITLSHIFT=565]="BITLSHIFT",e[e.BITRSHIFT=566]="BITRSHIFT",e[e.PERMUTATIONA=567]="PERMUTATIONA",e[e.COMBINA=568]="COMBINA",e[e.XOR=569]="XOR",e[e.PDURATION=570]="PDURATION",e[e.BASE=571]="BASE",e[e.DECIMAL=572]="DECIMAL",e[e.DAYS=573]="DAYS",e[e.BINOM_DIST_RANGE=574]="BINOM_DIST_RANGE",e[e.GAMMA=575]="GAMMA",e[e.SKEW_P=576]="SKEW_P",e[e.GAUSS=577]="GAUSS",e[e.PHI=578]="PHI",e[e.RRI=579]="RRI",e[e.UNICHAR=580]="UNICHAR",e[e.UNICODE=581]="UNICODE",e[e.MUNIT=582]="MUNIT",e[e.ARABIC=583]="ARABIC",e[e.ISOWEEKNUM=584]="ISOWEEKNUM",e[e.NUMBERVALUE=585]="NUMBERVALUE",e[e.SHEET=586]="SHEET",e[e.SHEETS=587]="SHEETS",e[e.FORMULATEXT=588]="FORMULATEXT",e[e.ISFORMULA=589]="ISFORMULA",e[e.IFNA=590]="IFNA",e[e.CEILING_MATH=591]="CEILING_MATH",e[e.FLOOR_MATH=592]="FLOOR_MATH",e[e.IMSINH=593]="IMSINH",e[e.IMCOSH=594]="IMCOSH",e[e.FILTERXML=595]="FILTERXML",e[e.WEBSERVICE=596]="WEBSERVICE",e[e.ENCODEURL=597]="ENCODEURL",e[e.FORECAST_ETS=598]="FORECAST_ETS",e[e.FORECAST_ETS_CONFINT=599]="FORECAST_ETS_CONFINT",e[e.FORECAST_ETS_SEASONALITY=600]="FORECAST_ETS_SEASONALITY",e[e.FORECAST_LINEAR=601]="FORECAST_LINEAR",e[e.FORECAST_ETS_STAT=602]="FORECAST_ETS_STAT",e[e.MAXIFS=603]="MAXIFS",e[e.MINIFS=604]="MINIFS",e[e.TEXTJOIN=605]="TEXTJOIN",e[e.CONCAT=606]="CONCAT",e[e.IFS=607]="IFS",e[e.SWITCH=608]="SWITCH",e[e.SINGLE=609]="SINGLE",e[e.AVERAGE_WEIGHTED=610]="AVERAGE_WEIGHTED",e[e.ANCHORARRAY=611]="ANCHORARRAY",e[e._FV=612]="_FV",e[e.FIELDVALUE=613]="FIELDVALUE",e[e.FILTER=614]="FILTER",e[e.SORT=615]="SORT",e[e.UNIQUE=616]="UNIQUE",e[e.RICHSEARCH=617]="RICHSEARCH",e[e.LARGEPROPERTY=618]="LARGEPROPERTY",e[e.SMALLPROPERTY=619]="SMALLPROPERTY",e[e.AVERAGEPROPERTY=620]="AVERAGEPROPERTY",e[e.FINDN=621]="FINDN",e[e.TEXTSLICE=622]="TEXTSLICE",e[e.TEXTBEFORE=623]="TEXTBEFORE",e[e.TEXTAFTER=624]="TEXTAFTER",e[e.TEXTSPLIT=625]="TEXTSPLIT",e[e._SORT=626]="_SORT",e[e._ONEDARRAY=627]="_ONEDARRAY",e[e.XMATCH=628]="XMATCH",e[e.XLOOKUP=629]="XLOOKUP",e[e.SORTBY=630]="SORTBY",e[e.RANDARRAY=631]="RANDARRAY",e[e.SEQUENCE=632]="SEQUENCE",e[e.STOCKHISTORY=633]="STOCKHISTORY",e[e.WRAPROWS=634]="WRAPROWS",e[e.VSTACK=635]="VSTACK",e[e.HSTACK=636]="HSTACK",e[e.CHOOSEROWS=637]="CHOOSEROWS",e[e.CHOOSECOLS=638]="CHOOSECOLS",e[e.LET=639]="LET",e[e.LAMBDA=640]="LAMBDA",e[e.MAKEARRAY=641]="MAKEARRAY",e[e.APPLY=642]="APPLY",e[e.ISLAMBDA=643]="ISLAMBDA",e[e.ARITY=644]="ARITY",e[e.RECURSE=645]="RECURSE",e[e.VALUETOTEXT=647]="VALUETOTEXT",e[e.ARRAYTOTEXT=648]="ARRAYTOTEXT",e[e.FORMATTEDNUMBER=649]="FORMATTEDNUMBER",e[e.TOCOL=650]="TOCOL",e[e.TOROW=651]="TOROW",e[e.WRAPCOLS=652]="WRAPCOLS",e[e.MAP=653]="MAP",e[e.REDUCE=654]="REDUCE",e[e.SCAN=655]="SCAN",e[e.BYROW=656]="BYROW",e[e.BYCOL=657]="BYCOL",e[e.ISOMITTED=658]="ISOMITTED",e[e.EXPAND=659]="EXPAND",e[e.TAKE=660]="TAKE",e[e.DROP=661]="DROP",e[e.PY=662]="PY",e[e.IMAGE=664]="IMAGE",e[e.PYO=665]="PYO",e[e.TESTFUNCTIONBEGIN=666]="TESTFUNCTIONBEGIN",e[e.GRF=667]="GRF",e[e.UNIT=668]="UNIT",e[e.RICHERROR=669]="RICHERROR",e[e.COUNTER=670]="COUNTER",e[e.BROKENRECORD=671]="BROKENRECORD",e[e.STREAM=672]="STREAM",e[e.GETRICHERRORS=673]="GETRICHERRORS",e[e.DBGSTAT=674]="DBGSTAT",e[e.RICHNUMBER=675]="RICHNUMBER",e[e.RICHERNUMBER=676]="RICHERNUMBER",e[e.DBGWRITE=677]="DBGWRITE",e[e.TEST=678]="TEST",e[e.AAC=679]="AAC",e[e.AWC=680]="AWC",e[e._FCN_IMAGEWEBADDRESS=681]="_FCN_IMAGEWEBADDRESS",e[e.PARSEDEXPRESSION=682]="PARSEDEXPRESSION",e[e._FCN_CONTACTAGE=683]="_FCN_CONTACTAGE",e[e._FCN_CONTACTFIRSTNAME=684]="_FCN_CONTACTFIRSTNAME",e[e._FCN_CONTACTFULLNAME=685]="_FCN_CONTACTFULLNAME",e[e._FCN_CONTACTLASTNAME=686]="_FCN_CONTACTLASTNAME",e[e._FCN_CONTACTTRANSLATENAME=687]="_FCN_CONTACTTRANSLATENAME",e[e.ARRAYVALUE=688]="ARRAYVALUE",e[e.RECORD=689]="RECORD",e[e.LETREC=750]="LETREC",e[e.NESTEDRECORD=751]="NESTEDRECORD"}(t.WorksheetFuncId||(t.WorksheetFuncId={})),t.worksheetFuncEnglishNames=[[255,"255"],[268,"GET.WORKBOOK"],[349,"OPTIONS.LISTS.GET"],[355,"OPEN.DIALOG"],[356,"SAVE.DIALOG"],[360,"PHONETIC"],[369,"THAIDAYOFWEEK"],[371,"THAIMONTHOFYEAR"],[612,"_FV"],[626,"_SORT"],[627,"_ONEDARRAY"],[681,"IMAGEWEBADDRESS"],[683,"CONTACTAGE"],[684,"CONTACTFIRSTNAME"],[685,"CONTACTFULLNAME"],[686,"CONTACTLASTNAME"],[687,"CONTACTTRANSLATENAME"]].reduce((function(e,t){return e[t[0]]=t[1],e}),[]);var i=[];t.worksheetFuncTypes=[[1,255,i,[57],i,1,0,16],[1,3,[36,831,831],i,i,823,0,0],[1,1,[15],i,i,4,0,0],[1,1,[15],i,i,4,0,0],[1,255,i,[305],i,1,0,16],[1,255,i,[49],i,1,0,16],[1,255,i,[49],i,1,0,16],[1,255,i,[49],i,1,0,16],[0,1,[16],i,i,33,0,0],[0,1,[16],i,i,33,0,0],[0,0,i,i,i,3,0,16],[2,255,[1],[49],i,1,0,16],[1,255,i,[49],i,1,0,16],[1,2,[1,1],i,i,2,0,0],[1,3,[1,65,4],i,i,2,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[0,0,i,i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[2,3,[263,48,48],i,i,263,0,0],[2,4,[48,1,1,1],i,i,311,0,0],[2,2,[2,1],i,i,2,0,0],[3,3,[2,1,1],i,i,2,0,0],[1,1,[2],i,i,1,0,0],[1,1,[7],i,i,1,0,0],[0,0,i,i,i,4,0,16],[0,0,i,i,i,4,0,16],[1,255,i,[52],i,4,0,16],[1,255,i,[52],i,4,0,16],[1,1,[4],i,i,4,0,16],[2,2,[1,1],i,i,1,0,0],[3,3,[16,83,18],i,i,1,0,0],[3,3,[16,19,18],i,i,1,0,0],[3,3,[16,19,18],i,i,1,0,0],[3,3,[16,19,18],i,i,1,0,0],[3,3,[16,19,18],i,i,1,0,0],[3,3,[16,19,18],i,i,1,0,0],[1,255,i,[49],i,1,0,16],[3,3,[16,19,18],i,i,1,0,0],[2,2,[263,2],i,i,2,0,0],[1,4,[48,112,84,84],i,i,32,0,0],[1,4,[48,112,112,84],i,i,32,0,0],[1,4,[48,112,84,84],i,i,32,0,0],[1,4,[48,112,112,84],i,i,32,0,0],[1,1,[16],i,i,512,0,2],[0,1,[4],i,i,512,0,2],[0,1,[575],i,i,512,0,2],[3,5,[1,1,1,1,1],i,i,1,0,0],[3,5,[1,1,1,1,1],i,i,1,0,0],[3,5,[1,1,1,1,1],i,i,1,0,0],[3,5,[1,1,1,1,1],i,i,1,0,0],[3,6,[1,1,1,1,1,1],i,i,1,0,0],[3,3,[48,1,1],i,i,1,0,16],[1,2,[48,1],i,i,1,0,0],[0,0,i,i,i,1,16383,0],[2,3,[263,305,17],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,2,[1,1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[0,0,i,i,i,1,16383,0],[1,1,[16],i,i,1,0,0],[1,1,[48],i,i,1,0,0],[1,1,[48],i,i,1,0,0],[3,5,[16,65,65,65,65],i,i,16,16383,0],[2,2,[2,16],i,i,16,0,2],[2,2,[16,16],i,i,2,0,2],[0,3,[66,81,16],i,i,4,0,2],[2,3,[2,2,1],i,i,1,0,0],[1,1,[39],i,i,32,0,0],[0,2,[1,24],i,i,4,0,2],[0,0,i,i,i,4,0,2],[1,1,[303],i,i,1,0,0],[0,1,[4],i,i,4,0,2],[1,2,[2,63],i,i,4,0,2],[0,0,i,i,i,50,0,2],[1,1,[16],i,i,47,0,2],[0,2,[65,66],i,i,32,0,2],[4,5,[87,117,117,1,117],i,i,4,0,0],[0,2,[1,66],i,i,32,0,2],[0,0,i,i,i,16,0,2],[0,0,i,i,i,16,0,2],[0,1,[1],i,i,4,0,2],[2,2,[1,1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[2,255,[33],[831],i,823,0,0],[3,4,[263,49,49,4],i,i,295,0,0],[3,4,[263,49,49,4],i,i,295,0,0],[0,2,[66,65],i,i,32,0,2],[1,7,[2,65,66,67,65,65,2],i,i,575,0,2],[1,1,[63],i,i,4,0,0],[1,1,[18],i,i,2,0,2],[1,2,[2,4],i,i,6,0,2],[2,2,[16,47],i,i,4,0,2],[1,2,[1,1],i,i,1,0,0],[1,4,[2,1,4,4],i,i,7,0,2],[1,1,[1],i,i,2,0,0],[1,1,[2],i,i,2,0,0],[1,1,[2],i,i,2,0,0],[1,1,[2],i,i,2,0,0],[1,2,[2,9],i,i,2,0,0],[1,2,[2,9],i,i,2,0,0],[2,2,[258,258],i,i,4,0,0],[1,1,[2],i,i,2,0,0],[4,4,[2,1,1,2],i,i,2,0,0],[3,4,[2,2,2,2],i,i,2,0,0],[1,1,[2],i,i,1,0,0],[0,3,[66,65,66],i,i,32,0,2],[0,1,[2],i,i,2,0,2],[2,3,[2,2,1],i,i,1,0,0],[1,2,[2,16],i,i,303,16383,0],[1,1,[15],i,i,4,0,0],[1,1,[143],i,i,4,0,0],[1,1,[143],i,i,4,0,0],[1,1,[143],i,i,4,0,0],[1,1,[23],i,i,2,0,0],[1,1,[23],i,i,1,0,0],[1,2,[2,1],i,i,1,0,2],[1,1,[1],i,i,1,0,2],[1,1,[1],i,i,1,0,2],[1,1,[1],i,i,2,0,2],[2,2,[1,1],i,i,2,0,2],[2,2,[1,2],i,i,1,0,2],[2,2,[1,2],i,i,1,0,2],[1,2,[1,1],i,i,1,0,2],[1,1,[3],i,i,1,0,0],[1,1,[3],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[4,4,[1,1,1,1],i,i,1,0,0],[4,5,[1,1,1,1,1],i,i,1,0,0],[1,3,[2,66,65],i,i,2,0,2],[1,2,[16,4],i,i,2,0,2],[1,2,[2,4],i,i,16,0,2],[1,2,[2,4],i,i,16,16383,0],[1,255,[2,3,66,66,66,65,67,66,67],[66],i,3,0,2],[1,255,[3],[127],i,575,0,2],[0,1,[3],i,i,1,0,2],[2,4,[3,115,83,3],i,i,1,0,2],[3,5,[3,83,115,83,3],i,i,1,0,2],[4,5,[3,3,3,4,3],i,i,4,0,2],[4,5,[3,3,3,4,3],i,i,4,0,2],[4,5,[3,3,3,3,3],i,i,4,0,2],[0,1,[3],i,i,4,0,2],[2,3,[3,3,3],i,i,4,0,2],[3,4,[3,3,3,3],i,i,4,0,2],[1,3,[1,67,66],i,i,1,0,2],[1,1,[52],i,i,36,0,2],[1,1,[2],i,i,2,0,0],[1,1,[32],i,i,1,0,0],[1,1,[32],i,i,32,0,0],[2,2,[32,32],i,i,32,0,0],[0,2,[2,2],i,i,32,0,2],[4,6,[1,1,1,1,1,1],i,i,1,0,0],[4,6,[1,1,1,1,1,1],i,i,1,0,0],[1,255,i,[121],i,1,0,16],[0,2,[1,16],i,i,4,0,2],[3,4,[2,1,1,1],i,i,512,0,2],[1,1,[4],i,i,512,0,2],[0,0,i,i,i,512,0,2],[0,0,i,i,i,512,0,2],[2,2,[2,2],i,i,1,0,2],[2,2,[1,2],i,i,32,0,2],[3,3,[1,18,18],i,i,4,0,2],[2,2,[1,2],i,i,4,0,2],[1,1,[1],i,i,4,0,2],[0,1,[1],i,i,512,0,2],[0,1,[2],i,i,4,0,2],[0,4,[3,3,3,3],i,i,3,0,2],[1,255,i,[113],i,1,0,16],[1,1,[1],i,i,1,0,0],[1,2,[1,16],i,i,47,0,2],[1,1,[1],i,i,47,0,2],[1,2,[1,2],i,i,47,0,2],[1,2,[1,2],i,i,63,0,2],[3,3,[16,19,18],i,i,1,0,0],[1,1,[143],i,i,4,0,0],[0,3,[82,65,65],i,i,2,0,2],[0,4,[66,82,17,17],i,i,1,0,2],[1,255,i,[49],i,1,0,16],[1,255,i,[49],i,1,0,16],[3,3,[16,19,18],i,i,1,0,0],[3,3,[16,19,18],i,i,1,0,0],[1,2,[1,1],i,i,1,0,0],[1,1,[143],i,i,4,0,0],[3,3,[16,83,18],i,i,1,0,0],[1,1,[3],i,i,4,0,2],[1,1,[3],i,i,4,0,2],void 0,void 0,[1,2,[1,1],i,i,2,0,0],[2,3,[2,2,1],i,i,1,0,0],[2,3,[2,2,1],i,i,1,0,0],[4,4,[2,1,1,2],i,i,2,0,0],[1,2,[2,9],i,i,2,0,0],[1,2,[2,9],i,i,2,0,0],[3,3,[2,1,1],i,i,2,0,0],[1,1,[2],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[1,1,[2],i,i,2,0,0],[1,1,[2],i,i,2,0,0],[2,3,[1,16,4],i,i,1,0,16],void 0,void 0,[2,5,[1,65,65,68,66],i,i,2,0,0],[2,3,[1,1,4],i,i,1,0,0],[0,0,i,i,i,1,16383,0],[5,7,[1,1,1,1,1,1,4],i,i,1,0,0],[0,0,i,i,i,512,0,2],[1,1,[12],i,i,512,0,2],[0,0,i,i,i,512,0,2],[1,3,[2,82,84],i,i,512,0,2],[1,255,i,[49],i,1,0,16],[1,255,i,[32],i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[3,3,[16,19,18],i,i,263,0,0],[2,11,[1,18,17,17,18,17,17,115,84,21,17],i,i,2,0,2],[0,1,[4],i,i,4,0,2],[0,0,i,i,i,16,0,2],[0,2,[2,2],i,i,4,0,2],[0,3,[2,2,2],i,i,4,0,2],[2,5,[2,23,23,23,23],i,i,2,0,2],[2,4,[2,1,1,2],i,i,1,0,2],[1,4,[2,66,65,65],i,i,1,0,2],[1,1,[2],i,i,3,16383,0],[0,0,i,i,i,2,0,2],[1,5,[1,2,1,1,1],i,i,47,0,2],[4,5,[1,1,1,1,1],i,i,1,0,0],[0,1,[4],i,i,512,0,2],void 0,void 0,[0,1,[1],i,i,512,0,2],[2,2,[48,48],i,i,32,0,16],[0,2,[66,96],i,i,2,0,2],[1,1,[2],i,i,4,0,2],[1,255,[17],[127],i,575,0,0],[1,1,[3],i,i,4,0,2],[1,1,[2],i,i,63,0,2],[1,2,[1,3],i,i,47,0,2],[1,3,[1,3,1],i,i,47,0,2],[1,3,[2,66,4],i,i,4,0,2],[1,1,[15],i,i,1,0,0],[0,1,[2],i,i,4,0,2],[0,1,[2],i,i,4,0,2],[0,2,[99,66],i,i,4,0,2],[3,3,[3,1,4],i,i,4,0,2],[3,3,[3,1,4],i,i,4,0,2],[2,3,[2,3,66],i,i,1,0,2],[1,2,[1,2],i,i,35,0,2],[1,255,i,[49],i,1,0,16],[3,5,[1,1,1,65,65],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[3,5,[1,1,1,65,65],i,i,1,0,0],[4,4,[1,1,1,4],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[3,3,[1,1,4],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[4,4,[1,1,1,4],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[4,4,[1,1,1,1],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[4,4,[1,1,1,4],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[3,3,[1,1,4],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[4,4,[1,1,1,4],i,i,1,0,0],[2,2,[32,32],i,i,1,0,0],[2,2,[32,32],i,i,1,0,0],[2,2,[32,32],i,i,1,0,0],[2,2,[32,32],i,i,1,0,0],[2,2,[32,32],i,i,1,0,0],[2,2,[32,32],i,i,1,0,0],[3,3,[1,32,32],i,i,1,0,0],[2,2,[32,32],i,i,1,0,0],[2,2,[32,32],i,i,1,0,0],[2,2,[32,32],i,i,1,0,0],[2,2,[32,32],i,i,1,0,0],[2,2,[32,32],i,i,1,0,0],[2,2,[32,32],i,i,1,0,0],[4,4,[32,32,1,1],i,i,1,0,0],[3,4,[32,32,1,65],i,i,1,0,0],[1,255,i,[49],i,1,0,16],[1,255,i,[49],i,1,0,16],[1,255,i,[49],i,1,0,16],[1,255,i,[49],i,1,0,16],[1,255,i,[49],i,1,0,16],[1,255,i,[49],i,1,0,16],[2,3,[49,1,1],i,i,1,0,16],[2,2,[49,1],i,i,1,0,16],[2,2,[49,1],i,i,1,0,16],[2,2,[49,1],i,i,1,0,16],[2,2,[49,1],i,i,1,0,16],[2,3,[49,1,65],i,i,1,0,16],[1,255,i,[32],i,1,0,16],[2,2,[49,1],i,i,1,0,16],[2,2,[1,1],i,i,1,0,0],void 0,[3,4,[2,1,1,1],i,i,1,0,2],[2,3,[2,1,1],i,i,1,0,2],[1,255,i,[2],i,2,0,0],[2,2,[1,1],i,i,1,0,0],[2,9,[66,2,66,65,65,65,66,66,66],i,i,2,0,2],[1,2,[1,2],i,i,35,0,2],[1,3,[1,66,2],i,i,35,0,2],[1,4,[1,66,66,2],i,i,7,0,2],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[2,255,[1],[16],i,1,0,0],[2,3,[16,15,16],i,i,1,0,0],[2,2,[16,15],i,i,1,0,0],[1,1,[16],i,i,1,0,0],[1,2,[1,2],i,i,19,0,2],[1,1,[33],i,i,33,0,2],[4,4,[1,1,1,1],i,i,1,0,0],[3,3,[1,1,2],i,i,1,0,0],[1,1,[1],i,i,2,0,0],[2,2,[1,1],i,i,2,0,0],[1,2,[1,5],i,i,2,0,0],[0,4,[66,66,66,65],i,i,6,0,2],[0,5,[66,66,66,66,65],i,i,6,0,2],[1,2,[1,2],i,i,19,0,2],[2,255,[18,18],[2,79],i,15,0,0],[1,2,[2,39],i,i,39,0,0],[1,1,[16],i,i,2,0,0],[1,255,i,[49],i,1,0,16],[1,255,i,[49],i,1,0,16],[1,255,i,[49],i,1,0,16],[1,255,i,[49],i,1,0,16],[1,255,i,[49],i,1,0,16],[1,255,i,[49],i,1,0,16],[1,255,i,[49],i,1,0,16],[1,1,[1],i,i,2,0,0],[1,1,[1],i,i,2,0,0],[1,1,[3],i,i,2,0,0],[1,1,[1],i,i,2,0,0],[1,1,[1],i,i,2,0,0],[1,1,[1],i,i,2,0,0],[1,1,[2],i,i,1,0,0],[1,1,[2],i,i,4,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[3,255,i,[2],i,2,0,0],[1,255,[2],[50],i,15,0,0],[2,3,[2,50,2],i,i,10,0,0],[3,3,[2,2,2],i,i,15,0,0],[3,4,[2,2,1,2],i,i,10,0,0],[1,2,[95,95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,2,[95,95],i,i,9,0,0],[1,2,[95,95],i,i,9,0,0],[1,2,[95,95],i,i,9,0,0],[1,2,[95,95],i,i,9,0,0],[1,2,[95,95],i,i,9,0,0],[1,2,[95,95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,2,[95,95],i,i,9,0,0],[1,2,[95,95],i,i,9,0,0],[2,2,[95,95],i,i,9,0,0],[2,2,[95,95],i,i,9,0,0],[2,2,[95,95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[2,3,[95,95,95],i,i,9,0,0],[1,255,i,[127],i,9,0,0],[1,255,i,[127],i,9,0,0],[4,4,[95,95,95,127],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[2,2,[95,95],i,i,9,0,0],[1,2,[95,95],i,i,9,0,0],[1,2,[95,95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[2,2,[95,95],i,i,9,0,0],[1,2,[95,95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[2,2,[95,95],i,i,9,0,0],[2,2,[95,95],i,i,9,0,0],[2,2,[95,95],i,i,9,0,0],[2,2,[95,95],i,i,9,0,0],[2,3,[127,127,95],i,i,9,0,0],[3,3,[95,127,127],i,i,9,0,0],[5,6,[95,95,95,95,95,95],i,i,9,0,0],[5,6,[95,95,95,95,95,95],i,i,9,0,0],[4,5,[95,95,95,95,95],i,i,9,0,0],[4,5,[95,95,95,95,95],i,i,9,0,0],[4,5,[95,95,95,95,95],i,i,9,0,0],[4,5,[95,95,95,95,95],i,i,9,0,0],[4,5,[95,95,95,95,95],i,i,9,0,0],[3,3,[95,95,95],i,i,9,0,0],[3,3,[95,95,95],i,i,9,0,0],[3,3,[95,95,95],i,i,9,0,0],[6,7,[95,95,95,95,95,95,95],i,i,9,0,0],[6,7,[95,95,95,95,95,95,95],i,i,9,0,0],[2,2,[95,95],i,i,9,0,0],[2,2,[95,95],i,i,9,0,0],[2,2,[95,95],i,i,9,0,0],[2,2,[95,95],i,i,9,0,0],[6,6,[95,95,95,95,95,95],i,i,9,0,0],[6,6,[95,95,95,95,95,95],i,i,9,0,0],[2,2,[95,95],i,i,9,0,0],[2,2,[95,95],i,i,9,0,0],[2,3,[95,95,95],i,i,9,0,0],[3,4,[95,95,95,95],i,i,9,0,0],[3,4,[95,95,95,95],i,i,9,0,0],[3,4,[95,95,95,95],i,i,9,0,0],[3,4,[95,95,95,95],i,i,9,0,0],[3,4,[95,95,95,95],i,i,9,0,0],[3,4,[95,95,95,95],i,i,9,0,0],[5,6,[95,95,95,95,95,95],i,i,9,0,0],[5,6,[95,95,95,95,95,95],i,i,9,0,0],[7,8,[95,95,95,95,95,95,95,95],i,i,9,0,0],[7,8,[95,95,95,95,95,95,95,95],i,i,9,0,0],[8,9,[95,95,95,95,95,95,95,95,95],i,i,9,0,0],[8,9,[95,95,95,95,95,95,95,95,95],i,i,9,0,0],[2,2,[95,95],i,i,9,16383,0],[1,2,[95,95],i,i,9,0,0],[6,7,[95,95,95,95,95,95,95],i,i,9,0,0],[6,7,[95,95,95,95,95,95,95],i,i,9,0,0],[3,3,[95,95,95],i,i,9,0,0],[6,8,[95,95,95,95,95,95,95,95],i,i,9,0,0],[4,5,[95,95,95,95,95],i,i,9,0,0],[2,3,[95,95,127],i,i,9,0,0],[2,3,[95,95,127],i,i,9,0,0],[1,255,i,[127],i,9,0,0],[1,255,i,[127],i,9,0,0],[1,255,i,[127],i,9,0,0],[2,2,[95,127],i,i,9,0,0],[3,4,[2,2,1,2],i,i,10,0,0],[2,5,[2,50,2,1,2],i,i,10,0,0],[1,1,[2],i,i,9,0,0],[2,2,[47,575],i,i,303,0,0],[2,255,i,[16,15],i,1,0,0],[3,255,[16],[16,15],i,1,0,0],[2,3,[16,15,16],i,i,1,0,0],[3,255,[16],[16,15],i,1,0,0],[3,254,[1,1,48,17],[16],i,1,0,0],[4,4,[1,1,1,4],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[2,2,[32,32],i,i,1,0,0],[2,2,[32,32],i,i,1,0,0],[2,2,[32,32],i,i,1,0,0],[2,2,[32,32],i,i,1,0,0],[3,3,[1,1,4],i,i,1,0,0],[4,4,[1,1,1,4],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[1,254,i,[32],i,32,0,16],[1,254,i,[32],i,1,0,16],[4,4,[1,1,1,4],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[2,2,[49,1],i,i,1,0,16],[2,2,[49,1],i,i,1,0,16],[2,3,[49,1,65],i,i,1,0,16],[2,3,[49,1,65],i,i,1,0,16],[3,3,[1,1,4],i,i,1,0,0],[2,2,[49,1],i,i,1,0,16],[2,2,[49,1],i,i,1,0,16],[2,3,[1,16,4],i,i,1,0,16],[2,3,[1,16,4],i,i,1,0,16],[1,254,i,[49],i,1,0,16],[1,254,i,[49],i,1,0,16],[3,3,[1,1,4],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[1,254,i,[49],i,1,0,16],[1,254,i,[49],i,1,0,16],[4,4,[1,1,1,4],i,i,1,0,0],[2,4,[95,95,75,127],i,i,9,0,0],[2,4,[95,95,75,127],i,i,9,0,0],[2,2,[1,1],i,i,1,0,0],[1,2,[1,65],i,i,1,0,0],void 0,[4,6,[1,1,1,4,65,65],i,i,1,0,0],[3,5,[1,1,1,65,65],i,i,1,0,0],[3,3,[1,1,4],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[4,4,[1,1,1,4],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[5,5,[1,1,1,1,4],i,i,1,0,0],[4,4,[1,1,1,4],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[4,4,[1,1,1,4],i,i,1,0,0],[2,2,[1,4],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[4,4,[32,32,1,1],i,i,1,0,0],[2,3,[49,1,1],i,i,1,0,16],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[1],i,i,1,0,0],[1,2,[1,65],i,i,1,0,0],[1,2,[1,65],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[2,2,[1,1],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[2,2,[1,1],i,i,1,0,0],[1,254,i,[52],i,4,0,16],[3,3,[1,1,1],i,i,1,0,0],[2,3,[1,1,65],i,i,2,0,0],[2,2,[2,1],i,i,1,0,0],[2,2,[3,3],i,i,1,0,0],[3,4,[1,1,1,65],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,254,i,[49],i,1,0,16],[1,1,[1],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[3,3,[1,1,1],i,i,1,0,0],[1,1,[1],i,i,2,0,0],[1,1,[2],i,i,1,0,0],[1,1,[1],i,i,32,0,0],[1,1,[2],i,i,1,0,0],[1,1,[1],i,i,1,0,0],[1,3,[2,66,66],i,i,1,0,0],[0,1,[50],i,i,1,16383,16],[0,1,[48],i,i,1,16383,16],[1,1,[16],i,i,2,16383,0],[1,1,[16],i,i,4,0,0],[2,2,[47,575],i,i,303,0,0],[1,3,[1,65,65],i,i,1,0,0],[1,3,[1,65,65],i,i,1,0,0],[1,1,[95],i,i,9,0,0],[1,1,[95],i,i,9,0,0],[2,2,[2,2],i,i,47,0,0],[1,1,[2],i,i,10,0,0],[1,1,[2],i,i,10,0,0],[3,6,[1,48,48,65,65,65],i,i,1,0,0],[3,7,[1,48,48,65,65,65,65],i,i,1,0,0],[2,4,[48,48,65,65],i,i,1,0,0],[3,3,[1,32,32],i,i,1,0,0],[3,6,[48,48,1,65,65,65],i,i,1,0,0],[3,254,[16],[16,15],i,1,0,0],[3,254,[16],[16,15],i,1,0,0],[3,254,[114,68],[114],i,2,0,16],[1,254,i,[114],i,2,0,16],[2,254,i,[44,575],i,831,0,0],[3,254,[47],[575,575],[575],831,0,0],[1,1,[1527],i,i,1503,0,21],[2,254,i,[113,113],i,1,0,17],[1,1,[16],i,i,48,0,21],[2,3,[271,2,4],i,i,303,0,21],[2,2,[271,2],i,i,303,0,17],[2,3,[48,48,111],i,i,303,0,1],[1,4,[160,96,96,4],i,i,32,0,1],[1,3,[160,4,4],i,i,32,0,1],[2,2,[2,256],i,i,1,0,8],[3,3,[2,49,1],i,i,1,0,25],[3,3,[2,49,1],i,i,1,0,25],[2,254,[2],[49],i,1,0,25],[2,7,[34,2,65,65,65,74,68],i,i,1,0,1],[1,3,[2,65,65],i,i,2,0,1],[2,6,[2,34,65,65,65,74],i,i,2,0,1],[2,6,[2,34,65,65,65,74],i,i,2,0,1],[2,6,[2,98,98,68,65,495],i,i,32,0,1],[1,4,[32,96,96,4],i,i,32,0,9],[2,2,[4,16],i,i,32,0,25],[2,4,[391,48,65,65],i,i,1,0,1],[3,6,[391,48,48,511,65,65],i,i,319,0,1],[2,254,[160],[160,65],i,32,0,1],[0,5,[65,65,65,65,68],i,i,32,16383,1],[1,4,[65,65,65,65],i,i,32,0,1],[2,254,[258,1,65,65,65],[65],i,32,0,17],[2,3,[32,1,463],i,i,32,0,1],[1,254,[48],[48],i,32,0,17],[1,254,[48],[48],i,32,0,17],[2,254,[48,33],[33],i,32,0,1],[2,254,[48,33],[33],i,32,0,1],[3,254,i,[319,319],[319],319,0,1],[1,254,i,[319],i,319,0,1],[3,3,[65,65,319],i,i,32,0,1],[1,254,i,[319],i,319,0,1],[1,1,[319],i,i,4,0,1],[1,1,[319],i,i,9,0,1],[0,0,i,i,i,319,0,1],void 0,[1,2,[399,1],i,i,2,0,1],[1,2,[32,1],i,i,2,0,1],[2,2,[15,2],i,i,256,0,17],[1,3,[48,65,68],i,i,32,0,17],[1,3,[48,65,68],i,i,32,0,17],[2,3,[32,1,463],i,i,32,0,1],[2,254,[48],[319],i,32,0,1],[3,3,[511,48,271],i,i,319,0,1],[3,3,[511,48,271],i,i,32,0,1],[1,2,[48,271],i,i,32,0,1],[1,2,[48,271],i,i,32,0,1],[1,1,[1535],i,i,4,0,1],[2,4,[32,65,65,495],i,i,32,0,1],[2,3,[48,65,65],i,i,48,0,1],[2,3,[48,65,65],i,i,48,0,1],[1,254,[1],[48],i,303,0,17],void 0,[1,5,[2,66,65,65,65],i,i,264,0,1],[1,254,[1],[48],i,1087,0,17],[0,0,i,i,i,1,0,1],[1,2,[287,2],i,i,288,0,17],[2,2,[15,2],i,i,271,0,17],[1,2,[1,1],i,i,10,0,17],[0,0,i,i,i,1,0,1],[3,254,[47],[2,47],i,47,0,17],[0,1,[1],i,i,1,0,1],[0,1,[1],i,i,32,0,1],[1,2,[2,1],i,i,47,0,1],[1,1,[1],i,i,264,0,17],[1,1,[1],i,i,264,0,17],[2,2,[2,47],i,i,47,0,1],[1,254,[2],[1151],i,1087,0,16],[1,254,[1],[1151],i,1087,0,0],[1,254,[1],[1151],i,1087,0,0],[1,1,[256],i,i,258,0,17],[1,1,[16],i,i,32,0,1],[1,1,[256],i,i,2,0,17],[1,1,[256],i,i,2,0,17],[1,1,[256],i,i,2,0,17],[1,1,[256],i,i,2,0,17],[2,2,[256,2],i,i,2,0,17],[1,1,[32],i,i,256,0,17],[3,254,[15],[2,47],i,303,0,17],void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,[3,254,i,[319,319],[319],319,0,1],[3,254,[15],[2,303],i,303,0,17]].map((function(e){return void 0===e?void 0:n.functionType.apply(void 0,e)}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.wrapPosition=t.parseGridRangeA1=t.parseGridCellA1=t.parseCellRef=t.isR1C1IdentStart=t.SpecialPos=void 0;var n=r(75),i=r(58),a=r(69),o=r(217),s=r(142),u=r(111),c=r(112),l=r(140),d=n.sheetRows,f=d.toString(10).length,p=n.sheetCols,m=p.toString(26).length,h=p.toString(10).length,v=s.codePointCapitalA,g=s.codePointCapitalZ,b=s.codePointSmallA,S=s.codePointSmallZ,y=s.codePointPlusSign,O=s.codePointMinusSign,C=s.codePointColon;function P(e){return e>=b&&e<=S||e>=v&&e<=g}function N(e){return 1+(e>=b?e-b:e-v)}function R(e,t,r,n){return function(i,o,s,d,f){var p=function(e,t){return(0,u.stringStartsWith)(e,"$",t)?[a.PosKind.Abs,t+1]:[a.PosKind.Rel,t]}(s,d),m=p[0],h=p[1],v=e(i,r,s,h),g=v[0],b=v[1];if(b>h){if(g<1||g>t)return(m===a.PosKind.Abs||(!0===n?"object"==typeof f&&f.kind===a.PosKind.Abs||f===_.A1BadDollar:(0,u.stringStartsWith)(s,"$",b)))&&(0,l.isFeatureEnabled)(l.FeatureName["OfficeVSO:3594447_A1_BadDollar"])?[_.A1BadDollar,!0,b]:void 0;var S=m===a.PosKind.Rel?g-o:g;return[(0,a.pos)(m,S-1),m===a.PosKind.Abs&&(0,l.isFeatureEnabled)(l.FeatureName["OfficeVSO:3594447_A1_BadDollar"]),b]}return m!==a.PosKind.Abs||!0!==n&&b!==s.length&&i.isNumeral((0,c.stringCodePointAt)(s,b))||!(0,l.isFeatureEnabled)(l.FeatureName["OfficeVSO:3594447_A1_BadDollar"])?[void 0,!1,d]:[_.A1BadDollar,!0,b]}}function k(e,t,r){return x(e,t,r)-e}function T(e,t,r,n){return function(i,s,c,d){var f=t?e?"R":i.rowLetter:e?"C":i.columnLetter;if(d>=c.length||0!==i.stringCompareCI(f,c[d]))return[void 0,!1,d];var p=d+f.length,m=(0,o.parseUint)(i,n,c,p),h=m[0],v=m[1];if(v>p){if(h>=1&&h<=r)return[(0,a.pos)(a.PosKind.Abs,h-1),!1,v];if(!(0,l.isFeatureEnabled)(l.FeatureName["OfficeVSO:3594447_R1C0_Fix"]))return}if((0,u.stringStartsWith)(c,i.leftBracket,p)){if(p+=i.leftBracket.length,(0,u.stringStartsWith)(c,i.rightBracket,p))return[(0,a.pos)(a.PosKind.Rel,k(s,0,r)),!0,p+i.rightBracket.length];var g=1,b=c.charCodeAt(p);b===y?p+=1:b===O&&(g=-1,p+=1);var S=(0,o.parseUint)(i,n,c,p),C=S[0],P=S[1];if(P>p&&C<r&&(0,u.stringStartsWith)(c,i.rightBracket,P))return[(0,a.pos)(a.PosKind.Rel,k(s,C*g,r)),!0,P+i.rightBracket.length]}return[_.RCNoNum,!1,d+f.length]}}function E(e,t,r,n,i,a,o){var s=n(e,t,a,o,void 0);if(null==s)return[void 0,void 0,o];var u=s[0],c=s[1],l=s[2];if(l>o){var d=i(e,r,a,l,u);if(null==d)return c?[u,void 0,l]:[void 0,void 0,o];var f=d[0],p=d[2];return p>l?[u,f,p]:[u,void 0,l]}var m=i(e,r,a,o,u);if(null==m)return[void 0,void 0,o];var h=m[0],v=m[2];return v>o?[void 0,h,v]:[void 0,void 0,o]}var _,F=R(o.parseUint,d,f,!0),I=R((function(e,t,r,n){return function(e,t,r){for(var n=0,a=r,o=(0,i.fastMin)(t.length,r+e);a<o;a+=1){var s=t.charCodeAt(a);if(!P(s))break;n=26*n+N(s)}return a===o&&a<t.length&&P(t.charCodeAt(a))?[0,r]:[n,a]}(t,r,n)}),p,m,!1),A=T(!1,!0,d,f),M=T(!1,!1,p,h),w=T(!0,!0,d,f),D=T(!0,!1,p,h);function j(e,t){return"object"!=typeof e&&"object"!=typeof t}function x(e,t,r){return e+t&r-1}!function(e){e[e.RCNoNum=0]="RCNoNum",e[e.A1BadDollar=1]="A1BadDollar"}(_=t.SpecialPos||(t.SpecialPos={})),t.isR1C1IdentStart=j,t.parseCellRef=function(e,t,r,n,i){var o=function(e,t,r,n,i){var o=E(e,r.col,r.row,I,F,n,i),s=o[0],u=o[1],l=o[2],d="object"==typeof u&&u.kind===a.PosKind.Abs||u===_.A1BadDollar||"object"==typeof s&&s.kind===a.PosKind.Abs||s===_.A1BadDollar;if(null!=u&&null!=s||d||(null!=u||null!=s)&&(i-1>=0&&n.charCodeAt(i-1)===C||l<n.length&&n.charCodeAt(l)===C)){if(l<n.length&&e.isIdentContinue((0,c.stringCodePointAt)(n,l)))return;if(t!==a.RefStyle.A1&&!d)return;return{refStyle:a.RefStyle.A1,row:u,col:s,i:l}}}(e,t,r,n,i);return void 0!==o?o:function(e,t,r,n,i){var o,s=r.col,u=r.row,l=!1,d=E(e,u,s,A,M,n,i),f=d[0],p=d[1],m=d[2];if(null!=f||null!=p||"R"===e.rowLetter&&"C"===e.columnLetter||(l=!0,f=(o=E(e,u,s,w,D,n,i))[0],p=o[1],m=o[2]),(null!=f||null!=p)&&(m>=n.length||!j(f,p)||!e.isIdentContinue((0,c.stringCodePointAt)(n,m))))return{refStyle:a.RefStyle.R1C1,row:f,col:p,i:m,enLocale:l}}(e,0,r,n,i)},t.parseGridCellA1=function(e,t){var r=E(e,0,0,I,F,t,0),i=r[0],a=r[1],o=r[2];return"object"==typeof i&&"object"==typeof a&&o===t.length?(0,n.gridCell)(a.index,i.index):void 0},t.parseGridRangeA1=function(e,t){var r=E(e,0,0,I,F,t,0),a=r[0],o=r[1],s=r[2];if("object"==typeof a&&"object"==typeof o){if(s===t.length)return(0,n.gridCell)(o.index,a.index);if(t.charCodeAt(s)===C){var u=E(e,0,0,I,F,t,s+1),c=u[0],l=u[1],d=u[2];if("object"==typeof c&&"object"==typeof l&&d===t.length){var f=(0,i.fastMin)(o.index,l.index),p=(0,i.fastMin)(a.index,c.index);return(0,n.gridRange)(f,p,(0,i.fastMax)(o.index,l.index)+1-f,(0,i.fastMax)(a.index,c.index)+1-p)}}}},t.wrapPosition=x},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.KnownFormat=t.Calendar=t.NumberShape=t.DateOrder=t.CurrencyFormat=void 0,function(e){e.Paren="Paren",e.Lead="Lead",e.Intern="Intern",e.Trail="Trail"}(t.CurrencyFormat||(t.CurrencyFormat={})),function(e){e.MDY="MDY",e.DMY="DMY",e.YMD="YMD",e.MYD="MYD",e.DYM="DYM",e.YDM="YDM"}(t.DateOrder||(t.DateOrder={})),function(e){e.ASCII="ASCII",e.ArabicIndic="ArabicIndic",e.ExtendedArabicIndic="ExtendedArabicIndic",e.Devanagari="Devanagari",e.Bengali="Bengali",e.Gurmukhi="Gurmukhi",e.Gujarati="Gujarati",e.Oriya="Oriya",e.Tamil="Tamil",e.Telugu="Telugu",e.Kannada="Kannada",e.Malayalam="Malayalam",e.Thai="Thai",e.Lao="Lao",e.Tibetan="Tibetan",e.Myanmar="Myanmar",e.Ethiopic="Ethiopic",e.Khmer="Khmer",e.Mongolian="Mongolian",e.Unknown="Unknown",e.ChineseTrad1="ChineseTrad1",e.ChineseTrad2="ChineseTrad2",e.ChineseTrad3="ChineseTrad3",e.ChineseSimp1="ChineseSimp1",e.ChineseSimp2="ChineseSimp2",e.ChineseSimp3="ChineseSimp3",e.Japanese1="Japanese1",e.Japanese2="Japanese2",e.Japanese3="Japanese3",e.Korean1="Korean1",e.Korean2="Korean2",e.Korean3="Korean3",e.Korean4="Korean4"}(t.NumberShape||(t.NumberShape={})),function(e){e.Gregorian="Gregorian",e.GregorianUS="GregorianUS",e.Japan="Japan",e.Taiwan="Taiwan",e.Korea="Korea",e.Hijri="Hijri",e.Thai="Thai",e.Hebrew="Hebrew",e.GregorianMEFrench="GregorianMEFrench",e.GregorianArabic="GregorianArabic",e.GregorianXlitEnglish="GregorianXlitEnglish",e.GregorianXlitFrench="GregorianXlitFrench",e.Persian="Persian",e.UmAlQura="UmAlQura"}(t.Calendar||(t.Calendar={})),function(e){e[e.General=0]="General",e[e.NoComFixed0=-1]="NoComFixed0",e[e.NoComFixed=-2]="NoComFixed",e[e.Fixed0=-3]="Fixed0",e[e.Fixed=-4]="Fixed",e[e.Currency=-9]="Currency",e[e.CoCurrency=-10]="CoCurrency",e[e.CurrencyDec=-11]="CurrencyDec",e[e.CoCurrencyDec=-12]="CoCurrencyDec",e[e.Pct0=-13]="Pct0",e[e.Pct=-14]="Pct",e[e.Exp=-15]="Exp",e[e.Fract=-17]="Fract",e[e.FractBond=-18]="FractBond",e[e.MMDDYY=-19]="MMDDYY",e[e.DDMMMYY=-20]="DDMMMYY",e[e.DDMMM=-21]="DDMMM",e[e.MMMYY=-22]="MMMYY",e[e.HHMMAP=-23]="HHMMAP",e[e.HHMMSSAP=-24]="HHMMSSAP",e[e.HHMM=-25]="HHMM",e[e.HHMMSS=-26]="HHMMSS",e[e.MDYHMS=-27]="MDYHMS",e[e.USCoCurrency=-37]="USCoCurrency",e[e.USCoCurrencyDec=-39]="USCoCurrencyDec",e[e.Currency2=-5]="Currency2",e[e.CoCurrency2=-6]="CoCurrency2",e[e.CurrencyDec2=-7]="CurrencyDec2",e[e.CoCurrencyDec2=-8]="CoCurrencyDec2",e[e.Acct=-33]="Acct",e[e.AcctCur=-32]="AcctCur",e[e.AcctDec=-35]="AcctDec",e[e.AcctDecCur=-34]="AcctDecCur",e[e.MMSS=-28]="MMSS",e[e.AbsHMMSS=-31]="AbsHMMSS",e[e.SS0=-29]="SS0",e[e.Eng=-16]="Eng",e[e.Text=-30]="Text"}(t.KnownFormat||(t.KnownFormat={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createResolver=t.resolveGridRef=void 0;var n=r(2),i=r(58),a=r(58),o=r(70),s=r(141),u=r(69),c=r(86),l=r(86),d=r(75),f=r(75),p=r(110),m=r(143),h=r(140);function v(e){return(0,p.isSuccess)(e)&&(0,a.isNone)(e.value)?p.successUndefined:e}function g(e){return!(0,p.isSuccess)(e)||void 0===e.value}function b(e,t,r){var n=(0,s.resolvePosition)(e.row,t.row,f.sheetRows,r),i=(0,s.resolvePosition)(e.col,t.col,f.sheetCols,r);return void 0!==n&&void 0!==i?(0,f.gridCell)(n,i):void 0}function S(e,t){if(t.kind===u.CellRefKind.Error)return p.successUndefined;var r=e.originGridCell;if(!(0,p.isSuccess)(r))return r;var n=r.value,i=e.wrapCellReferences;switch(t.kind){case u.CellRefKind.Single:return(0,p.success)(b(n,t,i));case u.CellRefKind.Range:var a=b(n,t.ref1,i),c=b(n,t.ref2,i);return void 0!==a&&void 0!==c?(0,p.success)((0,l.gridCellRange)(a,c)):p.successUndefined;case u.CellRefKind.Row:var d=(0,s.resolvePosition)(n.row,t.row1,f.sheetRows,i),h=(0,s.resolvePosition)(n.row,t.row2,f.sheetRows,i);return void 0!==d&&void 0!==h?(0,p.success)((0,l.gridCellRange)((0,f.gridCell)(d,0),(0,f.gridCell)(h,f.sheetCols-1))):p.successUndefined;case u.CellRefKind.Col:var v=(0,s.resolvePosition)(n.col,t.col1,f.sheetCols,i),g=(0,s.resolvePosition)(n.col,t.col2,f.sheetCols,i);return void 0!==v&&void 0!==g?(0,p.success)((0,l.gridCellRange)((0,f.gridCell)(0,v),(0,f.gridCell)(f.sheetRows-1,g))):p.successUndefined;case u.CellRefKind.Bad:return(0,p.failure)((0,m.invalidCellRef)(m.InvalidCellRefReason.BadCellRef));default:return(0,o.assertNever)("calc.runtime.resolverService.resolveGridRef",t)}}t.resolveGridRef=S,t.createResolver=function(e){function t(t,r){if(void 0===r){var n=t.originSheet;return(0,p.isSuccess)(n)?[r,(0,p.success)(n.value.document)]:[r,n]}var i=e.getDocumentLoc(r.path,r.document);if(!(0,p.isSuccess)(i))return[r,i];if((0,a.isNone)(i.value)&&(0,h.isFeatureEnabled)(h.FeatureName["OfficeVSO:3594447_InvalidQualifier"]))return[r,(0,p.failure)((0,m.invalidQualifier)(m.InvalidQualifierReason.UndefinedDocument))];var o=null==r.path?void 0:(0,a.isNone)(i.value)?r.path:i.value.path,s=(0,a.isNone)(i.value)?r.document:i.value.name;return[(0,u.documentQualifier)(s,o,r.isQuoted,r.label),(0,a.isDefined)(i.value)?(0,p.success)(i.value):p.successUndefined]}function r(t,r){if(g(r))return[t,r];var n=v(e.getSheetIndex(r.value,t));if(!(0,p.isSuccess)(n))return[t,n];if((0,a.isNone)(n.value))return(0,h.isFeatureEnabled)(h.FeatureName["OfficeVSO:3594447_InvalidQualifier"])?[t,(0,p.failure)((0,m.invalidQualifier)(m.InvalidQualifierReason.UndefinedSheetName))]:[t,p.successUndefined];var i=e.getSheetName(r.value,n.value);return(0,p.isSuccess)(i)?[i.value,(0,p.success)((0,f.sheetIndex)(r.value,n.value))]:[t,i]}function s(e,n){var i=t(e,n.document),a=i[0],o=i[1],s=r(n.sheet,o),c=s[0],l=s[1];return[(0,u.sheetQualifier)(c,a,n.isQuoted,n.label),l]}function b(n,i){switch(i.kind){case u.QualifierKind.Error:return[i,p.successUndefined];case u.QualifierKind.Sheet:return s(n,i);case u.QualifierKind.SheetRange:return function(n,i){var a,o=t(n,i.document),s=o[0],c=o[1],d=r(i.sheet1,c),m=d[0],h=d[1],v=r(i.sheet2,c),b=v[0],S=v[1],y=m,O=b;if(g(c))a=c;else if(g(h))a=h;else if(g(S))a=S;else{if((0,l.isSheetIndexEqual)(h.value,S.value))return[(0,u.sheetQualifier)(y,s,i.isQuoted,i.label),(0,p.success)((0,f.sheetIndex)(c.value,h.value.index))];var C=e.getSheetRangeIndexes(h.value),P=e.getSheetRangeIndexes(S.value);(0,p.isSuccess)(C)?(0,p.isSuccess)(P)?P.value.position<C.value.position&&(y=b,O=m):a=P:a=C,a=(0,p.success)((0,f.sheetRange)(c.value,h.value.index,S.value.index))}return[(0,u.sheetRangeQualifier)(y,O,s,i.isQuoted,i.label),a]}(n,i);case u.QualifierKind.Document:return[i,(0,p.failure)((0,m.invalidQualifier)(m.InvalidQualifierReason.SheetRangeName))];case u.QualifierKind.Bad:return[i,(0,p.failure)((0,m.invalidQualifier)(m.InvalidQualifierReason.BadQualifier))];default:return(0,o.assertNever)("calc.runtime.resolverService.resolveCellRefQualifier",i)}}function y(e,t){var r,n,i,a,o=t.qualifier,s=t.ref,c=S(e,s);if(void 0===o||o.kind===u.QualifierKind.Relative){n=o;var l=e.originSheet;if((0,p.isSuccess)(l)){var d=l.value;i=void 0===d.index?(0,p.failure)((0,m.noOriginSheet)(d)):(0,p.success)(d)}else i=l}else n=(r=b(e,o))[0],i=r[1];return a=g(c)?c:g(i)?i:(0,p.success)((0,f.sheetGridCube)(i.value,c.value)),(0,m.resolvedCellRef)((0,u.cellRefNode)(s,n,t.label),a)}function O(r,n,i){var a,c,l,b=n.qualifier,S=n.parts,y=[];if(void 0===b||b.kind===u.QualifierKind.Relative){var O=r.originSheet;if(!(0,p.isSuccess)(O))return(0,m.resolvedName)(n,O,y);var C=O.value;if(i!==f.NameSource.StructRef||!(0,h.isTypedChangeGateEnabled)("Microsoft.Office.Excel.ChangeGate.ResolveSheetTable")){if(void 0===C.index)return(0,m.resolvedName)(n,(0,p.failure)((0,m.noOriginSheet)(C)),y);y.push((0,d.nameLoc)(C,S.asWhole));var P=v(e.getNameLoc(C,S.asWhole,i));if(!(0,p.isSuccess)(P))return(0,m.resolvedName)(n,P,y);if(P.value)return(0,m.resolvedName)((0,u.nameNode)((0,u.identNamePart)(P.value.name,S.canDenoteNamedObject,S.label,S.qualifiedLabel),b,n.label),P,y)}c=b,l=(0,p.success)((0,f.documentScope)(C.document))}else c=(a=function(e,r){switch(r.kind){case u.QualifierKind.Document:var n=t(e,r);return[d=n[0],g(h=n[1])?h:(0,p.success)((0,f.documentScope)(h.value))];case u.QualifierKind.Sheet:return s(e,r);case u.QualifierKind.SheetRange:return[r,(0,p.failure)((0,m.invalidQualifier)(m.InvalidQualifierReason.SheetRangeName))];case u.QualifierKind.Ident:var i=s(e,(0,u.sheetQualifier)(r.name,void 0)),a=i[0],c=i[1];if(!(0,p.isSuccess)(c)&&c.reason.kind!==m.ResolveReasonKind.InvalidQualifier)return[r,c];if((0,p.isSuccess)(c)&&void 0!==c.value)return[(0,u.identQualifier)(a.sheet,r.isQuoted,r.label),c];var l=t(e,(0,u.documentQualifier)(r.name)),d=l[0],h=l[1];return[(0,u.identQualifier)(d.document,r.isQuoted,r.label),g(h)?h:(0,p.success)((0,f.documentScope)(h.value))];case u.QualifierKind.Bad:return[r,(0,p.failure)((0,m.invalidQualifier)(m.InvalidQualifierReason.BadQualifier))];default:return(0,o.assertNever)("calc.runtime.resolverService.resolveNameQualifier",r)}}(r,b))[0],l=a[1];var N,R=S;return g(l)?N=l:(y.push((0,d.nameLoc)(l.value,S.asWhole)),g(N=v(e.getNameLoc(l.value,S.asWhole,i)))||(R=(0,u.identNamePart)(N.value.name,S.canDenoteNamedObject,S.label,S.qualifiedLabel))),(0,m.resolvedName)((0,u.nameNode)(R,c,n.label),N,y)}function C(t,r,n){void 0===n&&(n=!1);var i=e.getStructRefColumn(t,r.name);if(!(0,p.isSuccess)(i))return{kind:u.StructRefKind.ColumnRef,innerRef:r,resolution:i};var o=i.value;if((0,a.isNone)(o))return{kind:u.StructRefKind.ColumnRef,innerRef:r,resolution:(0,p.failure)((0,m.invalidStructRef)(m.InvalidStructRefReason.UndefinedColumnName))};var s=o.range.range;return n&&(s=(0,f.gridRange)(s.row-(o.hasHeadersRow?1:0),s.col,s.rows+(o.hasHeadersRow?1:0)+(o.hasTotalsRow?1:0),s.cols)),{kind:u.StructRefKind.ColumnRef,innerRef:(0,u.columnRef)(o.name,r.isBracketed,r.isClosed,r.label),resolution:(0,p.success)((0,f.sheetGridRange)(o.range.sheet,s))}}function P(t,r,n){if(n===u.SpecialRefId.ThisRow){if(!(0,p.isSuccess)(t.originGridCell))return t.originGridCell;var i=P(t,r,u.SpecialRefId.Data);if(g(i))return i;var a=i.value.range,o=t.originGridCell.value.row;return o<a.row||o>=a.row+a.rows?(0,p.failure)(m.emptyIntersection):(0,p.success)((0,f.sheetGridRange)(i.value.sheet,(0,f.gridRange)(o,a.col,1,a.cols)))}return v(e.getStructRefSpecialRef(r,n))}function N(e,t,r){switch(t.kind){case u.StructRefKind.ColumnRef:return C(e,t,r);case u.StructRefKind.MissingRef:return{kind:u.StructRefKind.MissingRef,innerRef:t,resolution:p.successUndefined}}}function R(e,t,r){var n;void 0===r&&(r=!1);var i,a,o=N(e,t.lhs,r),s=o.innerRef,c=o.resolution,d=N(e,t.rhs,r),h=d.innerRef,v=d.resolution,g=(0,u.rangeOpRef)(s,h,t.label);if(!(0,p.isSuccess)(c)&&c.reason.kind!==m.ResolveReasonKind.InvalidStructRef)return{kind:u.StructRefKind.RangeOpRef,innerRef:g,resolution:c};if(!(0,p.isSuccess)(v)&&v.reason.kind!==m.ResolveReasonKind.InvalidStructRef)return{kind:u.StructRefKind.RangeOpRef,innerRef:g,resolution:v};if(!(0,p.isSuccess)(c))return{kind:u.StructRefKind.RangeOpRef,innerRef:g,resolution:c};if(!(0,p.isSuccess)(v))return{kind:u.StructRefKind.RangeOpRef,innerRef:g,resolution:v};if(void 0!==c.value)i=c.value.sheet,a=(0,l.gridRangeJoinOpt)(c.value.range,null===(n=v.value)||void 0===n?void 0:n.range);else{if(void 0===v.value)return{kind:u.StructRefKind.RangeOpRef,innerRef:g,resolution:(0,p.failure)((0,m.invalidStructRef)(m.InvalidStructRefReason.InvalidOp))};i=v.value.sheet,a=v.value.range}return{kind:u.StructRefKind.RangeOpRef,innerRef:g,resolution:(0,p.success)((0,f.sheetGridRange)(i,a))}}function k(r,n){var i,a,s,l,f,h,v,b=n.qualifier,S=n.parts,y=null!==(s=null===(a=r.config)||void 0===a?void 0:a.localeInfo)&&void 0!==s?s:e.config.localeInfo;if(void 0===b){var O=r.originSheet;if(!(0,p.isSuccess)(O))return(0,m.resolvedUserDefinedFunc)(n,O,[],S.asWhole);l=b,f=(0,p.success)(O.value.document)}else l=(i=function(e,r){switch(r.kind){case u.QualifierKind.Document:return t(e,r);case u.QualifierKind.Ident:var n=t(e,(0,u.documentQualifier)(r.name)),i=n[0],a=n[1];return[(0,u.identQualifier)(i.document,r.isQuoted,r.label),a];default:return(0,o.assertNever)("calc.runtime.resolverService.resolveUserDefinedFuncQualifier",r)}}(r,b))[0],f=i[1];var C=S.asWhole;if(g(f))v=f,h=[];else{C=(0,c.getUserDefinedFuncName)(y,S.asWhole);var P=e.getUserDefinedFuncLoc(f.value,C);h=[(0,d.userDefinedFuncLoc)(f.value,C)],v=(0,p.isSuccess)(P)?0!==P.value.length?P:p.successUndefined:P}return(0,m.resolvedUserDefinedFunc)((0,u.nameNode)((0,u.identNamePart)(S.asWhole,S.canDenoteNamedObject,S.label,S.qualifiedLabel),l,n.label),v,h,C)}return{resolveGridRef:S,resolveCellRef:y,resolveName:O,resolveStructRef:function(t,r){var n,i,o=r.lhs,s=r.rhs,c=o;if(void 0!==o){var d=O(t,o,f.NameSource.StructRef),h=d.node,v=d.resolution,b=d.precedents,S=v;if(!(0,p.isSuccess)(S))return(0,m.resolvedStructRef)(r,void 0,S,b);if((0,a.isNone)(S.value))return(0,m.resolvedStructRef)(r,void 0,(0,p.failure)((0,m.invalidStructRef)(m.InvalidStructRefReason.UndefinedTableName)),b);c=h,n=S.value,i=b}else{var y=t.originGridCell,N=t.originSheet;if(!(0,p.isSuccess)(y))return(0,m.resolvedStructRef)(r,void 0,y,[]);if(!(0,p.isSuccess)(N))return(0,m.resolvedStructRef)(r,void 0,N,[]);if(void 0===N.value.index)return(0,m.resolvedStructRef)(r,void 0,(0,p.failure)((0,m.invalidStructRef)(m.InvalidStructRefReason.InvalidOriginSheet)),[]);S=e.getContainingTable((0,f.sheetGridCell)(N.value,y.value));if(!(0,p.isSuccess)(S))return(0,m.resolvedStructRef)(r,void 0,S,[]);if((0,a.isNone)(S.value))return(0,m.resolvedStructRef)(r,void 0,(0,p.failure)((0,m.invalidStructRef)(m.InvalidStructRefReason.MissingTableName)),[]);i=[n=S.value]}var k=function(e,t,r){var n;switch(null===(n=r.innerRef)||void 0===n?void 0:n.kind){case u.StructRefKind.ColumnRef:var i=C(t,r.innerRef),a=i.innerRef,o=i.resolution;return{structRef:(0,u.structRef)(a,r.isClosed,r.label),resolution:o};case u.StructRefKind.RangeOpRef:var s=R(t,r.innerRef);a=s.innerRef,o=s.resolution;return{structRef:(0,u.structRef)(a,r.isClosed,r.label),resolution:o};case void 0:o=P(e,t,u.SpecialRefId.Data);return{structRef:r,resolution:o};case u.StructRefKind.SpecialRef:o=P(e,t,r.innerRef.id);return{structRef:r,resolution:o};case u.StructRefKind.CommaOpRef:var c=function(e,t,r){for(var n,i,a=r.refs.map((function(r){return function(e,t,r){switch(r.kind){case u.StructRefKind.ColumnRef:return C(t,r,!0);case u.StructRefKind.SpecialRef:return{kind:u.StructRefKind.SpecialRef,innerRef:r,resolution:P(e,t,r.id)};case u.StructRefKind.RangeOpRef:return R(t,r,!0);case u.StructRefKind.MissingRef:return{kind:u.StructRefKind.MissingRef,innerRef:r,resolution:p.successUndefined};case u.StructRefKind.BadRef:return{kind:u.StructRefKind.BadRef,innerRef:r,resolution:(0,p.failure)((0,m.invalidStructRef)(m.InvalidStructRefReason.InvalidOp))}}}(e,t,r)})),o=(0,u.commaOpRef)(a.map((function(e){return e.innerRef})),r.label),s=0,c=a;s<c.length;s++){var d=c[s].resolution;if(!(0,p.isSuccess)(d)&&d.reason.kind!==m.ResolveReasonKind.InvalidStructRef)return{commaOpRef:o,resolution:d}}for(var h,v,g=[],b=0,S=a;b<S.length;b++){var y=S[b];if(!(0,p.isSuccess)(y.resolution)||y.kind===u.StructRefKind.BadRef)return{commaOpRef:o,resolution:y.resolution};g.push((y.kind===u.StructRefKind.SpecialRef||(y.kind,u.StructRefKind.MissingRef),{kind:y.kind,resolution:y.resolution}))}if(!(0,l.isCommaOpRefWellFormed)(r))return{commaOpRef:o,resolution:(0,p.failure)((0,m.invalidStructRef)(m.InvalidStructRefReason.InvalidOp))};for(var O=0,N=g;O<N.length;O++){(y=N[O]).kind===u.StructRefKind.SpecialRef&&(h=(0,l.gridRangeJoinOpt)(h,null===(n=y.resolution.value)||void 0===n?void 0:n.range),void 0===v&&(v=null===(i=y.resolution.value)||void 0===i?void 0:i.sheet))}if(void 0===h||void 0===v)return{commaOpRef:o,resolution:p.successUndefined};for(var k=0,T=g;k<T.length;k++){if((y=T[k]).kind!==u.StructRefKind.SpecialRef&&(y.kind!==u.StructRefKind.MissingRef&&void 0===(h=(0,l.gridRangeIsect)(h,y.resolution.value.range))))return{commaOpRef:o,resolution:(0,p.failure)((0,m.invalidStructRef)(m.InvalidStructRefReason.InvalidOp))}}return{commaOpRef:o,resolution:(0,p.success)((0,f.sheetGridRange)(v,h))}}(e,t,r.innerRef);a=c.commaOpRef,o=c.resolution;return{structRef:(0,u.structRef)(a,r.isClosed,r.label),resolution:o};case u.StructRefKind.ThisRowOpRef:var d=P(e,t,u.SpecialRefId.ThisRow);if(g(d)||void 0===r.innerRef.ref)return{structRef:r,resolution:d};var h=r.innerRef.ref.kind===u.StructRefKind.ColumnRef?C(t,r.innerRef.ref):R(t,r.innerRef.ref),v=(a=h.innerRef,h.resolution),b=(0,u.thisRowOpRef)(a,a.label);if(g(v))return{structRef:(0,u.structRef)(b,r.isClosed,r.label),resolution:v};var S=(0,l.gridRangeIsect)(d.value.range,v.value.range);return S?{structRef:(0,u.structRef)(b,r.isClosed,r.label),resolution:(0,p.success)((0,f.sheetGridRange)(d.value.sheet,S))}:{structRef:r,resolution:(0,p.failure)((0,m.invalidStructRef)(m.InvalidStructRefReason.InvalidOp))};case u.StructRefKind.BadRef:return{structRef:r,resolution:(0,p.failure)((0,m.invalidStructRef)(m.InvalidStructRefReason.InvalidOp))}}}(t,n,s),T=k.structRef,E=k.resolution;return(0,m.resolvedStructRef)(E.kind===p.ResultKind.Failure&&E.reason.kind!==m.ResolveReasonKind.EmptyIntersection?r:(0,u.structRefNode)(c,T,r.label),n,E,i)},resolveUserDefinedFunc:k,resolveDottedName:function(e,t,r){var a,o,s=t.qualifier,c=t.parts,l=[],d={names:new Array,udfs:new Array},h=r[t.label],v=(null==h?void 0:h.kind)===u.AnnotationKind.AppHeadName;if(!s){var g=(0,u.headNamePart)(c);if(g.kind===u.NamePartKind.IdentNamePart){var b=function(e,t){var r=t[e.label];return(null==r?void 0:r.kind)===u.AnnotationKind.LocalNameUse?(0,m.resolvedLocalName)((0,u.nameNode)((0,u.identNamePart)(r.whole,e.canDenoteNamedObject,e.label,e.qualifiedLabel),void 0,e.qualifiedLabel),(0,p.success)(r)):(0,m.resolvedLocalName)((0,u.nameNode)((0,u.identNamePart)(e.asWhole,e.canDenoteNamedObject,e.label,e.qualifiedLabel),void 0,e.qualifiedLabel),p.successUndefined)}(g,r);if(void 0!==b.resolution.value){var S=(0,u.flattenNameParts)(c).parts.slice(1),C=S.map((function(e){var t=e.rhs;return(null==t?void 0:t.field.kind)===u.NodeKind.Name?t.field.whole:void 0})).filter((function(e){return void 0!==e}));if(C.length===S.length)return(0,m.resolvedDottedName)(b,C,d)}}}for(;;){if(c.canDenoteNamedObject){var P=(0,u.nameNode)((0,u.identNamePart)(c.asWhole,c.canDenoteNamedObject,c.label,c.qualifiedLabel),s,c.qualifiedLabel),N=O(e,P,v?f.NameSource.AppHead:f.NameSource.Plain);if(o=(0,m.resolvedDottedName)(N,n.__spreadArray([],l,!0).reverse(),d),(0,i.safePush)(d.names,N.precedents),!(0,p.isSuccess)(N.resolution)&&N.resolution.reason.kind!==m.ResolveReasonKind.InvalidQualifier||(0,p.isSuccess)(N.resolution)&&void 0!==N.resolution.value)return o;if(v&&(void 0===s||s.kind===u.QualifierKind.Document||s.kind===u.QualifierKind.Ident)){var R=k(e,P);if(o=(0,m.resolvedDottedName)(R,n.__spreadArray([],l,!0).reverse(),d),(0,i.safePush)(d.udfs,R.precedents),!(0,p.isSuccess)(R.resolution)&&R.resolution.reason.kind!==m.ResolveReasonKind.InvalidQualifier||(0,p.isSuccess)(R.resolution)&&void 0!==R.resolution.value)return o}}if(c.kind===u.NamePartKind.CellRefNamePart&&(null==s&&e.allowUnqualifiedCell||null!=s&&s.kind!==u.QualifierKind.Document)){var T=y(e,(0,u.cellRefNode)(c.ref,null!=s&&s.kind===u.QualifierKind.Ident?(0,u.sheetQualifier)(s.name):s,c.qualifiedLabel));return(0,m.resolvedDottedName)(T,n.__spreadArray([],l,!0).reverse(),d)}if(c.kind!==u.NamePartKind.FieldRefNamePart||(null===(a=c.rhs)||void 0===a?void 0:a.field.kind)!==u.NodeKind.Name)return void 0!==o?o:(0,m.resolvedDottedName)((0,m.resolvedNever)((0,u.nameNode)((0,u.identNamePart)(c.asWhole,c.canDenoteNamedObject,c.label,c.qualifiedLabel),s,c.qualifiedLabel)),n.__spreadArray([],l,!0).reverse(),d);l.push(c.rhs.field.whole),c=c.lhs,v=!1}}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSupported=t.strToPxchar=t.pxcharToStr=t.fastMin=t.Base_LocaleDecimalSeparator=t.Base_LocaleGetOrdinal=t.Base_LocaleIsNumeral=t.setLocale=void 0;var n=r(144),i=void 0;t.setLocale=function(e){i=e};t.Base_LocaleIsNumeral=function(e){return i.isNumeral(e)?1:0},t.Base_LocaleGetOrdinal=function(e){return i.getOrdinal(e)},t.Base_LocaleDecimalSeparator=function(){var e=i.decimalSeparator;return 0===e.length?46:e.charCodeAt(0)},t.fastMin=function(e,t){return e<t?e:t},t.pxcharToStr=function(e,t){for(var r=new Uint16Array(n.memory.buffer),i="",a=0;a<t;a+=1)i+=String.fromCharCode(r[e+(a<<1)>>1]);return i},t.strToPxchar=function(e,t){for(var r=new Uint16Array(n.memory.buffer),i=0;i<t.length;i+=1)r[e+(i<<1)>>1]=t.charCodeAt(i)},t.isSupported=function(){var e=new ArrayBuffer(2);return new Uint16Array(e)[0]=1,1===new Uint8Array(e)[0]}},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.formatDiagnostic=t.baseErrors=t.TypeSourceKind=t.TypeError=t.SyntaxError=void 0;var i,a,o,s=r(181),u=r(102);!function(e){e.Unclosed_application="Unclosed_application",e.Unclosed_paren="Unclosed_paren",e.Unclosed_bracket="Unclosed_bracket",e.Unclosed_array="Unclosed_array",e.Unclosed_literal="Unclosed_literal",e.Invalid_number_literal="Invalid_number_literal",e.Invalid_string_literal="Invalid_string_literal",e.Invalid_error_literal="Invalid_error_literal",e.Invalid_name="Invalid_name",e.Illegal_array_literal_element="Illegal_array_literal_element",e.Empty_array_literal="Empty_array_literal",e.Irregular_array_shape="Irregular_array_shape",e.Empty_parenthesis="Empty_parenthesis",e.Missing_operation_argument="Missing_operation_argument",e.Bad_node="Bad_node",e.Invalid_qualifier="Invalid_qualifier",e.Invalid_cell_ref="Invalid_cell_ref",e.Invalid_binder="Invalid_binder",e.Missing_binder="Missing_binder",e.Invalid_body="Invalid_body",e.Mandatory_binder_after_optional="Mandatory_binder_after_optional",e.Missing_default_expression="Missing_default_expression",e.Binder_requires_brackets="Binder_requires_brackets",e.Invalid_field_name="Invalid_field_name",e.Missing_field_name="Missing_field_name",e.Empty_formula="Empty_formula",e.Invalid_rel_sheet_qualifier_in_cell="Invalid_rel_sheet_qualifier_in_cell",e.Invalid_rel_sheet_qualifier_in_name="Invalid_rel_sheet_qualifier_in_name",e.Invalid_unqualified_cell="Invalid_unqualified_cell",e.Unexpected_closing_paren="Unexpected_closing_paren",e.Unexpected_closing_brace="Unexpected_closing_brace",e.Unexpected_closing_bracket="Unexpected_closing_bracket",e.Unexpected_character="Unexpected_character",e.Unexpected_field_ref="Unexpected_field_ref",e.Unexpected_dot="Unexpected_dot",e.Invalid_struct_ref_table_name="Invalid_struct_ref_table_name",e.Invalid_struct_ref_comma_parts="Invalid_struct_ref_comma_parts",e.Invalid_struct_ref_missing_part="Invalid_struct_ref_missing_part",e.Invalid_struct_ref_bad_part="Invalid_struct_ref_bad_part",e.Excess_higher_order_function_arguments="Excess_higher_order_function_arguments"}(i=t.SyntaxError||(t.SyntaxError={})),function(e){e.Types_not_related="Types_not_related",e.Unexpected_application_head="Unexpected_application_head",e.Unexpected_application_head_with_fix="Unexpected_application_head_with_fix",e.Incorrect_number_of_operator_arguments="Incorrect_number_of_operator_arguments",e.Excess_function_arguments="Excess_function_arguments",e.Insufficient_function_arguments="Insufficient_function_arguments"}(a=t.TypeError||(t.TypeError={})),function(e){e.WSFArgument="WSFArgument",e.OperatorArgument="OperatorArgument"}(o=t.TypeSourceKind||(t.TypeSourceKind={})),t.baseErrors=((n={})[i.Unclosed_application]={kind:i.Unclosed_application},n[i.Unclosed_paren]={kind:i.Unclosed_paren},n[i.Unclosed_bracket]={kind:i.Unclosed_bracket},n[i.Unclosed_array]={kind:i.Unclosed_array},n[i.Unclosed_literal]={kind:i.Unclosed_literal},n[i.Invalid_number_literal]={kind:i.Invalid_number_literal},n[i.Invalid_string_literal]={kind:i.Invalid_string_literal},n[i.Invalid_error_literal]={kind:i.Invalid_error_literal},n[i.Invalid_name]={kind:i.Invalid_name},n[i.Illegal_array_literal_element]={kind:i.Illegal_array_literal_element},n[i.Empty_array_literal]={kind:i.Empty_array_literal},n[i.Irregular_array_shape]={kind:i.Irregular_array_shape},n[i.Empty_parenthesis]={kind:i.Empty_parenthesis},n[i.Bad_node]={kind:i.Bad_node},n[i.Invalid_qualifier]={kind:i.Invalid_qualifier},n[i.Invalid_cell_ref]={kind:i.Invalid_cell_ref},n[i.Invalid_binder]={kind:i.Invalid_binder},n[i.Missing_binder]={kind:i.Missing_binder},n[i.Invalid_body]={kind:i.Invalid_body},n[i.Mandatory_binder_after_optional]={kind:i.Mandatory_binder_after_optional},n[i.Missing_default_expression]={kind:i.Missing_default_expression},n[i.Binder_requires_brackets]={kind:i.Binder_requires_brackets},n[i.Invalid_field_name]={kind:i.Invalid_field_name},n[i.Missing_field_name]={kind:i.Missing_field_name},n[i.Empty_formula]={kind:i.Empty_formula},n[i.Invalid_rel_sheet_qualifier_in_cell]={kind:i.Invalid_rel_sheet_qualifier_in_cell},n[i.Invalid_rel_sheet_qualifier_in_name]={kind:i.Invalid_rel_sheet_qualifier_in_name},n[i.Invalid_unqualified_cell]={kind:i.Invalid_unqualified_cell},n[i.Unexpected_closing_paren]={kind:i.Unexpected_closing_paren},n[i.Unexpected_closing_brace]={kind:i.Unexpected_closing_brace},n[i.Unexpected_closing_bracket]={kind:i.Unexpected_closing_bracket},n[i.Unexpected_field_ref]={kind:i.Unexpected_field_ref},n[i.Unexpected_dot]={kind:i.Unexpected_dot},n[i.Invalid_struct_ref_table_name]={kind:i.Invalid_struct_ref_table_name},n[i.Invalid_struct_ref_comma_parts]={kind:i.Invalid_struct_ref_comma_parts},n[i.Invalid_struct_ref_missing_part]={kind:i.Invalid_struct_ref_missing_part},n[i.Invalid_struct_ref_bad_part]={kind:i.Invalid_struct_ref_bad_part},n[a.Unexpected_application_head]={kind:a.Unexpected_application_head},n[a.Unexpected_application_head_with_fix]={kind:a.Unexpected_application_head_with_fix},n),t.formatDiagnostic=function(e){switch(e.kind){case a.Insufficient_function_arguments:case a.Excess_function_arguments:return"".concat(e.kind,": ").concat((0,s.englishWorksheetFuncIdToName)(e.funcId));case i.Missing_operation_argument:case a.Incorrect_number_of_operator_arguments:return"".concat(e.kind,": ").concat((0,s.englishOperatorIdToName)(e.opId));case i.Unexpected_character:return"".concat(e.kind,": ").concat((0,u.anonymizeFormulaString)(e.text));case a.Types_not_related:return"".concat(e.kind,": ").concat(function(e){var t=e.kind,r=e.argIndex;switch(e.kind){case o.WSFArgument:return JSON.stringify({kind:t,head:(0,s.englishWorksheetFuncIdToName)(e.head),argIndex:r});case o.OperatorArgument:return JSON.stringify({kind:t,head:(0,s.englishOperatorIdToName)(e.head),argIndex:r})}}(e.typeSource));default:return e.kind}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ulsLogger=t.operatorIdToName=t.localeInfo=t.isNumeralNew=t.isNumeralOld=t.getIsNumeral=t.isIdentStart=t.isIdentContinue=t.getOrdinalNew=t.getOrdinalOld=t.getGetOrdinal=t.getNumberShapeNew=t.getNumberShapeOld=t.getGetNumberShape=t.getEnglishWorksheetFuncIdToName=t.getEnglishLocaleInfo=t.englishWorksheetFuncIdToName=t.englishSysTimeFormat=t.englishSysDateFormat=t.englishSpecialRefNames=t.englishPictureSpecial=t.englishPictureSingle=t.englishPictureDbnum=t.englishPictureColor=t.englishOperatorIdToName=t.englishErrorTypeToName=t.englishErrorNames=t.createWorksheetFuncNameCallbacks=t.calcConfig=t.TraceLevel=t.PictureSpecial=t.PictureSingle=t.PictureDbnum=t.PictureColor=t.NulLogger=t.LogCategory=t.LCID=t.Country=void 0;var n=r(3);t.Country=n.config.Country,t.LCID=n.config.LCID,t.LogCategory=n.config.LogCategory,t.NulLogger=n.config.NulLogger,t.PictureColor=n.config.PictureColor,t.PictureDbnum=n.config.PictureDbnum,t.PictureSingle=n.config.PictureSingle,t.PictureSpecial=n.config.PictureSpecial,t.TraceLevel=n.config.TraceLevel,t.calcConfig=n.config.calcConfig,t.createWorksheetFuncNameCallbacks=n.config.createWorksheetFuncNameCallbacks,t.englishErrorNames=n.config.englishErrorNames,t.englishErrorTypeToName=n.config.englishErrorTypeToName,t.englishOperatorIdToName=n.config.englishOperatorIdToName,t.englishPictureColor=n.config.englishPictureColor,t.englishPictureDbnum=n.config.englishPictureDbnum,t.englishPictureSingle=n.config.englishPictureSingle,t.englishPictureSpecial=n.config.englishPictureSpecial,t.englishSpecialRefNames=n.config.englishSpecialRefNames,t.englishSysDateFormat=n.config.englishSysDateFormat,t.englishSysTimeFormat=n.config.englishSysTimeFormat,t.englishWorksheetFuncIdToName=n.config.englishWorksheetFuncIdToName,t.getEnglishLocaleInfo=n.config.getEnglishLocaleInfo,t.getEnglishWorksheetFuncIdToName=n.config.getEnglishWorksheetFuncIdToName,t.getGetNumberShape=n.config.getGetNumberShape,t.getNumberShapeOld=n.config.getNumberShapeOld,t.getNumberShapeNew=n.config.getNumberShapeNew,t.getGetOrdinal=n.config.getGetOrdinal,t.getOrdinalOld=n.config.getOrdinalOld,t.getOrdinalNew=n.config.getOrdinalNew,t.isIdentContinue=n.config.isIdentContinue,t.isIdentStart=n.config.isIdentStart,t.getIsNumeral=n.config.getIsNumeral,t.isNumeralOld=n.config.isNumeralOld,t.isNumeralNew=n.config.isNumeralNew,t.localeInfo=n.config.localeInfo,t.operatorIdToName=n.config.operatorIdToName,t.ulsLogger=n.config.ulsLogger},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.userDefinedFuncLoc=t.unsafeGridRange=t.structRefColumnLoc=t.sheetRows=t.sheetRangeIndexes=t.sheetRange=t.sheetIndex=t.sheetGridRange=t.sheetGridCube=t.sheetGridCell=t.sheetCols=t.originCell=t.nameScope=t.nameLoc=t.lexicalSourceUDF=t.lexicalSourceWSF=t.lexicalSourceRange=t.lexicalSourceName=t.lexicalSourceGrid=t.lexicalSourceCell=t.isSheetIndex=t.isSheetGridRange=t.isSheetGridCell=t.isGridCell=t.gridRange=t.gridCell=t.documentScope=t.documentLoc=t.allSheetsRange=t.NameSource=t.LexicalKind=void 0;var n=r(3);t.LexicalKind=n.location.LexicalKind,t.NameSource=n.location.NameSource,t.allSheetsRange=n.location.allSheetsRange,t.documentLoc=n.location.documentLoc,t.documentScope=n.location.documentScope,t.gridCell=n.location.gridCell,t.gridRange=n.location.gridRange,t.isGridCell=n.location.isGridCell,t.isSheetGridCell=n.location.isSheetGridCell,t.isSheetGridRange=n.location.isSheetGridRange,t.isSheetIndex=n.location.isSheetIndex,t.lexicalSourceCell=n.location.lexicalSourceCell,t.lexicalSourceGrid=n.location.lexicalSourceGrid,t.lexicalSourceName=n.location.lexicalSourceName,t.lexicalSourceRange=n.location.lexicalSourceRange,t.lexicalSourceWSF=n.location.lexicalSourceWSF,t.lexicalSourceUDF=n.location.lexicalSourceUDF,t.nameLoc=n.location.nameLoc,t.nameScope=n.location.nameScope,t.originCell=n.location.originCell,t.sheetCols=n.location.sheetCols,t.sheetGridCell=n.location.sheetGridCell,t.sheetGridCube=n.location.sheetGridCube,t.sheetGridRange=n.location.sheetGridRange,t.sheetIndex=n.location.sheetIndex,t.sheetRange=n.location.sheetRange,t.sheetRangeIndexes=n.location.sheetRangeIndexes,t.sheetRows=n.location.sheetRows,t.structRefColumnLoc=n.location.structRefColumnLoc,t.unsafeGridRange=n.location.unsafeGridRange,t.userDefinedFuncLoc=n.location.userDefinedFuncLoc},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.zipVisitor=t.voidVisitor=t.visitWSFNode=t.visitQualifier=t.visitOperatorNode=t.visitFormulaNode=t.visitCellRef=t.visitAppHeadNode=t.reduceTopDown_Pledge=t.reducePledge=t.reduceBottomUp_Recursive=t.reduceBottomUp_Pledge=t.reduceBottomUp_MaxDepth=t.reduceBottomUp_CPS=t.reduceBottomUp=t.identityVisitor=t.depthVisitor=t.constVisitor=t.composeVisitor=t.bindVisitor=t.binaryVisitor=t.ZipVisitor=t.PledgeReducer=t.IdentityVisitor=t.DelegatingVisitor=t.ConstVisitor=t.ComposeVisitor=t.BinaryVisitor=void 0;var n=r(3);t.BinaryVisitor=n.visitor.BinaryVisitor,t.ComposeVisitor=n.visitor.ComposeVisitor,t.ConstVisitor=n.visitor.ConstVisitor,t.DelegatingVisitor=n.visitor.DelegatingVisitor,t.IdentityVisitor=n.visitor.IdentityVisitor,t.PledgeReducer=n.visitor.PledgeReducer,t.ZipVisitor=n.visitor.ZipVisitor,t.binaryVisitor=n.visitor.binaryVisitor,t.bindVisitor=n.visitor.bindVisitor,t.composeVisitor=n.visitor.composeVisitor,t.constVisitor=n.visitor.constVisitor,t.depthVisitor=n.visitor.depthVisitor,t.identityVisitor=n.visitor.identityVisitor,t.reduceBottomUp=n.visitor.reduceBottomUp,t.reduceBottomUp_CPS=n.visitor.reduceBottomUp_CPS,t.reduceBottomUp_MaxDepth=n.visitor.reduceBottomUp_MaxDepth,t.reduceBottomUp_Pledge=n.visitor.reduceBottomUp_Pledge,t.reduceBottomUp_Recursive=n.visitor.reduceBottomUp_Recursive,t.reducePledge=n.visitor.reducePledge,t.reduceTopDown_Pledge=n.visitor.reduceTopDown_Pledge,t.visitAppHeadNode=n.visitor.visitAppHeadNode,t.visitCellRef=n.visitor.visitCellRef,t.visitFormulaNode=n.visitor.visitFormulaNode,t.visitOperatorNode=n.visitor.visitOperatorNode,t.visitQualifier=n.visitor.visitQualifier,t.visitWSFNode=n.visitor.visitWSFNode,t.voidVisitor=n.visitor.voidVisitor,t.zipVisitor=n.visitor.zipVisitor},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseFieldRef=t.isUnbracketedField=void 0;var n=r(59),i=r(79),a=r(89),o=r(115),s=r(98),u=r(97),c=r(66),l=r(114),d=r(145),f=d.codePointQuestionMark,p=d.codePointBackslash,m=d.codePointUnderscore;function h(e,t){if(0===t.length)return!1;var r,n=(0,l.stringCodePointAt)(t,0);return!((r=n)===m||r===p||!e.isIdentStart(r)&&!e.isNumeral(r))&&(0,l.codePointIterator)(t,(0,l.numCodeUnits)(n)).every((function(t){return t!==f&&t!==p&&e.isIdentContinue(t)}))}t.isUnbracketedField=h;var v=(0,a.take)((function(e,t){return(0,u.isBracketToken)(t)||t.kind===i.TokenKind.Escape||t.kind===i.TokenKind.End?void 0:t.chars})),g=(0,a.take)((function(e,t){return t.kind!==i.TokenKind.Ident||t.chars!==e.localeInfo.leftBracket&&t.chars!==e.localeInfo.rightBracket&&"'"!==t.chars?void 0:t.chars})),b=(0,a.any)(v,(0,a.right)(u.parseEscape,g)),S=(0,a.apply)((0,a.tuple)((0,a.many)(b),u.parseEnd),(function(e,t){var r=t[0];t[1];return r.join("")})),y=(0,a.applyTake)(u.parseBracketedTokens,(function(e,t){var r=t[0],i=t[1],o=(0,a.runParser)(S,r,0,e);if((0,c.isSuccess)(o)){var u=r[0].start,l=r[r.length-1].start,d=o.value.output;if(d.length>255){var f=r.map((function(e){return e.chars})).join("");return[(0,n.badNode)(n.BadType.FieldName,f,(0,s.addSpan)(e,u,l,"","")),!1,!0]}var p=(0,s.addSpan)(e,u,l,"",""),m=(0,s.addSpan)(e,u,l,"","");return[(0,n.nameNode)((0,n.identNamePart)(d,void 0,p,p),void 0,m),!0,i]}})),O=(0,a.apply)(u.parseIdentContinue,(function(e,t){var r=t.start,i=t.start+t.chars.length;if(!h(e.localeInfo,t.chars)||t.chars.length>255)return[(0,n.badNode)(n.BadType.FieldName,t.chars,(0,s.addSpan)(e,r,i,"","")),!1,!0];var a=(0,s.addSpan)(e,r,i,"",""),o=(0,s.addSpan)(e,r,i,"","");return[(0,n.nameNode)((0,n.identNamePart)(t.chars,void 0,a,a),void 0,o),!1,!0]}));t.parseFieldRef=(0,a.apply)((0,a.tuple)(u.parseCharIndex,u.parseSpaces,u.parseDotSepToken,(0,a.any)(O,y),u.parseCharIndex),(function(e,t){var r=t[0],i=t[1],a=t[2],u=t[3],c=u[0],l=u[1],d=u[2],f=t[4],p=(0,s.addSpan)(e,a.start,f,i,""),m=(0,n.fieldRef)(c,l,d,p);return(0,o.fieldRefTerm)(i.length>0,m,r,f)}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.values=t.stringStartsWith=t.stringEndsWith=t.repeat=t.prependErrorMessage=t.partialArray=t.messageFromError=t.mathLog2=t.isInteger=t.arrayFill=void 0;var n=r(7);t.arrayFill=n.util.arrayFill,t.isInteger=n.util.isInteger,t.mathLog2=n.util.mathLog2,t.messageFromError=n.util.messageFromError,t.partialArray=n.util.partialArray,t.prependErrorMessage=n.util.prependErrorMessage,t.repeat=n.util.repeat,t.stringEndsWith=n.util.stringEndsWith,t.stringStartsWith=n.util.stringStartsWith,t.values=n.util.values},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shouldInstallFormat=t.parseEdit=void 0;var n=r(130),i=r(241),a=r(90),o=r(187),s=r(190),u=r(76);function c(e){var t=(0,n.stringStartsWith)(e,"'"),r=t?e.substring(1):e;return r.length>i.cellStringLimit?(0,u.failure)((0,a.notValueString)("cell text too long")):(0,u.success)((0,a.stringEdit)((0,i.stringOper)(r),t))}function l(e,t,r){return(0,s.parseDateInternal)((0,s.initParseDateGlobals)(e),t,r,a.GetTimeKind.ValueCell)}function d(e,t,r){var n=e.config,i=n.localeInfo,s=n.mathpack,u=i.isEastAsia&&r.valueType===a.FormatValueType.Percentage&&!0,c=!1;switch(r.valueType){case a.FormatValueType.Number:case a.FormatValueType.Currency:case a.FormatValueType.Percentage:case a.FormatValueType.Fraction:case a.FormatValueType.Scientific:case a.FormatValueType.Accounting:c=!0}return(0,o.parseConstInternal)(i,s,t,u,!0,c)}function f(e,t,r){var n=function(e,t){if(0===e.stringCompareCI(t,e.trueName))return i.trueOper;if(0===e.stringCompareCI(t,e.falseName))return i.falseOper;for(var r=1;r<e.errorNames.length;r+=1){var n=e.errorNames[r];if(null!=n&&0===e.stringCompareCI(n,t))return(0,i.errorOper)(r)}}(e.config.localeInfo,t);if(void 0!==n)return(0,u.success)((0,a.otherEdit)(n));for(var o=0,s=r.valueType===a.FormatValueType.Date||r.valueType===a.FormatValueType.Time?[l,d]:[d,l];o<s.length;o++){var c=(0,s[o])(e,t,r);if(!(0,u.isSuccess)(c))return c;if(void 0!==c.value){var f=c.value,p=f.value,m=f.format;return(0,u.success)((0,a.numberEdit)(p,m))}}return(0,u.success)(void 0)}t.parseEdit=function(e,t,r){try{if(r.valueType===a.FormatValueType.Text)return c(t);if(""===t)return(0,u.success)((0,a.otherEdit)(i.blankOper));if((0,n.stringStartsWith)(t,"="))return(0,u.success)((0,a.formulaEdit)(t));if(!(0,n.stringStartsWith)(t,"'")){var o=f(e,t,r);if(!(0,u.isSuccess)(o))return o;if(void 0!==o.value)return(0,u.success)(o.value)}return"="===(s=t.charAt(0))||"+"===s||"-"===s||"@"===s?(0,u.success)((0,a.formulaEdit)(t)):c(t)}catch(e){return(0,u.failure)((0,u.javaScriptError)(e))}var s},t.shouldInstallFormat=function(e,t){return e!==t&&(t.source===a.NumberFormatSource.Builtin&&(t.valueType===a.FormatValueType.General||function(e,t){return(null==e?void 0:e.valueType)!==a.FormatValueType.Number&&t.valueType!==a.FormatValueType.Number&&(null==e?void 0:e.valueType)!==t.valueType}(e,t)))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseConstInternal=void 0;var n=r(2),i=r(188),a=r(80),o=r(91),s=r(132),u=r(148),c=r(76),l=u.codePointDollarSign,d=u.codePointBackslash,f=u.codePointPercentSign,p=u.codePointSpace,m=u.codePointLeftParen,h=u.codePointMinusSign,v=u.codePointPlusSign,g=u.codePointRightParen;function b(e,t,r,n){if(" "!==t&&""!==t){var i="$"===t;if(e.isEastAsia){if(n<r.length&&r.charCodeAt(n)===l&&!i)return{currency:1,i:n+1};if(n+2<r.length&&0===e.stringCompareCI(r.substring(n,n+3),"US$"))return{currency:e.isChinaT?1:2,i:n+3};if(("¥"===t&&e.isJapan||"₩"===t&&e.isKorea)&&n<r.length&&r.charCodeAt(n)===d)return{currency:0,i:n+1};if(e.isChinaT&&n+2<r.length&&0===e.stringCompareCI(r.substring(n,n+3),"NT$"))return{currency:2,i:n+3}}return n+t.length<=r.length&&0===e.stringCompareCI(r.substring(n,n+t.length),t)?{currency:0,i:n+t.length}:void 0}}function S(e,t,r,u,l,d){var S,y=0,O=!1,C=!1,P=!1,N=e.isCurrencySymbolLead,R=e.currencySymbol;0!==l&&(N=1===l,R="€");for(var k=0;k<r.length;){if(void 0===S&&N)if(void 0!==(F=b(e,R,r,k))){S=F.currency,k=F.i;continue}switch(I=r.charCodeAt(k)){case f:k+=1,y+=1;continue;case p:k+=1;continue;case m:case h:case v:if(k+=1,C)return(0,c.success)(void 0);C=!0,I===m&&(O=!0),P=I!==v;continue}break}var T=(0,i.parseNumberLiteral)(e,t,r,k,!0,y>0||u,d);if(void 0===T||void 0===T.value)return(0,c.success)(void 0);k=T.i;for(var E,_=P?t.neg(T.value):T.value;k<r.length;){var F,I;if(void 0===S&&!N)if(void 0!==(F=b(e,R,r,k))){S=F.currency,k=F.i;continue}switch(I=r.charCodeAt(k)){case f:k+=1,y+=1;continue;case p:k+=1;continue;case g:if(k+=1,!O)return(0,c.success)(void 0);O=!1;continue}break}if(k!==r.length||O||y>1||void 0!==S&&y>0)return(0,c.success)(void 0);if(void 0!==T.format)E=T.format;else if(1===S)E=T.consumedDecimal?o.KnownFormat.USCoCurrencyDec:o.KnownFormat.USCoCurrency;else if(2===S){E=e.isChinaT?T.consumedDecimal?'"NT$"#,##0.00_);("NT$"#,##0.00)':'"NT$"#,##0_);("NT$"#,##0)':T.consumedDecimal?'"US$"#,##0.00_);("US$"#,##0.00)':'"US$"#,##0_);("US$"#,##0)'}else{if(T.numShape!==o.NumberShape.ASCII)return(0,c.failure)((0,a.notImplemented)(["parseConstInternal ifmt for non-ASCII"]));if(void 0!==S)switch(l){case 0:E=T.consumedDecimal?o.KnownFormat.CoCurrencyDec:o.KnownFormat.CoCurrency;break;case 1:E=(0,s.buildCurrencyFormat)(n.__assign(n.__assign({},e),{isCurrencySymbolLead:!0,isCurrencySepBySpace:!0}),!0,T.consumedDecimal?2:0,!0,!1,"[$€-x-euro2]");break;case 2:E=(0,s.buildCurrencyFormat)(n.__assign(n.__assign({},e),{isCurrencySymbolLead:!1,isCurrencySepBySpace:!0}),!0,T.consumedDecimal?2:0,!0,!1,"[$€-x-euro1]")}else E=y>0?T.consumedDecimal?o.KnownFormat.Pct:o.KnownFormat.Pct0:T.consumedThousands?T.consumedDecimal?o.KnownFormat.Fixed:o.KnownFormat.Fixed0:o.KnownFormat.General}return(0,c.success)({value:_,format:E})}t.parseConstInternal=function(e,t,r,n,i,a){if(!i)return S(e,t,r,n,0,a);for(var o=0;o<=2;o+=1){var s=S(e,t,r,n,o,a);if(!(0,c.isSuccess)(s))return s;if(void 0!==s.value)return s;if(0===o&&r.indexOf("€")<0)break}return(0,c.success)(void 0)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseUint=t.parseSignedLiteral=t.parseNumberLiteral=t.isSpace=void 0;var n=r(3);t.isSpace=n.literalParse.isSpace,t.parseNumberLiteral=n.literalParse.parseNumberLiteral,t.parseSignedLiteral=n.literalParse.parseSignedLiteral,t.parseUint=n.literalParse.parseUint},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.surrogatePairToCodePoint=t.stringFromCodePoint=t.stringCodePointAt=t.scanCodePointsBack=t.scanCodePoints=t.numCodeUnits=t.makeGetCharCodeBits=t.isLowSurrogate=t.isHighSurrogate=t.isAnySurrogate=t.forEachClassInterval=t.countCodePoints=t.codePointIterator=t.CharCodeBits=void 0;var n=r(7);t.CharCodeBits=n.unicode.CharCodeBits,t.codePointIterator=n.unicode.codePointIterator,t.countCodePoints=n.unicode.countCodePoints,t.forEachClassInterval=n.unicode.forEachClassInterval,t.isAnySurrogate=n.unicode.isAnySurrogate,t.isHighSurrogate=n.unicode.isHighSurrogate,t.isLowSurrogate=n.unicode.isLowSurrogate,t.makeGetCharCodeBits=n.unicode.makeGetCharCodeBits,t.numCodeUnits=n.unicode.numCodeUnits,t.scanCodePoints=n.unicode.scanCodePoints,t.scanCodePointsBack=n.unicode.scanCodePointsBack,t.stringCodePointAt=n.unicode.stringCodePointAt,t.stringFromCodePoint=n.unicode.stringFromCodePoint,t.surrogatePairToCodePoint=n.unicode.surrogatePairToCodePoint},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.parseDateInternal=t.initParseDateGlobals=void 0;var i=r(2),a=r(133),o=r(90),s=r(131),u=r(80),c=r(189),l=r(148),d=r(188),f=r(92),p=r(91),m=r(242),h=r(130),v=r(76),g=l.codePointSlash,b=l.codePointSpace,S=l.codePointMinusSign,y=l.codePointColon,O={getTime:function(){return(0,f.assertFalse)("calc.numfmt.parseDateInternal: default getTime")}};function C(e,t){return(0,f.assertTrue)("calc.numfmt.monthToken",B(e,1,12)),{kind:0,value:e,bidiDate:t}}t.initParseDateGlobals=function(e){var t,r;return{config:e.config,getTime:null!==(r=null===(t=e.getTime)||void 0===t?void 0:t.bind(e))&&void 0!==r?r:O.getTime}};var P=i.__spreadArray([],new Array(12),!0).map((function(e,t){return C(t+1)})),N=function(e){return P[e]},R=function(e){return C(e+1,o.BidiDate.English)},k=function(e){return C(e+1,o.BidiDate.Lunar)},T=[!0,!1].map((function(e){return{kind:1,am:e}})),E=T[0],_=T[1],F=function(e){return 0===e?E:_};function I(e,t,r){return(0,f.assertTrue)("calc.numfmt.numberToken",(0,h.isInteger)(e)&&B(e,-9999,9999)&&B(t,1,4)),{kind:2,value:e,digits:t,numShape:r}}var A=function(e){return 3===e||4===e},M=function(e,t){return e.lcid===a.LCID.Hungarian&&2===t},w=function(e){return e<=1},D=function(e){return e<=2},j=["上午","下午"],x=((n={})[a.Country.FRN]=[["Jun",C(6)],["Jul",C(7)]],n[a.Country.DUT]=[["Mrt",C(3)]],n[a.Country.GER]=[["Mrz",C(3)]],n),L=["محرم","صفر","ربيع الاول","ربيع الثاني","جمادى الاولى","جمادى الثانية","رجب","شعبان","رمضان","شوال","ذو القعدة","ذو الحجة"];function B(e,t,r){return e>=t&&e<=r}function U(e,t){var r=e.getTime(m.TimeGranularity.Year,t);if(!(0,v.isSuccess)(r))return r;var n=e.config,i=n.datepack.fromNum(n,r.value,m.Rounding.RoundSec);return(0,f.assertTrue)("calc.numfmt.parseDateInternal: current year fromNum",!1!==i),(0,v.success)(i.yr)}function G(e,t,r,n){return n+t.length<=r.length&&0===e.stringCompareCI(t,r.substring(n,n+t.length))}function K(e,t,r,n,i,a){for(var o=t.indexOf(" ",r),u=0;u<n.length;u+=1){var c=n[u],l=(0,s.fastMin)(i,c.length);if(o>=0&&c.indexOf(" ")<0&&o-r>=l&&o-r<=c.length)if(G(e,p=c.substring(0,o-r),t,r))return[a(u),r+p.length];for(var d=void 0,f=l;f<=c.length;f+=1){var p;if(!G(e,p=c.substring(0,f),t,r))break;d=r+p.length}if(void 0!==d)return[a(u),d]}}function V(e,t,r,n,i){for(var a=0;a<n.length;a+=1){var o=n[a];if(G(e,o,t,r))return[i(a),r+o.length]}}function W(e,t,r){var n,i=x[e.country];if(void 0!==i)for(var o=0,s=i;o<s.length;o++){var u=s[o],c=u[0],l=u[1];if(G(e,c,t,r))return[l,r+c.length]}if(e.isEastAsia){if(void 0!==(n=K(e,t,r,(0,a.getEnglishLocaleInfo)().monthNameLong,3,N)))return n}else if(e.isComplexScript){if(void 0!==(n=V(e,t,r,e.monthNameLong,N)))return n;if(void 0!==(n=V(e,t,r,e.monthNameShort,N)))return n;if(void 0!==(n=V(e,t,r,(0,a.getEnglishLocaleInfo)().monthNameLong,R)))return n;if(void 0!==(n=V(e,t,r,(0,a.getEnglishLocaleInfo)().monthNameShort,R)))return n}else if(void 0!==(n=K(e,t,r,e.monthNameLong,3,N)))return n;return(e.lcid&a.LCID.LANG)==(a.LCID.Arabic&a.LCID.LANG)&&void 0!==(n=V(e,t,r,L,k))||void 0!==(n=K(e,t,r,e.ampmSymbols,1,F))||void 0!==(n=K(e,t,r,(0,a.getEnglishLocaleInfo)().ampmSymbols,1,F))||(e.isChinaS||e.isChinaT)&&void 0!==(n=K(e,t,r,j,1,F))?n:[void 0,r]}function H(e,t,r,n){var i,a,o,s,u,l=r,m=t.charCodeAt(l)===S;if(m&&(l+=1),5===n){if(o=(i=(0,d.parseUint)(e,4,l+4<t.length?t.substring(0,l+4):t,l))[0],u=(s=i[1])-l,(0,f.assertTrue)("calc.numfmt.parseDateInternal: 0 < digits <= 4",B(u,1,4)),4===u){for(var h=void 0;s<t.length&&e.isNumeral(h=(0,c.stringCodePointAt)(t,s));)s+=(0,c.numCodeUnits)(h);o=Math.round(o/10),u=3}}else if(o=(a=(0,d.parseUint)(e,4,t,l))[0],(u=(s=a[1])-l)>4||u>2&&o<100)return[void 0,r];if(0===u)return[void 0,r];var v=function(e,t){for(var r=p.NumberShape.ASCII,n=0,i=(0,c.codePointIterator)(t);n<i.length;n++){var a=i[n],o=e.getNumberShape(a);o!==p.NumberShape.ASCII&&(r=o)}return r}(e,t.substring(l,s));return l=s,[I(m?-o:o,u,v),l]}function q(e,t,r,n){var i=0,a=r;if(t.charCodeAt(a)===b)for(i=1;t.charCodeAt(a)===b;)a+=1;return null!=e.timeAltSeparator&&e.timeAltSeparator!==e.timeSeparator&&3===n&&(0,h.stringStartsWith)(t,e.timeAltSeparator,a)?(i=4,a+=e.timeAltSeparator.length):(0,h.stringStartsWith)(t,e.dateSeparator,a)?(i=2,a+=e.dateSeparator.length):(0,h.stringStartsWith)(t,e.timeSeparator,a)?(i=3,a+=e.timeSeparator.length):(0,h.stringStartsWith)(t,e.decimalSeparator,a)&&3===n?(i=5,a+=e.decimalSeparator.length):t.charCodeAt(a)===g||t.charCodeAt(a)===S?(i=2,a+=1):t.charCodeAt(a)===y?(i=3,a+=1):(0,h.stringStartsWith)(t,", ",a)&&(i=6,a+=2),1===i&&(" "===e.dateSeparator?i=2:" "===e.timeSeparator?i=3:" "===e.decimalSeparator&&3===n&&(i=5)),[i,a]}t.parseDateInternal=function(e,t,r,n){var i=e.config,a=i.localeInfo;if(!a.isEastAsia&&!function(e,t){for(var r=0,n=(0,c.codePointIterator)(t);r<n.length;r++){var i=n[r];if(e.isNumeral(i))return!0}return!1}(a,t))return(0,v.success)(void 0);if(a.isEastAsia)return(0,v.failure)((0,u.notImplemented)(["parse East Asia date"]));if(a.isThai){var s=t.indexOf("b");if(s<0&&(s=t.indexOf("B")),s>=0&&s+1<t.length&&a.isNumeral((0,c.stringCodePointAt)(t,s+1)))return(0,v.failure)((0,u.notImplemented)(["parse Thai Buddhist date"]))}var l=function(e,t,r){for(var n,i=e.localeInfo,a=e.dateCompatibility,o=[],s=null==r?void 0:r.bidiDate,l=p.NumberShape.ASCII,d=null==r?void 0:r.culture,m=!1,h=!1,g=0;g<t.length;){if(o.length>=9)return(0,v.success)(void 0);var y=void 0;if(i.isNumeral((0,c.stringCodePointAt)(t,g))||!a&&g+1<t.length&&t.charCodeAt(g)===S&&i.isNumeral((0,c.stringCodePointAt)(t,g+1))){var O=H(i,t,g,n),C=O[0],P=O[1];if(void 0===C)return(0,v.success)(void 0);g=P,C.numShape!==p.NumberShape.ASCII&&(l=C.numShape),y=C}else{if(t.charCodeAt(g)===b)return(0,v.failure)((0,u.notImplemented)(["absurd date/time string with leading space"]));var N=W(i,t,g),R=N[0],k=N[1];if(void 0===R)return(0,v.success)(void 0);if(g=k,0===R.kind){if(m)return(0,v.success)(void 0);m=!0,void 0!==R.bidiDate&&(s=R.bidiDate)}if(1===R.kind){if(h)return(0,v.success)(void 0);if(h=!0,0===o.length||1!==o[o.length-1].sep)return(0,v.success)(void 0);n=o[o.length-1].sep=3}y=R}var T=q(i,t,g,n),E=T[0];for(g=T[1];g<t.length&&t.charCodeAt(g)===b;)g+=1;o.push({tok:y,sep:E}),n=E}return(0,f.assertTrue)("calc.numfmt.parseDateInternal: > 0 tokens",0!==o.length),(0,v.success)({tokens:o,bidiDate:s,numShape:l,culture:d})}(i,t,r);if(!(0,v.isSuccess)(l)||void 0===l.value)return l;var d=l.value,h=d.tokens,g=d.bidiDate,y=d.numShape,O=d.culture;if(g===o.BidiDate.Lunar)return(0,v.failure)((0,u.notImplemented)(["Lunar calendar"]));if(void 0!==O&&(O.localCalendarInput||O.tag===o.CultureTag.Gannen))return(0,v.failure)((0,u.notImplemented)(["parse date: possible local calendar"]));var C=function(e,t){for(var r,n,i,a,o,s,c,l=e.localeInfo,d=0;d<t.length;d+=1)if(A(t[d].sep)){r={start:d,end:d+1};break}if(void 0!==r){if(0!==r.start&&1!==t[r.start-1].sep&&!M(l,t[r.start-1].sep))return(0,v.success)(void 0);for(;r.end<t.length&&A(t[r.end-1].sep);)r.end+=1;if(r.end<t.length&&5===t[r.end-1].sep){r.end+=1;var p=t[r.end-1];if(2!==p.tok.kind)return(0,v.success)(void 0);p.tok;if(s=p,r.end<t.length&&A(t[r.end-1].sep)){if(r.end+=1,1!==(m=t[r.end-1]).tok.kind)return(0,v.failure)((0,u.notImplemented)(["non-AM/PM after FracSec"]));m.tok;c=m}}else{var m;if(1===(m=t[r.end-1]).tok.kind){m.tok;c=m}}var h=r.end-r.start-(void 0!==s?1:0)-(void 0!==c?1:0);for(d=0;d<h;d+=1)if(2!==t[r.start+d].tok.kind)return(0,v.failure)((0,u.notImplemented)(["non-number in H/M/S component"]));switch(h){case 0:return(0,f.assertFalse)("calc.numfmt.parseDateInternal: 0 time");case 1:(0,f.assertTrue)("calc.numfmt.parseDateInternal: 1 time => !fracSec",void 0===s),i=t[r.start];break;case 2:void 0===s?(i=t[r.start],a=t[r.start+1]):(a=t[r.start],o=t[r.start+1]);break;case 3:i=t[r.start],a=t[r.start+1],o=t[r.start+2];break;default:return(0,v.success)(void 0)}for(d=r.end;d<t.length;d+=1)if(A(t[d].sep))return(0,v.success)(void 0);if(r.end===t.length){var g=t[r.end-1].sep;if(!(w(g)||void 0!==c&&5===g))return(0,v.failure)((0,u.notImplemented)(["trailing sep after time"]))}else{var b=t[r.end-1].sep;if(!w(b)&&6!==b)return(0,v.failure)((0,u.notImplemented)(["unexpected sep between time and date"]))}if(0===r.start)r.end!==t.length&&(n={start:r.end,end:t.length});else{if(r.end!==t.length)return(0,v.failure)((0,u.notImplemented)(["date part split around time part"]));n={start:0,end:r.start}}}else n={start:0,end:t.length};return(0,v.success)({time:r,date:n,hour:i,min:a,sec:o,fracSec:s,ampm:c})}(i,h);if(!(0,v.isSuccess)(C)||void 0===C.value)return C;var P=C.value,N=P.time,R=P.date,k=P.hour,T=P.min,E=P.sec,_=P.fracSec,F=P.ampm,j=function(e,t,r,n){var i,a,o,s=e.config,c=s.localeInfo,l=s.dateCompatibility,d=s.datepack,m=!1;if(void 0!==n){var h=n.end-n.start;if(h<2||h>3)return(0,v.success)(void 0);var g=r[n.start],b=g.tok,S=g.sep,y=r[n.start+1],O=y.tok,C=y.sep,P=r[n.end-1],N=P.tok,R=P.sep;if((0,f.assertTrue)("calc.numfmt.parseDateInternal: all not AM/PM",1!==b.kind&&1!==O.kind&&1!==N.kind),!w(R)&&!M(c,R))return(0,v.success)(void 0);var k=void 0!==function(e,t){for(var r=t.start;r<t.end;r+=1)if(0===e[r].tok.kind)return r}(r,n);if(m=k,k)if(D(S)&&D(C))if(0===b.kind){if(h>2)return(0,v.success)(void 0);a=b,(0,f.assertTrue)("calc.numfmt.parseDateInternal: yr not Month",0!==N.kind),i=N}else{if(0!==O.kind)return(0,v.success)(void 0);o=b,a=O,3===h&&((0,f.assertTrue)("calc.numfmt.parseDateInternal: yr not Month",0!==N.kind),i=N)}else{if(3!==h)return(0,v.success)(void 0);if(w(C))return(0,v.success)(void 0);var T=c.longDateFormat?b:O,E=c.longDateFormat?O:b;if(0!==T.kind)return(0,v.success)(void 0);(0,f.assertTrue)("calc.numfmt.parseDateInternal: Int1 dom & yr not Month",0!==E.kind&&0!==N.kind),o=E,a=T,i=N}else if((0,f.assertTrue)("calc.numfmt.parseDateInternal: all not Month",0!==b.kind&&0!==O.kind&&0!==N.kind),2===h&&2===S)switch(m=!0,c.dateOrder){case p.DateOrder.MDY:a=b,i=N;break;case p.DateOrder.YMD:B(b.value,1,12)?(a=b,o=N):(i=b,a=N);break;case p.DateOrder.DMY:B(N.value,1,12)?(o=b,a=N):(a=b,i=N);break;default:return(0,v.failure)((0,u.notImplemented)(["date parse date order"]))}else{if(h<3||2!==S||2!==C)return(0,v.success)(void 0);switch(b.value>999||!l&&b.value>99?p.DateOrder.YMD:c.dateOrder){case p.DateOrder.MDY:a=b,o=O,i=N;break;case p.DateOrder.YMD:i=b,a=O,o=N;break;case p.DateOrder.DMY:o=b,a=O,i=N;break;default:return(0,v.failure)((0,u.notImplemented)(["date parse date order"]))}}}var _=!1;if(c.dateOrder!==p.DateOrder.DMY&&void 0===o&&void 0!==a&&B(a.value,1,12)&&void 0!==i&&B(i.value,1,31)){var F=U(e,t);if(!(0,v.isSuccess)(F))return F;i.value<=d.daysPerMonth(a.value,F.value,l)&&(o=i,i=I(F.value,4,p.NumberShape.ASCII),_=!0)}return(0,v.success)({yr:i,mon:a,dom:o,useMonthName:m,usingCurrentYear:_})}(e,n,h,R);if(!(0,v.isSuccess)(j)||void 0===j.value)return j;var x=j.value,L=x.yr,G=x.mon,K=x.dom,V=x.useMonthName,z=x.usingCurrentYear,Q=function(e,t,r,n,i,a,o,s,c,l){var d,p,h,g,b=e.config,S=b.mathpack,y=b.datepack,O=b.dateCompatibility;if(void 0!==n||void 0!==i||void 0!==r){if((0,f.assertTrue)("calc.numfmt.parseDateInternal: dom || yr",void 0!==i||void 0!==r),(0,f.assertTrue)("calc.numfmt.parseDateInternal: mon",void 0!==n),!B(h=n.value,1,12))return(0,v.success)(void 0);if(void 0===r){var C=U(e,t);if(!(0,v.isSuccess)(C))return C;p=C.value}else p=B(r.value,0,99)?function(e){return 1900+(e<30?100:0)+e}(r.value):r.value;if(!B(p,1900,9999))return(0,v.success)(void 0);if(!B(g=null!==(d=null==i?void 0:i.value)&&void 0!==d?d:1,1,y.daysPerMonth(h,p,O)))return(0,v.success)(void 0)}else{var P=y.fromNum(b,S.zero,m.Rounding.RoundSec);(0,f.assertTrue)("calc.numfmt.parseDateInternal: zeroDtr fromNum",!1!==P),p=P.yr,h=P.mon,g=P.dom}var N,R=0,k=0,T=0,E=0,_=m.Rounding.RoundSec,F=0;if(void 0!==a){if(a.value<0)return(0,v.failure)((0,u.notImplemented)(["negative hour"]));if(a.value>23){if(void 0!==N)return(0,v.success)(void 0);F=a.value,N=m.TimeDivision.Hour}else R=a.value}if(void 0!==o){if(o.value<0)return(0,v.failure)((0,u.notImplemented)(["negative minute"]));if(o.value>59){if(void 0!==N)return(0,v.success)(void 0);F=o.value,N=m.TimeDivision.Minute}else k=o.value}if(void 0!==s){if(s.value<0)return(0,v.failure)((0,u.notImplemented)(["negative second"]));if(s.value>59){if(void 0!==N)return(0,v.success)(void 0);F=s.value,N=m.TimeDivision.Second}else T=s.value}if(void 0!==c){if(c.value<0)return(0,v.failure)((0,u.notImplemented)(["negative fractional second"]));(0,f.assertTrue)("calc.numfmt.parseDateInternal: fracSec.digits",c.digits>=1&&c.digits<=3),_=c.digits,(0,f.assertTrue)("calc.numfmt.parseDateInternal: fracSec.value",c.value<(3===_?1001:2===_?100:10)),E=c.value}if(void 0!==l){if(void 0!==N||R>12)return(0,v.success)(void 0);l.am?12===R&&(R=0):R<12&&(R+=12)}var I=(0,m.dateTime)(p,h,g,R,k,T,1,E,_),A=void 0!==N?y.toNumWithDuration(b,I,N,F):y.toNum(b,I);return(0,u.isErrorOper)(A)?(0,v.success)(void 0):(0,v.success)({value:A,duration:N})}(e,n,L,G,K,null==k?void 0:k.tok,null==T?void 0:T.tok,null==E?void 0:E.tok,null==_?void 0:_.tok,null==F?void 0:F.tok);if(!(0,v.isSuccess)(Q)||void 0===Q.value)return Q;var J=Q.value,Y=J.value,$=function(e,t,r,n,i,a,o,s,c,l,d,h){if(e!==p.NumberShape.ASCII)return(0,v.failure)((0,u.notImplemented)(["parseDateInternal ifmt for non-ASCII"]));if(o)return 4===(null==s?void 0:s.sep)?(0,v.failure)((0,u.notImplemented)(["parseDateInternal ifmt for alternate time separator"])):void 0!==l?(0,v.success)(p.KnownFormat.SS0):void 0!==h?h!==m.TimeDivision.Hour||void 0!==d||t?(0,v.success)(p.KnownFormat.General):(0,v.success)(p.KnownFormat.AbsHMMSS):t?(0,v.success)(p.KnownFormat.MDYHMS):void 0!==d?(0,v.success)(void 0!==c?p.KnownFormat.HHMMSSAP:p.KnownFormat.HHMMAP):(0,v.success)(void 0!==c?p.KnownFormat.HHMMSS:p.KnownFormat.HHMM);if((0,f.assertTrue)("calc.numfmt.parseDateInternal: !haveTime => haveDate",t),!i)return(0,v.success)(p.KnownFormat.MMDDYY);var g=void 0!==r&&!a;return(0,v.success)(void 0===n?p.KnownFormat.MMMYY:g?p.KnownFormat.DDMMMYY:p.KnownFormat.DDMMM)}(y,void 0!==R,L,K,V,z,void 0!==N,T,E,_,F,J.duration);return(0,v.isSuccess)($)?(0,v.success)({value:Y,format:$.value}):$}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.functionType=t.SpecialPrecs=t.SignatureType=t.OperKind=t.FunctionFlags=void 0;var n=r(3);t.FunctionFlags=n.types.FunctionFlags,t.OperKind=n.types.OperKind,t.SignatureType=n.types.SignatureType,t.SpecialPrecs=n.types.SpecialPrecs,t.functionType=n.types.functionType},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.renderHashesValue=t.renderValue=t.renderGeneral=void 0;var n=r(90),i=r(80),a=r(92),o=r(131),s=r(147),u=r(130),c=r(76),l=function(e){return e.kind!==n.FormattedUnitKind.General},d=function(e){return e.kind!==n.FormattedUnitKind.Flexible};function f(e,t,r){return 0!=(t&n.Clip.MaxChars)&&r.length>255?n.Clip.MaxChars:0!=(t&n.Clip.CellWidth)&&e.renderWidth<1/0&&e.getTextWidth(r)>e.renderWidth?n.Clip.CellWidth:void 0}function p(e,t,r,n,i,s,u){var c=(0,o.fastMax)(0,255-r.length-n.length),l=0===i.length?c:Math.floor(c/i.length);if(e.renderWidth!==1/0){var d=e.getTextWidth(i);d>0&&(l=(0,o.fastMin)(l,(0,o.fastMax)(Math.floor((e.renderWidth-e.getTextWidth(r+n))/d),0)))}var p,m=u(l);if(e.bestFit&&s&&(!1===m||m.indexOf("E")>=0)){for(var h=1,g=m;(!1===g||g.indexOf("E")>=0)&&l+h<=v;)g=u(l+h),h++;if(!1!==g)return g}if(!1===m||void 0===(p=f(e,t,r+m+n))){for(var b=m,S=l+1;S<l+50;S+=1){if(!1!==(O=u(S))){if(O===b)break;if(void 0!==(C=f(e,t,r+O+n))){!1===b&&(b=C);break}b=O}}return(0,a.assertTrue)("calc.numfmt.renderValue: false after upwards search",!1!==b),b}var y=p;for(S=l-1;S>=0;S-=1){var O,C;if(!1===(O=u(S)))break;if(void 0===(C=f(e,t,r+O+n)))return O;y=C}return y}var m=(0,i.createFailureErrorClass)("RenderHashesError"),h=(0,i.createFailureErrorClass)("RenderError"),v=11;function g(e,t,r){var n=e.fromNumber(t.num),i=t.includeSign&&e.cond(n)<0?"-":"",o=i+e.formatGeneral(t,e.abs(n),r-i.length);if("-0"===o&&(o="0"),o.length>r)return(0,c.success)(!1);var u=o.indexOf("E");if(u>=0){var l=(0,s.convertNumberShape)(t,o.substring(0,u),t.expNumberShape);if(!(0,c.isSuccess)(l))return l;var d=o.substring(u,u+2),f=(0,s.convertDigitsShape)(o.substring(u+2),t.expNumberShape);return(0,a.assertTrue)("calc.numfmt.render: formatGeneral ePart","E-"===d||"E+"===d),(0,c.success)(l.value+d+f)}var p=(0,s.convertNumberShape)(t,o,t.numberShape);return(0,c.isSuccess)(p)?(0,c.success)(p.value):p}t.renderGeneral=g,t.renderValue=function(e,t,r){try{return(0,n.isHashesValue)(t)?(0,c.success)((0,n.hashesValue)(t.units,t.color)):(0,c.success)(function(e,t,r){var i,s,b=t.units,S=t.color,y=t.alignment,O=t.clip,C=(0,n.memoizedRenderCallback)(r);if(b.every(l))i=b;else if(C.renderWidth===1/0)i=b.map((function(t){if(t.kind!==n.FormattedUnitKind.General)return t;var r=g(e,t,v);if(!(0,c.isSuccess)(r))throw new h(r.reason);return(0,a.assertTrue)("calc.numfmt.renderValue: false after format at defaultGenPrecision",!1!==r.value),(0,n.formattedUnitString)(r.value)}));else{for(var P="",N="",R=void 0,k=void 0,T=0;T<b.length;T+=1){var E=b[T];switch(E.kind){case n.FormattedUnitKind.String:case n.FormattedUnitKind.Blank:void 0!==R?N+=E.str:P+=E.str;break;case n.FormattedUnitKind.General:(0,a.assertTrue)("calc.numfmt.renderValue: expected a single General unit",void 0===R),R=T,k=E;break;case n.FormattedUnitKind.Flexible:}}(0,a.assertTrue)("calc.numfmt.renderValue: genUnit",void 0!==R&&void 0!==k);var _=k,F=p(C,O,P,N,"0",_.builtin,(function(t){var r=g(e,_,(0,o.fastMin)(t,v));if(!(0,c.isSuccess)(r))throw new h(r.reason);return r.value}));if("number"==typeof F)throw new m((0,n.tooWide)(F));i=b.map((function(e){return e.kind===n.FormattedUnitKind.General?(0,n.formattedUnitString)(F):e}))}if(i.every(d))s=i;else if(C.renderWidth===1/0||C.bestFit)s=i.filter(d);else{P="",N="";var I,A=void 0;for(T=0;T<i.length;T+=1){var M=i[T];switch(M.kind){case n.FormattedUnitKind.String:case n.FormattedUnitKind.Blank:void 0!==I?N+=M.str:P+=M.str;break;case n.FormattedUnitKind.Flexible:I=T,A=M}}(0,a.assertTrue)("calc.numfmt.renderValue: lastFlexUnit",void 0!==I&&void 0!==A);var w=A,D=p(C,n.Clip.All,P,N,A.str,!1,(function(e){return(0,u.repeat)(w.str,e)}));if("number"==typeof D){if(0!=(D&O))throw new m((0,n.tooWide)(D));D=""}var j=D.length/w.str.length;j=(0,o.fastMax)(j-1,0);var x=(0,u.repeat)(w.str,j);s=i.map((function(e,t){return e.kind!==n.FormattedUnitKind.Flexible?e:(0,n.formattedUnitString)(t===I?x:"")}))}if(O!==n.Clip.None){var L="";for(T=0;T<s.length;T+=1)L+=s[T].str;var B=f(C,O,L);if(C.bestFit&&B===n.Clip.CellWidth)return(0,n.renderedValue)(s,S,y,O);if(void 0!==B)throw new m((0,n.tooWide)(B))}return(0,n.renderedValue)(s,S,y,O)}(e,t,r))}catch(e){return e instanceof m?(0,c.success)((0,n.hashesValue)(e.reason,t.color)):e instanceof h?(0,c.failure)(e.reason):(0,c.failure)((0,c.javaScriptError)(e))}},t.renderHashesValue=function(e,t){try{var r=p((0,n.memoizedRenderCallback)(t),e.clip,"","","#",!1,(function(e){return(0,u.repeat)("#",e)}));if("number"==typeof r)switch(r){case n.Clip.MaxChars:r=(0,u.repeat)("#",255);break;case n.Clip.CellWidth:r="";break;default:return(0,a.assertNever)("calc.numFmt.renderHashesValue",r)}var i=(0,n.formattedUnitString)(r);return(0,c.success)((0,n.renderedValue)([i],e.color,e.alignment,e.clip))}catch(e){return(0,c.failure)((0,c.javaScriptError)(e))}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolvedUserDefinedFunc=t.resolvedStructRef=t.resolvedNever=t.resolvedName=t.resolvedLocalName=t.resolvedDottedName=t.resolvedCellRef=t.resolveLocalsGrid=t.noOriginSheet=t.invalidStructRef=t.invalidQualifier=t.invalidCellRef=t.emptyIntersection=t.ResolvedKind=t.ResolveReasonKind=t.InvalidStructRefReason=t.InvalidQualifierReason=t.InvalidCellRefReason=void 0;var n=r(3);t.InvalidCellRefReason=n.resolveServiceTypes.InvalidCellRefReason,t.InvalidQualifierReason=n.resolveServiceTypes.InvalidQualifierReason,t.InvalidStructRefReason=n.resolveServiceTypes.InvalidStructRefReason,t.ResolveReasonKind=n.resolveServiceTypes.ResolveReasonKind,t.ResolvedKind=n.resolveServiceTypes.ResolvedKind,t.emptyIntersection=n.resolveServiceTypes.emptyIntersection,t.invalidCellRef=n.resolveServiceTypes.invalidCellRef,t.invalidQualifier=n.resolveServiceTypes.invalidQualifier,t.invalidStructRef=n.resolveServiceTypes.invalidStructRef,t.noOriginSheet=n.resolveServiceTypes.noOriginSheet,t.resolveLocalsGrid=n.resolveServiceTypes.resolveLocalsGrid,t.resolvedCellRef=n.resolveServiceTypes.resolvedCellRef,t.resolvedDottedName=n.resolveServiceTypes.resolvedDottedName,t.resolvedLocalName=n.resolveServiceTypes.resolvedLocalName,t.resolvedName=n.resolveServiceTypes.resolvedName,t.resolvedNever=n.resolveServiceTypes.resolvedNever,t.resolvedStructRef=n.resolveServiceTypes.resolvedStructRef,t.resolvedUserDefinedFunc=n.resolveServiceTypes.resolvedUserDefinedFunc},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.coerceOper=void 0;var n=r(54),i=r(52),a=r(48),o=r(40),s=r(134),u=r(38),c=r(60),l=r(54),d=r(43);function f(e,t){return 0!=(t&a.OperKind.Number)?e.zero:0!=(t&a.OperKind.String)?l.emptyStringOper:0!=(t&a.OperKind.Boolean)?o.falseOper:o.valueErrorOper}t.coerceOper=function(e,t,r){var l=function e(t,r,n){var l=t.globals.config,p=l.localeInfo,m=l.mathpack;if(0!=(n&r.kind))return r;if((0,u.isNumberOper)(r)){if(0!=(n&a.OperKind.String)){return(0,o.stringOper)(m.formatGeneral(p,r,20))}return 0!=(n&a.OperKind.Boolean)?(0,o.booleanOper)(0!==m.cond(r)):0!=(n&a.OperKind.Array)?(0,o.arrayOper)(1,1,[[r]]):o.valueErrorOper}if((0,u.isStringOper)(r)){if(0!=(n&a.OperKind.Number)){if(0===r.value.length)return o.valueErrorOper;if(r.value.length>255)return o.valueErrorOper;var h=t.numberFormatter.parseGeneral(r.value,!1,!0,s.GetTimeKind.NonVolatile);return(0,c.isSuccess)(h)||(0,i.throwEvaluationError)(h.reason),void 0!==h.value?h.value.value:o.valueErrorOper}return 0!=(n&a.OperKind.Boolean)?0===p.stringCompareCI(r.value,p.trueName)?o.trueOper:0===p.stringCompareCI(r.value,p.falseName)?o.falseOper:o.valueErrorOper:0!=(n&a.OperKind.Array)?(0,o.arrayOper)(1,1,[[r]]):o.valueErrorOper}if((0,u.isBooleanOper)(r))return 0!=(n&a.OperKind.Number)?r.value?m.one:m.zero:0!=(n&a.OperKind.String)?(0,o.stringOper)(r.value?p.trueName:p.falseName):0!=(n&a.OperKind.Array)?(0,o.arrayOper)(1,1,[[r]]):o.valueErrorOper;switch(r.kind){case a.OperKind.Error:return r;case a.OperKind.Missing:return 0!=(n&a.OperKind.Blank)?o.blankOper:f(m,n);case a.OperKind.Blank:return f(m,n);case a.OperKind.Rich:return e(t,r.getFallback(),n);case a.OperKind.Range:case a.OperKind.Array:return o.valueErrorOper;default:return(0,d.assertNever)("calc.runtime.coerceOper",r)}}(e,t,r);return(0,u.isErrorOper)(l)&&!(0,u.isErrorOper)(t)&&(0,n.traceErrorOper)("calc.runtime.coerceOper",l.type,"kind = ".concat(t.kind)),l}},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.createCompiler=t.compiledFormulaTerm=t.compiledFormula=void 0;var i=r(2),a=r(136),o=r(43),s=r(137),u=r(137),c=r(54),l=r(118),d=r(38),f=r(72),p=r(149),m=r(40),h=r(60),v=r(252),g=r(62),b=r(196),S=r(51),y=(0,d.createFailureErrorClass)("CompileError"),O=(0,c.makeStrict)((0,f.getWorksheetFuncType)(f.WorksheetFuncId.IF)),C=(0,c.makeStrict)((0,f.getWorksheetFuncType)(f.WorksheetFuncId.CHOOSE));function P(e){return(0,u.isOperTerm)(e)&&(0,d.isWriteOper)(e)}var N=function(){function e(e){var t=this;this.context=e,this.visitFormulaNode=function(e){return(0,v.visitFormulaNode)(t,e)},this.lazyVisitFormulaNode=function(e){return b.Pledge.resolve(e).bind(t.visitFormulaNode)}}return e.prototype.literalNode=function(e,t,r){return b.Pledge.resolve(this.noopTerm(e,r))},e.prototype.arrayNode=function(e,t,r){var n=this;return b.Pledge.all(e.map((function(e){return b.Pledge.all(e.map(n.lazyVisitFormulaNode))}))).bind((function(e){return n.toArrayTerm(e,r)}))},e.prototype.toArrayTerm=function(e,t){var r=e.length,n=void 0===e[0]?0:e[0].length,i=e.map((function(e){return e.map((function(e){return e.kind===u.TermKind.Noop?e.children:e}))}));return i.every((function(e){return e.every(P)}))?this.noopTerm((0,m.arrayOper)(r,n,i),t):(0,u.arrayTerm)(r,n,e,t)},e.prototype.appNode=function(t,r,n,a){var s,c=this,p=(0,d.getArguments)((0,l.appNode)(t,r,n)),m=(null===(s=this.context.annotations[a])||void 0===s?void 0:s.kind)===l.AnnotationKind.FormulaRoot;if((0,d.isOperatorNode)(t)){var h=(0,f.getOperatorType)(t.id);return b.Pledge.all(p.map(this.lazyVisitFormulaNode)).bind((function(e){return(0,u.appTerm)((0,u.operatorIdToName)(t.id),h,m,e,a)}))}if((0,d.isWSFNode)(t)){var g=t.id;switch(g){case f.WorksheetFuncId.IFERROR:case f.WorksheetFuncId.IFNA:(0,o.assertTrue)("calc.runtime.toIfPredicateTerm: expected wff",2===p.length);var S=p[0],y=p[1],O=new e(i.__assign(i.__assign({},this.context),{numNames:this.context.numNames+1}));return b.Pledge.all([this.lazyVisitFormulaNode(S),b.Pledge.try((function(){return(0,v.visitFormulaNode)(O,y)}))]).bind((function(e){var t=e[0],r=e[1];return c.toIfPredicateTerm(g===f.WorksheetFuncId.IFERROR?f.WorksheetFuncId.ISERROR:f.WorksheetFuncId.ISNA,t,r,a)}));case f.WorksheetFuncId._UDF:return(0,o.assertFalse)("calc.runtime.appNode: expected wff (not UDF)")}return b.Pledge.all(p.map(this.lazyVisitFormulaNode)).bind((function(e){switch(g){case f.WorksheetFuncId.IF:return c.toIfTerm(e,a);case f.WorksheetFuncId.CHOOSE:return c.toChooseTerm(e,a)}var t=(0,f.getWorksheetFuncType)(g);return(0,u.appTerm)((0,u.worksheetFunctionIdToName)(g),t,!1,e,a)}))}return this.lazyVisitFormulaNode(t).bind((function(e){return b.Pledge.all(p.map(c.lazyVisitFormulaNode)).bind((function(t){return c.toAppTerm(e,t,a)}))}))},e.prototype.toIfPredicateTerm=function(e,t,r,n){var i=(0,u.readStackTerm)(0,void 0),a=(0,u.conditionalTerm)((0,u.worksheetFunctionIdToName)(f.WorksheetFuncId.IF),O,!1,(0,u.appTerm)((0,u.worksheetFunctionIdToName)(e),(0,f.getWorksheetFuncType)(e),!1,[i],void 0),[r,i],void 0);return(0,u.letTerm)([t],!1,[void 0],a,n)},e.prototype.toIfTerm=function(e,t){switch(e.length){case 3:return(0,u.conditionalTerm)((0,u.worksheetFunctionIdToName)(f.WorksheetFuncId.IF),O,!1,e[0],[e[1],e[2]],t);case 2:return(0,u.conditionalTerm)((0,u.worksheetFunctionIdToName)(f.WorksheetFuncId.IF),O,!1,e[0],[e[1],m.falseOper],t);case 1:throw new y((0,d.notImplemented)(["single-argument IF"]));default:return(0,o.assertFalse)("calc.runtime.toIfTerm: expected wff")}},e.prototype.toChooseTerm=function(e,t){return(0,o.assertTrue)("calc.runtime.toChooseTerm: expected wff",e.length>=1),(0,u.conditionalTerm)((0,u.worksheetFunctionIdToName)(f.WorksheetFuncId.CHOOSE),C,!1,e[0],e.slice(1),t)},e.prototype.toAppTerm=function(e,t,r){return(0,u.appTerm)((0,u.worksheetFunctionIdToName)(f.WorksheetFuncId._UDF),(0,f.higherOrderFunctionType)(),!1,i.__spreadArray([e],t,!0),r)},e.prototype.letNode=function(e,t,r,n,i,a){var s=e.id===f.WorksheetFuncId.LETREC||e.id!==f.WorksheetFuncId.LET&&(0,o.assertFalse)("calc.runtime.compile");(0,o.assertTrue)("calc.runtime.letNode: expected wff",void 0!==r);var c=this.bindNames(t),l=c[t.length],d=t.map((function(e){return e.name.arg.label}));return(s?b.Pledge.all(t.map((function(e){var t=e.binder;return b.Pledge.try((function(){return(0,v.visitFormulaNode)(l,t.arg)}))}))):b.Pledge.all(t.map((function(e,t){var r=e.binder,n=c[t];return b.Pledge.try((function(){return(0,v.visitFormulaNode)(n,r.arg)}))})))).bind((function(e){return(0,v.visitFormulaNode)(l,r.arg).bind((function(t){return(0,u.letTerm)(e,s,d,t,a)}))}))},e.prototype.lambdaNode=function(e,t,r,n,a,s){(0,o.assertTrue)("calc.runtime.lambdaNode: expected wff",void 0!==r);var c=this.bindNames(t),l=c[t.length],d=t.reduce((function(e,t,r){var n=t.name;return(0,g.fastMax)(e,n.arg.isOptional?0:r+1)}),0),f=t.length,p=t.map((function(e){return e.name.arg.name.name.label}));return b.Pledge.all(t.map((function(e,t){var r=e.name;if(void 0===r.arg.def)return b.Pledge.resolve(void 0);var n=c[t],i=r.arg.def.rhs;return b.Pledge.try((function(){return(0,v.visitFormulaNode)(n,i)}))}))).bind((function(e){return(0,v.visitFormulaNode)(l,r.arg).bind((function(t){var r=e.map((function(e,t){return[e,t]})).filter((function(e){return void 0!==e[0]})),n=r.map((function(e){return e[1]})),a=i.__spreadArray(i.__spreadArray([],r.map((function(e){return e[0]})),!0),[t],!1);return(0,u.lambdaTerm)(d,f,p,n,a,s)}))}))},e.prototype.bindNames=function(t){var r=this,n=this.context.numNames,a=[this];return t.reduce((function(t,s,u){var c=s.name;(0,o.assertTrue)("calc.runtime.bindNames: expected wff",void 0!==c.arg.whole);var l=t.setValue((0,d.getBoundName)(r.context.localeInfo,c.arg.whole),n+u);return a.push(new e(i.__assign(i.__assign({},r.context),{names:l,numNames:n+u+1}))),l}),this.context.names),a},e.prototype.parenNode=function(e,t,r){var n=this;return this.lazyVisitFormulaNode(e).bind((function(e){return n.noopTerm(e,r)}))},e.prototype.nameNode=function(e,t,r){var n,i=(null===(n=this.context.annotations[r])||void 0===n?void 0:n.kind)===l.AnnotationKind.AppHeadName;return b.Pledge.resolve(this.toNameTerm(e,t,i))},e.prototype.toNameTerm=function(e,t,r){var n=this,i=this.context,a=i.locals,s=i.names,c=i.numNames;if(!t){var f=(0,l.flattenNameParts)(e);if(f.kind===l.NamePartKind.IdentNamePart){var p=f.parts,m=p[0],h=p.slice(1),v=s.getEntry((0,d.getBoundName)(this.context.localeInfo,m.asWhole));if(void 0!==v){var g=v.value,y=(0,u.readStackTerm)(c-g-1,m.qualifiedLabel);return b.Pledge.resolve(h.reduce((function(e,t){var r;return(0,o.assertTrue)("calc.runtime.toNameTerm: expected wff",(null===(r=t.rhs)||void 0===r?void 0:r.field.kind)===l.NodeKind.Name),n.toFieldRefTerm(e,t.rhs.field.whole,t.qualifiedLabel)}),y))}}}var O=function(e,r){var i,o=b.Pledge.resolve(void 0);if(r.kind===l.NamePartKind.FieldRefNamePart&&(null===(i=r.rhs)||void 0===i?void 0:i.field.kind)===l.NodeKind.Name){var s=r.rhs.field.whole;o=b.Pledge.try((function(){return O(!1,r.lhs)})).bind((function(e){return void 0===e?void 0:n.toFieldRefTerm(e,s,r.qualifiedLabel)}))}return r.kind===l.NamePartKind.CellRefNamePart&&(null==t&&a.allowUnqualifiedCell||null!=t&&t.kind!==l.QualifierKind.Document)&&(o=b.Pledge.resolve((0,u.cellRefTerm)(r.ref,null!=t&&t.kind===l.QualifierKind.Ident?(0,l.sheetQualifier)(t.name):t,r.qualifiedLabel))),r.canDenoteNamedObject&&(!e||t&&t.kind!==l.QualifierKind.Document&&t.kind!==l.QualifierKind.Ident||(o=o.bind((function(e){return(0,u.udfTerm)(r.asWhole,t,e,r.qualifiedLabel)}))),o=o.bind((function(n){return(0,u.nameTerm)(r.asWhole,t,e?S.NameSource.AppHead:S.NameSource.Plain,n,r.qualifiedLabel)}))),o};return O(r,e).bind((function(e){return void 0!==e?e:(0,o.assertFalse)("calc.runtime.compile: expected wff NameNode")}))},e.prototype.cellRefNode=function(e,t,r){return b.Pledge.resolve((0,u.cellRefTerm)(e,t,r))},e.prototype.fieldRefNode=function(e,t,r,n){var i=this;(0,o.assertTrue)("calc.runtime.compile: expected wff FieldRef",t.field.kind===l.NodeKind.Name);var a=t.field.whole;return this.lazyVisitFormulaNode(e).bind((function(e){return i.toFieldRefTerm(e,a,n)}))},e.prototype.toFieldRefTerm=function(e,t,r){var n=f.WorksheetFuncId.FIELDVALUE;return(0,u.appTerm)((0,u.worksheetFunctionIdToName)(n),(0,f.getWorksheetFuncType)(n),!1,[e,(0,m.stringOper)(t)],r)},e.prototype.noopTerm=function(e,t){return this.context.locals.emitStepInfo?(0,s.noopTerm)(e,t):e},e.prototype.structRefNode=function(e,t,r){return b.Pledge.resolve((0,u.structRefTerm)((0,l.structRefNode)(e,t,r),r))},e.prototype.badSequenceNode=function(e,t,r){return(0,o.assertFalse)("calc.runtime.compile: unexpected bad node")},e.prototype.badStringNode=function(e,t,r){return(0,o.assertFalse)("calc.runtime.compile: unexpected bad node")},e.prototype.operatorNode=function(e,t){return b.Pledge.resolve((0,l.operatorNode)(e,t))},e.prototype.wsfNode=function(e,t,r){return b.Pledge.resolve((0,l.wsfNode)(e,t,r))},e}(),R=((n={})[f.OperatorId.At]=f.WorksheetFuncId.SINGLE,n[f.OperatorId.Pound]=f.WorksheetFuncId.ANCHORARRAY,n);var k=[function(e){if(!(0,u.isOperTerm)(e)&&e.kind===u.TermKind.App&&(0,u.isOperatorName)(e.data.funName)){var t=R[(0,u.operatorNameToId)(e.data.funName)];if(void 0!==t)return(0,u.appTerm)((0,u.worksheetFunctionIdToName)(t),(0,f.getWorksheetFuncType)(t),e.data.isFormulaRoot,e.children,e.lexicalPosition)}return e}],T=function(e,t){return t(e)},E=function(e){return k.reduce(T,e)};function _(e,t){return i.__assign(i.__assign({},e),{term:t})}function F(e,t,r){var n,i,a;try{var o=null!==(i=null===(n=t.config)||void 0===n?void 0:n.localeInfo)&&void 0!==i?i:e.config.localeInfo,s=p.RedBlackMapTree.create(o.stringCompareCI),c={globals:e,locals:t,localeInfo:o,annotations:r.annotations,names:s,numNames:0},l=(0,v.reducePledge)(new N(c),r),d=(a=l,(0,u.transformBottomUp)(a,E));return(0,h.success)(_(r,d))}catch(e){return e instanceof y?(0,h.failure)(e.reason):(0,h.failure)((0,h.javaScriptError)(e))}}t.compiledFormula=_,t.compiledFormulaTerm=function(e,t){return"object"!=typeof t.term?(0,o.assertFalse)("".concat(e,": expected known compiled formula type; given ").concat((0,a.anonymize)(t))):t.term},t.createCompiler=function(e){return{compileFormula:function(t,r){return F(e,t,r)}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Pledge=void 0;var n=r(7);t.Pledge=n.pledge.Pledge},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dereferenceOpers=t.dereferenceOper=t.dereference=t.getCellValuesAsArray=void 0;var n=r(43),i=r(150),a=r(81),o=r(136),s=r(105),u=r(52),c=r(71),l=r(54),d=r(18),f=r(40),p=r(62),m=r(38),h=r(51),v=r(117),g=r(48),b=r(60);function S(e,t){var r=t.map.getValue(e);if(void 0!==r){var n=(0,v.recordCellCycle)(r,t.current);return(0,u.throwEvaluationError)(n)}}function y(e,t,r){e.precedents.cells.push(t);var n=e.globals.getCellValue(t);if(n.kind===b.ResultKind.Failure)return(0,u.throwEvaluationError)(n.reason);var i=n.value;if(i.kind===s.CellKind.FinalValue)return i.oper;S(i.anchor,e.visitedCells),r.push(i.anchor)}function O(e,t,r,i){var o;if(e.precedents.cells.push(t),!i||(0,m.gridRangeSize)(t.range)<=16)o=t;else{var c=e.globals.getUsedRange(t.sheet),l=void 0;(0,b.isSuccess)(c)?l=null==c.value?void 0:c.value.range:(0,u.throwEvaluationError)(c.reason);var d=void 0===l?void 0:(0,m.gridRangeIsect)(t.range,(0,h.gridRange)(0,0,l.row+l.rows,l.col+l.cols));if(void 0===d)return new a.StrictSparseArray2D(t.range.rows,t.range.cols,0,0,[],f.blankOper);o=(0,h.sheetGridRange)(t.sheet,d)}var v=e.globals.getCellValues(o);if(v.kind===b.ResultKind.Failure)return(0,u.throwEvaluationError)(v.reason);var g=r.length,y=function(e,t,r,i,o){var u=[],c=i.length,l=0;(0,n.assertTrue)("calc.runtime.deference: readIntoArray2D number of rows",c===r.rows);for(var d=0;d<c;d+=1){u.push([]);var h=i[d].length;(0,n.assertTrue)("calc.runtime.deference: readIntoArray2D number of cols",h===r.cols),l=0===d?h:(0,p.fastMin)(h,l);for(var v=0;v<h;v+=1){var g=i[d][v];s.CellKind.FinalValue===g.kind?u[d][v]=g.oper:(S(g.anchor,e.visitedCells),(0,n.assertTrue)("calc.runtime.deference: readIntoArray2D correct sheet",(0,m.isSheetIndexEqual)(g.anchor.sheet,t.sheet)),o.push(g.anchor),u[d][v]=f.refErrorOper)}}return new a.StrictSparseArray2D(t.range.rows,t.range.cols,c,l,u,f.blankOper)}(e,t,o.range,v.value,r);return g===r.length?y:void 0}function C(e,t,r){var n=O(e,t,r,!1);if(null!=n)return(0,f.arrayOper)(n.rows,n.cols,n.rows===n.denseRows&&n.cols===n.denseCols?n.denseElements:(0,a.array2DToJaggedArray)(n))}function P(e,t,r,n){if(0!=(r&g.OperKind.Range))return t;if(!(0,m.isRangeOper)(t))return t;var a=t.sheets;if(!(0,m.isSheetIndex)(a))return(0,l.traceErrorOper)("calc.runtime.dereference",f.ErrorType.REF,"3D range, oper = ".concat((0,o.anonymize)(t))),f.refErrorOper;if(1!==t.ranges.length)return(0,l.traceErrorOper)("calc.runtime.dereference",f.ErrorType.VALUE,"union range, oper = ".concat((0,o.anonymize)(t))),f.valueErrorOper;var s=t.ranges[0];if(0!=(r&c.singleReadOperType)){if((0,m.isGridCell)(s))return y(e,(0,h.sheetGridCell)(a,s),n);if(e.locals.implicitIntersect&&(0,i.isFeatureEnabled)(i.FeatureName.CalcLegacyImplicitIntersection)&&!(0,i.isFeatureEnabled)(i.FeatureName.CalcPreventSpillingHack)){var d=e.locals.originGridCell;if(!(0,b.isSuccess)(d))return(0,u.throwEvaluationError)(d.reason);var p=(0,m.gridCellImplicitIsect)(d.value,s);return null==p?((0,l.traceErrorOper)("calc.runtime.dereference",f.ErrorType.VALUE,"empty intersection, oper = ".concat((0,o.anonymize)(t))),f.valueErrorOper):y(e,(0,h.sheetGridCell)(a,p),n)}return C(e,(0,h.sheetGridRange)(a,s),n)}return 0!=(r&g.OperKind.Array)?C(e,(0,h.sheetGridRange)(a,s),n):((0,l.traceErrorOper)("calc.runtime.dereference",f.ErrorType.VALUE,"bad target type ".concat(r)),f.valueErrorOper)}t.getCellValuesAsArray=O,t.dereference=P,t.dereferenceOper=function(e,t,r){var i=[],a=P(e,t,r,i);if(null==a){if(i.length>0)return(0,u.throwEvaluationError)((0,u.unevaluated)(i));var s=(0,o.anonymize)(t),c="calc.runtime.dereferenceOper: internal error: expected nonempty anchors; oper = ".concat(s);return n.ulsLogger.ULS.assertTag(595980819,d.LogCategory.msoulscat_ES_EWAJS,!1,c)}return a},t.dereferenceOpers=function(e,t,r){for(var n=[],i=0;i<t.length;i+=1){var a=P(e,t[i],(0,m.getArgType)(r,i,t.length),n);null!=a&&(t[i]=a)}if(n.length>0)return(0,u.throwEvaluationError)((0,u.unevaluated)(n))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseLocals=t.notFormulaString=t.createParseGlobals=t.ReasonKind=void 0;var n=r(20);t.ReasonKind=n.parseServiceTypes.ReasonKind,t.createParseGlobals=n.parseServiceTypes.createParseGlobals,t.notFormulaString=n.parseServiceTypes.notFormulaString,t.parseLocals=n.parseServiceTypes.parseLocals},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.evalFormula=t.createLambdaEvaluationMachine=t.createFormulaEvaluationMachine=t.createCellEvaluationMachine=t.createSchedule=t.evalCellsAsync=t.evalCells=t.EvaluationRuntime=t.evaluationMachineContext=t.runtimeEvaluationContext=t.runtimeTimer=t.calculateNextDeadline=void 0;var n=r(18),i=r(43),a=r(105),o=r(52),s=r(52),u=r(52),c=r(52),l=r(52),d=r(62),f=r(62),p=r(71),m=r(257),h=r(200),v=r(258),g=r(151),b=r(201),S=r(60),y=r(202),O=r(117),C=r(117),P=r(51),N=r(51),R=r(196),k=r(40),T=r(40),E=r(136),_=r(38),F=r(54),I=r(119),A=r(150),M=r(137),w=r(253),D=r(197),j=r(48),x=r(194),L=r(195),B=r(54),U=r(193),G=r(118),K=r(72);function V(e){if(void 0!==e.yieldIntervalMs||void 0!==e.endTimeMs){if(void 0===e.yieldIntervalMs)return e.endTimeMs;var t=(0,f.now)()+e.yieldIntervalMs;return void 0===e.endTimeMs?t:(0,f.fastMin)(e.endTimeMs,t)}}function W(){return{doTimeout:function(e){return void 0!==e&&(0,f.now)()>=e}}}t.calculateNextDeadline=V,t.runtimeTimer=W;var H={kind:a.ReasonKind.Timeout},q={kind:a.ReasonKind.Breakpoint};function z(e){return{globals:e,timer:W(),machineContext:Q(e)}}function Q(e){return{globals:e,resolver:(0,m.createResolver)(e),numberFormatter:(0,b.createNumberFormatter)(e),parser:(0,h.createParser)(e),printer:(0,y.createPrinter)(e),analyzer:(0,v.createAnalyzer)(e),createCellEvaluationMachine:X,createFormulaEvaluationMachine:ie,createLambdaEvaluationMachine:ae}}t.runtimeEvaluationContext=z,t.evaluationMachineContext=Q;var J=function(){function e(e,t){(0,i.assertPositiveInteger)("calc.runtime.EvaluationRuntime",t.length),this.context=e,this.machineRuntimes=t.map((function(e){return new p.MachineRuntime(e)})),this.results=[]}return e.prototype.evaluateAsync=function(e){var t=this;if(this.context.globals.interruptToken[0]===a.Interrupt.Stop)return this.generatePartialResults(),Promise.resolve(this.results);if(this.context.timer.doTimeout(e.endTimeMs))return this.generatePartialResults(),Promise.resolve(this.results);try{var r=this.evaluate(V(e));return Array.isArray(r)?Promise.resolve(r):((0,i.assertTrue)("calc.runtime.EvaluationRuntime.evaluateAsync",r.kind===a.ReasonKind.Timeout),new Promise((function(r,n){return e.scheduleFunction((function(){try{r(t.evaluateAsync(e))}catch(e){n(e)}}))})))}catch(e){return Promise.reject(e)}},e.prototype.evaluateSync=function(e){var t=this,r=function(n){if(t.context.globals.interruptToken[0]===a.Interrupt.Stop||t.context.timer.doTimeout(e.endTimeMs))return t.generatePartialResults(),t.results;var o=t.evaluate(n);if(Array.isArray(o))return o;switch(o.kind){case a.ReasonKind.Timeout:return(0,a.paused)((function(t){return r(null!=t?t:V(e))}));case a.ReasonKind.Breakpoint:return(0,a.breaked)((function(){return r(V(e))}));default:return(0,i.assertNever)("calc.runtime.EvaluationRuntime.evaluateSync",o)}};return r(V(e))},e.prototype.evaluate=function(e){var t=this,r=function(){return t.context.timer.doTimeout(e)};try{for(;this.results.length<this.machineRuntimes.length;){var a=this.machineRuntimes[this.results.length].run(r);if(a.kind===p.TransitionKind.Next)return H;if(a.kind===p.TransitionKind.Break)return q;this.pushResult(a)}return this.results}catch(e){var o="calc.runtime.EvaluationRuntime.evaluate: unhandled error ".concat((0,g.messageFromError)(e));return i.ulsLogger.ULS.assertTag(595980807,n.LogCategory.msoulscat_ES_EWAJS,!1,o)}},e.prototype.pushResult=function(e){return this.results.push(e),p.nextTransition},e.prototype.generatePartialResults=function(){for(;this.results.length<this.machineRuntimes.length;)this.results.push((0,S.failure)(a.stopped))},e}();t.EvaluationRuntime=J;var Y=function(){function e(e,t,r,o,s){var u=this;this.context=e,this.stepConfig=t,this.visitedCells=r,this.cell=o,this.isPrecedent=s,this.receiveSuccess=function(e){return function(t){if((0,_.isRangeOper)(t)||(0,_.isMissingOper)(t)){var r="expected ReadOper; given ".concat((0,E.anonymize)(t)),a="calc.runtime.CellEvaluationMachine.receiveSuccess: ".concat(r);return i.ulsLogger.ULS.assertTag(595980815,n.LogCategory.msoulscat_ES_EWAJS,!1,a)}return u.writeSuccess(e.source,t,e.precedents),t}},this.receiveFailure=function(e){return function(t){if(t.kind===l.RuntimeInternalReasonKind.Unevaluated){var r="unexpected reason ".concat((0,E.anonymize)(t)),o="calc.runtime.CellEvaluationMachine.receiveFailure: ".concat(r);return i.ulsLogger.ULS.assertTag(595980817,n.LogCategory.msoulscat_ES_EWAJS,!1,o)}var s=t.kind===a.ReasonKind.PreviousFailure&&void 0!==e.cycle?e.cycle:t;return u.writeFailure(e.source,s,e.precedents),R.Pledge.reject(u.isPrecedent?(0,a.previousFailure)(e.source.range):s)}}}return e.prototype.evalCell=function(){var e=this.context.globals.getCellValue(this.cell);if(e.kind===S.ResultKind.Failure)return R.Pledge.reject(e.reason);var t=e.value;if(t.kind===a.CellKind.FinalValue)return t.oper;var r=this.context.globals.getCellFormula(t.anchor);if(r.kind===S.ResultKind.Failure){var o="calc.runtime.CellEvaluationMachine.next: unexpected Failure from getCellFormula";return i.ulsLogger.ULS.assertTag(595980813,n.LogCategory.msoulscat_ES_EWAJS,!1,o)}var s=r.value;if(null==s){var u="client error: expected getCellFormula(".concat((0,E.anonymize)(t.anchor),") != null");o="calc.runtime.CellEvaluationMachine.next: ".concat(u);return i.ulsLogger.ULS.assertTag(595980814,n.LogCategory.msoulscat_ES_EWAJS,!1,o)}var c=this.visitAnchor(s),d=this.context.createFormulaEvaluationMachine(this.context,this.stepConfig,(0,l.evalLocalsGrid)(c.source),c.precedents,(0,C.appendVisitedCell)(this.visitedCells,c),s.formula);return R.Pledge.fromMachine(d).bind(this.receiveSuccess(c)).catch(this.receiveFailure(c))},e.prototype.visitAnchor=function(e){var t=(0,_.sheetGridRangeAnchor)(e.source.range),r=this.visitedCells.map.getValue(t);if(null!=r){var a="unexpected visitValue at ".concat((0,E.anonymize)(t),"; given ").concat((0,E.anonymize)(r)),o="calc.runtime.CellEvaluationMachine.visitAnchor: ".concat(a);return i.ulsLogger.ULS.assertTag(595980812,n.LogCategory.msoulscat_ES_EWAJS,!1,o)}return{cell:t,cycle:void 0,previous:this.visitedCells.current,source:e.source,precedents:(0,l.bottomEvalPrecedents)()}},e.prototype.writeSuccess=function(e,t,r){this.setCellValue(e,t,r)},e.prototype.writeFailure=function(e,t,r){this.context.globals.setCellFailure(e.range,t,r)},e.prototype.setCellValue=function(e,t,r){var n=this.context.globals.config.mathpack.zero,i=(0,_.isBlankOper)(t)?n:t;if(e.kind===N.LexicalKind.Cell){if((0,_.isArrayOper)(i)){var a=void 0===i.opers[0]?T.naErrorOper:i.opers[0][0],o=(0,_.isBlankOper)(a)?n:a;if(!this.isLambdaEnabled(e,o,r))return;return this.context.globals.setCellValue(e.range,o,r)}if(!this.isLambdaEnabled(e,i,r))return;return this.context.globals.setCellValue(e.range,i,r)}var s=e.range.range,u=(0,F.broadcastWriteOper)(s.rows,s.cols,i).opers,c=function(e){return(0,_.isBlankOper)(e)?n:e},l=u.map((function(e){return e.map(c)}));if(this.isLambdaEnabled(e,l,r))return this.context.globals.setCellValues(e.range,l,r)},e.prototype.isLambdaEnabled=function(e,t,r){return!((Array.isArray(t)?t.some((function(e){return e.some((function(e){return e instanceof I.LambdaOper}))})):t instanceof I.LambdaOper)&&!(0,A.isFeatureEnabled)(A.FeatureName.CalcLambdaCellValues))||(this.context.globals.setCellFailure(e.range,(0,_.notImplemented)(["LAMBDA cell values"]),r),!1)},e}();function $(e,t,r){for(var n=z(e),i=[],a=0;a<r.length;a+=1)i.push(X(n.machineContext,t,C.emptyVisitedCells,r[a],!1));return new J(n,i)}function Z(e){return{yieldIntervalMs:e.yieldIntervalMs,endTimeMs:null==e.totalTimeMs?void 0:(0,f.now)()+e.totalTimeMs,scheduleFunction:null!=e.scheduleFunction?e.scheduleFunction:function(e){return setTimeout(e,0)}}}function X(e,t,r,n,i){return R.Pledge.try((function(){return new Y(e,t,r,n,i).evalCell()}))}t.evalCells=function(e,t,r){var n;if(0===r.length)return[];var i=$(e,t.stepConfig,r),a=Z(null!==(n=t.schedulerConfig)&&void 0!==n?n:e.schedulerConfig);return i.evaluateSync(a)},t.evalCellsAsync=function(e,t,r){var n;if(0===r.length)return Promise.resolve([]);var i=$(e,void 0,r),a=Z(null!==(n=t.schedulerConfig)&&void 0!==n?n:e.schedulerConfig);return i.evaluateAsync(a)},t.createSchedule=Z,t.createCellEvaluationMachine=X;var ee=function(){return(0,l.throwEvaluationError)((0,_.notImplemented)(["LETREC cycle"]))};function te(e){for(var t=e.lambda,r=e.args,n=e.caller,i=r.slice();i.length<t.maxArity;)i.push(k.missingOper);for(var a=0;a<t.defIdxs.length;a+=1){var o=t.defIdxs[a],s=t.defsAndBody[a],u=i[o];(0,M.isOperTerm)(u)&&(0,_.isMissingOper)(u)&&(i[o]=s)}var c=t.defsAndBody[t.defsAndBody.length-1],l=(0,M.letTerm)(i,!1,t.paramLabels,c,void 0);return(0,M.callLambdaTerm)(t.locals,t.stackEnv,t.stackMap,n,l)}function re(e,t){return{context:e,holeIndex:0,locals:t}}var ne=function(){function e(e,t,r,n,i,a,o,s,u,l){this.context=e,this.stepConfig=t,this.locals=r,this.precedents=n,this.visitedCells=i,this.visitedNames=a,this.usage=o,this.target=s,this.isLambda=u,this.runStatus=!1,this.stackEnv=c.emptyStackEnv,this.stackMapLabels=void 0,this.stackMapNumPushed=0,this.stackMapNext=void 0,this.caller=void 0,this.continuation=[],this.term=null!=t&&l.kind!==M.TermKind.CallLambda?(0,M.noopTerm)(l,void 0):l,this.initialLambdaDepth=o.lambdaDepth}return Object.defineProperty(e.prototype,"globals",{get:function(){return this.context.globals},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"numberFormatter",{get:function(){return this.context.numberFormatter},enumerable:!1,configurable:!0}),e.prototype.next=function(){try{return this.doNext()}catch(e){if(e instanceof l.EvaluationError)return(0,l.handleEvaluationError)(this.context,this.visitedCells,e.reason);throw e}},e.prototype.receiveResult=function(e){return(0,S.isSuccess)(e)?this.updateTermTransition(e.value):e},e.prototype.doNext=function(){if((0,M.isOperTerm)(this.term)){var e=this.continuation;if(0===e.length){(0,i.assertTrue)("calc.runtime.FormulaEvaluationMachine.doNext: lambdaDepth correctly decremented",this.usage.lambdaDepth===this.initialLambdaDepth);var t=(0,D.dereferenceOper)(this,this.term,this.target),r=(0,x.coerceOper)(this,t,this.target);return this.precedents.bound=k.PrecsBound.Exact,!(0,A.isFeatureEnabled)(A.FeatureName.CalcPreventSpillingHack)||this.isLambda||this.locals.lexicalSource.kind!==N.LexicalKind.Cell||!(0,_.isArrayOper)(r)||1===r.rows&&1===r.cols?(0,S.success)(r):(0,S.failure)((0,_.notImplemented)(["spilling"]))}var n=e[e.length-1];return this.applyContinuation(this.term,n)}return this.reduceFormula(this.term)},e.prototype.applyContinuation=function(e,t){var r,n=t.context;switch(n.kind){case M.TermKind.App:var a=t.holeIndex,o=n.children.length;return(s=t.locals)[a]=e,a+1<o?this.nextHoleTransition(t,n.children[a+1]):this.dispatchFunction(s,s,n.data,n.lexicalPosition);case M.TermKind.Conditional:var s;if(0===(a=t.holeIndex)){var u=(0,M.worksheetFunctionNameToId)(n.data.funName),c=u===K.WorksheetFuncId.IF?j.OperKind.Boolean:j.OperKind.Number,l=(0,D.dereferenceOper)(this,e,c);if((0,_.isArrayOper)(l))return t.locals=[l],this.nextHoleTransition(t,n.children[a+1]);if((0,_.isRichOper)(l))return(0,S.failure)((0,_.notImplemented)(["IF/CHOOSE with a rich value condition"]));if(l=(0,x.coerceOper)(this,l,c),u===K.WorksheetFuncId.IF&&(0,_.isBooleanOper)(l))return this.popContextTransition(n.children[l.value?1:2]);if(u===K.WorksheetFuncId.CHOOSE&&(0,_.isNumberOper)(l)){var d=this.context.globals.config.mathpack.fix(l);if(d<1||d>n.children.length-1){var f="CHOOSE; out of bounds option = ".concat((0,E.anonymize)(d));return(0,B.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.applyContinuation",k.ErrorType.VALUE,f),this.popContextTransition(k.valueErrorOper)}return this.popContextTransition(n.children[d])}return(0,i.assertTrue)("calc.runtime.FormulaEvaluationMachine.applyContinuation",(0,_.isErrorOper)(l)),this.popContextTransition(l)}return(s=t.locals)[a]=e,a+1<n.children.length?this.nextHoleTransition(t,n.children[a+1]):this.dispatchFunction(s,s,n.data,n.lexicalPosition);case M.TermKind.CallName:var p=t.locals;return this.locals=p.locals,this.caller=p.caller,this.restoreStack(p),this.visitedNames=p.visitedNames,this.popContextTransition(e);case M.TermKind.Let:a=t.holeIndex;var m=n.children.length-1;if(a>=m){p=t.locals;return this.restoreStack(p),this.popContextTransition(e)}if(n.data.rec){var h=this.stackEnv.getCount()-m+a;this.stackEnv.getValue(h).value=e,this.stackEnv=this.stackEnv.setValue(h,e)}else this.stackEnv=this.stackEnv.setValue(this.stackEnv.getCount(),e),this.stackMapNumPushed+=1;return this.nextHoleTransition(t,n.children[a+1]);case M.TermKind.Array:var v=(0,D.dereferenceOper)(this,e,F.writeOperType),g=n.data,b=g.rows,y=g.cols,O=t.holeIndex,C=O%y,P=y===C+1,N=(O-C)/y,R=t.locals;if(R[N][C]=(0,x.coerceOper)(this,v,F.writeOperType),b===N+1&&P)return this.popContextTransition((0,k.arrayOper)(b,y,R));var T=P?N+1:N,I=P?0:C+1;return this.nextHoleTransition(t,n.children[T][I]);case M.TermKind.CallLambda:p=t.locals;return this.locals=p.locals,this.caller=p.caller,this.restoreStack(p),this.usage.lambdaDepth-=1,this.popContextTransition(e);case M.TermKind.PostStep:var A=t.locals;return null===(r=this.stepConfig)||void 0===r||r.postStep(A,e),this.popContextTransition(e);default:return(0,i.assertNever)("calc.runtime.FormulaEvaluationMachine.applyContinuation",n)}},e.prototype.reduceFormula=function(e){var t,r;switch(e.kind){case M.TermKind.CellRef:return this.updateTermTransition(this.evalCellRefTerm(e));case M.TermKind.StructRef:return this.updateTermTransition(this.evalStructRefTerm(e));case M.TermKind.App:var n=e.data.funName;if(!(0,M.isOperatorName)(n)){var s=(0,M.worksheetFunctionNameToId)(n);if(s!==K.WorksheetFuncId._UDF){var u=this.globals.getWorksheetFunc(s);if(u.kind===S.ResultKind.Failure)return(0,l.throwEvaluationError)(u.reason)}}if(0===e.children.length){var d=new w.FunctionDispatcher(this.context,this.stepConfig,this.locals,this.stackFrameList(e.lexicalPosition),this.precedents,this.visitedCells,this.visitedNames,this.usage).dispatchFunction(n,e.data.funType,e.data.isFormulaRoot,[]);return(0,o.isLambdaCall)(d)?this.evaluateLambdaTransition(void 0,d):(0,p.isMachineCall)(d)?this.evaluateMachineTransition(void 0,d):this.updateTermTransition(d)}return this.pushContextTransition(e,e.children[0],[]);case M.TermKind.CallLambda:if(this.usage.lambdaCalls[0]+1>(null!==(t=this.globals.limits.maxLambdaCalls)&&void 0!==t?t:1/0))return(0,l.throwEvaluationError)((0,a.limitExceeded)(a.LimitKind.LambdaCalls));if(this.usage.lambdaDepth+1>(null!==(r=this.globals.limits.maxLambdaDepth)&&void 0!==r?r:1/0))return(0,l.throwEvaluationError)((0,a.limitExceeded)(a.LimitKind.LambdaDepth));this.usage.lambdaDepth+=1,this.usage.lambdaCalls[0]+=1;var f=this.stackEnv;this.stackEnv=e.data.capturedStackEnv;var m=this.stackMapList();this.stackMapLabels=void 0,this.stackMapNumPushed=0,this.stackMapNext=e.data.capturedStackMap;var h=this.locals;this.locals=(0,l.evalLocalsLambda)(e.data.capturedLocals,this.locals);var v=this.caller;return this.caller=e.data.caller,this.pushContextTransition(e,e.children,{locals:h,caller:v,stackEnv:f,stackMap:m});case M.TermKind.Conditional:return this.pushContextTransition(e,e.children[0],void 0);case M.TermKind.Let:return this.evaluateLetTransition(e);case M.TermKind.Name:return this.updateTermTransition(this.evalNameTerm(e));case M.TermKind.CallName:var g=e.data.loc,b=this.checkForNameCycle(g),y=this.stackFrameList(e.lexicalPosition);h=this.locals;this.locals=(0,l.evalLocalsName)((0,P.lexicalSourceName)(g),h);v=this.caller;this.caller=y;f=this.stackEnv;this.stackEnv=c.emptyStackEnv;m=this.stackMapList();this.stackMapLabels=void 0,this.stackMapNumPushed=0,this.stackMapNext=void 0;var O=this.visitedNames;return this.visitedNames=b,this.pushContextTransition(e,e.children,{locals:h,caller:v,stackEnv:f,stackMap:m,visitedNames:O});case M.TermKind.Udf:return this.updateTermTransition(this.evalUdfTerm(e));case M.TermKind.ReadStack:var C=this.stackEnv.getValue(this.stackEnv.getCount()-1-e.data);return(0,i.assertTrue)("calc.runtime.FormulaEvaluationMachine.reduceFormula: ReadStack oper",void 0!==C),this.updateTermTransition(C instanceof c.LazyOper?C.value:C);case M.TermKind.Array:return this.pushContextTransition(e,e.children[0][0],e.children.map((function(){return[]})));case M.TermKind.Lambda:return this.updateTermTransition(new I.LambdaOper(e.data.minArity,e.data.maxArity,e.data.paramLabels,this.locals,this.stackEnv,this.stackMapList(),e.data.defIdxs,e.children));case M.TermKind.Noop:return this.updateTermTransition(e.children);default:return(0,i.assertNever)("calc.runtime.FormulaEvaluationMachine.reduceFormula",e)}},e.prototype.dispatchFunction=function(e,t,r,n){var i=r.funName,a=r.funType,s=r.isFormulaRoot;(0,D.dereferenceOpers)(this,t,a);var u=new w.FunctionDispatcher(this.context,this.stepConfig,this.locals,this.stackFrameList(n),this.precedents,this.visitedCells,this.visitedNames,this.usage).dispatchFunction(i,a,s,t);return(0,o.isLambdaCall)(u)?this.evaluateLambdaTransition(e,u):(0,p.isMachineCall)(u)?this.evaluateMachineTransition(e,u):this.popContextTransition(u)},e.prototype.stackFrameList=function(e){return(0,s.stackFrameList)(this.locals.lexicalSource,e,this.stackEnv,this.stackMapList(),this.caller)},e.prototype.stackMapList=function(){return void 0!==this.stackMapLabels&&0!==this.stackMapNumPushed?(0,o.stackMapList)(this.stackMapLabels,this.stackMapNumPushed,this.stackMapNext):this.stackMapNext},e.prototype.pushContextTransition=function(e,t,r){var n=re(e,r);return this.continuation[this.continuation.length]=n,this.updateTermTransition(t)},e.prototype.popContextTransition=function(e){return this.continuation.pop(),this.updateTermTransition(e)},e.prototype.evaluateMachineTransition=function(e,t){var r=t.machine;return void 0!==e&&this.continuation.pop(),(0,p.callMachineTransition)(r,this)},e.prototype.evaluateLambdaTransition=function(e,t){var r,n=this.continuation.length-1-(void 0!==e?1:0),i=n-1,o=this.continuation[n],s=this.continuation[i],u=(null==o?void 0:o.context.kind)===M.TermKind.Let&&o.holeIndex===o.context.children.length-1&&(null==s?void 0:s.context.kind)===M.TermKind.CallLambda?s:void 0,c=te(t);if(void 0!==u){if(this.usage.lambdaCalls[0]+1>(null!==(r=this.globals.limits.maxLambdaCalls)&&void 0!==r?r:1/0))return(0,l.throwEvaluationError)((0,a.limitExceeded)(a.LimitKind.LambdaCalls));var d=u.locals;return u.context=c,u.holeIndex=0,this.stackEnv=c.data.capturedStackEnv,this.stackMapLabels=void 0,this.stackMapNumPushed=0,this.stackMapNext=c.data.capturedStackMap,this.locals=(0,l.evalLocalsLambda)(c.data.capturedLocals,d.locals),this.caller=c.data.caller,this.usage.lambdaCalls[0]+=1,void 0!==e&&this.continuation.pop(),this.continuation.pop(),this.updateTermTransition(c.children)}return void 0!==e&&this.continuation.pop(),this.updateTermTransition(c)},e.prototype.evaluateLetTransition=function(e){var t=this.stackEnv,r=this.stackMapList();if(this.stackMapLabels=e.data.varLabels,this.stackMapNumPushed=0,this.stackMapNext=r,e.data.rec){for(var n=e.children.length-1,i=0;i<n;i+=1)this.stackEnv=this.stackEnv.setValue(this.stackEnv.getCount(),new c.LazyOper(ee));this.stackMapNumPushed+=n}return this.pushContextTransition(e,e.children[0],{stackEnv:t,stackMap:r})},e.prototype.nextHoleTransition=function(e,t){return e.holeIndex+=1,this.updateTermTransition(t)},e.prototype.updateTermTransition=function(e){if(this.term=e,null!=this.stepConfig&&!(0,M.isOperTerm)(e)&&void 0!==e.lexicalPosition&&e.kind!==M.TermKind.Name&&e.kind!==M.TermKind.Udf){var t=(r=this.locals.lexicalSource,n=e.lexicalPosition,i=this.stackEnv,o=this.stackMapList(),c=this.caller,l=(0,s.stackFrameList)(r,n,i,o,c),{stack:new u.ES5IterableStackFrame(l)});if(this.continuation.push(re(M.postStepTerm,t)),this.stepConfig.preStep(t)===a.StepAction.Break)return p.breakTransition}var r,n,i,o,c,l;return p.nextTransition},e.prototype.restoreStack=function(e){var t,r=e.stackEnv,n=e.stackMap;this.stackEnv=r,this.stackMapLabels=null==n?void 0:n.labels,this.stackMapNumPushed=null!==(t=null==n?void 0:n.numPushed)&&void 0!==t?t:0,this.stackMapNext=null==n?void 0:n.next},e.prototype.noopTerm=function(e,t){return null!=this.stepConfig?(0,M.noopTerm)(e,t):e},e.prototype.getNameFormulaAsTerm=function(e,t){var r=this.globals.getNameFormula(e,t);if(r.kind===S.ResultKind.Failure)return(0,l.throwEvaluationError)(r.reason);var n=r.value;return null!=n?(0,L.compiledFormulaTerm)("calc.runtime.FormulaEvaluationMachine.getNameFormulaAsTerm",n):void 0},e.prototype.checkForNameCycle=function(e){var t,r=this.visitedNames,n=r.map.getValue(e);if(void 0!==n){var i=(0,O.recordNameCycle)(n,r.current);return(0,l.throwEvaluationError)(i)}return this.visitedNames.map.getCount()+1>(null!==(t=this.globals.limits.maxNameChain)&&void 0!==t?t:1/0)?(0,l.throwEvaluationError)((0,a.limitExceeded)(a.LimitKind.NameChain)):(0,O.appendVisitedName)(this.visitedNames,e)},e.prototype.evalNameTerm=function(e){var t=this.context.resolver.resolveName(this.locals,(0,G.nameNode)((0,G.identNamePart)(e.data.name,!0),e.data.qualifier),e.data.source),r=t.resolution,n=t.precedents;if((0,d.safePush)(this.precedents.names,n),!(0,S.isSuccess)(r)){if(r.reason.kind===U.ResolveReasonKind.NoOriginSheet){var i="error ref, no sheet, qualifier = ".concat((0,E.anonymize)(e.data.qualifier));return(0,B.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalName",k.ErrorType.REF,i),this.noopTerm(k.refErrorOper,e.lexicalPosition)}var a=e.children;return r.reason.kind===U.ResolveReasonKind.InvalidQualifier&&void 0!==a?a:(0,l.throwEvaluationError)(r.reason)}var o,s=r.value;if(void 0===s||void 0===(o=this.getNameFormulaAsTerm(s,e.data.source))){if(void 0===(a=e.children)){i="error ref, qualifier = ".concat((0,E.anonymize)(e.data.qualifier));return(0,B.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalName",k.ErrorType.NAME,i),this.noopTerm(k.nameErrorOper,e.lexicalPosition)}return a}return(0,M.callNameTerm)(s,o,e.lexicalPosition)},e.prototype.evalCellRefTerm=function(e){var t=this.context.resolver.resolveCellRef(this.locals,(0,G.cellRefNode)(e.data.ref,e.data.qualifier)).resolution;if(!(0,S.isSuccess)(t)){if(t.reason.kind===U.ResolveReasonKind.NoOriginSheet){var r="error ref, no sheet, qualifier = ".concat((0,E.anonymize)(e.data.qualifier));return(0,B.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",k.ErrorType.REF,r),k.refErrorOper}return(0,l.throwEvaluationError)(t.reason)}var n=t.value;if(!n){r="error ref, qualifier = ".concat((0,E.anonymize)(e.data.qualifier));return(0,B.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",k.ErrorType.REF,r),k.refErrorOper}return(0,k.range3DOper)(n.sheet,n.range)},e.prototype.evalStructRefTerm=function(e){var t=this.context.resolver.resolveStructRef(this.locals,e.data),r=t.resolution,n=t.precedents;if((0,d.safePush)(this.precedents.names,n),!(0,S.isSuccess)(r)){if(r.reason.kind===U.ResolveReasonKind.NoOriginSheet){var i="error ref, no sheet, struct ref = ".concat((0,E.anonymize)(e.data));return(0,B.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalStructRefTerm",k.ErrorType.REF,i),k.refErrorOper}if(r.reason.kind===U.ResolveReasonKind.EmptyIntersection){i="error ref, empty intersection, struct ref = ".concat((0,E.anonymize)(e.data));return(0,B.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalStructRefTerm",k.ErrorType.VALUE,i),k.valueErrorOper}return(0,l.throwEvaluationError)(r.reason)}var a=r.value;if(!a){i="error ref, struct ref = ".concat((0,E.anonymize)(e.data));return(0,B.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalStructRefTerm",k.ErrorType.REF,i),k.refErrorOper}return(0,k.range3DOper)(a.sheet,a.range)},e.prototype.evalUdfTerm=function(e){var t=this.context.resolver.resolveUserDefinedFunc(this.locals,(0,G.nameNode)((0,G.identNamePart)(e.data.name,!0),e.data.qualifier)),r=t.resolution,n=t.precedents;if((0,d.safePush)(this.precedents.udfs,n),!(0,S.isSuccess)(r)){var i=e.children;if(r.reason.kind===U.ResolveReasonKind.InvalidQualifier&&void 0!==i)return i;(0,l.throwEvaluationError)(r.reason)}var a=r.value;if(!a){if(void 0===(i=e.children)){var o="UDF resolution, qualifier = ".concat((0,E.anonymize)(e.data.qualifier));return(0,B.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalUdfTerm",k.ErrorType.NAME,o),this.noopTerm(k.nameErrorOper,e.lexicalPosition)}return i}if(a.length>1){o="UDF resolution, ambiguous name";return(0,B.traceErrorOper)("calc.runtime.FormulaEvaluationMachine.evalUdfTerm",k.ErrorType.NAME,o),this.noopTerm(k.nameErrorOper,e.lexicalPosition)}var s=a[0],u=this.globals.getUserDefinedFunc(s);return(0,S.isSuccess)(u)||(0,l.throwEvaluationError)(u.reason),new w.UdfOper(s,u.value)},e}();function ie(e,t,r,n,i,a){return new ne(e,t,r,n,i,O.emptyVisitedNames,(0,l.evalUsage)([0],0),p.readOperType,!1,(0,L.compiledFormulaTerm)("calc.runtime.createFormulaEvaluationMachine",a))}function ae(e,t,r,n,i,a,o,s){var u=te(s);return new ne(e,t,r,n,i,a,(0,l.evalUsage)(o.lambdaCalls,o.lambdaDepth),j.SignatureType.All,!0,u)}t.createFormulaEvaluationMachine=ie,t.createLambdaEvaluationMachine=ae,t.evalFormula=function(e,t,r){var n,i=z(e),o=(0,l.bottomEvalPrecedents)(),s=ie(i.machineContext,t.stepConfig,(0,l.evalLocalsSlice)(t),o,C.emptyVisitedCells,r),u=new J(i,[s]),c=Z(null!==(n=t.schedulerConfig)&&void 0!==n?n:e.schedulerConfig);return function e(t){return Array.isArray(t)?t[0]:t.kind===S.ResultKind.Paused?(0,a.paused)((function(r){return e(t.resume(r))})):(0,a.breaked)((function(){return e(t.resume())}))}(u.evaluateSync(c))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createParser=void 0;var n=r(20);t.createParser=n.parserService.createParser},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createNumberFormatter=void 0;var n=r(22);t.createNumberFormatter=n.formatService.createNumberFormatter},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createPrinter=t.anonymizeFormula=void 0;var n=r(3);t.anonymizeFormula=n.printService.anonymizeFormula,t.createPrinter=n.printService.createPrinter},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.codePointExclamationMark=t.codePointEuroSign=t.codePointEqualsSign=t.codePointDoubleQuote=t.codePointDollarSign=t.codePointDigitZero=t.codePointDigitTwo=t.codePointDigitThree=t.codePointDigitSix=t.codePointDigitSeven=t.codePointDigitOne=t.codePointDigitNine=t.codePointDigitFour=t.codePointDigitFive=t.codePointDigitEight=t.codePointComma=t.codePointColon=t.codePointCircumflexAccent=t.codePointCapitalZ=t.codePointCapitalY=t.codePointCapitalX=t.codePointCapitalW=t.codePointCapitalV=t.codePointCapitalU=t.codePointCapitalT=t.codePointCapitalS=t.codePointCapitalR=t.codePointCapitalQ=t.codePointCapitalP=t.codePointCapitalO=t.codePointCapitalN=t.codePointCapitalM=t.codePointCapitalL=t.codePointCapitalK=t.codePointCapitalJ=t.codePointCapitalI=t.codePointCapitalH=t.codePointCapitalG=t.codePointCapitalF=t.codePointCapitalE=t.codePointCapitalD=t.codePointCapitalC=t.codePointCapitalB=t.codePointCapitalA=t.codePointCR=t.codePointBacktick=t.codePointBackslash=t.codePointAtSign=t.codePointAsterisk=t.codePointAmpersand=void 0,t.codePointSmallW=t.codePointSmallV=t.codePointSmallU=t.codePointSmallT=t.codePointSmallS=t.codePointSmallR=t.codePointSmallQ=t.codePointSmallP=t.codePointSmallO=t.codePointSmallN=t.codePointSmallM=t.codePointSmallL=t.codePointSmallK=t.codePointSmallJ=t.codePointSmallI=t.codePointSmallH=t.codePointSmallG=t.codePointSmallF=t.codePointSmallE=t.codePointSmallD=t.codePointSmallC=t.codePointSmallB=t.codePointSmallA=t.codePointSlash=t.codePointSingleQuote=t.codePointSemicolon=t.codePointRightSquareBracket=t.codePointRightParen=t.codePointRightCurlyBracket=t.codePointQuestionMark=t.codePointPlusSign=t.codePointPipe=t.codePointPercentSign=t.codePointMinusSign=t.codePointLessThanSign=t.codePointLeftSquareBracket=t.codePointLeftParen=t.codePointLeftCurlyBracket=t.codePointLF=t.codePointInvertedQuestionMark=t.codePointInvertedExclamationMark=t.codePointHash=t.codePointGreaterThanSign=t.codePointFullwidthLatinSmallZ=t.codePointFullwidthLatinSmallA=t.codePointFullwidthLatinCapitalZ=t.codePointFullwidthLatinCapitalA=t.codePointFullwidthDigitZero=t.codePointFullwidthDigitNine=t.codePointFullStop=void 0,t.codePointUnderscore=t.codePointTilde=t.codePointThaiDigitZero=t.codePointThaiDigitNine=t.codePointTab=t.codePointSpace=t.codePointSmallZ=t.codePointSmallY=t.codePointSmallX=void 0;var n=r(7);t.codePointAmpersand=n.codePoint.codePointAmpersand,t.codePointAsterisk=n.codePoint.codePointAsterisk,t.codePointAtSign=n.codePoint.codePointAtSign,t.codePointBackslash=n.codePoint.codePointBackslash,t.codePointBacktick=n.codePoint.codePointBacktick,t.codePointCR=n.codePoint.codePointCR,t.codePointCapitalA=n.codePoint.codePointCapitalA,t.codePointCapitalB=n.codePoint.codePointCapitalB,t.codePointCapitalC=n.codePoint.codePointCapitalC,t.codePointCapitalD=n.codePoint.codePointCapitalD,t.codePointCapitalE=n.codePoint.codePointCapitalE,t.codePointCapitalF=n.codePoint.codePointCapitalF,t.codePointCapitalG=n.codePoint.codePointCapitalG,t.codePointCapitalH=n.codePoint.codePointCapitalH,t.codePointCapitalI=n.codePoint.codePointCapitalI,t.codePointCapitalJ=n.codePoint.codePointCapitalJ,t.codePointCapitalK=n.codePoint.codePointCapitalK,t.codePointCapitalL=n.codePoint.codePointCapitalL,t.codePointCapitalM=n.codePoint.codePointCapitalM,t.codePointCapitalN=n.codePoint.codePointCapitalN,t.codePointCapitalO=n.codePoint.codePointCapitalO,t.codePointCapitalP=n.codePoint.codePointCapitalP,t.codePointCapitalQ=n.codePoint.codePointCapitalQ,t.codePointCapitalR=n.codePoint.codePointCapitalR,t.codePointCapitalS=n.codePoint.codePointCapitalS,t.codePointCapitalT=n.codePoint.codePointCapitalT,t.codePointCapitalU=n.codePoint.codePointCapitalU,t.codePointCapitalV=n.codePoint.codePointCapitalV,t.codePointCapitalW=n.codePoint.codePointCapitalW,t.codePointCapitalX=n.codePoint.codePointCapitalX,t.codePointCapitalY=n.codePoint.codePointCapitalY,t.codePointCapitalZ=n.codePoint.codePointCapitalZ,t.codePointCircumflexAccent=n.codePoint.codePointCircumflexAccent,t.codePointColon=n.codePoint.codePointColon,t.codePointComma=n.codePoint.codePointComma,t.codePointDigitEight=n.codePoint.codePointDigitEight,t.codePointDigitFive=n.codePoint.codePointDigitFive,t.codePointDigitFour=n.codePoint.codePointDigitFour,t.codePointDigitNine=n.codePoint.codePointDigitNine,t.codePointDigitOne=n.codePoint.codePointDigitOne,t.codePointDigitSeven=n.codePoint.codePointDigitSeven,t.codePointDigitSix=n.codePoint.codePointDigitSix,t.codePointDigitThree=n.codePoint.codePointDigitThree,t.codePointDigitTwo=n.codePoint.codePointDigitTwo,t.codePointDigitZero=n.codePoint.codePointDigitZero,t.codePointDollarSign=n.codePoint.codePointDollarSign,t.codePointDoubleQuote=n.codePoint.codePointDoubleQuote,t.codePointEqualsSign=n.codePoint.codePointEqualsSign,t.codePointEuroSign=n.codePoint.codePointEuroSign,t.codePointExclamationMark=n.codePoint.codePointExclamationMark,t.codePointFullStop=n.codePoint.codePointFullStop,t.codePointFullwidthDigitNine=n.codePoint.codePointFullwidthDigitNine,t.codePointFullwidthDigitZero=n.codePoint.codePointFullwidthDigitZero,t.codePointFullwidthLatinCapitalA=n.codePoint.codePointFullwidthLatinCapitalA,t.codePointFullwidthLatinCapitalZ=n.codePoint.codePointFullwidthLatinCapitalZ,t.codePointFullwidthLatinSmallA=n.codePoint.codePointFullwidthLatinSmallA,t.codePointFullwidthLatinSmallZ=n.codePoint.codePointFullwidthLatinSmallZ,t.codePointGreaterThanSign=n.codePoint.codePointGreaterThanSign,t.codePointHash=n.codePoint.codePointHash,t.codePointInvertedExclamationMark=n.codePoint.codePointInvertedExclamationMark,t.codePointInvertedQuestionMark=n.codePoint.codePointInvertedQuestionMark,t.codePointLF=n.codePoint.codePointLF,t.codePointLeftCurlyBracket=n.codePoint.codePointLeftCurlyBracket,t.codePointLeftParen=n.codePoint.codePointLeftParen,t.codePointLeftSquareBracket=n.codePoint.codePointLeftSquareBracket,t.codePointLessThanSign=n.codePoint.codePointLessThanSign,t.codePointMinusSign=n.codePoint.codePointMinusSign,t.codePointPercentSign=n.codePoint.codePointPercentSign,t.codePointPipe=n.codePoint.codePointPipe,t.codePointPlusSign=n.codePoint.codePointPlusSign,t.codePointQuestionMark=n.codePoint.codePointQuestionMark,t.codePointRightCurlyBracket=n.codePoint.codePointRightCurlyBracket,t.codePointRightParen=n.codePoint.codePointRightParen,t.codePointRightSquareBracket=n.codePoint.codePointRightSquareBracket,t.codePointSemicolon=n.codePoint.codePointSemicolon,t.codePointSingleQuote=n.codePoint.codePointSingleQuote,t.codePointSlash=n.codePoint.codePointSlash,t.codePointSmallA=n.codePoint.codePointSmallA,t.codePointSmallB=n.codePoint.codePointSmallB,t.codePointSmallC=n.codePoint.codePointSmallC,t.codePointSmallD=n.codePoint.codePointSmallD,t.codePointSmallE=n.codePoint.codePointSmallE,t.codePointSmallF=n.codePoint.codePointSmallF,t.codePointSmallG=n.codePoint.codePointSmallG,t.codePointSmallH=n.codePoint.codePointSmallH,t.codePointSmallI=n.codePoint.codePointSmallI,t.codePointSmallJ=n.codePoint.codePointSmallJ,t.codePointSmallK=n.codePoint.codePointSmallK,t.codePointSmallL=n.codePoint.codePointSmallL,t.codePointSmallM=n.codePoint.codePointSmallM,t.codePointSmallN=n.codePoint.codePointSmallN,t.codePointSmallO=n.codePoint.codePointSmallO,t.codePointSmallP=n.codePoint.codePointSmallP,t.codePointSmallQ=n.codePoint.codePointSmallQ,t.codePointSmallR=n.codePoint.codePointSmallR,t.codePointSmallS=n.codePoint.codePointSmallS,t.codePointSmallT=n.codePoint.codePointSmallT,t.codePointSmallU=n.codePoint.codePointSmallU,t.codePointSmallV=n.codePoint.codePointSmallV,t.codePointSmallW=n.codePoint.codePointSmallW,t.codePointSmallX=n.codePoint.codePointSmallX,t.codePointSmallY=n.codePoint.codePointSmallY,t.codePointSmallZ=n.codePoint.codePointSmallZ,t.codePointSpace=n.codePoint.codePointSpace,t.codePointTab=n.codePoint.codePointTab,t.codePointThaiDigitNine=n.codePoint.codePointThaiDigitNine,t.codePointThaiDigitZero=n.codePoint.codePointThaiDigitZero,t.codePointTilde=n.codePoint.codePointTilde,t.codePointUnderscore=n.codePoint.codePointUnderscore},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sqrtpi=t.factdouble=t.fact=t.quotient=t.radians=t.degrees=t.sign=t.abs=t.odd=t.even=t.floor_precise=t.floor_math=t.floor=t.ceiling_precise=t.ceiling_math=t.ceiling=t.mround=t.rounddown=t.roundup=t.trunc=t.round=t.int=t.atan2=t.atan=t.acos=t.asin=t.tan=t.cos=t.sin=t.log=t.log10=t.ln=t.power=t.exp=t.sqrt=t.pi=void 0;var n=r(106),i=r(40),a=r(38);function o(e,t,r){var n=e.cond(t),o=e.cond(r);if(n>0&&o<0)return i.numErrorOper;if(0===n||0===o)return e.zero;var s=e.div(t,r);return(0,a.isErrorOper)(s)?s:e.mul(e.ceil(e.viewRound(s)),r)}function s(e,t,r){var n=e.cond(t),o=e.cond(r);if(n>0&&o<0)return i.numErrorOper;if(0===n&&0===o)return t;var s=e.div(t,r);return(0,a.isErrorOper)(s)?s:e.mul(e.floor(e.viewRound(s)),r)}function u(e,t,r){var i=r[0],a=t.mathpack;if(a.cond(i)>=0){var o=a.ceil(i);return 0===a.cond2((0,n.assertNumber)((0,n.numMod)(a,o,a.fromNumber(2))),a.one)===e?a.add(o,a.one):o}var s=a.floor(i);return 0===a.cond2((0,n.assertNumber)((0,n.numMod)(a,s,a.fromNumber(2))),a.one)===e?a.sub(s,a.one):s}t.pi=function(e,t){return e.mathpack.pi},t.sqrt=(0,n.wrap1)((function(e){return e.mathpack.sqrt})),t.exp=(0,n.wrap1)((function(e){return e.mathpack.exp})),t.power=(0,n.wrap2)((function(e){return e.mathpack.power})),t.ln=(0,n.wrap1)((function(e){return e.mathpack.ln})),t.log10=(0,n.wrap1)((function(e){return e.mathpack.log})),t.log=function(e,t){var r=t[0],n=t[1],i=e.mathpack;if(void 0===n)return i.log(r);var o=i.ln(r);if((0,a.isErrorOper)(o))return o;var s=i.ln(n);return(0,a.isErrorOper)(s)?s:i.div(o,s)},t.sin=(0,n.wrap1)((function(e){return e.mathpack.sin})),t.cos=(0,n.wrap1)((function(e){return e.mathpack.cos})),t.tan=(0,n.wrap1)((function(e){return e.mathpack.tan})),t.asin=(0,n.wrap1)((function(e){return e.mathpack.asin})),t.acos=(0,n.wrap1)((function(e){return e.mathpack.acos})),t.atan=(0,n.wrap1)((function(e){return e.mathpack.atan})),t.atan2=(0,n.wrap2)((function(e){return e.mathpack.atan2})),t.int=function(e,t){var r=t[0],n=e.mathpack;return n.cond2(n.abs(r),n.fromNumber(1e15))<0&&(r=n.viewRound(r)),n.floor(r)},t.round=(0,n.wrap2)((function(e){return e.mathpack.round})),t.trunc=function(e,t){var r=t[0],n=t[1],i=void 0===n?e.mathpack.zero:n;return e.mathpack.roundDown(r,i)},t.roundup=(0,n.wrap2)((function(e){return e.mathpack.roundUp})),t.rounddown=(0,n.wrap2)((function(e){return e.mathpack.roundDown})),t.mround=function(e,t){var r=t[0],o=t[1],s=(0,n.chkNumOper)(e,r);if((0,a.isErrorOper)(s))return s;var u=(0,n.chkNumOper)(e,o);if((0,a.isErrorOper)(u))return u;var c=e.mathpack;if(0===c.cond(u))return c.zero;if(0!==c.cond(s)&&c.cond(s)<0!=c.cond(u)<0)return i.numErrorOper;var l=c.div(s,u);if((0,a.isErrorOper)(l))return i.numErrorOper;var d=c.floor(l),f=(0,n.assertNumber)(c.sub(l,d)),p=c.fromNumber(.5-5e-15);if(c.cond2(f,p)<0)return c.mul(d,u);var m=c.add(d,c.one);return(0,a.isErrorOper)(m)?m:c.mul(m,u)},t.ceiling=function(e,t){var r=t[0],n=t[1];return o(e.mathpack,r,n)},t.ceiling_math=function(e,t){var r=t[0],n=t[1],i=t[2],s=e.mathpack,u=void 0===n||(0,a.isMissingOper)(n)?s.one:s.abs(n),c=void 0===i||(0,a.isMissingOper)(i)?s.zero:i;return 0!==s.cond(c)&&s.cond(r)<0&&(u=s.neg(u)),0===s.cond(u)?s.zero:o(s,r,u)},t.ceiling_precise=function(e,t){var r=t[0],n=t[1],i=e.mathpack,s=void 0===n||(0,a.isMissingOper)(n)?i.one:i.abs(n);return 0===i.cond(s)?i.zero:o(i,r,s)},t.floor=function(e,t){var r=t[0],n=t[1];return s(e.mathpack,r,n)},t.floor_math=function(e,t){var r=t[0],n=t[1],i=t[2],o=e.mathpack,u=void 0===n||(0,a.isMissingOper)(n)?o.one:o.abs(n),c=void 0===i||(0,a.isMissingOper)(i)?o.zero:i;return 0!==o.cond(c)&&o.cond(r)<0&&(u=o.neg(u)),0===o.cond(u)?o.zero:s(o,r,u)},t.floor_precise=function(e,t){var r=t[0],n=t[1],i=e.mathpack,o=void 0===n||(0,a.isMissingOper)(n)?i.one:i.abs(n);return 0===i.cond(o)?i.zero:s(i,r,o)},t.even=u.bind(void 0,!0),t.odd=u.bind(void 0,!1),t.abs=(0,n.wrap1)((function(e){return e.mathpack.abs})),t.sign=function(e,t){var r=t[0],n=e.mathpack;return n.fromNumber(n.cond(r))},t.degrees=function(e,t){var r=t[0],i=e.mathpack,a=(0,n.assertNumber)(i.div(i.fromNumber(180),i.pi));return i.mul(r,a)},t.radians=function(e,t){var r=t[0],i=e.mathpack,a=(0,n.assertNumber)(i.div(i.pi,i.fromNumber(180)));return i.mul(r,a)},t.quotient=function(e,t){var r=t[0],o=t[1],s=(0,n.chkNumOper)(e,r);if((0,a.isErrorOper)(s))return s;var u=(0,n.chkNumOper)(e,o);if((0,a.isErrorOper)(u))return u;var c=e.mathpack;if(0===c.cond(u))return i.div0ErrorOper;var l=c.div(s,u);return(0,a.isErrorOper)(l)?i.numErrorOper:c.cond(l)>0?c.floor(l):c.ceil(l)},t.fact=function(e,t){var r=t[0],n=e.mathpack,o=n.sfix(r);if(n.cond(r)<0||o>170)return i.numErrorOper;for(var s=n.one,u=o;u>0;u-=1){if((0,a.isErrorOper)(s))return s;s=n.mul(n.fromNumber(u),s)}return s},t.factdouble=function(e,t){var r=t[0],o=(0,n.chkNumOper)(e,r);if((0,a.isErrorOper)(o))return o;var s=e.mathpack,u=s.floor(o);if(s.cond2(u,s.fromNumber(-1))<0||s.cond2(u,s.fromNumber(300))>0)return i.numErrorOper;for(var c=s.one,l=s.toNumber(u);l>1;l-=2){if((0,a.isErrorOper)(c))return c;c=s.mul(s.fromNumber(l),c)}return c},t.sqrtpi=function(e,t){var r=t[0],o=(0,n.chkNumOper)(e,r);if((0,a.isErrorOper)(o))return o;var s=e.mathpack;if(s.cond(o)<0)return i.numErrorOper;var u=s.mul(s.pi,o);return(0,a.isErrorOper)(u)?u:s.sqrt(u)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Timer=t.createPerf=void 0;function n(){return"undefined"!=typeof process?{now:function(){var e=process.hrtime();return(1e9*e[0]+e[1])/1e6}}:"undefined"!=typeof performance?performance:Date}t.createPerf=n;var i=function(){function e(e){this.perf=n(),this.name=e,this.start()}return e.prototype.start=function(){this.startTimeMS=this.perf.now(),this.splitTimeMS=this.startTimeMS},e.prototype.split=function(e){var t=this.perf.now(),r=t-this.splitTimeMS;console.warn("timer: "+this.name+" @ "+e+" : = "+this.roundMe(r)+" (total = "+this.roundMe(t-this.startTimeMS)+")"),this.splitTimeMS=t},e.prototype.elapsedTime=function(){return this.perf.now()-this.startTimeMS},e.prototype.roundMe=function(e){return Math.round(100*e)/100},e}();t.Timer=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JSF32=void 0;var n=function(e,t){return(e<<t|e>>>32-t)>>>0},i=function(){function e(e){this.x=new Uint32Array([4058668781,e,e,e]);for(var t=0;t<20;t+=1)this.nextU32()}return e.prototype.next=function(){return this.nextU32()*(1/4294967296)},e.prototype.nextU32=function(){var e=this.x[0]-n(this.x[1],27)>>>0;return this.x[0]=(this.x[1]^n(this.x[2],17))>>>0,this.x[1]=this.x[2]+this.x[3]>>>0,this.x[2]=this.x[3]+e>>>0,this.x[3]=e+this.x[0]>>>0},e}();t.JSF32=i},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.mathLog2=void 0,t.mathLog2=null!==(n=Math.log2)&&void 0!==n?n:function(e){return Math.log(e)*Math.LOG2E}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.globalThis=void 0;var n=r(300);t.globalThis=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BinaryHeap=void 0;var n=function(){function e(e){this.items=[],this.cmp=e}return e.prototype.insert=function(e){this.items.push(e);for(var t=this.getCount()-1;t>0;){var r=t-1>>>1,n=this.items[r];if(!(this.cmp(n,e)>0))break;this.items[t]=n,t=r}this.items[t]=e},e.prototype.peek=function(){return this.items[0]},e.prototype.removeMin=function(){var e=this.peek(),t=this.items.pop(),r=this.getCount()-1;if(r<0||void 0===t)return e;var n=0;for(this.items[0]=t;n<r;){var i=n,a=1+(n<<1),o=2+(n<<1);if(a<=r&&this.cmp(this.items[a],t)<0&&(i=a),o<=r&&this.cmp(this.items[o],i===a?this.items[i]:t)<0&&(i=o),n===i)break;this.items[n]=this.items[i],n=i}return this.items[n]=t,e},e.prototype.getCount=function(){return this.items.length},e.prototype.clear=function(){this.items.length=0},e.prototype.forEach=function(e){for(var t=0,r=this.items;t<r.length;t++){if(!e(r[t]))return}},e}();t.BinaryHeap=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.forEachKeyUntyped=t.forEachKey=t.getNodeCount=t.complement=t.symmetricDiff=t.lazy=t.empty=t.dense=t.compareUntyped=t.combineCmp=t.compare=t.exceptUntyped=t.except=t.meetsUntyped=t.meets=t.intersectUntyped=t.intersect=t.unionUntyped=t.union=t.fromUntyped=t.createFromKey=t.cacheKeySplitting=t.SetKind=void 0;var n,i=r(2),a=r(2).__assign;function o(e,t,r){return void 0===r&&(r=10),function(n){if(void 0!==n.split)return n.split;var i=e(n),a=n===t?0:n.depth;return void 0!==a&&a<r&&(n.split=i,i[0][0].depth=a+1,i[1][0].depth=a+1),i}}function s(e,r){return r===t.empty?t.empty:r===t.dense?t.dense:{setOperations:e,root:r}}function u(e,r){return r===t.empty?e:r===t.dense||e===t.empty?r:e===t.dense?e:s(e.setOperations,c(e.setOperations,e.setOperations.top,e.root,r.root))}function c(e,r,n,i){if(i===t.empty)return n;if(i===t.dense)return i;if(n===t.empty)return i;if(n===t.dense)return n;if(n.isExact&&i.isExact){var a=function(e,r,n,i){var a=n.key,o=i.key,s=e.compare(a,o);if(void 0!==s)return s<0?i:n;var u=e.union(a,o);if(void 0!==u){var c=e.compare(u,r);return void 0!==c&&0===c?t.dense:S(e,r,u,!0)}return}(e,r,n,i);if(void 0!==a)return a}var o=y(e,r,n),s=y(e,r,i),u=e.split(r),l=u[0][0],d=u[1][0];return v(e,l,d,c(e,l,o.left,s.left),c(e,d,o.right,s.right))}function l(e,r,n,i){if(n===t.empty)return n;if(i===t.empty)return i;if(n===t.dense)return i;if(i===t.dense)return n;if(n.isExact&&i.isExact){var a=function(e,r,n,i){var a=n.key,o=i.key;if(!e.meets(a,o))return t.empty;var s=e.compare(a,o);if(void 0!==s)return s<0?n:i;var u=e.intersect(a,o);if(void 0!==u)return S(e,r,u,!0);return}(e,r,n,i);if(void 0!==a)return a}var o=y(e,r,n),s=y(e,r,i),u=e.split(r),c=u[0][0],d=u[1][0];return v(e,c,d,l(e,c,o.left,s.left),l(e,d,o.right,s.right))}function d(e,r,n,i){if(n===t.empty||i===t.empty)return!1;if(n===t.dense||i===t.dense)return!0;if(n.isExact&&i.isExact)return e.meets(n.key,i.key);var a=y(e,r,n),o=y(e,r,i),s=e.split(r),u=s[0][0],c=s[1][0];return d(e,u,a.left,o.left)||d(e,c,a.right,o.right)}function f(e,r){return e===t.empty||r===t.empty?e:r===t.dense?t.empty:e===t.dense?s(r.setOperations,p(r.setOperations,r.setOperations.top,e,r.root)):s(e.setOperations,p(e.setOperations,e.setOperations.top,e.root,r.root))}function p(e,r,n,i){if(n===t.empty)return n;if(i===t.empty)return n;if(i===t.dense)return t.empty;if(n===t.dense){var a=y(e,r,i),o=e.split(r),s=o[0][0],u=o[1][0];return v(e,s,u,p(e,s,t.dense,a.left),p(e,u,t.dense,a.right))}if(n.isExact&&i.isExact){var c=function(e,t,r,n){var i=r.key,a=n.key;if(!e.meets(i,a))return r;var o=e.except(i,a);if(void 0!==o)return S(e,t,o,!0);return}(e,r,n,i);if(void 0!==c)return c}var l=y(e,r,n),d=y(e,r,i),f=e.split(r),m=f[0][0],h=f[1][0];return v(e,m,h,p(e,m,l.left,d.left),p(e,h,l.right,d.right))}function m(e,t){if(void 0!==e&&void 0!==t)return 0===e?t:0===t||e===t?e:void 0}function h(e,r,n,i){if(n===i)return 0;if(n===t.empty)return-1;if(i===t.empty)return 1;if(n===t.dense)return i===t.dense?0:1;if(i===t.dense)return-1;if(n.isExact&&i.isExact)return function(e,t,r){return e.compare(t.key,r.key)}(e,n,i);var a=y(e,r,n),o=y(e,r,i),s=e.split(r),u=s[0][0],c=s[1][0],l=h(e,u,a.left,o.left);if(void 0!==l){var d=h(e,c,a.right,o.right);if(void 0!==d)return m(l,d)}}function v(e,r,n,i,a){return i===t.empty?a===t.empty?t.empty:a===t.dense?g(i,a,void 0,!1,e.infimum(n,n),e.supremum(n,n)):g(i,a,void 0,!1,a.infimum,a.supremum):a===t.empty?i===t.dense?g(i,a,void 0,!1,e.infimum(r,r),e.supremum(r,r)):g(i,a,void 0,!1,i.infimum,i.supremum):i===t.dense?a===t.dense?t.dense:g(i,a,void 0,!1,e.combineInfima(e.infimum(r,r),a.infimum),e.combineSuprema(e.supremum(r,r),a.supremum)):a===t.dense?g(i,a,void 0,!1,e.combineInfima(i.infimum,e.infimum(n,n)),e.combineSuprema(i.supremum,e.supremum(n,n))):g(i,a,void 0,!1,e.combineInfima(i.infimum,a.infimum),e.combineSuprema(i.supremum,a.supremum))}function g(e,t,r,n,i,a){return{key:r,left:e,right:t,isExact:n,infimum:i,supremum:a}}function b(e,r,n){if(!e.meets(r,n))return t.empty;var i=e.compare(r,n);if(void 0!==i)return i<=0?t.dense:S(e,r,n,!0);var a=e.intersect(r,n);return void 0!==a?S(e,r,a,!0):S(e,r,n,!1)}function S(e,t,r,n){return g(void 0,void 0,r,!!n,e.infimum(r,t),e.supremum(r,t))}function y(e,r,n){if(void 0!==n.left)return n;var i=e.split(r),o=i[0][0],s=i[1][0],u=v(e,o,s,b(e,o,n.key),b(e,s,n.key));if(u===t.empty||u===t.dense)throw new Error("incorrect set operations implementation");var c=u;return a(n,{left:c.left,right:c.right})}function O(e,r,n){return function r(i,a){if(a===t.empty)return!0;if(a===t.dense)return n(i);if(a.isExact)return n(a.key);var o=y(e,i,a),s=e.split(i),u=s[0][0],c=s[1][0];return r(u,o.left)&&r(c,o.right)}(e.top,r)}!function(e){e[e.Dense=0]="Dense",e[e.Empty=1]="Empty"}(n=t.SetKind||(t.SetKind={})),t.cacheKeySplitting=o,t.createFromKey=function(e){var t=i.__assign(i.__assign({},e),{split:o(e.split,e.top)});return function(e){return s(t,b(t,t.top,e))}},t.fromUntyped=s,t.union=u,t.unionUntyped=c,t.intersect=function(e,r){return e===t.empty?e:r===t.empty||e===t.dense?r:r===t.dense?e:s(e.setOperations,l(e.setOperations,e.setOperations.top,e.root,r.root))},t.intersectUntyped=l,t.meets=function(e,r){return e!==t.empty&&r!==t.empty&&(e===t.dense||r===t.dense||d(e.setOperations,e.setOperations.top,e.root,r.root))},t.meetsUntyped=d,t.except=f,t.exceptUntyped=p,t.compare=function(e,r){return e===r?0:e===t.empty?-1:r===t.empty?1:e===t.dense?r===t.dense?0:1:r===t.dense?-1:h(e.setOperations,e.setOperations.top,e.root,r.root)},t.combineCmp=m,t.compareUntyped=h,t.dense=n.Dense,t.empty=n.Empty,t.lazy=b,t.symmetricDiff=function(e,t){return u(f(e,t),f(t,e))},t.complement=function(e){return f(t.dense,e)},t.getNodeCount=function(e){return e===t.empty||e===t.dense?0:function e(r){if(void 0===r||r===t.empty||r===t.dense)return 0;return e(r.left)+e(r.right)+1}(e.root)},t.forEachKey=function(e,r){return e===t.empty||O(e.setOperations,e.root,r)},t.forEachKeyUntyped=O},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ivlCompare=t.ivlExcept=t.ivlMeetsOrTouches=t.ivlMeets=t.ivlDistance=t.ivlMeet=t.ivlJoin=void 0;var n=r(74);t.ivlJoin=function(e,t){var r=e[0],i=e[1],a=t[0],o=t[1];return[(0,n.fastMin)(r,a),(0,n.fastMax)(i,o)]},t.ivlMeet=function(e,t){var r=e[0],i=e[1],a=t[0],o=t[1];return[(0,n.fastMax)(r,a),(0,n.fastMin)(i,o)]},t.ivlDistance=function(e,t){var r=e[0],i=e[1],a=t[0],o=t[1];return.5*(0,n.fastAbs)(r+i-(a+o))},t.ivlMeets=function(e,t){var r=e[0],i=e[1],a=t[0],o=t[1];return(0,n.fastMax)(r,a)<(0,n.fastMin)(i,o)},t.ivlMeetsOrTouches=function(e,t){var r=e[0],i=e[1],a=t[0],o=t[1];return(0,n.fastMax)(r,a)<=(0,n.fastMin)(i,o)},t.ivlExcept=function(e,t){var r=e[0],n=e[1],i=t[0],a=t[1];return r<i&&a>=n?[r,i]:r>=i&&a<n?[a,n]:void 0},t.ivlCompare=function(e,t){var r=e[0],n=e[1],i=t[0],a=t[1];return r===i&&n===a?0:r>=i&&n<=a?-1:r<=i&&n>=a?1:void 0}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.remove=t.removeUntyped=t.insert=t.insertUntyped=t.forEach=t.forEachUntyped=t.find=t.findUntyped=t.empty=t.emptyUntyped=t.isLeaf=t.fromUntyped=t.Color=void 0;var n,i,a=r(101);!function(e){e[e.Red=0]="Red",e[e.Black=1]="Black"}(n=t.Color||(t.Color={})),function(e){e[e.DoubleBlack=2]="DoubleBlack"}(i||(i={}));var o=n.Red,s=n.Black,u=i.DoubleBlack,c={c:s,l:void 0,r:void 0},l={c:u,l:void 0,r:void 0};function d(e,t){return{ops:e,root:t}}function f(e){return void 0===e.l}function p(e){return e.c===o}function m(e){return e.c===s&&void 0!==e.l}function h(e){return e.c===s&&void 0===e.l}function v(e,t,r,n,i){return{c:e,l:t,key:r,value:n,r:i}}function g(e,t){return v(e,t.l,t.key,t.value,t.r)}function b(e){return f(e)?c:g(s,e)}function S(e,t,r){if(!f(r)){var n=e.keyCompare(t,r.key);return n<0?S(e,t,r.l):n>0?S(e,t,r.r):r}}function y(e,t){return!!f(t)||!!y(e,t.l)&&(!!e(t.key,t.value)&&y(e,t.r))}function O(e,t,r,n,i){if(e===s){if(p(t)&&p(t.l))return v(o,g(s,t.l),t.key,t.value,v(s,t.r,r,n,i));if(p(i)&&p(i.r))return v(o,v(s,t,r,n,i.l),i.key,i.value,g(s,i.r));if(p(t)&&p(t.r))return v(o,v(s,t.l,t.key,t.value,t.r.l),t.r.key,t.r.value,v(s,t.r.r,r,n,i));if(p(i)&&p(i.l))return v(o,v(s,t,r,n,i.l.l),i.l.key,i.l.value,v(s,i.l.r,i.key,i.value,i.r))}if(e===u){if(p(i)&&p(i.l))return v(s,v(s,t,r,n,i.l.l),i.l.key,i.l.value,v(s,i.l.r,i.key,i.value,i.r));if(p(t)&&p(t.r))return v(s,v(s,t.l,t.key,t.value,t.r.l),t.r.key,t.r.value,v(s,t.r.r,r,n,i))}return v(e,t,r,n,i)}function C(e,t,r,n,i){return e===o&&t.c===u&&m(i)?O(s,v(o,b(t),r,n,i.l),i.key,i.value,i.r):e===o&&m(t)&&i.c===u?O(s,t.l,t.key,t.value,v(o,t.r,r,n,b(i))):e===s&&t.c===u&&m(i)?O(u,v(o,b(t),r,n,i.l),i.key,i.value,i.r):e===s&&m(t)&&i.c===u?O(u,t.l,t.key,t.value,v(o,t.r,r,n,b(i))):e===s&&t.c===u&&p(i)&&m(i.l)?v(s,O(s,v(o,b(t),r,n,i.l.l),i.l.key,i.l.value,i.l.r),i.key,i.value,i.r):e===s&&p(t)&&m(t.r)&&i.c===u?v(s,t.l,t.key,t.value,O(s,t.r.l,t.r.key,t.r.value,v(o,t.r.r,r,n,b(i)))):((0,a.assertTrue)("calc.common.rbTree.rotate: expected R|B",t.c!==u&&i.c!==u),v(e,t,r,n,i))}function P(e,t,r,n){return function(e){return!p(e)||e.l.c!==o&&e.r.c!==o?e:g(s,e)}(function e(t,r,n,i){if(f(i))return v(o,c,r,n,c);var a=t.keyCompare(r,i.key);return a<0?O(i.c,e(t,r,n,i.l),i.key,i.value,i.r):a>0?O(i.c,i.l,i.key,i.value,e(t,r,n,i.r)):v(i.c,i.l,r,n,i.r)}(e,t,r,n))}function N(e,t,r){if(f(r))return r;if(r.c===o&&h(r.l)&&h(r.r))return 0===e.keyCompare(t,r.key)?c:r;if(r.c===s&&h(r.l)&&h(r.r))return 0===e.keyCompare(t,r.key)?l:r;if(r.c===s&&p(r.l)&&h(r.l.l)&&h(r.l.r)&&h(r.r)){var n=e.keyCompare(t,r.key);return n<0?v(s,N(e,t,r.l),r.key,r.value,c):n>0?r:v(s,c,r.l.key,r.l.value,c)}var i=e.keyCompare(t,r.key);if(i<0)return C(r.c,N(e,t,r.l),r.key,r.value,r.r);if(i>0)return C(r.c,r.l,r.key,r.value,N(e,t,r.r));(0,a.assertTrue)("calc.common.rbTree.rem: expected node",!f(r.r));var u=function e(t){if(t.c===o&&h(t.l)&&h(t.r))return[t.key,t.value,c];if(t.c===s&&h(t.l)&&h(t.r))return[t.key,t.value,l];if(t.c===s&&h(t.l)&&p(t.r))return[t.key,t.value,g(s,t.r)];(0,a.assertTrue)("calc.common.rbTree.remMin: expected node",!f(t.l));var r=e(t.l),n=r[0],i=r[1],u=r[2];return[n,i,C(t.c,u,t.key,t.value,t.r)]}(r.r),d=u[0],m=u[1],b=u[2];return C(r.c,r.l,d,m,b)}function R(e,t,r){var n=N(e,t,function(e){return m(e)&&e.l.c===s&&e.r.c===s?g(o,e):e}(r));return(0,a.assertTrue)("calc.common.rbTree.remove: expected R|B",n.c===o||n.c===s),n}t.fromUntyped=d,t.isLeaf=f,t.emptyUntyped=c,t.empty=function(e){return d(e,t.emptyUntyped)},t.findUntyped=S,t.find=function(e,t){return S(t.ops,e,t.root)},t.forEachUntyped=y,t.forEach=function(e,t){return y(e,t.root)},t.insertUntyped=P,t.insert=function(e,t,r){return d(r.ops,P(r.ops,e,t,r.root))},t.removeUntyped=R,t.remove=function(e,t){return d(t.ops,R(t.ops,e,t.root))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initStopwatch=t.ulsStopwatchFactory=void 0;var n=r(18),i={ULS:new n.NulLogger};t.ulsStopwatchFactory=(0,n.initStopwatchFactory)((function(e){return i.ULS.traceTag(595948114,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,e)})),t.initStopwatch=function(e){i.ULS=e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ResolvablePromise=void 0;var n=r(173),i=function(){function e(){var e=this;this.promise=new Promise((function(t,r){e._resolve=t,e._reject=r}))}return e.prototype.then=function(e,t){return this.promise.then(e,t)},e.prototype.toPromise=function(){return this.promise},e.prototype.resolve=function(e){return this._resolve(e),(0,n.isThenable)(e)?this.promise.then():void 0},e.prototype.reject=function(e){return this._reject(e),(0,n.isThenable)(e)?this.promise.then():void 0},e}();t.ResolvablePromise=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AllMachine=t.MachineRuntime=t.MachineCycle=t.nextOnSuccessReceiver=t.callMachineTransition=t.breakTransition=t.nextTransition=t.TransitionKind=void 0;var n,i=r(2),a=r(174);function o(e,t,r){return{kind:e,machine:t,receiver:r}}function s(e,t){return o(n.CallMachine,e,t)}!function(e){e[e.Next=1]="Next",e[e.CallMachine=2]="CallMachine",e[e.Break=3]="Break"}(n=t.TransitionKind||(t.TransitionKind={})),t.nextTransition=o(n.Next,void 0,void 0),t.breakTransition=o(n.Break,void 0,void 0),t.callMachineTransition=s;var u={receiveResult:function(e){return(0,a.isSuccess)(e)?t.nextTransition:e}};t.nextOnSuccessReceiver=function(){return u};var c=function(e){function t(t,r){var n=this.constructor,i=e.call(this,"Cycle detected: tried to call an already-running Machine")||this;i.machine=t,i.stackDepth=r;var a=n.prototype;return Object.getPrototypeOf(i)!==a&&(null!=Object.setPrototypeOf?Object.setPrototypeOf(i,a):i.__proto__=a),i}return i.__extends(t,e),t}(Error);t.MachineCycle=c;var l=function(){function e(e){this.numSteps=0,this.stack=[];try{this.pushFrame(s(e,{receiveResult:function(e){return e}})),this.transition=t.nextTransition}catch(e){this.transition=(0,a.failure)((0,a.javaScriptError)(e))}}return e.resetStats=function(){e.maxStackDepth=0,e.numPauses=0,e.numCycles=0},e.prototype.pushFrame=function(t){var r=this.stack.length,n=t.machine;if(!0===n.runStatus)throw e.numCycles+=1,new c(n,r);!1===n.runStatus&&(n.runStatus=!0),this.stack.push(t),e.maxStackDepth<r+1&&(e.maxStackDepth=r+1)},e.prototype.advanceTopFrame=function(){var e=this.stack[this.stack.length-1].machine;return"boolean"!=typeof e.runStatus?e.runStatus:e.next()},e.prototype.step=function(){this.numSteps+=1;var e=this.transition;try{switch(e.kind){case n.Next:return this.transition=this.advanceTopFrame(),t.nextTransition;case n.CallMachine:return this.pushFrame(e),this.transition=this.advanceTopFrame(),t.nextTransition;case n.Break:return this.transition=t.nextTransition,e;default:var r=this.stack.pop();return r?(r.machine.runStatus=e,this.transition=r.receiver.receiveResult(e),t.nextTransition):e}}catch(e){return this.transition=(0,a.failure)((0,a.javaScriptError)(e)),t.nextTransition}},e.prototype.run=function(t){if(void 0===t&&(t=function(){return!1}),this.result)return this.result;try{for(;;){var r=this.step();if(r.kind===n.Break)return r;if(r.kind!==n.Next)return this.result=r;if(t())return e.numPauses+=1,r}}catch(e){return this.result=(0,a.failure)((0,a.javaScriptError)(e))}},e.prototype.runToResult=function(){for(;;){var e=this.run();if(e.kind!==n.Break)return e}},e.maxStackDepth=0,e.numPauses=0,e.numCycles=0,e}();t.MachineRuntime=l;var d=function(){function e(e){this.machines=e,this.runStatus=!1,this.values=[]}return e.prototype.next=function(){return this.values.length<this.machines.length?s(this.machines[this.values.length],this):(0,a.success)(this.values)},e.prototype.receiveResult=function(e){return(0,a.isSuccess)(e)?(this.values.push(e.value),this.next()):e},e}();t.AllMachine=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCharCodeBits=void 0;var n=r(7).unicode.makeGetCharCodeBits;t.getCharCodeBits=n([65,91,92,93,95,96,97,123,170,171,181,182,186,187,192,215,216,247,248,706,710,722,736,741,748,749,750,751,880,885,886,888,890,894,895,896,902,903,904,907,908,909,910,930,931,1014,1015,1154,1162,1328,1329,1367,1369,1370,1376,1417,1488,1515,1519,1523,1568,1611,1646,1648,1649,1748,1749,1750,1765,1767,1774,1776,1786,1789,1791,1792,1808,1809,1810,1840,1869,1958,1969,1970,1994,2027,2036,2038,2042,2043,2048,2070,2074,2075,2084,2085,2088,2089,2112,2137,2144,2155,2160,2184,2185,2191,2208,2250,2308,2362,2365,2366,2384,2385,2392,2402,2417,2433,2437,2445,2447,2449,2451,2473,2474,2481,2482,2483,2486,2490,2493,2494,2510,2511,2524,2526,2527,2530,2544,2546,2556,2557,2565,2571,2575,2577,2579,2601,2602,2609,2610,2612,2613,2615,2616,2618,2649,2653,2654,2655,2674,2677,2693,2702,2703,2706,2707,2729,2730,2737,2738,2740,2741,2746,2749,2750,2768,2769,2784,2786,2809,2810,2821,2829,2831,2833,2835,2857,2858,2865,2866,2868,2869,2874,2877,2878,2908,2910,2911,2914,2929,2930,2947,2948,2949,2955,2958,2961,2962,2966,2969,2971,2972,2973,2974,2976,2979,2981,2984,2987,2990,3002,3024,3025,3077,3085,3086,3089,3090,3113,3114,3130,3133,3134,3160,3163,3165,3166,3168,3170,3200,3201,3205,3213,3214,3217,3218,3241,3242,3252,3253,3258,3261,3262,3293,3295,3296,3298,3313,3315,3332,3341,3342,3345,3346,3387,3389,3390,3406,3407,3412,3415,3423,3426,3450,3456,3461,3479,3482,3506,3507,3516,3517,3518,3520,3527,3585,3643,3648,3663,3713,3715,3716,3717,3718,3723,3724,3748,3749,3750,3751,3761,3762,3764,3773,3774,3776,3781,3782,3783,3804,3808,3840,3841,3904,3912,3913,3949,3976,3981,4096,4139,4159,4160,4176,4182,4186,4190,4193,4194,4197,4199,4206,4209,4213,4226,4238,4239,4256,4294,4295,4296,4301,4302,4304,4347,4348,4681,4682,4686,4688,4695,4696,4697,4698,4702,4704,4745,4746,4750,4752,4785,4786,4790,4792,4799,4800,4801,4802,4806,4808,4823,4824,4881,4882,4886,4888,4955,4992,5008,5024,5110,5112,5118,5121,5741,5743,5760,5761,5787,5792,5867,5870,5881,5888,5906,5919,5938,5952,5970,5984,5997,5998,6001,6016,6068,6103,6104,6108,6109,6176,6265,6272,6313,6314,6315,6320,6390,6400,6431,6480,6510,6512,6517,6528,6572,6576,6602,6656,6679,6688,6741,6823,6824,6917,6964,6981,6989,7043,7073,7086,7088,7098,7142,7168,7204,7245,7248,7258,7294,7296,7305,7312,7355,7357,7360,7401,7405,7406,7412,7413,7415,7418,7419,7424,7616,7680,7958,7960,7966,7968,8006,8008,8014,8016,8024,8025,8026,8027,8028,8029,8030,8031,8062,8064,8117,8118,8125,8126,8127,8130,8133,8134,8141,8144,8148,8150,8156,8160,8173,8178,8181,8182,8189,8305,8306,8319,8320,8336,8349,8450,8451,8455,8456,8458,8468,8469,8470,8472,8478,8484,8485,8486,8487,8488,8489,8490,8506,8508,8512,8517,8522,8526,8527,8544,8585,11264,11493,11499,11503,11506,11508,11520,11558,11559,11560,11565,11566,11568,11624,11631,11632,11648,11671,11680,11687,11688,11695,11696,11703,11704,11711,11712,11719,11720,11727,11728,11735,11736,11743,12293,12296,12321,12330,12337,12342,12344,12349,12353,12439,12443,12448,12449,12539,12540,12544,12549,12592,12593,12687,12704,12736,12784,12800,13312,19904,19968,42125,42192,42238,42240,42509,42512,42528,42538,42540,42560,42607,42623,42654,42656,42736,42775,42784,42786,42889,42891,42955,42960,42962,42963,42964,42965,42970,42994,43010,43011,43014,43015,43019,43020,43043,43072,43124,43138,43188,43250,43256,43259,43260,43261,43263,43274,43302,43312,43335,43360,43389,43396,43443,43471,43472,43488,43493,43494,43504,43514,43519,43520,43561,43584,43587,43588,43596,43616,43639,43642,43643,43646,43696,43697,43698,43701,43703,43705,43710,43712,43713,43714,43715,43739,43742,43744,43755,43762,43765,43777,43783,43785,43791,43793,43799,43808,43815,43816,43823,43824,43867,43868,43882,43888,44003,44032,55204,55216,55239,55243,55292,63744,64110,64112,64218,64256,64263,64275,64280,64285,64286,64287,64297,64298,64311,64312,64317,64318,64319,64320,64322,64323,64325,64326,64434,64467,64830,64848,64912,64914,64968,65008,65020,65136,65141,65142,65277,65313,65339,65345,65371,65382,65471,65474,65480,65482,65488,65490,65496,65498,65501],[48,58,63,64,65,91,92,93,95,96,97,123,162,167,168,171,174,177,178,182,183,187,188,191,192,215,216,247,248,888,890,894,895,896,900,907,908,909,910,930,931,1328,1329,1367,1369,1370,1376,1417,1421,1424,1425,1470,1471,1472,1473,1475,1476,1478,1479,1480,1488,1515,1519,1523,1536,1545,1547,1548,1550,1563,1564,1565,1567,1642,1646,1748,1749,1792,1807,1867,1869,1970,1984,2039,2042,2043,2045,2094,2112,2140,2144,2155,2160,2191,2192,2194,2200,2404,2406,2416,2417,2436,2437,2445,2447,2449,2451,2473,2474,2481,2482,2483,2486,2490,2492,2501,2503,2505,2507,2511,2519,2520,2524,2526,2527,2532,2534,2557,2558,2559,2561,2564,2565,2571,2575,2577,2579,2601,2602,2609,2610,2612,2613,2615,2616,2618,2620,2621,2622,2627,2631,2633,2635,2638,2641,2642,2649,2653,2654,2655,2662,2678,2689,2692,2693,2702,2703,2706,2707,2729,2730,2737,2738,2740,2741,2746,2748,2758,2759,2762,2763,2766,2768,2769,2784,2788,2790,2800,2801,2802,2809,2816,2817,2820,2821,2829,2831,2833,2835,2857,2858,2865,2866,2868,2869,2874,2876,2885,2887,2889,2891,2894,2901,2904,2908,2910,2911,2916,2918,2936,2946,2948,2949,2955,2958,2961,2962,2966,2969,2971,2972,2973,2974,2976,2979,2981,2984,2987,2990,3002,3006,3011,3014,3017,3018,3022,3024,3025,3031,3032,3046,3067,3072,3085,3086,3089,3090,3113,3114,3130,3132,3141,3142,3145,3146,3150,3157,3159,3160,3163,3165,3166,3168,3172,3174,3184,3192,3204,3205,3213,3214,3217,3218,3241,3242,3252,3253,3258,3260,3269,3270,3273,3274,3278,3285,3287,3293,3295,3296,3300,3302,3312,3313,3315,3328,3341,3342,3345,3346,3397,3398,3401,3402,3408,3412,3428,3430,3456,3457,3460,3461,3479,3482,3506,3507,3516,3517,3518,3520,3527,3530,3531,3535,3541,3542,3543,3544,3552,3558,3568,3570,3572,3585,3643,3647,3663,3664,3674,3713,3715,3716,3717,3718,3723,3724,3748,3749,3750,3751,3774,3776,3781,3782,3783,3784,3790,3792,3802,3804,3808,3840,3844,3859,3860,3861,3898,3902,3912,3913,3949,3953,3973,3974,3992,3993,4029,4030,4045,4046,4048,4053,4057,4096,4170,4176,4294,4295,4296,4301,4302,4304,4347,4348,4681,4682,4686,4688,4695,4696,4697,4698,4702,4704,4745,4746,4750,4752,4785,4786,4790,4792,4799,4800,4801,4802,4806,4808,4823,4824,4881,4882,4886,4888,4955,4957,4960,4969,4989,4992,5018,5024,5110,5112,5118,5121,5742,5743,5760,5761,5787,5792,5867,5870,5881,5888,5910,5919,5941,5952,5972,5984,5997,5998,6001,6002,6004,6016,6100,6103,6104,6107,6110,6112,6122,6128,6138,6155,6170,6176,6265,6272,6315,6320,6390,6400,6431,6432,6444,6448,6460,6464,6465,6470,6510,6512,6517,6528,6572,6576,6602,6608,6619,6622,6684,6688,6751,6752,6781,6783,6794,6800,6810,6823,6824,6832,6863,6912,6989,6992,7002,7009,7037,7040,7156,7168,7224,7232,7242,7245,7294,7296,7305,7312,7355,7357,7360,7376,7379,7380,7419,7424,7958,7960,7966,7968,8006,8008,8014,8016,8024,8025,8026,8027,8028,8029,8030,8031,8062,8064,8117,8118,8133,8134,8148,8150,8156,8157,8176,8178,8181,8182,8191,8203,8208,8234,8239,8255,8257,8260,8261,8274,8275,8276,8277,8288,8293,8294,8306,8308,8317,8319,8333,8336,8349,8352,8385,8400,8433,8448,8588,8592,9001,9003,9255,9280,9291,9312,10088,10102,10181,10183,10214,10224,10627,10649,10712,10716,10748,10750,11124,11126,11158,11159,11508,11517,11518,11520,11558,11559,11560,11565,11566,11568,11624,11631,11632,11647,11671,11680,11687,11688,11695,11696,11703,11704,11711,11712,11719,11720,11727,11728,11735,11736,11743,11744,11776,11823,11824,11856,11858,11904,11930,11931,12020,12032,12246,12272,12284,12292,12296,12306,12308,12320,12336,12337,12349,12350,12352,12353,12439,12441,12448,12449,12539,12540,12544,12549,12592,12593,12687,12688,12772,12784,12831,12832,42125,42128,42183,42192,42238,42240,42509,42512,42540,42560,42611,42612,42622,42623,42738,42752,42955,42960,42962,42963,42964,42965,42970,42994,43053,43056,43066,43072,43124,43136,43206,43216,43226,43232,43256,43259,43260,43261,43310,43312,43348,43360,43389,43392,43457,43471,43482,43488,43519,43520,43575,43584,43598,43600,43610,43616,43715,43739,43742,43744,43760,43762,43767,43777,43783,43785,43791,43793,43799,43808,43815,43816,43823,43824,43884,43888,44011,44012,44014,44016,44026,44032,55204,55216,55239,55243,55292,63744,64110,64112,64218,64256,64263,64275,64280,64285,64311,64312,64317,64318,64319,64320,64322,64323,64325,64326,64451,64467,64830,64832,64912,64914,64968,64975,64976,65008,65040,65056,65072,65075,65077,65101,65104,65122,65123,65124,65127,65129,65130,65136,65141,65142,65277,65279,65280,65284,65285,65291,65292,65296,65306,65308,65311,65313,65339,65342,65371,65372,65373,65374,65375,65382,65471,65474,65480,65482,65488,65490,65496,65498,65501,65504,65511,65512,65519,65529,65534],[48,58,1632,1642,1776,1786,1984,1994,2406,2416,2534,2544,2662,2672,2790,2800,2918,2928,3046,3056,3174,3184,3302,3312,3430,3440,3558,3568,3664,3674,3792,3802,3872,3882,4160,4170,4240,4250,6112,6122,6160,6170,6470,6480,6608,6618,6784,6794,6800,6810,6992,7002,7088,7098,7232,7242,7248,7258,42528,42538,43216,43226,43264,43274,43472,43482,43504,43514,43600,43610,44016,44026,65296,65306])},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseSignedLiteral=t.parseNumberLiteral=t.parseUint=t.isSpace=void 0;var n=r(58),i=r(70),a=r(111),o=r(112),s=r(177),u=r(142),c=r(86),l=u.codePointSpace,d=u.codePointLF,f=u.codePointMinusSign,p=u.codePointPlusSign,m=u.codePointSlash;function h(e){return e===l||e===d}function v(e,t,r,a){(0,i.assertIndex)("calc.parse.parseUint",t,16);for(var s=0,u=a,c=r.length;u<c;){var l=(0,o.stringCodePointAt)(r,u);if(!e.isNumeral(l))break;var d=e.getOrdinal(l);0===s&&0!==d&&(c=(0,n.fastMin)(c,u+t)),s=10*s+d,u+=(0,o.numCodeUnits)(l)}return u===c&&u<r.length&&e.isNumeral((0,o.stringCodePointAt)(r,u))?[0,a]:[s,u]}function g(e,t,r,n){var a=n,o=v(e,5,r,a),s=o[0],u=o[1];if(u===a)return!1;if(s>32767)return!1;if(!((a=u)<r.length&&r.charCodeAt(a)===m))return!1;var l=v(e,5,r,a+=1),d=l[0],f=l[1];if(f===a)return!1;if(d>32767)return!1;if(a=f,0===d)return[!1,0,a];var p=t.div(t.fromNumber(s),t.fromNumber(d));return(0,i.assertTrue)("calc.lang.tryTokenizeFrac",(0,c.isNumberOper)(p)),[p,d,a]}function b(e,t,r,u,l,d,m){var b,S,y,O=u,C=0,P="",N=!1,R=!1,k=s.NumberShape.ASCII;if((0,a.stringStartsWith)(r,e.decimalSeparator,u)||u<r.length&&e.isNumeral((0,o.stringCodePointAt)(r,u))){for(var T=function(){if((d||l&&r.indexOf("%",O)>=0)&&(C-=2,void 0!==b)){var a=t.div(b,t.fromNumber(100));(0,i.assertTrue)("calc.lang.parseNumberLiteral",(0,c.isNumberOper)(a)),b=a,y=s.KnownFormat.Pct}if((0,n.fastAbs)(C)>=309)return{value:void 0,i:O,consumedThousands:N,consumedDecimal:R,numShape:k,format:y};var o=t.parse(e,!0,C,P);if(void 0!==b){var u=t.add(o,b);(0,i.assertTrue)("calc.lang.parseNumberLiteral",(0,c.isNumberOper)(u)),o=u}return{value:o,i:O,consumedThousands:N,consumedDecimal:R,numShape:k,format:y}};O<r.length;){var E=(0,o.stringCodePointAt)(r,O);if(!e.isNumeral(E))break;if(0!==e.getOrdinal(E))break;(S=e.getNumberShape(E))!==s.NumberShape.ASCII&&(k=S),O+=(0,o.numCodeUnits)(E)}if(m)if(!1!==(A=g(e,t,r,O))){var _=A[0],F=A[1],I=A[2];return O=I,!1===_?{value:void 0,i:O,consumedThousands:N,consumedDecimal:R,numShape:k,format:y}:(y=F>=10?s.KnownFormat.FractBond:s.KnownFormat.Fract,b=_,T())}for(var A,M=O;O<r.length;){E=(0,o.stringCodePointAt)(r,O);if(e.isNumeral(E))C+=1,(S=e.getNumberShape(E))!==s.NumberShape.ASCII&&(k=S),O+=(0,o.numCodeUnits)(E);else{if(!(l&&C>0&&(0,a.stringStartsWith)(r,e.thousandsSeparator,O)))break;N=!0,O+=e.thousandsSeparator.length}}if(P+=r.substring(M,O),N){var w=function(e,t,r){for(var n=r,i="",a=0;a<t.length;){var s=(0,o.stringCodePointAt)(t,a);if(e.isNumeral(s)){var u=(0,o.numCodeUnits)(s);i+=t.substring(a,a+u),a+=u,n-=1}else{if(0===n||!e.isThousandsPosition(n))return;a+=e.thousandsSeparator.length}}return i}(e,P,C);if(void 0===w)return;P=w}if(u<O&&O<r.length&&h(r.charCodeAt(O)))if(!1!==(A=g(e,t,r,O+1))){_=A[0],F=A[1],I=A[2];return O=I,!1===_?{value:void 0,i:O,consumedThousands:N,consumedDecimal:R,numShape:k,format:y}:(y=F>=10?s.KnownFormat.FractBond:s.KnownFormat.Fract,b=_,T())}var D=!1;if((0,a.stringStartsWith)(r,e.decimalSeparator,O)&&(D=O===u,R=!0,O+=e.decimalSeparator.length),0===C)for(;O<r.length;){E=(0,o.stringCodePointAt)(r,O);if(!e.isNumeral(E))break;if(0!==e.getOrdinal(E))break;C-=1,(S=e.getNumberShape(E))!==s.NumberShape.ASCII&&(k=S),O+=(0,o.numCodeUnits)(E)}for(M=O;O<r.length;){E=(0,o.stringCodePointAt)(r,O);if(!e.isNumeral(E))break;(S=e.getNumberShape(E))!==s.NumberShape.ASCII&&(k=S),O+=(0,o.numCodeUnits)(E)}if(P+=r.substring(M,O),!(D&&O<=u+e.decimalSeparator.length)){var j=function(e,t,r){var n=r;if(n<t.length&&0===e.stringCompareCI("E",t.substring(n,n+1)))n+=1;else{if(!(0,a.stringStartsWith)(t,"**",n))return[0,r];n+=2}var i=!1;if(n<t.length){var s=(0,o.stringCodePointAt)(t,n);((i=s===f)||s===p)&&(n+=(0,o.numCodeUnits)(s))}if(n>=t.length||!e.isNumeral((0,o.stringCodePointAt)(t,n)))return!1;var u=v(e,10,t,n),c=u[0],l=u[1];return l!==n&&(!(c>2147483647)&&[i?-c:c,l])}(e,r,O);if(!1!==j){var x=j[0];I=j[1];C+=x,I!==O&&(y=s.KnownFormat.Exp),O=I}return!1===j?{value:void 0,i:O,consumedThousands:N,consumedDecimal:R,numShape:k,format:y}:T()}}}t.isSpace=h,t.parseUint=v,t.parseNumberLiteral=b,t.parseSignedLiteral=function(e,t,r,n,i){var a=n,o=!1;if(a<r.length){var s=r.charCodeAt(a);if((s===p||s===f)&&(o=s===f,a+=1,i))for(;a<r.length&&h(r.charCodeAt(a));)a+=1}var u=b(e,t,r,a,!1,!1,!1);return void 0===(null==u?void 0:u.value)?[t.zero,n]:(a=u.i,[o?t.neg(u.value):u.value,a])}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Pledge=void 0;var n=r(7);t.Pledge=n.pledge.Pledge},function(e,t,r){"use strict";var n,i,a,o,s,u;Object.defineProperty(t,"__esModule",{value:!0}),t.getEnglishLocaleInfo=t.createWorksheetFuncNameCallbacks=t.getEnglishWorksheetFuncIdToName=t.operatorIdToName=t.englishOperatorIdToName=t.englishErrorTypeToName=t.englishWorksheetFuncIdToName=t.englishSysTimeFormat=t.englishSysDateFormat=t.englishPictureDbnum=t.englishPictureColor=t.englishPictureSingle=t.englishPictureSpecial=t.englishSpecialRefNames=t.englishErrorNames=t.isIdentContinue=t.isIdentStart=t.getGetNumberShape=t.getGetOrdinal=t.getIsNumeral=t.getNumberShapeNew=t.getOrdinalNew=t.isNumeralNew=t.getNumberShapeOld=t.getOrdinalOld=t.isNumeralOld=t.PictureDbnum=t.PictureColor=t.PictureSingle=t.PictureSpecial=t.LCID=t.Country=t.localeInfo=t.calcConfig=t.ulsLogger=t.NulLogger=t.TraceLevel=t.LogCategory=void 0;var c=r(18);Object.defineProperty(t,"LogCategory",{enumerable:!0,get:function(){return c.LogCategory}}),Object.defineProperty(t,"TraceLevel",{enumerable:!0,get:function(){return c.TraceLevel}}),Object.defineProperty(t,"NulLogger",{enumerable:!0,get:function(){return c.NulLogger}});var l=r(58),d=r(70);Object.defineProperty(t,"ulsLogger",{enumerable:!0,get:function(){return d.ulsLogger}});var f,p,m,h,v,g,b=r(128),S=r(220),y=r(111),O=r(112),C=r(216),P=r(338),N=r(109),R=r(69),k=r(177),T=r(221),E=r(224),_=r(140);function F(e,t,r,n,i,a,o,s,u,c,l,d,f,p,m,h,v,g,b,S,y,O,C,P,N,R,k,T,E,_,F,I,A,M,w,D,j,x,L,B,U,G,K,V,W,H,q,z,Q,J,Y,$,Z,X,ee,te,re,ne,ie,ae,oe,se,ue,ce,le){return{getWorksheetFuncId:e,getWorksheetFuncName:t,isNumeral:r,getOrdinal:n,getNumberShape:i,isThousandsPosition:a,isIdentStart:o,isIdentContinue:s,stringCompareCI:u,errorNames:c,specialRefNames:l,trueName:d,falseName:f,rowLetter:p,columnLetter:m,leftBrace:h,rightBrace:v,leftBracket:g,rightBracket:b,decimalSeparator:S,listSeparator:y,columnSeparator:O,rowSeparator:C,thousandsSeparator:P,lcid:N,country:R,isThai:k,isEastAsia:T,isKorea:E,isJapan:_,isChinaT:F,isChinaS:I,isComplexScript:A,numberDecimals:M,isExpSepBySpace:w,fractionSeparator:D,isPercentSepBySpace:j,currencyFormat:x,isCurrencySymbolLead:L,isCurrencySepBySpace:B,currencySymbol:U,currencyDecimals:G,dateOrder:K,dateSeparator:V,dateAltSeparator:W,year4Digits:H,month2Digits:q,day2Digits:z,longDateFormat:Q,timeSeparator:J,timeAltSeparator:Y,hour2Digits:$,clock24Hour:Z,isAMPMSepBySpace:X,ampmSymbols:ee,dayNameShort:te,dayNameLong:re,monthNameShort:ne,monthNameLong:ie,pictureSpecial:ae,pictureSingle:oe,pictureColor:se,pictureDbnum:ue,sysDateFormat:ce,sysTimeFormat:le}}function I(e){return 0!=((0,C.getCharCodeBits)(e)&O.CharCodeBits.DigitClass)}function A(e){var t=(0,C.getCharCodeBits)(e);return 0==(t&O.CharCodeBits.DigitClass)?(0,d.assertFalse)("calc.config.getOrdinal: expected numeral; given ".concat((0,S.anonymize)(e))):t&O.CharCodeBits.Ordinal}function M(e){switch((0,d.assertTrue)("calc.config.getNumberShape",I(e)),2147483392&e){case 0:return k.NumberShape.ASCII;case 1536:return e<1648?k.NumberShape.ArabicIndic:k.NumberShape.ExtendedArabicIndic;case 1792:return k.NumberShape.Unknown;case 2304:return e<2416?k.NumberShape.Devanagari:k.NumberShape.Bengali;case 2560:return e<2672?k.NumberShape.Gurmukhi:k.NumberShape.Gujarati;case 2816:return e<2928?k.NumberShape.Oriya:k.NumberShape.Tamil;case 3072:return e<3184?k.NumberShape.Telugu:k.NumberShape.Kannada;case 3328:return e<3440?k.NumberShape.Malayalam:k.NumberShape.Unknown;case 3584:return e<3680?k.NumberShape.Thai:k.NumberShape.Lao;case 3840:return k.NumberShape.Tibetan;case 4096:return e<4176?k.NumberShape.Myanmar:k.NumberShape.Unknown;case 4864:return k.NumberShape.Ethiopic;case 5888:return k.NumberShape.Khmer;case 6144:return k.NumberShape.Mongolian;default:return k.NumberShape.Unknown}}function w(e){var t=0|e;if(t<128)return t>=48&&t<58;var r=15&t;switch(2147483632&t){case 1632:case 1776:return r<=9;case 2400:case 2528:case 2656:case 2784:case 2912:case 3040:case 3168:case 3296:case 3424:return r>=6&&r<=15;case 3664:case 3792:case 3872:case 4160:return r<=9;case 4960:return r>=9;case 4976:return r<=1;case 6112:case 6160:return r<=9;default:return!1}}function D(e){var t=0|e;if(t<128)return(t<48||t>=58)&&(0,d.assertFalse)("calc.config.getOrdinal"),15&t;var r,n=15&t;switch(2147483632&t){case 1632:case 1776:r=n;break;case 2400:case 2528:case 2656:case 2784:case 2912:case 3040:case 3168:case 3296:case 3424:r=n-6;break;case 3664:case 3792:case 3872:case 4160:r=n;break;case 4960:r=n-8;break;case 4976:r=n+8;break;case 6112:case 6160:r=n;break;default:return(0,d.assertFalse)("calc.config.getOrdinal")}return(r<0||r>9||4968===t)&&(0,d.assertFalse)("calc.config.getOrdinal"),r}function j(e){var t=0|e;if(t<128)return(t<48||t>=58)&&(0,d.assertFalse)("calc.config.getNumberShape"),k.NumberShape.ASCII;switch(w(t)||(0,d.assertFalse)("calc.config.getNumberShape"),2147483632&t){case 1632:return k.NumberShape.ArabicIndic;case 1776:return k.NumberShape.ExtendedArabicIndic;case 2400:return k.NumberShape.Devanagari;case 2528:return k.NumberShape.Bengali;case 2656:return k.NumberShape.Gurmukhi;case 2784:return k.NumberShape.Gujarati;case 2912:return k.NumberShape.Oriya;case 3040:return k.NumberShape.Tamil;case 3168:return k.NumberShape.Telugu;case 3296:return k.NumberShape.Kannada;case 3424:return k.NumberShape.Malayalam;case 3664:return k.NumberShape.Thai;case 3792:return k.NumberShape.Lao;case 3872:return k.NumberShape.Tibetan;case 4160:return k.NumberShape.Myanmar;case 4960:case 4976:return k.NumberShape.Ethiopic;case 6112:return k.NumberShape.Khmer;case 6160:return k.NumberShape.Mongolian;default:return(0,d.assertFalse)("calc.config.getNumberShape")}}function x(){return(0,_.getTypedFeatureGate)("Microsoft.Office.Excel.CalcNewIsNumeral")?w:I}function L(){return(0,_.getTypedFeatureGate)("Microsoft.Office.Excel.CalcNewIsNumeral")?D:A}function B(){return(0,_.getTypedFeatureGate)("Microsoft.Office.Excel.CalcNewIsNumeral")?j:M}function U(e){return 0!=((0,C.getCharCodeBits)(e)&O.CharCodeBits.IdentStartClass)}function G(e){return 0!=((0,C.getCharCodeBits)(e)&O.CharCodeBits.IdentContinueClass)}t.calcConfig=function(e,t,r,n,i,a,o){return void 0===t&&(t=R.RefStyle.A1),void 0===r&&(r=E.xlMathpack),void 0===n&&(n=!1),void 0===i&&(i=!0),void 0===a&&(a=T.tzUTC),void 0===o&&(o=T.xlDatepack),{localeInfo:e,refStyle:t,mathpack:r,date1904:n,dateCompatibility:i,timezone:a,datepack:o}},t.localeInfo=F,function(e){e[e.USA=1]="USA",e[e.UK=44]="UK",e[e.AUS=61]="AUS",e[e.NZ=64]="NZ",e[e.UNK=1]="UNK",e[e.CAN=2]="CAN",e[e.DUT=31]="DUT",e[e.FRN=33]="FRN",e[e.SPA=34]="SPA",e[e.ITN=39]="ITN",e[e.SWE=46]="SWE",e[e.GER=49]="GER",e[e.JPN=81]="JPN",e[e.MEX=52]="MEX",e[e.BRA=55]="BRA",e[e.LAM=3]="LAM",e[e.BEL=32]="BEL",e[e.SWZ=41]="SWZ",e[e.SWG=41]="SWG",e[e.SWF=41]="SWF",e[e.AUT=43]="AUT",e[e.DAN=45]="DAN",e[e.NOR=47]="NOR",e[e.POR=351]="POR",e[e.FIN=358]="FIN",e[e.ICE=354]="ICE",e[e.GRK=30]="GRK",e[e.TUR=90]="TUR",e[e.CZE=420]="CZE",e[e.HUN=36]="HUN",e[e.POL=48]="POL",e[e.RUS=7]="RUS",e[e.HEB=972]="HEB",e[e.ARB=966]="ARB",e[e.PER=981]="PER",e[e.ARB_Algeria=213]="ARB_Algeria",e[e.ARB_Bahrain=966]="ARB_Bahrain",e[e.ARB_Djibouti=253]="ARB_Djibouti",e[e.ARB_Egypt=20]="ARB_Egypt",e[e.ARB_Iraq=964]="ARB_Iraq",e[e.ARB_Jordan=962]="ARB_Jordan",e[e.ARB_Kuwait=965]="ARB_Kuwait",e[e.ARB_Lebanon=961]="ARB_Lebanon",e[e.ARB_Libya=218]="ARB_Libya",e[e.ARB_Mauritania=222]="ARB_Mauritania",e[e.ARB_Morocco=216]="ARB_Morocco",e[e.ARB_Oman=968]="ARB_Oman",e[e.ARB_Qatar=974]="ARB_Qatar",e[e.ARB_SaudiArabia=966]="ARB_SaudiArabia",e[e.ARB_Somalia=1]="ARB_Somalia",e[e.ARB_Sudan=249]="ARB_Sudan",e[e.ARB_Syria=963]="ARB_Syria",e[e.ARB_Tunisia=216]="ARB_Tunisia",e[e.ARB_UAE=971]="ARB_UAE",e[e.ARB_Yemen=969]="ARB_Yemen",e[e.KOR=82]="KOR",e[e.TW=886]="TW",e[e.PRC=86]="PRC",e[e.THA=66]="THA",e[e.VIET=84]="VIET"}(f=t.Country||(t.Country={})),function(e){e[e.None=0]="None",e[e.USA=1033]="USA",e[e.Greek=1032]="Greek",e[e.Hungarian=1038]="Hungarian",e[e.Turkish=1055]="Turkish",e[e.Thailand=1054]="Thailand",e[e.Vietnam=1066]="Vietnam",e[e.Arabic=1025]="Arabic",e[e.Hebrew=1037]="Hebrew",e[e.Tamil=1097]="Tamil",e[e.Syriac=1114]="Syriac",e[e.Iraq=2049]="Iraq",e[e.Algerian=5121]="Algerian",e[e.Basque=1069]="Basque",e[e.PortBrazil=1046]="PortBrazil",e[e.Croatian=1050]="Croatian",e[e.Czech=1029]="Czech",e[e.Danish=1030]="Danish",e[e.Dutch=1043]="Dutch",e[e.Australian=3081]="Australian",e[e.CanadianEnglish=4105]="CanadianEnglish",e[e.British=2057]="British",e[e.Finnish=1035]="Finnish",e[e.French=1036]="French",e[e.FrenchCanadian=3084]="FrenchCanadian",e[e.Italian=1040]="Italian",e[e.NorskBokmal=1044]="NorskBokmal",e[e.NorskNynorsk=2068]="NorskNynorsk",e[e.Polish=1045]="Polish",e[e.PortIberian=2070]="PortIberian",e[e.Romanian=1048]="Romanian",e[e.Russian=1049]="Russian",e[e.Ukrainian=1058]="Ukrainian",e[e.Belarusian=1059]="Belarusian",e[e.SerbianCyrillic=3098]="SerbianCyrillic",e[e.SerbianLatin=2074]="SerbianLatin",e[e.Slovak=1051]="Slovak",e[e.Slovenian=1060]="Slovenian",e[e.SpanishModern=3082]="SpanishModern",e[e.Swedish=1053]="Swedish",e[e.HongKong=3076]="HongKong",e[e.ChinaT=1028]="ChinaT",e[e.Korea=1042]="Korea",e[e.Japan=1041]="Japan",e[e.China=2052]="China",e[e.ChinaStroke=133124]="ChinaStroke",e[e.Devihi=1125]="Devihi",e[e.Hindi=1081]="Hindi",e[e.German=1031]="German",e[e.Swiss=4108]="Swiss",e[e.SystemTime=62464]="SystemTime",e[e.SystemLongDate=63488]="SystemLongDate",e[e.EuroTrailing=1]="EuroTrailing",e[e.EuroLeading=2]="EuroLeading",e[e.LANG=1023]="LANG",e[e.COUNTRY=64512]="COUNTRY",e[e.OPTIONS=16711680]="OPTIONS"}(p=t.LCID||(t.LCID={})),function(e){e[e.AP1=0]="AP1",e[e.AP2=1]="AP2",e[e.AP3=2]="AP3",e[e.GeneralOldMAC=3]="GeneralOldMAC",e[e.General=4]="General",e[e.Currency=5]="Currency"}(m=t.PictureSpecial||(t.PictureSpecial={})),function(e){e[e.Sep=1]="Sep",e[e.Hash=2]="Hash",e[e.Zero=3]="Zero",e[e.Decimal=4]="Decimal",e[e.Percent=5]="Percent",e[e.Comma=6]="Comma",e[e.Colon=7]="Colon",e[e.DateSep=8]="DateSep",e[e.Slash=9]="Slash",e[e.Space=10]="Space",e[e.Minus=11]="Minus",e[e.Plus=12]="Plus",e[e.OpenParen=13]="OpenParen",e[e.CloseParen=14]="CloseParen",e[e.Extra=15]="Extra",e[e.Backslash=16]="Backslash",e[e.Star=17]="Star",e[e.Year=18]="Year",e[e.Month=19]="Month",e[e.Day=20]="Day",e[e.Hour=21]="Hour",e[e.Minute=22]="Minute",e[e.Second=23]="Second",e[e.E=24]="E",e[e.APDelim=25]="APDelim",e[e.Quote=26]="Quote",e[e.ColorStart=27]="ColorStart",e[e.ColorEnd=28]="ColorEnd",e[e.Text=29]="Text",e[e.Question=30]="Question",e[e.Underscore=31]="Underscore",e[e.Reign=32]="Reign",e[e.LocDay=33]="LocDay",e[e.Era=34]="Era",e[e.EraYear=35]="EraYear",e[e.Nen1=36]="Nen1",e[e.Gatsu1=37]="Gatsu1",e[e.Nichi1=38]="Nichi1",e[e.Nen2=39]="Nen2",e[e.Gatsu2=40]="Gatsu2",e[e.Nichi2=41]="Nichi2",e[e.BidiDate=42]="BidiDate",e[e.BidiNum=43]="BidiNum",e[e.DayTh=44]="DayTh",e[e.MonthTh=45]="MonthTh",e[e.YearTh=46]="YearTh",e[e.EngYearTh=47]="EngYearTh",e[e.ThYear=48]="ThYear",e[e.HourTh=49]="HourTh",e[e.MinuteTh=50]="MinuteTh",e[e.SecondTh=51]="SecondTh",e[e.ZeroTh=52]="ZeroTh"}(h=t.PictureSingle||(t.PictureSingle={})),function(e){e[e.Black=0]="Black",e[e.White=1]="White",e[e.Red=2]="Red",e[e.Green=3]="Green",e[e.Blue=4]="Blue",e[e.Yellow=5]="Yellow",e[e.Magenta=6]="Magenta",e[e.Cyan=7]="Cyan",e[e.Color=8]="Color"}(v=t.PictureColor||(t.PictureColor={})),function(e){e[e.DBNUM1=0]="DBNUM1",e[e.DBNUM2=1]="DBNUM2",e[e.DBNUM3=2]="DBNUM3",e[e.DBNUM4=3]="DBNUM4"}(g=t.PictureDbnum||(t.PictureDbnum={})),t.isNumeralOld=I,t.getOrdinalOld=A,t.getNumberShapeOld=M,t.isNumeralNew=w,t.getOrdinalNew=D,t.getNumberShapeNew=j,t.getIsNumeral=x,t.getGetOrdinal=L,t.getGetNumberShape=B,t.isIdentStart=U,t.isIdentContinue=G,t.englishErrorNames=(0,y.partialArray)(((n={})[N.ErrorType.NULL]="#NULL!",n[N.ErrorType.DIV0]="#DIV/0!",n[N.ErrorType.VALUE]="#VALUE!",n[N.ErrorType.REF]="#REF!",n[N.ErrorType.NAME]="#NAME?",n[N.ErrorType.NUM]="#NUM!",n[N.ErrorType.NA]="#N/A",n[N.ErrorType.GETTING_DATA]="#GETTING_DATA",n[N.ErrorType.FIELD]="#FIELD!",n)),t.englishSpecialRefNames=(0,y.partialArray)(((i={})[R.SpecialRefId.All]="#All",i[R.SpecialRefId.Data]="#Data",i[R.SpecialRefId.Headers]="#Headers",i[R.SpecialRefId.Totals]="#Totals",i[R.SpecialRefId.ThisRow]="#This Row",i)),t.englishPictureSpecial=(0,y.partialArray)(((a={})[m.AP1]="AM/PM",a[m.AP2]="A/P",a[m.AP3]="上午/下午",a[m.General]="General",a[m.Currency]="$",a)),t.englishPictureSingle=(0,y.partialArray)(((o={})[h.Sep]=";",o[h.Hash]="#",o[h.Zero]="0",o[h.Decimal]=".",o[h.Percent]="%",o[h.Comma]=",",o[h.Colon]=":",o[h.DateSep]="/",o[h.Slash]="/",o[h.Space]=" ",o[h.Minus]="-",o[h.Plus]="+",o[h.OpenParen]="(",o[h.CloseParen]=")",o[h.Backslash]="\\",o[h.Star]="*",o[h.Year]="y",o[h.Month]="m",o[h.Day]="d",o[h.Hour]="h",o[h.Minute]="m",o[h.Second]="s",o[h.E]="E",o[h.APDelim]="/",o[h.Quote]='"',o[h.ColorStart]="[",o[h.ColorEnd]="]",o[h.Text]="@",o[h.Question]="?",o[h.Underscore]="_",o[h.Reign]="r",o[h.LocDay]="a",o[h.Era]="g",o[h.EraYear]="e",o[h.BidiDate]="B",o[h.BidiNum]="N",o[h.DayTh]="ว",o[h.MonthTh]="ด",o[h.YearTh]="ป",o[h.EngYearTh]="b",o[h.ThYear]="ค",o[h.HourTh]="ช",o[h.MinuteTh]="น",o[h.SecondTh]="ท",o[h.ZeroTh]="๐",o)),t.englishPictureColor=(0,y.partialArray)(((s={})[v.Black]="Black",s[v.White]="White",s[v.Red]="Red",s[v.Green]="Green",s[v.Blue]="Blue",s[v.Yellow]="Yellow",s[v.Magenta]="Magenta",s[v.Cyan]="Cyan",s[v.Color]="Color",s)),t.englishPictureDbnum=(0,y.partialArray)(((u={})[g.DBNUM1]="DBNum1",u[g.DBNUM2]="DBNum2",u[g.DBNUM3]="DBNum3",u[g.DBNUM4]="DBNum4",u)),t.englishSysDateFormat="dddd, mmmm dd, yyyy",t.englishSysTimeFormat="h:mm:ss AM/PM";var K=void 0;t.englishWorksheetFuncIdToName=function(e){var t=W()[e];return void 0===t?"wsf:".concat(e):t},t.englishErrorTypeToName=function(e){var r=t.englishErrorNames[e];return void 0===r?"error.type:".concat(e):r},t.englishOperatorIdToName=function(e){if(e===b.OperatorId.Isect)return" ";if(e===b.OperatorId.Union)return",";var t=b.operatorStrings[e];return void 0===t?"op:".concat(e):t},t.operatorIdToName=function(e,t,r){return t===b.OperatorId.Isect?r:t===b.OperatorId.Union?e.listSeparator:b.operatorStrings[t]};var V=/_/g;function W(){if(null==K){K=[];for(var e=0,t=(0,l.numEnumArray)(b.WorksheetFuncId);e<t.length;e++){var r=t[e],n=(0,b.getWorksheetFuncEnglishName)(r),i=null!=n?n:b.WorksheetFuncId[r].replace(V,".");K[r]=i}}return K}function H(e,t){var r=function(e,t){var r=[];return t.forEach((function(e,t){null!=e&&r.push([e,t])})),P.ArrayMapTree.create(e).setValues(r)}(e,t);return{getWorksheetFuncId:function(e){return r.getValue(e)},getWorksheetFuncName:function(e){var r=t[e];return null==r?(0,d.assertFalse)("calc.config.getWorksheetFuncName: unknown function ID ".concat(e)):r}}}t.getEnglishWorksheetFuncIdToName=W,t.createWorksheetFuncNameCallbacks=H;var q=void 0;t.getEnglishLocaleInfo=function(){return null==q&&(q=function(){var e=W(),r=(0,l.makeStringCompareCI)("en-US"),n=H(r,e),i=n.getWorksheetFuncId,a=n.getWorksheetFuncName;return F(i,a,x(),L(),B(),(function(e){return e>0&&e%3==0}),U,G,r,t.englishErrorNames,t.englishSpecialRefNames,"TRUE","FALSE","R","C","{","}","[","]",".",",",",",";",",",p.USA,f.USA,!1,!1,!1,!1,!1,!1,!1,2,!1," ",!1,k.CurrencyFormat.Paren,!0,!1,"$",2,k.DateOrder.MDY,"/","-",!0,!1,!1,!0,":",void 0,!1,!1,!0,["AM","PM"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"],t.englishPictureSpecial,t.englishPictureSingle,t.englishPictureColor,t.englishPictureDbnum,t.englishSysDateFormat,t.englishSysTimeFormat)}()),q}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.kindAnonymizers=t.anonymizeMagnitude=t.anonymizeFormulaString=t.anonymize=void 0;var n=r(7);t.anonymize=n.anonymizer.anonymize,t.anonymizeFormulaString=n.anonymizer.anonymizeFormulaString,t.anonymizeMagnitude=n.anonymizer.anonymizeMagnitude,t.kindAnonymizers=n.anonymizer.kindAnonymizers},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.xlDatepack=t.TimeGranularity=t.TimeDivision=t.dateTime=t.Rounding=t.tzUTC=t.tzData=void 0;var n=r(222),i=r(109),a=r(58);t.tzData=(0,a.typedInstanceCreator)()((function(e,t,r,n,i){return{bias:e,standardDate:t,standardBias:r,daylightDate:n,daylightBias:i}})),t.tzUTC=(0,t.tzData)(0,void 0,0,void 0,0),t.Rounding=n.dtr.Rounding,t.dateTime=n.dtr.dtr,t.TimeDivision=n.dtr.TimeDivision,function(e){e[e.Year=0]="Year",e[e.Day=1]="Day",e[e.Instant=2]="Instant"}(t.TimeGranularity||(t.TimeGranularity={})),t.xlDatepack={fromNum:function(e,t,r){return n.dtr.fromNum(e.mathpack.toNumber(t),r,e.date1904,e.dateCompatibility)},toNum:function(e,t){var r=n.dtr.toNum(t,e.date1904,e.dateCompatibility);return"number"==typeof r?e.mathpack.fromNumber(r):i.numErrorOper},toNumWithDuration:function(e,t,r,a){var o=n.dtr.toNumWithDuration(t,e.date1904,e.dateCompatibility,r,a);return"number"==typeof o?e.mathpack.fromNumber(o):i.numErrorOper},daysPerMonth:n.dtr.daysPerMonth,toDays:function(e,t){return n.dtr.toDays(t,e.date1904,e.dateCompatibility)},toTime:function(e,t,r,i){return n.dtr.toTime(e.mathpack.toNumber(t),r,i)},utcToLocal:function(e,t,r){return n.dtr.utcToLocal(t,r,e.date1904,e.dateCompatibility)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSupported=t.dtr=t.mathpack=void 0;var n=r(223);t.mathpack=n;var i=r(342);t.dtr=i;var a=r(179);Object.defineProperty(t,"isSupported",{enumerable:!0,get:function(){return a.isSupported}}),(0,r(144)._start)()},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.pack=t.formatScientific=t.formatFixed=t.formatGeneral=t.atan2=t.atan=t.acos=t.asin=t.tan=t.cos=t.sin=t.log=t.ln=t.exp=t.sqrt=t.viewRound=t.cond2=t.cond=t.power=t.add=t.sub=t.mul=t.div=t.compare=t.tenTo=t.roundDown=t.roundUp=t.round=t.sfix=t.lfix=t.fix=t.float=t.neg=t.abs=t.floor=t.ceil=t.trunc=t.equal=t.exp32=t.pi=t.one=t.zero=t.mathError=t.MathErrorNum=void 0;var i,a=r(144),o=r(179);function s(e){return{num:e}}!function(e){e[e.None=0]="None",e[e.Over=1]="Over",e[e.Under=2]="Under",e[e.DivBy0=4]="DivBy0",e[e.Trans=8]="Trans",e[e._NA=16]="_NA",e[e._Val=32]="_Val",e[e._Num=64]="_Num"}(i=t.MathErrorNum||(t.MathErrorNum={}));var u=((n={})[i.Over]=s(i.Over),n[i.Under]=s(i.Under),n[i.DivBy0]=s(i.DivBy0),n[i.Trans]=s(i.Trans),n);function c(e){var t;return null!==(t=u[e])&&void 0!==t?t:s(e)}function l(e){return function(t){var r=e(t),n=(0,a.Mathpack_TakeMathError)();return n===i.None?r:c(n)}}function d(e){return function(t,r){var n=e(t,r),o=(0,a.Mathpack_TakeMathError)();return o===i.None?n:c(o)}}t.mathError=c,t.zero=a.Mathpack_Zero,t.one=a.Mathpack_One,t.pi=a.Mathpack_Pi,t.exp32=a.Mathpack_GetExp32,t.equal=function(e,t){return 0!==(0,a.Mathpack_Equal)(e,t)},t.trunc=a.Mathpack_Trunc,t.ceil=l(a.Mathpack_Ceil),t.floor=l(a.Mathpack_Floor),t.abs=a.Mathpack_Abs,t.neg=a.Mathpack_Neg,t.float=function(e){return e<0?(0,a.Mathpack_SFloat)(e):(0,a.Mathpack_Float)(e)},t.fix=function(e){return(0,a.Mathpack_Fix)(e)>>>0},t.lfix=a.Mathpack_LFix,t.sfix=l(a.Mathpack_SFix),t.round=d(a.Mathpack_Round),t.roundUp=d(a.Mathpack_RoundUp),t.roundDown=d(a.Mathpack_RoundDown),t.tenTo=function(e){if(e<-1e3)return 0;if(e>1e3)return c(i.Over);if(!isFinite(e))return c(i.Over);var t=(0,a.Mathpack_TenTo)(e),r=(0,a.Mathpack_TakeMathError)();return r===i.None?t:c(r)},t.compare=a.Mathpack_Compare,t.div=d(a.Mathpack_Div),t.mul=d(a.Mathpack_Mul),t.sub=d(a.Mathpack_Sub),t.add=d(a.Mathpack_Add),t.power=d(a.Mathpack_Power),t.cond=function(e){var t=(0,a.Mathpack_Cond)(e),r=(0,a.Mathpack_TakeMathError)();return r===i.None?t:c(r)},t.cond2=a.Mathpack_Cond2,t.viewRound=l(a.Mathpack_ViewRound),t.sqrt=l(a.Mathpack_Sqrt),t.exp=l(a.Mathpack_Exp),t.ln=l(a.Mathpack_Ln),t.log=l(a.Mathpack_Log),t.sin=l(a.Mathpack_Sin),t.cos=l(a.Mathpack_Cos),t.tan=l(a.Mathpack_Tan),t.asin=l(a.Mathpack_Asin),t.acos=l(a.Mathpack_Acos),t.atan=l(a.Mathpack_Atan),t.atan2=d(a.Mathpack_Atan2),t.formatGeneral=function(e,t,r){try{(0,o.setLocale)(e);var n=(0,a.Mathpack_FormatGeneral)(t,r);return n<0?c((0,a.Mathpack_TakeMathError)()):(0,o.pxcharToStr)((0,a.Base_StrBuf)(),n)}finally{(0,o.setLocale)(void 0)}},t.formatFixed=function(e,t,r){var n=(0,a.Mathpack_FormatFixed)(e,t,r);if(n<0)return(0,a.Mathpack_TakeMathError)();var i=(0,o.pxcharToStr)((0,a.Base_StrBuf)(),n),s=(0,a.Mathpack_FormatGetExponent)();return{sign:0!==(0,a.Mathpack_FormatGetSign)(),mantissa:i,exponent:s}},t.formatScientific=function(e,t,r){var n=(0,a.Mathpack_FormatScientific)(e,t,r);if(n<0)return(0,a.Mathpack_TakeMathError)();var i=(0,o.pxcharToStr)((0,a.Base_StrBuf)(),n),s=(0,a.Mathpack_FormatGetExponent)();return{sign:0!==(0,a.Mathpack_FormatGetSign)(),mantissa:i,exponent:s}},t.pack=function(e,t,r,n){try{(0,o.setLocale)(e);var s=(0,o.fastMin)(n.length,(0,a.Base_StrBufSize)());(0,o.strToPxchar)((0,a.Base_StrBuf)(),n.substring(0,s));var u=(0,a.Mathpack_Pack)(!!t,r,s),l=(0,a.Mathpack_TakeMathError)();return l!==i.None?c(l):isNaN(u)?c(i.Over):u}finally{(0,o.setLocale)(void 0)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.xlMathpack=void 0;var n=r(222),i=r(109),a=r(70),o=r(96),s=r(58);function u(e){return{kind:o.OperKind.Number,_valueXL:e}}var c=u(n.mathpack.zero()),l=u(n.mathpack.one()),d=u(n.mathpack.pi());function f(e){return 0!=(e.num&n.mathpack.MathErrorNum.DivBy0)?i.div0ErrorOper:i.numErrorOper}function p(e){return function(t){return(0,a.assertFalse)("calc.lang.".concat(e,": error ").concat(JSON.stringify(t)))}}function m(e,t,r){return function(n){var i=e(n._valueXL);return"number"==typeof i?t(i):r(i)}}function h(e,t,r){return function(n,i){var a=e(n._valueXL,i._valueXL);return"number"==typeof a?t(a):r(a)}}var v=h((function(e,t){return n.mathpack.equal(t,2)?n.mathpack.mul(e,e):n.mathpack.power(e,t)}),u,f),g=m((function(e){return n.mathpack.div(e,100)}),u,p("xlPercent"));var b=m(n.mathpack.ceil,u,p("xlCeil")),S=m(n.mathpack.floor,u,p("xlFloor")),y=m(n.mathpack.cond,s.identity,p("xlCond, isSupported = ".concat((0,n.isSupported)()))),O=h(n.mathpack.cond2,s.identity,p("xlCond2"));var C=m(n.mathpack.sfix,s.identity,p("xlSfix")),P=m(n.mathpack.viewRound,u,p("xlViewRound"));t.xlMathpack={zero:c,one:l,pi:d,add:h(n.mathpack.add,u,f),sub:h(n.mathpack.sub,u,f),mul:h(n.mathpack.mul,u,f),div:h(n.mathpack.div,u,f),power:v,percent:g,neg:function(e){return 0!==y(e)?u(n.mathpack.neg(e._valueXL)):e},compare:function(e,t){return n.mathpack.compare(e._valueXL,t._valueXL)},formatGeneral:function(e,t,r){var i=t._valueXL,o=n.mathpack.formatGeneral(e,i,r);return"string"!=typeof o?(0,a.assertFalse)("calc.lang.xlFormatGeneral: error ".concat(JSON.stringify(o))):o},formatFixed:function(e,t,r){var i=e._valueXL,o=n.mathpack.formatFixed(i,t,r);return"object"!=typeof o?(0,a.assertFalse)("calc.lang.xlFormatFixed: error ".concat(JSON.stringify(o))):o},formatScientific:function(e,t,r){var i=e._valueXL,o=n.mathpack.formatScientific(i,t,r);return"object"!=typeof o?(0,a.assertFalse)("calc.lang.xlFormatScientific: error ".concat(JSON.stringify(o))):o},parse:function(e,t,r,i){var o=n.mathpack.pack(e,t,r,i);return"number"!=typeof o?(0,a.assertFalse)("calc.lang.xlParse: error ".concat(JSON.stringify(o))):u(o)},trunc:function(e){return u(n.mathpack.trunc(e._valueXL))},ceil:b,floor:S,abs:function(e){return u(n.mathpack.abs(e._valueXL))},cond:y,cond2:O,fromNumber:function(e){return(0,a.assertTrue)("calc.lang.xlFromNumber",isFinite(e)),u(e)},toNumber:function(e){var t=e._valueXL;return(0,a.assertTrue)("calc.lang.xlToNumber",isFinite(t)),t},sqrt:m(n.mathpack.sqrt,u,f),exp:m(n.mathpack.exp,u,f),ln:m(n.mathpack.ln,u,f),log:m(n.mathpack.log,u,f),sin:m(n.mathpack.sin,u,f),cos:m(n.mathpack.cos,u,f),tan:m(n.mathpack.tan,u,f),asin:m(n.mathpack.asin,u,f),acos:m(n.mathpack.acos,u,f),atan:m(n.mathpack.atan,u,f),atan2:h(n.mathpack.atan2,u,f),round:h(n.mathpack.round,u,f),roundUp:h(n.mathpack.roundUp,u,f),roundDown:h(n.mathpack.roundDown,u,f),tenTo:function(e){(0,a.assertInteger)("calc.lang.xlTenTo",e);var t=n.mathpack.tenTo(e);return"number"==typeof t?u(t):f(t)},checkAlmostCancellation:function(e,t){var r=e._valueXL,i=t._valueXL;return n.mathpack.exp32(r)-n.mathpack.exp32(i)>=52428800?c:t},fix:function(e){return n.mathpack.fix(e._valueXL)},lfix:function(e){return n.mathpack.lfix(e._valueXL)},sfix:C,viewRound:P}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatScientificLeft=t.numberComponents=void 0;var n=r(58);t.numberComponents=(0,n.typedInstanceCreator)()((function(e,t,r){return{sign:e,mantissa:t,exponent:r}})),t.formatScientificLeft=function(e,t){if(t<=1)return t;var r=e%t;return 0===r?t:r<0?r+t:r}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.printLocalsName=t.printLocalsGrid=t.createSimplePrintGlobals=void 0;var n=r(75),i=r(110),a=r(86),o=function(){function e(e){this.config=e}return e.prototype.getDocumentLoc=function(e,t){return(0,i.success)((0,n.documentLoc)(e,t))},e.prototype.getSheetIndex=function(e,t){return(0,i.success)(t)},e.prototype.getSheetName=function(e,t){return(0,i.success)(t)},e.prototype.getNameLoc=function(e,t){return(0,i.success)(t.indexOf(".")>=0?void 0:(0,n.nameLoc)(e,t))},e.prototype.getUserDefinedFuncLoc=function(e,t){return(0,i.success)([(0,n.userDefinedFuncLoc)(e,t)])},e.prototype.getSheetRangeIndexes=function(e){if(void 0===e.index)return(0,i.failure)((0,a.notImplemented)(["simplePrintGlobals.getSheetRangeIndexes"]));var t=[e.index];return e.index2!==e.index&&t.push(e.index2),(0,i.success)((0,n.sheetRangeIndexes)(t,0))},e.prototype.getContainingTable=function(e){return i.successUndefined},e.prototype.getStructRefColumn=function(e,t){return i.successUndefined},e.prototype.getStructRefSpecialRef=function(e,t){return i.successUndefined},e.prototype.getNamedRanges=function(e){return(0,i.success)([])},e}();t.createSimplePrintGlobals=function(e){return new o(e)},t.printLocalsGrid=function(e,t,r){return{config:null!=r?r:void 0,lexicalSource:e,originGridCell:(0,i.success)(t.range),originSheet:(0,i.success)(t.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!1}},t.printLocalsName=function(e,t,r){return{config:null!=r?r:void 0,lexicalSource:e,originGridCell:(0,i.success)(t.range),originSheet:(0,i.success)(t.sheet),allowUnqualifiedCell:!1,wrapCellReferences:!0}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.checkFormula=t.checkFormulaSimple=t.checkFormulaWithDiagnostics=void 0;var n=r(2),i=r(65),a=r(113),o=r(180),s=r(350),u=r(87),c=r(103),l=r(59),d=r(88),f=r(104),p=r(66),m=r(182),h=r(351),v={};function g(e,t){return{context:e,result:t}}function b(e){return function(t){return t.kind===l.NodeKind.Literal&&e(t.oper)}}var S=b(u.isMissingOper),y=b(u.isNumberOper),O=c.OperKind.String|c.OperKind.Boolean|c.OperKind.Error,C=b((function(e){return 0!=(e.kind&O)}));function P(e,t,r,n){void 0===n&&(n=!1),n||(e.errorData=e.reportError(t,r,e.errorData))}function N(e,t){return t!==c.OperKind.Range||0!=(e&c.OperKind.Range)}function R(e,t){if(t.kind===l.NodeKind.Literal)switch(P(e,t,o.baseErrors.Unclosed_literal,t.isClosed),t.oper.kind){case c.OperKind.Number:case c.OperKind.Boolean:case c.OperKind.String:case c.OperKind.Error:return;default:return void P(e,t,o.baseErrors.Illegal_array_literal_element)}P(e,t,o.baseErrors.Illegal_array_literal_element)}function k(e,t,r,n){return h.Pledge.try((function(){if(e.earlyExit&&!e.isOk())throw v;switch(t.kind){case l.NodeKind.Paren:return P(e,t,o.baseErrors.Unclosed_paren,t.isClosed),P(e,t,o.baseErrors.Empty_parenthesis,!S(t.node)),k(e,t.node,r,n);case l.NodeKind.Bad:case l.NodeKind.Array:case l.NodeKind.Name:case l.NodeKind.CellRef:case l.NodeKind.FieldRef:case l.NodeKind.StructRef:case l.NodeKind.App:case l.NodeKind.Let:case l.NodeKind.Lambda:case l.NodeKind.Literal:return I(e,t).bind((function(a){return N(a.result,r)||((0,i.assertTrue)("calc.analyze.checker.check: typeSource passed",void 0!==n),P(e,t,{kind:o.TypeError.Types_not_related,typeGiven:a.result,typeExpected:r,typeSource:n})),a.result=r,a}));default:return(0,i.assertNever)("calc.analyze.checker.check: unhandled formula case",t)}}))}function T(e,t,r){if((0,u.isUnqualifiedNameNode)(r)&&r.parts.kind===l.NamePartKind.IdentNamePart){var n=(0,u.getBoundName)(e.localeInfo,r.whole);return P(e,r,o.baseErrors.Invalid_binder,n.indexOf(".")<0&&!t.contains(n)),t.setValue(n,!0)}return P(e,r,r.kind===l.NodeKind.Bad&&r.type===l.BadType.Missing?o.baseErrors.Missing_binder:o.baseErrors.Invalid_binder),t}var E=function(e){return 0===e.args.length?e:e.args[e.args.length-1]};function _(e,t,r){return h.Pledge.try((function(){var d,p=(0,f.getWorksheetFuncType)(t),v=p.minArgs,b=p.maxArgs,S=p.headTypes,y=p.restTypes,O=p.tailTypes,C=p.flags,N=r.args,R=N.length,_=(0,u.getArguments)(r).length;if(P(e,r.head,o.baseErrors.Invalid_name,0==(C&c.FunctionFlags.OnlyParsedDuringLoad)||e.locals.workbookLoad),_<v)switch(t){case f.WorksheetFuncId.IF:case f.WorksheetFuncId.LET:case f.WorksheetFuncId.LETREC:case f.WorksheetFuncId.LAMBDA:break;default:var F=N[R-1];P(e,void 0===F?r:F,{kind:o.TypeError.Insufficient_function_arguments,funcId:t,numArgsGiven:_,numArgsExpected:v})}if(_>b){var A=N[R-1];P(e,void 0===A?r:A,{kind:o.TypeError.Excess_function_arguments,funcId:t,numArgsGiven:_,numArgsExpected:b})}else if(y.length>1&&_>S.length+y.length){var M=(_-S.length)%y.length;M>O.length&&P(e,E(r),{kind:o.TypeError.Insufficient_function_arguments,funcId:t,numArgsGiven:_,numArgsExpected:_+(y.length-M)})}var w=r.kind===l.NodeKind.App?(0,u.getArguments)(r).map((function(r,n){return k(e,r,(0,u.getArgType)(p,n,_),{kind:o.TypeSourceKind.WSFArgument,head:t,argIndex:n,numArgsGiven:_})})):n.__spreadArray(n.__spreadArray([],r.kind===l.NodeKind.Let?r.vars.map((function(e){return e.binder.arg})):r.params.map((function(e){var t;return null===(t=e.name.arg.def)||void 0===t?void 0:t.rhs})),!0),[null===(d=r.body)||void 0===d?void 0:d.arg],!1).filter(a.isDefined).map((function(t){return I(e,t)}));return h.Pledge.all(w).bind((function(n){return function(e,t,r){var n=(0,u.getArguments)(r).length;switch(t){case f.WorksheetFuncId.IF:var c=e.locals.lexicalKind===m.LexicalKind.NameManager?1:2;return void(n<c&&P(e,E(r),{kind:o.TypeError.Insufficient_function_arguments,funcId:t,numArgsGiven:n,numArgsExpected:c}));case f.WorksheetFuncId._UDF:return P(e,r,o.baseErrors.Unexpected_application_head);case f.WorksheetFuncId.LET:case f.WorksheetFuncId.LETREC:(0,i.assertTrue)("calc.analyze.applySpecificWorksheetFunctionChecks",r.kind===l.NodeKind.Let);for(var d=s.RedBlackMapTree.create(e.localeInfo.stringCompareCI),p=0,h=r.vars;p<h.length;p++){d=T(e,d,h[p].name.arg)}for(var v=0,g=r.badArgs;v<g.length;v++){P(e,g[v].arg,o.baseErrors.Invalid_binder)}P(e,E(r),{kind:o.TypeError.Insufficient_function_arguments,funcId:t,numArgsGiven:n,numArgsExpected:(0,a.fastMax)(3,n+1+n%2)},n>=3&&void 0!==r.body);break;case f.WorksheetFuncId.LAMBDA:(0,i.assertTrue)("calc.analyze.applySpecificWorksheetFunctionChecks",r.kind===l.NodeKind.Lambda);d=s.RedBlackMapTree.create(e.localeInfo.stringCompareCI);for(var b=!1,S=0,y=r.params;S<y.length;S++){var O=y[S].name;P(e,O.arg.name,o.baseErrors.Unclosed_bracket,O.arg.name.isClosed),void 0!==O.arg.def&&(P(e,O.arg.name,o.baseErrors.Binder_requires_brackets,O.arg.name.isBracketed),P(e,O.arg.def.rhs,o.baseErrors.Missing_default_expression,!(0,u.isMissingNode)(O.arg.def.rhs))),O.arg.isOptional?b=!0:P(e,O.arg,o.baseErrors.Mandatory_binder_after_optional,!b),d=T(e,d,O.arg.name.name)}for(var C=0,N=r.badArgs;C<N.length;C++){P(e,N[C].arg,o.baseErrors.Invalid_binder)}P(e,E(r),{kind:o.TypeError.Insufficient_function_arguments,funcId:t,numArgsGiven:n,numArgsExpected:n+1},n>=1&&void 0!==r.body),void 0!==r.body&&P(e,r.body.arg,o.baseErrors.Invalid_body,0===n||!(0,u.isMissingNode)(r.body.arg))}}(e,t,r),g(e,p.returnType)}))}))}function F(e,t){return h.Pledge.try((function(){if(P(e,t,o.baseErrors.Unclosed_application,t.isClosed),(0,u.isWSFNode)(t.head))return _(e,t.head.id,t);var r=t,n=r.args,i=n.length,a=(0,u.getArguments)(r).length;if((0,u.isOperatorNode)(t.head))return function(e,t,r){return h.Pledge.try((function(){var n=(0,f.getOperatorType)(t.id),i=r.length,a=i===n.minArgs;return P(e,t,{kind:o.TypeError.Incorrect_number_of_operator_arguments,opId:t.id},a),h.Pledge.all(r.map((function(r,s){return h.Pledge.try((function(){return S(r)&&(a=!1,P(e,r,{kind:o.SyntaxError.Missing_operation_argument,opId:t.id})),k(e,r,(0,u.getArgType)(n,s,i),{kind:o.TypeSourceKind.OperatorArgument,head:t.id,argIndex:s,numArgsGiven:i})}))}))).bind((function(t){return g(e,a?n.returnType:c.SignatureType.All)}))}))}(e,t.head,n);var s=t.head,d=n[i-1],p=(0,f.higherOrderFunctionType)().maxArgs-1;return a>p&&P(e,void 0===d?t:d,{kind:o.SyntaxError.Excess_higher_order_function_arguments,numArgsGiven:a,numArgsExpected:p}),h.Pledge.all(n.map((function(t){return k(e,t,c.SignatureType.All,void 0)}))).bind((function(t){return I(e,s).bind((function(t){return N(t.result,c.OperKind.Range)||0!=(t.result&(c.OperKind.Array|c.OperKind.Rich))||P(e,s,C(s)||s.kind===l.NodeKind.Array?o.baseErrors.Unexpected_application_head:o.baseErrors.Unexpected_application_head_with_fix),g(e,c.SignatureType.All)}))}))}))}function I(e,t){return h.Pledge.try((function(){var r,n,a,s,f,p,m,b,O,C;if(e.earlyExit&&!e.isOk())throw v;switch(t.kind){case l.NodeKind.App:case l.NodeKind.Let:case l.NodeKind.Lambda:return F(e,t);case l.NodeKind.Array:return function(e,t){return h.Pledge.try((function(){P(e,t,o.baseErrors.Unclosed_array,t.isClosed);var r=t.nodes.length>0&&!(1===t.nodes.length&&1===t.nodes[0].length&&(0,u.isMissingNode)(t.nodes[0][0]));if(P(e,t,o.baseErrors.Empty_array_literal,r),!r)return g(e,c.OperKind.Array);for(var n=t.nodes[0].length,i=0;i<t.nodes.length;i+=1){var a=t.nodes[i],s=a.length;P(e,t,o.baseErrors.Irregular_array_shape,s===n);for(var l=0;l<s;l+=1)R(e,a[l])}return g(e,c.OperKind.Array)}))}(e,t);case l.NodeKind.Bad:return function e(t,r){return h.Pledge.try((function(){switch(r.type){case l.BadType.Sequence:return P(t,r,o.baseErrors.Bad_node,r.contents.some((function(e){return e.kind===l.NodeKind.Bad}))),h.Pledge.all(r.contents.map((function(r){return r.kind===l.NodeKind.Bad?e(t,r):I(t,r)})));case l.BadType.StructRef:return P(t,r,o.baseErrors.Invalid_struct_ref_table_name);case l.BadType.FieldRef:return P(t,r,o.baseErrors.Unexpected_field_ref);case l.BadType.Unexpected:switch(r.contents){case")":return P(t,r,o.baseErrors.Unexpected_closing_paren);case t.localeInfo.rightBrace:return P(t,r,o.baseErrors.Unexpected_closing_brace);case t.localeInfo.rightBracket:return P(t,r,o.baseErrors.Unexpected_closing_bracket);case".":return P(t,r,o.baseErrors.Unexpected_dot);default:return P(t,r,{kind:o.SyntaxError.Unexpected_character,text:r.contents})}case l.BadType.NumberLiteral:return P(t,r,o.baseErrors.Invalid_number_literal);case l.BadType.StringLiteral:return P(t,r,o.baseErrors.Invalid_string_literal);case l.BadType.ErrorLiteral:return P(t,r,o.baseErrors.Invalid_error_literal);case l.BadType.FieldName:case l.BadType.ParamName:case l.BadType.Missing:return P(t,r,o.baseErrors.Bad_node);case l.BadType.Qualifier:return P(t,r,o.baseErrors.Invalid_qualifier);default:(0,i.assertNever)("calc.analyze.diagnoseBadNode",r)}}))}(e,t).bind((function(){return g(e,c.SignatureType.All)}));case l.NodeKind.CellRef:return e.locals.allowRelativeQualifier||(null===(r=t.qualifier)||void 0===r?void 0:r.kind)!==l.QualifierKind.Relative?e.locals.allowUnqualifiedCell||void 0!==t.qualifier?(null===(n=t.qualifier)||void 0===n?void 0:n.kind)===l.QualifierKind.Document||(null===(a=t.qualifier)||void 0===a?void 0:a.kind)===l.QualifierKind.Bad?(P(e,t,o.baseErrors.Invalid_qualifier),g(e,c.SignatureType.All)):t.ref.kind===l.CellRefKind.Bad?(P(e,t,o.baseErrors.Invalid_cell_ref),g(e,c.SignatureType.All)):g(e,c.OperKind.Range):(P(e,t,o.baseErrors.Invalid_unqualified_cell),g(e,c.SignatureType.All)):(P(e,t,o.baseErrors.Invalid_rel_sheet_qualifier_in_cell),g(e,c.SignatureType.All));case l.NodeKind.Literal:return P(e,t,o.baseErrors.Unclosed_literal,t.isClosed),g(e,t.oper.kind|((0,u.isErrorOper)(t.oper)&&t.oper.type===d.ErrorType.REF?c.OperKind.Range:0));case l.NodeKind.Name:if(!e.locals.allowRelativeQualifier&&(null===(s=t.qualifier)||void 0===s?void 0:s.kind)===l.QualifierKind.Relative)return P(e,t,o.baseErrors.Invalid_rel_sheet_qualifier_in_name),g(e,c.SignatureType.All);if(!e.locals.workbookLoad&&(null===(f=t.qualifier)||void 0===f?void 0:f.kind)===l.QualifierKind.Document&&!t.qualifier.isQuoted)return P(e,t,o.baseErrors.Invalid_qualifier),g(e,c.SignatureType.All);if((null===(p=t.qualifier)||void 0===p?void 0:p.kind)===l.QualifierKind.SheetRange||(null===(m=t.qualifier)||void 0===m?void 0:m.kind)===l.QualifierKind.Bad)return P(e,t,o.baseErrors.Invalid_qualifier),g(e,c.SignatureType.All);var N=(0,l.flattenNameParts)(t.parts).parts;return(null===(b=e.annotations[N[0].label])||void 0===b?void 0:b.kind)===l.AnnotationKind.LocalNameUse?P(e,t,o.baseErrors.Invalid_name,N.every((function(e){var t;return e.kind!==l.NamePartKind.FieldRefNamePart||(null===(t=e.rhs)||void 0===t?void 0:t.field.kind)===l.NodeKind.Name}))):(null===(O=e.annotations[t.label])||void 0===O?void 0:O.kind)===l.AnnotationKind.LocalNameDecl||P(e,t,o.baseErrors.Invalid_name,N.reduceRight((function(e,t){var r,n=e.anyCanDenoteNamedObject,i=e.rhsValid;return{anyCanDenoteNamedObject:n||t.canDenoteNamedObject&&i,rhsValid:i&&(t.kind!==l.NamePartKind.FieldRefNamePart||(null===(r=t.rhs)||void 0===r?void 0:r.field.kind)===l.NodeKind.Name)}}),{anyCanDenoteNamedObject:!1,rhsValid:!0}).anyCanDenoteNamedObject),g(e,c.SignatureType.All);case l.NodeKind.Paren:return P(e,t,o.baseErrors.Unclosed_paren,t.isClosed),P(e,t,o.baseErrors.Empty_parenthesis,!S(t.node)),I(e,t.node);case l.NodeKind.FieldRef:return P(e,t,o.baseErrors.Unclosed_bracket,t.rhs.isClosed),P(e,t,o.baseErrors.Unexpected_field_ref,!S(t.lhs)&&!y(t.lhs)),(0,u.isUnqualifiedNameNode)(t.rhs.field)||P(e,t.rhs.field,t.rhs.field.kind===l.NodeKind.Bad&&t.rhs.field.type===l.BadType.Missing?o.baseErrors.Missing_field_name:o.baseErrors.Invalid_field_name),I(e,t.lhs).bind((function(t){return g(e,c.SignatureType.All)}));case l.NodeKind.StructRef:if(P(e,t,o.baseErrors.Invalid_struct_ref_table_name,void 0===t.lhs&&e.locals.allowImplicitTable||(null===(C=t.lhs)||void 0===C?void 0:C.kind)===l.NodeKind.Name&&t.lhs.parts.kind===l.NamePartKind.IdentNamePart&&t.lhs.parts.canDenoteNamedObject),void 0===t.rhs.innerRef);else{P(e,t.rhs.innerRef,o.baseErrors.Invalid_struct_ref_comma_parts,t.rhs.innerRef.kind!==l.StructRefKind.CommaOpRef||(0,u.isCommaOpRefWellFormed)(t.rhs.innerRef));var k=function(t){switch(null==t?void 0:t.kind){case void 0:break;case l.StructRefKind.RangeOpRef:k(t.lhs),k(t.rhs);break;case l.StructRefKind.CommaOpRef:t.refs.forEach(k);break;case l.StructRefKind.SpecialRef:case l.StructRefKind.ColumnRef:P(e,t,o.baseErrors.Unclosed_bracket,t.isClosed);break;case l.StructRefKind.ThisRowOpRef:k(t.ref);break;case l.StructRefKind.MissingRef:P(e,t,o.baseErrors.Invalid_struct_ref_missing_part);break;case l.StructRefKind.BadRef:P(e,t,o.baseErrors.Unclosed_bracket,t.isClosed),P(e,t,o.baseErrors.Invalid_struct_ref_bad_part)}};k(t.rhs.innerRef)}return P(e,t,o.baseErrors.Unclosed_bracket,t.rhs.isClosed),(void 0===t.lhs?h.Pledge.resolve(void 0):I(e,t.lhs)).bind((function(t){return g(e,c.SignatureType.All)}));default:return(0,i.assertNever)("calc.analyze.checker.infer: unhandled formula case",t)}}))}var A={ok:!0,isOk:a.identity,collect:function(e,t,r){return!1}};function M(e,t,r,n,i){var a,o,s=r.annotations;void 0===i&&(i=!0);var u={globals:e,locals:t,localeInfo:null!==(o=null===(a=t.config)||void 0===a?void 0:a.localeInfo)&&void 0!==o?o:e.config.localeInfo,annotations:s,reportError:n.collect,isOk:function(){return n.isOk(u.errorData)},earlyExit:i,errorData:n.ok};return u}function w(e,t){try{return P(e,t.node,o.baseErrors.Empty_formula,!S(t.node)),h.Pledge.settleOrThrow(k(e,t.node,c.SignatureType.All,void 0))}catch(t){if(t===v)return g(e,c.SignatureType.All);throw t}}function D(e,t,r){var i=w(M(e,t,r,A),r).context.errorData;return n.__assign(n.__assign({},r),{isWellFormed:i})}t.checkFormulaWithDiagnostics=function(e,t,r){try{var i=w(M(e,t,r,{ok:void 0,isOk:function(e){return void 0===e},collect:function(e,t,r){var n,i=null!=r?r:[];return(null!==(n=i[e.label])&&void 0!==n?n:i[e.label]=[]).push(t),i}},!1),r).context.errorData;return(0,p.success)([n.__assign(n.__assign({},r),{isWellFormed:void 0===i}),i])}catch(e){return(0,p.failure)((0,p.javaScriptError)(e))}},t.checkFormulaSimple=D,t.checkFormula=function(e,t,r){try{return(0,p.success)(D(e,t,r))}catch(e){return(0,p.failure)((0,p.javaScriptError)(e))}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.autocorrectFormula=void 0;var n=r(2),i=r(59),a=r(87),o=r(65),s=r(66),u=r(183),c=r(229),l=r(230),d={getDocumentLoc:function(){return(0,o.assertFalse)("calc.analyze.autocorrectFormula: default getDocumentLoc")},getSheetIndex:function(){return(0,o.assertFalse)("calc.analyze.autocorrectFormula: default getSheetIndex")},getSheetName:function(){return(0,o.assertFalse)("calc.analyze.autocorrectFormula: default getSheetName")},getNameLoc:function(){return(0,o.assertFalse)("calc.analyze.autocorrectFormula: default getNameLoc")},getUserDefinedFuncLoc:function(){return(0,o.assertFalse)("calc.analyze.autocorrectFormula: default getUserDefinedFuncLoc")},getSheetRangeIndexes:function(){return(0,o.assertFalse)("calc.analyze.autocorrectFormula: default getSheetRangeIndexes")},getContainingTable:function(){return(0,o.assertFalse)("calc.analyze.autocorrectFormula: default getContainingTable")},getStructRefColumn:function(){return(0,o.assertFalse)("calc.analyze.autocorrectFormula: default getStructRefColumn")},getStructRefSpecialRef:function(){return(0,o.assertFalse)("calc.analyze.autocorrectFormula: default getStructRefSpecialRef")}};var f=(0,a.createFailureErrorClass)("AutocorrectError"),p=n.__assign(n.__assign({},(0,u.binaryVisitor)((0,u.constVisitor)(!1),(function(e,t){return e||t}))),{badSequenceNode:function(e,t,r){return!0},badStringNode:function(e,t,r){return!0}}),m=function(e){function t(t,r,n){var i=e.call(this)||this;return i.f=n,i.seenUnclosed=!1,i.seenParen=!1,i.seenMissingOperand=!1,i.globals=function(e){var t,r,n,i,a,o,s,u,c,l,f,p,m,h,v,g,b,S;return{config:e.config,getDocumentLoc:null!==(r=null===(t=e.getDocumentLoc)||void 0===t?void 0:t.bind(e))&&void 0!==r?r:d.getDocumentLoc,getSheetIndex:null!==(i=null===(n=e.getSheetIndex)||void 0===n?void 0:n.bind(e))&&void 0!==i?i:d.getSheetIndex,getSheetName:null!==(o=null===(a=e.getSheetName)||void 0===a?void 0:a.bind(e))&&void 0!==o?o:d.getSheetName,getNameLoc:null!==(u=null===(s=e.getNameLoc)||void 0===s?void 0:s.bind(e))&&void 0!==u?u:d.getNameLoc,getUserDefinedFuncLoc:null!==(l=null===(c=e.getUserDefinedFuncLoc)||void 0===c?void 0:c.bind(e))&&void 0!==l?l:d.getUserDefinedFuncLoc,getSheetRangeIndexes:null!==(p=null===(f=e.getSheetRangeIndexes)||void 0===f?void 0:f.bind(e))&&void 0!==p?p:d.getSheetRangeIndexes,getContainingTable:null!==(h=null===(m=e.getContainingTable)||void 0===m?void 0:m.bind(e))&&void 0!==h?h:d.getContainingTable,getStructRefColumn:null!==(g=null===(v=e.getStructRefColumn)||void 0===v?void 0:v.bind(e))&&void 0!==g?g:d.getStructRefColumn,getStructRefSpecialRef:null!==(S=null===(b=e.getStructRefSpecialRef)||void 0===b?void 0:b.bind(e))&&void 0!==S?S:d.getStructRefSpecialRef}}(t),i.locals=r,i.resolver=(0,l.createResolver)(i.globals),i}return n.__extends(t,e),t.prototype.autocorrect=function(){return(0,u.reduceBottomUp)(p,this.f)?this.f.node:(0,u.reduceBottomUp)(this,this.f)},t.prototype.literalNode=function(e,t,r){return t||(this.seenUnclosed=!0),(0,i.literalNode)(e,t,r)},t.prototype.nameNode=function(e,t,r){var n=(0,i.nameNode)(e,t,r),a=(0,i.flattenNameParts)(e);if(a.kind===i.NamePartKind.CellRefNamePart){var u=this.resolver.resolveDottedName(this.locals,n,this.f.annotations).resolved;if(u.kind===c.ResolvedKind.ResolvedCellRef){var l=u.node,d=l.ref,p=l.qualifier,m=l.label,h=this.cellRefNode(d,p,m).ref;(0,o.assertTrue)("calc.analyze.autocorrectFormula",a.kind===i.NamePartKind.CellRefNamePart);var v=a.parts,g=v[0],b=v[1],S=v.slice(2),y=function(e,t){var r=t.rhs,n=t.canDenoteNamedObject,a=t.label,o=t.qualifiedLabel;return(0,i.fieldRefNamePart)(e,r,n,a,o)};return(0,i.nameNode)(S.reduce(y,y((0,i.cellRefNamePart)(h,g.asWhole,g.label,g.qualifiedLabel),b)),t,m)}if(u.resolution.kind!==s.ResultKind.Success&&u.resolution.reason.kind!==c.ResolveReasonKind.NoOriginSheet&&u.resolution.reason.kind!==c.ResolveReasonKind.InvalidQualifier)throw new f(u.resolution.reason)}return n},t.prototype.arrayNode=function(e,t,r){return t||(this.seenUnclosed=!0),(0,i.arrayNode)(e,t,r)},t.prototype.appNode=function(e,t,r,n){var o=this.appNodeBase(e,r,n);return r||(this.seenUnclosed=!0),(0,a.isOperatorNode)(e)||(this.seenParen=!0),(0,a.isOperatorNode)(e)&&t.some(a.isMissingNode)&&(this.seenMissingOperand=!0),(0,i.appNode)(e,t,o,n)},t.prototype.letNode=function(e,t,r,n,a,o){var s=this.appNodeBase(e,a,o);return a||(this.seenUnclosed=!0),this.seenParen=!0,(0,i.letNode)(e,t,r,n,s,o)},t.prototype.lambdaNode=function(e,t,r,n,a,o){var s=this.appNodeBase(e,a,o);return a||(this.seenUnclosed=!0),this.seenParen=!0,(0,i.lambdaNode)(e,t,r,n,s,o)},t.prototype.parenNode=function(e,t,r){return t||(this.seenUnclosed=!0),this.seenParen=!0,(0,i.parenNode)(e,t,r)},t.prototype.cellRefNode=function(e,t,r){var n=this.globals.config.localeInfo;return e.isBracketed&&"("===n.leftBracket&&(this.seenParen=!0),this.locals.allowUnqualifiedCell||void 0!==t?(0,i.cellRefNode)(e,t,r):(0,i.cellRefNode)(e,this.qualifyCellRef(),r)},t.prototype.fieldRefNode=function(e,t,r,n){return t.isClosed||(this.seenUnclosed=!0),(0,i.fieldRefNode)(e,t,r,n)},t.prototype.structRefNode=function(e,t,r){return t.isClosed||(this.seenUnclosed=!0),(0,i.structRefNode)(e,t,r)},t.prototype.qualifyCellRef=function(){var e=this.locals.originSheet;if(!(0,s.isSuccess)(e))throw new f(e.reason);if(void 0!==e.value.index){var t=this.globals.getSheetName(e.value.document,e.value.index);if(!(0,s.isSuccess)(t))throw new f(t.reason);return(0,i.sheetQualifier)(t.value,void 0)}},t.prototype.appNodeBase=function(e,t,r){return t||!(0,a.isOperatorNode)(e)&&this.isFormulaRoot(r)&&!this.seenParen&&!this.seenUnclosed&&!this.seenMissingOperand},t.prototype.isFormulaRoot=function(e){var t;return(null===(t=this.f.annotations[e])||void 0===t?void 0:t.kind)===i.AnnotationKind.FormulaRoot},t}(u.IdentityVisitor);t.autocorrectFormula=function(e,t,r){try{var n=r.spans,a=r.annotations,o=r.depthUpperBound,u=new m(e,t,r).autocorrect();return(0,s.success)((0,i.formula)(u,n,a,o))}catch(e){return e instanceof f?(0,s.failure)(e.reason):(0,s.failure)((0,s.javaScriptError)(e))}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolvedUserDefinedFunc=t.resolvedStructRef=t.resolvedNever=t.resolvedName=t.resolvedLocalName=t.resolvedDottedName=t.resolvedCellRef=t.resolveLocalsGrid=t.noOriginSheet=t.invalidStructRef=t.invalidQualifier=t.invalidCellRef=t.emptyIntersection=t.ResolvedKind=t.ResolveReasonKind=t.InvalidStructRefReason=t.InvalidQualifierReason=t.InvalidCellRefReason=void 0;var n=r(3);t.InvalidCellRefReason=n.resolveServiceTypes.InvalidCellRefReason,t.InvalidQualifierReason=n.resolveServiceTypes.InvalidQualifierReason,t.InvalidStructRefReason=n.resolveServiceTypes.InvalidStructRefReason,t.ResolveReasonKind=n.resolveServiceTypes.ResolveReasonKind,t.ResolvedKind=n.resolveServiceTypes.ResolvedKind,t.emptyIntersection=n.resolveServiceTypes.emptyIntersection,t.invalidCellRef=n.resolveServiceTypes.invalidCellRef,t.invalidQualifier=n.resolveServiceTypes.invalidQualifier,t.invalidStructRef=n.resolveServiceTypes.invalidStructRef,t.noOriginSheet=n.resolveServiceTypes.noOriginSheet,t.resolveLocalsGrid=n.resolveServiceTypes.resolveLocalsGrid,t.resolvedCellRef=n.resolveServiceTypes.resolvedCellRef,t.resolvedDottedName=n.resolveServiceTypes.resolvedDottedName,t.resolvedLocalName=n.resolveServiceTypes.resolvedLocalName,t.resolvedName=n.resolveServiceTypes.resolvedName,t.resolvedNever=n.resolveServiceTypes.resolvedNever,t.resolvedStructRef=n.resolveServiceTypes.resolvedStructRef,t.resolvedUserDefinedFunc=n.resolveServiceTypes.resolvedUserDefinedFunc},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolveGridRef=t.createResolver=void 0;var n=r(3);t.createResolver=n.resolveService.createResolver,t.resolveGridRef=n.resolveService.resolveGridRef},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.analyzeLocalsName=t.analyzeLocalsGrid=t.createAnalyzeGlobals=t.staticPrecedents=t.summarizeFormulaDiagnostics=t.diagnostics=void 0;var n=r(182),i=r(180);t.diagnostics=i;var a=r(66);t.summarizeFormulaDiagnostics=function(e){if(void 0!==e){var t={};return Object.keys(e).forEach((function(r){e[Number(r)].forEach((function(e){var r,n=i.formatDiagnostic(e);t[n]=(null!==(r=t[n])&&void 0!==r?r:0)+1}))})),t}},t.staticPrecedents=function(e,t,r,n,i,a,o){return{cells:e,names:t,udfs:r,special:n,ownSpecial:i,bound:a,resolutions:o}},t.createAnalyzeGlobals=function(e,t){return{config:e,getSheetName:t}},t.analyzeLocalsGrid=function(e,t,r,n){return void 0===n&&(n=!1),{config:null!=r?r:void 0,lexicalKind:e,originGridCell:(0,a.success)(t.range),originSheet:(0,a.success)(t.sheet),allowRelativeQualifier:!1,allowUnqualifiedCell:!0,allowImplicitTable:!0,wrapCellReferences:!1,workbookLoad:n}},t.analyzeLocalsName=function(e,t,r){return void 0===r&&(r=!1),{config:null!=t?t:void 0,lexicalKind:n.LexicalKind.NameManager,originGridCell:(0,a.success)(e.range),originSheet:(0,a.success)(e.sheet),allowRelativeQualifier:!0,allowUnqualifiedCell:!1,allowImplicitTable:!1,wrapCellReferences:!0,workbookLoad:r}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.notFormulaString=t.ReasonKind=t.parseLocals=t.createParseGlobals=void 0;var n,i=r(2),a=r(87),o=r(66);t.createParseGlobals=function(e){return{config:e}},t.parseLocals=function(e,t,r){return{config:null!=r?r:void 0,lexicalKind:e,originGridCell:(0,o.success)(t)}},function(e){e.NotFormulaString="NotFormulaString"}(n||(n={})),t.ReasonKind=i.__assign(i.__assign({},a.ReasonKind),n),t.notFormulaString=function(e){return{kind:t.ReasonKind.NotFormulaString,message:e}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseSpParam=t.runFormulaParser=t.parseFormula=void 0;var n=r(18),i=r(102),a=r(65),o=r(59),s=r(88),u=r(104),c=r(79),l=r(89),d=r(115),f=r(98),p=r(97),m=r(234),h=r(236),v=r(184),g=r(237),b=r(66),S=r(354),y=r(114),O=r(7),C=r(146),P=r(116),N=r(87),R=(0,l.apply)((0,l.tuple)(p.parseSpaces,(0,l.lazy)((function(){return t.parseFormula})),p.parseSpaces),(function(e,t){var r=t[0],n=t[1],i=t[2],a=(0,f.getNodeSpan)(e,n);return a.pre=r,a.post=i,n})),k=(0,l.apply)((0,l.tuple)(p.parseLeftParen,(0,f.withDelim)({delimId:c.DelimId.Paren,listSep:f.ListSep.Union},R),(0,l.opt)(p.parseRightParen,void 0),p.parseCharIndex),(function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3];return(0,o.parenNode)(n,void 0!==i,(0,f.addSpan)(e,r.start,a,"",""))})),T=(0,l.many1)(R,(0,l.right)(p.parseColSep,R)),E=(0,l.many1)(T,(0,l.right)(p.parseRowSep,T)),_=(0,l.apply)((0,l.tuple)(p.parseLeftBrace,(0,f.withDelim)({delimId:c.DelimId.Brace,listSep:f.ListSep.Union},E),(0,l.opt)(p.parseRightBrace,void 0),p.parseCharIndex),(function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3];return(0,o.arrayNode)(n,void 0!==i,(0,f.addSpan)(e,r.start,a,"",""))}));function F(e){return(0,l.takePeek)((function(t,r,n){return e(r)?(0,o.badNode)(o.BadType.Unexpected,r.chars,(0,f.addSpan)(t,r.start,n.start,"","")):void 0}))}var I=(0,l.apply)((0,l.tuple)(p.parseCharIndex,F(p.isLeftBracketToken),(0,f.withDelim)({delimId:c.DelimId.Bracket,listSep:f.ListSep.Union},R),(0,l.opt)(F(p.isRightBracketToken),void 0),p.parseCharIndex),(function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],s=t[4],u=[n,i];return null!=a&&u.push(a),(0,o.badNode)(o.BadType.Sequence,u,(0,f.addSpan)(e,r,s,"",""))})),A=(0,l.takePeek)((function(e,t,r){switch(t.kind){case c.TokenKind.End:case c.TokenKind.Operator:case c.TokenKind.Spaces:return;case c.TokenKind.Sep:if(t.value===c.SepId.Dot)return;if(t.value===c.SepId.Qual||t.value===c.SepId.Assign)break;if(e.delim.delimId===c.DelimId.Brace||t.value!==c.SepId.Col&&t.value!==c.SepId.Row)return;break;case c.TokenKind.Right:if(t.value===e.delim.delimId)return}return(0,o.badNode)(o.BadType.Unexpected,t.chars,(0,f.addSpan)(e,t.start,r.start,"",""))})),M=(0,l.any)(m.parseRef,h.parseLiteral,k,_,v.parseFieldRef,g.parseStructRef,I,m.parseUnqualBadRef,A);function w(e){return(0,l.tuple)(p.parseLeftParen,(0,f.withDelim)({delimId:c.DelimId.Paren,listSep:f.ListSep.Arg},(0,l.many1)(e,(0,l.right)(p.parseListSep,e))),(0,l.opt)(p.parseRightParen,void 0),p.parseCharIndex)}var D=(0,l.apply)(w(R),(function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3];return(0,d.argsTerm)(n,void 0!==i,r.start,a)})),j=(0,l.apply)(w((0,l.any)((0,l.lazy)((function(){return t.parseSpParam})),R)),(function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3];return(0,d.lambdaArgsTerm)(n,void 0!==i,r.start,a)})),x=(0,l.take)((function(e,t){return t.kind!==c.TokenKind.Operator||t.value!==u.OperatorId.Percent&&t.value!==u.OperatorId.Pound?void 0:t}));var L=(0,l.take)((function(e,t){return t.kind===c.TokenKind.Operator||(0,p.isDotSepToken)(t)?t:function(e,t){return t.kind===c.TokenKind.Sep&&t.value===c.SepId.List&&e.delim.listSep===f.ListSep.Union?(0,c.operatorToken)(t.start,e.localeInfo.listSeparator,u.OperatorId.Union):void 0}(e,t)})),B=(0,l.take)((function(e,t){return t.kind===c.TokenKind.Spaces?t:void 0})),U=(0,l.any)((0,l.concat)((0,l.bind)((0,l.any)(M,x),(function(e,t){var r=(0,d.isWSFNode)(e.localeInfo,t);return(null==r?void 0:r.id)===u.WorksheetFuncId.LAMBDA?(0,l.concat)((0,l.parseSucceed)([t]),(0,l.opt)((0,l.tuple)(j),[])):(0,l.parseSucceed)([t])})),(0,l.many)((0,l.any)(D,v.parseFieldRef,g.parseStructRef))),(0,l.tuple)(L)),G=(0,l.flatten)((0,l.many1)(U,(0,l.concat)((0,l.opt)((0,l.tuple)(B),[]),U)));t.parseFormula=(0,l.apply)((0,l.tuple)((0,l.opt)(G,void 0),p.parseCharIndex),(function(e,t){var r=t[0],n=t[1];if(null==r){var i=(0,f.addSpan)(e,n,n,"","");return(0,o.literalNode)(s.missingOper,!0,i)}var a=r;return a.push((0,c.endToken)(n)),(0,d.runOperatorPrecedenceParser)(e,a)})),t.runFormulaParser=function(e,t,r,s,u,d){var p=d.length-1;if(p<0){var m="calc.parse.runTokenParser: internal error: expected at least 1 token";return a.ulsLogger.ULS.assertTag(589825167,n.LogCategory.msoulscat_ES_EWAJS,!1,m)}if(d[p].kind!==c.TokenKind.End){m="calc.parse.runTokenParser: internal error: array[n] !== End in ".concat((0,i.anonymize)(d));return a.ulsLogger.ULS.assertTag(589825168,n.LogCategory.msoulscat_ES_EWAJS,!1,m)}var h=(0,f.makeState)(e,t,r,s,u),v=(0,l.runParser)(R,d,0,h);if(!(0,b.isSuccess)(v)||v.value.index<p){var g=(0,b.isSuccess)(v)?v.value.index:0;m="calc.parse.runTokenParser: internal error: consumed ".concat(g," out of ").concat(p," in ").concat((0,i.anonymize)(d));return a.ulsLogger.ULS.assertTag(589825169,n.LogCategory.msoulscat_ES_EWAJS,!1,m)}var y=v.value.output,O=h.spans,C=(0,S.buildAnnotations)(e,y);return(0,o.formula)(y,O,C)};var K=O.codePoint.codePointFullStop;var V=(0,l.apply)((0,l.many1)((0,l.take)((function(e,t){return t.isIdentContinue||(0,p.isDotSepToken)(t)?t:void 0}))),(function(e,t){var r=t[0].start,n=t.map((function(e){return e.chars})).join(""),i=(0,f.addSpan)(e,r,r+n.length,"","");if(!function(e,t){if(!e.localeInfo.isIdentStart((0,y.stringCodePointAt)(t,0)))return!1;if(!(0,y.codePointIterator)(t).every((function(t){return t===K||e.localeInfo.isIdentContinue(t)})))return!1;var r=(0,C.parseCellRef)(e.localeInfo,e.refStyle,e.origin,t,0);if(void 0!==r&&r.i===t.length){var n=r.refStyle===o.RefStyle.A1?(0,c.cellRefA1Token)(0,t,r.row,r.col):(0,c.cellRefR1C1Token)(0,t,r.row,r.col,r.enLocale);if((0,m.isCompleteCellRefToken)(e,n))return!1}return!0}(e,n))return(0,o.badNode)(o.BadType.ParamName,n,i);var a=(0,f.addSpan)(e,r,r+n.length,"","");return(0,o.nameNode)((0,o.identNamePart)(n,void 0,a,a),void 0,i)})),W=(0,l.applyTake)((0,l.tuple)(p.parseCharIndex,p.parseLeftBracket,p.parseCharIndex,p.parseSpaces,(0,l.opt)(V,void 0),p.parseSpaces,p.parseCharIndex,(0,l.opt)(p.parseRightBracket,void 0),p.parseCharIndex),(function(e,t){var r=t[0],n=(t[1],t[2]),i=t[3],a=t[4],s=t[5],u=t[6],c=t[7],l=t[8];if(void 0!==a){var d=(0,f.getNodeSpan)(e,a);d.pre=i,d.post=s}var p=null!=a?a:(0,o.badNode)(o.BadType.Missing,i+s,(0,f.addSpan)(e,n,u,"",""));return(0,o.paramName)(p,!0,void 0!==c,(0,f.addSpan)(e,r,l,"",""))})),H=(0,l.lazy)((function(){return(0,P.isFeatureEnabled)(P.FeatureName.CalcLambdaOptionalParameters)?W:(0,l.parseFail)()})),q=(0,l.applyTake)((0,l.tuple)(p.parseCharIndex,m.parseRef,p.parseCharIndex),(function(e,t){var r=t[0],n=t[1],i=t[2],a=n.kind===d.TermKind.MaybeWSFTerm?n.node:n;if((0,N.isUnqualifiedNameNode)(a))return(0,o.paramName)(a,!1,!0,(0,f.addSpan)(e,r,i,"",""))})),z=(0,l.apply)((0,l.tuple)(p.parseSpaces,p.parseCharIndex,p.parseAssignToken,p.parseSpaces,(0,l.lazy)((function(){return t.parseFormula})),p.parseCharIndex),(function(e,t){var r=t[0],n=t[1],i=(t[2],t[3]),a=t[4],s=t[5];return(0,f.getNodeSpan)(e,a).pre=i,(0,o.paramDefault)(a,(0,f.addSpan)(e,n,s,r,""))})),Q=(0,l.lazy)((function(){return(0,P.isFeatureEnabled)(P.FeatureName.CalcLambdaDefaultParameters)?z:(0,l.parseFail)()}));t.parseSpParam=(0,l.applyTake)((0,l.tuple)(p.parseSpaces,p.parseCharIndex,(0,l.bind)((0,l.any)(q,H),(function(e,t){return t.isClosed?(0,l.apply)((0,l.opt)(Q,void 0),(function(e,r){return[t,r]})):(0,l.parseSucceed)([t,void 0])})),p.parseCharIndex,p.parseSpaces,(0,l.peek)((function(e,t){return t}))),(function(e,t){var r=t[0],n=t[1],i=t[2],a=i[0],s=i[1],u=t[3],l=t[4],d=t[5];if(void 0!==s||d.kind===c.TokenKind.End&&a.isBracketed||(0,p.isListSepToken)(d)&&a.isClosed)return(0,o.paramNode)(a,s,(0,f.addSpan)(e,n,u,r,l))}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseRef=t.parseUnqualBadRef=t.isCompleteCellRefToken=void 0;var n=r(2),i=r(18),a=r(102),o=r(65),s=r(59),u=r(88),c=r(146),l=r(79),d=r(89),f=r(115),p=r(98),m=r(87),h=r(97),v=r(235),g=r(103),b=r(114),S=r(184),y=r(116);function O(e,t){return e.refStyle===t.refStyle&&!t.isBadLocale&&t.row!==c.SpecialPos.A1BadDollar&&t.col!==c.SpecialPos.A1BadDollar}function C(e){return e.refStyle===s.RefStyle.R1C1||"object"==typeof e.row&&"object"==typeof e.col}function P(e,t){return t.kind===l.TokenKind.CellRef&&O(e,t)&&C(t)}t.isCompleteCellRefToken=P;var N=(0,s.pos)(s.PosKind.Rel,0);function R(e){return e===c.SpecialPos.RCNoNum?N:e}function k(e,t){if(e.row!==c.SpecialPos.A1BadDollar&&e.col!==c.SpecialPos.A1BadDollar){var r=e.refStyle===s.RefStyle.R1C1&&!e.isIdentContinue;if(null!=e.row&&null!=e.col)return(0,s.cellRefSingle)(R(e.row),R(e.col),r,t);if(null!=e.row){var n=R(e.row);return(0,s.cellRefRow)(n,n,r,t)}if(null!=e.col){var u=R(e.col);return(0,s.cellRefCol)(u,u,r,t)}}var l="calc.parse.cellRefToken2cellRef: bad token ".concat((0,a.anonymize)(e));return o.ulsLogger.ULS.assertTag(589825159,i.LogCategory.msoulscat_ES_EWAJS,!1,l)}function T(e,t){return t.isIdentContinue&&e.localeInfo.isIdentStart((0,b.stringCodePointAt)(t.chars,0))}var E=(0,d.take)((function(e,t){return P(e,t)&&!T(e,t)||(0,h.isRefErrorToken)(t)?t:void 0})),_=(0,d.take)((function(e,t){return P(e,t)&&T(e,t)?t:void 0})),F=(0,d.apply)((0,d.tuple)((0,d.any)(E,(0,d.withState)((function(e){return e.cellRefMustBeCellRefNode?_:(0,d.left)(_,(0,d.fails)((0,d.any)(h.parseIdentContinue,h.parseDotSepTokenNotFollowedByLeftBracket)))}))),h.parseCharIndex),(function(e,t){var r=t[0],n=t[1],i=r.kind===l.TokenKind.CellRef?k(r,(0,p.addSpan)(e,r.start,n,"","")):(0,s.cellRefError)((0,p.addSpan)(e,r.start,n,"","")),a=r.kind===l.TokenKind.CellRef?r.chars:void 0;return(0,f.maybeWSFTerm)((0,s.cellRefNode)(i,void 0,(0,p.addSpan)(e,r.start,n,"","")),a)}));var I=(0,d.takePeek)((function(e,t,r){return t.kind!==l.TokenKind.CellRef||!O(e,t)||function(e,t,r){return r.kind===l.TokenKind.Left&&r.value===l.DelimId.Paren&&t.isIdentContinue&&null!=(0,m.getWorksheetFuncId)(e.localeInfo,t.chars)}(e,t,r)||r.isIdentContinue?void 0:[t,r.start]})),A=(0,d.bind)((0,d.tuple)(I,h.parseSpaces,h.parseRangeOp,h.parseSpaces,I),(function(e,t){var r=t[0],n=r[0],i=r[1],a=t[1],o=(t[2],t[3]),u=t[4],c=u[0],m=u[1],h=(0,p.addSpan)(e,n.start,i,"",a),v=(0,p.addSpan)(e,c.start,m,o,""),g=k(n,h),b=k(c,v),S=void 0;if(g.kind===s.CellRefKind.Single&&b.kind===s.CellRefKind.Single){var y=(0,p.addSpan)(e,n.start,m,"","");S=(0,s.cellRefRange)(g,b,y)}else if(0===a.length&&0===o.length)if(g.kind===s.CellRefKind.Row&&b.kind===s.CellRefKind.Row){var O=g.isBracketed||b.isBracketed;y=(0,p.addSpan)(e,n.start,m,"","");S=(0,s.cellRefRow)(g.row1,b.row1,O,y)}else if(g.kind===s.CellRefKind.Col&&b.kind===s.CellRefKind.Col){O=g.isBracketed||b.isBracketed,y=(0,p.addSpan)(e,n.start,m,"","");S=(0,s.cellRefCol)(g.col1,b.col1,O,y)}if(null==S)return(0,d.parseFail)();var C=(0,f.maybeWSFTerm)((0,s.cellRefNode)(S,void 0,(0,p.addSpan)(e,n.start,m,"","")),void 0);return n.isIdentContinue&&c.isIdentContinue?(0,d.peek)((function(e,t){return t.kind===l.TokenKind.Sep&&t.value===l.SepId.Qual?void 0:C})):(0,d.parseSucceed)(C)})),M=(0,d.any)(A,F);t.parseUnqualBadRef=(0,d.apply)((0,d.take)((function(e,t){return t.kind===l.TokenKind.CellRef?t:void 0})),(function(e,t){var r=t.start+t.chars.length,n=t.refStyle===s.RefStyle.R1C1&&!t.isIdentContinue;return(0,f.maybeWSFTerm)((0,s.cellRefNode)((0,s.cellRefBad)(t.chars,n,(0,p.addSpan)(e,t.start,r,"","")),void 0,(0,p.addSpan)(e,t.start,r,"","")),t.chars)}));var w=(0,d.take)((function(e,t){return t.kind===l.TokenKind.Ident&&e.localeInfo.isIdentStart((0,b.stringCodePointAt)(t.chars,0))||t.kind===l.TokenKind.CellRef&&T(e,t)?t:void 0})),D=(0,d.take)((function(e,t){return t.kind===l.TokenKind.Literal&&t.oper.kind===g.OperKind.Boolean?t:void 0})),j=(0,d.any)(w,(0,d.left)(D,(0,d.succeeds)(h.parseDotSepTokenNotFollowedByLeftBracket))),x=(0,d.peek)((function(e,t){return(0,h.isLeftBracketToken)(t)})),L=(0,d.tuple)((0,d.many1)(j,h.parseIdentContinue),(0,d.many)((0,d.any)(h.parseIdentContinue,h.parseDotSepTokenNotFollowedByLeftBracket)),x,h.parseCharIndex),B=(0,d.apply)(L,(function(e,t){var r,i,a,u,d,m,h=t[0],v=t[1],g=t[2],b=t[3],P=h[0],N=1===h.length&&(null===(r=v[0])||void 0===r?void 0:r.kind)===l.TokenKind.Sep,R=P.kind!==l.TokenKind.CellRef||(m=P).refStyle===s.RefStyle.A1&&null==m.row&&"object"==typeof m.col&&m.col.kind===s.PosKind.Rel||function(e,t){return t.refStyle===s.RefStyle.A1&&e.refStyle===s.RefStyle.A1&&t.isIdentContinue||t.refStyle===s.RefStyle.R1C1&&(0,c.isR1C1IdentStart)(t.row,t.col)}(e,P)&&N;if(g||function(e,t,r){return 0===r.length||1===t.length&&t[0].kind===l.TokenKind.Literal||r.length%2!=0&&!(0,y.isTypedChangeGateEnabled)("Microsoft.Office.Excel.ChangeGate.ParseTrailingNameDot")||r.some((function(t,r){return r%2==0?t.kind!==l.TokenKind.Sep:t.kind===l.TokenKind.Sep||!(0,S.isUnbracketedField)(e.localeInfo,t.chars)}))}(e,h,v)){var T=n.__spreadArray(n.__spreadArray([],h,!0),v,!0).map((function(e){return e.chars})).join(""),E=(0,p.addSpan)(e,P.start,b,"",""),_=(0,p.addSpan)(e,P.start,b,"",""),F=(0,s.identNamePart)(T,R,E,_),I=(0,s.nameNode)(F,void 0,(0,p.addSpan)(e,P.start,b,"",""));return(0,f.maybeWSFTerm)(I,I.whole)}var A,M=R,w=0,D=null!==(a=null===(i=v[w])||void 0===i?void 0:i.start)&&void 0!==a?a:b,j=(0,p.addSpan)(e,P.start,D,"",""),x=(0,p.addSpan)(e,P.start,D,"","");if(1===h.length&&P.kind===l.TokenKind.CellRef)if(O(e,P))if(C(P)){var L=k(P,(0,p.addSpan)(e,P.start,D,"",""));A=(0,s.cellRefNamePart)(L,P.chars,j,x)}else A=(0,s.identNamePart)(P.chars,M,j,x);else M=!1,A=(0,s.identNamePart)(P.chars,M,j,x);else{var B=h.map((function(e){return e.chars})).join("");0===e.localeInfo.stringCompareCI(B,"_xlpm")&&w+1<v.length&&(B+="."+v[w+1].chars,w+=2),A=(0,s.identNamePart)(B,M,j,x)}for(var U=A;w+1<v.length;w+=2){var G=v[w+1],K=null!==(d=null===(u=v[w+2])||void 0===u?void 0:u.start)&&void 0!==d?d:b,V=(0,p.addSpan)(e,G.start,K,"","");U=(0,s.fieldRefNamePart)(U,(0,s.fieldRef)((0,s.nameNode)((0,s.identNamePart)(G.chars,void 0,V,V),void 0,(0,p.addSpan)(e,G.start,K,"","")),!1,!0,(0,p.addSpan)(e,G.start,K,"","")),w+2>=v.length?R:M,(0,p.addSpan)(e,P.start,K,"",""),(0,p.addSpan)(e,P.start,K,"",""))}w<v.length&&(U=(0,s.fieldRefNamePart)(U,void 0,R,(0,p.addSpan)(e,P.start,b,"",""),(0,p.addSpan)(e,P.start,b,"","")),w+=1),(0,o.assertTrue)("calc.parse.pUnqualName: i == tailTokens",w===v.length),U.kind===s.NamePartKind.CellRefNamePart&&(0,o.assertFalse)("calc.parse.pUnqualName: expected lhs.kind !== NamePartKind.CellRefNamePart");var W=(0,s.nameNode)(U,void 0,(0,p.addSpan)(e,P.start,b,"",""));return(0,f.maybeWSFTerm)(W,W.whole)})),U=(0,d.opt)((0,d.any)(M,B,t.parseUnqualBadRef),{node:void 0}),G=(0,d.any)(M,(0,d.right)((0,d.fails)(B),t.parseUnqualBadRef));var K=(0,d.bind)(v.parseQualifier,(function(e,t){var r=t[0],n=t[1];return(0,d.apply)(r.kind===s.QualifierKind.SheetRange?(0,p.cellRefMustBeCellRefNode)(r.isQuoted?U:G):r.kind===s.QualifierKind.Error?(0,p.cellRefMustBeCellRefNode)(U):U,(function(e,t){var i=t.node;if(null==i)return r.kind===s.QualifierKind.Error?(0,s.literalNode)(u.refErrorOper,!0,r.label):(0,s.badNode)(s.BadType.Qualifier,n,r.label);var a=(0,p.getNodeSpan)(e,r).start,c=(0,p.getNodeSpan)(e,i).end;if(i.kind===s.NodeKind.Name){var l=(0,p.addSpan)(e,a,c,"","");if((r.kind===s.QualifierKind.Bad||r.kind===s.QualifierKind.Error||r.kind===s.QualifierKind.SheetRange)&&!(0,y.isFeatureEnabled)(y.FeatureName["OfficeVSO:3594447_NameCell_BadQual"])){var d=(0,s.badNode)(s.BadType.Qualifier,n,r.label);return(0,s.badNode)(s.BadType.Sequence,[d,i],l)}if(r.kind===s.QualifierKind.Error){var f=(0,s.literalNode)(u.refErrorOper,!0,r.label);return(0,s.badNode)(s.BadType.Sequence,[f,i],l)}return(0,o.assertTrue)("calc.parse.pQualRef: sheet-range-name quoted",r.kind!==s.QualifierKind.SheetRange||r.isQuoted),(0,s.nameNode)(function(e,t,r){for(var n=t;;){if((0,p.getSpan)(e,n.qualifiedLabel).start=r,n.kind!==s.NamePartKind.FieldRefNamePart)break;n=n.lhs}return t}(e,i.parts,a),r,l)}var m=(0,p.addSpan)(e,a,c,"","");if((r.kind===s.QualifierKind.Bad||r.kind===s.QualifierKind.Document)&&!(0,y.isFeatureEnabled)(y.FeatureName["OfficeVSO:3594447_NameCell_BadQual"])){d=(0,s.badNode)(s.BadType.Qualifier,n,r.label);return(0,s.badNode)(s.BadType.Sequence,[d,i],m)}return r.kind===s.QualifierKind.Ident&&(r=(0,s.sheetQualifier)(r.name,void 0,r.isQuoted,r.label)),(0,s.cellRefNode)(i.ref,r,m)}))})),V=(0,d.apply)((0,d.any)(M,B),(function(e,t){return t.node.kind===s.NodeKind.CellRef&&t.node.ref.kind===s.CellRefKind.Error?(0,s.literalNode)(u.refErrorOper,!0,t.node.label):t}));t.parseRef=(0,d.any)(K,V)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseQualifier=void 0;var n=r(59),i=r(89),a=r(98),o=r(97),s=r(79),u=r(145),c=r(103),l=r(353),d=r(116);function f(e){return e.kind===s.TokenKind.Literal&&e.oper.kind===c.OperKind.Boolean}var p=u.codePointFullStop,m=(0,i.take)((function(e,t){return t.isIdentContinue&&!f(t)&&t.chars.length>0&&t.chars.charCodeAt(0)!==p?t.chars:void 0})),h=(0,i.take)((function(e,t){return t.isIdentContinue||(0,o.isDotSepToken)(t)?t.chars:void 0})),v=(0,i.apply)((0,i.many1)(m,h),(function(e,t){return t.join("")})),g=(0,i.take)((function(e,t){return t.kind===s.TokenKind.Ident?t.chars:void 0})),b=function(e,t){var r;return(null!==(r=t.path)&&void 0!==r?r:"")+e.leftBracket+t.document+e.rightBracket};function S(e,t,r,i,a,o){var s,u;if(null==t)null==i?(s=(0,n.identQualifier)(r,a,o),u=r):(s=(0,n.sheetRangeQualifier)(r,i,void 0,a,o),u="".concat(r,":").concat(i));else{var c=b(e.localeInfo,t);null==i?(s=(0,n.sheetQualifier)(r,t,a,o),u="".concat(c).concat(r)):(s=(0,n.sheetRangeQualifier)(r,i,t,a,o),u="".concat(c).concat(r,":").concat(i))}return[s,a?(0,l.quoteQualifier)(u):u]}var y=(0,i.take)((function(e,t){return t.kind===s.TokenKind.Ident||(0,o.isRangeOpToken)(t)?t.chars:void 0})),O=(0,i.apply)((0,i.tuple)(o.parseCharIndex,(0,i.many)(y),o.parseLeftBracket,(0,i.many1)(y),o.parseRightBracket,o.parseCharIndex),(function(e,t){var r=t[0],i=t[1],o=(t[2],t[3]),s=(t[4],t[5]),u=i.join(""),c=o.join("");return(0,n.documentQualifier)(c,""!==u?u:void 0,!0,(0,a.addSpan)(e,r,s,"",""))})),C=(0,i.apply)((0,i.tuple)(o.parseCharIndex,o.parseLeftBracket,(0,i.many1)(h),o.parseRightBracket,o.parseCharIndex),(function(e,t){var r=t[0],i=(t[1],t[2]),o=(t[3],t[4]),s=i.join("");return(0,n.documentQualifier)(s,void 0,!1,(0,a.addSpan)(e,r,o,"",""))})),P=(0,i.apply)((0,i.tuple)(o.parseCharIndex,(0,i.opt)(C,void 0),v,(0,i.opt)((0,i.right)(o.parseRangeOp,v),void 0),o.parseCharIndex),(function(e,t){var r=t[0],n=t[1],i=t[2],o=t[3],s=t[4];return S(e,n,i,o,!1,(0,a.addSpan)(e,r,s,"",""))})),N=(0,i.apply)((0,i.tuple)(o.parseLeftSQuote,(0,i.opt)(O,void 0),g,(0,i.opt)((0,i.right)(o.parseRangeOp,g),void 0),o.parseRightSQuote,o.parseCharIndex),(function(e,t){var r=t[0],n=t[1],i=t[2],o=t[3],s=(t[4],t[5]);return S(e,n,i,o,!0,(0,a.addSpan)(e,r.start,s,"",""))})),R=(0,i.apply)(C,(function(e,t){return[t,b(e.localeInfo,t)]})),k=(0,i.apply)((0,i.tuple)(o.parseLeftSQuote,O,o.parseRightSQuote),(function(e,t){t[0];var r=t[1];t[2];return[r,(0,l.quoteQualifier)(b(e.localeInfo,r))]})),T=(0,i.take)((function(e,t){return t.kind===s.TokenKind.End||t.kind===s.TokenKind.Right&&t.value===s.DelimId.SQuote?void 0:t.chars})),E=(0,i.apply)((0,i.tuple)(o.parseLeftSQuote,(0,i.many)(T),(0,i.opt)((0,i.tuple)(o.parseRightSQuote,(0,i.opt)((0,i.tuple)(o.parseQualSep,o.parseSpaces),[void 0,""])),[void 0,[void 0,""]]),o.parseCharIndex),(function(e,t){var r=t[0],i=t[1],o=t[2],s=o[0],u=o[1],c=u[0],l=u[1],d=t[3],f="'".concat(i.join("")).concat(void 0!==s?"'":"").concat(void 0!==c?"!":""),p=(0,a.addSpan)(e,r.start,d-l.length,"",l);return[(0,n.badQualifier)(f,!0,p),f]})),_=(0,i.takePeek)((function(e,t,r){if((0,o.isRefErrorToken)(t)){var i=(0,a.addSpan)(e,t.start,r.start,"","");return[(0,n.errorQualifier)(i),t.chars]}})),F=(0,i.peek)((function(e,t){var r=(0,a.addSpan)(e,t.start,t.start,"","");return[(0,n.relativeQualifier)(r),""]})),I=(0,i.apply)((0,i.tuple)((0,i.any)(P,N,R,k,F),o.parseQualSep,o.parseSpaces),(function(e,t){var r=t[0],n=r[0],i=r[1],o=(t[1],t[2]),s=(0,a.getNodeSpan)(e,n);return s.end+=1,s.post=o,[n,"".concat(i,"!")]})),A=(0,i.take)((function(e,t){return t.isIdentContinue||(0,o.isDotSepToken)(t)||f(t)||function(e){return e.kind===s.TokenKind.Literal&&(0,s.isNumberLikeOper)(e.oper)}(t)?t.chars:void 0})),M=(0,i.apply)((0,i.tuple)(o.parseCharIndex,(0,i.many)(A),o.parseQualSep,o.parseCharIndex,o.parseSpaces),(function(e,t){var r=t[0],i=t[1],o=(t[2],t[3]),s=t[4],u="".concat(i.join(""),"!"),c=(0,a.addSpan)(e,r,o,"",s);return[(0,n.badQualifier)(u,!1,c),u]}));t.parseQualifier=(0,i.any)(_,I,(0,i.lazy)((function(){return(0,d.isFeatureEnabled)(d.FeatureName["OfficeVSO:3594447_InvalidQualifier2"])?M:(0,i.parseFail)()})),E)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseLiteral=void 0;var n=r(59),i=r(79),a=r(89),o=r(115),s=r(98),u=r(97),c=r(88),l=r(87),d=r(103);var f=(0,a.take)((function(e,t){return t.kind===i.TokenKind.Literal&&t.oper.kind!==d.OperKind.Boolean?t:t.kind===i.TokenKind.CellRef&&function(e){return e.refStyle===n.RefStyle.A1&&null==e.col&&"object"==typeof e.row&&e.row.kind===n.PosKind.Rel}(t)?(0,i.literalToken)(t.start,t.chars,e.mathpack.fromNumber(t.row.index+e.origin.row+1)):void 0})),p=(0,a.take)((function(e,t){return t.kind===i.TokenKind.Literal&&t.oper.kind===d.OperKind.Boolean?t:void 0}));t.parseLiteral=(0,a.apply)((0,a.tuple)((0,a.any)(f,(0,a.left)(p,(0,a.fails)(u.parseDotSepTokenNotFollowedByLeftBracket))),u.parseCharIndex),(function(e,t){var r=t[0],a=t[1],u=(0,s.addSpan)(e,r.start,a,"","");if((0,i.isBadNumberOper)(r.oper))return(0,n.badNode)(n.BadType.NumberLiteral,r.chars,u);if((0,i.isBadErrorOper)(r.oper))return(0,n.badNode)(n.BadType.ErrorLiteral,r.chars,u);if((0,l.isStringOper)(r.oper)&&r.oper.value.length>c.cellStringLimit)return(0,n.badNode)(n.BadType.StringLiteral,r.chars,u);var d=(0,n.literalNode)(r.oper,r.hasRight,u);return(0,l.isBooleanOper)(r.oper)?(0,o.maybeWSFTerm)(d,r.chars):d}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseStructRef=void 0;var n=r(2),i=r(89),a=r(115),o=r(97),s=r(59),u=r(98),c=r(79),l=r(66),d=(0,i.take)((function(e,t){return t.isIdentContinue||t.kind===c.TokenKind.Spaces?t:void 0})),f=(0,i.apply)((0,i.many1)(d),(function(e,t){var r=t[0];return 1===t.length?r:(0,c.identToken)(r.start,t.map((function(e){return e.kind===c.TokenKind.Escape?"":e.chars})).join(""))})),p=(0,i.take)((function(e,t){return t.isIdentContinue||t.kind===c.TokenKind.Spaces||t.kind===c.TokenKind.Escape||(0,o.isListSepToken)(t)||(0,o.isRangeOpToken)(t)?t:void 0})),m=(0,i.apply)((0,i.many1)(p),(function(e,t){var r=t[0];return 1===t.length?r:(0,c.identToken)(r.start,t.map((function(e){return e.kind===c.TokenKind.Escape?"":e.chars})).join(""))})),h=(0,i.take)((function(e,t){return t.kind===c.TokenKind.SpecialRef?t:void 0})),v=(0,i.apply)((0,i.tuple)(o.parseCharIndex,h,o.parseCharIndex),(function(e,t){var r=t[0],n=t[1],i=t[2];return(0,s.specialRef)(n.value,!1,!0,(0,u.addSpan)(e,r,i,"",""))})),g=(0,i.apply)((0,i.tuple)(o.parseCharIndex,o.parseLeftBracket,h,(0,i.opt)(o.parseRightBracket,void 0),o.parseCharIndex),(function(e,t){var r=t[0],n=(t[1],t[2]),i=t[3],a=t[4];return(0,s.specialRef)(n.value,!0,void 0!==i,(0,u.addSpan)(e,r,a,"",""))})),b=(0,i.any)(v,g),S=(0,i.apply)((0,i.tuple)(o.parseCharIndex,f,o.parseCharIndex),(function(e,t){var r=t[0],n=t[1],i=t[2];return(0,s.columnRef)(n.chars,!1,!0,(0,u.addSpan)(e,r,i,"",""))})),y=(0,i.apply)((0,i.tuple)(o.parseCharIndex,o.parseLeftBracket,(0,i.opt)(m,void 0),(0,i.opt)(o.parseRightBracket,void 0),o.parseCharIndex),(function(e,t){var r,n=t[0],i=(t[1],t[2]),a=t[3],o=t[4];return(0,s.columnRef)(null!==(r=null==i?void 0:i.chars)&&void 0!==r?r:"",!0,void 0!==a,(0,u.addSpan)(e,n,o,"",""))})),O=(0,i.apply)((0,i.tuple)(o.parseCharIndex,m,o.parseCharIndex),(function(e,t){var r=t[0],n=t[1],i=t[2];return(0,s.columnRef)(n.chars,!1,!0,(0,u.addSpan)(e,r,i,"",""))})),C=(0,i.any)(S,y),P=(0,i.apply)(o.parseCharIndex,(function(e,t){return(0,s.missingRef)((0,u.addSpan)(e,t,t,"",""))})),N=(0,i.any)(C,P),R=(0,i.take)((function(e,t){return"#"===t.chars?t:void 0})),k=(0,i.apply)((0,i.many1)(R,d),(function(e,t){return(0,c.unexpectedToken)(t[0].start,t.map((function(e){return e.chars})).join(""))})),T=(0,i.apply)((0,i.many1)(R,p),(function(e,t){return(0,c.unexpectedToken)(t[0].start,t.map((function(e){return e.chars})).join(""))})),E=(0,i.apply)((0,i.tuple)(o.parseCharIndex,k,o.parseCharIndex),(function(e,t){var r=t[0],n=t[1],i=t[2];return(0,s.badRef)(n.chars,!1,!0,(0,u.addSpan)(e,r,i,"",""))})),_=(0,i.apply)((0,i.tuple)(o.parseCharIndex,o.parseLeftBracket,T,(0,i.opt)(o.parseRightBracket,void 0),o.parseCharIndex),(function(e,t){var r=t[0],n=(t[1],t[2]),i=t[3],a=t[4];return(0,s.badRef)(n.chars,!0,void 0!==i,(0,u.addSpan)(e,r,a,"",""))})),F=(0,i.any)(E,_),I=(0,i.apply)((0,i.tuple)(o.parseCharIndex,N,o.parseRangeOp,N,o.parseCharIndex),(function(e,t){var r=t[0],n=t[1],i=(t[2],t[3]),a=t[4];return(0,s.rangeOpRef)(n,i,(0,u.addSpan)(e,r,a,"",""))})),A=(0,i.any)(I,C),M=(0,i.any)(b,F,I,C,P),w=(0,i.apply)((0,i.tuple)(o.parseCharIndex,M,(0,i.many1)((0,i.tuple)(o.parseListSep,M)),o.parseCharIndex),(function(e,t){var r=t[0],i=t[1],a=t[2],o=t[3];return(0,s.commaOpRef)(n.__spreadArray([i],a.map((function(e){e[0];return e[1]})),!0),(0,u.addSpan)(e,r,o,"",""))})),D=(0,i.apply)((0,i.tuple)(o.parseCharIndex,o.parseAtOp,(0,i.opt)(A,void 0),o.parseCharIndex),(function(e,t){var r=t[0],n=(t[1],t[2]),i=t[3];return(0,s.thisRowOpRef)(n,(0,u.addSpan)(e,r,i,"",""))})),j=(0,i.apply)(o.parseSpaces,(function(){})),x=(0,i.any)((0,i.left)(j,o.parseEnd),(0,i.left)(O,o.parseEnd),(0,i.left)(w,o.parseEnd),(0,i.left)(D,o.parseEnd),(0,i.left)(I,o.parseEnd),(0,i.left)(b,o.parseEnd),(0,i.left)(F,o.parseEnd),(0,i.left)(y,o.parseEnd));t.parseStructRef=(0,i.applyTake)((0,i.tuple)(o.parseCharIndex,o.parseBracketedTokens,o.parseCharIndex),(function(e,t){var r=t[0],n=t[1],o=n[0],c=n[1],d=t[2],f=(0,i.runParser)(x,o,0,e);return(0,l.isSuccess)(f)?(0,a.structRefTerm)((0,s.structRef)(f.value.output,c,(0,u.addSpan)(e,r,d,"","")),r,d):void 0}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.traverse_old=t.extractReferences_old=void 0;var n=r(65),i=r(59),a=r(181),o=r(66),s=r(113);function u(e,t){var r=e[t];return null==r?(0,n.assertFalse)("ParseResultHelper.getFormulaSpan: expected span for label ".concat(t," to be defined")):r}function c(e,t,r,c,l,d,f){return void 0===l&&(l=!1),!!(0,o.isSuccess)(e)&&(function(e,t,r,a,c,l,d){if(null==e||null==a)return;var f={};null!=r?r.forEach((function(e){f[e]=!0})):f["*"]=!0;var p={},m=0,h=[];h.push(e.node);for(;h.length>0;){var v=h.pop();if(null!=v)switch(v.kind){case i.NodeKind.Literal:F("literal")&&a("literal",{label:v.label,value:v});break;case i.NodeKind.Array:v.nodes.forEach((function(e){return(0,s.safePush)(h,e)}));break;case i.NodeKind.Let:case i.NodeKind.Lambda:case i.NodeKind.App:var g=v.head;switch(g.kind){case i.NodeKind.Operator:F("operator")&&a("operator",{label:v.label,value:g.id});break;case i.NodeKind.WSF:case i.NodeKind.Name:F("function")&&a("function",{label:v.label,name:g.whole,isClosed:v.isClosed,args:v.args});break;default:h.push(g)}if(v.kind===i.NodeKind.Let){for(var b=0,S=v.vars;b<S.length;b++){var y=S[b].name;p[y.arg.label]=m}m+=1}else if(v.kind===i.NodeKind.Lambda){for(var O=0,C=v.params;O<C.length;O++){var P=C[O].name;p[P.arg.label]=m}m+=1}(0,s.safePush)(h,v.args);break;case i.NodeKind.Paren:h.push(v.node);break;case i.NodeKind.Name:var N=e.annotations[v.parts.label],R=e.annotations[v.label];if((null==N?void 0:N.kind)===i.AnnotationKind.LocalNameUse)F("letName")&&a("letName",{label:v.label,name:N.name,number:p[N.label],qualifier:void 0});else if((null==R?void 0:R.kind)===i.AnnotationKind.LocalNameDecl)F("letName")&&a("letName",{label:v.label,name:v.whole,number:p[v.label],qualifier:void 0});else if(F("namedRange")){var k=v.whole.split(".");a("namedRange",{label:v.label,name:k[0],names:k.slice(1),qualifier:I(v)})}break;case i.NodeKind.Param:var T=e.annotations[v.label];(null==T?void 0:T.kind)===i.AnnotationKind.LocalNameDecl&&F("letName")&&a("letName",{label:v.name.label,name:v.whole,number:p[v.label],qualifier:void 0}),void 0!==v.def&&h.push(v.def.rhs);break;case i.NodeKind.CellRef:F("range")&&A(v);break;case i.NodeKind.FieldRef:h.push(v.lhs);break;case i.NodeKind.StructRef:if(F("structRefRange")){if(null==d||null==l)break;var E=d.resolveStructRef(l,v).resolution;if(!(0,o.isSuccess)(E)||void 0===E.value)break;var _=E.value;a("structRefRange",{label:v.label,type:"range",top:(0,i.pos)(i.PosKind.Rel,_.range.row),left:(0,i.pos)(i.PosKind.Rel,_.range.col),bottom:(0,i.pos)(i.PosKind.Rel,_.range.row+_.range.rows-1),right:(0,i.pos)(i.PosKind.Rel,_.range.col+_.range.cols-1),span:u(e.spans,v.label),qualifier:void 0!==v.lhs?I(v.lhs):void 0,name:void 0!==v.lhs?v.lhs.whole:void 0})}break;case i.NodeKind.Bad:switch(v.type){case i.BadType.Sequence:case i.BadType.StructRef:case i.BadType.FieldRef:(0,s.safePush)(h,v.contents);break;default:(0,s.staticAssertSame)()}break;default:return(0,n.assertNever)("calc.parse.traverseFormula",v)}}function F(e){return f[e]||f["*"]}function I(e){if(null!=e.qualifier){var t={};switch(e.qualifier.kind){case i.QualifierKind.Sheet:var r=e.qualifier;t.type=i.QualifierKind.Sheet,t.sheet=r.sheet,null!=r.document&&(t.document=r.document.document,null!=r.document.path&&(t.documentPath=r.document.path));break;case i.QualifierKind.SheetRange:var n=e.qualifier;t.type=i.QualifierKind.SheetRange,t.sheet1=n.sheet1,t.sheet2=n.sheet2;break;case i.QualifierKind.Ident:var a=e.qualifier;t.type=i.QualifierKind.Ident,t.name=a.name;break;case i.QualifierKind.Document:var o=e.qualifier;t.document=o.document,null!=o.path&&(t.documentPath=o.path)}return t}}function A(t){if(null!=e&&null!=a)switch(t.ref.kind){case i.CellRefKind.Error:break;case i.CellRefKind.Col:var r=t.ref;a("range",{label:t.label,type:"col",startIndex:r.col1,endIndex:r.col2,span:u(e.spans,r.label),qualifier:I(t)});break;case i.CellRefKind.Row:var n=t.ref;a("range",{label:t.label,type:"row",startIndex:n.row1,endIndex:n.row2,span:u(e.spans,n.label),qualifier:I(t)});break;case i.CellRefKind.Single:var o=t.ref;a("range",{label:t.label,type:"cell",row:o.row,col:o.col,span:u(e.spans,o.label),qualifier:I(t)});break;case i.CellRefKind.Range:var s=t.ref;a("range",{label:t.label,type:"range",top:s.ref1.row,left:s.ref1.col,bottom:s.ref2.row,right:s.ref2.col,topLeftSpan:u(e.spans,s.ref1.label),bottomRightSpan:u(e.spans,s.ref2.label),qualifier:I(t)})}}}(e.value,null!=c||(0,a.getEnglishLocaleInfo)(),t,r,0,d,f),!0)}t.extractReferences_old=function(e,t,r,n,i){if(void 0===r&&(r=!1),(0,o.isSuccess)(e)){var a=[];return c(e,["range","namedRange","letName","literal","function","structRefRange"],(function(t,r){var n={kind:t,ref:r,span:u(e.value.spans,r.label)};a.push(n)}),t,r,n,i),a.sort((function(e,t){return e.span.start-t.span.start})),a}},t.traverse_old=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tokenizeFormula=void 0;var n,i=r(18),a=r(65),o=r(79),s=r(88),u=r(146),c=r(357),l=r(113),d=r(59),f=r(240),p=r(114),m=r(145),h=r(185),v=r(116),g=m.codePointAsterisk,b=m.codePointAtSign,S=m.codePointColon,y=m.codePointDoubleQuote,O=m.codePointExclamationMark,C=m.codePointHash,P=m.codePointLeftParen,N=m.codePointQuestionMark,R=m.codePointRightParen,k=m.codePointSingleQuote,T=m.codePointFullStop,E=m.codePointDigitZero,_=m.codePointSlash,F=m.codePointInvertedExclamationMark,I=m.codePointInvertedQuestionMark;function A(e){if(!n){n=(0,l.makeStringMap)();for(var t=0,r=Object.getOwnPropertyNames(M);t<r.length;t++){var i=r[t];n[i.charCodeAt(0)]=!0}for(var a=0,o=Object.getOwnPropertyNames(w);a<o.length;a++){var s=o[a];n[s.charCodeAt(0)]=!0}}return!0===n[e]}var M={"+":o.addOperatorToken,"-":o.subOperatorToken,"*":o.mulOperatorToken,"/":o.divOperatorToken,"^":o.powOperatorToken,"%":o.percentOperatorToken,"&":o.concatOperatorToken,"=":o.eqOperatorToken,"<":o.ltOperatorToken,">":o.gtOperatorToken,":":o.rangeOperatorToken,".":o.dotSepToken,"@":o.atOperatorToken,"#":o.poundOperatorToken},w={"<>":o.neOperatorToken,"<=":o.leOperatorToken,">=":o.geOperatorToken};function D(e,t,r){if(t<e.length-1){var n=w[e.substring(t,t+2)];if(null!=n)return(0,o.appendToken)(2,n(t),r)}var s=M[e.charAt(t)];if(null!=s)return(0,o.appendToken)(1,s(t),r);return a.ulsLogger.ULS.assertTag(595980822,i.LogCategory.msoulscat_ES_EWAJS,!1,"calc.parse.tokenizeOperator: internal error: expected operator")}function j(e,t,r,n,i){var a=(0,c.parseNumberLiteral)(e,t,r,n,!1,!1,!1);if(void 0!==a){var s=a.value,u=a.i,l=r.substring(n,u);return(0,o.appendToken)(u-n,(0,o.literalToken)(n,l,null!=s?s:o.badNumberOper,!0),i),u}}var x=function(e,t){return e.charCodeAt(t)!==y},L=function(e,t){return e.charCodeAt(t)===y};function B(e,t,r){var n=(0,f.scanEscapedWhile)(e,t+1,x,'"',L),i=n[0],a=n[1],u=e.substring(t,a+1);return a<e.length?(0,o.appendToken)(a+1-t,(0,o.literalToken)(t,u,(0,s.stringOper)(i),!0),r):(0,o.appendToken)(a-t,(0,o.literalToken)(t,u,(0,s.stringOper)(i),!1),r)}function U(e,t,r,n){for(var i=1;i<e.errorNames.length;i+=1){var a=e.errorNames[i];if(null!=a){var u=t.substring(r,r+a.length);if(0===e.stringCompareCI(a,u))return(0,o.appendToken)(a.length,(0,o.literalToken)(r,u,(0,s.errorOper)(i)),n)}}for(var c=r+1,l=!1;c<t.length;){var d=(0,p.stringCodePointAt)(t,c);if(c!==r+1||d!==F&&d!==I)if(c>r+1&&d===_&&!l)l=!0,c+=1;else if(c>r+1&&d===T)c+=1;else{if(c>r+1&&d===E){(c+=1)<t.length&&t.charCodeAt(c)===O&&(c+=1);break}if(d===O||d===N){c!==r+1&&(c+=1);break}if(!e.isIdentStart(d))break;c+=(0,p.numCodeUnits)(d)}else c+=1}if(c>r+1){u=t.substring(r,c);return(0,o.appendToken)(c-r,(0,o.literalToken)(r,u,o.badErrorOper),n)}}function G(e,t,r,n){for(var i=1;i<e.specialRefNames.length;i+=1){var a=e.specialRefNames[i];if(null!=a){var s=t.substring(r,r+a.length);if(0===e.stringCompareCI(a,s))return(0,o.appendToken)(a.length,(0,o.specialRefToken)(r,s,i),n)}}}function K(e,t,r){var n=t.charCodeAt(r);return!((0,c.isSpace)(n)||n===k||n===C||n===S||n===b||(0,h.stringStartsWith)(t,e.listSeparator,r)||(0,h.stringStartsWith)(t,e.leftBracket,r)||(0,h.stringStartsWith)(t,e.rightBracket,r))}var V=function(e,t){return(0,c.isSpace)((0,p.stringCodePointAt)(e,t))};function W(e,t,r,n){for(var i=r,a=0,s=function(t,r){return K(e,t,r)},u=function(t,r){return!K(e,t,r)},l=(0,f.makeProgressAsserter)("calc.parse.tokenizeBracketedRef",i);i<t.length;){l(i);var d=(0,p.stringCodePointAt)(t,i);if(n.length>0&&n[n.length-1].kind===o.TokenKind.Escape&&u(t,i))i=(0,o.appendToken)((0,p.numCodeUnits)(d),(0,o.identToken)(i,(0,p.stringFromCodePoint)(d)),n);else if(d!==b){if(d===C)if(null!=(g=G(e,t,i,n))){i=g;continue}if(d!==k)if((0,h.stringStartsWith)(t,e.rightBracket,i)){if(i=(0,o.appendToken)(e.rightBracket.length,(0,o.rightBracketToken)(i,e.rightBracket),n),0===(a-=1))return i}else if(s(t,i)){var m=(0,f.scanWhile)(t,i,s),v=m[0],g=m[1];i=(0,o.appendToken)(g-i,(0,o.identToken)(i,v),n)}else if((0,c.isSpace)(d)){var y=(0,f.scanWhile)(t,i,V);v=y[0],g=y[1];i=(0,o.appendToken)(g-i,(0,o.spacesToken)(i,v),n)}else d!==S?(0,h.stringStartsWith)(t,e.listSeparator,i)?i=(0,o.appendToken)(e.listSeparator.length,(0,o.listSepToken)(i,e.listSeparator),n):(0,h.stringStartsWith)(t,e.leftBracket,i)&&a<2?(i=(0,o.appendToken)(e.leftBracket.length,(0,o.leftBracketToken)(i,e.leftBracket),n),a+=1):i=(0,o.appendToken)((0,p.numCodeUnits)(d),(0,o.unexpectedToken)(i,(0,p.stringFromCodePoint)(d)),n):i=(0,o.appendToken)(1,(0,o.rangeOperatorToken)(i),n);else i=(0,o.appendToken)(1,(0,o.escapeToken)(i,"'"),n)}else i=(0,o.appendToken)(1,(0,o.atOperatorToken)(i),n)}return i}function H(e,t,r,n){for(var i=(0,o.appendToken)(1,(0,o.leftSQuoteToken)(r),n),a=function(t,r){return function(e,t,r){var n=t.charCodeAt(r);return n!==k&&n!==S&&n!==g&&n!==N&&!(0,h.stringStartsWith)(t,e.leftBracket,r)&&!(0,h.stringStartsWith)(t,e.rightBracket,r)}(e,t,r)},s=function(e,t){return e.charCodeAt(t)===k},u=(0,f.makeProgressAsserter)("calc.parse.tokenizeQuotedQualifier",i);i<t.length;){u(i);var c=(0,p.stringCodePointAt)(t,i);if(c===k&&!(i+1<t.length&&t.charCodeAt(i+1)===k))return(0,o.appendToken)(1,(0,o.rightSQuoteToken)(i),n);if(c!==S)if((0,h.stringStartsWith)(t,e.leftBracket,i))i=(0,o.appendToken)(e.leftBracket.length,(0,o.leftBracketToken)(i,e.leftBracket),n);else if((0,h.stringStartsWith)(t,e.rightBracket,i))i=(0,o.appendToken)(e.rightBracket.length,(0,o.rightBracketToken)(i,e.rightBracket),n);else if((0,f.getEscapedSkip)(t,i,a,"'",s)>0){var l=(0,f.scanEscapedWhile)(t,i,a,"'",s),d=l[0],m=l[1];i=(0,o.appendToken)(m-i,(0,o.identToken)(i,d),n)}else i=(0,o.appendToken)((0,p.numCodeUnits)(c),(0,o.unexpectedToken)(i,(0,p.stringFromCodePoint)(c)),n);else i=(0,o.appendToken)(1,(0,o.rangeOperatorToken)(i),n)}return i}function q(e,t,r,n,i,a){var s=(0,u.parseCellRef)(e,t,r,n,i);if(null!=s){var c=s.i,l=n.substring(c,i),f=s.refStyle===d.RefStyle.A1?(0,o.cellRefA1Token)(i,l,s.row,s.col):(0,o.cellRefR1C1Token)(i,l,s.row,s.col,s.enLocale);return(0,o.appendToken)(c-i,f,a)}}function z(e,t,r,n){var i=n[n.length-1];return null==i||(i.kind!==o.TokenKind.Sep||i.value!==o.SepId.Dot)&&((0,h.stringStartsWith)(t,e.decimalSeparator,r)?i.kind===o.TokenKind.Spaces&&null==(i=n[n.length-2])||i.kind!==o.TokenKind.Ident&&i.kind!==o.TokenKind.CellRef&&i.kind!==o.TokenKind.Right&&(i.kind!==o.TokenKind.Literal||(0,o.isNumberLikeOper)(i.oper)):e.isNumeral((0,p.stringCodePointAt)(t,r)))}function Q(e,t,r,n){for(var i=e[t],a=t+1;a<e.length;a+=1){var o=e[a];if(o.kind!==r)break;i=n(i,o)}return[i,a]}t.tokenizeFormula=function(e,t,r,n,i,a){for(var s=function(e,t,r,n,i,a){for(var s=[],u=[],l=a,d=(0,f.makeProgressAsserter)("calc.parse.tokenize",l);l<i.length;){d(l);var m=q(e,r,n,i,l,s);if(null==m){var g=(0,p.stringCodePointAt)(i,l);if(z(e,i,l,s)){var b=j(e,t,i,l,s);if(null!=b){l=b;continue}}if(g!==y)if(e.isIdentContinue(g)){var S=(0,f.scanWhile)(i,l,(function(t,r){return e.isIdentContinue((0,p.stringCodePointAt)(t,r))})),N=S[0],T=S[1];l=(0,o.appendToken)(T-l,(0,o.identOrBooleanToken)(e,l,N),s)}else if(g!==C)if((0,c.isSpace)(g)){var E=(0,f.scanWhile)(i,l,V),_=(N=E[0],E[1]);l=(0,o.appendToken)(_-l,(0,o.spacesToken)(l,N),s)}else if(g!==P)if(g!==R)if((0,h.stringStartsWith)(i,e.leftBrace,l))u.push(o.DelimId.Brace),l=(0,o.appendToken)(e.leftBrace.length,(0,o.leftBraceToken)(l,e.leftBrace),s);else if((0,h.stringStartsWith)(i,e.rightBrace,l))u.length>0&&u[u.length-1]===o.DelimId.Brace&&u.pop(),l=(0,o.appendToken)(e.rightBrace.length,(0,o.rightBraceToken)(l,e.rightBrace),s);else if((0,h.stringStartsWith)(i,e.leftBracket,l))l=W(e,i,l,s);else if((0,h.stringStartsWith)(i,e.rightBracket,l))l=(0,o.appendToken)(e.rightBracket.length,(0,o.rightBracketToken)(l,e.rightBracket),s);else{if(u.length>0&&u[u.length-1]===o.DelimId.Brace){if((0,h.stringStartsWith)(i,e.columnSeparator,l)){l=(0,o.appendToken)(e.columnSeparator.length,(0,o.colSepToken)(l,e.columnSeparator),s);continue}if((0,h.stringStartsWith)(i,e.rowSeparator,l)){l=(0,o.appendToken)(e.rowSeparator.length,(0,o.rowSepToken)(l,e.rowSeparator),s);continue}}if((0,h.stringStartsWith)(i,e.listSeparator,l))l=(0,o.appendToken)(e.listSeparator.length,(0,o.listSepToken)(l,e.listSeparator),s);else if(g!==O)if(g!==k)if(A(g)){if((0,h.stringStartsWith)(i,":=",l)&&(0,v.isFeatureEnabled)(v.FeatureName.CalcLambdaDefaultParameters)){l=(0,o.appendToken)(2,(0,o.assignSepToken)(l),s);continue}l=D(i,l,s)}else l=(0,o.appendToken)((0,p.numCodeUnits)(g),(0,o.unexpectedToken)(l,(0,p.stringFromCodePoint)(g)),s);else l=H(e,i,l,s);else l=(0,o.appendToken)(1,(0,o.qualSepToken)(l),s)}else u.length>0&&u[u.length-1]===o.DelimId.Paren&&u.pop(),l=(0,o.appendToken)(1,(0,o.rightParenToken)(l),s);else u.push(o.DelimId.Paren),l=(0,o.appendToken)(1,(0,o.leftParenToken)(l),s);else{var F=U(e,i,l,s);if(null!=F){l=F;continue}l=D(i,l,s)}else l=B(i,l,s)}else l=m}return s}(e,t,r,n,i,a),u=[],l=0;l<s.length;){var d=s[l];if(d.kind!==o.TokenKind.Unexpected)u.push(d),l+=1;else{var m=Q(s,l,o.TokenKind.Unexpected,(function(e,t){var r=e,n=t;return(0,o.unexpectedToken)(r.start,r.chars+n.chars)})),g=m[0],b=m[1];u.push(g),l=b}}return u.push((0,o.endToken)(i.length)),u}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.scanEscapedWhile=t.getEscapedSkip=t.scanWhile=t.makeProgressAsserter=void 0;var n=r(18),i=r(65),a=r(114),o=r(185);function s(e,t,r,n,i){return r(e,t)?1:(0,o.stringStartsWith)(e,n,t)&&t+n.length<e.length&&i(e,t+n.length)?2:0}t.makeProgressAsserter=function(e,t){var r=t-1;return function(t){if(t<=r){var a="".concat(e,": internal error: no progress made at index ").concat(t);return i.ulsLogger.ULS.assertTag(595980821,n.LogCategory.msoulscat_ES_EWAJS,!1,a)}r=t}},t.scanWhile=function(e,t,r){for(var n=t;n<e.length&&r(e,n);)n+=(0,a.numCodeUnits)((0,a.stringCodePointAt)(e,n));return[e.substring(t,n),n]},t.getEscapedSkip=s,t.scanEscapedWhile=function(e,t,r,n,i){for(var o=[],u=t,c=t;c<e.length;){var l=s(e,c,r,n,i);if(0===l)break;2===l&&(u!==c&&o.push(e.substring(u,c)),u=c+n.length,c+=n.length),c+=(0,a.numCodeUnits)((0,a.stringCodePointAt)(e,c))}return u!==c&&o.push(e.substring(u,c)),[o.join(""),c]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.valueErrorOper=t.trueOper=t.stringOper=t.refErrorOper=t.rangeSeqOper=t.range3DOper=t.precedents=t.numErrorOper=t.nullErrorOper=t.nameErrorOper=t.naErrorOper=t.missingOper=t.gettingDataErrorOper=t.fieldErrorOper=t.falseOper=t.errorOper=t.div0ErrorOper=t.cellStringLimit=t.booleanOper=t.blankOper=t.arrayOper=t.PrecsBound=t.ErrorType=void 0;var n=r(3);t.ErrorType=n.value.ErrorType,t.PrecsBound=n.value.PrecsBound,t.arrayOper=n.value.arrayOper,t.blankOper=n.value.blankOper,t.booleanOper=n.value.booleanOper,t.cellStringLimit=n.value.cellStringLimit,t.div0ErrorOper=n.value.div0ErrorOper,t.errorOper=n.value.errorOper,t.falseOper=n.value.falseOper,t.fieldErrorOper=n.value.fieldErrorOper,t.gettingDataErrorOper=n.value.gettingDataErrorOper,t.missingOper=n.value.missingOper,t.naErrorOper=n.value.naErrorOper,t.nameErrorOper=n.value.nameErrorOper,t.nullErrorOper=n.value.nullErrorOper,t.numErrorOper=n.value.numErrorOper,t.precedents=n.value.precedents,t.range3DOper=n.value.range3DOper,t.rangeSeqOper=n.value.rangeSeqOper,t.refErrorOper=n.value.refErrorOper,t.stringOper=n.value.stringOper,t.trueOper=n.value.trueOper,t.valueErrorOper=n.value.valueErrorOper},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.xlDatepack=t.tzUTC=t.tzData=t.dateTime=t.TimeGranularity=t.TimeDivision=t.Rounding=void 0;var n=r(3);t.Rounding=n.datepack.Rounding,t.TimeDivision=n.datepack.TimeDivision,t.TimeGranularity=n.datepack.TimeGranularity,t.dateTime=n.datepack.dateTime,t.tzData=n.datepack.tzData,t.tzUTC=n.datepack.tzUTC,t.xlDatepack=n.datepack.xlDatepack},function(e,t,r){"use strict";var n,i;Object.defineProperty(t,"__esModule",{value:!0}),t.evalFormat=t.evalFormatImpl=void 0;var a=r(2),o=r(92),s=r(80),u=r(359),c=r(90),l=r(360),d=r(361),f=r(244),p=r(191),m=r(131),h=r(91),v=r(76),g=r(362),b=r(363),S=(0,m.typedInstanceCreator)()((function(e,t,r,n){return{strong:e,format:t,valueType:r,decimals:n}})),y={},O=(0,s.createFailureErrorClass)("InferenceError"),C={getDocumentLoc:function(){return(0,o.assertFalse)("calc.numfmt.evalFormula: default getDocumentLoc")},getSheetIndex:function(){return(0,o.assertFalse)("calc.numfmt.evalFormula: default getSheetIndex")},getSheetName:function(){return(0,o.assertFalse)("calc.numfmt.evalFormula: default getSheetName")},getNameLoc:function(){return(0,o.assertFalse)("calc.numfmt.evalFormula: default getNameLoc")},getUserDefinedFuncLoc:function(){return(0,o.assertFalse)("calc.numfmt.evalFormula: default getUserDefinedFuncLoc")},getSheetRangeIndexes:function(){return(0,o.assertFalse)("calc.numfmt.evalFormula: default getSheetRangeIndexes")},getCellFormat:function(){return(0,o.assertFalse)("calc.numfmt.evalFormula: default getCellFormat")},getKnownFormat:function(){return(0,o.assertFalse)("calc.numfmt.evalFormula: default getKnownFormat")},getIformat:function(){return(0,o.assertFalse)("calc.numfmt.evalFormula: default getIformat")},getFormatString:function(){return(0,o.assertFalse)("calc.numfmt.evalFormula: default getFormatString")},getContainingTable:function(){return(0,o.assertFalse)("calc.numfmt.evalFormula: default getContainingTable")},getStructRefColumn:function(){return(0,o.assertFalse)("calc.numfmt.evalFormula: default getStructRefColumn")},getStructRefSpecialRef:function(){return(0,o.assertFalse)("calc.numfmt.evalFormula: default getStructRefSpecialRef")}};function P(e,t){var r,n,i=function(e){var t,r,n,i,a,o,s,u,c,l,d,f,p,m,h,v,g,b,S,y,O,P,N,R,k,T;return{config:e.config,getDocumentLoc:null!==(r=null===(t=e.getDocumentLoc)||void 0===t?void 0:t.bind(e))&&void 0!==r?r:C.getDocumentLoc,getSheetIndex:null!==(i=null===(n=e.getSheetIndex)||void 0===n?void 0:n.bind(e))&&void 0!==i?i:C.getSheetIndex,getSheetName:null!==(o=null===(a=e.getSheetName)||void 0===a?void 0:a.bind(e))&&void 0!==o?o:C.getSheetName,getNameLoc:null!==(u=null===(s=e.getNameLoc)||void 0===s?void 0:s.bind(e))&&void 0!==u?u:C.getNameLoc,getUserDefinedFuncLoc:null!==(l=null===(c=e.getUserDefinedFuncLoc)||void 0===c?void 0:c.bind(e))&&void 0!==l?l:C.getUserDefinedFuncLoc,getSheetRangeIndexes:null!==(f=null===(d=e.getSheetRangeIndexes)||void 0===d?void 0:d.bind(e))&&void 0!==f?f:C.getSheetRangeIndexes,getCellFormat:null!==(m=null===(p=e.getCellFormat)||void 0===p?void 0:p.bind(e))&&void 0!==m?m:C.getCellFormat,getKnownFormat:null!==(v=null===(h=e.getKnownFormat)||void 0===h?void 0:h.bind(e))&&void 0!==v?v:C.getKnownFormat,getIformat:null!==(b=null===(g=e.getIformat)||void 0===g?void 0:g.bind(e))&&void 0!==b?b:C.getIformat,getFormatString:null!==(y=null===(S=e.getFormatString)||void 0===S?void 0:S.bind(e))&&void 0!==y?y:C.getFormatString,getContainingTable:null!==(P=null===(O=e.getContainingTable)||void 0===O?void 0:O.bind(e))&&void 0!==P?P:C.getContainingTable,getStructRefColumn:null!==(R=null===(N=e.getStructRefColumn)||void 0===N?void 0:N.bind(e))&&void 0!==R?R:C.getStructRefColumn,getStructRefSpecialRef:null!==(T=null===(k=e.getStructRefSpecialRef)||void 0===k?void 0:k.bind(e))&&void 0!==T?T:C.getStructRefSpecialRef}}(e);return{globals:i,locals:t,config:e.config,localeInfo:null!==(n=null===(r=t.config)||void 0===r?void 0:r.localeInfo)&&void 0!==n?n:e.config.localeInfo,mathpack:e.config.mathpack,get document(){var e=t.originSheet;if(!(0,v.isSuccess)(e))throw new O(e);return e.value.document},get defaultFormat(){var e=F(this,h.KnownFormat.General);return S(!1,e,e.valueType,e.decimals)},get unitlessFormat(){var e=F(this,h.KnownFormat.General);return S(!0,e,e.valueType,e.decimals)},resolver:(0,d.createResolver)(i),multOrDivTainted:!1}}var N,R=((n={})[c.FormatValueType.General]=0,n[c.FormatValueType.Number]=1,n[c.FormatValueType.Currency]=2,n[c.FormatValueType.Accounting]=2,n[c.FormatValueType.Percentage]=3,n[c.FormatValueType.Date]=4,n[c.FormatValueType.Time]=5,n[c.FormatValueType.Fraction]=6,n[c.FormatValueType.Scientific]=7,n[c.FormatValueType.Text]=8,n[c.FormatValueType.Custom]=9,n);!function(e){e[e.Propagate=-2147483648]="Propagate",e[e.Ignore=-2147483647]="Ignore"}(N||(N={}));var k=((i={})[f.WorksheetFuncId.INT]=N.Propagate,i[f.WorksheetFuncId.MOD]=N.Propagate,i[f.WorksheetFuncId.ROUND]=N.Propagate,i[f.WorksheetFuncId.SUM]=N.Propagate,i[f.WorksheetFuncId.TRUNC]=N.Propagate,i[f.WorksheetFuncId.AVERAGE]=N.Propagate,i[f.WorksheetFuncId.MAX]=N.Propagate,i[f.WorksheetFuncId.MEDIAN]=N.Propagate,i[f.WorksheetFuncId.MIN]=N.Propagate,i[f.WorksheetFuncId.ROUNDUP]=N.Propagate,i[f.WorksheetFuncId.ROUNDDOWN]=N.Propagate,i[f.WorksheetFuncId.NPV]=h.KnownFormat.CoCurrencyDec,i[f.WorksheetFuncId.PV]=h.KnownFormat.CoCurrencyDec,i[f.WorksheetFuncId.FV]=h.KnownFormat.CoCurrencyDec,i[f.WorksheetFuncId.PMT]=h.KnownFormat.CoCurrencyDec,i[f.WorksheetFuncId.RATE]=h.KnownFormat.Pct0,i[f.WorksheetFuncId.MIRR]=h.KnownFormat.Pct0,i[f.WorksheetFuncId.IRR]=h.KnownFormat.Pct0,i[f.WorksheetFuncId.DATE]=h.KnownFormat.MMDDYY,i[f.WorksheetFuncId.TIME]=h.KnownFormat.HHMMAP,i[f.WorksheetFuncId.NOW]=h.KnownFormat.MDYHMS,i[f.WorksheetFuncId.SLN]=h.KnownFormat.CoCurrencyDec,i[f.WorksheetFuncId.SYD]=h.KnownFormat.CoCurrencyDec,i[f.WorksheetFuncId.DDB]=h.KnownFormat.CoCurrencyDec,i[f.WorksheetFuncId.IPMT]=h.KnownFormat.CoCurrencyDec,i[f.WorksheetFuncId.PPMT]=h.KnownFormat.CoCurrencyDec,i[f.WorksheetFuncId.TODAY]=h.KnownFormat.MMDDYY,i[f.WorksheetFuncId.VDB]=h.KnownFormat.CoCurrencyDec,i[f.WorksheetFuncId.DB]=h.KnownFormat.CoCurrencyDec,i);var T=[[c.FormatValueType.General,c.FormatValueType.Number,c.FormatValueType.Currency,c.FormatValueType.Percentage,c.FormatValueType.Date,c.FormatValueType.Time,c.FormatValueType.Fraction,c.FormatValueType.Scientific,c.FormatValueType.Text,c.FormatValueType.Custom],[c.FormatValueType.General,c.FormatValueType.Number,c.FormatValueType.Currency,c.FormatValueType.Percentage,c.FormatValueType.Date,c.FormatValueType.Time,c.FormatValueType.Number,c.FormatValueType.Scientific,c.FormatValueType.Text,c.FormatValueType.Custom],[c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.Currency,c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.Currency,c.FormatValueType.Currency,c.FormatValueType.Text,c.FormatValueType.Custom],[c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.Percentage,c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.Percentage,c.FormatValueType.Percentage,c.FormatValueType.Text,c.FormatValueType.Custom],[c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.Date,c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.Text,c.FormatValueType.Custom],[c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.Time,c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.Text,c.FormatValueType.Custom],[c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.Fraction,c.FormatValueType.Scientific,c.FormatValueType.Text,c.FormatValueType.Custom],[c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.Scientific,c.FormatValueType.Text,c.FormatValueType.Custom],[c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.Text,c.FormatValueType.Custom],[c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.Custom]],E=[[c.FormatValueType.General,c.FormatValueType.Number,c.FormatValueType.Currency,c.FormatValueType.General,c.FormatValueType.Date,c.FormatValueType.Time,c.FormatValueType.Fraction,c.FormatValueType.Scientific,c.FormatValueType.Text,c.FormatValueType.Custom],[c.FormatValueType.General,c.FormatValueType.Number,c.FormatValueType.Currency,c.FormatValueType.Number,c.FormatValueType.Date,c.FormatValueType.Time,c.FormatValueType.Fraction,c.FormatValueType.Scientific,c.FormatValueType.Text,c.FormatValueType.Custom],[c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.Currency,c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.Currency,c.FormatValueType.Currency,c.FormatValueType.Text,c.FormatValueType.Custom],[c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.Percentage,c.FormatValueType.Date,c.FormatValueType.Time,c.FormatValueType.Percentage,c.FormatValueType.Scientific,c.FormatValueType.Text,c.FormatValueType.Custom],[c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.Date,c.FormatValueType.Date,c.FormatValueType.Text,c.FormatValueType.Custom],[c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.Time,c.FormatValueType.Time,c.FormatValueType.Text,c.FormatValueType.Custom],[c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.Fraction,c.FormatValueType.Scientific,c.FormatValueType.Text,c.FormatValueType.Custom],[c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.Scientific,c.FormatValueType.Text,c.FormatValueType.Custom],[c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.Text,c.FormatValueType.Custom],[c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.General,c.FormatValueType.Custom]];function _(e,t){if("number"!=typeof t)return t;var r=e.globals.getIformat(e.document,t);if(!(0,v.isSuccess)(r))throw new O(r.reason);return r.value}function F(e,t){var r=e.globals.getKnownFormat(e.document,t);if(!(0,v.isSuccess)(r))throw new O(r.reason);return r.value}function I(e,t){if("number"==typeof t)return t;var r=e.globals.getFormatString(e.document,t.formatString);if(!(0,v.isSuccess)(r))throw new O(r.reason);return void 0!==r.value?r.value:t}function A(e,t,r){return(0,o.assertTrue)("calc.numfmt.evalFormula: well-formed bin op",2===t.length),r(e,t[0],t[1])}function M(e,t,r,n){var i=r[0],a=n[0],o=R[i.valueType],s=R[a.valueType],u=o<=s?t[o][s]:t[s][o],c=R[u],l=a.decimals>i.decimals?a.decimals:i.decimals;switch(c){case o:return S(!0,i.format,i.valueType,l);case s:return S(!0,a.format,a.valueType,l);default:return e.unitlessFormat}}function w(e,t,r){return M(e,E,t,r)}function D(e,t,r){var n=t[0],i=r[0];if(n.format===i.format&&n.valueType===i.valueType&&n.valueType===c.FormatValueType.Time)return S(!0,n.format,n.valueType,n.decimals);if(n.valueType===c.FormatValueType.Date&&i.valueType===c.FormatValueType.Time||n.valueType===c.FormatValueType.Time&&i.valueType===c.FormatValueType.Date){var a=F(e,h.KnownFormat.MDYHMS),o=a.valueType,s=a.decimals;return S(!0,a,o,s)}return M(e,T,t,r)}var j=function(e){return e.unitlessFormat};function x(e,t,r){var n=t[0],i=r[0];return n.format===i.format?S(!0,n.format,n.valueType,n.decimals):e.unitlessFormat}function L(e){return R[e]===R[c.FormatValueType.General]}var B=function(){function e(e){var t=this;this.context=e,this.visitFormulaNode=function(e){return(0,g.visitFormulaNode)(t,e)},this.lazyVisitFormulaNode=function(e){return b.Pledge.resolve(e).bind(t.visitFormulaNode)}}return e.prototype.literalNode=function(e){switch(e.kind){case p.OperKind.String:case p.OperKind.Boolean:case p.OperKind.Error:case p.OperKind.Missing:return b.Pledge.resolve(this.context.defaultFormat);case p.OperKind.Number:var t=this.context.mathpack.formatGeneral(this.context.localeInfo,this.context.mathpack.abs(e),21),r=t.indexOf(this.context.localeInfo.decimalSeparator),n=r>=0?t.length-r-1:0,i=F(this.context,h.KnownFormat.General);return b.Pledge.resolve(S(!1,i,i.valueType,n));default:return(0,o.assertNever)("calc.numfmt.evalFormat: unexpected literal oper",e)}},e.prototype.arrayNode=function(e){return b.Pledge.resolve(this.context.defaultFormat)},e.prototype.appNode=function(e,t){var r=this;if((0,s.isOperatorNode)(e))return b.Pledge.all(t.map((function(e){return r.lazyVisitFormulaNode(e).bind((function(t){return[t,e]}))}))).bind((function(t){return function(e,t,r){switch(t){case f.OperatorId.Mul:case f.OperatorId.Div:return e.multOrDivTainted=!0,A(e,r,w);case f.OperatorId.Pow:return A(e,r,w);case f.OperatorId.Add:case f.OperatorId.Sub:return A(e,r,D);case f.OperatorId.Percent:(0,o.assertTrue)("calc.numfmt.evalFormat: well-formed unary op",1===r.length);var n=r[0],i=n[0],a=n[1];if(!(0,s.isNumberNode)(a))return e.defaultFormat;var u=i.strong,c=i.decimals,l=F(e,h.KnownFormat.Pct);return S(u,l,l.valueType,c);case f.OperatorId.Pound:case f.OperatorId.At:return e.defaultFormat;case f.OperatorId.Neg:case f.OperatorId.Pos:return(0,o.assertTrue)("calc.numfmt.evalFormat: well-formed unary op",1===r.length),i=r[0][0];case f.OperatorId.Lt:case f.OperatorId.Le:case f.OperatorId.Eq:case f.OperatorId.Ge:case f.OperatorId.Gt:case f.OperatorId.Ne:return A(e,r,j);case f.OperatorId.Isect:case f.OperatorId.Union:case f.OperatorId.Range:case f.OperatorId.Concat:return A(e,r,x);case f.OperatorId.And:case f.OperatorId.Or:case f.OperatorId.Xor:case f.OperatorId.Min:case f.OperatorId.Max:throw new O((0,s.notImplemented)(["evalFormat for Yellow ops"]));default:return(0,o.assertNever)("calc.numfmt.evalFormat: unexpected operator id",t)}}(r.context,e.id,t)}));if((0,s.isWSFNode)(e)){var n=e.id,i=function(e){var t;return null!==(t=k[e])&&void 0!==t?t:N.Ignore}(n),a=(0,f.getWorksheetFuncType)(n),c=(0,s.getArguments)((0,u.appNode)(e,t));if((0,o.assertTrue)("calc.numfmt.evalFormula: well-formed WSF args",(0,s.isValidArgsLength)(a,c.length)),i===N.Ignore)return b.Pledge.resolve(this.context.defaultFormat);if(i===N.Propagate)return 0===c.length?b.Pledge.resolve(this.context.defaultFormat):b.Pledge.all(t.map(this.lazyVisitFormulaNode)).bind((function(e){var t=e[0],n=t.format,i=t.valueType,a=t.decimals,o=!L(i);if(!t.strong&&o)return r.context.unitlessFormat;for(var s=o,u=1;u<e.length;u+=1){var c=e[u],l=!L(c.valueType);if(!c.strong&&l)return r.context.unitlessFormat;s||(n=c.format,i=c.valueType,a=c.decimals,s=l)}return S(!0,n,i,a)}));var l=F(this.context,i),d=l.valueType,p=l.decimals;return b.Pledge.resolve(S(!0,l,d,p))}return this.lazyVisitFormulaNode(e)},e.prototype.letNode=function(e,t,r,n){return b.Pledge.resolve(this.context.defaultFormat)},e.prototype.lambdaNode=function(e,t,r,n){return b.Pledge.resolve(this.context.defaultFormat)},e.prototype.parenNode=function(e){return this.lazyVisitFormulaNode(e)},e.prototype.nameNode=function(e,t){return b.Pledge.resolve(this.context.defaultFormat)},e.prototype.cellRefNode=function(e,t){var r=this.context.resolver.resolveCellRef(this.context.locals,(0,u.cellRefNode)(e,t)).resolution;if(!(0,v.isSuccess)(r))throw(0,o.assertTrue)("calc.numfmt.evalFormat: NoOriginSheet",r.reason.kind!==l.ResolveReasonKind.NoOriginSheet),new O(r.reason);var n=r.value;if(void 0===n)throw y;return(0,s.isSheetGridRange)(n)?b.Pledge.resolve(G(this.context,n)):b.Pledge.resolve(this.context.unitlessFormat)},e.prototype.fieldRefNode=function(e,t){var r=this;return this.lazyVisitFormulaNode(e).bind((function(e){return r.context.defaultFormat}))},e.prototype.structRefNode=function(e,t){var r=(0,u.structRefNode)(e,t),n=this.context.resolver.resolveStructRef(this.context.locals,r).resolution;if(!(0,v.isSuccess)(n)){if((0,o.assertTrue)("calc.numfmt.evalFormat: NoOriginSheet",n.reason.kind!==l.ResolveReasonKind.NoOriginSheet),n.reason.kind===l.ResolveReasonKind.EmptyIntersection)throw y;throw new O(n.reason)}var i=n.value;if(void 0===i)throw y;return b.Pledge.resolve(G(this.context,i))},e.prototype.badSequenceNode=function(e,t){return(0,o.assertFalse)("calc.numfmt.evalFormat: unexpected bad node")},e.prototype.badStringNode=function(e,t){return(0,o.assertFalse)("calc.numfmt.evalFormat: unexpected bad node")},e.prototype.operatorNode=function(e,t){return b.Pledge.resolve((0,u.operatorNode)(e,t))},e.prototype.wsfNode=function(e,t,r){return b.Pledge.resolve((0,u.wsfNode)(e,t,r))},e}();function U(e,t){return(0,g.reducePledge)(new B(e),t)}function G(e,t){var r=(0,s.sheetGridRangeAnchor)(t),n=e.globals.getCellFormat(r);if(!(0,v.isSuccess)(n))throw new O(n.reason);var i=n.value,a=_(e,i);if(!(0,s.isDocumentLocEqual)(r.sheet.document,e.document)&&("number"!=typeof i||a.source!==c.NumberFormatSource.Builtin))return e.defaultFormat;var o=a.valueType,u=a.decimals;return S(!0,i,o,u)}t.evalFormatImpl=function(e,t,r){try{var n=P(e,t),i=U(n,r);return(0,v.success)(a.__assign(a.__assign({},i),{format:I(n,i.format),mulOrDivTainted:n.multOrDivTainted}))}catch(e){return e instanceof O?(0,v.failure)(e.reason):e===y?v.successUndefined:(0,v.failure)((0,v.javaScriptError)(e))}},t.evalFormat=function(e,t,r){try{var n=P(e,t),i=U(n,r);return(0,v.success)(function(e,t){var r=t.strong,n=t.format,i=t.valueType,a=t.decimals;if(i!==c.FormatValueType.Number||!e.multOrDivTainted){if(a>0&&r&&(i===c.FormatValueType.Number||i===c.FormatValueType.Currency||i===c.FormatValueType.Accounting||i===c.FormatValueType.Percentage)){var o=_(e,n);a!==o.decimals&&(n=o.synthesizeDecimals(a))}if(i!==c.FormatValueType.General&&r)return n=I(e,n)}}(n,i))}catch(e){return e instanceof O?(0,v.failure)(e.reason):e===y?v.successUndefined:(0,v.failure)((0,v.javaScriptError)(e))}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unknownFunctionType=t.operatorStrings=t.higherOrderFunctionType=t.getWorksheetFuncType=t.getWorksheetFuncEnglishName=t.getOperatorType=t.WorksheetFuncId=t.OperatorId=void 0;var n=r(3);t.OperatorId=n.signature.OperatorId,t.WorksheetFuncId=n.signature.WorksheetFuncId,t.getOperatorType=n.signature.getOperatorType,t.getWorksheetFuncEnglishName=n.signature.getWorksheetFuncEnglishName,t.getWorksheetFuncType=n.signature.getWorksheetFuncType,t.higherOrderFunctionType=n.signature.higherOrderFunctionType,t.operatorStrings=n.signature.operatorStrings,t.unknownFunctionType=n.signature.unknownFunctionType},function(e,t,r){"use strict";var n,i,a,o,s,u,c,l,d,f;Object.defineProperty(t,"__esModule",{value:!0}),t.changeFormatDecimals=t.applyFormat=t.createFormat=t.NumberFormatImpl=void 0;var p=r(2),m=r(133),h=r(92),v=r(80),g=r(90),b=r(189),S=r(241),y=r(244),O=r(188),C=r(130),P=r(365),N=r(131),R=r(80),k=r(147),T=r(148),E=r(91),_=r(242),F=r(192),I=r(191),A=r(76),M=r(366),w=r(246),D=T.codePointMinusSign,j=T.codePointPlusSign,x=T.codePointDigitZero,L=T.codePointHash,B=T.codePointFullStop,U=T.codePointDigitOne,G=T.codePointDigitTwo,K=T.codePointLeftParen,V=T.codePointRightParen,W=T.codePointSmallT,H=T.codePointBackslash,q={decimalSeparator:"NOTUSED"};function z(e,t,r,n){var i=e.formatFixed(t,0,0),a=i.mantissa,o=i.exponent;(0,h.assertTrue)("calc.numfmt.dtrInteger: mantissa len <= exponent",a.length<=o),(0,h.assertTrue)("calc.numfmt.dtrInteger: mantissa || !exponent",0!==a.length||0===o);var s=(0,k.convertDigitsShape)(o<r?(0,C.repeat)("0",r-o):"",n),u=(0,k.convertNumberShape)(q,a+(0,C.repeat)("0",o-a.length),n);if(!(0,A.isSuccess)(u))throw new Ee(u.reason);return s+u.value}function Q(e,t,r,n,i){var a=e.formatFixed(t,0,0),o=a.mantissa,s=a.exponent;(0,h.assertTrue)("calc.numfmt.dtrFracSeconds: mantissa len <= exponent",o.length<=s),(0,h.assertTrue)("calc.numfmt.dtrFracSeconds: mantissa || !exponent",0!==o.length||0===s);var u=((s<r?(0,C.repeat)("0",r-s):"")+o+(0,C.repeat)("0",s-o.length)).substring(0,n);return(0,k.convertDigitsShape)(u,i)}function J(e,t){var r=e.formatFixed(t,0,0),n=r.mantissa,i=r.exponent;return(0,h.assertTrue)("calc.numfmt.formatInt: mantissa len <= exponent",n.length<=i),(0,h.assertTrue)("calc.numfmt.formatInt: mantissa || !exponent",0!==n.length||0===i),""===n?"0":n.length<i?n+(0,C.repeat)("0",i-n.length):n}function Y(e){for(var t=[],r=0;r<e.length;r+=1){var n=e[r];switch(n.kind){case g.FormattedUnitKind.Blank:case g.FormattedUnitKind.String:for(var i=n.str;r+1<e.length;){var a=e[r+1];if(a.kind!==n.kind)break;i+=a.str,r+=1}t.push({kind:n.kind,str:i});break;case g.FormattedUnitKind.Flexible:case g.FormattedUnitKind.General:t.push(n)}}return t}var $,Z=function(e){return e.kind===g.FormattedUnitKind.Flexible},X=((n={})[1]=E.NumberShape.ChineseTrad1,n[2]=E.NumberShape.ChineseTrad2,n[3]=E.NumberShape.ChineseTrad3,n),ee=((i={})[1]=E.NumberShape.ChineseSimp1,i[2]=E.NumberShape.ChineseSimp2,i[3]=E.NumberShape.ChineseSimp3,i),te=((a={})[1]=E.NumberShape.Japanese1,a[2]=E.NumberShape.Japanese2,a[3]=E.NumberShape.Japanese3,a),re=((o={})[1]=E.NumberShape.Korean1,o[2]=E.NumberShape.Korean2,o[3]=E.NumberShape.Korean3,o[4]=E.NumberShape.Korean4,o);function ne(e){return e+1}!function(e){e[e.Ne=0]="Ne",e[e.Le=1]="Le",e[e.Ge=2]="Ge",e[e.Eq=3]="Eq",e[e.Lt=4]="Lt",e[e.Gt=5]="Gt"}($||($={}));var ie,ae=(0,C.partialArray)(((s={})[$.Ne]="<>",s[$.Le]="<=",s[$.Ge]=">=",s[$.Eq]="=",s[$.Lt]="<",s[$.Gt]=">",s)),oe=((u={})[$.Ne]=y.OperatorId.Ne,u[$.Le]=y.OperatorId.Le,u[$.Ge]=y.OperatorId.Ge,u[$.Eq]=y.OperatorId.Eq,u[$.Lt]=y.OperatorId.Lt,u[$.Gt]=y.OperatorId.Gt,u),se=((c={})[y.OperatorId.Ne]=$.Ne,c[y.OperatorId.Le]=$.Le,c[y.OperatorId.Ge]=$.Ge,c[y.OperatorId.Eq]=$.Eq,c[y.OperatorId.Lt]=$.Lt,c[y.OperatorId.Gt]=$.Gt,c);function ue(e,t,r,n){for(var i=0;i<t.length;i+=1){var a=t[i];if(null!=a&&!(n+a.length>r.length)){var o=r.substring(n,n+a.length);if(0===e.stringCompareCI(a,o))return Number(i)}}}function ce(e,t,r,n){for(var i=0;i<t.length;i+=1){var a=t[i];if(null!=a&&(0,C.stringStartsWith)(r,a,n))return Number(i)}return ue(e,t,r,n)}function le(e,t){var r;return null!==(r=e[t])&&void 0!==r?r:""}function de(e,t){var r=t.indexOf(le(e.pictureSingle,m.PictureSingle.APDelim));return r<0&&(r=t.length>>1),[t.substring(0,r),t.substring(r+1)]}!function(e){e[e.AMPM=100]="AMPM",e[e.AMPMFE=101]="AMPMFE",e[e.General=102]="General",e[e.Currency=103]="Currency",e[e.Color=200]="Color",e[e.Dbnum=201]="Dbnum",e[e.Cond=202]="Cond",e[e.CurrCode=203]="CurrCode",e[e.Char=300]="Char",e[e.StrLit=301]="StrLit",e[e.Numeral=302]="Numeral",e[e.PrefixDigTh=303]="PrefixDigTh",e[e.LatinDate=304]="LatinDate",e[e.BidiDate=305]="BidiDate",e[e.Exp=306]="Exp"}(ie||(ie={}));var fe=/^[0-9A-F]{1,8}$/i,pe=/^(?:([a-z]{2,}(?:-[A-Z0-9]{2,}(?:_[A-Z0-9]+)?)*)(?:-x-([a-z]+))?|x-([a-z0-9]+))?(?:,([0-9A-F]{1,4}))?$/i,me=(0,C.partialArray)(((l={})[1]=E.NumberShape.ASCII,l[2]=E.NumberShape.ArabicIndic,l[3]=E.NumberShape.ExtendedArabicIndic,l[4]=E.NumberShape.Devanagari,l[5]=E.NumberShape.Bengali,l[6]=E.NumberShape.Gurmukhi,l[7]=E.NumberShape.Gujarati,l[8]=E.NumberShape.Oriya,l[9]=E.NumberShape.Tamil,l[10]=E.NumberShape.Telugu,l[11]=E.NumberShape.Kannada,l[12]=E.NumberShape.Malayalam,l[13]=E.NumberShape.Thai,l[14]=E.NumberShape.Lao,l[15]=E.NumberShape.Tibetan,l[16]=E.NumberShape.Myanmar,l[17]=E.NumberShape.Ethiopic,l[18]=E.NumberShape.Khmer,l[19]=E.NumberShape.Mongolian,l[27]=E.NumberShape.Japanese1,l[28]=E.NumberShape.Japanese2,l[29]=E.NumberShape.Japanese3,l[30]=E.NumberShape.ChineseSimp1,l[31]=E.NumberShape.ChineseSimp2,l[32]=E.NumberShape.ChineseSimp3,l[33]=E.NumberShape.ChineseTrad1,l[34]=E.NumberShape.ChineseTrad2,l[35]=E.NumberShape.ChineseTrad3,l[36]=E.NumberShape.Korean1,l[37]=E.NumberShape.Korean2,l[38]=E.NumberShape.Korean3,l[39]=E.NumberShape.Korean4,l)),he=(0,C.partialArray)(((d={})[1]=E.Calendar.Gregorian,d[2]=E.Calendar.GregorianUS,d[3]=E.Calendar.Japan,d[4]=E.Calendar.Taiwan,d[5]=E.Calendar.Korea,d[6]=E.Calendar.Hijri,d[7]=E.Calendar.Thai,d[8]=E.Calendar.Hebrew,d[9]=E.Calendar.GregorianMEFrench,d[10]=E.Calendar.GregorianArabic,d[11]=E.Calendar.GregorianXlitEnglish,d[12]=E.Calendar.GregorianXlitFrench,d[22]=E.Calendar.Persian,d[23]=E.Calendar.UmAlQura,d)),ve=Object.keys(g.CultureTag).reduce((function(e,t){var r=g.CultureTag[t];return e[String(r)]=r,e}),Object.create(null));function ge(e){return e.toString(16).toUpperCase()}function be(e){return Number("0x"+e)}var Se=((f={})[m.PictureSingle.Hour]=_.TimeDivision.Hour,f[m.PictureSingle.HourTh]=_.TimeDivision.Hour,f[m.PictureSingle.Minute]=_.TimeDivision.Minute,f[m.PictureSingle.MinuteTh]=_.TimeDivision.Minute,f[m.PictureSingle.Second]=_.TimeDivision.Second,f[m.PictureSingle.SecondTh]=_.TimeDivision.Second,f);function ye(e){return 400===e.kind?e.formattedStr:void 0}var Oe={kind:ie.General};function Ce(e){return 1===e.length&&e[0].kind===ie.General}var Pe={code:[Oe],color:void 0,dbnum:void 0,dtrRounding:_.Rounding.RoundSec};function Ne(e){return void 0===e.color&&void 0===e.dbnum&&Ce(e.code)}function Re(e){return void 0===e.color&&void 0===e.dbnum&&(1===(t=e.code).length&&t[0].kind===m.PictureSingle.Text);var t}var ke={},Te=(0,v.createFailureErrorClass)("ApplyHashesError"),Ee=(0,v.createFailureErrorClass)("ApplyError"),_e=(0,v.createFailureErrorClass)("InitError"),Fe=function(){function e(e,t){this.config=e,this.hasPercent=!1,this.hasDate=!1,this.hasTime=!1,this.posBeforeText=!0,this.onlyOneNumberPart=!0,this.parts=[void 0,void 0,void 0,void 0],void 0===t.old?(this.logFormatString=(0,M.anonymizeFormulaString)(t.formatString),this.source=t.source,this.parseString(t.formatString)):(this.hasPercent=t.old.hasPercent,this.hasDate=t.old.hasDate,this.hasTime=t.old.hasTime,this.posBeforeText=t.old.posBeforeText,this.onlyOneNumberPart=t.old.onlyOneNumberPart,this.parts=t.synth,this.thisCurrCode=t.old.thisCurrCode,this.thisCurrencySymbol=t.old.thisCurrencySymbol,this.applyCurrCode=t.old.applyCurrCode,this.condPos=t.old.condPos,this.condNeg=t.old.condNeg,this.logFormatString=t.logFormatString,this.source=g.NumberFormatSource.CustomString,this.checkBytecode()),this.formatString=this.printFormatString(),this.valueType=this.determineValueType(),this.decimals=this.determineDecimals(),this.bidiDate=this.determineBidiDate()}return Object.defineProperty(e.prototype,"isPercent",{get:function(){return this.hasPercent},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isDate",{get:function(){return this.hasDate},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isTime",{get:function(){return this.hasTime},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isTextOnly",{get:function(){return!this.posBeforeText},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"culture",{get:function(){return this.thisCurrCode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currencySymbol",{get:function(){return this.thisCurrencySymbol},enumerable:!1,configurable:!0}),e.prototype.apply=function(e,t,r,n){try{return(0,A.success)(this.applyImpl(e,t,r,n))}catch(e){return e instanceof Ee?(0,A.failure)(e.reason):(0,A.failure)((0,A.javaScriptError)((0,C.prependErrorMessage)(e,"(while applying format ".concat(this.logFormatString,")"))))}},e.prototype.applyImpl=function(e,t,r,n){var i,a=this.config,o=a.mathpack,s=a.localeInfo;if(this.valueType===g.FormatValueType.General){var u=void 0;if((0,v.isStringOper)(e))return(0,g.formattedValue)([(0,g.formattedUnitString)(e.value)],u,t,r);if(!n&&0===o.cond(e))return(0,g.formattedValue)([],u,t,r);var c=(0,g.formattedUnitGeneral)(o.toNumber(e),s.decimalSeparator,!0,E.NumberShape.ASCII,E.NumberShape.ASCII,!0);return(0,g.formattedValue)([c],u,t,r)}for(var l=!1;;){var d=void 0;try{var f=void 0,p=!1,m=[];if((0,v.isStringOper)(e))f=3;else{var b=o.cond(e);void 0!==this.condPos||void 0!==this.condNeg?(f=(i=this.getPart(e)).partKind,p=i.forceNeg):f=b<0?1:b>0?0:2,b<0&&(this.onlyOneNumberPart||p)&&m.push((0,g.formattedUnitString)("-"))}u=(d=this.parts[f]).color;var S=d.dbnum,y=d.code,O=d.dtrRounding;if(!n&&2===f&&d===this.parts[0]&&!l)return(0,g.formattedValue)([],u,t,r);var C=this.getNumShape(S);this.applyPart({dtrRounding:O,dbnum:S,forceNeg:p,units:m,numShape:C},y,e,void 0);var P=r|(3!==f||Ne(d)||Re(d)?g.Clip.None:g.Clip.MaxChars),N=m.some(Z)?g.Alignment.Left:t;return(0,g.formattedValue)(Y(m),u,N,P)}catch(t){if(t===ke){(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: applyImpl restart",!(0,v.isStringOper)(e)&&0!==o.cond(e)),e=o.zero,l=!0;continue}if(t instanceof Te)return(0,g.hashesValue)(t.reason,null==d?void 0:d.color);throw t}}},e.prototype.applyPart=function(e,t,r,n){for(var i,a,o,s,u=this,c=this.config,l=c.mathpack,d=c.datepack,f=c.localeInfo,p=function(){var t,n;if(void 0!==s)return s;(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart getDtr value",!(0,v.isStringOper)(r));var i=u.config,a=i.date1904,o=i.dateCompatibility;if(!o&&l.cond(r)<0)throw new Te(g.dateOverflow);if(o&&!a&&l.cond(r)<0)throw new Te(g.dateOverflow);var c=d.fromNum(u.config,l.abs(r),e.dtrRounding);if(!1===c)throw new Te(g.dateOverflow);var f=null!==(n=null===(t=u.applyCurrCode)||void 0===t?void 0:t.calendar)&&void 0!==n?n:E.Calendar.Gregorian;if(f!==E.Calendar.Gregorian)throw new Ee((0,v.notImplemented)(["calendar: "+f]));return(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: components within range",c.yr>=0&&c.mon>=1&&c.mon<=12&&c.dom>=0&&c.dom<=31&&c.hour>=0&&c.hour<=23&&c.min>=0&&c.min<=59&&c.sec>=0&&c.sec<=59&&c.fracSec>=0&&c.wdy>=1&&c.wdy<=7),s=c},S=function(){if(void 0!==s)throw new Ee((0,v.notImplemented)(["use of value after date component"]));return r},y=!1,O=e.numShape,R=e.units,T=0;T<t.length;T+=1){var _=t[T];switch(_.kind){case ie.General:y=!0;var I=S();if((0,v.isStringOper)(I))R.push((0,g.formattedUnitString)(I.value));else{var M=l.abs(I);if(l.cond(I)<0&&"0"===l.formatGeneral(f,M,1))throw new Ee((0,v.notImplemented)(["potential LRestart in interval (-0.5,0)"]));var w=(0,g.formattedUnitGeneral)(l.toNumber(M),f.decimalSeparator,!1,O,this.getNumShape(void 0),this.valueType===g.FormatValueType.General);if(void 0!==e.dbnum){var D=(0,F.renderGeneral)(l,w,255);if(!(0,A.isSuccess)(D))throw new Ee(D.reason);(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart General renderRes",!1!==D.value),R.push((0,g.formattedUnitString)(D.value));break}R.push(w)}break;case m.PictureSingle.Text:var j=S();(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Text value",(0,v.isStringOper)(j)),R.push((0,g.formattedUnitString)(j.value));break;case ie.Exp:case m.PictureSingle.Slash:case 400:R.push((0,g.formattedUnitString)(_.formattedStr));break;case m.PictureSingle.Star:R.push((0,g.formattedUnitFlexible)(_.escaped));break;case m.PictureSingle.Underscore:R.push((0,g.formattedUnitBlank)(_.escaped));break;case ie.StrLit:R.push((0,g.formattedUnitString)(_.escaped));break;case m.PictureSingle.Percent:case ie.Numeral:R.push((0,g.formattedUnitString)(_.formattedStr));break;case ie.Currency:R.push((0,g.formattedUnitString)(f.currencySymbol));break;case ie.CurrCode:var x=_.currencySymbol,L=_.currCode;(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart system tag",!(0,g.isSystemCultureTag)(null==L?void 0:L.tag)),void 0!==x&&R.push((0,g.formattedUnitString)(x));break;case 405:R.push((0,g.formattedUnitString)(f.dateSeparator));break;case 406:_.printAsTimeSep?R.push((0,g.formattedUnitString)(f.timeSeparator)):R.push((0,g.formattedUnitString)(_.formattedStr));break;case 403:var B=S();(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Num value",!(0,v.isStringOper)(B)),(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Num numState",void 0===n);var U=_.numDigLeft,G=_.numDigDec,K=2*(ae=_.numPercent)-3*(oe=_.numThousands),V=l.formatFixed(B,K,G),W=V.mantissa,H=V.exponent;if((0,h.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Num mantissa || !exponent",0!==W.length||0===H),(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Num mantissa len",W.length<=H+G),l.cond(B)<0&&(this.onlyOneNumberPart||e.forceNeg)&&0===W.length)throw ke;this.applyPart(e,_.codeBefore,l.zero,void 0),this.applyPart(e,_.code,l.zero,{comma:_.comma,fractionDenom:!1,decimal:!1,digits:W,digitsExp:H,numDigLeft:U});break;case 402:var q=S();(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Exp value",!(0,v.isStringOper)(q)),(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Exp numState",void 0===n);var Y=_.numMantDigLeft,$=_.numMantDigDec,Z=0===Y&&0===$,X=l.formatScientific(q,Y,$);W=X.mantissa,H=X.exponent;(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Exp mantissa || !exponent",0!==W.length||0===H||Z);var ee=(0,P.formatScientificLeft)(H,Y);(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Exp mantissa len",W.length<=ee+$),this.applyPart(e,_.codeMant,l.zero,{comma:_.commaMant,fractionDenom:!1,decimal:!1,digits:W,digitsExp:ee,numDigLeft:_.numMantDigLeft}),this.applyPart(e,_.codeBetween,l.zero,void 0);var te=""!==W||Z?H-ee:0;te<0?R.push((0,g.formattedUnitString)("-")):_.isNeg||R.push((0,g.formattedUnitString)("+"));var re=J(l,l.fromNumber(te));this.applyPart(e,_.codeExp,l.zero,{comma:_.commaMant,fractionDenom:!1,decimal:!1,digits:re,digitsExp:re.length,numDigLeft:_.numExpDigLeft});break;case 401:var ne=S();(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Fraction value",!(0,v.isStringOper)(ne)),(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Fraction numState",void 0===n);var ae=_.numPercent,oe=_.numThousands,se=_.numIntDigLeft,ue=_.numNumerDig,ce=_.numDenomDig,le=_.commaInt,fe=_.denomValue,pe=(K=2*ae-3*oe,l.tenTo(K)),me=(0,v.isErrorOper)(pe)?pe:l.mul(l.abs(ne),pe);if((0,v.isErrorOper)(me))throw new Ee((0,v.notImplemented)(["overflow on fraction exp adjust"]));var he=function(e){for(var t=e;t<R.length;t+=1){var r=R[t];r.kind===g.FormattedUnitKind.String&&(R[t]=(0,g.formattedUnitBlank)(r.str))}},ve=_.anyZeroNumer,ge=void 0,be=void 0,ye=void 0;if(void 0!==_.codeInt){var Oe=l.trunc(me),Ce=l.sub(me,Oe);if((0,h.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart fracPart sub",(0,v.isNumberOper)(Ce)),ge=(i=this.formFraction(Ce,fe,ce)).numer,be=i.denom,(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart numer <= denom",l.cond2(ge,be)<=0),0===l.cond2(ge,be)){ge=l.zero;var Pe=l.add(Oe,l.one);(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart bumped error",(0,v.isNumberOper)(Pe)),Oe=Pe}0!==l.cond(ge)&&(ve=!0);var Ne=J(l,Oe),Re={comma:le,fractionDenom:!1,decimal:!1,digits:Ne,digitsExp:Ne.length,numDigLeft:se},_e=R.length;this.applyPart(e,_.codeInt,l.zero,Re),ye=R.length,(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Fraction lastDigInt",void 0!==_.lastDigInt),0!==l.cond(Oe)||!ve||_.lastDigInt===m.PictureSingle.Zero?this.applyPart(e,_.codeBetween1,l.zero,void 0):(_.lastDigInt!==m.PictureSingle.Question&&(R.length=_e),this.applyPart(e,_.codeBetween1,l.zero,void 0),he(_e),_.firstDigNumer!==m.PictureSingle.Question&&(R.length=_e))}else{if(ge=(a=this.formFraction(me,fe,ce)).numer,be=a.denom,l.cond(ne)<0&&(this.onlyOneNumberPart||e.forceNeg)&&0===l.cond(ge))throw ke;ve=!0,ye=R.length}var Fe=J(l,ge),Ie={comma:!1,fractionDenom:!1,decimal:!1,digits:Fe,digitsExp:Fe.length,numDigLeft:ue};this.applyPart(e,_.codeNumer,l.zero,Ie),this.applyPart(e,_.codeBetween2,l.zero,void 0);var Ae=J(l,be),Me={comma:!1,fractionDenom:!0,decimal:Ie.decimal,digits:Ae,digitsExp:Ae.length,numDigLeft:ce};this.applyPart(e,_.codeDenom,l.zero,Me),ve||(_.anyQuestionNumer||_.firstDigDenom===m.PictureSingle.Question?he(ye):R.length=ye);break;case m.PictureSingle.Decimal:(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart Decimal numState",void 0!==n),n.digitsExp>0&&(n.numDigLeft=n.digitsExp,this.dumpDigLeft(e,n,n.digitsExp)),n.decimal=!0,R.push((0,g.formattedUnitString)(f.decimalSeparator));break;case m.PictureSingle.Hash:case m.PictureSingle.Zero:case m.PictureSingle.Question:(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart H/Z/Q numState",void 0!==n);var we=_.count;if(n.decimal||n.fractionDenom&&_.kind===m.PictureSingle.Question){if(n.fractionDenom&&T!==t.length-1)throw new Ee((0,v.notImplemented)(["left-align bug in denominator"]));if(n.digitsExp<0){var De=(0,N.fastMin)(we,-n.digitsExp),je=(0,k.convertDigitsShape)((0,C.repeat)("0",De),O);R.push((0,g.formattedUnitString)(je)),n.digitsExp+=De,we-=De}var xe=(0,N.fastMin)(we,n.digits.length);je=(0,k.convertDigitsShape)(n.digits.substring(0,xe),O);if(R.push((0,g.formattedUnitString)(je)),n.digits=n.digits.substring(xe),we-=xe,_.kind!==m.PictureSingle.Hash&&we>0){je=(0,k.convertDigitsShape)((0,C.repeat)("0",we),O);R.push(_.kind===m.PictureSingle.Question?(0,g.formattedUnitBlank)(je):(0,g.formattedUnitString)(je))}break}if(n.numDigLeft>n.digitsExp){De=(0,N.fastMin)(we,n.numDigLeft-n.digitsExp);if(_.kind!==m.PictureSingle.Hash){je=(0,k.convertDigitsShape)((0,C.repeat)("0",De),O);n.comma&&(je=(0,k.insertCommas)(f,je,n.numDigLeft-De)),R.push(_.kind===m.PictureSingle.Question?(0,g.formattedUnitBlank)(je):(0,g.formattedUnitString)(je))}we-=De,n.numDigLeft-=De}else we+=n.digitsExp-n.numDigLeft,n.numDigLeft=n.digitsExp;this.dumpDigLeft(e,n,we);break;case ie.PrefixDigTh:f.isThai&&(O=e.numShape=E.NumberShape.Thai);break;case ie.LatinDate:throw new Ee((0,v.notImplemented)(["TokenKind.LatinDate"]));case ie.BidiDate:throw new Ee((0,v.notImplemented)(["TokenKind.BidiDate"]));case m.PictureSingle.HourTh:throw new Ee((0,v.notImplemented)(["PictureSingle.HourTh"]));case m.PictureSingle.MinuteTh:throw new Ee((0,v.notImplemented)(["PictureSingle.MinuteTh"]));case m.PictureSingle.SecondTh:throw new Ee((0,v.notImplemented)(["PictureSingle.SecondTh"]));case m.PictureSingle.Hour:case m.PictureSingle.Minute:case m.PictureSingle.Second:if(_.isAbs){var Le=S();(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart H/M/S value",!(0,v.isStringOper)(Le));var Be=d.toTime(this.config,l.abs(Le),Se[_.kind],e.dtrRounding);if(!1===Be)throw new Ee((0,v.notImplemented)(["absolute time overflow"]));R.push((0,g.formattedUnitString)(z(l,l.fromNumber(Be),_.count,O)))}else{var Ue=p(),Ge=void 0;_.kind===m.PictureSingle.Minute?Ge=Ue.min:_.kind===m.PictureSingle.Second?Ge=Ue.sec:(Ge=Ue.hour,_.isAMPM&&(Ge>12&&(Ge-=12),0===Ge&&(Ge=12))),R.push((0,g.formattedUnitString)(z(l,l.fromNumber(Ge),_.count,O)))}break;case ie.AMPM:case ie.AMPMFE:var Ke=void 0;if(Ke=!!(0,v.isStringOper)(r)||p().hour<12,(void 0===(null===(o=this.applyCurrCode)||void 0===o?void 0:o.culture)||_.kind===ie.AMPMFE)&&(_.kind===ie.AMPMFE||f.isEastAsia||_.pictureKind===m.PictureSpecial.AP2)){var Ve=de(f,_.tokenStr);R.push((0,g.formattedUnitString)(Ve[Ke?0:1]));break}var We=this.getBundledLocaleInfo("localised AM/PM string",this.applyCurrCode);R.push((0,g.formattedUnitString)(We.ampmSymbols[Ke?0:1]));break;case 404:var He=p();(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart FracSeconds rounding",He.rounding>=_.rounding);var qe=Q(l,l.fromNumber(He.fracSec),He.rounding,_.rounding,O);R.push((0,g.formattedUnitString)(f.decimalSeparator+qe));break;case m.PictureSingle.Era:throw new Ee((0,v.notImplemented)(["PictureSingle.Era"]));case m.PictureSingle.EraYear:throw new Ee((0,v.notImplemented)(["PictureSingle.EraYear"]));case m.PictureSingle.YearTh:throw new Ee((0,v.notImplemented)(["PictureSingle.YearTh"]));case m.PictureSingle.EngYearTh:throw new Ee((0,v.notImplemented)(["PictureSingle.EngYearTh"]));case m.PictureSingle.ThYear:throw new Ee((0,v.notImplemented)(["PictureSingle.ThYear"]));case m.PictureSingle.MonthTh:throw new Ee((0,v.notImplemented)(["PictureSingle.MonthTh"]));case m.PictureSingle.DayTh:throw new Ee((0,v.notImplemented)(["PictureSingle.DayTh"]));case m.PictureSingle.Year:var ze=p().yr;Ge=_.count>2?ze:ze%100;R.push((0,g.formattedUnitString)(z(l,l.fromNumber(Ge),_.count,O)));break;case m.PictureSingle.Month:var Qe=p().mon;switch(_.count){case 1:case 2:R.push((0,g.formattedUnitString)(z(l,l.fromNumber(Qe),_.count,O)));break;case 3:case 4:case 5:We=this.getBundledLocaleInfo("localised month string",this.applyCurrCode);if(3===_.count)R.push((0,g.formattedUnitString)(We.monthNameShort[Qe-1]));else if(4===_.count)R.push((0,g.formattedUnitString)(We.monthNameLong[Qe-1]));else{var Je=We.monthNameLong[Qe-1];R.push((0,g.formattedUnitString)(Je.substring(0,(0,b.numCodeUnits)((0,b.stringCodePointAt)(Je,0)))))}}break;case m.PictureSingle.Day:case m.PictureSingle.LocDay:if(_.count<3){var Ye=p().dom;R.push((0,g.formattedUnitString)(z(l,l.fromNumber(Ye),_.count,O)))}else{var $e=p().wdy,Ze=void 0;Ze=f.isEastAsia&&_.kind===m.PictureSingle.Day?(0,m.getEnglishLocaleInfo)():this.getBundledLocaleInfo("localised day string",this.applyCurrCode);je=3===_.count?Ze.dayNameShort[$e-1]:Ze.dayNameLong[$e-1];R.push((0,g.formattedUnitString)(je))}break;case 407:(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: applyPart SysFormat numState",void 0===n),this.applyPart(e,_.codeSysFormat,r,n);break;default:return(0,h.assertNever)("calc.numfmt.NumberFormatImpl: applyPart code",_)}}y&&S()},e.prototype.dumpDigLeft=function(e,t,r){var n=this.config.localeInfo,i=e.units,a=e.numShape,o=r,s=(0,N.fastMin)(o,t.digits.length),u=(0,k.convertDigitsShape)(t.digits.substring(0,s),a);if(t.comma&&(u=(0,k.insertCommas)(n,u,t.numDigLeft-s)),i.push((0,g.formattedUnitString)(u)),t.digits=t.digits.substring(s),o-=s,t.digitsExp-=s,t.numDigLeft-=s,o>0){u=(0,k.convertDigitsShape)((0,C.repeat)("0",o),a);t.comma&&(u=(0,k.insertCommas)(n,u,t.numDigLeft-o)),i.push((0,g.formattedUnitString)(u)),t.digitsExp-=o,t.numDigLeft-=o}},e.prototype.getPart=function(e){for(var t=this.config.mathpack,r=0;r<2;r+=1){var n=r,i=void 0;if(0===r){if(void 0===(i=this.condPos)&&t.cond(e)>0)return{partKind:n,forceNeg:!1}}else{if(this.parts[n]===this.parts[0])throw new Te(g.noFormatPart);if(0===this.parts[0].code.length)throw new Ee((0,v.notImplemented)(['emulation of ";[COND]foo" bug']));if(void 0===(i=this.condNeg)){if(this.parts[2]===this.parts[0])return(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: getPart condPos",void 0!==this.condPos),{partKind:n,forceNeg:t.cond(this.condPos.operand)>0||this.condPos.operator===y.OperatorId.Eq};if(t.cond(e)<0)return{partKind:n,forceNeg:!1}}}if(void 0!==i){var a=i.operator,o=i.operand,s=t.sub(e,o);if((0,v.isErrorOper)(s))throw new Ee((0,v.notImplemented)(["overflow in condition check"]));if((0,R.applyComparison)(a,t.cond2(e,o)))switch(a){case y.OperatorId.Eq:return{partKind:n,forceNeg:!1};case y.OperatorId.Ne:case y.OperatorId.Gt:case y.OperatorId.Ge:return{partKind:n,forceNeg:!0};case y.OperatorId.Lt:return{partKind:n,forceNeg:t.cond(o)>0};case y.OperatorId.Le:return{partKind:n,forceNeg:t.cond(o)>=0}}}}if(this.parts[2]===this.parts[0])throw new Te(g.noFormatPart);return{partKind:2,forceNeg:!0}},e.prototype.getNumShape=function(e){var t=this.applyCurrCode,r=null==t?void 0:t.numberShape;if(void 0!==r)return r;if(void 0===e)return E.NumberShape.ASCII;var n=this.getBundledLocaleInfo("localised DBNUM culture",t);return n.isEastAsia&&(n.isKorea?r=re[e]:n.isJapan?r=te[e]:n.isChinaT?r=X[e]:n.isChinaS&&(r=ee[e])),null!=r?r:E.NumberShape.ASCII},e.prototype.formFraction=function(e,t,r){var n,i,a,o=this.config.mathpack;if(void 0!==t){var s=o.fromNumber(137438953472);if((0,v.isErrorOper)(o.sub(e,s)))throw new Ee((0,v.notImplemented)(["overflow in fraction threshold check"]));if(o.cond2(e,s)<0){var u=o.mul(e,o.fromNumber(1.0000000000000002));(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: formFraction nudged error",(0,v.isNumberOper)(u)),e=u}var c=t,l=o.toNumber(c)<<1,d=o.mul(e,o.fromNumber(l));if(!(0,v.isNumberOper)(d))throw new Ee((0,v.notImplemented)(["overflow in fraction denom mul"]));var f=o.lfix(d);if(f<0||f>=65535)throw new Te(g.fractionOverflow);return{numer:o.fromNumber(f+1>>1),denom:c}}switch(r){case 1:a=10;break;case 2:a=100;break;case 3:a=1e3;break;case 4:a=1e4;break;case 5:a=1e5;break;case 6:a=1e6;break;default:a=1e7}var p=o.fix(e);if(p>=2147483647)throw new Te(g.fractionOverflow);for(var m=e,b=1,S=1,y=0,O=0;;){var C=b*p;O+=C;var P=y*p;if(S+=P,C>2147483647||P>2147483647||S>=a){1===y&&2===p&&0===o.cond2(m,o.trunc(m))&&(b+=1);break}b=(n=[O,b])[0],O=n[1],y=(i=[S,y])[0],S=i[1];var N=o.sub(m,o.trunc(m));if((0,h.assertTrue)("calc.numfmt.NumberFormatImpl: formFraction frac sub",(0,v.isNumberOper)(N)),0===o.cond(N))break;var R=o.div(o.one,N);if((0,v.isErrorOper)(R))throw new Ee((0,v.notImplemented)(["overflow in fraction inversion"]));if(m=R,(p=o.fix(m))>2147483647)break}return 0===y&&(y=b=1),{numer:o.fromNumber(b),denom:o.fromNumber(y)}},e.prototype.synthesizeDecimals=function(t){for(var r=this,n=(0,N.fastMax)(0,(0,N.fastMin)(t,127)),i=[],a=function(e){var t=o.parts[e];if((1===e||2===e)&&t===o.parts[0])return i.push(i[0]),"continue";if(3===e)return i.push(t===o.parts[0]?i[0]:t),"continue";var a=t.code,s=t.color,u=t.dbnum,c=t.dtrRounding,l={code:a.map((function(t){if(403===t.kind){var i=t.numDigLeft,a=t.numPercent,o=t.numThousands,s=t.comma,u=t.codeBefore;return{kind:403,numDigLeft:i,numDigDec:n,numPercent:a,numThousands:o,comma:s,code:r.adjustDecimals(e,t.numDigDec,t.code,n),codeBefore:u}}if(402===t.kind){var c=t.isNeg,l=t.numMantDigLeft,d=t.numExpDigLeft,f=t.commaMant,p=t.codeBetween,m=t.codeExp;return{kind:402,isNeg:c,numMantDigLeft:l,numMantDigDec:n,numExpDigLeft:d,commaMant:f,codeMant:r.adjustDecimals(e,t.numMantDigDec,t.codeMant,n),codeBetween:p,codeExp:m}}return t})),color:s,dbnum:u,dtrRounding:c};i.push(l)},o=this,s=0;s<=3;s+=1)a(s);try{var u=new e(this.config,{old:this,logFormatString:"synthesizeDecimals(dec=".concat(n," on ").concat(this.logFormatString,")"),synth:i});if(u.formatString.length>255)throw new _e(this.notFormatString("format string too long: max length"));return u}catch(e){if(e instanceof _e)return this;throw e}},e.prototype.adjustDecimals=function(e,t,r,n){var i;if(n===t)return r;for(var a=!1,o=void 0,s=void 0,u=void 0,c=0;c<r.length;c+=1){switch((O=r[c]).kind){case m.PictureSingle.Decimal:void 0===u&&(u=c);break;case m.PictureSingle.Hash:case m.PictureSingle.Question:case m.PictureSingle.Zero:void 0!==u?s=c:(o=c,O.kind===m.PictureSingle.Question&&(a=!0))}}var l=function(e){return e===m.PictureSingle.Percent||e===ie.Currency||e===ie.CurrCode||e===m.PictureSingle.Star};if(0===n){if(void 0===u)return r;var d=0,f=0;void 0===o?void 0!==s&&(d=u+1,f=s+1):(d=u,f=(null!=s?s:u)+1);var v=r.slice(0,d);for(c=d;c<f;c+=1)l(r[c].kind)&&v.push(r[c]);return(0,N.safePush)(v,r.slice(f)),v}if(t>n){(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: adjustDecimals dec",void 0!==u);var g=void 0;!function(e){e[e.AfterDigs=0]="AfterDigs",e[e.Dropping=1]="Dropping",e[e.Keeping=2]="Keeping"}(g||(g={}));var b=g.AfterDigs,S=[],y=t-n;for(c=r.length-1;c>=0;c-=1){c<=u&&(b=g.Keeping);var O=r[c];if(b===g.AfterDigs&&(O.kind!==m.PictureSingle.Hash&&O.kind!==m.PictureSingle.Question&&O.kind!==m.PictureSingle.Zero||(b=g.Dropping)),b===g.Keeping||b===g.AfterDigs||l(O.kind))S.push(O);else if(O.kind===m.PictureSingle.Hash||O.kind===m.PictureSingle.Question||O.kind===m.PictureSingle.Zero){var C=(0,N.fastMin)(y,O.count);C<O.count&&S.push({kind:O.kind,count:O.count-C}),0===(y-=C)&&(b=g.Keeping)}}return S.reverse(),S}if(2===e&&a&&void 0===s)return r;var P=n-t;if(void 0!==s){var R=r.slice();O=R[s];return R[s]={kind:O.kind,count:O.count+P},R}var k=r.slice(),T=null!==(i=null!=u?u:o)&&void 0!==i?i:k.length-1,E=[];return void 0===u&&E.push({kind:m.PictureSingle.Decimal}),E.push({kind:m.PictureSingle.Zero,count:P}),k.splice.apply(k,p.__spreadArray([T+1,0],E,!1)),k},e.prototype.parseString=function(e){if(this.source!==g.NumberFormatSource.CustomBytecode&&e.length>255)throw new _e(this.notFormatString("format string too long: max length"));for(var t=!1,r=!1,n=0,i=!1,a=0;a<=3&&!i;a+=1){var o=this.tokenize(e.substring(n)),s=o.cond,u=o.currencySymbol,c=this.convertTokToSun(o),l=c.currCode,d=c.hasPercent,f=c.hasDate,p=c.hasTime,m=this.classifySunPartKind(c,3===a?3:0),b=this.convertSunToCode(c),S=b.part,y=b.applyCurrCode;if(n+=o.consumed,i=o.eos,d&&(this.hasPercent=!0),f&&(this.hasDate=!0),p&&(this.hasTime=!0),void 0!==l){if(0!==a&&(void 0===this.thisCurrCode||!(0,g.isFormatCultureEqual)(this.thisCurrCode,l)))throw new _e((0,v.notImplemented)(["inconsistent CurrCode in number parts"]));void 0===this.thisCurrCode&&(this.thisCurrCode=l)}if(void 0!==y&&void 0===this.applyCurrCode&&(this.applyCurrCode=y),void 0!==u&&void 0===this.thisCurrencySymbol&&(this.thisCurrencySymbol=u),this.source===g.NumberFormatSource.System&&((0,h.assertTrue)("calc.numfmt.NumberFormatImpl.parseString: system ipart",0===a),!i||3===m))throw new _e(this.notFormatString("system format with more than one part"));if((3===m||0===a&&1===m)&&(t=!0,this.parts[3]=S,3===m)){if(void 0!==s)throw new _e(this.notFormatString("condition in text part"));if(void 0!==l)throw new _e((0,v.notImplemented)(["CurrCode in text part"]));break}if(r=!0,this.parts[a]=S,this.onlyOneNumberPart=0===a,0===a)this.parts[1]=S,this.parts[2]=S,this.condPos=s;else if(1===a)this.condNeg=s;else if(void 0!==s)throw new _e(this.notFormatString("condition in zero part"))}if(!i)throw new _e(this.notFormatString("too many parts"));r||(this.parts[0]=Pe,this.parts[1]=Pe,this.parts[2]=Pe,this.posBeforeText=!1),t||(this.parts[3]=Pe),r&&!t&&this.onlyOneNumberPart&&void 0!==this.condPos&&!Ce(this.parts[0].code)&&(this.parts[1]=Pe,this.onlyOneNumberPart=!1),(0,h.assertTrue)("calc.numfmt.NumberFormatImpl.parseString: every part set",this.parts.every((function(e){return void 0!==e}))),this.checkBytecode()},e.prototype.tokenize=function(e){for(var t,r,n,i=this.config.localeInfo,a={color:void 0,dbnum:void 0,dbnumForbidden:!1,cond:void 0,currCode:void 0,currencySymbol:void 0,tokens:[],consumed:0,eos:!0};a.consumed<e.length&&a.eos;){var o=this.readToken(a,e,a.consumed),s=t;switch(t=o,a.consumed+=o.tokenStr.length,o.kind){case m.PictureSingle.Sep:a.eos=!1;continue;case ie.Color:if(void 0!==a.color)throw new _e(this.notFormatString("more than one color"));if(0!==a.tokens.length)throw new _e((0,v.notImplemented)(["colour in middle of format"]));a.color=o.color;continue;case ie.Dbnum:if(void 0!==a.dbnum)throw new _e(this.notFormatString("more than one DBNUM"));if(a.dbnumForbidden)throw new _e(this.notFormatString("DBNUM after token which forbids it (% or E)"));if(0!==a.tokens.length)throw new _e((0,v.notImplemented)(["DBNUM in middle of format"]));a.dbnum=o.dbnum;continue;case ie.Cond:if(void 0!==a.cond)throw new _e(this.notFormatString("more than one condition"));if(0!==a.tokens.length)throw new _e((0,v.notImplemented)(["condition in middle of format"]));a.cond=o.cond;continue;case ie.CurrCode:if(void 0!==r)throw new _e(this.notFormatString("more than one currency code in section"));r=o;break;case ie.Currency:n=o;break;case ie.AMPM:case ie.AMPMFE:case m.PictureSingle.Colon:case m.PictureSingle.DateSep:case ie.LatinDate:case ie.BidiDate:case m.PictureSingle.Year:case m.PictureSingle.Month:case m.PictureSingle.Day:case m.PictureSingle.Hour:case m.PictureSingle.Minute:case m.PictureSingle.Second:case m.PictureSingle.Reign:case m.PictureSingle.LocDay:case m.PictureSingle.Era:case m.PictureSingle.EraYear:case m.PictureSingle.EngYearTh:case m.PictureSingle.DayTh:case m.PictureSingle.MonthTh:case m.PictureSingle.YearTh:case m.PictureSingle.ThYear:case m.PictureSingle.HourTh:case m.PictureSingle.MinuteTh:case m.PictureSingle.SecondTh:if((null==s?void 0:s.kind)===o.kind){s.count+=o.count;continue}}a.tokens.push(o)}return void 0!==r?(a.currCode=r.currCode,a.currencySymbol=r.currencySymbol):void 0!==n&&void 0===a.currencySymbol&&(a.currencySymbol=g.FormatCurrency.LocaleInfo),4!==a.dbnum||i.isKorea||void 0===a.currCode&&!i.isThai||(a.dbnum=void 0),a},e.prototype.readToken=function(e,t,r){var n=this.config,i=n.mathpack,a=n.localeInfo,o=ue(a,a.pictureSpecial,t,r);if(void 0!==o){var s=o,u=le(a.pictureSpecial,s);a.isJapan&&s===m.PictureSpecial.GeneralOldMAC&&(s=m.PictureSpecial.General);var c=t.substring(r,r+u.length);switch(s){case m.PictureSpecial.AP1:case m.PictureSpecial.AP2:return{kind:ie.AMPM,tokenStr:c,count:1,pictureKind:s};case m.PictureSpecial.AP3:return{kind:ie.AMPMFE,tokenStr:c,count:1};case m.PictureSpecial.General:return{kind:ie.General,tokenStr:c};case m.PictureSpecial.Currency:return{kind:ie.Currency,tokenStr:c}}}var l,d=(0,b.stringCodePointAt)(t,r),f=(0,b.numCodeUnits)(d),g=t.substring(r,r+f),S=ce(a,a.pictureSingle,t,r);if(void 0!==S){s=S;if((a.isJapan||a.isChinaT)&&(s===m.PictureSingle.E||s===m.PictureSingle.EraYear)){var y=void 0,P=void 0;s=!(r+f+1<t.length)||(y=t.charCodeAt(r+f))!==D&&y!==j||(P=t.charCodeAt(r+f+1))!==x&&P!==L&&P!==B?m.PictureSingle.EraYear:m.PictureSingle.E}if(s===m.PictureSingle.BidiDate||s===m.PictureSingle.EngYearTh){y=void 0;if(r+f<t.length&&((y=t.charCodeAt(r+f))===U||y===G))return{kind:y===U?ie.LatinDate:ie.BidiDate,tokenStr:t.substring(r,r+f+1),count:1};s=m.PictureSingle.EngYearTh}if(s===m.PictureSingle.BidiNum)throw new _e(this.notFormatString("bidi num not allowed"));switch(s){case m.PictureSingle.Star:case m.PictureSingle.Underscore:if(r+f>=t.length)throw new _e(this.notFormatString("unterminated "+g));y=(0,b.stringCodePointAt)(t,r+f);var N=(0,b.numCodeUnits)(y),R=(0,b.stringFromCodePoint)(y);return{kind:s,tokenStr:c=t.substring(r,r+f+N),escaped:R};case m.PictureSingle.Backslash:return this.readToken_Backslash(t,r,f);case m.PictureSingle.Quote:var k=t.indexOf(g,r+f);if(k<0)throw new _e(this.notFormatString("unterminated quoted string"));var T=t.substring(r+f,k),_=(c=t.substring(r,k+f),ue(a,a.pictureSpecial,T,0));return void 0!==_&&_===m.PictureSpecial.Currency&&le(a.pictureSpecial,_).length===T.length?{kind:ie.Currency,tokenStr:c}:{kind:ie.StrLit,tokenStr:c,escaped:T};case m.PictureSingle.E:if(a.isEastAsia){if(void 0!==e.dbnum)throw new _e(this.notFormatString("invalid DBNUM with exp"));if(e.dbnumForbidden)throw new _e((0,v.notImplemented)(["multiple DBNUM-forbidden tokens (% or E)"]));e.dbnumForbidden=!0}if(r+f>=t.length)throw new _e(this.notFormatString("unterminated exp"));if((y=t.charCodeAt(r+f))!==j&&y!==D)throw new _e(this.notFormatString("exp not followed by sign"));c=t.substring(r,r+f+1);return{kind:ie.Exp,tokenStr:c,eStr:g,isNeg:y===D};case m.PictureSingle.Hash:case m.PictureSingle.Year:case m.PictureSingle.Month:case m.PictureSingle.Day:case m.PictureSingle.Hour:case m.PictureSingle.Minute:case m.PictureSingle.Second:case m.PictureSingle.YearTh:case m.PictureSingle.MonthTh:case m.PictureSingle.DayTh:case m.PictureSingle.HourTh:case m.PictureSingle.MinuteTh:case m.PictureSingle.SecondTh:case m.PictureSingle.EngYearTh:case m.PictureSingle.ThYear:case m.PictureSingle.Question:case m.PictureSingle.Comma:case m.PictureSingle.Reign:case m.PictureSingle.LocDay:case m.PictureSingle.Era:case m.PictureSingle.EraYear:if(s===m.PictureSingle.Reign&&!a.isJapan&&!a.isChinaT)break;for(var F=f,I=1;(0,C.stringStartsWith)(t,g,r+F)&&void 0===ue(a,a.pictureSpecial,t,r+F);)F+=f,I+=1;if(s===m.PictureSingle.LocDay&&I<3)break;return{kind:s,tokenStr:c=t.substring(r,r+F),count:I};case m.PictureSingle.Sep:case m.PictureSingle.Text:case m.PictureSingle.Decimal:case m.PictureSingle.Slash:case m.PictureSingle.Minus:case m.PictureSingle.Plus:return{kind:s,tokenStr:g};case m.PictureSingle.Space:return{kind:ie.Char,tokenStr:g,escaped:g};case m.PictureSingle.Colon:return{kind:s,tokenStr:g,count:1};case m.PictureSingle.Percent:if(a.isEastAsia){if(void 0!==e.dbnum)throw new _e(this.notFormatString("invalid DBNUM with pct"));if(e.dbnumForbidden)throw new _e((0,v.notImplemented)(["multiple DBNUM-forbidden tokens (% or E)"]));e.dbnumForbidden=!0}return{kind:m.PictureSingle.Percent,tokenStr:g};case m.PictureSingle.DateSep:return g===le(a.pictureSingle,m.PictureSingle.Slash)?{kind:m.PictureSingle.Slash,tokenStr:g}:g===le(a.pictureSingle,m.PictureSingle.Minus)?{kind:m.PictureSingle.Minus,tokenStr:g}:{kind:m.PictureSingle.DateSep,tokenStr:g,count:1};case m.PictureSingle.ColorStart:var A=le(a.pictureSingle,m.PictureSingle.ColorEnd),M=t.indexOf(A,r+f);if(M<0)throw new _e(this.notFormatString("unterminated ["));var w=t.substring(r+f,M),q=(c=t.substring(r,M+A.length),ue(a,ae,w,0));if(void 0!==q){for(var z=le(ae,q).length;z<w.length&&(0,O.isSpace)(w.charCodeAt(z));)z+=1;var Q=(0,O.parseSignedLiteral)(a,i,w,z,!1);if(Q[1]===z)throw new _e((0,v.notImplemented)(["invalid number in condition"]));if(Q[1]!==w.length)throw new _e((0,v.notImplemented)(["trailing junk after condition"]));return{kind:ie.Cond,tokenStr:c,cond:{operator:oe[q],operand:Q[0]}}}var J=ue(a,a.pictureColor,w,0);if(void 0!==J){var Y=le(a.pictureColor,J);if(J!==m.PictureColor.Color){if(Y.length!==w.length)throw new _e((0,v.notImplemented)(["trailing junk after named color"]));return{kind:ie.Color,tokenStr:c,color:(l=J,m.PictureColor[l])}}if(J===m.PictureColor.Color){for(var $=Y.length;$<w.length&&(0,O.isSpace)(w.charCodeAt($));)$+=1;var Z=(0,O.parseUint)(a,4,w,$),X=Z[0],ee=Z[1];if(ee===$)throw new _e(this.notFormatString("missing number for numbered color"));if(ee!==w.length)throw new _e((0,v.notImplemented)(["trailing junk after numbered color"]));if(X<1||X>56)throw new _e(this.notFormatString("out-of-range numbered color"));return{kind:ie.Color,tokenStr:c,color:X+8}}}var te=ue(a,a.pictureDbnum,w,0);if(void 0!==te){if(le(a.pictureDbnum,te).length!==w.length)throw new _e((0,v.notImplemented)(["trailing junk after DBNUM"]));return{kind:ie.Dbnum,tokenStr:c,dbnum:ne(te)}}return(0,C.stringStartsWith)(w,"$")?p.__assign({kind:ie.CurrCode,tokenStr:c},this.parseCurrCode(w.substring("$".length))):{kind:s,tokenStr:g};case m.PictureSingle.ColorEnd:return{kind:s,tokenStr:g};case m.PictureSingle.OpenParen:case m.PictureSingle.CloseParen:return{kind:s,tokenStr:g,escaped:g};case m.PictureSingle.Extra:case m.PictureSingle.APDelim:case m.PictureSingle.Nen1:case m.PictureSingle.Gatsu1:case m.PictureSingle.Nichi1:case m.PictureSingle.Nen2:case m.PictureSingle.Gatsu2:case m.PictureSingle.Nichi2:break;case m.PictureSingle.Zero:case m.PictureSingle.ZeroTh:break;default:return(0,h.assertNever)("calc.numfmt.NumberFormatImpl: readToken single picKind",s)}}if(a.isNumeral(d)){if(a.getNumberShape(d)!==E.NumberShape.ASCII)throw new _e((0,v.notImplemented)(["non-ASCII digits"]));var re=a.getOrdinal(d);if(0===re){var se=f;for(I=1;(0,C.stringStartsWith)(t,g,r+se);)se+=f,I+=1;c=t.substring(r,r+se);return{kind:m.PictureSingle.Zero,tokenStr:c,count:I}}return{kind:ie.Numeral,tokenStr:g,ordinal:re}}switch(d){case K:return{kind:m.PictureSingle.OpenParen,tokenStr:g,escaped:g};case V:return{kind:m.PictureSingle.CloseParen,tokenStr:g,escaped:g};case H:return this.readToken_Backslash(t,r,f);case W:if(a.isThai)return{kind:ie.PrefixDigTh,tokenStr:g}}return{kind:ie.Char,tokenStr:g,escaped:g}},e.prototype.readToken_Backslash=function(e,t,r){if(t+r>=e.length)throw new _e(this.notFormatString("unterminated backslash"));var n=(0,b.stringCodePointAt)(e,t+r),i=(0,b.numCodeUnits)(n),a=(0,b.stringFromCodePoint)(n),o=e.substring(t,t+r+i);return n===K||n===V?{kind:n===K?m.PictureSingle.OpenParen:m.PictureSingle.CloseParen,tokenStr:o,escaped:a}:{kind:ie.Char,tokenStr:o,escaped:a}},e.prototype.convertTokToSun=function(e){var t,r,n,i,a,o,s,u=this,c=e.color,l=e.dbnum,d=e.cond,f=e.currCode,p=e.tokens,g=this.config.localeInfo,b={suns:[],dtrRounding:_.Rounding.RoundSec,color:c,dbnum:l,currCode:f,hasPercent:!1,hasDate:!1,hasTime:!1,get isEmpty(){return 0===this.suns.length&&void 0===d&&void 0===c&&void 0===l&&void 0===f}},S=0===g.stringCompareCI(le(g.pictureSingle,m.PictureSingle.Month),le(g.pictureSingle,m.PictureSingle.Minute)),y=!1,O=0,C=0,P=!1,R=!1,k=!1,T=!1,E=0,F=function(e,t){var n=Se[e];if(t){if(R)throw new _e(u.notFormatString("more than one absolute time"));if(void 0!==r&&n>=r)throw new _e(u.notFormatString("absolute time must be largest division"));R=!0}else if(R&&n<=r)throw new _e((0,v.notImplemented)(["larger time division after absolute time"]));(void 0===r||n<r)&&(r=n)};function I(e,t,n){var i=r;if(F(e,t),e===m.PictureSingle.Hour||e===m.PictureSingle.HourTh)k=!0,a=n,o=void 0;else if(e===m.PictureSingle.Second||e===m.PictureSingle.SecondTh)if(void 0===o||R)void 0===i&&(k=!0);else{var s=o.code[0];(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: onTime ambigCode",s.kind===m.PictureSingle.Month);var u=m.PictureSingle.Minute,c=s.count;(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: onTime ambigCount",1===c||2===c);F(u,!1),O-=1,C+=1,o.code=[{kind:u,count:c,isAbs:!1}],o=void 0}else k=!1}function A(e){var t=le(g.pictureSingle,e.kind);return{kind:406,printAsTimeSep:O>0||C>0,formattedStr:t}}function M(e){var t=le(g.pictureSingle,e.kind);return t===le(g.pictureSingle,m.PictureSingle.DateSep)?{kind:405}:t===le(g.pictureSingle,m.PictureSingle.Colon)?A(e):{kind:400,formattedStr:t}}for(var w=0;w<p.length;w+=1){var D=p[w];switch(D.kind){case ie.AMPM:case ie.AMPMFE:case m.PictureSingle.Colon:case m.PictureSingle.DateSep:case m.PictureSingle.Year:case m.PictureSingle.Month:case m.PictureSingle.Day:case m.PictureSingle.Hour:case m.PictureSingle.Minute:case m.PictureSingle.Second:case m.PictureSingle.Reign:case m.PictureSingle.LocDay:case m.PictureSingle.Era:case m.PictureSingle.EraYear:case m.PictureSingle.EngYearTh:case ie.LatinDate:case ie.BidiDate:case m.PictureSingle.DayTh:case m.PictureSingle.MonthTh:case m.PictureSingle.YearTh:case m.PictureSingle.ThYear:case m.PictureSingle.HourTh:case m.PictureSingle.MinuteTh:case m.PictureSingle.SecondTh:var j={kind:1,code:[]};switch(b.suns.push(j),P=!0,D.kind){case ie.LatinDate:case ie.BidiDate:if(0!==w)throw new _e(this.notFormatString("bidi date must be first"));j.code.push(D);break;case m.PictureSingle.DateSep:j.code.push({kind:405});break;case m.PictureSingle.Colon:j.code.push(A(D));break;case m.PictureSingle.Reign:O+=1,g.isJapan&&D.count>=2&&j.code.push({kind:m.PictureSingle.Era,count:3}),j.code.push({kind:m.PictureSingle.EraYear,count:g.isChinaT?1:2});break;case m.PictureSingle.Era:O+=1,j.code.push({kind:m.PictureSingle.Era,count:(0,N.fastMin)(3,D.count)});break;case m.PictureSingle.EraYear:O+=1,j.code.push({kind:m.PictureSingle.EraYear,count:(0,N.fastMin)(2,D.count)});break;case m.PictureSingle.Year:case m.PictureSingle.YearTh:case m.PictureSingle.EngYearTh:case m.PictureSingle.ThYear:o=void 0,O+=1,j.code.push({kind:D.kind,count:D.count<=2?2:4});break;case m.PictureSingle.Month:if(S&&D.count<=2){if(k){I(Z=m.PictureSingle.Minute,x=!1,j),C+=1,j.code.push({kind:Z,count:D.count,isAbs:x}),k=!1;break}o=j}else o=void 0;O+=1,j.code.push({kind:D.kind,count:(0,N.fastMin)(5,D.count)});break;case m.PictureSingle.MonthTh:O+=1,j.code.push({kind:D.kind,count:(0,N.fastMin)(4,D.count)});break;case m.PictureSingle.Day:case m.PictureSingle.DayTh:o=void 0,O+=1,j.code.push({kind:D.kind,count:(0,N.fastMin)(4,D.count)});break;case m.PictureSingle.LocDay:o=void 0,O+=1,j.code.push({kind:m.PictureSingle.LocDay,count:3===D.count?3:4});break;case m.PictureSingle.Hour:case m.PictureSingle.HourTh:case m.PictureSingle.Minute:case m.PictureSingle.MinuteTh:case m.PictureSingle.Second:case m.PictureSingle.SecondTh:var x=!1;I(D.kind,x,j),C+=1;var L=(0,N.fastMin)(2,D.count);D.kind===m.PictureSingle.Hour||D.kind===m.PictureSingle.HourTh?j.code.push({kind:D.kind,count:L,isAbs:x,isAMPM:!1}):j.code.push({kind:D.kind,count:L,isAbs:x});break;case ie.AMPM:case ie.AMPMFE:if(R)throw new _e(this.notFormatString("AM/PM after absolute time"));if(D.count>1)throw new _e((0,v.notImplemented)(["multiple AM/PM symbols"]));if(void 0!==a)(q=a.code[0]).isAMPM=!0,a=void 0;T=!0,j.code.push(D);break;default:return(0,h.assertNever)("calc.numfmt.NumberFormatImpl: convertTokToSun tok as date",D)}break;case m.PictureSingle.Decimal:case ie.Numeral:case m.PictureSingle.Hash:case m.PictureSingle.Zero:case m.PictureSingle.Question:case m.PictureSingle.Comma:if(P){if(D.kind!==m.PictureSingle.Decimal&&D.kind!==m.PictureSingle.Comma)throw new _e(this.notFormatString("number picture in date/time format"));var B={kind:1,code:[]};b.suns.push(B);var U=p[w+1];if(D.kind===m.PictureSingle.Decimal&&(null==U?void 0:U.kind)===m.PictureSingle.Zero){var G=U.count;if(G>3)throw new _e(this.notFormatString("invalid number of fractional seconds"));w+=1,I(m.PictureSingle.Second,!1,B),C+=1,B.code.push({kind:404,rounding:G}),b.dtrRounding=(0,N.fastMax)(b.dtrRounding,G)}else B.code.push(M(D));break}if(D.kind===m.PictureSingle.Comma){var K={kind:7,code:[{kind:400,formattedStr:le(g.pictureSingle,D.kind)}]};b.suns.push(K);break}j={kind:0,code:[],numDigLeft:0,numDigDec:0,numPercent:0,numThousands:0,comma:!1,decimal:!1,numVal:!1,nonZero:!1,get digitTokens(){return this.anyHash||this.anyQuestion},get reallyNum(){return this.anyHash||this.anyQuestion||this.anyZero},lastDig:void 0,firstDig:void 0,anyHash:!1,anyQuestion:!1,anyZero:!1};b.suns.push(j),void 0===n&&(n=j),i=j;var V=void 0;for(w-=1;w+1<p.length;w+=1){var W=p[w+1],H=!0;switch(W.kind){case m.PictureSingle.Decimal:y=j.decimal=!0,j.code.push(W),V=void 0;break;case ie.Numeral:j.code.push({kind:W.kind,formattedStr:W.tokenStr,ordinal:W.ordinal}),j.numVal=j.nonZero=!0,V=void 0;break;case m.PictureSingle.Hash:case m.PictureSingle.Zero:case m.PictureSingle.Question:if(j.decimal?j.numDigDec+=W.count:j.numDigLeft+=W.count,void 0===j.firstDig&&(j.firstDig=W.kind),j.lastDig=W.kind,W.kind===m.PictureSingle.Hash?j.anyHash=!0:W.kind===m.PictureSingle.Question?j.anyQuestion=!0:(j.anyZero=!0,j.numVal=!0),void 0!==V&&V.kind===W.kind)V.count+=W.count;else{var q={kind:W.kind,count:W.count};j.code.push(q),V=q}break;case m.PictureSingle.Comma:U=null===(t=p[w+2])||void 0===t?void 0:t.kind;if((s=U)!==ie.Numeral&&s!==m.PictureSingle.Hash&&s!==m.PictureSingle.Zero&&s!==m.PictureSingle.Question){L=W.count;var z=le(g.pictureSingle,m.PictureSingle.Space);z===le(g.pictureSingle,m.PictureSingle.Comma)&&(!g.isCurrencySymbolLead&&g.isCurrencySepBySpace&&U===ie.Currency||g.isPercentSepBySpace&&U===m.PictureSingle.Percent)&&(j.code.push({kind:400,formattedStr:z}),L-=1),L>0&&(j.numThousands+=L)}else y||(j.comma=!0);break;default:H=!1}if(!H)break}break;case m.PictureSingle.Percent:E+=1;j={kind:3,code:[{kind:m.PictureSingle.Percent,formattedStr:D.tokenStr}]};b.suns.push(j),b.hasPercent=!0;break;case ie.Exp:j={kind:4,code:[{kind:ie.Exp,formattedStr:D.eStr,isNeg:D.isNeg}],isNeg:D.isNeg};b.suns.push(j);break;case ie.General:j={kind:6,code:[D]};b.suns.push(j);break;case m.PictureSingle.Text:j={kind:5,code:[D]};b.suns.push(j);break;case m.PictureSingle.Slash:if(P){var Q={kind:1,code:[M(D)]};b.suns.push(Q);break}j={kind:2,code:[{kind:m.PictureSingle.Slash,formattedStr:D.tokenStr}]};b.suns.push(j);break;case m.PictureSingle.Star:case ie.PrefixDigTh:case m.PictureSingle.Underscore:case ie.Currency:case ie.CurrCode:case ie.StrLit:j={kind:7,code:[D]};b.suns.push(j);break;case m.PictureSingle.ColorEnd:case m.PictureSingle.Plus:j={kind:7,code:[{kind:400,formattedStr:D.tokenStr}]};b.suns.push(j);break;case m.PictureSingle.OpenParen:case m.PictureSingle.CloseParen:case ie.Char:j={kind:7,code:[{kind:400,formattedStr:D.escaped}]};b.suns.push(j);break;case m.PictureSingle.Minus:if(P){var J={kind:1,code:[M(D)]};b.suns.push(J);break}j={kind:7,code:[{kind:400,formattedStr:le(g.pictureSingle,D.kind)}]};b.suns.push(j);break;case m.PictureSingle.ColorStart:var Y=0;for(j={kind:1,code:[]};w+1<p.length&&2!==Y;w+=1){var $=p[w+1];switch($.kind){case m.PictureSingle.ColorEnd:if(1!==Y)throw new _e(this.notFormatString("unexpected closing ]"));Y=2;continue;case m.PictureSingle.Hour:case m.PictureSingle.Month:case m.PictureSingle.Minute:case m.PictureSingle.Second:if($.kind===m.PictureSingle.Month&&!S)break;var Z;I(Z=$.kind===m.PictureSingle.Month?m.PictureSingle.Minute:$.kind,x=!0,j),C+=1;L=(0,N.fastMin)(2,$.count);Z===m.PictureSingle.Hour?j.code.push({kind:Z,count:L,isAbs:x,isAMPM:!1}):j.code.push({kind:Z,count:L,isAbs:x}),P=!0,Y=1;continue;case ie.Char:if($.tokenStr===le(g.pictureSingle,m.PictureSingle.Space))continue;break;case m.PictureSingle.HourTh:throw new _e((0,v.notImplemented)(["Thai hour in ["]))}throw new _e(this.notFormatString("unexpected token after ["))}if(2!==Y)throw new _e((0,v.notImplemented)(["semicolon inside [ ]"]));b.suns.push(j);break;default:return(0,h.assertNever)("calc.numfmt.NumberFormatImpl: convertTokToSun tok",D)}if(b.suns.length>=2){var X=b.suns[b.suns.length-2],ee=b.suns[b.suns.length-1];if(7===X.kind&&7===ee.kind){var te=X.code;(0,N.safePush)(te,ee.code),b.suns.pop()}}}(void 0!==n&&(n.numThousands=i.numThousands,n.numPercent=E),T&&void 0!==a)&&((q=a.code[0]).isAMPM=!0);if(R)for(var re=0,ne=b.suns;re<ne.length;re++){if(1===(j=ne[re]).kind)for(var ae=0,oe=j.code;ae<oe.length;ae++){switch((q=oe[ae]).kind){case m.PictureSingle.Hour:case m.PictureSingle.HourTh:case m.PictureSingle.Minute:case m.PictureSingle.MinuteTh:case m.PictureSingle.Second:case m.PictureSingle.SecondTh:q.isAbs=Se[q.kind]===r}}}if(b.suns.length>32)throw new _e(this.notFormatString("format string too long: SUNs limit"));return b.hasDate=O>0,b.hasTime=C>0,b},e.prototype.classifySunPartKind=function(e,t){for(var r=e.suns,n=e.isEmpty,i=e.hasDate,a=e.hasTime,o=2===t,s=3===t,u=!o&&!s,c=0,l=r;c<l.length;c++){var d=l[c];switch(d.kind){case 0:case 2:case 3:case 4:o=!0;break;case 5:s=!0;break;case 6:continue;case 7:case 1:break;default:return(0,h.assertNever)("calc.numfmt.NumberFormatImpl: classifySunPartKind sun",d)}u=!1}if((o?1:0)+(i||a?1:0)+(s?1:0)>1)throw new _e(this.notFormatString("cannot mix number/date/text"));return o||i||a?2:s?3:u&&!n?1:t},e.prototype.convertSunToCode=function(t){var r,n=t.suns,i=t.isEmpty,a=t.dtrRounding,o=t.color,s=t.dbnum,u=t.currCode,c=this.config.localeInfo,l=[];function d(e){for(var t=e-1;t>=0;t-=1){var r=n[t];if(0===r.kind)return[t,r]}}function f(e){for(var t=e+1;t<n.length;t+=1){var r=n[t];if(0===r.kind)return[t,r]}}for(var m=!1,v=0,b=0;b<n.length;b+=1){var S=n[b];switch(S.kind){case 5:if(5===r)break;if(void 0!==r)throw new _e(this.notFormatString("@ after other control"));r=5;break;case 6:if(void 0!==r)throw new _e(this.notFormatString("General after other control"));if(m)throw new _e(this.notFormatString("General after number"));r=6;break;case 0:if(m=!0,6===r)throw new _e(this.notFormatString("number after General"));break;case 2:if(void 0!==r)throw new _e(this.notFormatString("/ after other control"));if(c.isEastAsia&&void 0!==s)throw new _e(this.notFormatString("/ not allowed with DBNUM"));r=2;var y=d(b);if(void 0===y)throw new _e(this.notFormatString("no number before /"));var O=this.mergeNumSuns(n,v,y[0]),C=O[0],P=O[1],R=O[2],k=f(b);if(void 0===k)throw new _e(this.notFormatString("no number after /"));var T=n.slice(y[0]+1,k[0]),E=void 0!==f(k[0]);(0,N.safePush)(l,this.flattenSuns(C)),(0,N.safePush)(l,this.buildFractCode(P,R,y[1],T,k[1],E)),v=k[0]+1;break;case 4:if(void 0!==r)throw new _e(this.notFormatString("E after other control"));r=4;var _=this.mergeNumSuns(n,v,b),F=_[0],I=_[1],A=_[2];if(void 0===I)throw new _e(this.notFormatString("no number before E"));var M=this.mergeNumSuns(n,b+1,n.length),w=M[0],D=M[1],j=M[2];if(void 0===D)throw new _e(this.notFormatString("no number after E"));(0,N.safePush)(l,this.flattenSuns(F)),(0,N.safePush)(l,this.buildExpCode(S.isNeg,I,p.__spreadArray(p.__spreadArray(p.__spreadArray([],A,!0),[n[b]],!1),w,!0),D)),(0,N.safePush)(l,this.flattenSuns(j)),v=n.length;break;case 3:case 7:case 1:break;default:return(0,h.assertNever)("calc.numfmt.NumberFormatImpl: convertSunToCode sun",S)}}if(void 0===r){var x=this.mergeNumSuns(n,v,n.length),L=(C=x[0],x[1]),B=x[2];void 0!==L?(0,N.safePush)(l,this.buildNumberCode(C,L)):(0,N.safePush)(l,this.flattenSuns(C)),(0,N.safePush)(l,this.flattenSuns(B)),v=n.length}(0,N.safePush)(l,this.flattenSuns(n.slice(v))),0!==n.length||i||l.push(Oe);var U=null==u?void 0:u.tag;if((0,g.isSystemCultureTag)(U)){var G=U===g.CultureTag.SysDate?c.sysDateFormat:c.sysTimeFormat,K=new e(this.config,{old:void 0,formatString:G,source:g.NumberFormatSource.System}),V=K.parts[0];return{part:{code:[{kind:407,codeSysFormat:V.code,codeThisFormat:l}],color:V.color,dbnum:V.dbnum,dtrRounding:V.dtrRounding},applyCurrCode:K.thisCurrCode}}return{part:{code:l,color:o,dbnum:s,dtrRounding:a},applyCurrCode:u}},e.prototype.flattenSuns=function(e){return(0,N.safeConcat)([],e.map((function(e){return e.code})))},e.prototype.buildExpCode=function(e,t,r,n){if(n.comma)throw new _e(this.notFormatString("comma following E"));var i=t.numDigDec;if(i>127)throw new _e(this.notFormatString("too many decimal digits"));var a=this.bumpDigitsForComma(t),o=a.code,s=a.comma;return[{kind:402,isNeg:e,numMantDigLeft:a.numDigLeft,numMantDigDec:i,numExpDigLeft:n.numDigLeft,commaMant:s,codeMant:o,codeBetween:this.flattenSuns(r),codeExp:this.flattenSuns([n])}]},e.prototype.buildNumberCode=function(e,t){var r=t.numDigDec;if(r>127)throw new _e(this.notFormatString("too many decimal digits"));var n=this.bumpDigitsForComma(t),i=n.code,a=n.comma;return[{kind:403,numDigLeft:n.numDigLeft,numDigDec:r,numPercent:t.numPercent,numThousands:t.numThousands,comma:a,codeBefore:this.flattenSuns(e),code:i}]},e.prototype.buildFractCode=function(e,t,r,n,i,a){var o,s,u,c,l=this.config.mathpack;if(r.comma)throw new _e(this.notFormatString("comma in numerator"));if(r.decimal)throw new _e((0,v.notImplemented)(["decimals in numerator"]));if(i.comma)throw new _e(this.notFormatString("comma in denominator"));if(i.decimal)throw new _e(this.notFormatString("decimals in denominator"));if(0!==r.numDigDec)throw new _e(this.notFormatString("decimals in numerator"));if((c=i).numVal&&c.nonZero&&c.digitTokens)throw new _e(this.notFormatString("literal and placeholder digits mixed in denominator"));if(a)throw new _e((0,v.notImplemented)(["fraction number formats with trailing numbers"]));var d,f=!1,p=0;if(void 0!==e){if(!e.reallyNum)throw new _e((0,v.notImplemented)(["fixed numerals in fraction integer part"]));if(e.decimal)throw new _e((0,v.notImplemented)(["decimal in fraction integer part"]));if(0!==e.numDigDec)throw new _e(this.notFormatString("decimals in fraction integer part"));if(e.numVal&&e.nonZero)throw new _e((0,v.notImplemented)(["numerals in fraction integer part"]));d=(o=this.bumpDigitsForComma(e)).code,f=o.comma,p=o.numDigLeft}var g=null!==(s=null==e?void 0:e.numPercent)&&void 0!==s?s:r.numPercent,b=null!==(u=null==e?void 0:e.numThousands)&&void 0!==u?u:r.numThousands;if(b>0)throw new _e((0,v.notImplemented)(["fraction number formats with thousands"]));var S,y=i.code,O=i.numDigLeft,C=i.firstDig;if(i.numVal&&i.nonZero){if(a)throw new _e((0,v.notImplemented)(["fraction number formats with specified denominator and trailing numbers"]));if(i.code.length>5)throw new _e((0,v.notImplemented)(["too many digits in denominator"]));for(var P=0,N=0;N<i.code.length;N+=1){var R=i.code[N];switch(R.kind){case ie.Numeral:P=10*P+R.ordinal;break;case m.PictureSingle.Zero:if(0===N)throw new _e((0,v.notImplemented)(["leading zero in denominator"]));P*=10;break;default:return(0,h.assertFalse)("calc.numfmt.NumberFormatImpl: buildFractCode denomCode")}}if(P>32767)throw new _e((0,v.notImplemented)(["overflow in denominator not emulated"]));y=[{kind:m.PictureSingle.Hash,count:1}],O=1,C=void 0,S=l.fromNumber(P)}return[{kind:401,numIntDigLeft:p,numPercent:g,numThousands:b,numNumerDig:r.numDigLeft,numDenomDig:O,commaInt:f,codeInt:d,codeBetween1:this.flattenSuns(t),codeNumer:r.code,codeBetween2:this.flattenSuns(n),codeDenom:y,denomValue:S,lastDigInt:void 0!==e?e.lastDig:void 0,firstDigNumer:r.firstDig,firstDigDenom:C,anyZeroNumer:r.anyZero,anyQuestionNumer:r.anyQuestion}]},e.prototype.mergeNumSuns=function(e,t,r){for(var n,i=[],a=[],o=t;o<e.length&&o<r;o+=1){var s=e[o];void 0!==n?0===s.kind?(n.decimal?n.numDigDec+=s.numDigLeft+s.numDigDec:(n.numDigLeft+=s.numDigLeft,n.numDigDec+=s.numDigDec),n.comma=n.comma||s.comma,n.decimal=n.decimal||s.decimal,n.numVal=n.numVal||s.numVal,n.nonZero=n.nonZero||s.nonZero,void 0!==s.lastDig&&(n.lastDig=s.lastDig),void 0===n.firstDig&&(n.firstDig=s.firstDig),n.anyHash=n.anyHash||s.anyHash,n.anyQuestion=n.anyQuestion||s.anyQuestion,n.anyZero=n.anyZero||s.anyZero,(0,N.safePush)(n.code,this.flattenSuns(a)),a.length=0,(0,N.safePush)(n.code,s.code)):a.push(s):0===s.kind?n=s:i.push(s)}return[i,n,a]},e.prototype.bumpDigitsForComma=function(e){if(!e.comma)return e;if(this.anyLegalCommaPosition(e))return e;for(var t=e.numDigLeft%3,r=(0===t?0===e.numDigLeft?3:e.numDigLeft:e.numDigLeft+3-t)+1,n=0;n<e.code.length;n+=1){var i=e.code[n];switch(i.kind){case m.PictureSingle.Hash:return(a=e.code.slice())[n]=p.__assign(p.__assign({},i),{count:i.count+(r-e.numDigLeft)}),{code:a,comma:!0,numDigLeft:r};case m.PictureSingle.Zero:case m.PictureSingle.Question:case m.PictureSingle.Decimal:var a;return(a=e.code.slice()).splice(n,0,{kind:m.PictureSingle.Hash,count:r-e.numDigLeft}),{code:a,comma:!0,numDigLeft:r}}}throw new _e((0,v.notImplemented)(["comma with pure number literal"]))},e.prototype.anyLegalCommaPosition=function(e){if(e.numDigLeft<4)return!1;for(var t=function(e){var t=null==e?void 0:e.kind;return t===m.PictureSingle.Hash||t===m.PictureSingle.Zero||t===m.PictureSingle.Question},r=e.numDigLeft,n=0;n<e.code.length;n+=1){var i=e.code[n];if(i.kind===m.PictureSingle.Decimal)return!1;if(t(i))for(var a=0;a<i.count;a+=1)if((r-=1)>0&&r%3==0&&(a+1<i.count||t(e.code[n+1])))return!0}return!1},e.prototype.parseCurrCode=function(e){var t,r,n,i=this.config.localeInfo,a=e.indexOf("-");if(0!==e.length&&0!==a){if((t=a<0?e:e.substring(0,a)).length>61)throw new _e(this.notFormatString("currencySymbol too long"));for(var o=0,s=(0,b.codePointIterator)(t);o<s.length;o++){var u=s[o];if(i.isNumeral(u)&&i.getNumberShape(u)!==E.NumberShape.ASCII)throw new _e((0,v.notImplemented)(["non-ASCII digits in currencySymbol"]))}}if(a>=0&&(n=e.substring(a+"-".length)),void 0!==n&&void 0===(r=this.parseFormatCulture(n)))throw new _e((0,v.notImplemented)(["unhandled CurrCode: "+(0,M.anonymizeFormulaString)(e)]));if((0,g.isSystemCultureTag)(null==r?void 0:r.tag)){if(void 0!==t)throw new _e(this.notFormatString("currencySymbol with sysdate/systime"));if(this.source===g.NumberFormatSource.System)throw new _e(this.notFormatString("system format referenced circularly within system format"))}return{currencySymbol:t,currCode:r}},e.prototype.parseFormatCulture=function(e){var t,r,n={culture:"",numberShape:void 0,nationalNumberInput:!1,calendar:void 0,localCalendarInput:!1,tag:void 0},i=e.match(pe);if(null!=i){n.culture=null!==(t=i[1])&&void 0!==t?t:"";var a=null!==(r=i[2])&&void 0!==r?r:i[3];if(null!=a){if(n.tag=ve[a.toLowerCase()],void 0===n.tag)throw new _e((0,v.notImplemented)(["unknown CurrCode tag: "+(0,M.anonymizeFormulaString)(e)]));switch(n.tag){case g.CultureTag.SysDate:case g.CultureTag.SysTime:case g.CultureTag.Euro1:case g.CultureTag.Euro2:case g.CultureTag.Bitcoin1:case g.CultureTag.Bitcoin2:if(""!==n.culture)throw new _e(this.notFormatString("CultureTag ".concat(String(n.tag)," cannot have culture")));break;case g.CultureTag.GenLower:case g.CultureTag.GenUpper:case g.CultureTag.NomLower:case g.CultureTag.Gannen:if(""===n.culture)throw new _e(this.notFormatString("CultureTag ".concat(String(n.tag)," must have culture")))}}var o=i[4];if(null!=o){var s=be(o),u=(32512&s)>>8;if(0!==u&&(n.numberShape=me[u],void 0===n.numberShape))throw new _e((0,v.notImplemented)(["unknown number shape ".concat(u," in culture: ").concat((0,M.anonymizeFormulaString)(e))]));n.nationalNumberInput=0!=(32768&s);var c=127&s;if(0!==c&&(n.calendar=he[c],void 0===n.calendar))throw new _e((0,v.notImplemented)(["unknown calendar ".concat(c," in culture: ").concat((0,M.anonymizeFormulaString)(e))]));n.localCalendarInput=0!=(128&s)}return n}if(fe.test(e)){var l=be(e);switch(l){case m.LCID.SystemLongDate:n.tag=g.CultureTag.SysDate;break;case m.LCID.SystemTime:n.tag=g.CultureTag.SysTime;break;case m.LCID.EuroTrailing:n.tag=g.CultureTag.Euro1;break;case m.LCID.EuroLeading:n.tag=g.CultureTag.Euro2;break;default:64512==(64512&l)&&(n.tag=g.CultureTag.GenLower),63488==(64512&l)&&(n.tag=g.CultureTag.GenUpper),62464==(64512&l)&&(n.tag=g.CultureTag.NomLower),void 0!==n.tag&&(l&=-63489),n.culture=(0,w.convertKnownLCID)(l)}return n}},e.prototype.determineValueType=function(){for(var e=this.config.localeInfo,t={accountFill:!1,fvt:void 0},r=0,n=this.parts;r<n.length;r++){var i=n[r];t.accountFill=!1;var a=this.determineValueTypeCodes(t,i.code);if(void 0!==a)return a;if(t.accountFill&&(t.fvt===g.FormatValueType.Number||t.fvt===g.FormatValueType.Currency))return g.FormatValueType.Accounting;if(void 0!==t.fvt)return t.fvt}return void 0!==t.fvt?t.fvt:this.formatString===le(e.pictureSpecial,m.PictureSpecial.General)?g.FormatValueType.General:g.FormatValueType.Custom},e.prototype.determineValueTypeCodes=function(e,t){for(var r=this.config.localeInfo,n=0;n<t.length;n+=1){var i=t[n];switch(i.kind){case ie.General:break;case m.PictureSingle.Text:return g.FormatValueType.Text;case m.PictureSingle.Star:e.accountFill=!0;break;case 400:case ie.Exp:case m.PictureSingle.Slash:case ie.StrLit:case m.PictureSingle.Percent:case m.PictureSingle.Underscore:case ie.Numeral:case 405:case 406:break;case ie.Currency:e.fvt=g.FormatValueType.Currency;break;case ie.CurrCode:void 0!==i.currencySymbol&&(e.fvt=g.FormatValueType.Currency);break;case 403:e.fvt=1===i.numPercent&&0===i.numThousands?g.FormatValueType.Percentage:g.FormatValueType.Number;var a=i.codeBefore,o=0;if(r.isEastAsia){if(o<a.length&&"("===ye(a[o])&&(o+=1),o<a.length&&"US$"===ye(a[o]))return g.FormatValueType.Currency;if(r.isChinaT){if(o<a.length&&"NT$"===ye(a[o]))return g.FormatValueType.Currency}else if(o<a.length&&"$"===ye(a[o]))return g.FormatValueType.Currency}var s=void 0;if(void 0!==(s=this.determineValueTypeCodes(e,i.codeBefore.slice(o))))return s;if(void 0!==(s=this.determineValueTypeCodes(e,i.code)))return s;break;case 402:e.fvt=g.FormatValueType.Scientific;s=void 0;if(void 0!==(s=this.determineValueTypeCodes(e,i.codeMant)))return s;if(void 0!==(s=this.determineValueTypeCodes(e,i.codeBetween)))return s;if(void 0!==(s=this.determineValueTypeCodes(e,i.codeExp)))return s;break;case 401:e.fvt=g.FormatValueType.Fraction;s=void 0;if(void 0!==i.codeInt&&void 0!==(s=this.determineValueTypeCodes(e,i.codeInt)))return s;if(void 0!==(s=this.determineValueTypeCodes(e,i.codeBetween1)))return s;if(void 0!==(s=this.determineValueTypeCodes(e,i.codeNumer)))return s;if(void 0!==(s=this.determineValueTypeCodes(e,i.codeBetween2)))return s;if(void 0!==(s=this.determineValueTypeCodes(e,i.codeDenom)))return s;break;case m.PictureSingle.Decimal:case m.PictureSingle.Hash:case m.PictureSingle.Zero:case m.PictureSingle.Question:break;case ie.PrefixDigTh:case ie.LatinDate:case ie.BidiDate:break;case m.PictureSingle.HourTh:case m.PictureSingle.MinuteTh:case m.PictureSingle.SecondTh:case m.PictureSingle.Hour:case m.PictureSingle.Minute:case m.PictureSingle.Second:case 404:return g.FormatValueType.Time;case ie.AMPM:case ie.AMPMFE:break;case m.PictureSingle.Era:case m.PictureSingle.EraYear:case m.PictureSingle.YearTh:case m.PictureSingle.EngYearTh:case m.PictureSingle.ThYear:case m.PictureSingle.MonthTh:case m.PictureSingle.DayTh:case m.PictureSingle.Year:case m.PictureSingle.Month:case m.PictureSingle.Day:case m.PictureSingle.LocDay:return g.FormatValueType.Date;case 407:return this.determineValueTypeCodes(e,i.codeThisFormat);default:return(0,h.assertNever)("calc.numfmt.NumberFormatImpl: determineValueTypeCodes code",i)}}},e.prototype.determineDecimals=function(){for(var e=0,t=this.parts[0].code;e<t.length;e++){var r=t[e];switch(r.kind){case 403:return r.numDigDec;case 402:return r.numMantDigDec}}return 0},e.prototype.determineBidiDate=function(){var e=le(this.config.localeInfo.pictureSingle,m.PictureSingle.BidiDate);return(0,C.stringStartsWith)(this.formatString,e+"1")?g.BidiDate.English:(0,C.stringStartsWith)(this.formatString,e+"2")?g.BidiDate.Lunar:void 0},e.prototype.printFormatString=function(){var e=this.config.localeInfo,t=this.parts,r=t[0],n=t[1],i=t[2],a=t[3],o=!(Ne(a)||a===r),s=this.posBeforeText||!o,u="";return s&&(u+=this.printPart(r,this.condPos),n!==r&&(u+=le(e.pictureSingle,m.PictureSingle.Sep),u+=this.printPart(n,this.condNeg),i!==r&&(u+=le(e.pictureSingle,m.PictureSingle.Sep),u+=this.printPart(i,void 0)))),o&&(s&&(u+=le(e.pictureSingle,m.PictureSingle.Sep)),u+=this.printPart(a,void 0)),u},e.prototype.printPart=function(e,t){var r,n=this.config,i=n.mathpack,a=n.localeInfo,o="";if(void 0!==e.color&&(o+=le(a.pictureSingle,m.PictureSingle.ColorStart)+("number"==typeof e.color?le(a.pictureColor,m.PictureColor.Color)+String(e.color-8):le(a.pictureColor,(r=e.color,m.PictureColor[r])))+le(a.pictureSingle,m.PictureSingle.ColorEnd)),void 0!==t){o+=le(a.pictureSingle,m.PictureSingle.ColorStart)+le(ae,se[t.operator])+i.formatGeneral(a,t.operand,21)+le(a.pictureSingle,m.PictureSingle.ColorEnd)}return void 0!==e.dbnum&&(o+=le(a.pictureSingle,m.PictureSingle.ColorStart)+le(a.pictureDbnum,e.dbnum-1)+le(a.pictureSingle,m.PictureSingle.ColorEnd)),o+=this.printCodes({seenDig:!1,wasPrevDig:!1},e.code,void 0)},e.prototype.printCodes=function(e,t,r){var n,i=this.config,a=i.mathpack,o=i.localeInfo,s="";if(void 0!==r&&r.numThousands>0){for(var u=0;u<t.length;u+=1){var c=t[u].kind;c!==m.PictureSingle.Zero&&c!==m.PictureSingle.Hash&&c!==m.PictureSingle.Question&&c!==m.PictureSingle.Decimal&&c!==ie.Numeral||(n=u)}(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: printCodes thousandsAfter",void 0!==n)}var l=function(i){var u=t[i],c=e.wasPrevDig;switch(e.wasPrevDig=!1,u.kind){case ie.General:s+=le(o.pictureSpecial,m.PictureSpecial.General);break;case m.PictureSingle.Decimal:void 0!==r&&(r.decimal=!0),e.wasPrevDig=!0,s+=le(o.pictureSingle,m.PictureSingle.Decimal);break;case m.PictureSingle.Hash:case m.PictureSingle.Zero:case m.PictureSingle.Question:e.seenDig=!0,e.wasPrevDig=!0;var l=u.kind===m.PictureSingle.Zero?"0":le(o.pictureSingle,u.kind),f=(0,C.repeat)(l,u.count);if(void 0===r||r.decimal){s+=f;break}if(r.comma){var p=r.numDigLeft-u.count;s+=(0,k.insertCommas)({isThousandsPosition:function(e){var r,n;return e>0&&e%3==0&&(e>p||((n=null===(r=t[i+1])||void 0===r?void 0:r.kind)===m.PictureSingle.Hash||n===m.PictureSingle.Zero||n===m.PictureSingle.Question))},thousandsSeparator:le(o.pictureSingle,m.PictureSingle.Comma)},f,p)}else s+=f;r.numDigLeft-=u.count;break;case ie.Numeral:e.wasPrevDig=!0,s+=u.formattedStr;break;case 402:s+=d.printCodes(e,u.codeMant,{comma:u.commaMant,numThousands:0,decimal:!1,numDigLeft:u.numMantDigLeft})+d.printCodes(e,u.codeBetween,void 0)+d.printCodes(e,u.codeExp,{comma:!1,numThousands:0,decimal:!1,numDigLeft:u.numExpDigLeft});break;case 403:s+=d.printCodes(e,u.codeBefore,void 0)+d.printCodes(e,u.code,{comma:u.comma,numThousands:u.numThousands,decimal:!1,numDigLeft:u.numDigLeft});break;case 401:var v=void 0===u.codeInt?"":d.printCodes(e,u.codeInt,{comma:u.commaInt,numThousands:0,decimal:!1,numDigLeft:u.numIntDigLeft}),S=d.printCodes(e,u.codeBetween1,void 0),y=d.printCodes(e,u.codeNumer,{comma:!1,numThousands:0,decimal:!1,numDigLeft:u.numNumerDig}),O=d.printCodes(e,u.codeBetween2,void 0),P=d.printCodes(e,u.codeDenom,{comma:!1,numThousands:u.numThousands,decimal:!1,numDigLeft:u.numDenomDig});s+=v+S+y+O+(void 0!==u.denomValue?J(a,u.denomValue):P);break;case 400:var N=le(o.pictureSingle,m.PictureSingle.Backslash),R=ce(o,o.pictureSingle,u.formattedStr,0),T=function(e,t,r,n){for(var i=r.substring(n,n+(0,b.numCodeUnits)((0,b.stringCodePointAt)(r,n))),a=0;a<t.length;a+=1){var o=t[a];if(null!=o&&0!==o.length){var s=o.substring(0,(0,b.numCodeUnits)((0,b.stringCodePointAt)(o,0)));if(0===e.stringCompareCI(i,s))return!0}}return!1}(o,o.pictureSpecial,u.formattedStr,0);if(void 0!==R&&R!==m.PictureSingle.Extra&&R!==m.PictureSingle.Zero)switch(R){case m.PictureSingle.Comma:var E=t[i+1];if(c){var _=le(o.pictureSingle,m.PictureSingle.Space);if(u.formattedStr!==_||void 0===E||(o.isCurrencySymbolLead||!o.isCurrencySepBySpace||E.kind!==ie.Currency)&&(!o.isPercentSepBySpace||E.kind!==m.PictureSingle.Percent)){s+=N;break}}if(400===(null==E?void 0:E.kind)&&(null==E?void 0:E.formattedStr)===u.formattedStr){s+=N;break}break;case m.PictureSingle.Decimal:s+=N;break;case m.PictureSingle.Slash:e.seenDig&&(s+=N);break;case m.PictureSingle.Space:case m.PictureSingle.Minus:case m.PictureSingle.Plus:case m.PictureSingle.OpenParen:case m.PictureSingle.CloseParen:break;case m.PictureSingle.DateSep:le(o.pictureSingle,m.PictureSingle.DateSep)!==le(o.pictureSingle,m.PictureSingle.Minus)&&(s+=N);break;default:s+=N}else(T||o.isNumeral((0,b.stringCodePointAt)(u.formattedStr,0)))&&(s+=N);s+=u.formattedStr;break;case ie.Exp:s+=u.formattedStr+(u.isNeg?"-":"+");break;case ie.StrLit:N=le(o.pictureSingle,m.PictureSingle.Quote);(0,h.assertTrue)("calc.numfmt.NumberFormatImpl: printCodes StrLit",u.escaped.indexOf(N)<0),s+=N+u.escaped+N;break;case m.PictureSingle.Slash:s+=le(o.pictureSingle,m.PictureSingle.Slash);break;case m.PictureSingle.Percent:s+=le(o.pictureSingle,m.PictureSingle.Percent);break;case m.PictureSingle.Star:s+=le(o.pictureSingle,m.PictureSingle.Star)+u.escaped;break;case m.PictureSingle.Underscore:s+=le(o.pictureSingle,m.PictureSingle.Underscore)+u.escaped;break;case ie.PrefixDigTh:s+="t";break;case ie.Currency:s+=le(o.pictureSpecial,m.PictureSpecial.Currency);break;case ie.CurrCode:if(s+=le(o.pictureSingle,m.PictureSingle.ColorStart),s+="$",void 0!==u.currencySymbol&&(s+=u.currencySymbol),void 0!==u.currCode){var F=u.currCode,I=F.culture,A=F.numberShape,M=F.nationalNumberInput,w=F.calendar,D=F.localCalendarInput,j=F.tag;switch(s+="-",typeof I){case"number":var x=I;switch((0,h.assertTrue)("calc.numfmt.NumberFormatImpl: printCodes lcid",void 0===A&&!M&&void 0===w&&!D),j){case void 0:break;case g.CultureTag.GenLower:x|=64512;break;case g.CultureTag.GenUpper:x|=63488;break;case g.CultureTag.NomLower:x|=62464;break;default:(0,h.assertFalse)("calc.numfmt.NumberFormatImpl: printCodes lcid2")}var L=ge(x);/^[a-f]{1,7}$/i.test(L)&&(L="0"+L),s+=L;break;case"string":s+=I,void 0!==j&&(""!==I&&(s+="-"),s+="x-",s+=String(j));var B=0;void 0!==A&&(B|=me.indexOf(A)<<8),M&&(B|=32768),void 0!==w&&(B|=he.indexOf(w)),D&&(B|=128),0!==B&&(s+=",",s+=ge(B))}}s+=le(o.pictureSingle,m.PictureSingle.ColorEnd);break;case m.PictureSingle.Text:s+=le(o.pictureSingle,m.PictureSingle.Text);break;case ie.LatinDate:s+=le(o.pictureSingle,m.PictureSingle.BidiDate)+"1";break;case ie.BidiDate:s+=le(o.pictureSingle,m.PictureSingle.BidiDate)+"2";break;case 404:s+=le(o.pictureSingle,m.PictureSingle.Decimal)+(0,C.repeat)("0",u.rounding);break;case 405:s+=le(o.pictureSingle,m.PictureSingle.DateSep);break;case 406:s+=le(o.pictureSingle,m.PictureSingle.Colon);break;case m.PictureSingle.Era:case m.PictureSingle.EraYear:case m.PictureSingle.Year:case m.PictureSingle.YearTh:case m.PictureSingle.EngYearTh:case m.PictureSingle.ThYear:case m.PictureSingle.Month:case m.PictureSingle.MonthTh:case m.PictureSingle.Day:case m.PictureSingle.DayTh:case m.PictureSingle.LocDay:s+=(0,C.repeat)(le(o.pictureSingle,u.kind),u.count);break;case m.PictureSingle.Hour:case m.PictureSingle.HourTh:case m.PictureSingle.Minute:case m.PictureSingle.MinuteTh:case m.PictureSingle.Second:case m.PictureSingle.SecondTh:if(u.isAbs){s+=le(o.pictureSingle,m.PictureSingle.ColorStart)+(0,C.repeat)(le(o.pictureSingle,u.kind),u.count)+le(o.pictureSingle,m.PictureSingle.ColorEnd);break}s+=(0,C.repeat)(le(o.pictureSingle,u.kind),u.count);break;case ie.AMPM:case ie.AMPMFE:u.kind===ie.AMPMFE||o.isEastAsia||u.pictureKind===m.PictureSpecial.AP2?s+=u.tokenStr:s+=le(o.pictureSpecial,u.pictureKind);break;case 407:s+=d.printCodes(e,u.codeThisFormat,void 0);break;default:return{value:(0,h.assertNever)("calc.numfmt.NumberFormatImpl: printCodes code",u)}}i===n&&(s+=(0,C.repeat)(le(o.pictureSingle,m.PictureSingle.Comma),r.numThousands))},d=this;for(u=0;u<t.length;u+=1){var f=l(u);if("object"==typeof f)return f.value}return s},e.prototype.countBytecodeBuffer=function(e){for(var t,r,n=this.config,i=n.mathpack,a=n.localeInfo,o=0,s=0;s<e.length;s+=1){var u=e[s],c=1;switch(u.kind){case m.PictureSingle.Percent:case ie.Numeral:case 400:case m.PictureSingle.Star:case m.PictureSingle.Underscore:c+=2;break;case ie.StrLit:c+=1+2*u.escaped.length;break;case 404:case m.PictureSingle.Hash:case m.PictureSingle.Zero:case m.PictureSingle.Question:case ie.Exp:c+=1;break;case m.PictureSingle.Hour:case m.PictureSingle.HourTh:case m.PictureSingle.Minute:case m.PictureSingle.MinuteTh:case m.PictureSingle.Second:case m.PictureSingle.SecondTh:u.isAbs&&(c+=1);break;case 401:if(c+=5,void 0!==u.codeInt&&(c+=this.countBytecodeBuffer(u.codeInt)),c+=this.countBytecodeBuffer(u.codeBetween1),c+=this.countBytecodeBuffer(u.codeNumer),c+=this.countBytecodeBuffer(u.codeBetween2),c+=this.countBytecodeBuffer(u.codeDenom),void 0!==u.denomValue)c-=2,c+=2+2*J(i,u.denomValue).length;u.commaInt&&(c+=1);break;case 402:c+=3,c+=this.countBytecodeBuffer(u.codeMant),c+=this.countBytecodeBuffer(u.codeBetween),c+=this.countBytecodeBuffer(u.codeExp),u.commaMant&&(c+=1);break;case 403:c+=3,c+=this.countBytecodeBuffer(u.codeBefore),c+=this.countBytecodeBuffer(u.code),u.comma&&(c+=1);break;case 407:c=0,c+=this.countBytecodeBuffer(u.codeThisFormat);break;case ie.CurrCode:c+=2*((null!==(r=null===(t=u.currencySymbol)||void 0===t?void 0:t.length)&&void 0!==r?r:0)+1),c+=8;break;case ie.AMPM:var l=a.isEastAsia||u.pictureKind===m.PictureSpecial.AP2?de(a,u.tokenStr):a.ampmSymbols;c+=2+2*(l[0].length+l[1].length);break;case ie.AMPMFE:break;case ie.General:case m.PictureSingle.Decimal:case m.PictureSingle.Slash:case ie.PrefixDigTh:case ie.Currency:case m.PictureSingle.Text:case ie.LatinDate:case ie.BidiDate:case 405:case 406:case m.PictureSingle.Era:case m.PictureSingle.EraYear:case m.PictureSingle.Year:case m.PictureSingle.YearTh:case m.PictureSingle.EngYearTh:case m.PictureSingle.ThYear:case m.PictureSingle.Month:case m.PictureSingle.MonthTh:case m.PictureSingle.Day:case m.PictureSingle.DayTh:case m.PictureSingle.LocDay:break;default:return(0,h.assertNever)("calc.numfmt.NumberFormatImpl: printCodes code",u)}o+=c}return o},e.prototype.countBytecodePart=function(e){var t=e.code,r=0;return void 0!==e.color&&(r+=2),void 0!==e.dbnum&&(r+=2),0!==e.dtrRounding&&(r+=2),r+=this.countBytecodeBuffer(t)},e.prototype.countBytecode=function(){for(var e=0,t=0;t<=3;t+=1){(0===t&&void 0!==this.condPos||1===t&&void 0!==this.condNeg)&&(e+=10);for(var r=this.parts[t],n=!1,i=0;i<t;i+=1)if(this.parts[i]===r){n=!0;break}n||(e+=this.countBytecodePart(r))}return e},e.prototype.checkBytecode=function(){if(this.countBytecode()>255)throw new _e(this.notFormatString("format string too long: bytecode limit"));if(this.countBytecode()>247)throw new _e((0,v.notImplemented)(["format string too long: close to bytecode limit"]))},e.prototype.getBundledLocaleInfo=function(e,t){if(void 0!==(null==t?void 0:t.culture)){var r=(0,w.getBundledLocaleInfo)(t);if(void 0===r)throw new Ee(this.notImplementedCulture(e,t.culture));return r}return this.config.localeInfo},e.prototype.notFormatString=function(e){return(0,g.notFormatString)("".concat(e," (source=").concat(String(this.source),"): ").concat(this.logFormatString))},e.prototype.notImplementedCulture=function(e,t){var r="number"==typeof t?"lcid:".concat(ge(t)):"lang:".concat(t);return(0,v.notImplemented)(["".concat(e,": culture = ").concat(r)])},e}();t.NumberFormatImpl=Fe,t.createFormat=function(e,t,r){try{return(0,A.success)(new Fe(e.config,{old:void 0,formatString:t,source:r}))}catch(e){return e instanceof _e?(0,A.failure)(e.reason):(0,A.failure)((0,A.javaScriptError)(e))}},t.applyFormat=function(e,t,r,n){try{var i=void 0,a=void 0,o=void 0,s=e.config.localeInfo;switch(r.kind){case I.OperKind.String:i=function(e){if(0===e.length)return!1;var t=(0,b.stringCodePointAt)(e,0);return t>=1424&&t<=1535||8207===t||t>=64285&&t<=64335||t>=1536&&t<=1791||t>=1872&&t<=1919||t>=2208&&t<=2303||t>=64336&&t<=65023||t>=65136&&t<=65279}(r.value)?g.Alignment.Right:g.Alignment.Left,a=g.Clip.None,o=r;break;case I.OperKind.Number:i=t.isTextOnly?g.Alignment.Left:g.Alignment.Right,a=g.Clip.All,o=r;break;case I.OperKind.Boolean:i=g.Alignment.Center,a=g.Clip.All,o=(0,S.stringOper)(r.value?s.trueName:s.falseName);break;case I.OperKind.Blank:return(0,A.success)((0,g.formattedValue)([],void 0,g.Alignment.Left,g.Clip.All));case I.OperKind.Error:var u=s.errorNames[r.type];return null==u?(0,A.failure)((0,v.internal)("No locale data for error type ".concat(r.type))):(0,A.success)((0,g.formattedValue)([(0,g.formattedUnitString)(u)],void 0,g.Alignment.Center,g.Clip.All));case I.OperKind.Array:return(0,A.failure)((0,v.notImplemented)(["Array applyFormat"]));case I.OperKind.Rich:return(0,A.failure)((0,v.notImplemented)(["Rich applyFormat"]))}return t.apply(o,i,a,n)}catch(e){return(0,A.failure)((0,A.javaScriptError)(e))}},t.changeFormatDecimals=function(e,t){try{switch(e.valueType){case g.FormatValueType.General:return(0,A.failure)((0,v.notImplemented)(["changeDecimals General"]));case g.FormatValueType.Number:case g.FormatValueType.Currency:case g.FormatValueType.Accounting:case g.FormatValueType.Percentage:case g.FormatValueType.Scientific:if(0===e.decimals&&t<0)return A.successUndefined;var r=(0,N.fastMax)(0,e.decimals+t),n=e.synthesizeDecimals(r);return n.formatString===e.formatString?A.successUndefined:(0,A.success)(n);default:return A.successUndefined}}catch(e){return(0,A.failure)((0,A.javaScriptError)(e))}}},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.convertKnownLCID=t.getBundledLocaleInfo=void 0;var i,a=r(133),o=r(92),s={ar:[["يناير","فبراير","مارس","أبريل","مايو","يونيو","يوليو","أغسطس","سبتمبر","أكتوبر","نوفمبر","ديسمبر"],["يناير","فبراير","مارس","أبريل","مايو","يونيو","يوليو","أغسطس","سبتمبر","أكتوبر","نوفمبر","ديسمبر"],["الأحد","الإثنين","الثلاثاء","الأربعاء","الخميس","الجمعة","السبت"],["الأحد","الإثنين","الثلاثاء","الأربعاء","الخميس","الجمعة","السبت"],["ص","م"],"z"],en:[["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["AM","PM"],"z"],es:[["ene.","feb.","mar.","abr.","may.","jun.","jul.","ago.","set","oct.","nov.","dic."],["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"],["do.","lu.","ma.","mi.","ju.","vi.","sá."],["domingo","lunes","martes","miércoles","jueves","viernes","sábado"],["a. m.","p. m."],"z"],fr:[["janv.","févr.","mars","avr.","mai","juin","juil.","août","sept.","oct.","nov.","déc."],["janvier","février","mars","avril","mai","juin","juillet","août","septembre","octobre","novembre","décembre"],["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],"en","z"],zh:[["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],["週日","週一","週二","週三","週四","週五","週六"],["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],["上午","下午"],"s"],de:[["Jan","Feb","Mrz","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],["So","Mo","Di","Mi","Do","Fr","Sa"],["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],"en","z"],hr:[["sij","vlj","ožu","tra","svi","lip","srp","kol","ruj","lis","stu","pro"],["siječanj","veljača","ožujak","travanj","svibanj","lipanj","srpanj","kolovoz","rujan","listopad","studeni","prosinac"],["ned","pon","uto","sri","čet","pet","sub"],["nedjelja","ponedjeljak","utorak","srijeda","četvrtak","petak","subota"],"en","z"],nl:[["jan","feb","mrt","apr","mei","jun","jul","aug","sep","okt","nov","dec"],["januari","februari","maart","april","mei","juni","juli","augustus","september","oktober","november","december"],["zo","ma","di","wo","do","vr","za"],["zondag","maandag","dinsdag","woensdag","donderdag","vrijdag","zaterdag"],"en","z"],sv:[["jan","feb","mar","apr","maj","jun","jul","aug","sep","okt","nov","dec"],["januari","februari","mars","april","maj","juni","juli","augusti","september","oktober","november","december"],["sön","mån","tis","ons","tor","fre","lör"],["söndag","måndag","tisdag","onsdag","torsdag","fredag","lördag"],"en","z"],it:[["gen","feb","mar","apr","mag","giu","lug","ago","set","ott","nov","dic"],["gennaio","febbraio","marzo","aprile","maggio","giugno","luglio","agosto","settembre","ottobre","novembre","dicembre"],["dom","lun","mar","mer","gio","ven","sab"],["domenica","lunedì","martedì","mercoledì","giovedì","venerdì","sabato"],"en","z"],ro:[["ian.","feb.","mar.","apr.","mai","iun.","iul.","aug.","sept.","oct.","nov.","dec."],["ianuarie","februarie","martie","aprilie","mai","iunie","iulie","august","septembrie","octombrie","noiembrie","decembrie"],["dum.","lun.","mar.","mie.","joi","vin.","sâm."],["duminică","luni","marți","miercuri","joi","vineri","sâmbătă"],["a.m.","p.m."],"z"],ru:[["янв","фев","мар","апр","май","июн","июл","авг","сен","окт","ноя","дек"],["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],["Вс","Пн","Вт","Ср","Чт","Пт","Сб"],["воскресенье","понедельник","вторник","среда","четверг","пятница","суббота"],"en","z"],sr:[["jan","feb","mar","apr","maj","jun","jul","avg","sep","okt","nov","dec"],["januar","februar","mart","april","maj","jun","jul","avgust","septembar","oktobar","novembar","decembar"],["ned","pon","uto","sre","čet","pet","sub"],["nedelja","ponedeljak","utorak","sreda","četvrtak","petak","subota"],["pre podne","po podne"],"z"],uk:[["Січ","Лют","Бер","Кві","Тра","Чер","Лип","Сер","Вер","Жов","Лис","Гру"],["січень","лютий","березень","квітень","травень","червень","липень","серпень","вересень","жовтень","листопад","грудень"],["Нд","Пн","Вт","Ср","Чт","Пт","Сб"],["неділя","понеділок","вівторок","середа","четвер","п'ятниця","субота"],"en","z"],bg:[["яну","фев","мар","апр","май","юни","юли","авг","сеп","окт","ное","дек"],["януари","февруари","март","април","май","юни","юли","август","септември","октомври","ноември","декември"],["нед","пон","вт","ср","четв","пет","съб"],["неделя","понеделник","вторник","сряда","четвъртък","петък","събота"],"en","z"],cs:[["I","II","III","IV","V","VI","VII","VIII","IX","X","XI","XII"],["leden","únor","březen","duben","květen","červen","červenec","srpen","září","říjen","listopad","prosinec"],["ne","po","út","st","čt","pá","so"],["neděle","pondělí","úterý","středa","čtvrtek","pátek","sobota"],["dop.","odp."],"z"],da:["sv",["januar","februar","marts","april","maj","juni","juli","august","september","oktober","november","december"],["sø","ma","ti","on","to","fr","lø"],["søndag","mandag","tirsdag","onsdag","torsdag","fredag","lørdag"],"sv","z"],el:[["Ιαν","Φεβ","Μαρ","Απρ","Μαϊ","Ιουν","Ιουλ","Αυγ","Σεπ","Οκτ","Νοε","Δεκ"],["Ιανουάριος","Φεβρουάριος","Μάρτιος","Απρίλιος","Μάιος","Ιούνιος","Ιούλιος","Αύγουστος","Σεπτέμβριος","Οκτώβριος","Νοέμβριος","Δεκέμβριος"],["Κυρ","Δευ","Τρι","Τετ","Πεμ","Παρ","Σαβ"],["Κυριακή","Δευτέρα","Τρίτη","Τετάρτη","Πέμπτη","Παρασκευή","Σάββατο"],["πμ","μμ"],"z"],et:[["jaan","veebr","märts","apr","mai","juuni","juuli","aug","sept","okt","nov","dets"],["jaanuar","veebruar","märts","aprill","mai","juuni","juuli","august","september","oktoober","november","detsember"],["P","E","T","K","N","R","L"],["pühapäev","esmaspäev","teisipäev","kolmapäev","neljapäev","reede","laupäev"],"en","z"],fi:[["tammi","helmi","maalis","huhti","touko","kesä","heinä","elo","syys","loka","marras","joulu"],["tammikuu","helmikuu","maaliskuu","huhtikuu","toukokuu","kesäkuu","heinäkuu","elokuu","syyskuu","lokakuu","marraskuu","joulukuu"],["su","ma","ti","ke","to","pe","la"],["sunnuntai","maanantai","tiistai","keskiviikko","torstai","perjantai","lauantai"],["ap.","ip."],"z"],he:[["ינו","פבר","מרץ","אפר","מאי","יונ","יול","אוג","ספט","אוק","נוב","דצמ"],["ינואר","פברואר","מרץ","אפריל","מאי","יוני","יולי","אוגוסט","ספטמבר","אוקטובר","נובמבר","דצמבר"],["יום א","יום ב","יום ג","יום ד","יום ה","יום ו","שבת"],["יום ראשון","יום שני","יום שלישי","יום רביעי","יום חמישי","יום שישי","שבת"],"en","z"],hu:[["jan.","febr.","márc.","ápr.","máj.","jún.","júl.","aug.","szept.","okt.","nov.","dec."],["január","február","március","április","május","június","július","augusztus","szeptember","október","november","december"],["V","H","K","Sze","Cs","P","Szo"],["vasárnap","hétfő","kedd","szerda","csütörtök","péntek","szombat"],["de.","du."],"z"],id:[["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Agu","Sep","Okt","Nov","Des"],["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],["Mgg","Sen","Sel","Rab","Kam","Jum","Sab"],["Minggu","Senin","Selasa","Rabu","Kamis","Jumat","Sabtu"],"en","z"],ja:[["1","2","3","4","5","6","7","8","9","10","11","12"],["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],["日","月","火","水","木","金","土"],["日曜日","月曜日","火曜日","水曜日","木曜日","金曜日","土曜日"],["午前","午後"],"j"],ko:["ja",["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"],["일","월","화","수","목","금","토"],["일요일","월요일","화요일","수요일","목요일","금요일","토요일"],["오전","오후"],"k"],lt:[["saus.","vas.","kov.","bal.","geg.","birž.","liep.","rugp.","rugs.","spal.","lapkr.","gruod."],["sausis","vasaris","kovas","balandis","gegužė","birželis","liepa","rugpjūtis","rugsėjis","spalis","lapkritis","gruodis"],["sk","pr","an","tr","kt","pn","št"],["sekmadienis","pirmadienis","antradienis","trečiadienis","ketvirtadienis","penktadienis","šeštadienis"],["priešpiet","popiet"],"z"],lv:[["janv.","febr.","marts","apr.","maijs","jūn.","jūl.","aug.","sept.","okt.","nov.","dec."],["janvāris","februāris","marts","aprīlis","maijs","jūnijs","jūlijs","augusts","septembris","oktobris","novembris","decembris"],["svētd.","pirmd.","otrd.","trešd.","ceturtd.","piektd.","sestd."],["svētdiena","pirmdiena","otrdiena","trešdiena","ceturtdiena","piektdiena","sestdiena"],["priekšp.","pēcp."],"z"],nb:[["jan","feb","mar","apr","mai","jun","jul","aug","sep","okt","nov","des"],["januar","februar","mars","april","mai","juni","juli","august","september","oktober","november","desember"],["søn","man","tir","ons","tor","fre","lør"],"da","ro","z"],pl:[["sty","lut","mar","kwi","maj","cze","lip","sie","wrz","paź","lis","gru"],["styczeń","luty","marzec","kwiecień","maj","czerwiec","lipiec","sierpień","wrzesień","październik","listopad","grudzień"],["niedz.","pon.","wt.","śr.","czw.","pt.","sob."],["niedziela","poniedziałek","wtorek","środa","czwartek","piątek","sobota"],"en","z"],pt:[["jan","fev","mar","abr","mai","jun","jul","ago","set","out","nov","dez"],["janeiro","fevereiro","março","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"],["dom","seg","ter","qua","qui","sex","sáb"],["domingo","segunda-feira","terça-feira","quarta-feira","quinta-feira","sexta-feira","sábado"],"en","z"],sk:["ja",["január","február","marec","apríl","máj","jún","júl","august","september","október","november","december"],["ne","po","ut","st","št","pi","so"],["nedeľa","pondelok","utorok","streda","štvrtok","piatok","sobota"],"en","z"],sl:[["jan.","feb.","mar.","apr.","maj","jun.","jul.","avg.","sep.","okt.","nov.","dec."],["januar","februar","marec","april","maj","junij","julij","avgust","september","oktober","november","december"],["ned.","pon.","tor.","sre.","čet.","pet.","sob."],["nedelja","ponedeljek","torek","sreda","četrtek","petek","sobota"],["dop.","pop."],"z"],th:[["ม.ค.","ก.พ.","มี.ค.","เม.ย.","พ.ค.","มิ.ย.","ก.ค.","ส.ค.","ก.ย.","ต.ค.","พ.ย.","ธ.ค."],["มกราคม","กุมภาพันธ์","มีนาคม","เมษายน","พฤษภาคม","มิถุนายน","กรกฎาคม","สิงหาคม","กันยายน","ตุลาคม","พฤศจิกายน","ธันวาคม"],["อา.","จ.","อ.","พ.","พฤ.","ศ.","ส."],["อาทิตย์","จันทร์","อังคาร","พุธ","พฤหัสบดี","ศุกร์","เสาร์"],"en","z"],tr:[["Oca","Şub","Mar","Nis","May","Haz","Tem","Ağu","Eyl","Eki","Kas","Ara"],["Ocak","Şubat","Mart","Nisan","Mayıs","Haziran","Temmuz","Ağustos","Eylül","Ekim","Kasım","Aralık"],["Paz","Pzt","Sal","Çar","Per","Cum","Cmt"],["Pazar","Pazartesi","Salı","Çarşamba","Perşembe","Cuma","Cumartesi"],["ÖÖ","ÖS"],"z"],vi:[["Thg1","Thg2","Thg3","Thg4","Thg5","Thg6","Thg7","Thg8","Thg9","Thg10","Thg11","Thg12"],["Tháng Giêng","Tháng Hai","Tháng Ba","Tháng Tư","Tháng Năm","Tháng Sáu","Tháng Bảy","Tháng Tám","Tháng Chín","Tháng Mười","Tháng Mười Một","Tháng Mười Hai"],["CN","T2","T3","T4","T5","T6","T7"],["Chủ Nhật","Thứ Hai","Thứ Ba","Thứ Tư","Thứ Năm","Thứ Sáu","Thứ Bảy"],["SA","CH"],"z"],ta:[["ஜனவரி","பிப்ரவரி","மார்ச்","ஏப்ரல்","மே","ஜூன்","ஜூலை","ஆகஸ்ட்","செப்டம்பர்","அக்டோபர்","நவம்பர்","டிசம்பர்"],["ஜனவரி","பிப்ரவரி","மார்ச்","ஏப்ரல்","மே","ஜூன்","ஜூலை","ஆகஸ்ட்","செப்டம்பர்","அக்டோபர்","நவம்பர்","டிசம்பர்"],["ஞாயிறு","திங்கள்","செவ்வாய்","புதன்","வியாழன்","வெள்ளி","சனி"],["ஞாயிற்றுக்கிழமை","திங்கள்கிழமை","செவ்வாய்க்கிழமை","புதன்கிழமை","வியாழக்கிழமை","வெள்ளிக்கிழமை","சனிக்கிழமை"],["காலை","மாலை"],"z"],syr:[["܏ܟܢ ܏ܒ","ܫܒܛ","ܐܕܪ","ܢܝܣܢ","ܐܝܪ","ܚܙܝܪܢ","ܬܡܘܙ","ܐܒ","ܐܝܠܘܠ","܏ܬܫ ܏ܐ","܏ܬܫ ܏ܒ","܏ܟܢ ܏ܐ"],["ܟܢܘܢ ܐܚܪܝ","ܫܒܛ","ܐܕܪ","ܢܝܣܢ","ܐܝܪ","ܚܙܝܪܢ","ܬܡܘܙ","ܐܒ","ܐܝܠܘܠ","ܬܫܪܝ ܩܕܝܡ","ܬܫܪܝ ܐܚܪܝ","ܟܢܘܢ ܩܕܝܡ"],["܏ܐ ܏ܒܫ","܏ܒ ܏ܒܫ","܏ܓ ܏ܒܫ","܏ܕ ܏ܒܫ","܏ܗ ܏ܒܫ","܏ܥܪܘܒ","܏ܫܒ"],["ܚܕ ܒܫܒܐ","ܬܪܝܢ ܒܫܒܐ","ܬܠܬܐ ܒܫܒܐ","ܐܪܒܥܐ ܒܫܒܐ","ܚܡܫܐ ܒܫܒܐ","ܥܪܘܒܬܐ","ܫܒܬܐ"],["ܩ.ܛ","ܒ.ܛ"],"z"],eu:[["urt.","ots.","mar.","api.","mai.","eka.","uzt.","abu.","ira.","urr.","aza.","abe."],["urtarrila","otsaila","martxoa","apirila","maiatza","ekaina","uztaila","abuztua","iraila","urria","azaroa","abendua"],["ig.","al.","ar.","az.","og.","or.","lr."],["igandea","astelehena","asteartea","asteazkena","osteguna","ostirala","larunbata"],"en","z"],be:[["студз","лют","сак","крас","май","чэрв","ліп","жн","вер","кастр","ліст","снеж"],["студзень","люты","сакавік","красавік","май","чэрвень","ліпень","жнівень","верасень","кастрычнік","лістапад","снежань"],["нд","пн","аўт","ср","чц","пт","сб"],["нядзеля","панядзелак","аўторак","серада","чацвер","пятніца","субота"],"en","z"],dv:[["ޖަނަވަރީ","ފެބްރުއަރީ","މާރޗް","އޭޕްރިލް","މެއި","ޖޫން","ޖުލައި","އޮގަސްޓް","ސެޕްޓެމްބަރ","އޮކްޓޯބަރ","ނޮވެމްބަރ","ޑިސެމްބަރ"],["ޖަނަވަރީ","ފެބްރުއަރީ","މާރޗް","އޭޕްރިލް","މެއި","ޖޫން","ޖުލައި","އޮގަސްޓް","ސެޕްޓެމްބަރ","އޮކްޓޯބަރ","ނޮވެމްބަރ","ޑިސެމްބަރ"],["އާދީއްތަ","ހޯމަ","އަންގާރަ","ބުދަ","ބުރާސްފަތި","ހުކުރު","ހޮނިހިރު"],["އާދީއްތަ","ހޯމަ","އަންގާރަ","ބުދަ","ބުރާސްފަތި","ހުކުރު","ހޮނިހިރު"],["މކ","މފ"],"z"],hi:[["जनवरी","फरवरी","मार्च","अप्रैल","मई","जून","जुलाई","अगस्त","सितम्बर","अक्तूबर","नवम्बर","दिसम्बर"],["जनवरी","फरवरी","मार्च","अप्रैल","मई","जून","जुलाई","अगस्त","सितम्बर","अक्तूबर","नवम्बर","दिसम्बर"],["रवि.","सोम.","मंगल.","बुध.","गुरु.","शुक्र.","शनि."],["रविवार","सोमवार","मंगलवार","बुधवार","गुरुवार","शुक्रवार","शनिवार"],["पूर्वाह्न","अपराह्न"],"z"],"ar-SA":"ar","ar-IQ":[["كانون الثاني","شباط","آذار","نيسان","أيار","حزيران","تموز","آب","أيلول","تشرين الأول","تشرين الثاني","كانون الأول"],["كانون الثاني","شباط","آذار","نيسان","أيار","حزيران","تموز","آب","أيلول","تشرين الأول","تشرين الثاني","كانون الأول"],"ar","ar","ar","z"],"ar-DZ":"ar","en-US":"en","en-AU":"en","en-BZ":"en","en-CA":"en","en-029":"en","en-HK":"en","en-IN":"en","en-ID":"en","en-IE":"en","en-JM":"en","en-MY":"en","en-NZ":"en","en-PH":"en","en-SG":"en","en-ZA":"en","en-TT":"en","en-GB":"en","en-ZW":"en","es-ES":[["ene.","feb.","mar.","abr.","may.","jun.","jul.","ago.","sep.","oct.","nov.","dic."],"es","es","es","en","z"],"es-AR":["es-ES","es",["dom.","lun.","mar.","mié.","jue.","vie.","sáb."],"es",["a. m.","p. m."],"z"],"es-BO":["es-ES","es","es-AR","es","es-AR","z"],"es-CL":[["ene.","feb.","mar.","abr.","may.","jun.","jul.","ago.","sept.","oct.","nov.","dic."],"es","es-AR","es","es-AR","z"],"es-CO":["es-ES","es","es-AR","es","es-AR","z"],"es-CR":["es-ES","es","es-AR","es","es-AR","z"],"es-DO":["es-ES","es","es-AR","es","es-AR","z"],"es-EC":["es-ES","es","es-AR","es","es-AR","z"],"es-SV":["es-ES","es","es-AR","es","es-AR","z"],"es-GT":["es-ES","es","es-AR","es","es-AR","z"],"es-HN":["es-ES","es","es-AR","es","es-AR","z"],"es-419":["es-ES","es","es-AR","es","ro","z"],"es-MX":["es-ES","es","es-AR","es","es","z"],"es-NI":["es-ES","es","es-AR","es","es-AR","z"],"es-PA":["es-ES","es","es-AR","es","es-AR","z"],"es-PY":["es-CL","es","es-AR","es","es-CL","z"],"es-PE":[["Ene.","Feb.","Mar.","Abr.","May.","Jun.","Jul.","Ago.","Set.","Oct.","Nov.","Dic."],["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Setiembre","Octubre","Noviembre","Diciembre"],"es-AR","es","es-AR","z"],"es-PR":["es-ES","es","es-AR","es","es-AR","z"],"es-ES_tradnl":["es-ES","es","es","es","es-ES","z"],"es-US":[["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"],"es",["dom","lun","mar","mié","jue","vie","sáb"],"es","en","z"],"es-UY":["es","es-PE","es-AR","es","es-AR","z"],"es-VE":["es-CL","es","es-AR","es","es-CL","z"],"fr-FR":"fr","fr-BE":"fr","fr-CM":["fr","fr","fr","fr",["mat.","soir"],"z"],"fr-CA":"fr","fr-029":"fr","fr-CD":"fr","fr-CI":"fr","fr-HT":"fr","fr-LU":"fr","fr-ML":"fr","fr-MC":"fr","fr-MA":[["jan.","fév.","mar.","avr.","mai","jui.","juil.","août","sept.","oct.","nov.","déc."],"fr","fr","fr","en","z"],"fr-RE":"fr","fr-SN":"fr","fr-CH":"fr","zh-CN":["zh","zh",["周日","周一","周二","周三","周四","周五","周六"],"zh","zh","s"],"zh-SG":[["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],"zh","zh-CN","zh","zh","s"],"zh-HK":["zh-SG","zh","zh","zh","zh-SG","t"],"zh-MO":["zh-SG","zh","zh","zh","zh-SG","t"],"zh-TW":["zh-SG","zh","zh","zh","zh-SG","t"],"de-DE":"de","de-AT":[["Jän","Feb","Mär","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],["Jänner","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],["So.","Mo.","Di.","Mi.","Do.","Fr.","Sa."],"de","en","z"],"de-LI":[["Jan","Feb","Mär","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],"de","de-AT","de","en","z"],"de-LU":["de-LI","de","de-AT","de","de-LI","z"],"de-CH":["de-LI","de","de-AT","de","de-LI","z"],"hr-HR":"hr","hr-BA":[["sij","velj","ožu","tra","svi","lip","srp","kol","ruj","lis","stu","pro"],"hr","hr","hr","en","z"],"nl-NL":"nl","nl-BE":"nl","sv-SE":"sv","sv-FI":[["jan.","feb.","mars","apr.","maj","juni","juli","aug.","sep.","okt.","nov.","dec."],"sv","sv","sv",["fm","em"],"z"],"it-IT":"it","it-CH":"it","ro-RO":"ro","ro-MD":["ro","ro",["Du","Lu","Mar","Mie","Jo","Vi","Sâ"],"ro","ro","z"],"ru-RU":"ru","ru-MD-x-genlower":[["янв.","февр.","март","апр.","май","июнь","июль","авг.","сент.","окт.","нояб.","дек."],["января","февраля","марта","апреля","мая","июня","июля","августа","сентября","октября","ноября","декабря"],"ru","ru","en","z"],"sr-Latn-RS":"sr","sr-Latn-BA":[["jan","feb","mart","apr","maj","jun","jul","avg","sept","okt","nov","dec"],"sr","hr","hr",["prije podne","po podne"],"z"],"sr-Latn-CS":[["jan.","feb.","mart","apr.","maj","jun","jul","avg.","sept.","okt.","nov.","dec."],"sr",["ned.","pon.","uto.","sre.","čet.","pet.","sub."],"sr","en","z"],"uk-UA-x-genlower":["uk",["січня","лютого","березня","квітня","травня","червня","липня","серпня","вересня","жовтня","листопада","грудня"],"uk","uk","uk","z"],"uk-UA":"uk","bg-BG":"bg","cs-CZ":"cs","da-DK":["sv","da","da","da","sv","z"],"el-GR":"el","et-EE":"et","fi-FI":"fi","he-IL":"he","hu-HU":"hu","id-ID":"id","ja-JP":"ja","ko-KR":["ja","ko","ko","ko","ko","k"],"lt-LT":"lt","lv-LV":"lv","nb-NO":["nb","nb","nb","da","nb","z"],"pl-PL":"pl","pt-BR":"pt","pt-PT":"pt","sk-SK":["ja","sk","sk","sk","en","z"],"sl-SI":"sl","th-TH":"th","tr-TR":"tr","vi-VN":"vi","ta-IN":"ta","syr-SY":"syr","eu-ES":"eu","be-BY-x-genlower":["be",["студзеня","лютага","сакавіка","красавіка","мая","чэрвеня","ліпеня","жніўня","верасня","кастрычніка","лістапада","снежня"],"be","be","be","z"],"be-BY":"be","dv-MV":"dv","hi-IN":"hi"};t.getBundledLocaleInfo=function(e){var t=e.culture,r=e.tag;if("number"!=typeof t){var n=t;return void 0!==r&&(""!==t&&(n+="-"),n+="x-"+String(r)),void 0===i&&(i=function(){for(var e={},t=["monthNameShort","monthNameLong","dayNameShort","dayNameLong","ampmSymbols"],r=0,n=Object.keys(s);r<n.length;r++){var i=n[r],a=s[i];if("string"!=typeof a){var u=a.slice(0,5).map((function(r,n){if("string"==typeof r){var i=e[r];return(0,o.assertTrue)("calc.numfmt.buildBundledLocaleData: ref prior culture 2",void 0!==i),i[t[n]]}return r})),c=u[0],l=u[1],d=u[2],f=u[3],p=u[4],m=a[5],h="k"===m,v="j"===m,g="t"===m,b="s"===m,S=h||v||g||b;e[i]={monthNameShort:c,monthNameLong:l,dayNameShort:d,dayNameLong:f,ampmSymbols:p,isEastAsia:S,isKorea:h,isJapan:v,isChinaT:g,isChinaS:b}}else{var y=e[a];(0,o.assertTrue)("calc.numfmt.buildBundledLocaleData: ref prior culture",void 0!==y),e[i]=y}}return e}()),i[n]}};var u=((n={})[a.LCID.USA]="en-US",n[a.LCID.Greek]="el-GR",n[a.LCID.Hungarian]="hu-HU",n[a.LCID.Turkish]="tr-TR",n[a.LCID.Thailand]="th-TH",n[a.LCID.Vietnam]="vi-VN",n[a.LCID.Arabic]="ar-SA",n[a.LCID.Hebrew]="he-IL",n[a.LCID.Tamil]="ta-IN",n[a.LCID.Syriac]="syr-SY",n[a.LCID.Iraq]="ar-IQ",n[a.LCID.Algerian]="ar-DZ",n[a.LCID.Basque]="eu-ES",n[a.LCID.PortBrazil]="pt-BR",n[a.LCID.Croatian]="hr-HR",n[a.LCID.Czech]="cs-CZ",n[a.LCID.Danish]="da-DK",n[a.LCID.Dutch]="nl-NL",n[a.LCID.Australian]="en-AU",n[a.LCID.CanadianEnglish]="en-CA",n[a.LCID.British]="en-GB",n[a.LCID.Finnish]="fi-FI",n[a.LCID.French]="fr-FR",n[a.LCID.FrenchCanadian]="fr-CA",n[a.LCID.Italian]="it-IT",n[a.LCID.NorskBokmal]="nb-NO",n[a.LCID.NorskNynorsk]="nn-NO",n[a.LCID.Polish]="pl-PL",n[a.LCID.PortIberian]="pt-PT",n[a.LCID.Romanian]="ro-RO",n[a.LCID.Russian]="ru-RU",n[a.LCID.Ukrainian]="uk-UA",n[a.LCID.Belarusian]="be-BY",n[a.LCID.SerbianCyrillic]="sr-Cyrl-CS",n[a.LCID.SerbianLatin]="sr-Latn-CS",n[a.LCID.Slovak]="sk-SK",n[a.LCID.Slovenian]="sl-SI",n[a.LCID.SpanishModern]="es-ES",n[a.LCID.Swedish]="sv-SE",n[a.LCID.HongKong]="zh-HK",n[a.LCID.ChinaT]="zh-TW",n[a.LCID.Korea]="ko-KR",n[a.LCID.Japan]="ja-JP",n[a.LCID.China]="zh-CN",n[a.LCID.Devihi]="dv-MV",n[a.LCID.Hindi]="hi-IN",n[a.LCID.German]="de-DE",n[a.LCID.Swiss]="fr-CH",n);t.convertKnownLCID=function(e){var t;return"string"==typeof e?e:null!==(t=u[e])&&void 0!==t?t:e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.renderFormulaBar=void 0;var n=r(90),i=r(80),a=r(132),o=r(92),s=r(248),u=r(91),c=r(191),l=r(76);function d(e,t,r,c,d){if(d.isDate||d.isTime){var f=function(e,t,r,c,d){var f=t.config,p=f.mathpack,m=f.localeInfo;if(p.cond(c)<0)return(0,l.success)(void 0);var h="",v=0!==p.fix(c)||d.isDate,g=c;if(v){var b=p.trunc(c),S=(0,s.getFormatString)(e,t,r,(0,a.buildMMDDYYFormat)(m,!0),n.NumberFormatSource.CustomString);if(!(0,l.isSuccess)(S))return S;var y=(0,s.renderFormat)(e,S.value,b);if(!(0,l.isSuccess)(y))return y;if("string"!=typeof y.value)return(0,l.success)(void 0);h+=y.value;var O=p.sub(c,b);(0,o.assertTrue)("calc.numfmt.renderFormulaBar: sub error",!(0,i.isErrorOper)(O)),g=O}if(p.cond(g)>0||d.isTime){v&&(h+="  ");var C=t.getKnownFormat(r,m.clock24Hour?u.KnownFormat.HHMMSS:u.KnownFormat.HHMMSSAP);if(!(0,l.isSuccess)(C))return C;y=(0,s.renderFormat)(e,C.value,g);if(!(0,l.isSuccess)(y))return y;if("string"!=typeof y.value)return(0,l.success)(void 0);h+=y.value}return(0,l.success)(h)}(e,(0,s.initUtilGlobals)(t),r,c,d);if(!(0,l.isSuccess)(f))return f;if(void 0!==f.value){f.value;return f}}var p=t.config,m=p.mathpack,h=p.localeInfo;if(d.isPercent){var v=m.mul(c,m.fromNumber(100));return(0,i.isErrorOper)(v)?(0,l.failure)((0,i.notImplemented)(["renderFormulaBar % overflow"])):(0,l.success)(m.formatGeneral(h,v,21)+"%")}return(0,l.success)(m.formatGeneral(h,c,21))}t.renderFormulaBar=function(e,t,r,n,a,s){try{var u=t.config.localeInfo;switch(n.kind){case c.OperKind.Number:return d(e,t,r,n,a);case c.OperKind.String:return(0,l.success)(s?"'"+n.value:n.value);case c.OperKind.Boolean:return(0,l.success)(n.value?u.trueName:u.falseName);case c.OperKind.Error:var f=u.errorNames[n.type];return null==f?(0,l.failure)((0,i.internal)("No locale data for error type ".concat(n.type))):(0,l.success)(f);case c.OperKind.Array:return(0,l.failure)((0,i.notImplemented)(["Array renderFormulaBar"]));case c.OperKind.Rich:return(0,l.failure)((0,i.notImplemented)(["Rich renderFormulaBar"]));case c.OperKind.Blank:return(0,l.success)("");default:return(0,o.assertNever)("calc.numfmt.renderFormulaBar: never value",n)}}catch(e){return(0,l.failure)((0,l.javaScriptError)(e))}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toXLNumber=t.applyValueEdit=t.getValueEditOperKind=t.renderFormat=t.getFormatString=t.initUtilGlobals=void 0;var n=r(80),i=r(90),a=r(91),o=r(76),s=r(92),u=r(186),c=r(132),l={getKnownFormat:function(){return(0,s.assertFalse)("calc.numfmt: default getKnownFormat")},getIformat:function(){return(0,s.assertFalse)("calc.numfmt: default getIformat")},getFormatString:function(){return(0,s.assertFalse)("calc.numfmt: default getFormatString")}};t.initUtilGlobals=function(e){var t,r,n,i,a,o;return{config:e.config,getKnownFormat:null!==(r=null===(t=e.getKnownFormat)||void 0===t?void 0:t.bind(e))&&void 0!==r?r:l.getKnownFormat,getIformat:null!==(i=null===(n=e.getIformat)||void 0===n?void 0:n.bind(e))&&void 0!==i?i:l.getIformat,getFormatString:null!==(o=null===(a=e.getFormatString)||void 0===a?void 0:a.bind(e))&&void 0!==o?o:l.getFormatString}},t.getFormatString=function(e,t,r,n,a){var s=t.getFormatString(r,n);if(!(0,o.isSuccess)(s))return s;if(void 0!==s.value)return t.getIformat(r,s.value);var u=e.createFormat(n,a);return(0,o.isSuccess)(u)?u:u.reason.kind===i.FormatReasonKind.NotFormatString?(0,o.failure)((0,i.previousFormatFailure)()):(0,o.failure)(u.reason)},t.renderFormat=function(e,t,r){var a=(0,n.isStringOper)(r)?i.Clip.None:i.Clip.All,s=t.apply(r,i.Alignment.Right,a,!0);if(!(0,o.isSuccess)(s))return s;var u=e.renderValue(s.value,i.renderInfiniteWidth);return(0,o.isSuccess)(u)?(0,i.isHashesValue)(u.value)?(0,o.success)(u.value.units):(0,o.success)((0,i.renderedValueToString)(u.value)):u},t.getValueEditOperKind=function(e){return e.value.kind},t.applyValueEdit=function(e,t,r,n){var s=r;if(n.kind===i.EditKind.Number&&n.format!==a.KnownFormat.General){var l=n.format,d="string"==typeof l?l:(0,c.getKnownFormat)(t,l),f="string"!=typeof l,p=e.createFormat(d,f);if(!(0,o.isSuccess)(p))return p;var m=p.value;(0,u.shouldInstallFormat)(m,r)&&(s=m)}return e.applyFormat(s,n.value,!0)},t.toXLNumber=function(e,t,r){var n=t.parseGeneral(r,!1,!0,i.GetTimeKind.NonVolatile);return(0,o.isSuccess)(n)?null==n.value?(0,o.failure)(null):(0,o.success)(e.toNumber(n.value.value)):n}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseDate=t.parseGeneral=void 0;var n=r(187),i=r(190),a=r(76);t.parseGeneral=function(e,t,r,o,s){try{var u=e.config,c=u.localeInfo,l=u.mathpack,d=(0,n.parseConstInternal)(c,l,t,r,o,!1);return(0,a.isSuccess)(d)?void 0!==d.value?d:(0,i.parseDateInternal)((0,i.initParseDateGlobals)(e),t,void 0,s):d}catch(e){return(0,a.failure)((0,a.javaScriptError)(e))}},t.parseDate=function(e,t,r){try{return(0,i.parseDateInternal)((0,i.initParseDateGlobals)(e),t,void 0,r)}catch(e){return(0,a.failure)((0,a.javaScriptError)(e))}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGridRangeTable=t.gridRangeDistance=void 0;var n=r(370),i=r(62),a=r(38);function o(e,t){var r=e.row,n=e.col,a=e.rows,o=e.cols,s=t.row,u=t.col,c=t.rows,l=t.cols;return(0,i.fastAbs)(r-s+.5*(a-c))+(0,i.fastAbs)(n-u+.5*(o-l))}t.gridRangeDistance=o,t.makeGridRangeTable=function(){return n.RTree.create(a.gridRangeJoin,a.gridRangeIsects,a.gridRangeCompare,o)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.breakTransition=t.nextTransition=t.nextOnSuccessReceiver=t.callMachineTransition=t.TransitionKind=t.MachineRuntime=t.MachineCycle=t.AllMachine=void 0;var n=r(7);t.AllMachine=n.machine.AllMachine,t.MachineCycle=n.machine.MachineCycle,t.MachineRuntime=n.machine.MachineRuntime,t.TransitionKind=n.machine.TransitionKind,t.callMachineTransition=n.machine.callMachineTransition,t.nextOnSuccessReceiver=n.machine.nextOnSuccessReceiver,t.nextTransition=n.machine.nextTransition,t.breakTransition=n.machine.breakTransition},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.zipVisitor=t.voidVisitor=t.visitWSFNode=t.visitQualifier=t.visitOperatorNode=t.visitFormulaNode=t.visitCellRef=t.visitAppHeadNode=t.reduceTopDown_Pledge=t.reducePledge=t.reduceBottomUp_Recursive=t.reduceBottomUp_Pledge=t.reduceBottomUp_MaxDepth=t.reduceBottomUp_CPS=t.reduceBottomUp=t.identityVisitor=t.depthVisitor=t.constVisitor=t.composeVisitor=t.bindVisitor=t.binaryVisitor=t.ZipVisitor=t.PledgeReducer=t.IdentityVisitor=t.DelegatingVisitor=t.ConstVisitor=t.ComposeVisitor=t.BinaryVisitor=void 0;var n=r(3);t.BinaryVisitor=n.visitor.BinaryVisitor,t.ComposeVisitor=n.visitor.ComposeVisitor,t.ConstVisitor=n.visitor.ConstVisitor,t.DelegatingVisitor=n.visitor.DelegatingVisitor,t.IdentityVisitor=n.visitor.IdentityVisitor,t.PledgeReducer=n.visitor.PledgeReducer,t.ZipVisitor=n.visitor.ZipVisitor,t.binaryVisitor=n.visitor.binaryVisitor,t.bindVisitor=n.visitor.bindVisitor,t.composeVisitor=n.visitor.composeVisitor,t.constVisitor=n.visitor.constVisitor,t.depthVisitor=n.visitor.depthVisitor,t.identityVisitor=n.visitor.identityVisitor,t.reduceBottomUp=n.visitor.reduceBottomUp,t.reduceBottomUp_CPS=n.visitor.reduceBottomUp_CPS,t.reduceBottomUp_MaxDepth=n.visitor.reduceBottomUp_MaxDepth,t.reduceBottomUp_Pledge=n.visitor.reduceBottomUp_Pledge,t.reduceBottomUp_Recursive=n.visitor.reduceBottomUp_Recursive,t.reducePledge=n.visitor.reducePledge,t.reduceTopDown_Pledge=n.visitor.reduceTopDown_Pledge,t.visitAppHeadNode=n.visitor.visitAppHeadNode,t.visitCellRef=n.visitor.visitCellRef,t.visitFormulaNode=n.visitor.visitFormulaNode,t.visitOperatorNode=n.visitor.visitOperatorNode,t.visitQualifier=n.visitor.visitQualifier,t.visitWSFNode=n.visitor.visitWSFNode,t.voidVisitor=n.visitor.voidVisitor,t.zipVisitor=n.visitor.zipVisitor},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FunctionDispatcher=t.UdfOper=void 0;var n=r(18),i=r(136),a=r(43),o=r(81),s=r(105),u=r(52),c=r(52),l=r(52),d=r(138),f=r(254),p=r(137),m=r(54),h=r(54),v=r(62),g=r(135),b=r(51),S=r(51),y=r(38),O=r(118),C=r(193),P=r(198),N=r(40),R=r(255),k=r(371),T=r(119),E=r(72),_=r(71),F=r(134),I=r(372),A=r(48),M=r(197),w=r(194),D=r(60),j=r(151),x=r(256),L=r(150),B=function(){function e(e,t){this.kind=A.OperKind.Rich,this.loc=e,this.arity=t.arity,this.func=t.func}return e.prototype.getFallback=function(){return(0,a.assertFalse)("calc.runtime.UdfOper.getFallback")},e.prototype.getField=function(e){return(0,a.assertFalse)("calc.runtime.UdfOper.getField")},e}();t.UdfOper=B;var U=function(){function e(e,t,r,n,i,a,o,s){this.context=e,this.stepConfig=t,this.locals=r,this.caller=n,this.precedents=i,this.visitedCells=a,this.visitedNames=o,this.usage=s,this.internalSource=void 0;var u=e.globals.config.refStyle;this.config={localeInfo:e.globals.config.localeInfo,get refStyle(){return i.special|=A.SpecialPrecs.RefStyle,u},mathpack:e.globals.config.mathpack,date1904:e.globals.config.date1904,dateCompatibility:e.globals.config.dateCompatibility,timezone:e.globals.config.timezone,datepack:e.globals.config.datepack},this.mathpack=this.config.mathpack,this.datepack=this.config.datepack}return Object.defineProperty(e.prototype,"globals",{get:function(){return this.context.globals},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"numberFormatter",{get:function(){return this.context.numberFormatter},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"internalCaller",{get:function(){return void 0===this.internalSource?this.caller:(0,u.stackFrameList)(this.internalSource,void 0,c.emptyStackEnv,void 0,this.caller)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"calcingArray",{get:function(){return this.locals.calcingArray},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"originGridCell",{get:function(){var e=this.locals.originGridCell;return(0,D.isSuccess)(e)?e.value:(0,l.throwEvaluationError)(e.reason)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"originSheet",{get:function(){var e=this.locals.originSheet;return(0,D.isSuccess)(e)?e.value:(0,l.throwEvaluationError)(e.reason)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"reflectionGridCell",{get:function(){var e=this.locals.reflectionGridCell;return(0,D.isSuccess)(e)?e.value:(0,l.throwEvaluationError)(e.reason)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"reflectionSheet",{get:function(){var e=this.locals.reflectionSheet;return(0,D.isSuccess)(e)?e.value:(0,l.throwEvaluationError)(e.reason)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"followHyperlinks",{get:function(){var e=this.locals.followHyperlinks;return(0,D.isSuccess)(e)?e.value:(0,l.throwEvaluationError)(e.reason)},enumerable:!1,configurable:!0}),e.prototype.makeChildDispatcher=function(){return new e(this.context,this.stepConfig,this.locals,this.internalCaller,this.precedents,this.visitedCells,this.visitedNames,this.usage)},e.prototype.useAsFuncContext=function(e){return(0,a.assertTrue)("calc.runtime.FunctionDispatcher.useAsFuncContext",void 0===this.internalSource),void 0!==e&&(this.internalSource=e),this},e.prototype.applyFunction=function(e,t){var r=this.makeChildDispatcher(),n=(0,E.getWorksheetFuncType)(e),i=t.some(y.isRangeOper)?t.slice(0):t;return(0,M.dereferenceOpers)(r,i,n),r.handleLambda(r.dispatchFunction((0,p.worksheetFunctionIdToName)(e),n,!1,i))},e.prototype.applyLambda=function(e,t){return this.handleLambda((0,u.lambdaCall)(e,t,this.internalCaller))},e.prototype.handleEvaluationError=function(e){if(e instanceof l.EvaluationError)return(0,l.handleEvaluationError)(this.context,this.visitedCells,e.reason)},e.prototype.applyOperatorOrFunction=function(e,t,r){if((0,p.isOperatorName)(e))return(0,f.applyOperator)(this.globals,(0,p.operatorNameToId)(e),t,r);var n=(0,p.worksheetFunctionNameToId)(e);if(n===E.WorksheetFuncId._UDF){if(t[0]instanceof T.LambdaOper){var i=t[0],o=t.slice(1);return o.length>=i.minArity&&o.length<=i.maxArity?(0,u.lambdaCall)(i,o,this.internalCaller):N.valueErrorOper}if(t[0]instanceof B){var s=t[0];if(t.length-1!==s.arity)return N.valueErrorOper;if((v=s.func(this.useAsFuncContext((0,b.lexicalSourceUDF)(s.loc)),t.slice(1))).kind===A.OperKind.Error){var c="UDF function return value";(0,h.traceErrorOper)("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",v.type,c)}return v}switch(t[0].kind){case A.OperKind.Error:return t[0];case A.OperKind.Number:return N.valueErrorOper;case A.OperKind.Rich:return(0,l.throwEvaluationError)((0,y.notImplemented)(["Rich UDF head"]));case A.OperKind.String:case A.OperKind.Boolean:case A.OperKind.Blank:case A.OperKind.Missing:return N.refErrorOper;case A.OperKind.Array:return(0,L.isFeatureEnabled)(L.FeatureName.CalcLambdaArrayLifting)?(0,a.assertFalse)("calc.runtime.FunctionDispatcher.applyOperatorOrFunction: unexpected array UDF head"):(0,l.throwEvaluationError)((0,y.notImplemented)(["Array UDF head"]));case A.OperKind.Range:return(0,L.isFeatureEnabled)(L.FeatureName.CalcLambdaCellValues)?(0,a.assertFalse)("calc.runtime.FunctionDispatcher.applyOperatorOrFunction: unexpected range UDF head"):(0,l.throwEvaluationError)((0,y.notImplemented)(["Range UDF head"]));default:return(0,a.assertNever)("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",t[0])}}var d=this.globals.getWorksheetFunc(n);if(d.kind===D.ResultKind.Failure)return(0,l.throwEvaluationError)(d.reason);var m=d.value;if(null==m){c="nonexistent worksheet function ".concat(n);return(0,h.traceErrorOper)("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",N.ErrorType.NAME,c),N.nameErrorOper}try{var v;if((v=m(this.useAsFuncContext((0,b.lexicalSourceWSF)(n)),t)).kind===A.OperKind.Error){c="worksheet function ".concat(n," return value");(0,h.traceErrorOper)("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",v.type,c)}return v}catch(e){throw(0,j.prependErrorMessage)(e,"(in WSF ".concat((0,g.englishWorksheetFuncIdToName)(n),")"))}},e.prototype.handleLambda=function(e){return(0,u.isLambdaCall)(e)?(0,_.machineCall)(this.context.createLambdaEvaluationMachine(this.context,this.stepConfig,this.locals,this.precedents,this.visitedCells,this.visitedNames,this.usage,e)):e},e.prototype.dispatchFunction=function(e,t,r,o){var s=this;if(!(0,y.isValidArgsLength)(t,o.length)){var u=JSON.stringify(t),c="bad application of ".concat(JSON.stringify(e)," to ").concat(o.length," arguments, ftype = ").concat(u),l="calc.runtime.FunctionDispatcher.dispatchFunction: ".concat(c);return a.ulsLogger.ULS.assertTag(593372499,n.LogCategory.msoulscat_ES_EWAJS,!1,l)}for(var d=o.length,f=A.SignatureType.None,p=0;p<d;p+=1){var v=o[p],g=v.kind;0==(g&(0,y.getArgType)(t,p,d))&&(f|=g),(0,y.isRangeOper)(v)&&0==(t.flags&A.FunctionFlags.Allow3dRef)&&!(0,y.isSheetIndex)(v.sheets)&&(f|=g)}if(f===A.SignatureType.None)return this.applyOperatorOrFunction(e,o,r);if(0!=(f&A.OperKind.Array)){return(0,m.arrayLift)(this.useAsFuncContext(void 0),t,(function(r){var n=s.makeChildDispatcher();return n.handleLambda(n.dispatchFunction(e,t,!1,r))}),o)}f&=~A.OperKind.Array;var b=[];for(p=0;p<d;p+=1){var S=o[p];if(0!=(f&S.kind)){var O=(0,y.getArgType)(t,p,d);if(S=this.coerceOper(S,O),(0,y.isErrorOper)(S)&&0==(O&A.OperKind.Error))return S;if((0,y.isRangeOper)(S)&&0==(t.flags&A.FunctionFlags.Allow3dRef)&&!(0,y.isSheetIndex)(S.sheets)){c="3D reference, oper = ".concat((0,i.anonymize)(S));return(0,h.traceErrorOper)("calc.runtime.FunctionDispatcher.dispatchFunction",N.ErrorType.VALUE,c),N.valueErrorOper}}b[p]=S}return this.applyOperatorOrFunction(e,b,r)},e.prototype.getAvailableFormula=function(e){var t=this.globals.getCellFormula(e);return(0,D.isSuccess)(t)?(0,v.isNone)(t.value)?void 0:t.value:(0,l.throwEvaluationError)(t.reason)},e.prototype.getNameFormula=function(e,t,r){var n=this.context.resolver.resolveName(this.locals,(0,O.nameNode)((0,O.identNamePart)(t,!0),e),r),i=n.resolution,a=n.precedents;if((0,v.safePush)(this.precedents.names,a),!(0,D.isSuccess)(i))switch(i.reason.kind){case C.ResolveReasonKind.NoOriginSheet:case C.ResolveReasonKind.InvalidQualifier:return;default:return(0,l.throwEvaluationError)(i.reason)}var o=i.value;if(o){var s=this.globals.getNameFormula(o,r);(0,D.isSuccess)(s)||(0,l.throwEvaluationError)(s.reason);var u=s.value;if(!(0,v.isNone)(u))return[o,u.node]}},e.prototype.getCellRef=function(e,t,r,n){var i={originGridCell:(0,D.success)(r.range),originSheet:(0,D.success)(r.sheet),allowUnqualifiedCell:!0,wrapCellReferences:n},a=this.context.resolver.resolveCellRef(i,(0,O.cellRefNode)(t,e)).resolution;if(!(0,D.isSuccess)(a))switch(a.reason.kind){case C.ResolveReasonKind.NoOriginSheet:case C.ResolveReasonKind.InvalidQualifier:return;default:return(0,l.throwEvaluationError)(a.reason)}var o=a.value;if(o)return(0,N.range3DOper)(o.sheet,o.range)},e.prototype.getStructRef=function(e,t,r){var n={originGridCell:(0,D.success)(r.range),originSheet:(0,D.success)(r.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!1},i=this.context.resolver.resolveStructRef(n,(0,O.structRefNode)(e,t)),a=i.resolution,o=i.precedents;if((0,v.safePush)(this.precedents.names,o),!(0,D.isSuccess)(a))switch(a.reason.kind){case C.ResolveReasonKind.NoOriginSheet:case C.ResolveReasonKind.InvalidQualifier:case C.ResolveReasonKind.InvalidStructRef:case C.ResolveReasonKind.EmptyIntersection:return;default:return(0,l.throwEvaluationError)(a.reason)}var s=a.value;if(s)return(0,N.range3DOper)(s.sheet,s.range)},e.prototype.dereferenceOper=function(e,t){return(0,M.dereferenceOper)(this,e,t)},e.prototype.dereferenceOpers=function(e,t){(0,M.dereferenceOpers)(this,e,t)},e.prototype.getCellFormula=function(e){this.precedents.cells.push(e);var t=this.globals.getCellValue(e);return(0,D.isSuccess)(t)?this.getAvailableFormula(e):(0,l.throwEvaluationError)(t.reason)},e.prototype.getSheetIndex=function(e,t){var r=this.globals.getSheetIndex(e,t);return(0,D.isSuccess)(r)?(this.precedents.special|=A.SpecialPrecs.OwnDocSheets,null==r.value?void 0:(0,S.sheetIndex)(e,r.value)):(0,l.throwEvaluationError)(r.reason)},e.prototype.getSheetRangePosition=function(e){this.precedents.special|=A.SpecialPrecs.OwnDocSheets;var t=this.globals.getSheetRangeIndexes(e);return(0,D.isSuccess)(t)?t.value.position:(0,l.throwEvaluationError)(t.reason)},e.prototype.getSheetRangeIndexes=function(e){if(void 0!==e.index&&e.index===e.index2)return[e.index];this.precedents.special|=A.SpecialPrecs.OwnDocSheets;var t=this.globals.getSheetRangeIndexes(e);return(0,D.isSuccess)(t)?t.value.sheets:(0,l.throwEvaluationError)(t.reason)},e.prototype.dereferenceAllOpersInner=function(e,t,r){var n=this;void 0===r&&(r=!1);for(var i=[],o=[],s=function(s){var c=e[s];if(!(0,y.isRangeOper)(c))return o.push(c),"continue";for(var f=[],p=function(e){var r=(0,M.getCellValuesAsArray)(n,e,i,!0);void 0!==r&&f.push(t(r,e))},m=u.getSheetRangeIndexes(c.sheets),h=function(e){for(var t=(0,S.sheetIndex)(c.sheets.document,m[e]),n=function(e){var n=c.ranges[e];if(!r)return p((0,S.sheetGridRange)(t,n)),"continue";var i=u.globals.tryGetHiddenRows(t,n.row,n.row+n.rows);if(!(0,D.isSuccess)(i))return{value:(0,l.throwEvaluationError)(i.reason)};var o=i.value;if(0===o.length)return p((0,S.sheetGridRange)(t,n)),"continue";for(var s=function(e,r){var i=(0,S.gridRange)(e,n.col,r-e,n.cols);p((0,S.sheetGridRange)(t,i))},d=0;d<o.length;d+=1){var f=o[d],m=f.start,h=f.end,v=0===d?n.row:o[d-1].end;(0,a.assertTrue)("calc.runtime.FunctionDispatcher.dereferenceAllOpersInner: valid interval",v<=m&&m<h&&h<=n.row+n.rows),v!==m&&s(v,m);var g=(0,S.gridRange)(m,n.col,h-m,n.cols);u.precedents.cells.push((0,S.sheetGridRange)(t,g))}var b=o[o.length-1].end;b!==n.row+n.rows&&s(b,n.row+n.rows)},i=0;i<c.ranges.length;i+=1){var o=n(i);if("object"==typeof o)return o}},v=0;v<m.length;v+=1){var g=h(v);if("object"==typeof g)return g}o.push({kind:d.DerefOperKind.RangeValues,arrays:f})},u=this,c=0;c<e.length;c+=1){var f=s(c);if("object"==typeof f)return f.value}return i.length>0?(0,l.throwEvaluationError)((0,l.unevaluated)(i)):o},e.prototype.dereferenceAllOpers=function(e,t){return this.dereferenceAllOpersInner(e,v.identity,t)},e.prototype.dereferenceAllOpersAndFormulae=function(e,t){var r=this;return this.dereferenceAllOpersInner(e,(function(e,t){return new o.NonstrictSparseArray2D(e.rows,e.cols,e.denseRows,e.denseCols,(function(n,i){var a=e.get(n,i),o=(0,S.sheetGridCell)(t.sheet,(0,S.gridCell)(t.range.row+n,t.range.col+i));return[a,r.getAvailableFormula(o)]}),(function(){return[e.getSparse(),void 0]})).strict()}),t)},e.prototype.parseFormula=function(e,t,r,n){var i=this.context.parser.parseFormula((0,P.parseLocals)(r.lexicalKind,t,{refStyle:e}),n);if(!(0,D.isSuccess)(i))return i;var a=this.context.analyzer.checkFormula(r,i.value);if(!(0,D.isSuccess)(a))return a;if(!(0,y.isWellFormed)(a.value))return(0,D.failure)((0,s.illFormedFormula)("ill-formed indirect formula","indirect"));a.value;return a},e.prototype.getRandom=function(){this.precedents.special|=A.SpecialPrecs.Calc;var e=this.globals.getRandom();return(0,D.isSuccess)(e)||(0,l.throwEvaluationError)(e.reason),e.value},e.prototype.getTime=function(e){this.precedents.special|=A.SpecialPrecs.Time;var t=this.globals.getTime(e,F.GetTimeKind.Volatile);return(0,D.isSuccess)(t)||(0,l.throwEvaluationError)(t.reason),t.value},e.prototype.coerceOper=function(e,t){return(0,w.coerceOper)(this,e,t)},e.prototype.parseGeneral=function(e,t){var r,n=this.numberFormatter.parseGeneral(e,!1,t,F.GetTimeKind.NonVolatile);return(0,D.isSuccess)(n)||(0,l.throwEvaluationError)(n.reason),null===(r=n.value)||void 0===r?void 0:r.value},e.prototype.parseDate=function(e){var t,r=this.numberFormatter.parseDate(e,F.GetTimeKind.NonVolatile);return(0,D.isSuccess)(r)||(0,l.throwEvaluationError)(r.reason),null===(t=r.value)||void 0===t?void 0:t.value},e.prototype.getBinaryOperator=function(e){var t=this,r=(0,E.getOperatorType)(e),n=[N.falseOper,N.falseOper];return function(i,o){n[0]=i,n[1]=o,(0,M.dereferenceOpers)(t,n,r);var s=t.dispatchFunction((0,p.operatorIdToName)(e),r,!1,n);return(0,a.assertTrue)("calc.runtime.FunctionDispatcher.getBinaryOperator",!(0,u.isLambdaCall)(s)&&!(0,_.isMachineCall)(s)),s}},e.prototype.getUnaryOperator=function(e){var t=this,r=(0,E.getOperatorType)(e),n=[N.falseOper];return function(i){n[0]=i,(0,M.dereferenceOpers)(t,n,r);var o=t.dispatchFunction((0,p.operatorIdToName)(e),r,!1,n);return(0,a.assertTrue)("calc.runtime.FunctionDispatcher.getUnaryOperator",!(0,u.isLambdaCall)(o)&&!(0,_.isMachineCall)(o)),o}},e.prototype.isInFilterMode=function(e){this.precedents.special|=A.SpecialPrecs.InFilterMode;for(var t=0,r=e;t<r.length;t++){var n=r[t];if((0,y.isRangeOper)(n))for(var i=0,a=this.getSheetRangeIndexes(n.sheets);i<a.length;i++){var o=a[i],s=this.globals.isInFilterMode((0,S.sheetIndex)(n.sheets.document,o));if(!(0,D.isSuccess)(s))return(0,l.throwEvaluationError)(s.reason);if(s.value)return!0}}return!1},e.prototype.printFormula=function(e,t){var r=(0,S.sheetGridCell)(e.source.range.sheet,t),n=(0,k.adjustFormulaOrigin)(this.globals,(0,R.analyzeLocalsGrid)(S.LexicalKind.Cell,(0,y.sheetGridRangeAnchor)(e.source.range)),t,e.formula);if(!(0,D.isSuccess)(n))return(0,l.throwEvaluationError)(n.reason);var i=this.context.printer.printFormula((0,x.printLocalsGrid)(e.source,r,{refStyle:this.config.refStyle}),n.value);return(0,D.isSuccess)(i)?i.value:(0,l.throwEvaluationError)(i.reason)},e.prototype.applyFormat=function(e,t,r,n){var i;if("number"==typeof t){var a=this.globals.getKnownFormat(e,t);if(!(0,D.isSuccess)(a))return(0,l.throwEvaluationError)(a.reason);i=a.value}else{var o=(0,I.getFormatString)(this.context.numberFormatter,this.globals,e,t,n);if(!(0,D.isSuccess)(o))switch(o.reason.kind){case F.FormatReasonKind.PreviousFormatFailure:return;default:return(0,l.throwEvaluationError)(o.reason)}i=o.value}var s=(0,I.renderFormat)(this.context.numberFormatter,i,r);return(0,D.isSuccess)(s)?"string"==typeof s.value?s.value:void 0:(0,l.throwEvaluationError)(s.reason)},e}();t.FunctionDispatcher=U},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.applyOperator=t.cmpNum=t.cmpStr=t.cmpBool=t.cmpInt=void 0;var n=r(136),i=r(54),a=r(135),o=r(40),s=r(43),u=r(72),c=r(48),l=r(51),d=r(38),f=r(54);function p(e,r,n){return(0,t.cmpInt)(e,r.value-n.value)}function m(e,r,n,i){return(0,t.cmpInt)(r,e.stringCompareCI(n.value,i.value))}function h(e,r,n,i){return(0,t.cmpInt)(r,e.compare(n,i))}function v(e,t,r){if((0,d.isSheetIndex)(t.sheets))if((0,d.isSheetIndex)(r.sheets))if((0,d.isDocumentLocEqual)(t.sheets.document,r.sheets.document)){if(t.sheets.index===r.sheets.index)return(0,l.sheetIndex)(t.sheets.document,t.sheets.index);a="different sheet, range1 = ".concat((0,n.anonymize)(t),", range2 = ").concat((0,n.anonymize)(r));(0,i.traceErrorOper)(e,o.ErrorType.VALUE,a)}else{var a="different document, range1 = ".concat((0,n.anonymize)(t),", range2 = ").concat((0,n.anonymize)(r));(0,i.traceErrorOper)(e,o.ErrorType.VALUE,a)}else(0,i.traceErrorOper)(e,o.ErrorType.VALUE,"3D reference, range2 = ".concat((0,n.anonymize)(r)));else(0,i.traceErrorOper)(e,o.ErrorType.VALUE,"3D reference, range1 = ".concat((0,n.anonymize)(t)))}t.cmpInt=d.applyComparison,t.cmpBool=p,t.cmpStr=m,t.cmpNum=h,t.applyOperator=function(e,r,l,g){void 0===g&&(g=!1);var b,S,y,O=e.config.mathpack;if(1===l.length){var C=l[0];switch(r){case u.OperatorId.Percent:return O.percent(C);case u.OperatorId.Neg:return O.neg(C);case u.OperatorId.Pos:return C;default:var P="bad application of ".concat(r," to 1 argument"),N="calc.runtime.applyOperator: ".concat(P);return s.ulsLogger.ULS.assertTag(593372496,a.LogCategory.msoulscat_ES_EWAJS,!1,N)}}if(2===l.length){C=l[0];var R=l[1];switch(r){case u.OperatorId.Add:var k=O.add(C,R);return g&&(0,d.isNumberOper)(k)?O.checkAlmostCancellation(C,k):k;case u.OperatorId.Sub:k=O.sub(C,R);return g&&(0,d.isNumberOper)(k)?O.checkAlmostCancellation(C,k):k;case u.OperatorId.Mul:return O.mul(C,R);case u.OperatorId.Div:return O.div(C,R);case u.OperatorId.Pow:return O.power(C,R);case u.OperatorId.Concat:return(0,o.stringOper)((C.value+R.value).substring(0,o.cellStringLimit));case u.OperatorId.Eq:case u.OperatorId.Ne:case u.OperatorId.Lt:case u.OperatorId.Le:case u.OperatorId.Gt:case u.OperatorId.Ge:return(0,o.booleanOper)(function(e,r,n,i){var a=e.config,s=a.localeInfo,u=a.mathpack;if(n.kind!==i.kind){if((0,d.isBlankOper)(n))switch(i.kind){case c.OperKind.Number:return h(u,r,u.zero,i);case c.OperKind.String:return m(s,r,f.emptyStringOper,i);case c.OperKind.Boolean:return p(r,o.falseOper,i)}if((0,d.isBlankOper)(i))switch(n.kind){case c.OperKind.Number:return h(u,r,n,u.zero);case c.OperKind.String:return m(s,r,n,f.emptyStringOper);case c.OperKind.Boolean:return p(r,n,o.falseOper)}return(0,t.cmpInt)(r,n.kind-i.kind)}switch(n.kind){case c.OperKind.Number:return h(u,r,n,i);case c.OperKind.String:return m(s,r,n,i);case c.OperKind.Boolean:return p(r,n,i);case c.OperKind.Blank:return(0,t.cmpInt)(r,0);default:return!1}}(e,r,C,R));case u.OperatorId.Range:return function(e,t){var r=v("calc.runtime.applyRangeOp",e,t);if(null==r)return o.valueErrorOper;var n=(0,d.gridRangesJoin)(e.ranges),i=(0,d.gridRangesJoin)(t.ranges),a=[(0,d.gridRangeJoin)(n,i)];return(0,o.rangeSeqOper)(r,a)}(C,R);case u.OperatorId.Isect:return function(e,t){var r=v("calc.runtime.applyIsectOp",e,t);if(null==r)return o.valueErrorOper;for(var a=[],s=0;s<e.ranges.length;s+=1)for(var u=0;u<t.ranges.length;u+=1){var c=(0,d.gridRangeIsect)(e.ranges[s],t.ranges[u]);null!=c&&a.push(c)}if(0===a.length){var l="empty intersection, range1 = ".concat((0,n.anonymize)(e),", range2 = ").concat((0,n.anonymize)(t));return(0,i.traceErrorOper)("calc.runtime.applyIsectOp",o.ErrorType.NULL,l),o.nullErrorOper}return(0,o.rangeSeqOper)(r,a)}(C,R);case u.OperatorId.Union:return null==(y=v("calc.runtime.applyUnionOp",b=C,S=R))?o.valueErrorOper:(0,o.rangeSeqOper)(y,b.ranges.concat(S.ranges));case u.OperatorId.And:return(0,o.booleanOper)(C.value&&R.value);case u.OperatorId.Or:return(0,o.booleanOper)(C.value||R.value);case u.OperatorId.Xor:return(0,o.booleanOper)(C.value!==R.value);case u.OperatorId.Min:return O.cond2(C,R)<=0?C:R;case u.OperatorId.Max:return O.cond2(C,R)>=0?C:R;default:var T="bad application of ".concat(r," to 2 arguments"),E="calc.runtime.applyOperator: ".concat(T);return s.ulsLogger.ULS.assertTag(593372497,a.LogCategory.msoulscat_ES_EWAJS,!1,E)}}var _="bad application of ".concat(r," to ").concat(l.length," arguments"),F="calc.runtime.applyOperator: ".concat(_);return s.ulsLogger.ULS.assertTag(593372498,a.LogCategory.msoulscat_ES_EWAJS,!1,F)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.summarizeFormulaDiagnostics=t.diagnostics=t.createAnalyzeGlobals=t.analyzeLocalsName=t.analyzeLocalsGrid=void 0;var n=r(20);t.analyzeLocalsGrid=n.analyzeServiceTypes.analyzeLocalsGrid,t.analyzeLocalsName=n.analyzeServiceTypes.analyzeLocalsName,t.createAnalyzeGlobals=n.analyzeServiceTypes.createAnalyzeGlobals,t.diagnostics=n.analyzeServiceTypes.diagnostics,t.summarizeFormulaDiagnostics=n.analyzeServiceTypes.summarizeFormulaDiagnostics},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.printLocalsName=t.printLocalsGrid=t.createSimplePrintGlobals=void 0;var n=r(3);t.createSimplePrintGlobals=n.printServiceTypes.createSimplePrintGlobals,t.printLocalsGrid=n.printServiceTypes.printLocalsGrid,t.printLocalsName=n.printServiceTypes.printLocalsName},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolveGridRef=t.createResolver=void 0;var n=r(3);t.createResolver=n.resolveService.createResolver,t.resolveGridRef=n.resolveService.resolveGridRef},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createAnalyzer=void 0;var n=r(20);t.createAnalyzer=n.analyzeService.createAnalyzer},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getWorksheetFunc=void 0;var n=r(260),i=r(264),a=r(266),o=r(267),s=r(268),u=r(269),c=r(270),l=r(204),d=r(271),f=r(272),p=r(273),m=r(274),h=r(275),v=r(276),g=r(277),b=r(278),S=r(150),y=r(72),O={};O[y.WorksheetFuncId.SUM]=n.sum,O[y.WorksheetFuncId.PRODUCT]=n.product,O[y.WorksheetFuncId.AVERAGE]=n.average,O[y.WorksheetFuncId.COUNTBLANK]=n.countblank,O[y.WorksheetFuncId.MAX]=n.max,O[y.WorksheetFuncId.MIN]=n.min,O[y.WorksheetFuncId.AND]=n.and,O[y.WorksheetFuncId.COUNTA]=n.counta,O[y.WorksheetFuncId.OR]=n.or,O[y.WorksheetFuncId.CONCAT]=n.concat,O[y.WorksheetFuncId.AVERAGEIF]=n.averageif,O[y.WorksheetFuncId.AVERAGEIFS]=n.averageifs,O[y.WorksheetFuncId.COUNT]=n.count,O[y.WorksheetFuncId.COUNTIF]=n.countif,O[y.WorksheetFuncId.COUNTIFS]=n.countifs,O[y.WorksheetFuncId.MEDIAN]=n.median,O[y.WorksheetFuncId.SUMSQ]=n.sumsq,O[y.WorksheetFuncId.SUMIF]=n.sumif,O[y.WorksheetFuncId.SUMIFS]=n.sumifs,O[y.WorksheetFuncId.LARGE]=n.large,O[y.WorksheetFuncId.SMALL]=n.small,O[y.WorksheetFuncId.RANK]=n.rank,O[y.WorksheetFuncId.RANK_EQ]=n.rank,O[y.WorksheetFuncId.RANK_AVG]=n.rank_avg,O[y.WorksheetFuncId.PERCENTILE]=n.percentile,O[y.WorksheetFuncId.PERCENTILE_INC]=n.percentile,O[y.WorksheetFuncId.PERCENTILE_EXC]=n.percentile_exc,O[y.WorksheetFuncId.QUARTILE]=n.quartile,O[y.WorksheetFuncId.QUARTILE_INC]=n.quartile,O[y.WorksheetFuncId.QUARTILE_EXC]=n.quartile_exc,O[y.WorksheetFuncId.TRIMMEAN]=n.trimmean,O[y.WorksheetFuncId.AVERAGEA]=n.averagea,O[y.WorksheetFuncId.MAXA]=n.maxa,O[y.WorksheetFuncId.MINA]=n.mina,O[y.WorksheetFuncId.MAXIFS]=n.maxifs,O[y.WorksheetFuncId.MINIFS]=n.minifs,O[y.WorksheetFuncId.XOR]=n.xor,O[y.WorksheetFuncId.AGGREGATE]=n.aggregate,O[y.WorksheetFuncId.SUBTOTAL]=n.subtotal,O[y.WorksheetFuncId.VAR]=n.var_,O[y.WorksheetFuncId.VAR_S]=n.var_,O[y.WorksheetFuncId.VARP]=n.varp,O[y.WorksheetFuncId.VAR_P]=n.varp,O[y.WorksheetFuncId.STDEV]=n.stdev,O[y.WorksheetFuncId.STDEV_S]=n.stdev,O[y.WorksheetFuncId.STDEVP]=n.stdevp,O[y.WorksheetFuncId.STDEV_P]=n.stdevp,O[y.WorksheetFuncId.VARA]=n.vara,O[y.WorksheetFuncId.VARPA]=n.varpa,O[y.WorksheetFuncId.STDEVA]=n.stdeva,O[y.WorksheetFuncId.STDEVPA]=n.stdevpa,O[y.WorksheetFuncId.AVEDEV]=n.avedev,O[y.WorksheetFuncId.DEVSQ]=n.devsq,O[y.WorksheetFuncId.MODE]=n.mode,O[y.WorksheetFuncId.MODE_SNGL]=n.mode,O[y.WorksheetFuncId.MODE_MULT]=n.mode_mult,O[y.WorksheetFuncId.TEXTJOIN]=n.textjoin,O[y.WorksheetFuncId.YEAR]=i.year,O[y.WorksheetFuncId.MONTH]=i.month,O[y.WorksheetFuncId.DAY]=i.day,O[y.WorksheetFuncId.HOUR]=i.hour,O[y.WorksheetFuncId.MINUTE]=i.minute,O[y.WorksheetFuncId.SECOND]=i.second,O[y.WorksheetFuncId.WEEKNUM]=i.weeknum,O[y.WorksheetFuncId.ISOWEEKNUM]=i.isoweeknum,O[y.WorksheetFuncId.WEEKDAY]=i.weekday,O[y.WorksheetFuncId.DATE]=i.date,O[y.WorksheetFuncId.TIME]=i.time,O[y.WorksheetFuncId.DAYS360]=i.days360,O[y.WorksheetFuncId.DAYS]=i.days,O[y.WorksheetFuncId.DATEDIF]=i.datedif,O[y.WorksheetFuncId.WORKDAY]=i.workday,O[y.WorksheetFuncId.WORKDAY_INTL]=i.workday_intl,O[y.WorksheetFuncId.EDATE]=i.edate,O[y.WorksheetFuncId.EOMONTH]=i.eomonth,O[y.WorksheetFuncId.NETWORKDAYS]=i.networkdays,O[y.WorksheetFuncId.NETWORKDAYS_INTL]=i.networkdays_intl,O[y.WorksheetFuncId.YEARFRAC]=i.yearFrac,O[y.WorksheetFuncId.DELTA]=a.delta,O[y.WorksheetFuncId.GESTEP]=a.gestep,O[y.WorksheetFuncId.NA]=o.na,O[y.WorksheetFuncId.T]=o.t_,O[y.WorksheetFuncId.N]=o.n_,O[y.WorksheetFuncId.TYPE]=o.type,O[y.WorksheetFuncId.ERROR_TYPE]=o.error_type,O[y.WorksheetFuncId.INFO]=o.info,O[y.WorksheetFuncId.IF]=u.if_,O[y.WorksheetFuncId.IFS]=u.ifs,O[y.WorksheetFuncId.SWITCH]=u.switch_,O[y.WorksheetFuncId.TRUE]=u.true_,O[y.WorksheetFuncId.FALSE]=u.false_,O[y.WorksheetFuncId.NOT]=u.not,O[y.WorksheetFuncId.CHOOSE]=u.choose,O[y.WorksheetFuncId.INDEX]=c.index,O[y.WorksheetFuncId.MATCH]=c.match,O[y.WorksheetFuncId.LOOKUP]=c.lookup,O[y.WorksheetFuncId.HLOOKUP]=c.hlookup,O[y.WorksheetFuncId.VLOOKUP]=c.vlookup,O[y.WorksheetFuncId.ABS]=l.abs,O[y.WorksheetFuncId.CEILING]=l.ceiling,O[y.WorksheetFuncId.ECMA_CEILING]=l.ceiling,O[y.WorksheetFuncId.DEGREES]=l.degrees,O[y.WorksheetFuncId.FLOOR]=l.floor,O[y.WorksheetFuncId.RADIANS]=l.radians,O[y.WorksheetFuncId.ROUND]=l.round,O[y.WorksheetFuncId.ROUNDUP]=l.roundup,O[y.WorksheetFuncId.ROUNDDOWN]=l.rounddown,O[y.WorksheetFuncId.EVEN]=l.even,O[y.WorksheetFuncId.SIGN]=l.sign,O[y.WorksheetFuncId.PI]=l.pi,O[y.WorksheetFuncId.SQRT]=l.sqrt,O[y.WorksheetFuncId.EXP]=l.exp,O[y.WorksheetFuncId.POWER]=l.power,O[y.WorksheetFuncId.LN]=l.ln,O[y.WorksheetFuncId.LOG10]=l.log10,O[y.WorksheetFuncId.LOG]=l.log,O[y.WorksheetFuncId.SIN]=l.sin,O[y.WorksheetFuncId.COS]=l.cos,O[y.WorksheetFuncId.TAN]=l.tan,O[y.WorksheetFuncId.ASIN]=l.asin,O[y.WorksheetFuncId.ACOS]=l.acos,O[y.WorksheetFuncId.ATAN]=l.atan,O[y.WorksheetFuncId.ATAN2]=l.atan2,O[y.WorksheetFuncId.FACT]=l.fact,O[y.WorksheetFuncId.SQRTPI]=l.sqrtpi,O[y.WorksheetFuncId.FACTDOUBLE]=l.factdouble,O[y.WorksheetFuncId.INT]=l.int,O[y.WorksheetFuncId.TRUNC]=l.trunc,O[y.WorksheetFuncId.ODD]=l.odd,O[y.WorksheetFuncId.MROUND]=l.mround,O[y.WorksheetFuncId.QUOTIENT]=l.quotient,O[y.WorksheetFuncId.FLOOR_MATH]=l.floor_math,O[y.WorksheetFuncId.FLOOR_PRECISE]=l.floor_precise,O[y.WorksheetFuncId.CEILING_MATH]=l.ceiling_math,O[y.WorksheetFuncId.CEILING_PRECISE]=l.ceiling_precise,O[y.WorksheetFuncId.ISO_CEILING]=l.ceiling_precise,O[y.WorksheetFuncId.TEXT]=d.text,O[y.WorksheetFuncId.FIXED]=d.fixed,O[y.WorksheetFuncId.DOLLAR]=d.dollar,O[y.WorksheetFuncId.VALUE]=d.value,O[y.WorksheetFuncId.DATEVALUE]=d.datevalue,O[y.WorksheetFuncId.TIMEVALUE]=d.timevalue,O[y.WorksheetFuncId.ISERROR]=f.iserror,O[y.WorksheetFuncId.ISERR]=f.iserr,O[y.WorksheetFuncId.ISBLANK]=f.isblank,O[y.WorksheetFuncId.ISLOGICAL]=f.islogical,O[y.WorksheetFuncId.ISNA]=f.isna,O[y.WorksheetFuncId.ISNONTEXT]=f.isnontext,O[y.WorksheetFuncId.ISTEXT]=f.istext,O[y.WorksheetFuncId.ISNUMBER]=f.isnumber,O[y.WorksheetFuncId.ISREF]=f.isref,O[y.WorksheetFuncId.ISEVEN]=f.iseven,O[y.WorksheetFuncId.ISODD]=f.isodd,O[y.WorksheetFuncId.ISFORMULA]=f.isformula,O[y.WorksheetFuncId.FORMULATEXT]=f.formulatext,O[y.WorksheetFuncId.ROWS]=p.rows,O[y.WorksheetFuncId.COLUMNS]=p.columns,O[y.WorksheetFuncId.AREAS]=p.areas,O[y.WorksheetFuncId.SHEETS]=p.sheets,O[y.WorksheetFuncId.ROW]=p.row,O[y.WorksheetFuncId.COLUMN]=p.column,O[y.WorksheetFuncId.SHEET]=p.sheet,O[y.WorksheetFuncId.OFFSET]=p.offset,O[y.WorksheetFuncId.TRANSPOSE]=p.transpose,O[y.WorksheetFuncId.SINGLE]=p.single,O[y.WorksheetFuncId.ADDRESS]=h.address,O[y.WorksheetFuncId.INDIRECT]=h.indirect,O[y.WorksheetFuncId.LEFT]=v.left,O[y.WorksheetFuncId.RIGHT]=v.right,O[y.WorksheetFuncId.MID]=v.mid,O[y.WorksheetFuncId.LEN]=v.len,O[y.WorksheetFuncId.CONCATENATE]=v.concatenate,O[y.WorksheetFuncId.EXACT]=v.exact,O[y.WorksheetFuncId.REPT]=v.rept,O[y.WorksheetFuncId.TRIM]=v.trim,O[y.WorksheetFuncId.CLEAN]=v.clean,O[y.WorksheetFuncId.CHAR]=v.char,O[y.WorksheetFuncId.UNICHAR]=v.unichar,O[y.WorksheetFuncId.CODE]=v.code,O[y.WorksheetFuncId.UNICODE]=v.unicode,O[y.WorksheetFuncId.LOWER]=v.lower,O[y.WorksheetFuncId.UPPER]=v.upper,O[y.WorksheetFuncId.PROPER]=v.proper,O[y.WorksheetFuncId.FIND]=v.find,O[y.WorksheetFuncId.REPLACE]=v.replace,O[y.WorksheetFuncId.SEARCH]=v.search,O[y.WorksheetFuncId.SUBSTITUTE]=v.substitute,O[y.WorksheetFuncId.RAND]=g.rand,O[y.WorksheetFuncId.RANDBETWEEN]=g.randbetween,O[y.WorksheetFuncId.NOW]=g.now,O[y.WorksheetFuncId.TODAY]=g.today,O[y.WorksheetFuncId.HYPERLINK]=b.hyperlink,O[y.WorksheetFuncId.FIELDVALUE]=m.fieldvalue,O[y.WorksheetFuncId._FV]=m.fieldvalue;var C=!1;t.getWorksheetFunc=function(e){return C||(C=!0,(0,S.isFeatureEnabled)(S.FeatureName.CalcRecordFunctions)&&(O[y.WorksheetFuncId.RECORD]=m.record),(0,S.isFeatureEnabled)(S.FeatureName.CalcNestedRecordFunction)&&(O[y.WorksheetFuncId.NESTEDRECORD]=m.record),(0,S.isFeatureEnabled)(S.FeatureName.CalcLambdaBasicFunctions)&&(O[y.WorksheetFuncId.ARITY]=s.arity,O[y.WorksheetFuncId.APPLY]=s.apply,O[y.WorksheetFuncId.ISLAMBDA]=f.islambda),(0,S.isFeatureEnabled)(S.FeatureName.CalcLambdaHelperFunctions)&&(O[y.WorksheetFuncId.MAKEARRAY]=s.makearray,O[y.WorksheetFuncId.ISOMITTED]=f.isomitted)),O[e]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.devsq=t.avedev=t.rank_avg=t.rank=t.aggregate=t.subtotal=t.mode_mult=t.mode=t.varpa=t.vara=t.varp=t.var_=t.stdevpa=t.stdeva=t.stdevp=t.stdev=t.trimmean=t.median=t.quartile_exc=t.quartile=t.percentile_exc=t.percentile=t.small=t.large=t.xor=t.or=t.and=t.minifs=t.maxifs=t.mina=t.maxa=t.min=t.max=t.countifs=t.countif=t.counta=t.countblank=t.count=t.textjoin=t.concat=t.averagea=t.averageifs=t.averageif=t.average=t.product=t.sumifs=t.sumif=t.sumsq=t.sum=void 0;var n=r(2),i=r(43),a=r(40),o=r(38),s=r(138),u=r(51),c=r(261),l=r(62),d=r(72),f=r(263),p=r(106),m=r(54),h=r(48),v=r(60),g=r(252);function b(e,t){var r=(0,o.isRichOper)(t)?t.getFallback():t;switch(r.kind){case h.OperKind.Number:return r;case h.OperKind.Boolean:case h.OperKind.String:return;case h.OperKind.Error:return r;case h.OperKind.Missing:case h.OperKind.Blank:return;default:return(0,i.assertNever)("calc.funcs.arithmeticOperationCoerce",r)}}function S(e,t){var r=(0,o.isRichOper)(t)?t.getFallback():t;switch(r.kind){case h.OperKind.Boolean:return r.value?e.mathpack.one:e.mathpack.zero;case h.OperKind.Number:return r;case h.OperKind.String:return e.mathpack.zero;case h.OperKind.Error:return r;case h.OperKind.Missing:case h.OperKind.Blank:return;default:return(0,i.assertNever)("calc.funcs.arithmeticAOperationCoerce",r)}}function y(e){return function(t,r,n){if(void 0!==t&&(0,o.isErrorOper)(t))return t;if((0,i.assertTrue)("calc.funcs.numberReducer",void 0===t||(0,o.isNumberOper)(t)),(0,o.isErrorOper)(r))return r;var a,s;(0,i.assertTrue)("calc.funcs.numberReducer",(0,o.isNumberOper)(r)),void 0===t?(a=r,s=n-1):(a=t,s=n);for(var u=0;u<s;u+=1){var c=e(a,r);if((0,o.isErrorOper)(c))return c;a=c}return a}}function O(e){return function(t,r,n){return e.count+=n,r}}function C(e,t,r){if(!(0,o.isNumberOper)(r))return r;var n=function(e){for(var t=e.length-1;t>=0;t-=1){var r=e[t];if(void 0!==r&&(0,s.isRangeValues)(r))for(var n=r.arrays.length-1;n>=0;n-=1){var i=r.arrays[n];if(i.rows>i.denseRows||i.cols>i.denseCols)if((null==(u=i.getSparse())?void 0:u.kind)===h.OperKind.Number)return u;for(var a=i.denseRows-1;a>=0;a-=1)for(var o=i.denseCols-1;o>=0;o-=1){var u;if((null==(u=i.get(a,o))?void 0:u.kind)===h.OperKind.Number)return u}}}}(t);return(null==n?void 0:n.kind)!==h.OperKind.Number?r:e.mathpack.checkAlmostCancellation(n,r)}function P(e,t,r){var n=(0,f.reduceDerefOpers)(t,y(t.mathpack.add),b,r);return null==n?t.mathpack.zero:(e&&(n=C(t,r,n)),n)}var N=P.bind(void 0,!1),R=P.bind(void 0,!0);function k(e){return(0,o.isRangeOper)(e)&&1!==e.ranges.length}function T(e,t,r){if(k(t))return(0,v.failure)(a.valueErrorOper);if(void 0===r){var n=e.dereferenceAllOpers([t])[0];return(0,v.success)({values:n,valuesToFilter:n})}if(k(r))return(0,v.failure)(a.valueErrorOper);var i=function(e,t){var r=e.ranges[0],n=t.ranges[0],i=(0,l.fastMin)(r.cols,u.sheetCols-n.col),o=(0,l.fastMin)(r.rows,u.sheetRows-n.row),s=(0,u.gridRange)(r.row,r.col,o,i),c=(0,a.range3DOper)(e.sheets,s),d=(0,u.gridRange)(n.row,n.col,o,i),f=(0,a.range3DOper)(t.sheets,d);return{actualEvalRange:c,actualFilterRange:f}}(t,r),o=i.actualEvalRange,s=i.actualFilterRange,c=o.ranges[0],d=s.ranges[0],f=e.dereferenceAllOpers([o])[0];if(c.col===d.col&&c.row===d.row)return(0,v.success)({values:f,valuesToFilter:f});var p=e.dereferenceAllOpers([s])[0];return(0,v.success)({values:f,valuesToFilter:p})}function E(e,t){var r=t[0],n=t[1],i=T(e,r,t[2]);if(!(0,v.isSuccess)(i))return i.reason;var a=i.value,o=a.values,u=a.valuesToFilter,l=[(0,s.rangeValues)([(0,c.applyCriteria)(e,o.arrays[0],n,u.arrays[0])])];return N(e,l)}function _(e,t,r,n){void 0===r&&(r=!1),void 0===n&&(n=!1);var i,o,u=t[0];if(k(u))return(0,v.failure)(a.valueErrorOper);if(r){var l=t[1],d=e.dereferenceAllOpers([u])[0];i=(0,c.applyCriteria)(e,d.arrays[0],l),o=2}else{i=e.dereferenceAllOpers([u])[0].arrays[0],o=1}for(var f=o;f<t.length;f+=2){var p=t[f],m=t[f+1];if(k(p))return(0,v.failure)(a.valueErrorOper);if(p.ranges[0].cols!==u.ranges[0].cols||p.ranges[0].rows!==u.ranges[0].rows)return(0,v.failure)(a.valueErrorOper);d=e.dereferenceAllOpers([p])[0];i=(0,c.applyCriteria)(e,d.arrays[0],m,i)}return n&&(i=i.strict()),(0,v.success)((0,s.rangeValues)([i]))}function F(e,t){var r=(0,f.reduceDerefOpers)(e,y(e.mathpack.mul),b,t);return null==r?e.mathpack.zero:r}function I(e,t,r,n,a,s){var u=(0,f.reduceDerefOpers)(a,y(a.mathpack.add),e,s,t);if(null==u)return n;if(r&&(u=C(a,s,u)),(0,o.isErrorOper)(u))return u;var c={count:0},l=(0,f.reduceDerefOpers)(a,O(c),e,s,t);(0,i.assertTrue)("calc.funcs.averageCoerceInner",(0,o.isNumberOper)(u)&&(null==l?void 0:l.kind)===h.OperKind.Number&&c.count>0);var d=a.mathpack.div(u,a.mathpack.fromNumber(c.count));return(0,o.isErrorOper)(d)?d:[d,c.count]}function A(e,t,r,n,i){var o=I(e,t,r,a.div0ErrorOper,n,i);return Array.isArray(o)?o[0]:o}t.sum=function(e,t){var r=e.dereferenceAllOpers(t);return R(e,r)},t.sumsq=function(e,t){var r=e.dereferenceAllOpers(t),n=pe(b),i=(0,f.reduceDerefOpers)(e,y(e.mathpack.add),n,r);return null==i?e.mathpack.zero:i},t.sumif=E,t.sumifs=function(e,t){if(3===t.length)return E(e,[t[1],t[2],t[0]]);var r=_(e,t);return(0,v.isSuccess)(r)?N(e,[r.value]):r.reason},t.product=function(e,t){var r=e.dereferenceAllOpers(t);return F(e,r)};var M=A.bind(void 0,b,void 0,!1),w=A.bind(void 0,b,void 0,!0),D=A.bind(void 0,S,(function(e,t){var r=(0,o.isRichOper)(t)?t.getFallback():t;return(0,o.isStringOper)(r)?e.mathpack.zero:b(0,r)}),!0);function j(e,t){var r=t[0],n=t[1],i=T(e,r,t[2]);if(!(0,v.isSuccess)(i))return i.reason;var a=i.value,o=a.values,u=a.valuesToFilter,l=[(0,s.rangeValues)([(0,c.applyCriteria)(e,o.arrays[0],n,u.arrays[0]).strict()])];return M(e,l)}function x(e,t,r,n,s){for(var u=void 0,c=0,l="",d=function(e,t){return e.coerceOper(t,h.OperKind.String)},p=function(e,n,s){if(void 0!==e&&(0,o.isErrorOper)(e))return e;for(var d=0;d<s;d+=1){if(void 0!==u&&t.length>0&&(!r||u.value.length>0)){var f=t[c];if(c=(c+1)%t.length,l.length+f.value.length>a.cellStringLimit)return a.valueErrorOper;l+=f.value}if((0,o.isErrorOper)(n))return n;if((0,i.assertTrue)("calc.funcs.concatInner: expected string in reducer",(0,o.isStringOper)(n)),l.length+n.value.length>a.cellStringLimit)return a.valueErrorOper;if(l+=n.value,u=n,""===n.value&&(0===t.length||r))break}return n},m=0;m<s.length;m+=1){var v=n[m];if((0,o.isRangeOper)(v)&&v.ranges.length>1)return a.valueErrorOper;var g=(0,f.reduceDerefOpers)(e,p,d,s.slice(m,m+1));if(void 0!==g&&(0,o.isErrorOper)(g))return g;(0,i.assertTrue)("calc.funcs.concatInner: expected string from reduce",void 0!==g&&(0,o.isStringOper)(g))}if(r&&void 0!==u&&""===u.value&&t.length>0&&l.length>0){var b=t[(c+t.length-1)%t.length];l=l.substring(0,l.length-b.value.length)}return(0,a.stringOper)(l)}function L(e,t,r){var n={count:0};return(0,f.reduceDerefOpers)(t,O(n),e,r),t.mathpack.fromNumber(n.count)}t.average=function(e,t){var r=e.dereferenceAllOpers(t);return w(e,r)},t.averageif=j,t.averageifs=function(e,t){if(3===t.length)return j(e,[t[1],t[2],t[0]]);var r=_(e,t,void 0,!0);return(0,v.isSuccess)(r)?M(e,[r.value]):r.reason},t.averagea=function(e,t){var r=e.dereferenceAllOpers(t);return D(e,r)},t.concat=function(e,t){var r=e.dereferenceAllOpers(t);return x(e,[],!0,t,r)},t.textjoin=function(e,t){var r=t[0],n=t[1],s=t.slice(2),u=[];if(!(0,o.isMissingOper)(r)){if((0,o.isRangeOper)(r)&&r.ranges.length>1)return a.valueErrorOper;var c=(0,f.reduceDerefOpers)(e,re(u,p.assertString),(function(e,t){return e.coerceOper(t,h.OperKind.String)}),e.dereferenceAllOpers([r]));if(void 0!==c&&(0,o.isErrorOper)(c))return c;(0,i.assertTrue)("calc.funcs.textjoin: expected string from reduce",void 0!==c&&(0,o.isStringOper)(c))}return x(e,u,(0,o.isMissingOper)(n)||n.value,s,e.dereferenceAllOpers(s))};var B=L.bind(void 0,(function(e,t){var r=(0,o.isRichOper)(t)?t.getFallback():t;return(0,o.isNumberOper)(r)?r:void 0}));t.count=function(e,t){var r=e.dereferenceAllOpers(t);return B(e,r)};var U=L.bind(void 0,(function(e,t){var r=(0,o.isRichOper)(t)?t.getFallback():t;return(0,o.isBlankOper)(r)||(0,m.isEmptyStringOper)(r)?r:void 0}));t.countblank=function(e,t){var r=t[0];if(!(0,o.isSheetIndex)(r.sheets)||1!==r.ranges.length)return a.valueErrorOper;var n=e.dereferenceAllOpers(t);return U(e,n)};var G=L.bind(void 0,(function(e,t){var r=(0,o.isRichOper)(t)?t.getFallback():t;return(0,o.isPrimitiveOper)(r)||(0,o.isErrorOper)(r)?r:void 0}));t.counta=function(e,t){var r=e.dereferenceAllOpers(t);return G(e,r)};var K=L.bind(void 0,(function(e,t){return t}));function V(e,t){var r=t[0],n=t[1];if(k(r))return a.valueErrorOper;var i=e.dereferenceAllOpers([r])[0],o=[(0,s.rangeValues)([(0,c.applyCriteria)(e,i.arrays[0],n)])];return K(e,o)}t.countif=V,t.countifs=function(e,t){if(2===t.length)return V(e,t);var r=_(e,t,!0);return(0,v.isSuccess)(r)?K(e,[r.value]):r.reason};var W=function(e,t,r){return e.mathpack.cond2(t,r)>0},H=function(e,t,r){return e.mathpack.cond2(t,r)<0};function q(e,t,r,n,a){var s=(0,f.reduceDerefOpers)(n,(function(t,r,a){return void 0===t?r:(0,o.isErrorOper)(t)?t:((0,i.assertTrue)("calc.funcs.minMaxCoerceInner",(0,o.isNumberOper)(t)),(0,o.isErrorOper)(r)?r:((0,i.assertTrue)("calc.funcs.minMaxCoerceInner",(0,o.isNumberOper)(r)),e(n,t,r)?t:r))}),t,a,r);return null==s?n.mathpack.zero:s}var z=q.bind(void 0,W,b,void 0),Q=q.bind(void 0,H,b,void 0),J=q.bind(void 0,W,S,b),Y=q.bind(void 0,H,S,b);function $(e,t){var r=(0,o.isRichOper)(t)?t.getFallback():t;switch(r.kind){case h.OperKind.Boolean:return r;case h.OperKind.Number:return(0,a.booleanOper)(0!==e.mathpack.cond(r));case h.OperKind.String:return;case h.OperKind.Error:return r;case h.OperKind.Missing:case h.OperKind.Blank:return;default:return(0,i.assertNever)("calc.funcs.aggregationFuncs: booleanOperationCoerce",r)}}function Z(e,t,r){var n=(0,f.reduceDerefOpers)(t,(function(t,r,n){return void 0!==t&&(0,o.isErrorOper)(t)?t:(0,o.isErrorOper)(r)?r:((0,i.assertTrue)("calc.funcs.booleanInner",(void 0===t||(0,o.isBooleanOper)(t))&&(0,o.isBooleanOper)(r)),(0,a.booleanOper)(e(null==t?void 0:t.value,r.value,n)))}),$,r);return null==n?a.valueErrorOper:n}t.max=function(e,t){var r=e.dereferenceAllOpers(t);return z(e,r)},t.min=function(e,t){var r=e.dereferenceAllOpers(t);return Q(e,r)},t.maxa=function(e,t){var r=e.dereferenceAllOpers(t);return J(e,r)},t.mina=function(e,t){var r=e.dereferenceAllOpers(t);return Y(e,r)},t.maxifs=function(e,t){var r=_(e,t);return(0,v.isSuccess)(r)?z(e,[r.value]):r.reason},t.minifs=function(e,t){var r=_(e,t);return(0,v.isSuccess)(r)?Q(e,[r.value]):r.reason};var X=Z.bind(void 0,(function(e,t){return!1!==e&&t})),ee=Z.bind(void 0,(function(e,t){return!0===e||t})),te=Z.bind(void 0,(function(e,t,r){return t?((!0===e?1:0)+r)%2==1:!0===e}));function re(e,t){return function(r,n,i){if(void 0!==r&&(0,o.isErrorOper)(r))return r;if(!(0,o.isErrorOper)(n))for(var a=t(n),s=0;s<i;s+=1)e.push(a);return n}}function ne(e,t,r,n){var i=[],s=(0,f.reduceDerefOpers)(t,re(i,p.assertNumber),b,[r]);if(null==s)return a.numErrorOper;if((0,o.isErrorOper)(s))return s;var u=t.mathpack;if(u.cond2(n,u.one)<0)return a.numErrorOper;if(u.cond2(n,u.fromNumber(i.length))>0)return a.numErrorOper;var c=i.sort(u.cond2);if(e){var l=(0,p.assertNumber)(u.add((0,p.assertNumber)(u.sub(u.fromNumber(i.length),n)),u.one));return c[u.lfix(l)-1]}return c[u.lfix(n)-1]}t.and=function(e,t){var r=e.dereferenceAllOpers(t);return X(e,r)},t.or=function(e,t){var r=e.dereferenceAllOpers(t);return ee(e,r)},t.xor=function(e,t){var r=e.dereferenceAllOpers(t);return te(e,r)};var ie=ne.bind(void 0,!0),ae=ne.bind(void 0,!1);function oe(e,t,r,n){var i=e.mathpack,s=[],u=(0,f.reduceDerefOpers)(e,re(s,p.assertNumber),b,t);if(null==u)return a.numErrorOper;if((0,o.isErrorOper)(u))return u;if((0,o.isErrorOper)(r))return r;if(i.cond(r)<0)return a.numErrorOper;if(i.cond2(r,i.one)>0)return a.numErrorOper;var c=s.sort(i.cond2),l=(0,p.assertNumber)(i.sub(i.fromNumber(c.length),i.one)),d=(0,p.assertNumber)(i.add(i.fromNumber(c.length),i.one)),m=n?(0,p.assertNumber)(i.mul(l,r)):(0,p.assertNumber)(i.sub((0,p.assertNumber)(i.mul(d,r)),i.one));if(i.cond(m)<0||i.cond2(m,l)>0)return a.numErrorOper;var h=i.lfix(m),v=(0,p.assertNumber)(i.sub(m,i.fromNumber(h)));if(0===i.cond(v))return c[h];var g=i.sub(c[h+1],c[h]);return(0,o.isErrorOper)(g)?g:i.add(c[h],(0,p.assertNumber)(i.mul(g,v)))}t.large=function(e,t){var r=e.dereferenceAllOpers(t),n=r[0],i=r[1];return ie(e,n,i)},t.small=function(e,t){var r=e.dereferenceAllOpers(t),n=r[0],i=r[1];return ae(e,n,i)};var se=function(e,t,r){return oe(e,[t],r,!0)};t.percentile=function(e,t){var r=e.dereferenceAllOpers(t),n=r[0],i=r[1];return se(e,n,i)};var ue=function(e,t,r){return oe(e,[t],r,!1)};function ce(e,t){var r=e.mathpack;if(r.cond(t)<0)return a.numErrorOper;if(r.cond2(t,r.fromNumber(5))>=0)return a.numErrorOper;var n=r.lfix(t);return r.div(r.fromNumber(n),r.fromNumber(4))}t.percentile_exc=function(e,t){var r=e.dereferenceAllOpers(t),n=r[0],i=r[1];return ue(e,n,i)};var le=function(e,t,r){return oe(e,[t],ce(e,r),!0)};t.quartile=function(e,t){var r=e.dereferenceAllOpers(t),n=r[0],i=r[1];return le(e,n,i)};var de=function(e,t,r){return oe(e,[t],ce(e,r),!1)};function fe(e,t){return oe(e,t,e.mathpack.fromNumber(.5),!0)}function pe(e){return function(t,r){var n=e(t,r);return void 0!==n&&(0,o.isNumberOper)(n)?t.mathpack.mul(n,n):n}}function me(e,t){return function(r,n){var i=e(r,n);if((null==i?void 0:i.kind)!==h.OperKind.Number)return i;var a=r.mathpack,s=a.sub(i,t);return(0,o.isErrorOper)(s)?s:a.mul(s,s)}}function he(e,t,r,n){var s={count:0};if(null==(0,f.reduceDerefOpers)(r,O(s),e,n,t))return a.div0ErrorOper;(0,i.assertTrue)("calc.funcs.varFirstPass: unexpected count type",s.count>=1);var u=y(r.mathpack.add),c=(0,f.reduceDerefOpers)(r,u,e,n,t),l=(0,f.reduceDerefOpers)(r,u,pe(e),n,void 0===t?void 0:pe(t));if((0,i.assertTrue)("calc.funcs.varFirstPass: expected sum",null!=c),(0,i.assertTrue)("calc.funcs.varFirstPass: expected sumSq",null!=l),(0,o.isErrorOper)(c))return c;if((0,o.isErrorOper)(l))return l;(0,i.assertTrue)("calc.funcs.varFirstPass: unexpected oper type",(0,o.isNumberOper)(c)&&(0,o.isNumberOper)(l));var d=r.mathpack,p=d.div(c,d.fromNumber(s.count));return(0,o.isErrorOper)(p)?p:[s.count,c,l,p]}function ve(e,t,r,n,a){var o=y(r.mathpack.add),s=(0,f.reduceDerefOpers)(r,o,me(e,a),n,void 0===t?void 0:me(t,a));return(0,i.assertTrue)("calc.funcs.varSecondPass: unexpected error",(null==s?void 0:s.kind)===h.OperKind.Number),s}function ge(e,t,r,n){var i=he(e,t,r,n);if(!Array.isArray(i))return i;var s=r.mathpack,u=i[0],c=i[1],l=i[2],d=i[3];if(u<2)return a.div0ErrorOper;var f=s.mul(c,c);if((0,o.isErrorOper)(f))return f;var m=(0,p.assertNumber)(s.div(f,s.fromNumber(u))),h=(0,p.assertNumber)(s.sub(l,m));if(0===s.cond(d))return s.cond(h)<0?s.zero:s.div(h,s.fromNumber(u-1));if(s.cond(h)>=0){var v=(0,p.assertNumber)(s.div(h,s.fromNumber(u-1)));if(s.cond2(v,s.fromNumber(21219957905e-324))>0){var g=s.div(m,l),b=(0,o.isErrorOper)(g)?g:s.sub(g,s.one);if(!(0,o.isErrorOper)(b)&&s.cond2(s.abs(b),s.fromNumber(.01))>0){var S=s.div(d,v),y=(0,o.isErrorOper)(S)?S:s.sub(s.abs(S),s.fromNumber(1e3));if(!(0,o.isErrorOper)(y)&&s.cond(y)<0)return v}}}var O=ve(e,t,r,n,d);return s.cond(O)<0?s.zero:s.div(O,s.fromNumber(u-1))}function be(e,t,r,n){var i=he(e,t,r,n);if(!Array.isArray(i))return i;var s=r.mathpack,u=i[0],c=i[1],l=i[2],d=i[3];if(u<1)return a.div0ErrorOper;var f=s.mul(c,c);if((0,o.isErrorOper)(f))return f;var m=s.mul(l,s.fromNumber(u));if((0,o.isErrorOper)(m))return m;var h=(0,p.assertNumber)(s.sub(m,f));if(0===s.cond(d))return s.cond(h)<0?s.zero:s.div(h,s.fromNumber(u*u));if(s.cond(h)>=0){var v=(0,p.assertNumber)(s.div(h,s.fromNumber(u*u)));if(s.cond2(v,s.fromNumber(21219957905e-324))>0){var g=s.div((0,p.assertNumber)(s.div(f,s.fromNumber(u))),l),b=(0,o.isErrorOper)(g)?g:s.sub(g,s.one);if(!(0,o.isErrorOper)(b)&&s.cond2(s.abs(b),s.fromNumber(.01))>0){var S=s.div(d,v),y=(0,o.isErrorOper)(S)?S:s.sub(s.abs(S),s.fromNumber(1e3));if(!(0,o.isErrorOper)(y)&&s.cond(y)<0)return v}}}var O=ve(e,t,r,n,d);return s.cond(O)<0?s.zero:s.div(O,s.fromNumber(u))}t.quartile_exc=function(e,t){var r=e.dereferenceAllOpers(t),n=r[0],i=r[1];return de(e,n,i)},t.median=function(e,t){var r=e.dereferenceAllOpers(t);return fe(e,r)},t.trimmean=function(e,t){var r=e.dereferenceAllOpers(t),n=r[0],s=r[1],u=[],c=(0,f.reduceDerefOpers)(e,re(u,p.assertNumber),b,[n]);if(null==c)return a.numErrorOper;if((0,o.isErrorOper)(c))return c;var l=e.mathpack;if(l.cond(s)<0)return a.numErrorOper;if(l.cond2(s,l.one)>=0)return a.numErrorOper;u=u.sort(l.cond2);var d=l.lfix((0,p.assertNumber)(l.div((0,p.assertNumber)(l.mul(l.fromNumber(u.length),s)),l.fromNumber(2))));(0,i.assertTrue)("calc.funcs.trimmean",d+d<u.length);var m=u[d],h=u[u.length-1-d],v=0,g=0,S=(0,f.reduceDerefOpers)(e,y(e.mathpack.add),(function(e,t){var r=b(0,t);if(void 0===r)return r;(0,i.assertTrue)("calc.funcs.trimmean: unexpected error",(0,o.isNumberOper)(r));var n=e.mathpack;if(n.cond2(r,m)<0)v+=1;else{if(!(n.cond2(r,h)>0))return r;g+=1}}),[n]);(0,i.assertTrue)("calc.funcs.trimmean: found no elements",void 0!==S&&(0,o.isNumberOper)(S)),(0,i.assertTrue)("calc.funcs.trimmean: trimmed too many",v<=d&&g<=d);for(var O=S;v<d;v+=1){var C=l.sub(O,m);if((0,o.isErrorOper)(C))return C;O=C}for(;g<d;g+=1){C=l.sub(O,h);if((0,o.isErrorOper)(C))return C;O=C}return l.div(O,l.fromNumber(u.length-d-d))};var Se=ge.bind(void 0,b,void 0),ye=be.bind(void 0,b,void 0),Oe=ge.bind(void 0,S,b),Ce=be.bind(void 0,S,b);function Pe(e){return function(t,r){var n=e(t,r);return(0,o.isNumberOper)(n)?t.mathpack.sqrt(n):n}}var Ne=Pe(Se),Re=Pe(ye),ke=Pe(Oe),Te=Pe(Ce);t.stdev=function(e,t){var r=e.dereferenceAllOpers(t);return Ne(e,r)},t.stdevp=function(e,t){var r=e.dereferenceAllOpers(t);return Re(e,r)},t.stdeva=function(e,t){var r=e.dereferenceAllOpers(t);return ke(e,r)},t.stdevpa=function(e,t){var r=e.dereferenceAllOpers(t);return Te(e,r)},t.var_=function(e,t){var r=e.dereferenceAllOpers(t);return Se(e,r)},t.varp=function(e,t){var r=e.dereferenceAllOpers(t);return ye(e,r)},t.vara=function(e,t){var r=e.dereferenceAllOpers(t);return Oe(e,r)},t.varpa=function(e,t){var r=e.dereferenceAllOpers(t);return Ce(e,r)};var Ee=[w,B,G,z,Q,F,Ne,Re,R,Se,ye];function _e(e,t){var r,n=[],s=(0,f.reduceDerefOpers)(e,(r=n,function(e,t,n){if(void 0!==e&&(0,o.isErrorOper)(e))return e;if((0,o.isNumberOper)(t))for(var i=0;i<n;i+=1)r.push({value:t,index:r.length});return t}),b,t);if(null==s)return a.naErrorOper;if((0,o.isErrorOper)(s))return s;var u=e.mathpack,c=n.sort((function(e,t){return u.cond2(e.value,t.value)})),l=1,d=0,p=1/0,m=[];function h(e){l=1,p=e.index}var v,g,S,y=function(e){var t=e.value;l>d?(d=l,m.length=0,m.push({value:t,index:p})):l===d&&m.push({value:t,index:p})};h(c[0]);for(var O=1;O<c.length;O+=1)g=c[O-1],S=c[O],0===u.cond2(g.value,S.value)?((v=c[O]).index<p&&(p=v.index),l+=1):(y(c[O-1]),h(c[O]));return y(c[c.length-1]),d<2?a.naErrorOper:((0,i.assertTrue)("calc.funcs.modeInner: unexpected error",0!==m.length),m.sort((function(e,t){return e.index-t.index})))}function Fe(e,t){var r=_e(e,t);return Array.isArray(r)?r[0].value:r}t.mode=function(e,t){return Fe(e,t)},t.mode_mult=function(e,t){var r=_e(e,t);return Array.isArray(r)?(0,a.arrayOper)(r.length,1,r.map((function(e){return[e.value]}))):r};var Ie=(0,g.binaryVisitor)(n.__assign(n.__assign({},(0,g.constVisitor)(!1)),{wsfNode:function(e){return e===d.WorksheetFuncId.SUBTOTAL||e===d.WorksheetFuncId.AGGREGATE}}),(function(e,t){return e||t}));function Ae(e){if(!(0,s.isRangeValues)(e))return e;var t=e.arrays.map((function(e){return e.map((function(e){var t,r=e[0],n=e[1];return void 0!==n&&(t=n.formula,(0,g.reduceBottomUp)(Ie,t))?void 0:r}))}));return(0,s.rangeValues)(t)}t.subtotal=function(e,t){var r=t[0],n=t.slice(1),i=e.mathpack.sfix(r),o=Ee.length;if(!(i>=1&&i<=o||i>=101&&i<=o+100))return a.valueErrorOper;var s=i>100||e.isInFilterMode(n),u=e.dereferenceAllOpersAndFormulae(n,s).map(Ae);return(0,Ee[i%100-1])(e,u)};var Me=n.__spreadArray(n.__spreadArray([],Ee,!0),[fe,Fe],!1),we=[ie,ae,se,le,ue,de];function De(e,t,r){var n=t[0],i=t[1],s=t[2],u=(void 0===s?a.falseOper:s).value?1:-1,c=0,l=0,d=e.mathpack,m=(0,f.reduceDerefOpers)(e,(function(e,t,r){if(void 0!==e)return e;if((0,o.isErrorOper)(t))return t;var i=d.cond2(n,(0,p.assertNumber)(t));0===i?c+=r:i===u&&(l+=r)}),b,e.dereferenceAllOpers([i]));if(void 0!==m)return m;if(0===c)return a.naErrorOper;var h=d.fromNumber(l+1);if(r){var v=d.div(d.fromNumber(c-1),d.fromNumber(2));return d.add(h,(0,p.assertNumber)(v))}return h}function je(e){return function(t,r){var n=e(t,r);return(null==n?void 0:n.kind)===h.OperKind.Number?t.mathpack.abs(n):n}}function xe(e,t,r){var n=I(b,void 0,!0,a.numErrorOper,t,r);if(!Array.isArray(n))return n;var s=n[0],u=n[1],c=(0,f.reduceDerefOpers)(t,y(t.mathpack.add),e(function(e,t){return function(r,n){var i=e(r,n);return(null==i?void 0:i.kind)===h.OperKind.Number?r.mathpack.sub(i,t):i}}(b,s)),r);return(0,i.assertTrue)("calc.funcs.sumDevAndCount",void 0!==c),(0,o.isErrorOper)(c)?c:[(0,p.assertNumber)(c),u]}t.aggregate=function(e,t){var r=t[0],n=t[1],u=t[2],c=t[3],l=t.slice(4),d=e.mathpack,p=d.sfix(r),m=d.sfix(n);if(!(p>=1&&p<=Me.length+we.length&&m>=0&&m<=7))return a.valueErrorOper;var v=1==(1&m),g=2==(2&m),b=!(4==(4&m));function S(t){var r=b?e.dereferenceAllOpersAndFormulae(t,v).map(Ae):e.dereferenceAllOpers(t,v);return g&&(r=r.map((function(e){if((0,f.isPrimitiveCoercedOper)(e))return e;if((0,s.isRangeValues)(e)){var t=e.arrays.map((function(e){return e.map((function(e){return void 0===e||(0,o.isErrorOper)(e)?void 0:e}))}));return(0,s.rangeValues)(t)}if((0,f.isCoercedArrayOper)(e)){var r=e.opers.map((function(e){return e.map((function(e){return void 0===e||(0,o.isErrorOper)(e)?void 0:e}))}));return(0,f.coercedArrayOper)(e.rows,e.cols,r)}return e}))),r}if(p>Me.length){if(void 0===c||l.length>0)return a.valueErrorOper;var y=h.OperKind.Number,O=e.coerceOper(e.dereferenceOper(c,y),y);if((0,o.isErrorOper)(O))return a.valueErrorOper;if((0,o.isRangeOper)(u)&&!(0,o.isSheetIndex)(u.sheets))return a.valueErrorOper;var C=S([u])[0],P=Me.length;return(0,we[p-P-1])(e,C,O)}for(var N=2;N<t.length;N+=1){var R=t[N];if(!R||!(0,o.isRangeOper)(R)||!(0,o.isSheetIndex)(R.sheets))return a.valueErrorOper}var k=S(t.slice(2));return(0,i.assertTrue)("calc.funcs.aggregate: requested non-array function with unexpected number",p>=1&&p<=Me.length),(0,Me[p-1])(e,k)},t.rank=function(e,t){return De(e,t,!1)},t.rank_avg=function(e,t){return De(e,t,!0)},t.avedev=function(e,t){var r=e.dereferenceAllOpers(t),n=xe(je,e,r);if(!Array.isArray(n))return n;var i=n[0],a=n[1];return e.mathpack.div(i,e.mathpack.fromNumber(a))},t.devsq=function(e,t){var r=e.dereferenceAllOpers(t),n=xe(pe,e,r);return Array.isArray(n)?n[0]:n}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.applyCriteria=t.compileCriteria=t.parseCriteria=void 0;var n=r(40),i=r(72),a=r(81),o=r(62),s=r(254),u=r(38),c=r(43),l=r(152),d=r(54),f=r(48),p={"=":i.OperatorId.Eq,"<":i.OperatorId.Lt,">":i.OperatorId.Gt},m={"<>":i.OperatorId.Ne,"<=":i.OperatorId.Le,">=":i.OperatorId.Ge};function h(e,t){if(!(0,u.isStringOper)(t))return t;var r,i,a=(r=t.value).length>=2&&void 0!==(i=m[r.substring(0,2)])?[i,r.substring(2)]:r.length>=1&&void 0!==(i=p[r.substring(0,1)])?[i,r.substring(1)]:[void 0,r];return{kind:"FilterExpression",operator:a[0],operand:function(e,t){var r=e.config.localeInfo;if(0===r.stringCompareCI(t,r.trueName))return n.trueOper;if(0===r.stringCompareCI(t,r.falseName))return n.falseOper;for(var i=1;i<r.errorNames.length;i+=1){var a=r.errorNames[i];if(null!=a&&0===r.stringCompareCI(a,t))return(0,n.errorOper)(i)}var o=e.parseGeneral(t,!1);return void 0!==o?o:(0,n.stringOper)(t)}(e,a[1])}}function v(e,t){var r="FilterExpression"===t.kind?t:{kind:"FilterExpression",operator:i.OperatorId.Eq,operand:t},n=e.config,a=n.mathpack,o=n.localeInfo;if(r.operator===i.OperatorId.Ne&&(0,d.isEmptyStringOper)(r.operand))return function(e){return!(0,u.isBlankOper)(e)};if(r.operator===i.OperatorId.Eq&&(0,d.isEmptyStringOper)(r.operand))return u.isBlankOper;if(void 0!==r.operator&&(0,d.isEmptyStringOper)(r.operand))return function(e){return!1};if(void 0===r.operator&&(0,d.isEmptyStringOper)(r.operand))return function(e){return(0,u.isBlankOper)(e)||(0,d.isEmptyStringOper)(e)};var p,m,h=void 0===r.operator?i.OperatorId.Eq:r.operator;switch(r.operand.kind){case f.OperKind.Number:return p=h,m=r.operand,function(t){var r=(0,u.isRichOper)(t)?t.getFallback():t;if((0,u.isNumberOper)(r))return(0,s.cmpNum)(a,p,r,m);if((0,u.isStringOper)(r)&&p===i.OperatorId.Eq){var n=e.parseGeneral(r.value,!1);return void 0!==n&&(0,s.cmpNum)(a,p,n,m)}return p===i.OperatorId.Ne};case f.OperKind.Boolean:return function(e,t){return function(r){var n=(0,u.isRichOper)(r)?r.getFallback():r;return(0,u.isBooleanOper)(n)?(0,s.cmpBool)(e,n,t):e===i.OperatorId.Ne}}(h,r.operand);case f.OperKind.String:return function(e,t){switch(e){case i.OperatorId.Eq:case i.OperatorId.Ne:var r=new l.WildExp(o,t.value);return function(t){var n=(0,u.isRichOper)(t)?t.getFallback():t;return(0,u.isStringOper)(n)?r.test(n.value)===(e===i.OperatorId.Eq):e===i.OperatorId.Ne};case i.OperatorId.Lt:case i.OperatorId.Gt:case i.OperatorId.Le:case i.OperatorId.Ge:return function(r){var n=(0,u.isRichOper)(r)?r.getFallback():r;return!!(0,u.isStringOper)(n)&&(0,s.cmpStr)(o,e,n,t)}}}(h,r.operand);case f.OperKind.Error:return function(e,t){return function(r){var n=(0,u.isRichOper)(r)?r.getFallback():r;return(0,u.isErrorOper)(n)?(0,s.cmpInt)(e,n.type-t.type):e===i.OperatorId.Ne}}(h,r.operand);default:return(0,c.assertNever)("calc.funcs.criteria.compileCriteria",r.operand)}}t.parseCriteria=h,t.compileCriteria=v,t.applyCriteria=function(e,t,r,n){var i=v(e,h(e,r)),s=t,u=void 0===n?s:n;return new a.NonstrictSparseArray2D(u.rows,u.cols,(0,o.fastMax)(s.denseRows,u.denseRows),(0,o.fastMax)(s.denseCols,u.denseCols),(function(e,t){var r=s.get(e,t);return i(r)?u.get(e,t):void 0}),(function(){var e=s.getSparse();return i(e)?u.getSparse():void 0}))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.surrogatePairToCodePoint=t.stringFromCodePoint=t.stringCodePointAt=t.scanCodePointsBack=t.scanCodePoints=t.numCodeUnits=t.makeGetCharCodeBits=t.isLowSurrogate=t.isHighSurrogate=t.isAnySurrogate=t.forEachClassInterval=t.countCodePoints=t.codePointIterator=t.CharCodeBits=void 0;var n=r(7);t.CharCodeBits=n.unicode.CharCodeBits,t.codePointIterator=n.unicode.codePointIterator,t.countCodePoints=n.unicode.countCodePoints,t.forEachClassInterval=n.unicode.forEachClassInterval,t.isAnySurrogate=n.unicode.isAnySurrogate,t.isHighSurrogate=n.unicode.isHighSurrogate,t.isLowSurrogate=n.unicode.isLowSurrogate,t.makeGetCharCodeBits=n.unicode.makeGetCharCodeBits,t.numCodeUnits=n.unicode.numCodeUnits,t.scanCodePoints=n.unicode.scanCodePoints,t.scanCodePointsBack=n.unicode.scanCodePointsBack,t.stringCodePointAt=n.unicode.stringCodePointAt,t.stringFromCodePoint=n.unicode.stringFromCodePoint,t.surrogatePairToCodePoint=n.unicode.surrogatePairToCodePoint},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.reduceDerefOpers=t.isPrimitiveCoercedOper=t.isCoercedArrayOper=t.coercedArrayOper=void 0;var n=r(138),i=r(81),a=r(43),o=r(48);t.coercedArrayOper=function(e,t,r){return(0,a.assertNatural)("calc.runtime.coercedArrayOper",e),(0,a.assertNatural)("calc.runtime.coercedArrayOper",t),r.length!==e?(0,a.assertFalse)("calc.runtime.coercedArrayOper: Inconsistent row number"):{kind:o.OperKind.Array,rows:e,cols:t,opers:r}},t.isCoercedArrayOper=function(e){return e.kind===o.OperKind.Array};var s=o.OperKind.Number|o.OperKind.String|o.OperKind.Boolean;t.isPrimitiveCoercedOper=function(e){var t=e.kind;return"number"==typeof t&&0!=(t&s)},t.reduceDerefOpers=function(e,t,r,a,s){var u=function(n,a,u,l){if((null==a?void 0:a.kind)===o.OperKind.Array){for(var d=new i.StrictArray2D(a.rows,a.cols,a.opers),f=n,p=0;p<u;p+=1)f=c(f,d);return f}var m=(l&&void 0!==s?s:r)(e,a);return null==m?n:t(n,m,u)};function c(e,t){for(var r=e,n=0;n<t.rows;n+=1)for(var i=0;i<t.cols;i+=1){var a=t.get(n,i);void 0!==a&&(r=u(r,a,1,!0))}return r}function l(e,t){for(var r=e,n=t.getSparse(),i=t.cols-t.denseCols,a=0;a<t.denseRows;a+=1){for(var o=0;o<t.denseCols;o+=1){var s=t.get(a,o);void 0!==s&&(r=u(r,s,1,!1))}i>0&&void 0!==n&&(r=u(r,n,i,!1))}var c=(t.rows-t.denseRows)*t.cols;return c>0&&void 0!==n&&(r=u(r,n,c,!1)),r}return a.reduce((function(e,t){return(0,n.isRangeValues)(t)?t.arrays.reduce(l,e):u(e,t,1,!1)}),void 0)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.yearFrac=t.networkdays=t.networkdays_intl=t.eomonth=t.edate=t.workday=t.workday_intl=t.days=t.datedif=t.days360=t.time=t.date=t.weeknum=t.isoweeknum=t.weekday=t.second=t.minute=t.hour=t.day=t.month=t.year=void 0;var n=r(2),i=r(40),a=r(265),o=r(106),s=r(38),u=r(60),c=r(48),l=r(43);function d(e,t,r){var n=r[0],o=t.datepack,s=t.config,u=o.fromNum(s,n,a.Rounding.RoundSec);return!1===u?i.numErrorOper:t.mathpack.fromNumber(e(u))}function f(e,t,r){var o=t[0],s=t[1];void 0===r&&(r=!1);var u,c=e.config,l=e.mathpack,d=e.datepack.fromNum(n.__assign(n.__assign({},c),{date1904:c.date1904&&!r}),o,a.Rounding.RoundSec);if(!1===d)return i.numErrorOper;switch(void 0!==s?l.sfix(s):1){case 1:case 17:u=d.wdy;break;case 2:case 11:u=1===d.wdy?7:d.wdy-1;break;case 3:u=1===d.wdy?6:d.wdy-2;break;case 12:u=(d.wdy+4)%7+1;break;case 13:u=(d.wdy+3)%7+1;break;case 14:u=(d.wdy+2)%7+1;break;case 15:u=(d.wdy+1)%7+1;break;case 16:u=d.wdy%7+1;break;default:return i.numErrorOper}return l.fromNumber(u)}function p(e,t,r){if(!t){var n=e.lfix(r);if(0===n||1===n)return e.fromNumber(52)}return i.numErrorOper}function m(e,t,r){var u=r[0],c=r[1],d=(0,o.chkDateOper)(t,u);if((0,s.isErrorOper)(d))return d;var m=function(e,t,r){if(void 0===t||(0,s.isMissingOper)(t))return[r?2:1,r];var n=(0,o.chkNumOper)(e,t);if(!(0,s.isErrorOper)(n)){var i=e.mathpack.sfix(n);if(r){if(1===i||2===i)return[i,r]}else{if(1===i||2===i)return[i,r];if(i>=11&&i<=16)return[i-9,r];if(17===i)return[1,r];if(21===i)return[2,!0]}}return[void 0,r]}(t,c,e),h=m[0],v=m[1];if(void 0===h)return i.numErrorOper;var g=t.mathpack,b=t.datepack,S=t.config,y=n.__assign(n.__assign({},S),{date1904:!1}),O=b.fromNum(y,d,a.Rounding.RoundSec);if(!1===O)return p(g,y.dateCompatibility,d);var C=(0,a.dateTime)(O.yr,1,1,0,0,0,0,0,a.Rounding.RoundSec),P=b.toNum(y,C);if((0,s.isErrorOper)(P))return p(g,y.dateCompatibility,d);var N=f(t,[P],!0);if((0,s.isErrorOper)(N))return N;var R=(0,o.assertNumber)(g.add((0,o.assertNumber)(g.sub(N,g.fromNumber(h))),g.fromNumber(7))),k=(0,o.assertNumber)((0,o.numMod)(g,R,g.fromNumber(7))),T=(0,o.assertNumber)(g.add(g.floor((0,o.assertNumber)(g.div((0,o.assertNumber)(g.add((0,o.assertNumber)(g.sub(d,P)),k)),g.fromNumber(7)))),g.one));return v?function(e,t,r,i){var a=e.mathpack,s=e.datepack,u=e.config,c=n.__assign({},i),d=(t+6-c.wdy)%7;if(12===c.mon&&c.dom+d>=35)return a.one;c.dom=4,c.mon=1;var f=s.toDays(u,c);if((0,l.assertTrue)("calc.funcs.weeknumISOAmendments",!1!==f),((f=(f-1)%7+1)-t+7)%7<3){var p=(0,o.assertNumber)(a.sub(r,a.one));if(0===a.cond(p)){var m=c.yr-1;return t===f||m%4==0&&(m%100!=0||m%400==0)&&(t-f+7)%7==6?a.fromNumber(53):a.fromNumber(52)}return p}return r}(t,h,T,O):T}t.year=d.bind(void 0,(function(e){return e.yr})),t.month=d.bind(void 0,(function(e){return e.mon})),t.day=d.bind(void 0,(function(e){return e.dom})),t.hour=d.bind(void 0,(function(e){return e.hour})),t.minute=d.bind(void 0,(function(e){return e.min})),t.second=d.bind(void 0,(function(e){return e.sec})),t.weekday=function(e,t){return f(e,t)},t.isoweeknum=m.bind(void 0,!0),t.weeknum=m.bind(void 0,!1);t.date=function(e,t){var r=t[0],n=t[1],o=t[2],s=e.mathpack,u=e.datepack,c=e.config,l=s.sfix(r);if(l>9999)return i.numErrorOper;var d=s.sfix(n);if(d>32767||d<-32768)return i.numErrorOper;var f=s.sfix(o);(f>32767||f<-32768)&&(f=32767),c.dateCompatibility?l<1900&&(l+=1900):l<1900&&!(1899===l&&12===d&&f>=30)&&(l+=1900);var p=(0,a.dateTime)(l,d,f,0,0,0,0,0,a.Rounding.RoundSec);return u.toNum(c,p)};var h;function v(e,t){var r;if((0,s.isStringOper)(t)){var n=t.value.replace(/^\s+/,"");if(r=e.coerceOper((0,i.stringOper)(n),c.OperKind.Number),(0,s.isErrorOper)(r))return r}else r=t;return(0,o.chkDateOper)(e,r)}function g(e,t,r){return r?(0,o.assertNumber)(e.sub(t,e.fromNumber(o.atpm1904to1900Days))):t}function b(e,t){return 0!=(e>>t%7&1)}function S(e){switch(e){case 1:return h.Saturday|h.Sunday;case 2:return h.Sunday|h.Monday;case 3:return h.Monday|h.Tuesday;case 4:return h.Tuesday|h.Wednesday;case 5:return h.Wednesday|h.Thursday;case 6:return h.Thursday|h.Friday;case 7:return h.Friday|h.Saturday;case 11:return h.Sunday;case 12:return h.Monday;case 13:return h.Tuesday;case 14:return h.Wednesday;case 15:return h.Thursday;case 16:return h.Friday;case 17:return h.Saturday;default:return!1}}function y(e){if(7!==e.length)return!1;for(var t=h.None,r=0;r<e.length;r+=1)if("1"===e[r])t|=1<<(r+2)%7;else if("0"!==e[r])return!1;return t}function O(e,t){var r=t[0],n=t[1],a=t[2],l=t[3],d=h.Saturday|h.Sunday,f=(0,o.chkDateOper)(e,r);if((0,s.isErrorOper)(f))return f;var p=(0,o.chkNumOper)(e,n);if((0,s.isErrorOper)(p))return p;var m=e.mathpack,v=e.config;p=m.floor(p);var O=m.cond(p)>0?m.one:m.fromNumber(-1),C=m.abs(p),P=(0,o.assertNumber)(m.add(f,p));if(!(0,o.validDateRange)(e,P))return i.numErrorOper;if(0===m.cond(C))return g(m,f,v.date1904);var N=null,R=[];if(a){if(!(0,s.isMissingOper)(a)){if((0,s.isNumberOper)(a)){var k=S(m.lfix(a));if(!1===k)return i.numErrorOper;d=k}else{if(!(0,s.isStringOper)(a))return i.numErrorOper;var T=y(a.value);if(!1===T)return i.valueErrorOper;d=T}if(127===d)return i.valueErrorOper}if(l&&!(0,s.isMissingOper)(l)){var E=(0,o.chkNumMultiOper)(e,l);if(!(0,u.isSuccess)(E))return E.reason;N=E.value}}for(var _=null==N?[]:function(e){for(var t=[],r=e.getSparse(),n=e.cols-e.denseCols,i=0;i<e.denseRows;i+=1){for(var a=0;a<e.denseCols;a+=1){var o=e.get(i,a);void 0!==o&&t.push(o)}if(n>0&&void 0!==r)for(var s=0;s<n;s+=1)t.push(r)}var u=(e.rows-e.denseRows)*e.cols;if(u>0&&void 0!==r)for(i=0;i<u;i+=1)t.push(r);return t}(N),F=_.length-1;F>=0;F-=1){var I=_[F];switch(I.kind){case c.OperKind.Number:case c.OperKind.String:case c.OperKind.Blank:var A=(0,o.chkDateOper)(e,I);if((0,s.isErrorOper)(A))return A;R[F]=A;break;case c.OperKind.Error:return I;default:return i.valueErrorOper}}for(;m.cond(C)>0;){if(f=(0,o.assertNumber)(m.add(f,O)),!b(d,m.lfix(f))){var M=!0;for(F=0;F<_.length;F+=1)if(0===m.cond2(R[F],f)){M=!1;break}M&&(C=(0,o.assertNumber)(m.sub(C,m.one)))}}return f=g(m,f,v.date1904),(0,o.validDateRange)(e,f)?f:i.numErrorOper}t.time=function(e,t){var r=t[0],n=t[1],o=t[2],u=e.mathpack,c=e.datepack,l=e.config,d=u.sfix(r);if(d>32767)return i.numErrorOper;var f=u.sfix(n);if(f>32767)return i.numErrorOper;var p,m,h,v=u.sfix(o);if(v>32767)return i.numErrorOper;l.dateCompatibility?(p=l.date1904?1904:1900,m=1,h=l.date1904?1:0):(p=1899,m=12,h=30);var g=(0,a.dateTime)(p,m,h,d,f,v,0,0,a.Rounding.RoundSec),b=c.toNum(l,g);return(0,s.isErrorOper)(b)?b:u.cond(b)<0?i.numErrorOper:u.sub(b,u.trunc(b))},t.days360=function(e,t){var r,n=t[0],o=t[1],s=t[2],u=e.mathpack,c=e.datepack,l=e.config,d=null!==(r=null==s?void 0:s.value)&&void 0!==r&&r,f=c.fromNum(l,n,a.Rounding.RoundSec);if(!1===f)return i.naErrorOper;var p=31===f.dom||!d&&2===f.mon&&f.dom===c.daysPerMonth(2,f.yr,l.dateCompatibility)?30:f.dom,m=u.fromNumber(360*(f.yr-1900)+30*f.mon+p),h=c.fromNum(l,o,a.Rounding.RoundSec);if(!1===h)return i.naErrorOper;var v=31!==h.dom||!d&&30!==f.dom?h.dom:30,g=u.fromNumber(360*(h.yr-1900)+30*h.mon+v);return u.sub(g,m)},t.datedif=function(e,t){var r=t[0],n=t[1],o=t[2].value;if(o.length>2||0===o.length)return i.numErrorOper;var s=e.mathpack,u=e.datepack,c=e.config,l=s.lfix(r),d=u.fromNum(c,r,a.Rounding.RoundSec);if(!1===d)return i.numErrorOper;var f=e.mathpack.lfix(n),p=u.fromNum(c,n,a.Rounding.RoundSec);if(!1===p)return i.numErrorOper;if(l>f)return i.numErrorOper;var m=p.dom,h=p.mon,v=p.yr;d.dom>m&&(0===(h-=1)&&(h=12,v-=1),m+=u.daysPerMonth(h,v,c.dateCompatibility)),d.mon>h&&(h+=12,v-=1);var g=function(e,t){return 0===c.localeInfo.stringCompareCI(e,t)};if(g(o,"Y"))return s.fromNumber(v-d.yr);if(g(o,"M"))return s.fromNumber(12*(v-d.yr)+(h-d.mon));if(g(o,"D"))return s.fromNumber(f-l);if(g(o,"MD"))return s.fromNumber(m-d.dom);if(g(o,"YM"))return s.fromNumber(h-d.mon);if(g(o,"YD")){for(var b=0,S=d.mon;S<h;S+=1)b+=u.daysPerMonth(S,d.yr,c.dateCompatibility);return s.fromNumber(b+(m-d.dom))}return i.numErrorOper},t.days=function(e,t){var r=t[0],n=t[1];if((0,s.isStringOper)(r)&&r.value.length>255||(0,s.isStringOper)(n)&&n.value.length>255)return i.valueErrorOper;var a=v(e,r);if((0,s.isErrorOper)(a))return a;var o=v(e,n);return(0,s.isErrorOper)(o)?o:e.mathpack.sub(a,o)},function(e){e[e.None=0]="None",e[e.Saturday=1]="Saturday",e[e.Sunday=2]="Sunday",e[e.Monday=4]="Monday",e[e.Tuesday=8]="Tuesday",e[e.Wednesday=16]="Wednesday",e[e.Thursday=32]="Thursday",e[e.Friday=64]="Friday"}(h||(h={})),t.workday_intl=O,t.workday=function(e,t){var r=t[0],n=t[1],a=t[2];return O(e,a?[r,n,i.missingOper,a]:[r,n])};var C;function P(e,t,r,i){var u=e.mathpack,c=e.datepack,l=e.config,d=n.__assign(n.__assign({},l),{date1904:!1}),f=c.fromNum(d,t,a.Rounding.RoundSec);if(!1===f)return f;var p=u.fromNumber(f.dom),m=u.fromNumber(f.mon),h=u.fromNumber(12),v=u.fromNumber(f.yr);if(u.cond(r)>=0){v=(0,o.assertNumber)(u.add(u.floor((0,o.assertNumber)(u.div(r,h))),v));var g=(0,o.assertNumber)((0,o.numMod)(u,r,h)),b=(0,o.assertNumber)(u.add(g,m));1===u.cond2(b,h)&&(v=(0,o.assertNumber)(u.add(v,u.one))),m=(0,o.assertNumber)((0,o.numMod)(u,b,h))}else{var S=u.neg(r),y=u.floor((0,o.assertNumber)(u.div(S,h)));v=(0,o.assertNumber)(u.sub(v,y));g=(0,o.assertNumber)((0,o.numMod)(u,S,h));if(u.cond2(g,m)>=0)v=(0,o.assertNumber)(u.sub(v,u.one)),m=(0,o.assertNumber)(u.add((0,o.assertNumber)(u.sub(m,g)),h));else{var O=(0,o.assertNumber)(u.sub(m,g));m=(0,o.assertNumber)((0,o.numMod)(u,O,h))}}0===u.cond(m)&&(m=h);var C=u.lfix(m);switch(C){case 4:case 6:case 9:case 11:var P=u.fromNumber(30);u.cond2(p,P)>0&&(p=P);break;case 2:u.cond2(p,u.fromNumber(28))>0&&(p=u.fromNumber(c.daysPerMonth(2,u.toNumber(v),!1)))}if(i&&(p=u.fromNumber(c.daysPerMonth(C,u.toNumber(v),!1))),u.lfix(v)<(d.dateCompatibility?1900:-9999))return!1;var N=function(e,t,r,n,i,o){var s=e.lfix(n),u=e.lfix(i),c=e.lfix(o);return t.toNum(r,(0,a.dateTime)(c,u,s,0,0,0,0,0,a.Rounding.RoundSec))}(u,c,d,p,m,v);return!(0,s.isErrorOper)(N)&&N}function N(e,t,r){var n=r[0],a=r[1],u=(0,o.chkDateOper)(t,n);if((0,s.isErrorOper)(u))return u;var c=(0,o.chkNumOper)(t,a);if((0,s.isErrorOper)(c))return c;var l=t.mathpack,d=t.config,f=P(t,u,c=l.cond(c)>0?l.floor(c):l.ceil(c),!e);return!1===f?i.numErrorOper:g(l,f,d.date1904)}function R(e,t){var r,n=t[0],a=t[1],u=t[2],l=t[3],d=e.mathpack,f=h.Saturday|h.Sunday,p=5;function m(e){p=7;for(var t=f=e;0!==t;)1==(1&t)&&(p-=1),t>>=1}if(void 0!==u&&!(0,s.isMissingOper)(u))if((0,s.isStringOper)(u)){var v=y(u.value);if(!1===v)return i.valueErrorOper;m(v)}else{var g=(0,o.chkNumOper)(e,u);if((0,s.isErrorOper)(g))return i.valueErrorOper;var O=S(d.lfix(g));if(!1===O)return i.numErrorOper;m(O)}var C=null!=l?l:i.missingOper,P=(0,o.chkDateOper)(e,n);if((0,s.isErrorOper)(P))return P;var N=(0,o.chkDateOper)(e,a);if((0,s.isErrorOper)(N))return N;var R,k=d.lfix(P),T=d.lfix(N);k>T?(R=k,k=T,T=R,r=-1):r=1,R=k%7,R=T%7;for(var E=0,_=k<T?k:T,F=k<T?T:k;_%7!=0&&_!==F;)b(f,_)||(E+=1),_+=1;for(;F%7!=6&&_!==F;)b(f,F)||(E+=1),F-=1;if(F===_&&1!=(f>>_%7&1)&&(E+=1),k>T){var I=_;_=F,F=I}var A=d.fromNumber(p*Math.floor((F+1-_)/7)+E);switch(C.kind){case c.OperKind.Number:case c.OperKind.String:var M=(0,o.chkDateOper)(e,C);if((0,s.isErrorOper)(M))return M;(R=d.lfix(M))>=k&&R<=T&&R%7>=2&&(A=(0,o.assertNumber)(d.sub(A,d.one)));break;case c.OperKind.Range:case c.OperKind.Array:var w=function(e,t,r,n,a,u){var l,d=e.mathpack;if(void 0===u||(0,s.isMissingOper)(u))l=h.Saturday|h.Sunday;else if((0,s.isStringOper)(u)){var f=y(u.value);if(!1===f)return i.valueErrorOper;l=f}else{var p=(0,o.chkNumOper)(e,u);if((0,s.isErrorOper)(p))return i.valueErrorOper;var m=S(d.lfix(p));if(!1===m)return i.numErrorOper;l=m}var v=d.fromNumber(r),g=d.fromNumber(n),O=e.dereferenceOper(a,c.OperKind.Array);if(!(0,s.isArrayOper)(O))return i.valueErrorOper;var C=[];function P(e){if(d.cond2(e,v)>=0&&d.cond2(e,g)<=0){var t=d.lfix(e);b(l,t)||C.push(e)}}for(var N=0;N<O.rows;N+=1)for(var R=0;R<O.cols;R+=1){var k=O.opers[N][R];switch(k.kind){case c.OperKind.Number:case c.OperKind.String:var T=(0,o.chkDateOper)(e,k);if((0,s.isErrorOper)(T))return T;P(T);break;case c.OperKind.Blank:break;case c.OperKind.Error:return k;default:return i.valueErrorOper}}var E=t;if(0!==C.length){var _=C.sort((function(e,t){return d.cond2(e,t)})),F=_[0];E=(0,o.assertNumber)(d.sub(E,d.one));for(N=0;N<_.length;N+=1){var I=_[N];0!==d.cond2(I,F)&&(F=I,E=(0,o.assertNumber)(d.sub(E,d.one)))}}return E}(e,A,k,T,C,u);if((0,s.isErrorOper)(w))return w;A=w;break;case c.OperKind.Error:return C;case c.OperKind.Missing:break;default:return i.valueErrorOper}return d.mul(d.fromNumber(r),A)}function k(e,t,r,n,i,a,o){var s=360*(r-t),u=30*(i-n);return e.mathpack.fromNumber(o-a+u+s)}function T(e,t,r,n){var i=e.datepack,a=e.config;return t===i.daysPerMonth(r,n,a.dateCompatibility)}function E(e,t,r,n,i){var s=e.mathpack;switch(s.cond2(t,r)){case 1:break;case 0:return s.zero;case-1:switch(n){case C.Basis30360:return function(e,t,r,n,i){var o=e.datepack,s=e.config,u=o.fromNum(s,t,a.Rounding.RoundSec);if(!1===u)return!1;var c=u.dom,l=u.mon,d=u.yr,f=o.fromNum(s,r,a.Rounding.RoundSec);if(!1===f)return!1;var p=f.dom,m=f.mon,h=f.yr;return 2===p&&T(e,p,m,h)&&(2===c&&T(e,c,l,d)||3===n)&&(p=30),31===p&&(c>=30||3===n)&&(p=30),31===c&&(c=30),i&&2===l&&T(e,c,l,d)&&(c=30),k(e,d,h,l,m,c,p)}(e,t,r,i,!0);case C.BasisActual360:case C.BasisActual365:case C.BasisActual:return(0,o.assertNumber)(s.sub(r,t));case C.BasisE30360:return function(e,t,r){var n=e.datepack,i=e.config,o=n.fromNum(i,t,a.Rounding.RoundSec);if(!1===o)return!1;var s=o.dom,u=o.mon,c=o.yr,l=n.fromNum(i,r,a.Rounding.RoundSec);if(!1===l)return!1;var d=l.dom,f=l.mon;return 31===s&&(s=30),31===d&&(d=30),k(e,c,l.yr,u,f,s,d)}(e,t,r)}}return!1}t.edate=N.bind(void 0,!0),t.eomonth=N.bind(void 0,!1),t.networkdays_intl=R,t.networkdays=function(e,t){var r=t[0],n=t[1],a=t[2];return R(e,a?[r,n,i.missingOper,a]:[r,n])},function(e){e[e.DefaultBasis=0]="DefaultBasis",e[e.Basis30360=0]="Basis30360",e[e.BasisActual=1]="BasisActual",e[e.BasisActual360=2]="BasisActual360",e[e.BasisActual365=3]="BasisActual365",e[e.BasisE30360=4]="BasisE30360"}(C||(C={})),t.yearFrac=function(e,t){var r=t[0],n=t[1],u=t[2],c=C.DefaultBasis;if(void 0!==u){var l=function(e,t){var r=C.DefaultBasis;if(void 0===t||(0,s.isMissingOper)(t))return r;var n=(0,o.chkNumOper)(e,t);if((0,s.isErrorOper)(n))return n;var a=e.mathpack;switch(r=a.lfix(a.floor(n))){case C.Basis30360:case C.BasisActual:case C.BasisActual360:case C.BasisActual365:case C.BasisE30360:return r;default:return i.numErrorOper}}(e,u);if("number"!=typeof l)return l;c=l}var d=(0,o.chkDateOper)(e,r);if((0,s.isErrorOper)(d))return d;var f=(0,o.chkDateOper)(e,n);if((0,s.isErrorOper)(f))return f;var p=e.mathpack;if(p.cond2(d,f)>0){var m=d;d=f,f=m}var h=E(e,d,f,c,0);if(!1===h)return i.numErrorOper;var v=function(e,t,r,n){var i=e.mathpack,u=e.datepack,c=e.config,l=i.fromNumber(360),d=i.fromNumber(365),f=i.fromNumber(366);switch(t){case C.BasisActual:var p=u.fromNum(c,r,a.Rounding.RoundSec);if(!1===p)return!1;var m=p.dom,h=p.mon,v=p.yr,g=u.fromNum(c,n,a.Rounding.RoundSec);if(!1===g)return!1;var b=g.dom,S=g.mon,y=g.yr,O=y-1;if(v===y)return 29===u.daysPerMonth(2,v,c.dateCompatibility)?f:d;if(O===v&&(h>S||h===S&&m>=b)){if(29===u.daysPerMonth(2,v,c.dateCompatibility)){var P=u.toNum(c,(0,a.dateTime)(v,2,29,0,0,0,0,0,a.Rounding.RoundSec));return!(0,s.isErrorOper)(P)&&(i.cond2(P,r)>=0?f:d)}if(29===u.daysPerMonth(2,y,c.dateCompatibility)){P=u.toNum(c,(0,a.dateTime)(v,2,29,0,0,0,0,0,a.Rounding.RoundSec));return!(0,s.isErrorOper)(P)&&(i.cond2(P,n)<=0?f:d)}return d}for(var N=0,R=v;R<=y;R+=1)29===u.daysPerMonth(2,R,c.dateCompatibility)?N+=366:N+=365;var k=i.fromNumber(y-v+1);return(0,o.assertNumber)(i.div(i.fromNumber(N),k));case C.Basis30360:case C.BasisActual360:case C.BasisE30360:return l;case C.BasisActual365:return d;default:return l}}(e,c,d,f);return!1===v?i.numErrorOper:p.div(h,v)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.xlDatepack=t.tzUTC=t.tzData=t.dateTime=t.TimeGranularity=t.TimeDivision=t.Rounding=void 0;var n=r(3);t.Rounding=n.datepack.Rounding,t.TimeDivision=n.datepack.TimeDivision,t.TimeGranularity=n.datepack.TimeGranularity,t.dateTime=n.datepack.dateTime,t.tzData=n.datepack.tzData,t.tzUTC=n.datepack.tzUTC,t.xlDatepack=n.datepack.xlDatepack},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.gestep=t.delta=void 0;var n=r(106),i=r(38);function a(e,t){var r=t[0],a=t[1],o=void 0===a||(0,i.isMissingOper)(a)?e.mathpack.zero:(0,n.chkNumOper)(e,a);if((0,i.isErrorOper)(o))return o;var s=(0,n.chkNumOper)(e,r);return(0,i.isErrorOper)(s)?s:[s,o]}t.delta=function(e,t){var r=a(e,t);if(!Array.isArray(r))return r;var n=r[0],i=r[1],o=e.mathpack;return 0===o.cond2(n,i)?o.one:o.zero},t.gestep=function(e,t){var r=a(e,t);if(!Array.isArray(r))return r;var n=r[0],i=r[1],o=e.mathpack;return o.cond2(n,i)>=0?o.one:o.zero}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.info=t.error_type=t.type=t.n_=t.t_=t.na=void 0;var n=r(40),i=r(71),a=r(38),o=r(43),s=r(48),u=r(54);function c(e,t){if((0,a.isRangeOper)(t)){if((0,a.isSheetIndex)(t.sheets)){var r=(0,n.rangeSeqOper)(t.sheets,[(0,a.gridRangeAnchor)(t.ranges[0])]);return e.dereferenceOper(r,i.readOperType)}return n.valueErrorOper}return t}t.na=function(e,t){return n.naErrorOper},t.t_=function(e,t){var r=c(e,t[0]);return(0,a.isStringOper)(r)||(0,a.isErrorOper)(r)?r:u.emptyStringOper},t.n_=function(e,t){var r=c(e,t[0]);if((0,a.isNumberOper)(r)||(0,a.isErrorOper)(r))return r;var n=e.mathpack;return(0,a.isBooleanOper)(r)&&r.value?n.one:n.zero},t.type=function(e,t){var r=t[0],n=e.mathpack;switch(r.kind){case s.OperKind.Number:return n.fromNumber(1);case s.OperKind.String:return n.fromNumber(2);case s.OperKind.Boolean:return n.fromNumber(4);case s.OperKind.Error:return n.fromNumber(16);case s.OperKind.Array:return n.fromNumber(64);case s.OperKind.Rich:return n.fromNumber(128);default:return(0,o.assertNever)("calc.funcs.type",r)}},t.error_type=function(e,t){var r=t[0];return(0,a.isErrorOper)(r)?e.mathpack.fromNumber(r.type):n.naErrorOper},t.info=function(e,t){return n.valueErrorOper}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.arity=t.makearray=t.apply=void 0;var n=r(40),i=r(119),a=r(71),o=r(71),s=r(52),u=r(38);function c(e,t,r){var o=(0,a.refToVal)(e,t,!0);return o instanceof i.LambdaOper?void 0===r||r>=o.minArity&&r<=o.maxArity?o:n.naErrorOper:(0,u.isErrorOper)(o)?o:n.refErrorOper}t.apply=function(e,t){var r=t[0],n=t.slice(1),i=c(e,r,n.length);return(0,u.isErrorOper)(i)?i:e.applyLambda(i,n)},t.makearray=function(e,t){var r=t[0],i=t[1],a=t[2],l=c(e,a,2);if((0,u.isErrorOper)(l))return l;var d=e.mathpack,f=(0,u.isMissingOper)(r)?1:d.fix(r),p=(0,u.isMissingOper)(i)?1:d.fix(i);if(f<1||p<1)return n.valueErrorOper;if(f*p>1e6)return(0,s.throwEvaluationError)((0,u.notImplemented)(["MAKEARRAY with very large size"]));var m=[n.falseOper,n.falseOper];return(0,o.machineCall)(new o.ArrayMachine(e,f,p,(function(t,r){return(0,o.machineCall)(new o.ThenMachine(e,(function(){var n=e.mathpack;return m[0]=n.fromNumber(t+1),m[1]=n.fromNumber(r+1),e.applyLambda(l,m)}),(function(e){return(0,u.isRangeOper)(e)?(0,s.throwEvaluationError)((0,u.notImplemented)(["MAKEARRAY with nested RangeOper"])):(0,u.isArrayOper)(e)?(0,s.throwEvaluationError)((0,u.notImplemented)(["MAKEARRAY with nested ArrayOper"])):e})))})))},t.arity=function(e,t){var r=(0,a.refToVal)(e,t[0],!0);return r instanceof i.LambdaOper?e.mathpack.fromNumber(r.maxArity):n.naErrorOper}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.not=t.false_=t.true_=t.switch_=t.ifs=t.choose=t.if_=void 0;var n=r(40),i=r(43),a=r(54),o=r(72),s=r(38),u=r(52),c=r(48),l=(0,a.makeStrict)((0,o.getWorksheetFuncType)(o.WorksheetFuncId.IFS)),d=(0,a.makeStrict)((0,o.getWorksheetFuncType)(o.WorksheetFuncId.SWITCH));function f(e,t,r,n){var i=n.slice();return e.dereferenceOpers(i,t),(0,a.arrayLift)(e,t,(function(n){for(var i=[],a=0;a<n.length;a+=1){var o=(0,s.getArgType)(t,a,n.length);i[a]=e.coerceOper(n[a],o)}return r(e,i)}),i)}t.if_=function(e,t){var r=t[0];(0,i.assertTrue)("calc.funcs.if: condition is not a boolean",(0,s.isBooleanOper)(r));var n=t[r.value?1:2];return(0,i.assertTrue)("calc.funcs.if: result is undefined",void 0!==n),n},t.choose=function(e,t){var r=t[0];(0,i.assertTrue)("calc.funcs.choose",(0,s.isNumberOper)(r));var a=e.mathpack.fix(r);return a<1||a>t.length-1?n.valueErrorOper:t[a]},t.ifs=function e(t,r){for(var a=0;a<r.length;a+=2){var o=r[a];if((0,s.isArrayOper)(o)){var u=r.slice(a);return f(t,l,e,u)}if((0,s.isErrorOper)(o))return o;if((0,i.assertTrue)("calc.funcs.ifs",(0,s.isBooleanOper)(o)),o.value)return r[a+1]}return n.naErrorOper},t.switch_=function e(t,r){var a=r[0];if((0,s.isArrayOper)(a))return f(t,d,e,r);if((0,s.isErrorOper)(a))return a;for(var o=function(e,t){var r=e.mathpack,n=e.localeInfo;switch(t.kind){case c.OperKind.Number:return function(e){return(0,s.isRichOper)(e)?(0,u.throwEvaluationError)((0,s.notImplemented)(["SWITCH with a rich value case"])):(0,s.isNumberOper)(e)&&0===r.compare(t,e)};case c.OperKind.String:return function(e){return(0,s.isRichOper)(e)?(0,u.throwEvaluationError)((0,s.notImplemented)(["SWITCH with a rich value case"])):(0,s.isStringOper)(e)&&0===n.stringCompareCI(t.value,e.value)};case c.OperKind.Boolean:return function(e){return(0,s.isRichOper)(e)?(0,u.throwEvaluationError)((0,s.notImplemented)(["SWITCH with a rich value case"])):(0,s.isBooleanOper)(e)&&t.value===e.value};case c.OperKind.Rich:return(0,u.throwEvaluationError)((0,s.notImplemented)(["SWITCH with a rich value condition"]));default:return(0,i.assertNever)("calc.funcs.makeSwitchComparer",t)}}(t.config,a),l=1;l<r.length-1;l+=2){var p=c.OperKind.Error|c.OperKind.Rich|c.OperKind.Number|c.OperKind.Boolean|c.OperKind.String|c.OperKind.Array,m=t.coerceOper(t.dereferenceOper(r[l],p),p);if((0,s.isArrayOper)(m))return f(t,d,e,r);if((0,s.isErrorOper)(m))return m;if(o(m))return r[l+1]}return r.length%2==0?r[r.length-1]:n.naErrorOper},t.true_=function(e,t){return n.trueOper},t.false_=function(e,t){return n.falseOper},t.not=function(e,t){var r=t[0];return(0,n.booleanOper)(!r.value)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.vlookup=t.hlookup=t.lookup=t.match=t.linearSearch=t.binarySearch=t.index=void 0;var n=r(72),i=r(40),a=r(138),o=r(38),s=r(43),u=r(52),c=r(152),l=r(51),d=r(81),f=r(62),p=r(48);t.index=function(e,t){var r=t[0],n=t[1],a=t[2],u=t[3],c=e.mathpack,d=c.sfix(n);if(d<0)return i.valueErrorOper;var m=void 0===a?void 0:c.sfix(a);if(void 0!==m&&m<0)return i.valueErrorOper;var h,v,g=void 0===u?0:c.sfix(u)-1;if(g<0)return i.valueErrorOper;switch(r.kind){case p.OperKind.Range:if(!(0,o.isSheetIndex)(r.sheets))return i.valueErrorOper;if(g>=r.ranges.length)return i.refErrorOper;var b=r.ranges[g];if(void 0===m)if(1===b.rows)h=0,v=d-1;else{if(1!==b.cols)return i.refErrorOper;h=d-1,v=-1}else h=d-1,v=m-1;if(h>=b.rows||v>=b.cols)return i.refErrorOper;var S=(0,l.gridRange)(b.row+(0,f.fastMax)(h,0),b.col+(0,f.fastMax)(v,0),-1===h?b.rows:1,-1===v?b.cols:1);return(0,i.rangeSeqOper)(r.sheets,[S]);case p.OperKind.Array:return g>0?i.refErrorOper:(void 0===m?1===r.rows?(h=0,v=d-1):(h=d-1,v=-1):(h=d-1,v=m-1),h>=r.rows||v>=r.cols?i.refErrorOper:-1===h&&-1===v?r:-1===h?(0,i.arrayOper)(r.rows,1,r.opers.map((function(e){return[e[v]]}))):-1===v?(0,i.arrayOper)(1,r.cols,[r.opers[h]]):r.opers[h][v]);default:return(0,s.assertNever)("calc.funcs.lookupFuncs: INDEX",r)}};var m=function(e){return e<0?n.OperatorId.Lt:e>0?n.OperatorId.Gt:n.OperatorId.Eq};function h(e,t,r){void 0===r&&(r=!1);var i,a=e.config,l=a.localeInfo,d=a.mathpack;switch(t.kind){case p.OperKind.Number:i=function(e){return{correctType:!0,sgnT:(r=d,n=e,i=t,m(r.cond2(n,i)))};var r,n,i};break;case p.OperKind.String:if(r){var f=new c.WildExp(l,t.value);i=function(e){return{correctType:!0,sgnT:f.test(e.value)?n.OperatorId.Eq:n.OperatorId.Ne}}}else i=function(e){return{correctType:!0,sgnT:m(l.stringCompareCI(e.value,t.value))}};break;case p.OperKind.Boolean:i=function(e){return{correctType:!0,sgnT:(r=e.value,n=t.value,m(r-n))};var r,n};break;case p.OperKind.Rich:return(0,u.throwEvaluationError)((0,o.notImplemented)(["lookup with rich value condition"]));default:return(0,s.assertNever)("calc.funcs.makeLookupComparer",t)}return function(e){var r=(0,o.isRichOper)(e)?e.getFallback():e;return t.kind!==r.kind?{correctType:!1,sgnT:n.OperatorId.Ne}:i(r)}}function v(e,t,r){for(var i=!1,a=r.length-1,o=Math.floor((0+a)/2),s=0,u=a,c=h(e,t);;){var l=c(r.get(o)).sgnT;if(l===n.OperatorId.Ne){if(o<u)for(var d=o+1;d<=u;d+=1)if((l=c(r.get(d)).sgnT)!==n.OperatorId.Ne){o=d;break}l===n.OperatorId.Ne&&(o=Math.floor((s+u)/2),l=n.OperatorId.Gt)}if(l===n.OperatorId.Eq){if(o<a){i=!0,s=o+=1,u=o;continue}return o}if(l===n.OperatorId.Lt?s=o+1:u=o-1,!(s<=u)){if(i)o-=1;else if(l===n.OperatorId.Gt&&(o-=1)>=0){s=o,u=o;continue}return o}o=Math.floor((s+u)/2)}}function g(e,t,r,i){for(var a=-1,o=h(e,t,i===n.OperatorId.Eq),s=0;s<r.length;s+=1){var u=o(r.get(s)),c=u.correctType,l=u.sgnT;if(c){if(l===n.OperatorId.Eq)return s;if(l!==n.OperatorId.Ne&&l===i)return a;a=s}s===r.denseLength&&(s=(0,f.fastMax)(s,r.length-2))}return i!==n.OperatorId.Eq?a:r.length}function b(e){switch(e.kind){case p.OperKind.Number:return i.naErrorOper;case p.OperKind.Range:return(0,o.isSheetIndex)(e.sheets)?e.ranges.length>1?i.naErrorOper:e:i.valueErrorOper;case p.OperKind.Array:return e}}function S(e,t){var r;switch(t.kind){case p.OperKind.Number:return t;case a.DerefOperKind.RangeValues:r=t.arrays[0].get(0,0);break;case p.OperKind.Array:r=t.opers[0][0];break;default:return(0,s.assertNever)("calc.funcs.lookupFuncs.getNumFromRef",t)}return r=e.coerceOper(r,p.OperKind.Number),(0,o.isErrorOper)(r)?i.refErrorOper:r}function y(e){switch(e.kind){case p.OperKind.Number:case p.OperKind.Rich:return i.naErrorOper;case p.OperKind.Range:if(!(0,o.isSheetIndex)(e.sheets))return i.valueErrorOper;if(e.ranges.length>1)return i.naErrorOper;var t=e.ranges[0];return 1!==t.rows&&1!==t.cols?i.naErrorOper:e;case p.OperKind.Array:return 1!==e.rows&&1!==e.cols?i.naErrorOper:e}}function O(e){switch(e.kind){case a.DerefOperKind.RangeValues:return e.arrays[0];case p.OperKind.Array:return new d.StrictSparseArray2D(e.rows,e.cols,e.rows,e.cols,e.opers,i.blankOper)}}function C(e,t){switch(t.kind){case p.OperKind.Range:var r=t.sheets,n=t.ranges[0];return new d.NonstrictSparseArray2D(n.rows,n.cols,n.rows,n.cols,(function(t,a){var o=(0,l.gridCell)(n.row+t,n.col+a);return e.dereferenceAllOpers([(0,i.rangeSeqOper)(r,[o])])[0].arrays[0].get(0,0)}),(function(){return(0,s.assertFalse)("calc.funcs.lookupFuncs: rangeOrArrayOperToLazyArray2D")}));case p.OperKind.Array:return new d.StrictSparseArray2D(t.rows,t.cols,t.rows,t.cols,t.opers,i.blankOper)}}function P(e){if((0,o.isRangeOper)(e)){var t=e.ranges[0];return t.cols>t.rows}return e.cols>e.rows}function N(e,t,r){var a=t[0],s=t[1],c=t[2],l=t[3],d=void 0===l?i.trueOper:l,f=b(s);if((0,o.isErrorOper)(f))return f;var m=k(f,r),h=R(O(e.dereferenceAllOpers([m])[0]),r),y=!d.value?g(e,a,h,n.OperatorId.Eq):v(e,a,h);if(y<0||y>=h.length)return i.naErrorOper;var P=function(e,t){switch(t.kind){case p.OperKind.Number:return t;case p.OperKind.Range:if(!(0,o.isSheetIndex)(t.sheets))return i.valueErrorOper;if(t.ranges.length>1)return i.refErrorOper;var r=t.ranges;return e.calcingArray?(0,u.throwEvaluationError)((0,o.notImplemented)(["HLOOKUP/VLOOKUP ref argument 3 in array formula"])):r[0].rows>1||r[0].cols>1?(0,u.throwEvaluationError)((0,o.notImplemented)(["HLOOKUP/VLOOKUP non-singleton ref argument 3"])):t;case p.OperKind.Array:return(0,u.throwEvaluationError)((0,o.notImplemented)(["HLOOKUP/VLOOKUP array argument 3"]))}}(e,c);if((0,o.isErrorOper)(P))return P;var N=e.dereferenceAllOpers([P])[0],T=S(e,N);if((0,o.isErrorOper)(T))return T;var E=e.mathpack.sfix(T)-1,_=C(e,f);return E<0?i.valueErrorOper:E>=(r?_.rows:_.cols)?i.refErrorOper:r?_.get(E,y):_.get(y,E)}function R(e,t){var r=e.getSparse.bind(e);return t?{length:e.cols,denseLength:e.denseCols,get:function(t){return e.get(0,t)},getSparse:r}:{length:e.rows,denseLength:e.denseRows,get:function(t){return e.get(t,0)},getSparse:r}}function k(e,t){if((0,o.isRangeOper)(e)){var r=e.ranges[0],n=(0,l.gridRange)(r.row,r.col,t?1:r.rows,t?r.cols:1);return(0,i.rangeSeqOper)(e.sheets,[n])}return e}t.binarySearch=v,t.linearSearch=g,t.match=function(e,t){var r=t[0],a=t[1],s=t[2],u=void 0===s?e.mathpack.one:s,c=e.mathpack,l=function(e){switch(e.kind){case p.OperKind.Number:return e;case p.OperKind.Range:if(!(0,o.isSheetIndex)(e.sheets))return i.valueErrorOper;if(e.ranges.length>1)return i.refErrorOper;var t=e.ranges[0];return 1!==t.rows||1!==t.cols?i.refErrorOper:e}}(u);if((0,o.isErrorOper)(l))return l;var d=e.dereferenceAllOpers([l])[0],f=S(e,d);if((0,o.isErrorOper)(f))return f;var m=y(a);if((0,o.isErrorOper)(m))return m;var h=O(e.dereferenceAllOpers([m])[0]),b=R(h,1===h.rows),C=-1;return(C=c.cond(f)>0?v(e,r,b):0===c.cond(f)?g(e,r,b,n.OperatorId.Eq):g(e,r,b,n.OperatorId.Lt))<0||C>=b.length?i.naErrorOper:e.mathpack.fromNumber(C+1)},t.lookup=function(e,t){var r=t[0],n=t[1],a=t[2],s=b(n);if((0,o.isErrorOper)(s))return s;var u=P(s),c=k(s,u),d=R(O(e.dereferenceAllOpers([c])[0]),u),p=v(e,r,d);if(p<0)return i.naErrorOper;if(void 0!==a){var m=y(a);if((0,o.isErrorOper)(m))return m;var h=P(m),g=R(C(e,function(e,t,r){if((0,o.isRangeOper)(r)){var n=r.ranges[0],a=(0,l.gridRange)(n.row,n.col,(0,f.fastMin)(t?1:e,l.sheetRows-n.row),(0,f.fastMin)(t?e:1,l.sheetCols-n.col));return(0,i.range3DOper)(r.sheets,a)}return r}(d.length,h,m)),h);return p>=g.length?(0,o.isArrayOper)(m)?i.naErrorOper:i.blankOper:g.get(p)}var S=C(e,s);return u?S.get(S.rows-1,p):S.get(p,S.cols-1)},t.hlookup=function(e,t){return N(e,t,!0)},t.vlookup=function(e,t){return N(e,t,!1)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.timevalue=t.datevalue=t.value=t.dollar=t.fixed=t.text=void 0;var n=r(40),i=r(43),a=r(204),o=r(378),s=r(203),u=r(38),c=r(379),l=r(48),d=r(134),f=s.codePointSpace;function p(e,t,r,o){if(void 0===r||(0,u.isMissingOper)(r))return{formatValue:t,formatDecimals:null!=o?o:2};var s=e.config.mathpack;if(s.cond(r)<0){var c=(0,a.round)(e,[t,r]);return(0,i.assertTrue)("calc.funcs.fixedDollarRound",(0,u.isNumberOper)(c)||(0,u.isErrorOper)(c)),{formatValue:c,formatDecimals:0}}var l=s.sfix(r);return l<0||l>127?{formatValue:n.valueErrorOper,formatDecimals:0}:{formatValue:t,formatDecimals:l}}function m(e){for(var t=0;t<e.length&&e.charCodeAt(t)===f;)t+=1;return e.substring(t)}function h(e,t){var r;return(0,u.isStringOper)(t)?t.value.length>255?n.valueErrorOper:null!==(r=e.parseDate(m(t.value)))&&void 0!==r?r:n.valueErrorOper:n.valueErrorOper}t.text=function(e,t){var r,a=t[0],o=t[1].value,s=(0,u.isRichOper)(a)?a.getFallback():a;if((0,u.isStringOper)(s)&&s.value.length>255||o.length>255)return n.valueErrorOper;switch(s.kind){case l.OperKind.String:var c=e.coerceOper(s,l.OperKind.Number);r=(0,u.isNumberOper)(c)?c:s;break;case l.OperKind.Number:r=s;break;case l.OperKind.Boolean:c=e.coerceOper(s,l.OperKind.String);(0,i.assertTrue)("calc.funcs.text",(0,u.isStringOper)(c)),r=c;break;case l.OperKind.Error:return n.valueErrorOper}var f=e.applyFormat(e.originSheet.document,o,r,d.NumberFormatSource.CustomString);return void 0!==f?(0,n.stringOper)(f):n.valueErrorOper},t.fixed=function(e,t){var r,i,a=t[0],s=t[1],l=t[2],f=p(e,a,s,void 0),m=f.formatValue,h=f.formatDecimals;if((0,u.isErrorOper)(m))return m;i=null!==(r=null==l?void 0:l.value)&&void 0!==r&&r?0===h?o.KnownFormat.NoComFixed0:2===h?o.KnownFormat.NoComFixed:(0,c.buildNumberFormat)(e.config.localeInfo,!1,1,h):0===h?o.KnownFormat.Fixed0:2===h?o.KnownFormat.Fixed:(0,c.buildNumberFormat)(e.config.localeInfo,!0,4,h);var v=e.applyFormat(e.originSheet.document,i,m,d.NumberFormatSource.CustomBytecode);return void 0!==v?(0,n.stringOper)(v):n.valueErrorOper},t.dollar=function(e,t){var r=t[0],i=t[1],a=e.config.localeInfo,s=p(e,r,i,a.isEastAsia?a.currencyDecimals:void 0),l=s.formatValue,m=s.formatDecimals;if((0,u.isErrorOper)(l))return l;var h=0===m?o.KnownFormat.Currency:2===m?o.KnownFormat.CurrencyDec:(0,c.buildCurrencyFormat)(a,!1,m,!0,!1),v=e.applyFormat(e.originSheet.document,h,l,d.NumberFormatSource.CustomBytecode);return void 0!==v&&v.length>0&&v.charCodeAt(v.length-1)===f?(0,n.stringOper)(v.substring(0,v.length-1)):void 0!==v?(0,n.stringOper)(v):n.valueErrorOper},t.value=function(e,t){var r=t[0];switch(r.kind){case l.OperKind.Boolean:return n.valueErrorOper;case l.OperKind.Number:return r;case l.OperKind.String:return r.value.length>255?n.valueErrorOper:e.coerceOper((0,n.stringOper)(m(r.value)),l.OperKind.Number)}},t.datevalue=function(e,t){var r=h(e,t[0]);return(0,u.isErrorOper)(r)?r:e.mathpack.trunc(r)},t.timevalue=function(e,t){var r=h(e,t[0]);return(0,u.isErrorOper)(r)?r:e.mathpack.sub(r,e.mathpack.trunc(r))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formulatext=t.isformula=t.isodd=t.iseven=t.isomitted=t.islambda=t.isref=t.isnumber=t.istext=t.isnontext=t.isna=t.islogical=t.isblank=t.iserr=t.iserror=void 0;var n=r(40),i=r(38),a=r(51),o=r(81),s=r(71),u=r(119),c=r(106);function l(e,t){var r=t[0],a=(0,c.chkNumOper)(e,r);if((0,i.isErrorOper)(a))return a;var o=e.mathpack,s=(0,c.assertNumber)(o.add(o.abs(a),o.fromNumber(1.0000000000000003e-10))),u=(0,c.assertNumber)(o.div(o.floor(s),o.fromNumber(2)));return(0,n.booleanOper)(0===o.cond2(u,o.floor(u)))}function d(e,t,r){if(!(0,i.isSheetIndex)(t.sheets))return n.valueErrorOper;var s=t.ranges[0];if(e.calcingArray||!(0,i.isGridCell)(s)){var u=t.sheets;return(0,n.arrayOper)(s.rows,s.cols,(0,o.jaggedArray)(s.rows,s.cols,(function(t,n){var i=(0,a.sheetGridCell)(u,(0,a.gridCell)(s.row+t,s.col+n));return r(e.getCellFormula(i),i)})))}var c=(0,i.sheetGridRangeAnchor)((0,a.sheetGridRange)(t.sheets,s));return r(e.getCellFormula(c),c)}t.iserror=function(e,t){var r=t[0];return(0,n.booleanOper)((0,i.isErrorOper)(r))},t.iserr=function(e,t){var r=t[0];return(0,n.booleanOper)((0,i.isErrorOper)(r)&&r.type!==n.ErrorType.NA)},t.isblank=function(e,t){var r=t[0];return(0,n.booleanOper)((0,i.isBlankOper)(r))},t.islogical=function(e,t){var r=t[0];return(0,n.booleanOper)((0,i.isBooleanOper)(r))},t.isna=function(e,t){var r=t[0];return(0,n.booleanOper)((0,i.isErrorOper)(r)&&r.type===n.ErrorType.NA)},t.isnontext=function(e,t){var r=t[0];return(0,n.booleanOper)(!(0,i.isStringOper)(r))},t.istext=function(e,t){var r=t[0];return(0,n.booleanOper)((0,i.isStringOper)(r))},t.isnumber=function(e,t){var r=t[0];return(0,n.booleanOper)((0,i.isNumberOper)(r))},t.isref=function(e,t){var r=t[0];return(0,n.booleanOper)((0,i.isRangeOper)(r))},t.islambda=function(e,t){var r=(0,s.refToVal)(e,t[0],!0);return(0,n.booleanOper)(r instanceof u.LambdaOper)},t.isomitted=function(e,t){var r=t[0];return(0,n.booleanOper)((0,i.isMissingOper)(r))},t.iseven=l,t.isodd=function(e,t){var r=l(e,t);return(0,i.isBooleanOper)(r)?(0,n.booleanOper)(!r.value):r},t.isformula=function(e,t){return d(e,t[0],(function(e){return(0,n.booleanOper)(void 0!==e)}))},t.formulatext=function(e,t){var r=t[0];return d(e,r,(function(t,r){if(void 0===t)return n.naErrorOper;var i=e.printFormula(t,r.range);return t.source.kind===a.LexicalKind.Cell?(0,n.stringOper)(i):(0,n.stringOper)("{"+i+"}")}))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.single=t.transpose=t.offset=t.sheet=t.sheets=t.column=t.row=t.columns=t.rows=t.areas=void 0;var n=r(40),i=r(38),a=r(51),o=r(62),s=r(43),u=r(81);function c(e,t){if(!t)return[e.reflectionGridCell,!e.calcingArray];if(!(0,i.isSheetIndex)(t.sheets))return n.valueErrorOper;if(t.ranges.length>1)return n.refErrorOper;var r=t.ranges[0];return[r,(0,i.isGridCell)(r)]}t.areas=function(e,t){var r=t[0];return(0,i.isSheetIndex)(r.sheets)?e.mathpack.fromNumber(r.ranges.length):n.valueErrorOper},t.rows=function(e,t){var r=t[0],a=e.mathpack;return(0,i.isArrayOper)(r)?a.fromNumber(r.rows):(0,i.isSheetIndex)(r.sheets)?r.ranges.length>1?n.refErrorOper:a.fromNumber(r.ranges[0].rows):n.valueErrorOper},t.columns=function(e,t){var r=t[0],a=e.mathpack;return(0,i.isArrayOper)(r)?a.fromNumber(r.cols):(0,i.isSheetIndex)(r.sheets)?r.ranges.length>1?n.refErrorOper:a.fromNumber(r.ranges[0].cols):n.valueErrorOper},t.row=function(e,t){var r=c(e,t[0]);if(!Array.isArray(r))return r;var i=r[0],a=r[1],o=e.mathpack;return a?o.fromNumber(i.row+1):(0,n.arrayOper)(i.rows,1,(0,u.jaggedArray)(i.rows,1,(function(e){return o.fromNumber(i.row+e+1)})))},t.column=function(e,t){var r=c(e,t[0]);if(!Array.isArray(r))return r;var i=r[0],a=r[1],o=e.mathpack;return a?o.fromNumber(i.col+1):(0,n.arrayOper)(1,i.cols,(0,u.jaggedArray)(1,i.cols,(function(e,t){return o.fromNumber(i.col+t+1)})))},t.sheets=function(e,t){var r=t[0],o=e.mathpack;return r?(0,i.isArrayOper)(r)?n.naErrorOper:o.fromNumber(e.getSheetRangeIndexes(r.sheets).length):o.fromNumber(e.getSheetRangeIndexes((0,a.allSheetsRange)(e.reflectionSheet.document)).length)},t.sheet=function(e,t){var r=t[0],a=e.mathpack;if(!r){var o=e.reflectionSheet;return void 0===o.index?n.naErrorOper:a.fromNumber(e.getSheetRangePosition(o)+1)}if((0,i.isStringOper)(r)){var u=e.getSheetIndex(e.reflectionSheet.document,r.value);return void 0===u?n.naErrorOper:a.fromNumber(e.getSheetRangePosition(u)+1)}return(0,i.isRangeOper)(r)?a.fromNumber(e.getSheetRangePosition(r.sheets)+1):(0,i.isArrayOper)(r)?n.naErrorOper:(0,s.assertNever)("calc.funcs.sheet",r)},t.offset=function(e,t){var r=t[0],s=t[1],u=t[2],c=t[3],l=t[4];if(!(0,i.isSheetIndex)(r.sheets))return n.valueErrorOper;if(1!==r.ranges.length)return n.valueErrorOper;var d=e.mathpack,f=r.ranges[0],p=f.row,m=f.col,h=f.rows,v=f.cols,g=p;(0,i.isNumberOper)(s)&&(g+=d.lfix(s));var b=m;(0,i.isNumberOper)(u)&&(b+=d.lfix(u));var S=g+h-1;if(void 0!==c&&(0,i.isNumberOper)(c)){if(0===(O=d.cond(c)))return n.refErrorOper;S=g+d.lfix(c)-(O>0?1:-1)}var y=b+v-1;if(void 0!==l&&(0,i.isNumberOper)(l)){var O;if(0===(O=d.cond(l)))return n.refErrorOper;y=b+d.lfix(l)-(O>0?1:-1)}var C=(0,o.fastMin)(g,S),P=(0,o.fastMin)(b,y),N=(0,o.fastMax)(g,S)-C+1,R=(0,o.fastMax)(b,y)-P+1;return C<0||P<0||C+N>a.sheetRows||P+R>a.sheetCols?n.refErrorOper:(0,n.rangeSeqOper)(r.sheets,[(0,a.gridRange)(C,P,N,R)])},t.transpose=function(e,t){var r=t[0];return(0,i.isArrayOper)(r)?(0,n.arrayOper)(r.cols,r.rows,(0,u.jaggedArray)(r.cols,r.rows,(function(e,t){return r.opers[t][e]}))):r},t.single=function(e,t){var r=t[0];if((0,i.isPrimitiveOper)(r)||(0,i.isMissingOper)(r)||(0,i.isBlankOper)(r)||(0,i.isRichOper)(r))return r;if((0,i.isArrayOper)(r))return r.opers[0][0];if(!(0,i.isSheetIndex)(r.sheets))return n.refErrorOper;if(1!==r.ranges.length)return n.valueErrorOper;var a=e.originGridCell,o=(0,i.gridCellImplicitIsect)(a,r.ranges[0]);return void 0===o?n.valueErrorOper:(0,n.rangeSeqOper)(r.sheets,[o])}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.record=t.fieldvalue=void 0;var n=r(40),i=r(38),a=r(149),o=r(119);t.fieldvalue=function(e,t){var r=t[0],a=t[1].value;if((0,i.isRichOper)(r)){var o=r.getField(a);if(void 0!==o)return o}return n.fieldErrorOper},t.record=function(e,t){for(var r=t[0],n=e.config.localeInfo,i=a.RedBlackMapTree.create(n.stringCompareCI),s=1;s<t.length;s+=2){var u=t[s].value,c=t[s+1];i=i.setValue(u,c)}return new o.RecordOper(i,r)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.indirect=t.address=void 0;var n=r(40),i=r(51),a=r(118),o=r(380),s=r(38),u=r(72),c=r(43),l=r(151),d=r(60),f=r(48),p=r(52);t.address=function(e,t){var r=t[0],u=t[1],l=t[2],d=t[3],p=t[4],m=e.mathpack,h=(null==l?void 0:l.kind)===f.OperKind.Number?m.sfix(l)-1:0;if(h<0||h>3)return n.valueErrorOper;var v=0!=(1&h),g=0!=(2&h),b=(null==d?void 0:d.kind)!==f.OperKind.Boolean||d.value?a.RefStyle.A1:a.RefStyle.R1C1,S=function(e,t,r){return b===a.RefStyle.R1C1&&e?-t<r&&r<t:1<=r&&r<=t},y=m.sfix(r);if(!S(g,i.sheetRows,y))return n.valueErrorOper;if(!(0,s.isNumberOper)(u))return n.valueErrorOper;var O=m.sfix(u);if(!S(v,i.sheetCols,O))return n.valueErrorOper;var C=(0,i.gridCell)(y<0?i.sheetRows-1:0,O<0?i.sheetCols-1:0),P=(0,a.pos)(g?a.PosKind.Rel:a.PosKind.Abs,b===a.RefStyle.R1C1&&g?y:y-1),N=(0,a.pos)(v?a.PosKind.Rel:a.PosKind.Abs,b===a.RefStyle.R1C1&&v?O:O-1),R=(0,o.formatCellPos)(e.config.localeInfo,b,C,P,N,!1);return(0,c.assertTrue)("calc.funcs.address: cell wrapped",void 0!==R),(null==p?void 0:p.kind)===f.OperKind.String?""===p.value?(0,n.stringOper)("!"+R):p.value.length>255?n.valueErrorOper:(0,n.stringOper)((0,o.formatQualifier)(e.config.localeInfo,e.config.refStyle,p.value)+"!"+R):(0,n.stringOper)(R)},t.indirect=function(e,t){var r,o=t[0].value,c=t[1],f=null===(r=null==c?void 0:c.value)||void 0===r||r?a.RefStyle.A1:a.RefStyle.R1C1;if(o.length>255||(0,l.stringStartsWith)(o," "))return n.valueErrorOper;var m=(0,i.originCell)(e.originSheet,e.originGridCell),h={lexicalKind:i.LexicalKind.Indirect,originGridCell:(0,d.success)(m.range),originSheet:(0,d.success)(m.sheet),allowRelativeQualifier:!1,allowUnqualifiedCell:!0,allowImplicitTable:!1,wrapCellReferences:!0,workbookLoad:!1},v=e.parseFormula(f,m.range,h,"="+o);if(!(0,d.isSuccess)(v))return n.refErrorOper;for(var g=v.value.node,b=!1,S=!1;;){var y;if(!b&&g.kind===a.NodeKind.App&&(0,s.isOperatorNode)(g.head)&&g.head.id===u.OperatorId.Pound&&1===g.args.length&&(b=!0,g=g.args[0]),S||g.kind!==a.NodeKind.Name)return g.kind===a.NodeKind.CellRef?void 0===(y=e.getCellRef(g.qualifier,g.ref,m,!0))?n.refErrorOper:(0,s.isSheetIndex)(y.sheets)?b?(0,p.throwEvaluationError)((0,s.notImplemented)(["# operator in INDIRECT"])):y:n.refErrorOper:g.kind===a.NodeKind.StructRef?void 0===g.lhs||void 0===(y=e.getStructRef(g.lhs,g.rhs,m))||b?n.refErrorOper:y:n.refErrorOper;var O=e.getNameFormula(g.qualifier,g.whole,i.NameSource.Indirect);if(void 0===O)return n.refErrorOper;m=(0,i.originCell)(m.sheet,(0,i.gridCell)(0,0)),g=O[1],S=!0}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.substitute=t.search=t.replace=t.find=t.proper=t.upper=t.lower=t.unicode=t.code=t.unichar=t.char=t.clean=t.trim=t.rept=t.exact=t.concatenate=t.len=t.mid=t.left=t.right=void 0;var n=r(38),i=r(40),a=r(52),o=r(262),s=r(152),u=r(203),c=r(151),l=r(48),d=r(54),f=u.codePointSpace,p=u.codePointCapitalA,m=u.codePointCapitalZ,h=u.codePointSmallA,v=u.codePointSmallZ;function g(e,t){return void 0===t?1:e.cond(t)<0?i.valueErrorOper:e.sfix(t)}function b(e){return e>=p&&e<=m||e>=h&&e<=v}function S(e,t,r){return""===e?e:function(e){for(var t=0;t<e.length;t+=1)if(e.charCodeAt(t)>=128)return!1;return!0}(e)?r():(0,a.throwEvaluationError)((0,n.notImplemented)([t+" for non-ASCII input"]))}t.right=function(e,t){var r,a=t[0].value,s=t[1];if(void 0!==s&&(0,n.isErrorOper)(s))return s;var u=g(e.mathpack,s);if("number"!=typeof u&&(0,n.isErrorOper)(u))return i.valueErrorOper;var c=null!==(r=(0,o.scanCodePointsBack)(a,a.length,u))&&void 0!==r?r:0;return(0,i.stringOper)(a.substring(c))},t.left=function(e,t){var r,a=t[0].value,s=t[1];if(void 0!==s&&(0,n.isErrorOper)(s))return s;var u=g(e.mathpack,s);if("number"!=typeof u&&(0,n.isErrorOper)(u))return i.valueErrorOper;var c=null!==(r=(0,o.scanCodePoints)(a,0,u))&&void 0!==r?r:a.length;return(0,i.stringOper)(a.substring(0,c))},t.mid=function(e,t){var r,n,a=t[0].value,s=t[1],u=t[2],c=e.mathpack,l=c.fix(s)-1,d=c.fix(u);if(c.cond(s)<0||l<0||c.cond(u)<0||d<0)return i.valueErrorOper;var f=null!==(r=(0,o.scanCodePoints)(a,0,l))&&void 0!==r?r:a.length,p=null!==(n=(0,o.scanCodePoints)(a,f,d))&&void 0!==n?n:a.length;return(0,i.stringOper)(a.substring(f,p))},t.len=function(e,t){var r=t[0].value;return e.mathpack.fromNumber((0,o.countCodePoints)(r,0,r.length))},t.concatenate=function(e,t){for(var r="",n=0;n<t.length;n+=1){var a=t[n].value;if(r.length+a.length>i.cellStringLimit){r+=a.substring(0,i.cellStringLimit-r.length);break}r+=a}return(0,i.stringOper)(r)},t.exact=function(e,t){var r=t[0],o=t[1];return((0,n.isRichOper)(r)||(0,n.isRichOper)(o))&&(0,a.throwEvaluationError)((0,n.notImplemented)(["EXACT rich argument"])),(0,i.booleanOper)(r.value===o.value)},t.rept=function(e,t){var r=t[0].value,n=t[1],a=e.mathpack,o=a.fix(n);return a.cond(n)<0||o>2147483647?i.valueErrorOper:""===r?d.emptyStringOper:o*r.length>i.cellStringLimit?i.valueErrorOper:(0,i.stringOper)((0,c.repeat)(r,o))},t.trim=function(e,t){for(var r=t[0].value,n="",a=0;a<r.length;){for(;a<r.length&&r.charCodeAt(a)===f;)a+=1;for(var o=a;a<r.length;){var s=r.charCodeAt(a)===f;if(a+=1,s)break}n+=r.substring(o,a)}return n.length>0&&n.charCodeAt(n.length-1)===f&&(n=n.substring(0,n.length-1)),(0,i.stringOper)(n)},t.clean=function(e,t){for(var r=t[0].value,n="",a=0;a<r.length;a+=1){var o=r.charCodeAt(a);(o>=256||(127&o)>=32)&&(n+=r.charAt(a))}return(0,i.stringOper)(n)},t.char=function(e,t){var r=t[0],n=e.mathpack.sfix(r);return n<1||n>255?i.valueErrorOper:(0,i.stringOper)(String.fromCharCode(n))},t.unichar=function(e,t){var r=t[0],n=e.mathpack,a=n.lfix(n.trunc(r));return n.cond2(r,n.one)<0||a>=1114112?i.valueErrorOper:a<=65535&&(0,o.isAnySurrogate)(a)||a>=64976&&a<=65007||(65535&a)>=65534?i.naErrorOper:(0,i.stringOper)((0,o.stringFromCodePoint)(a))},t.code=function(e,t){var r=t[0].value;if(0===r.length)return i.valueErrorOper;var o=r.charCodeAt(0);return o>255?(0,a.throwEvaluationError)((0,n.notImplemented)(["CODE for codepoints > 255"])):e.mathpack.fromNumber(o)},t.unicode=function(e,t){var r=t[0].value;if(0===r.length)return i.valueErrorOper;var n=r.charCodeAt(0),a=e.mathpack;if(!(0,o.isAnySurrogate)(n))return a.fromNumber(n);if(1===r.length)return i.valueErrorOper;var s=r.charCodeAt(1),u=(0,o.surrogatePairToCodePoint)(n,s);return void 0===u?i.valueErrorOper:a.fromNumber(u)},t.lower=function(e,t){var r=t[0].value;return(0,i.stringOper)(S(r,"LOWER",r.toLowerCase.bind(r)))},t.upper=function(e,t){var r=t[0].value;return(0,i.stringOper)(S(r,"UPPER",r.toUpperCase.bind(r)))},t.proper=function(e,t){var r=t[0].value;return(0,i.stringOper)(S(r,"PROPER",(function(){for(var e=r.toLowerCase(),t="",n=0;;){for(var i=n;n<e.length&&!b(e.charCodeAt(n));)n+=1;if(t+=e.substring(i,n),n===e.length)break;var a=n,s=(0,o.stringCodePointAt)(e,n);for(t+=(0,o.stringFromCodePoint)(s).toUpperCase(),n+=(0,o.numCodeUnits)(s);n<e.length&&b(e.charCodeAt(n));)n+=1;t+=e.substring(a+1,n)}return t})))},t.find=function(e,t){var r,n=t[0].value,a=t[1].value,s=t[2],u=void 0!==s?e.mathpack.sfix(s)-1:0;if(u<0||u>=2147483647)return i.valueErrorOper;var c=null!==(r=(0,o.scanCodePoints)(a,0,u))&&void 0!==r?r:a.length,l=a.indexOf(n,c);return l>=0?e.mathpack.fromNumber((0,o.countCodePoints)(a,0,l)+1):i.valueErrorOper},t.replace=function(e,t){var r,n,a=t[0].value,s=t[1],u=t[2],c=t[3].value,l=e.mathpack.sfix(s)-1;if(l<0||l>=i.cellStringLimit)return i.valueErrorOper;var d=e.mathpack.sfix(u);if(d<0||d>i.cellStringLimit)return i.valueErrorOper;var f=null!==(r=(0,o.scanCodePoints)(a,0,l))&&void 0!==r?r:a.length,p=null!==(n=(0,o.scanCodePoints)(a,f,d))&&void 0!==n?n:a.length,m=a.slice(0,f),h=a.slice(p);return m.length+c.length+h.length>i.cellStringLimit?i.valueErrorOper:(0,i.stringOper)(m+c+h)},t.search=function(e,t){var r,n=t[0].value,a=t[1].value,u=t[2],c=void 0!==u?e.mathpack.sfix(u)-1:0;if(c<0||c>=2147483647)return i.valueErrorOper;for(var l=null!==(r=(0,o.scanCodePoints)(a,0,c))&&void 0!==r?r:a.length,d=new s.WildExp(e.config.localeInfo,n,!0);l<a.length;l+=1)if(d.test(a.slice(l)))return e.mathpack.fromNumber((0,o.countCodePoints)(a,0,l)+1);return i.valueErrorOper},t.substitute=function(e,t){var r=t[0],a=t[1].value,o=t[2].value,s=t[3],u=r.value,c=1/0;if(void 0!==s){var d=e.coerceOper(s,l.OperKind.Number);if((0,n.isErrorOper)(d))return d;if((c=e.mathpack.sfix(d))<1||c>2147483646)return i.valueErrorOper}var f=a.length;if(f>0){for(var p="",m=0,h=0;c>=0&&-1!==(h=u.indexOf(a,h));)if((c-=1)===1/0||0===c){var v=u.slice(m,h);if(p.length+v.length+o.length>i.cellStringLimit)return i.valueErrorOper;p+=v,p+=o,m=h+=f}else h+=1;var g=u.slice(m);return p.length+g.length>i.cellStringLimit?i.valueErrorOper:(p+=g,(0,i.stringOper)(p))}return r}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.today=t.now=t.randbetween=t.rand=void 0;var n=r(40),i=r(106),a=r(38),o=r(265);t.rand=function(e,t){return e.getRandom()},t.randbetween=function(e,t){var r=t[0],o=t[1],s=(0,i.chkNumOper)(e,r),u=(0,i.chkNumOper)(e,o);if((0,a.isErrorOper)(s))return s;if((0,a.isErrorOper)(u))return u;var c=e.mathpack;if(c.cond2(s,u)>0)return n.numErrorOper;var l=e.getRandom(),d=c.ceil(s),f=c.floor(u),p=c.sub(f,d);return(0,a.isErrorOper)(p)?p:c.add(c.floor((0,i.assertNumber)(c.mul((0,i.assertNumber)(c.add(p,c.one)),l))),d)},t.now=function(e,t){return e.getTime(o.TimeGranularity.Instant)},t.today=function(e,t){return e.getTime(o.TimeGranularity.Day)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hyperlink=void 0,t.hyperlink=function(e,t){var r=t[0],n=t[1];return e.followHyperlinks?r:null!=n?n:r}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExcelUtils=void 0;var n=r(153),i=function(){function e(){}return e.column_name_to_index=function(e){if(1===e.length)return e[0].charCodeAt(0)-"A".charCodeAt(0)+1;for(var t=0,r=0,n=e.split("");r<n.length;r++){t*=26,t+=n[r].charCodeAt(0)-"A".charCodeAt(0)+1}return t},e.column_index_to_name=function(e){for(var t="";e>0;)t+=String.fromCharCode((e-1)%26+65),e=Math.floor((e-1)/26);return t.split("").reverse().join("")},e.cell_dependency=function(t,r,i){(0,n.watchdog)("wd0x1a9bd3");var a;if(a=e.cell_both_absolute.exec(t)){var o=e.column_name_to_index(a[1]),s=Number(a[2]);return a[2][0]>=" "&&(s=Number(a[2].charCodeAt(0)-16384)),[o,s,0]}if((0,n.watchdog)("wd0xa26bda"),a=e.cell_col_absolute.exec(t)){o=e.column_name_to_index(a[1]),s=Number(a[2]);return a[2][0]>=" "&&(s=Number(a[2].charCodeAt(0)-16384)),[o,s-i,0]}if((0,n.watchdog)("wd0x2a23e1"),a=e.cell_row_absolute.exec(t)){o=e.column_name_to_index(a[1]),s=Number(a[2]);return a[2][0]>=" "&&(s=Number(a[2].charCodeAt(0)-16384)),[o-r,s,0]}if((0,n.watchdog)("wd0x3ebc91"),a=e.cell_both_relative.exec(t)){o=e.column_name_to_index(a[1]),s=Number(a[2]);return a[2][0]>=" "&&(s=Number(a[2].charCodeAt(0)-16384)),[o-r,s-i,0]}throw new Error("We should never get here.")},e.toR1C1=function(t,r,n){void 0===n&&(n=!1);var i=e.cell_dependency(t,0,0),a=e.cell_dependency(r,0,0),o="R",s="C";n&&(o="ρ",s="γ");var u=[];a.forEach((function(e,t,r){u.push(e-i[t])}));var c="";return e.cell_both_absolute.exec(r)?c=o+a[1]+s+a[0]:e.cell_col_absolute.exec(r)?(0===u[1]?c+=o:c+=o+"["+u[1]+"]",c+=s+a[0]):e.cell_row_absolute.exec(r)?(0===u[0]?c+=s:c+=s+"["+u[0]+"]",c=o+a[1]+c):(0===u[1]?c+=o:c+=o+"["+u[1]+"]",0===u[0]?c+=s:c+=s+"["+u[0]+"]"),c},e.formulaToR1C1=function(t,r,n){for(var i,a=t.slice(),o=e.column_index_to_name(r)+n;i=e.range_pair.exec(a);)if(i){var s=i[1];i[2];a=a.replace(i[0],e.toR1C1(o,i[1],!0)+":"+e.toR1C1(o,i[2],!0))}for(var u=null;u=e.single_dep.exec(a);)if(u){s=u[1];a=a.replace(u[0],e.toR1C1(o,s,!0))}return a=(a=a.replace(/ρ/g,"R")).replace(/γ/g,"C")},e.extract_sheet_cell=function(t){(0,n.watchdog)("wd0x012630");var r=e.sheet_plus_cell.exec(t);return r?[r[1],r[2],r[2]]:["","",""]},e.all_cell_dependencies=function(t,r,i,a){void 0===a&&(a=!0),(0,n.watchdog)("wd0x2f82fe");var o=null,s=[];if("string"!=typeof t)return null;for(t=(t=(t=(t=(t=(t=(t=t.replace(this.formulas_with_numbers,"_")).replace(this.formulas_with_quoted_sheetnames_2,"_")).replace(this.formulas_with_quoted_sheetnames_1,"_")).replace(this.formulas_with_unquoted_sheetnames_2,"_")).replace(this.formulas_with_unquoted_sheetnames_1,"_")).replace(this.formulas_with_unquoted_sheetnames_1,"_")).replace(this.formulas_with_structured_references,"_");o=e.range_pair.exec(t);)if((0,n.watchdog)("wd0x784918"),o){for(var u=o[1],c=e.cell_dependency(u,r,i),l=o[2],d=e.cell_dependency(l,r,i),f=d[0]-c[0]+1,p=d[1]-c[1]+1,m=0;m<f;m++)for(var h=0;h<p;h++)s.push([m+c[0],h+c[1],0]);t=t.replace(o[0],"_")}for(var v=null;v=e.single_dep.exec(t);)if((0,n.watchdog)("wd0x0fb232"),v){u=v[1];var g=e.cell_dependency(u,r,i);s.push(g),t=t.replace(v[0],"_")}if(a)for(var b=null;b=e.number_dep.exec(t);)(0,n.watchdog)("wd0xd82ed1"),b&&(s.push([0,0,1]),t=t.replace(b[0],"_"));return s},e.numeric_constants=function(t){var r=[];if("string"!=typeof(t=t.slice()))return r;t=(t=(t=(t=(t=(t=(t=t.replace(this.formulas_with_numbers,"_")).replace(this.formulas_with_quoted_sheetnames_2,"_")).replace(this.formulas_with_quoted_sheetnames_1,"_")).replace(this.formulas_with_unquoted_sheetnames_2,"_")).replace(this.formulas_with_unquoted_sheetnames_1,"_")).replace(this.formulas_with_unquoted_sheetnames_1,"_")).replace(this.formulas_with_structured_references,"_");for(var n=null;n=e.range_pair.exec(t);)n&&(t=t.replace(n[0],"_"));for(var i=null;i=e.single_dep.exec(t);)i&&(t=t.replace(i[0],"_"));for(var a=null;a=e.number_dep.exec(t);)a&&(r.push(parseFloat(a)),t=t.replace(a[0],"_"));return r},e.baseVector=function(){return[0,0,0]},e.all_dependencies=function(t,r,i,a,o){(0,n.watchdog)("wd0x961028");var s=[];if(t>=o.length||r>=o[0].length||t<0||r<0)return[];var u=o[t][r];return u.length>1&&"="===u[0]&&(s=e.all_cell_dependencies(u,a,i)),s},e.generate_all_references=function(t,r,i){(0,n.watchdog)("wd0x6a6002");for(var a={},o=0;o<t.length;o++)for(var s=t[o],u=0;u<s.length;u++){(0,n.watchdog)("wd0x93d412");var c=s[u];if("="===c[0])for(var l=0,d=e.all_cell_dependencies(c,0,0);l<d.length;l++){var f=d[l];if((0,n.watchdog)("wd0x8a466e"),0===f[0]&&0===f[1]&&0!==f[2]);else{var p=f[0]-r-1,m=f[1]-i-1,h=!1;if(m>=t.length||p>=t[0].length||p<0||m<0)h=!0;else{var v=t[m][p];void 0!==v&&"="!==v[0]&&(h=!0)}h&&(a[f.join(",")]=!0)}}}return a},e.general_re="\\$?[A-Z][A-Z]?\\$?[\\d\\u2000-\\u6000]+",e.sheet_re="[^\\!]+",e.sheet_plus_cell=new RegExp("("+e.sheet_re+")\\!("+e.general_re+")"),e.sheet_plus_range=new RegExp("("+e.sheet_re+")\\!("+e.general_re+"):("+e.general_re+")"),e.single_dep=new RegExp("("+e.general_re+")"),e.range_pair=new RegExp("("+e.general_re+"):("+e.general_re+")","g"),e.number_dep=new RegExp("([0-9]+\\.?[0-9]*)"),e.cell_both_relative=new RegExp("[^\\$A-Z]?([A-Z][A-Z]?)([\\d\\u2000-\\u6000]+)"),e.cell_col_absolute=new RegExp("\\$([A-Z][A-Z]?)([\\d\\u2000-\\u6000]+)"),e.cell_row_absolute=new RegExp("[^\\$A-Z]?([A-Z][A-Z]?)\\$([\\d\\u2000-\\u6000]+)"),e.cell_both_absolute=new RegExp("\\$([A-Z][A-Z]?)\\$([\\d\\u2000-\\u6000]+)"),e.formulas_with_numbers=new RegExp("/ATAN2|BIN2DEC|BIN2HEX|BIN2OCT|DAYS360|DEC2BIN|DEC2HEX|DEC2OCT|HEX2BIN|HEX2DEC|HEX2OCT|IMLOG2|IMLOG10|LOG10|OCT2BIN|OCT2DEC|OCT2HEX|SUNX2MY2|SUMX2PY2|SUMXMY2|T.DIST.2T|T.INV.2T/","g"),e.formulas_with_quoted_sheetnames_1=new RegExp("'[^']*'!\\$?[A-Z][A-Z]?\\$?\\d+","g"),e.formulas_with_quoted_sheetnames_2=new RegExp("'[^']*'!\\$?[A-Z][A-Z]?\\$?\\d+:\\$?[A-Z][A-Z]?\\$?\\d+","g"),e.formulas_with_unquoted_sheetnames_1=new RegExp("[A-Za-z0-9]+!\\$?[A-Z][A-Z]?\\$?\\d+","g"),e.formulas_with_unquoted_sheetnames_2=new RegExp("[A-Za-z0-9]+!\\$?[A-Z][A-Z]?\\$?\\d+:\\$?[A-Z][A-Z]?\\$?\\d+","g"),e.formulas_with_structured_references=new RegExp("\\[([^\\]])*\\]","g"),e.originalSheetSuffix="_EL",e}();t.ExcelUtils=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Colorize=t.tuple=void 0;var n=r(279),i=r(386),a=r(205),o=r(387),s=r(388),u=r(390),c=r(153);function l(e,t){if("number"==typeof e)return e-t;e=e,t=t;for(var r=0;r<e.length;r+=1){var n=l(e[r],t[r]);if(0!==n)return n}return 0}function d(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e}t.tuple=d;var f=function(){function e(){}return e.setReportingThreshold=function(t){e.reportingThreshold=t},e.getReportingThreshold=function(){return e.reportingThreshold},e.setFormattingDiscount=function(t){e.formattingDiscount=t},e.getFormattingDiscount=function(){return e.formattingDiscount},e.process_formulas=function(t,r,i){(0,c.watchdog)("wd0xea1170");for(var a=JSON.stringify(n.ExcelUtils.baseVector()),o=function(e,t){return[e[0]+t[0],e[1]+t[1],e[2]+t[2]]},s=[],u=0;u<t.length;u++){(0,c.watchdog)("wd0xa1597b");for(var l=t[u],d=0;d<l.length;d++){(0,c.watchdog)("wd0x0d7fc8");var f=l[d].toString();if(f.length>0){var p=n.ExcelUtils.all_dependencies(u,d,i+u,r+d,t),m=d+r+1,h=u+i+1;if(0===p.length)"="===f[0]&&s.push([[m,h,0],e.distinguishedZeroHash]);else{var v=p.reduce(o);if(JSON.stringify(v)===a)s.push([[m,h,0],v.toString()]);else{var g=this.hash_vector(v).toString();s.push([[m,h,0],g])}}}}}return s},e.color_all_data=function(t){for(var r=[],n=0,i=Object.keys(t);n<i.length;n++){var a=i[n];(0,c.watchdog)("wd0xc22046");var o=a.split(","),s=Number(o[0]),u=Number(o[1]);r.push([[s,u,0],e.distinguishedZeroHash])}return r},e.process_values=function(t,r,n,i){for(var a=[],o=0;o<t.length;o++){(0,c.watchdog)("wd0x503d57");for(var s=t[o],u=0;u<s.length;u++){(0,c.watchdog)("wd0x366ad1");var l=s[u].toString();if(l.length>0&&"="!==r[o][u][0])if(Number(l).toString()===l){var d=u+n+1,f=o+i+1;a.push([[d,f,1],e.distinguishedZeroHash])}}}return a},e.identify_ranges=function(e,t){for(var r={},n=0,i=e;n<i.length;n++){var a=i[n];(0,c.watchdog)("wd0x770d8c"),r[a[1]]=r[a[1]]||[],r[a[1]].push(a[0])}for(var o=0,s=Object.keys(r);o<s.length;o++){var u=s[o];(0,c.watchdog)("wd0x84ae4d"),r[u].sort(t)}return r},e.group_ranges=function(e,t){var r={},n=0,i=1;t||(n=1,i=0);for(var a=0,o=Object.keys(e);a<o.length;a++){var s=o[a];(0,c.watchdog)("wd0xa372ae"),r[s]=[];for(var u=e[s].shift(),l=u,d=0,f=e[s];d<f.length;d++){var p=f[d];p[n]===l[n]&&p[i]===l[i]+1||(r[s].push([u,l]),u=p),l=p}r[s].push([u,l])}return r},e.identify_groups=function(e){var t=this.identify_ranges(e,(function(e,t){return e[0]===t[0]?e[1]-t[1]:e[0]-t[0]})),r=this.group_ranges(t,!0),n=o.JSONclone.clone(r);return this.merge_groups(n)},e.processed_to_matrix=function(t,r,n,i,a){for(var o=new Array(t),s=0;s<t;s++)o[s]=new Array(r).fill(0);for(var u=0,c=a;u<c.length;u++){var l=c[u],d=l[0],f=d[0],p=d[1],m=d[2],h=l[1],v=p-i-1,g=f-n-1,b=Number(e.distinguishedZeroHash);1===m||(b=Number(h)),o[v][g]=b}return o},e.stencilize=function(e){return u.Stencil.stencil_computation(e,(function(e,t){return e*t}),1)},e.compute_stencil_probabilities=function(e,t,r){for(var n=new Array(e),i=0;i<e;i++)n[i]=new Array(t).fill(0);var a=0,o={};for(i=0;i<e;i++)for(var s=0;s<t;s++)o[r[i][s]]=o[r[i][s]]+1||1,0!==r[i][s]&&(a+=1);for(i=0;i<e;i++)for(s=0;s<t;s++)n[i][s]=o[r[i][s]]/a;var u=0,c=0;for(i=0;i<e;i++)for(s=0;s<t;s++)r[i][s]>0&&(c+=o[r[i][s]]);for(i=0;i<e;i++)for(s=0;s<t;s++)o[r[i][s]]>0&&(u+=this.entropy(o[r[i][s]]/c));Math.log2(a);return n},e.generate_suspicious_cells=function(e,t,r,n,i,a,o){void 0===o&&(o=.01);for(var s=[],u=0,c=0,l=0;l<e;l++)for(var d=0;d<t;d++){var f=d+r+1,p=l+n+1;a[l][d]>0&&(u+=i[l][d],c+=1,a[l][d]<=o&&0!==i[l][d]&&s.push([f,p,a[l][d]]))}var m=u/c;return s.sort((function(e,t){return Math.abs(t[2]-m)-Math.abs(e[2]-m)})),s},e.process_suspicious=function(t,r,i){(0,c.watchdog)("wd0x72fd38");new a.Timer("process_suspicious");var o=n.ExcelUtils.extract_sheet_cell(t),s=(o[0],o[1]),u=n.ExcelUtils.cell_dependency(s,0,0),l=[];r.length>this.formulasThreshold?console.warn("Too many formulas to perform formula analysis."):l=e.process_formulas(r,u[0]-1,u[1]-1);var f=[],p=[],m=i.length,h=i[0].length;if(i.length>this.valuesThreshold)console.warn("Too many values to perform reference analysis.");else{var v=n.ExcelUtils.generate_all_references(r,u[0]-1,u[1]-1);f=e.color_all_data(v),p=e.process_values(i,r,u[0]-1,u[1]-1)}var g=e.identify_groups(f),b=e.identify_groups(l),S=[];return i.length<1e4&&(S=e.find_suspicious_cells(m,h,u,r,l,p,1)),d(S,b,g,e.generate_proposed_fixes(b))},e.entropy=function(e){return-e*Math.log2(e)},e.entropydiff=function(e,t){var r=e+t;return-((this.entropy(e/r)+this.entropy(t/r))/Math.log2(r))},e.fix_metric=function(e,t,r,n){var a=t[0],o=t[1],s=n[0],u=n[1],c=i.RectangleUtils.area([[a[0],a[1],0],[o[0],o[1],0]]),l=i.RectangleUtils.area([[s[0],s[1],0],[u[0],u[1],0]]),d=Math.min(c,l),f=Math.max(c,l),p=Math.min(r,e),m=Math.max(r,e),h=Math.abs(m-p)/this.Multiplier;h<1&&(h=1);var v=(1+this.entropydiff(d,f))/(h*d);return v=-v},e.count_proposed_fixes=function(e){var t=0;for(var r in e){var n=e[r][1],a=n[0],o=n[1],s=e[r][2],u=s[0],c=s[1];t+=i.RectangleUtils.diagonal([[a[0],a[1],0],[o[0],o[1],0]]),t+=i.RectangleUtils.diagonal([[u[0],u[1],0],[c[0],c[1],0]])}return t},e.fix_proposed_fixes=function(t){var r={},n={};for(var i in t){if(t[i][1]>t[i][2]){var a=t[i][1];t[i][1]=t[i][2],t[i][2]=a}r[JSON.stringify(t[i][1])]=t[i],n[JSON.stringify(t[i][2])]=t[i]}var o=[],s={};for(var i in t){var u=t[i][0];if(!(-u<e.reportingThreshold/100)){var c=JSON.stringify(t[i][1]),l=JSON.stringify(t[i][2]);if(c in n||l in r){if(!s[c]&&c in n){var d=[-u*JSON.parse(n[c][0]),t[i][1],n[c][1]];o.push(d),s[c]=!0,s[l]=!0;continue}if(!s[l]&&l in r){d=[-u*JSON.parse(r[l][0]),t[i][1],r[l][2]];o.push(d),s[l]=!0,s[c]=!0}}else o.push(t[i])}}return o},e.generate_proposed_fixes=function(e){var t=(0,s.find_all_proposed_fixes)(e);return t.sort(l),t},e.merge_groups=function(e){for(var t=0,r=Object.keys(e);t<r.length;t++){var n=r[t];(0,c.watchdog)("wd0x781a33");var i=e[n].slice();e[n]=this.merge_individual_groups(i)}return e},e.merge_individual_groups=function(e){var t=new a.Timer("merge_individual_groups"),r=0;for(e=e.sort();;){(0,c.watchdog)("wd0x0a3668");for(var n=!1,o={},s=[],u=e.slice();u.length>0;)for(var l=u.shift(),d=0;d<u.length;d++)if((0,c.watchdog)("wd0x9cf1d5"),i.RectangleUtils.is_mergeable(l,u[d])){var f=JSON.stringify(l),p=JSON.stringify(u[d]);if(!(f in o)&&!(p in o)){s.push(i.RectangleUtils.bounding_box(l,u[d])),o[f]=!0,o[p]=!0,n=!0;break}}for(d=0;d<e.length;d++)(0,c.watchdog)("wd0x1bc2bb"),JSON.stringify(e[d])in o||s.push(e[d]);if(s.sort(),!n)return s;if(e=s.slice(),++r>2e3)return console.warn("Too many iterations; abandoning this group."),t.split("done, "+r+" iterations."),[[[-1,-1,0],[-1,-1,0]]]}},e.hash_vector=function(e){var t=0,r=0,n=Math.abs(e[0]-t),i=Math.abs(e[1]-r),a=e[2];return this.Multiplier*(n+i+a)},e.adjust_proposed_fixes=function(e,t,r,n){return e.map((function(e){var i=e[0];if(100*-i<1)return null;for(var a=e[1].map((function(e){return e.toString().padStart(10,"0")})),o=e[2].map((function(e){return e.toString().padStart(10,"0")})),s=a<o?e[1]:e[2],u=a<o?e[2]:e[1],c=s[0],l=c[0],f=c[1],p=s[1],m=(p[0],p[1],u[0]),h=(m[0],m[1],u[1]),v=h[0],g=h[1],b=l-r-1,S=f-n-1,y=v-r-1,O=g-n-1,C=!0,P=JSON.stringify(t[S][b]),N=S;N<=O;N++)for(var R=b;R<=y;R++){if(JSON.stringify(t[N][R])!==P){C=!1;break}}return d(i,s,u,C)})).filter((function(e){return null!==e}))},e.find_suspicious_cells=function(e,t,r,n,i,a,o){return(0,c.watchdog)("wd0x8cabd6"),[]},e.reportingThreshold=35,e.suspiciousCellsReportingThreshold=85,e.formattingDiscount=50,e.formulasThreshold=1e4,e.valuesThreshold=1e4,e.Multiplier=1,e.distinguishedZeroHash="12345",e}();t.Colorize=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.detect_errors=void 0;var n=r(385);Object.defineProperty(t,"detect_errors",{enumerable:!0,get:function(){return n.detect_errors}})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PackageName=void 0,t.PackageName="excel-online-calc-recalc"},function(e,t,r){"use strict";var n=r(391),i=r(393);function a(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}t.parse=S,t.resolve=function(e,t){return S(e,!1,!0).resolve(t)},t.resolveObject=function(e,t){return e?S(e,!1,!0).resolveObject(t):t},t.format=function(e){i.isString(e)&&(e=S(e));return e instanceof a?e.format():a.prototype.format.call(e)},t.Url=a;var o=/^([a-z0-9.+-]+:)/i,s=/:[0-9]*$/,u=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,c=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),l=["'"].concat(c),d=["%","/","?",";","#"].concat(l),f=["/","?","#"],p=/^[+a-z0-9A-Z_-]{0,63}$/,m=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,h={javascript:!0,"javascript:":!0},v={javascript:!0,"javascript:":!0},g={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},b=r(394);function S(e,t,r){if(e&&i.isObject(e)&&e instanceof a)return e;var n=new a;return n.parse(e,t,r),n}a.prototype.parse=function(e,t,r){if(!i.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var a=e.indexOf("?"),s=-1!==a&&a<e.indexOf("#")?"?":"#",c=e.split(s);c[0]=c[0].replace(/\\/g,"/");var S=e=c.join(s);if(S=S.trim(),!r&&1===e.split("#").length){var y=u.exec(S);if(y)return this.path=S,this.href=S,this.pathname=y[1],y[2]?(this.search=y[2],this.query=t?b.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var O=o.exec(S);if(O){var C=(O=O[0]).toLowerCase();this.protocol=C,S=S.substr(O.length)}if(r||O||S.match(/^\/\/[^@\/]+@[^@\/]+/)){var P="//"===S.substr(0,2);!P||O&&v[O]||(S=S.substr(2),this.slashes=!0)}if(!v[O]&&(P||O&&!g[O])){for(var N,R,k=-1,T=0;T<f.length;T++){-1!==(E=S.indexOf(f[T]))&&(-1===k||E<k)&&(k=E)}-1!==(R=-1===k?S.lastIndexOf("@"):S.lastIndexOf("@",k))&&(N=S.slice(0,R),S=S.slice(R+1),this.auth=decodeURIComponent(N)),k=-1;for(T=0;T<d.length;T++){var E;-1!==(E=S.indexOf(d[T]))&&(-1===k||E<k)&&(k=E)}-1===k&&(k=S.length),this.host=S.slice(0,k),S=S.slice(k),this.parseHost(),this.hostname=this.hostname||"";var _="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!_)for(var F=this.hostname.split(/\./),I=(T=0,F.length);T<I;T++){var A=F[T];if(A&&!A.match(p)){for(var M="",w=0,D=A.length;w<D;w++)A.charCodeAt(w)>127?M+="x":M+=A[w];if(!M.match(p)){var j=F.slice(0,T),x=F.slice(T+1),L=A.match(m);L&&(j.push(L[1]),x.unshift(L[2])),x.length&&(S="/"+x.join(".")+S),this.hostname=j.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),_||(this.hostname=n.toASCII(this.hostname));var B=this.port?":"+this.port:"",U=this.hostname||"";this.host=U+B,this.href+=this.host,_&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==S[0]&&(S="/"+S))}if(!h[C])for(T=0,I=l.length;T<I;T++){var G=l[T];if(-1!==S.indexOf(G)){var K=encodeURIComponent(G);K===G&&(K=escape(G)),S=S.split(G).join(K)}}var V=S.indexOf("#");-1!==V&&(this.hash=S.substr(V),S=S.slice(0,V));var W=S.indexOf("?");if(-1!==W?(this.search=S.substr(W),this.query=S.substr(W+1),t&&(this.query=b.parse(this.query)),S=S.slice(0,W)):t&&(this.search="",this.query={}),S&&(this.pathname=S),g[C]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){B=this.pathname||"";var H=this.search||"";this.path=B+H}return this.href=this.format(),this},a.prototype.format=function(){var e=this.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var t=this.protocol||"",r=this.pathname||"",n=this.hash||"",a=!1,o="";this.host?a=e+this.host:this.hostname&&(a=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(a+=":"+this.port)),this.query&&i.isObject(this.query)&&Object.keys(this.query).length&&(o=b.stringify(this.query));var s=this.search||o&&"?"+o||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||g[t])&&!1!==a?(a="//"+(a||""),r&&"/"!==r.charAt(0)&&(r="/"+r)):a||(a=""),n&&"#"!==n.charAt(0)&&(n="#"+n),s&&"?"!==s.charAt(0)&&(s="?"+s),t+a+(r=r.replace(/[?#]/g,(function(e){return encodeURIComponent(e)})))+(s=s.replace("#","%23"))+n},a.prototype.resolve=function(e){return this.resolveObject(S(e,!1,!0)).format()},a.prototype.resolveObject=function(e){if(i.isString(e)){var t=new a;t.parse(e,!1,!0),e=t}for(var r=new a,n=Object.keys(this),o=0;o<n.length;o++){var s=n[o];r[s]=this[s]}if(r.hash=e.hash,""===e.href)return r.href=r.format(),r;if(e.slashes&&!e.protocol){for(var u=Object.keys(e),c=0;c<u.length;c++){var l=u[c];"protocol"!==l&&(r[l]=e[l])}return g[r.protocol]&&r.hostname&&!r.pathname&&(r.path=r.pathname="/"),r.href=r.format(),r}if(e.protocol&&e.protocol!==r.protocol){if(!g[e.protocol]){for(var d=Object.keys(e),f=0;f<d.length;f++){var p=d[f];r[p]=e[p]}return r.href=r.format(),r}if(r.protocol=e.protocol,e.host||v[e.protocol])r.pathname=e.pathname;else{for(var m=(e.pathname||"").split("/");m.length&&!(e.host=m.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==m[0]&&m.unshift(""),m.length<2&&m.unshift(""),r.pathname=m.join("/")}if(r.search=e.search,r.query=e.query,r.host=e.host||"",r.auth=e.auth,r.hostname=e.hostname||e.host,r.port=e.port,r.pathname||r.search){var h=r.pathname||"",b=r.search||"";r.path=h+b}return r.slashes=r.slashes||e.slashes,r.href=r.format(),r}var S=r.pathname&&"/"===r.pathname.charAt(0),y=e.host||e.pathname&&"/"===e.pathname.charAt(0),O=y||S||r.host&&e.pathname,C=O,P=r.pathname&&r.pathname.split("/")||[],N=(m=e.pathname&&e.pathname.split("/")||[],r.protocol&&!g[r.protocol]);if(N&&(r.hostname="",r.port=null,r.host&&(""===P[0]?P[0]=r.host:P.unshift(r.host)),r.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===m[0]?m[0]=e.host:m.unshift(e.host)),e.host=null),O=O&&(""===m[0]||""===P[0])),y)r.host=e.host||""===e.host?e.host:r.host,r.hostname=e.hostname||""===e.hostname?e.hostname:r.hostname,r.search=e.search,r.query=e.query,P=m;else if(m.length)P||(P=[]),P.pop(),P=P.concat(m),r.search=e.search,r.query=e.query;else if(!i.isNullOrUndefined(e.search)){if(N)r.hostname=r.host=P.shift(),(_=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=_.shift(),r.host=r.hostname=_.shift());return r.search=e.search,r.query=e.query,i.isNull(r.pathname)&&i.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r}if(!P.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var R=P.slice(-1)[0],k=(r.host||e.host||P.length>1)&&("."===R||".."===R)||""===R,T=0,E=P.length;E>=0;E--)"."===(R=P[E])?P.splice(E,1):".."===R?(P.splice(E,1),T++):T&&(P.splice(E,1),T--);if(!O&&!C)for(;T--;T)P.unshift("..");!O||""===P[0]||P[0]&&"/"===P[0].charAt(0)||P.unshift(""),k&&"/"!==P.join("/").substr(-1)&&P.push("");var _,F=""===P[0]||P[0]&&"/"===P[0].charAt(0);N&&(r.hostname=r.host=F?"":P.length?P.shift():"",(_=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=_.shift(),r.host=r.hostname=_.shift()));return(O=O||r.host&&P.length)&&!F&&P.unshift(""),P.length?r.pathname=P.join("/"):(r.pathname=null,r.path=null),i.isNull(r.pathname)&&i.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=e.auth||r.auth,r.slashes=r.slashes||e.slashes,r.href=r.format(),r},a.prototype.parseHost=function(){var e=this.host,t=s.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},function(e,t,r){r(285),r(286),e.exports=r(397)},function(e,t,r){
/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */var n;n=function(){"use strict";function e(e){return"function"==typeof e}var t=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},r=0,n=void 0,i=void 0,a=function(e,t){f[r]=e,f[r+1]=t,2===(r+=2)&&(i?i(p):b())},o="undefined"!=typeof window?window:void 0,s=o||{},u=s.MutationObserver||s.WebKitMutationObserver,c="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),l="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function d(){var e=setTimeout;return function(){return e(p,1)}}var f=new Array(1e3);function p(){for(var e=0;e<r;e+=2)(0,f[e])(f[e+1]),f[e]=void 0,f[e+1]=void 0;r=0}var m,h,v,g,b=void 0;function S(e,t){var r=this,n=new this.constructor(C);void 0===n[O]&&A(n);var i=r._state;if(i){var o=arguments[i-1];a((function(){return F(i,n,o,r._result)}))}else E(r,n,e,t);return n}function y(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(C);return N(t,e),t}c?b=function(){return process.nextTick(p)}:u?(h=0,v=new u(p),g=document.createTextNode(""),v.observe(g,{characterData:!0}),b=function(){g.data=h=++h%2}):l?((m=new MessageChannel).port1.onmessage=p,b=function(){return m.port2.postMessage(0)}):b=void 0===o?function(){try{var e=Function("return this")().require("vertx");return void 0!==(n=e.runOnLoop||e.runOnContext)?function(){n(p)}:d()}catch(e){return d()}}():d();var O=Math.random().toString(36).substring(2);function C(){}function P(t,r,n){r.constructor===t.constructor&&n===S&&r.constructor.resolve===y?function(e,t){1===t._state?k(e,t._result):2===t._state?T(e,t._result):E(t,void 0,(function(t){return N(e,t)}),(function(t){return T(e,t)}))}(t,r):void 0===n?k(t,r):e(n)?function(e,t,r){a((function(e){var n=!1,i=function(e,t,r,n){try{e.call(t,r,n)}catch(e){return e}}(r,t,(function(r){n||(n=!0,t!==r?N(e,r):k(e,r))}),(function(t){n||(n=!0,T(e,t))}),e._label);!n&&i&&(n=!0,T(e,i))}),e)}(t,r,n):k(t,r)}function N(e,t){if(e===t)T(e,new TypeError("You cannot resolve a promise with itself"));else if(i=typeof(n=t),null===n||"object"!==i&&"function"!==i)k(e,t);else{var r=void 0;try{r=t.then}catch(t){return void T(e,t)}P(e,t,r)}var n,i}function R(e){e._onerror&&e._onerror(e._result),_(e)}function k(e,t){void 0===e._state&&(e._result=t,e._state=1,0!==e._subscribers.length&&a(_,e))}function T(e,t){void 0===e._state&&(e._state=2,e._result=t,a(R,e))}function E(e,t,r,n){var i=e._subscribers,o=i.length;e._onerror=null,i[o]=t,i[o+1]=r,i[o+2]=n,0===o&&e._state&&a(_,e)}function _(e){var t=e._subscribers,r=e._state;if(0!==t.length){for(var n=void 0,i=void 0,a=e._result,o=0;o<t.length;o+=3)n=t[o],i=t[o+r],n?F(r,n,i,a):i(a);e._subscribers.length=0}}function F(t,r,n,i){var a=e(n),o=void 0,s=void 0,u=!0;if(a){try{o=n(i)}catch(e){u=!1,s=e}if(r===o)return void T(r,new TypeError("A promises callback cannot return that same promise."))}else o=i;void 0!==r._state||(a&&u?N(r,o):!1===u?T(r,s):1===t?k(r,o):2===t&&T(r,o))}var I=0;function A(e){e[O]=I++,e._state=void 0,e._result=void 0,e._subscribers=[]}var M=function(){function e(e,r){this._instanceConstructor=e,this.promise=new e(C),this.promise[O]||A(this.promise),t(r)?(this.length=r.length,this._remaining=r.length,this._result=new Array(this.length),0===this.length?k(this.promise,this._result):(this.length=this.length||0,this._enumerate(r),0===this._remaining&&k(this.promise,this._result))):T(this.promise,new Error("Array Methods must be provided an Array"))}return e.prototype._enumerate=function(e){for(var t=0;void 0===this._state&&t<e.length;t++)this._eachEntry(e[t],t)},e.prototype._eachEntry=function(e,t){var r=this._instanceConstructor,n=r.resolve;if(n===y){var i=void 0,a=void 0,o=!1;try{i=e.then}catch(e){o=!0,a=e}if(i===S&&void 0!==e._state)this._settledAt(e._state,t,e._result);else if("function"!=typeof i)this._remaining--,this._result[t]=e;else if(r===w){var s=new r(C);o?T(s,a):P(s,e,i),this._willSettleAt(s,t)}else this._willSettleAt(new r((function(t){return t(e)})),t)}else this._willSettleAt(n(e),t)},e.prototype._settledAt=function(e,t,r){var n=this.promise;void 0===n._state&&(this._remaining--,2===e?T(n,r):this._result[t]=r),0===this._remaining&&k(n,this._result)},e.prototype._willSettleAt=function(e,t){var r=this;E(e,void 0,(function(e){return r._settledAt(1,t,e)}),(function(e){return r._settledAt(2,t,e)}))},e}(),w=function(){function t(e){this[O]=I++,this._result=this._state=void 0,this._subscribers=[],C!==e&&("function"!=typeof e&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof t?function(e,t){try{t((function(t){N(e,t)}),(function(t){T(e,t)}))}catch(t){T(e,t)}}(this,e):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return t.prototype.catch=function(e){return this.then(null,e)},t.prototype.finally=function(t){var r=this.constructor;return e(t)?this.then((function(e){return r.resolve(t()).then((function(){return e}))}),(function(e){return r.resolve(t()).then((function(){throw e}))})):this.then(t,t)},t}();return w.prototype.then=S,w.all=function(e){return new M(this,e).promise},w.race=function(e){var r=this;return t(e)?new r((function(t,n){for(var i=e.length,a=0;a<i;a++)r.resolve(e[a]).then(t,n)})):new r((function(e,t){return t(new TypeError("You must pass an array to race."))}))},w.resolve=y,w.reject=function(e){var t=new this(C);return T(t,e),t},w._setScheduler=function(e){i=e},w._setAsap=function(e){a=e},w._asap=a,w.polyfill=function(){var e=void 0;if("undefined"!=typeof global)e=global;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var r=null;try{r=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===r&&!t.cast)return}e.Promise=w},w.Promise=w,w.polyfill(),w},e.exports=n()},function(e,t){!function(e,t){"use strict";if(!e.setImmediate){var r,n,i,a,o,s=1,u={},c=!1,l=e.document,d=Object.getPrototypeOf&&Object.getPrototypeOf(e);d=d&&d.setTimeout?d:e,"[object process]"==={}.toString.call(e.process)?r=function(e){process.nextTick((function(){p(e)}))}:!function(){if(e.postMessage&&!e.importScripts){var t=!0,r=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=r,t}}()?e.MessageChannel?((i=new MessageChannel).port1.onmessage=function(e){p(e.data)},r=function(e){i.port2.postMessage(e)}):l&&"onreadystatechange"in l.createElement("script")?(n=l.documentElement,r=function(e){var t=l.createElement("script");t.onreadystatechange=function(){p(e),t.onreadystatechange=null,n.removeChild(t),t=null},n.appendChild(t)}):r=function(e){setTimeout(p,0,e)}:(a="setImmediate$"+Math.random()+"$",o=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(a)&&p(+t.data.slice(a.length))},e.addEventListener?e.addEventListener("message",o,!1):e.attachEvent("onmessage",o),r=function(t){e.postMessage(a+t,"*")}),d.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var i={callback:e,args:t};return u[s]=i,r(s),s++},d.clearImmediate=f}function f(e){delete u[e]}function p(e){if(c)setTimeout(p,0,e);else{var t=u[e];if(t){c=!0;try{!function(e){var t=e.callback,r=e.args;switch(r.length){case 0:t();break;case 1:t(r[0]);break;case 2:t(r[0],r[1]);break;case 3:t(r[0],r[1],r[2]);break;default:t.apply(void 0,r)}}(t)}finally{f(e),c=!1}}}}}("undefined"==typeof self?"undefined"==typeof global?this:global:self)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fnv1a=void 0;t.fnv1a=function(e){for(var t=2166136261,r=e.length,n=0;n<r;n+=1)t^=e.charCodeAt(n),t+=(t<<1)+(t<<4)+(t<<7)+(t<<8)+(t<<24);return t>>>0}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.findIsomorphicSubtrees=void 0,t.findIsomorphicSubtrees=function(e,t,r,n){void 0===r&&(r=function(){return""}),void 0===n&&(n=function(){return 1});for(var i=[e],a=new Set(i),o=0;o<i.length;o+=1)for(var s=0,u=t(i[o]);s<u.length;s++){var c=u[s];a.has(c)||(a.add(c),i.push(c))}a.clear(),i.reverse();var l=new Map,d=[],f=new Map,p=[];i.forEach((function(e,i){var a=t(e).map((function(e){return l.get(e)}));if(a.some((function(e){return void 0===e})))throw new Error("Circular references in the tree");var o=a.map((function(e){return d[e]})),s=function(e){var t=f.get(e);return void 0!==t||(t=f.size,f.set(e,t)),t}(o.join("/")+"/"+r(e));if(d.push(s),void 0===p[s]){var u=o.map((function(e){return p[e]})),c=u.map((function(e){return e.size})).reduce((function(e,t){return e+t}),n(e)),m=u.map((function(e){return e.depth})).reduce((function(e,t){return Math.max(e,t)}),0)+1;p[s]={subtrees:[e],size:c,depth:m}}else p[s].subtrees.push(e);l.set(e,i)}));for(var m=0,h=p;m<h.length;m++){(S=h[m]).subtrees.reverse()}for(var v=new Array(i.length),g=0,b=p;g<b.length;g++){var S=b[g];v[v.length-l.get(S.subtrees[0])-1]=S}return v.filter((function(e){return void 0!==e}))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getBoundingRectForText=t.getCharIndexInTextFromPoint=t.calcHashCode=t.decodeHtml=t.getQueryParameterByName=t.chainFallbackPromises=t.retry=t.getPerfWatchMarkName=t.getStringifiedError=t.defaultToJSONResultWhenStringifyFails=t.forEachPromise=void 0,t.forEachPromise=function(e,t,r){return e.reduce((function(e,n){return e.then((function(){return r&&r.stop?Promise.resolve(void 0):t(n,r)}))}),Promise.resolve(void 0))},t.defaultToJSONResultWhenStringifyFails="...",t.getStringifiedError=function(e){if(0===e)return"0";if(!e)return"";try{return JSON.stringify(function e(t,r){void 0===r&&(r=0);if(r<0||r>5)return t;if(null==t||"object"!=typeof t)return t;var n={};Object.getOwnPropertyNames(t).forEach((function(e){"stack"!==e&&e.toUpperCase()!==e&&(n[e]=t[e])}));var i=Object.getPrototypeOf(t);i&&"object"==typeof i&&Object.keys(i).forEach((function(e){"stack"!==e&&e.toUpperCase()!==e&&(n[e]=t[e])}));var a={};return Object.keys(n).forEach((function(t){a[t]=e(n[t],r+1)})),a}(e))}catch(e){return t.defaultToJSONResultWhenStringifyFails}};var n=new RegExp("".concat("\\W","+"),"g");t.getPerfWatchMarkName=function(e){if(!e)return"";var t=e.trim().substring(0,200).trim().replace(n,"_").substring(0,80);return t&&t.length>0&&"_"===t.substr(t.length-1,1)&&(t=t.substr(0,t.length-1)),t&&t.length>0&&"_"===t.substr(0,1)&&(t=t.substr(1)),t},t.retry=function(e,t){if(!e)return Promise.reject(new Error("utils.retry: action can't be null or undefined"));if(t<1)return Promise.reject(new Error("utils.retry: attempts expected to be greater than 0 but got ".concat(t)));for(var r=Promise.reject(),n=function(t){r=r.catch((function(r){return e(t,r)}))},i=1;i<=t;i+=1)n(i);return r},t.chainFallbackPromises=function(e,t){if(!e||0===e.length)return Promise.reject();for(var r=t(e[0]),n=function(n){var i=e[n];r=r.catch((function(){return t(i)}))},i=1;i<e.length;i+=1)n(i);return r},t.getQueryParameterByName=function(e,t){var r=new RegExp("[?&]".concat(t,"(=([^&#]*)|&|#|$)")).exec(e);if(r)return r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):""},t.decodeHtml=function(e){return"string"==typeof e?(new DOMParser).parseFromString(e,"text/html").documentElement.textContent:e},t.calcHashCode=function(e){if(!e)return 0;for(var t=5381,r=t,n=e.length,i=0;i<n&&(t=4294967295&((t<<5)+t^e.charCodeAt(i)),i!==n-1);i+=2)r=4294967295&((r<<5)+r^e.charCodeAt(i+1));var a=t+35685*r+(23896*r<<16)&4294967295;return a<0&&(a+=4294967296),a},t.getCharIndexInTextFromPoint=function(e,t,r){void 0===r&&(r=!1);var n=-1,i=null;if(void 0!==document.caretPositionFromPoint)null!==(a=document.caretPositionFromPoint(e,t))&&(n=a.offset,i=null!=a.offsetNode&&null!=a.offsetNode.parentElement&&"SPAN"===a.offsetNode.parentElement.nodeName?a.offsetNode.parentElement:a.offsetNode);else if(void 0!==document.caretRangeFromPoint){null!==(a=document.caretRangeFromPoint(e,t))&&(n=a.startOffset,i=null!=a.startContainer&&null!=a.startContainer.parentElement&&"SPAN"===a.startContainer.parentElement.nodeName?a.startContainer.parentElement:a.startContainer)}else try{var a;i=document.elementFromPoint(e,t),(a=document.body.createTextRange()).moveToPoint(e,t);var o=document.body.createTextRange();o.moveToElementText(i),o.setEndPoint("EndToStart",a),n=o.text.length}catch(e){return n}if(r)for(var s=!1;null!=i;)null===i.previousSibling&&null!==i.parentNode&&null!==i.parentNode.parentNode&&i.parentNode.parentNode.childNodes.length>1&&!s?(i=i.parentNode,s=!0):null!=(i=i.previousSibling)&&null!=i.textContent&&(n+=i.textContent.length,s&&(n+=1));else for(;null!=i;)null!=(i=i.previousSibling)&&null!=i.textContent&&(n+=i.textContent.length);return n},t.getBoundingRectForText=function(e,t,r,n){function i(e,t,r){if(!e||!e.textContent)return t;if(n&&(t<0||t>e.textContent.length&&(0===e.childNodes.length||"DIV"!==e.childNodes[0].nodeName)))return t-e.textContent.length;if(t<0||t>e.textContent.length)return t-e.textContent.length;if(!e.hasChildNodes())return r(e,t),t-e.textContent.length;for(var a=e.childNodes,o=0;o<a.length&&t>=0;o+=1)t=i(a[o],t,r),n&&"DIV"===a[o].nodeName&&(t-=1);return t}void 0===n&&(n=!1);var a=document.createRange();return i(e,t,(function(e,t){return a.setStart(e,t)})),i(e,r,(function(e,t){return a.setEnd(e,t)})),a.getBoundingClientRect()}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.promises=void 0;var n={};t.promises=function(){return void 0===n.promises&&(n.promises="undefined"!=typeof Promise&&"function"==typeof Promise.resolve&&Promise.resolve(0)&&"function"==typeof Promise.resolve(0).then),n.promises}},function(e,t,r){"use strict";function n(){var e="undefined"!=typeof self?self:window;return e.performance&&e.performance.now?e.performance.now():Date.now()}function i(e,t,r){e[t]=n()-r}Object.defineProperty(t,"__esModule",{value:!0}),t.timeStamp=t.failure=t.success=t.end=t.mark=t.start=void 0,t.start=function(e){var t=n(),r=e,a=t,o={},s=function(e,t,n){return function(e,t,r,n,a,o){i(e,"end",r);var s={sessionName:t,result:n?"success":"failure",message:o,marks:e},u=JSON.stringify(s);a(u)}(o,r,a,e,t,n)};return o.start=0,{mark:function(e){return function(e){return i(o,e,a)}(e)},end:function(e){return s(!0,e)},success:function(e,t){return s(!0,e,t)},failure:function(e,t){return s(!1,e,t)}}},t.mark=function(e,t){void 0!==e&&e.mark(t)},t.end=function(e,t){void 0!==e&&e.end(t)},t.success=function(e,t,r){void 0!==e&&e.success(t,r)},t.failure=function(e,t,r){void 0!==e&&e.failure(t,r)},t.timeStamp=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initEwaUtils=t.ewaUtils=void 0;var n=r(293),i={isChangeGateEnabled:function(e){return!1}};t.ewaUtils=function(){return i},t.initEwaUtils=function(e){if(!e)throw new Error("the 'ewaUtils' argument is missing");(0,n.setChangeGatesManager)({isChangeGateEnabled:e.isChangeGateEnabled}),i=e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2);n.__exportStar(r(294),t),n.__exportStar(r(295),t)},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.isChangeGateEnabled=t.setChangeGatesManager=void 0;t.setChangeGatesManager=function(e){n=e};t.isChangeGateEnabled=function(e){return!n||n.isChangeGateEnabled(e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initStopwatchFactory=void 0;var n=function(){return Date.now()};t.initStopwatchFactory=function(e,t){return void 0===t&&(t=1),"undefined"!=typeof self&&self.performance&&self.performance.now&&(n=function(){return self.performance.now()}),function(r){var i=n(),a=r;return{reset:function(e){null!=e&&(a=e),i=n()},stop:function(r){var o=n()-i,s=JSON.stringify({Target:a,Duration:o.toFixed(t),StopInfo:r});e(s)}}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TelemetryCollector=void 0;var n=function(){function e(){this.counters={},this.timers={},this.events={}}return e.prototype.getJsonForLogging=function(){return'{"Events":'+this.getEventsLoggableString()+',"Counters":'+this.getCountersLoggableString()+',"Timers":'+this.getTimersLoggableString()+"}"},e.prototype.addEvent=function(e,t){null!=e&&null!=t&&(this.events[e]=t)},e.prototype.clearEvents=function(){this.events={}},e.prototype.getEventsLoggableString=function(){return JSON.stringify(this.events)},e.prototype.incrementCounter=function(e){null!=e&&(this.counters.hasOwnProperty(e)?this.counters[e]+=1:this.counters[e]=1)},e.prototype.getCountersLoggableString=function(){return JSON.stringify(this.counters)},e.prototype.clearCounters=function(){this.counters={}},e.prototype.startTimer=function(e){null!=e&&(this.timers[e]={name:e,startTime:Date.now(),endTime:void 0,isRunning:!0,duration:void 0})},e.prototype.endTimer=function(e){null!=e&&this.timers.hasOwnProperty(e)&&(this.timers[e].endTime=Date.now(),this.timers[e].isRunning=!1,this.timers[e].duration=this.timers[e].endTime-this.timers[e].startTime)},e.prototype.getTimerDuration=function(e){return null==e?"-1":this.timers.hasOwnProperty(e)&&void 0!==this.timers[e].duration?this.timers[e].duration:"-1"},e.prototype.getTimersLoggableString=function(){return JSON.stringify(this.timers)},e}();t.TelemetryCollector=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNewGuid=void 0,t.getNewGuid=function(){var e=new Uint8Array(31),t=function(e){var t={crypto:!1,perfNow:!1,exceptions:[]},r="undefined"!=typeof self?self:window,n=r.crypto||r.msCrypto;if(n){t.crypto=!0;try{return n.getRandomValues(e),t}catch(e){t.exceptions.push("crypto: ".concat(JSON.stringify(e)))}}var i=!1,a=r.performance;try{a&&a.now&&a.now()!==1/0&&(i=!0)}catch(e){t.exceptions.push("perfNow: ".concat(JSON.stringify(e)))}for(var o=0;o<e.length;o+=1){try{if(i){t.perfNow=!0;var s=Math.floor(100*a.now())%10;(s<0||s>9)&&(s=0);for(var u=0;u<s;u+=1)Math.random()}}catch(e){t.exceptions.push("Math.random: ".concat(JSON.stringify(e)))}e[o]=Math.floor(16*Math.random())}return t}(e),r=0;return["xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=15&e[r];return r+=1,("x"===t?n:3&n|8).toString(16)})),t]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextAreaInputMode=t.TextAreaVirtualKeyboardPolicy=void 0,function(e){e.Auto="auto",e.Manual="manual"}(t.TextAreaVirtualKeyboardPolicy||(t.TextAreaVirtualKeyboardPolicy={})),function(e){e.None="none",e.Text="text",e.Tel="tel",e.Url="url",e.Email="email",e.Numeric="numeric",e.Decimal="decimal",e.Search="search"}(t.TextAreaInputMode||(t.TextAreaInputMode={}))},function(e,t,r){"use strict";e.exports=r(301)()?globalThis:r(302)},function(e,t,r){"use strict";e.exports=function(){return"object"==typeof globalThis&&(!!globalThis&&globalThis.Array===Array)}},function(e,t){var r=function(){if("object"==typeof self&&self)return self;if("object"==typeof window&&window)return window;throw new Error("Unable to resolve global `this`")};e.exports=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(e){return r()}try{return __global__||r()}finally{delete Object.prototype.__global__}}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetTypedFeatureGate=void 0;var n=r(170);t.makeGetTypedFeatureGate=function(e){return function(t){var r=e[t];switch(typeof r){case"boolean":return(0,n.getBooleanFeatureGate)(t,r);case"number":return(0,n.getNumberFeatureGate)(t,r);case"string":return(0,n.getStringFeatureGate)(t,r);default:throw new Error("Wrong defaultValue type")}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeTypedIsChangeGateEnabled=void 0;var n=r(171);t.makeTypedIsChangeGateEnabled=function(e){return function(e){return(0,n.isChangeGateEnabled)(e)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedChangeGates=t.overrideChangeGates=void 0;var n=r(2),i=r(171);function a(e){var t=(0,i.setChangeGateDictionaryGetter)(void 0);return void 0===t?(0,i.setChangeGateDictionaryGetter)(void 0):(0,i.setChangeGateDictionaryGetter)((function(){var r=t();return null===r?null:n.__assign(n.__assign({},r),e)})),t}t.overrideChangeGates=a,t.overrideTypedChangeGates=function(e,t){return a(t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedFeatureGates=t.overrideFeatureGates=void 0;var n=r(2),i=r(170);function a(e){for(var t,r,a={},o=0,s=Object.keys(e);o<s.length;o++){var u=s[o];a[u]=null===(t=e[u])||void 0===t?void 0:t.toString()}var c=null!==(r=(0,i.setFeatureGateDictionaryGetter)(void 0))&&void 0!==r?r:function(){return{}};return(0,i.setFeatureGateDictionaryGetter)((function(){return n.__assign(n.__assign({},c()),a)})),c}t.overrideFeatureGates=a,t.overrideTypedFeatureGates=function(e,t){return a(t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.randomElement=t.randomShuffled=t.randomIndex=t.randomFloat=void 0;var n,i,a=r(101),o=r(206),s=(n=.4531024141007942,i=null!=Object({NODE_ENV:"production"}).BUILD_BUILDID?n:Math.random()*Date.now(),new o.JSF32(i));function u(e){return(0,a.assertTrue)("calc.common.randomIndex",e>0),Math.min(e-1,Math.floor(s.next()*e))}t.randomFloat=function(){return s.next()},t.randomIndex=u,t.randomShuffled=function(e){return e.map((function(e){return[s.next(),e]})).sort((function(e,t){return e[0]<t[0]?-1:e[0]===t[0]?0:1})).map((function(e){return e[1]}))},t.randomElement=function(e){return e[u(e.length)]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.enumerateKeysInOrder=t.enumerateInOrder=t.RootPointer=t.ArrayMapTree=t.floorToPowerOf2=void 0;var n=r(127);function i(e){if(0===e)return 0;var t=e;return t=((t=((t=((t=((t=(t|t>>>1)>>>0)|t>>>2)>>>0)|t>>>4)>>>0)|t>>>8)>>>0)|t>>>16)>>>0,(t+=1)/2}t.floorToPowerOf2=i;var a=function(){function e(e,t,r){this.keyCompare=e,this.keys=t,this.values=r}return e.create=function(t){return new e(t,[],[])},e.prototype.setValue=function(e,t){return this.setValues([[e,t]])},e.prototype.remove=function(e){return void 0===this.getKeyIndex(e)?this:this.filter((function(t){return t!==e}))},e.prototype.getOrSetValue=function(e,t){var r=this.getKeyIndex(e);if(void 0===r){var n=t();return[this.setValue(e,n),n]}return[this,this.values[r]]},e.prototype.filter=function(e){for(var t=[],r=0;r<this.keys.length;r+=1){var n=this.keys[r],i=this.values[r];e(n,i)&&t.push([n,i])}return t.length===this.getCount()?this:this.ofSequence(t)},e.prototype.getCount=function(){return this.keys.length},e.prototype.getValue=function(e){var t=this.getKeyIndex(e);if(void 0!==t)return this.values[t]},e.prototype.getEntry=function(e){var t=this.getKeyIndex(e);if(void 0!==t)return(0,n.entry)(this.keys[t],this.values[t])},e.prototype.contains=function(e){return void 0!==this.getKeyIndex(e)},e.prototype.forEach=function(e){for(var t=0;t<this.keys.length;t+=1)if(!e(this.keys[t],this.values[t]))return!1;return!0},e.prototype.setValues=function(e){var t=this,r=this.keys.map((function(e,r){return[e,t.values[r],r]})),n=r.length;e.forEach((function(e,t){var i=e[0],a=e[1];return r.push([i,a,t+n])})),r.sort((function(e,r){var n=e[0],i=e[2],a=r[0],o=r[2],s=t.keyCompare(n,a);return 0!==s?s:i-o}));for(var i=[],a=void 0,o=0;o<r.length;o+=1){var s=r[o],u=s[0],c=s[1];void 0===a||0!==this.keyCompare(u,a)?(i.push([u,c]),a=u):i[i.length-1]=[u,c]}return this.ofSequence(i)},e.prototype.getKeyIndex=function(e){for(var r=t.RootPointer;r>=0&&r<this.keys.length;){var n=this.keyCompare(e,this.keys[r]);if(0===n)return r;n<0?r=s(r):n>0&&(r=u(r))}},e.prototype.ofSequence=function(r){var n=this,a=r.slice();a.sort((function(e,t){var r=e[0],i=t[0];return n.keyCompare(r,i)}));for(var o=new Array(a.length),c=new Array(a.length),l=function(e){var r=new Array(e);return function e(t,r,n,a){if(t>=r.length)return;var o=function(e){var t=i(e);if(t/2-1<=e-t)return t-1;return e-t/2}(a);r[t]=n+o,e(s(t),r,n,o),e(u(t),r,n+o+1,a-o-1)}(t.RootPointer,r,0,e),r}(a.length),d=0;d<a.length;d+=1){var f=a[l[d]],p=f[0],m=f[1];o[d]=p,c[d]=m}return new e(this.keyCompare,o,c)},e}();function o(e,t){var r=[];return function e(t,r,n){if(r<0||r>=t.keys.length)return;e(t,s(r),n),n.push([t.keys[r],t.values[r]]),e(t,u(r),n)}(e,t,r),r}function s(e){return 2*e+1}function u(e){return 2*e+2}t.ArrayMapTree=a,t.RootPointer=0,t.enumerateInOrder=o,t.enumerateKeysInOrder=function(e,t){return o(e,t).map((function(e){return e[0]}))}},function(e,t,r){"use strict";function n(e,t){return e&t-1}Object.defineProperty(t,"__esModule",{value:!0}),t.Deque=void 0;var i=function(){function e(){this.front=0,this.count=0,this.values=[void 0]}return e.prototype.getCount=function(){return this.count},e.prototype.maybeResize=function(){var e=this.values.length;if(this.count>=e){this.values.length=e<<1;for(var t=0;t<this.front;t+=1)this.values[e+t]=this.values[t],this.values[t]=void 0}else{var r=e>>4;if(r>=1&&this.count<r){for(t=0;t<this.count;t+=1)this.values[n(this.front+t,r)]=this.values[n(this.front+t,e)];this.values.length=r,this.front=n(this.front,r)}}},e.prototype.pushBack=function(e){this.maybeResize(),this.values[n(this.front+this.count,this.values.length)]=e,this.count+=1},e.prototype.pushFront=function(e){this.maybeResize();var t=n(this.front-1,this.values.length);this.values[t]=e,this.front=t,this.count+=1},e.prototype.peekBack=function(){return this.values[n(this.front+this.count-1,this.values.length)]},e.prototype.peekFront=function(){return this.values[this.front]},e.prototype.peekPos=function(e){if(!(e<0||e>=this.count))return this.values[n(this.front+e,this.values.length)]},e.prototype.popBack=function(){var e=n(this.front+this.count-1,this.values.length),t=this.values[e];return void 0!==t&&(this.values[e]=void 0,this.count-=1),t},e.prototype.popFront=function(){var e=this.values[this.front];return void 0!==e&&(this.values[this.front]=void 0,this.front=n(this.front+1,this.values.length),this.count-=1),e},e.prototype.forEach=function(e){for(var t=this.values.length,r=0;r<this.count;r+=1){if(!e(this.values[n(this.front+r,t)]))return!1}return!0},e}();t.Deque=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeNumberDict=t.makeStringDict=t.makeDictionary=void 0;var n=r(127),i=r(74);function a(e){function t(e,t){return Object.prototype.hasOwnProperty.call(e,t)}return{entries:(0,i.makeStringMap)(),keyToString:e,getCount:function(){return Object.keys(this.entries).length},getValue:function(e){var r=this.keyToString(e),n=t(this.entries,r)?this.entries[r]:void 0;return(0,i.isDefined)(n)?n.value:void 0},getEntry:function(e){var t=this.getValue(e);return void 0===t?void 0:(0,n.entry)(e,t)},setValue:function(e,r){var a=this.keyToString(e),o=t(this.entries,a)?this.entries[a]:void 0;(0,i.isDefined)(o)?o.value=r:this.entries[a]=(0,n.entry)(e,r)},contains:function(e){var r=this.keyToString(e),n=t(this.entries,r)?this.entries[r]:void 0;return(0,i.isDefined)(n)},remove:function(e){var r=this.keyToString(e);return!!t(this.entries,r)&&(delete this.entries[r],!0)},getOrSetValue:function(e,r){var a=this.keyToString(e),o=t(this.entries,a)?this.entries[a]:void 0;if((0,i.isDefined)(o))return o.value;var s=r();return delete this.entries[a],this.entries[a]=(0,n.entry)(e,s),s},forEach:function(e){for(var r in this.entries){var n=t(this.entries,r)?this.entries[r]:void 0;if((0,i.isDefined)(n)&&!e(n.key,n.value))return!1}return!0},filter:function(e){var t=[];this.forEach((function(r,n){return e(r,n)||t.push(r),!0}));for(var r=0,n=t;r<n.length;r++){var i=n[r];this.remove(i)}}}}t.makeDictionary=a,t.makeStringDict=function(){return a(i.identity)},t.makeNumberDict=function(){return a((function(e){return String(e)}))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeHashSet=void 0;var n=r(74),i=r(172);t.makeHashSet=function(e,t){return{map:{},keyToHash:e,keyEquals:t,nelements:0,add:function(e){var t=this.keyToHash(e);if((0,n.isNone)(this.map[t]))this.map[t]=[e],this.nelements+=1;else{for(var r=this.map[t],a=0;a<r.length;a+=1)if(this.keyEquals(e,r[a]))return;(0,i.logCollision)("object"==typeof e?"Object {".concat(Object.keys(e),"}"):typeof e),r.push(e),this.nelements+=1}},contains:function(e){var t=this.keyToHash(e),r=this.map[t];if((0,n.isNone)(r))return!1;for(var a=0;a<r.length;a+=1)if(this.keyEquals(e,r[a]))return!0;return(0,i.logCollision)("object"==typeof e?"Object {".concat(Object.keys(e),"}"):typeof e),!1},forEach:function(e){var t=this;Object.keys(this.map).forEach((function(r){t.map[Number(r)].forEach((function(t){e(t)}))}))},size:function(){return this.nelements},remove:function(e){var t=this,r=this.keyToHash(e),a=this.map[r];if((0,n.isNone)(a))return!1;var o=[],s=!1;return a.forEach((function(r){t.keyEquals(e,r)?(t.nelements-=1,s=!0):o.push(r)})),this.map[r]=o,s||(0,i.logCollision)("object"==typeof e?"Object {".concat(Object.keys(e),"}"):typeof e),s}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeHashTable=void 0;var n=r(127),i=r(172),a=r(74);t.makeHashTable=function(e,t){return{map:{},nentries:0,keyToHash:e,keyEquals:t,getCount:function(){return this.nentries},getValue:function(e){var t=this.getEntry(e);return void 0===t?void 0:t.value},getEntry:function(e){var t=this.keyToHash(e),r=this.map[t];if(!(0,a.isNone)(r)){for(var n=0;n<r.length;n+=1){var o=r[n];if(this.keyEquals(e,o.key))return o}(0,i.logCollision)("object"==typeof e?"Object {".concat(Object.keys(e),"}"):typeof e)}},contains:function(e){return void 0!==this.getValue(e)},setValue:function(e,t){var r=this.keyToHash(e),a=this.map[r];if(null==a)this.map[r]=[(0,n.entry)(e,t)],this.nentries+=1;else{for(var o=0;o<a.length;o+=1){var s=a[o];if(this.keyEquals(s.key,e))return void(s.value=t)}a.push((0,n.entry)(e,t)),this.nentries+=1,(0,i.logCollision)("object"==typeof e?"Object {".concat(Object.keys(e),"}"):typeof e)}},remove:function(e){var t=this.keyToHash(e),r=this.map[t];if((0,a.isNone)(r))return!1;for(var n=[],o=!1,s=0;s<r.length;s+=1){var u=r[s];this.keyEquals(e,u.key)?(this.nentries-=1,o=!0):n.push(u)}return this.map[t]=n,o||(0,i.logCollision)("object"==typeof e?"Object {".concat(Object.keys(e),"}"):typeof e),o},getOrSetValue:function(e,t){var r=this.keyToHash(e),o=this.map[r];if((0,a.isNone)(o)){var s=t();return this.map[r]=[(0,n.entry)(e,s)],this.nentries+=1,s}for(var u=0;u<o.length;u+=1){var c=o[u];if(this.keyEquals(e,c.key))return c.value}var l=t();return o.push((0,n.entry)(e,l)),this.nentries+=1,(0,i.logCollision)("object"==typeof e?"Object {".concat(Object.keys(e),"}"):typeof e),l},forEach:function(e){var t=this;return Object.keys(this.map).every((function(r){return t.map[Number(r)].every((function(t){return e(t.key,t.value)}))}))},filter:function(e){var t=[];this.forEach((function(r,n){return e(r,n)||t.push(r),!0}));for(var r=0,n=t;r<n.length;r++){var i=n[r];this.remove(i)}}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.binarySearch=t.exponentialBuckets=t.linearBuckets=t.Histogram=void 0;var n=function(){function e(e){var t,r,n=this;this.buckets=e,this.createSampleCounts=function(){return new Array(n.buckets.length+1).fill(0)},this.sampleCounts=this.createSampleCounts(),this.findBucket=(t=function(e,t){return e-t},r=n.buckets.length,function(e){return i(n.buckets,0,r,e,t)})}return e.prototype.addSample=function(e){var t=this.findBucket(e);t<0&&(t=~t),this.sampleCounts[t]+=1},e.prototype.reset=function(){var e={buckets:this.buckets,sampleCounts:this.sampleCounts};return this.sampleCounts=this.createSampleCounts(),e},e}();function i(e,t,r,n,i){for(var a=t,o=t+r-1;a<=o;){var s=a+(o-a>>>1),u=i(e[s],n);if(0===u)return s;u<0?a=s+1:o=s-1}return~a}t.Histogram=n,t.linearBuckets=function(e,t,r){for(var n=(t-e)/(r-1),i=[],a=e,o=0;o<r;a+=n,o+=1)i.push(a);return i},t.exponentialBuckets=function(e,t,r){for(var n=Math.log(e),i=(Math.log(t)-n)/(r-1),a=[],o=0,s=0;s<r;o+=i,s+=1)a.push(Math.exp(n+o));return a},t.binarySearch=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PriorityQueue=void 0;var n=r(209),i=function(){function e(e){this.min=0,this.max=0,this.heap=new n.BinaryHeap((function(t,r){var n=t[0],i=t[1],a=r[0],o=r[1],s=e(n,a);return 0!==s?s:i-o}))}return e.prototype.peek=function(){var e=this.heap.peek();if(void 0!==e)return e[0]},e.prototype.enqueue=function(e){this.max+=1,this.heap.insert([e,this.max])},e.prototype.push=function(e){this.min-=1,this.heap.insert([e,this.min])},e.prototype.pop=function(){var e=this.heap.removeMin();return void 0===e?(this.min=0,void(this.max=0)):e[0]},e.prototype.getCount=function(){return this.heap.getCount()},e.prototype.clear=function(){this.heap.clear()},e}();t.PriorityQueue=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.productSetSerializer=t.ProductSetSerializer=t.getSubspaceCount=t.forEachProduct=t.getSubspaces=t.symmetricDiffProduct=t.complementProduct=t.meetsProduct=t.compareProduct=t.exceptProduct=t.intersectProduct=t.unionProduct=t.project=t.createFromProduct=void 0;var n=r(2),i=r(210),a=r(126),o=function(e,t){var r,n,i=e[0],a=t[0];return r=String(i),n=String(a),r<n?-1:r>n?1:0},s={};var u=function(e){for(var t=[],r=0,n=Object.keys(e);r<n.length;r++){var i=n[r];t.push([i,e[i].id])}var a=function(e){for(var t="",r=0,n=e;r<n.length;r++){var i=n[r];t+=String(i[0]),t+="\0",t+=String(i[1]),t+="\0"}return t}(t.sort(o)),u=s[a];return void 0===u&&(u={box:{},probabilities:{},depth:1},s[a]=u),u};function c(e){return Object.getOwnPropertyNames(e).length>0}var l=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return(0,a.getTypedFeatureGate)("Microsoft.Office.Excel.ProductSetBugFixFromPR1043532")?d.apply(void 0,e):f.apply(void 0,e)};function d(e){return c(e)?{isSubspace:!0,bounds:e}:i.dense}function f(e){for(var t=!0,r=0,n=Object.keys(e);r<n.length;r++){var a=n[r];if(Object.prototype.hasOwnProperty.call(e,a)){t=!1;break}}return t?i.dense:{isSubspace:!0,bounds:e}}function p(e){return e.isSubspace?1:e.subspaceCount}var m=function(e,t,r){return{isSubspace:!1,left:e,right:t,bounds:r,subspaceCount:p(e)+p(t)}};function h(e,t){if(t===i.dense)return t;if(t.isSubspace){for(var r=!1,n=0,a=Object.keys(t.bounds);n<a.length;n++){var o=a[n];if(Object.prototype.hasOwnProperty.call(e,o)){r=!0;break}}if(!r)return i.dense}return{productOperations:e,root:t}}function v(e){return void 0===e?i.dense:e}var g={unzip:function(e){for(var t={},r={},n=0,a=Object.keys(e);n<a.length;n++){var o=a[n];if(Object.prototype.hasOwnProperty.call(e,o)){var s=e[o];if(s===i.empty)return i.empty;if(s===i.dense)continue;t[o]=s.setOperations,r[o]=s.root}}return h(t,l(r))},combineProduct:function(e,t,r,n){for(var a={},o=0,s=Object.keys(e);o<s.length;o++){var u=s[o];if(Object.prototype.hasOwnProperty.call(e,u)){var c=n(e[u],e[u].top,v(t[u]),v(r[u]));if(c===i.empty)return i.empty;if(c===i.dense)continue;a[u]=c}}return a},restrict:function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];for(var n={},i=0,a=t;i<a.length;i++){var o=a[i];if(Object.prototype.hasOwnProperty.call(e,o)){var s=e[o];n[o]=s}}return n},fromUntypedProduct:function(e,t,r){for(var n={},a=0,o=r;a<o.length;a++){var s=o[a],u=t[s];n[s]=(0,i.fromUntyped)(e[s],void 0!==u?u:i.dense)}return n},denseProduct:function(e){for(var t={},r=0,n=e;r<n.length;r++){t[n[r]]=i.dense}return t}};function b(e,t,r){var n=g.combineProduct(e,t,r,i.unionUntyped);if(n===i.empty)throw new Error("broken invariant: the union of two non-empty products cannot be empty");return n}function S(e,t,r){for(var n=0,a=0,o=Object.keys(e);a<o.length;a++){var s=o[a];if(Object.prototype.hasOwnProperty.call(e,s)){var u=v(t[s]),c=v(r[s]),l=e[s];if(void 0===(n=(0,i.combineCmp)(n,(0,i.compareUntyped)(l,l.top,u,c))))return}}return n}t.createFromProduct=g.unzip.bind(g);var y,O=(y={},function(e,t,r){var a;if(t===y.left&&r===y.right)return y.res;y.left=t,y.right=r;var o,s=S(e,t.bounds,r.bounds);if(void 0!==s)return y.res=s<=0?r:t;for(var u=0,c=Object.keys(e);u<c.length;u++){var d=c[u];if(Object.prototype.hasOwnProperty.call(e,d)&&0!==(0,i.compareUntyped)(e[d],e[d].top,v(t.bounds[d]),v(r.bounds[d]))){if(void 0!==o)return y.res=void 0;o=d}}if(void 0!==o){var f=(0,i.unionUntyped)(e[o],e[o].top,v(t.bounds[o]),v(r.bounds[o]));if(f===i.empty)return y.res=i.empty;if(f===i.dense){var p=t.bounds,m=o,h=(p[m],n.__rest(p,["symbol"==typeof m?m:m+""]));return y.res=l(h)}var g=n.__assign(n.__assign({},t.bounds),((a={})[o]=f,a));return y.res=l(g)}return y.res=void 0});function C(e,t,r){if(r===i.empty)return t;if(r===i.dense)return r;if(t===i.empty)return r;if(t===i.dense)return t;if(!t.isSubspace||!r.isSubspace)return m(t,r,b(e,t.bounds,r.bounds));var n=O(e,t,r);return void 0!==n?n:m(t,r,b(e,t.bounds,r.bounds))}function P(e,t){for(var r=[],a=2;a<arguments.length;a++)r[a-2]=arguments[a];var o=g.restrict.apply(g,n.__spreadArray([t.bounds],r,!1));if(t.isSubspace)return l(o);var s=P.apply(void 0,n.__spreadArray([e,t.left],r,!1));if(s===i.dense)return i.dense;var u=P.apply(void 0,n.__spreadArray([e,t.right],r,!1));return C(e,s,u)}function N(e,t,r){for(var a=[],o=3;o<arguments.length;o++)a[o-3]=arguments[o];if(t===i.empty||t===i.dense)return t;if(t.isSubspace){var s=g.restrict.apply(g,n.__spreadArray([t.bounds],a,!1));return l(s)}var u=T(e,r),c=u[0],d=u[1],f=E(e,t,c,d),p=f[0],m=f[1],h=N.apply(void 0,n.__spreadArray([e,p,c],a,!1)),v=N.apply(void 0,n.__spreadArray([e,m,d],a,!1));return C(e,h,v)}function R(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(e===i.dense||e===i.empty)return e;var a=g.restrict.apply(g,n.__spreadArray([e.productOperations],t,!1));if(!c(a))return i.dense;var o=N.apply(void 0,n.__spreadArray([a,e.root,u(a)],t,!1));return o===i.empty?o:h(a,o)}function k(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(e===i.dense||e===i.empty)return e;var a=g.restrict.apply(g,n.__spreadArray([e.productOperations],t,!1)),o=P.apply(void 0,n.__spreadArray([a,e.root],t,!1));return o===i.empty?o:h(a,o)}function T(e,t){var r,a,o,s;if(void 0!==t.children)return t.children;for(var u,c,l=t.box,d=t.probabilities,f=0,p=0,m=Object.keys(e);p<m.length;p++){var h=m[p];if(Object.prototype.hasOwnProperty.call(e,h)){var g=d[h],b=e[h];if(void 0===g){u=h,c=b.top;break}if(g>f){var S=v(l[h]);if(S===i.empty)throw new Error("the key split can never return empty");var y=b.top;if(S!==i.dense){if(!S.isExact)throw new Error("the key can always be represented exactly");y=S.key}if(!b.canSplit(y))continue;u=h,f=g,c=y}}}if(void 0===u||void 0===c)throw new Error("there has to be at least one dimension");var O=e[u],C=O.split(c),P=C[0],N=P[0],R=P[1],k=C[1],T=k[0],E=k[1],_=[{box:n.__assign(n.__assign({},l),(r={},r[u]=(0,i.lazy)(O,O.top,N),r)),probabilities:n.__assign(n.__assign({},d),(a={},a[u]=R,a)),depth:t.depth+1},{box:n.__assign(n.__assign({},l),(o={},o[u]=(0,i.lazy)(O,O.top,T),o)),probabilities:n.__assign(n.__assign({},d),(s={},s[u]=E,s)),depth:t.depth+1}];return t.depth<10&&(t.children=_),_}t.project=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return(0,a.getTypedFeatureGate)("Microsoft.Office.Excel.ProductSetBugFixFromPR1043532")?R.apply(void 0,e):k.apply(void 0,e)};var E=function(e,t,r,n){return function e(t,r,n,a){if(r===i.empty)return[i.empty,i.empty];if(r===i.dense)return[l(n),l(a)];var o=S(t,r.bounds,n);if(void 0!==o&&o<=0)return[r,i.empty];var s=g.combineProduct(t,r.bounds,n,i.intersectUntyped);if(s===i.empty)return[i.empty,r];var u=g.combineProduct(t,r.bounds,a,i.intersectUntyped);if(r.isSubspace)return[l(s),u===i.empty?i.empty:l(u)];var c=e(t,r.left,n,a),d=c[0],f=c[1],p=e(t,r.right,n,a),m=p[0],h=p[1];return[C(t,d,m),C(t,f,h)]}(e,t,r.box,n.box)};function _(e,t,r,n,a){var o=T(e,n),s=o[0],u=o[1],c=E(e,t,s,u),l=c[0],d=c[1],f=E(e,r,s,u),p=f[0],m=f[1],h=a(e,l,p,s);return h===i.dense?i.dense:C(e,h,a(e,d,m,u))}function F(e,t,r,n){if(r===i.empty)return t;if(t===i.empty)return r;if(t===i.dense)return t;if(r===i.dense)return r;if(t.isSubspace&&r.isSubspace){var a=O(e,t,r);if(void 0!==a)return a}return _(e,t,r,n,F)}function I(e,t){if(t===i.empty)return e;if(t===i.dense)return t;if(e===i.empty)return t;if(e===i.dense)return e;var r=n.__assign(n.__assign({},e.productOperations),t.productOperations),a=F(r,e.root,t.root,u(r));return a===i.empty?a:h(r,a)}function A(e,t,r,n){if(t===i.empty||r===i.empty)return i.empty;if(t===i.dense)return r;if(r===i.dense)return t;if(t.isSubspace&&r.isSubspace){var a=g.combineProduct(e,t.bounds,r.bounds,i.intersectUntyped);return a===i.empty?i.empty:l(a)}return _(e,t,r,n,A)}function M(e,t,r,a){if(t===i.empty)return t;if(r===i.dense)return i.empty;if(r===i.empty)return t;if(t===i.dense)return _(e,t,r,a,M);if(t.isSubspace&&r.isSubspace){var o=function(e,t,r){var a,o,s=S(e,t.bounds,r.bounds);if(0===s||-1===s)return i.empty;for(var u=0,c=Object.keys(e);u<c.length;u++){var d=c[u];if(Object.prototype.hasOwnProperty.call(e,d)){var f=(0,i.compareUntyped)(e[d],e[d].top,v(t.bounds[d]),v(r.bounds[d]));if(void 0===f||f>0){if(void 0!==o)return;o=d}}}if(void 0!==o){var p=(0,i.exceptUntyped)(e[o],e[o].top,v(t.bounds[o]),v(r.bounds[o]));if(p===i.empty)return i.empty;if(p===i.dense){var m=t.bounds,h=o,g=(m[h],n.__rest(m,["symbol"==typeof h?h:h+""]));return l(g)}var b=n.__assign(n.__assign({},t.bounds),((a={})[o]=p,a));return l(b)}}(e,t,r);if(void 0!==o)return o}return _(e,t,r,a,M)}function w(e,t){if(e===i.empty)return e;if(t===i.empty)return e;if(t===i.dense)return i.empty;if(e===i.dense){var r=M(t.productOperations,i.dense,t.root,u(t.productOperations));return r===i.empty?r:h(t.productOperations,r)}var a=n.__assign(n.__assign({},e.productOperations),t.productOperations),o=M(a,e.root,t.root,u(a));return o===i.empty?o:h(a,o)}function D(e,t,r,n){if(t===i.empty||r===i.empty)return!1;if(t===i.dense||r===i.dense)return!0;if(!function(e,t,r){for(var n=0,a=Object.keys(e);n<a.length;n++){var o=a[n];if(Object.prototype.hasOwnProperty.call(e,o)){var s=v(t[o]),u=v(r[o]),c=e[o];if(!(0,i.meetsUntyped)(c,c.top,s,u))return!1}}return!0}(e,t.bounds,r.bounds))return!1;if(t.isSubspace&&r.isSubspace)return!0;var a=T(e,n),o=a[0],s=a[1],u=E(e,t,o,s),c=u[0],l=u[1],d=E(e,r,o,s),f=d[0],p=d[1];return D(e,c,f,o)||D(e,l,p,s)}t.unionProduct=I,t.intersectProduct=function(e,t){if(e===i.empty)return e;if(t===i.empty)return t;if(e===i.dense)return t;if(t===i.dense)return e;var r=n.__assign(n.__assign({},e.productOperations),t.productOperations),a=A(r,e.root,t.root,u(r));return a===i.empty?a:h(r,a)},t.exceptProduct=w,t.compareProduct=function(e,t){if(e===t)return 0;if(e===i.empty)return-1;if(t===i.empty)return 1;if(e===i.dense)return t===i.dense?0:1;if(t===i.dense)return-1;var r=n.__assign(n.__assign({},e.productOperations),t.productOperations);return function e(t,r,n,a){if(r===n)return 0;if(r===i.empty)return-1;if(n===i.empty)return 1;if(r===i.dense)return n===i.dense?0:1;if(n===i.dense)return-1;if(r.isSubspace&&n.isSubspace)return S(t,r.bounds,n.bounds);var o=T(t,a),s=o[0],u=o[1],c=E(t,r,s,u),l=c[0],d=c[1],f=E(t,n,s,u),p=f[0],m=f[1],h=e(t,l,p,s);return void 0!==h?(0,i.combineCmp)(h,e(t,d,m,u)):void 0}(r,e.root,t.root,u(r))},t.meetsProduct=function(e,t){if(e===i.empty||t===i.empty)return!1;if(e===i.dense||t===i.dense)return!0;var r=n.__assign(n.__assign({},e.productOperations),t.productOperations);return D(r,e.root,t.root,u(r))};t.complementProduct=function(e){return w(i.dense,e)};t.symmetricDiffProduct=function(e,t){return I(w(e,t),w(t,e))},t.getSubspaces=function(e){if(e===i.empty||e===i.dense)return[];var t=[];return function e(r){r.isSubspace?t.push(r.bounds):(e(r.left),e(r.right))}(e.root),t},t.forEachProduct=function(e,r){for(var a=[],o=2;o<arguments.length;o++)a[o-2]=arguments[o];var s=t.project.apply(void 0,n.__spreadArray([e],a,!1));if(s===i.empty)return!0;if(s===i.dense)return r(g.denseProduct(a));var u=s.productOperations,c=s.root;function l(e){return e.isSubspace?r(g.fromUntypedProduct(u,e.bounds,a)):l(e.left)&&l(e.right)}return l(c)},t.getSubspaceCount=function(e){return e===i.empty||e===i.dense?0:p(e.root)};var j=function(){function e(e){void 0===e&&(e=[]),this.buffer=e,this.cursor=0}return e.prototype.putBack=function(e){this.cursor-=1,this.buffer[this.cursor]=e},e.prototype.pick=function(){return this.buffer[this.cursor]},Object.defineProperty(e.prototype,"length",{get:function(){return this.buffer.length-this.cursor},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"empty",{get:function(){return 0===this.length},enumerable:!1,configurable:!0}),e.prototype.pop=function(){var e=this.pick();return this.cursor+=1,e},e}(),x=function(){var e=this;this.size=0,this.clear=function(){},this.get=function(){},this.set=function(){return e}};function L(e,t){return function(r,i){for(var a=[],o=2;o<arguments.length;o++)a[o-2]=arguments[o];var s=t.get(r);void 0===s?(e.apply(void 0,n.__spreadArray([r,i],a,!1)),t.set(r,t.size)):i.push("__cached__",s)}}function B(e,t){return function(r){for(var i=[],a=1;a<arguments.length;a++)i[a-1]=arguments[a];if("__cached__"===r.pick()){r.pop();var o=r.pop();return t[o]}var s=e.apply(void 0,n.__spreadArray([r],i,!1));return t.push(s),s}}var U=function(){function e(t){var r,n,a,o,s=this;for(var u in this.globalProductOperations=t,this.cached="undefined"!=typeof Map?new Map:new x,this.cache=[],this.serializers={},this.serializeProductSet=function(e,t){if(e!==i.empty&&e!==i.dense){var r=e,n=s.getDims(r.productOperations);t.push(n),s.serializeUntypedSparseProductCached(r.root,t,n)}else t.push(e)},this.deserializeProductSet=function(e){var t=e.pop();if(t===i.empty||t===i.dense)return t;e.putBack(t);for(var r={},n=e.pop(),a=0,o=n;a<o.length;a++){var u=o[a],c=s.globalProductOperations[u];r[u]=c}return{productOperations:r,root:s.deserializeUntypedSparseProductCached(e,n)}},this.serializeUntypedSparse=function(t,r,n){r.push(null==t?void 0:t.isExact),r.push(s.serializers[n].serializeBound(null==t?void 0:t.infimum)),r.push(s.serializers[n].serializeBound(null==t?void 0:t.supremum));var a=e.normalizeKey(null==t?void 0:t.key);r.push(s.serializers[n].serializeKey(a));for(var o=0,u=[null==t?void 0:t.left,null==t?void 0:t.right];o<u.length;o++){var c=u[o];null==c||c===i.empty||c===i.dense?r.push(c):(r.push("us"),s.serializeUntypedSparseCached(c,r,n))}},this.deserializeUntypedSparse=function(e,t){var r=e.pop(),n=s.serializers[t].deserializeBound(e.pop()),i=s.serializers[t].deserializeBound(e.pop()),a=s.serializers[t].deserializeKey(e.pop()),o=["left","right"].map((function(r){var n=e.pop();return"us"===n?s.deserializeUntypedSparseCached(e,t):n}));return{infimum:n,supremum:i,isExact:r,key:a,left:o[0],right:o[1]}},this.serializeUntypedSparseProduct=function(e,t,r){t.push(e.isSubspace);for(var n=0,i=r;n<i.length;n++){var a=i[n],o=e.bounds[a];s.serializeUntypedSparseCached(o,t,a)}e.isSubspace||(s.serializeUntypedSparseProductCached(e.left,t,r),s.serializeUntypedSparseProductCached(e.right,t,r),t.push(e.subspaceCount))},this.deserializeUntypedSparseProduct=function(e,t){for(var r=e.pop(),n={},i=0,a=t;i<a.length;i++){var o=a[i],u=s.deserializeUntypedSparseCached(e,o);n[o]=u}return r?{isSubspace:r,bounds:n}:{isSubspace:r,bounds:n,left:s.deserializeUntypedSparseProductCached(e,t),right:s.deserializeUntypedSparseProductCached(e,t),subspaceCount:e.pop()}},this.serializeUntypedSparseCached=L(this.serializeUntypedSparse,this.cached),this.deserializeUntypedSparseCached=B(this.deserializeUntypedSparse,this.cache),this.serializeProductSetCached=L(this.serializeProductSet,this.cached),this.deserializeProductSetCached=B(this.deserializeProductSet,this.cache),this.serializeUntypedSparseProductCached=L(this.serializeUntypedSparseProduct,this.cached),this.deserializeUntypedSparseProductCached=B(this.deserializeUntypedSparseProduct,this.cache),t){var c={serializeKey:null!==(r=t[u].serializeKey)&&void 0!==r?r:function(e){return JSON.stringify(e)},deserializeKey:null!==(n=t[u].deserializeKey)&&void 0!==n?n:function(e){return JSON.parse(e)},serializeBound:null!==(a=t[u].serializeBound)&&void 0!==a?a:function(e){return JSON.stringify(e)},deserializeBound:null!==(o=t[u].deserializeBound)&&void 0!==o?o:function(e){return JSON.parse(e)}};this.serializers[u]=c}}return e.prototype.getDims=function(e){return Object.keys(e)},e.prototype.serialize=function(e){this.cached.clear();var t=[];t.push(e.length);for(var r=0,n=e;r<n.length;r++){var i=n[r];this.serializeProductSetCached(i,t)}return JSON.stringify(t)},e.prototype.deserialize=function(e){this.cache.length=0;for(var t=new j(JSON.parse(e)),r=t.pop(),n=[],i=0;i<r;i+=1){var a=this.deserializeProductSetCached(t);n.push(a)}return n},e.normalizeKey=function(e){if("object"==typeof e){var t=n.__assign({},e);return delete t.depth,delete t.split,t}return e},e}();t.ProductSetSerializer=U,t.productSetSerializer=function(e){return new U(e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RedBlackMapTree=void 0;var n=r(212),i=function(){function e(e,t,r){this.root=e,this.count=t,this.keyCompare=r}return e.create=function(t){return new e(n.emptyUntyped,0,t)},e.prototype.getCount=function(){return this.count},e.prototype.getValue=function(e){var t=(0,n.findUntyped)(this,e,this.root);return null==t?void 0:t.value},e.prototype.getEntry=function(e){return(0,n.findUntyped)(this,e,this.root)},e.prototype.contains=function(e){return void 0!==this.getValue(e)},e.prototype.forEach=function(e){return(0,n.forEachUntyped)(e,this.root)},e.prototype.setValue=function(t,r){return new e((0,n.insertUntyped)(this,t,r,this.root),this.contains(t)?this.count:this.count+1,this.keyCompare)},e.prototype.remove=function(t){return this.contains(t)?new e((0,n.removeUntyped)(this,t,this.root),this.count-1,this.keyCompare):this},e.prototype.getOrSetValue=function(t,r){var i=this.getValue(t);if(void 0!==i)return[this,i];var a=r();return[new e((0,n.insertUntyped)(this,t,a,this.root),this.count+1,this.keyCompare),a]},e.prototype.filter=function(t){var r=this,i=n.emptyUntyped,a=0;return this.forEach((function(e,o){return t(e,o)&&(i=(0,n.insertUntyped)(r,e,o,i),a+=1),!1})),new e(i,a,this.keyCompare)},e}();t.RedBlackMapTree=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RingBuffer=void 0;var n=function(){function e(e){void 0===e&&(e=1/0),this.list=e<1/0?new Array(e):new Array,this.counter=0,this.capacity=e,this.readIndex=0,this.writeIndex=0}return e.prototype.count=function(){return this.counter},e.prototype.isEmpty=function(){return 0===this.counter},e.prototype.enqueue=function(e){this.list[this.writeIndex]=e,0!==this.counter&&this.writeIndex===this.readIndex?this.readIndex=(this.readIndex+1)%this.capacity:this.counter++,this.writeIndex=(this.writeIndex+1)%this.capacity},e.prototype.dequeue=function(){if(!this.isEmpty()){var e=this.list[this.readIndex];return this.list[this.readIndex]=void 0,this.readIndex=(this.readIndex+1)%this.capacity,this.counter--,e}},e.prototype.executeOnEveryElement=function(e){for(var t=0;t<this.counter;t++){var r=(this.readIndex+t)%this.capacity,n=this.list[r];if(void 0!==n)if(!e(n))return!1}return!0},e}();t.RingBuffer=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RTree=t.RTKind=t.copyExcept=void 0;var n,i=r(2),a=r(74),o=r(127);function s(e,t,r){if(void 0!==r){var n=e.slice();return n[t]=r,n}var i=e.slice(0,-1);return t<e.length-1&&(i[t]=e[e.length-1]),i}function u(e,t,r){return{kind:e,key:t,value:r}}function c(e,t){return u(n.Ptr,e,t)}function l(e,t){return u(n.Leaf,e,t)}function d(e,t){return u(n.Branch,e,t)}t.copyExcept=s,function(e){e[e.Ptr=1]="Ptr",e[e.Leaf=2]="Leaf",e[e.Branch=3]="Branch"}(n=t.RTKind||(t.RTKind={}));var f=function(){function e(e,t,r){this.lattice=e,this.root=t,this.count=r}return e.create=function(t,r,n,i,a){void 0===a&&(a=2);var o=a>1?Math.ceil(a):1;return new e({keyJoin:t,keyMeets:r,keyCompare:n,keyDistance:i,minChildren:o,maxChildren:2*o,keyGe:function(e,t){var r=n(e,t);return void 0!==r&&r>=0},keyLe:function(e,t){var r=n(e,t);return void 0!==r&&r<=0}},void 0,0)},e.prototype.getCount=function(){return this.count},Object.defineProperty(e.prototype,"bounds",{get:function(){var e;return null===(e=this.root)||void 0===e?void 0:e.key},enumerable:!1,configurable:!0}),e.prototype.getValue=function(e){if(void 0!==this.root)return function t(r,i){var a=r.keyCompare(i.key,e);if(i.kind===n.Ptr)return 0===a?i.value:void 0;if(!(void 0===a||a<0))for(var o=0,s=i.value;o<s.length;o++){var u=t(r,s[o]);if(void 0!==u)return u}}(this.lattice,this.root)},e.prototype.getEntry=function(e){var t=this.getValue(e);return void 0===t?void 0:(0,o.entry)(e,t)},e.prototype.setValue=function(t,r,n){void 0===n&&(n=function(e){return!0});var i=b(this.lattice,this.root,t,n,r);return void 0!==i?i===this.root?this:new e(this.lattice,i,this.count):new e(this.lattice,g(this.lattice,this.root,c(t,r)),this.count+1)},e.prototype.filter=function(t){var r=new e(this.lattice,void 0,0);return this.forEach((function(e,n){return t(e,n)&&(r=r.setValue(e,n)),!0})),r},e.prototype.contains=function(e,t){return void 0===t&&(t=function(e){return!0}),void 0!==b(this.lattice,this.root,e,t)},e.prototype.getOrSetValue=function(e,t){var r=this.getValue(e);if(void 0===r){var n=t();return[this.setValue(e,n),n]}return[this,r]},e.prototype.forEach=function(e){return p(this.root,e)},e.prototype.forEachGe=function(e,t){var r=this;return p(this.root,t,(function(t){return r.lattice.keyGe(t,e)}),(function(t){return r.lattice.keyGe(t,e)}))},e.prototype.forEachLe=function(e,t){var r=this;return p(this.root,t,(function(t){return r.lattice.keyMeets(t,e)}),(function(t){return r.lattice.keyLe(t,e)}))},e.prototype.forEachMeets=function(e,t){var r=this;return p(this.root,t,(function(t){return r.lattice.keyMeets(t,e)}),(function(t){return r.lattice.keyMeets(t,e)}))},e.prototype.remove=function(t){var r=this;if(null==this.root)return this;var i=[],o=this.lattice,u=function(e,r){var c=o.keyCompare(e.key,t);if(void 0===c||c<0)return(0,a.pair)(e,1);if(e.kind===n.Leaf){for(var f=e.value,p=0;p<f.length;p+=1)if(0===o.keyCompare(f[p].key,t)){if((S=s(f,p)).length<r){var m=l(e.key,S);return i.push(m),(0,a.pair)(m,3)}return(0,a.pair)(l(h(o,S),S),2)}}else for(f=e.value,p=0;p<f.length;p+=1){var v=u(f[p],o.minChildren),g=v[0],b=v[1];if(3===b){var S;if((S=s(f,p)).length>=r)return(0,a.pair)(d(h(o,S),S),2);m=d(e.key,S);return i.push(m),(0,a.pair)(m,3)}if(2===b)return(0,a.pair)(d(e.key,s(f,p,g)),2)}return(0,a.pair)(e,1)},f=this.root.kind===n.Leaf?1:2,m=u(this.root,f),v=m[0],b=m[1];if(v===this.root)return this;for(var S=3===b?void 0:v,y=0;y<i.length;y+=1)p(i[y],(function(e,t){return S=g(r.lattice,S,c(e,t)),!0}));return new e(this.lattice,S,this.count-1)},e}();function p(e,t,r,i){var a=void 0!==r?r:function(){return!0},o=void 0!==i?i:function(){return!0};if(null==e)return!0;var s=function(e){if(!a(e.key))return!0;if(e.kind===n.Leaf)for(var r=e.value,i=0;i<r.length;i+=1){var u=r[i];if(o(u.key)&&!t(u.key,u.value))return!1}else for(r=e.value,i=0;i<r.length;i+=1)if(!s(r[i]))return!1;return!0};return s(e)}function m(e,t){for(var r=function(e,t){for(var r=0,n=1,i=e.keyDistance(t[0].key,t[1].key),o=2;o<t.length;o+=1)for(var s=0;s<o;s+=1){var u=e.keyDistance(t[s].key,t[o].key);u>i&&(r=s,n=o,i=u)}return(0,a.pair)(r,n)}(e,t),n=r[0],i=r[1],o=t[n].key,s=t[i].key,u=[],c=0;c<t.length;c+=1){var l=t[c];u.push([l,e.keyDistance(o,l.key)-e.keyDistance(s,l.key)])}u.sort((function(e,t){return e[1]-t[1]}));for(var d=e.minChildren;d<t.length-e.minChildren&&u[d][1]<0;d+=1);var f=[],p=[];for(c=0;c<d;c+=1)f.push(u[c][0]);for(c=d;c<t.length;c+=1)p.push(u[c][0]);return(0,a.pair)(f,p)}function h(e,t){for(var r=t[0].key,n=1;n<t.length;n+=1)r=e.keyJoin(r,t[n].key);return r}function v(e,t,r){var n=m(e,r),i=n[0],o=n[1];return(0,a.pair)(u(t,h(e,i),i),u(t,h(e,o),o))}function g(e,t,r){if(null==t)return l(r.key,[r]);var o=function t(o){if(o.kind===n.Leaf){var s=i.__spreadArray(i.__spreadArray([],o.value,!0),[r],!1);if(s.length>e.maxChildren){var u=v(e,o.kind,s),c=u[0],f=u[1];return(0,a.pair)(l(c.key,c.value),f)}return(0,a.pair)(l(e.keyJoin(o.key,r.key),s),void 0)}var p=o.value.slice(),m=function(e,t,r){for(var n=0,i=e.keyDistance(t[0].key,r),a=t[0].value.length,o=1;o<t.length;o+=1){var s=t[o],u=e.keyDistance(s.key,r);(u<i||u===i&&s.value.length<a)&&(n=o,i=u,a=s.value.length)}return n}(e,p,r.key),h=t(p[m]),g=h[0],b=h[1];if(p[m]=g,null!=b&&(p.push(b),p.length>e.maxChildren)){var S=v(e,o.kind,p),y=S[0];f=S[1];return(0,a.pair)(d(y.key,y.value),f)}return(0,a.pair)(d(e.keyJoin(o.key,r.key),p),void 0)}(t),s=o[0],u=o[1];return null!=u?d(e.keyJoin(s.key,u.key),[s,u]):s}function b(e,t,r,i,a){if(void 0!==t)return function t(i){if(i.kind!==n.Leaf)for(a=0;a<i.value.length;a+=1){u=i.value[a];if(e.keyMeets(u.key,r))if(void 0!==(c=t(u)))return d(i.key,s(i.value,a,c))}else for(var a=0;a<i.value.length;a+=1){var u,c;if(void 0!==(c=o(u=i.value[a])))return l(i.key,s(i.value,a,c))}}(t);function o(t){if(0===e.keyCompare(t.key,r))return void 0!==a&&t.value!==a&&i(t.value)?c(t.key,a):t}}t.RTree=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.boundedParetoSetOperations=t.boundedParetoSplitter=t.boundedPareto=void 0;var n=r(74),i=r(211);function a(e,t,r){var n=Math.pow(t,e),i=1-Math.pow(t/r,e),a=Math.pow(r,e),o=a*n,s=a-n,u=-1/e;return{cdf:1===e?function(e){return(1-n/e)/i}:function(t){return(1-n*Math.pow(t,-e))/i},invCdf:1===e?function(e){return 1/((a-e*s)/o)}:function(e){return Math.pow((a-e*s)/o,u)}}}function o(e,t,r){var i=a(e,t,r);return{canSplit:function(e){var t=e[0];return e[1]-t>1},split:function(e){var t=e[0],r=e[1],a=i.cdf(r),o=i.cdf(t+1),s=i.invCdf((a+o)/2),u=(0,n.fastMin)((0,n.fastMax)(Math.round(s),t+1),r-1);return[[[t,u],i.cdf(u)-i.cdf(t+1)],[[u,r],i.cdf(r)-i.cdf(u)]]}}}t.boundedPareto=a,t.boundedParetoSplitter=o,t.boundedParetoSetOperations=function(e,t,r,a,s){var u=o(e,t,r);return{id:s,split:function(e){return u.split(e)},canSplit:function(e){return u.canSplit(e)},meets:i.ivlMeets,intersect:i.ivlMeet,union:function(e,t){return(0,i.ivlMeetsOrTouches)(e,t)?(0,i.ivlJoin)(e,t):void 0},except:i.ivlExcept,compare:i.ivlCompare,top:a,infimum:function(e){return e[0]},supremum:function(e){return e[1]},combineInfima:function(e,t){return(0,n.fastMin)(e,t)},combineSuprema:function(e,t){return(0,n.fastMax)(e,t)}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.broadcastArray2D=t.broadcastArray=t.colArray2D=t.rowArray2D=t.singletonArray2D=t.constantArray2D=t.constantArray=t.array2DToJaggedArray=t.jaggedArray=t.array2DForall2=t.array2DForall=t.NonstrictSparseArray2D=t.NonstrictArray2D=t.StrictSparseArray2D=t.strictArray2D=t.StrictArray2D=void 0;var n=r(101),i=r(74),a=function(){function e(e,t,r){(0,n.assertNatural)("calc.common.StrictArray2D",e),(0,n.assertNatural)("calc.common.StrictArray2D",t);var i=r.length;i<e&&(0,n.assertFalse)("calc.common.StrictArray2D: expected elements.length >= ".concat(e,"; given ").concat(i));for(var a=0;a<i;a+=1){var o=r[a].length;o<t&&(0,n.assertFalse)("calc.common.StrictArray2D: expected elements[".concat(a,"].length >= ").concat(e,"; given ").concat(o))}this.rows=e,this.cols=t,this.elements=r}return e.prototype.get=function(e,t){return(0,n.assertIndex)("calc.common.StrictArray2D.get",e,this.rows),(0,n.assertIndex)("calc.common.StrictArray2D.get",t,this.cols),this.elements[e][t]},e.prototype.strict=function(){return this},e.prototype.map=function(e){var t=this;return new s(this.rows,this.cols,(function(r,n){return e(t.elements[r][n])}))},e}();t.StrictArray2D=a,t.strictArray2D=function(e,t,r){return new a(e,t,r)};var o=function(){function e(e,t,r,i,a,o){(0,n.assertNatural)("calc.common.StrictSparseArray2D",e),(0,n.assertNatural)("calc.common.StrictSparseArray2D",t),(0,n.assertIndex)("calc.common.StrictSparseArray2D",r,e+1),(0,n.assertIndex)("calc.common.StrictSparseArray2D",i,t+1);var s=a.length;s<r&&(0,n.assertFalse)("calc.common.StrictSparseArray2D: expected elements.length >= ".concat(r,"; given ").concat(s));for(var u=0;u<s;u+=1){var c=a[u].length;c<i&&(0,n.assertFalse)("calc.common.StrictSparseArray2D: expected elements[".concat(u,"].length >= ").concat(i,"; given ").concat(c))}this.rows=e,this.cols=t,this.denseRows=r,this.denseCols=i,this.denseElements=a,this.sparseElement=o}return e.prototype.get=function(e,t){return(0,n.assertIndex)("calc.common.StrictSparseArray2D.get",e,this.rows),(0,n.assertIndex)("calc.common.StrictSparseArray2D.get",t,this.cols),e<this.denseRows&&t<this.denseCols?this.denseElements[e][t]:this.sparseElement},e.prototype.getSparse=function(){return this.sparseElement},e.prototype.strict=function(){return this},e.prototype.map=function(e){var t=this;return new u(this.rows,this.cols,this.denseRows,this.denseCols,(function(r,n){return e(t.denseElements[r][n])}),(function(){return e(t.sparseElement)}))},e}();t.StrictSparseArray2D=o;var s=function(){function e(e,t,r){(0,n.assertNatural)("calc.common.NonstrictArray2D",e),(0,n.assertNatural)("calc.common.NonstrictArray2D",t),this.rows=e,this.cols=t,this.func=r}return e.prototype.get=function(e,t){return(0,n.assertIndex)("calc.common.NonstrictArray2D.get",e,this.rows),(0,n.assertIndex)("calc.common.NonstrictArray2D.get",t,this.cols),this.func(e,t)},e.prototype.strict=function(){var e=c(this.rows,this.cols,this.func);return new a(this.rows,this.cols,e)},e.prototype.map=function(t){var r=this;return new e(this.rows,this.cols,(function(e,n){return t(r.func(e,n))}))},e}();t.NonstrictArray2D=s;var u=function(){function e(e,t,r,i,a,o){(0,n.assertNatural)("calc.common.NonstrictSparseArray2D",e),(0,n.assertNatural)("calc.common.NonstrictSparseArray2D",t),(0,n.assertIndex)("calc.common.NonstrictSparseArray2D",r,e+1),(0,n.assertIndex)("calc.common.NonstrictSparseArray2D",i,t+1),this.rows=e,this.cols=t,this.denseRows=r,this.denseCols=i,this.denseFunc=a,this.sparseFunc=o}return e.prototype.get=function(e,t){return(0,n.assertIndex)("calc.common.NonstrictSparseArray2D.get",e,this.rows),(0,n.assertIndex)("calc.common.NonstrictSparseArray2D.get",t,this.cols),e<this.denseRows&&t<this.denseCols?this.denseFunc(e,t):this.sparseFunc()},e.prototype.getSparse=function(){return this.sparseFunc()},e.prototype.strict=function(){var e=c(this.denseRows,this.denseCols,this.denseFunc),t=this.sparseFunc();return new o(this.rows,this.cols,this.denseRows,this.denseCols,e,t)},e.prototype.map=function(t){var r=this;return new e(this.rows,this.cols,this.denseRows,this.denseCols,(function(e,n){return t(r.denseFunc(e,n))}),(function(){return t(r.sparseFunc())}))},e}();function c(e,t,r){for(var n=[],i=0;i<e;i+=1){for(var a=[],o=0;o<t;o+=1)a[o]=r(i,o);n[i]=a}return n}function l(e,t,r){for(var n=[],i=[],a=0;a<t;a+=1)i[a]=r;for(var o=0;o<e;o+=1)n[o]=i;return n}function d(e,t,r){return new s(e,t,(function(e,t){return r}))}t.NonstrictSparseArray2D=u,t.array2DForall=function(e,t){for(var r=0;r<t.rows;r+=1)for(var n=0;n<t.cols;n+=1)if(!e(t.get(r,n)))return!1;return!0},t.array2DForall2=function(e,t,r){for(var n=(0,i.fastMin)(t.rows,r.rows),a=(0,i.fastMin)(t.cols,r.cols),o=0;o<n;o+=1)for(var s=0;s<a;s+=1)if(!e(t.get(o,s),r.get(o,s)))return!1;return!0},t.jaggedArray=c,t.array2DToJaggedArray=function(e){return c(e.rows,e.cols,e.get.bind(e))},t.constantArray=l,t.constantArray2D=d,t.singletonArray2D=function(e){return d(1,1,e)},t.rowArray2D=function(e){return new s(1,e.length,(function(t,r){return e[r]}))},t.colArray2D=function(e){return new s(e.length,1,(function(t,r){return e[t]}))},t.broadcastArray=function(e,t,r,n,i,a){if(e===r&&t===n)return i;if(1===e&&1===t)return l(r,n,void 0===i[0]?a:i[0][0]);var o,s=[];o=1===e?function(e,r){return r<t?i[0][r]:a}:1===t?function(t,r){return t<e?i[t][0]:a}:function(r,n){return r<e&&n<t?i[r][n]:a};for(var u=0;u<r;u+=1){s.push([]);for(var c=0;c<n;c+=1)s[u][c]=o(u,c)}return s},t.broadcastArray2D=function(e,t,r,n){return r.rows===e&&r.cols===t?r:1===r.rows&&1===r.cols?d(e,t,r.get(0,0)):1===r.rows?new s(e,t,(function(e,t){return t<r.cols?r.get(0,t):n})):1===r.cols?new s(e,t,(function(e,t){return e<r.rows?r.get(e,0):n})):new s(e,t,(function(e,t){return e<r.rows&&t<r.cols?r.get(e,t):n}))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.asyncLoop=void 0;var n=r(74),i=r(173);function a(e){return new Promise((function(t){return setTimeout(t,e)}))}t.asyncLoop=function(e,t){var r,o,s,u=null!==(r=null==t?void 0:t.timeThreshold)&&void 0!==r?r:10,c=null!==(o=null==t?void 0:t.costThreshold)&&void 0!==o?o:1,l=null!==(s=null==t?void 0:t.macrotaskDelay)&&void 0!==s?s:0,d={iterations:0,microtaskContinues:0,macrotaskContinues:0,macrotaskTotalDelay:0},f=(0,i.newPromise)(),p=f[0],m=f[1],h=m[0],v=m[1],g=!0,b=a(l),S=(0,n.now)();return function t(){if(!g||!function(){try{for(var t=0;t<c;){d.iterations+=1;var r=e();if(void 0===r)return!1;t+=r}return!0}catch(e){return v(e),!1}}())return h();var r=(0,n.now)();r-S<u?(Promise.resolve().then(t),d.microtaskContinues+=1):(b.then((function(){b=a(l),S=(0,n.now)(),d.macrotaskTotalDelay+=S-r,t()})),d.macrotaskContinues+=1)}(),{promise:p,stop:function(){g=!1},stats:d}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.codePointCapitalD=t.codePointCapitalC=t.codePointCapitalB=t.codePointCapitalA=t.codePointTilde=t.codePointRightCurlyBracket=t.codePointPipe=t.codePointLeftCurlyBracket=t.codePointBacktick=t.codePointUnderscore=t.codePointCircumflexAccent=t.codePointRightSquareBracket=t.codePointBackslash=t.codePointLeftSquareBracket=t.codePointAtSign=t.codePointQuestionMark=t.codePointGreaterThanSign=t.codePointEqualsSign=t.codePointLessThanSign=t.codePointSemicolon=t.codePointColon=t.codePointDigitNine=t.codePointDigitEight=t.codePointDigitSeven=t.codePointDigitSix=t.codePointDigitFive=t.codePointDigitFour=t.codePointDigitThree=t.codePointDigitTwo=t.codePointDigitOne=t.codePointDigitZero=t.codePointSlash=t.codePointFullStop=t.codePointMinusSign=t.codePointComma=t.codePointPlusSign=t.codePointAsterisk=t.codePointRightParen=t.codePointLeftParen=t.codePointSingleQuote=t.codePointAmpersand=t.codePointPercentSign=t.codePointDollarSign=t.codePointHash=t.codePointDoubleQuote=t.codePointExclamationMark=t.codePointSpace=t.codePointCR=t.codePointLF=t.codePointTab=void 0,t.codePointThaiDigitNine=t.codePointThaiDigitZero=t.codePointSmallZ=t.codePointSmallY=t.codePointSmallX=t.codePointSmallW=t.codePointSmallV=t.codePointSmallU=t.codePointSmallT=t.codePointSmallS=t.codePointSmallR=t.codePointSmallQ=t.codePointSmallP=t.codePointSmallO=t.codePointSmallN=t.codePointSmallM=t.codePointSmallL=t.codePointSmallK=t.codePointSmallJ=t.codePointSmallI=t.codePointSmallH=t.codePointSmallG=t.codePointSmallF=t.codePointSmallE=t.codePointSmallD=t.codePointSmallC=t.codePointSmallB=t.codePointSmallA=t.codePointCapitalZ=t.codePointCapitalY=t.codePointCapitalX=t.codePointCapitalW=t.codePointCapitalV=t.codePointCapitalU=t.codePointCapitalT=t.codePointCapitalS=t.codePointCapitalR=t.codePointCapitalQ=t.codePointCapitalP=t.codePointCapitalO=t.codePointCapitalN=t.codePointCapitalM=t.codePointCapitalL=t.codePointCapitalK=t.codePointCapitalJ=t.codePointCapitalI=t.codePointCapitalH=t.codePointCapitalG=t.codePointCapitalF=t.codePointCapitalE=void 0,t.codePointInvertedQuestionMark=t.codePointInvertedExclamationMark=t.codePointEuroSign=t.codePointFullwidthLatinSmallZ=t.codePointFullwidthLatinSmallA=t.codePointFullwidthLatinCapitalZ=t.codePointFullwidthLatinCapitalA=t.codePointFullwidthDigitNine=t.codePointFullwidthDigitZero=void 0,t.codePointTab=9,t.codePointLF=10,t.codePointCR=13,t.codePointSpace=32,t.codePointExclamationMark=33,t.codePointDoubleQuote=34,t.codePointHash=35,t.codePointDollarSign=36,t.codePointPercentSign=37,t.codePointAmpersand=38,t.codePointSingleQuote=39,t.codePointLeftParen=40,t.codePointRightParen=41,t.codePointAsterisk=42,t.codePointPlusSign=43,t.codePointComma=44,t.codePointMinusSign=45,t.codePointFullStop=46,t.codePointSlash=47,t.codePointDigitZero=48,t.codePointDigitOne=49,t.codePointDigitTwo=50,t.codePointDigitThree=51,t.codePointDigitFour=52,t.codePointDigitFive=53,t.codePointDigitSix=54,t.codePointDigitSeven=55,t.codePointDigitEight=56,t.codePointDigitNine=57,t.codePointColon=58,t.codePointSemicolon=59,t.codePointLessThanSign=60,t.codePointEqualsSign=61,t.codePointGreaterThanSign=62,t.codePointQuestionMark=63,t.codePointAtSign=64,t.codePointLeftSquareBracket=91,t.codePointBackslash=92,t.codePointRightSquareBracket=93,t.codePointCircumflexAccent=94,t.codePointUnderscore=95,t.codePointBacktick=96,t.codePointLeftCurlyBracket=123,t.codePointPipe=124,t.codePointRightCurlyBracket=125,t.codePointTilde=126,t.codePointCapitalA=65,t.codePointCapitalB=66,t.codePointCapitalC=67,t.codePointCapitalD=68,t.codePointCapitalE=69,t.codePointCapitalF=70,t.codePointCapitalG=71,t.codePointCapitalH=72,t.codePointCapitalI=73,t.codePointCapitalJ=74,t.codePointCapitalK=75,t.codePointCapitalL=76,t.codePointCapitalM=77,t.codePointCapitalN=78,t.codePointCapitalO=79,t.codePointCapitalP=80,t.codePointCapitalQ=81,t.codePointCapitalR=82,t.codePointCapitalS=83,t.codePointCapitalT=84,t.codePointCapitalU=85,t.codePointCapitalV=86,t.codePointCapitalW=87,t.codePointCapitalX=88,t.codePointCapitalY=89,t.codePointCapitalZ=90,t.codePointSmallA=97,t.codePointSmallB=98,t.codePointSmallC=99,t.codePointSmallD=100,t.codePointSmallE=101,t.codePointSmallF=102,t.codePointSmallG=103,t.codePointSmallH=104,t.codePointSmallI=105,t.codePointSmallJ=106,t.codePointSmallK=107,t.codePointSmallL=108,t.codePointSmallM=109,t.codePointSmallN=110,t.codePointSmallO=111,t.codePointSmallP=112,t.codePointSmallQ=113,t.codePointSmallR=114,t.codePointSmallS=115,t.codePointSmallT=116,t.codePointSmallU=117,t.codePointSmallV=118,t.codePointSmallW=119,t.codePointSmallX=120,t.codePointSmallY=121,t.codePointSmallZ=122,t.codePointThaiDigitZero=3664,t.codePointThaiDigitNine=3673,t.codePointFullwidthDigitZero=65296,t.codePointFullwidthDigitNine=65305,t.codePointFullwidthLatinCapitalA=65313,t.codePointFullwidthLatinCapitalZ=65338,t.codePointFullwidthLatinSmallA=65345,t.codePointFullwidthLatinSmallZ=65370,t.codePointEuroSign=8364,t.codePointInvertedExclamationMark=161,t.codePointInvertedQuestionMark=191},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initCalcThread=t.initCalcInThread=t.initCalc=t.getCalcAbsUrlOrThrow=t.getCalcAbsUrl=t.isCalcInit=t.maxRetriesForLoadingScript=t.initCalcCalled=void 0;var n=r(2),i=r(18),a=r(44),o=r(101),s=r(213),u=r(126),c=r(169),l=r(214),d=r(325);t.initCalcCalled=new l.ResolvablePromise,t.maxRetriesForLoadingScript=9;var f=/^(https)|(http)|(file):\/\//,p=!1,m=void 0;function h(){if(null==m)throw new Error("initCalc was not passed calcAbsUrl");return m}function v(e,r,n,l){if(p){o.ulsLogger.ULS.traceTag(595910878,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"calc.config.initCalc: Calc is already initialized")}else{if(o.ulsLogger.setLogger(e),(0,s.initStopwatch)(e),(0,u.initFeatureConfiguration)(r),null!=n&&!f.test(n)){var h="calc.config.initCalc: calcAbsUrl is not absolute: ".concat(n);o.ulsLogger.ULS.traceTag(595910879,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,h)}a.setConfig(null!=l?l:{importScriptsMaxRetries:t.maxRetriesForLoadingScript,onWorkerError:function(e){var t={error:(0,c.messageFromError)(e),innerError:e.info.error?(0,c.messageFromError)(e.info.error):void 0},r="calc.onWorkerError: ".concat(JSON.stringify(t));o.ulsLogger.ULS.traceTag(593335298,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,r)},onCreateWorker:function(e){var t="calc.onCreateWorker: ".concat(JSON.stringify(e));o.ulsLogger.ULS.traceTag(593335299,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,t)}}),m=n,p=!0;var v=" (".concat("production",")"),g="calc.config.initCalc: Calc version ".concat(d.excelOnlineCalcPackageVersion).concat(v," initialized");o.ulsLogger.ULS.traceTag(594642132,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,g),t.initCalcCalled.resolve(void 0)}}t.isCalcInit=function(){return p},t.getCalcAbsUrl=function(){return m},t.getCalcAbsUrlOrThrow=h,t.initCalc=function(e,t,r){v(e,t,r,void 0)},t.initCalcInThread=function(e,t,r,i){return n.__awaiter(this,void 0,void 0,(function(){var o;return n.__generator(this,(function(n){switch(n.label){case 0:return[4,a.Endpoint.createOutside(e)];case 1:return o=n.sent(),v((s=o.post,u=function(e){return"[".concat((new Date).toISOString(),"] ").concat(e)},{shipAssertTag:function(e,t,r,n){s.shipAssertTag(e,t,r,u(n))},assertTag:function(e,t,r,n){s.assertTag(e,t,r,u(n))},traceTag:function(e,t,r,n){s.traceTag(e,t,r,u(n))},debugTraceTag:function(e,t,r,n){s.debugTraceTag(e,t,r,u(n))},dnmTraceTag:function(e,t,r,n){s.dnmTraceTag(e,t,r,u(n))}}),(function(e){return!0===t[e]}),r,i),[2]}var s,u}))}))},t.initCalcThread=function(e){return n.__awaiter(this,void 0,void 0,(function(){var t,r,i,s,c;return n.__generator(this,(function(n){switch(n.label){case 0:t=h(),r=new MessageChannel,i={port:r.port1,options:{id:"WorkerThreadLogger"}},s={port:r.port2,options:{id:"WorkerThreadLogger"}},n.label=1;case 1:return n.trys.push([1,3,,4]),[4,Promise.all([a.Endpoint.createInside(i,(function(){return o.ulsLogger.noThrowLogger})),e.call.initCalcThreadInside.transfer([s.port],s,(0,u.getFeatures)(),t)])];case 2:return[2,n.sent()[0]];case 3:throw c=n.sent(),i.port.close(),c;case 4:return[2]}}))}))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.excelOnlineCalcPackageVersion=void 0,t.excelOnlineCalcPackageVersion="36.4.6"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mixin=void 0;var n=r(2),i=0;t.mixin=function(e,t,r){for(var a,o=(void 0===(a="___mixinField")&&(a=""),a+(i+=1).toString()),s={},u=function(e){s[e]=function(){for(var t,r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];var a=this[o];return(t=a[e]).call.apply(t,n.__spreadArray([a],r,!1))}},c=0,l=r;c<l.length;c++){u(l[c])}return function(e){function i(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];for(var a=e.apply(this,n)||this,u=t(a),c=0,l=r;c<l.length;c++){var d=l[c];Object.defineProperty(a,d,{value:s[d],enumerable:!1,configurable:!1})}return a[o]=u,a}return n.__extends(i,e),i}(e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetCharCodeBits=t.forEachClassInterval=t.CharCodeBits=t.codePointIterator=t.numCodeUnits=t.stringCodePointAt=t.countCodePoints=t.scanCodePointsBack=t.scanCodePoints=t.stringFromCodePoint=t.surrogatePairToCodePoint=t.isAnySurrogate=t.isLowSurrogate=t.isHighSurrogate=void 0;var n,i=r(74);function a(e){return 55296==(64512&e)}function o(e){return 56320==(64512&e)}function s(e){return 55296==(63488&e)}function u(e,t){if(a(e)&&o(t))return 65536+((1023&e)<<10|1023&t)}function c(e,t){var r=e.charCodeAt(t);if(!s(r))return r;if(t+1>=e.length)return 65533;var n=u(r,e.charCodeAt(t+1));return null!=n?n:65533}function l(e){return e>=65536?2:1}function d(e,t){if(1==(1&e.length))throw new Error("Invalid class length");for(var r=0;r<e.length;r+=2)for(var n=e[r],i=e[r+1],a=n;a<i;a+=1)t(a,n,i)}t.isHighSurrogate=a,t.isLowSurrogate=o,t.isAnySurrogate=s,t.surrogatePairToCodePoint=u,t.stringFromCodePoint=function(e){if(e<=65535)return String.fromCharCode(e);var t=e-65536;return String.fromCharCode(t>>10|55296,1023&t|56320)},t.scanCodePoints=function(e,t,r){for(var n=t,i=0;i<r;i+=1){if(n>=e.length)return;a(e.charCodeAt(n))&&n+1<e.length&&o(e.charCodeAt(n+1))?n+=2:n+=1}return n},t.scanCodePointsBack=function(e,t,r){for(var n=t,i=0;i<r;i+=1){if(n-1<0)return;o(e.charCodeAt(n-1))&&n-2>=0&&a(e.charCodeAt(n-2))?n-=2:n-=1}return n},t.countCodePoints=function(e,t,r){for(var n=0,i=t;i<r;n+=1){a(e.charCodeAt(i))&&i+1<r&&o(e.charCodeAt(i+1))?i+=2:i+=1}return n},t.stringCodePointAt=c,t.numCodeUnits=l,t.codePointIterator=function(e,t){void 0===t&&(t=0);for(var r=[],n=t;n<e.length;){var i=c(e,n);r.push(i),n+=l(i)}return r},function(e){e[e.Ordinal=15]="Ordinal",e[e.DigitClass=16]="DigitClass",e[e.IdentStartClass=32]="IdentStartClass",e[e.IdentContinueClass=64]="IdentContinueClass"}(n=t.CharCodeBits||(t.CharCodeBits={})),t.forEachClassInterval=d,t.makeGetCharCodeBits=function(e,t,r){var a;function o(e){a[e]|=n.IdentStartClass}function s(e){a[e]|=n.IdentContinueClass}function u(e,t){a[e]|=n.DigitClass,a[e]|=e-t}return function(n){if(void 0===a){var c=(0,i.fastMax)(e[e.length-1],(0,i.fastMax)(t[t.length-1],r[r.length-1]));a=new Uint8Array(c),d(e,o),d(t,s),d(r,u);for(var l=4969;l<4978;l+=1)u(l,4968)}var f=a[n];return void 0!==f?f:0}}},function(e,t,r){"use strict";function n(){return function(e){return function(e){for(var t=function(e){this.obj=e},r=function(e){t.prototype[e]=function(){for(var t,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var i=(t=this.obj)[e].apply(t,r);return Promise.resolve(i)}},n=0,i=e;n<i.length;n++){r(i[n])}return t}(e)}}Object.defineProperty(t,"__esModule",{value:!0}),t.wrapIntoAsync=t.wrapIntoAsyncClass=void 0,t.wrapIntoAsyncClass=n,t.wrapIntoAsync=function(e,t){return new(n()(t))(e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createArrayLogger=void 0;var n=r(2);t.createArrayLogger=function(e,t,r){void 0===e&&(e=!1),void 0===t&&(t=function(){return!0});var i=new Set,a=new Set;return{log:[],addTriggerListener:function(e){i.add(e)},waitForMessage:function(e,t){var r=this;return new Promise((function(n){var i=setTimeout((function(){console.warn("ArrayLogger.waitForMessage: timed out waiting for message; timeout = ".concat(t)),n(!1)}),t);r.addTriggerListener((function(t){var r=e(t);return r&&(clearTimeout(i),n(!0)),r}))}))},waitForReceivedButDelayedMessages:function(){var e=[];return a.forEach((function(t){return e.push(t)})),Promise.all(e).then((function(){}))},addLogMessage:function(o){var s=this;if(t(o)){var u=new Promise((function(t){var a;a=function(){s.log.push(o),e&&console.log.apply(console,n.__spreadArray([(new Date).toISOString()],o,!1)),i.forEach((function(e){e(o)&&i.delete(e)})),t()},void 0===r?a():setTimeout((function(){return a()}),r)})).then((function(){a.delete(u)}));a.add(u)}},shipAssertTag:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.addLogMessage(["shipAssertTag",e]);var r=e[2],n=e[3];if(!r)throw new TypeError("shipAssertTag: ".concat(n))},assertTag:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.addLogMessage(["assertTag",e]);var r=e[2],n=e[3];if(!r)throw new TypeError("assertTag: ".concat(n))},traceTag:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.addLogMessage(["traceTag",e])},dnmTraceTag:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.addLogMessage(["dnmTraceTag",e])},debugTraceTag:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.addLogMessage(["debugTraceTag",e])}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.featureEnabledDummyCallback=t.AssertLogger=t.ConsoleLogger=void 0;var n=r(126),i=function(){function e(){}return e.prototype.shipAssertTag=function(e,t,r,n){if(console.assert(r,"shipAssertTag2 ".concat(e," ").concat(t," ").concat(n)),!r)throw new Error("shipAssertTag2 ".concat(e," ").concat(t," ").concat(n))},e.prototype.assertTag=function(e,t,r,n){if(console.assert(r,"assertTag2 ".concat(e," ").concat(t," ").concat(n)),!r)throw new Error("assertTag2 ".concat(e," ").concat(t," ").concat(n))},e.prototype.traceTag=function(e,t,r,n){console.log("traceTag2",e,n,t,r)},e.prototype.dnmTraceTag=function(e,t,r,n){console.log("dnmTraceTag2",e,n,t,r)},e.prototype.debugTraceTag=function(e,t,r,n){console.log("debugTraceTag2",e,n,t,r)},e}();t.ConsoleLogger=i;var a=function(){function e(){this.traceTag=function(){},this.debugTraceTag=function(){},this.dnmTraceTag=function(){}}return e.prototype.shipAssertTag=function(e,t,r,n){if(!r)throw new Error("shipAssertTag2 ".concat(e," ").concat(t," ").concat(n))},e.prototype.assertTag=function(e,t,r,n){if(!r)throw new Error("assertTag2 ".concat(e," ").concat(t," ").concat(n))},e}();t.AssertLogger=a,t.featureEnabledDummyCallback=function(e){switch(e){case n.FeatureName.FeatureCheckingEnabled:return!0;case n.FeatureName.CalcRecordFunctions:case n.FeatureName.CalcNestedRecordFunction:case n.FeatureName.CalcLetRecFunction:case n.FeatureName.CalcLambdaFunction:case n.FeatureName.CalcLambdaBasicFunctions:case n.FeatureName.CalcLambdaHelperFunctions:case n.FeatureName.CalcLambdaOptionalParameters:case n.FeatureName.CalcLambdaDefaultParameters:case n.FeatureName.CalcLambdaCellValues:case n.FeatureName.CalcLambdaArrayLifting:return!0;default:return e.startsWith("OfficeVSO:")}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Pledge=void 0;var n=r(215),i=r(174),a=function(){function e(t,r,i){this.transition=t,this.onFulfilled=r,this.onRejected=i,this.runStatus=!(t instanceof e||t.kind===n.TransitionKind.CallMachine)&&t}return e.prototype.setState=function(e,t,r){return this.onFulfilled=t,this.onRejected=r,this.transition=e,e},e.prototype.next=function(){return this.transition instanceof e?this.transition=(0,n.callMachineTransition)(this.transition,this):this.transition},e.prototype.receiveResult=function(t){var r;try{if((0,i.isSuccess)(t)){if(!this.onFulfilled)return this.setState(t,void 0,void 0);r=this.onFulfilled(t.value)}else{if(!this.onRejected)return this.setState(t,void 0,void 0);r=this.onRejected(t.reason)}}catch(e){return this.setState((0,i.failure)((0,i.javaScriptError)(e)),void 0,void 0)}return r instanceof e?(this.setState(r.transition,r.onFulfilled,r.onRejected),r.setState(this,void 0,void 0),this.next()):this.setState((0,i.success)(r),void 0,void 0)},e.prototype.bind=function(t){return new e(this,t,void 0)},e.prototype.catch=function(t){return new e(this,void 0,t)},e.prototype.finally=function(t){return new e(this,(function(e){return t(),e}),(function(r){return t(),e.reject(r)}))},e.all=function(t){return e.fromMachine(new n.AllMachine(t.map(e.resolve)))},e.prototype.settle=function(){return new n.MachineRuntime(this).runToResult()},e.settleOrThrow=function(e){var t=e.settle();if((0,i.isSuccess)(t))return t.value;throw t.reason.error},e.resolve=function(t){return t instanceof e?t:new e((0,i.success)(t),void 0,void 0)},e.reject=function(t){return new e((0,i.failure)(t),void 0,void 0)},e.undefinedPledge=e.resolve(void 0),e.fromMachine=function(t){if(t instanceof e)return t;var r=new e(e.undefinedPledge,void 0,void 0);return r.transition=(0,n.callMachineTransition)(t,r),r},e.try=function(t){return e.undefinedPledge.bind(t)},e.RepeatMachine=function(){function t(e,t){this.onLoop=e,this.accum=t,this.runStatus=!1}return t.prototype.next=function(){var t=this.onLoop(this.accum);return t instanceof e?(0,n.callMachineTransition)(t,this):this.receiveSuccess(t)},t.prototype.receiveResult=function(e){return(0,i.isSuccess)(e)?this.receiveSuccess(e.value):e},t.prototype.receiveSuccess=function(e){return void 0===e?(0,i.success)(this.accum):(this.accum=e,n.nextTransition)},t}(),e.repeat=function(t,r){return e.resolve(r).bind((function(r){return e.fromMachine(new e.RepeatMachine(t,r))}))},e}();t.Pledge=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.throwAfterSteps=t.pauseAfterSteps=void 0,t.pauseAfterSteps=function(e){var t=Math.max(1,Math.floor(e)),r=0;return function(){return(r+=1)>=t}},t.throwAfterSteps=function(e){var t=Math.max(1,Math.floor(e)),r=0;return function(){if((r+=1)<t)return!1;throw t}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RevocableSingleton=void 0;var n=function(){function e(e,t){var r=this;this.target=e,this.isRevoked=!1;var n=function(e){if(r.isRevoked)throw new TypeError("".concat(String(e),": ").concat(t))};this.proxy="undefined"==typeof Proxy?e:new Proxy(e,{get:function(e,t,r){return n(t),Reflect.get(e,t,r)},set:function(e,t,r,i){return n(t),Reflect.set(e,t,r,i)}})}return e.prototype.revoke=function(){this.isRevoked=!0},e}(),i=function(){function e(e){this.message=e}return e.prototype.getInstance=function(){var e;return null===(e=this.instance)||void 0===e?void 0:e.proxy},e.prototype.setInstance=function(e){var t;return null===(t=this.instance)||void 0===t||t.revoke(),void 0===e?this.instance=void 0:(this.instance=new n(e,this.message),this.instance.proxy)},e.prototype.revokeInstance=function(){if(this.instance)return this.instance.revoke(),this.instance=new n(this.instance.target,this.message),this.instance.proxy},e}();t.RevocableSingleton=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.adjustFormulaOrigin=void 0;var n=r(2),i=r(75),a=r(69),o=r(86),s=r(141),u=r(176),c=r(110),l=r(70),d=r(143),f=r(178),p=r(129);function m(e,t,r,n){if(r.kind===a.PosKind.Abs)return r;var i=(0,u.wrapPosition)(e,r.index,n)-t;return i===r.index?r:(0,a.pos)(a.PosKind.Rel,i)}function h(e,t,r,n){var o=m(t.row,r.row,n.row,i.sheetRows),u=m(t.col,r.col,n.col,i.sheetCols),c=(0,s.canonicaliseBrackets)(e,o)||(0,s.canonicaliseBrackets)(e,u);return(0,a.cellRefSingle)(o,u,c,n.label)}function v(e,t,r,n){switch(n.kind){case a.CellRefKind.Error:case a.CellRefKind.Bad:return n;case a.CellRefKind.Single:return h(e,t,r,n);case a.CellRefKind.Range:var o=h(e,t,r,n.ref1),u=h(e,t,r,n.ref2);return o===n.ref1&&u===n.ref2?n:(0,a.cellRefRange)(o,u,n.label);case a.CellRefKind.Row:var c=m(t.row,r.row,n.row1,i.sheetRows),l=m(t.row,r.row,n.row2,i.sheetRows),d=(0,s.canonicaliseBrackets)(e,c)||(0,s.canonicaliseBrackets)(e,l);return(0,a.cellRefRow)(c,l,d,n.label);case a.CellRefKind.Col:var f=m(t.col,r.col,n.col1,i.sheetCols),p=m(t.col,r.col,n.col2,i.sheetCols);d=(0,s.canonicaliseBrackets)(e,f)||(0,s.canonicaliseBrackets)(e,p);return(0,a.cellRefCol)(f,p,d,n.label)}}var g=(0,o.createFailureErrorClass)("TransformRefsError"),b=function(e){function t(t,r,n,i){var a=e.call(this)||this;return a.fn=t,a.locals=n,a.annotations=i,a.resolver=(0,f.createResolver)(r),a}return n.__extends(t,e),t.prototype.nameNode=function(e,t,r){var n=(0,a.nameNode)(e,t,r),i=this.resolver.resolveDottedName(this.locals,n,this.annotations).resolved;if(i.kind===d.ResolvedKind.ResolvedCellRef){var o=(0,a.flattenNameParts)(e);(0,l.assertTrue)("calc.lang.adjustFormulaOrigin",o.kind===a.NamePartKind.CellRefNamePart);var s=o.parts,u=s[0],f=s[1],p=s.slice(2),m=function(e,t){var r=t.rhs,n=t.canDenoteNamedObject,i=t.label,o=t.qualifiedLabel;return(0,a.fieldRefNamePart)(e,r,n,i,o)};return(0,a.nameNode)(p.reduce(m,m((0,a.cellRefNamePart)(this.fn(u.ref),u.asWhole,u.label,u.qualifiedLabel),f)),t,r)}if(i.resolution.kind!==c.ResultKind.Success&&i.resolution.reason.kind!==d.ResolveReasonKind.NoOriginSheet&&i.resolution.reason.kind!==d.ResolveReasonKind.InvalidQualifier)throw new g(i.resolution.reason);return n},t.prototype.cellRefNode=function(e,t,r){return(0,a.cellRefNode)(this.fn(e),t,r)},t}(p.IdentityVisitor);t.adjustFormulaOrigin=function(e,t,r,i){var a=t.originGridCell.value;if((0,o.isGridCellEqual)(a,r))return(0,c.success)(i);try{var s=(0,p.reduceBottomUp)(new b(v.bind(void 0,e.config.refStyle,a,r),e,t,i.annotations),i);return(0,c.success)(n.__assign(n.__assign({},i),{node:s}))}catch(e){if(e instanceof g)return(0,c.failure)(e.reason);throw e}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ivlCompare=t.ivlExcept=t.ivlMeetsOrTouches=t.ivlMeets=t.ivlDistance=t.ivlMeet=t.ivlJoin=void 0;var n=r(7);t.ivlJoin=n.interval.ivlJoin,t.ivlMeet=n.interval.ivlMeet,t.ivlDistance=n.interval.ivlDistance,t.ivlMeets=n.interval.ivlMeets,t.ivlMeetsOrTouches=n.interval.ivlMeetsOrTouches,t.ivlExcept=n.interval.ivlExcept,t.ivlCompare=n.interval.ivlCompare},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.buildAnnotations=void 0;var n=r(2),i=r(70),a=r(337),o=r(218),s=r(175),u=r(69),c=r(86),l=r(129),d=function(e){function t(t,r,n){var i=e.call(this,l.voidVisitor)||this;return i.localeInfo=t,i.annotations=r,i.names=n,i}return n.__extends(t,e),t.prototype.appNode=function(t,r,n,i){var a=this;return o.Pledge.try((function(){return t.kind===u.NodeKind.Name&&(a.annotations[t.label]=u.appHeadNameAnnotation),e.prototype.appNode.call(a,t,r,n,i)}))},t.prototype.letNode=function(e,t,r,n){var a=this,u=e.id===s.WorksheetFuncId.LETREC||e.id!==s.WorksheetFuncId.LET&&(0,i.assertFalse)("calc.lang.buildAnnotations"),c=this.bindNames(t),d=c[t.length];return this.lazyVisitAppHeadNode(e).bind((function(e){return u?o.Pledge.all(t.map((function(e){var t=e.binder;return o.Pledge.try((function(){return(0,l.visitFormulaNode)(d,t.arg)}))}))):o.Pledge.all(t.map((function(e,t){var r=e.binder,n=c[t];return o.Pledge.try((function(){return(0,l.visitFormulaNode)(n,r.arg)}))})))})).bind((function(e){return void 0===r?void 0:(0,l.visitFormulaNode)(d,r.arg)})).bind((function(e){return o.Pledge.all(n.map((function(e){return o.Pledge.try((function(){return(0,l.visitFormulaNode)(a,e.arg)}))})))})).bind((function(e){}))},t.prototype.lambdaNode=function(e,t,r,n){var i=this,a=this.bindNames(t),s=a[t.length];return this.lazyVisitAppHeadNode(e).bind((function(e){return o.Pledge.all(t.map((function(e,t){var r=e.name;if(void 0===r.arg.def)return o.Pledge.resolve(void 0);var n=a[t],i=r.arg.def;return o.Pledge.try((function(){return(0,l.visitFormulaNode)(n,i.rhs)}))})))})).bind((function(e){return void 0===r?void 0:(0,l.visitFormulaNode)(s,r.arg)})).bind((function(e){return o.Pledge.all(n.map((function(e){return o.Pledge.try((function(){return(0,l.visitFormulaNode)(i,e.arg)}))})))})).bind((function(e){}))},t.prototype.bindNames=function(e){var r=this,n=[this];return e.reduce((function(e,i){var a=i.name;if(void 0===a.arg.whole)return n.push(new t(r.localeInfo,r.annotations,e)),e;var o=(0,c.getBoundName)(r.localeInfo,a.arg.whole),s=e.setValue(o,a.arg);return n.push(new t(r.localeInfo,r.annotations,s)),r.annotations[a.arg.label]=(0,u.localNameDeclAnnotation)(o,a.arg.whole),s}),this.names),n},t.prototype.nameNode=function(t,r,n){var i=this;return o.Pledge.try((function(){if(void 0===r){var a=(0,u.headNamePart)(t),o=i.names.getEntry((0,c.getBoundName)(i.localeInfo,a.asWhole));if(void 0!==o)i.annotations[a.label]=(0,u.localNameUseAnnotation)(o.key,o.value.whole,o.value.label),i.annotations[o.value.label].uses.push({label:a.label})}return e.prototype.nameNode.call(i,t,r,n)}))},t}(l.PledgeReducer);t.buildAnnotations=function(e,t){var r=[];return(0,l.reduceTopDown_Pledge)(new d(e,r,a.RedBlackMapTree.create(e.stringCompareCI)),t),r[t.label]=u.formulaRootAnnotation,r}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RedBlackMapTree=void 0;var n=r(7);t.RedBlackMapTree=n.rbMapTree.RedBlackMapTree},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.enumerateKeysInOrder=t.enumerateInOrder=t.RootPointer=t.ArrayMapTree=t.floorToPowerOf2=void 0;var n=r(7);t.floorToPowerOf2=n.arrayMapTree.floorToPowerOf2,t.ArrayMapTree=n.arrayMapTree.ArrayMapTree,t.RootPointer=n.arrayMapTree.RootPointer,t.enumerateInOrder=n.arrayMapTree.enumerateInOrder,t.enumerateKeysInOrder=n.arrayMapTree.enumerateKeysInOrder},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Math=void 0;const n=function(e){if(e.imul&&e.fround&&e.clz32)return e;const t=new Float32Array(1);return Object.create(e,{imul:{value:function(e,t){var r=(4194303&e)*(t|=0);return 4290772992
/*!== 0*/&e&&(r+=(4290772992&e)*t|0),0|r}},fround:{value:function(e){return t[0]=e,t[0]}},clz32:{value:function(t){var r=t>>>0;return 0===r?32:31-(e.log(r)/e.LN2|0)|0}}})}(Math);t.Math=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"Base_LocaleDecimalSeparator",{enumerable:!0,get:function(){return n.Base_LocaleDecimalSeparator}}),Object.defineProperty(t,"Base_LocaleGetOrdinal",{enumerable:!0,get:function(){return n.Base_LocaleGetOrdinal}}),Object.defineProperty(t,"Base_LocaleIsNumeral",{enumerable:!0,get:function(){return n.Base_LocaleIsNumeral}}),t.Math_tan=t.Math_sqrt=t.Math_sin=t.Math_log10=t.Math_log=t.Math_exp=t.Math_cos=t.Math_atan=void 0;var n=r(179);const i=Math.sqrt;t.Math_sqrt=i;const a=Math.log10||function(e){return Math.log(e)*Math.LOG10E};t.Math_log10=a;const o=Math.log;t.Math_log=o;const s=Math.exp;t.Math_exp=s;const u=Math.sin;t.Math_sin=u;const c=Math.cos;t.Math_cos=c;const l=Math.tan;t.Math_tan=l;const d=Math.atan;t.Math_atan=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.proc_exit=function(e){throw new Error("unexpected process termination: "+e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.utcToLocal=t.toTime=t.TimeDivision=t.toDays=t.toNumWithDuration=t.toNum=t.fromNum=t.dtr=t.Rounding=t.daysPerMonth=void 0;var n=r(144),i=r(223);function a(e,t,r,n,i,a,o,s,u){return{yr:e,mon:t,dom:r,hour:n,min:i,sec:a,wdy:o,fracSec:s,rounding:u}}function o(e){return a((0,n.Dtr_Yr)(e),(0,n.Dtr_Mon)(e),(0,n.Dtr_DOM)(e),(0,n.Dtr_Hour)(e),(0,n.Dtr_Min)(e),(0,n.Dtr_Sec)(e),(0,n.Dtr_Wdy)(e),(0,n.Dtr_FracSec)(e),(0,n.Dtr_Rounding)(e))}function s(e,t){(0,n.Dtr_Write)(t.yr,t.mon,t.dom,t.hour,t.min,t.sec,t.wdy,t.fracSec,t.rounding,e)}t.daysPerMonth=function(e,t,r){return(0,n.Dtr_DaysPerMonth)(e,t,r?1:0)},function(e){e[e.RoundSec=0]="RoundSec",e[e.Round10ths=1]="Round10ths",e[e.Round100ths=2]="Round100ths",e[e.Round1000ths=3]="Round1000ths"}(t.Rounding||(t.Rounding={})),t.dtr=a,t.fromNum=function(e,t,r,i){var a=t;return 0===(0,n.Dtr_FromNum)(e,a,0,r?1:0,i?1:0)&&o(0)},t.toNum=function(e,t,r){s(0,e);var a=(0,n.Dtr_ToNum)(0,t?1:0,r?1:0),o=(0,n.Mathpack_TakeMathError)();return o===i.MathErrorNum.None?a:(0,i.mathError)(o)},t.toNumWithDuration=function(e,t,r,a,o){s(0,e);var u=a,c=(0,n.Dtr_ToNumWithDuration)(0,t?1:0,r?1:0,u,o),l=(0,n.Mathpack_TakeMathError)();return l===i.MathErrorNum.None?c:(0,i.mathError)(l)},t.toDays=function(e,t,r){return s(0,e),0===(0,n.Dtr_ToDays)(0,t?1:0,r?1:0)&&(0,n.Dtr_Days)()},function(e){e[e.Hour=0]="Hour",e[e.Minute=1]="Minute",e[e.Second=2]="Second"}(t.TimeDivision||(t.TimeDivision={})),t.toTime=function(e,t,r){var a=t,o=r,s=(0,n.Dtr_ToTime)(e,a,o);return(0,n.Mathpack_TakeMathError)()===i.MathErrorNum.None&&s},t.utcToLocal=function(e,t,r,i){return s(0,e),null!=t.standardDate&&s(1,t.standardDate),null!=t.daylightDate&&s(2,t.daylightDate),0!==(0,n.Dtr_UtcToLocal)(0,t.bias,null!=t.standardDate?1:-1,t.standardBias,null!=t.daylightDate?2:-1,t.daylightBias,r?1:0,i?1:0)&&o(0)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.relabelFormula=void 0;var n=r(2),i=r(69),a=r(129);t.relabelFormula=function(e,t){var r;void 0===t&&(r=1,t=function(){return r++});var o=e.spans,s=e.annotations,u=e.depthUpperBound,c=[],l=[],d=[],f=[];function p(e){var r=t();return c[r]=o[e],l[r]=s[e],d[e]=r,f[r]=e,r}function m(e){if(e.kind===i.CellRefKind.Range){var t=e;return(0,i.cellRefRange)(m(t.ref1),m(t.ref2),p(e.label))}return n.__assign(n.__assign({},e),{label:p(e.label)})}function h(e){return null!=e?(0,i.documentQualifier)(e.document,e.path,e.isQuoted,p(e.label)):void 0}function v(e){return(0,i.fieldRef)((t=e.field).kind===i.NodeKind.Name?b(t.parts,t.qualifier,t.label):(0,i.badNode)(t.type,t.contents,p(t.label)),e.isBracketed,e.isClosed,p(e.label));var t}function g(e){switch(null==e?void 0:e.kind){case void 0:return;case i.StructRefKind.SpecialRef:return(0,i.specialRef)(e.id,e.isBracketed,e.isClosed,p(e.label));case i.StructRefKind.ColumnRef:return(0,i.columnRef)(e.name,e.isBracketed,e.isClosed,p(e.label));case i.StructRefKind.RangeOpRef:return(0,i.rangeOpRef)(g(e.lhs),g(e.rhs),p(e.label));case i.StructRefKind.CommaOpRef:return(0,i.commaOpRef)(e.refs.map(g),p(e.label));case i.StructRefKind.ThisRowOpRef:return(0,i.thisRowOpRef)(void 0!==e.ref?g(e.ref):void 0,p(e.label));case i.StructRefKind.MissingRef:return(0,i.missingRef)(p(e.label));case i.StructRefKind.BadRef:return(0,i.badRef)(e.contents,e.isBracketed,e.isClosed,p(e.label))}}function b(e,t,r){return(0,i.nameNode)(function(e){var t=(0,i.flattenNameParts)(e),r=function(e,t){var r=t.rhs,n=t.canDenoteNamedObject,a=t.label,o=t.qualifiedLabel;return(0,i.fieldRefNamePart)(e,void 0===r?r:v(r),n,p(a),p(o))};if(t.kind===i.NamePartKind.IdentNamePart){var n=t.parts,a=n[0],o=n.slice(1),s=(0,i.identNamePart)(a.asWhole,a.canDenoteNamedObject,p(a.label),p(a.qualifiedLabel));return o.reduce(r,s)}var u=t.parts,c=u[0],l=u[1],d=u.slice(2),f=(0,i.cellRefNamePart)(m(c.ref),c.asWhole,p(c.label),p(c.qualifiedLabel));return d.reduce(r,r(f,l))}(e),function(e){if(null!=e)return e.kind===i.QualifierKind.Sheet||e.kind===i.QualifierKind.SheetRange?n.__assign(n.__assign({},e),{document:h(e.document),label:p(e.label)}):n.__assign(n.__assign({},e),{label:p(e.label)})}(t),p(r))}function S(e){return b(e.parts,e.qualifier,e.label)}function y(e){var t=(0,i.paramName)(function(e){switch(e.kind){case i.NodeKind.Name:return S(e);case i.NodeKind.Bad:return(0,i.badNode)(e.type,e.contents,p(e.label))}}(e.name.name),e.name.isBracketed,e.name.isClosed,p(e.name.label)),r=void 0===e.def?void 0:(0,i.paramDefault)(e.def.rhs,p(e.def.label));return(0,i.paramNode)(t,r,p(e.label))}for(var O={literalNode:function(e,t,r){return(0,i.literalNode)(e,t,p(r))},arrayNode:function(e,t,r){return(0,i.arrayNode)(e,t,p(r))},appNode:function(e,t,r,n){return(0,i.appNode)(e,t,r,p(n))},letNode:function(e,t,r,n,a,o){return(0,i.letNode)(e,t.map((function(e){var t=e.name,r=e.binder;return(0,i.letVar)((0,i.indexedArg)(S(t.arg),t.index),r)})),r,n,a,p(o))},lambdaNode:function(e,t,r,n,a,o){return(0,i.lambdaNode)(e,t.map((function(e){var t=e.name;return(0,i.lambdaParam)((0,i.indexedArg)(y(t.arg),t.index))})),r,n,a,p(o))},parenNode:function(e,t,r){return(0,i.parenNode)(e,t,p(r))},nameNode:function(e,t,r){return b(e,t,r)},cellRefNode:function(e,t,r){return(0,i.cellRefNode)(m(e),function(e){if(null!=e)return e.kind===i.QualifierKind.Sheet||e.kind===i.QualifierKind.SheetRange?n.__assign(n.__assign({},e),{document:h(e.document),label:p(e.label)}):n.__assign(n.__assign({},e),{label:p(e.label)})}(t),p(r))},fieldRefNode:function(e,t,r,n){return(0,i.fieldRefNode)(e,v(t),r,p(n))},structRefNode:function(e,t,r){return(0,i.structRefNode)(void 0===e?void 0:S(e),(n=t,(0,i.structRef)(g(n.innerRef),n.isClosed,p(n.label))),p(r));var n},badSequenceNode:function(e,t,r){return(0,i.badNode)(e,t,p(r))},badStringNode:function(e,t,r){return(0,i.badNode)(e,t,p(r))},operatorNode:function(e,t){return(0,i.operatorNode)(e,p(t))},wsfNode:function(e,t,r){return(0,i.wsfNode)(e,t,p(r))}},C=(0,i.formula)((0,a.reduceBottomUp)(O,e),c,l,u),P=0,N=Object.keys(l);P<N.length;P++){var R=N[P],k=Number(R),T=l[k];switch(null==T?void 0:T.kind){case i.AnnotationKind.LocalNameUse:l[k]=(0,i.localNameUseAnnotation)(T.name,T.whole,d[T.label]);break;case i.AnnotationKind.LocalNameDecl:l[k]=(0,i.localNameDeclAnnotation)(T.name,T.whole,T.uses.map((function(e){var t=e.label;return{label:d[t]}})))}}return{formula:C,oldToNewLabel:d,newToOldLabel:f}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ieeeMathpack=void 0;var n=r(109),i=r(58),a=r(225),o=r(142),s=r(111),u=r(70),c=r(96),l=r(112);var d=o.codePointDigitZero;function f(e){return{kind:c.OperKind.Number,_valueIEEE:e}}var p=f(0),m=f(1),h=f(Math.PI);function v(e){return isFinite(e)?f(e):n.numErrorOper}function g(e,t){var r=e._valueIEEE,n=t._valueIEEE;return r<n?-1:r>n?1:0}function b(e,t){var r=void 0===t?e.toExponential():e.toExponential(t),n=r.indexOf("e"),i=!(0,s.stringStartsWith)(r,"-"),a=r.substring(i?0:1,n).replace(".",""),o=parseInt(r.substring(n+1),10)+1;return function(e){for(var t=0;t<e.length;t+=1)if(e.charCodeAt(t)!==d)return!1;return!0}(a)?{sign:i,mantissa:"",exponent:0}:{sign:i,mantissa:a,exponent:o}}var S=["0","1","2","3","4","5","6","7","8","9"];function y(e){var t=e._valueIEEE;return f(t<0?Math.ceil(t):Math.floor(t))}function O(e){var t=e._valueIEEE;return f(Math.floor(t))}function C(e){return e.substring(0,1)+"."+e.substring(1)}t.ieeeMathpack={zero:p,one:m,pi:h,add:function(e,t){return v(e._valueIEEE+t._valueIEEE)},sub:function(e,t){return v(e._valueIEEE-t._valueIEEE)},mul:function(e,t){return v(e._valueIEEE*t._valueIEEE)},div:function(e,t){var r=e._valueIEEE,i=t._valueIEEE;return 0===i?n.div0ErrorOper:v(r/i)},power:function(e,t){var r=e._valueIEEE,i=t._valueIEEE,a=Math.pow(r,i);return isFinite(a)?f(a):isNaN(a)?n.div0ErrorOper:n.numErrorOper},percent:function(e){return f(e._valueIEEE/100)},neg:function(e){return f(-e._valueIEEE)},compare:g,formatGeneral:function(e,t,r){var n=e.decimalSeparator,i=t._valueIEEE,a=String(i).replace("e","E");return"."!==n&&(a=a.replace(".",n)),a},formatFixed:function(e,t,r){var n,i=e._valueIEEE,o=b(i),s=o.sign,u=o.mantissa,c=o.exponent,l=r+(c+t);if(0===l){var d=parseFloat("5e"+String(c-1));if(Math.abs(i)>=d)return(0,a.numberComponents)(s,"1",c+t+1)}if(l<1)return(0,a.numberComponents)(!0,"",0);l<=21&&(s=(n=b(i,l-1)).sign,u=n.mantissa,l=r+((c=n.exponent)+t));var f=u.substring(0,l);return(0,a.numberComponents)(s,f,0===f.length?0:c+t)},formatScientific:function(e,t,r){var n,i=e._valueIEEE,o=b(i),s=o.sign,c=o.mantissa,l=o.exponent,d=(0,a.formatScientificLeft)(l,t),f=d+r;if((0,u.assertTrue)("calc.lang.ieeeFormatScientific",f>0),0===f){var p=parseFloat("5e"+String(l-1));if(Math.abs(i)>=p)return(0,a.numberComponents)(s,"",l+1)}if(f<1)return(0,a.numberComponents)(!0,"",0);f<=21&&(s=(n=b(i,f-1)).sign,c=n.mantissa,l=n.exponent,f=(d=(0,a.formatScientificLeft)(l,t))+r);var m=c.substring(0,f);return(0,a.numberComponents)(s,m,0===m.length?0:l)},parse:function(e,t,r,n){return f(Number((t?"":"-")+"0."+function(e,t){for(var r=e.getOrdinal,n="",i=0,a=(0,l.codePointIterator)(t);i<a.length;i++){var o=a[i];n+=S[r(o)]}return n}(e,n)+"E"+String(r)))},trunc:y,ceil:function(e){var t=e._valueIEEE;return f(Math.ceil(t))},floor:O,abs:function(e){return f(Math.abs(e._valueIEEE))},cond:function(e){return g(e,p)},cond2:g,fromNumber:f,toNumber:function(e){return e._valueIEEE},sqrt:function(e){return v(Math.sqrt(e._valueIEEE))},exp:function(e){return v(Math.exp(e._valueIEEE))},ln:function(e){return v(Math.log(e._valueIEEE))},log:function(e){return v(Math.log(e._valueIEEE)/Math.LN10)},sin:function(e){return f(Math.sin(e._valueIEEE))},cos:function(e){return f(Math.cos(e._valueIEEE))},tan:function(e){return f(Math.tan(e._valueIEEE))},asin:function(e){return v(Math.asin(e._valueIEEE))},acos:function(e){return v(Math.acos(e._valueIEEE))},atan:function(e){return v(Math.atan(e._valueIEEE))},atan2:function(e,t){return f(Math.atan2(t._valueIEEE,e._valueIEEE))},round:function(e,t){var r=e._valueIEEE;if(0===r)return p;var n=b(r).exponent,i=y(t)._valueIEEE+n;if(0===i){var a=parseFloat("5e"+String(n-1));if(Math.abs(r)>=a)return v((r<0?-1:1)*parseFloat("10e"+String(n-1)))}return i<1?p:i>21?e:v(parseFloat(r.toExponential(i-1)))},roundUp:function(e,t){var r=e._valueIEEE;if(0===r)return p;var n=b(r),i=n.sign,a=n.mantissa,o=n.exponent,s=y(t)._valueIEEE+o;return s<1?v(parseFloat((i?"":"-")+"10e"+String(o-1-s))):s>21?e:v(parseFloat((i?"":"-")+function(e,t){if(e.length<=t)return C(e);for(var r=e.substring(0,t),n=0,i=r.length-1;i>=0&&r.charCodeAt(i)-d==9;i-=1)n+=1;return n===r.length?"10":C(r.substring(0,r.length-n-1)+String.fromCharCode(r.charCodeAt(r.length-n-1)+1))}(a,s)+"e"+String(o-1)))},roundDown:function(e,t){var r=e._valueIEEE;if(0===r)return p;var n=b(r),i=n.sign,a=n.mantissa,o=n.exponent,s=y(t)._valueIEEE+o;if(s<1)return p;if(s>21)return e;var u=a.substring(0,s);return v(parseFloat((i?"":"-")+C(u)+"e"+String(o-1)))},tenTo:function(e){return(0,u.assertInteger)("calc.lang.ieeeTenTo",e),v(Math.pow(10,e))},checkAlmostCancellation:function(e,t){return t},fix:function(e){var t=e._valueIEEE,r=Math.abs(t);return r>=4294967296?4294967295:Math.floor(r)},lfix:function(e){var t=y(e)._valueIEEE;return t<-2147483648||t>2147483647?-2147483648:t},sfix:function(e){var t=O(e)._valueIEEE;return t<-2147483648?-2147483648:t>2147483647?2147483647:t},viewRound:i.identity}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createPrinter=t.anonymizeFormula=void 0;var n,i=r(2),a=r(69),o=r(109),s=r(128),u=r(70),c=r(86),l=r(75),d=r(219),f=r(220),p=r(141),m=r(111),h=r(143),v=r(178),g=r(110),b=r(129),S=r(96),y=r(346),O=r(226),C=r(112),P=/"/g,N=(0,l.sheetGridCell)((0,l.sheetIndex)((0,l.documentLoc)(void 0,"Book1"),0),(0,l.gridCell)(0,0));function R(e){if(!(0,g.isSuccess)(e)&&e.reason.kind!==h.ResolveReasonKind.NoOriginSheet&&e.reason.kind!==h.ResolveReasonKind.InvalidQualifier&&e.reason.kind!==h.ResolveReasonKind.InvalidCellRef&&e.reason.kind!==h.ResolveReasonKind.InvalidStructRef&&e.reason.kind!==h.ResolveReasonKind.EmptyIntersection)throw new I(e.reason)}function k(e){for(var t=[],r=[],n=0,i=e;n<i.length;n++){var a=i[n];a.length>0&&(0,C.numCodeUnits)((0,C.stringCodePointAt)(a,0))===a.length?t[(0,C.stringCodePointAt)(a,0)]=!0:r.push(a)}return function(e,n){var i=(0,C.stringCodePointAt)(e,n);if(!0===t[i])return!0;for(var a=0,o=r;a<o.length;a++){var s=o[a];if((0,m.stringStartsWith)(e,s,n))return!0}return!1}}function T(e,t){for(var r="",n=0;n<e.length;){t(e,n)&&(r+="'");var i=(0,C.stringCodePointAt)(e,n);r+=(0,C.stringFromCodePoint)(i),n+=(0,C.numCodeUnits)(i)}return r}!function(e){e[e.Original=0]="Original",e[e.Bracketed=1]="Bracketed",e[e.Unbracketed=2]="Unbracketed"}(n||(n={}));var E={literalNode:function(e,t,r){return r},arrayNode:function(e,t,r){return r},appNode:function(e,t,r,n){return n},letNode:function(e,t,r,n,i,a){return a},lambdaNode:function(e,t,r,n,i,a){return a},parenNode:function(e,t,r){return r},nameNode:function(e,t,r){return r},cellRefNode:function(e,t,r){return r},fieldRefNode:function(e,t,r,n){return n},structRefNode:function(e,t,r){return r},badSequenceNode:function(e,t,r){return r},badStringNode:function(e,t,r){return r},operatorNode:function(e,t){return t},wsfNode:function(e,t,r){return r}},_=i.__assign(i.__assign({},(0,b.constVisitor)(void 0)),{operatorNode:function(e){return e}}),F=function(){function e(e,t,r,n){var a,o,s,u,c=this;this.root=r,this.anonymize=n,this.anon=function(e){return c.anonymize?(0,f.anonymizeFormulaString)(e):e},this.locals=t,this.localeInfo=null!==(o=null===(a=t.config)||void 0===a?void 0:a.localeInfo)&&void 0!==o?o:e.config.localeInfo,this.mathpack=e.config.mathpack,this.refStyle=null!==(u=null===(s=t.config)||void 0===s?void 0:s.refStyle)&&void 0!==u?u:e.config.refStyle,this.resolver=(0,v.createResolver)(e),this.spans=r.spans,this.annotations=r.annotations;var l=["'",this.localeInfo.leftBracket,this.localeInfo.rightBracket,"#","@"],d=i.__spreadArray(i.__spreadArray([],l,!0),["\t","\n","\r"," ","!",'"',"$","%","&","(",")","*","+",this.localeInfo.listSeparator,"-",".","/",":",";","<","=",">","?","\\","^","_","`","{","}","~"],!1);this.isStructRefEscapable=k(l),this.isStructRefBracketedThisRef=k(d),this.isFieldRefEscapable=k(["'",this.localeInfo.leftBracket,this.localeInfo.rightBracket])}return e.prototype.print=function(){var e=new b.ZipVisitor({str:this,label:E,op:_});return"="+this.pre(this.root.node.label,"")+(0,b.reduceBottomUp)(e,this.root).str},e.prototype.pre=function(e,t){var r,n;return this.anonymize?t:null!==(n=null===(r=this.spans[e])||void 0===r?void 0:r.pre)&&void 0!==n?n:t},e.prototype.post=function(e,t){var r,n;return this.anonymize?t:null!==(n=null===(r=this.spans[e])||void 0===r?void 0:r.post)&&void 0!==n?n:t},e.prototype.printRef=function(e,t){var r="";switch(e.kind){case a.StructRefKind.SpecialRef:(t===n.Original&&e.isBracketed||t===n.Bracketed)&&(r+=this.localeInfo.leftBracket);var i=this.localeInfo.specialRefNames[e.id];if(null==i)throw new I((0,c.internal)("No locale data for specialRefName"));r+=i,(t===n.Original&&e.isBracketed&&e.isClosed||t===n.Bracketed)&&(r+=this.localeInfo.rightBracket);break;case a.StructRefKind.ColumnRef:var o=0===e.name.length||(0,m.stringStartsWith)(e.name," ")||(0,m.stringEndsWith)(e.name," ");(t===n.Original&&e.isBracketed||t===n.Bracketed||t===n.Unbracketed&&o)&&(r+=this.localeInfo.leftBracket);var s=T(e.name,this.isStructRefEscapable);r+=this.anon(s),(t===n.Original&&e.isBracketed&&e.isClosed||t===n.Bracketed||t===n.Unbracketed&&o)&&(r+=this.localeInfo.rightBracket);break;case a.StructRefKind.RangeOpRef:r+=this.printRef(e.lhs,t===n.Original?t:n.Bracketed)+":"+this.printRef(e.rhs,t===n.Original?t:n.Bracketed);break;case a.StructRefKind.MissingRef:break;case a.StructRefKind.BadRef:e.isBracketed&&(r+=this.localeInfo.leftBracket),r+=e.contents,e.isBracketed&&e.isClosed&&(r+=this.localeInfo.rightBracket)}return r},e.prototype.printThisRowOpRef=function(e){var t="@";return e&&(e.kind===a.StructRefKind.ColumnRef?t+=this.printRef(e,e.isClosed?function(e,t){for(var r=0;r<e.length;){if(t(e,r))return!0;r+=(0,C.numCodeUnits)((0,C.stringCodePointAt)(e,r))}return!1}(e.name,this.isStructRefBracketedThisRef)?n.Bracketed:n.Unbracketed:n.Original):t+=this.printRef(e,(0,c.isRangeOpClosed)(e)&&(0,c.isRangeOpNoMissing)(e)?n.Bracketed:n.Original)),t},e.prototype.printApplication=function(e,t,r){var n=this,i=t.map((function(e,t){return n.pre(e.label,0===t||""===e.str?"":" ")+e.str}));return e.str+"("+i.join(this.localeInfo.listSeparator)+(0===t.length?"":this.post(t[t.length-1].label,""))+(r?")":"")},e.prototype.printCellRef=function(e){var t=e.ref,r=e.qualifier;return(void 0!==r?(0,b.visitQualifier)(this,r):"")+(0,b.visitCellRef)(this,t)},e.prototype.printName=function(e){var t=e.whole,r=e.qualifier;return(void 0!==r?(0,b.visitQualifier)(this,r):"")+this.anon(t)},e.prototype.printUnanonymisedDocQual=function(e){if(void 0===e)return"";var t=e.path,r=e.document;return(null!=t?t:"")+this.localeInfo.leftBracket+r+this.localeInfo.rightBracket},e.prototype.printOptionalParamName=function(e){return e.kind===a.NodeKind.Name?this.anon((0,c.getBoundName)(this.localeInfo,e.whole)):this.pre(e.label,"")+this.anon(e.contents)+this.post(e.label,"")},e.prototype.literalNode=function(e,t,r){switch(e.kind){case S.OperKind.String:return'"'+this.anon(e.value).replace(P,'""')+'"';case S.OperKind.Boolean:return e.value?this.localeInfo.trueName:this.localeInfo.falseName;case S.OperKind.Number:return this.anon(this.mathpack.formatGeneral(this.localeInfo,e,21));case S.OperKind.Missing:return"";case S.OperKind.Error:var n=this.localeInfo.errorNames[e.type];if(null==n)throw new I((0,c.internal)("No locale data for error type ".concat(e.type)));return n;default:return(0,u.assertNever)("calc.lang.printFormula",e)}},e.prototype.arrayNode=function(e,t,r){var n=this;return this.localeInfo.leftBrace+e.map((function(e){return e.map((function(e){return e.str})).join(n.localeInfo.columnSeparator)})).join(this.localeInfo.rowSeparator)+(t?this.localeInfo.rightBrace:"")},e.prototype.appNode=function(e,t,r,n){if(void 0!==e.op){if(1===t.length){var i=t[0];switch(e.op){case s.OperatorId.Percent:return i.str+this.pre(e.label,"")+e.str;case s.OperatorId.Pound:return i.str+e.str;default:return e.str+this.post(e.label,"")+i.str}}if(2===t.length){var a=t[0],o=t[1];return a.str+this.pre(e.label," ")+e.str+this.post(e.label,e.op===s.OperatorId.Isect?"":" ")+o.str}return(0,u.assertFalse)("calc.lang.printFormula: invalid number of operator args")}return this.printApplication(e,t,r)},e.prototype.letNode=function(e,t,r,n,i,o){var s=this,u=t.map((function(e){var t=e.name,r=e.binder;return(0,a.letVar)((0,a.indexedArg)({str:s.anon((0,c.getBoundName)(s.localeInfo,t.arg.whole)),label:t.arg.label,op:void 0},t.index),r)}));return this.printApplication(e,(0,a.flattenLetArgs)(u,r,n),i)},e.prototype.lambdaNode=function(e,t,r,n,i,o){var s=this,u=t.map((function(e){var t=e.name,r=(t.arg.name.isBracketed?s.localeInfo.leftBracket:"")+s.printOptionalParamName(t.arg.name.name)+(t.arg.name.isBracketed&&t.arg.name.isClosed?s.localeInfo.rightBracket:"");return void 0!==t.arg.def&&(r+=s.pre(t.arg.def.label," ")+":="+s.pre(t.arg.def.rhs.label,""===t.arg.def.rhs.str?"":" ")+t.arg.def.rhs.str),(0,a.lambdaParam)((0,a.indexedArg)({str:r,label:t.arg.label,op:void 0},t.index))}));return this.printApplication(e,(0,a.flattenLambdaArgs)(u,r,n),i)},e.prototype.parenNode=function(e,t,r){return"("+this.pre(e.label,"")+e.str+this.post(e.label,"")+(t?")":"")},e.prototype.nameNode=function(e,t,r){var n=this.resolver.resolveDottedName(this.locals,(0,a.nameNode)(e,t,r),this.annotations),o=n.resolved,s=n.fields;return R(o.resolution),o.kind===h.ResolvedKind.ResolvedCellRef?i.__spreadArray([this.printCellRef(o.node)],s.map(this.anon),!0).join("."):o.kind===h.ResolvedKind.ResolvedLocalName&&void 0!==o.resolution.value?i.__spreadArray([this.anon(o.resolution.value.name)],s.map(this.anon),!0).join("."):o.kind===h.ResolvedKind.ResolvedUserDefinedFunc?i.__spreadArray([this.anon(o.name)],s.map(this.anon),!0).join("."):i.__spreadArray([this.printName(o.node)],s.map(this.anon),!0).join(".")},e.prototype.cellRefNode=function(e,t,r){var n=this.resolver.resolveCellRef(this.locals,(0,a.cellRefNode)(e,t,r)),i=n.node;return R(n.resolution),this.printCellRef(i)},e.prototype.fieldRefNode=function(e,t,r,n){var i=e.str,o=r,s=t.isBracketed||o?this.localeInfo.leftBracket:"",u=t.isBracketed&&t.isClosed||o?this.localeInfo.rightBracket:"",c=t.field.kind===a.NodeKind.Name?T(t.field.whole,this.isFieldRefEscapable):t.field.contents;return t.field.kind!==a.NodeKind.Name&&(i+=this.pre(t.label,"")),i+="."+s+this.anon(c)+u+this.post(t.label,"")},e.prototype.structRefNode=function(e,t,r){var i,o=this,s=this.resolver.resolveStructRef(this.locals,(0,a.structRefNode)(e,t,r)),u=s.node,l=s.table;R(s.resolution);var d=u.rhs.innerRef,f=u.lhs;void 0!==f||void 0===l||!u.rhs.isClosed||(null==d?void 0:d.kind)===a.StructRefKind.ColumnRef||(null==d?void 0:d.kind)===a.StructRefKind.ThisRowOpRef&&(null===(i=d.ref)||void 0===i?void 0:i.kind)===a.StructRefKind.ColumnRef||(f=(0,a.nameNode)((0,a.identNamePart)(l.name)));var p=void 0!==f?this.printName(f):"";if(void 0===d&&u.rhs.isClosed&&void 0!==f)return p;switch(p+=this.localeInfo.leftBracket,null==d?void 0:d.kind){case a.StructRefKind.ColumnRef:case a.StructRefKind.SpecialRef:if(d.kind===a.StructRefKind.SpecialRef&&d.id===a.SpecialRefId.ThisRow&&d.isClosed){p+=this.printThisRowOpRef(void 0);break}p+=this.printRef(d,d.isClosed?n.Unbracketed:n.Original);break;case a.StructRefKind.RangeOpRef:var m=(h=(0,c.isRangeOpClosed)(d)&&(0,c.isRangeOpNoMissing)(d))?n.Bracketed:n.Original;p+=this.printRef(d,m);break;case a.StructRefKind.CommaOpRef:var h;if((h=(0,c.isCommaOpRefWellFormed)(d)&&(0,c.isCommaOpClosed)(d)&&(0,c.isCommaOpNoBadOrMissing)(d))&&d.specialRefs[a.SpecialRefId.ThisRow]){p+=this.printThisRowOpRef(0===d.columnRefs.length?void 0:d.columnRefs[0]);break}var v=h?(0,c.normalizeCommaOpRef)(d):d.refs,g=h?1===v.length?n.Unbracketed:n.Bracketed:n.Original;p+=v.map((function(e){return o.printRef(e,g)})).join(this.localeInfo.listSeparator);break;case a.StructRefKind.ThisRowOpRef:p+=this.printThisRowOpRef(d.ref);break;case a.StructRefKind.BadRef:p+=this.printRef(d,n.Original)}return u.rhs.isClosed&&(p+=this.localeInfo.rightBracket),p},e.prototype.badSequenceNode=function(e,t,r){var n=this;return t.map((function(e){return n.pre(e.label,"")+e.str+n.post(e.label,"")})).join("")},e.prototype.badStringNode=function(e,t,r){return this.anon(t)},e.prototype.operatorNode=function(e,t){var r=(0,d.operatorIdToName)(this.localeInfo,e,"");if(void 0===r)throw new I((0,c.internal)("Invalid operator"));return r},e.prototype.wsfNode=function(e,t,r){return this.localeInfo.getWorksheetFuncName(e)},e.prototype.cellRefError=function(){var e=this.localeInfo.errorNames[o.ErrorType.REF];if(null==e)throw new I((0,c.internal)("No locale data for #REF"));return e},e.prototype.cellRefSingle=function(e,t,r){var n=(0,p.formatCellPos)(this.localeInfo,this.refStyle,this.locals.originGridCell.value,e,t,this.locals.wrapCellReferences);return void 0!==n?this.anon(n):this.cellRefError()},e.prototype.cellRefRange=function(e,t){var r=(0,p.formatRangePos)(this.localeInfo,this.refStyle,this.locals.originGridCell.value,e.row,e.col,t.row,t.col,this.locals.wrapCellReferences);return void 0!==r?this.anon(r):this.cellRefError()},e.prototype.cellRefRow=function(e,t,r){var n=(0,p.formatRowRange)(this.localeInfo,this.refStyle,this.locals.originGridCell.value.row,e,t,this.locals.wrapCellReferences);return void 0!==n?this.anon(n):this.cellRefError()},e.prototype.cellRefCol=function(e,t,r){var n=(0,p.formatColRange)(this.localeInfo,this.refStyle,this.locals.originGridCell.value.col,e,t,this.locals.wrapCellReferences);return void 0!==n?this.anon(n):this.cellRefError()},e.prototype.cellRefBad=function(e,t){return this.anon(e)},e.prototype.errorQualifier=function(){var e=this.localeInfo.errorNames[o.ErrorType.REF];if(null==e)throw new I((0,c.internal)("No locale data for #REF"));return e},e.prototype.relativeQualifier=function(){return"!"},e.prototype.documentQualifier=function(e,t,r){return(0,p.quoteQualifier)(this.anon(this.printUnanonymisedDocQual((0,a.documentQualifier)(e,t))))+"!"},e.prototype.sheetQualifier=function(e,t,r){return(0,p.formatQualifier)(this.localeInfo,this.refStyle,this.anon(this.printUnanonymisedDocQual(t)+e))+"!"},e.prototype.identQualifier=function(e,t){return(0,p.formatQualifier)(this.localeInfo,this.refStyle,this.anon(e))+"!"},e.prototype.sheetRangeQualifier=function(e,t,r,n){var i=this.anon(this.printUnanonymisedDocQual(r)+e),a=this.anon(t),o=i+":"+a;return((0,p.shouldQuoteQualifier)(this.localeInfo,this.refStyle,i)||(0,p.shouldQuoteQualifier)(this.localeInfo,this.refStyle,a)?(0,p.quoteQualifier)(o):o)+"!"},e.prototype.badQualifier=function(e,t){return this.anon(e)},e}(),I=(0,c.createFailureErrorClass)("PrintFormulaError"),A=(0,c.createFailureErrorClass)("PrintRangeError");function M(e,t,r,n){void 0===n&&(n=!1);try{return(0,g.success)(new F(e,t,r,n).print())}catch(e){return e instanceof I?(0,g.failure)(e.reason):(0,g.failure)((0,g.javaScriptError)(e))}}function w(e,t){return(0,a.cellRefSingle)((0,a.pos)(a.PosKind.Rel,t.row-e.row),(0,a.pos)(a.PosKind.Rel,t.col-e.col))}function D(e,t,r){var n,i=t.originSheet.value,o=function(e,t){var r=w(e,(0,c.gridRangeAnchor)(t));if((0,c.isGridCell)(t))return r;var n=w(e,(0,l.gridCell)(t.row+t.rows-1,t.col+t.cols-1));return(0,a.cellRefRange)(r,n)}(t.originGridCell.value,r.range);if(void 0===i.index||!(0,c.isSheetIndexEqual)(i,r.sheet)){var s=e.getSheetName(r.sheet.document,r.sheet.index);if(!(0,g.isSuccess)(s))throw new A(s.reason);n=(0,a.sheetQualifier)(s.value)}return(0,a.cellRefNode)(o,n)}function j(e){return(0,g.isSuccess)(e)?((0,u.assertTrue)("calc.lang.printRangeStructRef: NameLoc can't be no-table",null!=e.value),(0,g.success)(e.value)):e.reason.kind===h.ResolveReasonKind.InvalidStructRef?(0,u.assertFalse)("calc.lang.printRangeStructRef: NameLoc can't be InvalidStructRef"):(0,g.failure)(e.reason)}function x(e,t,r,n){var o,s;void 0===n&&(n=(0,y.makeEmptyTable)());try{var u=t.originSheet.value;if(!(0,c.isDocumentLocEqual)(u.document,r.sheet.document))throw new A((0,c.notImplemented)(["printRange cross-document"]));return(0,g.success)(null!==(s=null!==(o=function(e,t,r,n){var o=t.originSheet.value,s=e.getNamedRanges(r);if(!(0,g.isSuccess)(s))throw new A(s.reason);if(0!==s.value.length){var u=function(e){return void 0!==e.index&&(void 0===o.index||!(0,c.isSheetIndexEqual)(e,o))},d=s.value.filter((function(e){var t=e.scope;return void 0===t.index?(0,c.isDocumentLocEqual)(t.document,r.sheet.document):(0,c.isSheetIndexEqual)(t,r.sheet)})).filter((function(t){var r=t.scope,n=t.name;if(void 0!==r.index||void 0===o.index)return!0;var i=o,a=e.getNameLoc(i,n,l.NameSource.Plain);if(!(0,g.isSuccess)(a))throw new A(a.reason);return null==a.value})).filter((function(e){var t=e.scope,r=e.name;return u(t)||!n.contains(r)}));if(0!==d.length){var f,p=1===d.length?d[0]:i.__spreadArray([],d,!0).sort((function(t,r){return e.config.localeInfo.stringCompareCI(t.name,r.name)}))[0];if(u(p.scope)){var m=e.getSheetName(p.scope.document,p.scope.index);if(!(0,g.isSuccess)(m))throw new A(m.reason);f=(0,a.sheetQualifier)(m.value)}return(0,a.nameNode)((0,a.identNamePart)(p.name),f)}}}(e,t,r,n))&&void 0!==o?o:function(e,t,r){var n=r.sheet,i=r.range,o=e.getContainingTable((0,l.sheetGridCell)(n,(0,c.gridRangeAnchor)(i)));if(!(0,g.isSuccess)(o))throw new A(o.reason);if(null!=o.value){var s=o.value,u=j(e.getStructRefSpecialRef(s,a.SpecialRefId.All));if(!(0,g.isSuccess)(u))throw new A(u.reason);var d=u.value.range,f=u.value.sheet,p=(0,c.gridRangeCompare)(d,i);if(!(void 0===p||p<0)){var m=j(e.getStructRefSpecialRef(s,a.SpecialRefId.Data));if(!(0,g.isSuccess)(m))throw new A(m.reason);var h=m.value.range,v=t.originGridCell.value,b=t.originSheet.value,S=void 0!==b.index&&(0,c.isSheetIndexEqual)(b,f)&&(0,c.gridRangeIsects)(d,v)?void 0:(0,a.nameNode)((0,a.identNamePart)(s.name)),y=null!=S?S:(0,a.nameNode)((0,a.identNamePart)(s.name)),O=h.cols>1&&i.col===h.col&&i.cols===h.cols,C=function(){var t=j(e.getStructRefColumn(s,i.col));if(!(0,g.isSuccess)(t))throw new A(t.reason);if(1===i.cols)return(0,a.columnRef)(t.value.name);var r=j(e.getStructRefColumn(s,i.col+i.cols-1));if(!(0,g.isSuccess)(r))throw new A(r.reason);return(0,a.rangeOpRef)((0,a.columnRef)(t.value.name),(0,a.columnRef)(r.value.name))};if(i.row===d.row&&i.rows===d.rows)return(0,a.structRefNode)(y,(0,a.structRef)(O?(0,a.specialRef)(a.SpecialRefId.All):(0,a.commaOpRef)([(0,a.specialRef)(a.SpecialRefId.All,!0),C()])));if(1===i.rows&&i.row===v.row&&i.row>=h.row&&i.row<h.row+h.rows)return(0,a.structRefNode)(1===i.cols?S:y,(0,a.structRef)((0,a.thisRowOpRef)(O?void 0:C())));if(i.row===h.row&&i.rows===h.rows)return O?(0,a.structRefNode)(y,(0,a.structRef)(void 0)):(0,a.structRefNode)(1===i.cols?S:y,(0,a.structRef)(C()));var P=i.row===d.row&&i.row+i.rows===h.row,N=i.row===h.row+h.rows&&i.row+i.rows===d.row+d.rows;if(P||N){var R=(0,a.specialRef)(P?a.SpecialRefId.Headers:a.SpecialRefId.Totals,!O);return(0,a.structRefNode)(y,(0,a.structRef)(O?R:(0,a.commaOpRef)([R,C()])))}var k=i.row===d.row&&d.row<h.row&&i.row+i.rows===h.row+h.rows,T=i.row===h.row&&d.row+d.rows>h.row+h.rows&&i.row+i.rows===d.row+d.rows;if(k||T){var E=(0,a.specialRef)(k?a.SpecialRefId.Headers:a.SpecialRefId.Data,!0),_=(0,a.specialRef)(k?a.SpecialRefId.Data:a.SpecialRefId.Totals,!0);return(0,a.structRefNode)(y,(0,a.structRef)(O?(0,a.commaOpRef)([E,_]):(0,a.commaOpRef)([E,_,C()])))}}}}(e,t,r))&&void 0!==s?s:D(e,t,r))}catch(e){return e instanceof A?(0,g.failure)(e.reason):(0,g.failure)((0,g.javaScriptError)(e))}}t.anonymizeFormula=function(e,t,r){try{var n=r.kind===l.LexicalKind.Cell||r.kind===l.LexicalKind.Range?(0,O.printLocalsGrid)(r,(0,c.sheetGridRangeAnchor)(r.range)):r.kind===l.LexicalKind.NameManager?(0,O.printLocalsName)(r,N):(0,u.assertNever)("calc.lang.anonymizeFormula",r),i=M((0,O.createSimplePrintGlobals)((0,d.calcConfig)((0,d.getEnglishLocaleInfo)(),a.RefStyle.A1,e.mathpack)),n,t,!0);if(i.kind===g.ResultKind.Success)return i.value;if(i.reason.kind===g.ReasonKind.JavaScriptError)throw i.reason.error}catch(e){var o="calc.lang.anonymizeFormula: Format failed: "+(0,m.messageFromError)(e);u.ulsLogger.ULS.traceTag(556863706,d.LogCategory.msoulscat_ES_EWAJS,d.TraceLevel.Warning,o)}return(0,f.anonymize)(t)};var L={getNamedRanges:function(){return(0,u.assertFalse)("calc.lang.prettyPrinter: default getNamedRanges")}};t.createPrinter=function(e){var t=function(e){var t,r,n;return{config:e.config,getDocumentLoc:e.getDocumentLoc.bind(e),getSheetIndex:e.getSheetIndex.bind(e),getSheetName:e.getSheetName.bind(e),getNameLoc:e.getNameLoc.bind(e),getUserDefinedFuncLoc:e.getUserDefinedFuncLoc.bind(e),getSheetRangeIndexes:e.getSheetRangeIndexes.bind(e),getContainingTable:e.getContainingTable.bind(e),getStructRefColumn:e.getStructRefColumn.bind(e),getStructRefSpecialRef:null===(t=e.getStructRefSpecialRef)||void 0===t?void 0:t.bind(e),getNamedRanges:null!==(n=null===(r=e.getNamedRanges)||void 0===r?void 0:r.bind(e))&&void 0!==n?n:L.getNamedRanges}}(e);return{printFormula:function(t,r){return M(e,t,r)},printRange:function(e,r,n){return x(t,e,r,n)}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.entry=t.makeEmptyTable=void 0;var n=r(7);t.makeEmptyTable=n.table.makeEmptyTable,t.entry=n.table.entry},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.poundNode=t.atNode=t.maxNode=t.minNode=t.xorNode=t.orNode=t.andNode=t.unionNode=t.isectNode=t.rangeNode=t.geNode=t.gtNode=t.leNode=t.ltNode=t.neNode=t.eqNode=t.concatNode=t.posNode=t.negNode=t.percentNode=t.powNode=t.divNode=t.mulNode=t.subNode=t.addNode=t.badBracketNode=t.badQualNode=t.badCellRefNode=t.badMissingNode=t.badParamNameNode=t.badFieldNameNode=t.badErrorLiteralNode=t.badStringLiteralNode=t.badNumberLiteralNode=t.badUnexpNode=t.badFieldRefNode=t.badStructRefNode=t.badSeqNode=t.absPos=t.relPos=t.expectTrue=t.isNameLocEqual=t.createSingleRange=t.sheet1=t.sheet1Name=t.document1=void 0;var n=r(75),i=r(86),a=r(69),o=r(128);function s(e,t){return void 0===t&&(t=0),(0,a.badNode)(a.BadType.Sequence,e,t)}function u(e,t){return void 0===t&&(t=0),(0,a.badNode)(a.BadType.Unexpected,e,t)}function c(e){return function(t){return void 0===t&&(t=0),(0,a.operatorNode)(e,t)}}t.document1=(0,n.documentLoc)(void 0,"Book1"),t.sheet1Name="Sheet1",t.sheet1=(0,n.sheetIndex)(t.document1,0),t.createSingleRange=function(e,r){var i=(0,n.gridCell)(e,r);return(0,n.sheetGridCell)(t.sheet1,i)},t.isNameLocEqual=function(e,t,r){return(0,i.isNameScopeEqual)(t.scope,r.scope)&&0===e.stringCompareCI(t.name,r.name)},t.expectTrue=function(e){expect(e).toBeTruthy()},t.relPos=function(e){return(0,a.pos)(a.PosKind.Rel,e)},t.absPos=function(e){return(0,a.pos)(a.PosKind.Abs,e)},t.badSeqNode=s,t.badStructRefNode=function(e,t){return void 0===t&&(t=0),(0,a.badNode)(a.BadType.StructRef,e,t)},t.badFieldRefNode=function(e,t){return void 0===t&&(t=0),(0,a.badNode)(a.BadType.FieldRef,e,t)},t.badUnexpNode=u,t.badNumberLiteralNode=function(e,t){return void 0===t&&(t=0),(0,a.badNode)(a.BadType.NumberLiteral,e,t)},t.badStringLiteralNode=function(e,t){return void 0===t&&(t=0),(0,a.badNode)(a.BadType.StringLiteral,e,t)},t.badErrorLiteralNode=function(e,t){return void 0===t&&(t=0),(0,a.badNode)(a.BadType.ErrorLiteral,e,t)},t.badFieldNameNode=function(e,t){return void 0===t&&(t=0),(0,a.badNode)(a.BadType.FieldName,e,t)},t.badParamNameNode=function(e,t){return void 0===t&&(t=0),(0,a.badNode)(a.BadType.ParamName,e,t)},t.badMissingNode=function(e,t){return void 0===t&&(t=0),(0,a.badNode)(a.BadType.Missing,e,t)},t.badCellRefNode=function(e,t,r,n){return void 0===t&&(t=e.indexOf("[")>=0),void 0===r&&(r=0),void 0===n&&(n=0),(0,a.cellRefNode)((0,a.cellRefBad)(e,t,r),void 0,n)},t.badQualNode=function(e,t){return void 0===t&&(t=0),(0,a.badNode)(a.BadType.Qualifier,e,t)},t.badBracketNode=function(e,t){void 0===t&&(t=!0);var r=[u("["),e];return t&&r.push(u("]")),s(r)},t.addNode=c(o.OperatorId.Add),t.subNode=c(o.OperatorId.Sub),t.mulNode=c(o.OperatorId.Mul),t.divNode=c(o.OperatorId.Div),t.powNode=c(o.OperatorId.Pow),t.percentNode=c(o.OperatorId.Percent),t.negNode=c(o.OperatorId.Neg),t.posNode=c(o.OperatorId.Pos),t.concatNode=c(o.OperatorId.Concat),t.eqNode=c(o.OperatorId.Eq),t.neNode=c(o.OperatorId.Ne),t.ltNode=c(o.OperatorId.Lt),t.leNode=c(o.OperatorId.Le),t.gtNode=c(o.OperatorId.Gt),t.geNode=c(o.OperatorId.Ge),t.rangeNode=c(o.OperatorId.Range),t.isectNode=c(o.OperatorId.Isect),t.unionNode=c(o.OperatorId.Union),t.andNode=c(o.OperatorId.And),t.orNode=c(o.OperatorId.Or),t.xorNode=c(o.OperatorId.Xor),t.minNode=c(o.OperatorId.Min),t.maxNode=c(o.OperatorId.Max),t.atNode=c(o.OperatorId.At),t.poundNode=c(o.OperatorId.Pound)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VerticalAlignment=t.HorizontalAlignment=t.BorderLineType=t.PatternType=t.FillKind=t.FontVerticalAlignment=t.FontUnderline=void 0;var n=r(58);!function(e){e.None="None",e.Single="Single",e.Double="Double",e.SingleAccounting="SingleAccounting",e.DoubleAccounting="DoubleAccounting"}(t.FontUnderline||(t.FontUnderline={})),(0,n.staticAssertSame)(),function(e){e.None="None",e.Subscript="Subscript",e.Superscript="Superscript"}(t.FontVerticalAlignment||(t.FontVerticalAlignment={})),(0,n.staticAssertSame)(),function(e){e.Pattern="Pattern",e.Gradient="Gradient"}(t.FillKind||(t.FillKind={})),function(e){e.None="None",e.Solid="Solid",e.MediumGray="MediumGray",e.DarkGray="DarkGray",e.LightGray="LightGray",e.DarkHorizontal="DarkHorizontal",e.DarkVertical="DarkVertical",e.DarkDown="DarkDown",e.DarkUp="DarkUp",e.DarkGrid="DarkGrid",e.DarkTrellis="DarkTrellis",e.LightHorizontal="LightHorizontal",e.LightVertical="LightVertical",e.LightDown="LightDown",e.LightUp="LightUp",e.LightGrid="LightGrid",e.LightTrellis="LightTrellis",e.Gray125="Gray125",e.Gray0625="Gray0625"}(t.PatternType||(t.PatternType={})),function(e){e.None="None",e.Thin="Thin",e.Medium="Medium",e.Dashed="Dashed",e.Dotted="Dotted",e.Thick="Thick",e.Double="Double",e.Hair="Hair",e.MediumDashed="MediumDashed",e.DashDot="DashDot",e.MediumDashDot="MediumDashDot",e.DashDotDot="DashDotDot",e.MediumDashDotDot="MediumDashDotDot",e.SlantDashDot="SlantDashDot"}(t.BorderLineType||(t.BorderLineType={})),(0,n.staticAssertSame)(),function(e){e.Automatic="Automatic",e.Left="Left",e.Center="Center",e.Right="Right",e.Fill="Fill",e.Justify="Justify",e.CenterAcrossSelection="CenterAcrossSelection",e.Distributed="Distributed",e.JustifyDistributed="JustifyDistributed"}(t.HorizontalAlignment||(t.HorizontalAlignment={})),(0,n.staticAssertSame)(),function(e){e.Top="Top",e.Center="Center",e.Bottom="Bottom",e.Justify="Justify",e.Distributed="Distributed"}(t.VerticalAlignment||(t.VerticalAlignment={})),(0,n.staticAssertSame)()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createAnalyzer=void 0;var n=r(227),i=r(228),a=r(352);t.createAnalyzer=function(e){return{checkFormula:function(t,r){return(0,n.checkFormula)(e,t,r)},checkFormulaWithDiagnostics:function(t,r){return(0,n.checkFormulaWithDiagnostics)(e,t,r)},autocorrectFormula:function(t,r){return(0,i.autocorrectFormula)(e,t,r)},resolveStaticPrecedents:function(t,r){return(0,a.resolveStaticPrecedents)(e,t,r)}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RedBlackMapTree=void 0;var n=r(7);t.RedBlackMapTree=n.rbMapTree.RedBlackMapTree},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Pledge=void 0;var n=r(7);t.Pledge=n.pledge.Pledge},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolveStaticPrecedents=void 0;var n=r(2),i=r(65),a=r(113),o=r(66),s=r(59),u=r(182),c=r(230),l=r(229),d=r(104),f=r(103),p=r(87),m=r(88),h=r(183),v=r(231),g={getDocumentLoc:function(){return(0,i.assertFalse)("calc.analyze.resolveStaticPrecedents: default getDocumentLoc")},getSheetIndex:function(){return(0,i.assertFalse)("calc.analyze.resolveStaticPrecedents: default getSheetIndex")},getSheetName:function(){return(0,i.assertFalse)("calc.analyze.resolveStaticPrecedents: default getSheetName")},getNameLoc:function(){return(0,i.assertFalse)("calc.analyze.resolveStaticPrecedents: default getNameLoc")},getUserDefinedFuncLoc:function(){return(0,i.assertFalse)("calc.analyze.resolveStaticPrecedents: default getUserDefinedFuncLoc")},getSheetRangeIndexes:function(){return(0,i.assertFalse)("calc.analyze.resolveStaticPrecedents: default getSheetRangeIndexes")},getContainingTable:function(){return(0,i.assertFalse)("calc.analyze.resolveStaticPrecedents: default getContainingTable")},getStructRefColumn:function(){return(0,i.assertFalse)("calc.analyze.resolveStaticPrecedents: default getStructRefColumn")},getStructRefSpecialRef:function(){return(0,i.assertFalse)("calc.analyze.resolveStaticPrecedents: default getStructRefSpecialRef")}};var b=(0,p.createFailureErrorClass)("ResolveStaticPrecedentsError"),S=function(e){function t(t,r,n){var i=e.call(this)||this;return i.locals=r,i.annotations=n,i.cells=[],i.names=[],i.udfs=[],i.nameSpecial=f.SpecialPrecs.None,i.ownSpecial=f.SpecialPrecs.None,i.resolutions=[],i.globals=function(e){var t,r,n,i,a,o,s,u,c,l,d,f,p,m,h,v,b,S;return{config:e.config,getDocumentLoc:null!==(r=null===(t=e.getDocumentLoc)||void 0===t?void 0:t.bind(e))&&void 0!==r?r:g.getDocumentLoc,getSheetIndex:null!==(i=null===(n=e.getSheetIndex)||void 0===n?void 0:n.bind(e))&&void 0!==i?i:g.getSheetIndex,getSheetName:null!==(o=null===(a=e.getSheetName)||void 0===a?void 0:a.bind(e))&&void 0!==o?o:g.getSheetName,getNameLoc:null!==(u=null===(s=e.getNameLoc)||void 0===s?void 0:s.bind(e))&&void 0!==u?u:g.getNameLoc,getUserDefinedFuncLoc:null!==(l=null===(c=e.getUserDefinedFuncLoc)||void 0===c?void 0:c.bind(e))&&void 0!==l?l:g.getUserDefinedFuncLoc,getSheetRangeIndexes:null!==(f=null===(d=e.getSheetRangeIndexes)||void 0===d?void 0:d.bind(e))&&void 0!==f?f:g.getSheetRangeIndexes,getContainingTable:null!==(m=null===(p=e.getContainingTable)||void 0===p?void 0:p.bind(e))&&void 0!==m?m:g.getContainingTable,getStructRefColumn:null!==(v=null===(h=e.getStructRefColumn)||void 0===h?void 0:h.bind(e))&&void 0!==v?v:g.getStructRefColumn,getStructRefSpecialRef:null!==(S=null===(b=e.getStructRefSpecialRef)||void 0===b?void 0:b.bind(e))&&void 0!==S?S:g.getStructRefSpecialRef}}(t),i.resolver=(0,c.createResolver)(i.globals),i}return n.__extends(t,e),t.prototype.appNode=function(t,r,n,i){var a,c,m,h,v=this;if(t.kind===s.NodeKind.WSF){var g=t.id,b=(0,d.getWorksheetFuncType)(g).staticPrecs;switch(g){case d.WorksheetFuncId.LOOKUP:case d.WorksheetFuncId.SUMIF:case d.WorksheetFuncId.AVERAGEIF:var S=function(e){var t=e.label,r=v.resolutions[t],n=(null==r?void 0:r.kind)===l.ResolvedKind.ResolvedCellRef||(null==r?void 0:r.kind)===l.ResolvedKind.ResolvedStructRef?r.resolution:void 0;return(null==n?void 0:n.kind)===o.ResultKind.Success?n.value:void 0};(r.length<3||r[2].kind===s.NodeKind.Literal||r[2].kind===s.NodeKind.Array||(a=r[2],c=g===d.WorksheetFuncId.LOOKUP?r[1]:r[0],m=S(a),h=S(c),void 0!==m&&void 0!==h&&(0,u.isSheetGridRange)(m)&&(0,u.isSheetGridRange)(h)&&(0,p.isDocumentLocEqual)(m.sheet.document,h.sheet.document)&&m.range.rows===h.range.rows&&m.range.cols===h.range.cols))&&(b&=~f.SpecialPrecs.AllCells)}b!==f.SpecialPrecs.None&&(this.ownSpecial|=b)}return e.prototype.appNode.call(this,t,r,n,i)},t.prototype.nameNode=function(t,r,n){var i=this.resolver.resolveDottedName(this.locals,(0,s.nameNode)(t,r,n),this.annotations);this.resolutions[n]=i,(0,a.safePush)(this.names,i.precedents.names),(0,a.safePush)(this.udfs,i.precedents.udfs);var u=i.resolved;switch(u.kind){case l.ResolvedKind.ResolvedName:if(!(0,o.isSuccess)(u.resolution)){this.handleResolutionError(u.resolution.reason);break}void 0!==u.resolution.value&&(this.nameSpecial|=f.SpecialPrecs.All);break;case l.ResolvedKind.ResolvedUserDefinedFunc:if(!(0,o.isSuccess)(u.resolution)){this.handleResolutionError(u.resolution.reason);break}break;case l.ResolvedKind.ResolvedCellRef:this.pushResolvedGridRef(u.resolution)}return e.prototype.nameNode.call(this,t,r,n)},t.prototype.cellRefNode=function(t,r,n){var i=this.resolver.resolveCellRef(this.locals,(0,s.cellRefNode)(t,r,n));this.resolutions[n]=i;var a=i.resolution;return this.pushResolvedGridRef(a),e.prototype.cellRefNode.call(this,t,r,n)},t.prototype.structRefNode=function(t,r,n){var i=this.resolver.resolveStructRef(this.locals,(0,s.structRefNode)(t,r,n));this.resolutions[n]=i,(0,a.safePush)(this.names,i.precedents);var o=i.resolution;return this.pushResolvedGridRef(o),e.prototype.structRefNode.call(this,t,r,n)},t.prototype.pushResolvedGridRef=function(e){if(e.kind!==o.ResultKind.Success)return this.handleResolutionError(e.reason);if(void 0!==e.value){var t=e.value;if((0,u.isSheetGridRange)(t))this.cells.push(t);else{this.ownSpecial|=f.SpecialPrecs.OwnDocSheets;var r=this.globals.getSheetRangeIndexes(t.sheet);if(!(0,o.isSuccess)(r))throw new b(r.reason);(0,a.safePush)(this.cells,r.value.sheets.map((function(e){return(0,u.sheetGridRange)((0,u.sheetIndex)(t.sheet.document,e),t.range)})))}}},t.prototype.handleResolutionError=function(e){switch(e.kind){case l.ResolveReasonKind.NoOriginSheet:case l.ResolveReasonKind.InvalidStructRef:case l.ResolveReasonKind.InvalidCellRef:case l.ResolveReasonKind.InvalidQualifier:case l.ResolveReasonKind.EmptyIntersection:return}throw new b(e)},t}(h.IdentityVisitor);t.resolveStaticPrecedents=function(e,t,r){try{var n=new S(e,t,r.annotations);return(0,h.reduceBottomUp)(n,r),(0,o.success)((0,v.staticPrecedents)(n.cells,n.names,n.udfs,n.nameSpecial|n.ownSpecial,n.ownSpecial,m.PrecsBound.Upper,n.resolutions))}catch(e){return e instanceof b?(0,o.failure)(e.reason):(0,o.failure)((0,o.javaScriptError)(e))}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shouldQuoteQualifier=t.resolvePosition=t.quoteQualifier=t.formatRowRange=t.formatRow=t.formatRangePos=t.formatQualifier=t.formatGridRangeA1=t.formatColRange=t.formatCol=t.formatCellPos=t.columnName=t.canonicaliseRowRange=t.canonicaliseRow=t.canonicaliseRangePos=t.canonicaliseColRange=t.canonicaliseCol=t.canonicaliseCellPos=t.canonicaliseBrackets=void 0;var n=r(3);t.canonicaliseBrackets=n.cellFormat.canonicaliseBrackets,t.canonicaliseCellPos=n.cellFormat.canonicaliseCellPos,t.canonicaliseCol=n.cellFormat.canonicaliseCol,t.canonicaliseColRange=n.cellFormat.canonicaliseColRange,t.canonicaliseRangePos=n.cellFormat.canonicaliseRangePos,t.canonicaliseRow=n.cellFormat.canonicaliseRow,t.canonicaliseRowRange=n.cellFormat.canonicaliseRowRange,t.columnName=n.cellFormat.columnName,t.formatCellPos=n.cellFormat.formatCellPos,t.formatCol=n.cellFormat.formatCol,t.formatColRange=n.cellFormat.formatColRange,t.formatGridRangeA1=n.cellFormat.formatGridRangeA1,t.formatQualifier=n.cellFormat.formatQualifier,t.formatRangePos=n.cellFormat.formatRangePos,t.formatRow=n.cellFormat.formatRow,t.formatRowRange=n.cellFormat.formatRowRange,t.quoteQualifier=n.cellFormat.quoteQualifier,t.resolvePosition=n.cellFormat.resolvePosition,t.shouldQuoteQualifier=n.cellFormat.shouldQuoteQualifier},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.buildAnnotations=void 0;var n=r(3);t.buildAnnotations=n.annotations.buildAnnotations},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseResultHelper=t.ExtractLetVisitor=void 0;var n=r(2),i=r(65),a=r(59),o=r(181),s=r(104),u=r(66),c=r(183),l=r(113),d=r(116),f=r(238),p=r(185);function m(e,t){var r=e[t];return(0,i.assertTrue)("ParseResultHelper.getFormulaSpan: expected span to be defined",void 0!==r),r}var h=function(e){function t(t,r){var n=e.call(this)||this;return n.formula=t,n.caretPosition=r,n.references=[],n}return n.__extends(t,e),t.prototype.letNode=function(t,r,n,i,a,o){if(this.caretInNode(null==n?void 0:n.arg))this.pushNames(r);else for(var u=0;u<r.length;u+=1){var c=r[u].binder;if(this.caretInNode(c.arg)){this.pushNames(t.id===s.WorksheetFuncId.LET?r.slice(0,u):r);break}}return e.prototype.letNode.call(this,t,r,n,i,a,o)},t.prototype.lambdaNode=function(t,r,n,i,a,o){if(this.caretInNode(null==n?void 0:n.arg))this.pushNames(r);else for(var s=0;s<r.length;s+=1){var u=r[s].name;if(void 0!==u.arg.def&&this.caretInNode(u.arg.def.rhs)){this.pushNames(r.slice(0,s));break}}return e.prototype.lambdaNode.call(this,t,r,n,i,a,o)},t.prototype.caretInNode=function(e){if(void 0===e)return!1;var t=this.formula.spans[e.label];return void 0!==t&&this.caretPosition>=t.start&&this.caretPosition<=t.end},t.prototype.pushNames=function(e){(0,l.safePush)(this.references,e.map((function(e){return e.name.arg.whole})).filter(l.isDefined).reverse())},t}(c.IdentityVisitor);function v(e,t,r,s,l,d,f){if(void 0===l&&(l=!1),!(0,u.isSuccess)(e))return!1;try{!function(e,t,r,i,o,s,l){if(null==e||null==i)return;var d={};null!=r?r.forEach((function(e){d[e]=!0})):d["*"]=!0;var f={},p=0,h=[],v=n.__assign(n.__assign({},c.voidVisitor),{letNode:function(t,r,n,i,a,o){for(var s=0,u=r;s<u.length;s++){var c=u[s].name;f[c.arg.label]=p}h.push({letCount:p,span:m(e.spans,o)}),p+=1},lambdaNode:function(t,r,n,i,a,o){for(var s=0,u=r;s<u.length;s++){var c=u[s].name;f[c.arg.label]=p}h.push({letCount:p,span:m(e.spans,o)}),p+=1}});(0,c.reduceBottomUp)(v,e),h.sort((function(e,t){return e.span.start-t.span.start}));for(var g={},b=0;b<h.length;b+=1)g[h[b].letCount]=b;for(var S=0,y=Object.keys(f).map(Number);S<y.length;S++){var O=y[S];f[O]=g[f[O]]}var C={literalNode:function(e,t,r){var n=c.identityVisitor.literalNode(e,t,r);return P("literal")&&i("literal",{label:r,value:n}),n},arrayNode:function(e,t,r){return c.identityVisitor.arrayNode(e,t,r)},appNode:function(e,t,r,n){var i=c.identityVisitor.appNode(e,t,r,n);return R(e,t,r,n),i},letNode:function(e,t,r,n,o,s){var u=(0,a.letNode)(e,t,r,n,o,s);R(e,u.args,o,s);for(var c=0,l=t;c<l.length;c++){var d=l[c].name;P("letName")&&i("letName",{label:d.arg.label,name:d.arg.whole,number:f[d.arg.label],qualifier:void 0})}return u},lambdaNode:function(e,t,r,n,o,s){var u=(0,a.lambdaNode)(e,t,r,n,o,s);R(e,u.args,o,s);for(var c=0,l=t;c<l.length;c++){var d=l[c].name;P("letName")&&i("letName",{label:d.arg.name.name.label,name:d.arg.whole,number:f[d.arg.label],qualifier:void 0})}return u},parenNode:function(e,t,r){return c.identityVisitor.parenNode(e,t,r)},nameNode:function(t,r,n){var o=(0,a.nameNode)(t,r,n),s=e.annotations[t.label],u=e.annotations[n];if((null==u?void 0:u.kind)===a.AnnotationKind.AppHeadName);else if((null==s?void 0:s.kind)===a.AnnotationKind.LocalNameUse)P("letName")&&i("letName",{label:n,name:s.name,number:f[s.label],qualifier:void 0});else if(P("namedRange")){var c=o.whole.split(".");i("namedRange",{label:n,name:c[0],names:c.slice(1),qualifier:N(o)})}return o},cellRefNode:function(t,r,n){var o=(0,a.cellRefNode)(t,r,n);return P("range")&&function(t){if(null==e||null==i)return;switch(t.ref.kind){case a.CellRefKind.Error:break;case a.CellRefKind.Col:var r=t.ref;i("range",{label:t.label,type:"col",startIndex:r.col1,endIndex:r.col2,span:m(e.spans,r.label),qualifier:N(t)});break;case a.CellRefKind.Row:var n=t.ref;i("range",{label:t.label,type:"row",startIndex:n.row1,endIndex:n.row2,span:m(e.spans,n.label),qualifier:N(t)});break;case a.CellRefKind.Single:var o=t.ref;i("range",{label:t.label,type:"cell",row:o.row,col:o.col,span:m(e.spans,o.label),qualifier:N(t)});break;case a.CellRefKind.Range:var s=t.ref;i("range",{label:t.label,type:"range",top:s.ref1.row,left:s.ref1.col,bottom:s.ref2.row,right:s.ref2.col,topLeftSpan:m(e.spans,s.ref1.label),bottomRightSpan:m(e.spans,s.ref2.label),qualifier:N(t)})}}(o),o},fieldRefNode:function(e,t,r,n){return c.identityVisitor.fieldRefNode(e,t,r,n)},structRefNode:function(t,r,n){var o=(0,a.structRefNode)(t,r,n);if(P("structRefRange")){if(null==l||null==s)return o;var c=l.resolveStructRef(s,o).resolution;if(!(0,u.isSuccess)(c)||void 0===c.value)return o;var d=c.value;i("structRefRange",{label:n,type:"range",top:(0,a.pos)(a.PosKind.Rel,d.range.row),left:(0,a.pos)(a.PosKind.Rel,d.range.col),bottom:(0,a.pos)(a.PosKind.Rel,d.range.row+d.range.rows-1),right:(0,a.pos)(a.PosKind.Rel,d.range.col+d.range.cols-1),span:m(e.spans,n),qualifier:void 0!==t?N(t):void 0,name:void 0!==t?t.whole:void 0})}return o},badSequenceNode:function(e,t,r){return c.identityVisitor.badSequenceNode(e,t,r)},badStringNode:function(e,t,r){return c.identityVisitor.badStringNode(e,t,r)},operatorNode:function(e,t){return c.identityVisitor.operatorNode(e,t)},wsfNode:function(e,t,r){return c.identityVisitor.wsfNode(e,t,r)}};function P(e){return d[e]||d["*"]}function N(e){if(null!=e.qualifier){var t={};switch(e.qualifier.kind){case a.QualifierKind.Sheet:var r=e.qualifier;t.type=a.QualifierKind.Sheet,t.sheet=r.sheet,null!=r.document&&(t.document=r.document.document,null!=r.document.path&&(t.documentPath=r.document.path));break;case a.QualifierKind.SheetRange:var n=e.qualifier;t.type=a.QualifierKind.SheetRange,t.sheet1=n.sheet1,t.sheet2=n.sheet2;break;case a.QualifierKind.Ident:var i=e.qualifier;t.type=a.QualifierKind.Ident,t.name=i.name;break;case a.QualifierKind.Document:var o=e.qualifier;t.document=o.document,null!=o.path&&(t.documentPath=o.path)}return t}}function R(e,t,r,n){if(null!=i)switch(e.kind){case a.NodeKind.Operator:P("operator")&&i("operator",{label:n,value:e.id});break;case a.NodeKind.WSF:case a.NodeKind.Name:P("function")&&i("function",{label:n,name:e.whole,isClosed:r,args:t})}}(0,c.reduceBottomUp)(C,e)}(e.value,null!=s||(0,o.getEnglishLocaleInfo)(),t,r,0,d,f)}catch(e){var h="ParseResultHelper.traverse: unhandled error ".concat((0,p.messageFromError)(e));i.ulsLogger.ULS.traceTag(540645344,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,h)}return!0}t.ExtractLetVisitor=h,t.parseResultHelper={isSuccess:u.isSuccess,traverse:function(e,t,r,n,i,a,o){return(0,d.isFeatureEnabled)(d.FeatureName["OfficeVSO:5484395_SafeParseResultHelper"])?v(e,t,r,n,i,a,o):(0,f.traverse_old)(e,t,r,n,i,a,o)},extractReferences:function(e,t,r,n,i){return(0,d.isFeatureEnabled)(d.FeatureName["OfficeVSO:5484395_SafeParseResultHelper"])?function(e,t,r,n,i){if(void 0===r&&(r=!1),(0,u.isSuccess)(e)){var a=[];return v(e,["range","namedRange","letName","literal","function","structRefRange"],(function(t,r){var n={kind:t,ref:r,span:m(e.value.spans,r.label)};a.push(n)}),t,r,n,i),a.sort((function(e,t){var r;return 0!=(r=e.span.start-t.span.start)||0!=(r=t.span.end-e.span.end)?r:0})),a}}(e,t,r,n,i):(0,f.extractReferences_old)(e,t,r,n,i)},extractLetVariables:function(e,t){if((0,u.isSuccess)(e))try{var r=new h(e.value,t);return(0,c.reduceBottomUp)(r,e.value),r.references.reverse()}catch(e){var n="ParseResultHelper.extractLetVariables: unhandled error ".concat((0,p.messageFromError)(e));return i.ulsLogger.ULS.traceTag(540645343,o.LogCategory.msoulscat_ES_EWAJS,o.TraceLevel.Warning,n),[]}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createParser=void 0;var n=r(239),i=r(233),a=r(232),o=r(87),s=r(66),u={"=":1,"+":0,"-":0,"@":-1};t.createParser=function(e){return{parseFormula:function(t,r){return function(e,t,r){var c,l,d,f;try{var p=r[0],m=null!=p?u[p]:void 0;if(null==m)return(0,s.failure)((0,a.notFormulaString)("first character is not '=', '+', '-' or '@'"));if(m<0)return(0,s.failure)((0,o.notImplemented)(["Lotus 1-2-3 syntax"]));var h=null!==(l=null===(c=t.config)||void 0===c?void 0:c.localeInfo)&&void 0!==l?l:e.config.localeInfo,v=null!==(f=null===(d=t.config)||void 0===d?void 0:d.refStyle)&&void 0!==f?f:e.config.refStyle,g=e.config.mathpack,b=(0,n.tokenizeFormula)(h,g,v,t.originGridCell.value,r,m),S=(0,i.runFormulaParser)(h,g,v,t.lexicalKind,t.originGridCell.value,b);return(0,s.success)(S)}catch(e){return(0,s.failure)((0,s.javaScriptError)(e))}}(e,t,r)}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseUint=t.parseSignedLiteral=t.parseNumberLiteral=t.isSpace=void 0;var n=r(3);t.isSpace=n.literalParse.isSpace,t.parseNumberLiteral=n.literalParse.parseNumberLiteral,t.parseSignedLiteral=n.literalParse.parseSignedLiteral,t.parseUint=n.literalParse.parseUint},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFeatureGateDictionaryGetter=t.overrideTypedFeatureGates=t.isTypedChangeGateEnabled=t.getTypedFeatureGate=t.getFeatures=t.isFeatureEnabled=t.initFeatureConfiguration=t.FeatureName=void 0;var n=r(7);t.FeatureName=n.featureConfiguration.FeatureName,t.initFeatureConfiguration=n.featureConfiguration.initFeatureConfiguration,t.isFeatureEnabled=n.featureConfiguration.isFeatureEnabled,t.getFeatures=n.featureConfiguration.getFeatures,t.getTypedFeatureGate=n.featureConfiguration.getTypedFeatureGate,t.isTypedChangeGateEnabled=n.featureConfiguration.isTypedChangeGateEnabled;var i=r(41);Object.defineProperty(t,"overrideTypedFeatureGates",{enumerable:!0,get:function(){return i.overrideTypedFeatureGates}}),Object.defineProperty(t,"setFeatureGateDictionaryGetter",{enumerable:!0,get:function(){return i.setFeatureGateDictionaryGetter}})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.nameNode=t.missingRef=t.localNameUseAnnotation=t.localNameDeclAnnotation=t.literalNode=t.letVar=t.letNode=t.lambdaParam=t.lambdaNode=t.indexedArg=t.identQualifier=t.identNamePart=t.headNamePart=t.formulaSpan=t.formulaRootAnnotation=t.formula=t.flattenNameParts=t.flattenLetArgs=t.flattenLambdaArgs=t.fieldRefNode=t.fieldRefNamePart=t.fieldRef=t.errorQualifier=t.documentQualifier=t.commaOpRef=t.columnRef=t.cellRefSingle=t.cellRefRow=t.cellRefRange=t.cellRefNode=t.cellRefNamePart=t.cellRefError=t.cellRefCol=t.cellRefBad=t.badRef=t.badQualifier=t.badNode=t.arrayNode=t.appNode=t.appHeadNameAnnotation=t.StructRefKind=t.SpecialRefId=t.RefStyle=t.QualifierKind=t.PosKind=t.NodeKind=t.NamePartKind=t.CellRefKind=t.BadType=t.AnnotationKind=void 0,t.getDepthUpperBound=t.wsfNode=t.thisRowOpRef=t.structRefNode=t.structRef=t.specialRef=t.sheetRangeQualifier=t.sheetQualifier=t.relativeQualifier=t.rangeOpRef=t.pos=t.parenNode=t.paramNode=t.paramName=t.paramDefault=t.operatorNode=void 0;var n=r(3);t.AnnotationKind=n.formulaModule.AnnotationKind,t.BadType=n.formulaModule.BadType,t.CellRefKind=n.formulaModule.CellRefKind,t.NamePartKind=n.formulaModule.NamePartKind,t.NodeKind=n.formulaModule.NodeKind,t.PosKind=n.formulaModule.PosKind,t.QualifierKind=n.formulaModule.QualifierKind,t.RefStyle=n.formulaModule.RefStyle,t.SpecialRefId=n.formulaModule.SpecialRefId,t.StructRefKind=n.formulaModule.StructRefKind,t.appHeadNameAnnotation=n.formulaModule.appHeadNameAnnotation,t.appNode=n.formulaModule.appNode,t.arrayNode=n.formulaModule.arrayNode,t.badNode=n.formulaModule.badNode,t.badQualifier=n.formulaModule.badQualifier,t.badRef=n.formulaModule.badRef,t.cellRefBad=n.formulaModule.cellRefBad,t.cellRefCol=n.formulaModule.cellRefCol,t.cellRefError=n.formulaModule.cellRefError,t.cellRefNamePart=n.formulaModule.cellRefNamePart,t.cellRefNode=n.formulaModule.cellRefNode,t.cellRefRange=n.formulaModule.cellRefRange,t.cellRefRow=n.formulaModule.cellRefRow,t.cellRefSingle=n.formulaModule.cellRefSingle,t.columnRef=n.formulaModule.columnRef,t.commaOpRef=n.formulaModule.commaOpRef,t.documentQualifier=n.formulaModule.documentQualifier,t.errorQualifier=n.formulaModule.errorQualifier,t.fieldRef=n.formulaModule.fieldRef,t.fieldRefNamePart=n.formulaModule.fieldRefNamePart,t.fieldRefNode=n.formulaModule.fieldRefNode,t.flattenLambdaArgs=n.formulaModule.flattenLambdaArgs,t.flattenLetArgs=n.formulaModule.flattenLetArgs,t.flattenNameParts=n.formulaModule.flattenNameParts,t.formula=n.formulaModule.formula,t.formulaRootAnnotation=n.formulaModule.formulaRootAnnotation,t.formulaSpan=n.formulaModule.formulaSpan,t.headNamePart=n.formulaModule.headNamePart,t.identNamePart=n.formulaModule.identNamePart,t.identQualifier=n.formulaModule.identQualifier,t.indexedArg=n.formulaModule.indexedArg,t.lambdaNode=n.formulaModule.lambdaNode,t.lambdaParam=n.formulaModule.lambdaParam,t.letNode=n.formulaModule.letNode,t.letVar=n.formulaModule.letVar,t.literalNode=n.formulaModule.literalNode,t.localNameDeclAnnotation=n.formulaModule.localNameDeclAnnotation,t.localNameUseAnnotation=n.formulaModule.localNameUseAnnotation,t.missingRef=n.formulaModule.missingRef,t.nameNode=n.formulaModule.nameNode,t.operatorNode=n.formulaModule.operatorNode,t.paramDefault=n.formulaModule.paramDefault,t.paramName=n.formulaModule.paramName,t.paramNode=n.formulaModule.paramNode,t.parenNode=n.formulaModule.parenNode,t.pos=n.formulaModule.pos,t.rangeOpRef=n.formulaModule.rangeOpRef,t.relativeQualifier=n.formulaModule.relativeQualifier,t.sheetQualifier=n.formulaModule.sheetQualifier,t.sheetRangeQualifier=n.formulaModule.sheetRangeQualifier,t.specialRef=n.formulaModule.specialRef,t.structRef=n.formulaModule.structRef,t.structRefNode=n.formulaModule.structRefNode,t.thisRowOpRef=n.formulaModule.thisRowOpRef,t.wsfNode=n.formulaModule.wsfNode,t.getDepthUpperBound=n.formulaModule.getDepthUpperBound},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolvedUserDefinedFunc=t.resolvedStructRef=t.resolvedNever=t.resolvedName=t.resolvedLocalName=t.resolvedDottedName=t.resolvedCellRef=t.resolveLocalsGrid=t.noOriginSheet=t.invalidStructRef=t.invalidQualifier=t.invalidCellRef=t.emptyIntersection=t.ResolvedKind=t.ResolveReasonKind=t.InvalidStructRefReason=t.InvalidQualifierReason=t.InvalidCellRefReason=void 0;var n=r(3);t.InvalidCellRefReason=n.resolveServiceTypes.InvalidCellRefReason,t.InvalidQualifierReason=n.resolveServiceTypes.InvalidQualifierReason,t.InvalidStructRefReason=n.resolveServiceTypes.InvalidStructRefReason,t.ResolveReasonKind=n.resolveServiceTypes.ResolveReasonKind,t.ResolvedKind=n.resolveServiceTypes.ResolvedKind,t.emptyIntersection=n.resolveServiceTypes.emptyIntersection,t.invalidCellRef=n.resolveServiceTypes.invalidCellRef,t.invalidQualifier=n.resolveServiceTypes.invalidQualifier,t.invalidStructRef=n.resolveServiceTypes.invalidStructRef,t.noOriginSheet=n.resolveServiceTypes.noOriginSheet,t.resolveLocalsGrid=n.resolveServiceTypes.resolveLocalsGrid,t.resolvedCellRef=n.resolveServiceTypes.resolvedCellRef,t.resolvedDottedName=n.resolveServiceTypes.resolvedDottedName,t.resolvedLocalName=n.resolveServiceTypes.resolvedLocalName,t.resolvedName=n.resolveServiceTypes.resolvedName,t.resolvedNever=n.resolveServiceTypes.resolvedNever,t.resolvedStructRef=n.resolveServiceTypes.resolvedStructRef,t.resolvedUserDefinedFunc=n.resolveServiceTypes.resolvedUserDefinedFunc},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolveGridRef=t.createResolver=void 0;var n=r(3);t.createResolver=n.resolveService.createResolver,t.resolveGridRef=n.resolveService.resolveGridRef},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.zipVisitor=t.voidVisitor=t.visitWSFNode=t.visitQualifier=t.visitOperatorNode=t.visitFormulaNode=t.visitCellRef=t.visitAppHeadNode=t.reduceTopDown_Pledge=t.reducePledge=t.reduceBottomUp_Recursive=t.reduceBottomUp_Pledge=t.reduceBottomUp_MaxDepth=t.reduceBottomUp_CPS=t.reduceBottomUp=t.identityVisitor=t.depthVisitor=t.constVisitor=t.composeVisitor=t.bindVisitor=t.binaryVisitor=t.ZipVisitor=t.PledgeReducer=t.IdentityVisitor=t.DelegatingVisitor=t.ConstVisitor=t.ComposeVisitor=t.BinaryVisitor=void 0;var n=r(3);t.BinaryVisitor=n.visitor.BinaryVisitor,t.ComposeVisitor=n.visitor.ComposeVisitor,t.ConstVisitor=n.visitor.ConstVisitor,t.DelegatingVisitor=n.visitor.DelegatingVisitor,t.IdentityVisitor=n.visitor.IdentityVisitor,t.PledgeReducer=n.visitor.PledgeReducer,t.ZipVisitor=n.visitor.ZipVisitor,t.binaryVisitor=n.visitor.binaryVisitor,t.bindVisitor=n.visitor.bindVisitor,t.composeVisitor=n.visitor.composeVisitor,t.constVisitor=n.visitor.constVisitor,t.depthVisitor=n.visitor.depthVisitor,t.identityVisitor=n.visitor.identityVisitor,t.reduceBottomUp=n.visitor.reduceBottomUp,t.reduceBottomUp_CPS=n.visitor.reduceBottomUp_CPS,t.reduceBottomUp_MaxDepth=n.visitor.reduceBottomUp_MaxDepth,t.reduceBottomUp_Pledge=n.visitor.reduceBottomUp_Pledge,t.reduceBottomUp_Recursive=n.visitor.reduceBottomUp_Recursive,t.reducePledge=n.visitor.reducePledge,t.reduceTopDown_Pledge=n.visitor.reduceTopDown_Pledge,t.visitAppHeadNode=n.visitor.visitAppHeadNode,t.visitCellRef=n.visitor.visitCellRef,t.visitFormulaNode=n.visitor.visitFormulaNode,t.visitOperatorNode=n.visitor.visitOperatorNode,t.visitQualifier=n.visitor.visitQualifier,t.visitWSFNode=n.visitor.visitWSFNode,t.voidVisitor=n.visitor.voidVisitor,t.zipVisitor=n.visitor.zipVisitor},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Pledge=void 0;var n=r(7);t.Pledge=n.pledge.Pledge},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createNumberFormatter=void 0;var n=r(90),i=r(245),a=r(186),o=r(192),s=r(243),u=r(247),c=r(249);t.createNumberFormatter=function(e){return{createFormat:function(t,r){return(0,i.createFormat)(e,t,"boolean"!=typeof r?r:r?n.NumberFormatSource.Builtin:n.NumberFormatSource.CustomString)},applyFormat:function(t,r,n){return(0,i.applyFormat)(e,t,r,n)},changeFormatDecimals:i.changeFormatDecimals,renderValue:function(t,r){return(0,o.renderValue)(e.config.mathpack,t,r)},renderHashesValue:function(e,t){return(0,o.renderHashesValue)(e,t)},renderFormulaBar:function(t,r,n,i){return(0,u.renderFormulaBar)(this,e,t,r,n,i)},parseGeneral:function(t,r,n,i){return(0,c.parseGeneral)(e,t,r,n,i)},parseDate:function(t,r){return(0,c.parseDate)(e,t,r)},parseEdit:function(t,r){return(0,a.parseEdit)(e,t,r)},evalFormat:function(t,r){return(0,s.evalFormat)(e,t,r)}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.numberComponents=t.formatScientificLeft=void 0;var n=r(3);t.formatScientificLeft=n.mathpack.formatScientificLeft,t.numberComponents=n.mathpack.numberComponents},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.kindAnonymizers=t.anonymizeMagnitude=t.anonymizeFormulaString=t.anonymize=void 0;var n=r(7);t.anonymize=n.anonymizer.anonymize,t.anonymizeFormulaString=n.anonymizer.anonymizeFormulaString,t.anonymizeMagnitude=n.anonymizer.anonymizeMagnitude,t.kindAnonymizers=n.anonymizer.kindAnonymizers},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getRibbonFormat=t.RibbonFormat=void 0;var n,i=r(2),a=r(133),o=r(91),s=r(132);function u(e,t){return(0,s.buildSingle)(e,a.PictureSingle.ColorStart,"$-",t,a.PictureSingle.ColorEnd)}!function(e){e.GalleryGeneral="GalleryGeneral",e.GalleryNumber="GalleryNumber",e.GalleryCurrency="GalleryCurrency",e.GalleryAccounting="GalleryAccounting",e.GalleryShortDate="GalleryShortDate",e.GalleryLongDate="GalleryLongDate",e.GalleryTime="GalleryTime",e.GalleryPercentage="GalleryPercentage",e.GalleryFraction="GalleryFraction",e.GalleryScientific="GalleryScientific",e.GalleryText="GalleryText",e.ButtonComma="ButtonComma",e.ButtonPercentage="ButtonPercentage",e.ButtonAccounting="ButtonAccounting",e.KeyboardGeneral="KeyboardGeneral",e.KeyboardNumber="KeyboardNumber",e.KeyboardCurrency="KeyboardCurrency",e.KeyboardDate="KeyboardDate",e.KeyboardTime="KeyboardTime",e.KeyboardPercentage="KeyboardPercentage",e.KeyboardScientific="KeyboardScientific"}(n=t.RibbonFormat||(t.RibbonFormat={})),t.getRibbonFormat=function(e,t,r){var c,l,d=(null!==(l=null===(c=null==r?void 0:r.culture)||void 0===c?void 0:c.calendar)&&void 0!==l?l:o.Calendar.Gregorian)===o.Calendar.Gregorian;switch(t){case n.GalleryGeneral:case n.KeyboardGeneral:return(0,s.getKnownFormat)(e,o.KnownFormat.General);case n.GalleryNumber:return(0,s.buildNumberFormat)(e,!1,1,e.currencyDecimals);case n.KeyboardNumber:return(0,s.buildNumberFormat)(e,!0,4,e.currencyDecimals);case n.GalleryCurrency:var f=i.__assign(i.__assign({},e),{currencyFormat:e.currencyFormat===o.CurrencyFormat.Paren?o.CurrencyFormat.Lead:e.currencyFormat});return(0,s.buildCurrencyFormat)(f,!1,e.currencyDecimals,!0,!1,void 0,!0);case n.KeyboardCurrency:return(0,s.buildCurrencyFormat)(e,!0,e.currencyDecimals,!0,!1);case n.GalleryAccounting:case n.ButtonAccounting:return(0,s.buildCurrencyFormat)(e,!1,e.currencyDecimals,!0,!0);case n.GalleryShortDate:return d?(0,s.getKnownFormat)(e,o.KnownFormat.MMDDYY):(0,s.buildSingle)(e,a.PictureSingle.Month,a.PictureSingle.DateSep,a.PictureSingle.Day,a.PictureSingle.Sep,a.PictureSingle.Text);case n.GalleryLongDate:return d?u(e,"x-sysdate")+(0,s.buildSingle)(e,a.PictureSingle.Day,a.PictureSingle.Day,a.PictureSingle.Day,a.PictureSingle.Day,", ",a.PictureSingle.Month,a.PictureSingle.Month,a.PictureSingle.Month,a.PictureSingle.Month," ",a.PictureSingle.Day,a.PictureSingle.Day,", ",a.PictureSingle.Year,a.PictureSingle.Year,a.PictureSingle.Year,a.PictureSingle.Year):(0,s.buildSingle)(e,a.PictureSingle.Month,a.PictureSingle.DateSep,a.PictureSingle.Day,a.PictureSingle.DateSep,a.PictureSingle.Year,a.PictureSingle.Year,a.PictureSingle.Sep,a.PictureSingle.Text);case n.GalleryTime:return u(e,"x-systime")+(0,s.buildSingle)(e,a.PictureSingle.Hour,a.PictureSingle.Colon,a.PictureSingle.Minute,a.PictureSingle.Minute,a.PictureSingle.Colon,a.PictureSingle.Second,a.PictureSingle.Second," ")+(0,s.getSpecial)(e,a.PictureSpecial.AP1);case n.KeyboardDate:return u(e,"en-US")+(0,s.buildSingle)(e,a.PictureSingle.Day,"-",a.PictureSingle.Month,a.PictureSingle.Month,a.PictureSingle.Month,"-",a.PictureSingle.Year,a.PictureSingle.Year,a.PictureSingle.Sep,a.PictureSingle.Text);case n.KeyboardTime:return u(e,"en-US")+(0,s.buildSingle)(e,a.PictureSingle.Hour,a.PictureSingle.Colon,a.PictureSingle.Minute,a.PictureSingle.Minute," ",(0,s.getSpecial)(e,a.PictureSpecial.AP1),a.PictureSingle.Sep,a.PictureSingle.Text);case n.GalleryPercentage:return(0,s.buildPercentFormat)(e,e.currencyDecimals);case n.ButtonPercentage:case n.KeyboardPercentage:return(0,s.getKnownFormat)(e,o.KnownFormat.Pct0);case n.GalleryFraction:return(0,s.getKnownFormat)(e,o.KnownFormat.Fract);case n.GalleryScientific:case n.KeyboardScientific:return(0,s.buildScientificFormat)(e,1,e.currencyDecimals,2);case n.GalleryText:return(0,s.getKnownFormat)(e,o.KnownFormat.Text);case n.ButtonComma:return(0,s.buildCurrencyFormat)(e,!1,e.currencyDecimals,!1,!0)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.commonFormats=void 0,t.commonFormats=["#","##","###","########\\ \\ \\ \\ \\ \\ \\ \\ ","###,###","###\\ ###","###\\-##\\-####","##,###.##\\ \\ \\ ","#,###","#,###.#","#,###.##","#,###_)","#,###_)_ ","#.##","#.##%","#.#%","#;\\(\\ \\ @\\ \\ \\ \\)",'#"\\""\\""\\""\\"\\ ??/??',"#\\ ###",";;",";;;","@\\ ","\\ #######\\ \\ \\ \\ ","\\ \\ @","\\(###\\)\\ ###\\-####","\\(\\ ###\\ \\)\\ ###\\-####","\\:","__@","[$$]#,##0_);\\([$$]#,##0\\);[$$]#,##0_);@_)","[$$]#,##0.0_);\\([$$]#,##0.0\\);[$$]#,##0.0_);@_)","[$$-1009]#,##0.00","[$$-1009]#,##0;[Red]\\-[$$-1009]#,##0","[$$-409]#,##0","[$$-409]#,##0.00","[$$-409]#,##0.00_);\\([$$-409]#,##0.00\\)",'_([$$-409]* #,##0.00_);_([$$-409]* \\(#,##0.00\\);_([$$-409]* "-"??_);_(@_)',"[$$-409]#,##0.0000","[$$-409]#,##0.0000_);\\([$$-409]#,##0.0000\\)","[$$-409]#,##0.00_);[Red]\\([$$-409]#,##0.00\\)","[$$-409]#,##0;[Red][$$-409]#,##0","[$$-409]#,##0_);[Red]\\([$$-409]#,##0\\)","[$$-C09]#,##0.00","[$$-C09]#,##0.000","[$$-C09]#,##0.0000","[$$-C09]#,##0.00000","[$£-809]#,##0","[$£-809]#,##0.00","[$£-809]#,##0.00;[Red]\\-[$£-809]#,##0.00","[$£-809]#,##0;[Red][$£-809]#,##0","[$¥-411]#,##0","[$€-2]\\ #,##0.00","[$€-2]\\ #,##0.00_);[Red]\\([$€-2]\\ #,##0.00\\)","[$€-2]\\ #,##0_);[Red]\\([$€-2]\\ #,##0\\)",'"$"#,##0','"$"#,##0;\\("$"#,##0\\)','"$"#,##0;\\-"$"#,##0','"$"#,##0_);\\("$"#,##0\\)','"$"#,##0_);\\("$"#,##0\\);"-"??_)','"$"#,##0_);\\("$"#,##0\\);\\ \\-\\ ','"$"\\ #,##0;\\("$"\\ #,##0\\)',"\\$#,##0_);\\(\\$#,##0\\)",'_ "$"\\ * #,##0_ ;_ "$"\\ * \\-#,##0_ ;_ "$"\\ * "-"??_ ;_ @_ ','_ "$"\\ * #,##0_ ;_ "$"\\ * \\-#,##0_ ;_ "$"\\ * "-"_ ;_ @_ ','_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"??_);_(@_)','_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)','_("$"\\ * #,##0_);_("$"\\ * \\(#,##0\\);_("$"\\ * "-"_);_(@_)','_-"$"* #,##0_-;\\-"$"* #,##0_-;_-"$"* "-"_-;_-@_-','"$"#,##0_%_);\\("$"#,##0\\)_%;"$"#,##0_%_);@_%_)','"$"#,##0.0','"$"#.00','"$"0.0','"$"#,##0.0,_);\\("$"#,##0.0,\\)','"$"#,##0.0;\\("$"#,##0.0\\);','"$"#,##0.0_);\\("$"#,##0.0\\)','"$"\\ \\ \\ \\ \\ \\ \\ #,###.00_);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\(#,###.00\\);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\-','"$"\\ \\ \\ \\ \\ \\ \\ \\ #,###.00_);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\(#,###.00\\);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\-','"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ #,###.00_);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\(#,###.00\\);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\-','"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ #,###.00_);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\(#,###.00\\);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\-','"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ #,###.00_);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\(#,###.00\\);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\-','"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ #,###.00_);"$"\\ \\ \\ \\ \\ \\ \\ \\(#,###.00\\);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\-','_ "$"\\ * #,##0.0_ ;_ "$"\\ * \\-#,##0.0_ ;_ "$"\\ * "-"??_ ;_ @_ ','_("$"* #,##0.0_);_("$"* \\(#,##0.0\\);_("$"* "-"??_);_(@_)','_("$"* #,##0.0_);_("$"* \\(#,##0.0\\);_("$"* "-"?_);_(@_)','_("$"* #,##0.0_);_("$"* \\(#,##0.0\\);_("$"* "-"_);_(@_)','_-"$"* #,##0.0_-;\\-"$"* #,##0.0_-;_-"$"* "-"_-;_-@_-','"$"#,##0.0_%_);\\("$"#,##0.0\\)_%;"$"#,##0.0_%_);@_%_)','"$"#,##0.00','"$"#.000','"$"\\ #,##0.00','"$"#,##0.00,_);\\("$"#,##0.00,\\)','"$"#,##0.00;\\("$"#,##0.00\\)','"$"#,##0.00;\\-"$"#,##0.00','"$"#,##0.00_);\\("$"#,##0.00\\)','"$"\\ \\ \\ #,##0.00_);\\("$"\\ \\ \\ #,##0.00\\);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\-','_ "$"\\ * #,##0.00_ ;_ "$"\\ * \\-#,##0.00_ ;_ "$"\\ * "-"??_ ;_ @_ ','_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"????_);_(@_)','_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"???_);_(@_)','_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)','_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"_);_(@_)','_("$"\\ * #,##0.00_);_("$"\\ * \\(#,##0.00\\);_("$"\\ * "-"??_);_(@_)','_-"$"* #,##0.00_-;\\-"$"* #,##0.00_-;_-"$"* "-"??_-;_-@_-','"$"#,##0.00_%_);\\("$"#,##0.00\\)_%;"$"#,##0.00_%_);@_%_)','"$"#,##0.000','"$"0.000','"$"0000','"$"#,##0.000_);\\("$"#,##0.0\\)','"$"#,##0.000_);\\("$"#,##0.00\\)','"$"#,##0.000_);\\("$"#,##0.000\\)','_("$"* #,##0.000_);_("$"* \\(#,##0.000\\);_("$"* "-"???_);_(@_)','_("$"* #,##0.000_);_("$"* \\(#,##0.000\\);_("$"* "-"??_);_(@_)','_("$"* #,##0.000_);_("$"* \\(#,##0.000\\);_("$"* "-"_);_(@_)','"$"#,##0.0000','"$"0.0000','"$"#,##0.0000_);\\("$"#,##0.00\\)','"$"#,##0.0000_);\\("$"#,##0.0000\\)','_("$"* #,##0.0000_);_("$"* \\(#,##0.0000\\);_("$"* "-"????_);_(@_)','_("$"* #,##0.0000_);_("$"* \\(#,##0.0000\\);_("$"* "-"??_);_(@_)','_("$"* #,##0.0000_);_("$"* \\(#,##0.0000\\);_("$"* "-"_);_(@_)','"$"#,##0.00000','"$"#,##0.00000_);\\("$"#,##0.000\\)','"$"#,##0.00000_);\\("$"#,##0.00000\\)','_("$"* #,##0.00000_);_("$"* \\(#,##0.00000\\);_("$"* "-"?????_);_(@_)','_("$"* #,##0.00000_);_("$"* \\(#,##0.00000\\);_("$"* "-"??_);_(@_)','_("$"* #,##0.00000_);_("$"* \\(#,##0.00000\\);_("$"* "-"_);_(@_)','"$"#,##0.000000','"$"#,##0.000000_);\\("$"#,##0.000000\\)','_("$"* #,##0.000000_);_("$"* \\(#,##0.000000\\);_("$"* "-"??????_);_(@_)','_("$"* #,##0.000000_);_("$"* \\(#,##0.000000\\);_("$"* "-"??_);_(@_)','_("$"* #,##0.000000_);_("$"* \\(#,##0.000000\\);_("$"* "-"_);_(@_)','"$"#,##0.0000000','"$"#,##0.0000000_);\\("$"#,##0.0000000\\)','_("$"* #,##0.0000000_);_("$"* \\(#,##0.0000000\\);_("$"* "-"??_);_(@_)','_("$"* #,##0.0000000_);_("$"* \\(#,##0.0000000\\);_("$"* "-"_);_(@_)','"$"#,##0.00000000','"$"#,##0.00000000_);\\("$"#,##0.00000000\\)','_("$"* #,##0.00000000_);_("$"* \\(#,##0.00000000\\);_("$"* "-"??_);_(@_)','"$"#,##0.000000000_);\\("$"#,##0.000000000\\)','_("$"* #,##0.000000000_);_("$"* \\(#,##0.000000000\\);_("$"* "-"??_);_(@_)','"$"#,##0.0000000000_);\\("$"#,##0.0000000000\\)','"$"#,##0.0000000;[Red]\\-"$"#,##0.0000000','"$"#,##0.0000000_);[Red]\\("$"#,##0.0000000\\)','"$"#,##0.000000_);[Red]\\("$"#,##0.000000\\)','"$"#,##0.000000_);[Red]\\("$"#,##0.000000\\);"- "_)','"$"#,##0.00000;[Red]\\-"$"#,##0.00000','"$"#,##0.00000_);[Red]\\("$"#,##0.00000\\)','"$"#,##0.0000;[Red]\\-"$"#,##0.0000','"$"#,##0.0000_);[Red]\\("$"#,##0.0000\\)','"$"#,##0.0000_);[Red]\\("$"#,##0.0000\\);"- "_)','"$"#,##0.000" /GJ"','"$"#,##0.000_);[Red]\\("$"#,##0.000\\)','"$"#,##0.00" /GJ"','"$"#,##0.00" /mmbtu"','"$"#,##0.00" /MWh"','"$"#,##0.00;[Red]"$"#,##0.00','"$"#,##0.00;[Red]\\-"$"#,##0.00','"$"#,##0.00_);[Red]\\("$"#,##0.00\\)','"$"#,##0.00_);[Red]\\("$"#,##0.00\\);','"$"#,##0.00_);[Red]\\("$"#,##0.00\\);"- "_)','"$"#,##0.00_);[Red]\\("$"#,##0.00\\);"-"','"$"* #,##0.00;[Red]\\ \\("$"* #,##0.00\\)','"$"\\ #,##0.00;[Red]"$"\\ \\-#,##0.00','"$"\\ #,##0.00_);[Red]\\("$"\\ #,##0.00\\)','"$"\\ \\ #,##0.00_);[Red]\\("$"\\ \\ #,##0.00\\)',"\\$#,##0.00;[Red]\\$\\(#,##0.00\\);\\-",'"$"0.0"MM"','"$"#,##0.0;[Red]\\("$"#,##0.0\\)','"$"#,##0.0;[Red]\\-"$"#,##0.0','"$"#,##0.0_);[Red]\\("$"#,##0.0\\)','"$"#,##0.0_);[Red]\\("$"#,##0.0\\);','"$"#,##0.0_);[Red]\\("$"#,##0.0\\);"- "_)','"$"\\ \\ #,##0.0_);[Red]\\("$"\\ \\ #,##0.0\\)','"$"0" / kW"','"$"0"MM"','"$"#,##0\\ "/MW"','"$"#,##0\\ "/MWh"','"$"#,##0\\ "/MWH"','"$"#,##0;[Red]"$"#,##0','"$"#,##0;[Red]\\-"$"#,##0','"$"#,##0_);[Red]\\("$"#,##0\\)','"$"#,##0_);[Red]\\("$"#,##0\\);"- "_)','"$"#,##0_);[Red]\\<"$"#,##0\\>','"$"\\ #,##0;[Red]\\-"$"\\ #,##0','"$"\\ #,##0_);[Red]\\("$"\\ #,##0\\)','"$"\\ \\ #,##0_);[Red]\\("$"\\ \\ #,##0\\)','"$"\\ \\ \\ #,##0_);[Red]"$"\\ \\ \\ \\(#,##0\\);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\-','"$"\\ \\ \\ #,##0_);[Red]"$"\\ \\ \\ \\(#,##0\\);"$"\\ \\ \\ \\ \\ \\ \\ \\ \\ \\-','_("$"* #,##0_);[Red]_("$"* \\(#,##0\\);_("$"* "-"??_);_(@_)','_("$"* #,##0_);[Red]_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',"[$CAD]\\ #,##0.000","[$CAD]\\ #,##0.000_);\\([$CAD]\\ #,##0.000\\)","[$R$ -416]#,##0_);\\([$R$ -416]#,##0\\)","[$R$ -416]#,##0.00_);\\([$R$ -416]#,##0.00\\)","[$R$-416]#,##0.0000_);[Red]\\([$R$-416]#,##0.0000\\)","[$R$-416]#,##0.000_);[Red]\\([$R$-416]#,##0.000\\)","[$R$-416]#,##0.00_);[Red]\\([$R$-416]#,##0.00\\)","[$R$-416]#,##0_);[Red]\\([$R$-416]#,##0\\)",'"£"#,##0','"£"#,##0;\\-"£"#,##0',"\\£#,##0_);\\(\\£#,##0\\)",'_ "£"* #,##0_ ;_ "£"* \\-#,##0_ ;_ "£"* "-"_ ;_ @_ ','_("£"* #,##0_);_("£"* \\(#,##0\\);_("£"* "-"_);_(@_)','_-"£"* #,##0_-;\\-"£"* #,##0_-;_-"£"* "-"_-;_-@_-','"£"#,##0.0',"\\£#,##0.0_);\\(\\£#,##0.0\\)",'"£"#,##0.00','"£"#,##0.00;\\-"£"#,##0.00',"\\£#,##0.00_);\\(\\£#,##0.00\\)",'_ "£"* #,##0.00_ ;_ "£"* \\-#,##0.00_ ;_ "£"* "-"??_ ;_ @_ ','_("£"* #,##0.00_);_("£"* \\(#,##0.00\\);_("£"* "-"??_);_(@_)','_-"£"* #,##0.00_-;\\-"£"* #,##0.00_-;_-"£"* "-"??_-;_-@_-',"\\£#,##0.000_);\\(\\£#,##0.000\\)","\\£#,##0.0000_);\\(\\£#,##0.0000\\)",'_-"£"* #,##0.0000_-;\\-"£"* #,##0.0000_-;_-"£"* "-"??_-;_-@_-','"£"#,##0.00;[Red]\\-"£"#,##0.00','"£"#,##0.00_);[Red]\\("£"#,##0.00\\)',"\\£#,##0.00_);[Red]\\(\\£#,##0.00\\)","\\£#,##0.0_);[Red]\\(\\£#,##0.0\\)",'"£"#,##0;[Red]\\-"£"#,##0','"£"#,##0_);[Red]\\("£"#,##0\\)',"\\£#,##0_);[Red]\\(\\£#,##0\\)","###\\ ###\\ ###\\ ###.0","###0","#,###.0#","#,###_);\\(#,##0\\);\\ \\-_ ","#,###___);\\(#,##0\\);\\ \\-\\ __","#,##0.##","#,##0.####","#,##0_)","#.0%","#0",'"#"\\ 0',"\\(0\\)",'0%;_("-"\\)',"0%\\ \\ ","0.",'0"  "',"0_)","0_;",'0" $/MWh"','#,##0"£"_);\\(#,##0"£"\\)','_ * #,##0_)"£"_ ;_ * \\(#,##0\\)"£"_ ;_ * "-"_)"£"_ ;_ @_ ','_ * #,##0_)_£_ ;_ * \\(#,##0\\)_£_ ;_ * "-"_)_£_ ;_ @_ ','#,##0"£"_);[Red]\\(#,##0"£"\\)',"#,###.00###","#,###.00###\\ \\ \\ ","#,##0.;\\-#,##0.","#,##0.0","#,##0.0___;","#,##0;\\(#,##0\\)","#,##0;\\(#,##0\\);\\-\\-","#,##0;\\-#,##0",'#,##0;\\-#,##0;"-"',"#,##0\\ ;\\(#,##0\\)","#,##0_ ;\\-#,##0\\ ","#,##0_ \\ ;\\(#,##0\\ \\ \\)","#,##0_);\\(#,##0\\);",'#,##0_);\\(#,##0\\);\\ "  -"',"#,##0_);\\(#,##0\\);\\ \\-\\ ","#,##0_);\\(#,##0\\);\\ \\-\\ \\ ","#,##0_);\\(#,##0\\);\\ \\-\\ \\ \\ \\ ","#,##0_);\\(#,##0\\);\\-","#,##0_);\\(#,##0\\);\\-\\ \\ ","#,##0_);\\(#,##0\\);\\-_)","#,##0_);\\(#,##0\\);\\-_)_ _ ","#,##0_);\\(#,##0\\);_ \\-\\ \\ ","#,##0_);\\(#,##0\\)\\ ;\\-_)_ _ ","#,##0_);\\(#,##0\\)\\-","#,##0_)_ ;\\(#,##0\\)\\ ;\\ \\-_ _)","#,##0_)_ ;\\(#,##0\\)\\ ;\\-_)_ _ ","#,##0___);\\(#,##0\\);\\ \\-\\ __","#,##0___);\\(#,##0\\);\\ \\-__\\ \\ ","#,##0___);\\(#,##0\\);___-\\ \\ ","#,##0___);\\(#,##0\\)_;\\ \\-__\\ \\ ","#,##0___);\\(#,##0\\)___;\\ \\-__\\ \\ ","#,##0_____);\\(#,##0\\);_____-\\ \\ ","#,##0_________);\\(#,##0\\);_________-\\ \\ ","#,#00",".00",'"**"_(* #,##0_);_(* \\(#,##0\\);_(* "-"??_);_(@_)','"*"_(* #,##0_);_(* \\(#,##0\\);_(* "-"??_);_(@_)','"\\"#,##0;"\\""\\""\\""\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;"\\""\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;"\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;"\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;"\\""\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;"\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;\\-"\\"#,##0',"\\(#,##0_)\\);\\(#,##0\\)",'_ * #,##0_ ;_ * "\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0_ ;_ * "-"_ ;_ @_ ','_ * #,##0_ ;_ * "\\""\\""\\""\\""\\""\\""\\"\\-#,##0_ ;_ * "-"_ ;_ @_ ','_ * #,##0_ ;_ * "\\""\\""\\""\\""\\""\\"\\-#,##0_ ;_ * "-"_ ;_ @_ ','_ * #,##0_ ;_ * "\\""\\""\\""\\""\\"\\-#,##0_ ;_ * "-"_ ;_ @_ ','_ * #,##0_ ;_ * "\\""\\""\\""\\"\\-#,##0_ ;_ * "-"_ ;_ @_ ','_ * #,##0_ ;_ * "\\""\\"\\-#,##0_ ;_ * "-"_ ;_ @_ ','_ * #,##0_ ;_ * \\-#,##0_ ;_ * "-"??_ ;_ @_ ','_ * #,##0_ ;_ * \\-#,##0_ ;_ * "-"_ ;_ @_ ','_ "\\"* #,##0_ ;_ "\\"* "\\""\\""\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0_ ;_ "\\"* "-"_ ;_ @_ ','_ "\\"* #,##0_ ;_ "\\"* "\\""\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0_ ;_ "\\"* "-"_ ;_ @_ ','_ "\\"* #,##0_ ;_ "\\"* "\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0_ ;_ "\\"* "-"_ ;_ @_ ','_ "\\"* #,##0_ ;_ "\\"* "\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0_ ;_ "\\"* "-"_ ;_ @_ ','_ "\\"* #,##0_ ;_ "\\"* "\\""\\""\\""\\""\\""\\""\\"\\-#,##0_ ;_ "\\"* "-"_ ;_ @_ ','_ "\\"* #,##0_ ;_ "\\"* "\\""\\""\\""\\""\\""\\"\\-#,##0_ ;_ "\\"* "-"_ ;_ @_ ','_ "\\"* #,##0_ ;_ "\\"* "\\""\\""\\""\\""\\"\\-#,##0_ ;_ "\\"* "-"_ ;_ @_ ','_ "\\"* #,##0_ ;_ "\\"* "\\""\\""\\""\\"\\-#,##0_ ;_ "\\"* "-"_ ;_ @_ ','_ "\\"* #,##0_ ;_ "\\"* "\\""\\"\\-#,##0_ ;_ "\\"* "-"_ ;_ @_ ','_ "\\"* #,##0_ ;_ "\\"* \\-#,##0_ ;_ "\\"* "-"_ ;_ @_ ',"_##,##0_);\\(#,##0\\);\\-_)_ _ ","_##,##0_);\\(#,##0\\)\\ ;\\-_)_ _ ","_(##0_);\\(##0\\)_ ;\\-_)_ _ ",'_(#,##0_);\\(#,##0\\);"-    "','_(* #,##0_);_(* \\(#,##0\\);_(* "-"???_);_(@_)','_(* #,##0_);_(* \\(#,##0\\);_(* "-"??_);_(@_)','_(* #,##0_);_(* \\(#,##0\\);_(* "-"?_);_(@_)','_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)','_(* #,##0_);_(* \\(#,##0\\);_(* ""??_);_(@_)','_-* #,##0_-;\\-* #,##0_-;_-* "-"??_-;_-@_-','_-* #,##0_-;\\-* #,##0_-;_-* "-"_-;_-@_-','_-* #,##0_-;_-* #,##0\\-;_-* "-"??_-;_-@_-','_-"\\"* #,##0_-;\\-"\\"* #,##0_-;_-"\\"* "-"_-;_-@_-',"0%\\-0%","0.0","0.0%",'0.0%;_(* "-"_)','0.0%;_("-"\\)','0.0%;_("-"_)','0.0%;_(\\ "-"_)',"0.0%\\ \\)",'0.0%\\-;_("-"_)','0.0"  "','0.0"%"','0.0_ "  "',"0.0_)","0.0_;","0.0____","0;\\-0;","0;\\-0;;","0;\\-0;;@\\ ","0_ ;\\-0\\ ","0_);\\(0\\)","00","###0_%_);\\(#,##0\\)_%;#,##0_%_);@_%_)","#,###.0_);\\(#,##0.0\\);\\ \\-\\ _ ","#,##0.00#","#,##0.00###","#,##0.00__;","#,##0_%_);\\(#,##0\\)_%;#,##0_%_);@_%_)","#,##0_);\\(#,##0\\);#,##0_);@_)",'"@ "\\&0.00%','"@ "0.00%','_(* #,##0_);_(* \\(#,##0\\);_(* "0"??_);_(@_)',"0%_);\\(0%\\);0%_);@_%_)","0.00#%",'0.00%;_(* "-"_)','0.00%;_("-"\\)',"0.00;;",'0.00"  "',"0.00_)","0_%_);\\(0\\)_%;0_%_);@_%_)","000","000#",'#,##0.00" $";\\-#,##0.00" $"',"#,##0.00\\ [$DM-407]","#,##0.00\\ [$EUR-407]",'#,##0.00" $";[Red]\\-#,##0.00" $"','#,##0.00"£"_);\\(#,##0.00"£"\\)','_ * #,##0.00_)"£"_ ;_ * \\(#,##0.00\\)"£"_ ;_ * "-"??_)"£"_ ;_ @_ ','_ * #,##0.00_)_£_ ;_ * \\(#,##0.00\\)_£_ ;_ * "-"??_)_£_ ;_ @_ ','#,##0.00"£"_);[Red]\\(#,##0.00"£"\\)',"##0.000","#,##0.0%_);\\(#,##0.0%\\);","#,##0.0_);\\(#,##0.0\\)","#,##0.0_);\\(#,##0.0\\);\\ \\-\\ \\ ","#,##0.0_);\\(#,##0.0\\);_ \\ \\-","#,##0.0____\\);\\(#,##0.0\\);___ \\-\\ \\ ","#,##0.0_______);\\(#,##0.0\\);______\\ \\-\\ \\ ","#,##0.0________\\);\\(#,##0.0\\);_______ \\-\\ \\ ","#,##0.0________\\);\\(#,##0.0\\);________\\ \\-\\ \\ ","#,##0.0_________);\\(#,##0.0\\);\\ \\-\\ \\ ","#,##0.0_________);\\(#,##0.0\\);________\\ \\-\\ \\ ","#,##0.000","#,##0.000___;",".0000",".0000%",'_(* #,##0.0_);_(* \\(#,##0.0\\);_(* "-"??_);_(@_)','_(* #,##0.0_);_(* \\(#,##0.0\\);_(* "-"?_);_(@_)','_(* #,##0.0_);_(* \\(#,##0.0\\);_(* "-"_);_(@_)','_-* #,##0.0_-;\\-* #,##0.0_-;_-* "-"??_-;_-@_-','_-* #,##0.0_-;\\-* #,##0.0_-;_-* "-"_-;_-@_-',"0.0%;\\(0.0\\)%;\\ \\-\\ \\ ",'0.0%;\\-0.0%;\\ "-"_%;@_%',"0.0%\\ ;\\(0.0\\)%\\ ;\\-\\ \\ \\ ","0.0%\\);\\(0.0\\)%;\\ \\-","0.0%_);\\(0.0%\\)","0.0%_);\\(0.0\\)%;\\ \\-","0.0%_;\\(0.0\\)%;\\ \\-\\ \\ \\ ","0.0_%;\\(0.0\\)%;\\ \\-\\ \\ \\ ","0.0_);\\(0.0\\)","0.000","0.000%",'0.000%;_("-"\\)',"0.000_)","0.000_;","0000","##0.000\\ \\¢","#,##0.00_);\\(#,##0.0\\)","#,##0.0000","#,##0.0000___;","0.0000","0.0000%",'0.0000%;_(* "-"_)','0.0000%;_("-"\\)','0.0000"  "',"0.0000\\ %","0.0000_)","00\\-000","00\\-000_)","00000","###0.00_);\\(#,##0.00\\)","#,##0.0%_);\\(#,##0.0%\\);0.0%_);@_%_)","#,##0.0_%_);\\(#,##0.0\\)_%;#,##0.0_%_);@_%_)","#,##0.0_);\\(#,##0.0\\);#,##0.0_);@_)","#,##0.00%_);\\(#,##0.00%\\)","#,##0.00;#,##0.00;","#,##0.00;\\(#,##0.00\\)","#,##0.00;\\(#,##0.00\\);\\-\\-","#,##0.00_);\\(#,##0.00\\);\\ \\-\\ ","#,##0.00_);\\(#,##0.00\\);\\-","#,##0.00_);\\(#,##0.00\\);\\-\\ \\ ","#,##0.00_);\\(#,##0.00\\);_ \\ \\-","#,##0.00_);\\(#,##0.00\\);_ \\-\\ \\ ","#,##0.00__\\);\\(#,##0.00\\);__\\ \\ \\-","#,##0.00___);\\(#,##0.00\\);___ \\ \\-","#,##0.00___);\\(#,##0.00_);\\ \\-\\ \\ \\ ","#,##0.00000","#,##0.00000___;",'"\\"#,##0.00;"\\""\\""\\""\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;"\\""\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;"\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;"\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;"\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;"\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;"\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;"\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;"\\"\\-#,##0.00','"\\"#,##0.00;\\-"\\"#,##0.00','_ * #,##0.00_ ;_ * "\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00_ ;_ * "-"??_ ;_ @_ ','_ * #,##0.00_ ;_ * "\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00_ ;_ * "-"??_ ;_ @_ ','_ * #,##0.00_ ;_ * "\\""\\""\\""\\""\\""\\"\\-#,##0.00_ ;_ * "-"??_ ;_ @_ ','_ * #,##0.00_ ;_ * "\\""\\""\\""\\""\\"\\-#,##0.00_ ;_ * "-"??_ ;_ @_ ','_ * #,##0.00_ ;_ * "\\""\\""\\""\\"\\-#,##0.00_ ;_ * "-"??_ ;_ @_ ','_ * #,##0.00_ ;_ * \\-#,##0.00_ ;_ * "-"??_ ;_ @_ ','_ "\\"* #,##0.00_ ;_ "\\"* "\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00_ ;_ "\\"* "-"??_ ;_ @_ ','_ "\\"* #,##0.00_ ;_ "\\"* "\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00_ ;_ "\\"* "-"??_ ;_ @_ ','_ "\\"* #,##0.00_ ;_ "\\"* "\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00_ ;_ "\\"* "-"??_ ;_ @_ ','_ "\\"* #,##0.00_ ;_ "\\"* "\\""\\""\\""\\""\\""\\"\\-#,##0.00_ ;_ "\\"* "-"??_ ;_ @_ ','_ "\\"* #,##0.00_ ;_ "\\"* "\\""\\""\\""\\""\\"\\-#,##0.00_ ;_ "\\"* "-"??_ ;_ @_ ','_ "\\"* #,##0.00_ ;_ "\\"* "\\""\\""\\""\\"\\-#,##0.00_ ;_ "\\"* "-"??_ ;_ @_ ','_ "\\"* #,##0.00_ ;_ "\\"* "\\""\\"\\-#,##0.00_ ;_ "\\"* "-"??_ ;_ @_ ','_ "\\"* #,##0.00_ ;_ "\\"* "\\"\\-#,##0.00_ ;_ "\\"* "-"??_ ;_ @_ ','_ "\\"* #,##0.00_ ;_ "\\"* \\-#,##0.00_ ;_ "\\"* "-"??_ ;_ @_ ','_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"????_);_(@_)','_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)','_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"?_);_(@_)','_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"_);_(@_)','_-* #,##0.00_-;\\-* #,##0.00_-;_-* "-"??_-;_-@_-','_-* #,##0.00_-;\\-* #,##0.00_-;_-* "-"_-;_-@_-','_-* #,##0.00_-;_-* #,##0.00\\-;_-* "-"??_-;_-@_-','_-"\\"* #,##0.00_-;\\-"\\"* #,##0.00_-;_-"\\"* "-"??_-;_-@_-',"0.0%_);\\(0.0%\\);0.0%_);@_%_)","0.0\\%_);\\(0.0\\%\\);0.0\\%_);@_%_)","0.00%_);\\(0.00%\\)","0.00;\\-0.00;","0.00_);\\(0.00\\)","0.00000","0.00000%",'0.00000"  "',"0.00000_)","000000","#,###.000_);\\(#,##0.000\\);\\ \\-\\ _ ","#,##0.000000","0.000000","0.000000%","0.000000_)","#,##0.000;\\(#,##0.000\\)","#,##0.000;\\(#,##0.000\\);\\-\\-","#,##0.000_);\\(#,##0.000\\)","#,##0.000_);\\(#,##0.000\\);\\ \\-\\ \\ ","#,##0.000_);\\(#,##0.000\\);\\-","#,##0.000_);\\(#,##0.000\\);_ \\-\\ \\ ","#,##0.0000000",'_(* #,##0.000_);_(* \\(#,##0.000\\);_(* "-"???_);_(@_)','_(* #,##0.000_);_(* \\(#,##0.000\\);_(* "-"??_);_(@_)','_(* #,##0.000_);_(* \\(#,##0.000\\);_(* "-"?_);_(@_)','_(* #,##0.000_);_(* \\(#,##0.000\\);_(* "-"_);_(@_)','_-* #,##0.000_-;\\-* #,##0.000_-;_-* "-"??_-;_-@_-',"_00000000","0.000_);\\(0.000\\)","0.0000000","0.0000000%","0.0000000_)","0000\\ \\-\\ 0000","00000000","#,###.0000_);\\(#,##0.0000\\);\\ \\-\\ _ ","#,##0.00_%_);\\(#,##0.00\\)_%;#,##0.00_%_);@_%_)","#,##0.00000000","0.00%_);\\(0.00%\\);0.00%_);@_%_)","0.00000000","0.00000000%","0.00000000_)","000\\-00\\-0000","000000000","#,##0.0000;\\(#,##0.0000\\)","#,##0.0000;\\-#,##0.0000","#,##0.0000_);\\(#,##0.0000\\)","#,##0.0000_);\\(#,##0.0000\\);_ \\-\\ \\ ","#,##0.0000_);\\(#,##0.0000_)","#,##0.0000___);\\(#,##0.0000_);\\ \\-\\ \\ \\ ","#,##0.000000000","\\(000\\)000\\-0000",'_(* #,##0.0000_);_(* \\(#,##0.0000\\);_(* "-"????_);_(@_)','_(* #,##0.0000_);_(* \\(#,##0.0000\\);_(* "-"??_);_(@_)','_(* #,##0.0000_);_(* \\(#,##0.0000\\);_(* "-"?_);_(@_)','_(* #,##0.0000_);_(* \\(#,##0.0000\\);_(* "-"_);_(@_)','_-* #,##0.0000_-;\\-* #,##0.0000_-;_-* "-"??_-;_-@_-',"0.0000_);\\(0.0000\\)","0.000000000","0.000000000%","0.000000000_)","0000000000","#,###.00000_);\\(#,##0.00000\\);\\ \\-\\ _ ","#,##0.0000000000","0.0000000000","0.0000000000_)","#,##0.00000_);\\(#,##0.00000\\)","#,##0.00000000000",'_(* #,##0.00000_);_(* \\(#,##0.00000\\);_(* "-"?????_);_(@_)','_(* #,##0.00000_);_(* \\(#,##0.00000\\);_(* "-"??_);_(@_)','_(* #,##0.00000_);_(* \\(#,##0.00000\\);_(* "-"_);_(@_)','_-* #,##0.00000_-;\\-* #,##0.00000_-;_-* "-"??_-;_-@_-',"0.00000_);\\(0.00000\\)","0.00000000000","0.00000000000_)","#,###.000000_);\\(#,##0.000000\\);\\ \\-\\ _ ","0.000000000000","#,##0.000000_);\\(#,##0.000000\\)",'_(* #,##0.000000_);_(* \\(#,##0.000000\\);_(* "-"??_);_(@_)','0.000000%;\\-0.000000%;\\ "-"_%;@_%',"0.0000000000000","0.0000000000000_)","0.00000000000000%","#,##0.0000000_);\\(#,##0.0000000\\)",'_(* #,##0.0000000_);_(* \\(#,##0.0000000\\);_(* "-"??_);_(@_)',"0.0000000_);\\(0.0000000\\)","0.000000000000000%","0.0000000000000000","#,##0.00000000_);\\(#,##0.00000000\\)",'_(* #,##0.00000000_);_(* \\(#,##0.00000000\\);_(* "-"??_);_(@_)',"0.00000000000000000","0.00000000000000000%","0.000000000000000000","0.000000000000000000%","#,##0.000000000_);\\(#,##0.000000000\\)",'_(* #,##0.000000000_);_(* \\(#,##0.000000000\\);_(* "-"??_);_(@_)',"#,##0.00000000000000000000","#,##0.0000000000_);\\(#,##0.0000000000\\)",'_(* #,##0.0000000000_);_(* \\(#,##0.0000000000\\);_(* "-"_);_(@_)',"0.0000000000000000000000","0.0000000000000000000000%",'_(* #,##0.000000000000_);_(* \\(#,##0.000000000000\\);_(* "-"_);_(@_)',"0.0000000000000000000000000","0.00000000000000000000000000",'_(* #,##0.0000000000000_);_(* \\(#,##0.0000000000000\\);_(* "-"_);_(@_)',"0.000000000000000000000000000","0.0000000000000000000000000000",'_(* #,##0.00000000000000_);_(* \\(#,##0.00000000000000\\);_(* "-"??_);_(@_)','_(* #,##0.00000000000000_);_(* \\(#,##0.00000000000000\\);_(* "-"_);_(@_)',"0.000000000000000000000000000000","0.00000000000000000000000000000000","#,##0.0000000000000000_);\\(#,##0.0000000000000000\\)","0.000000000000000000000000000000000","0.0000000000000000000000000000000000","0.00000000000000000000000000000000000","#,##0.00000000000000000000_);[Red]\\(#,##0.00000000000000000000\\)","#,##0.0000000000000_);[Red]\\(#,##0.0000000000000\\)","#,##0.000000000000_);[Red]\\(#,##0.000000000000\\)","#,##0.00000000000_);[Red]\\(#,##0.00000000000\\)","#,##0.0000000000_);[Red]\\(#,##0.0000000000\\)","#,##0.00000000_);[Red]\\(#,##0.00000000\\)","#,##0.0000000_);[Red]\\(#,##0.0000000\\)","#,##0.000000_);[Red]\\(#,##0.000000\\)","0.000000\\x_);\\(0.000000\\x\\)","0.00000E+00","#,##0.00000_);[Red]\\(#,##0.00000\\)","0.00000_);[Red]\\(0.00000\\)","0.0000E+00","###0.0000_);[Red]\\(###0.0000\\)","#,##0.0000\\ ;[Red]\\(#,##0.0000\\)","#,##0.0000_ ;[Red]\\-#,##0.0000\\ ","#,##0.0000_);[Red]\\(#,##0.0000\\)","0.0000%;[Red]\\-0.0000%","0.0000%\\ ;[Red]\\(0.0000%\\)","0.0000;[Red]0.0000","0.0000_ ;[Red]\\-0.0000\\ ","0.0000_);[Red]\\(0.0000\\)","0.0000\\x_);\\(0.0000\\x\\)","0.000E+00","0.000E+00_)",'0.000" MWh/GJ"',"###0.000_);[Red]\\(###0.000\\)","#,##0.000;[Red]\\(#,##0.000\\)","#,##0.000;[Red]\\(#,##0.000\\);\\-","#,##0.000\\ ;[Red]\\(#,##0.000\\)","#,##0.000_);[Red]\\(#,##0.000\\)","0.000;[Red]0.000","0.000_);[Red]\\(0.000\\)","0.000_);[Red]\\-0.000_)","#,##0.0_%_);\\(#,##0.0\\)_%;[White]#,##0.0_%_);@_%_)",'0.00%" Capitalization Rate"','0.00%" Discount Rate"','_-* #,##0.00\\ "DM"_-;\\-* #,##0.00\\ "DM"_-;_-* "-"??\\ "DM"_-;_-@_-','_-* #,##0.00\\ _D_M_-;\\-* #,##0.00\\ _D_M_-;_-* "-"??\\ _D_M_-;_-@_-','#,##0.00" F"_);\\(#,##0.00" F"\\)','_-* #,##0.00\\ "F"_-;\\-* #,##0.00\\ "F"_-;_-* "-"??\\ "F"_-;_-@_-','_-* #,##0.00\\ _F_-;\\-* #,##0.00\\ _F_-;_-* "-"??\\ _F_-;_-@_-','0.00" GJ//MWh"','0.00" GJ/MWh"','0.00\\ "MW"','0.00%" of Avg LTD"','0.00%" of Sales"','0.00%" perpetual annual growth"','_-* #,##0.00\\ "Pts"_-;\\-* #,##0.00\\ "Pts"_-;_-* "-"??\\ "Pts"_-;_-@_-','_-* #,##0.00\\ _P_t_s_-;\\-* #,##0.00\\ _P_t_s_-;_-* "-"??\\ _P_t_s_-;_-@_-',"###0.00_);[Red]\\(###0.00\\)","#,##0.00%_);[Red]\\(#,##0.00%\\)","#,##0.00;[Red]#,##0.00",'#,##0.00;[Red]"-"#,##0.00',"#,##0.00;[Red]\\(#,##0.00\\)","#,##0.00;[Red]\\(#,##0.00\\);\\-","#,##0.00\\ ;[Red]\\(#,##0.00\\)","#,##0.00\\ \\);[Red]\\(#,##0.00\\)","#,##0.00_ ;[Red]\\-#,##0.00\\ ",'#,##0.00_);[Red]\\(#,##0.00\\);"-"','"\\"#,##0.00;[Red]"\\""\\""\\""\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;[Red]"\\""\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;[Red]"\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;[Red]"\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;[Red]"\\""\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;[Red]"\\""\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;[Red]"\\""\\""\\""\\""\\"\\-#,##0.00','"\\"#,##0.00;[Red]"\\"\\-#,##0.00','"\\"#,##0.00;[Red]\\-"\\"#,##0.00','_(* #,##0.00_);[Red]_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',"0.00%;[Red]\\(0.00%\\)","0.00%\\ ;[Red]\\(0.00%\\)","0.00%\\ ;[Red]\\(0.00%\\);\\-","0.00;[Red]0.00","0.00_ ;[Red]\\-0.00\\ ","0.00_);[Red]\\(0.00\\)","0.00_);[Red]\\(0.00\\);;","#,##0.00_);[Red]\\(#,##0.00\\)*1000","0.00\\x",'_(* #,##0.00\\x\\ \\ ;_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',"0.00\\x_);\\(0.00\\x\\)","_(##0_);\\(##0\\)_1;\\-_)_ _ ",'""0.0%" --\x3e 61.5% of Sales 1st 5 yrs.; steady state thereafter"','00\\ "Coal Upgrade"',"0.0E+00",'0.0" GJ/MWh"','00\\ "Hydro"','00\\ "Incremental"','0.0" mmbtu//MWh"','0.0%" of beg. Net PPE + Intgble Amort."','0.0%" of Sales"','0.0%" of Total Assets"',"#,##0.0_);[Red]\\(#,##0\\)","###0.0_);[Red]\\(###0.0\\)","#,##0.0;[Red]\\(#,##0.0\\)","#,##0.0;[Red]\\(#,##0.0\\);\\-","#,##0.0;[Red]\\-#,##0.0","#,##0.0\\ ;[Red]\\(#,##0.0\\)","#,##0.0_ ;[Red]\\-#,##0.0\\ ","#,##0.0_);[Red]\\(#,##0.0\\)","#,##0.0_);[Red]\\(#,##0.0\\);","#,##0.0_);[Red]\\(#,##0.0\\);\\-","0.0%;[Red]\\(0.0%\\)","0.0%\\ ;[Red]\\(0.0%\\)","0.0%_);[Red]\\(0.0%\\)","0.0_);[Red]\\(0.0\\)","0.0_);[Red]\\-0.0_)","#,##0.0_);[Red]\\(#,##0.0\\)*1000",'0.0"x"','0.0\\ "x"',"0.0\\x","#,##0.0\\x_);\\(#,##0.0\\x\\)","#,##0.0\\x_);\\(#,##0.0\\x\\);",'0.0\\x_)_);"NM"_x_)_);0.0\\x_)_);@_%_)',"#,##0.0\\x_);[Red]\\(#,##0.0\\x\\);",'0%\\ "Beg. Net PPE + Intangibles"','0" Days"','_-* #,##0\\ "DM"_-;\\-* #,##0\\ "DM"_-;_-* "-"\\ "DM"_-;_-@_-','_-* #,##0\\ _D_M_-;\\-* #,##0\\ _D_M_-;_-* "-"\\ _D_M_-;_-@_-',"#,##0_e","0.E+00","0E+00","0\\ \\f",'_-* #,##0\\ "F"_-;\\-* #,##0\\ "F"_-;_-* "-"\\ "F"_-;_-@_-','_-* #,##0\\ _F_-;\\-* #,##0\\ _F_-;_-* "-"\\ _F_-;_-@_-','#,##0" GJ/D"','0\\ "Hydro"','0" / kW"','0\\ "Last Year"','#,##0" MMBTUs";\\-#,##0" MMBTUs"','0" months"','0\\ "mos"','0" MW"','#,##0" MWh";\\-#,##0" MWh"','#,##0" MWh/D"','#,##0_)"MWH";[Red]\\("$"#,##0\\);"- "_)','#,##0_)"mW";[Red]\\("$"#,##0\\);"- "_)','0\\ " of"','0%" of Sales"','_-* #,##0\\ "Pts"_-;\\-* #,##0\\ "Pts"_-;_-* "-"\\ "Pts"_-;_-@_-','_-* #,##0\\ _P_t_s_-;\\-* #,##0\\ _P_t_s_-;_-* "-"\\ _P_t_s_-;_-@_-',"#,##0_r_)",'#,##0"r"_)',"###0_);[Red]\\(#,##0\\)","##,##0;[Red]\\(##,##0\\)","#,##0;[Red]#,##0",'#,##0;[Red]"-"#,##0',"#,##0;[Red]\\(#,##0\\)","#,##0;[Red]\\(#,##0\\);\\-","#,##0;[Red]\\-#,##0","#,##0;[Red]\\-#,##0;\\-","#,##0\\ ;[Red]\\(#,##0\\)","#,##0_ ;[Red]\\-#,##0\\ ","#,##0_);[Red]\\(#,##0\\);","#,##0_);[Red]\\(#,##0\\);;",'#,##0_);[Red]\\(#,##0\\);"-   "','#,##0_);[Red]\\(#,##0\\);"- "_)','#,##0_);[Red]\\(#,##0\\);"-"',"#,##0_);[Red]\\(#,##0\\);\\-","#,##0_);[Red]\\<#,##0\\>","#.0,,;[Red]\\(#.0,,\\)",'"\\"#,##0;[Red]"\\""\\""\\""\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;[Red]"\\""\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;[Red]"\\""\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;[Red]"\\""\\""\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;[Red]"\\""\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;[Red]"\\""\\""\\""\\""\\""\\"\\-#,##0','"\\"#,##0;[Red]"\\""\\""\\""\\"\\-#,##0','"\\"#,##0;[Red]"\\""\\""\\"\\-#,##0','"\\"#,##0;[Red]"\\"\\-#,##0','"\\"#,##0;[Red]\\-"\\"#,##0','_(* #,##0_);[Red]* \\(#,##0\\);_(* "-"_);_(@_)','_(* #,##0_);[Red]\\(* \\(#,##0\\);_(* "-"_);_(@_)',"0%\\ ;[Red]\\(0%\\)",'0%\\ ;[Red]\\(0%\\)\\ ;"-  "',"0%\\);[Red]\\(0%\\)","0%_);[Red]\\(0%\\)","0;[Red]0","0_);[Red]\\(0\\)","0_);[Red]\\(0\\);;","0_);[Red]\\-0_)","#,##0_);[Red]\\(#,##0,\\)*1000",'0%" Tax Rate"','0\\ "Wind"','0\\ "WTG"','0" Year"','0" years"',"0\\ \\y\\e\\a\\r\\s",'0"  Years"',"\\10000000","#?/12","#\\ ?/32","#\\ ?/32;[Red]\\(#?/32\\)","#\\ ?/32;[Red]\\(#\\ ?/32\\)","#\\ ?/4","#\\ ?/64","[<=9999999]###\\-####;\\(###\\)\\ ###\\-####",'"and"\\ 0\\ "--\x3e6-year average"','"As of "\\ mm/dd/yy','"As of "mmmm\\ dd\\,\\ yyyy','"As of"\\ mmmm\\ dd\\,\\ yyyy','"As of "mmmm\\ d\\,\\ yyyy','"Ave. Debt Bal. * "0.00%" cost * (1-t)"','#\\ "BP"','_(\\C"$"* #,##0.00000_);_(\\C"$"* \\(#,##0.00000\\);_(\\C"$"* "0"_);_(@_)','\\C"$"#,##0_);\\(\\C"$"#,##0\\)','_(\\C"$"* #,##0_);_(\\C"$"* \\(#,##0\\);_(\\C"$"* "0"_);_(@_)','\\C"$"\\ #,##0\\);[Red]\\(\\C"$"\\ #,##0\\)','"Canada Cash Desk Economics (CDN$) for"\\ mmm\\-yy\\ "as of:"','"Change since "mmmm\\ dd\\,\\ yyyy','"Changes Since "mmmm\\ dd\\,\\ yyyy','_ "CHF"\\ * #,##0.00_ ;_ "CHF"\\ * \\-#,##0.00_ ;_ "CHF"\\ * "-"??_ ;_ @_ ','"Converted at "_(* #,##0.0000_);_(* \\(#,##0.0000\\);_(* "-"??_);_(@_)','"Cr$"\\ #,##0_);\\("Cr$"\\ #,##0\\)','"Current Day ("mm/dd/yy") Theoretical Sensitivities"\\ ','"Curves Loaded for"\\ \\ mm/dd/yy','"DATE:"\\ dd\\-mmm\\-yy','"DATE="mm/dd/yy','#\\ "Day"',"dd","ddd","dddd","ddd\\ \\-\\ dd","ddd\\-dd","dddd\\ d\\ mmmm\\ yyyy","ddd\\-dd\\-mmm\\-yy","ddd\\ dd\\ mmm\\ yyyy\\ hh:mm","dd\\-ddd\\-yy","dddd\\ mmmm\\ dd\\ ","dddd\\,\\ mmmm\\ dd\\,\\ yyyy","dddd\\,\\ mmmm\\ d\\,\\ yyyy","dddd\\,\\ mmmm\\,\\ d\\,\\ yyyy","dddd\\,mmmm\\,d\\,yyyy","ddd\\,\\ mmm\\ d","ddd\\-mmm\\-dd","ddd\\ yy/mm/dd","dd\\-mmm_)","dd\\-mmm\\-yy","dd\\-mmm\\-yy_)","dd\\-mmm\\-yy_);[Red]dd\\-mmm\\-yy_)","dd\\ mmm\\ yyyy","dd\\-mmm\\-yyyy","ddmmyy",'"Detail of New Transactions By Originator - "mmmm\\,\\ yyyy','"Discount Rate of"\\ 0.00%',"d\\-mmm\\,ddd",'d\\-mmm\\-yy\\ "Cycle 6"',"d/mmm/yyyy","d\\-mmm\\-yyyy",'d\\-mmm\\-yyyy\\ "Cycle 6"',"d/m/yy\\ h:mm","d\\.m\\.yy\\ h:mm",'"down"\\ 0.0','"DR="0.00%','"Effective Date: "\\ dd\\-mmm\\-yyyy','"EQUITY CASH FLOW PV AT "#0.00"%"','"First Period Days =  "\\ 0','"Fuel Cost:"\\ 0.00',"General\\ ","General_)","General;[Red]\\-General","General_);[Red]\\-General_)","h","hh:mm","hh:mm\\ AM/PM","hh:mm\\ AM/PM_)","hh:mm:ss","[h]:mm",'h:mm:ss"\\""\\""\\""\\"\\ AM/PM','"Include";;"Exclude"','" K-"#','_ "kr"\\ * #,##0.00_ ;_ "kr"\\ * \\-#,##0.00_ ;_ "kr"\\ * "-"??_ ;_ @_ ','_ "kr"\\ * #,##0_ ;_ "kr"\\ * \\-#,##0_ ;_ "kr"\\ * "-"_ ;_ @_ ','"LTD Through "mmmm\\ dd\\,\\ yyyy','##"m"',"m","m/d","m/dd/yyyy","m/d/yy","m/d/yy_%_)","m\\-d\\-yy","m/d/yy\\ h:mm","m/d/yy\\ h:mm\\ AM/PM","m\\/d\\/yyyy","m/d/yyyy\\ h:mm:ss","mm","mm/dd","mmdd","mm/dd/ddd","mm/dd/yy","mm/dd/yy_)","mm\\-dd\\-yy","mmddyy","mm/dd/yy\\ hh:mm","mm\\-dd\\-yy\\ hmm\\ AM/PM","mm/dd/yyyy",'mm"/"dd"/"yyyy',"mm\\-dd\\-yyyy","mm\\-dd\\-yyyy\\ ","mm\\/dd\\/yyyy","mm/dd/yyyy\\ hh:mm\\ AM/PM","mm/dd/yyyy\\ hh:mmAM/PM","mm\\-dd\\-yyyy\\ \\ hh:mm:ss\\ AM/PM\\ \\ ","mm\\-dd\\-yyyy\\ hh:mm:ss\\ AM/PM","mmm","mmm\\ d","mmm\\-dd","mmm\\-dd\\ \\ \\ h:mm\\ AM/PM","mmm\\ dd\\ yy_;","mmm\\-dd\\-yy","mmm\\-dd\\-yy\\ h:mm\\ AM/PM","mmm\\ dd\\ yyyy;","mmmddyyyy","mmm\\ dd\\ yyyy\\ hh:mm\\ AM/PM","mmm\\-d\\-yy","mmm\\-d\\-yy\\ ","mmm\\ d\\,\\ yyyy","mmmm","mmmm\\ d",'mmmm\\ dd","\\ yyyy',"mmmm\\ dd\\,\\ yyyy","mmmm\\ dd\\,\\ yyyy\\ \\ h:mm\\ AM/PM","\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ mmmm\\ d\\,\\ yyyy","mmmm\\ d\\,\\ yyyy","mmmmm","mm\\-mmm\\-yy","mmmm\\-yy","mmmm\\ yyyy","mmmm\\-yyyy","mmm\\ yy","mmm\\-yy_)","mmm\\.yy","mmm\\ yyyy","mmm\\,\\ yyyy","mmm\\-yyyy","mmm\\-yyyy_)","mm/yy","mm\\-yy","mm/yyyy","mm\\-yyyy",'"MTD Through "mmmm\\ dd\\,\\ yyyy',"m/yy","m\\/yy","m/yyyy","\\n\\o\\t\\ \\Q0",'"On";;"Off"','_("P"* #,##0.00_);_("P"* \\(#,##0.00\\);_("P"* "-"??_);_(@_)','_("P"\\ * #,##0.00_);_("P"\\ * \\(#,##0.00\\);_("P"\\ * "-"??_);_(@_)','_("P"* #,##0_);_("P"* \\(#,##0\\);_("P"* "-"_);_(@_)','_("P"\\ * #,##0_);_("P"\\ * \\(#,##0\\);_("P"\\ * "-"_);_(@_)','"Pmts per Year = "0',"\\P\\P\\ #,##0.00000_);\\(\\P\\P\\ #,##0.00000_)",'_("Ps. "* #,##0.00_);_("Ps. "* \\(#,##0.00\\);_("Ps. "* "-"??_);_(@_)','"Ps. "#,##0.00_);[Red]\\("Ps. "#,##0.00\\)','_("Ps. "* #,##0_);_("Ps. "* \\(#,##0\\);_("Ps. "* "-"_);_(@_)',"\\Q\\ 0","\\Q0",'_("R$"* #,##0.00_);_("R$"* \\(#,##0.00\\);_("R$"* "-"??_);_(@_)','_("R$"* #,##0_);_("R$"* \\(#,##0\\);_("R$"* "-"_);_(@_)',"[Red]#,##0;\\-#,##0","[Red]#,##0.0;[Blue]\\<#,##0.0\\>",'_-"Rs."* #,##0.00_-;\\-"Rs."* #,##0.00_-;_-"Rs."* "-"??_-;_-@_-','_-"Rs."* #,##0_-;\\-"Rs."* #,##0_-;_-"Rs."* "-"_-;_-@_-','_-"S/."\\ * #,##0.00_-;\\-"S/."\\ * #,##0.00_-;_-"S/."\\ * "-"??_-;_-@_-','_-"S/."\\ * #,##0_-;\\-"S/."\\ * #,##0_-;_-"S/."\\ * "-"_-;_-@_-','"Sales growth declines from "0.0%" to 10% in yr 5"','"Sensitivity Change from Prior Day ("mm/dd/yy")"','_ "SFr."* #,##0.00_ ;_ "SFr."* \\-#,##0.00_ ;_ "SFr."* "-"??_ ;_ @_ ','"SFr."#,##0;[Red]"SFr."\\-#,##0','"SFr."#,##0;"SFr."\\-#,##0','_ "SFr."* #,##0_ ;_ "SFr."* \\-#,##0_ ;_ "SFr."* "-"_ ;_ @_ ','"Stmt Date "m/d/yy','"Through "mmmm\\ dd\\,\\ yyyy','_(\\U"$"* #,##0_);_(\\U"$"* \\(#,##0\\);_(\\U"$"* "0"_);_(@_)','"up"\\ 0.0','"VS"\\ mmm\\-yy',"\\W#,##0","\\W#,##0.0",'"Wire Date "m/d/yy','"with "0%" tax"',"#\\x","\\X",'"Yes";;"No"','"Yes"_%_);;"No"_%_)','"YTD Through "mmmm\\ dd\\,\\ yyyy',"yyddmm","yy/m","yy/mm","yy\\-mm\\-dd","yymmdd",'yy"\\""\\""\\"\\-mm"\\""\\""\\"\\-dd"\\""\\""\\""\\"\\ h:mm',"yy\\ mmm","yy\\ mmm\\ dd","yyyy","yyyyddmm","yyyy/mm","yyyy\\.mm\\.dd","yyyy\\-mm\\-dd\\ hh:mm","yyyy/mm/dd\\ hh:mm:ss:ss","yyyy\\-mm\\-dd\\ hh:mm:ss\\.ss","yyyy\\ \\-\\ mmm","yyyy\\-mmm","yyyy\\-mmm\\-dd","yyyymmmdd","yyyy\\ mmmm"]},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IterativeRecalcState=t.cellRead=t.cellWrite=t.rangeWrite=t.TransactionLogMessageKind=t.TransactionLog=t.WriteResultKind=void 0;var n,i=r(2),a=r(51),o=r(250),s=r(62),u=r(117),c=r(54),l=r(38);!function(e){e[e.Next=0]="Next",e[e.Done=1]="Done",e[e.CellWriteLimitReached=2]="CellWriteLimitReached",e[e.CellCycle=3]="CellCycle"}(n=t.WriteResultKind||(t.WriteResultKind={}));var d,f=function(){function e(e){this.state=e}return e.prototype.forEachMeets=function(e,t){var r=this.state[e.sheet.index];void 0!==r&&r.forEachMeets(e.range,t)},e.prototype.setValue=function(t,r){var n,a,s=null!==(a=this.state[t.sheet.index])&&void 0!==a?a:(0,o.makeGridRangeTable)();return new e(i.__assign(i.__assign({},this.state),((n={})[t.sheet.index]=s.setValue(t.range,r),n)))},e.empty=function(){return new e({})},e}(),p=function(){function e(){this.log=[]}return e.prototype.extract=function(){return this.log},e.prototype.lookup=function(t){var r=[];return void 0!==this.current&&(this.current.previousVersions.forEachMeets(t,(function(e,t){return r.push(t),!0})),e.meets(t,this.current.range)&&r.push(this.current)),r},Object.defineProperty(e.prototype,"current",{get:function(){return this.log[this.log.length-1]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this.log.length},enumerable:!1,configurable:!0}),e.prototype.insert=function(e,t){if(void 0!==this.current){var r={version:this.current.version+1,range:e,message:t,previousVersions:this.current.previousVersions.setValue(this.current.range,this.current)};this.log.push(r)}else this.log.push({version:0,range:e,message:t,previousVersions:f.empty()})},e.prototype.rollBack=function(t){if(void 0===this.current)return!1;var r=void 0;return this.current.previousVersions.forEachMeets(t,(function(e,t){return(void 0===r||t.version<r.version)&&(r=t),!0})),void 0===r?!!e.meets(t,this.current.range)&&(this.truncLog(this.log.length-1),!0):(this.truncLog(r.version),!0)},e.prototype.truncLog=function(e){this.log.length=(0,s.fastMax)(e,0)},e.meets=function(e,t){return e.sheet.index===t.sheet.index&&(0,l.gridRangeIsects)(e.range,t.range)},e}();function m(e,t){return{kind:d.RangeWrite,range:e,opers:t}}function h(e,t){return{kind:d.CellWrite,cell:e,oper:t}}t.TransactionLog=p,function(e){e[e.RangeWrite=0]="RangeWrite",e[e.CellWrite=1]="CellWrite",e[e.CellRead=2]="CellRead"}(d=t.TransactionLogMessageKind||(t.TransactionLogMessageKind={})),t.rangeWrite=m,t.cellWrite=h,t.cellRead={kind:d.CellRead};var v={kind:n.CellWriteLimitReached},g=function(){function e(e){this.transactionLog=new p,this.anchorVisitCounts={},this.workStack=[[e,u.emptyVisitedCells]]}return e.prototype.registerVisibleCells=function(e){for(var t=0,r=e;t<r.length;t++){var i=r[t];this.ensureNeedsVisit(i)}return{kind:n.Next,address:this.address}},e.prototype.registerDynamicDependency=function(e){for(var t=0,r=e;t<r.length;t++){var i=r[t],a={cell:i,previous:this.visitedCells.current,cycle:void 0},o=this.visitedCells.map.getValue(i);if(void 0!==o)return(0,u.recordCellCycle)(o,this.visitedCells.current),{kind:n.CellCycle,cycle:o.cycle};this.workStack.push([i,(0,u.appendVisitedCell)(this.visitedCells,a)]),this.ensureNeedsVisit(i)}return{kind:n.Next,address:this.address}},e.prototype.registerRead=function(){return 0===this.transactionLog.lookup(this.address).length&&this.transactionLog.insert(this.address,t.cellRead),this.next()},e.prototype.writeRange=function(e){var t=this.address,r=t.sheet,n=t.range,i=n.row,o=n.col,s=(0,a.sheetGridRange)(r,(0,a.gridRange)(i,o,e.length,e[0].length));return this.write(s,m(s,e))},e.prototype.writeCell=function(e){return this.write(this.address,h(this.address,e))},Object.defineProperty(e.prototype,"address",{get:function(){return this.workStack[this.workStack.length-1][0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"visitedCells",{get:function(){return this.workStack[this.workStack.length-1][1]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"grid",{get:function(){return this.transactionLog},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"remainingWork",{get:function(){return this.workStack},enumerable:!1,configurable:!0}),e.prototype.incrementCellWriteCount=function(e){var t=this.ensureNeedsVisit(e);if(t[1]+=1,t[1]>10)return v},e.prototype.ensureNeedsVisit=function(e){var t,r=this.anchorVisitCounts[e.sheet.index];return void 0===r&&(r=this.anchorVisitCounts[e.sheet.index]={}),r[(0,c.gridRangeAnchorHash)(e.range)]=null!==(t=r[(0,c.gridRangeAnchorHash)(e.range)])&&void 0!==t?t:[e,0]},e.prototype.write=function(e,t){if(this.transactionLog.rollBack(e))return{kind:n.Next,address:this.address};var r=this.incrementCellWriteCount(this.address);return void 0!==r?r:(this.transactionLog.insert(e,t),this.next())},e.prototype.next=function(){for(;this.workStack.length>1;)if(this.workStack.pop(),0===this.transactionLog.lookup(this.address).length)return{kind:n.Next,address:this.address};if(0===this.transactionLog.lookup(this.address).length)return{kind:n.Next,address:this.address};var e=this.unevaluatedVisibleRanges();if((0,s.safePush)(this.workStack,e),e.length>0)return{kind:n.Next,address:this.address};for(var t=[],r=[],i=0,a=this.transactionLog.extract();i<a.length;i++){var o=a[i];switch(o.message.kind){case d.CellWrite:t.push([o.message.cell,o.message.oper]);break;case d.RangeWrite:r.push([o.range,o.message.opers])}}return{kind:n.Done,cellWrites:t,rangeWrites:r}},e.prototype.unevaluatedVisibleRanges=function(){var e=[];for(var t in this.anchorVisitCounts)for(var r in this.anchorVisitCounts[t]){var n=this.anchorVisitCounts[t][r][0];0===this.transactionLog.lookup(n).length&&e.push([n,u.emptyVisitedCells])}return e},e}();t.IterativeRecalcState=g},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RTree=t.RTKind=t.copyExcept=void 0;var n=r(7);t.copyExcept=n.rTree.copyExcept,t.RTKind=n.rTree.RTKind,t.RTree=n.rTree.RTree},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.adjustFormulaOrigin=void 0;var n=r(3);t.adjustFormulaOrigin=n.adjust.adjustFormulaOrigin},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toXLNumber=t.renderFormat=t.initUtilGlobals=t.getValueEditOperKind=t.getFormatString=t.applyValueEdit=void 0;var n=r(22);t.applyValueEdit=n.util.applyValueEdit,t.getFormatString=n.util.getFormatString,t.getValueEditOperKind=n.util.getValueEditOperKind,t.initUtilGlobals=n.util.initUtilGlobals,t.renderFormat=n.util.renderFormat,t.toXLNumber=n.util.toXLNumber},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createEvaluator=void 0;var n=r(199);t.createEvaluator=function(e){return{evalFormula:function(t,r){return(0,n.evalFormula)(e,t,r)},evalCells:function(t,r){return(0,n.evalCells)(e,t,r)},evalCellsAsync:function(t,r){return(0,n.evalCellsAsync)(e,t,r)}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isFormulaSubExpressionVolatile=t.getSubstitutedSubExpressionString=t.getFormulaSubExpressionObject=t.getSubExpressionSubspans=t.getSubExpressionSpan=t.getSubExpressionFromFormulaCharacterIndex=void 0;var n=r(38),i=r(51),a=r(198),o=r(200),s=r(118),u=r(256),c=r(202),l=r(72),d=r(135),f=r(43),p=r(48),m=r(60);function h(e,t,r,n,i){switch(r.kind){case s.NodeKind.Let:return function(e,t,r,n,i){for(var a=[],o=0;o<r.args.length;o+=1){var u=t.spans[r.args[o].label];if(u&&n.start>=u.start&&n.end<=u.end){var c=r.args[o];if((n.start>u.start||n.end<u.end)&&(c=h(e,t,r.args[o],n,i)),o===r.args.length-1&&r.args.length%2==1)a.push(c);else if(o%2==1){if(1===o)return c;a.pop(),a.push(c)}else a.push(c),a.push(r.args[o+1]),a.push(c);return(0,s.appNode)(r.head,a,!0,r.label)}a.push(r.args[o])}return i}(e,t,r,n,i);case s.NodeKind.App:case s.NodeKind.Lambda:for(var a=0;a<r.args.length;a+=1){var o=t.spans[r.args[a].label];if(o&&n.start>=o.start&&n.end<=o.end)return h(e,t,r.args[a],n,i)}return i;case s.NodeKind.Array:for(a=0;a<r.nodes.length;a+=1)for(var u=0;u<r.nodes[a].length;u+=1){var c=t.spans[r.nodes[a][u].label];if(c&&n.start>=c.start&&n.end<=c.end)return h(e,t,r.nodes[a][u],n,i)}return i;case s.NodeKind.Paren:var l=t.spans[r.node.label];return l&&n.start>=l.start&&n.end<=l.end?h(e,t,r.node,n,i):i;case s.NodeKind.Bad:case s.NodeKind.CellRef:case s.NodeKind.FieldRef:case s.NodeKind.Literal:case s.NodeKind.Name:case s.NodeKind.Param:case s.NodeKind.StructRef:return i;default:return(0,f.assertNever)("calc.runtime.makeSubstitutions",r)}}t.getSubExpressionFromFormulaCharacterIndex=function(e,t,r,s){var u=(0,o.createParser)((0,a.createParseGlobals)(e)).parseFormula((0,a.parseLocals)(i.LexicalKind.Cell,s.range),r);if((0,m.isSuccess)(u)){var c=u.value;if(!(t<0||t>=r.length))return{formula:c,subexpression:(0,n.getSubExpressionFromPosition)(c,t)}}},t.getSubExpressionSpan=function(e){return e.formula.spans[e.subexpression.label]},t.getSubExpressionSubspans=function(e,t,r){var i=t.formula;return function(e,t,r,i){if((t.kind===s.NodeKind.App||t.kind===s.NodeKind.Let)&&(0,n.isWSFNode)(t.head)&&t.head.id===l.WorksheetFuncId.LET){for(var a=[],o=r.spans[t.label],u=0;u<t.args.length-1;u+=2){var c=0===u?r.spans[t.head.label]:r.spans[t.args[u].label],d=r.spans[t.args[u+1].label];if(o&&c&&d){var p=i.indexOf(e.listSeparator,d.end);p>=0?p+=1:(p=i.indexOf(")",d.end))<0&&(p=d.end);var m=(0,s.formulaSpan)(0===u?c.end+1:c.start,p,"","");a.push(m)}}return a}if(t.kind===s.NodeKind.Name||t.kind===s.NodeKind.CellRef&&void 0===t.qualifier&&t.ref.kind===s.CellRefKind.Bad)return function e(t,r,i,a){switch(r.kind){case s.NodeKind.App:case s.NodeKind.Let:case s.NodeKind.Lambda:if((0,n.isWSFNode)(r.head)&&r.head.id===l.WorksheetFuncId.LET)for(var o=0;o<r.args.length;o+=1)if(o%2==0&&o<r.args.length-1){var u=r.args[o],c=r.args[o+1];if(u.kind===s.NodeKind.Name&&a.kind===s.NodeKind.Name&&0===t.stringCompareCI(u.whole,a.whole)||u.kind===s.NodeKind.CellRef&&a.kind===s.NodeKind.CellRef&&void 0===u.qualifier&&void 0===a.qualifier&&u.ref.kind===s.CellRefKind.Bad&&a.ref.kind===s.CellRefKind.Bad&&0===t.stringCompareCI(u.ref.chars,a.ref.chars)){var d=[],p=i.spans[u.label],m=i.spans[c.label],h=i.spans[a.label];if(h&&p&&m&&p.start===h.start&&p.end===h.end)return d.push((0,s.formulaSpan)(p.start,m.end,"","")),d}}else{if((d=e(t,r.args[o],i,a)).length>0)return d}else for(o=0;o<r.args.length;o+=1){if((d=e(t,r.args[o],i,a)).length>0)return d}return[];case s.NodeKind.Array:for(o=0;o<r.nodes.length;o+=1)for(var v=0;v<r.nodes[o].length;v+=1){if((d=e(t,r.nodes[o][v],i,a)).length>0)return d}return[];case s.NodeKind.Paren:return e(t,r.node,i,a);case s.NodeKind.Bad:case s.NodeKind.CellRef:case s.NodeKind.FieldRef:case s.NodeKind.Literal:case s.NodeKind.Name:case s.NodeKind.Param:case s.NodeKind.StructRef:return[];default:return(0,f.assertNever)("calc.runtime.addLETNameSubspans",r)}}(e,r.node,r,t);return[]}(e,t.subexpression,i,r)},t.getFormulaSubExpressionObject=function(e,t,r,n){var s=r;s.startsWith("=")||(s="="+r);var u=(0,o.createParser)((0,a.createParseGlobals)(e)),c=u.parseFormula((0,a.parseLocals)(i.LexicalKind.Cell,n.range),t),l=u.parseFormula((0,a.parseLocals)(i.LexicalKind.Cell,n.range),s);if((0,m.isSuccess)(c)&&(0,m.isSuccess)(l))return{formula:c.value,subexpression:l.value.node}},t.getSubstitutedSubExpressionString=function(e,t,r,n){var a=h(e.localeInfo,t.formula,t.formula.node,r,t.subexpression),o=(0,d.calcConfig)((0,d.getEnglishLocaleInfo)()),l=t.formula,f=l.spans,p=l.annotations,v=l.depthUpperBound,g=(0,c.createPrinter)((0,u.createSimplePrintGlobals)(o)).printFormula((0,u.printLocalsGrid)((0,i.lexicalSourceGrid)(i.LexicalKind.Cell,n),n,o),(0,s.formula)(a,f,p,v));return(0,m.isSuccess)(g)?g.value:""},t.isFormulaSubExpressionVolatile=function(e,t){var r=[];for(r.push(t.subexpression);r.length>0;){var i=r.pop();if(void 0!==i)switch(i.kind){case s.NodeKind.App:case s.NodeKind.Let:case s.NodeKind.Lambda:if((0,n.isWSFNode)(i.head)&&0!=((0,l.getWorksheetFuncType)(i.head.id).staticPrecs&(p.SpecialPrecs.Time|p.SpecialPrecs.Calc)))return!0;i.args.forEach((function(e){r.push(e)}));break;case s.NodeKind.Array:i.nodes.map((function(e){return e.map((function(e){r.push(e)}))}));break;case s.NodeKind.FieldRef:r.push(i.lhs);break;case s.NodeKind.Paren:r.push(i.node);break;case s.NodeKind.Bad:case s.NodeKind.CellRef:case s.NodeKind.StructRef:case s.NodeKind.Literal:case s.NodeKind.Name:case s.NodeKind.Param:case s.NodeKind.Operator:break;default:(0,f.assertNever)("calc.runtime.isVolatile",i)}}return!1}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.randomCellEvaluationTest=t.randomTestSheetContents=t.randomTestCellContents=t.randomTestFormula=t.runCellEvaluationTest=t.runMockCellEvaluationTest=t.makeRandomizedTimer=t.abstractEvalCells=t.sheet=t.document=t.makeDirtyCellContents=t.makeFailedCellContents=t.makeFinalCellContents=t.TestCellState=t.SpecialContents=t.locationFormula=t.locationValue=t.parsed=t.compiled=t.makeTestContext=void 0;var n,i,a=r(2),o=r(43),s=r(81),u=r(376),c=r(255),l=r(105),d=r(52),f=r(199),p=r(195),m=r(377),h=r(259),v=r(51),g=r(38),b=r(198),S=r(200),y=r(135),O=r(381),C=r(118),P=r(40),N=r(72),R=r(257),k=r(258),T=r(117),E=r(201),_=r(60),F=r(382),I=r(202),A=r(383);function M(e,r,n,i,o){void 0===o&&(o=!1);var s=r.kind===v.LexicalKind.NameManager?(0,c.analyzeLocalsName)((0,v.sheetGridCell)(t.sheet,n)):(0,c.analyzeLocalsGrid)(r.kind,(0,v.sheetGridCell)(t.sheet,n)),u=e.analyzer.checkFormula(s,i);if((0,_.isSuccess)(u)&&(0,g.isWellFormed)(u.value)){var d=r.kind===v.LexicalKind.NameManager?(0,l.compileLocalsName)(n):(0,l.compileLocalsGrid)(r.kind,n),f=e.compiler.compileFormula(o?a.__assign(a.__assign({},d),{emitStepInfo:o}):d,u.value);if(f.kind===_.ResultKind.Success)return f.value;throw new Error("unexpected result ".concat(JSON.stringify(f)))}throw new Error("not well formed formula ".concat(JSON.stringify(u)))}t.makeTestContext=function(e,t,r){var n=(0,A.createArrayLogger)();(0,O.initCalc)(n,null!=e?e:u.featureEnabledDummyCallback);var i=(0,y.calcConfig)(null!=t?t:(0,y.getEnglishLocaleInfo)(),void 0,r),a={config:i},o={config:i},s={config:i};return{logger:n,config:i,compileGlobals:o,parser:(0,S.createParser)(a),analyzer:(0,k.createAnalyzer)(s),compiler:(0,p.createCompiler)(o)}},t.compiled=M,t.parsed=function(e,t,r,n,i,a){void 0===n&&(n=C.RefStyle.A1),void 0===i&&(i=t.kind!==v.LexicalKind.NameManager?(0,g.gridRangeAnchor)(t.range.range):(0,o.assertFalse)("must pass origin for LexicalSourceName")),void 0===a&&(a=!1);var s=e.parser.parseFormula((0,b.parseLocals)(t.kind,i,{refStyle:n}),r);if(s.kind!==_.ResultKind.Success)throw new Error("unexpected result ".concat(JSON.stringify(s)));return M(e,t,i,s.value,a)},t.locationValue=function(e,t){return{cell:e,oper:t}},t.locationFormula=function(e,t){return{source:e,formula:(0,C.formula)(t,[],[],1)}},function(e){e.ValueMocked="ValueMocked",e.ValueUnavailable="ValueUnavailable",e.FormulaUnavailable="FormulaUnavailable",e.EvalNotImplemented="EvalNotImplemented",e.EvalJavaScriptError="EvalJavaScriptError"}(n=t.SpecialContents||(t.SpecialContents={})),function(e){e.Dirty="Dirty",e.Final="Final",e.Failed="Failed"}(i=t.TestCellState||(t.TestCellState={}));var w,D=((w=(0,d.bottomEvalPrecedents)()).bound=P.PrecsBound.Exact,w);function j(e,t,r){return{oper:e,reason:t,state:r,precedents:D}}function x(e){return j(e,void 0,i.Final)}function L(e){return j(e,void 0,i.Dirty)}function B(e){var t=e.row,r=e.col;return"R".concat(t+1,"C").concat(r+1)}function U(e,t){return"number"==typeof t?(0,C.literalNode)(e.config.mathpack.fromNumber(t)):t===n.EvalNotImplemented?(0,C.appNode)((0,C.wsfNode)(N.WorksheetFuncId.RAND,"RAND"),[]):t===n.EvalJavaScriptError?(0,C.appNode)((0,C.wsfNode)(N.WorksheetFuncId.NOW,"NOW"),[]):Array.isArray(t)?(0,C.appNode)((0,C.wsfNode)(N.WorksheetFuncId.SUM,"SUM"),t.map(U.bind(void 0,e))):(0,C.cellRefNode)((0,C.cellRefSingle)((0,m.absPos)(t.row),(0,m.absPos)(t.col)))}function G(e,t,r){var a={};for(var s in t){var u=t[s];if(null!=u){var c=u[1];if("number"==typeof c){var d=x(e.config.mathpack.fromNumber(c));a[s]=d}else if(Array.isArray(c)||c===n.FormulaUnavailable||c===n.EvalNotImplemented||c===n.EvalJavaScriptError){d=L(P.blankOper);a[s]=d}else c===n.ValueUnavailable||c===n.ValueMocked||(0,o.assertNever)("calc.runtime.abstractEvalCells, tc",c)}}var f={},p=[];function m(r){var s=B(r),u=t[s];if(null==u)return P.blankOper;var c=u[1];if("number"==typeof c)return e.config.mathpack.fromNumber(c);if(c===n.ValueUnavailable)return l.ReasonKind.Unavailable;var d=a[s];if(null==d&&(d=L(P.blankOper),a[s]=d),d.state===i.Failed)return(0,o.assertTrue)("calc.runtime.makeCellEvaluationTest",null!=d.reason),l.ReasonKind.PreviousFailure;if(d.state===i.Final)return d.oper;var h={cycle:!1};(0,o.assertTrue)("calc.runtime.makeCellEvaluationTest.abstractEvalCell: undetected cycle",null==f[s]),f[s]=h,p.push(h);try{switch(c){case n.ValueMocked:return(0,o.assertFalse)("calc.runtime.makeCellEvaluationTest.abstractEvalCell: unexpected ValueMocked");case n.FormulaUnavailable:throw!0}var v=function r(o,s){if("number"==typeof s)return(0,_.success)(e.config.mathpack.fromNumber(s));if(s===n.EvalNotImplemented)return(0,_.failure)({kind:l.ReasonKind.NotImplemented});if(s===n.EvalJavaScriptError)return(0,_.failure)({kind:l.ReasonKind.JavaScriptError});for(var u=[],c=0;c<s.length;c+=1){var d=s[c];if("object"!=typeof d||Array.isArray(d)){var h=r(o,d);if(!(0,_.isSuccess)(h))return h;u.push(e.config.mathpack.toNumber(h.value))}else u.push(d)}var v=function(e){var r=u[e];if("number"==typeof r)return"continue";var o=B(r),s=t[o];if(null!=s&&s[1]===n.ValueUnavailable)return{value:(0,_.failure)({kind:l.ReasonKind.Unavailable})};var c=a[o];if(null!=c&&c.state===i.Failed)return{value:(0,_.failure)({kind:l.ReasonKind.PreviousFailure})};var d=f[o];if(void 0!==d){for(var m=p.findIndex((function(e){return e===d}));-1!==m&&m<p.length;m+=1)p[m].cycle=!0;return{value:(0,_.failure)({kind:l.ReasonKind.CellCycle})}}};for(c=0;c<u.length;c+=1){var g=v(c);if("object"==typeof g)return g.value}var b=0;for(c=0;c<u.length;c+=1){var S=u[c];if("number"!=typeof S){try{m(S)}catch(e){return(0,_.failure)({kind:l.ReasonKind.JavaScriptError})}var y=B(S),O=a[y];if(null!=O){if(O.state===i.Failed)return(0,_.failure)({kind:o.cycle?l.ReasonKind.CellCycle:l.ReasonKind.PreviousFailure});b+=e.config.mathpack.toNumber(O.oper)}}else b+=S}return(0,_.success)(e.config.mathpack.fromNumber(b))}(h,c);return(0,_.isSuccess)(v)?(function(e,t){if(e.state!==i.Dirty){var r="expected dirty cellContent; given ".concat(JSON.stringify(e));(0,o.assertFalse)("calc.runtime.makeCellEvaluationTest.setContentFinal: ".concat(r))}e.oper=t,e.state=i.Final}(d,v.value),v.value):(function(e,t){if(e.state!==i.Dirty){var r="expected dirty cellContent; given ".concat(JSON.stringify(e));(0,o.assertFalse)("calc.runtime.makeCellEvaluationTest.setContentFailed: ".concat(r))}e.reason=t,e.state=i.Failed}(d,v.reason.kind),v.reason.kind)}finally{delete f[s],p.pop()}}return{evalResults:r.map((function(e){try{return m(e)}catch(e){return l.ReasonKind.JavaScriptError}})),sheetState:a}}function K(e){return"string"==typeof e?l.ReasonKind.PreviousFailure:e}function V(e){return null==e?e:a.__assign(a.__assign({},e),{reason:void 0})}function W(e,t){for(var r in e){var n=e[r];null!=n&&n.state===i.Dirty&&(delete e[r],delete t[r])}}function H(e,t){var r={};for(var n in e)r[n]=t(e[n]);return r}function q(e){for(var t=[],r=0;r<e;r+=1)t.push(r);return t}function z(e,t){return null==t?t:"number"==typeof t.row&&"number"==typeof t.col&&1===t.rows&&1===t.cols?"gridCell(".concat(t.row,", ").concat(t.col,")"):128===t.kind&&1===Object.getOwnPropertyNames(t).length?"blankOper":t}function Q(e,r,a,u,c,p,m,b){void 0===b&&(b={});var y=function(e,r){var a={},u={};function c(e){var t=a[e];return null==t&&(t=x(P.blankOper),a[e]=t),t}for(var f in r){var p=r[f];if(null!=p){var m=p[0],b=p[1];if("number"==typeof b)c(f).oper=e.config.mathpack.fromNumber(b);else if(Array.isArray(b)||b===n.EvalNotImplemented||b===n.EvalJavaScriptError){c(f).state=i.Dirty;var S=(0,C.formula)(U(e,b),[],[],2);u[f]=M(e,(0,v.lexicalSourceCell)((0,v.sheetGridCell)(t.sheet,m)),m,S)}else if(b===n.ValueMocked||b===n.FormulaUnavailable){c(f).state=i.Dirty}else b===n.ValueUnavailable||(0,o.assertNever)("calc.runtime.makeCellEvaluationTest, tc",b)}}function y(e,t){return(0,d.throwEvaluationError)((0,g.notImplemented)(["RAND"]))}function O(e,t){throw new Error("JavaScript error")}var R={config:e.config,getDocumentLoc:function(e,r){return(0,_.success)(t.document)},getSheetIndex:function(e,r){return(0,_.success)(t.sheet.index)},getSheetName:function(e,t){return(0,_.success)("Sheet1")},getSheetRangeIndexes:function(e){return(0,_.success)((0,v.sheetRangeIndexes)([t.sheet.index],0))},getNameLoc:function(e,t){return(0,_.failure)((0,g.unavailable)(["name at ".concat(JSON.stringify((0,v.nameLoc)(e,t)))]))},getUserDefinedFuncLoc:function(e,t){return(0,_.success)([])},getCellValue:function(e){var t=B(e.range),o=r[t];if(null!=o&&o[1]===n.ValueUnavailable)return(0,_.failure)((0,g.unavailable)(["value at ".concat(t)]));var s=a[t];return null==s?(0,_.success)((0,l.finalValue)(P.blankOper)):s.state===i.Final?(0,_.success)((0,l.finalValue)(s.oper)):s.state===i.Failed?(0,_.failure)((0,l.previousFailure)(e)):(0,_.success)((0,l.pendingValue)(e))},getCellValues:function(e){var t=e.sheet,r=e.range,n=r.row,i=r.col,a=r.rows,o=r.cols,u=void 0,c=(0,s.jaggedArray)(a,o,(function(e,r){var a=R.getCellValue((0,v.sheetGridCell)(t,(0,v.gridCell)(e+n,r+i)));return a.kind===_.ResultKind.Failure?(null==u&&(u=a),(0,l.finalValue)(P.blankOper)):a.value}));return null!=u?u:(0,_.success)(c)},getWorksheetFunc:function(e){if(e===N.WorksheetFuncId.SUM){var t=(0,h.getWorksheetFunc)(e);return null!=t?(0,_.success)(t):(0,_.failure)((0,g.notImplemented)(["SUM"]))}return(0,_.success)(e===N.WorksheetFuncId.RAND?y:O)},getUserDefinedFunc:function(){return(0,_.failure)((0,g.unavailable)(["getUserDefinedFunc"]))},getNameFormula:function(e){return(0,_.failure)((0,g.unavailable)(["name at ".concat(JSON.stringify(e))]))},getCellFormula:function(e){var t=B(e.range),i=r[t];if(null!=i&&i[1]===n.FormulaUnavailable)return(0,_.failure)((0,g.unavailable)(["formula at ".concat(t)]));var a=u[t];return null!=a?(0,_.success)((0,l.cellFormula)((0,v.lexicalSourceCell)(e),a)):(0,_.success)(void 0)},interruptToken:[l.Interrupt.Continue],tryGetHiddenRows:function(e,t,r){return(0,_.success)([])},tryGetHiddenCols:function(e,t,r){return(0,_.success)([])},isInFilterMode:function(e){return(0,_.success)(!1)},getKnownFormat:function(){return(0,_.failure)((0,g.notImplemented)(["getKnownFormat"]))},getIformat:function(){return(0,_.failure)((0,g.notImplemented)(["getIformat"]))},getFormatString:function(){return(0,_.failure)((0,g.notImplemented)(["getFormatString"]))},getRandom:function(){return(0,_.failure)((0,g.notImplemented)(["getRandom"]))},getTime:function(){return(0,_.failure)((0,g.notImplemented)(["getTime"]))},schedulerConfig:{},limits:{},setCellValue:function(e,t){var r=B(e.range),n=a[r];if(null==n)n=x(P.blankOper),a[r]=n;else if(n.state!==i.Dirty){var s="expected dirty cell at ".concat(JSON.stringify(e)," but have ").concat(JSON.stringify(n),"; given ").concat(JSON.stringify(t));(0,o.assertFalse)("calc.runtime.makeCellEvaluationTest.setCellValue: ".concat(s))}n.oper=t,n.state=i.Final},setCellValues:function(e,t){throw new Error("unexpected call to setCellValues")},setCellFailure:function(e,t){if(!(0,g.isSheetGridCell)(e)){var r="expected cell; given range ".concat(JSON.stringify(e));return(0,o.assertFalse)("calc.runtime.makeCellEvaluationTest.setCellFailure: ".concat(r))}var n=B(e.range),s=a[n];if(null==s)s=x(P.blankOper),a[n]=s;else if(s.state!==i.Dirty){r="expected dirty cell at ".concat(JSON.stringify(e)," but have ").concat(JSON.stringify(s),"; given ").concat(JSON.stringify(t));(0,o.assertFalse)("calc.runtime.makeCellEvaluationTest.setCellFailure: ".concat(r))}s.reason=t.kind,s.state=i.Failed},getUsedRange:function(e){return(0,_.success)((0,v.sheetGridRange)(e,(0,v.gridRange)(0,0,v.sheetRows,v.sheetCols)))},getContainingTable:function(){return(0,_.failure)((0,g.notImplemented)(["getContainingTable"]))},getIntersectingTables:function(){return(0,_.failure)((0,g.notImplemented)(["getIntersectingTables"]))},getStructRefColumn:function(){return(0,_.failure)((0,g.notImplemented)(["getStructRefColumn"]))},getStructRefSpecialRef:function(){return(0,_.failure)((0,g.notImplemented)(["getStructRefSpecialRef"]))}};return[t.sheet,a,R]}(e,u),O=y[0],F=y[1],A=y[2];for(var w in b){var D=w;A[D]=b[D](A[D])}for(var j=[u,c,p,m],L=c.map((function(e){return(0,v.sheetGridCell)(O,e)})),G=null!=m?m:q(c.length),Q=[],J=0;J<G.length;J+=1)Q[G[J]]=J;var Y={globals:A,resolver:(0,R.createResolver)(A),numberFormatter:(0,E.createNumberFormatter)(A),parser:(0,S.createParser)(A),printer:(0,I.createPrinter)(A),analyzer:(0,k.createAnalyzer)(A),createCellEvaluationMachine:r.createCellEvaluationMachine.bind(r),createFormulaEvaluationMachine:r.createFormulaEvaluationMachine.bind(r),createLambdaEvaluationMachine:r.createLambdaEvaluationMachine.bind(r)},$={globals:A,timer:a,machineContext:Y},Z=[];for(J=0;J<G.length;J+=1){var X=L[G[J]];Z.push(Y.createCellEvaluationMachine(Y,void 0,T.emptyVisitedCells,X,!1))}return new f.EvaluationRuntime($,Z).evaluateAsync((0,f.createSchedule)($.globals.schedulerConfig)).then((function(e){return Q.map((function(t){var r=e[t];return r.kind===_.ResultKind.Success?r.value:r.reason.kind}))})).catch((function(e){return null!=e.reason?e.reason.stack:e.stack})).then((function(e){if(Array.isArray(e)){var t=e,r=F,n=p.evalResults,i=p.sheetState;null!=m&&(t=t.map(K),n=n.map(K),function(e,t){W(e,t),W(t,e)}(r=H(r,V),i=H(i,V)));try{expect([j,t,r]).toEqual([j,n,i])}catch(e){throw console.warn("runMockCellEvaluationTest: test failure:",JSON.stringify({testData:j,testResults:t,testState:r},z,2)),e}}else expect([j,e]).toEqual([j,void 0])}))}t.makeFinalCellContents=x,t.makeFailedCellContents=function(e,t){return j(e,t,i.Failed)},t.makeDirtyCellContents=L,t.document={path:void 0,name:"Book1"},t.sheet=(0,v.sheetIndex)(t.document,0),t.abstractEvalCells=G,t.makeRandomizedTimer=function(e){return void 0===e&&(e=.5),{doTimeout:function(t){return(0,F.randomFloat)()>e}}},t.runMockCellEvaluationTest=Q,t.runCellEvaluationTest=function(e,t,r,n,i,a){return void 0===a&&(a={}),Q(e,{createCellEvaluationMachine:f.createCellEvaluationMachine,createFormulaEvaluationMachine:f.createFormulaEvaluationMachine,createLambdaEvaluationMachine:function(e){}},(0,f.runtimeTimer)(),t,r,n,i,a)};function J(e,t,r){void 0===r&&(r=0);var i=(0,F.randomFloat)()*(r<3?1:.625);return i<.05?n.EvalJavaScriptError:i<.1?n.EvalNotImplemented:i<.55?1:a.__spreadArray([],new Array((0,F.randomIndex)(3)+1),!0).map((function(){return(0,F.randomFloat)()<.5?(0,v.gridCell)((0,F.randomIndex)(e),(0,F.randomIndex)(t)):J(e,t,r+1)}))}function Y(e,t){for(;;){var r=(0,F.randomFloat)();return r<.1?n.ValueUnavailable:r<.2?n.FormulaUnavailable:J(e,t)}}function $(e,t){for(var r={},n=0;n<e;n+=1)for(var i=0;i<t;i+=1)if((0,F.randomFloat)()<.5){var a=Y(e,t),o=(0,v.gridCell)(n,i);r[B(o)]=[o,a]}return r}t.randomTestFormula=J,t.randomTestCellContents=Y,t.randomTestSheetContents=$,t.randomCellEvaluationTest=function(e,t,r){var n=$(t,r),i=[];for(var a in n){var o=n[a];null!=o&&(0,F.randomFloat)()<.75&&i.push(o[0])}return[n,i=(0,F.randomShuffled)(i),G(e,n,i),(0,F.randomFloat)()<.5?(0,F.randomShuffled)(q(i.length)):void 0]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.featureEnabledDummyCallback=t.ConsoleLogger=t.AssertLogger=void 0;var n=r(7);t.AssertLogger=n.testConfig.AssertLogger,t.ConsoleLogger=n.testConfig.ConsoleLogger,t.featureEnabledDummyCallback=n.testConfig.featureEnabledDummyCallback},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.xorNode=t.unionNode=t.subNode=t.sheet1Name=t.sheet1=t.relPos=t.rangeNode=t.powNode=t.poundNode=t.posNode=t.percentNode=t.orNode=t.negNode=t.neNode=t.mulNode=t.minNode=t.maxNode=t.ltNode=t.leNode=t.isectNode=t.isNameLocEqual=t.gtNode=t.geNode=t.expectTrue=t.eqNode=t.document1=t.divNode=t.createSingleRange=t.concatNode=t.badUnexpNode=t.badStructRefNode=t.badStringLiteralNode=t.badSeqNode=t.badQualNode=t.badParamNameNode=t.badNumberLiteralNode=t.badMissingNode=t.badFieldRefNode=t.badFieldNameNode=t.badErrorLiteralNode=t.badCellRefNode=t.badBracketNode=t.atNode=t.andNode=t.addNode=t.absPos=void 0;var n=r(3);t.absPos=n.testUtil.absPos,t.addNode=n.testUtil.addNode,t.andNode=n.testUtil.andNode,t.atNode=n.testUtil.atNode,t.badBracketNode=n.testUtil.badBracketNode,t.badCellRefNode=n.testUtil.badCellRefNode,t.badErrorLiteralNode=n.testUtil.badErrorLiteralNode,t.badFieldNameNode=n.testUtil.badFieldNameNode,t.badFieldRefNode=n.testUtil.badFieldRefNode,t.badMissingNode=n.testUtil.badMissingNode,t.badNumberLiteralNode=n.testUtil.badNumberLiteralNode,t.badParamNameNode=n.testUtil.badParamNameNode,t.badQualNode=n.testUtil.badQualNode,t.badSeqNode=n.testUtil.badSeqNode,t.badStringLiteralNode=n.testUtil.badStringLiteralNode,t.badStructRefNode=n.testUtil.badStructRefNode,t.badUnexpNode=n.testUtil.badUnexpNode,t.concatNode=n.testUtil.concatNode,t.createSingleRange=n.testUtil.createSingleRange,t.divNode=n.testUtil.divNode,t.document1=n.testUtil.document1,t.eqNode=n.testUtil.eqNode,t.expectTrue=n.testUtil.expectTrue,t.geNode=n.testUtil.geNode,t.gtNode=n.testUtil.gtNode,t.isNameLocEqual=n.testUtil.isNameLocEqual,t.isectNode=n.testUtil.isectNode,t.leNode=n.testUtil.leNode,t.ltNode=n.testUtil.ltNode,t.maxNode=n.testUtil.maxNode,t.minNode=n.testUtil.minNode,t.mulNode=n.testUtil.mulNode,t.neNode=n.testUtil.neNode,t.negNode=n.testUtil.negNode,t.orNode=n.testUtil.orNode,t.percentNode=n.testUtil.percentNode,t.posNode=n.testUtil.posNode,t.poundNode=n.testUtil.poundNode,t.powNode=n.testUtil.powNode,t.rangeNode=n.testUtil.rangeNode,t.relPos=n.testUtil.relPos,t.sheet1=n.testUtil.sheet1,t.sheet1Name=n.testUtil.sheet1Name,t.subNode=n.testUtil.subNode,t.unionNode=n.testUtil.unionNode,t.xorNode=n.testUtil.xorNode},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NumberShape=t.KnownFormat=t.DateOrder=t.CurrencyFormat=t.Calendar=void 0;var n=r(3);t.Calendar=n.numfmt.Calendar,t.CurrencyFormat=n.numfmt.CurrencyFormat,t.DateOrder=n.numfmt.DateOrder,t.KnownFormat=n.numfmt.KnownFormat,t.NumberShape=n.numfmt.NumberShape},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isKnownFormatDefined=t.getSpecial=t.getSingle=t.getKnownFormat=t.getColor=t.englishXLSXKnownFormat=t.buildSingle=t.buildScientificFormat=t.buildPercentFormat=t.buildNumberFormat=t.buildMMDDYYFormat=t.buildFractionFormat=t.buildCurrencyFormat=void 0;var n=r(22);t.buildCurrencyFormat=n.knownFormat.buildCurrencyFormat,t.buildFractionFormat=n.knownFormat.buildFractionFormat,t.buildMMDDYYFormat=n.knownFormat.buildMMDDYYFormat,t.buildNumberFormat=n.knownFormat.buildNumberFormat,t.buildPercentFormat=n.knownFormat.buildPercentFormat,t.buildScientificFormat=n.knownFormat.buildScientificFormat,t.buildSingle=n.knownFormat.buildSingle,t.englishXLSXKnownFormat=n.knownFormat.englishXLSXKnownFormat,t.getColor=n.knownFormat.getColor,t.getKnownFormat=n.knownFormat.getKnownFormat,t.getSingle=n.knownFormat.getSingle,t.getSpecial=n.knownFormat.getSpecial,t.isKnownFormatDefined=n.knownFormat.isKnownFormatDefined},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shouldQuoteQualifier=t.resolvePosition=t.quoteQualifier=t.formatRowRange=t.formatRow=t.formatRangePos=t.formatQualifier=t.formatGridRangeA1=t.formatColRange=t.formatCol=t.formatCellPos=t.columnName=t.canonicaliseRowRange=t.canonicaliseRow=t.canonicaliseRangePos=t.canonicaliseColRange=t.canonicaliseCol=t.canonicaliseCellPos=t.canonicaliseBrackets=void 0;var n=r(3);t.canonicaliseBrackets=n.cellFormat.canonicaliseBrackets,t.canonicaliseCellPos=n.cellFormat.canonicaliseCellPos,t.canonicaliseCol=n.cellFormat.canonicaliseCol,t.canonicaliseColRange=n.cellFormat.canonicaliseColRange,t.canonicaliseRangePos=n.cellFormat.canonicaliseRangePos,t.canonicaliseRow=n.cellFormat.canonicaliseRow,t.canonicaliseRowRange=n.cellFormat.canonicaliseRowRange,t.columnName=n.cellFormat.columnName,t.formatCellPos=n.cellFormat.formatCellPos,t.formatCol=n.cellFormat.formatCol,t.formatColRange=n.cellFormat.formatColRange,t.formatGridRangeA1=n.cellFormat.formatGridRangeA1,t.formatQualifier=n.cellFormat.formatQualifier,t.formatRangePos=n.cellFormat.formatRangePos,t.formatRow=n.cellFormat.formatRow,t.formatRowRange=n.cellFormat.formatRowRange,t.quoteQualifier=n.cellFormat.quoteQualifier,t.resolvePosition=n.cellFormat.resolvePosition,t.shouldQuoteQualifier=n.cellFormat.shouldQuoteQualifier},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.maxRetriesForLoadingScript=t.isCalcInit=t.initCalcThread=t.initCalcInThread=t.initCalcCalled=t.initCalc=t.getCalcAbsUrlOrThrow=t.getCalcAbsUrl=void 0;var n=r(7);t.getCalcAbsUrl=n.config.getCalcAbsUrl,t.getCalcAbsUrlOrThrow=n.config.getCalcAbsUrlOrThrow,t.initCalc=n.config.initCalc,t.initCalcCalled=n.config.initCalcCalled,t.initCalcInThread=n.config.initCalcInThread,t.initCalcThread=n.config.initCalcThread,t.isCalcInit=n.config.isCalcInit,t.maxRetriesForLoadingScript=n.config.maxRetriesForLoadingScript},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.randomElement=t.randomShuffled=t.randomIndex=t.randomFloat=void 0;var n=r(7);t.randomFloat=n.testUtil.randomFloat,t.randomIndex=n.testUtil.randomIndex,t.randomShuffled=n.testUtil.randomShuffled,t.randomElement=n.testUtil.randomElement},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createArrayLogger=void 0;var n=r(7);t.createArrayLogger=n.arrayLogger.createArrayLogger},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FuncContextMock=void 0;var n=r(201),i=r(52),a=r(134),o=r(60),s=function(){function e(e){this.config=e,this.formatter=(0,n.createNumberFormatter)({config:this.config}),this.mathpack=this.config.mathpack,this.datepack=this.config.datepack}return Object.defineProperty(e.prototype,"calcingArray",{get:function(){throw new Error("Method not implemented.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"originGridCell",{get:function(){throw new Error("Method not implemented.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"originSheet",{get:function(){throw new Error("Method not implemented.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"reflectionGridCell",{get:function(){throw new Error("Method not implemented.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"reflectionSheet",{get:function(){throw new Error("Method not implemented.")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"followHyperlinks",{get:function(){throw new Error("Method not implemented.")},enumerable:!1,configurable:!0}),e.prototype.applyFunction=function(e,t){throw new Error("Method not implemented.")},e.prototype.applyLambda=function(e,t){throw new Error("Method not implemented.")},e.prototype.handleEvaluationError=function(e){throw new Error("Method not implemented.")},e.prototype.coerceOper=function(e,t){throw new Error("Method not implemented.")},e.prototype.parseGeneral=function(e,t){var r,n=this.formatter.parseGeneral(e,!1,t,a.GetTimeKind.NonVolatile);return(0,o.isSuccess)(n)||(0,i.throwEvaluationError)(n.reason),null===(r=n.value)||void 0===r?void 0:r.value},e.prototype.parseDate=function(e){var t,r=this.formatter.parseDate(e,a.GetTimeKind.NonVolatile);return(0,o.isSuccess)(r)||(0,i.throwEvaluationError)(r.reason),null===(t=r.value)||void 0===t?void 0:t.value},e.prototype.getCellFormula=function(e){throw new Error("Method not implemented.")},e.prototype.getSheetIndex=function(e,t){throw new Error("Method not implemented.")},e.prototype.getSheetRangePosition=function(e){throw new Error("Method not implemented.")},e.prototype.getSheetRangeIndexes=function(e){throw new Error("Method not implemented.")},e.prototype.getNameFormula=function(e,t){throw new Error("Method not implemented.")},e.prototype.getCellRef=function(e,t,r,n){throw new Error("Method not implemented.")},e.prototype.getStructRef=function(e,t,r){throw new Error("Method not implemented.")},e.prototype.dereferenceAllOpers=function(){throw new Error("Method not implemented.")},e.prototype.dereferenceAllOpersAndFormulae=function(){throw new Error("Method not implemented.")},e.prototype.dereferenceOper=function(e,t){throw new Error("Method not implemented.")},e.prototype.dereferenceOpers=function(e,t){throw new Error("Method not implemented.")},e.prototype.isInFilterMode=function(){throw new Error("Method not implemented.")},e.prototype.printFormula=function(e,t){throw new Error("Method not implemented.")},e.prototype.getBinaryOperator=function(e){throw new Error("Method not implemented.")},e.prototype.getUnaryOperator=function(e){throw new Error("Method not implemented.")},e.prototype.parseFormula=function(e,t,r,n){throw new Error("Method not implemented.")},e.prototype.applyFormat=function(e,t,r){throw new Error("Method not implemented.")},e.prototype.getRandom=function(){throw new Error("Method not implemented.")},e.prototype.getTime=function(e){throw new Error("Method not implemented.")},e}();t.FuncContextMock=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.detect_errors=void 0;var n=r(279),i=r(280),a=r(205),o=r(153);function s(e,t){for(var r=e[0],n=e[1],i=t[0],a=t[1],o=[],s=r;s<=i;s++)for(var u=n;u<=a;u++)o.push([s,u,0]);return o}t.detect_errors=function(e,t,r,u){void 0===u&&(u=1/0),t=null!=t?t:i.Colorize.getFormattingDiscount(),r=null!=r?r:i.Colorize.getReportingThreshold(),o.watchdog.arm(u);for(var c={},l=0,d=e.worksheets.map((function(e){if((0,o.watchdog)("wd0x8d98cc"),0===e.formulas.length&&0===e.values.length)return{name:"",out:null};var u=e.usedRangeAddress;u=u.replace(/!(!+)/,"!");var c=new a.Timer("excelint"),l=i.Colorize.process_suspicious(u,e.formulas,e.values),d=(l[0],l[1],l[2],l[3]);(0,o.watchdog)("wd0x7919b4");var f=c.elapsedTime(),p=i.Colorize.adjust_proposed_fixes(d,e.styles,0,0),m=c.elapsedTime(),h=p.map((function(e){(0,o.watchdog)("wd0xfb8f16");var n=e[0],a=e[1],s=e[2],u=e[3],c=-n;return u||(c*=(100-t)/100),100*c>=r?(0,i.tuple)(c,a,s,u):null})).filter((function(e){return null!==e})),v=function(e,t){return(t[0]-e[0]+1)*(t[1]-e[1]+1)*(t[2]-e[2]+1)},g=c.elapsedTime(),b=h.map((function(t){(0,o.watchdog)("wd0x2375dd");for(var r=t[1][0][0]===t[2][0][0]?"vertical":"horizontal",i=[],a=[],s=[],u=[],c=[],l=[],d=[],f=[],p=[],m=t[3],h=[v.apply(void 0,t[1]),v.apply(void 0,t[2])],g=0;g<2;g++){var b=t[g+1][0],S=b[1]-1,y=b[0]-1,O=e.formulas[S][y],C=n.ExcelUtils.numeric_constants(O);c.push(C),l.push(l.reduce((function(e,t){return e+t}),0));var P=n.ExcelUtils.all_cell_dependencies(O,y+1,S+1,!1);d.push(P.length);var N=n.ExcelUtils.formulaToR1C1(O,y+1,S+1),R=n.ExcelUtils.column_index_to_name(y+1)+(S+1)+":",k=R+N;s.push(N),u.push(k),i.push(O),a.push(R+O),f.push((O.match(/\$/g)||[]).length),p.push(P)}var T=Math.abs(l[0]-l[1]),E=[];for(g=0;g<p.length;g++)if(p[g].length>0){if("vertical"===r&&0===p[g][0][0]&&-1===p[g][0][1]){E.push("recurrent-formula");break}if("horizontal"===r&&-1===p[g][0][0]&&0===p[g][0][1]){E.push("recurrent-formula");break}}d[0]!==d[1]&&E.push("different-referent-count"),c[0].length!==c[1].length&&(1===Math.abs(c[0].length-c[1].length)?E.push("one-extra-constant"):E.push("number-of-constants-mismatch")),c[0].length>0&&c[1].length>0&&(d[0]+d[1]===0?E.push("both-constants"):d[0]*d[1]==0&&E.push("one-is-all-constants")),s[0]!==s[1]&&JSON.stringify(p[0].sort())!==JSON.stringify(p[1].sort())&&E.push("r1c1-mismatch"),f[0]!==f[1]&&E.push("absolute-ref-mismatch");for(g=0;g<p.length;g++)if(p[g].length>0&&p[g][0][0]*p[g][0][1]!=0){E.push("off-axis-reference");break}return E===[]&&E.push("unclassified"),{bin:E,direction:r,sameFormat:m,rangeSizes:h,numbers:l,sameConstants:c[0]===c[1],numeric_difference:T,magnitude_numeric_difference:0===T?0:Math.log10(T),formulas:a,r1c1formulas:u,dependence_vectors:p}})),S=c.elapsedTime(),y=e.formulas.flat().filter((function(e){return e.length>0})).length,O=e.values.flat().filter((function(e){return e.length>0})).length,C=e.values[0].length,P=e.values.length,N=P*C,R=h.map((function(e){return e[0]})).reduce((function(e,t){return e+t}),0),k=h.map((function(e){return(0,o.watchdog)("wd0xbcc23c"),e[0]>=r/100?s(e[1][0],e[1][1]).concat(s(e[2][0],e[2][1])):[]})),T=Array.from(new Set(k.flat(1).map((function(e){return JSON.stringify(e)}))));k=T.map((function(e){return JSON.parse(e)}));var E=c.elapsedTime(),_={suspiciousnessThreshold:r,formattingDiscount:t,proposedFixes:h,exampleFixes:b,suspiciousRanges:h.length,weightedSuspiciousRanges:R,suspiciousCells:k.length,elapsedTimeSeconds:E/1e3,proposedFixesTimeSeconds:f/1e3,adjustProposedFixesTimeSeconds:(m-f)/1e3,adjustFormatProposedFixesTimeSeconds:(g-m)/1e3,exampleFixesTimeSeconds:(S-g)/1e3,numCountingTimeSeconds:(E-S)/1e3,columns:C,rows:P,totalCells:N,numFormulaCells:y,numValueCells:O};return{name:e.sheetName,out:_}})).filter((function(e){return null!==e.out}));l<d.length;l++){var f=d[l],p=f.name,m=f.out;c[p]=m}return{workbookName:e.workbookName,worksheets:c}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RectangleUtils=void 0;var n=function(){function e(){}return e.is_adjacent=function(e,t){var r=e[0],n=r[0],i=r[1],a=(r[2],e[1]),o=a[0],s=a[1],u=(a[2],t[0]),c=u[0],l=u[1],d=(u[2],t[1]),f=d[0],p=d[1];d[2];return!(n-f>1||c-o>1||i-p>1||l-s>1)},e.bounding_box=function(e,t){var r=e[0],n=r[0],i=r[1],a=(r[2],e[1]),o=a[0],s=a[1],u=(a[2],t[0]),c=u[0],l=u[1],d=(u[2],t[1]),f=d[0],p=d[1];d[2];return[[Math.min(n,c),Math.min(i,l),0],[Math.max(o,f),Math.max(s,p),0]]},e.area=function(e){var t=e[0],r=t[0],n=t[1],i=(t[2],e[1]),a=i[0],o=i[1];i[2];return(a-r+1)*(o-n+1)},e.diagonal=function(e){var t=e[0],r=t[0],n=t[1],i=(t[2],e[1]),a=i[0],o=i[1],s=(i[2],a-r+1),u=o-n+1;return Math.sqrt(s*s+u*u)},e.overlap=function(e,t){var r=e[0],n=r[0],i=r[1],a=(r[2],e[1]),o=a[0],s=a[1],u=(a[2],t[0]),c=u[0],l=u[1],d=(u[2],t[1]),f=d[0],p=d[1];d[2];return(o>f?f-n+1:o-c+1)*(s>p?p-i+1:s-l+1)},e.is_mergeable=function(t,r){return e.is_adjacent(t,r)&&e.area(t)+e.area(r)-e.overlap(t,r)===e.area(e.bounding_box(t,r))},e}();t.RectangleUtils=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JSONclone=void 0;var n=function(){function e(){}return e.clone=function(t){if(t){if(Array.isArray(t))return t.slice();if(t.constructor===Object){for(var r={},n=0,i=Object.keys(t);n<i.length;n++){var a=i[n];r[a]=e.clone(t[a])}return r}return t}return null},e}();t.JSONclone=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.find_all_proposed_fixes=void 0;var n=r(389),i=r(280),a=r(153);function o(e,t){var r=e[0],n=(e[1],t[0]);t[1];return r[0]!==n[0]?r[0]-n[0]:r[1]-n[1]}function s(e,t){for(var r=0;r<3;r++){if(e[r]<t[r])return-1;if(e[r]>t[r])return 1}return 0}function u(e,t,r,a,o,u,c,l,d,f){var p,m,h,v=t[0],g=t[1],b=[],S=(0,n.binsearch)(d,t,(function(e,t){return e[0][0]-t[0][0]})),y=(0,n.binsearch)(f,t,(function(e,t){return e[0][1]-t[0][1]}));S>y?(p=a,h=S,m=0):(p=o,h=y,m=1),h>0&&(h-=1);for(var O=function(r){var a=p[r];if(a===e)return"continue";var o=l[a];if(0===m){if(g[0]+1<o[0][0])return"break"}else if(g[1]+1<o[0][1])return"break";if(g[0]+1<o[0][0]||g[1]+1<o[0][1]||o[1][0]+1<v[0]||o[1][1]+1<v[1]);else{var d=function(e,t,r,i){var a=e[0],o=e[1],u=t[0],c=t[1],l=[a-1,c,0],d=[u,o-1,0],f=[u+1,o,0],p=[a,c+1,0],m=[],h=-1;if(-1!==(h=(0,n.strict_binsearch)(i,l,s))&&r[h][1]===o){var v=[r[h],i[h]];m.push(v)}if(-1!==(h=(0,n.strict_binsearch)(i,d,s))&&r[h][0]===a){v=[r[h],i[h]];m.push(v)}if(-1!==(h=(0,n.strict_binsearch)(r,f,s))&&i[h][1]===c){v=[r[h],i[h]];m.push(v)}if(-1!==(h=(0,n.strict_binsearch)(r,p,s))&&i[h][0]===u){v=[r[h],i[h]];m.push(v)}return m}(v,g,u[a],c[a]);d.length>0&&(b=b.concat(d.map((function(r,n,o){return[i.Colorize.fix_metric(parseFloat(e),t,parseFloat(a),r),t,r]}))))}},C=h;C<p.length;C++){if("break"===O(C))break}return b}function c(e,t){for(var r=e.map((function(e,t){return{item:e,index:t}})).sort((function(e,r){return t(e.item,r.item)||e.index-r.index})).map((function(e){return e.item})),n=0;n<e.length;n+=1)e[n]=r[n];return e}t.find_all_proposed_fixes=function(e){var t=[],r={};!function(e,t){for(var r=0,n=Object.keys(e);r<n.length;r++){var i=n[r];(0,a.watchdog)("wd0xa287cd"),t[i]=e[i].sort(o).map((function(e,t,r){return[e[0].map((function(e,t,r){return Number(e)})),e[1].map((function(e,t,r){return Number(e)}))]}))}}(e,r);for(var n={},i={},l=0,d=Object.keys(e);l<d.length;l++){var f=d[l];(0,a.watchdog)("wd0xb02b87"),n[f]=r[f].map((function(e,t,r){var n=e[0];e[1];return n})),i[f]=r[f].map((function(e,t,r){e[0];return e[1]}))}var p=function(e){for(var t={},r=0,n=Object.keys(e);r<n.length;r++){for(var i=n[r],a=1e6,o=1e6,s=-1e6,u=-1e6,c=0;c<e[i].length;c++){var l=e[i][c][0][0],d=e[i][c][1][0],f=e[i][c][0][1],p=e[i][c][1][1];d>s&&(s=d),l<a&&(a=l),p>u&&(u=p),f<o&&(o=f)}t[i]=[[a,o,0],[s,u,0]]}return t}(e),m=Object.keys(e);c(m,(function(e,t){return p[e][0][0]-p[t][0][0]}));var h=m.map((function(e,t,r){return p[e]})),v=Object.keys(e);c(v,(function(e,t){return p[e][0][1]-p[t][0][1]}));for(var g,b=v.map((function(e,t,r){return p[e]})),S=0,y=Object.keys(e);S<y.length;S++){f=y[S];for(var O=0;O<r[f].length;O++){(0,a.watchdog)("wd0xe37031");var C=u(f,r[f][O],0,m,v,n,i,p,h,b);t=t.concat(C)}}return t=t.map((function(e,t,r){return s(e[1],e[2])<0?[e[0],e[2],e[1]]:[e[0],e[1],e[2]]})),g={},t=t.filter((function(e){return!(g[e]=e in g)}))}},function(e,t,r){"use strict";function n(e,t,r){for(var n=0,i=e.length;n<i;){var a=Math.floor((n+i)/2);r(e[a],t)<0?n=a+1:i=a}return n}Object.defineProperty(t,"__esModule",{value:!0}),t.strict_binsearch=t.binsearch=void 0,t.binsearch=function(e,t,r){return void 0===r&&(r=void 0),void 0===r&&(r=function(e,t){return e===t?0:e<t?-1:1}),n(e,t,r)},t.strict_binsearch=function(e,t,r){void 0===r&&(r=void 0);var i=n(e,t,r);return i===e.length||0!==r(e[i],t)?-1:i}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Stencil=t.InfoGain=void 0;var n=function(){function e(){}return e.normalized_entropy=function(e){for(var t=e.reduce((function(e,t){return e+t}),0),r=0,n=0;n<e.length;n++){var i=e[n]/t;0!==i&&(r-=i*Math.log2(i))}return r/Math.log2(t)},e}();t.InfoGain=n;var i=function(){function e(){}return e.initialize=function(){if(!e.initialized){if(e.stencil_right=e.stencil.filter((function(e){var t=e[0];e[1];return t<=0})),e.stencil_left=e.stencil.filter((function(e){var t=e[0];e[1];return t>=0})),e.stencil_top=e.stencil.filter((function(e){e[0];return e[1]>=0})),e.stencil_bottom=e.stencil.filter((function(e){e[0];return e[1]<=0})),e.stencil_topleft=e.stencil_top.filter((function(e){var t=e[0];e[1];return t>=0})),e.stencil_topright=e.stencil_top.filter((function(e){var t=e[0];e[1];return t<=0})),e.stencil_bottomleft=e.stencil_bottom.filter((function(e){var t=e[0];e[1];return t>=0})),e.stencil_bottomright=e.stencil_bottom.filter((function(e){var t=e[0];e[1];return t<=0})),e.reflectStencils){var t=void 0;t=e.stencil.filter((function(e){var t=e[0];e[1];return t>0})).map((function(e){return[-e[0],e[1]]})),e.stencil_right=e.stencil_right.concat(t),t=e.stencil.filter((function(e){var t=e[0];e[1];return t<0})).map((function(e){return[-e[0],e[1]]})),e.stencil_left=e.stencil_left.concat(t),t=e.stencil.filter((function(e){e[0];return e[1]<0})).map((function(e){return[e[0],-e[1]]})),e.stencil_top=e.stencil_top.concat(t),t=e.stencil.filter((function(e){e[0];return e[1]>0})).map((function(e){return[e[0],-e[1]]})),e.stencil_bottom=e.stencil_bottom.concat(t),t=e.stencil_top.filter((function(e){var t=e[0];e[1];return t<0})).map((function(e){return[-e[0],e[1]]})),e.stencil_topleft=e.stencil_topleft.concat(t),t=e.stencil_left.filter((function(e){e[0];return e[1]<0})).map((function(e){return[e[0],-e[1]]})),e.stencil_topleft=e.stencil_topleft.concat(t),e.stencil_topleft.splice(e.stencil_topleft.findIndex((function(e){return JSON.stringify(e)===JSON.stringify([1,1])})),1),t=e.stencil_top.filter((function(e){var t=e[0];e[1];return t>0})).map((function(e){return[-e[0],e[1]]})),e.stencil_topright=e.stencil_topright.concat(t),t=e.stencil_right.filter((function(e){e[0];return e[1]<0})).map((function(e){return[e[0],-e[1]]})),e.stencil_topright=e.stencil_topright.concat(t),e.stencil_topright.splice(e.stencil_topright.findIndex((function(e){return JSON.stringify(e)===JSON.stringify([-1,1])})),1),t=e.stencil_bottom.map((function(e){return[-e[0],e[1]]})).filter((function(e){var t=e[0];e[1];return t>0})),e.stencil_bottomleft=e.stencil_bottomleft.concat(t),t=e.stencil_left.map((function(e){return[e[0],-e[1]]})).filter((function(e){e[0];return e[1]<0})),e.stencil_bottomleft=e.stencil_bottomleft.concat(t),e.stencil_bottomleft.splice(e.stencil_bottomleft.findIndex((function(e){return JSON.stringify(e)===JSON.stringify([1,-1])})),1),t=e.stencil_bottom.map((function(e){return[-e[0],e[1]]})).filter((function(e){var t=e[0];e[1];return t<0})),e.stencil_bottomright=e.stencil_bottomright.concat(t),t=e.stencil_right.map((function(e){return[e[0],-e[1]]})).filter((function(e){e[0];return e[1]<0})),e.stencil_bottomright=e.stencil_bottomright.concat(t),e.stencil_bottomright.splice(e.stencil_bottomright.findIndex((function(e){return JSON.stringify(e)===JSON.stringify([-1,-1])})),1)}e.initialized=!0}},e.apply_stencil=function(t,r,n,i,a,o){if(t.length!==e.stencil.length)throw Error("Length mismatched");for(var s=a,u=0;u<t.length;u++){var c=t[u],l=c[0];s=o(s,r[n+c[1]][i+l])}return s},e.stencil_computation=function(t,r,n){e.initialize();for(var i=t.length,a=t[0].length,o=Array(i).fill(0).map((function(){return Array(a).fill(0)})),s=1;s<a-1;s++)for(var u=1;u<i-1;u++)o[u][s]=e.apply_stencil(e.stencil,t,s,u,n,r);for(u=1;u<a-1;u++)o[0][u]=e.apply_stencil(e.stencil_top,t,0,u,n,r),o[i-1][u]=e.apply_stencil(e.stencil_bottom,t,i-1,u,n,r);for(s=1;s<i-1;s++)o[s][0]=e.apply_stencil(e.stencil_left,t,s,0,n,r),o[s][a-1]=e.apply_stencil(e.stencil_right,t,s,a-1,n,r);return o[0][0]=e.apply_stencil(e.stencil_topleft,t,0,0,n,r),o[0][a-1]=e.apply_stencil(e.stencil_topright,t,0,a-1,n,r),o[i-1][0]=e.apply_stencil(e.stencil_bottomleft,t,i-1,0,n,r),o[i-1][a-1]=e.apply_stencil(e.stencil_bottomright,t,i-1,a-1,n,r),o},e.reflectStencils=!0,e.ninePointStencil=[[-1,-1],[-1,0],[-1,1],[0,-1],[0,0],[0,1],[1,-1],[1,0],[1,1]],e.stencil=e.ninePointStencil,e.initialized=!1,e}();t.Stencil=i},function(e,t,r){(function(e){var n;/*! https://mths.be/punycode v1.3.2 by @mathias */!function(i){t&&t.nodeType,e&&e.nodeType;var a="object"==typeof global&&global;a.global!==a&&a.window!==a&&a.self;var o,s=2147483647,u=/^xn--/,c=/[^\x20-\x7E]/,l=/[\x2E\u3002\uFF0E\uFF61]/g,d={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},f=Math.floor,p=String.fromCharCode;function m(e){throw RangeError(d[e])}function h(e,t){for(var r=e.length,n=[];r--;)n[r]=t(e[r]);return n}function v(e,t){var r=e.split("@"),n="";return r.length>1&&(n=r[0]+"@",e=r[1]),n+h((e=e.replace(l,".")).split("."),t).join(".")}function g(e){for(var t,r,n=[],i=0,a=e.length;i<a;)(t=e.charCodeAt(i++))>=55296&&t<=56319&&i<a?56320==(64512&(r=e.charCodeAt(i++)))?n.push(((1023&t)<<10)+(1023&r)+65536):(n.push(t),i--):n.push(t);return n}function b(e){return h(e,(function(e){var t="";return e>65535&&(t+=p((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+=p(e)})).join("")}function S(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function y(e,t,r){var n=0;for(e=r?f(e/700):e>>1,e+=f(e/t);e>455;n+=36)e=f(e/35);return f(n+36*e/(e+38))}function O(e){var t,r,n,i,a,o,u,c,l,d,p,h=[],v=e.length,g=0,S=128,O=72;for((r=e.lastIndexOf("-"))<0&&(r=0),n=0;n<r;++n)e.charCodeAt(n)>=128&&m("not-basic"),h.push(e.charCodeAt(n));for(i=r>0?r+1:0;i<v;){for(a=g,o=1,u=36;i>=v&&m("invalid-input"),((c=(p=e.charCodeAt(i++))-48<10?p-22:p-65<26?p-65:p-97<26?p-97:36)>=36||c>f((s-g)/o))&&m("overflow"),g+=c*o,!(c<(l=u<=O?1:u>=O+26?26:u-O));u+=36)o>f(s/(d=36-l))&&m("overflow"),o*=d;O=y(g-a,t=h.length+1,0==a),f(g/t)>s-S&&m("overflow"),S+=f(g/t),g%=t,h.splice(g++,0,S)}return b(h)}function C(e){var t,r,n,i,a,o,u,c,l,d,h,v,b,O,C,P=[];for(v=(e=g(e)).length,t=128,r=0,a=72,o=0;o<v;++o)(h=e[o])<128&&P.push(p(h));for(n=i=P.length,i&&P.push("-");n<v;){for(u=s,o=0;o<v;++o)(h=e[o])>=t&&h<u&&(u=h);for(u-t>f((s-r)/(b=n+1))&&m("overflow"),r+=(u-t)*b,t=u,o=0;o<v;++o)if((h=e[o])<t&&++r>s&&m("overflow"),h==t){for(c=r,l=36;!(c<(d=l<=a?1:l>=a+26?26:l-a));l+=36)C=c-d,O=36-d,P.push(p(S(d+C%O,0))),c=f(C/O);P.push(p(S(c,0))),a=y(r,b,n==i),r=0,++n}++r,++t}return P.join("")}o={version:"1.3.2",ucs2:{decode:g,encode:b},decode:O,encode:C,toASCII:function(e){return v(e,(function(e){return c.test(e)?"xn--"+C(e):e}))},toUnicode:function(e){return v(e,(function(e){return u.test(e)?O(e.slice(4).toLowerCase()):e}))}},void 0===(n=function(){return o}.call(t,r,t,e))||(e.exports=n)}()}).call(this,r(392)(e))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,r){"use strict";e.exports={isString:function(e){return"string"==typeof e},isObject:function(e){return"object"==typeof e&&null!==e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null==e}}},function(e,t,r){"use strict";t.decode=t.parse=r(395),t.encode=t.stringify=r(396)},function(e,t,r){"use strict";function n(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,r,i){t=t||"&",r=r||"=";var a={};if("string"!=typeof e||0===e.length)return a;var o=/\+/g;e=e.split(t);var s=1e3;i&&"number"==typeof i.maxKeys&&(s=i.maxKeys);var u=e.length;s>0&&u>s&&(u=s);for(var c=0;c<u;++c){var l,d,f,p,m=e[c].replace(o,"%20"),h=m.indexOf(r);h>=0?(l=m.substr(0,h),d=m.substr(h+1)):(l=m,d=""),f=decodeURIComponent(l),p=decodeURIComponent(d),n(a,f)?Array.isArray(a[f])?a[f].push(p):a[f]=[a[f],p]:a[f]=p}return a}},function(e,t,r){"use strict";var n=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,r,i){return t=t||"&",r=r||"=",null===e&&(e=void 0),"object"==typeof e?Object.keys(e).map((function(i){var a=encodeURIComponent(n(i))+r;return Array.isArray(e[i])?e[i].map((function(e){return a+encodeURIComponent(n(e))})).join(t):a+encodeURIComponent(n(e[i]))})).join(t):i?encodeURIComponent(n(i))+r+encodeURIComponent(n(e)):""}},function(e,t,r){"use strict";r.r(t);var n,i,a=r(4),o=r(9),s=r(35),u=r(155),c=r(7),l=r(42);(i=n||(n={})).fastMin=a.c,i.fastMax=a.b,i.fastAbs=a.a,i.identity=a.d,i.numEnumArray=a.k,i.numEnumMap=a.l,i.safePush=a.o,i.safeConcat=a.n,i.isDefined=a.e,i.isNone=a.f,i.makeStringMap=a.h,i.now=a.j,i.staticAssertExtends=a.q,i.staticAssertSame=a.t,i.staticAssertIs=a.r,i.staticAssertIsOptional=a.s,i.JSF32=c.JSF32,i.Pledge=l.a,i.assertNever=o.d,i.assertNatural=o.c,i.assertTrue=o.g,i.assertFalse=o.a,i.assertPositiveLength=o.f,i.assertPositiveInteger=o.e,i.assertIndex=o.b,i.messageFromError=s.c,i.isInteger=s.b,i.stringStartsWith=s.e,i.stringEndsWith=s.d,i.arrayFill=s.a,(i.ds||(i.ds={})).Deque=u.a;var d,f,p,m,h,v,g,b,S,y,O,C,P,N,R,k,T=r(37),E=r(0),_=r(8),F=r(30),I=r(11),A=r(1),M=r(85),w=r(3),D=(w.cellParse.SpecialPos,w.cellParse.isR1C1IdentStart,w.cellParse.parseCellRef,w.cellParse.parseGridCellA1),j=w.cellParse.parseGridRangeA1,x=(w.cellParse.wrapPosition,r(6)),L=r(12),B=r(56),U=r(107),G=r(33),K=r(28),V=r(100),W=r(94),H=w.mathpack.formatScientificLeft,q=w.mathpack.numberComponents,z=w.mathpackIEEE.ieeeMathpack,Q=r(156),J=r(45),Y=r(21),$=w.annotations.buildAnnotations,Z=w.relabel.relabelFormula;(f=d||(d={})).LexicalKind=_.a,f.NameSource=_.b,f.sheetRows=_.x,f.sheetCols=_.q,f.lexicalSourceCell=_.h,f.lexicalSourceRange=_.k,f.lexicalSourceGrid=_.i,f.lexicalSourceName=_.j,f.lexicalSourceWSF=_.m,f.lexicalSourceUDF=_.l,f.documentLoc=_.d,f.structRefColumnLoc=_.y,f.sheetIndex=_.u,f.sheetRange=_.v,f.gridCell=_.f,f.gridRange=_.g,f.allSheetsRange=_.c,f.sheetRangeIndexes=_.w,f.sheetGridCell=_.r,f.sheetGridRange=_.t,f.sheetGridCube=_.s,f.originCell=_.p,f.documentScope=_.e,f.nameLoc=_.n,f.nameScope=_.o,f.userDefinedFuncLoc=_.z,(m=p||(p={})).SpecialPrecs=Y.d,m.PrecsBound=F.b,m.OperKind=Y.b,m.trueOper=F.u,m.falseOper=F.h,m.ErrorType=F.a,m.precedents=F.p,m.stringOper=F.t,m.booleanOper=F.e,m.errorOper=F.g,m.nullErrorOper=F.n,m.div0ErrorOper=F.f,m.valueErrorOper=F.v,m.refErrorOper=F.s,m.nameErrorOper=F.m,m.numErrorOper=F.o,m.naErrorOper=F.l,m.gettingDataErrorOper=F.j,m.fieldErrorOper=F.i,m.arrayOper=F.c,m.rangeSeqOper=F.r,m.range3DOper=F.q,m.missingOper=F.k,m.blankOper=F.d,(v=h||(h={})).RefStyle=I.h,v.QualifierKind=I.g,v.CellRefKind=I.c,v.PosKind=I.f,v.NodeKind=I.e,v.NamePartKind=I.d,v.SpecialRefId=I.i,v.StructRefKind=I.j,v.BadType=I.b,v.errorQualifier=I.B,v.relativeQualifier=I.fb,v.documentQualifier=I.A,v.sheetQualifier=I.gb,v.identQualifier=I.N,v.sheetRangeQualifier=I.hb,v.badQualifier=I.o,v.pos=I.db,v.cellRefError=I.s,v.cellRefSingle=I.x,v.cellRefRange=I.v,v.cellRefRow=I.w,v.cellRefCol=I.r,v.cellRefBad=I.q,v.formula=I.I,v.formulaSpan=I.K,v.literalNode=I.T,v.arrayNode=I.m,v.appNode=I.l,v.flattenLetArgs=I.G,v.indexedArg=I.O,v.letVar=I.S,v.letNode=I.R,v.flattenLambdaArgs=I.F,v.paramName=I.ab,v.paramDefault=I.Z,v.paramNode=I.bb,v.lambdaParam=I.Q,v.lambdaNode=I.P,v.operatorNode=I.Y,v.wsfNode=I.mb,v.parenNode=I.cb,v.nameNode=I.X,v.identNamePart=I.M,v.cellRefNamePart=I.t,v.fieldRefNamePart=I.D,v.cellRefNode=I.u,v.fieldRefNode=I.E,v.fieldRef=I.C,v.structRefNode=I.kb,v.structRef=I.jb,v.specialRef=I.ib,v.columnRef=I.y,v.rangeOpRef=I.eb,v.commaOpRef=I.z,v.thisRowOpRef=I.lb,v.missingRef=I.W,v.badRef=I.p,v.badNode=I.n,v.flattenNameParts=I.H,v.headNamePart=I.L,v.AnnotationKind=I.a,v.appHeadNameAnnotation=I.k,v.formulaRootAnnotation=I.J,v.localNameUseAnnotation=I.V,v.localNameDeclAnnotation=I.U,(b=g||(g={})).SignatureType=Y.c,b.FunctionFlags=Y.a,b.OperatorId=A.a,b.WorksheetFuncId=A.b,b.SpecialPrecs=Y.d,b.functionType=Y.e,b.unknownFunctionType=A.f,b.getOperatorType=A.c,b.getWorksheetFuncType=A.d,(y=S||(S={})).isSheetIndex=x.P,y.isSheetGridRange=x.N,y.isGridCell=x.z,y.isSheetGridCell=x.L,y.forEachCellInRange=x.d,y.gridRangeJoin=x.p,y.gridRangeJoinOpt=x.q,y.gridRangesJoin=x.s,y.gridRangeIsect=x.n,y.gridRangeIsects=x.o,y.gridCellImplicitIsect=x.i,y.gridRangeCompare=x.l,y.gridRangeExcept=x.m,y.gridRangeSize=x.r,y.isDocumentLocEqual=x.x,y.isSheetIndexEqual=x.Q,y.isNameScopeEqual=x.D,y.isGridCellEqual=x.A,y.isGridRangeEqual=x.B,y.isSheetGridCellEqual=x.M,y.isSheetGridRangeEqual=x.O,y.isWellFormed=x.V,y.isUnqualifiedNameNode=x.S,y.isOperatorNode=x.G,y.isWSFNode=x.U,y.gridRangeAnchor=x.k,y.sheetGridRangeAnchor=x.Y,y.gridCellRange=x.j,y.getArguments=x.g,y.getArgType=x.f,y.isValidArgsLength=x.T,y.isNumberOper=x.F,y.isStringOper=x.R,y.isBooleanOper=x.w,y.isErrorOper=x.y,y.isRangeOper=x.I,y.isArrayOper=x.u,y.isMissingOper=x.C,y.isBlankOper=x.v,y.isRichOper=x.K,y.isPrimitiveOper=x.H,y.isWriteOper=x.W,y.isReadOperEqual=x.J,y.ResultKind=E.a,y.success=E.e,y.failure=E.b,y.successUndefined=E.f,y.isSuccess=E.c,y.ReasonKind=x.b,y.notImplemented=x.X,y.unavailable=x.Z,y.internal=x.t,y.javaScriptError=E.d,y.createFailureErrorClass=x.c,y.columnName=M.a,y.formatRow=M.f,y.formatCol=M.c,y.formatRowRange=M.g,y.formatColRange=M.d,y.formatCellPos=M.b,y.formatGridRangeA1=M.e,y.parseGridCellA1=D,y.parseGridRangeA1=j,y.getSubExpressionFromPosition=x.h,y.resolveLocalsGrid=G.k,y.ResolveReasonKind=G.d,y.noOriginSheet=G.j,y.invalidQualifier=G.h,y.InvalidQualifierReason=G.b,y.invalidCellRef=G.g,y.InvalidCellRefReason=G.a,y.invalidStructRef=G.i,y.InvalidStructRefReason=G.c,y.emptyIntersection=G.f,y.ResolvedKind=G.e,y.resolvedName=G.o,y.resolvedCellRef=G.l,y.resolvedUserDefinedFunc=G.r,y.resolvedLocalName=G.n,y.resolvedStructRef=G.q,y.resolvedNever=G.p,y.resolvedDottedName=G.m,y.createResolver=U.a,y.resolveGridRef=U.b,y.visitFormulaNode=K.n,y.visitOperatorNode=K.o,y.visitWSFNode=K.q,y.visitAppHeadNode=K.l,y.visitQualifier=K.p,y.visitCellRef=K.m,y.IdentityVisitor=K.e,y.identityVisitor=K.i,y.ConstVisitor=K.c,y.constVisitor=K.h,y.voidVisitor=K.r,y.DelegatingVisitor=K.d,y.BinaryVisitor=K.a,y.binaryVisitor=K.f,y.ComposeVisitor=K.b,y.composeVisitor=K.g,y.reduceBottomUp=K.j,y.reducePledge=K.k,y.buildAnnotations=$,y.createSimplePrintGlobals=W.a,y.printLocalsGrid=W.b,y.printLocalsName=W.c,y.createPrinter=V.b,y.relabelFormula=Z,(C=O||(O={})).LogCategory=L.c,C.TraceLevel=L.i,C.NulLogger=L.d,C.ulsLogger=L.y,C.localeInfo=L.w,C.LCID=L.b,C.Country=L.a,C.PictureSpecial=L.h,C.PictureSingle=L.g,C.PictureColor=L.e,C.PictureDbnum=L.f,C.calcConfig=L.j,C.initCalc=B.c,C.getEnglishLocaleInfo=L.p,C.englishWorksheetFuncIdToName=L.o,C.englishErrorTypeToName=L.m,C.englishOperatorIdToName=L.n,C.operatorIdToName=L.x,C.createWorksheetFuncNameCallbacks=L.k,C.isCalcInit=B.g,C.getCalcAbsUrl=B.a,C.FeatureName=T.a,(N=P||(P={})).numberComponents=q,N.ieeeMathpack=z,N.xlMathpack=Q.a,N.formatScientificLeft=H,(k=R||(R={})).TimeDivision=J.b,k.Rounding=J.a,k.tzData=J.e,k.tzUTC=J.f,k.dateTime=J.d,k.TimeGranularity=J.c,k.xlDatepack=J.g;var X,ee,te=r(73),re=r(108),ne=r(20),ie=ne.parseResultHelperModule.ExtractLetVisitor,ae=ne.parseResultHelperModule.parseResultHelper;(ee=X||(X={})).createParseGlobals=te.b,ee.ReasonKind=te.a,ee.parseLocals=te.d,ee.notFormulaString=te.c,ee.createParser=re.a,ee.parseResultHelper=ae;var oe,se,ue=r(55),ce=r(93);(se=oe||(oe={})).analyzeLocalsGrid=ue.a,se.analyzeLocalsName=ue.b,se.diagnostics=ue.d,se.summarizeFormulaDiagnostics=ue.e,se.createAnalyzeGlobals=ue.c,se.createAnalyzer=ce.a;var le,de,fe=r(17),pe=r(47),me=r(125),he=r(77),ve=r(157),ge=r(120),be=r(22),Se=be.util.applyValueEdit,ye=(be.util.getFormatString,be.util.getValueEditOperKind),Oe=(be.util.initUtilGlobals,be.util.renderFormat,be.util.toXLNumber);(de=le||(le={})).FormatReasonKind=fe.g,de.ReasonKind=fe.m,de.notValueString=fe.C,de.notFormatString=fe.B,de.noFormatPart=fe.A,de.tooWide=fe.L,de.dateOverflow=fe.o,de.fractionOverflow=fe.w,de.previousFormatFailure=fe.F,de.FormatValueType=fe.h,de.BidiDate=fe.b,de.CultureTag=fe.d,de.FormatCurrency=fe.f,de.NamedColor=fe.k,de.Alignment=fe.a,de.GetTimeKind=fe.j,de.Clip=fe.c,de.FormattedUnitKind=fe.i,de.formattedUnitGeneral=fe.s,de.formattedUnitString=fe.t,de.formattedUnitBlank=fe.q,de.formattedUnitFlexible=fe.r,de.formattedValue=fe.u,de.renderedValue=fe.I,de.hashesValue=fe.x,de.isHashesValue=fe.y,de.renderCallback=fe.G,de.memoizedRenderCallback=fe.z,de.renderInfiniteWidth=fe.H,de.renderedValueToString=fe.J,de.EditKind=fe.e,de.formulaEdit=fe.v,de.stringEdit=fe.K,de.numberEdit=fe.D,de.otherEdit=fe.E,de.NumberFormatSource=fe.l,de.createFormatGlobals=fe.n,de.evalFormatLocalsGrid=fe.p,de.KnownFormat=pe.d,de.CurrencyFormat=pe.b,de.DateOrder=pe.c,de.NumberShape=pe.e,de.Calendar=pe.a,de.getKnownFormat=me.b,de.isKnownFormatDefined=me.c,de.englishXLSXKnownFormat=me.a,de.RibbonFormat=he.a,de.getRibbonFormat=he.b,de.shouldInstallFormat=ve.a,de.createNumberFormatter=ge.a,de.getValueEditOperKind=ye,de.applyValueEdit=Se,de.toXLNumber=Oe;var Ce,Pe,Ne,Re=r(19),ke=r(158),Te=r(159),Ee=r(25),_e=Ee.extensionTypes.DerefOperKind,Fe=(Ee.extensionTypes.isRangeValues,Ee.extensionTypes.machine),Ie=(Ee.extensionTypes.rangeValues,Ee.subexpressionEvaluation.getFormulaSubExpressionObject),Ae=Ee.subexpressionEvaluation.getSubExpressionFromFormulaCharacterIndex,Me=Ee.subexpressionEvaluation.getSubExpressionSpan,we=Ee.subexpressionEvaluation.getSubExpressionSubspans,De=Ee.subexpressionEvaluation.getSubstitutedSubExpressionString,je=Ee.subexpressionEvaluation.isFormulaSubExpressionVolatile;(Ne=Ce||(Ce={})).ReasonKind=Re.d,Ne.interval=Re.q,Ne.CellKind=Re.a,Ne.Interrupt=Re.b,Ne.finalValue=Re.n,Ne.pendingValue=Re.u,Ne.cellWellFormedFormula=Re.h,Ne.cellFormula=Re.g,Ne.userDefinedFunc=Re.y,Ne.stopped=Re.x,Ne.nameCycle=Re.s,Ne.cellCycle=Re.f,Ne.paused=Re.t,Ne.breaked=Re.e,Ne.previousFailure=Re.v,Ne.previousNameFailure=Re.w,Ne.evalGlobals=Re.l,Ne.evalLocals=Re.m,Ne.compileLocalsGrid=Re.i,Ne.compileLocalsName=Re.j,Ne.getEvalFailureReason=Re.o,Ne.illFormedFormula=Re.p,Ne.createCompileGlobals=Re.k,Ne.limitExceeded=Re.r,Ne.LimitKind=Re.c,Ne.createCompiler=ke.a,Ne.createEvaluator=Te.a,(Pe=Ne.extension||(Ne.extension={})).DerefOperKind=_e,Pe.machine=Fe,Ne.getSubExpressionFromFormulaCharacterIndex=Ae,Ne.getSubExpressionSpan=Me,Ne.getFormulaSubExpressionObject=Ie,Ne.getSubstitutedSubExpressionString=De,Ne.getSubExpressionSubspans=we,Ne.isFormulaSubExpressionVolatile=je;var xe=r(15),Le=r(2),Be=r(44),Ue=r(18),Ge=r(78),Ke=r(68),Ve=r(49),We=r(32),He=r(165);function qe(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=t[0],i=t[1];return Object(Le.__awaiter)(this,void 0,void 0,(function(){function t(e){void 0===e&&(e="Requested"),m=e,f.close()}var r,u,c,l,d,f,p,m,h,v,g,b,S,y,O=this;return Object(Le.__generator)(this,(function(C){switch(C.label){case 0:return r="boolean"==typeof n?n?[(new Ve.c).instance(),(new Ve.b).instance()]:[void 0,void 0]:[n,i],u=r[0],c=r[1],l=-1/0,d={onRecalcResults:function(e){},onUpdateRequest:function(e){},onGC:function(e){l=e}},[4,Be.createWorker({id:"RecalcService",createMode:e},{local:Ge.c,thread:{scriptUrl:Object(B.b)(),insideInitName:"excelOnlineCalc.calc.recalcServiceInsideInit"}},(function(){return d}))];case 1:f=C.sent(),p=[],m="Requested",f.onClose=function(){for(var e=0,t=p;e<t.length;e++){var r=t[e];try{r()}catch(e){o.h.ULS.traceTag(539341771,Ue.LogCategory.msoulscat_ES_EWAJS,Ue.TraceLevel.Warning,"calc.calc.createRecalcService.service.onClose: callback threw ".concat(Object(s.c)(e)))}}var n="calc.calc.createRecalcService.service.onClose: recalc service closed; reason = ".concat(m);o.h.ULS.traceTag(561534148,Ue.LogCategory.msoulscat_ES_EWAJS,"Requested"===m?Ue.TraceLevel.Info:Ue.TraceLevel.Warning,n)},C.label=2;case 2:return C.trys.push([2,5,,6]),"Thread"!==f.createMode?[3,4]:[4,Object(B.f)(f)];case 3:h=C.sent(),p.push((function(){return h.close()})),Object(T.c)(T.a.CalcWebWorkerTest)&&Object(He.b)(f.call.getMissingJSFeatures),C.label=4;case 4:return f.call.ping.callTimeout=3e4,v=3,g=0,b=function(){},Object(Ke.d)((function(){return Object(Le.__awaiter)(O,void 0,void 0,(function(){var e,r,n,i,s,u,c;return Object(Le.__generator)(this,(function(l){switch(l.label){case 0:return[4,new Promise((function(e){return setTimeout(e,1e3)}))];case 1:if(l.sent(),f.hasBeenClosed())return[2,void 0];e=f.call.ping.callTimeout,r=Object(a.j)(),l.label=2;case 2:return l.trys.push([2,4,,5]),[4,f.call.ping()];case 3:return l.sent(),[3,5];case 4:if(n=l.sent(),!Be.WorkerError.isWorkerError(n)||"Timeout"!==n.info.cause)throw n;return i=Object(a.j)()-r,(g+=1)>=v&&t("Unresponsive"),s=f.hasBeenClosed(),u={timeout:e,waitTime:i,timeoutCount:g,hasBeenClosed:s},c="calc.calc.RecalcService: unresponsive; ".concat(JSON.stringify(u)),o.h.ULS.traceTag(561534149,Ue.LogCategory.msoulscat_ES_EWAJS,Ue.TraceLevel.Warning,c),b(e,i,g,s),[2,!0];case 5:return g=0,[2,!0]}}))}))}),!0).catch((function(e){var t="calc.calc.RecalcService: ping loop threw an error: ".concat(Object(s.c)(e));o.h.ULS.traceTag(561534150,Ue.LogCategory.msoulscat_ES_EWAJS,Ue.TraceLevel.Warning,t)})),f.post.updateRanges.onPostMessageError=Be.dispatchWorkerError,S={setOnRecalcResults:function(e){d.onRecalcResults=e},setOnUpdateRequest:function(e){d.onUpdateRequest=e},setOnUnresponsive:function(e){b=e},setA1ReferenceStyle:function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];(e=f.post).setA1ReferenceStyle.apply(e,t),void 0!==u&&u.doNotify(We.a.setA1ReferenceStyle,t)},setLocale:function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];(e=f.post).setLocale.apply(e,t),void 0!==u&&u.doNotify(We.a.setLocale,t)},setWorkbookProps:function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];(e=f.post).setWorkbookProps.apply(e,t),void 0!==u&&u.doNotify(We.a.setWorkbookProps,t)},updateSheetNames:function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];(e=f.post).updateSheetNames.apply(e,t),void 0!==u&&u.doNotify(We.a.updateSheetNames,t)},updateNamedObjects:function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];(e=f.post).updateNamedObjects.apply(e,t),void 0!==u&&u.doNotify(We.a.updateNamedObjects,t)},setNumberFormats:f.post.setNumberFormats,updateUnusedCells:f.post.updateUnusedCells,updateRanges:f.post.updateRanges,updateArrays:f.post.updateArrays,editRangeFormulas:f.post.editRangeFormulas,editRangeFormats:f.post.editRangeFormats,editArrayFormulas:f.post.editArrayFormulas,editRangePaste:f.post.editRangePaste,resumeRecalc:f.post.resumeRecalc,reconfigure:function(e){var t,r;f.call.ping.callTimeout=null!==(t=e.responsivenessPingTimeout)&&void 0!==t?t:3e4,v=null!==(r=e.responsivenessPingAttempts)&&void 0!==r?r:3,f.post.reconfigure(e)},clearCache:function(){f.post.clearCache(),l=-1/0},testAdvanceState:f.post.testAdvanceState,testResumeRecalc:f.call.testResumeRecalc,close:t,stateIdAvailable:function(e){return e>=l},evalFormula:f.call.evalFormula,evalOnClonedModel:f.call.evalOnClonedModel,createIGridExportEndpoint:function(e,t){return p.push(t),f.call.createIGridExportEndpoint.transfer([e.port],e)}},void 0!==c&&c.onGridExporterCreated(S),[2,S];case 5:throw y=C.sent(),t("Error"),y;case 6:return[2]}}))}))}var ze,Qe,Je,Ye=r(31),$e=r(29),Ze=r(10),Xe=r(46),et=r(24),tt=r(14),rt=r(50),nt=r(84),it=r(27),at=r(16),ot=r(13),st=r(121),ut=r(61),ct=r(166),lt=r(123);(Je=ze||(ze={})).worksheetFunctionName=xe.nb,Je.errorTypeName=xe.r,Je.localeData=xe.G,Je.numberFormat=xe.Q,Je.sheetName=xe.fb,Je.blankValue=xe.j,Je.errorValue=xe.s,Je.richValue=xe.cb,Je.getCellValueKind=xe.D,Je.getCellFormatKind=xe.C,Je.cellLocation=xe.o,Je.rangeLocation=xe.V,Je.sheetRangeLocation=xe.gb,Je.sheetCellLocation=xe.eb,Je.cellData=xe.k,Je.cellFormulaCellData=xe.m,Je.arrayFormulaCellData=xe.e,Je.valueCellData=xe.kb,Je.rangeUpdate=xe.Y,Je.rangeWrite=xe.Z,Je.rangePromote=xe.X,Je.arrayData=xe.c,Je.arrayUpdate=xe.h,Je.arrayWrite=xe.i,Je.arrayPromote=xe.g,Je.unusedCellsUpdate=xe.ib,Je.namedValueData=xe.P,Je.namedFormulaData=xe.I,Je.namedRangeData=xe.N,Je.namedFailureData=xe.H,Je.namedObject=xe.J,Je.namedObjectsUpdate=xe.L,Je.namedObjectsWrite=xe.M,Je.undefinedNamesWrite=xe.hb,Je.namedObjectsPromote=xe.K,Je.namedTableData=xe.O,Je.columnData=xe.p,Je.rangeFormulaEdit=xe.U,Je.cellFormulaRangeFormulaEdit=xe.n,Je.valueRangeFormulaEdit=xe.lb,Je.inferredRangeFormulaEdit=xe.F,Je.RibbonFormat=xe.b,Je.formatEditOperation=xe.z,Je.formatEditSetFormat=xe.B,Je.formatEditRibbonFormat=xe.A,Je.formatEditChangeDecimals=xe.y,Je.rangeFormatEdit=xe.T,Je.arrayFormulaEdit=xe.f,Je.rangePasteEdit=xe.W,Je.copyPasteRangePasteEdit=xe.q,Je.inferredFormat=xe.E,Je.cellDataDelta=xe.l,Je.rangeDelta=xe.R,Je.arrayDelta=xe.d,Je.rangeFailure=xe.S,Je.recalcResults=xe.ab,Je.evalFormulaData=xe.t,Je.evalFormulaFormat=xe.u,Je.evalFormulaFormatOrigin=xe.x,Je.evalFormulaFormatIformat=xe.v,Je.evalFormulaFormatInferred=xe.w,Je.updateRequest=xe.jb,Je.runExperiment=xe.db,Je.recalcServiceConfig=xe.bb,Je.workbookProps=xe.mb,Je.createRecalcService=qe,Je.RecalcServiceCreateMode=xe.a,Je.localeInfoFromData=Ye.g,Je.cellValueToReadOper=Ye.b,Je.readOperToCellValue=Ye.j,Je.recalcServiceInsideInit=Ge.c,Je.getEvalResultKind=$e.d,Je.getEvalFailureReason=$e.c,Je.getTime=$e.e,Je.RecalcServiceDataTransformer=lt.a,(Qe=Je.internal||(Je.internal={})).PartialWorkbookDocumentCollection=Xe.a,Qe.VolatileMode=Xe.b,Qe.voidCallback=Xe.c,Qe.sheetCellSet=Ze.l,Qe.createSheetCellSetFromRange=Ze.h,Qe.ComputedCellKind=Ze.b,Qe.ComputeKind=Ze.a,Qe.SpecialStyle=Ze.g,Qe.SpecialFormat=Ze.f,Qe.UnavailableKind=et.e,Qe.CloningTarget=et.a,Qe.PartialWorkbook=et.d,Qe.createCellSetFromRange=tt.f,Qe.bspFactory=tt.d,Qe.forEachCellInSet=tt.g,Qe.forEachRangeInSet=tt.i,Qe.makeGridRangeTable=ut.a,Qe.namedFormula=rt.g,Qe.namedTable=rt.i,Qe.empty=at.d,Qe.dense=at.c,Qe.union=at.j,Qe.unionProduct=ot.j,Qe.meetsProduct=ot.h,Qe.exceptProduct=ot.d,Qe.intersectProduct=ot.g,Qe.blankStyleValue=st.b,Qe.UnitExperiment=ct.a,Qe.ExperimentKind=nt.a,Qe.registerExperimentFactory=nt.c,Qe.incrementFailure=Ge.b,Qe.arrayChecker=it.a,Qe.chBoolean=it.d,Qe.check=it.w,Qe.chFiniteNumber=it.g,Qe.chPossiblyInfiniteNumber=it.m,Qe.objectChecker=it.A,Qe.oneOfChecker=it.B,Qe.optChecker=it.C;var dt,ft=r(162);(dt||(dt={})).getWorksheetFunc=ft.a;var pt,mt,ht,vt,gt=r(57);function bt(){}function St(){return Promise.resolve()}(mt=pt||(pt={})).FontUnderline=gt.c,mt.FontVerticalAlignment=gt.d,mt.FillKind=gt.b,mt.PatternType=gt.f,mt.BorderLineType=gt.a,mt.HorizontalAlignment=gt.e,mt.VerticalAlignment=gt.g,(vt=ht||(ht={})).runSmokeTest=St,vt.cancelSmokeTest=bt;var yt=r(164),Ot=r(82),Ct=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]};var Pt=c.wrapIntoAsyncModule.wrapIntoAsync,Nt=c.wrapIntoAsyncModule.wrapIntoAsyncClass,Rt=r(53);function kt(e){if("object"==typeof e)switch(e.kind){case"Blank":return"";case"Error":return Object(L.p)().errorNames[e.type];case"Rich":return"rich value formulaBarText"}return e.toString()}var Tt=function(e){function t(t){var r=this,n=(new(function(e){function t(){var t=e.call(this,Ct,Ct,Ct)||this;return t.interval=void 0,t.calcGrid=t,t}return Object(Le.__extends)(t,e),Object.defineProperty(t.prototype,"calcConfig",{get:function(){return this.calcGrid.dataModel.docs.config},enumerable:!1,configurable:!0}),t.prototype.runTasks=function(){for(;!this.calcGrid.dataModel.step().queueEmpty;);},t.prototype.startRecalc=function(e){void 0===e&&(e=5),this.stopRecalc(),this.interval=setInterval(this.runTasks.bind(this),e)},t.prototype.stopRecalc=function(){void 0!==this.interval&&clearInterval(this.interval),this.interval=void 0},t}(Ge.a))).calcGrid,i=Object(Ve.f)(t).createRecalcSideGrid(n);return(r=e.call(this,i)||this).sheetNames=[],r.calcGrid=n,r.document=n.document,r}return Object(Le.__extends)(t,e),Object.defineProperty(t.prototype,"calcConfig",{get:function(){return this.calcGrid.dataModel.docs.config},enumerable:!1,configurable:!0}),t.prototype.setSheet=function(e,t,r){var n=_.d(void 0,""),i=_.u(n,e);Object(o.g)("Sheet having sheetId ".concat(e," is already in the mock workbook"),!this.sheetNames.some((function(t){return t.sheetId===e}))),this.sheetNames.push(Object(xe.fb)(i.index,t)),this.calcGrid.updateSheetNames(0,this.sheetNames);for(var a=[],s=0;s<r.length;s+=1){var u=r[s];if(void 0!==u)for(var c=0;c<u.length;c+=1){var l=u[c];if(void 0!==l){var d=Object(xe.gb)(i.index,s,c),f=kt(l);f.startsWith("=")?a.push(Object(xe.Z)(d,Object(xe.m)(f,l,0))):a.push(Object(xe.Z)(d,Object(xe.kb)(f,l,0)))}}}this.calcGrid.updateRanges(0,Object(Le.__spreadArray)([Object(xe.Z)(Object(xe.gb)(i.index,0,0))],a,!0)),this.runTasks()},t.prototype.setNamedObjects=function(e){this.calcGrid.updateNamedObjects(0,e),this.runTasks()},t.prototype.runTasks=function(){for(;;){if(this.calcGrid.dataModel.step().queueEmpty)break}},t}(Nt()(["getRangeFormats","getRangeFormulae","getRangeValues","getSheetNames","getIntersectingTables","getIformats","discardSnapshot","getHiddenRows","getHiddenCols","evalClonedModelOnSnapshot","evalFormulaOnSnapshot"]));function Et(e){var t=new Tt(e),r=Object(Rt.e)(t,(function(){return t.calcGrid.resumeRecalc()}));return r.setSheet=t.setSheet.bind(t),r.setNamedObjects=t.setNamedObjects.bind(t),r.document=t.document,Object.defineProperty(r,"calcConfig",{get:function(){return t.calcConfig}}),r}function _t(e){return{getGrid:function(){return e}}}function Ft(e){return{createIGridExportEndpoint:function(t){return Object(Le.__awaiter)(this,void 0,void 0,(function(){return Object(Le.__generator)(this,(function(r){switch(r.label){case 0:return[4,Be.Endpoint.createInside(t,(function(){return e}))];case 1:return r.sent(),[2]}}))}))}}}function It(e,t,r,n,i,a){void 0===a&&(a=0),r.setSheet(e,t,n);var o={sheetId:e,sheetName:t};i.doNotify(We.a.updateSheetNames,[a,[o]])}var At=r(99),Mt=(function(){function e(e){var t=this;this.nowTimes=e,this.setImmediateCalls=[],this.setTimeoutCalls=[],this.clearImmediateCalls=[],this.clearTimeoutCalls=[],this.setImmediate=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];if(void 0!==t.handle)throw"setImmediate called, even though we already have a callback";return t.setImmediateCalls.push(e),t.handle=setImmediate((function(){var r;return t.handle=void 0,e[0].apply(e,null!==(r=e[1])&&void 0!==r?r:[])}))},this.clearImmediate=function(e){if(t.handle!==e)throw"clearImmediate called with a different handle than the one supplied";clearImmediate(t.handle),t.clearImmediateCalls.push([e]),t.handle=void 0},this.setTimeout=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];if(void 0!==t.handle)throw"setTimeout called, even though we already have a callback";return t.setTimeoutCalls.push(e),t.handle=setImmediate((function(){var r;return t.handle=void 0,e[0].apply(e,null!==(r=e[2])&&void 0!==r?r:[])}))},this.clearTimeout=function(e){if(t.handle!==e)throw"clearTimeout called with a different handle than the one supplied";clearImmediate(t.handle),t.clearTimeoutCalls.push([e]),t.handle=void 0}}e.prototype.now=function(){var e=this.nowTimes.shift();if(void 0===e)throw"now was called too many times";return e}}(),function(){function e(t,r){void 0===t&&(t=1),void 0===r&&(r=0);var n=this;this.precisionMs=t,this.startTime=r,this.setImmediate=function(t){for(var r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];var a={delayUntil:-1,callback:t,args:r,isValid:!0};return n.queue.enqueue(a),new e.Immediate(a)},this.clearImmediate=function(t){if(!(t instanceof e.Immediate))throw new TypeError("handle is not a MockFullTimer.Immedate");t.delayedCallback.isValid=!1},this.setTimeout=function(t,r){for(var i=[],a=2;a<arguments.length;a++)i[a-2]=arguments[a];var o=n.time+(r>4?r:4),s={delayUntil:o,callback:t,args:i,isValid:!0};return n.queue.enqueue(s),new e.Timeout(s)},this.clearTimeout=function(t){if(!(t instanceof e.Timeout))throw new TypeError("handle is not a MockFullTimer.Timeout");t.delayedCallback.isValid=!1},this.time=r>0?r:0,this.queue=new At.a((function(e,t){return e.delayUntil-t.delayUntil}))}return e.prototype.preciseNow=function(){return this.time},e.prototype.now=function(){return Math.floor(this.time/this.precisionMs)*this.precisionMs},e.prototype.busyWait=function(e){this.time+=e>0?e:0},e.prototype.busyWaitUntil=function(e){this.time=this.time<e?e:this.time},e.prototype.runMacrotasksWhile=function(e){return Object(Le.__awaiter)(this,void 0,void 0,(function(){var t;return Object(Le.__generator)(this,(function(r){switch(r.label){case 0:return[4,new Promise((function(e){return setImmediate((function(){return e()}))}))];case 1:if(r.sent(),!e())return[2];if(!(t=this.queue.pop()))return[2];if(this.busyWaitUntil(t.delayUntil),t.isValid)try{t.callback.apply(t,t.args)}catch(e){dispatchEvent(new ErrorEvent("error",{error:e,message:Object(s.c)(e),filename:"",lineno:0,colno:0}))}return[3,0];case 2:return[2]}}))}))},e.Immediate=function(e){this.delayedCallback=e},e.Timeout=function(e){this.delayedCallback=e},e}()),wt=r(23),Dt=r(5),jt=function(){function e(e){this.config=e,this.tableNameCache={}}return e.prototype.getDocumentLoc=function(e,t){var r,n;return Object(Le.__generator)(this,(function(i){switch(i.label){case 0:return[4,{kind:Dt.a.GetSheetNames}];case 1:return r=i.sent(),Object(o.g)("calc.x10.GlobalsGeneratorImpl.getDocumentLoc",r.kind===Dt.a.GetSheetNames),void 0===(n=r.document)||void 0!==e&&e!==n.path||0!==this.config.localeInfo.stringCompareCI(t,n.name)?[2,Object(E.b)(Object(x.Z)(["getDocumentLoc: document"]))]:[2,Object(E.e)(n)]}}))},e.prototype.getSheetIndex=function(e,t){var r,n;return Object(Le.__generator)(this,(function(i){switch(i.label){case 0:return[4,{kind:Dt.a.GetSheetNames}];case 1:return r=i.sent(),Object(o.g)("calc.x10.GlobalsGeneratorImpl.getSheetIndex",r.kind===Dt.a.GetSheetNames),Object(x.x)(e,r.document)?(n=r.nameToIndex.getValue(t),[2,Object(E.e)(void 0===n?void 0:r.sheets[n].sheetIndex.index)]):[2,Object(E.b)(Object(x.Z)(["getSheetIndex: document"]))]}}))},e.prototype.getSheetName=function(e,t){var r;return Object(Le.__generator)(this,(function(n){switch(n.label){case 0:return[4,{kind:Dt.a.GetSheetNames}];case 1:return r=n.sent(),Object(o.g)("calc.x10.GlobalsGeneratorImpl.getSheetName",r.kind===Dt.a.GetSheetNames),Object(x.x)(e,r.document)?[2,Object(E.e)(r.sheets[r.idToIndex[t]].sheetName)]:[2,Object(E.b)(Object(x.Z)(["getSheetName: document"]))]}}))},e.prototype.getSheetRangeIndexes=function(e){var t,r,n,i,s,u;return Object(Le.__generator)(this,(function(c){switch(c.label){case 0:return[4,{kind:Dt.a.GetSheetNames}];case 1:return t=c.sent(),Object(o.g)("calc.x10.GlobalsGeneratorImpl.getSheetRangeIndexes",t.kind===Dt.a.GetSheetNames),Object(x.x)(e.document,t.document)?(r=0,n=t.sheets.length,void 0!==e.index&&(i=t.idToIndex[e.index],s=t.idToIndex[e.index2],r=Object(a.c)(i,s),n=Object(a.b)(i,s)+1),u=t.sheets.slice(r,n).map((function(e){return e.sheetIndex.index})),[2,Object(E.e)(Object(_.w)(u,r))]):[2,Object(E.b)(Object(x.Z)(["getSheetRangeIndexes: document"]))]}}))},e.prototype.getContainingTable=function(e){var t,r;return Object(Le.__generator)(this,(function(n){switch(n.label){case 0:return[4,{kind:Dt.a.GetContainingTable,cell:e}];case 1:return t=n.sent(),Object(o.g)("calc.x10.GlobalsGeneratorImpl.getContainingTable",t.kind===Dt.a.GetContainingTable),Object(E.c)(t.result)?void 0===(r=t.result.value)?[2,Object(E.e)(void 0)]:(this.tableNameCache[r.name]=r,[2,Object(E.e)(Object(_.n)(Object(_.e)(e.sheet.document),r.name))]):[2,t.result]}}))},e.prototype.getStructRefColumn=function(e,t){var r,n;return Object(Le.__generator)(this,(function(i){return void 0===(r=this.tableNameCache[e.name])?[2,Object(E.b)(Object(G.i)(G.c.UndefinedTableName))]:void 0===(n="string"==typeof t?r.nameToColumn.getValue(t):r.indexToColumn[t])?[2,Object(E.b)(Object(G.i)(G.c.UndefinedColumnName))]:[2,Object(E.e)(Object(_.y)(n.name,Object(_.t)(r.sheet,Object(_.g)(r.dataRange.row,n.column,r.dataRange.rows,1)),void 0!==r.headersRange,void 0!==r.totalsRange))]}))},e.prototype.getStructRefSpecialRef=function(e,t){var r;return Object(Le.__generator)(this,(function(n){if(void 0===(r=this.tableNameCache[e.name]))return[2,Object(E.b)(Object(G.i)(G.c.UndefinedTableName))];switch(t){case I.i.All:return[2,Object(E.e)(Object(_.t)(r.sheet,r.allRange))];case I.i.Data:return[2,Object(E.e)(Object(_.t)(r.sheet,r.dataRange))];case I.i.Headers:return[2,Object(E.e)(void 0!==r.headersRange?Object(_.t)(r.sheet,r.headersRange):void 0)];case I.i.Totals:return[2,Object(E.e)(void 0!==r.totalsRange?Object(_.t)(r.sheet,r.totalsRange):void 0)];default:return[2,Object(o.d)("calc.x10.GlobalsGeneratorImpl.getStructRefSpecialRef",t)]}return[2]}))},e.prototype.getIntersectingTables=function(e){var t;return Object(Le.__generator)(this,(function(r){switch(r.label){case 0:return[4,{kind:Dt.a.GetIntersectingTables,range:e}];case 1:return t=r.sent(),Object(o.g)("calc.x10.GlobalsGeneratorImpl.getIntersectingTables",t.kind===Dt.a.GetIntersectingTables),Object(E.c)(t.result)?[2,Object(E.e)(t.result.value.map((function(t){return Object(_.n)(Object(_.e)(e.sheet.document),t.name)})))]:[2,t.result]}}))},e.prototype.getCellValue=function(e){var t;return Object(Le.__generator)(this,(function(r){switch(r.label){case 0:return[4,{kind:Dt.a.GetCell,cell:e}];case 1:return t=r.sent(),Object(o.g)("calc.x10.GlobalsGeneratorImpl.getCellValue",t.kind===Dt.a.GetCell),Object(E.c)(t.result)?[2,Object(E.e)(Object(Re.n)(t.result.value.value))]:[2,t.result]}}))},e.prototype.getCellFormula=function(e){var t,r,n,i;return Object(Le.__generator)(this,(function(a){switch(a.label){case 0:return[4,{kind:Dt.a.GetCell,cell:e}];case 1:return t=a.sent(),Object(o.g)("calc.x10.GlobalsGeneratorImpl.getCellFormula",t.kind===Dt.a.GetCell),Object(E.c)(t.result)?(r=t.result.value.formula).kind!==Rt.a.CellFormula?[2,E.f]:(n=r,[4,{kind:Dt.a.ParseCellFormula,cell:e,formula:n,useEnglishLocaleInfo:!1}]):[2,t.result];case 2:return i=a.sent(),Object(o.g)("calc.x10.GlobalsGeneratorImpl.getCellFormula",i.kind===Dt.a.ParseCellFormula),Object(E.c)(i.result)?[2,Object(E.e)(Object(Re.h)(Object(_.h)(e),i.result.value))]:[2,Object(E.b)(Object(x.Z)(["getCellFormula: parse/analyze failure"]))]}}))},e.prototype.getHiddenRows=function(e,t,r){var n;return Object(Le.__generator)(this,(function(i){switch(i.label){case 0:return[4,{kind:Dt.a.GetHiddenRows,sheet:e,start:t,endExclusive:r}];case 1:return n=i.sent(),Object(o.g)("calc.x10.GlobalsGeneratorImpl.getHiddenRows",n.kind===Dt.a.GetHiddenRows),[2,n.result]}}))},e.prototype.getHiddenCols=function(e,t,r){var n;return Object(Le.__generator)(this,(function(i){switch(i.label){case 0:return[4,{kind:Dt.a.GetHiddenCols,sheet:e,start:t,endExclusive:r}];case 1:return n=i.sent(),Object(o.g)("calc.x10.GlobalsGeneratorImpl.getHiddenCols",n.kind===Dt.a.GetHiddenCols),[2,n.result]}}))},e.prototype.getCellFormat=function(e){var t,r,n;return Object(Le.__generator)(this,(function(i){switch(i.label){case 0:return[4,{kind:Dt.a.GetCell,cell:e}];case 1:return t=i.sent(),Object(o.g)("calc.x10.GlobalsGeneratorImpl.getCellFormat",t.kind===Dt.a.GetCell),Object(E.c)(t.result)?"number"==typeof(r=t.result.value.format)?[2,Object(E.e)(r)]:[4,{kind:Dt.a.ParseNumberFormat,formatString:r,builtIn:!1}]:[2,t.result];case 2:return n=i.sent(),Object(o.g)("calc.x10.GlobalsGeneratorImpl.getCellFormat",n.kind===Dt.a.ParseNumberFormat),Object(E.c)(n.result)?[2,Object(E.e)(n.result.value)]:[2,Object(E.b)(Object(x.Z)(["getCellFormat: parse format failure"]))]}}))},e.prototype.getIformat=function(e,t){var r,n,i,a,s;return Object(Le.__generator)(this,(function(u){switch(u.label){case 0:return[4,{kind:Dt.a.GetIformat,document:e,iformat:t}];case 1:return r=u.sent(),Object(o.g)("calc.x10.GlobalsGeneratorImpl.getIformat",r.kind===Dt.a.GetIformat),Object(E.c)(r.result)?(n=r.result.value,i=n.formatString,a=n.builtIn,[4,{kind:Dt.a.ParseNumberFormat,formatString:i,builtIn:a}]):[2,r.result];case 2:return s=u.sent(),Object(o.g)("calc.x10.GlobalsGeneratorImpl.getIformat",s.kind===Dt.a.ParseNumberFormat),Object(E.c)(s.result)?[2,Object(E.e)(s.result.value)]:[2,Object(E.b)(Object(x.Z)(["getIformat: parse format failure"]))]}}))},e.prototype.getMergeCell=function(e){return Object(Le.__generator)(this,(function(e){return[2,E.f]}))},e.prototype.getCellStyle=function(e){return Object(Le.__generator)(this,(function(e){return[2,Object(E.e)(st.b)]}))},e.prototype.resolveCellRef=function(e,t){var r;return Object(Le.__generator)(this,(function(n){switch(n.label){case 0:return[4,{kind:Dt.a.ResolveReferences,locals:e,nodes:[t]}];case 1:return r=n.sent(),Object(o.g)("calc.x10.GlobalsGeneratorImpl.resolveCellRef",r.kind===Dt.a.ResolveReferences&&1===r.resolverResults.length&&r.resolverResults[0].kind===G.e.ResolvedCellRef),[2,r.resolverResults[0]]}}))},e.prototype.resolveStructRef=function(e,t){var r;return Object(Le.__generator)(this,(function(n){switch(n.label){case 0:return[4,{kind:Dt.a.ResolveReferences,locals:e,nodes:[t]}];case 1:return r=n.sent(),Object(o.g)("calc.x10.GlobalsGeneratorImpl.resolveStructRef",r.kind===Dt.a.ResolveReferences&&1===r.resolverResults.length&&r.resolverResults[0].kind===G.e.ResolvedStructRef),[2,r.resolverResults[0]]}}))},e}();function xt(){var e;return Object(Le.__generator)(this,(function(t){switch(t.label){case 0:return[4,{kind:Dt.a.GetConfig}];case 1:return e=t.sent(),Object(o.g)("calc.x10.GetConfig",e.kind===Dt.a.GetConfig),[2,new jt(e.config)]}}))}var Lt=new $e.a((function(){var e;return(e={})[A.b.ABS]="=ABS(2)",e[A.b.CUBEMEMBERPROPERTY]='=CUBEMEMBERPROPERTY("'.concat(FormulaAuthoringStrings.Sales,'","[').concat(FormulaAuthoringStrings.Time,"].[").concat(FormulaAuthoringStrings.Fiscal,'].[2014]",$A$3)'),e[A.b.CUBERANKEDMEMBER]='=CUBERANKEDMEMBER("'.concat(FormulaAuthoringStrings.Sales,'",$D$4,1,"').concat(FormulaAuthoringStrings.TopMonth,'")'),e[A.b.BINOM_DIST_RANGE]="=BINOM.DIST.RANGE(60,0.75,48)",e[A.b.NETWORKDAYS_INTL]="=NETWORKDAYS.INTL(DATE(2006,1,1),DATE(2006,1,31))",e[A.b.AVERAGE_WEIGHTED]="=AVERAGE.WEIGHTED(A1:A10, B1:B10, 5, 0.5)",e[A.b.GAMMALN_PRECISE]="=GAMMALN.PRECISE(4)",e[A.b.CONFIDENCE_NORM]="=CONFIDENCE.NORM(0.05,2.5,50)",e[A.b.CEILING_PRECISE]="=CEILING.PRECISE(4.3)",e[A.b.FORECAST_LINEAR]="=FORECAST.LINEAR(30,A2:A6,B2:B6)",e[A.b.PERCENTRANK_EXC]="=PERCENTRANK.EXC(A2:A11,2)",e[A.b.PERCENTRANK_INC]="=PERCENTRANK.INC(A2:A11,2)",e[A.b.PERCENTILE_EXC]="=PERCENTILE.EXC(B2:B10,0.25)",e[A.b.PERCENTILE_INC]="=PERCENTILE.INC(A2:A5,0.3)",e[A.b.CUBEKPIMEMBER]='=CUBEKPIMEMBER("'.concat(FormulaAuthoringStrings.Sales,'","').concat(FormulaAuthoringStrings.MySalesKPI,'",1)'),e[A.b.CHISQ_DIST_RT]="=CHISQ.DIST.RT(18.307,10)",e[A.b.FLOOR_PRECISE]="=FLOOR.PRECISE(-3.2,-1)",e[A.b.NEGBINOM_DIST]="=NEGBINOM.DIST(10,5,0.25,TRUE)",e[A.b.GETPIVOTDATA]='=GETPIVOTDATA("'.concat(FormulaAuthoringStrings.Sales,'", $A$3, "').concat(FormulaAuthoringStrings.Region,'", "').concat(FormulaAuthoringStrings.South,'")'),e[A.b.CUBESETCOUNT]="=CUBESETCOUNT(A3)",e[A.b.ERFC_PRECISE]="=ERFC.PRECISE(1)",e[A.b.CHISQ_INV_RT]="=CHISQ.INV.RT(0.3, 2)",e[A.b.CONFIDENCE_T]="=CONFIDENCE.T(0.05,1,50)",e[A.b.CEILING_MATH]="=CEILING.MATH(24.3,5)",e[A.b.HYPGEOM_DIST]="=HYPGEOM.DIST(1,4,8,20,TRUE)",e[A.b.LOGNORM_DIST]="=LOGNORM.DIST(4,3.5,1.2,TRUE)",e[A.b.NEGBINOMDIST]="=NEGBINOMDIST(10,5,0.25)",e[A.b.PERMUTATIONA]="=PERMUTATIONA(3,2)",e[A.b.POISSON_DIST]="=POISSON.DIST(1, 2, TRUE)",e[A.b.WEIBULL_DIST]="=WEIBULL.DIST(105,20,100,TRUE)",e[A.b.COVARIANCE_P]="=COVARIANCE.P(A2:A6, B2:B6)",e[A.b.COVARIANCE_S]="=COVARIANCE.S(A3:A5,B3:B5)",e[A.b.QUARTILE_EXC]="=QUARTILE.EXC(A2:A12,1)",e[A.b.QUARTILE_INC]="=QUARTILE.INC(A2:A9,1)",e[A.b.ECMA_CEILING]="=ECMA.CEILING(1.5, 0.1)",e[A.b.WORKDAY_INTL]="=WORKDAY.INTL(DATE(2012,1,1),30,0)",e[A.b.STOCKHISTORY]="=STOCKHISTORY(MSFT,1-1-2020)",e[A.b.ERF_PRECISE]="=ERF.PRECISE(0.745)",e[A.b.NUMBERVALUE]="=NUMBERVALUE(0.035)",e[A.b.REGISTER_ID]='=REGISTER.ID(Kernel32, "GetTickCount", "J!")',e[A.b.HYPGEOMDIST]="=HYPGEOMDIST(1,4,8,20)",e[A.b.LOGNORMDIST]="=LOGNORMDIST(4,3.5,1.2)",e[A.b.LOGNORM_INV]="=LOGNORM.INV(0.039084, 3.5, 1.2)",e[A.b.NORM_S_DIST]="=NORM.S.DIST(1.33, TRUE)",e[A.b.STANDARDIZE]="=STANDARDIZE(42,40,1.5)",e[A.b.FORMULATEXT]="=FORMULATEXT(A2)",e[A.b.PERCENTRANK]="=PERCENTRANK(A2:A11,2)",e[A.b.CONCATENATE]='=CONCATENATE("'.concat(FormulaAuthoringStrings.Andreas,'", " ", "').concat(FormulaAuthoringStrings.Hauser,'")'),e[A.b.ISO_CEILING]="=ISO.CEILING(4.3)",e[A.b.VALUETOTEXT]='=VALUETOTEXT("'.concat(FormulaAuthoringStrings.SomeText,'")'),e[A.b.ARRAYTOTEXT]="=ARRAYTOTEXT(B1:B3)",e[A.b.AVERAGEIFS]='=AVERAGEIFS(B2:B5, B2:B5, ">70", B2:B5, "<90")',e[A.b.COUNTBLANK]="=COUNTBLANK(A2:B5)",e[A.b.ERROR_TYPE]="=ERROR.TYPE(#NULL!)",e[A.b.CUBEMEMBER]='=CUBEMEMBER("'.concat(FormulaAuthoringStrings.Sales,'",(B4, C6, D5),"').concat(FormulaAuthoringStrings.SalesFor2004,'")'),e[A.b.ISOWEEKNUM]="=ISOWEEKNUM(40977)",e[A.b.SUBSTITUTE]='=SUBSTITUTE("'.concat(FormulaAuthoringStrings.SalesData,'", "').concat(FormulaAuthoringStrings.Sales,'", "').concat(FormulaAuthoringStrings.Cost,'")'),e[A.b.SUMPRODUCT]="=SUMPRODUCT(C2:C5,D2:D5)",e[A.b.WEBSERVICE]="=WEBSERVICE(".concat(FormulaAuthoringStrings.WebServiceLink,")"),e[A.b.BINOM_DIST]="=BINOM.DIST(6,10,0.5,FALSE)",e[A.b.CHISQ_DIST]="=CHISQ.DIST(0.5,1,TRUE)",e[A.b.CONFIDENCE]="=CONFIDENCE(0.05,2.5,50)",e[A.b.EXPON_DIST]="=EXPON.DIST(0.2,10,TRUE)",e[A.b.FLOOR_MATH]="=FLOOR.MATH(24.3,5)",e[A.b.GAMMA_DIST]="=GAMMA.DIST(4.79, 1.234, 7, TRUE)",e[A.b.NORM_S_INV]="=NORM.S.INV(0.908789)",e[A.b.CHISQ_TEST]="=CHISQ.TEST(A2:B4,A6:B8)",e[A.b.PERCENTILE]="=PERCENTILE(E2:E5,0.3)",e[A.b.FIELDVALUE]='=FIELDVALUE(A2, "'.concat(FormulaAuthoringStrings.Price,'")'),e[A.b.AVERAGEIF]='=AVERAGEIF(B2:B5,"<23000")',e[A.b.BITLSHIFT]="=BITLSHIFT(4,2)",e[A.b.BITRSHIFT]="=BITRSHIFT(13,2)",e[A.b.DATEVALUE]="=DATEVALUE(40685)",e[A.b.FILTERXML]='=FILTERXML(B3,"//rc/@title")',e[A.b.CUBEVALUE]='=CUBEVALUE(Sales,"['.concat(FormulaAuthoringStrings.Measures,"].[").concat(FormulaAuthoringStrings.Profit,']","[').concat(FormulaAuthoringStrings.Time,'].[2004]","[').concat(FormulaAuthoringStrings.AllProduct,"].[").concat(FormulaAuthoringStrings.Beverages,']")'),e[A.b.ENCODEURL]='=ENCODEURL("'.concat(FormulaAuthoringStrings.EncodeURLExmapleLink,'")'),e[A.b.HYPERLINK]='=HYPERLINK("'.concat(FormulaAuthoringStrings.HyperlinkExampleLink,'", "').concat(FormulaAuthoringStrings.ClickForReport,'")'),e[A.b.ISLOGICAL]="=ISLOGICAL(TRUE)",e[A.b.ISNONTEXT]="=ISNONTEXT(A2)",e[A.b.ISFORMULA]="=ISFORMULA(A2)",e[A.b.PDURATION]="=PDURATION(2.5%,2000,2200)",e[A.b.TIMEVALUE]="=TIMEVALUE(0.1)",e[A.b.TRANSPOSE]="=TRANSPOSE(A2:F9)",e[A.b.FREQUENCY]="=FREQUENCY(A2:A20, B2:B5)",e[A.b.BETA_DIST]="=BETA.DIST(2,8,10,TRUE,1,3)",e[A.b.BINOMDIST]="=BINOMDIST(6,10,0.5,FALSE)",e[A.b.BINOM_INV]="=BINOM.INV(6,0.5,0.75)",e[A.b.CHISQ_INV]="=CHISQ.INV(0.3, 2)",e[A.b.CRITBINOM]="=CRITBINOM(6,0.5,0.75)",e[A.b.EXPONDIST]="=EXPONDIST(0.2,10,TRUE)",e[A.b.F_DIST_RT]="=F.DIST.RT(15.2069,6,4)",e[A.b.FISHERINV]="=FISHERINV(0.972955)",e[A.b.GAMMADIST]="=GAMMADIST(10.00001131,9,2,FALSE)",e[A.b.GAMMA_INV]="=GAMMA.INV(0.068094,9,2)",e[A.b.NORM_DIST]="=NORM.DIST(1, 0, 1, TRUE)",e[A.b.T_DIST_2T]="=T.DIST.2T(1.959999998,60)",e[A.b.T_DIST_RT]="=T.DIST.RT(1.959999998,60)",e[A.b.INTERCEPT]="=INTERCEPT(A2:A6, B2:B6)",e[A.b.MODE_MULT]="=MODE.MULT(A2:A13)",e[A.b.MODE_SNGL]="=MODE.SNGL(A2:A7)",e[A.b.AGGREGATE]="=AGGREGATE(12, 6, A1:A11, B1:B11)",e[A.b.RANDARRAY]="=RANDARRAY(5,3,1,100)",e[A.b.COUNTIFS]='=COUNTIFS(A2:A7,"<6",A2:A7,">1")',e[A.b.DAVERAGE]='=DAVERAGE(A4:E10, "'.concat(FormulaAuthoringStrings.Yield,'", A1:B2)'),e[A.b.BAHTTEXT]="=BAHTTEXT(1234)",e[A.b.DPRODUCT]='=DPRODUCT(A5:E11, "'.concat(FormulaAuthoringStrings.Yield,'", A1:F3)'),e[A.b.INDIRECT]="=INDIRECT(B&A)",e[A.b.ISNUMBER]="=ISNUMBER(A2)",e[A.b.MINVERSE]="=MINVERSE(A1:D4)",e[A.b.RANK_AVG]="=RANK.AVG(94,B2:B8)",e[A.b.SUBTOTAL]="=SUBTOTAL(9,A2:A5)",e[A.b.BETADIST]="=BETADIST(2,8,10,1,3)",e[A.b.BETA_INV]="=BETA.INV(0.685470581,8,10,1,3)",e[A.b.F_INV_RT]="=F.INV.RT(0.01,6,4)",e[A.b.GAMMAINV]="=GAMMAINV(0.65, 4, 2)",e[A.b.NORMDIST]="=NORMDIST(42,40,1.5,TRUE)",e[A.b.NORM_INV]="=NORM.INV(0.908789,40,1.5)",e[A.b.NORMSINV]="=NORMSINV(0.9088)",e[A.b.SUMX2MY2]="=SUMX2MY2(A3:A9,B3:B9)",e[A.b.SUMX2PY2]="=SUMX2PY2(A3:A9,B3:B9)",e[A.b.FORECAST]="=FORECAST(30,A2:A6,B2:B6)",e[A.b.QUARTILE]="=QUARTILE(A2:A9,1)",e[A.b.TRIMMEAN]="=TRIMMEAN(A2:A12,0.2)",e[A.b.T_INV_2T]="=T.INV.2T(0.546449,60)",e[A.b.AVERAGEA]="=AVERAGEA(A2:A6)",e[A.b.TEXTJOIN]="=TEXTJOIN(, , TRUE, A2:A8)",e[A.b.SEQUENCE]="=SEQUENCE(4,5)",e[A.b.ADDRESS]='=ADDRESS(2,3,1,FALSE,"['.concat(FormulaAuthoringStrings.Book1,"]").concat(FormulaAuthoringStrings.Sheet1,'")'),e[A.b.AVERAGE]="=AVERAGE(A2:A6)",e[A.b.COLUMNS]="=COLUMNS(C1:E4)",e[A.b.COUNTIF]='=COUNTIF(B2:B5,">55")',e[A.b.DAYS360]="=DAYS360(30-Jan-11,1-Feb-11)",e[A.b.DCOUNTA]='=DCOUNTA(A4:E10, "'.concat(FormulaAuthoringStrings.Profit,'", A1:F2)'),e[A.b.DECIMAL]="=DECIMAL(FF,16)",e[A.b.DEGREES]="=DEGREES(PI())",e[A.b.DSTDEVP]='=DSTDEVP(A5:E11, "'.concat(FormulaAuthoringStrings.Yield,'", A1:A3)'),e[A.b.CUBESET]='=CUBESET("'.concat(FormulaAuthoringStrings.Sales,'","[').concat(FormulaAuthoringStrings.Product,"].[").concat(FormulaAuthoringStrings.AllProducts,"].").concat(FormulaAuthoringStrings.Children,'","').concat(FormulaAuthoringStrings.Products,'",1,"[').concat(FormulaAuthoringStrings.Measures,"].[").concat(FormulaAuthoringStrings.SalesAmount,']")'),e[A.b.HLOOKUP]='=HLOOKUP("'.concat(FormulaAuthoringStrings.Axles,'", A1:C4, 2, TRUE)'),e[A.b.IFERROR]='=IFERROR(55/0, "'.concat(FormulaAuthoringStrings.ErrorInCalculation,'")'),e[A.b.ISBLANK]="=ISBLANK(A2)",e[A.b.ISERROR]="=ISERROR(#REF!)",e[A.b.XLOOKUP]='=XLOOKUP("'.concat(FormulaAuthoringStrings.Tom,'",A2:A9,C2:C9,"').concat(FormulaAuthoringStrings.NotFound,'",0,1)'),e[A.b.MDETERM]="=MDETERM(A2:D5)",e[A.b.PRODUCT]="=PRODUCT(A2:A4)",e[A.b.RADIANS]="=RADIANS(270)",e[A.b.RANK_EQ]="=RANK.EQ(7,A2:A6,1)",e[A.b.REPLACE]='=REPLACE(2009,3,2,"10")',e[A.b.STDEV_S]="=STDEV.S(A2:A11)",e[A.b.STDEV_P]="=STDEV.P(A3:A12)",e[A.b.UNICODE]="=UNICODE(B)",e[A.b.UNICHAR]="=UNICHAR(66)",e[A.b.VLOOKUP]="=VLOOKUP(103, A2:B26, 2, FALSE)",e[A.b.WEEKDAY]="=WEEKDAY(39492)",e[A.b.GAMMALN]="=GAMMALN(4)",e[A.b.BETAINV]="=BETAINV(0.685470581,8,10,1,3)",e[A.b.CHIDIST]="=CHIDIST(18.307,10)",e[A.b.COMBINA]="=COMBINA(4,3)",e[A.b.CEILING]="=CEILING(2.5, 1)",e[A.b.NORMINV]="=NORMINV(0.908789,40,1.5)",e[A.b.POISSON]="=POISSON(1, 2, TRUE)",e[A.b.WEIBULL]="=WEIBULL(105,20,100,TRUE)",e[A.b.SUMXMY2]="=SUMXMY2(A3:A9,B3:B9)",e[A.b.CHITEST]="=CHITEST(A2:B4,A6:B8)",e[A.b.PEARSON]="=PEARSON(A3:A7,B3:B7)",e[A.b.GEOMEAN]="=GEOMEAN(A2:A8)",e[A.b.HARMEAN]="=HARMEAN(A2:A8)",e[A.b.STDEVPA]="=STDEVPA(A3:A12)",e[A.b.DATEDIF]='=DATEDIF(1/1/2001,1/1/2003,"Y")',e[A.b.ARABIC]="=ARABIC(LVII)",e[A.b.CHOOSE]='=CHOOSE(3,"'.concat(FormulaAuthoringStrings.Wide,'",115,"').concat(FormulaAuthoringStrings.World,'",8)'),e[A.b.COLUMN]="=COLUMN(C9)",e[A.b.COUNTA]="=COUNTA(B2:B6)",e[A.b.DCOUNT]='=DCOUNT(A5:E11, "'.concat(FormulaAuthoringStrings.Age,'", A1:F2)'),e[A.b.DOLLAR]="=DOLLAR(1.2351, 4)",e[A.b.DSTDEV]='=DSTDEV(A5:E11, "'.concat(FormulaAuthoringStrings.Yield,'", A1:A3)'),e[A.b.GROWTH]="=GROWTH(#VALUE!)",e[A.b.IMCOSH]='=IMCOSH("4+3i")',e[A.b.IMCSCH]='=IMCSCH("4+3i")',e[A.b.IMSECH]='=IMSECH("4+3i")',e[A.b.IMSINH]='=IMSINH("4+3i")',e[A.b.ISTEXT]='=ISTEXT("'.concat(FormulaAuthoringStrings.Region1,'")'),e[A.b.LINEST]="=LINEST(B2:B10, A2:A10, FALSE, TRUE)",e[A.b.LOGEST]="=LOGEST(B2:B10, A2:A10, TRUE, TRUE)",e[A.b.LOOKUP]="=LOOKUP(4.19, A2:A6, B2:B6)",e[A.b.XMATCH]="=XMATCH(F2,C3:C9,1)",e[A.b.MEDIAN]="=MEDIAN(A2:A6)",e[A.b.MINUTE]="=MINUTE(0.53125)",e[A.b.OFFSET]="=OFFSET(D3,3,-2,1,1)",e[A.b.PROPER]='=PROPER("'.concat(FormulaAuthoringStrings.ThisIsATITLE,'")'),e[A.b.SEARCH]='=SEARCH("'.concat(FormulaAuthoringStrings.E,'","').concat(FormulaAuthoringStrings.Statements,'",6)'),e[A.b.SECOND]="=SECOND(0.700208333333333)",e[A.b.SHEETS]="=SHEETS(".concat(FormulaAuthoringStrings.My3DRef,")"),e[A.b.STDEVP]="=STDEVP(A3:A12)",e[A.b.SUMIFS]='=SUMIFS(A2:A9, B2:B9, "<>'.concat(FormulaAuthoringStrings.Bananas,'", C2:C9, "').concat(FormulaAuthoringStrings.Tom,'")'),e[A.b.AVEDEV]="=AVEDEV(A2:A8)",e[A.b.CHIINV]="=CHIINV(0.3, 2)",e[A.b.COMBIN]="=COMBIN(8,2)",e[A.b.F_DIST]="=F.DIST(15.2069,6,4,TRUE)",e[A.b.FISHER]="=FISHER(0.75)",e[A.b.LOGINV]="=LOGINV(0.039084, 3.5, 1.2)",e[A.b.PERMUT]="=PERMUT(100,3)",e[A.b.T_DIST]="=T.DIST(60,1,TRUE)",e[A.b.CORREL]="=CORREL(A2:A6, B2:B6)",e[A.b.F_TEST]="=F.TEST(A2:A6,B2:B6)",e[A.b.T_TEST]="=T.TEST(A2:A10,B2:B10,2,1)",e[A.b.SKEW_P]="=SKEW.P(A2:A11)",e[A.b.Z_TEST]="=Z.TEST(A2:A11,4)",e[A.b.STDEVA]="=STDEVA(A3:A12)",e[A.b.MAXIFS]='=MAXIFS(A2:A7,B2:B7,"'.concat(FormulaAuthoringStrings.IfsB,'",D2:D7,">100")'),e[A.b.MINIFS]='=MINIFS(A2:A7,B2:B7,"'.concat(FormulaAuthoringStrings.IfsB,'",D2:D7,">100")'),e[A.b.CONCAT]='=CONCAT("'.concat(FormulaAuthoringStrings.Andreas,'"," ", "').concat(FormulaAuthoringStrings.Hauser,'")'),e[A.b.SWITCH]='=SWITCH(WEEKDAY(10/10/2016),1,"'.concat(FormulaAuthoringStrings.Sunday,'",2,"').concat(FormulaAuthoringStrings.Monday,'",3,"').concat(FormulaAuthoringStrings.Tuesday,'","').concat(FormulaAuthoringStrings.NoMatch,'")'),e[A.b.FILTER]='=FILTER(A5:D20,(C5:C20="'.concat(FormulaAuthoringStrings.Apple,'")*(A5:A20="').concat(FormulaAuthoringStrings.East,'"),"")'),e[A.b.UNIQUE]="=UNIQUE(A2:A12)",e[A.b.SORTBY]="=SORTBY(D2:D9,E2:E9,1)",e[A.b.BITAND]="=BITAND(1,5)",e[A.b.BITXOR]="=BITXOR(5,3)",e[A.b.ACOSH]="=ACOSH(10)",e[A.b.ACOTH]="=ACOTH(6)",e[A.b.ATANH]="=ATANH(-0.1)",e[A.b.ATAN2]="=ATAN2(4,0)",e[A.b.CLEAN]="=CLEAN(A2)",e[A.b.COUNT]="=COUNT(A2:A7)",e[A.b.DVARP]='=DVARP(A4:E10, "'.concat(FormulaAuthoringStrings.Yield,'", A1:A3)'),e[A.b.EXACT]='=EXACT("'.concat(FormulaAuthoringStrings.Hello,'", "').concat(FormulaAuthoringStrings.Goodbye,'")'),e[A.b.FALSE]="=FALSE()",e[A.b.FIXED]="=FIXED(-1234.567, -1, TRUE)",e[A.b.IMCOT]='=IMCOT("4+3i")',e[A.b.IMCSC]='=IMCSC("4+3i")',e[A.b.IMSEC]='=IMSEC("4+3i")',e[A.b.IMTAN]='=IMTAN("4+3i")',e[A.b.INDEX]="=INDEX(A2:B3,2,1)",e[A.b.ISERR]="=ISERR(#N/A)",e[A.b.ISREF]="=ISREF(A2)",e[A.b.LOWER]='=LOWER("'.concat(FormulaAuthoringStrings.EECummings,'")'),e[A.b.MATCH]="=MATCH(39,B2:B5,1)",e[A.b.MMULT]="=MMULT(A1:B3, C1:F2)",e[A.b.MONTH]="=MONTH(40648)",e[A.b.RIGHT]='=RIGHT("'.concat(FormulaAuthoringStrings.SalePrice,'",5)'),e[A.b.ROUND]="=ROUND(2.149, 1)",e[A.b.SHEET]="=SHEET(".concat(FormulaAuthoringStrings.Table1,")"),e[A.b.STDEV]="=STDEV(A3:A12)",e[A.b.SUMIF]='=SUMIF(A2:A5,">160000")',e[A.b.TODAY]="=TODAY()",e[A.b.TREND]="=TREND(B2:B10, A2:A10, A11:A13, TRUE)",e[A.b.TRUNC]="=TRUNC(8.9)",e[A.b.UPPER]='=UPPER("'.concat(FormulaAuthoringStrings.KelliXu,'")'),e[A.b.VALUE]="=VALUE(1000)",e[A.b.VAR_S]="=VAR.S(A2:A11)",e[A.b.VAR_P]="=VAR.P(A2:A11)",e[A.b.GAMMA]="=GAMMA(-3.75)",e[A.b.GAUSS]="=GAUSS(2)",e[A.b.FDIST]="=FDIST(15.20686486,6,4)",e[A.b.F_INV]="=F.INV(0.01,6,4)",e[A.b.FLOOR]="=FLOOR(23.25, 0.1)",e[A.b.TDIST]="=TDIST(60, 1, 1)",e[A.b.COVAR]="=COVAR(A2:A6, B2:B6)",e[A.b.FTEST]="=FTEST(A2:A6,B2:B6)",e[A.b.STEYX]="=STEYX(A3:A9,B3:B9)",e[A.b.SLOPE]="=SLOPE(A3:A9,B3:B9)",e[A.b.TTEST]="=TTEST(A2:A10,B2:B10,2,1)",e[A.b.DEVSQ]="=DEVSQ(A2:A8)",e[A.b.SUMSQ]="=SUMSQ(3, 4)",e[A.b.ZTEST]="=ZTEST(A2:A11,6)",e[A.b.LARGE]="=LARGE(A2:B6,7)",e[A.b.SMALL]="=SMALL(A2:A10,4)",e[A.b.MUNIT]="=MUNIT(2)",e[A.b.T_INV]="=T.INV(0.75,2)",e[A.b.ROMAN]="=ROMAN(499,0)",e[A.b.POWER]="=POWER(5,2)",e[A.b.ISPMT]="=ISPMT(10%, 2, 5, 1000)",e[A.b.VARPA]="=VARPA(1, 2)",e[A.b.AREAS]="=AREAS(B2:D4)",e[A.b.ASINH]="=ASINH(10)",e[A.b.BITOR]="=BITOR(23,10)",e[A.b.ACOS]="=ACOS(-0.5)",e[A.b.ACOT]="=ACOT(2)",e[A.b.ATAN]="=ATAN(1)",e[A.b.CALL]="=CALL(A5)",e[A.b.CELL]='=CELL("'.concat(FormulaAuthoringStrings.Address,'", C2)'),e[A.b.CHAR]="=CHAR(65)",e[A.b.COSH]="=COSH(EXP(1))",e[A.b.COTH]="=COTH(2)",e[A.b.CSCH]="=CSCH(2)",e[A.b.DATE]="=DATE(2008,1,2)",e[A.b.DAYS]="=DAYS(3/15/11,2/1/11)",e[A.b.DGET]='=DGET(A5:E11, "'.concat(FormulaAuthoringStrings.Yield,'", A1:A3)'),e[A.b.DMAX]='=DMAX(A5:E11, "'.concat(FormulaAuthoringStrings.Profit,'", A1:F3)'),e[A.b.DMIN]='=DMIN(A5:E11, "'.concat(FormulaAuthoringStrings.Profit,'", A1:F3)'),e[A.b.DSUM]='=DSUM(A4:E10,"'.concat(FormulaAuthoringStrings.Profit,'", A1:F3)'),e[A.b.DVAR]='=DVAR(A4:E10, "'.concat(FormulaAuthoringStrings.Yield,'", A1:A3)'),e[A.b.FACT]="=FACT(5)",e[A.b.FIND]='=FIND("'.concat(FormulaAuthoringStrings.M,'",A2)'),e[A.b.HOUR]="=HOUR(0.75)",e[A.b.IFNA]='=IFNA("'.concat(FormulaAuthoringStrings.NoNAError,'", "').concat(FormulaAuthoringStrings.Error,'")'),e[A.b.IPMT]="=IPMT(10%, 3, 3, 8000)",e[A.b.ISNA]="=ISNA(#REF!)",e[A.b.LEFT]='=LEFT("'.concat(FormulaAuthoringStrings.SalePrice,'",4)'),e[A.b.MIRR]="=MIRR(A2:A7, 0.1, 0.12)",e[A.b.NPER]="=NPER(0.12/12, -100, -1000, 10000, 1)",e[A.b.PPMT]="=PPMT(0.08, 10, 10, 200000)",e[A.b.RAND]="=RAND()",e[A.b.RANK]="=RANK(3.5,A2:A6,1)",e[A.b.RATE]="=RATE(4*12, -200, 8000)",e[A.b.REPT]='=REPT("*-", 3)',e[A.b.ROWS]="=ROWS(C1:E4)",e[A.b.SECH]="=SECH(0)",e[A.b.SIGN]="=SIGN(10)",e[A.b.SINH]="=SINH(2)",e[A.b.SQRT]="=SQRT(16)",e[A.b.TANH]="=TANH(0.5)",e[A.b.TEXT]='=TEXT(1234.567,"$#,##0.00")',e[A.b.TIME]="=TIME(16,48,10)",e[A.b.TRIM]='=TRIM("'.concat(FormulaAuthoringStrings.FirstQuarterEarnings,'")'),e[A.b.TRUE]="=TRUE()",e[A.b.TYPE]='=TYPE("'.concat(FormulaAuthoringStrings.Smith,'")'),e[A.b.VARP]="=VARP(A2:A11)",e[A.b.YEAR]="=YEAR(39634)",e[A.b.INFO]='=INFO("'.concat(FormulaAuthoringStrings.Numfile,'")'),e[A.b.EVEN]="=EVEN(1.5)",e[A.b.FINV]="=FINV(0.42, 2, 3)",e[A.b.PROB]="=PROB(A3:A6,B3:B6,2)",e[A.b.KURT]="=KURT(A2:A11)",e[A.b.SKEW]="=SKEW(A2:A11)",e[A.b.MODE]="=MODE(A2:A7)",e[A.b.MINA]="=MINA(A2:A6)",e[A.b.MAXA]="=MAXA(A2:A6)",e[A.b.VARA]="=VARA(1, 2)",e[A.b.SORT]="=SORT(A2:A17)",e[A.b.ASIN]="=ASIN(-0.5)",e[A.b.BASE]="=BASE(7,2)",e[A.b.CODE]='=CODE("'.concat(FormulaAuthoringStrings.CodeA,'")'),e[A.b.AND]="=AND(A2>1,A2<100)",e[A.b.COS]="=COS(1.047)",e[A.b.COT]="=COT(30)",e[A.b.CSC]="=CSC(15)",e[A.b.DAY]="=DAY(40648)",e[A.b.DDB]="=DDB(2400,300,10*365,1)",e[A.b.RTD]='=RTD(mycomaddin.progid,,"'.concat(FormulaAuthoringStrings.ServerName,'","').concat(FormulaAuthoringStrings.Price,'")'),e[A.b.EXP]="=EXP(1)",e[A.b.INT]="=INT(8.9)",e[A.b.IRR]="=IRR(A2:A4,-10%)",e[A.b.LEN]='=LEN("'.concat(FormulaAuthoringStrings.Excel,'")'),e[A.b.LOG]="=LOG(10)",e[A.b.MAX]="=MAX(A2:A6)",e[A.b.MID]='=MID("'.concat(FormulaAuthoringStrings.FluidFlow,'",1,5)'),e[A.b.MIN]="=MIN(A2:A6)",e[A.b.MOD]="=MOD(3, 2)",e[A.b.NOT]="=NOT(A2>100)",e[A.b.NPV]="=NPV(0.1, -10000, 3000, 4200, 6800)",e[A.b.PMT]="=PMT(0.08/12,10,10000)",e[A.b.ROW]="=ROW(C10)",e[A.b.RRI]="=RRI(96,10000,11000)",e[A.b.SEC]="=SEC(30)",e[A.b.SIN]="=SIN(PI())",e[A.b.SLN]="=SLN(30000, 7500, 10)",e[A.b.SUM]="=SUM(A1:A3)",e[A.b.SYD]="=SYD(30000,7500,10,1)",e[A.b.TAN]="=TAN(0.785)",e[A.b.VAR]="=VAR(A2:A11)",e[A.b.VDB]="=VDB(2400, 300, 10*365, 0, 1)",e[A.b.XOR]="=XOR(3>0,2<9)",e[A.b.ODD]="=ODD(1.5)",e[A.b.PHI]="=PHI(0.75)",e[A.b.RSQ]="=RSQ(A3:A9, B3:B9)",e[A.b.IFS]='=IFS(A2>89,"'.concat(FormulaAuthoringStrings.IfsA,'",A2>79,"').concat(FormulaAuthoringStrings.IfsB,'",A2>69,"').concat(FormulaAuthoringStrings.IfsC,'",A2>59,"').concat(FormulaAuthoringStrings.IfsD,'",TRUE,"').concat(FormulaAuthoringStrings.IfsF,'")'),e[A.b.DB]="=DB(1000000,100000,6,1,7)",e[A.b.FV]="=FV(0.06/12, 10, -200, -500, 1)",e[A.b.IF]='=IF(C2>B2,"'.concat(FormulaAuthoringStrings.OverBudget,'","').concat(FormulaAuthoringStrings.WithinBudget,'")'),e[A.b.LN]="=LN(86)",e[A.b.NA]="=NA()",e[A.b.OR]="=OR(A2>1,A2<100)",e[A.b.PV]="=PV(0.08/12, 12*20, 500, , 0)",e[A.b.N]="=N(".concat(FormulaAuthoringStrings.Even,")"),e[A.b.T]='=T("'.concat(FormulaAuthoringStrings.Hello,'")'),e[A.b.ACCRINT]="=ACCRINT(39508,39691,39569,0.1,1000,2,0)",e[A.b.ACCRINTM]="=ACCRINTM(39539,39614,0.1,1000,3)",e[A.b.AMORDEGRC]="=AMORDEGRC(2400,39679,39813,300,1,0.15,1)",e[A.b.AMORLINC]="=AMORLINC(2400,39679,39813,300,1,0.15,1)",e[A.b.BESSELI]="=BESSELI(1.5,1)",e[A.b.BESSELJ]="=BESSELJ(1.9,2)",e[A.b.BESSELK]="=BESSELK(1.5,1)",e[A.b.BESSELY]="=BESSELY(2.5,1)",e[A.b.BIN2DEC]="=BIN2DEC(1100100)",e[A.b.BIN2HEX]="=BIN2HEX(11111011, 4)",e[A.b.BIN2OCT]="=BIN2OCT(1001, 3)",e[A.b.COMPLEX]='=COMPLEX(3,4,"j")',e[A.b.CONVERT]='=CONVERT(1,"lbm","kg")',e[A.b.COUPDAYBS]="=COUPDAYBS(25-Jan-11,15-Nov-11,2,1)",e[A.b.COUPDAYS]="=COUPDAYS(25-Jan-11,15-Nov-11,2,1)",e[A.b.COUPDAYSNC]="=COUPDAYSNC(25-Jan-11,15-Nov-11,2,1)",e[A.b.COUPNCD]="=COUPNCD(25-Jan-11,15-Nov-11,2,1)",e[A.b.COUPNUM]="=COUPNUM(25-Jan-11,15-Nov-12,2,1)",e[A.b.COUPPCD]="=COUPPCD(25-Jan-11,15-Nov-11,2,1)",e[A.b.CUMIPMT]="=CUMIPMT(A2/12,A3*12,A4,13,24,0)",e[A.b.CUMPRINC]="=CUMPRINC(A2/12,A3*12,A4,13,24,0)",e[A.b.DEC2BIN]="=DEC2BIN(9, 4)",e[A.b.DEC2HEX]="=DEC2HEX(100,4)",e[A.b.DEC2OCT]="=DEC2OCT(58,3)",e[A.b.DELTA]="=DELTA(5,4)",e[A.b.DISC]="=DISC(7/1/2018,1/1/2048,97.975,100,1)",e[A.b.DOLLARDE]="=DOLLARDE(1.02,16)",e[A.b.DOLLARFR]="=DOLLARFR(1.125,16)",e[A.b.DURATION]="=DURATION(7/1/2018,1/1/2048,8%,9%,2,1)",e[A.b.EDATE]="=EDATE(15-Jan-11,1)",e[A.b.EFFECT]="=EFFECT(0.0525,4)",e[A.b.EOMONTH]="=EOMONTH(1-Jan-11,1)",e[A.b.ERF]="=ERF(0.745)",e[A.b.ERFC]="=ERFC(1)",e[A.b.FACTDOUBLE]="=FACTDOUBLE(6)",e[A.b.FORECAST_ETS]="=FORECAST.ETS(A62,$B$4:$B$60,$A$4:$A$60,1,1)",e[A.b.FORECAST_ETS_CONFINT]="=FORECAST.ETS.CONFINT(A62,$B$4:$B$60,$A$4:$A$60,0.95,1,1)",e[A.b.FORECAST_ETS_SEASONALITY]="=FORECAST.ETS.SEASONALITY($B$4:$B$60,$A$4:$A$60,1,1)",e[A.b.FORECAST_ETS_STAT]="=FORECAST.ETS.STAT($B$4:$B$60,$A$4:$A$60,1,J48,1,1)",e[A.b.FVSCHEDULE]="=FVSCHEDULE(1,{0.09,0.11,0.1})",e[A.b.GCD]="=GCD(24,36)",e[A.b.GESTEP]="=GESTEP(5,4)",e[A.b.HEX2BIN]="=HEX2BIN(F,8)",e[A.b.HEX2DEC]="=HEX2DEC(FFFFFFFF5B)",e[A.b.HEX2OCT]="=HEX2OCT(F, 3)",e[A.b.IMABS]='=IMABS("5+12i")',e[A.b.IMAGE]='=IMAGE("https://microsoft.com/abc.jpg", "Microsoft", 0)',e[A.b.IMAGINARY]='=IMAGINARY("3+4i")',e[A.b.IMARGUMENT]='=IMARGUMENT("3+4i")',e[A.b.IMCONJUGATE]='=IMCONJUGATE("3+4i")',e[A.b.IMCOS]='=IMCOS("1+i")',e[A.b.IMDIV]='=IMDIV("-238+240i","10+24i")',e[A.b.IMEXP]='=IMEXP("1+i")',e[A.b.IMLN]='=IMLN("3+4i")',e[A.b.IMLOG10]='=IMLOG10("3+4i")',e[A.b.IMLOG2]='=IMLOG2("3+4i")',e[A.b.IMPOWER]='=IMPOWER("2+3i", 3)',e[A.b.IMPRODUCT]='=IMPRODUCT("3+4i","5-3i")',e[A.b.IMREAL]='=IMREAL("6-9i")',e[A.b.IMSIN]='=IMSIN("4+3i")',e[A.b.IMSQRT]='=IMSQRT("1+i")',e[A.b.IMSUB]='=IMSUB("13+4i","5+3i")',e[A.b.IMSUM]='=IMSUM("3+4i","5-3i")',e[A.b.INTRATE]="=INTRATE(2/15/2008,5/15/2008,1000000,1014420,2)",e[A.b.ISEVEN]="=ISEVEN(2.5)",e[A.b.ISODD]="=ISODD(2.5)",e[A.b.LAMBDA]="=LAMBDA(a, b, SQRT((a^2+b^2)))",e[A.b.LET]="=LET(".concat(FormulaAuthoringStrings.Total,", SUM(A1:A10), ").concat(FormulaAuthoringStrings.Count,", COUNT(A1:A10), ").concat(FormulaAuthoringStrings.Total," / ").concat(FormulaAuthoringStrings.Count,")"),e[A.b.LCM]="=LCM(5,2)",e[A.b.LOG10]="=LOG10(86)",e[A.b.MDURATION]="=MDURATION(1/1/2008,1/1/2016,8%,9%,2,1)",e[A.b.MROUND]="=MROUND(10,3)",e[A.b.MULTINOMIAL]="=MULTINOMIAL(2,3,4)",e[A.b.NETWORKDAYS]="=NETWORKDAYS(10/1/2012,3/1/2013)",e[A.b.NOMINAL]="=NOMINAL(0.053543, 4)",e[A.b.NOW]="=NOW()",e[A.b.OCT2BIN]="=OCT2BIN(3,3)",e[A.b.OCT2DEC]="=OCT2DEC(54)",e[A.b.OCT2HEX]="=OCT2HEX(100,4)",e[A.b.ODDFPRICE]="=ODDFPRICE(11/11/2008,3/1/2021,10/15/2008,3/1/2009,7.85%,6.25%,100,2,1)",e[A.b.ODDFYIELD]="=ODDFYIELD(11/11/2008,3/1/2021,10/15/2008,3/1/2009,5.75%,84.5,100,2,0)",e[A.b.ODDLPRICE]="=ODDLPRICE(2/7/2008,6/15/2008,10/15/2007,3.75%,4.05%,100,2,0)",e[A.b.ODDLYIELD]="=ODDLYIELD(4/20/2008,6/15/2008,12/24/2007,3.75%,99.875,100,2,0)",e[A.b.PI]="=PI()",e[A.b.PRICE]="=PRICE(2/15/2008,11/15/2017,5.75%,6.5%,100,2,0)",e[A.b.PRICEDISC]="=PRICEDISC(2/16/2008,3/1/2008,5.25%,100,2)",e[A.b.PRICEMAT]="=PRICEMAT(2/15/2008,4/13/2008,11/11/2007,6.1%,6.1%,0)",e[A.b.QUOTIENT]="=QUOTIENT(5,2)",e[A.b.RANDBETWEEN]="=RANDBETWEEN(1,100)",e[A.b.RECEIVED]="=RECEIVED(2/15/2008,5/15/2008,1000000,5.75%,2)",e[A.b.RECURSE]="=RECURSE()",e[A.b.ROUNDDOWN]="=ROUNDDOWN(3.14159,3)",e[A.b.ROUNDUP]="=ROUNDUP(3.14159,3)",e[A.b.SERIESSUM]="=SERIESSUM(0.785398163,0,2,A4:A7)",e[A.b.SQRTPI]="=SQRTPI(1)",e[A.b.TBILLEQ]="=TBILLEQ(3/31/2008,6/1/2008,9.14%)",e[A.b.TBILLPRICE]="=TBILLPRICE(3/31/2008,6/1/2008,9%)",e[A.b.TBILLYIELD]="=TBILLYIELD(3/31/2008,6/1/2008,98.45%)",e[A.b.TINV]="=TINV(0.05464,60)",e[A.b.WEEKNUM]="=WEEKNUM(3/9/2012,2)",e[A.b.WORKDAY]="=WORKDAY(10/1/2008,151)",e[A.b.XIRR]="=XIRR(A3:A7, B3:B7, 0.1)",e[A.b.XNPV]="=XNPV(0.09, A2:A6, B2:B6)",e[A.b.YEARFRAC]="=YEARFRAC(1/1/2012,7/30/2012)",e[A.b.YIELD]="=YIELD(2/15/2008,11/15/2016,5.75%,95.04287,100,2,0)",e[A.b.YIELDDISC]="=YIELDDISC(2/16/2008,3/1/2008,99.795,100,2)",e[A.b.YIELDMAT]="=YIELDMAT(3/15/2008,11/3/2008,11/8/2007,6.25%,100.0123,0)",e})),Bt=r(41),Ut=function(e){function t(t,r){var n=e.call(this)||this;return n.parsedFormulaTree=t,n.caretPosition=r,n.assistedFunctionScopeStart=0,n.autoCompleteAfterFunctionNameEnabled=!1,n.autoCompleteAfterFunctionNameEnabled=Object(Bt.isChangeGateEnabled)("OfficeVSO:6128020_AutoCompleteAfterFunctionName"),n}return Object(Le.__extends)(t,e),t.prototype.appNode=function(t,r,n,i){return t.kind===I.e.WSF&&this.updateAssistedFunction(t,r),e.prototype.appNode.call(this,t,r,n,i)},t.prototype.letNode=function(t,r,n,i,a,o){var s=e.prototype.letNode.call(this,t,r,n,i,a,o);return this.updateAssistedFunction(t,s.args),s},t.prototype.lambdaNode=function(t,r,n,i,a,o){var s=e.prototype.lambdaNode.call(this,t,r,n,i,a,o);return this.updateAssistedFunction(t,s.args),s},t.prototype.updateAssistedFunction=function(e,t){return(this.autoCompleteAfterFunctionNameEnabled?this.updateAssistedFunction_NEW.bind(this):this.updateAssistedFunction_OLD.bind(this))(e,t)},t.prototype.updateAssistedFunction_OLD=function(e,t){var r,n,i,a=null===(r=this.parsedFormulaTree.spans[t[0].label])||void 0===r?void 0:r.start,o=null===(n=this.parsedFormulaTree.spans[t[t.length-1].label])||void 0===n?void 0:n.end;void 0!==o&&void 0!==a&&this.caretPosition<=o&&(this.caretPosition>=a||1===(null===(i=this.parsedFormulaTree.spans[e.label])||void 0===i?void 0:i.start))&&(void 0===this.assistedFunctionHead||a>this.assistedFunctionScopeStart)&&void 0!==this.parsedFormulaTree.spans[e.label]&&(this.assistedFunctionHead=e,this.assistedFunctionArgs=t,this.assistedFunctionScopeStart=a)},t.prototype.updateAssistedFunction_NEW=function(e,t){var r=this.parsedFormulaTree.spans[t[0].label].start,n=this.parsedFormulaTree.spans[t[t.length-1].label].end;this.caretPosition<=n&&this.caretPosition>=r&&(void 0===this.assistedFunctionHead||r>this.assistedFunctionScopeStart)&&(this.assistedFunctionHead=e,this.assistedFunctionArgs=t,this.assistedFunctionScopeStart=r)},t}(K.e);function Gt(e,t,r,n,i,a,o,s,u){var c=function(e,t,r){for(var n,i=0,a=t.length-1;a>=0;a-=1){var o=null===(n=e.spans[t[a].label])||void 0===n?void 0:n.end;void 0!==o&&r<=o&&(i=a)}return i}(t,r,n),l=e.Params.split("!");return{functionName:e.NameDataStrings,functionDescription:e.Help,signatures:l.map((function(t,r){return function(e,t,r,n,i,a,o,s,u){var c=Object(A.d)(i),l=""!==t?t.split(a+" ").filter((function(e){return"..."!==e})):[],d=function(e,t,r,n){var i=e.slice(),a=t.headTypes.length,o=t.restTypes.length;if(o>0){for(var s=1+Math.max(Math.floor((r-a)/o),0),u=a;u<i.length;u+=o){for(var c=0;c<o;c+=1){var l=Ht(i[u+c]),d=s>1&&c%o==0?"[":"",f=s>1&&c%o==o-1?"]":"";i[u+c]="".concat(d).concat(l).concat(s).concat(f)}s+=1}i.push("..."),Wt(r,t,n)&&i.splice(a,0,"...")}return i}(l,c,n,o),f=function(e,t){if(void 0===e||void 0===t)return null;return t.node.args.map((function(r){var n=t.spans[r.label];return n?e.substring(n.start,n.end):""}))}(s,u),p=function(e,t,r,n){var i=e.split("!");i=0===n?i.slice(0,t.length):i.slice(-1*t.length);if(r.restTypes.length>0){for(var a=r.headTypes.length;a<i.length;a+=1){var o=Ht(t[a]),s="".concat(o,"1,").concat(o,"2,... ");i[a]=s+i[a]}1===r.restTypes.length&&i.push(i[r.headTypes.length])}return i}(e.ParamsHelp,l,c,r),m=function(e,t){return e.filter((function(e){return"..."!==e})).slice(0,t.length).map((function(e){return function(e){if(e.startsWith("[")&&!e.endsWith("]"))return e+"]";if(!e.startsWith("[")&&e.endsWith("]"))return"["+e;return e}(e)}))}(d,p);return{signatureParams:qt(d,Vt(n,l.length,c,o)),descriptions:p,descriptionParams:qt(m,Kt(n,m.length,c,o)),exampleParams:null!==f?qt(f,Kt(n,f.length,c,o,!0)):null,exampleDescription:""}}(e,t,r,c,i,a,o,s,u)})),activeSignature:0,listSeparator:a,isUDF:e.IsDynamicUdf,helpID:e.HelpId}}function Kt(e,t,r,n,i){void 0===i&&(i=!1);var a=t-1;if(n){if(e<r.headTypes.length+r.restTypes.length)return e;if(e>=r.headTypes.length&&0===r.restTypes.length)return-1}else if(0===r.restTypes.length||e<r.headTypes.length+r.restTypes.length)return Math.min(e,a);var o=(e-r.headTypes.length)%r.restTypes.length;return i?e<=a-r.tailTypes.length?e:a-r.tailTypes.length-(r.restTypes.length-1)+o:r.headTypes.length+o}function Vt(e,t,r,n){var i=Kt(e,t,r,n);return Wt(e,r,n)&&(i+=1),i}function Wt(e,t,r){return(!r||t.restTypes.length>0)&&e>=t.headTypes.length+t.restTypes.length}function Ht(e){return e.match(/[^0-9\[\]]+/)}function qt(e,t){return{params:e,activeParam:Math.min(t,e.length-1)}}var zt=r(34),Qt=r(67),Jt=function(){function e(){this.factoryName=wt.a.ArgumentAssistancePlugin}return e.prototype.create=function(){return new Yt},e}(),Yt=function(){function e(){this.illegalParamHighlightFixEnabled=Object(Bt.isChangeGateEnabled)("OfficeVSO:6210910_ArgumentAssistanceDontHightlightIlegalParam"),this.timer=Qt.b,this.lastRunTime=0,this.runStartTime=0,this.timeStamps=new Map}return e.prototype.run=function(e){var t,r,n,i,a,o,s,u,c,l,d,f,p,m,h,v,g,b,S,y=this;return Object(Le.__generator)(this,(function(O){switch(O.label){case 0:return this.lastRunTime=this.timer.now(),this.runStartTime=this.timer.now(),this.timeStamps=new Map,[4,{kind:Dt.a.GetActiveCell}];case 1:return(t=O.sent()).kind!==Dt.a.GetActiveCell?(this.logFailure("failed to get active cell"),[2,null]):(this.addTimeStamp("GetActiveCell"),[4,{kind:Dt.a.ParseActiveCell,formulaText:e.content}]);case 2:return r=O.sent(),this.addTimeStamp("ParseCellContentSync"),void 0!==r&&r.kind===Dt.a.ParseActiveCell&&Object(E.c)(r.result)?[3,4]:(n=void 0===r||r.kind!==Dt.a.ParseActiveCell?"parseResultUndefined":r.result,this.logFailure("ParseActiveCellFailed. failReasonKind: ".concat(JSON.stringify(n))),[4,{kind:Dt.a.ParseEdit,cell:t.activeCell,formulaBarText:e.content}]);case 3:if(r=O.sent(),this.addTimeStamp("ParseCellContentAsync"),r.kind!==Dt.a.ParseEdit||!Object(E.c)(r.result))return i=r.kind!==Dt.a.ParseEdit?"parseResultUndefined":r.result,this.logFailure("ParseEditFailed. failResult: ".concat(JSON.stringify(i))),[2,null];O.label=4;case 4:return r.result.value.kind!==fe.e.Formula?[2,null]:(a=r.result.value.formula,o=new Ut(a,e.caretPosition),Object(K.j)(o,a),this.addTimeStamp("ArgumentAssistanceVisitor"),void 0===o.assistedFunctionHead?(this.logTimeStamp(),[2,null]):[4,{kind:Dt.a.GetFunctionInfo,functionName:o.assistedFunctionHead.whole}]);case 5:return s=O.sent(),this.addTimeStamp("GetFunctionInfo"),s.kind!==Dt.a.GetFunctionInfo?(this.logFailure("failed to get function info for ".concat(o.assistedFunctionHead.whole)),[2,null]):[4,{kind:Dt.a.GetConfig}];case 6:return u=O.sent(),this.addTimeStamp("GetConfig"),c=u.kind===Dt.a.GetConfig?u.config.localeInfo.listSeparator:",",l=new $e.a((function(){return Gt(s.functionInfo,a,o.assistedFunctionArgs,e.caretPosition,o.assistedFunctionHead.id,c,y.illegalParamHighlightFixEnabled)})),d=Lt.getValue()[o.assistedFunctionHead.id],this.addTimeStamp("GetExampleString"),void 0===d?(this.logFailure("no example found for function: ".concat(o.assistedFunctionHead.whole)),this.addTimeStampAndLog("createFunctionRenderingInfoNoExample"),[2,l.getValue()]):[4,{kind:Dt.a.ParseCellFormula,cell:t.activeCell,formula:{formulaBarText:d,kind:Rt.a.CellFormula},useEnglishLocaleInfo:!0}];case 7:return f=O.sent(),this.addTimeStamp("ParseExample"),f.kind===Dt.a.ParseCellFormula&&Object(E.c)(f.result)?u.kind===Dt.a.GetConfig&&u.config.localeInfo.lcid===L.b.USA?(m=Gt(s.functionInfo,a,o.assistedFunctionArgs,e.caretPosition,o.assistedFunctionHead.id,c,this.illegalParamHighlightFixEnabled,d,f.result.value),this.addTimeStampAndLog("createFunctionRenderingInfoEnUs"),[2,m]):[4,{kind:Dt.a.PrintFormula,formula:f.result.value,origin:t.activeCell}]:(this.logFailure("failed to parse example for function: ".concat(o.assistedFunctionHead.whole)),p=l.getValue(),this.addTimeStampAndLog("createFunctionRenderingInfoFailedToParseExample"),[2,p]);case 8:return h=O.sent(),this.addTimeStamp("localize example string"),h.kind===Dt.a.PrintFormula&&Object(E.c)(h.result)?[4,{kind:Dt.a.ParseCellFormula,cell:t.activeCell,formula:{formulaBarText:h.result.value,kind:Rt.a.CellFormula},useEnglishLocaleInfo:!1}]:(this.logFailure("failed to pretty print localized example for function: ".concat(o.assistedFunctionHead.whole)),v=l.getValue(),this.addTimeStampAndLog("createFunctionRenderingInfoFailedToPrintLocalizedExample"),[2,v]);case 9:return g=O.sent(),this.addTimeStamp("parse localized example string"),g.kind===Dt.a.ParseCellFormula&&Object(E.c)(g.result)?(S=Gt(s.functionInfo,a,o.assistedFunctionArgs,e.caretPosition,o.assistedFunctionHead.id,c,this.illegalParamHighlightFixEnabled,h.result.value,g.result.value),this.addTimeStampAndLog("createFunctionRenderingInfoWithLocalizedExample"),[2,S]):(this.logFailure("failed to parse localized example for function: ".concat(o.assistedFunctionHead.whole)),b=l.getValue(),this.addTimeStampAndLog("createFunctionRenderingInfoFailedToParseLocalizedExample"),[2,b])}}))},e.prototype.logFailure=function(e){L.y.ULS.traceTag(545388683,L.c.msoulscat_ES_EWAJS,L.i.Warning,"ArgumentAssistancePlugin encountered a failure with msg ".concat(e))},e.prototype.addTimeStampAndLog=function(e){this.addTimeStamp(e),this.logTimeStamp()},e.prototype.logTimeStamp=function(){this.timeStamps.set("Overall",this.timer.now()-this.runStartTime);var e={};this.timeStamps.forEach((function(t,r){e[r]=t})),L.y.ULS.traceTag(540377222,L.c.msoulscat_ES_EWAJS,L.i.Info,"".concat(JSON.stringify(e)))},e.prototype.addTimeStamp=function(e){this.timeStamps.set(e,this.timer.now()-this.lastRunTime),this.lastRunTime=this.timer.now()},e}();Object(wt.d)(new Jt);var $t=Object($e.b)((function(){return Object(Le.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(Le.__generator)(this,(function(t){switch(t.label){case 0:return Object(T.b)("Microsoft.Office.Excel.ArgumentAssistanceOnMainThread")?[4,zt.b.getValue()]:[3,2];case 1:return e=t.sent(),[3,4];case 2:return[4,zt.e.getValue()];case 3:e=t.sent(),t.label=4;case 4:return[4,e.loadPluginScript("formula-authoring-strings",!0)];case 5:return t.sent(),[4,e.createAndAttachPlugin(wt.a.ArgumentAssistancePlugin)];case 6:return t.sent(),[4,zt.c.getValue()];case 7:return t.sent(),[2]}}))}))})),Zt=function(e){function t(t,r){var n=e.call(this)||this;return n.parsedFormulaTree=t,n.caretPosition=r,n.autoCompleteAfterFunctionNameEnabled=!1,n.autoCompleteAfterFunctionNameEnabled=Object(Bt.isChangeGateEnabled)("OfficeVSO:6128020_AutoCompleteAfterFunctionName"),n}return Object(Le.__extends)(t,e),t.prototype.nameNode=function(e,t,r){return(this.autoCompleteAfterFunctionNameEnabled?this.nameNode_NEW.bind(this):this.nameNode_OLD.bind(this))(e,t,r)},t.prototype.nameNode_NEW=function(t,r,n){return t.kind!==I.d.IdentNamePart&&t.kind!==I.d.FieldRefNamePart||this.updateAutocompleteString(n,t.asWhole),e.prototype.nameNode.call(this,t,r,n)},t.prototype.nameNode_OLD=function(t,r,n){var i,a,o;return t.kind===I.d.IdentNamePart&&(null===(i=this.parsedFormulaTree.spans[n])||void 0===i?void 0:i.end)===this.caretPosition&&(this.autocompleteString=t.asWhole,this.stringStartPosition=null===(a=this.parsedFormulaTree.spans[n])||void 0===a?void 0:a.start,this.stringEndPosition=null===(o=this.parsedFormulaTree.spans[n])||void 0===o?void 0:o.end),e.prototype.nameNode.call(this,t,r,n)},t.prototype.appNode=function(t,r,n,i){return this.autoCompleteAfterFunctionNameEnabled&&t.kind===I.e.WSF&&this.updateAutocompleteString(i,t.whole),e.prototype.appNode.call(this,t,r,n,i)},t.prototype.updateAutocompleteString=function(e,t){var r=this.parsedFormulaTree.spans[e].start,n=r+t.length;this.caretPosition===n&&(this.autocompleteString=t,this.stringEndPosition=n,this.stringStartPosition=r)},t}(K.e),Xt=r(122),er=r(36),tr=r(63),rr=function(){function e(){this.factoryName=wt.a.AutocompleteFunctionPlugin}return e.prototype.create=function(){return new nr},e}(),nr=function(){function e(){}return e.prototype.run=function(e){var t,r,n,i,a,o,s,u,c,l,d,f,p,m,h,v,g;return Object(Le.__generator)(this,(function(b){switch(b.label){case 0:return[4,{kind:Dt.a.ParseActiveCell,formulaText:e.content}];case 1:return(t=b.sent()).kind===Dt.a.ParseActiveCell&&Object(E.c)(t.result)?t.result.value.kind!==fe.e.Formula?[2,null]:(r=t.result.value.formula,n=new Zt(r,e.caretPosition),Object(K.j)(n,r),void 0===n.autocompleteString||void 0===n.stringStartPosition||void 0===n.stringEndPosition?[2,null]:(i=n.autocompleteString.toUpperCase(),a=n.stringStartPosition,o=n.stringEndPosition,[4,{kind:Dt.a.GetFunctionsInfo}])):(this.logFailure("failed to parse cell content"),[2,null]);case 2:return(s=b.sent()).kind!==Dt.a.GetFunctionsInfo?(this.logFailure("failed to get functions info"),[2,null]):(u=s.functionsInfo,c=Object(tr.a)(i,u,(function(e){return e.NameDataStrings})),l=c.prefixedSuggestions,d=c.notPrefixedSuggestions,null!==(f=Xt.b.getValue())&&null!==f.descriptionsMap||this.logFailure("failed to get short descriptions, will show function info help description"),p="("===(null===(g=e.content)||void 0===g?void 0:g.charAt(o)),m=p?"":"(",h=this.generateCompletionItems(l,f,a,o,!0,m),v=this.generateCompletionItems(d,f,a,o,!1,m),[2,{items:Object(Le.__spreadArray)(Object(Le.__spreadArray)([],h,!0),v,!0)}])}}))},e.prototype.generateCompletionItems=function(e,t,r,n,i,a){return e.map((function(e){var o,s;return{label:e.NameDataStrings,kind:er.a.Function,detail:null!==(s=null===(o=t.descriptionsMap)||void 0===o?void 0:o.get(e.FunctionIndexInServer))&&void 0!==s?s:e.Help,textEdit:{newText:e.NameDataStrings+a,range:{start:{line:0,character:r},end:{line:0,character:n}}},isPrefixed:i}}))},e.prototype.logFailure=function(e){L.y.ULS.traceTag(539083013,L.c.msoulscat_ES_EWAJS,L.i.Warning,"AutocompleteFunctionPlugin encountered a failure with msg ".concat(e))},e}();Object(wt.d)(new rr);var ir=Object($e.b)((function(){return Object(Le.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(Le.__generator)(this,(function(t){switch(t.label){case 0:return[4,zt.a.getValue()];case 1:return[4,(e=t.sent()).loadPluginScript("formula-authoring-strings",!0)];case 2:return t.sent(),[4,e.createAndAttachPlugin(wt.a.AutocompleteFunctionPlugin)];case 3:return t.sent(),[4,zt.c.getValue()];case 4:return t.sent(),[2]}}))}))})),ar=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(Le.__extends)(t,e),t.prototype.nameNode=function(t,r,n){var i,a=null===(i=this.formula.spans[n])||void 0===i?void 0:i.end;return void 0!==a&&this.caretPosition===a&&t.asWhole.length>0&&(this.caretNodeText=t.asWhole),e.prototype.nameNode.call(this,t,r,n)},t}(ie),or=function(){function e(){this.factoryName=wt.a.AutocompleteLetPlugin}return e.prototype.create=function(){return new sr},e}(),sr=function(){function e(){}return e.prototype.run=function(e){var t,r,n,i,a,o,s,u,c,l,d,f,p,m;return Object(Le.__generator)(this,(function(h){switch(h.label){case 0:return[4,{kind:Dt.a.ParseActiveCell,formulaText:e.content}];case 1:return(t=h.sent()).kind===Dt.a.ParseActiveCell&&Object(E.c)(t.result)?t.result.value.kind!==fe.e.Formula?[2,null]:(r=t.result.value.formula,n=e.caretPosition,i=new ar(r,n),Object(K.j)(i,r),a=i.references.reverse(),o=Array.from(new Set(a)),void 0===(s=i.caretNodeText)?[2,null]:(c=(u=n)-s.length,l=Object(tr.a)(s,o),d=l.prefixedSuggestions,f=l.notPrefixedSuggestions,p=this.stringsToCompletionItems(d,c,u,!0),m=this.stringsToCompletionItems(f,c,u,!1),[2,{items:Object(Le.__spreadArray)(Object(Le.__spreadArray)([],p,!0),m,!0)}])):(this.logFailure("failed to parse cell content"),[2,null])}}))},e.prototype.stringsToCompletionItems=function(e,t,r,n){return e.map((function(e){return{label:e,kind:er.a.LetVariable,type:er.b.Simple,textEdit:{newText:e,range:{start:{line:0,character:t},end:{line:0,character:r}}},isPrefixed:n}}))},e.prototype.logFailure=function(e){L.y.ULS.traceTag(538056603,L.c.msoulscat_ES_EWAJS,L.i.Warning,"AutocompleteLetPlugin encountered a failure with msg ".concat(e))},e}();Object(wt.d)(new or);var ur=Object($e.b)((function(){return Object(Le.__awaiter)(void 0,void 0,void 0,(function(){return Object(Le.__generator)(this,(function(e){switch(e.label){case 0:return[4,zt.a.getValue()];case 1:return[4,e.sent().createAndAttachPlugin(wt.a.AutocompleteLetPlugin)];case 2:return e.sent(),[4,zt.c.getValue()];case 3:return e.sent(),[2]}}))}))})),cr=function(e){function t(t,r){var n=e.call(this)||this;return n.parsedFormulaTree=t,n.dotNotationIndex=r,n}return Object(Le.__extends)(t,e),t.prototype.cellRefNode=function(t,r,n){var i,a=null===(i=this.parsedFormulaTree.spans[n])||void 0===i?void 0:i.end;return void 0!==a&&this.dotNotationIndex===a&&(this.cellRef=t,this.qualifier=r),e.prototype.cellRefNode.call(this,t,r,n)},t}(K.e),lr=ne.parseFieldRefModule.isUnbracketedField,dr=(ne.parseFieldRefModule.parseFieldRef,r(154)),fr=function(){function e(){this.factoryName=wt.a.AutocompleteRichValuePlugin}return e.prototype.create=function(){return new pr},e}(),pr=function(){function e(){}return e.prototype.run=function(t){var r,n,i,o,s,u,c,l,d,f,p,m,h,v,g,b,S,y,O,C,P;return Object(Le.__generator)(this,(function(N){switch(N.label){case 0:return Object(a.f)(t.content)||Object(a.f)(t.caretPosition)||t.caretPosition!==t.content.length?(this.logFailure("missing request arguments"),[2,null]):(r=t.content.lastIndexOf("."),n=-1!==r?r:t.caretPosition,[4,{kind:Dt.a.ParseActiveCell,formulaText:t.content.slice(0,n)}]);case 1:return(i=N.sent()).kind===Dt.a.ParseActiveCell&&Object(E.c)(i.result)?i.result.value.kind!==fe.e.Formula?[2,null]:(o=i.result.value.formula,s=new cr(o,n),Object(K.j)(s,o),u=s.cellRef,Object(a.f)(u)||u.kind!==I.c.Single?[2,null]:(c=e.getRangeStringFromParsedCellRef(o,u,t.content),Object(a.f)(c)?(this.logFailure("failed to parse cellRef"),[2,null]):[4,{kind:Dt.a.GetActiveCell}])):(this.logFailure("failed to parse cell content"),[2,null]);case 2:return(l=N.sent()).kind!==Dt.a.GetActiveCell?(this.logFailure("failed to get active cell"),[2,null]):(d="",s.qualifier&&s.qualifier.kind===I.g.Sheet?(d=s.qualifier.sheet,[3,5]):[3,3]);case 3:return[4,{kind:Dt.a.GetSheetNames}];case 4:if((f=N.sent()).kind!==Dt.a.GetSheetNames)return this.logFailure("failed to get sheet names"),[2,null];if(!Object(x.x)(l.activeCell.sheet.document,f.document))return this.logFailure("sheet names document is different than that of active cell"),[2,null];d=f.sheets[f.idToIndex[l.activeCell.sheet.index]].sheetName,N.label=5;case 5:return p=u.row.kind===I.f.Rel?u.row.index+l.activeCell.range.row:u.row.index,m=u.col.kind===I.f.Rel?u.col.index+l.activeCell.range.col:u.col.index,h={FirstRow:p,LastRow:p,FirstColumn:m,LastColumn:m,SheetName:d,NamedObjectName:""},[4,{kind:Dt.a.GetRichValueFieldListContext,rangeToQuery:h,dotNotationPath:c,singleColumn:!1,findRange:!1}];case 6:return(v=N.sent()).kind!==Dt.a.GetRichValueFieldListContext||Object(a.f)(v.result)?(this.logFailure("failed to get field list context data"),[2,null]):(v.result.length>1&&this.logFailure("fieldListContextRequest results length greater than 1"),g=t.content.slice(n).replace(/[\[\].]+/g,""),b=Object(tr.a)(g,v.result[0].FieldInfoDataList.map((function(e){return e.Name})),void 0,!0),S=b.prefixedSuggestions,y=b.notPrefixedSuggestions,[4,{kind:Dt.a.GetConfig}]);case 7:return O=N.sent(),C=this.resultsToCompletionItems(S,!0,O,n,t.caretPosition),P=this.resultsToCompletionItems(y,!1,O,n,t.caretPosition),[2,{items:Object(Le.__spreadArray)(Object(Le.__spreadArray)([],C,!0),P,!0)}]}}))},e.getRangeStringFromParsedCellRef=function(e,t,r){var n,i,o=null===(n=e.spans[t.label])||void 0===n?void 0:n.start,s=null===(i=e.spans[t.label])||void 0===i?void 0:i.end;if(Object(a.e)(o)&&Object(a.e)(s)&&o>=0&&s<=r.length)return r.substring(o,s)},e.getTextToCommit=function(e,t){var r=e;r=(r=(r=r.replace("'","''")).replace("[","'[")).replace("]","']");var n=t.kind===Dt.a.GetConfig?t.config.localeInfo:void 0;return n&&!lr(n,r)?".[".concat(r,"]"):".".concat(r)},e.prototype.resultsToCompletionItems=function(t,r,n,i,a){return t.map((function(t){return{label:t,kind:er.a.RichEntity,detail:"",textEdit:{newText:e.getTextToCommit(t,n),range:{start:{line:0,character:i},end:{line:0,character:a}}},isPrefixed:r}}))},e.prototype.logFailure=function(e){o.h.ULS.traceTag(529056660,dr.LogCategory.msoulscat_ES_EWAJS,dr.TraceLevel.Warning,"AutocompleteRichValuePlugin encountered a failure with msg ".concat(e))},e}();Object(wt.d)(new fr);var mr=Object($e.b)((function(){return Object(Le.__awaiter)(void 0,void 0,void 0,(function(){return Object(Le.__generator)(this,(function(e){switch(e.label){case 0:return[4,zt.b.getValue()];case 1:return[4,e.sent().createAndAttachPlugin(wt.a.AutocompleteRichValuePlugin)];case 2:return e.sent(),[4,zt.c.getValue()];case 3:return e.sent(),[2]}}))}))})),hr=function(){function e(){this.factoryName=wt.a.AutocompleteNamedObjectsPlugin}return e.prototype.create=function(){return new vr},e}(),vr=function(){function e(){}return e.prototype.run=function(e){var t,r,n,i,o,s,u,c,l,d,f,p,m,h;return Object(Le.__generator)(this,(function(v){switch(v.label){case 0:return[4,{kind:Dt.a.ParseActiveCell,formulaText:e.content}];case 1:return(t=v.sent()).kind===Dt.a.ParseActiveCell&&Object(E.c)(t.result)?t.result.value.kind!==fe.e.Formula?[2,null]:(r=t.result.value.formula,[4,{kind:Dt.a.GetDefinedNamesInfo}]):(this.logFailure("failed to parse cell content"),[2,null]);case 2:return(n=v.sent()).kind!==Dt.a.GetDefinedNamesInfo?(this.logFailure("failed to get named objects info"),[2,null]):(i=n.definedNamesInfo,o=e.caretPosition,s=new Zt(r,o),Object(K.j)(s,r),u=s.autocompleteString,c=s.stringStartPosition,l=s.stringEndPosition,Object(a.e)(u)&&Object(a.e)(l)&&Object(a.e)(c)?(d=Object(tr.a)(u,i,(function(e){return e.name})),f=d.prefixedSuggestions,p=d.notPrefixedSuggestions,m=this.namesToCompletionItems(f,c,l,!0),h=this.namesToCompletionItems(p,c,l,!1),[2,{items:Object(Le.__spreadArray)(Object(Le.__spreadArray)([],m,!0),h,!0)}]):[2,null])}}))},e.prototype.namesToCompletionItems=function(e,t,r,n){return e.filter((function(e){return-1!==e.type})).map((function(e){return{label:e.name,kind:1===e.type?er.a.NamedRange:er.a.Table,type:er.b.Simple,textEdit:{newText:e.name,range:{start:{line:0,character:t},end:{line:0,character:r}}},detail:e.tooltip,isPrefixed:n}}))},e.prototype.logFailure=function(e){L.y.ULS.traceTag(528562134,L.c.msoulscat_ES_EWAJS,L.i.Warning,"AutocompleteNamedObjectPlugin encountered a failure with msg ".concat(e))},e}();Object(wt.d)(new hr);var gr=Object($e.b)((function(){return Object(Le.__awaiter)(void 0,void 0,void 0,(function(){return Object(Le.__generator)(this,(function(e){switch(e.label){case 0:return[4,zt.a.getValue()];case 1:return[4,e.sent().createAndAttachPlugin(wt.a.AutocompleteNamedObjectsPlugin)];case 2:return e.sent(),[4,zt.c.getValue()];case 3:return e.sent(),[2]}}))}))})),br=function(e){function t(t,r,n){var i=e.call(this)||this;return i.parsedFormulaTree=t,i.caretPosition=r,i.tableNames=n,i.isWithinThisRowOp=!1,i.findContainingNode=function(e){var t=i.parsedFormulaTree.spans[e.label];if(i.isCaretInNode(e))switch(e.kind){case I.j.SpecialRef:case I.j.ColumnRef:case I.j.BadRef:i.isTighterThanCurrent(t)&&(i.containingNode=t);break;case I.j.ThisRowOpRef:var r=e.ref;i.isWithinThisRowOp=!0,Object(a.e)(r)?i.findContainingNode(r):i.isTighterThanCurrent(t)&&(i.containingNode=t);break;case I.j.CommaOpRef:e.refs.map(i.findContainingNode);break;case I.j.RangeOpRef:var n=e;i.findContainingNode(n.lhs),i.findContainingNode(n.rhs);break;case I.j.MissingRef:i.containingNode=void 0}},i.isTighterThanCurrent=function(e){return Object(a.e)(e)&&(Object(a.f)(i.containingNode)||e.end<i.containingNode.end||e.start>i.containingNode.start)},i}return Object(Le.__extends)(t,e),t.prototype.structRefNode=function(t,r,n){return this.isCaretInNode(r)&&(t&&this.tableNames.includes(t.whole)&&(this.tableName=t.whole),void 0===r.innerRef?this.containingNode=this.parsedFormulaTree.spans[r.label]:this.findContainingNode(r.innerRef)),e.prototype.structRefNode.call(this,t,r,n)},t.prototype.isCaretInNode=function(e){var t=this.parsedFormulaTree.spans[e.label];return Object(a.e)(t)&&this.caretPosition<=t.end&&this.caretPosition>t.start},t}(K.e),Sr=function(){function e(){this.factoryName=wt.a.AutocompleteTableHeadersPlugin}return e.prototype.create=function(){return new yr},e}(),yr=function(){function e(){var e=this;this.getCompletionItems=function(t,r,n,i,a,o){var s,u="@"===r.charAt(0);if(u||a){var c=u?n+1:n,l=u?r.substring(1):r;return e.generateHeadersCompletionItems(l,t,c,i)}var d=[];if(""===r){var f=null===(s=o[I.i.ThisRow])||void 0===s?void 0:s.substring(1);d.push(e.generateThisRowOpCompletionItem(n,i,f))}return d.push.apply(d,e.generateSpecialCaseCompletionItems(n,i,r,o)),d.push.apply(d,e.generateHeadersCompletionItems(r,t,n,i)),d}}return e.prototype.run=function(e){var t,r,n,i,o,s,u,c,l,d,f,p,m,h,v,g,b,S;return Object(Le.__generator)(this,(function(y){switch(y.label){case 0:return t=e.content,r=e.caretPosition,Object(a.f)(t)||Object(a.f)(r)?[2,null]:[4,{kind:Dt.a.ParseActiveCell,formulaText:t}];case 1:return(n=y.sent()).kind===Dt.a.ParseActiveCell&&Object(E.c)(n.result)?n.result.value.kind!==fe.e.Formula?[2,null]:(i=n.result.value.formula,[4,{kind:Dt.a.GetDefinedNamesInfo}]):(this.logFailure("failed to parse cell content"),[2,null]);case 2:return(o=y.sent()).kind!==Dt.a.GetDefinedNamesInfo?(this.logFailure("failed to get named objects info"),[2,null]):0===(s=o.definedNamesInfo.filter((function(e){return 0===e.type})).map((function(e){return e.name})).filter(a.e)).length?[2,null]:(u=new br(i,r,s),Object(K.j)(u,i),c=u.tableName,l=u.containingNode,Object(a.f)(l)?[2,null]:Object(a.f)(c)?[4,{kind:Dt.a.GetActiveCell}]:[3,5]);case 3:return(d=y.sent()).kind!==Dt.a.GetActiveCell?(this.logFailure("Couldn't get active cell"),[2,null]):[4,{kind:Dt.a.GetContainingTable,cell:d.activeCell}];case 4:if((f=y.sent()).kind!==Dt.a.GetContainingTable||!Object(E.c)(f.result))return[2,null];if(c=null===(S=f.result.value)||void 0===S?void 0:S.name,Object(a.f)(c))return[2,null];y.label=5;case 5:return p=l.start,m=l.end,"]"===t.charAt(m-1)&&m--,"["===t.charAt(p)&&p++,r!==m?[2,null]:[4,{kind:Dt.a.GetTableHeaders,tableName:c}];case 6:return(h=y.sent()).kind!==Dt.a.GetTableHeaders||!Object(E.c)(h.result)||Object(a.f)(h.result.value)?(this.logFailure("Failed to get header names"),[2,null]):(v=h.result.value,g=t.substring(p,m),[4,{kind:Dt.a.GetConfig}]);case 7:return(b=y.sent()).kind!==Dt.a.GetConfig?(this.logFailure("getConfig request failed"),[2,null]):[2,{items:this.getCompletionItems(v,g,p,m,u.isWithinThisRowOp,b.config.localeInfo.specialRefNames)}]}}))},e.prototype.generateCompletionItems=function(e,t,r,n,i){var a=[];return e.forEach((function(e){var o="string"==typeof e,s=o?e:e.name,u=o?void 0:e.description;a.push({label:s,kind:i,type:er.b.Simple,textEdit:{newText:s,range:{start:{line:0,character:t},end:{line:0,character:r}}},detail:u,isPrefixed:n})})),a},e.prototype.generateHeadersCompletionItems=function(e,t,r,n){var i=Object(tr.a)(e,t),a=i.prefixedSuggestions,o=i.notPrefixedSuggestions;return Object(Le.__spreadArray)(Object(Le.__spreadArray)([],this.generateCompletionItems(a,r,n,!0,er.a.TableHeader),!0),this.generateCompletionItems(o,r,n,!1,er.a.TableHeader),!0)},e.prototype.generateSpecialCaseCompletionItems=function(e,t,r,n){var i=[I.i.All,I.i.Data,I.i.Headers,I.i.Totals].map((function(e){var t;return{name:null!==(t=n[e])&&void 0!==t?t:"",description:Cr.getValue()[e]}})),a=Object(tr.a)(r,i,(function(e){return e.name})),o=a.prefixedSuggestions,s=a.notPrefixedSuggestions;return Object(Le.__spreadArray)(Object(Le.__spreadArray)([],this.generateCompletionItems(o,e,t,!0,er.a.TableSpecialStructRef),!0),this.generateCompletionItems(s,e,t,!1,er.a.TableSpecialStructRef),!0)},e.prototype.generateThisRowOpCompletionItem=function(e,t,r){return{label:"@ - ".concat(r),kind:er.a.TableSpecialStructRef,type:er.b.Simple,textEdit:{newText:"@",range:{start:{line:0,character:e},end:{line:0,character:t}}},detail:FormulaAuthoringStrings.ThisRowOpDescription,shouldRequestAutocompleteOnCommit:!0}},e.prototype.logFailure=function(e){L.y.ULS.traceTag(526508764,L.c.msoulscat_ES_EWAJS,L.i.Warning,"AutocompleteTableHeadersPlugin encountered a failure with msg ".concat(e))},e}();Object(wt.d)(new Sr);var Or=Object($e.b)((function(){return Object(Le.__awaiter)(void 0,void 0,void 0,(function(){return Object(Le.__generator)(this,(function(e){switch(e.label){case 0:return[4,zt.a.getValue()];case 1:return[4,e.sent().createAndAttachPlugin(wt.a.AutocompleteTableHeadersPlugin)];case 2:return e.sent(),[4,zt.c.getValue()];case 3:return e.sent(),[2]}}))}))})),Cr=new $e.a((function(){var e;return(e={})[I.i.All]=FormulaAuthoringStrings.SpecialRefAllDescription,e[I.i.Data]=FormulaAuthoringStrings.SpecialRefDataDescription,e[I.i.Headers]=FormulaAuthoringStrings.SpecialRefHeadersDescription,e[I.i.Totals]=FormulaAuthoringStrings.SpecialRefTotalsDescription,e[I.i.ThisRow]=FormulaAuthoringStrings.ThisRowOpDescription,e})),Pr=r(26),Nr=function(e){function t(t,r){var n=e.call(this)||this;return n.formula=t,n.caretPosition=r,n.location=void 0,n}return Object(Le.__extends)(t,e),t.prototype.appNode=function(t,r,n,i){return t.kind!==I.e.Operator&&this.matchFormula(t,n,i),e.prototype.appNode.call(this,t,r,n,i)},t.prototype.parenNode=function(t,r,n){var i=this.formula.spans[n];return r&&i&&this.matchParentheses(i.start,i.end-1),e.prototype.parenNode.call(this,t,r,n)},t.prototype.letNode=function(t,r,n,i,a,o){return this.matchFormula(t,a,o),e.prototype.letNode.call(this,t,r,n,i,a,o)},t.prototype.lambdaNode=function(t,r,n,i,a,o){return this.matchFormula(t,a,o),e.prototype.lambdaNode.call(this,t,r,n,i,a,o)},t.prototype.matchFormula=function(e,t,r){var n=this.formula.spans[r],i=this.formula.spans[e.label];t&&n&&i&&this.matchParentheses(i.end,n.end-1)},t.prototype.matchParentheses=function(e,t){e<this.caretPosition&&this.caretPosition<=t&&(void 0===this.location||e>this.location.start)&&(this.location={start:e,end:t})},t}(K.e),Rr=function(){function e(){this.factoryName=wt.a.ParenthesesCouplingPlugin}return e.prototype.create=function(){return new kr},e}(),kr=function(){function e(){}return e.prototype.run=function(e){var t,r,n;return Object(Le.__generator)(this,(function(i){switch(i.label){case 0:return null!=e.selectionLength&&e.selectionLength>0?[2,null]:[4,{kind:Dt.a.ParseActiveCell,formulaText:e.content}];case 1:return(t=i.sent()).kind===Dt.a.ParseActiveCell&&Object(E.c)(t.result)&&t.result.value.kind===fe.e.Formula?(r=t.result.value.formula,n=new Nr(r,e.caretPosition),Object(K.j)(n,r),[2,this.buildParenthesesHighlights(n)]):(this.logFailure("failed to parse cell content"),[2,null])}}))},e.prototype.buildParenthesesHighlights=function(e){var t=void 0;if(Object(a.e)(e.location)){var r=e.location.start,n=e.location.end,i={kind:Pr.a.Parentheses,span:{start:r,end:r+1}};t=[{kind:Pr.a.Parentheses,span:{start:n,end:n+1}},i]}return{formulaHighlights:t}},e.prototype.logFailure=function(e){o.h.ULS.traceTag(525133646,Ue.LogCategory.msoulscat_ES_EWAJS,Ue.TraceLevel.Warning,"ParenthesesCouplingPlugin encountered a failure with msg ".concat(e))},e}();Object(wt.d)(new Rr);var Tr=Object($e.b)((function(){return Object(Le.__awaiter)(void 0,void 0,void 0,(function(){return Object(Le.__generator)(this,(function(e){switch(e.label){case 0:return[4,zt.b.getValue()];case 1:return[4,e.sent().createAndAttachSyncPlugin(wt.a.ParenthesesCouplingPlugin)];case 2:return e.sent(),[4,zt.c.getValue()];case 3:return e.sent(),[2]}}))}))})),Er=function(e){function t(){var t=e.call(this)||this;return t.referenceNodes=[],t}return Object(Le.__extends)(t,e),t.prototype.cellRefNode=function(t,r,n){var i=e.prototype.cellRefNode.call(this,t,r,n);return i.kind===I.e.CellRef&&this.referenceNodes.push(i),i},t.prototype.structRefNode=function(t,r,n){var i=e.prototype.structRefNode.call(this,t,r,n);return i.kind===I.e.StructRef&&this.referenceNodes.push(i),i},t}(K.e),_r=r(163),Fr=function(){function e(){this.factoryName=wt.a.ColoredReferencesPlugin}return e.prototype.create=function(){return new Ir},e}(),Ir=function(){function e(){}return e.prototype.run=function(e){var t,r,n,i,a,o,s,u;return Object(Le.__generator)(this,(function(c){switch(c.label){case 0:return[4,{kind:Dt.a.ParseActiveCell,formulaText:e.content}];case 1:return(t=c.sent()).kind===Dt.a.ParseActiveCell&&Object(E.c)(t.result)?t.result.value.kind!==fe.e.Formula?[2,null]:(r=t.result.value.formula,n=new Er,Object(K.j)(n,r),0===n.referenceNodes.length?[2,null]:[4,{kind:Dt.a.GetActiveCell}]):(this.logFailure("failed to parse cell content"),[2,null]);case 2:return(i=c.sent()).kind!==Dt.a.GetActiveCell?(this.logFailure("failed to get active cell"),[2,null]):(a=i.activeCell,o={originGridCell:Object(E.e)(a.range),originSheet:Object(E.e)(a.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!0},[4,{kind:Dt.a.ResolveReferences,nodes:n.referenceNodes,locals:o}]);case 3:return(s=c.sent()).kind!==Dt.a.ResolveReferences?(this.logFailure("failed to resolve node references"),[2,null]):(u=t.result.value.fmla,[2,this.buildColoredReferencesHighlights(s,r,u,a)])}}))},e.prototype.buildColoredReferencesHighlights=function(e,t,r,n){var i=this,a=[];return e.resolverResults.forEach((function(e){var o,s,u=t.spans[e.node.label];if(u){switch(e.kind){case G.e.ResolvedCellRef:if(!Object(E.c)(e.resolution)||void 0===e.resolution.value)return void i.logFailure("failed to resolve CellRef");o=e.resolution.value,s=Pr.a.CellRef,Object(_r.b)(u,r)&&(u=Object(Le.__assign)(Object(Le.__assign)({},u),{end:u.end+1}));break;case G.e.ResolvedStructRef:if(!Object(E.c)(e.resolution)||void 0===e.resolution.value)return void i.logFailure("failed to resolve StructRef");o=e.resolution.value,s=Pr.a.StructRef}if(o.sheet.index===n.sheet.index){var c={kind:s,span:u,range:o.range};a.push(c)}}})),{formulaHighlights:a}},e.prototype.logFailure=function(e){o.h.ULS.traceTag(525133647,Ue.LogCategory.msoulscat_ES_EWAJS,Ue.TraceLevel.Warning,"ColoredReferencesPlugin encountered a failure with msg ".concat(e))},e}();Object(wt.d)(new Fr);var Ar=Object($e.b)((function(){return Object(Le.__awaiter)(void 0,void 0,void 0,(function(){return Object(Le.__generator)(this,(function(e){switch(e.label){case 0:return[4,zt.b.getValue()];case 1:return[4,e.sent().createAndAttachSyncPlugin(wt.a.ColoredReferencesPlugin)];case 2:return e.sent(),[4,zt.c.getValue()];case 3:return e.sent(),[2]}}))}))})),Mr=r(124),wr=Object($e.b)((function(){return Object(Le.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(Le.__generator)(this,(function(t){switch(t.label){case 0:return[4,zt.e.getValue()];case 1:return[4,(e=t.sent()).loadPluginScript("excelOnlineAutocomplete",!1)];case 2:return t.sent(),[2,e]}}))}))})),Dr=Object($e.b)((function(){return Object(Le.__awaiter)(void 0,void 0,void 0,(function(){return Object(Le.__generator)(this,(function(e){switch(e.label){case 0:return[4,wr.getValue()];case 1:return[4,e.sent().createAndAttachPlugin(wt.a.AutocompletePlugin)];case 2:return e.sent(),[4,zt.c.getValue()];case 3:return e.sent(),[2]}}))}))})),jr=Object($e.b)((function(){return Object(Le.__awaiter)(void 0,void 0,void 0,(function(){return Object(Le.__generator)(this,(function(e){switch(e.label){case 0:return e.trys.push([0,3,,4]),[4,wr.getValue()];case 1:return[4,e.sent().createAndAttachPlugin(wt.a.AutocompletePrecisionMeasurements)];case 2:return e.sent(),[3,4];case 3:return e.sent(),[3,4];case 4:return[2]}}))}))})),xr=Object($e.b)((function(){return Object(Le.__awaiter)(void 0,void 0,void 0,(function(){return Object(Le.__generator)(this,(function(e){switch(e.label){case 0:return e.trys.push([0,3,,4]),[4,wr.getValue()];case 1:return[4,e.sent().createAndAttachPlugin(wt.a.AutocompleteAuthoringPrecisionMeasurements)];case 2:return e.sent(),[3,4];case 3:return e.sent(),[3,4];case 4:return[2]}}))}))})),Lr=Object($e.b)((function(){return Object(Le.__awaiter)(void 0,void 0,void 0,(function(){return Object(Le.__generator)(this,(function(e){switch(e.label){case 0:return[4,wr.getValue()];case 1:return[4,e.sent().createAndAttachPlugin(wt.a.AutocompleteGroundTruthMeasurements)];case 2:return e.sent(),[2]}}))}))})),Br=Object($e.b)((function(){return Object(Le.__awaiter)(void 0,void 0,void 0,(function(){return Object(Le.__generator)(this,(function(e){switch(e.label){case 0:return[4,wr.getValue()];case 1:return[4,e.sent().createAndAttachPlugin(wt.a.AutocompleteDataTypesMeasurements)];case 2:return e.sent(),[2]}}))}))})),Ur=Object($e.b)((function(){return Object(Le.__awaiter)(void 0,void 0,void 0,(function(){return Object(Le.__generator)(this,(function(e){switch(e.label){case 0:return[4,wr.getValue()];case 1:return[4,e.sent().createAndAttachPlugin(wt.a.ParserPerformanceMeasurements)];case 2:return e.sent(),[2]}}))}))})),Gr=ne.tokenizeFormulaModule.tokenizeFormula,Kr=ne.token.DelimId,Vr=(ne.token.SepId,ne.token.TokenKind),Wr=ne.token.TokenOperKind,Hr=(ne.token.addOperatorToken,ne.token.appendToken,ne.token.assignSepToken,ne.token.atOperatorToken,ne.token.badErrorOper,ne.token.badNumberOper,ne.token.cellRefA1Token),qr=ne.token.cellRefR1C1Token,zr=(ne.token.colSepToken,ne.token.concatOperatorToken,ne.token.divOperatorToken,ne.token.dotSepToken,ne.token.endToken,ne.token.eqOperatorToken,ne.token.escapeToken,ne.token.geOperatorToken,ne.token.gtOperatorToken,ne.token.identOrBooleanToken,ne.token.identToken),Qr=(ne.token.isBadErrorOper,ne.token.isBadNumberOper,ne.token.isNumberLikeOper,ne.token.leOperatorToken,ne.token.leftBraceToken,ne.token.leftBracketToken,ne.token.leftParenToken,ne.token.leftSQuoteToken,ne.token.listSepToken,ne.token.literalToken),Jr=(ne.token.ltOperatorToken,ne.token.mulOperatorToken,ne.token.neOperatorToken,ne.token.operatorToken,ne.token.percentOperatorToken,ne.token.poundOperatorToken,ne.token.powOperatorToken,ne.token.qualSepToken,ne.token.rangeOperatorToken,ne.token.rightBraceToken,ne.token.rightBracketToken,ne.token.rightParenToken,ne.token.rightSQuoteToken,ne.token.rowSepToken,ne.token.spacesToken,ne.token.specialRefToken,ne.token.subOperatorToken,ne.token.unexpectedToken),Yr=function(){function e(){this.nonLiteralStore=new Map,this.literalStore=new Map}return e.prototype.get=function(e,t,r){var n,i;if(e===Vr.Literal){if(void 0===r)throw new Error("Expected subkind");return null===(n=this.literalStore.get(r))||void 0===n?void 0:n.get(t)}return null===(i=this.nonLiteralStore.get(e))||void 0===i?void 0:i.get(t)},e.prototype.set=function(e,t,r,n){var i,a;if(e===Vr.Literal){if(void 0===n)throw new Error("Expected subkind");(o=null!==(i=this.literalStore.get(n))&&void 0!==i?i:new Map).set(t,r),this.literalStore.set(n,o)}else{var o;(o=null!==(a=this.nonLiteralStore.get(e))&&void 0!==a?a:new Map).set(t,r),this.nonLiteralStore.set(e,o)}},e}();var $r=function(){function e(){this.store=new Yr,this.counter=1}return e.prototype.getAnonymization=function(e,t,r,n){var i=this.store.get(e,r,t);if(void 0!==i)return i;var a=n(this.counter);return this.counter+=1,this.store.set(e,r,a,t),a},e.prototype.anonymizeIdent=function(e,t,r,n){var i=null!=t?t:e.start;if(void 0!==(null==r?void 0:r.localeInfo.getWorksheetFuncId(e.chars))&&function(e){return void 0!==e&&(e.kind===Vr.Left&&e.value===Kr.Paren)}(n))return zr(i,e.chars);var a=this.getAnonymization(e.kind,void 0,e.chars,(function(e){return"ident".concat(e)}));return zr(i,a)},e.prototype.anonymizeA1CellRef=function(e,t){if(e.refStyle!==I.h.A1)throw new Error("Expected RefStyle.A1");var r=null!=t?t:e.start,n=this.getAnonymization(e.kind,void 0,e.chars,(function(e){return"A".concat(e)}));return Hr(r,n,void 0,void 0)},e.prototype.anonymizeR1C1CellRef=function(e,t){if(e.refStyle!==I.h.R1C1)throw new Error("Expected RefStyle.R1C1");var r=null!=t?t:e.start,n=this.getAnonymization(e.kind,void 0,e.chars,(function(e){return"R".concat(e,"C").concat(e)}));return qr(r,n,void 0,void 0)},e.prototype.anonymizeCellRef=function(e,t){return e.refStyle===I.h.A1?this.anonymizeA1CellRef(e,t):this.anonymizeR1C1CellRef(e,t)},e.prototype.anonymizeLiteral=function(e,t){var r=null!=t?t:e.start,n=void 0;switch(e.oper.kind){case Y.b.Number:n=this.getAnonymization(e.kind,e.oper.kind,e.chars,(function(e){return"".concat(e)}));break;case Y.b.String:n=this.getAnonymization(e.kind,e.oper.kind,e.chars,(function(e){return'"s'.concat(e,'"')}));break;case Wr.BadNumber:n=this.getAnonymization(e.kind,e.oper.kind,e.chars,(function(e){return"1e".concat(e,"000")}));break;case Wr.BadError:n=this.getAnonymization(e.kind,e.oper.kind,e.chars,(function(e){for(var t=["a"],r="a".charCodeAt(0),n=e;n>0;){var i=e%10,a=String.fromCharCode(r+i);t.push(a),n=Math.floor(n/10)}var o=t.join("");return"#".concat(o)}));break;case Y.b.Boolean:case Y.b.Error:case Y.b.Missing:n=e.chars;break;default:Object(o.d)("error",e.oper)}var i=e.oper,a=e.hasRight;return Qr(r,n,i,a)},e.prototype.anonymizeToken=function(e,t,r,n){switch(e.kind){case Vr.Ident:return this.anonymizeIdent(e,t,r,n);case Vr.CellRef:return this.anonymizeCellRef(e,t);case Vr.Literal:return this.anonymizeLiteral(e,t);case Vr.Unexpected:return function(e,t){var r=null!=t?t:e.start;return"\t"===e.chars||";"===e.chars?Jr(r,e.chars):Jr(r,"\t")}(e,t);case Vr.End:case Vr.Left:case Vr.Right:case Vr.Sep:case Vr.Operator:case Vr.Spaces:case Vr.SpecialRef:case Vr.Escape:return Object(Le.__assign)(Object(Le.__assign)({},e),{start:t});default:return Object(o.d)("ConsistentAnonymizer.anonymizeToken",e)}},e.prototype.anonymize=function(e,t,r){for(var n=Gr(t.localeInfo,t.mathpack,t.refStyle,r,e,0),i=[],a=0,o=0;o<n.length;o+=1){var s=n[o],u=o+1<n.length?n[o+1]:void 0,c=this.anonymizeToken(s,a,t,u);a+=c.chars.length,i.push(c)}return i.map((function(e){return e.chars})).join("")},e}();function Zr(e){for(var t=0,r=function(e){var t=JSON.stringify(e),r=0,n=[];for(;t.length>0;){var i=an(t,r,e.i),a=i[0],o=i[1];t=o,r+=1,n.push(a)}return n}(e);t<r.length;t++){var n=nn(r[t]);L.y.ULS.dnmTraceTag(537962336,L.c.msoulscat_ES_EWAJS,L.i.Info,n)}}function Xr(e){L.y.ULS.traceTag(537962337,L.c.msoulscat_ES_EWAJS,L.i.Verbose,e)}var en,tn=function(){function e(){this.factoryName=wt.a.FormulaCollectionPlugin}return e.prototype.create=function(){return new rn},e}(),rn=function(){function e(){this.lastEdit=void 0,this.consistentAnonymizer=new $r,this.sheetIdAnonymization=new Map}return e.prototype.getEditEntry=function(e,t){var r={content:e,cell:t};if(void 0===this.lastEdit||!Object(x.M)(this.lastEdit.cell,t)||this.lastEdit.content!==e)return this.lastEdit=r,r},e.prototype.anonymizeSheetId=function(e){if(this.sheetIdAnonymization.has(e))return this.sheetIdAnonymization.get(e);var t=Object(Ue.getNewGuid)()[0];return this.sheetIdAnonymization.set(e,t),t},e.prototype.run=function(t){var r,n,i,a,o,s,u,c,l,d,f,p,m,h,v,g,b,S;return Object(Le.__generator)(this,(function(y){switch(y.label){case 0:return[4,{kind:Dt.a.GetActiveCell}];case 1:return(r=y.sent()).kind!==Dt.a.GetActiveCell?(Xr(en.GetActiveCell),[2,null]):(n=r.activeCell,null==t.content?(Xr(en.EmptyContent),[2,null]):t.content.trimLeft().startsWith("=")?void 0===(i=this.getEditEntry(t.content,n))?[2,null]:[4,{kind:Dt.a.GetConfig}]:[2,null]);case 2:return(a=y.sent()).kind!==Dt.a.GetConfig?(Xr(en.GetConfig),[2,null]):(o=a.config,s=Object(ue.c)(o),u=Object(_.h)(i.cell),c=Object(ue.a)(u.kind,u.range),l=Object(ce.a)(s),d=this.consistentAnonymizer.anonymize(i.content,o,n.range),[4,{kind:Dt.a.ParseEdit,cell:i.cell,formulaBarText:d}]);case 3:return(f=y.sent()).kind===Dt.a.ParseEdit&&Object(E.c)(f.result)?f.result.value.kind!==fe.e.Formula?[2,null]:(p=f.result.value.formula,m=p.isWellFormed,h=void 0,m||(v=l.checkFormulaWithDiagnostics(c,p),Object(E.c)(v)&&void 0!==(g=null==v?void 0:v.value[1])&&(h=function(e,t){var r={},n={};return Object.keys(e).forEach((function(i){var a=Number(i),o=e[a];void 0!==o&&(r[i]=o);var s=t.spans[a];void 0!==s&&(n[i]=s)})),{spanDiagnostics:r,spans:n}}(g,p))),[4,{kind:Dt.a.GetCorrelationId}]):(Xr(en.ParseEdit),[2,null]);case 4:return"GetCorrelationId"!==(b=y.sent()).kind||(S=b.correlationId,Zr({v:e.formulaCollectionVersion,f:d,ok:m,d:h,c:{s:this.anonymizeSheetId(i.cell.sheet.index),c:i.cell.range.col,r:i.cell.range.row},i:S})),[2,null]}}))},e.factoryName=wt.a.FormulaCollectionPlugin,e.formulaCollectionVersion=1,e}();function nn(e){return e.correlationId.toString()+","+e.logPartId.toString()+","+e.partialMessage}function an(e,t,r){var n=2300-(r.toString().length+t.toString().length+2);return[{correlationId:r,logPartId:t,partialMessage:e.slice(0,n)},e.slice(n)]}!function(e){e.GetActiveCell="GetActiveCell failed",e.GetConfig="GetConfig failed",e.ParseEdit="ParseEdit failed",e.EmptyContent="empty content"}(en||(en={})),Object(wt.d)(new tn);var on,sn=Object($e.b)((function(){return Object(Le.__awaiter)(void 0,void 0,void 0,(function(){return Object(Le.__generator)(this,(function(e){switch(e.label){case 0:return[4,zt.e.getValue()];case 1:return[4,e.sent().createAndAttachPlugin(wt.a.FormulaCollectionPlugin)];case 2:return e.sent(),[4,zt.c.getValue()];case 3:return e.sent(),[2]}}))}))})),un=((on={})[wt.a.ArgumentAssistancePlugin]=[$t,"Microsoft.Office.ExcelOnline.ArgumentAssistancePlugin"],on[wt.a.AutocompletePlugin]=[Dr,"Microsoft.Office.Excel.SmartFormulaBarAutocompleteIsEnabled"],on[wt.a.AutocompletePrecisionMeasurements]=[jr,"Microsoft.Office.Excel.x10AutocompletionPrecisionMeasurementsIsEnabled"],on[wt.a.AutocompleteGroundTruthMeasurements]=[Lr,"Microsoft.Office.Excel.x10AutocompleteGroundTruthMeasurementsIsEnabled"],on[wt.a.AutocompleteDataTypesMeasurements]=[Br,"Microsoft.Office.Excel.x10AutocompleteDataTypesMeasurements","OfficeVSO:5818445_AttachDataTypesExperiment"],on[wt.a.AutocompleteFunctionPlugin]=[ir,"Microsoft.Office.Excel.FormulaAssistanceRedesign"],on[wt.a.ParenthesesCouplingPlugin]=[Tr,"Microsoft.Office.Excel.ParenthesesCoupling"],on[wt.a.ColoredReferencesPlugin]=[Ar,"Microsoft.Office.Excel.ColoredReferences"],on[wt.a.AutocompleteLetPlugin]=[ur,"Microsoft.Office.Excel.FormulaAssistanceRedesign"],on[wt.a.AutocompleteRichValuePlugin]=[mr,"Microsoft.Office.Excel.FormulaAssistanceRedesign"],on[wt.a.FormulaCollectionPlugin]=[sn,"Microsoft.Office.Excel.FormulaCollection"],on[wt.a.AutocompleteNamedObjectsPlugin]=[gr,"Microsoft.Office.Excel.FormulaAssistanceRedesign"],on[wt.a.ParserPerformanceMeasurements]=[Ur,"Microsoft.Office.Excel.x10ParserPerformanceMeasurements"],on[wt.a.AutocompleteTableHeadersPlugin]=[Or,"Microsoft.Office.Excel.FormulaAssistanceRedesign"],on[wt.a.AutocompleteAuthoringPrecisionMeasurements]=[xr,"Microsoft.Office.Excel.x10AutocompletionAuthoringPrecisionMeasurementsIsEnabled"],on);function cn(e,t){return Object(Le.__awaiter)(this,void 0,void 0,(function(){var r,n,i,a;return Object(Le.__generator)(this,(function(o){switch(o.label){case 0:return zt.d.resolve(t),void 0===(r=un[e])?[2,!1]:(n=r[0],i=r[1],a=r[2],void 0!==i&&!Object(T.b)(i)||void 0!==a&&!Object(T.d)(a)?[3,2]:[4,n.getValue()]);case 1:return o.sent(),[2,!0];case 2:return[2,!1]}}))}))}function ln(e){return Object(Le.__awaiter)(this,void 0,void 0,(function(){var t,r,n,i;return Object(Le.__generator)(this,(function(a){switch(a.label){case 0:t=!1,r=0,o=un,n=Object.keys(o).map((function(e){return parseInt(e,10)})),a.label=1;case 1:return r<n.length?[4,cn(n[r],e)]:[3,4];case 2:i=a.sent(),t=t||i,a.label=3;case 3:return r++,[3,1];case 4:return[2,t]}var o}))}))}var dn,fn,pn=r(139);(fn=dn||(dn={})).defaultPluginResponseWindows=yt.a,fn.SchedulerVersion=Ot.a,fn.getSchedulerFactories=Ve.f,fn.PluginSchedulerSingleton=Ve.c,fn.FormulaKind=Rt.a,fn.SchedulerVersionCompatibility=Dt.d,fn.RecalcSideGrid=pn.a,fn.createMockAsyncGrid=Et,fn.createMockGridProvider=_t,fn.createMockGridExporter=Ft,fn.setMockGridSheetAndNotify=It,fn.MockTimerImmediate=Mt,fn.PluginFactoryName=wt.a,fn.registerPluginFactory=wt.d,fn.createDynamicPluginLoader=Ve.d,fn.DynamicPluginLoader=Ve.a,fn.devDynamicPluginLoaderInsideInit=Ve.e,fn.stableDynamicPluginLoaderInsideInit=Ve.g,fn.PluginRequestKind=Dt.a,fn.typedRequest=Dt.o,fn.awaitPromise=Dt.e,fn.wrapIntoAsync=Pt,fn.yieldStarAsyncGenerator=Dt.p,fn.delay=Dt.f,fn.delayRequest=Dt.g,fn.getSheetNamesRequest=Dt.j,fn.getRangeRequest=Dt.i,fn.getCellRequest=Dt.h,fn.parseCellFormulaRequest=Dt.n,fn.RequestKind=Dt.b,fn.NotificationKind=We.a,fn.PluginSchedulerResultKind=Pr.d,fn.createGlobalsGenerator=xt,fn.ArgumentAssistancePluginFactory=Jt,fn.AutocompleteFunctionPluginFactory=rr,fn.AutocompleteLetPluginFactory=or,fn.AutocompleteRichValuePluginFactory=fr,fn.AutocompleteNamedObjectsPluginFactory=hr,fn.AutocompleteTableHeadersPluginFactory=Sr,fn.ParenthesesCouplingPluginFactory=Rr,fn.ColoredReferencesPluginFactory=Fr,fn.spanToLSPRange=Mr.b,fn.ensurePluginAttached=cn,fn.ensureAllPluginsAttached=ln,fn.defaultTimerInterface=Qt.b,Object(T.b)("Microsoft.Office.Excel.ProseFormulaRepairExperimentIsEnabled")&&r(398);var mn=new Ve.c;r.d(t,"packageVersion",(function(){return"36.4.6"})),r.d(t,"PluginSchedulerSingletonGlobal",(function(){return mn})),r.d(t,"common",(function(){return n})),r.d(t,"location",(function(){return d})),r.d(t,"formula",(function(){return h})),r.d(t,"value",(function(){return p})),r.d(t,"signature",(function(){return g})),r.d(t,"util",(function(){return S})),r.d(t,"config",(function(){return O})),r.d(t,"math",(function(){return P})),r.d(t,"date",(function(){return R})),r.d(t,"parse",(function(){return X})),r.d(t,"analyze",(function(){return oe})),r.d(t,"numfmt",(function(){return le})),r.d(t,"runtime",(function(){return Ce})),r.d(t,"calc",(function(){return ze})),r.d(t,"funcs",(function(){return dt})),r.d(t,"style",(function(){return pt})),r.d(t,"worker",(function(){return ht})),r.d(t,"x10",(function(){return dn})),r.d(t,"getTypedFeatureGate",(function(){return T.b})),r.d(t,"isTypedChangeGateEnabled",(function(){return T.d}))},function(e,t,r){"use strict";r.r(t);var n,i=r(2),a=r(5),o=r(23),s=r(12),u=r(0),c=r(283),l=r(36),d=r(17),f=r(9),p=r(124),m=function(){function e(){this.factoryName=o.a.FormulaRepairPlugin}return e.prototype.create=function(){return new h},e}(),h=function(){function e(){}return e.prototype.run=function(e){var t,r,o,s,f,m,h;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return t={maxNumberOfRepairs:5,maxLocalEditDistance:5,maxGlobalEditDistance:5},[4,{kind:a.a.GetActiveCell}];case 1:return(r=i.sent()).kind!==a.a.GetActiveCell?(this.logFailure(n.GetActiveCell),[2,null]):[4,{kind:a.a.ParseEdit,cell:r.activeCell,formulaBarText:e.content}];case 2:return(o=i.sent()).kind===a.a.ParseEdit&&Object(u.c)(o.result)?o.result.value.kind!==d.e.Formula?(this.logFailure(n.NotFormula),[2,null]):o.result.value.formula.isWellFormed?(this.logFailure(n.FormulaWellFormed),[2,null]):(s=function(e,t){var r;return Object(c.format)({protocol:"http",hostname:"localhost",port:8080,pathname:"/",query:(r={},r.formula=e,r.k=t.maxNumberOfRepairs,r.max_local_edit_distance=t.maxLocalEditDistance,r.max_global_edit_distance=t.maxGlobalEditDistance,r)})}(e.content,t),f=this.getRepairsFromServer(s),[4,{kind:a.a.AwaitPromise,promise:f}]):(this.logFailure(n.ParseEdit),[2,null]);case 3:return(m=i.sent()).kind!==a.a.AwaitPromise?(this.logFailure(n.AwaitPromise),[2,null]):0===(h=m.result).length?[2,null]:[2,{items:h.map((function(e){return e.repair})).map((function(t){return{label:t,kind:l.a.Function,textEdit:{newText:t,range:Object(p.b)(e.content,0,e.content.length)}}}))}]}}))},e.prototype.logFailure=function(e){s.y.ULS.traceTag(545653663,s.c.msoulscat_ES_EWAJS,s.i.Warning,"FormulaRepairPlugin failed: ".concat(e))},e.prototype.getRepairsFromServer=function(e){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t,r;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return[4,fetch(e)];case 1:return 200!==(t=i.sent()).status?(this.logFailure(n.GetStatusCode),[2,[]]):(r=t.headers.get("content-type"),Object(f.g)("contentType is not null",null!=r),/^application\/json/.test(r)?[2,t.json()]:(this.logFailure(n.GetContentType),[2,[]]))}}))}))},e}();!function(e){e.GetActiveCell="GetActiveCell failed",e.ParseEdit="ParseEdit failed",e.NotFormula="Not a formula, can't repair",e.FormulaWellFormed="Formula is well formed, no repairs",e.AwaitPromise="Not our promise",e.GetStatusCode="Not 200",e.GetContentType="Not application/json content",e.JsonParse="Failed json parse"}(n||(n={}));var v=r(49);Object(o.d)(new m),v.c.instance().createAndAttachPlugin(new m)}]);
//# sourceMappingURL=excelOnlineCalc.min.js.map