(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[33],{1455:function(z,F,b){function a(Ob){var Ac=hd.call(this)||this;Ac.Cn=null;Ac.ly=null;Ac.eQa=function(){Ac.Cn.vJb(Ac.eQa);Aa.ULS.sendTraceTag(537162849,0,50,"ExcelLiveManager::OnRealTimeChannelInitialized");Ac.Eb(Ac.$.da.Aa(473)||new n(Ac.$,Ac.Cn,Ac.ly))};Ac.$=Ob;Ac.Xb();return Ac}function c(Ob){var Ac=sc.call(this)||this;Ac.iw=null;Ac.kKa=null;Ac.jKa=null;Ac.XBb=!1;Ac.zNa=null;Ac.rmc="ExcelLiveController::";Ac.$=Ob;Ac.XBb=
Cb.g(Ac.$);Ac.ffi();return Ac}function e(Ob,Ac){Ac=void 0===Ac?null:Ac;this.container=null;this.Yn=0;this.YQa=null;this.eh=!1;Ac&&(this.$=Ob,this.initialize(Ac),this.eh=$b.AFrameworkApplication.sa.Qa.eh)}function l(Ob,Ac){var sb=this;Ac=void 0===Ac?null:Ac;this.Cpa=null;this.OZd=this.YXe=!0;this.container=null;this.Yn=0;this.YQa=this.sAa=null;this.lastUpdateTime=0;this.$=null;this.b$h=function(){sb.OZd||(sb.tVf(),sb.OZd=!0,sb.container.classList.remove("ewa-excelLive-meetingPill-container-hidden"))};
Ac&&this.initialize(Ob,Ac);this.$=Ob}function m(Ob){this.Ghe=this.Fhe=this.Ehe=null;this.Zge=void 0;this.$=Ob}function n(Ob,Ac,sb){this.ara=this.Qjb=this.zmb=this.fkb=null;this.$=Ob;this.qie=Ac;this.mr=new h(this.$);this.Wga=Object(pa.a)(328,this.Cn.Lj);this.ara=sb;this.Sdi()}function h(Ob){this.Fne=this.r$d=this.q$d=this.jne=this.y9d=this.z9d=this.mke=0;this.A9d=!1;this.Jfe=this.Ife=0;this.Cde=void 0;this.J7d=this.bke=this.Ele=0;this.$=Ob}function u(Ob,Ac,sb,ad){this.controller=this.p0=null;this.QHi=
1E4;this.$=Ob;this.gridView=jb.g(this.$);this.mr=ad;this.realtimeChannel=Ac;this.controller=sb;this.Aqb();this.Muj();this.BKj()}function w(Ob,Ac,sb){this.rmc="ExcelLiveParticipantV0";this.viewBlockContainerHelpers=this.qQb=this.r7=null;this.xrd=this.TNa=!1;this.T3a=0;this.tWe=10;this.uWe=500;this.vWe=3E4;this.ima=0;this.ly=sb;this.realtimeChannel=Ac;this.$=Ob;this.gridView=jb.g(Ob);this.mfc=this.mfc.bind(this);this.kna=this.kna.bind(this);this.tWe=this.$.ya.FetchPresenterNavigationStateMaxRetries;
this.uWe=this.$.ya.FetchPresenterNavigationStateRetryBaseInMs;this.vWe=this.$.ya.FetchPresenterNavigationStateRetryMaxDelayInMs;this.initialize()}function r(Ob,Ac,sb,ad){this.statusBarManager=null;this.Zaa=new B;this.yvd=this.SHb=null;this.hba=this.THb=0;this.pWe=10;this.qWe=500;this.rWe=3E4;this.q2d=.98;this.Jxa=this.p7a=this.nic=this.wAb=this.grd=this.xAb=this.dOa=this.wrd=!1;this.Yvd=null;this.Uxa=this.Csd=!1;this.controller=sb;this.realtimeChannel=Ac;this.$=Ob;this.gridView=jb.g(Ob);this.mr=ad;
this.statusBarManager=new y(this.$,this.Zaa);this.q2d=this.$.ya.ExcelLiveViewportRoundOffFactor;this.pWe=this.$.ya.FetchPresenterNavigationStateMaxRetries;this.qWe=this.$.ya.FetchPresenterNavigationStateRetryBaseInMs;this.rWe=this.$.ya.FetchPresenterNavigationStateRetryMaxDelayInMs;this.Uxa=Tb.EwaSettings.isChangeGateEnabled("OfficeVSO:6175128_ExcelLiveExploreTransitionsFix");this.Aqb();this.eQg();this.BBc()}function B(){return T.call(this)||this}function y(Ob,Ac){var sb=Wc.call(this)||this;sb.statusBarManager=
null;sb.o7b=2;sb.Ksc=null;sb.HIf=function(ad,Hd){sb.o7b=Hd.o7b;sb.Ksc=Hd.Ksc;sb.Xz()};sb.$=Ob;sb.$.da.Ya(29,function(ad){sb.statusBarManager=ad;ad.WJ(sb)});sb.Zaa=Ac;sb.Zaa.CLg(sb.HIf);return sb}function v(Ob,Ac){var sb=Ub.call(this)||this;sb.o7b=Ob;sb.Ksc=Ac;return sb}function A(Ob,Ac){Ob=document.getElementById(Ob.Lb+Hc.a.z2a);return{uQb:Ob.clientWidth/Ac,rQb:Ob.clientHeight/Ac}}function t(Ob){return yb.call(this,Ob)||this}function E(Ob,Ac){this.$=Ob;this.excelLiveManager=Ac}function C(){this.tb=
null}function H(Ob){this.Lzg=Ob}function U(Ob){this.rug=Ob}function Q(){}function O(){}function ea(){}function Z(){}function S(Ob,Ac,sb,ad){ad=void 0===ad?null:ad;this.gm=new nb.a;this.rxg=Ob;this.iwg=Ac;this.vb=sb;this.nkb=ad}function I(){}function P(){}function J(){}function aa(Ob,Ac){this.La=Ob;this.fYa=Ac}function ia(){this.yx=this.Cm=!1}function ba(Ob,Ac,sb,ad,Hd,Ne,Ud,Ge,Sc){var Pc=this;this.Cm=!1;this.TXb=this.FYa=this.pQ=this.aha=null;this.Dnb=ba.AGc;this.$a=new Gb.a;this.Bsa=new ra(0);this.Bsa.jYc(Object(Fa.a)(this,
this.ZXi,"onStateMachineChanged"));this.pzg=Ob;this.CXb=Ac;this.ozg=sb;this.HSc=ad;this.re=Hd;this.rU=Ne;Ud.execute(function(Zd){Pc.Cm||(Pc.FYa=Zd,Pc.FYa.i_a(Object(Fa.a)(Pc,Pc.oda,"onUpdateNotificationReceived")),Pc.start())});Ge.execute(function(Zd){Pc.Cm||(Pc.TXb=Zd,Zd.f0b(Object(Fa.a)(Pc,Pc.iIf,"onTokenRefreshed")))});this.ime=Sc}function ra(Ob){this.$a=new Gb.a;this.jle=new Date;this.kjb=Ob;this.wKc=0}function ka(Ob,Ac,sb,ad,Hd){var Ne=xa.call(this)||this;Ne.qId=Ob;Ne.newState=Ac;Ne.c6i=sb;Ne.d6i=
ad;Ne.M5j=Hd;return Ne}function da(Ob,Ac){var sb=ab.call(this)||this;sb.o5j=Ob;sb.i5j=Ac;return sb}b.r(F);var ha=b(556),qa=b(0),Aa=b(13),Fa=b(82),ab=Sys.EventArgs;Am(da,ab);Object(qa.a)(da,"RtcHostNotificationEventArgs",Sys.EventArgs,[]);var Ua;(function(Ob){Ob[Ob.notYetStarted=0]="notYetStarted";Ob[Ob.polling=1]="polling";Ob[Ob.subscribed=2]="subscribed";Ob[Ob.blocked=3]="blocked";Ob[Ob.permanentlyStopped=4]="permanentlyStopped"})(Ua||(Ua={}));Object(qa.b)("RtcHostNotificationSubscriptionState",
Ua);var bb=b(107),xa=Sys.EventArgs;Am(ka,xa);Object(qa.a)(ka,"StateChangedEventArgs",Sys.EventArgs,[]);var Gb=b(96);ra.prototype.event=function(Ob,Ac){this.currentState!==Ob&&(this.EHh(this.currentState,Ob,this.fQe,void 0===Ac?null:Ac),this.wKc=0,this.jle=new Date);this.kjb=Ob;this.wKc=this.fQe+1};ra.prototype.EHh=function(Ob,Ac,sb,ad){Ob=new ka(Ob,Ac,sb,this.jle,ad);this.$a.raiseEvent("c",Ob)};ra.prototype.jYc=function(Ob){this.$a.addHandler("c",Ob)};ra.prototype.cVf=function(Ob){this.$a.removeHandler("c",
Ob)};uk.Object.defineProperties(ra.prototype,{currentState:{configurable:!0,enumerable:!0,get:function(){return this.kjb}},fQe:{configurable:!0,enumerable:!0,get:function(){return this.wKc}}});Object(qa.a)(ra,"StateMachine",null,[287]);ba.prototype.start=function(){0!==this.sfb?Aa.ULS.sendTraceTag(573100178,502,15,"HostNotifications: Tried starting poll when in state {0}",Ua[this.sfb]):(this.Bsa.event(1),this.WQd(null))};ba.prototype.WQd=function(){this.aha=null;if(this.Zkf){Aa.ULS.sendTraceTag(573100181,
502,50,"HostNotifications: Send event when connected.  Current state: {0}",Ua[this.sfb]);var Ob=null;this.HSc&&this.HSc.length&&(Ob={},Ob.etts=this.HSc);this.FYa.zea(14,Ob,!0);this.t_f(this.pzg)}else this.Bsa.event(3)};ba.prototype.t_f=function(Ob){this.aha=bb.a.w6b(1E3*Ob,Object(Fa.a)(this,this.WQd,"sendSubscribeEvent"),this.CXb,192,"RtcHostNotificationSubscribe");this.re.$g(this.aha)};ba.prototype.eqj=function(Ob){Ob=1E3*(Ob+this.ozg);var Ac=this.ime().getTime()+Ob;this.Dnb=new Date(Ac);Ob-=this.CXb;
this.pQ?this.re.doa(this.pQ,Ob):(this.pQ=bb.a.w6b(Ob,Object(Fa.a)(this,this.jRj,"transitionToPollingEvent"),this.CXb/2,194,"RtcHostNotificationTransitionToPolling"),this.re.$g(this.pQ))};ba.prototype.jRj=function(){this.pQ=null;2===this.sfb&&(this.Bsa.event(1),Aa.ULS.shipAssertTag(573100185,502,!!this.aha,"Missing task to ensure that we re-subscribe."))};ba.prototype.iIf=function(){this.E7h()};ba.prototype.E7h=function(){3===this.sfb&&this.Zkf&&(this.Bsa.event(this.p6?2:1),this.WQd(null))};ba.prototype.oda=
function(Ob,Ac){if(13===Ac.type&&(Ob=Ac.S8,Ac={},Aa.ULS.sendTraceTag(573100183,502,50,"HostNotifications: Subscription status: {0}",(Ac.SerializableHostNotificationSubscription=Ob,Ac.DurationBeforeExpirationToResubscribeInSec=this.CXb,Ac)),Ac=Ob.cts,!this.eTj(Ac))){if(Ob.sb){var sb=2;this.eqj(Ob.cts)}else sb=1,this.Dnb=ba.AGc,this.pQ&&(this.re.kq(this.pQ),this.pQ=null);this.Bsa.event(sb);this.aha?this.re.doa(this.aha,1E3*Ac):this.t_f(Ac)}};ba.prototype.eTj=function(Ob){if(!isNaN(Ob)&&isFinite(Ob)&&
0<Ob)return!1;this.Q$f(!1);return!0};ba.prototype.Q$f=function(Ob){this.aha&&(this.re.kq(this.aha),this.aha=null);this.pQ&&(this.re.kq(this.pQ),this.pQ=null);this.FYa&&(this.FYa.zJb(Object(Fa.a)(this,this.oda,"onUpdateNotificationReceived")),this.FYa=null);this.TXb&&(this.TXb.GMd(Object(Fa.a)(this,this.iIf,"onTokenRefreshed")),this.TXb=null);Ob||this.Bsa.event(4)};ba.prototype.ZXi=function(Ob,Ac){Ob=Ac.newState;var sb=Ac.qId,ad={};ad.NewState=Ua[Ob];ad.PreviousState=Ua[sb];ad.PreviousStateHits=Ac.c6i;
ad.PreviousStateTransitionTime=Ac.d6i.toISOString();ad.IsSubscribed=this.p6;this.Dnb!==ba.AGc&&(ad.SubscriptionExpiringTime=this.Dnb.toISOString());Aa.ULS.sendTraceTag(572346515,502,4===Ob?15:50,"HostNotificationChanged: {0}",ad);this.$a.raiseEvent("HN",new da(sb,Ob))};ba.prototype.dispose=function(){this.Cm||(this.Cm=!0,this.Q$f(!0),this.pQ&&(this.re.kq(this.pQ),this.pQ=null))};uk.Object.defineProperties(ba.prototype,{sfb:{configurable:!0,enumerable:!0,get:function(){return this.Bsa.currentState}},
Zkf:{configurable:!0,enumerable:!0,get:function(){return!this.rU||this.rU.nmf}},p6:{configurable:!0,enumerable:!0,get:function(){return 2===this.sfb&&this.ime()<this.Dnb}}});ba.AGc=new Date(0);Object(qa.a)(ba,"RtcHostNotificationSubscriptionManager",null,[846,3]);var $b=b(4),oa=b(254),Ma=b(738),Za=b(84);ia.prototype.hi=function(Ob){var Ac=this;Ob.register(ba,"Common.App.RtcHostNotificationSubscription.RtcHostNotificationSubscriptionManager").as("Common.App.RtcHostNotificationSubscription.IRtcHostNotificationSubscriptionManager").Ic().Nc(function(){var sb=
$b.AFrameworkApplication.ha;return new ba(sb.Cd("RtcHostNotificationRetryIntervalIdeallyInSeconds",1800),sb.Cd("RtcHostNotificationRetryIntervalBufferInSeconds",120),sb.Cd("RtcHostNotificationSubscriptionLostBufferInSeconds",60),Ac.C1h(sb),$b.AFrameworkApplication.Yi,Ma.SessionStatusManager.instance,Ob.qc("Common.IRealtimeChannelBasic"),Ob.qc("Common.ISessionExpirationManager"),function(){return new Date})})};ia.prototype.init=function(){var Ob=this;$b.AFrameworkApplication.ha.tv(function(){!Ob.Cm&&
$b.AFrameworkApplication.ha.ra("RtcHostNotificationEnabled")&&(Ob.yx=!0,Za.a.instance.resolve("Common.App.RtcHostNotificationSubscription.IRtcHostNotificationSubscriptionManager"))})};ia.prototype.dispose=function(){this.Cm||(this.Cm=!0,this.yx&&Za.a.instance.resolve("Common.App.RtcHostNotificationSubscription.RtcHostNotificationSubscriptionManager").dispose())};ia.prototype.C1h=function(Ob){return Ob.wz("RtcEventTypesToSubscribe")?Ob.Jw("RtcEventTypesToSubscribe"):null};ia.main=function(){oa.a.instance.nj(new ia)};
uk.Object.defineProperties(ia.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"RtcHostNotificationSubscription"}}});Object(qa.a)(ia,"RtcHostNotificationSubscriptionPackage",null,[4,5]);var gb=b(105),zb=b(26);aa.prototype.Sg=function(){this.La.ic(zb.a.Tof,gb.a.frame,Object(Fa.a)(this,this.Uof,"livePersonaCardActionHandler"))};aa.prototype.qPb=function(){this.La.RD(zb.a.Tof,gb.a.frame,Object(Fa.a)(this,this.Uof,"livePersonaCardActionHandler"))};aa.prototype.Uof=function(Ob,Ac,sb,
ad,Hd){if(!Hd||3===sb)return 2;if(1===sb)return this.GZa(this.fYa.dAe(Hd.upn||Hd.aadObjectId));if(!this.hqh(Hd))return 8;switch(Hd.action){case 0:return this.GZa(this.fYa.yEg(Hd));case 1:return this.GZa(this.fYa.xEg(Hd));case 2:return this.GZa(this.fYa.zEg(Hd));case 3:return this.GZa(this.fYa.openCard(Hd));case 4:return this.GZa(this.fYa.vej(Hd));default:return 2}};aa.prototype.hqh=function(Ob){var Ac=Ob.upn||Ob.aadObjectId;return Ob.targetElement&&(4===Ob.action||Ac&&""!==Ac)?!0:!1};aa.prototype.GZa=
function(Ob){return Ob?32:8};Object(qa.a)(aa,"LivePersonaCardActor",null,[]);var nb=b(161),pa=b(81);Object(qa.a)(J,"BootstrapperConfig",null,[]);Object(qa.a)(P,"LivePersonaCardInitializerResult",null,[]);I.Qxe=null;Object(qa.a)(I,"LivePersonaCardModule",null,[]);var Ja=b(618);S.prototype.init=function(){this.Rif()?this.rxg.Xxi().continueWith(Object(Fa.a)(this,this.VUi,"onPackageLoaded")):this.gm.setResult(Object.assign(new P,{isInitialized:!1,isEnabled:!1,failureMessage:"LivePersonaCard is not enabled."}));
return this.gm.task};S.prototype.VUi=function(){var Ob=this,Ac=I.Qxe;if(Ac){var sb=this.qPh();try{Ac.initializeLivePersonaCardAsync(sb).then(function(){Ob.gm.setResult(Object.assign(new P,{isInitialized:!0,isEnabled:!0}))}).catch(function(ad){var Hd=Object(pa.a)(String,ad);Hd?Ob.gm.setException(Error.create(Hd)):Ob.gm.setException(Error.create(JSON.stringify(ad)))})}catch(ad){this.gm.setException(ad)}}else this.gm.setResult(Object.assign(new P,{isInitialized:!1,isEnabled:!0,failureMessage:"LivePersonaCardBootstrapper package is not loaded."}))};
S.prototype.qPh=function(){var Ob=Ja.a.DK($b.AFrameworkApplication.lcid);return Object.assign(new J,{culture:Ob?Ob.name.toLocaleLowerCase():"en-us",clientType:this.vb.Wa("LivePersonaCardClientType"),clientContextType:"Generic",clientCorrelationId:$b.AFrameworkApplication.userSessionId,complianceEnvironment:this.pRh(),logMessage:Object(Fa.a)(this,this.logMessage,"logMessage"),getAuthToken:Object(Fa.a)(this,this.getAuthToken,"getAuthToken")})};S.prototype.Rif=function(){if(!this.vb.ra("LivePersonaCardIsEnabled")||
!this.CNg())return!1;var Ob=this.vb.Wa("SovereignEnvironmentName");return Ob&&""!==Ob?Ob.toLocaleLowerCase()==="USGov".toLocaleLowerCase()||Ob.toLocaleLowerCase()==="Blackforest".toLocaleLowerCase()?!0:!1:!0};S.prototype.CNg=function(){return this.vb.ra("CoauthorGalleryLivePersonaCardIsEnabled")||!!$b.AFrameworkApplication.sa&&$b.AFrameworkApplication.sa.Qa.rTa};S.prototype.pRh=function(){return this.vb.Wa("LivePersonaCardComplianceEnvironment")};S.prototype.logMessage=function(Ob,Ac,sb){var ad={};
Ob=JSON.stringify((ad["Log Type"]=Ob,ad["Log Result Type"]=Ac,ad.Message=sb,ad));Aa.ULS.sendTraceTag(50431106,3006,50,Ob)};S.prototype.getAuthToken=function(Ob,Ac){var sb=this;$b.AFrameworkApplication.ha.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.LokiFutureObject")?this.nkb.continueWith(function(ad){ad.Ph||ad.og?Ac("LokiTokenManagerTask is either canceled or faulted.",$b.AFrameworkApplication.userSessionId):sb.nkb.result.Did().then(function(Hd){Hd.isSuccess&&Hd.token&&Hd.token.length?
Ob(Hd.token,$b.AFrameworkApplication.userSessionId):Ac(Hd.errorMessage,$b.AFrameworkApplication.userSessionId)}).catch(function(Hd){return Aa.ULS.sendTraceTag(539617039,3006,10,"Unexpected exception received from GetLokiToken: {0}",JSON.stringify(Hd))})}):this.iwg.Did().then(function(ad){ad.isSuccess&&ad.token&&ad.token.length?Ob(ad.token,$b.AFrameworkApplication.userSessionId):Ac(ad.errorMessage,$b.AFrameworkApplication.userSessionId)}).catch(function(ad){return Aa.ULS.sendTraceTag(50431107,3006,
10,"Unexpected exception received from GetLokiToken: {0}",JSON.stringify(ad))})};Object(qa.a)(S,"LivePersonaCardInitializer",null,[]);Object(qa.a)(Z,"Behavior",null,[]);Object(qa.a)(ea,"Identifiers",null,[]);Object(qa.a)(O,"LivePersonaCardParameters",null,[]);Object(qa.a)(Q,"PersonaInfo",null,[]);U.prototype.dAe=function(Ob){return this.rug.Rif()&&Ob&&""!==Ob?!!window.self.LPC:!1};U.prototype.yEg=function(Ob){return this.gPb("addedPersonaToPageV2",Ob,0)};U.prototype.xEg=function(Ob){return this.gPb("addedPersonaToPageV2",
Ob,1)};U.prototype.zEg=function(Ob){return this.gPb("addedPersonaToPageV2",Ob,2)};U.prototype.openCard=function(Ob){return this.gPb("openCard",Ob)};U.prototype.vej=function(Ob){return this.gPb("removedPersonaFromPage",Ob)};U.prototype.yYg=function(Ob){return!!Ob.targetElement&&(this.dAe(Ob.upn||Ob.aadObjectId)||4===Ob.action)};U.prototype.gPb=function(Ob,Ac,sb){sb=void 0===sb?3:sb;if(!this.yYg(Ac))return!1;sb=4!==Ac.action?this.Jah(Ac,sb):null;var ad=window.self.LPC;if(ad&&ad[Ob]){if(sb)ad[Ob](Ac.targetElement,
sb);else ad[Ob](Ac.targetElement);return!0}return!1};U.prototype.Jah=function(Ob,Ac){Ac=void 0===Ac?3:Ac;var sb=Object.assign(new ea,{PersonaType:"User",Upn:Ob.upn,AadObjectId:Ob.aadObjectId});return Object.assign(new O,{personaInfo:Object.assign(new Q,{identifiers:sb,displayName:Ob.name,personaCoinColor:Ob.color}),behavior:Object.assign(new Z,{onCardOpen:function(){Aa.ULS.sendTraceTag(595067869,3006,100,"LivePersonaCard opened");if(Ob.onCardOpen)Ob.onCardOpen()},onCardClose:Ob.onCardClose,disableClick:2===
Ac||3===Ac,disableHover:0===Ac||3===Ac})})};Object(qa.a)(U,"LivePersonaCardManager",null,[]);H.prototype.Xxi=function(){var Ob=$b.AFrameworkApplication.k1("midgardbootstrapper.js",5);return this.Lzg.Qwd(Ob).continueWith(function(){I.Qxe=window.self.MidgardBootstrapper})};Object(qa.a)(H,"LivePersonaCardPackageLoader",null,[498]);var Da=b(565);C.prototype.init=function(){$b.AFrameworkApplication.ha&&$b.AFrameworkApplication.ha.tv(Object(Fa.a)(this,this.OB,"onFullAppSettingsReady"))};C.prototype.dispose=
function(){};C.prototype.hi=function(Ob){this.tb=Ob};C.prototype.OB=function(){var Ob=$b.AFrameworkApplication.ha.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.LokiFutureObject")?new S(new H(this.tb.resolve("Common.ISharedDependencyLoader")),null,$b.AFrameworkApplication.ha,Da.a.lr(this.tb.qc("Common.ILokiTokenManager"))):new S(new H(this.tb.resolve("Common.ISharedDependencyLoader")),this.tb.resolve("Common.ILokiTokenManager"),$b.AFrameworkApplication.ha);Ob.init().continueWith(function(Ac){Ac.og&&
Ac.exception?Aa.ULS.sendTraceTag(50431108,3006,15,"Failed to initialize LivePersonaCard, exception: [{0}]",Ac.exception.message):((Ac=Ac.result)||Aa.ULS.sendTraceTag(595067868,3006,15,"LivePersonaCardInitializer did not return a result"),Ac.isInitialized?Aa.ULS.sendTraceTag(50431109,3006,100,"Successfully initialized LivePersonaCard"):Aa.ULS.sendTraceTag(595067867,3006,Ac.isEnabled?15:100,"Failed to initialize LivePersonaCard, failure message: [{0}]",Ac.failureMessage))});(new aa($b.AFrameworkApplication.Ib,
new U(Ob))).Sg()};C.main=function(){oa.a.instance.nj(new C)};uk.Object.defineProperties(C.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.LivePersonaCard"}}});Object(qa.a)(C,"LivePersonaCardPackage",null,[4,5]);var ib=b(10),Rb=b(905),wc=b(35),Cb=b(175),lb=b(184);E.prototype.$c=function(){return!1};E.prototype.Mc=function(Ob,Ac){switch(Ac.command){case 1491932557:return Cb.g(this.$)&&2===this.excelLiveManager.FQa.Yn;case -440259636:return Cb.f(this.$)&&2===this.excelLiveManager.FQa.Yn;
default:return!1}};E.prototype.executeCommand=function(Ob,Ac){Ob=wc.TaskExtensions.Dl();var sb=Ac.command;switch(Ac.command){case -440259636:this.excelLiveManager.fld();break;case 1491932557:this.excelLiveManager.VXd();break;default:Ob=lb.a(sb)}return Ob};E.prototype.nd=function(){return!1};Object(qa.a)(E,"ExcelLiveCommandHandler",null,[434]);var yb=Rb.a;Am(t,yb);t.prototype.Qd=function(){var Ob=this;this.$.da.Ya(473,function(Ac){Ob.Jd([new E(Ob.$,Ac)])})};t.ka=function(Ob){Rb.a.je(469,new t(Ob))};
Object(qa.a)(t,"ExcelLiveCommandHandlerFactory",Rb.a,[]);var pc=b(224),Ta=b(9),rb=b(47),ic=b(24),Va=b(45),jb=b(20),rc=b(235),Cc=b(32),Hc=b(5),Nb=b(127),nc=b(46),Ha=b(275),tb=b(8),Ub=Sys.EventArgs;Am(v,Ub);Object(qa.a)(v,"ExcelLiveViewStateChangedArgs",Sys.EventArgs,[]);var gc=b(36),Eb;(function(Ob){Ob[Ob.complete=0]="complete";Ob[Ob.nonComplete=1]="nonComplete";Ob[Ob.unknown=2]="unknown"})(Eb||(Eb={}));Object(qa.b)("FollowerViewState",Eb);var Tb=b(1),Wc=gc.a;Am(y,Wc);y.prototype.Gq=function(Ob){this.addHandler("followerViewStateInfoChanged",
Ob)};y.prototype.er=function(Ob){this.removeHandler("followerViewStateInfoChanged",Ob)};y.prototype.Xz=function(){this.wn("QueryExcelLiveViewState")&&this.raiseEvent("followerViewStateInfoChanged")};y.prototype.Bs=function(Ob,Ac){return"QueryExcelLiveViewState"!==Ob?!1:this.j9h(Ac)};y.prototype.wn=function(){return Object(Cb.g)(this.$)&&Tb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShowExcelLiveViewStateInStatusBar",!1)};y.prototype.dispose=function(){this.statusBarManager&&(this.statusBarManager.tG(this),
this.statusBarManager=null);this.Zaa.Nij(this.HIf);this.$=this.Zaa=null;Wc.prototype.dispose.call(this)};y.prototype.j9h=function(Ob){if(!this.$)return!1;Ob.Value=String.format("View State: {0} | Presenter Visible Range: {1}",Eb[this.o7b],this.Ksc);return!0};Object(qa.a)(y,"ExcelLiveStatusBarManager",gc.a,[3,533,299]);var T=gc.a;Am(B,T);B.prototype.CLg=function(Ob){this.addHandler("FollowerViewStateChanged",Ob)};B.prototype.Nij=function(Ob){this.removeHandler("FollowerViewStateChanged",Ob)};B.prototype.Z8i=
function(Ob){this.raiseEvent("FollowerViewStateChanged",Ob)};Object(qa.a)(B,"ExcelLiveFollowerOrExplorerEventManager",gc.a,[]);var ua=b(78),ma=b(106),wa=new Set([ma.a.hlg,ma.a.gve,ma.a.lbg,ma.a.mbg,ma.a.m9e,ma.a.qld]);r.prototype.dispose=function(){this.fih();2!==this.controller.Yn&&(this.nLe(),this.Otb());this.gridView=this.$=this.controller=this.realtimeChannel=this.yvd=this.awd=this.t9a=this.Yvd=this.SHb=null};r.prototype.VXd=function(){this.mr.UXd=tb.HelperMethods.kc();this.BBc(!0)};r.prototype.BBc=
function(Ob,Ac){var sb=this;Ob=void 0===Ob?!1:Ob;Ac=void 0===Ac?null:Ac;var ad;Ob&&this.mr.nBi();if(Ac)this.fOb(Ac)||this.Jxa?this.gpd():Aa.ULS.sendTraceTag(527496925,0,15,"ExcelLiveFollowerOrExplorer::syncToPresenterInternalWithRetry: Could not sync to presenter from presence update"),this.hba=0;else if(++this.hba,this.hba>this.pWe)Aa.ULS.sendTraceTag(527496924,0,10,"ExcelLiveFollowerOrExplorer::syncToPresenterInternalWithRetry: Presenter Nav State not available after "+(this.hba-1)+" retries."),
this.wrd=!0,this.hba=0;else{if(1===this.hba){var Hd=null!==(ad=this.yvd)&&void 0!==ad?ad:this.SHb;if(null!==Hd&&(this.fOb(Hd,!0)||this.Jxa)){this.gpd(Ob,!0);this.hba=0;return}}(ad=this.bdd())&&(this.fOb(ad)||this.Jxa)?(this.gpd(Ob,!0),this.hba=0):1!==this.controller.Yn&&(this.controller.Opa(3,"ExcelLiveFollowerOrExplorer::syncToPresenterInternalWithRetry"),Aa.ULS.sendTraceTag(527496923,0,15,"ExcelLiveFollowerOrExplorer::syncToPresenterInternalWithRetry: Retry\n           "+this.hba+" - Presenter Nav State not available."),
nc.a.instance.create(function(){sb.BBc(Ob,Ac)},Ha.a.Jwa(this.hba,this.qWe,this.rWe,!0),"ExcelLiveFollowerOrExplorer::syncToPresenterInternalWithRetry",void 0,!0))}};r.prototype.gpd=function(Ob,Ac){Ob=void 0===Ob?!1:Ob;Ac=void 0===Ac?!1:Ac;this.controller.Opa(1,"ExcelLiveFollowerOrExplorer::initializeFollower");this.dQg();this.T1b();this.wrd=!1;Ob&&this.mr.mBi(Ac);Tb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExcelLiveSurvey",!1)&&this.controller.QCc()};r.prototype.Aqb=function(){this.kna=
this.kna.bind(this);this.AD=this.AD.bind(this);this.yD=this.yD.bind(this);this.Tf=this.Tf.bind(this);this.Qqc=this.Qqc.bind(this);this.mj=this.mj.bind(this);this.Joc=this.Joc.bind(this);this.lj=this.lj.bind(this);this.Hqc=this.Hqc.bind(this);this.Jpc=this.Jpc.bind(this);this.RPa=this.RPa.bind(this);this.Wqc=this.Wqc.bind(this);this.onScroll=this.onScroll.bind(this);this.Bab=this.Bab.bind(this);this.rd=this.rd.bind(this);this.kab=this.kab.bind(this);this.V$a=this.V$a.bind(this);this.Ie=this.Ie.bind(this);
this.Oqc=this.Oqc.bind(this)};r.prototype.oWe=function(){var Ob=this.bdd();return this.fOb(Ob)};r.prototype.bdd=function(Ob){Ob=void 0===Ob?null:Ob;if(Ob=null!==Ob&&void 0!==Ob?Ob:this.realtimeChannel.ggd())for(var Ac in Ob){var sb=Ac,ad=Ob[Ac];if(!ad)break;if(ad.NavigationState&&ad.MeetingInfo&&(ad.MeetingInfo.MeetingId===this.$.ya.MeetingId||Cb.d()))return this.controller.KL&&this.controller.KL===sb||this.controller.Nwc(sb,"ExcelLiveFollowerOrExplorer:extractNavigationStateFromMeetingPresence"),
ad.NavigationState}return null};r.prototype.fOb=function(Ob,Ac){Ac=void 0===Ac?!1:Ac;var sb=tb.HelperMethods.kc(),ad=this.$4g(Ob,this.SHb,Ac);if(0===ad)return this.GZf(ad,Ob),!0;if(!this.$Sj(Ob.SheetID))return!1;ad&4&&this.setZoom(this.SHb,Ob);Ac=this.V4g(Ob);this.WMj(Ob,ad,Ac);this.GZf(ad,Ob);Ob=Va.D(Ob.VisibleAreaRange);this.Zaa.Z8i(new v(Ac,Ob.toString()));this.mr.YQj(Ac,sb);return!0};r.prototype.WMj=function(Ob,Ac,sb){this.xAb=!0;0===sb?this.kbg(Ac,Ob):this.XMj(Ac,Ob)};r.prototype.GZf=function(Ob,
Ac){this.SHb=Ac;this.THb=Ob};r.prototype.$Sj=function(Ob){Ob=this.$.xa.getItemByName(Ob);var Ac=this.$.xa.oa;this.Yvd=Ob;if(!Ob)return this.Jxa=!0,!1;if(Ob!==Ac){if(!Ob.visible)return!1;this.dOa=!0;Ob.activate();Ac=Ob}if(Tb.EwaSettings.isChangeGateEnabled("OfficeVSO:6146876_ExcelLiveSkipNSVPrompts")){if(!Ac.Yd.fL&&!Ac.Yd.vy)return!0;Ob={};this.$.ae(1690118309,ua.a.$b,0,(Ob[Cb.a]=!0,Ob)).continueWith(function(){return!0})}return!0};r.prototype.setZoom=function(Ob,Ac){Ob&&Ob.SheetID===Ac.SheetID&&(Ob=
(Ac.ZoomLevel-Ob.ZoomLevel)/Ob.ZoomLevel*100,Ac=Cc.a(this.$).zoom,Ob=Ac+Ac*Ob/100,Cc.a(this.$).nlg(Ob),this.mr.h3d=tb.HelperMethods.kc())};r.prototype.kbg=function(Ob,Ac){Ob&2&&(Ob=Va.D(Ac.VisibleAreaRange),this.t9a=ic.Range.kd(Ob.top,Ob.left),this.awd=new rb.a(Ac.TopLeftCellOffsets.X,Ac.TopLeftCellOffsets.Y),Ac=rc.a(this.t9a,this.awd,this.gridView.jt,this.gridView.rb,0,0,this.$,this.gridView.l5()),this.gridView.K0b(Ac,this.t9a,60,this.t9a,ma.a.lbg))};r.prototype.XMj=function(Ob,Ac){var sb=Va.D(Ac.SelectedRanges[Ac.IndexOfActiveRange]),
ad=Ob!==this.THb,Hd=Va.D(Ac.VisibleAreaRange);Ob&1?(this.fkg=this.gridView.Acc(),this.gridView.mu(sb,64,ma.a.mbg,!0),Ob=this.gridView.Nka(),this.t9a=Ob.sM,this.awd=Ob.vD,ad&&(this.Uxa?this.Csd=!0:this.gridView.X_b(this.V$a))):Ob&2&&(!Hd.Od(sb)||this.THb&2||this.THb&4)&&(this.kbg(Ob,Ac),ad&&this.mr.wxd(),this.mr.dFc=tb.HelperMethods.kc())};r.prototype.Laf=function(Ob){var Ac=this.gridView.Acc();return Ac.Od(Ob)&&Ob.Od(Ac)?!0:!1};r.prototype.$4g=function(Ob,Ac,sb){sb=void 0===sb?!1:sb;if(!Ob&&!Ac)return 0;
if(!Ac&&Ob||sb)return 7;var ad=Va.D(Ob.SelectedRanges[Ob.IndexOfActiveRange]),Hd=Va.D(Ac.SelectedRanges[Ac.IndexOfActiveRange]),Ne=Va.D(Ob.VisibleAreaRange),Ud=Va.D(Ac.VisibleAreaRange);if(Ac.SheetID===Ob.SheetID&&(Ac.SheetID!==Ob.SheetID||Ac.ZoomLevel===Ob.ZoomLevel&&ad.equals(Hd)&&Ne.equals(Ud)&&Ac.TopLeftCellOffsets.X===Ob.TopLeftCellOffsets.X&&Ac.TopLeftCellOffsets.Y===Ob.TopLeftCellOffsets.Y))return sb?7:0;ad=Va.D(Ob.VisibleAreaRange);sb=Va.D(Ob.SelectedRanges[Ob.IndexOfActiveRange]);ad=ic.Range.kd(ad.top,
ad.left);Hd=new rb.a(Ob.TopLeftCellOffsets.X,Ob.TopLeftCellOffsets.Y);Ud=Va.D(Ac.VisibleAreaRange);Ne=Va.D(Ac.SelectedRanges[Ac.IndexOfActiveRange]);Ud=ic.Range.kd(Ud.top,Ud.left);var Ge=new rb.a(Ac.TopLeftCellOffsets.X,Ac.TopLeftCellOffsets.Y),Sc=0;Ob.SheetID!==Ac.SheetID?Sc|=3:(Ne.equals(sb)||(Sc|=1),Ob.ZoomLevel!==Ac.ZoomLevel&&(Sc|=4),Hd.equals(Ge)&&ad.equals(Ud)||(Sc|=2));return Sc};r.prototype.V4g=function(Ob){var Ac=A(this.$,Cc.a(this.$).zoom),sb=Ac.rQb;return Ac.uQb<Ob.ViewportWidth*this.q2d||
sb<Ob.ViewportHeight*this.q2d?1:0};r.prototype.dQg=function(){var Ob=this;this.$.ea.UE(this.AD);this.$.ea.e_a(this.yD);this.$.da.Ya(419,function(Ac){Ac.qse(Ob.Bab);Ac.rse(Ob.Bab)})};r.prototype.nLe=function(){var Ob=this;this.$&&(this.$.ea.VD(this.AD),this.$.ea.Dcb(this.yD),this.$.da.Ya(419,function(Ac){Ac.hVf(Ob.Bab);Ac.iVf(Ob.Bab)}))};r.prototype.Bab=function(){this.mr.ZQj()};r.prototype.AD=function(){this.$.ea.af!==Ta.a.Re&&this.$.ea.sc&&(this.Jxa&&this.$.ea.Yt(this.Tf),this.p7a=!0)};r.prototype.Tf=
function(){(this.p7a||this.Jxa)&&this.oWe()&&(this.$.ea.jx(this.Tf),this.Jxa=this.p7a=!1)};r.prototype.yD=function(){this.dOa?this.dOa=!1:this.p7a&&this.oWe()&&(this.p7a=!1)};r.prototype.T1b=function(){var Ob=this;this.Uxa?(this.gridView.view.ALg(this.Oqc),this.gridView.X_b(this.V$a)):(this.gridView.k_a(this.Qqc),this.$.xXc(this.Joc),this.$.aB(this.lj),this.$.da.Ya(419,function(Ac){Ac.JLg(Ob.Wqc)}),this.gridView.Tqe(this.RPa));this.gridView.zc.wl(this.mj);this.$.da.Ya(65,function(Ac){Ac.XJg(Ob.Hqc)})};
r.prototype.Otb=function(){this.gridView&&(this.Uxa?(this.gridView.view.Lij(this.Oqc),this.gridView.Wuc(this.V$a)):(this.gridView.Kcb(this.Qqc),this.gridView.hUf(this.RPa)),this.gridView.zc.$k(this.mj));if(!this.Uxa){this.$&&(this.$.jMd(this.Joc),this.$.UD(this.lj));var Ob=this.$.da.Aa(419);Ob&&Ob.Rij(this.Wqc)}(Ob=this.$.da.Aa(65))&&Ob.yhj(this.Hqc)};r.prototype.Qqc=function(){this.wAb?this.wAb=!1:this.nic||this.dOa||this.xAb||this.Sti()||(this.grd?this.grd=!1:this.cna())};r.prototype.Oqc=function(){this.cna()};
r.prototype.V$a=function(Ob,Ac){this.Uxa?(Ob=Ac.gotoCaller,Ob=Ob.endsWith("_Vacs")?Ob.split("_",1)[0]:Ob,wa.has(Ob))?this.Csd&&this.Laf(this.fkg)&&(this.mr.wxd(),this.Csd=!1):this.cna():(this.gridView.Wuc(this.V$a),this.Laf(this.fkg)&&this.mr.wxd())};r.prototype.Sti=function(){var Ob=this.gridView.Nka().sM;return this.Yvd===this.$.oa&&Ob.equals(this.t9a)?!0:!1};r.prototype.mj=function(){this.cna()};r.prototype.Joc=function(){this.wAb=!0};r.prototype.lj=function(){this.wAb=!0};r.prototype.Wqc=function(){this.nic=
!0};r.prototype.RPa=function(){this.nic=!1};r.prototype.onScroll=function(Ob){this.xAb&&1===this.controller.Yn&&(this.xAb=!1,this.grd=!0);Ob.stopPropagation()};r.prototype.Hqc=function(){this.cna()};r.prototype.cna=function(){this.Vlj();this.mr.XQj(this.THb);this.controller.Opa(2,"ExcelLiveFollowerOrExplorer::onExploreActionsObserved");this.nLe();this.Otb();this.controller.DCe()};r.prototype.eQg=function(){this.realtimeChannel.OGa(this.kna);this.$.ea.wre(this.Jpc);this.Uxa||Nb.a.instance.Gd(this.gridView.domElement).ka("scroll",
this.onScroll);this.$.Gl(this.rd);this.$.oa.Yd.LGa(this.kab);this.$.oa.Yd.c0b(this.kab);this.$.xa.Nf(this.Ie)};r.prototype.fih=function(){this.realtimeChannel&&this.realtimeChannel.XAa(this.kna);null!==this.$&&(this.$.ea.jhj(this.Jpc),this.$.En(this.rd),this.$.oa.Yd.Gcb(this.kab),this.$.oa.Yd.CMd(this.kab),this.$.xa.Ag(this.Ie))};r.prototype.kna=function(Ob,Ac){this.IId(Ac.v4);this.PId(Ac.JP)};r.prototype.IId=function(Ob){var Ac=this;!Ob||1>Ob.length||2===this.controller.Yn||Ob.forEach(function(sb){sb===
Ac.controller.KL&&(Ac.controller.yuc(),Ac.controller.Opa(3,"ExcelLiveFollowerOrExplorer:processDisconnectedClients"))})};r.prototype.PId=function(Ob){!Ob||1>Ob.length||(Ob=this.bdd(Ob),null!==Ob&&(this.yvd=Ob,2!==this.controller.Yn&&(3===this.controller.Yn?this.BBc(this.wrd,Ob):this.fOb(Ob))))};r.prototype.Vlj=function(){this.Jxa=this.xAb=this.dOa=this.wAb=this.nic=!1};r.prototype.Jpc=function(){1!==this.controller.Yn||this.dOa?this.mr.PVe=!0:this.cna()};r.prototype.kab=function(Ob,Ac){this.mr.bRj(Ac)};
r.prototype.Ie=function(){this.dOa||this.Uxa&&this.p7a||this.cna()};r.prototype.rd=function(Ob,Ac){Ac.Vg||this.mr.Jzi()};Object(qa.a)(r,"ExcelLiveFollowerOrExplorer",null,[]);var Ca=b(28),db=b(51),Sa=b(103),hb=b(393),Xb=b(14);w.prototype.dispose=function(){this.Otb();this.iih();this.$=this.gridView=this.viewBlockContainerHelpers=this.qQb=this.realtimeChannel=this.ZQa=this.ly=null};w.prototype.fld=function(){Aa.ULS.sendTraceTag(537162846,0,50,"ExcelLiveParticipantV0.GoToPresenter - UI action performed");
this.ZQa&&this.ZQa.Sq&&hb.a.kz.notificationBar.removeEntry(this.ZQa);if(this.xrd)this.o8f(),Aa.ULS.sendTraceTag(537162845,0,50,"ExcelLiveParticipantV0.GoToPresenter - UI action ignored due to floating object selection.");else{var Ob=!0;this.TNa||(Ob=this.F6h());Ob?this.d$f():this.o8f()}};w.prototype.kna=function(Ob,Ac){this.IId(Ac.v4);this.PId(Ac.JP)};w.prototype.mfc=function(){var Ob=this;if(0===this.ly.Yn)Aa.ULS.sendTraceTag(529064851,0,50,"ExcelLiveParticipantV0::HandleViewportChanged: Viewport changed for presenter.");
else if(!this.qQb||this.qQb&&!this.qQb.Ap)this.qQb=nc.a.instance.create(function(){Ob.cna()},500,"ExcelLiveParticipantV0.HandleViewportChanged",void 0,!0)};w.prototype.cna=function(){Aa.ULS.sendTraceTag(529064849,0,50,"ExcelLiveParticipantV0::onExploreActionsObserved: Explore action observed.");this.eQe();this.TNa||this.b$f("ExcelLiveParticipantV0::onExploreActionsObserved")};w.prototype.o8f=function(){this.ZQa||(this.ZQa=hb.a.kz.notificationBar.Caa(Xb.a.instance.fa(2208),!1),this.ZQa.image=0);hb.a.kz.notificationBar.OE(this.ZQa);
Aa.ULS.sendTraceTag(528786756,0,50,"ExcelLiveParticipantV0.GoToPresenter - Action not performed. Location not available.")};w.prototype.initialize=function(){Cb.e(this.$)?(this.Tdi(),this.T1b()):(this.tQg(),this.Cdf())};w.prototype.Tdi=function(){this.ly.Opa(0,this.rmc+"initExcelLivePresenter")};w.prototype.Cdf=function(){var Ob=this;++this.T3a;if(this.T3a>this.tWe)Aa.ULS.sendTraceTag(527766151,0,10,"ExcelLiveParticipantV0::initFollowerOrExplorerRetryable: Presenter data not available after "+(this.T3a-
1)+" retries.");else{var Ac=this.sWe();Ac?this.Adf(Ac):(Aa.ULS.sendTraceTag(527766150,0,15,"ExcelLiveParticipantV0::initFollowerOrExplorerRetryable: Retry "+this.T3a+" - Presenter data not available."),nc.a.instance.create(function(){Ob.Cdf()},Ha.a.Jwa(this.T3a,this.uWe,this.vWe,!0),"ExcelLiveParticipantV0::initFollowerOrExplorerRetryable",void 0,!0))}};w.prototype.Adf=function(Ob){Ob?(this.T3a=0,Aa.ULS.sendTraceTag(537162844,0,50,"ExcelLiveParticipantV0::InitExcelLiveFollowerOrExplorer: Update received from presenter with CID: "+
this.ly.KL+" and messageId:"+this.ima),this.r7=Ob,this.eQe(),this.TNa&&3===this.ly.Yn?this.d$f():this.TNa||this.b$f("ExcelLiveParticipantV0::InitExcelLiveFollowerOrExplorer")):Aa.ULS.sendTraceTag(527766149,0,50,"ExcelLiveParticipantV0::InitExcelLiveFollowerOrExplorer: Update not from presenter.")};w.prototype.d$f=function(){this.ly.Opa(1,"ExcelLiveParticipantV0::startFollowing");this.T1b();Tb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExcelLiveSurvey",!1)&&this.ly.QCc()};w.prototype.b$f=
function(Ob){this.ly.Opa(2,Ob);this.Otb();this.ly.DCe()};w.prototype.tQg=function(){this.realtimeChannel.OGa(this.kna)};w.prototype.iih=function(){this.realtimeChannel.XAa(this.kna)};w.prototype.T1b=function(){this.gridView.k_a(this.mfc)};w.prototype.Otb=function(){this.gridView.Kcb(this.mfc)};w.prototype.IId=function(Ob){var Ac=this;!Ob||1>Ob.length||Ob.forEach(function(sb){sb===Ac.ly.KL&&(Ac.r7=void 0,Ac.ly.yuc(),Ac.ly.Opa(3,"ExcelLiveParticipantV0::onMeetingPresenceUpdated"))})};w.prototype.PId=
function(Ob){!Ob||1>Ob.length||(Ob=this.sWe(Ob),this.Adf(Ob))};w.prototype.sWe=function(Ob){Ob=(void 0===Ob?null:Ob)||this.realtimeChannel.ggd();if(!Ob)return null;this.ly.KL||this.xci(Ob);if(this.ly.KL&&(Ob=Ob[this.ly.KL])){var Ac=Ob.MeetingInfo.MessageId;if(this.ima+1<Ac)Aa.ULS.sendTraceTag(524940886,0,15,"ExcelLiveParticipantV0::fetchPresenterSelectionFromPresenceData: Presenter message lost. LastMessageId: "+this.ima+", CurrentMessageId: "+Ac);else{if(this.ima>Ac)return Aa.ULS.sendTraceTag(524940885,
0,15,"ExcelLiveParticipantV0::fetchPresenterSelectionFromPresenceData: Older Presenter message received. LastMessageId: "+this.ima+", CurrentMessageId: "+Ac),null;if(this.ima===Ac)return Aa.ULS.sendTraceTag(524940884,0,50,"ExcelLiveParticipantV0::fetchPresenterSelectionFromPresenceData: Duplicate Presenter message received. LastMessageId: "+this.ima+", CurrentMessageId: "+Ac),null}this.ima=Ac;return Ob.SelectedRange}return null};w.prototype.xci=function(Ob){for(var Ac in Ob){var sb=Ac,ad=Ob[Ac];if((null===
ad||void 0===ad?0:ad.MeetingInfo)&&ad.MeetingInfo.IsPresenter&&ad.MeetingInfo.MeetingId===this.$.ya.MeetingId){this.ima=ad.MeetingInfo.MessageId-1;this.ly.Nwc(sb,"ExcelLiveParticipantV0:identifyPresenterFromPresenceData");break}}};w.prototype.eQe=function(){if(this.r7){for(var Ob=this.r7.length,Ac=0;Ac<Ob;Ac++){var sb=this.r7[Ac].NamedObjectName;if(Ca.a.N2c(sb)){if(Aa.ULS.sendTraceTag(537162837,0,50,"ExcelLiveParticipantV0::EvaluateIfPresenterRangeIntersectingWithCurrentViewport: Floating object selection evaluated to false"),
this.xrd=!1,this.r7[Ac].SheetName===this.$.xa.oa.sheetName&&this.gridView.V_(Va.D(this.r7[Ac]))){Aa.ULS.sendTraceTag(537162836,0,50,"ExcelLiveParticipantV0::EvaluateIfPresenterRangeIntersectingWithCurrentViewport: Presenter selection intersection evaluated to true");this.TNa=!0;return}}else if(Aa.ULS.sendTraceTag(537162839,0,50,"ExcelLiveParticipantV0::EvaluateIfPresenterRangeIntersectingWithCurrentViewport: Floating object selection evaluated to true"),this.xrd=!0,this.r7[Ac].SheetName===this.$.xa.oa.sheetName&&
this.fni(sb)){Aa.ULS.sendTraceTag(537162838,0,50,"ExcelLiveParticipantV0::EvaluateIfPresenterRangeIntersectingWithCurrentViewport: Presenter selection intersection evaluated to true");this.TNa=!0;return}}Aa.ULS.sendTraceTag(537162835,0,50,"ExcelLiveParticipantV0::EvaluateIfPresenterRangeIntersectingWithCurrentViewport: Presenter selection intersection evaluated to false")}this.TNa=!1};w.prototype.fni=function(Ob){var Ac=this;Ob=Sa.a(this.$).Mq(Ob);if(!Ob||!Ob.floatingObject||!Ob.domElement)return!1;
this.viewBlockContainerHelpers||wc.TaskExtensions.Ba(db.GetServiceTaskFactory.Ua(this.$.da,103,104,0),function(ad){Ac.viewBlockContainerHelpers=ad.result},this.$.la,8);if(!this.viewBlockContainerHelpers)return!1;var sb=this.viewBlockContainerHelpers.u_(Ob.sg,Ob.domElement);return Ob.sg.An.Od(sb)?!0:!1};w.prototype.F6h=function(){Aa.ULS.sendTraceTag(537162834,0,50,"ExcelLiveParticipantV0.GoToPresenterLocation - Update participant viewport");var Ob=this.r7&&0<this.r7.length?this.r7[0]:null;if(!Ob||
!Ob.SheetName)return!1;var Ac=this.$.xa.getItemByName(Ob.SheetName);if(!Ac||Ac!==this.$.oa&&!Ac.visible)return Aa.ULS.sendTraceTag(529109851,0,15,"ExcelLiveParticipantV0.GoToPresenterLocation - sheet not available"),!1;Ac!==this.$.oa&&Ac.activate();this.gridView.mu(Va.D(Ob),3,"ExcelLiveParticipantV0.GoToPresenterLocation");return!0};Object(qa.a)(w,"ExcelLiveParticipantV0",null,[]);u.prototype.dispose=function(){this.kih();this.gridView=this.$=this.realtimeChannel=this.controller=null};u.prototype.Aqb=
function(){this.tpc=this.tpc.bind(this);this.Zwa=this.Zwa.bind(this);this.Xec=this.Xec.bind(this);this.rd=this.rd.bind(this)};u.prototype.BKj=function(){this.wsc(!0);this.CQg()};u.prototype.CQg=function(){this.$.xa.YJ(this.Xec);this.gridView.k_a(this.Zwa);this.gridView.ga.WE(this.Zwa);this.$.Gl(this.rd)};u.prototype.kih=function(){this.$&&(this.$.xa.vG(this.Xec),this.$.En(this.rd));this.gridView&&(this.gridView.Kcb(this.Zwa),this.gridView.ga.OI(this.Zwa))};u.prototype.Xec=function(){this.gridView.Kcb(this.Zwa);
this.gridView.vQ(this.tpc)};u.prototype.tpc=function(){this.wsc();this.gridView.UL(this.tpc);this.gridView.k_a(this.Zwa)};u.prototype.Zwa=function(){this.$.xa&&this.$.xa.Dff||this.wsc()};u.prototype.rd=function(Ob,Ac){Ac.Vg||this.mr.GAi()};u.prototype.kSh=function(){var Ob=tb.HelperMethods.kc(),Ac=this.gridView.Acc();if(null===Ac)return null;var sb=this.gridView.Nka().vD;var ad={};ad.SheetID=this.$.oa?this.$.oa.sheetName:null;ad.ZoomLevel=Cc.a(this.$).zoom;ad.SelectedRanges=Va.k(this.gridView.ga.va.selectedRanges,
this.$);ad.IndexOfActiveRange=this.gridView.ga.va.CB;ad.VisibleAreaRange=Va.v(Ac,this.$);ad.TopLeftCellOffsets={};ad.TopLeftCellOffsets.X=sb.x;ad.TopLeftCellOffsets.Y=sb.y;sb=A(this.$,ad.ZoomLevel);var Hd=sb.uQb;ad.ViewportHeight=sb.rQb;ad.ViewportWidth=Hd;this.mr.$Qj(Ac);this.mr.Tya(tb.HelperMethods.kc()-Ob,"ExcelLivePresenter.getCurrentViewportNavigationState: TimeToCreateNavigationState");return ad};u.prototype.Muj=function(){this.p0={};this.p0.MeetingId=this.$.ya.MeetingId;this.p0.IsPresenter=
!0};u.prototype.wsc=function(Ob){var Ac=this;Ob=void 0===Ob?!1:Ob;var sb=this.kSh();if(null===sb)Aa.ULS.sendTraceTag(527962826,0,15,"ExcelLivePresenter:postViewportUpdatesToMeetingParticipants CurrentViewportNavigationState is null");else{var ad={};ad.MeetingInfo=this.p0;ad.NavigationState=sb;this.realtimeChannel.O0f(ad);Ob&&Tb.EwaSettings.isChangeGateEnabled("OfficeVSO:6085564_ExcelLive_ResendViewportStateAfterInterval")&&nc.a.instance.create(function(){Ac.wsc(Ob)},this.QHi+this.W4g(),"ExcelLivePresenter::postViewportUpdatesToMeetingParticipants",
void 0,!0)}};u.prototype.W4g=function(){var Ob=void 0===Ob?-3E3:Ob;return Math.random()*(3E3-Ob+1)+Ob};Object(qa.a)(u,"ExcelLivePresenter",null,[]);var xb=b(697),Sb;(function(Ob){Ob[Ob.none=0]="none";Ob[Ob.selection=1]="selection";Ob[Ob.scroll=2]="scroll";Ob[Ob.zoom=4]="zoom";Ob[Ob.default=0]="default"})(Sb||(Sb={}));Object(qa.b)("UpdateType",Sb);var qb=b(54);h.prototype.dispose=function(){};h.prototype.Jzi=function(){var Ob={};Ob.FollowerViewState=0<this.Ced?"Hybrid":Eb[this.wlc];Ob.FollowerViewStateTransitions=
this.Ced;Ob.FollowerZoomInOppositeDirectionCount=this.NYe;Ob.ExplorerConsumptionTrends=this.PVe?"WorkbookEdited":"WorkbookViewed";Ob.ExplorerNSVModeTrends=this.Pwf;Ob.ExplorerNSVSwitchTrends=this.Qwf;Ob=qb.a.Kc(Ob);this.$.sendBeaconTraceTag(526987797,50,!1,"ExcelLiveFollowerOrExplorer.logFollowerOrExplorerTelemetry: "+Ob)};h.prototype.wxd=function(){2E3>tb.HelperMethods.kc()-this.dFc&&(this.Tya(tb.HelperMethods.kc()-this.dFc,"ExcelLiveFollowerOrExplorer.logNonCompleteViewStateTelemetry: TimeElapsedSinceLastViewportChange"),
this.dFc=0)};h.prototype.Tya=function(Ob,Ac){Aa.ULS.sendTraceTag(527499614,0,50,Ac+" = "+Ob)};h.prototype.YQj=function(Ob,Ac){this.wlc&&Ob!==this.wlc&&++this.Ced;this.wlc=Ob;this.Tya(tb.HelperMethods.kc()-Ac,"ExcelLiveFollowerOrExplorer.trackAndLogFollowerViewStateTransitions: TimeElapsedInSyncingFollower")};h.prototype.XQj=function(Ob){this.Gcd=tb.HelperMethods.kc();++this.OVe;1===this.OVe&&this.Tya(tb.HelperMethods.kc()-this.sessionStartTime,"ExcelLiveFollowerOrExplorer.trackAndLogExplorerTransitions: TimeToFirstExplorerTransition");
Aa.ULS.sendTraceTag(527499613,0,50,"ExcelLiveFollowerOrExplorer.trackAndLogExplorerTransitions: Last Update Type from Presenter Was = {0}. Current View State = {1}",Sb[Ob],jb.g(this.$).Acc().AB(!0))};h.prototype.ZQj=function(){Cc.a(this.$);var Ob=tb.HelperMethods.kc()-this.h3d;1E4>Ob&&(this.Tya(Ob,"ExcelLiveFollowerOrExplorer.trackAndLogFollowerZoomTrends: TimeToZoomChangeInOppositeDirection"),this.h3d=0);this.aRj()};h.prototype.aRj=function(){tb.HelperMethods.kc()<this.sessionStartTime+12E4&&++this.NYe};
h.prototype.nBi=function(){var Ob=tb.HelperMethods.kc()-this.Gcd;5E3>Ob&&this.Tya(Ob,"ExcelLiveFollowerOrExplorer.logSyncBackToPresenterTelemetry: TimeElapsedToSyncBackSinceBecomingExplorer");this.Gcd=0};h.prototype.mBi=function(Ob){Ob=void 0===Ob?!1:Ob;this.Tya(tb.HelperMethods.kc()-this.UXd,"ExcelLiveFollowerOrExplorer.logSyncBackToPresenterTelemetry: Synced via Presence Notification = "+Ob+" TimeElapsedInSyncingExplorerBackToPresenter");this.UXd=0};h.prototype.bRj=function(Ob){typeof Ob===typeof xb.a?
++this.Pwf:++this.Qwf};h.prototype.$Qj=function(Ob){var Ac=jb.g(this.$).ga.va.activeRange;Ob=Ob.Od(Ac)?!0:!1;Ob||0!==this.cLb?Ob&&0<this.cLb&&(Ob=tb.HelperMethods.kc()-this.cLb,this.Tya(Ob,"ExcelLivePresenter.trackAndLogSelectionVisibilityForPresenter: Selection was outside presenter Viewport. TimeSpentWithoutSelectionVisible"),this.u7c+=Ob,this.cLb=0):this.cLb=tb.HelperMethods.kc()};h.prototype.GAi=function(){var Ob={},Ac=tb.HelperMethods.kc()-this.sessionStartTime;Ob.PercentageTimeSelectionVisible=
(Ac-this.u7c)/Ac*100;Ob=qb.a.Kc(Ob);this.$.sendBeaconTraceTag(526987796,50,!1,"ExcelLivePresenter.logPresenterTelemetry: "+Ob)};uk.Object.defineProperties(h.prototype,{sessionStartTime:{configurable:!0,enumerable:!0,get:function(){return this.mke},set:function(Ob){this.mke=Ob}},OVe:{configurable:!0,enumerable:!0,get:function(){return this.z9d},set:function(Ob){this.z9d=Ob}},Gcd:{configurable:!0,enumerable:!0,get:function(){return this.y9d},set:function(Ob){this.y9d=Ob}},dFc:{configurable:!0,enumerable:!0,
get:function(){return this.jne},set:function(Ob){this.jne=Ob}},NYe:{configurable:!0,enumerable:!0,get:function(){return this.q$d},set:function(Ob){this.q$d=Ob}},Ced:{configurable:!0,enumerable:!0,get:function(){return this.r$d},set:function(Ob){this.r$d=Ob}},h3d:{configurable:!0,enumerable:!0,get:function(){return this.Fne},set:function(Ob){this.Fne=Ob}},PVe:{configurable:!0,enumerable:!0,get:function(){return this.A9d},set:function(Ob){this.A9d=Ob}},Pwf:{configurable:!0,enumerable:!0,get:function(){return this.Ife},
set:function(Ob){this.Ife=Ob}},Qwf:{configurable:!0,enumerable:!0,get:function(){return this.Jfe},set:function(Ob){this.Jfe=Ob}},wlc:{configurable:!0,enumerable:!0,get:function(){return this.Cde},set:function(Ob){this.Cde=Ob}},UXd:{configurable:!0,enumerable:!0,get:function(){return this.Ele},set:function(Ob){this.Ele=Ob}},cLb:{configurable:!0,enumerable:!0,get:function(){return this.bke},set:function(Ob){this.bke=Ob}},u7c:{configurable:!0,enumerable:!0,get:function(){return this.J7d},set:function(Ob){this.J7d=
Ob}}});Object(qa.a)(h,"ExcelLiveTelemetryHelper",null,[3]);n.prototype.dispose=function(){this.zmb&&(this.zmb.dispose(),this.zmb=null);this.fkb&&(this.fkb.dispose(),this.fkb=null);this.Qjb&&(this.Qjb.dispose(),this.Qjb=null);this.mr&&(this.mr.dispose(),this.mr=null);this.$=this.Wga=this.qie=this.ara=null};n.prototype.VXd=function(){this.OYe?this.OYe.VXd():Aa.ULS.sendTraceTag(537162880,0,10,"ExcelLiveManager::SyncToPresenter - FollowerOrExplorer object is not available to complete the action")};n.prototype.fld=
function(){this.eVe?this.eVe.fld():Aa.ULS.sendTraceTag(537162851,0,10,"ExcelLiveManager::GoToPresenter - ExcelLiveParticipantV0 object is not available to complete the action")};n.prototype.l0b=function(Ob){this.ara.l0b(Ob)};n.prototype.LMd=function(Ob){this.ara.LMd(Ob)};n.prototype.Sdi=function(){Cb.g(this.$)?Cb.e(this.$)?this.zmb=new u(this.$,this.Wga,this.ara,this.mr):this.fkb=new r(this.$,this.Wga,this.ara,this.mr):Cb.f(this.$)&&(this.Qjb=new w(this.$,this.Wga,this.ara))};uk.Object.defineProperties(n.prototype,
{Cn:{configurable:!0,enumerable:!0,get:function(){return this.qie}},FQa:{configurable:!0,enumerable:!0,get:function(){return this.ara.FQa}},OYe:{configurable:!0,enumerable:!0,get:function(){return this.fkb}},presenter:{configurable:!0,enumerable:!0,get:function(){return this.zmb}},eVe:{configurable:!0,enumerable:!0,get:function(){return this.Qjb}}});Object(qa.a)(n,"ExcelLiveManager",null,[500,3]);m.prototype.dispose=function(){this.$=null};m.prototype.Nwc=function(Ob,Ac,sb){Aa.ULS.sendTraceTag(527171654,
0,50,"ExcelLiveFollowerOrExplorer:"+sb+" Setting presenter information to CID: "+Ob+" from CID: "+this.KL);this.KL=Ob;this.sAa=Ac.User.UserName;this.Jsc=Ac.UserColor};m.prototype.yuc=function(){this.Jsc=this.sAa=this.KL=void 0};uk.Object.defineProperties(m.prototype,{Yn:{configurable:!0,enumerable:!0,get:function(){return this.Zge},set:function(Ob){this.Zge=Ob}},KL:{configurable:!0,enumerable:!0,get:function(){return this.Ehe},set:function(Ob){this.Ehe=Ob}},sAa:{configurable:!0,enumerable:!0,get:function(){return this.Fhe},
set:function(Ob){this.Fhe=Ob}},Jsc:{configurable:!0,enumerable:!0,get:function(){return this.Ghe},set:function(Ob){this.Ghe=Ob}}});Object(qa.a)(m,"ExcelLiveParticipantModel",null,[3]);var mb=b(253),ac=b(11),Uc;(function(Ob){Ob[Ob.presenter=0]="presenter";Ob[Ob.follower=1]="follower";Ob[Ob.explorer=2]="explorer";Ob[Ob.unknown=3]="unknown"})(Uc||(Uc={}));Object(qa.b)("ParticipantRole",Uc);var Zc=b(269),Kc=b(21);l.prototype.eNd=function(Ob,Ac,sb,ad){sb=void 0===sb?null:sb;ad=void 0===ad?null:ad;this.Sya(Ob,
Ac);this.Yn=Ac;this.sAa=sb;this.YQa=ad;this.YXe?(this.YXe=!1,this.tVf()):(this.OZd=!1,this.container.classList.add("ewa-excelLive-meetingPill-container-hidden"))};l.prototype.dispose=function(){$removeHandler(this.container,"transitionend",this.Cpa);$removeHandler(this.container,"transitioncancel",this.Cpa);this.container=null};l.prototype.Qe=function(Ob,Ac){if(Ac)return!1;Ob=this.container.querySelectorAll(ac.DOMElementExtensions.nq);var sb;for(Ac=0;Ac<Ob.length;Ac++){var ad=Ob[Ac];ac.DOMElementExtensions.canReceiveFocus(ad)&&
(sb=ad)}if(!sb)return Aa.ULS.sendTraceTag(529109852,0,10,"ExcelLiveMeetingPillUtility.SetFocusOnSection: Could not find focusable element in live meeting pill"),!1;sb.focus();return!0};l.prototype.eg=function(Ob){return ac.DOMElementExtensions.Se(this.Kb,Ob)};l.prototype.ji=function(){};l.prototype.Xh=function(){};l.prototype.initialize=function(Ob,Ac){this.container=document.createElement("div");this.container.id="excelLiveMeetingPillContainer";this.container.classList.add("ewa-excelLive-meetingPill-container");
Ac.appendChild(this.container);Cb.c(Ob)&&(this.container.style.height="32px",Aa.ULS.sendTraceTag(529073433,0,50,"ExcelLiveMeetingPillUtility.initialize:Changed the height of meeting pill container for mobile"));this.Cpa=this.b$h;$addHandler(this.container,"transitionend",this.Cpa);$addHandler(this.container,"transitioncancel",this.Cpa);Zc.a(Ob).Xg(this)};l.prototype.tVf=function(){var Ob={};Ob.participantRole=this.Yn;Tb.EwaSettings.isChangeGateEnabled("OfficeVSO:5931413_ShortenMeetingPillDisplayNameForMobile")&&
this.$.ZN?(Aa.ULS.sendTraceTag(527991135,0,50,"ExcelLiveMeetingPillUtility.renderMeetingPillInternal: Getting shortened user name for mobile meeting pill"),Ob.presenterName=this.B2h(this.sAa)):Ob.presenterName=this.sAa;Ob.presenterColor=this.YQa;appChrome.renderLiveMeetingPill(this.container,Ob)};l.prototype.B2h=function(Ob){if(Kc.a.Qh(Ob))return Aa.ULS.sendTraceTag(527991134,0,15,"ExcelLiveMeetingPillUtility.getShortenedUserName: Username is null or empty"),Ob;var Ac=Ob.split(" "),sb=Ac.length;return 2>
sb||Kc.a.Qh(Ac[sb-1])?Ob:Ac[0]+" "+Ac[sb-1].substring(0,1)};l.prototype.Sya=function(Ob,Ac){Ac=Uc[Ac];if(0===this.lastUpdateTime)Aa.ULS.sendTraceTag(527766152,0,50,Ob+"::FirstRole - ["+Ac+"]"),this.lastUpdateTime=tb.HelperMethods.kc();else{var sb=Uc[this.Yn];if(sb===Ac)Aa.ULS.sendTraceTag(523548820,0,15,"{0}:RoleTransition: Received transition to participant role which is same as current role: [{1}]",Ob,sb);else{var ad=tb.HelperMethods.kc()-this.lastUpdateTime;Aa.ULS.sendTraceTag(528786757,0,50,"{0}:RoleTransition: Transition participant role from [{1}] to [{2}] after {3}s",
Ob,sb,Ac,(ad/1E3).toFixed(2));this.lastUpdateTime=tb.HelperMethods.kc()}}};uk.Object.defineProperties(l.prototype,{Kb:{configurable:!0,enumerable:!0,get:function(){return this.container}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!!this.container&&2===this.Yn}},de:{configurable:!0,enumerable:!0,get:function(){return mb.a.Sof}}});Object(qa.a)(l,"ExcelLiveMeetingPillUtility",null,[451,3]);e.prototype.CJb=function(Ob,Ac){this.Yn=Ob;this.YQa=void 0===Ac?null:Ac;appChrome.renderLiveMeetingBoundary(this.container,
this.gTg)};e.prototype.dispose=function(){this.container=null;this.$.UD(this.Wbb);this.$.hij(this.Wbb)};e.prototype.initialize=function(Ob){this.Aqb();this.container=document.createElement("div");this.container.id="excelLiveMeetingBoundaryContainer";this.container.classList.add("ewa-excelLive-meetingBoundary-container");Ob.append(this.container);this.CJb(this.Yn,this.YQa);this.$.aB(this.Wbb);this.$.QKg(this.Wbb)};e.prototype.Aqb=function(){this.Wbb=this.Wbb.bind(this)};e.prototype.Wbb=function(){this.CJb(this.Yn,
this.YQa)};uk.Object.defineProperties(e.prototype,{UJh:{configurable:!0,enumerable:!0,get:function(){var Ob;return(Ob=this.eh?document.getElementById("AdditionalBarsRegion"):document.getElementById(this.$.Lb+Hc.a.Btb))?Ob.clientHeight:0}},sWg:{configurable:!0,enumerable:!0,get:function(){var Ob;return(Ob=this.eh?document.getElementById("BusinessBar"):document.getElementById(this.$.Lb+Hc.a.Rye))?Ob.clientHeight:0}},KEh:{configurable:!0,enumerable:!0,get:function(){var Ob=null;this.eh&&(Ob=document.getElementById("FarPaneRegion"));
return Ob?Ob.clientWidth:0}},GNg:{configurable:!0,enumerable:!0,get:function(){var Ob=Cb.c(this.$)?(Ob=document.getElementById(this.$.Lb+Hc.a.D1a))?Ob.clientHeight:0:this.$.Vla?0:this.$.DXg();return Ob}},LAj:{configurable:!0,enumerable:!0,get:function(){var Ob;return(Ob=this.eh?document.getElementById("Header"):document.getElementById(Hc.a.kHa))?Ob.clientHeight:0}},v3c:{configurable:!0,enumerable:!0,get:function(){return this.eh?document.getElementById("EditorContainer"):this.$.fF}},Wxe:{configurable:!0,
enumerable:!0,get:function(){return this.LAj+this.GNg+this.sWg+this.UJh}},fTg:{configurable:!0,enumerable:!0,get:function(){return this.v3c.clientLeft}},hTg:{configurable:!0,enumerable:!0,get:function(){return this.v3c.clientWidth+this.KEh-3}},eTg:{configurable:!0,enumerable:!0,get:function(){if(this.eh){var Ob=document.getElementById("StatusBar");return Ob.offsetTop+Ob.clientHeight-this.Wxe}return this.v3c.clientHeight}},gTg:{configurable:!0,enumerable:!0,get:function(){var Ob={};Ob.participantRole=
this.Yn;Ob.presenterColor=this.YQa;Ob.top=this.Wxe;Ob.left=this.fTg;Ob.width=this.hTg;Ob.height=this.eTg;Ob.size=3;return Ob}}});Object(qa.a)(e,"ExcelLiveMeetingBoundaryUtility",null,[3]);var va=b(89),fb=b(43),Pb=b(187),sc=gc.a;Am(c,sc);c.prototype.dispose=function(){this.$=null;this.iw&&(this.iw.dispose(),this.iw=null);this.kKa&&(this.kKa.dispose(),this.kKa=null);this.jKa&&(this.jKa.dispose(),this.jKa=null);this.zNa&&(va.a.Fa(this.zNa),this.zNa=null)};c.prototype.Opa=function(Ob,Ac){this.iw.Yn&&
this.iw.Yn===Ob||(this.iw.Yn=Ob,this.xVf(Ac))};c.prototype.Nwc=function(Ob,Ac){if(Ob){var sb=this.$.ea.Lkd(Ob);sb?(this.iw.Nwc(Ob,sb,Ac),this.xVf(String.format("{0};{1}",Ac,this.rmc+"savePresenterDetails")),this.raiseEvent(c.UHd)):Aa.ULS.sendTraceTag(528086351,0,10,"ExcelLiveController:savePresenterDetails Failed to get presenter information from sessionStateManager")}else Aa.ULS.sendTraceTag(528086352,0,10,"ExcelLiveController:savePresenterDetails Presenter CID is undefined")};c.prototype.yuc=function(){this.iw.yuc()};
c.prototype.l0b=function(Ob){this.addHandler(c.UHd,Ob)};c.prototype.LMd=function(Ob){this.removeHandler(c.UHd,Ob)};c.prototype.QCc=function(){var Ob=this;this.zNa=Pb.AsyncMethodContext.av(function(){Ob.$.ae(-1404915046,-1,0,null)},this.$.ya.ExcelLiveSurveyTriggerThresholdTimeInMs,fb.a.QCc,this.zNa)};c.prototype.DCe=function(){this.zNa&&this.zNa.cancel()};c.prototype.ffi=function(){this.iw=new m(this.$);var Ob=this.$.fF;$b.AFrameworkApplication.sa.Qa.eh&&(Ob=document.getElementById("StatusBarRegion"));
this.kKa=new l(this.$,Ob);Ob=this.$.zr;$b.AFrameworkApplication.sa.Qa.eh&&(Ob=document.getElementById("regionComposerRoot"));this.XBb&&(this.jKa=new e(this.$,Ob));Ob=Cb.e(this.$)?0:3;this.Opa(Ob,this.rmc+"initializeController")};c.prototype.xVf=function(Ob){switch(this.iw.Yn){case 2:this.kKa.eNd(Ob,this.iw.Yn,this.iw.sAa);this.XBb&&this.jKa.CJb(this.iw.Yn);break;case 1:this.kKa.eNd(Ob,this.iw.Yn,this.iw.sAa,this.iw.Jsc);this.XBb&&this.jKa.CJb(this.iw.Yn,this.iw.Jsc);break;case 3:case 0:this.kKa.eNd(Ob,
this.iw.Yn),this.XBb&&this.jKa.CJb(this.iw.Yn)}};uk.Object.defineProperties(c.prototype,{FQa:{configurable:!0,enumerable:!0,get:function(){return this.iw}},Yn:{configurable:!0,enumerable:!0,get:function(){return this.iw.Yn}},KL:{configurable:!0,enumerable:!0,get:function(){return this.iw.KL}}});c.UHd="PDS";Object(qa.a)(c,"ExcelLiveController",gc.a,[3]);var hd=pc.a;Am(a,hd);a.prototype.create=function(){this.Rdi()};a.prototype.dispose=function(){this.Cn&&this.Cn.vJb(this.eQa);this.Cn=null;this.ly&&
(this.ly.dispose(),this.ly=null);hd.prototype.dispose.call(this)};a.prototype.Rdi=function(){var Ob=this;this.ly=new c(this.$);this.$.da.Ya(26,function(Ac){Ob.Cn=Ac;Ob.E5g()})};a.prototype.E5g=function(){Aa.ULS.sendTraceTag(537162850,0,50,"ExcelLiveCommandHandlerFactory::ConnectToRealTimeChannel - attach RealTimeChannelInitialized handler");this.Cn.$Xc(this.eQa);this.Cn.d1a()};a.ka=function(Ob){Aa.ULS.sendTraceTag(537162848,0,50,"ExcelLiveManagerFactory::Attach: Begin service registration");Ob.da.Ha(474,
new a(Ob));Aa.ULS.sendTraceTag(537162847,0,50,"ExcelLiveManagerFactory::Attach: Complete service registration")};Object(qa.a)(a,"ExcelLiveManagerFactory",pc.a,[]);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.ExcelLive");Type.registerNamespace("_Ewa");ha.a.Ti(".ewa-excelLive-meetingPill-container{height:24px;transition:height 400ms cubic-bezier(.8,0,.2,1) 0s;position:absolute;width:100%;bottom:0;pointer-events:none;z-index:992}.ewa-excelLive-meetingPill-container-hidden{height:0 !important;overflow:hidden;transition:height 400ms cubic-bezier(.8,0,.2,1) 0s}.ewa-excelLive-meetingBoundary-container{position:fixed;z-index:992}");
Type.registerNamespace("Common.App.RtcHostNotificationSubscription");ia.main();Type.registerNamespace("Common.App.LivePersonaCard.Contracts");Type.registerNamespace("Common.App.LivePersonaCard");C.main();Type.registerNamespace("AppRealtimeChannel");(function(){ib.a.Ga(function(Ob){a.ka(Ob);t.ka(Ob)})})()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.rt.js.map/92bf62f9a939b57eb7d338f7d8c8c5ad/EwaDS.rt.js.map