(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[24],{1206:function(z,F,b){function a(m,n){m=l.call(this,m,n)||this;n!==e.a.L$&&m.AGa(n);m.Fha(a.iterateNext);m.Fha(a.yya);m.HWc(c.a.FVa);m.HWc(c.a.GVa);return m}b.d(F,"a",function(){return a});z=b(0);var c=b(166);F=b(1318);var e=b(971),l=F.a;Am(a,l);a.iterateNext="IterateNext";a.yya="IteratePrevious";a.NOb="ToggleShowChanges";a.setCurrentChangeCount="SetCurrentChangeCount";a.setTotalChangesCount="SetTotalChangesCount";a.oQa=
"OnVHDiffReady";Object(z.a)(a,"VersionHistoryMessenger",F.a,[])},1321:function(z,F,b){function a(J,aa,ia,ba){var ra=this;this.authorColor=this.d3=this.sfa=null;this.E8a=!1;this.xdg=0;this.s2a=-1;this.K7c=0;this.mJa=100;this.cma=-1;this.$1d=null;this.wqb=u.a.t0j;this.nKe=u.a.u0j;this.Vh=function(ka){(ka=t.a(ka)?null:ka.Result)?ka.OperationWaitingForFileDownload?20>ra.K7c?(ra.mJa*=2,P.Task.delay(ra.mJa).continueWith(function(){ra.j_d()})):(ra.WDc(),e.ULS.sendTraceTag(537150406,0,50,"VersionHistoryHighlightManager::OnWebMethodSuccess Next Operation enqueue failed")):
ka.ActivityList?(ra.initialize(ka.ActivityList,ka.VersionAuthors),E.EwaSettings.isChangeGateEnabled("OfficeVSO:4844740_ExcelVersionHistoryHighlightChangesFix")?ra.oQa():ra.Zzc(!0),ra.$1d.stop(),e.ULS.sendTraceTag(41743369,0,50,"VersionHistoryHighlightManager: Time taken For showing diffs in Ms:{0}",ra.$1d.Gc.toString())):(ra.WDc(),e.ULS.sendTraceTag(537150407,0,50,"VersionHistoryHighlightManager::OnWebMethodSuccess no activity list found.")):(ra.mJa*=2,P.Task.delay(ra.mJa).continueWith(function(){ra.j_d()}),
e.ULS.sendTraceTag(537150408,0,10,"VersionHistoryHighlightManager::OnWebMethodSuccess call returned null result."))};this.Xza=function(){ra.WDc();e.ULS.sendTraceTag(537150405,0,10,"VersionHistoryHighlightManager::OnWebMethodFailure service call failed.")};this.Yud=function(ka){e.ULS.sendTraceTag(537150400,0,50,"VersionHistoryHighlightManager.IterateMessageHandler called with MessageID:{0}",ka.MessageId);switch(ka.MessageId){case Z.a.iterateNext:ra.iterateNext();ra.cma=(ra.cma+1)%ra.nT.length;ra.hLb(Z.a.setCurrentChangeCount,
ra.cma+1);break;case Z.a.yya:ra.yya();ra.cma=0>ra.cma?0:ra.cma;ra.cma=(ra.cma+ra.nT.length-1)%ra.nT.length;ra.hLb(Z.a.setCurrentChangeCount,ra.cma+1);break;case Z.a.NOb:ra.Zzc(ka.Values.ToggleValue)}};this.H4g=function(ka,da){return ra.T4b(ka.Jm,da.Jm)};this.G4g=function(ka,da){return ra.T4b(ka.Jm,da)};this.ld=function(){ra.U7b()};this.Fp=function(){ra.U7b()};this.mj=function(){ra.U7b()};e.ULS.sendTraceTag(537150411,0,50,"VersionHistoryHighlightManager::Constructor.");this.$=J;this.ariaLiveNotifier=
ba;this.gridView=O.g(this.$);this.gridView.ga.nH(this.ld);this.gridView.RE(this.Fp);this.gridView.zc.wl(this.mj);this.lXj();aa&&(this.$1d=J.Sb.Hc("UserAction","VersionHistoryDiffManagerStopWatch"),this.j_d());if(this.Fs=ia)J=l.a.Fba(this.$.ya.VersionHistoryActionUrl)||I.a.L$,J!==I.a.L$&&this.Fs.AGa(J),this.Fs.mo(Z.a.iterateNext),this.Fs.mo(Z.a.yya),this.Fs.mo(Z.a.NOb),this.Fs.Vl(Z.a.iterateNext,this.Yud),this.Fs.Vl(Z.a.yya,this.Yud),this.Fs.Vl(Z.a.NOb,this.Yud)}function c(J,aa,ia){this.xGa=J;this.Jm=
aa;this.FEc=ia}z=b(0);var e=b(13),l=b(79),m=b(1036),n=b(81),h=b(199),u=b(9),w=b(213),r=b(62),B=b(45),y=b(561),v=b(173),A=b(109),t=b(289),E=b(1),C=b(8),H=b(98),U=b(14),Q=b(288);b(106);var O=b(20),ea=b(353);Object(z.a)(c,"UserActivityLocation",null,[]);var Z=b(1206),S=b(83),I=b(971),P=b(53);b.d(F,"a",function(){return a});a.prototype.dispose=function(){this.RAa();this.sfa=this.d3=null;this.gridView&&(this.gridView.ga&&this.gridView.ga.xG(this.ld),this.gridView.wG(this.Fp),this.gridView.zc&&this.gridView.zc.$k(this.mj),
this.Fs&&(this.Fs.Ipa(Z.a.yya),this.Fs.Ipa(Z.a.iterateNext),this.Fs.Ipa(Z.a.NOb)))};a.prototype.initialize=function(J,aa){J?(this.RAa(),this.s2a=-1,this.sfa=[],this.E8a=!1,this.d3={},this.authorColor={},this.rDi(aa),this.o7c(J)):e.ULS.shipAssertTag(537150410,0,!1,"VersionHistoryHighlightManager.Initialize - userActivityList was Null")};a.prototype.j_d=function(){function J(ia,ba,ra){var ka=aa.$.na.ta;ia=Q.b(ia,aa.Vh);ba=Q.a(ba,aa.Xza);var da=ka.Ma(1,null);return S.i(ka,"GetVersionHistoryHighlightActivitiesData",
da,ia,ba,ra,null,4)}var aa=this;e.ULS.sendTraceTag(537150409,0,50,"VersionHistoryHighlightManager: TryFetchUserActivityandTriggerDiff triggered: {0} --{1}",this.K7c.toString(),this.mJa.toString());this.K7c++;E.EwaSettings.uc()?this.$.userOperationManager.jc(new v.a(537,0,J,80),null):this.$.userOperationManager.jc(new y.a(537,0,J,16),null)};a.prototype.Zzc=function(J){var aa=this.d3,ia;for(ia in aa){var ba=ia,ra=aa[ia];ra?ra.cNb(J):e.ULS.shipAssertTag(537150404,0,!1,"VersionHistoryHighlightManager.ShowOrHideAllHighlights -"+
ba+"view was Null")}};a.prototype.RAa=function(){var J=this.d3,aa;for(aa in J){var ia=aa,ba=J[aa];ba?ba.Vej():e.ULS.shipAssertTag(537150403,0,!1,"VersionHistoryHighlightManager.RemoveAllHighlights -"+ia+"view was Null")}this.sfa=this.d3=null};a.prototype.b0f=function(J){var aa=this.cZh(J,this.s2a);var ia=aa.qdf;J=aa.Sig;aa.returnValue&&(e.ULS.shipAssertTag(537150402,0,!!J,"VersionHistoryHighlightManager.SelectNextOrPreviousChange - userActivityLocation is null"),this.U7b(),J.xGa.toString()in this.d3?
(this.d3[J.xGa.toString()].wrj(J.Jm),aa=B.D(J.Jm),this.ariaLiveNotifier.setEnabled(!1),this.ariaLiveNotifier.setEnabled(!0),this.ariaLiveNotifier.readText(String.format(U.a.instance.Bb(157),ia+1,this.nT.length,aa.AB(!1),J.FEc.DisplayName)),this.s2a=ia):e.ULS.shipAssertTag(537150401,0,!1,String.format("VersionHistoryHighlightManager.SelectNextOrPreviousChange - {0} view not present in views dictionary",J.xGa.toString())))};a.prototype.hLb=function(J,aa){if(E.EwaSettings.ma(323))if(this.Fs){var ia=
{};ia.count=aa;J=new m.a(J);J.Values=ia;this.Fs.send(J)}else e.ULS.sendTraceTag(537150370,0,10,"VersionHistoryHighlightManager.SendIteratorTextUpdateMessage hostPostmessenger is null");else e.ULS.sendTraceTag(537150371,0,50,"VersionHistoryHighlightManager.SendIteratorTextUpdateMessage VersionHistoryIterator BRS is turned off")};a.prototype.cZh=function(J,aa){var ia=!1;var ba=null;for(var ra=0;!ia&&ra<this.nT.length;){aa=J?this.UYh(aa):this.E_h(aa);ba=this.nT[aa];var ka=Object(n.a)(H.a,this.$.xa.getItemByName(ba.Jm.SheetName));
if(!ka)return e.ULS.shipAssertTag(537150369,0,!1,String.format("VersionHistoryHighlightManager.GetNextorPreviousUserActivityLocationFromIndex - useractivitylocation contains sheetrange with null sheet")),{returnValue:!1,qdf:aa,Sig:ba};ka.visible&&(ia=!0);ra++}return{returnValue:ia,qdf:aa,Sig:ba}};a.prototype.UYh=function(J){return-1===J?this.y4e():(J+1)%this.nT.length};a.prototype.E_h=function(J){-1===J&&(J=this.y4e());return J=(J+this.nT.length-1)%this.nT.length};a.prototype.o7c=function(J){this.heh(J);
this.U6c()};a.prototype.Z4h=function(J,aa){var ia=[];if(!J.RangeList)return e.ULS.shipAssertTag(537150368,0,!1,"VersionHistoryHighlightManager.GetUserActivityLocationFromRangeActivityLocation - ActivityLocationType.Range RangeList Null "),ia;J=Cl(J.RangeList);for(var ba=J.next();!ba.done;ba=J.next())(ba=ba.value)&&this.$.xa.Gj(ba.SheetName)?(ba=new c(0,ba,aa),ia.push(ba)):e.ULS.shipAssertTag(537150367,0,!1," Inavlid sheet name"+ba.SheetName);return ia};a.prototype.heh=function(J){J=Cl(J);for(var aa=
J.next();!aa.done;aa=J.next())if(aa=aa.value,!aa||A.e(aa.LocationList))e.ULS.sendTraceTag(537150366,0,50,"Empty Location list");else for(var ia=Cl(aa.LocationList),ba=ia.next();!ba.done;ba=ia.next())if(ba=ba.value)switch(ba.Type){case 0:this.sfa.push.apply(this.sfa,Jl(this.Z4h(ba,aa.Person)));break;default:e.ULS.sendTraceTag(537150364,0,50,"VersionHistoryHighlightManager.CreateViews Failed. Invalid ActivityLocationType")}else e.ULS.shipAssertTag(537150365,0,!1,"VersionHistoryHighlightManager.CreateUserActivityLocationList - LocationList contains Null")};
a.prototype.U6c=function(){for(var J={},aa=new h.a,ia=[],ba=Cl(this.sfa),ra=ba.next();!ra.done;ra=ba.next())if(ra=ra.value,aa.contains(ra.FEc)||aa.add(ra.FEc),0===ra.xGa){var ka=new ea.a(B.D(ra.Jm),r.d(this.$.xa.getItemByName(ra.Jm.SheetName))),da=a.azc(ka);da in J||ia.push(ka);J[da]=this.VQh(ra.FEc)}e.ULS.sendTraceTag(42541534,0,15,"VersionHistoryHighlightManager.CreateRangeHighlightView. Total activities : {0}, Highlightable activities: {1},Total userlist in activities : {0}, Total userlist from pane: {1} ",
this.sfa.length,ia.length,aa.count,this.xdg);this.WDc();0<ia.length&&(J=new (b(1411).RangeVersionHistoryHighlightView)(this.$,ia,J,this.wqb),this.d3["0"]=J)};a.prototype.WDc=function(){var J=this.sfa?this.nT.length:0;this.hLb(Z.a.setCurrentChangeCount,0);this.hLb(Z.a.setTotalChangesCount,J)};a.prototype.oQa=function(){this.hLb(Z.a.oQa,0)};a.prototype.rDi=function(J){if(J){this.xdg=J.length;for(var aa=0;aa<J.length;++aa)if(E.EwaSettings.isChangeGateEnabled("OfficeVSO:5140301_HandleEmptyInitialsColor")&&
!J[aa].InitialsColor)e.ULS.sendTraceTag(537150362,0,15,"VersionHistoryHighlightManager.MapAuthorColorInfo: InitialsColor is null or empty for a version author");else{var ia=J[aa].EmailAddress;var ba=J[aa].UserName;var ra=null;if(J[aa].LoginName){var ka=J[aa].LoginName.split("|");3===ka.length&&(ra=ka[2])}ra?this.authorColor[ra]=J[aa].InitialsColor:ia?(e.ULS.sendTraceTag(537150361,0,15,String.format("VersionHistoryHighlightManager Map Author Color: LoginName is null")),this.authorColor[ia]=J[aa].InitialsColor):
ba?(e.ULS.sendTraceTag(537150360,0,15,String.format("VersionHistoryHighlightManager Map Author Color: Email Address is null")),this.authorColor[ba]=J[aa].InitialsColor):e.ULS.sendTraceTag(537150359,0,10,String.format("VersionHistoryHighlightManager Map Author Color: User name is null"))}}else e.ULS.sendTraceTag(537150363,0,15,"VersionHistoryHighlightManager.MapAuthorColorInfo: versionAuthors is null")};a.prototype.lXj=function(){if(this.$.ya.VersionHistoryHighlightsSettings)for(var J=Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(this.$.ya.VersionHistoryHighlightsSettings))?
Sys.Serialization.JavaScriptSerializer.deserialize(this.$.ya.VersionHistoryHighlightsSettings):null,aa=0;aa<J.length;aa++){var ia=J[aa],ba=ia.key?ia.key:ia.Key?ia.Key:"";ia=ia.value?ia.value:ia.Value?ia.Value:"";"DefaultColor"===ba?this.nKe=ia:"InitialTint"===ba?this.wqb=ia:e.ULS.sendTraceTag(537150357,0,15,String.format("VersionHistoryHighlightManager.UpdateHighlightSettings Highlight Settings are incorrect"))}else e.ULS.sendTraceTag(537150358,0,15,String.format("VersionHistoryHighlightManager.UpdateHighlightSettings Highlight Settings are null"))};
a.prototype.VQh=function(J){if(J.Email in this.authorColor)return this.authorColor[J.Email];if(J.DisplayName in this.authorColor)return this.authorColor[J.DisplayName];e.ULS.sendTraceTag(537150356,0,15,String.format("VersionHistoryHighlightManager GetColorFromPerson - unable to associate corresponding author in dictionary"));return this.nKe};a.prototype.T4b=function(J,aa){var ia=Object(n.a)(H.a,this.$.xa.getItemByName(J.SheetName)),ba=Object(n.a)(H.a,this.$.xa.getItemByName(aa.SheetName));return ia&&
ba?(ia=(ia=C.HelperMethods.uD(ia.index,ba.index))||C.HelperMethods.uD(J.FirstRow,aa.FirstRow))||C.HelperMethods.uD(J.FirstColumn,aa.FirstColumn):(e.ULS.sendTraceTag(537150355,0,10,"VersionHistoryHighlightManager.CompareSharedSheetRange - null sheet"),0)};a.prototype.y4e=function(){var J=B.m(this.gridView.ga.va.activeRange,this.$.xa.oa);if(!J)return e.ULS.sendTraceTag(537150354,0,10,"VersionHistoryHighlightManager.GetNearestLocationIndexFromCurrentSelection - SelectedSharedSheetRange is null "),0;
J=C.HelperMethods.Nx(new w.a(this.nT),0,this.nT.length,J,this.G4g);0>J&&(J=~J);return J%this.nT.length};a.prototype.U7b=function(){if(this.aLb){if(!(this.aLb.xGa.toString()in this.d3)){e.ULS.shipAssertTag(537150353,0,!1,String.format("VersionHistoryHighlightManager.DeselectCurrentlySelectedView - {0} view not present in views dictionary",this.aLb.xGa.toString()));return}this.d3[this.aLb.xGa.toString()].Shh(this.aLb.Jm)}this.s2a=-1};a.prototype.iterateNext=function(){this.b0f(!0)};a.prototype.yya=
function(){this.b0f(!1)};a.azc=function(J){return String.format("{0}{1}",J.range,J.sheetId)};uk.Object.defineProperties(a.prototype,{fhb:{configurable:!0,enumerable:!0,get:function(){return this.d3}},aLb:{configurable:!0,enumerable:!0,get:function(){return-1===this.s2a?null:this.nT[this.s2a]}},nT:{configurable:!0,enumerable:!0,get:function(){this.E8a||(this.sfa.sort(this.H4g),this.E8a=!0);return this.sfa}}});Object(z.a)(a,"VersionHistoryHighlightManager",null,[521,3])},1411:function(z,F,b){function a(y,
v,A,t){this.rkb=null;this.$=y;this.Nzg=v;this.pTa=A;this.qTa={};this.wqb=t;this.Bgi()}function c(){}b.r(F);z=b(0);var e=b(13),l=b(9);c.ryh="ewa-vhr-rectinnerborder";Object(z.a)(c,"CssClassNames",null,[]);var m=b(62),n=b(45),h=b(225),u=b(106),w=b(20),r=b(353),B=b(1321);b.d(F,"RangeVersionHistoryHighlightView",function(){return a});a.prototype.cNb=function(y){y?this.Fb.co(this.dI):this.Fb.si(this.dI)};a.prototype.Vej=function(){this.cNb(!1);this.Fb.RLb(new r.a(null,m.d(this.$.oa)),this.dI)};a.prototype.wrj=
function(y){if(this.pTa){var v=new r.a(n.D(y),m.d(this.$.xa.getItemByName(y.SheetName))),A=B.a.azc(v);if(A in this.pTa)if(A in this.qTa){v=h.a.pq(this.pTa[A]);A=this.qTa[A];for(var t in A)A[t].style.backgroundColor=String.format("rgba({0},{1},{2},{3})",v.r,v.g,v.b,l.a.v0j);w.g(this.$).ga.Pa.DH(null);w.g(this.$).b9e(y,60,!0,u.a.f$i)}else e.ULS.sendTraceTag(537150426,0,10,"RangeVersionHistoryHighlightView.SelectView sheetRangeToDivMap doesn't contain entry for "+A);else e.ULS.sendTraceTag(537150427,
0,10,"RangeVersionHistoryHighlightView.SelectView sheetRangeToColorMap doesn't contain entry for "+A)}else e.ULS.sendTraceTag(537150428,0,10,"RangeVersionHistoryHighlightView.SelectView sheetRangeToColorMap is null")};a.prototype.Shh=function(y){y=new r.a(n.D(y),m.d(this.$.xa.getItemByName(y.SheetName)));var v=B.a.azc(y);if(v in this.qTa)if(v in this.pTa){y=h.a.pq(this.pTa[v]);v=this.qTa[v];for(var A in v)v[A].style.backgroundColor=String.format("rgba({0},{1},{2},{3})",y.r,y.g,y.b,this.wqb)}else e.ULS.sendTraceTag(537150424,
0,10,"RangeVersionHistoryHighlightView.DeselectView sheetRangeToColorMap doesn't contain entry for "+v);else e.ULS.sendTraceTag(537150425,0,10,"RangeVersionHistoryHighlightView.DeSelectView sheetRangeToDivMap doesn't contain entry for "+v)};a.prototype.Bgi=function(){var y=this;this.Fb.ox(this.Nzg,[a.K5],!1,function(v,A){if(v&&v.range&&v.sheetId&&A){var t=new r.a(v.range,v.sheetId);t=B.a.azc(t);t in y.qTa||(y.qTa[t]={});y.qTa[t][v.paneType.toString()]=A;t in y.pTa?(v=y.pTa[t],t=h.a.pq(v),A.style.borderColor=
v,A.style.backgroundColor=String.format("rgba({0},{1},{2},{3})",t.r,t.g,t.b,y.wqb),v=document.createElement("div"),v.className=c.ryh,A.appendChild(v)):e.ULS.sendTraceTag(537150419,0,10,"RangeVersionHistoryHighlightView.InitializeSheetRangeList sheetRangeToColorMap doesn't contain entry for "+t)}else e.ULS.shipAssertTag(537150423,0,!!v,"RangeVersionHistoryHighlightView.AddSheetRangeList: state is null"),e.ULS.shipAssertTag(537150422,0,!v||!!v.range,"RangeVersionHistoryHighlightView.AddSheetRangeList: state.Range is null"),
e.ULS.shipAssertTag(537150421,0,!v||!!v.sheetId,"RangeVersionHistoryHighlightView.AddSheetRangeList: state.SheetId is null"),e.ULS.shipAssertTag(537150420,0,!!A,"RangeVersionHistoryHighlightView.AddSheetRangeList: div is null")})};uk.Object.defineProperties(a.prototype,{dI:{configurable:!0,enumerable:!0,get:function(){return[a.K5]}},Fb:{configurable:!0,enumerable:!0,get:function(){return this.rkb||(this.rkb=w.g(this.$).Fb)}}});a.K5=23;Object(z.a)(a,"RangeVersionHistoryHighlightView",null,[540])},
1449:function(z,F,b){function a(mc){var Rc=ke.call(this)||this;Rc.$=mc;Rc.Xb();return Rc}function c(mc,Rc,nd,Td){var Fe=this;nd=void 0===nd?null:nd;Td=void 0===Td?null:Td;this.WHa=null;this.$$e=!1;this.XIf=function(fe){Fe.W0a.Qtj();Fe.W0a.Zzc(!0);ug.a.Qh(fe.wywaActivities)||2===fe.wywaActivities[0].type||Fe.W0a.sbi(fe.wywaActivities[0])};this.$=mc;this.W0a=new Q(this.$);this.u6d=new ia(db.AFrameworkApplication.Ib,Zd.EwaSettings.ma(461));mc=Le.a.YPj(kf.a.instance.qc("Common.App.CatchUpActivity.ICatchUpRequestHandler"));
this.Iof=Td;this.SAe=new w(this.$,mc,this.V7a());this.RAe=new U(this.$,db.AFrameworkApplication.Ib);this.emptyCatchUpBehaviorManager=new u(this.$);this.Fxi(function(fe){Fe.AMi(fe)},Rc);this.Bzi();Rc=null;nd||(Rc=kf.a.instance.resolve("Common.App.CatchUpActivity.FloodgateEventLogger"));this.flyoutRibbonButton=nd||new m(Rc);this.flyoutFocus=new n(this.$,this.flyoutRibbonButton)}function e(){this.emptyCatchUpBehaviorManager=this.ulsLogger=this.uiCulture=this.flyoutRibbonButton=this.flyoutFocus=this.dataCulture=
this.changeSummariesDataProvider=this.appColorUpdateIsEnabled=this.activityRequestManager=this.activityNavigationManager=this.activityContentManager=null}function l(){this.flyoutAnchorTarget=this.useCompactSummaryString=this.disableDismissOnClick=this.customDynamicEntryPointEnabled=this.dynamicEntryPointEnabled=this.activityFeedDataEnabled=this.includeRelevantAuthorsInSummaryString=this.summaryStringEnabled=this.flyoutEnabled=this.featuredActivityGroupsEnabled=null}function m(mc){this.buttonClickedCallback=
null;this.Pkb=this.IAb=!1;this.UIh=new Date;this.qYe=mc}function n(mc,Rc){this.$=mc;this.flyoutRibbonButton=void 0===Rc?null:Rc;id.a(this.$).Xg(this);this.hasFocus=!1}function h(mc){window.performance&&"function"===typeof window.performance.mark&&window.performance.mark("CatchUpInit."+mc)}function u(mc){this.$=mc}function w(mc,Rc,nd){nd=void 0===nd?!1:nd;this.$=mc;this.TAe=Rc;this.mHb=kf.a.instance.resolve("Common.App.People.IPeopleColorUtils");this.$sc=kf.a.instance.resolve("Common.App.People.IUserProfilePictureUtils");
this.V7a=nd}function r(){var mc=t.call(this)||this;mc.relationship=0;return mc}function B(){this.color=this.imageUrl=this.email=this.givenName=this.displayName=this.provider=this.id=null}function y(){this.lowWaterline=this.highWaterline=this.wywaWaterline=this.actors=this.activities=null;this.hasMore=!1;this.isFirstDocumentOpen=null}function v(){this.activityFeedItems=null}function A(){this.collectionId=this.type=this.id=null;this.activityState=0;this.timestamp=this.activityFeedItemPayload=null}function t(){this.activityFeedItemId=
this.activityId=null;this.type=0;this.collectionId=this.state=this.navigationId=this.relevancy=this.displayTimestamp=this.location=this.actors=null}function E(mc,Rc,nd,Td,Fe,fe,ef){ef=mc.Ma(1,void 0===ef?null:ef);ef.getRelevantActivitiesDataRequest=Rc;return pd.i(mc,"GetRelevantActivitiesData",ef,nd,Td,Fe,fe,0)}function C(mc,Rc,nd,Td,Fe,fe){fe=mc.Ma(1,void 0===fe?null:fe);return pd.i(mc,"GetLineageWywaAuthors",fe,Rc,nd,Td,Fe,4)}function H(){}function U(mc,Rc){this.$=mc;this.Ki=Rc}function Q(mc){var Rc=
this;this.ESa=this.E5b=this.Pfa=null;this.J5={};this.oEa=null;this.qnd=!1;this.KFb=function(nd,Td){switch(Td.state){case 0:case 1:3===Td.qId&&(Rc.Lai(),Rc.ESa=null);break;case 2:break;case 3:Rc.Z8c();Rc.ESa=Td.activityId;Rc.QEj();break;default:hb.ULS.shipAssertTag(537168030,0,!1,"CatchUpActivityHighlightManager.OnHighlightStateChanged - Invalid CatchUpActivityHighlightState:"+Td.state)}};this.nl=function(){Rc.Mtb()};this.ld=function(){Rc.Mtb()};this.Fp=function(){Rc.Mtb()};this.mj=function(){Rc.Mtb()};
this.e7f=function(nd,Td){Rc.Pfa&&Td.cI!==Rc.dla&&(Td.isSticky&&Rc.q8b(!0),(nd=Rc.FSj(Td.cI))?(Rc.Pfa.createActivityIndicatorTooltip(Object.assign(new Z,{target:Td.cI,container:nd,activityIds:[Td.activityId],isSticky:Td.isSticky,dirHint:Rc.gridView.rtl?12:9})),Td.isSticky?(Rc.dla=Td.cI,hb.ULS.sendTraceTag(51172352,0,50,"CatchUpActivityHighlightManager::ShowActivityFlyoutHandler: Activity Indicator Raising Selected/Unselected Event.")):(Rc.bgc=Td.cI,hb.ULS.sendTraceTag(51172353,0,50,"CatchUpActivityHighlightManager::ShowActivityFlyoutHandler: Activity Indicator Raising Hover/Unhover Event.")),
Rc.yic||(Rc.gridView.view.nt(Rc.xDc),Rc.gridView.yr(Rc.xDc),Rc.yic=!0)):hb.ULS.shipAssertTag(537168027,0,!1,"CatchUpActivityHighlightManager::ShowActivityFlyoutHandler FlyoutContainer is null."))};this.eMe=function(nd,Td){Rc.q8b(Td.bkh)};this.xDc=function(){Rc.Pfa?(Rc.dla&&Rc.Pfa.updateActivityIndicatorTooltip(Object.assign(new O,{target:Rc.dla,isSticky:!0})),Rc.bgc&&Rc.Pfa.updateActivityIndicatorTooltip(Object.assign(new O,{target:Rc.dla,isSticky:!1}))):hb.ULS.shipAssertTag(537168024,0,!1,"CatchUpActivityHighlightManager::UpdateActivityFlyouts ActivityIndicatorTooltipManager is null.")};
this.$=mc;this.gridView=te.g(this.$);this.ga=this.gridView.ga;this.Za=this.gridView.zc;this.ga.R_b(this.nl);this.ga.nH(this.ld);this.gridView.RE(this.Fp);this.Za.wl(this.mj);this.dla=this.bgc=null;this.yic=!1;this.led={}}function O(){this.target=null;this.isSticky=!1}function ea(){this.clearSticky=!1}function Z(){this.activityIds=this.container=this.target=null;this.isSticky=!1;this.dirHint=0}function S(){this.J4c=[];this.oMb={};this.xoe={}}function I(mc,Rc,nd,Td,Fe){mc=P.call(this,mc,Rc,nd,Td)||
this;mc.ranges=Fe;mc.E8a=!1;return mc}function P(mc,Rc,nd,Td){var Fe=Ib.call(this)||this;Fe.$=mc;Fe.K4d=Rc;Fe.pog=nd;Fe.vC=Td;Fe.state=0;return Fe}function J(mc,Rc,nd){nd=eg.call(this,mc,Rc,nd)||this;nd.gridView=te.g(mc);nd.Nna=Rc;return nd}function aa(mc){var Rc=this;this.KFb=function(){switch(Rc.sv.model.state){case 1:Rc.g8f(!0);break;case 0:Rc.cNb(!1);break;case 2:case 3:Rc.cNb(!0);break;default:hb.ULS.shipAssertTag(537167968,0,!1,"RangeCatchUpActivityView.OnHighlightStateChanged - Invalid CatchUpActivityHighlightState:"+
Rc.sv.model.state)}};this.Ttg=mc;this.sv.Kqe(this.KFb);this.Mz=[]}function ia(mc){this.Ki=mc}function ba(mc){return Tf.call(this,mc)||this}function ra(mc,Rc){this.$=mc;this.catchUpActivityManager=Rc}function ka(){this.tb=null}function da(mc){this.Uu=mc}function ha(mc){this.Gxg=mc}function qa(mc){this.dZa=mc;this.eee=new wf.a}function Aa(mc,Rc,nd){this.Lwg=mc;this.pWa=Rc;this.FWa=nd}function Fa(mc,Rc){return vf.call(this,mc,Rc)||this}function ab(mc,Rc){this.Yg=mc;this.Uu=Rc}function Ua(mc){var Rc=
le.call(this)||this;Rc.$=mc;Rc.Xb();return Rc}function bb(mc,Rc){var nd=this;this.otd=!1;this.Tf=function(){nd.$dg()};this.$=mc;Zd.EwaSettings.ma(631)&&this.$.ea.w9a&&!bb.Gyb&&(Rc&&!Rc.$eb||this.l0j(),bb.baf?hb.ULS.sendTraceTag(537155461,0,50,"LineageTeachingCalloutTriggerManager will not trigger WYWA waterline check as it was already checked in session"):Rc&&!Rc.$eb||this.r0j());hb.ULS.sendTraceTag(537155460,0,50,"LineageTeachingCalloutTriggerManager is initialized.")}function xa(mc){var Rc=Id.call(this)||
this;Rc.Bi=null;Rc.gh=null;Rc.$=mc;Rc.Xb();return Rc}function Gb(mc,Rc,nd){var Td=xd.call(this,mc)||this;Td.te=null;Td.uDe=null;Td.OFb=null;Td.Psd=!0;Td.Wr=0;Td.Tp=!1;Td.rd=function(Fe,fe){fe.Vg||Td.N3c()};Td.kk=function(){Td.N3c();return!0};Td.$=Rc;Td.taskPaneManager=nd;Td.$.Gl(Td.rd);id.a(Td.$).Xg(Td);Ve.a.Md(Td.$)&&(Td.isVisible=!1);return Td}function $b(mc){var Rc=dc.call(this)||this;Rc.lineageTaskPane=null;Rc.n8=null;Rc.$=mc;Rc.Xb();return Rc}function oa(mc,Rc,nd,Td){var Fe=this;this.yvb=this.cG=
null;this.KE=this.zwd=0;this.OFb=function(){Fe.n8&&(Fe.n8.stop(),Fe.n8=null);Fe.TMb.start();Fe.cG.createLineagePane(Fe.uwd,Fe.yvb)};this.lineageOpenPaneOrChangeFilterRequest=function(fe,ef){function If(dg,qf,$g){var nf=Fe.$.na.ta,Qe=rf;dg=rd.b(dg,Fe.zid("LineageOpenPaneOrChangeFilter"));qf=rd.a(qf,Ke);var fh=nf.Ma(1,null);fh.clientParams=ng;fh.lineageFilter=Qe;return pd.i(nf,"LineageOpenPaneOrChangeFilter",fh,dg,qf,$g,null,0)}function Ke(dg){dg=Jf.a.mg(dg.data);hb.ULS.sendTraceTag(537155481,0,50,
"LineageManager::LineageOpenPaneOrChangeFilter service call failed. Errors: [{0}]",Pc.a.Wc(dg))}Fe.TMb.stop();ge.b(Fe.$).he(zc.a.vTi,{});Fe.gHj();var ng=Object.assign(new lb,{ClientViewCapacity:fe.clientViewCapacity}),rf=null;ef&&(rf=Object.assign(new Cb,{FilterSheetMultiRange:Fe.wRj(ef.filterSheetMultiRange)}));Zd.EwaSettings.uc()?Fe.$.userOperationManager.jc(new pe.a(1010,0,If,80),null):Fe.$.userOperationManager.jc(new Xe.a(1010,0,If,16),null)};this.lineageLoadMoreRequest=function(fe){function ef(Ke,
ng,rf){var dg=Fe.$.na.ta;Ke=rd.b(Ke,Fe.zid("LineageLoadMore"));ng=rd.a(ng,If);var qf=dg.Ma(1,null);qf.fetchFromBelow=fe;return pd.i(dg,"LineageLoadMore",qf,Ke,ng,rf,null,0)}function If(Ke){Ke=Jf.a.mg(Ke.data);hb.ULS.sendTraceTag(537155480,0,50,"LineageManager::LineageLoadMore service call failed. Errors: [{0}]",Pc.a.Wc(Ke))}ge.b(Fe.$).he(zc.a.uTi,{});Zd.EwaSettings.uc()?Fe.$.userOperationManager.jc(new pe.a(1011,0,ef,80),null):Fe.$.userOperationManager.jc(new Xe.a(1011,0,ef,16),null)};this.lineageRefreshViewRequest=
function(){function fe(If,Ke,ng){var rf=Fe.$.na.ta;If=rd.b(If,Fe.zid("LineageRefreshView"));Ke=rd.a(Ke,ef);var dg=rf.Ma(1,null);return pd.i(rf,"LineageRefreshView",dg,If,Ke,ng,null,0)}function ef(If){If=Jf.a.mg(If.data);hb.ULS.sendTraceTag(537155479,0,50,"LineageManager::LineageRefreshView service call failed. Errors: [{0}]",Pc.a.Wc(If))}ge.b(Fe.$).he(zc.a.wTi,{});Zd.EwaSettings.uc()?Fe.$.userOperationManager.jc(new pe.a(1012,0,fe,80),null):Fe.$.userOperationManager.jc(new Xe.a(1012,0,fe,16),null)};
this.lineageUpdateViewRequest=function(){wc(Fe.$.na.ta,function(fe){if(fe=$c.a(fe)?null:fe.Result){var ef={};ef=(ef.CountOfUpdatedActivities=fe.LineageActivitiesResponse.ActivityList.length,ef);ge.b(Fe.$).he(zc.a.xTi,ef);fe=Object.assign(new Da,{activityList:Fe.JId(fe.LineageActivitiesResponse.ActivityList),latestActivityId:fe.LineageActivitiesResponse.LastSearchedActivityId,oldestActivityId:fe.LineageActivitiesResponse.FirstSearchedActivityId,serverMessageCode:fe.LineageActivitiesResponse.LineageResponseCode,
lastSearchedActivityTimestamp:new Date(fe.LineageActivitiesResponse.EcmaLastSearchedDate),hasNewActivities:fe.HasNewActivities,filterSheetMultiRange:Fe.mRj(fe.LineageActivitiesResponse.FilterSheetMultiRange),serverFirstActivityId:fe.LineageActivitiesResponse.ServerFirstActivityId,serverLastActivityId:fe.LineageActivitiesResponse.ServerLastActivityId,showLoadPrevious:fe.LineageActivitiesResponse.ShowLoadPrevious,eolCorrelationId:fe.LineageActivitiesResponse.EolCorrelationId,eolDateHideHistory:new Date(fe.LineageActivitiesResponse.EolDateHideHistory),
eolPersonHideHistory:Fe.Dxb(fe.LineageActivitiesResponse.EolPersonHideHistory)});Fe.cG.onLineageActivitiesUpdateResponse(fe)}else hb.ULS.shipAssertTag(537155475,0,!!fe,"LineageManager.LineageUpdateView returned null response.")},function(fe){fe=Jf.a.mg(fe.data);hb.ULS.sendTraceTag(537155474,0,50,"LineageManager::LineageUpdateView service call failed. Errors: [{0}]",Pc.a.Wc(fe))},null,null)};this.onCardSelected=function(fe,ef){if(fe=fe.rangeHighlightLocation){if(ef){var If=$e.Z(ef,null);var Ke=If.range;
if(If.returnValue){Fe.Jbf(fe.sheetName,Fe.Kxb([$e.j(Ke)]));return}hb.ULS.shipAssertTag(537155472,0,!1,"The produced subCellLocation string "+ef+" is not valid.")}fe.rangeList.length?Fe.Jbf(fe.sheetName,fe.rangeList):Fe.tbi(fe.sheetName)}};this.onLearnMoreLinkClicked=function(){if(Zd.EwaSettings.isChangeGateEnabled("OfficeVSO:4597686_LineageLearnMoreLinkEnabled")){var fe=new Sc.a(-859308420,zd.a.$b,Fe.$.jd,12,null),ef={};ef=(ef[zd.a.Gg]="HelpID=XLO_LineageTS",ef.InputMethod=zd.a.$b,ef[zd.a.od]=De.a.oW,
ef.ShouldCanvasTakeFocus=!0,ef);Fe.$.Ka.dc(fe,ef)}};this.onVersionHistoryButtonClicked=function(fe){Fe.$.Ka.dc(new Sc.a(-1112508866,fe,Fe.$.jd,12,null))};this.isFeatureEnabled=function(){return!1};this.Tf=function(){var fe=Fe.$.ea.Pm.LineageVersion;fe!==Fe.zwd&&(hb.ULS.sendTraceTag(537155470,0,50,"LineageManager.OnWorkbookMetadataChanged: lineageVersion: {0}, this.lineageVersion: {1}",fe,Fe.zwd),Fe.zwd=fe,Fe.Nbj())};this.fd=function(fe,ef){Fe.cG&&!Fe.lineageTaskPane.Sic&&ef.gI&&(hb.ULS.sendTraceTag(587220563,
0,15,"LineageManager::SessionIdChanged detected."),Fe.onStaleActivitiesDetected())};this.Yq=function(){Fe.cG&&!Fe.lineageTaskPane.Sic&&(hb.ULS.sendTraceTag(587220562,0,15,"LineageManager::LoadOnDemandOccurred detected."),Fe.onStaleActivitiesDetected())};this.zD=function(){var fe=Fe.K5a();Fe.cG.onFilterableSheetListChange(fe)};this.Tza=function(){var fe=Fe.K5a();Fe.cG.onFilterableSheetListChange(fe)};this.Aqc=function(){var fe=Fe.K5a();Fe.cG.onFilterableSheetListChange(fe)};this.onPaneClosed=function(){Fe.cG.onPaneClosed();
Rb(Fe.$.na.ta,null,function(fe){fe=Jf.a.mg(fe.data);hb.ULS.sendTraceTag(537155469,0,50,"LineageManager::OnLineageClosePaneFailed service call failed. Errors: [{0}]",Pc.a.Wc(fe))},null,null)};this.onRangeFilterInputEnabled=function(fe){fe?Fe.gridView.ga.pZ(Fe.ld):Fe.gridView.ga.P7(Fe.ld)};this.ld=function(){var fe=$e.q(Fe.gridView.ga.va.activeRange,Fe.$);fe=Object.assign(new gb,{rangeList:Fe.Kxb(fe.Ranges),sheetName:fe.SheetName});Fe.cG.onSelectedRangeUpdated(fe)};this.tryParseRangeInfo=function(fe){var ef=
$e.Z(fe,Fe.$.xa);var If=ef.sheetName;fe=ef.range;return ef.returnValue?(If||(If=Fe.$.xa.oa.sheetName),ef=[],ef.push(fe),fe=$e.u(If,null,ef),Object.assign(new gb,{rangeList:Fe.Kxb(fe.Ranges),sheetName:fe.SheetName})):null};this.$z=function(){var fe=Fe.KE!==Fe.$.ea.af;Fe.cG&&Fe.lineageTaskPane.isVisible&&fe&&(Fe.KE=Fe.$.ea.af,Fe.cG.onRefreshRequired())};this.$=mc;Rc.Ha(366,this);this.gridView=te.g(this.$);this.lineageTaskPane=nd;this.uwd=this.lineageTaskPane.nN();this.batchSize=50;this.n8=Td;this.TMb=
this.$.Sb.Kh("UserAction","LineagePaneLoadingShimmerStopWatch");this.$sc=kf.a.instance.resolve("Common.App.People.IUserProfilePictureUtils");this.Yfi();this.ZEg()}function Ma(){this.hasOldValue=this.hasNewValue=!1;this.cellLocation=this.oldValue=this.newValue=null}function Za(){this.activityId=0;this.displayTimestamp=this.author=this.activityGuid=null;this.activityType=0;this.rangeHighlightLocation=this.isBulkEditOverflow=this.valueChanges=this.gridLocation=this.sheetName=this.nestedActivityList=
null;this.degradedCardTypeBits=0}function gb(){this.sheetName=this.rangeList=null}function zb(){this.lastCol=this.firstCol=this.lastRow=this.firstRow=0}function nb(){this.logger=this.uiCulture=this.dataCulture=null;this.clientBatchSize=0;this.lineageAppCallbacks=this.filterableSheetList=null}function pa(){this.imageUrl=this.email=this.displayName=this.provider=this.id=null}function Ja(){this.onLearnMoreLinkClicked=this.isFeatureEnabled=this.onRangeFilterInputEnabled=this.tryParseRangeInfo=this.onVersionHistoryButtonClicked=
this.onCardSelected=this.lineageUpdateViewRequest=this.lineageRefreshViewRequest=this.lineageLoadMoreRequest=this.lineageOpenPaneOrChangeFilterRequest=null}function Da(){var mc=ib.call(this)||this;mc.hasNewActivities=!1;mc.filterSheetMultiRange=null;return mc}function ib(){this.activityList=null;this.oldestActivityId=this.latestActivityId=0;this.lastSearchedActivityTimestamp=null;this.serverLastActivityId=this.serverFirstActivityId=this.serverMessageCode=0;this.docId=null;this.showLoadPrevious=!1;
this.eolPersonHideHistory=this.eolDateHideHistory=this.eolCorrelationId=null}function Rb(mc,Rc,nd,Td,Fe,fe){fe=mc.Ma(1,void 0===fe?null:fe);return pd.i(mc,"LineageClosePane",fe,Rc,nd,Td,Fe,0)}function wc(mc,Rc,nd,Td,Fe,fe){fe=mc.Ma(1,void 0===fe?null:fe);return pd.i(mc,"LineageUpdateView",fe,Rc,nd,Td,Fe,0)}function Cb(){}function lb(){}function yb(mc){var Rc=ae.call(this)||this;Rc.$=mc;Rc.Xb();return Rc}function pc(mc){this.$eb=!0;pc.fgf()?pc.ngf()?(hb.ULS.sendTraceTag(526434368,0,50,"LineageCatchUpExperimentManager is running in hybrid mode. TUI exhausted: {0}",
!mc),this.$eb=mc):this.$eb=!1:this.$eb=!0}function Ta(mc){return Od.call(this,mc)||this}function rb(mc,Rc){this.$=mc;this.lineageManager=Rc;mc=[new we.a(mb.a.wwd,1038647878,0,0,2176),new we.a(mb.a.idle,1038647878,0,1)];La.a(this.$).XKd(new Bc.a(mb.a.vwd,mb.a.idle,mc),new ic(mb.a.wwd,mb.a.idle,Rc))}function ic(mc,Rc,nd){mc=je.call(this,mc,Rc)||this;mc.lineageManager=nd;return mc}function Va(mc){var Rc=zf.call(this)||this;Rc.$=mc;Rc.Xb();return Rc}function jb(mc){return He.call(this,mc)||this}function rc(mc){var Rc=
this;this.baseVersionInfo=this.q4=this.Ypa=this.xm=this.ewaAccessibilityManager=this.jPb=null;this.rLd=this.dwf=!1;this.zJe=!0;this.dialog=this.eC=this.gYe=this.ZD=this.c2d=this.a2d=this.b2d=null;this.VFf=function(nd){hb.ULS.sendTraceTag(42553885,0,50,"VersionHistoryPaneActor:OnRestoreVersionSelected - Restore is triggered");if(Rc.ZDj()){var Td=function(fe){xb.c(2138207060,!1);Rc.xm.setRestoreFailedAtServer(fe)};Rc.ZD&&Rc.ZD.startTimer(rc.Jcg);var Fe=function(){Rc.ZD.endTimer(rc.Jcg);Rc.LAe(Rc.ZD)};
Rc.xm.setRestoreInProgress();ie.a(Rc.$).Jt(new vd.a(mb.a.Hz,5,function(){var fe=La.a(Rc.$).ud.activityState;fe[$d.a.tr]=mb.a.EDe;fe[Cd.a.lZ]=!0;fe[Cd.a.zU]=0;fe[ma.Mjg]=nd;fe[ma.htc]=db.AFrameworkApplication.uj;fe[ma.Mxd]=Fe;fe[T.z8f]=Td}))}else xb.c(2138207060,!1)};this.EIf=function(nd){Rc.jPb.then(function(Td){Td.enterFocusTrapZone();return null});hb.ULS.sendTraceTag(537150349,0,50,"VersionHistoryPaneActor: OnVersionsReady called");Rc.ZD.endTimer(rc.JYd);Rc.ZD.incrementCounter(rc.d8g);hb.ULS.sendTraceTag(537150348,
0,50,"VersionHistoryPaneActor: OnVersionsReady TimeTakenGetVersionsToOnVersionsReady Ms:{0}",Rc.ZD.getTimerDuration(rc.JYd));Rc.mlj(nd.containerDiv);nd.versions&&0<nd.versions.length&&(Rc.gYe=rc.MF(nd.versions[nd.versions.length-1]));Rc.q4&&Rc.Ypa&&Rc.vQd(Rc.q4);hb.ULS.sendTraceTag(537150346,0,50,"VersionHistoryPaneActor:OnVersionsReady Exit")};this.onVersionSelected=function(nd){hb.ULS.sendTraceTag(537150345,0,50,"VersionHistoryPaneActor:OnVersionSelected called. for Version:{0}, LastSelected:{1}",
rc.MF(nd.currentVersion),rc.MF(Rc.q4));Rc.ZD.incrementCounter(rc.c8g);Rc.q4=nd.currentVersion;Rc.baseVersionInfo=nd.baseVersion;Rc.dwf=nd.noBaseToCompareTo;Rc.Ypa&&Rc.Q_j()&&(Rc.vQd(nd.currentVersion),hb.ULS.sendTraceTag(537150344,0,50,"VersionHistoryPaneActor:OnVersionSelected Exit"))};this.DAf=function(nd){hb.ULS.sendTraceTag(537150337,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady called. for Version:{0} UpdatedVersionsCount{1}, LastSelected:{2}",(null===nd||void 0===nd?0:nd.versionSelected)?
rc.MF(nd.versionSelected.currentVersion):null,(null===nd||void 0===nd?0:nd.updatedVersions)?nd.updatedVersions.length:0,rc.MF(Rc.q4));Rc.ZD.incrementCounter(rc.b8g);if(Rc.baseVersionInfo){if((null===nd||void 0===nd?0:nd.updatedVersions)&&2<=nd.updatedVersions.length){var Td=null,Fe=null,fe=rc.MF(Rc.q4),ef=rc.MF(Rc.baseVersionInfo);nd=Cl(nd.updatedVersions);for(var If=nd.next();!If.done;If=nd.next()){If=If.value;var Ke=rc.MF(If);fe===Ke?Td=If:ef===Ke&&(Fe=If);if(Td&&Fe)break}Td&&Fe?(Rc.q4=Td,Rc.baseVersionInfo=
Fe,hb.ULS.sendTraceTag(537150307,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady -Calling versionsViewController:OnVersionSelected RevisionID[N]: {0}, RevisionID[N-1]: {1}.",rc.MF(Rc.q4),rc.MF(Rc.baseVersionInfo)),Rc.vQd(Rc.q4)):hb.ULS.sendTraceTag(537150306,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady - does not find currentVersion or baseVersion from UpdatedVersions. RevisionID[N]: {0}, RevisionID[N-1]: {1}.",fe,ef)}else hb.ULS.sendTraceTag(537150305,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady - no diff call due to downloadTokenReadyObject or downloadTokenReadyObject.UpdatedVersions objects are null or not enough.");
hb.ULS.sendTraceTag(537150304,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady")}else hb.ULS.sendTraceTag(537150336,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady baseVersionInfo is null in OnDownloadTokenReady callback.")};this.Dzf=function(){hb.ULS.sendTraceTag(537150303,0,50,"VersionHistoryPaneActor:OnCloseVersionHistoryDialog Called");Rc.O2g();var nd=new Sc.a(1470556788,0,Rc.$.jd,0,null);Rc.$.Ka.dc(nd)};this.lGf=function(nd){hb.ULS.sendTraceTag(41739662,0,50,"VersionHistoryPaneActor:OnSaveACopy Called");
var Td=new Sc.a(-1244760097,0,Rc.$.jd,0,null);Rc.$.dg.get(51)&&(hb.ULS.sendTraceTag(537150301,0,50,"VersionHistoryPaneActor:OnSaveACopy for ODConsumer Called"),Td=new Sc.a(-309686558,0,Rc.$.jd,0,null));xb.c(1604651619,!0);var Fe={};Rc.$.Ka.dc(Td,(Fe.FileDownloadUrl=nd,Fe))};this.EAf=function(nd){hb.ULS.sendTraceTag(537150300,0,50,"VersionHistoryPaneActor:OnDownloadVersion Called");nd=new Ac.QueryStringBuilder(nd);nd.Li("fn",db.AFrameworkApplication.fileName);hb.ULS.sendTraceTag(537150299,0,50,"VersionHistoryPaneActor:OnDownloadVersion URL Length is "+
nd.toString().length);8===Rc.$.frame.o$a(nd.toString(),!0)?(hb.ULS.sendTraceTag(587830283,0,10,"VersionHistoryPaneActor:OnDownloadVersion failed"),xb.c(1316171850,!1)):xb.c(1316171850,!0)};this.hyf=function(nd){Rc.xm.setFullAppErrorCode(nd)};this.RBf=function(nd){switch(nd){case 101:nd="VHFailedToGetDownloadToken";break;case 100:nd="VHFailedToLoadVersionList";break;case 104:nd="VHVersioningNotEnabled";break;case 105:nd="VHFileNotFound";break;case 106:nd="VHVersionTooOld";break;default:nd="None"}Rc.ZD.addEvent("OnFullAppError",
nd);hb.ULS.sendTraceTag(537150291,0,10,"FullApp Error Event: {0}",nd)};this.$Ed=function(nd){Rc.zJe=nd;hb.ULS.sendTraceTag(537150290,0,50,"VersionHistoryPaneActor:Show Changes toggled to:{0}",nd.toString());var Td={};Rc.TQd(Lb.a.NOb,(Td.ToggleValue=nd,Td))};this.iDf=function(nd){hb.ULS.sendTraceTag(50405840,0,50,"VersionHistoryPaneActor:OnIteratorSelected next: {0}",nd);xb.c(1488635506,!0);var Td={};nd?Rc.TQd(Lb.a.iterateNext,Td):Rc.TQd(Lb.a.yya,Td)};this.vIb=function(nd){switch(nd.MessageId){case sb.a.FVa:hb.ULS.sendTraceTag(537150289,
0,50,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession WacAppCompleted ");Zd.EwaSettings.ma(427)&&Rc.xm.setVersionLoadComplete();break;case sb.a.GVa:hb.ULS.sendTraceTag(51128035,0,10,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession WacAppFailed");break;case Lb.a.setCurrentChangeCount:nd=nd.Values.count;hb.ULS.sendTraceTag(537150288,0,50,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession SetCurrentChangeCount : {0}",nd);Rc.xm.setCurrentChangeCount(nd);break;case Lb.a.setTotalChangesCount:nd=
nd.Values.count;hb.ULS.sendTraceTag(537150287,0,50,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession SetTotalChangesCount : {0}",nd);Rc.xm.setTotalChangesCount(nd);break;case Lb.a.oQa:Rc.$Ed(Rc.zJe);break;default:hb.ULS.sendTraceTag(537150286,0,15,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession MessageID:{0}",nd.MessageId)}};this.$=mc;this.L$b=this.$.Lb+rc.gDh;this.qLd=!1;Zd.EwaSettings.ma(391)&&this.leh();this.NCb="";this.Pvd=0;this.perfTelemetryInfos=[]}function Cc(){this.perfTelemetryInfos=
this.appSettings=this.docId=this.latestStreamServiceBase=this.serviceBase=this.ulsLogger=null}function Hc(){this.appName=0;this.wdEnableDownloadTokens=!1;this.retryCount=0;this.wdEnableIterator=this.wdEnableRestore=this.wdEnableSaveACopy=!1;this.uiLocale=this.wacCluster=this.userSessionId=null;this.disableSaveACopy=this.wdEnableShowVersionChanges=this.wdEnableHiddenButtonsUntilVersionLoadComplete=this.viewerRootPositionRelative=this.useXhr=this.isRtl=!1;this.disabledChangeGates=null;this.wdEnableDeleteVersions=
this.wdEnableSaveACopyOverFlowMenu=!1;this.wdExperimentWithIteratorLocation=this.wdEnableAppColorUpdate=null}function Nb(){this.telemetryCollector=this.baseVersionInfo=this.selectedVersionInfo=null}function nc(){this.rootDiv=this.appBootSettings=null}function Ha(){this.actionUrl=this.ulsLogger=null;this.useFetch=this.hideEmbedFooter=!1}function tb(mc){this.ex=mc}function Ub(mc){this.ex=mc}function gc(mc){this.ex=mc}function Eb(){}function Tb(mc,Rc){this.$=mc;this.y0j=Rc}function Wc(mc,Rc){var nd=
Zc.call(this)||this;nd.activityName=mc;nd.oN=Rc;nd.Xb();return nd}function T(mc,Rc){return Uc.call(this,mc,Rc)||this}function ua(mc,Rc,nd){var Td=ac.call(this)||this;Td.activityName=mc;Td.oN=Rc;Td.vK=nd;Td.Xb();return Td}function ma(mc,Rc,nd,Td,Fe){var fe=qb.call(this,mc,Rc)||this;fe.Ei=null;fe.retryCount=0;fe.gWi=function(ef){var If=fe.HSj(ef);ef=If.FOd;If.returnValue?ef.Success?(xb.c(2138207060,!0),hb.ULS.sendTraceTag(42287318,0,15,"RestoreVersionActivity:onRestoreSuccessCallback Restore version is successful")):
(xb.c(2138207060,!1),hb.ULS.sendTraceTag(42287317,0,10,"RestoreVersionActivity:onRestoreSuccessCallback Restore version failed with message {0}",ef.Output),fe.Dh(fe.vK)):(xb.c(2138207060,!1),fe.Dh(fe.vK));(ef=fe.Ei.activityState[ma.Mxd])&&ef();fe.Ep();fe.Ei.iK()};fe.fWi=function(){if(0<fe.retryCount)hb.ULS.sendTraceTag(537150418,0,15,"RestoreVersionActivity:onRestoreFailureCallback Retrying version restore, retry count : {0}",fe.retryCount),fe.retryCount--,fe.WXf();else{hb.ULS.sendTraceTag(42287320,
0,10,"RestoreVersionActivity:onRestoreFailureCallback Restore version failed");xb.c(2138207060,!1);fe.Dh(fe.vK);var ef=fe.Ei.activityState[ma.Mxd];ef&&ef();fe.Ep();fe.Ei.iK()}};fe.vK=nd;fe.Y3=Td;fe.baseUrl=Fe;return fe}b.r(F);var wa=b(10),Ca=b(0),db=b(4),Sa=b(224),hb=b(13),Xb=b(112),xb=b(185),Sb=b(40),qb=Xb.a;Am(ma,qb);ma.prototype.execute=function(mc){this.Ei=mc;this.retryCount=3;this.WXf();return 1};ma.prototype.WXf=function(){var mc=this.Ei.activityState[ma.htc],Rc=this.Ei.activityState[ma.Mjg],
nd=String.format("{0}{1}",this.baseUrl,"restoreversion.ashx");mc=Sb.c({VersionId:Rc,QuerySignature:mc});this.Y3.jm(nd,2,mc,{"Content-Type":"application/json; charset=utf-8"},!1,2,this.gWi,this.fWi,null)};ma.prototype.HSj=function(mc){var Rc=null;mc=mc?mc.data?mc.data.oe:null:null;if(!mc||!mc.length)return hb.ULS.sendTraceTag(537150417,0,10,"RestoreVersionActivity:TryGetRestoreResult data returned from restoreversion call is null or empty"),{returnValue:!1,FOd:Rc};mc=Sb.d(mc);Rc=mc.ev;return mc.returnValue?
{returnValue:!0,FOd:Rc}:(hb.ULS.sendTraceTag(537150416,0,10,"RestoreVersionActivity:TryGetRestoreResult Failed in deserialization of returned data from restore version"),{returnValue:!1,FOd:Rc})};ma.Mjg="RVAvi";ma.htc="RVAqs";ma.Mxd="RVlvrt";Object(Ca.a)(ma,"RestoreVersionActivity",Xb.a,[]);var mb=b(6),ac=Sa.a;Am(ua,ac);ua.prototype.create=function(){this.Eb(new ma(this.activityName,this.oN,this.vK,db.AFrameworkApplication.Ld,db.AFrameworkApplication.sa.Qa.ZW))};ua.ka=function(mc){mc.da.Ha(320,new ua(mb.a.IOd,
mb.a.Aj,mb.a.JOd))};Object(Ca.a)(ua,"RestoreVersionActivityFactory",Sa.a,[]);var Uc=Xb.a;Am(T,Uc);T.prototype.execute=function(mc){var Rc=this;(0,mc.activityState[T.z8f])(function(){Rc.Ep();mc.iK()});return 1};T.z8f="RVEAssea";Object(Ca.a)(T,"RestoreVersionErrorActivity",Xb.a,[]);var Zc=Sa.a;Am(Wc,Zc);Wc.prototype.create=function(){this.Eb(new T(this.activityName,this.oN))};Wc.ka=function(mc){mc.da.Ha(321,new Wc(mb.a.JOd,mb.a.Aj))};Object(Ca.a)(Wc,"RestoreVersionErrorActivityFactory",Sa.a,[]);var Kc=
b(79),va=b(905),fb=b(51),Pb=b(35),sc=b(184),hd=b(389),Ob=b(53);Tb.prototype.$c=function(){return db.AFrameworkApplication.ha.ra("IsAnonymousUser")?(hb.ULS.sendTraceTag(537150415,0,15,"Verison History Command Handler: Anonymous user."),!0):!1};Tb.prototype.executeCommand=function(mc,Rc){hb.ULS.sendTraceTag(537150414,0,50,"VersionHistoryCommandHandler:ExecuteCommand called.");mc=!1;switch(Rc.command){case -1112508866:hd.a(this.$)&&this.$.da.Aa(423).$zc(!1),mc=this.y0j.sHj()}hb.ULS.sendTraceTag(537150413,
0,50,"VersionHistoryCommandHandler:ExecuteCommand response{0}.",mc);return mc?Ob.Task.Sa(mc):sc.a(Rc.command)};Tb.prototype.Mc=function(mc,Rc){return-1112508866===Rc.command&&this.$.isVersionHistoryEnabled()};Tb.prototype.nd=function(){return!1};Object(Ca.a)(Tb,"VersionHistoryCommandHandler",null,[434]);var Ac=b(292),sb=b(166),ad=b(408),Hd=b(23);Eb.addAppPLTEventToLog=function(mc){try{Microsoft.VersionHistory.VersionHistoryLogHelper.addAppPLTEventToLog(mc)}catch(Rc){}};Eb.setIsPageLoadForFirstTime=
function(mc){try{Microsoft.VersionHistory.VersionHistoryLogHelper.setIsPageLoadForFirstTime(mc)}catch(Rc){}};Object(Ca.a)(Eb,"VersionHistoryLogConnector",null,[]);var Ne=b(1036),Ud=b(1318),Ge=b(158),Sc=b(95),Pc=b(29),Zd=b(1),ie=b(42),vd=b(256),Lb=b(1206),id=b(269),uc=b(253),ed=b(11);gc.prototype.Xg=function(){id.a(this.ex.$).NN(this.de)||id.a(this.ex.$).Xg(this)};gc.prototype.Q8=function(){id.a(this.ex.$).NN(this.de)&&id.a(this.ex.$).eA(this)};gc.prototype.eg=function(mc){return ed.DOMElementExtensions.Se(this.Kb,
mc)};gc.prototype.ji=function(){this.ex.$.frame.Ue.mk(this.ex.$.frame.Ue.rF)};gc.prototype.Xh=function(){};gc.prototype.Qe=function(mc,Rc){Rc||this.ex.jPb.then(function(nd){nd.enterHeaderFocusTrapZone();return null});return!Rc};uk.Object.defineProperties(gc.prototype,{de:{configurable:!0,enumerable:!0,get:function(){return uc.a.Jjg}},Kb:{configurable:!0,enumerable:!0,get:function(){return document.querySelector('[id="vhHeader"]')}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!0}}});
Object(Ca.a)(gc,"VersionHistoryHeader",null,[451]);Ub.prototype.Xg=function(){id.a(this.ex.$).NN(this.de)||id.a(this.ex.$).Xg(this)};Ub.prototype.Q8=function(){id.a(this.ex.$).NN(this.de)&&id.a(this.ex.$).eA(this)};Ub.prototype.eg=function(mc){return ed.DOMElementExtensions.Se(this.Kb,mc)};Ub.prototype.ji=function(){this.ex.$.frame.Ue.mk(this.ex.$.frame.Ue.rF)};Ub.prototype.Xh=function(){};Ub.prototype.Qe=function(mc,Rc){Rc||this.ex.jPb.then(function(nd){nd.enterFocusTrapZone();return null});return!Rc};
uk.Object.defineProperties(Ub.prototype,{de:{configurable:!0,enumerable:!0,get:function(){return uc.a.Kjg}},Kb:{configurable:!0,enumerable:!0,get:function(){return document.querySelector('[aria-describedby="versionHistoryPane"]')}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object(Ca.a)(Ub,"VersionHistoryPane",null,[451]);tb.prototype.Xg=function(){id.a(this.ex.$).NN(this.de)||id.a(this.ex.$).Xg(this)};tb.prototype.Q8=function(){id.a(this.ex.$).NN(this.de)&&id.a(this.ex.$).eA(this)};
tb.prototype.eg=function(mc){return ed.DOMElementExtensions.Se(this.Kb,mc)};tb.prototype.ji=function(){this.ex.$.frame.Ue.mk(this.ex.$.frame.Ue.rF)};tb.prototype.Xh=function(){};tb.prototype.Qe=function(mc,Rc){Rc||this.ex.jPb.then(function(nd){nd.enterViewerFocusTrapZone();return null});return!Rc};uk.Object.defineProperties(tb.prototype,{de:{configurable:!0,enumerable:!0,get:function(){return uc.a.Ljg}},Kb:{configurable:!0,enumerable:!0,get:function(){return document.querySelector('[id="vhViewer"]')}},
canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object(Ca.a)(tb,"VersionHistoryViewer",null,[451]);var Cd=b(146),$d=b(258),La=b(65),od=b(443),ne=b(971);Object(Ca.a)(Ha,"AppBootSettings",null,[]);Object(Ca.a)(nc,"AppVersionControllerFactoryParameters",null,[]);Object(Ca.a)(Nb,"OnVersionSelectedParams",null,[]);Object(Ca.a)(Hc,"AppSettings",null,[]);Object(Ca.a)(Cc,"ControllerFactoryParameters",null,[]);rc.prototype.dispose=function(){this.sCe()};rc.prototype.e4i=function(){var mc=
this;this.$.da.Ya(15,function(Rc){mc.ewaAccessibilityManager=Rc;mc.ewaAccessibilityManager.mode=2})};rc.prototype.leh=function(){this.b2d=new Ub(this);this.a2d=new gc(this);this.c2d=new tb(this)};rc.prototype.sHj=function(){var mc=this;hb.ULS.sendTraceTag(41739649,0,15,"VersionHistoryPaneActor:ShowVersionHistoryDialogAction called");db.AFrameworkApplication.kO("Microsoft.Office.Excel.Server.Flighting.IDenyListExcelVersionHistoryEnableODCSaveACopy");db.AFrameworkApplication.kO("Microsoft.Office.Excel.Server.Flighting.IDenyListVersionHistorySaveACopyOverFlowMenu");
db.AFrameworkApplication.kO("Microsoft.Office.Excel.Server.Flighting.IDenyListExcelVersionHistoryRestoreSkipCoauthCheck");this.ZD=excelVersionHistory.FactoryGlobal.getTelemetryCollector();this.perfTelemetryInfos=[];this.ZD.startTimer(rc.Icg);if(!this.xm&&(od.a(function(){mc.xm=versionHistory.FactoryGlobal.getVersionHistoryControllerInstance(Object.assign(new Cc,{ulsLogger:new ad.a,docId:db.AFrameworkApplication.uj,appSettings:Object.assign(new Hc,{appName:120,userSessionId:db.AFrameworkApplication.userSessionId,
wdEnableSaveACopy:Zd.EwaSettings.ma(359),wdEnableDownloadTokens:Zd.EwaSettings.ma(354),wacCluster:db.AFrameworkApplication.Ld.yT,uiLocale:db.AFrameworkApplication.uiCulture||"en-us",wdEnableRestore:Zd.EwaSettings.ma(325)&&mc.$.isEditMode,wdEnableIterator:Zd.EwaSettings.ma(322)&&Zd.EwaSettings.ma(323),useXhr:Hd.a.YN,wdEnableHiddenButtonsUntilVersionLoadComplete:Zd.EwaSettings.ma(427),disableSaveACopy:mc.a6f(),wdEnableShowVersionChanges:Zd.EwaSettings.ma(322)&&Zd.EwaSettings.ma(324),disabledChangeGates:mc.$.ya.VHSDisabledChangeGates,
wdEnableSaveACopyOverFlowMenu:Zd.EwaSettings.ma(559),isRtl:db.AFrameworkApplication.isRtl}),perfTelemetryInfos:mc.perfTelemetryInfos}))}),!this.xm))return hb.ULS.sendTraceTag(537150352,0,10,"VersionHistoryPaneActor:ShowVersionHistoryDialogAction - VersionHistoryController should not be null"),xb.c(429638140,!1),!1;this.tHj();this.ZD.endTimer(rc.Icg);this.ZD.startTimer(rc.Lcg);hb.ULS.sendTraceTag(537150351,0,50,"VersionHistoryPaneActor:ShowVersionHistoryDialogAction Returned Success");xb.c(429638140,
!0);return!0};rc.prototype.tHj=function(){this.Ik();if(!document.getElementById(this.L$b)){var mc=document.createElement("div");mc.id=this.L$b;mc.style.width="100%";mc.style.zIndex="998";mc.style.display="block";mc.style.position="absolute";db.AFrameworkApplication.sa.Qa.eh?(mc.style.top=document.getElementById("HeaderRegion").offsetHeight+"px",mc.style.bottom="0px"):mc.style.height="100%";this.$.zr.insertBefore(mc,this.$.zr.firstChild);this.jPb=this.xm.createVersionHistoryDialog(mc)}document.getElementById(this.L$b).style.display=
"block";this.iLd();this.ZD.startTimer(rc.JYd);this.xm.getVersions("")};rc.prototype.iLd=function(){Zd.EwaSettings.ma(391)&&(this.b2d.Xg(),this.a2d.Xg(),this.c2d.Xg(),this.e4i())};rc.prototype.S_d=function(){Zd.EwaSettings.ma(391)&&(this.b2d.Q8(),this.a2d.Q8(),this.c2d.Q8(),this.ewaAccessibilityManager&&(this.ewaAccessibilityManager.mode=0))};rc.prototype.Ik=function(){this.xm.getVersionsReadyEvent().addListener(this.EIf);this.xm.getVersionSelectedEvent().addListener(this.onVersionSelected);this.xm.getCloseSelectedEvent().addListener(this.Dzf);
this.xm.getFullAppErrorEvent().addListener(this.RBf);this.xm.getIteratorSelectedEvent().addListener(this.iDf);this.xm.getShowVersionChangesToggledEvent().addListener(this.$Ed);Zd.EwaSettings.ma(354)&&(this.xm.getDownloadTokenReadyEvent().addListener(this.DAf),this.qLd=!0);Zd.EwaSettings.ma(359)&&(this.xm.getSaveACopySelectedEvent().addListener(this.lGf),this.xm.getDownloadVersionSelectedEvent().addListener(this.EAf));Zd.EwaSettings.ma(325)&&this.$.isEditMode&&(this.xm.getRestoreVersionSelectedEvent().addListener(this.VFf),
this.rLd=!0);this.Ypa&&this.Ypa.getAppErrorEvent().addListener(this.hyf)};rc.prototype.wm=function(){this.xm.getVersionsReadyEvent().removeListener(this.EIf);this.xm.getVersionSelectedEvent().removeListener(this.onVersionSelected);this.xm.getCloseSelectedEvent().removeListener(this.Dzf);this.xm.getFullAppErrorEvent().removeListener(this.RBf);this.xm.getIteratorSelectedEvent().removeListener(this.iDf);this.xm.getShowVersionChangesToggledEvent().removeListener(this.$Ed);Zd.EwaSettings.ma(359)&&(this.xm.getSaveACopySelectedEvent().removeListener(this.lGf),
this.xm.getDownloadVersionSelectedEvent().removeListener(this.EAf));this.qLd&&(this.xm.getDownloadTokenReadyEvent().removeListener(this.DAf),this.qLd=!1);this.rLd&&(this.xm.getRestoreVersionSelectedEvent().removeListener(this.VFf),this.rLd=!1);this.Ypa&&this.Ypa.getAppErrorEvent().removeListener(this.hyf)};rc.prototype.ZDj=function(){var mc=!0;if(Zd.EwaSettings.ma(625)&&!this.$.aS)return hb.ULS.sendTraceTag(537150350,0,15,"VersionHistoryPaneActor:ShouldTriggerRestore - Skipping coauth check with status "+
this.$.ea.amIAlone.toString()),!0;if(!this.$.ea.amIAlone&&!Zd.EwaSettings.ma(321)){this.$yi();this.xm.setCoauthRestoreError();mc=!1;var Rc=new Sc.a(-729359593,0,this.$.jd,0,null);this.$.Ka.dc(Rc)}this.$.aS&&(hb.ULS.sendTraceTag(42522439,0,10,"VersionHistoryPaneActor:ShouldTriggerRestore - Restore failed, Unsaved changes present"),mc&&(mc=!1,this.rHj()));return mc};rc.prototype.rHj=function(){var mc=Pc.a.ed(1,0,1851,1850,0,-1603358883,"RestoreVersionUnsavedChangesError");mc=this.dialog||new Ge.ErrorDialog(this.$,
mc);mc.initialize();mc.pf()};rc.prototype.Q_j=function(){hb.ULS.sendTraceTag(537150343,0,50,"VersionHistoryPaneActor:ValidateDiffDiffParameters called for BaseVersion{0}",this.baseVersionInfo?rc.MF(this.baseVersionInfo):"");if(rc.MF(this.q4)===this.gYe)return hb.ULS.sendTraceTag(537150342,0,15,"VersionHistoryPaneActor:ValidateDiffDiffParameters for last version"),!0;if(Zd.EwaSettings.isChangeGateEnabled("OfficeVSO:4381797_XLVHSkipBaseVersionValidateForGroupingUI")&&!this.baseVersionInfo&&this.dwf)return hb.ULS.sendTraceTag(537150341,
0,50,"VersionHistoryPaneActor:ValidateDiffDiffParameters skipping diff last version"),!0;if(!this.baseVersionInfo)return hb.ULS.sendTraceTag(537150340,0,10,"VersionHistoryPaneActor:ValidateDiffDiffParameters for null BaseVersion"),!1;var mc=rc.rTh(this.baseVersionInfo);hb.ULS.sendTraceTag(537150339,0,50,"downloadURL length {0}",mc?mc.length:0);return mc?!0:(hb.ULS.sendTraceTag(537150338,0,50,"VersionHistoryPaneActor:ValidateDiffDiffParameters downloadURL is null"),!1)};rc.prototype.a6f=function(){return!this.$.Dla};
rc.prototype.O2g=function(){document.getElementById(this.L$b).style.display="none";var mc=new Sc.a(-1423792966,0,this.$.jd,0,null);this.$.Ka.dc(mc);this.sCe()};rc.prototype.sCe=function(){this.ZD&&(this.ZD.endTimer(rc.Lcg),this.LAe(this.ZD),this.ZD=null);this.wm();this.S_d();this.perfTelemetryInfos&&(hb.ULS.sendTraceTag(537150302,0,15,this.perfTelemetryInfos.toString()),this.perfTelemetryInfos=null);this.eC&&(this.eC.Ipa(sb.a.FVa),this.eC.Ipa(sb.a.GVa),this.eC.Ipa(Lb.a.setCurrentChangeCount),this.eC.Ipa(Lb.a.setTotalChangesCount),
Zd.EwaSettings.isChangeGateEnabled("OfficeVSO:4844740_ExcelVersionHistoryHighlightChangesFix")&&this.eC.Ipa(Lb.a.oQa),this.eC.dispose(),this.eC=null)};rc.prototype.mlj=function(mc){var Rc=this;try{this.Ypa?Eb.setIsPageLoadForFirstTime(!1):(Eb.setIsPageLoadForFirstTime(!0),od.a(function(){var nd=new Ha;nd.ulsLogger=new ad.a;nd.actionUrl=Rc.$.ya.VersionHistoryActionUrl;nd.hideEmbedFooter=!0;nd.useFetch=Zd.EwaSettings.ma(422)&&!Hd.a.vv;Rc.Ypa=excelVersionHistory.FactoryGlobal.getAppVersionControllerInstance(Object.assign(new nc,
{appBootSettings:nd,rootDiv:mc}))}))}catch(nd){hb.ULS.sendTraceTag(41239239,0,10,"VersionHistoryPaneActor: ResetAppVersionController failed due to exception. {0}",nd)}};rc.prototype.vQd=function(mc){hb.ULS.sendTraceTag(537150298,0,50,"VersionHistoryPaneActor:SelectVersion called. for Version:{0}, LastSelected:{1}",rc.MF(mc),this.NCb);if(mc)if(rc.MF(mc).length){var Rc=(new Date).getTime();if(rc.MF(mc)===this.NCb&&1E3>Rc-this.Pvd)hb.ULS.sendTraceTag(537150295,0,50,"VersionHistoryPaneActor:SelectVersion reattempt within 1 sec");
else{rc.MF(mc)!==this.NCb&&(hb.ULS.sendTraceTag(537150294,0,50,"VersionHistoryPaneActor:Reset Iterator states if user clicks on different version"),this.xm.setTotalChangesCount(-1),this.xm.setCurrentChangeCount(-1));var nd=excelVersionHistory.FactoryGlobal.getTelemetryCollector();nd.addEvent("SelectVersion",rc.MF(mc));try{this.t2j(nd);this.Pvd=Rc;this.NCb=rc.MF(mc);var Td=new Nb;Td.selectedVersionInfo=this.q4;Td.baseVersionInfo=this.baseVersionInfo;Td.telemetryCollector=nd;this.Ypa.onVersionSelectedWithParams(Td);
this.xm&&Zd.EwaSettings.ma(359)&&this.xm.setDisableSaveACopy(this.a6f());var Fe=document.getElementById(rc.fDh);Fe&&!this.eC&&(hb.ULS.sendTraceTag(537150293,0,50,"VersionHistoryPaneActor: SelectVersion Lazy instantiate VersionHistoryMessenger"),this.eC=new Lb.a(Fe.contentWindow,Kc.a.Fba(this.$.ya.VersionHistoryActionUrl)||ne.a.L$),this.eC.Vl(sb.a.FVa,this.vIb),this.eC.Vl(sb.a.GVa,this.vIb),this.eC.mo(Lb.a.setCurrentChangeCount),this.eC.mo(Lb.a.setTotalChangesCount),Zd.EwaSettings.isChangeGateEnabled("OfficeVSO:4844740_ExcelVersionHistoryHighlightChangesFix")&&
this.eC.mo(Lb.a.oQa),this.eC.Vl(Lb.a.setCurrentChangeCount,this.vIb),this.eC.Vl(Lb.a.setTotalChangesCount,this.vIb),Zd.EwaSettings.isChangeGateEnabled("OfficeVSO:4844740_ExcelVersionHistoryHighlightChangesFix")&&this.eC.Vl(Lb.a.oQa,this.vIb))}catch(fe){this.Pvd=0,this.NCb="",nd.addEvent("Exception",fe.toString()),hb.ULS.sendTraceTag(42016832,0,10,"VersionHistoryPaneActor: OnVersionSelected failed due to exception. {0}",fe)}finally{hb.ULS.sendTraceTag(537150292,0,50,nd?nd.getJsonForLogging():"")}}}else hb.ULS.sendTraceTag(537150296,
0,50,"VersionHistoryPaneActor:SelectVersion selectedVersion RevisionId is null");else hb.ULS.sendTraceTag(537150297,0,50,"VersionHistoryPaneActor:SelectVersion selectedVersion is null")};rc.prototype.t2j=function(mc){for(var Rc=Cl(this.perfTelemetryInfos),nd=Rc.next();!nd.done;nd=Rc.next()){var Td=nd.value;nd=Td.TelemetryEventKey?Td.TelemetryEventKey:Td.telemetryEventKey?Td.telemetryEventKey:"";Td=Td.TelemetryEventData?Td.TelemetryEventData:Td.telemetryEventData?Td.telemetryEventData:"";nd&&Td&&mc.addEvent(nd,
Td)}Array.clear(this.perfTelemetryInfos)};rc.prototype.LAe=function(mc){hb.ULS.sendTraceTag(42553886,0,15,"VersionHistoryPaneActor:CaptureSessionTelemetry - {0} ",mc?mc.getJsonForLogging():"")};rc.prototype.$yi=function(){for(var mc=this.$.ea.Om,Rc={},nd=null,Td=Cl(mc),Fe=Td.next();!Fe.done;Fe=Td.next())Fe=Fe.value,Fe.UserEmail&&(Rc[Fe.UserEmail]=Fe.UserEmail in Rc?Rc[Fe.UserEmail]+1:1),Fe.User.UserID===this.$.ea.clientId&&(nd=Fe.UserEmail);hb.ULS.sendTraceTag(42522438,0,10,"VersionHistoryPaneActor:LogCoauthorsTelemetry Restore failed, TotalAuthors: {0}, TotalAuthorsAsYourself {1}",
mc.length,nd?Rc[nd]:-1)};rc.prototype.TQd=function(mc,Rc){hb.ULS.sendTraceTag(537150285,0,50,"VersionHistoryPaneActor.SendPostMessageToTheVHSession called with MessageID:{0}",mc);if(this.eC){mc=new Ne.a(mc);mc.Values[Ud.a.G7c]=this.$.ya.UserSessionId;if(Rc)for(var nd in Rc)mc.Values[nd]=Rc[nd];this.eC.send(mc)}else hb.ULS.sendTraceTag(537150284,0,10,"VersionHistoryPaneActor.SendPostMessageToTheVHSession versionHistoryMessenger is null")};rc.MF=function(mc){return mc?mc.RevisionID?mc.RevisionID:mc.revisionID?
mc.revisionID:"":""};rc.rTh=function(mc){return mc?mc.DownloadUrl?mc.DownloadUrl:mc.downloadUrl?mc.downloadUrl:"":""};rc.gDh="_excelVersionHistoryOverlay";rc.fDh="vhs_frame";rc.Icg="TimeTakenShowVersionHistoryDialogAction";rc.Lcg="TimeTillVersionHistoryDialogWasOpenMs";rc.JYd="TimeTakenGetVersionsToOnVersionsReady";rc.c8g="CountOnVersionSelectedCalledinOneVHSession";rc.d8g="CountOnVersionsReadyCalledinOneVHSession";rc.b8g="CountOnDownloadTokenReadyCalledinOneVHSession";rc.Jcg="TimeTakenVersionRestore";
Object(Ca.a)(rc,"VersionHistoryPaneActor",null,[3]);var qd=b(290),He=va.a;Am(jb,He);jb.prototype.Qd=function(){var mc=this,Rc=this.lyi(),nd=fb.GetServiceTaskFactory.Ua(this.$.da,21,137,this.ub);Pb.TaskExtensions.Ba(Pb.TaskExtensions.we([Rc,nd],this.la,3),function(){var Td=nd.result,Fe=Kc.a.Fba(mc.$.ya.VersionHistoryActionUrl);Fe!==ne.a.L$&&Td.AGa(Fe);Td=new rc(mc.$);mc.Jd([new Tb(mc.$,Td)])},this.la,3)};jb.prototype.lyi=function(){var mc=fb.GetServiceTaskFactory.Kdc(this.$.da,283,284,this.ub).then(function(Rc){return Rc.ho.loadScript("excelVersionHistory")},
function(Rc){hb.ULS.sendTraceTag(537150412,0,10,"versionHistoryManagerFactory: Dynamic Script Loading failed due to exception. {0}",Rc);return Promise.reject(Rc)});return qd.c(mc)};jb.ka=function(mc){va.a.je(304,new jb(mc))};Object(Ca.a)(jb,"VersionHistoryCommandHandlerFactory",va.a,[]);var Ue=b(1321),zf=Sa.a;Am(Va,zf);Va.prototype.create=function(){var mc=this,Rc=fb.GetServiceTaskFactory.Ua(this.$.da,211,212,this.ub),nd=fb.GetServiceTaskFactory.Ua(this.$.da,21,137,this.ub);Pb.TaskExtensions.Ba(Pb.TaskExtensions.we([Rc,
nd],this.$.la),function(){mc.Eb(mc.$.da.Aa(305)||new Ue.a(mc.$,!0,nd.result,Rc.result))},this.$.la,3)};Va.ka=function(mc){mc.da.Ha(306,new Va(mc))};Object(Ca.a)(Va,"VersionHistoryHighlightManagerFactory",Sa.a,[]);var Hf=b(556),De=b(5),Ae=b(164),yd=b(14),je=Xb.a;Am(ic,je);ic.prototype.execute=function(mc){this.lineageManager.lineageHidePreviousHistory();return je.prototype.execute.call(this,mc)};Object(Ca.a)(ic,"LineageClearHistoryConfirmedActivity",Xb.a,[]);var we=b(15),Bc=b(143);rb.prototype.$c=
function(){return!1};rb.prototype.executeCommand=function(mc,Rc,nd){mc=!1;switch(Rc.command){case 1834994092:9===Rc.ef&&this.QMj();this.NEj(Rc,nd);mc=!0;break;case -409942531:this.PEj(),mc=!0}return mc?Ob.Task.Sa(!0):sc.a(Rc.command)};rb.prototype.Mc=function(mc,Rc){return 1834994092===Rc.command||-409942531===Rc.command};rb.prototype.nd=function(){return!1};rb.prototype.NEj=function(mc,Rc){hb.ULS.sendTraceTag(537155483,0,50,"LineageActivityCommandHandler::ShowChangesCore command location: {0}",Rc.MenuItemId||
mc.ef);this.lineageManager.V7f(19===mc.ef&&!!Rc.MenuItemId,Rc.MenuItemId,mc.ef)};rb.prototype.QMj=function(){var mc=De.a.xtc;mc!==Ae.a(this.$).Um.Po&&Ae.a(this.$).Um.activateRibbonTab(mc)};rb.prototype.PEj=function(){var mc=this;ie.a(this.$).Jt(new vd.a(mb.a.vwd,5,function(){var Rc=La.a(mc.$).ud,nd=Pc.a.ed(3,1,2173,2174,2175,1038647878,"LineageConfirmClearHistory");nd.HelpTopicId="a1493bf9-25c3-470a-b970-60eceb0136e5";nd.HelpDescription=yd.a.instance.fa(1276);Rc.Wt([nd])}))};Object(Ca.a)(rb,"LineageActivityCommandHandler",
null,[434]);var Od=va.a;Am(Ta,Od);Ta.prototype.Qd=function(){var mc=this;Pb.TaskExtensions.Ba(fb.GetServiceTaskFactory.Ua(this.$.da,366,367,this.ub),function(Rc){mc.Jd([new rb(mc.$,Rc.result)])},this.la,3)};Ta.ka=function(mc){va.a.je(363,new Ta(mc))};Object(Ca.a)(Ta,"LineageActivityCommandHandlerFactory",va.a,[]);pc.prototype.V7a=function(){return!this.$eb};pc.ngf=function(){return pc.fgf()&&Zd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LineageCatchUpIntegrationTeachingUXTreatmentToControl",
!1)};pc.fgf=function(){return Zd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LineageCatchUpIntegrationSummaryStringTreatment",!1)};Object(Ca.a)(pc,"LineageCatchUpExperimentManager",null,[584]);var ae=Sa.a;Am(yb,ae);yb.prototype.create=function(){var mc=this;pc.ngf()?Pb.TaskExtensions.Ba(fb.GetServiceTaskFactory.Ua(this.$.da,456,457,this.ub),function(Rc){Pb.TaskExtensions.Ba(Rc.result.nDj(),function(nd){mc.uHe(nd.result)},mc.$.la,3)},this.$.la,3):this.uHe(!0)};yb.prototype.uHe=function(mc){this.Eb(this.$.da.Aa(458)||
this.$.da.Ha(458,new pc(mc)))};yb.ka=function(mc){mc.da.Ha(459,new yb(mc))};Object(Ca.a)(yb,"LineageCatchUpExperimentManagerFactory",Sa.a,[]);var Ad=b(438),Ve=b(39),kf=b(84),Fc=b(153),fd=b(122);Object(Ca.a)(lb,"LineageClientParams",null,[]);Object(Ca.a)(Cb,"LineageFilter",null,[]);var jd=b(62),zd=b(78),zc=b(131),$e=b(45),Xe=b(561),pe=b(173),Jf=b(118),kc=b(109),$c=b(289),rd=b(288),me=b(106),te=b(20),ge=b(132),pd=b(83),jc=b(49),jf=b(354);Object(Ca.a)(ib,"LineageActivitiesResponseDTO",null,[]);Am(Da,
ib);Object(Ca.a)(Da,"LineageActivitiesUpdateResponseDTO",ib,[]);Object(Ca.a)(Ja,"LineageAppCallbacks",null,[]);Object(Ca.a)(pa,"LineageAuthorDTO",null,[]);Object(Ca.a)(nb,"LineageControllerFactoryParams",null,[]);Object(Ca.a)(zb,"LineageSharedRangeDTO",null,[]);Object(Ca.a)(gb,"LineageSheetMultiRangeDTO",null,[]);Object(Ca.a)(Za,"LineageUserActivityDTO",null,[]);Object(Ca.a)(Ma,"LineageValueChangeDTO",null,[]);oa.prototype.dispose=function(){this.Kej();this.$=null;this.lineageTaskPane&&(this.lineageTaskPane.WO(this.onPaneClosed),
this.lineageTaskPane.WD(this.$z),this.lineageTaskPane=null);this.TMb=this.$sc=this.yvb=this.uwd=this.cG=null};oa.prototype.V7f=function(mc,Rc,nd){if(this.lineageTaskPane.isVisible){if(9===nd){hb.ULS.sendTraceTag(560989858,0,50,"LineageManager::ShowLineageTaskPane open from callout was invoked with an opened pane");return}if(!mc&&16!==nd&&18!==nd){this.lineageTaskPane.N3c();return}}Ve.a.Md(this.$)||(this.TMb.start(),this.n8&&(jc.b().xC(this.TMb.id,this.n8.id,"actions","actions"),this.n8.stop(),this.n8=
null));this.lineageTaskPane.Sic||hb.ULS.sendTraceTag(537155482,0,50,"LineageManager::ShowLineageTaskPane pane reopened by user via {0}",mc?Rc:nd);this.KE=this.$.ea.af;this.yvb=null;mc&&(mc=$e.r(this.gridView.ga.va.selectedRanges,this.$),this.yvb=Object.assign(new gb,{rangeList:Rc.toString()===De.a.o7f?this.Kxb(mc.Ranges):null,sheetName:mc.SheetName}));Ve.a.Md(this.$)&&this.lineageTaskPane.Sic?this.lineageTaskPane.Cwj(this.OFb):this.cG.createLineagePane(this.uwd,this.yvb);this.lineageTaskPane.Uf(!0);
this.$.ae(-71295319,-1,0,null)};oa.prototype.lineageHidePreviousHistory=function(){function mc(Td,Fe,fe){var ef=Rc.$.na.ta,If=ef.Ma(1,null);return pd.i(ef,"LineageHidePreviousHistory",If,Td,Fe,fe,null,0)}var Rc=this,nd={};nd=(nd.paneVisible=this.lineageTaskPane.isVisible,nd);Fc.a.sendTelemetryEvent(Object.assign(new jf.a,{name:"Office.Excel.Online.Lineage.ClearHistoryConfirmed",dataFields:fd.a.gl(nd)}));Zd.EwaSettings.uc()?this.$.userOperationManager.jc(new pe.a(1018,0,mc,64),null):this.$.userOperationManager.jc(new Xe.a(1018,
0,mc,0),null);this.lineageTaskPane.isVisible||this.V7f(!1,null,4)};oa.prototype.Yfi=function(){var mc=this,Rc=Object.assign(new Ja,{tryParseRangeInfo:this.tryParseRangeInfo,isFeatureEnabled:this.isFeatureEnabled,onCardSelected:this.onCardSelected,onVersionHistoryButtonClicked:this.onVersionHistoryButtonClicked,onRangeFilterInputEnabled:this.onRangeFilterInputEnabled,onLearnMoreLinkClicked:this.onLearnMoreLinkClicked,lineageOpenPaneOrChangeFilterRequest:this.lineageOpenPaneOrChangeFilterRequest,lineageLoadMoreRequest:this.lineageLoadMoreRequest,
lineageRefreshViewRequest:this.lineageRefreshViewRequest,lineageUpdateViewRequest:this.lineageUpdateViewRequest});od.a(function(){mc.cG=cellLineage.LineageActivityControllerFactoryGlobal.createLineageActivityController(Object.assign(new nb,{clientBatchSize:mc.batchSize,filterableSheetList:mc.K5a(),uiCulture:mc.$.ya.UICultureTag,dataCulture:mc.$.ya.DataCultureTag,logger:new ad.a,lineageAppCallbacks:Rc}))})};oa.prototype.zid=function(mc){var Rc=this;return function(nd){if(nd=$c.a(nd)?null:nd.Result){var Td=
{};Td=(Td.CountOfActivities=nd.ActivityList.length,Td);Td.WebRequestName=mc;ge.b(Rc.$).he(zc.a.ZQi,Td);nd=Object.assign(new ib,{activityList:Rc.JId(nd.ActivityList),latestActivityId:nd.LastSearchedActivityId,oldestActivityId:nd.FirstSearchedActivityId,serverMessageCode:nd.LineageResponseCode,lastSearchedActivityTimestamp:new Date(nd.EcmaLastSearchedDate),serverFirstActivityId:nd.ServerFirstActivityId,serverLastActivityId:nd.ServerLastActivityId,showLoadPrevious:nd.ShowLoadPrevious,eolCorrelationId:nd.EolCorrelationId,
eolDateHideHistory:new Date(nd.EolDateHideHistory),eolPersonHideHistory:Rc.Dxb(nd.EolPersonHideHistory)});Rc.cG.onLineageActivitiesResponse(nd)}else hb.ULS.shipAssertTag(537155477,0,!!nd,"LineageManager."+mc+" returned null response.")}};oa.prototype.mRj=function(mc){return kc.e(mc.Ranges)&&!mc.SheetName?null:Object.assign(new gb,{rangeList:this.Kxb(mc.Ranges),sheetName:mc.SheetName})};oa.prototype.Kxb=function(mc){var Rc=[];mc=Cl(mc);for(var nd=mc.next();!nd.done;nd=mc.next())nd=nd.value,nd=Object.assign(new zb,
{firstCol:nd.FirstColumn,firstRow:nd.FirstRow,lastRow:nd.LastRow,lastCol:nd.LastColumn}),Rc.push(nd);return Rc};oa.prototype.wRj=function(mc){if(!mc)return null;var Rc={};Rc.Ranges=this.Cjd(mc.rangeList);Rc.SheetName=mc.sheetName;return Rc};oa.prototype.Cjd=function(mc){var Rc=[];if(kc.e(mc))return Rc;mc=Cl(mc);for(var nd=mc.next();!nd.done;nd=mc.next()){nd=nd.value;var Td={};Td.FirstColumn=nd.firstCol;Td.FirstRow=nd.firstRow;Td.LastRow=nd.lastRow;Td.LastColumn=nd.lastCol;Rc.push(Td)}return Rc};oa.prototype.tbi=
function(mc){(mc=this.$.xa.getItemByName(mc))&&mc.visible&&mc.activate(!0)};oa.prototype.Jbf=function(mc,Rc){var nd=[];Rc=Cl(Rc);for(var Td=Rc.next();!Td.done;Td=Rc.next()){Td=Td.value;var Fe={};Fe.FirstColumn=Td.firstCol;Fe.FirstRow=Td.firstRow;Fe.LastRow=Td.lastRow;Fe.LastColumn=Td.lastCol;nd.push($e.D(Fe))}Rc=nd.length-1;Td=nd[Rc].topLeft;te.g(this.$).kW(nd,Rc,mc,null,Td,null,null,3,me.a.nxi,void 0,void 0,void 0,!0)};oa.prototype.Nbj=function(){this.cG&&this.lineageTaskPane.isVisible&&(this.KE=
this.$.ea.af,this.cG.onRefreshRequired())};oa.prototype.ZEg=function(){this.lineageTaskPane.ZM(this.onPaneClosed);this.lineageTaskPane.yC(this.$z);this.$.ea.Yt(this.Tf);this.$.ea.ek(this.fd);this.$.ea.xQ(this.Yq);var mc=this.$.xa;mc.nZ(this.zD);mc.Oha(this.Aqc);mc.JGa(this.Tza);mc.f_a(this.Aqc)};oa.prototype.Kej=function(){this.$.ea.jx(this.Tf);this.gridView.ga.P7(this.ld);this.$.ea.tk(this.fd);this.$.ea.DX(this.Yq);var mc=this.$.xa;mc.O7(this.zD);mc.Xna(this.Aqc);mc.ORa(this.Tza);mc.pJb(this.Aqc)};
oa.prototype.onStaleActivitiesDetected=function(){this.cG.onStaleActivitiesDetected()};oa.prototype.K5a=function(){for(var mc=[],Rc=Cl(this.$.xa.items),nd=Rc.next();!nd.done;nd=Rc.next())nd=nd.value,nd.visible&&!jd.e(nd)&&mc.push(nd.sheetName);return mc};oa.prototype.gHj=function(){if(Zd.EwaSettings.ma(631)){var mc=this.$.da.Aa(403);mc&&mc.disable();mc=new Sc.a(-847286761,zd.a.$b,this.$.jd,0,De.a.V0);var Rc={};Rc=(Rc.InputMethod=zd.a.$b,Rc);Rc.CalloutName=5;this.$.Ka.dc(mc,Rc)}};oa.prototype.JId=
function(mc){var Rc=[];mc=Cl(mc);for(var nd=mc.next();!nd.done;nd=mc.next())nd=nd.value,nd=Object.assign(new Za,{activityId:Number.parseLocale(nd.UserActivity.Id),activityGuid:nd.Uid,activityType:nd.UserActivity.Type,author:this.Dxb(nd.UserActivity.Person),sheetName:nd.SheetName,displayTimestamp:new Date(nd.UserActivity.DisplayTimestamp),gridLocation:nd.DisplayLocation,valueChanges:this.n7i(nd.LineageValueChangeList),isBulkEditOverflow:nd.IsBulkEditOverFlow,rangeHighlightLocation:this.c7i(nd.UserActivity.LocationList,
nd.UserActivity.Type),nestedActivityList:this.W6i(nd.NestedActivityList),degradedCardTypeBits:nd.DegradedCardTypeBits}),Rc.push(nd);return Rc};oa.prototype.c7i=function(mc,Rc){if(!mc)return hb.ULS.sendTraceTag(537155468,0,15,"LineageManager:: RangeHighlightLocation.ActivityLocationList is null"),null;if(!mc.length)return hb.ULS.sendTraceTag(537155467,0,50,"LineageManager:: RangeHighlightLocation.ActivityLocationList is empty"),null;var nd=[],Td=[],Fe="";21===Rc?Td.push(mc[0]):Td=mc;mc=Cl(Td);for(Td=
mc.next();!Td.done;Td=mc.next())switch(Td=Td.value,Td.Type){case 1:break;case 2:Fe=Td.SheetName;break;case 0:if(!Td.RangeList){hb.ULS.sendTraceTag(537155465,0,50,"LineageManager:: RangeHighlightLocation.RangeActivityLocation is null");break}Fe=Td.RangeList[0].SheetName;var fe=[];21===Rc?fe.push(Td.RangeList[0]):fe=Td.RangeList;Td=Cl(fe);for(fe=Td.next();!fe.done;fe=Td.next())fe=fe.value,fe=Object.assign(new zb,{firstCol:fe.FirstColumn,firstRow:fe.FirstRow,lastRow:fe.LastRow,lastCol:fe.LastColumn}),
nd.push(fe);break;default:hb.ULS.sendTraceTag(537155464,0,50,"LineageManager:: RangeHighlightLocation.ActivityLocationList is of type: ",Td.Type)}return Object.assign(new gb,{sheetName:Fe,rangeList:nd})};oa.prototype.n7i=function(mc){var Rc=[];mc=Cl(mc);for(var nd=mc.next();!nd.done;nd=mc.next())nd=nd.value,nd=Object.assign(new Ma,{hasNewValue:nd.HasNewValue,hasOldValue:nd.HasOldValue,newValue:nd.HasNewValue?nd.NewValue:null,oldValue:nd.HasOldValue?nd.OldValue:null,cellLocation:nd.CellLocation}),
Rc.push(nd);return Rc};oa.prototype.W6i=function(mc){return mc?this.JId(mc):null};oa.prototype.Dxb=function(mc){if(!mc)return null;var Rc=null;Zd.EwaSettings.isChangeGateEnabled("OfficeVSO:4947893_ShowChangesUserProfilePictureSupportEnabled")&&db.AFrameworkApplication.ha.ra("IsUserProfilePictureResolutionEnabled")&&(Rc=this.$sc.PIa(mc.Email,mc.Provider,db.AFrameworkApplication.uj,0));return Object.assign(new pa,{id:mc.Id,provider:mc.Provider,displayName:mc.DisplayName,email:mc.Email,imageUrl:Rc})};
Object(Ca.a)(oa,"LineageManager",null,[585,3]);var dc=Sa.a;Am($b,dc);$b.prototype.Txi=function(mc){var Rc=this;Pb.TaskExtensions.Ba(mc,function(){Rc.Eb(Rc.$.da.Aa(366)||new oa(Rc.$,Rc.$.da,Rc.lineageTaskPane,Rc.n8))},this.$.la,3)};$b.prototype.create=function(){var mc=this;this.n8=this.$.Sb.Hc("UserAction","LineagePaneSeenStopwatch");this.n8.start();var Rc=fb.GetServiceTaskFactory.Ua(this.$.da,365,364,this.ub),nd=Ad.a(this.$),Td=fb.GetServiceTaskFactory.Ua(this.$.da,283,284,this.ub);Pb.TaskExtensions.Ba(Pb.TaskExtensions.we([Rc,
nd,Td],this.$.la),function(){mc.lineageTaskPane=Rc.result;Ve.a.Md(mc.$)||nd.result.ZR(mc.lineageTaskPane);mc.Txi(qd.c(Td.result.ho.loadScript("cellLineage")))},this.$.la,3)};$b.ka=function(mc){mc.da.Ha(367,new $b(mc))};Object(Ca.a)($b,"LineageManagerFactory",Sa.a,[]);var za=b(1002),Mb=b(226),hc=b(12),cc=b(108),Ec=b(255),Lc=b(85),he=b(240),qe=b(17),Af=b(913),xf=b(66),fc=De.a.SBc+"LineageActivityPaneTitle",Gc=De.a.Bfb+"LineageActivityCloseButton",xd=he.a;Am(Gb,xd);Gb.prototype.mH=function(mc){this.get_events().addHandler("LineageTaskPaneRemove",
mc)};Gb.prototype.NI=function(mc){this.get_events().removeHandler("LineageTaskPaneRemove",mc)};Gb.prototype.yC=function(mc){this.addHandler("LineageTaskPaneVisibilityChanged",mc)};Gb.prototype.WD=function(mc){this.removeHandler("LineageTaskPaneVisibilityChanged",mc)};Gb.prototype.ZM=function(mc){this.get_events().addHandler("LineageTaskPaneClose",mc)};Gb.prototype.WO=function(mc){this.get_events().removeHandler("LineageTaskPaneClose",mc)};Gb.prototype.Pw=function(){};Gb.prototype.vn=function(){return this.Tp};
Gb.prototype.qq=function(){return this.Tp};Gb.prototype.lG=function(){};Gb.prototype.ZH=function(){return!1};Gb.prototype.ji=function(){};Gb.prototype.Xh=function(){};Gb.prototype.dispose=function(){this.$&&(this.$.En(this.rd),id.a(this.$).eA(this));this.te&&(Mb.a.instance.za(hc.a.click,this.te,this.kk),cc.KeyInputManager.instance.Tv(this.te,this.uDe));this.te=this.taskPaneManager=this.$=null;xd.prototype.dispose.call(this)};Gb.prototype.Qe=function(mc,Rc){if(!Rc){mc=ed.DOMElementExtensions.getElementById(this.domElement,
"LineagePaneFilterButton");if(!mc)return!1;ed.DOMElementExtensions.setFocus(mc)}return!Rc};Gb.prototype.eg=function(mc){return ed.DOMElementExtensions.Se(this.Kb,mc)};Gb.prototype.Uf=function(mc){this.Tp=mc;var Rc=this.taskPaneManager;if(this.isVisible=mc)this.$.frame.Ue.$j("LineagePane"),this.Psd=!1;if(Ve.a.Md(this.$))mc?Rc.LS("LineageTaskPane",this.lJ):Rc.hideTaskPane("LineageTaskPane");else{this.taskPaneManager.Zr();var nd=!!this.taskPaneManager.Jg&&15===this.taskPaneManager.Jg.taskPane.Cg;mc&&
0<Rc.oA.length&&(!nd||Rc.isCollapsed)&&Rc.XD(this,!0)}this.$.Cf()};Gb.prototype.nN=function(){var mc=this.$.Lb;mc=Ve.a.Md(this.$)?this.domElement:document.getElementById(mc+De.a.ywd);var Rc=this.yH();mc.appendChild(Rc);Rc=Af.b("div","LineagePaneBodyId","LineageActivityBody");mc.appendChild(Rc);this.Dwj();return Rc};Gb.prototype.N3c=function(){this.$.frame.Ue.$j(this.$.frame.Ue.rF||Ec.AFrame.OU);this.Psd=!0;this.Uf(!1);this.raiseEvent("LineageTaskPaneClose")};Gb.prototype.Cwj=function(mc){this.OFb=
mc};Gb.prototype.Dwj=function(){this.$.frame.Ue.mk("LineagePane");var mc=this.$.frame.Ue.Gi("LineagePane");mc.parent=Ec.AFrame.OU;mc.nS=!0};Gb.prototype.yH=function(){var mc=Af.b("div","LineagePaneHeaderId","LineageActivityPaneHeader"),Rc=Af.b("h1","LineagePaneTitleId",fc);Rc.innerText=this.titleText;this.te=za.a.Cb("LineagePaneCloseButtonId",Gc,yd.a.instance.fa(10),"ClosePaneGlyph_16x16x32",!1);this.te.classList.add(db.AFrameworkApplication.isRtl?De.a.qba:De.a.rba);Mb.a.instance.qa(hc.a.click,this.te,
this.kk);this.uDe=cc.KeyInputManager.instance.Ps(this.te,this.kk,Lc.a.fi);mc.appendChild(Rc);mc.appendChild(this.te);return mc};Gb.ka=function(mc,Rc){var nd=mc.Lb,Td=document.getElementById(nd+De.a.ywd);Td||(Td=document.createElement("div"),Td.id=mc.Lb+De.a.ywd,Td.classList.add("LineageActivityPane"),Ve.a.Md(mc)||document.getElementById(nd+De.a.AS).appendChild(Td));return mc.da.Aa(365)||mc.da.Ha(365,new Gb(Td,mc,Rc))};uk.Object.defineProperties(Gb.prototype,{isVisible:{configurable:!0,enumerable:!0,
get:function(){return Object(xf.a)(Gb.prototype,this,"isVisible")},set:function(mc){Object(xf.a)(Gb.prototype,this,"isVisible")!==mc&&(Object(xf.b)(Gb.prototype,this,"isVisible",mc),this.raiseEvent("LineageTaskPaneVisibilityChanged"))}},Sic:{configurable:!0,enumerable:!0,get:function(){return this.Psd}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.isVisible}},Cg:{configurable:!0,enumerable:!0,get:function(){return 15}},de:{configurable:!0,enumerable:!0,get:function(){return uc.a.oxi}},
Xj:{configurable:!0,enumerable:!0,get:function(){return qe.a.tAh}},lD:{configurable:!0,enumerable:!0,get:function(){return yd.a.instance.fa(1030)}},Sl:{configurable:!0,enumerable:!0,get:function(){return 300}},isResizable:{configurable:!0,enumerable:!0,get:function(){return!1}},Kb:{configurable:!0,enumerable:!0,get:function(){return this.domElement}},height:{configurable:!0,enumerable:!0,get:function(){return this.taskPaneManager.oM.offsetHeight}},titleText:{configurable:!0,enumerable:!0,get:function(){return yd.a.instance.fa(1251)}},
lJ:{configurable:!0,enumerable:!0,get:function(){var mc=this;return this.taskPaneManager.dwa(this.Kb,this.titleText,this.Sl,this.isResizable,function(){mc.isVisible=!0;mc.OFb?mc.OFb():hb.ULS.shipAssertTag(537155462,0,!1,"OnLineagePaneOpened callback not set.")},function(){mc.isVisible=!1},function(){mc.isVisible=!0},function(){mc.isVisible=!1},this.Sl)}}});Object(Ca.a)(Gb,"LineageTaskPane",he.a,[525,3,490,451]);var Id=Sa.a;Am(xa,Id);xa.prototype.create=function(){var mc=this,Rc=fb.GetServiceTaskFactory.create(this.$.da,
203,this.la,this.ub),nd=fb.GetServiceTaskFactory.create(this.$.da,155,this.la,this.ub);Pb.TaskExtensions.Ba(Pb.TaskExtensions.ts(Pb.TaskExtensions.we([Rc,nd],this.la),function(){return mc.ED},this.la),function(){mc.Eb(mc.gh)},this.la,3)};xa.prototype.dispose=function(){this.gh=this.Bi=this.$=null;Id.prototype.dispose.call(this)};xa.ka=function(mc){mc.da.Ha(364,new xa(mc))};uk.Object.defineProperties(xa.prototype,{ED:{configurable:!0,enumerable:!0,get:function(){var mc=this;this.Bi||(this.Bi=Pb.TaskExtensions.Ba(Ad.a(this.$),
function(Rc){mc.gh=Gb.ka(mc.$,Rc.result)},this.la,3));return this.Bi}}});Object(Ca.a)(xa,"LineageTaskPaneFactory",Sa.a,[]);bb.prototype.dispose=function(){this.SLd();this.$=null;hb.ULS.sendTraceTag(537155459,0,50,"LineageTeachingCalloutTriggerManager is disposed.")};bb.prototype.disable=function(){bb.Gyb||(bb.Gyb=!0,hb.ULS.sendTraceTag(578557781,0,50,"LineageTeachingCalloutTriggerManager.Disable as the pane was opened."));this.SLd()};bb.prototype.r0j=function(){var mc=this;Zd.EwaSettings.ma(627)&&
!this.$.isAnonymousUser()&&pd.l(this.$.na.ta,function(Rc){mc.$?(Rc=Rc.Result,hb.ULS.sendTraceTag(578557780,0,50,"CheckLineageWywaChanges service call succeeded, hasnewchanges = {0}.",Rc),bb.baf=!0,Rc&&mc.Qdg(0)):hb.ULS.sendTraceTag(537155458,0,50,"LineageTeachingCalloutTriggerManager.VerifyWaterlineTrigger ignoring server response as class is disposed.")},function(){hb.ULS.sendTraceTag(537155457,0,10,"CheckLineageWywaChanges service call failed.")},null,null)};bb.prototype.l0j=function(){Zd.EwaSettings.ma(626)&&
!this.$dg()&&(this.$.ea.Yt(this.Tf),this.otd=!0)};bb.prototype.$dg=function(){return this.$.ea&&this.$.ea.Pm&&this.$.ea.Pm.ShouldTriggerLineageCalloutOnMerge?(hb.ULS.sendTraceTag(578557778,0,50,"LineageTeachingCalloutTriggerManager.TriggerLineageCalloutOnMerge"),this.Qdg(1),!0):!1};bb.prototype.Qdg=function(mc){if(bb.Gyb)hb.ULS.sendTraceTag(537155456,0,50,"LineageTeachingCalloutTriggerManager.TriggerCallout Will not trigger dialog as it was already shown in session");else if(bb.Gyb=!0,hb.ULS.sendTraceTag(578557776,
0,50,"LineageTeachingCalloutTriggerManager.TriggerCallout triggering callout due to reason {0}.",mc),this.SLd(),Zd.EwaSettings.ma(492)){mc=new Sc.a(-847286761,zd.a.$b,this.$.jd,0,De.a.V0);var Rc={};Rc=(Rc.CalloutName=4,Rc);this.$.Ka.dc(mc,Rc)}};bb.prototype.SLd=function(){this.otd&&(this.otd=!1,this.$.ea.jx(this.Tf))};bb.Gyb=!1;bb.baf=!1;Object(Ca.a)(bb,"LineageTeachingCalloutTriggerManager",null,[522,3]);var le=Sa.a;Am(Ua,le);Ua.prototype.create=function(){var mc=this;Pb.TaskExtensions.Ba(fb.GetServiceTaskFactory.Ua(this.$.da,
458,459,this.ub),function(Rc){Rc=new bb(mc.$,Rc.result);mc.Eb(Rc)},this.$.la,3)};Ua.ka=function(mc){mc.da.Ha(402,new Ua(mc))};Object(Ca.a)(Ua,"LineageTeachingCalloutTriggerManagerFactory",Sa.a,[]);var Wd=b(1094),Je=b(73);ab.prototype.TX=function(mc,Rc,nd,Td){var Fe=this;return this.zlh(mc,void 0===Td?null:Td,function(fe){return Fe.Yg.F_b(fe,2,nd,Rc,void 0,void 0,void 0,void 0,void 0,"2")})};ab.prototype.zlh=function(mc,Rc,nd){var Td=this,Fe=!!Rc&&""!==Rc,fe=mc;Fe&&(fe=Kc.a.DU(mc,"perfTag",Rc));var ef=
new Date;return Wd.a.then(nd(fe),function(If){var Ke=+new Date-+ef;if(!If||!If.jh||!If.jh.data)return If;Fe&&If.jh.data.request&&Td.Hsj(If.jh.data.request.getResolvedUrl(),Rc,Ke);return If})};ab.prototype.Hsj=function(mc,Rc,nd){mc=this.Uu.b1h(mc);if(mc.count&&(mc=Je.last(mc))){var Td={Message:"Request durations for activities calls."};Td.PerfTag=Rc;Td.CustomDuration=nd;Td.PerformanceDuration=mc.duration;hb.ULS.sendTraceTag(592189641,3012,50,JSON.stringify(Td))}};Object(Ca.a)(ab,"CatchUpNetworkingWrapper",
null,[198]);var lf=b(251),vf=lf.a;Am(Fa,vf);Fa.prototype.nka=function(){return 6};Object(Ca.a)(Fa,"GetActivityFeedRequest",lf.a,[]);var se=b(409);Aa.prototype.getActivityFeed=function(mc){return this.NNh(mc)};Aa.prototype.NNh=function(mc){var Rc=this;return Wd.a.then(this.FWa.execute(new Fa(this.pWa(),null),function(nd,Td,Fe){return Rc.Lwg.TX(nd,Td,Fe,"ActivityFeed")},mc),function(nd){if(!nd)return hb.ULS.sendTraceTag(572846937,3012,10,"GetActivityFeed: Response is null"),null;if(!nd.jh)return hb.ULS.sendTraceTag(572846938,
3012,10,"GetActivityFeed: Response.Args is null"),null;if(!nd.jh.data)return hb.ULS.sendTraceTag(572846939,3012,10,"GetActivityFeed: Response.Args.Data is null"),null;if(!nd.jh.data.oe)return hb.ULS.sendTraceTag(572846940,3012,10,"GetActivityFeed: Response.Args.Data.ResponseData is null"),null;nd=se.a.oJa(nd.jh.data.oe);return nd?nd:(hb.ULS.sendTraceTag(572846941,3012,10,"GetActivityFeed: Deserialized response is null"),null)})};Object(Ca.a)(Aa,"CatchUpRequestHandler",null,[217]);var wf=b(516);qa.prototype.Yyi=
function(){this.Izi()};qa.prototype.Izi=function(){var mc=this;this.dZa?this.dZa.execute(function(Rc){window.setTimeout(function(){mc.eee.contains("CatchUpChangesFeedback")||(mc.eee.add("CatchUpChangesFeedback"),Rc.logActivity("CatchUpChangesFeedback",null))},2E4)}):hb.ULS.sendTraceTag(571586199,383,15,"FloodgateEventLogger: IFuture<ISystemInitiatedFeedback> was null")};Object(Ca.a)(qa,"FloodgateEventLogger",null,[]);var Uf=b(199);uk.Object.defineProperties(ha.prototype,{duration:{configurable:!0,
enumerable:!0,get:function(){return this.Gxg.duration}}});Object(Ca.a)(ha,"PerformanceResourceTimingWrapper",null,[]);da.prototype.b1h=function(mc){var Rc=new Uf.a;if(!this.Uu)return Rc;mc=this.Uu.getEntriesByName(mc,"resource");if(!mc)return Rc;mc=Cl(mc);for(var nd=mc.next();!nd.done;nd=mc.next())Rc.add(new ha(nd.value));return Rc};Object(Ca.a)(da,"PerformanceWrapper",null,[]);var Wf=b(254);ka.prototype.hi=function(mc){var Rc=this;this.tb=mc;this.tb.register(ab,"Common.App.CatchUpActivity.CatchUpNetworkingWrapper").as("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper").Ic().Nc(function(){return new ab(db.AFrameworkApplication.Ld,
new da(window.performance))});this.tb.register(Aa,"Common.App.CatchUpActivity.CatchUpRequestHandler").as("Common.App.CatchUpActivity.ICatchUpRequestHandler").Ic().Nc(function(){return new Aa(Rc.tb.resolve("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper"),function(){return db.AFrameworkApplication.uj},new se.a)});this.tb.register(qa,"Common.App.CatchUpActivity.FloodgateEventLogger").Ic().Nc(function(){return new qa(Rc.tb.qc("Common.ISystemInitiatedFeedback"))})};ka.prototype.init=function(){this.tb.resolve("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper");
this.tb.resolve("Common.App.CatchUpActivity.ICatchUpRequestHandler")};ka.prototype.dispose=function(){};ka.main=function(){Wf.a.instance.nj(new ka)};uk.Object.defineProperties(ka.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.CatchUpActivity"}}});Object(Ca.a)(ka,"CatchUpActivityPackage",null,[4,5]);ra.prototype.$c=function(mc,Rc){return this.catchUpActivityManager?-876699925===Rc?!this.catchUpActivityManager.egf:!1:!0};ra.prototype.executeCommand=function(mc,Rc){mc=
!1;switch(Rc.command){case -876699925:mc=this.catchUpActivityManager.SYi()}return mc?Ob.Task.Sa(!0):sc.a(Rc.command)};ra.prototype.Mc=function(mc,Rc){return Zd.EwaSettings.ma(443)&&-876699925===Rc.command?!0:!1};ra.prototype.nd=function(){return!1};Object(Ca.a)(ra,"CatchUpActivityCommandHandler",null,[434]);var Tf=va.a;Am(ba,Tf);ba.prototype.Qd=function(){var mc=this;this.$.da.Ya(286,function(Rc){mc.Jd([new ra(mc.$,Rc)])})};ba.ka=function(mc){va.a.je(285,new ba(mc))};Object(Ca.a)(ba,"CatchUpActivityCommandHandlerFactory",
va.a,[]);var ug=b(273),Le=b(565),Qd=b(89),Of=b(81),Ee=b(26);ia.prototype.doesContentExist=function(mc){if(!mc)return hb.ULS.sendTraceTag(537168066,3012,10,"Null activity: DoesContentExist. Default to false."),!1;switch(mc.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:if(!mc.navigationId)return hb.ULS.sendTraceTag(537168065,3012,10,"Null activity.NavigationId: DoesContentExist. Default to false."),!1;var Rc={};Rc.NavigationId=atob(mc.navigationId);return 32===this.Ki.Be(Ee.a.FJa,2,
Rc);default:return!1}};Object(Ca.a)(ia,"CatchUpActivityContentManager",null,[586]);var Eg=b(1037),lg=b(1316);aa.prototype.dispose=function(){this.sv.ZTf(this.KFb);this.Mz=null};aa.prototype.cwj=function(mc){this.Mz.push(mc)};aa.prototype.O1g=function(){Array.clear(this.Mz)};aa.prototype.g8f=function(mc){for(var Rc=Cl(this.Mz),nd=Rc.next();!nd.done;nd=Rc.next())nd=nd.value,nd.className=Eg.a.CZg,nd=document.getElementById(String.format("{0}-{1}",nd.id,De.a.QAe)),ed.DOMElementExtensions.setVisible(nd,
mc)};aa.prototype.cNb=function(mc){for(var Rc=Cl(this.Mz),nd=Rc.next();!nd.done;nd=Rc.next())if(nd=nd.value)mc?nd.className=2===this.sv.model.state?Eg.a.W9i:Eg.a.X9i:this.g8f(!1)};uk.Object.defineProperties(aa.prototype,{sv:{configurable:!0,enumerable:!0,get:function(){return this.Ttg}}});Object(Ca.a)(aa,"RangeCatchUpActivityView",null,[658,3]);var Ef=b(21),eg=lg.a;Am(J,eg);J.prototype.dispose=function(){this.gridView=null;eg.prototype.dispose.call(this)};J.prototype.vHg=function(mc){var Rc=this.fhb[0];
Rc?Rc.cwj(mc):hb.ULS.shipAssertTag(537168004,0,!1,"RangeCatchUpActivityHighlightController.AddViewElement - RangeCatchUpActivityView is null for activityId"+this.Nna.activityId)};J.prototype.$lj=function(){var mc=this.fhb[0];mc&&mc.O1g()};J.prototype.JFg=function(mc){this.Nna.addRange(mc)};J.prototype.kRh=function(){if(3!==this.Nna.activityType)return null;hb.ULS.shipAssertTag(537168003,0,1===this.Nna.BNb.length,"RangeCatchUpActivityHighlightController::GetCommentActivityRange Range Information Length should be 1.");
return $e.D(this.Nna.BNb[0])};J.prototype.XKb=function(mc){if(mc){if(!this.Nna)return;this.yAd(this.dnj())}eg.prototype.XKb.call(this,mc)};J.prototype.o7c=function(){var mc=this.U6c();Array.add(this.fhb,mc)};J.prototype.U6c=function(){return new aa(this)};J.prototype.yAd=function(mc){mc?mc.SheetName?(this.gridView.ga.Pa.DH(null),this.gridView.focus(),this.gridView.b9e(mc,3,!1,me.a.V9i)):hb.ULS.shipAssertTag(537168E3,0,!1,"RangeCatchUpActivityHighlightController.NavigateToRange: SheetName in the range is null."):
hb.ULS.shipAssertTag(537168001,0,!1,"RangeCatchUpActivityHighlightController.NavigateToRange: Range is null. Either the location list is empty or sheet is hidden.")};J.prototype.dnj=function(){if(kc.e(this.Nna.BNb))return hb.ULS.shipAssertTag(537167971,0,!1,"RangeCatchUpActivityHighlightController.RetrieveRangeInformationForNavigation : SortedRanges is either null or empty."),null;var mc=this.$.xa.oa;hb.ULS.shipAssertTag(537167970,0,!!mc,"RangeCatchUpActivityHighlightController.RetrieveRangeInformationForNavigation : currentSheet is null.");
mc=this.sSj(mc.sheetName,this.Nna.BNb);if(!mc&&(mc=this.E5h(this.Nna.BNb),!mc))return null;var Rc={};Rc.SheetName=mc.SheetName;Rc.FirstColumn=mc.FirstColumn;Rc.FirstRow=mc.FirstRow;Rc.LastColumn=mc.FirstColumn;Rc.LastRow=mc.FirstRow;return Rc};J.prototype.E5h=function(mc){if(kc.e(mc))return null;for(var Rc=null,nd=0;nd<mc.length;nd++){var Td=mc[nd].SheetName;if(!Ef.a.equals(Td,Rc,!1)&&(Rc=Td,Td=this.$.xa.getItemByName(Td),null===Td||void 0===Td?0:Td.visible))return mc[nd]}return null};J.prototype.sSj=
function(mc,Rc){if(Rc){Rc=Cl(Rc);for(var nd=Rc.next();!nd.done;nd=Rc.next())if(nd=nd.value,Ef.a.equals(nd.SheetName,mc,!1))return nd}return null};Object(Ca.a)(J,"RangeCatchUpActivityHighlightController",lg.a,[]);var Na=b(75),Ib=Na.a;Am(P,Ib);P.prototype.dispose=function(){this.K4d=null;Ib.prototype.dispose.call(this)};uk.Object.defineProperties(P.prototype,{type:{configurable:!0,enumerable:!0,get:function(){return this.vC}},activityId:{configurable:!0,enumerable:!0,get:function(){return this.K4d}},
activityType:{configurable:!0,enumerable:!0,get:function(){return this.pog}}});Object(Ca.a)(P,"CatchUpActivityHighlightModelBase",Na.a,[]);Am(I,P);I.prototype.addRange=function(mc){mc=Cl(mc);for(var Rc=mc.next();!Rc.done;Rc=mc.next())this.ranges.push(Rc.value)};I.prototype.dispose=function(){this.ranges=null;P.prototype.dispose.call(this)};I.T4b=function(mc,Rc){if(!mc.SheetName||!Rc.SheetName)return hb.ULS.shipAssertTag(537167969,0,!1,"RangeCatchUpActivityHighlightModel.CompareSharedSheetRange : SheetName is null."),
0;var nd=mc.SheetName.localeCompare(Rc.SheetName);return nd?nd:mc.FirstColumn<Rc.FirstColumn||mc.FirstColumn===Rc.FirstColumn&&mc.FirstRow<Rc.FirstRow?-1:mc.FirstColumn===Rc.FirstColumn&&mc.FirstRow===Rc.FirstRow?0:1};uk.Object.defineProperties(I.prototype,{BNb:{configurable:!0,enumerable:!0,get:function(){this.E8a||(this.ranges.sort(I.T4b),this.E8a=!0);return this.ranges}}});Object(Ca.a)(I,"RangeCatchUpActivityHighlightModel",P,[]);var vc=b(353);S.prototype.dispose=function(){this.xoe=this.oMb=this.J4c=
null};S.prototype.Zij=function(mc){te.g(mc).Fb.co([24])};S.prototype.N9g=function(mc,Rc,nd){var Td={};Rc=Cl(Rc);for(var Fe=Rc.next();!Fe.done;Fe=Rc.next())if((Fe=Fe.value)&&!kc.e(Fe.LocationList)){for(var fe=[],ef={},If=[],Ke=Cl(Fe.LocationList),ng=Ke.next();!ng.done;ng=Ke.next()){ng=ng.value;if(!ng){hb.ULS.shipAssertTag(537168013,0,!1,"CatchUpActivityHighlightManagerHelper.CreateControllersAndHighlights - Location is Null for activityId : "+Fe.Id);break}switch(ng.Type){case 0:var rf=ng;"0"in ef?
(ng=ef["0"],ng.JFg(rf.RangeList)):(ng=new J(mc,new I(mc,Fe.Id,Fe.Type,0,rf.RangeList),nd),fe.push(ng),ef["0"]=ng);rf=Cl(rf.RangeList);for(var dg=rf.next();!dg.done;dg=rf.next()){dg=dg.value;dg=new vc.a($e.D(dg),jd.d(mc.xa.getItemByName(dg.SheetName)));if(this.$yc(dg)in this.oMb)this.oMb[this.$yc(dg)].push(ng);else{var qf=[];qf.push(ng);this.oMb[this.$yc(dg)]=qf}If.push(dg);this.J4c.push(dg)}break;default:hb.ULS.sendTraceTag(537168012,0,10,"CatchUpHighlightControllersCreator.CreateControllersAndHighlights(): Failed.Invalid ActivityLocationType")}}hb.ULS.shipAssertTag(537168011,
0,!(Fe.Id in Td),"CatchUpHighlightControllersCreator.CreateAndUpdateControllers - highlightControllers already has activity: "+Fe.Id);this.xoe[Fe.Id]=If;Td[Fe.Id]=fe}this.iah(mc,this.J4c,this.oMb);return Td};S.prototype.H1g=function(mc){for(var Rc in mc)for(var nd=Cl(mc[Rc]),Td=nd.next();!Td.done;Td=nd.next())Td.value.$lj()};S.prototype.$yc=function(mc){return String.format("{0}-{1}",mc.range,mc.sheetId)};S.prototype.iah=function(mc,Rc,nd){var Td=this;this.H1g(nd);te.g(mc).Fb.ox(Rc,[24],!0,function(Fe,
fe){var ef=new vc.a(Fe.range,Fe.sheetId);ef=Td.$yc(ef);var If=nd[ef];if(If)for(ef=Cl(If),If=ef.next();!If.done;If=ef.next())If=If.value,If.vHg(fe),Fe.metadata=If;else hb.ULS.shipAssertTag(537168010,0,!1,"CatchUpHighlightControllersCreator.CreateHighlightsAndUpdateControllers(), Missing Controller for SheetRangeKey "+ef)})};Object(Ca.a)(S,"CatchUpHighlightControllersCreator",null,[]);Object(Ca.a)(Z,"CreateIndicatorTooltipParameters",null,[]);Object(Ca.a)(ea,"DismissIndicatorTooltipParameters",null,
[]);Object(Ca.a)(O,"UpdateIndicatorTooltipParameters",null,[]);Q.prototype.dispose=function(){this.ga.Puc(this.nl);this.ga.xG(this.ld);this.gridView.wG(this.Fp);this.Za.$k(this.mj);this.lLe();this.led=this.dla=this.bgc=this.ESa=this.Za=this.ga=this.gridView=null};Q.prototype.Qtj=function(){var mc=[];this.lLe();if(!kc.e(mc)){hb.ULS.sendTraceTag(537168035,0,50,"In CatchUpActivityHighlightManager:ProcessActivityPayloadHighlights().");if(this.J5=this.D5b.N9g(this.$,mc,this)){mc=this.J5;for(var Rc in mc)for(var nd=
Cl(mc[Rc]),Td=nd.next();!Td.done;Td=nd.next())this.ZPg(Td.value)}this.D5b.Zij(this.$)}};Q.prototype.Zzc=function(mc){if(mc&&this.qnd)hb.ULS.shipAssertTag(537168034,0,!1,"CatchUpActivityHighlightManager.ShowOrHideAllHighlights - Trying to show all highlights when marked as read");else if(mc||this.Mtb(),this.J5){var Rc=this.J5,nd;for(nd in Rc)for(var Td=Cl(Rc[nd]),Fe=Td.next();!Fe.done;Fe=Td.next())Fe.value.oGj(mc)}};Q.prototype.sbi=function(mc){this.dla&&this.q8b(!0);this.Z8c();if(mc=this.J5[mc.activityId]){mc=
Cl(mc);for(var Rc=mc.next();!Rc.done;Rc=mc.next())Rc.value.XKb(!0)}else hb.ULS.sendTraceTag(537168032,0,50,"CatchUpActivityHighlightManager.OnSelectHighlight - Controllers not found during select")};Q.prototype.lLe=function(){if(this.J5){var mc=this.J5,Rc;for(Rc in mc)for(var nd=Cl(mc[Rc]),Td=nd.next();!Td.done;Td=nd.next())Td=Td.value,this.Lej(Td),Td.dispose()}this.J5={};this.D5b.dispose();this.D5b=null};Q.prototype.QEj=function(){if(this.excelCommentManager){var mc=this.J5[this.ESa];mc&&0<mc.length&&
3===mc[0].model.activityType&&((mc=mc[0])?this.excelCommentManager.sFj(mc.kRh()):hb.ULS.shipAssertTag(537168029,0,!1,"RangeCatchUpActivityHighlightController::ShowCommentFlyoutOnSelectedActivity RangeController is Null."))}};Q.prototype.Lai=function(){this.excelCommentManager&&this.excelCommentManager.Oub()};Q.prototype.Z8c=function(){if(this.ESa){var mc=this.J5[this.ESa];if(mc){mc=Cl(mc);for(var Rc=mc.next();!Rc.done;Rc=mc.next())Rc.value.XKb(!1);this.ESa=null}else hb.ULS.sendTraceTag(537168028,
0,50,"CatchUpActivityHighlightManager.DeselectCurrentlySelected - Controllers not found for deselection")}};Q.prototype.Mtb=function(){this.Z8c();this.q8b(!0)};Q.prototype.FSj=function(mc){if(!mc)return hb.ULS.shipAssertTag(537168026,0,!1,"CatchUpActivityHighlightManager::TryGetFlyoutContainer HighlightDot is null."),null;mc=String.format("{0}-{1}",mc.id,De.a.AZg);var Rc=this.led[mc];if(!Rc){if(!this.gridView.domElement)return hb.ULS.shipAssertTag(537168025,0,!1,"CatchUpActivityHighlightManager::TryGetFlyoutContainer gridView.DOMElement is null."),
null;Rc=document.createElement("Div");Rc.className=Eg.a.BZg;Rc.id=mc;this.gridView.domElement.appendChild(Rc);this.led[mc]=Rc}return Rc};Q.prototype.q8b=function(mc){this.Pfa&&(this.Pfa.dismissActivityIndicatorTooltips(Object.assign(new ea,{clearSticky:mc})),this.bgc=null,mc&&(this.dla=null),this.yic&&!this.dla&&(this.gridView.view.fr(this.xDc),this.gridView.Nt(this.xDc),this.yic=!1))};Q.prototype.ZPg=function(mc){mc.Kqe(this.KFb);mc.$Hg(this.e7f);mc.ZHg(this.eMe)};Q.prototype.Lej=function(mc){mc.ZTf(this.KFb);
mc.Rfj(this.e7f);mc.Qfj(this.eMe)};uk.Object.defineProperties(Q.prototype,{RDg:{configurable:!0,enumerable:!0,get:function(){return this.Pfa},set:function(mc){this.Pfa=mc}},excelCommentManager:{configurable:!0,enumerable:!0,get:function(){this.oEa||(this.oEa=this.$.da.Aa(65));return this.oEa}},D5b:{configurable:!0,enumerable:!0,get:function(){this.E5b||(this.E5b=new S);return this.E5b},set:function(mc){this.E5b=mc}}});Object(Ca.a)(Q,"CatchUpActivityHighlightManager",null,[618,3]);U.prototype.navigateToActivity=
function(mc){if(mc.fromSummaryString){var Rc=new Sc.a(1834994092,zd.a.$b,this.$.jd,18,null);this.$.Ka.dc(Rc);return this.NVa(1)}mc=mc.activity;if(!this.Mji(mc))return this.NVa(4);if(!this.ysi(mc))return this.NVa(7);var nd={};try{Rc=window.self.atob(mc.navigationId);if(!Rc)return this.NVa(5);nd.NavigationId=Rc}catch(Td){return hb.ULS.sendTraceTag(537168023,3012,10,"Exception thrown when trying to decode activity NavigationID: {0}",Td),this.NVa(5)}if(8===this.Ki.Be(Ee.a.FJa,2,nd))return this.Ki.processAction(Ee.a.z$a,
2),this.NVa(2);Rc=32===this.Ki.Be(Ee.a.E1a,2,nd)?1:6;return this.NVa(Rc)};U.prototype.Mji=function(mc){return mc&&mc.navigationId?!0:!1};U.prototype.ysi=function(mc){switch(mc.type){case 3:case 4:case 6:case 7:case 9:case 8:return!0;default:return!1}};U.prototype.NVa=function(mc){return Promise.resolve(mc)};Object(Ca.a)(U,"CatchUpActivityNavigationManager",null,[587]);var Yc=b(473);Object(Ca.a)(H,"GetRelevantActivitiesDataRequest",null,[]);Object(Ca.a)(t,"Activity",null,[]);Object(Ca.a)(A,"ActivityFeedItem",
null,[]);Object(Ca.a)(v,"ActivityFeedPayload",null,[]);Object(Ca.a)(y,"ActivityRequestPayload",null,[]);Object(Ca.a)(B,"Person",null,[]);Am(r,t);Object(Ca.a)(r,"TaskActivity",t,[]);w.prototype.requestWYWAActivities=function(){var mc=this;return this.V7a?new Promise(function(Rc,nd){C(mc.$.na.ta,function(Td){Td=$c.a(Td)?null:Td.Result;Td=Object.assign(new y,{activities:[],actors:Td?mc.mjd(Td.WywaAuthors):null,hasMore:!1,highWaterline:w.C2a,lowWaterline:w.C2a,wywaWaterline:w.C2a});Rc(Td)},function(){hb.ULS.sendTraceTag(537168022,
0,10,"CatchUpActivityRequestManager::GetLineageWywaAuthors service call failed.");nd(null)},null,null)}):Promise.resolve(w.H7b)};w.prototype.requestActivities=function(){return Promise.resolve(w.H7b)};w.prototype.requestRelevantActivities=function(){var mc=this;if(!this.$.ea.sc||this.$.ea.q6a)return hb.ULS.sendTraceTag(537168021,3012,15,"CatchUpActivityRequestManager.RequestRelevantActivities: RequestRelevantActivities skipped [IsSessionActive: {0}, HasRaisedSessionEnded: {1}]",this.$.ea.sc,this.$.ea.q6a),
Promise.resolve(w.H7b);var Rc=Object.assign(new H,{SetDaysBack:db.AFrameworkApplication.ha.Cd("AppWaterlineOverrideDaysValue",0),SetTimestamp:db.AFrameworkApplication.ha.Cd("AppWaterlineOverrideTimestampValue",0)});return new Promise(function(nd,Td){E(mc.$.na.ta,Rc,function(Fe){var fe=w.H7b;Fe?$c.a(Fe)?hb.ULS.sendTraceTag(578353159,3012,10,"CatchUpActivityRequestManager::GetRelevantActivitiesData call returned errors codes: {0}",Pc.a.Wc(Fe.Errors)):fe=mc.K0h(Fe.Result):hb.ULS.sendTraceTag(537168020,
3012,10,"CatchUpActivityRequestManager::GetRelevantActivitiesData call returned Null result.");nd(fe)},function(Fe){Fe=Jf.a.mg(Fe.data);hb.ULS.sendTraceTag(537168019,3012,10,"CatchUpActivityRequestManager::GetRelevantActivitiesData call has failed - Errors: [{0}]",Pc.a.Wc(Fe));Td(null)},null,null)})};w.prototype.requestActivityFeed=function(){var mc=this;return qd.b(this.getActivityFeed()).then(function(Rc){return Object.assign(new v,{activityFeedItems:mc.kRj(Rc)})})};w.prototype.getActivityFeed=
function(){return this.TAe?Wd.a.EYd(this.TAe,function(mc){return mc.getActivityFeed(null)}):Ob.Task.Sa([])};w.prototype.K0h=function(mc){if(!mc)return hb.ULS.sendTraceTag(537168018,3012,10,"CatchUpActivityRequestManager::GetRelevantActivityRequestPayload response is null."),Object.assign(new y,{activities:[]});var Rc=this.Ldg(mc.NewActivities,2);mc=this.Ldg(mc.OutstandingActivities,3);mc=Cl(mc);for(var nd=mc.next();!nd.done;nd=mc.next())Rc.push(nd.value);return Object.assign(new y,{activities:Rc})};
w.prototype.Ldg=function(mc,Rc){Rc=void 0===Rc?1:Rc;var nd=[];if(!mc||!mc.length)return nd;mc=Cl(mc);for(var Td=mc.next();!Td.done;Td=mc.next())if(Td=Td.value){var Fe=w.rRj(Td.Type);6===Fe||7===Fe||9===Fe||8===Fe?nd.push(Object.assign(new r,{activityId:Td.Id,type:Fe,displayTimestamp:new Date(Td.DisplayTimestamp),navigationId:Td.NavigationId,actors:this.mjd(Td.People),relevancy:Rc,relationship:this.qRj(Td.Relationship)})):nd.push(Object.assign(new t,{activityId:Td.Id,type:Fe,displayTimestamp:new Date(Td.DisplayTimestamp),
navigationId:Td.NavigationId,actors:this.mjd(Td.People),relevancy:Rc}))}else hb.ULS.shipAssertTag(537168017,3012,!1,"CatchUpActivityRequestManager.TranslateRelevantActivitiesToActivities: relevantActivity is null");return nd};w.prototype.qRj=function(mc){switch(mc){case 1:return 1;case 2:return 2;case 3:return 3}hb.ULS.sendTraceTag(537168016,0,10,"Unexpected Relationship.");return 1};w.prototype.kRj=function(mc){var Rc=[];mc=Cl(mc);for(var nd=mc.next();!nd.done;nd=mc.next())nd=nd.value,nd=Object.assign(new A,
{id:nd.id,type:nd.type,collectionId:nd.collectionId,activityState:nd.activityState,activityFeedItemPayload:nd.activityFeedItemPayload,timestamp:nd.timestamp}),Rc.push(nd);return Rc};w.prototype.mjd=function(mc){var Rc=[];if(!mc||!mc.length)return Rc;mc=Cl(mc);for(var nd=mc.next();!nd.done;nd=mc.next())(nd=nd.value)&&Rc.push(this.Dxb(nd));return Rc};w.prototype.Dxb=function(mc){return Object.assign(new B,{id:mc.Id,provider:mc.Provider,displayName:mc.DisplayName,email:mc.Email,imageUrl:this.$sc.PIa(mc.Email,
mc.Provider,db.AFrameworkApplication.uj,0),color:this.mHb.Kkd(new Yc.a(null,void 0,mc.DisplayName),6)})};w.rRj=function(mc){switch(mc){case 1:return 3;case 2:return 4;case 3:return 6;case 4:return 7;case 6:return 8;case 5:return 9;case 7:return 10;default:return hb.ULS.shipAssertTag(537168015,3012,!1,"CatchUpActivityRequestManager.TranslateRelevantActivityTypeToActivityType: unknown RelevantActivityType"),1}};w.C2a="<WywaWaterline>DefaultWaterline</WywaWaterline>";w.H7b=Object.assign(new y,{activities:[],
actors:[],hasMore:!1,highWaterline:w.C2a,lowWaterline:w.C2a,wywaWaterline:w.C2a});Object(Ca.a)(w,"CatchUpActivityRequestManager",null,[588]);u.prototype.shouldShowEmptyExperienceButton=function(){if(!this.$.ea.w9a)return!1;if(!Zd.EwaSettings.isChangeGateEnabled("OfficeVSO:5892442_CatchupEmptyExperienceNewContract")){var mc=this.$.da.Aa(365);return!mc||!mc.isVisible}return!0};u.prototype.onButtonClick=function(){var mc={};mc=(mc.InputMethod=zd.a.$b,mc);this.$.Ka.dc(new Sc.a(1834994092,zd.a.$b,this.$.jd,
16,null),mc)};u.prototype.getExplanationText=function(){var mc=this.$.da.Aa(365);return yd.a.instance.Va(mc&&mc.isVisible?644:643)};u.prototype.getCommandName=function(){return yd.a.instance.fa(436)};Object(Ca.a)(u,"CatchUpEmptyExperienceBehaviorManager",null,[589]);n.prototype.dispose=function(){id.a(this.$).eA(this)};n.prototype.Qe=function(mc,Rc){if(Rc)return!1;mc=document.getElementById("flyoutItem0");if(!mc)return hb.ULS.sendTraceTag(537168009,3012,10,"Could not find firstItem in flyout when setting up focus"),
!1;mc.focus();this.gkh(mc);return!0};n.prototype.eg=function(mc){return this.Kb?ed.DOMElementExtensions.Se(this.Kb,mc):!1};n.prototype.ji=function(){this.hasFocus=!0};n.prototype.Xh=function(){this.hasFocus=!1};n.prototype.gkh=function(mc){if(Sys.Browser.agent===Sys.Browser.Firefox){var Rc=document.createEvent("KeyboardEvent");Rc.initKeyEvent(hc.a.Ub,!0,!0,window.self,!1,!1,!1,!1,Lc.a.NEc,0);mc.dispatchEvent(Rc)}else Rc=document.createEvent("Events"),Rc.initEvent(hc.a.Ub,!0,!0),Rc.keyCode=Lc.a.NEc,
Rc.which=Lc.a.NEc,mc.dispatchEvent(Rc)};uk.Object.defineProperties(n.prototype,{Kb:{configurable:!0,enumerable:!0,get:function(){return document.getElementById("catchUpFlyoutContainer")}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.flyoutRibbonButton.Lhf&&!this.hasFocus}},de:{configurable:!0,enumerable:!0,get:function(){return uc.a.e2c}}});Object(Ca.a)(n,"FlyoutFocus",null,[451,3]);var Md=b(393);m.prototype.dispose=function(){this.Pkb=this.IAb=!1};m.prototype.registerButtonClickedEvent=
function(mc){this.buttonClickedCallback&&hb.ULS.sendTraceTag(537168008,3012,15,"RegisterButtonClickedEvent: Button clicked callback should only be registered once.");this.buttonClickedCallback=mc.buttonClickedCallback};m.prototype.onFlyoutInitialized=function(){this.IAb&&hb.ULS.sendTraceTag(537168007,3012,15,"OnFlyoutInitialized: Flyout should only be initialized once.");var mc=(new Date).getTime()-this.UIh.getTime();hb.ULS.sendTraceTag(593601546,3012,50,"Time from retrieve activities to initialize Flyout: {0}",
mc);xb.c(Ee.a.EZg,!0,xb.e,0,0,mc);this.IAb=!0;Md.a.kz&&Md.a.kz.updateCommandUI(!0)};m.prototype.logFlightTriggers=function(){};m.prototype.toggleCatchUpFlyout=function(){this.IAb?this.buttonClickedCallback?this.buttonClickedCallback():hb.ULS.sendTraceTag(537168005,3012,10,"ToggleCatchUpFlyout: User clicked the button before the buttonClickedCallback was registered."):hb.ULS.sendTraceTag(537168006,3012,10,"ToggleCatchUpFlyout: User clicked the button before the flyout was initialized.")};m.prototype.onFlyoutVisibilityChanged=
function(mc){this.Pkb!==mc.flyoutIsVisible&&(this.Pkb=mc.flyoutIsVisible,Md.a.kz&&Md.a.kz.updateCommandUI(!0),this.Pkb||this.qYe&&this.qYe.Yyi())};uk.Object.defineProperties(m.prototype,{Lhf:{configurable:!0,enumerable:!0,get:function(){return this.Pkb}}});Object(Ca.a)(m,"FlyoutRibbonButton",null,[600]);var Ed=b(571);Object(Ca.a)(l,"CatchUpConfiguration",null,[]);Object(Ca.a)(e,"SharedControllerFactoryParameters",null,[]);c.prototype.dispose=function(){this.WHa&&this.WHa.getWywaEvent().removeListener(this.XIf);
this.WHa=this.$=null;Qd.a.Fa(this.W0a);this.flyoutRibbonButton=this.flyoutFocus=this.u6d=this.RAe=this.SAe=this.W0a=null};c.prototype.SYi=function(){this.flyoutRibbonButton.toggleCatchUpFlyout();return!0};c.prototype.Bzi=function(){hb.ULS.sendTraceTag(589608192,3012,50,"Catch Up script is loaded and Flyout is enabled.");this.Fff()&&hb.ULS.sendTraceTag(526718752,3012,50,"ActivityFeedData is enabled")};c.prototype.Fxi=function(mc,Rc){h("ScriptDownload");Pb.TaskExtensions.Ba(fb.GetServiceTaskFactory.Ua(this.$.da,
283,284,Rc),function(nd){mc(qd.c(nd.result.ho.loadScript("catchUpActivity")))},this.$.da.la,3)};c.prototype.V7a=function(){return!!this.Iof&&this.Iof.V7a()&&this.$.ea.w9a};c.prototype.Fff=function(){return Zd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ActivityFeedIsEnabled",!1)};c.prototype.AMi=function(mc){var Rc=this;Pb.TaskExtensions.Ba(mc,function(){od.a(function(){Rc.WHa=catchUpActivity.FactoryGlobal.getExcelCatchUpAppInstance(Object.assign(new e,{activityContentManager:Object(Of.a)(586,
Rc.u6d),activityNavigationManager:Object(Of.a)(587,Rc.RAe),activityRequestManager:Object(Of.a)(588,Rc.SAe),dataCulture:Rc.$.ya.DataCultureTag,flyoutFocus:null,flyoutRibbonButton:Object(Of.a)(m,Rc.flyoutRibbonButton),uiCulture:Rc.$.ya.UICultureTag,ulsLogger:new ad.a,emptyCatchUpBehaviorManager:Object(Of.a)(589,Rc.emptyCatchUpBehaviorManager)}))});Rc.W0a.RDg=Rc.WHa.getActivityIndicatorTooltipManager();Ed.a(Rc.$);Rc.WHa.getWywaEvent().addListener(Rc.XIf);h("InitializeCatchUpApp");Rc.WHa.initialize(Object.assign(new l,
{featuredActivityGroupsEnabled:!1,summaryStringEnabled:Rc.V7a(),includeRelevantAuthorsInSummaryString:!1,useCompactSummaryString:Zd.EwaSettings.isChangeGateEnabled("OfficeVSO:5788078_useCompactStringOnExcel"),activityFeedDataEnabled:Rc.Fff()}))},this.$.la,3)};uk.Object.defineProperties(c.prototype,{egf:{configurable:!0,enumerable:!0,get:function(){var mc=this.flyoutRibbonButton.IAb;mc&&!this.$$e&&(hb.ULS.sendTraceTag(588129368,3012,50,"Catch Up Flyout is ready and button is enabled."),this.$$e=!0);
return mc}},Rki:{configurable:!0,enumerable:!0,get:function(){return this.flyoutRibbonButton.Lhf}}});Object(Ca.a)(c,"CatchUpActivityManager",null,[590,3]);var ke=Sa.a;Am(a,ke);a.prototype.create=function(){var mc=this;Pb.TaskExtensions.Ba(fb.GetServiceTaskFactory.Ua(this.$.da,458,459,this.ub),function(Rc){Rc=Rc.result;mc.Eb(mc.$.da.Aa(286)||new c(mc.$,mc.ub,null,Rc))},this.$.la,3)};a.ka=function(mc){mc.da.Ha(287,new a(mc))};Object(Ca.a)(a,"CatchUpActivityManagerFactory",Sa.a,[]);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client");
Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Lineage");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.VersionHistory");Type.registerNamespace("_Ewa");wa.a.Ga(jb.ka);wa.a.Ga(Va.ka);wa.a.Ga(Wc.ka);wa.a.Ga(ua.ka);Hf.a.Ti('.LineageActivityPane{height:100%;display:flex;flex-direction:column;overflow:hidden;background-color:#edebe9}.LineageActivityPaneHeader{display:flex;flex-direction:row;position:relative;overflow:hidden;padding-right:16px;padding-left:16px;padding-top:16px;padding-bottom:11px;height:auto;background-color:#edebe9}.LineageActivityPaneTitle{max-width:240px;display:inline-flex;font-weight:bold;font-family:"Segoe UI Semi Bold","Segoe UI Web",Arial,Verdana,sans-serif;font-size:16px;line-height:16px;flex-grow:1;align-content:center;height:auto;text-overflow:ellipsis;overflow:hidden;background-color:#edebe9;margin:0}.LineageActivityCloseButton{display:inline-flex;align-self:center}.LineageActivityBody{height:100%;padding-left:16px;overflow:hidden;background-color:#edebe9}');
(function(){wa.a.Ga(function(mc){xa.ka(mc);$b.ka(mc);yb.ka(mc);Ua.ka(mc);Ta.ka(mc)})})();Type.registerNamespace("Common.App.CatchUpActivity");ka.main();(function(){wa.a.Ga(function(mc){h("Begin");a.ka(mc);ba.ka(mc)})})()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.catchup.js.map/491b1d4042ae6f1ebe514c41c6da03ab/EwaDS.catchup.js.map