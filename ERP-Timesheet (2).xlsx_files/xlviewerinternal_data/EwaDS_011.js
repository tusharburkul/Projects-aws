(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[29],{1443:function(z,F,b){function a(W){var ta=qi.call(this)||this;ta.$=W;ta.Xb();return ta}function c(W,ta){var ob=Ld.call(this)||this;ob.iqb=function(Kb,qc){Kb=qc.K5;var Bb=ob.gridView;qc=qc.vbi;var sd=qc.Qf,Vd=qc.W$;rf.a.dh&&Array.add(Vd,new A(sd,Bb));switch(Kb){case 24:Array.add(qc.W$,new y(sd,qc));break;case 0:Array.add(qc.W$,new t(sd,Bb));rf.a.zp||(Td.EwaSettings.isChangeGateEnabled("OfficeVSO:6170982_UseDragSelectionClickBehaviorTableRange")?
Array.add(Vd,new E(sd,ob.gridView.$,qc.paneType,ob.tableManager,ob.$o)):Array.add(Vd,new H(sd,ob.gridView.$,qc.paneType,ob.tableManager,ob.$o)));Array.add(Vd,new e(qc,sd,Bb,qc.paneType));break;case 3:Array.add(Vd,new S(sd));rf.a.zp||(Array.add(Vd,new O(sd,ob.gridView.$,qc.paneType,ob.Ay,ob.$o,qc)),Array.add(Vd,new u(sd,ob.gridView,ob.Ay,ob.$o,qc)),Array.add(Vd,new h(sd,ob.gridView,ob.Ay,ob.$o,qc)));break;case 4:case 5:Array.add(Vd,new n(sd));break;case 30:Array.add(Vd,new m(sd));break;case 16:Array.add(Vd,
new l(sd));Array.add(Vd,new B(qc,sd,Bb,qc.paneType));break;case 11:case 12:Array.add(Vd,new r(sd,11===Kb));break;case 17:Array.add(Vd,new S(sd));break;case 19:Array.add(Vd,new S(sd)),Array.add(Vd,new I(qc,sd,Bb,qc.paneType))}qc.k2b=!0};ob.$=W;ob.gridView=Ke.g(W);ob.tableManager=ta;ob.Ay=new v(ob.gridView);ob.$o=new ia(ob.gridView);ob.gridView.Fb&&(ob.gridView.Fb.gJg(ob.iqb),ob.gridView.Fb.update(!1));W.da.Ha(64,ob);return ob}function e(W,ta,ob,Kb){return P.call(this,W,ta,ob,Kb)||this}function l(W){var ta=
aa.call(this,W)||this;l.ctb(W,cg.a.bCh+" "+Xd.a.Bva);l.ctb(W,cg.a.aCh+" "+Xd.a.Bva);l.ctb(W,cg.a.YBh+" "+Xd.a.Bva);l.ctb(W,cg.a.$Bh+" "+Xd.a.Bva);l.ctb(W,Xd.a.ZBh);return ta}function m(W){var ta=aa.call(this,W)||this;appChrome.renderSpinner(W);return ta}function n(W){var ta=aa.call(this,W)||this;n.Nsb(W,cg.a.JBh+" "+Xd.a.Bva);n.Nsb(W,cg.a.IBh+" "+Xd.a.Bva);n.Nsb(W,cg.a.FBh+" "+Xd.a.Bva);n.Nsb(W,cg.a.HBh+" "+Xd.a.Bva);n.Nsb(W,Xd.a.GBh);return ta}function h(W,ta,ob,Kb,qc){var Bb=w.call(this,W,ta,ob,
Kb,qc)||this;Bb.MFb=function(){var sd=3===Hb.a.$b;Bb.Dvd&&!sd?Bb.$o.ULb(Bb.Rba,Bb.ZL,!1):!Bb.Dvd&&sd&&Bb.$o.ULb(Bb.Rba,Bb.ZL,!0);Bb.Dvd=sd};Bb.eWi=function(sd,Vd){Vd.Czb===Bb.Rba.oaa&&Bb.$o.ULb(Bb.Rba,Bb.ZL,!Vd.start&&Bb.oUd())};Hb.a.vre(Bb.MFb);Bb.Dvd=3===Hb.a.$b;Bb.$o.KJg(Bb.eWi);return Bb}function u(W,ta,ob,Kb,qc){return w.call(this,W,ta,ob,Kb,qc)||this}function w(W,ta,ob,Kb,qc){var Bb=aa.call(this,W)||this;Bb.cM=null;Bb.Za=null;Bb.n4=0;Bb.sourceRange=null;Bb.Nb=null;Bb.aUa=!1;Bb.onPointerDown=
function(sd){sd=Cf.a(Bb.$).se(sd);if(Bb.k6f(sd)&&!Bb.aUa){Bb.Vqf();Bb.Za=Bb.$o.Vfd();Bb.cM=Bb.$o.x6e(sd);if(!Bb.Za||!Bb.cM||!Bb.cM.range)return jc.ULS.shipAssertTag(537159361,0,!!Bb.Za,"ResizeMarqueeBehaviorBase.OnPointerDown: cellContentEditor is null"),jc.ULS.shipAssertTag(537159360,0,!!Bb.cM,"ResizeMarqueeBehaviorBase.OnPointerDown: selectedHighlightState is null"),jc.ULS.shipAssertTag(537159331,0,!!Bb.cM.range,"ResizeMarqueeBehaviorBase.OnPointerDown: selectedHighlightState.Range is null"),!1;
Bb.Nb=Bb.cM.range.clone();Bb.sourceRange=Bb.Nb.clone();Bb.n4=Bb.A2e(sd);if(4===Bb.n4)return jc.ULS.shipAssertTag(537159330,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: currentFixedCorner is not valid"),!1;var Vd=Bb.m4e(sd,!0);if(!Vd)return jc.ULS.shipAssertTag(537159329,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: mouseSelection is null. Not expect when clicking on handler."),!1;if(!Bb.$He(Vd))return jc.ULS.shipAssertTag(537159328,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: currentFixedCorner is not valid"),
!1;Bb.gridView.LMa=!0;Bb.Za.$E(!1);Bb.Ay.wNe(sd.Mb);Bb.$o.cPf(!0,Bb.Rba.oaa);Bb.Za.textBox.removeSelection();Bb.Za.a0b(Bb.j$e);Bb.pSf();Bb.aUa=!0;ud.b(Bb.$,!0)}return!0};Bb.j$e=function(){Bb.Mac(!0)};Bb.gridView=ta;Bb.$=ta.$;Bb.ZL=[];Bb.ga=Bb.gridView.ga;Bb.Ay=ob;Bb.$o=Kb;Bb.Rba=qc;Bb.coloredReferencesManager=Bb.$.da.Aa(281);jc.ULS.shipAssertTag(537159362,0,!!Bb.coloredReferencesManager,"ResizeMarqueeBehaviorBase Ctor: coloredReferencesManager is null. We already have marquee highlights so it shouldn't happen.");
ta=Cl(Bb.wXf());for(ob=ta.next();!ob.done;ob=ta.next())ob=Bb.$o.oHe(W,ob.value,Bb.zse(),Bb.onPointerDown),Array.add(Bb.ZL,ob);W=Cl(Bb.ZL);for(ta=W.next();!ta.done;ta=W.next())ta=ta.value,Pf.a.instance.qa(Sd.a.rX,ta,Object($e.a)(Bb.Ay,Bb.Ay.ocf,"hoveringStarted")),Pf.a.instance.qa(Sd.a.Ky,ta,Object($e.a)(Bb.Ay,Bb.Ay.pcf,"hoveringStopped"));Bb.r_a(qc);return Bb}function r(W,ta){var ob=aa.call(this,W)||this;var Kb=document.createElement("div"),qc=document.createElement("div");Kb.className=ta?Z.dCh:Z.fCh;
qc.className=ta?Z.eCh:Z.cCh;W.appendChild(Kb);W.appendChild(qc);return ob}function B(W,ta,ob,Kb){return P.call(this,W,ta,ob,Kb)||this}function y(W,ta){var ob=aa.call(this,W)||this;ob.bFf=function(){if(!ob.sv)return jc.ULS.shipAssertTag(537159364,0,!1,"RangeCatchUpActivityHighlightBehavior.OnPointerEnter: highlightController is null"),!1;ob.sv.tPf(ob.cI,!1);ob.sv.kPe(ob.cI,!1);if(3===ob.sv.model.state)return!0;ob.sv.kcf(!0);return!0};ob.kda=function(){if(!ob.sv)return!1;ob.sv.S8i();ob.sv.jOd(ob.cI,
!1);if(3===ob.sv.model.state)return!0;ob.sv.kcf(!1);return!0};ob.onPointerDown=function(Kb){return ob.sv?2===Kb.zb&&Kb.Vn===Sys.UI.MouseButton.leftButton?!0:!1:!1};ob.SFb=function(){if(!ob.sv)return!1;ob.sv.jOd(ob.cI,!0);ob.sv.tPf(ob.cI,!0);ob.sv.kPe(ob.cI,!0);ob.sv.XKb(!0);return!0};ob.onDoubleClick=function(Kb){if(Kb.Ca)return Kb.Ca.stopPropagation(),!0;jc.ULS.sendTraceTag(537159363,0,50,"CatchUpActivityHighlightBehavior::OnDoubleClick Double click event handled on Pill.");return!0};ob.sv=Object(Gc.a)(qg.a,
ta.metadata);ob.RK=document.createElement("div");ob.RK.id=String.format("{0}-{1}",W.id,fe.a.QAe);ob.RK.className=Ig.a.DZg;ob.cI=document.createElement("div");ob.cI.id=String.format("{0}-{1}",W.id,fe.a.c2c);ob.cI.className=Ig.a.c2c;ob.RK.appendChild(ob.cI);W.appendChild(ob.RK);jc.ULS.sendTraceTag(537159365,0,50,"RangeCatchUpActivityHighlightBehavior::RangeCatchUpActivityHighlightBehavior: An activity indicator has been created.");Pf.a.instance.qa(Sd.a.rX,ob.RK,ob.bFf);Pf.a.instance.qa(Sd.a.Ky,ob.RK,
ob.kda);Pf.a.instance.qa(Sd.a.pointerDown,ob.RK,ob.onPointerDown);Fg.a.instance.qa(Sd.a.click,ob.RK,ob.SFb);Fg.a.instance.qa(Sd.a.qk,ob.RK,ob.onDoubleClick);return ob}function v(W){var ta=this;this.zh=function(){ta.bsd=!1};this.Gp=function(){ta.bsd=!0};this.gridView=W;this.H6a=0;this.bsd=this.Iic=!1;this.w6=Number.NaN;this.gridView.ga.x3(this.Gp);this.gridView.ga.oZ(this.zh);this.gridView.ga.bYc(this.zh)}function A(W,ta){var ob=aa.call(this,W)||this;ob.ZWi=function(Kb){var qc=tf.HelperMethods.Km(Kb),
Bb=ob.Twa.i2d(Kb.clientPoint);if(!Bb)return!1;var sd=Bb.Df,Vd=ob.Twa.Da.l5a(sd.hashCode).kka(Bb.vJ);if(!Vd)return!1;Kb=sd.Ej.domElement;Bb=tf.HelperMethods.Xpe(tf.HelperMethods.yLa(sd.domElement,Kb),Bb.vJ);sd=0;Vd=ob.Twa.rc(Vd.getRange());for(var bf=0,Xf=A.eBe.length;bf<Xf;++bf){var vg=A.eBe[bf];if(128!==vg&&64!==vg||!ob.Twa.$.isEditMode){var kh=Vd.tLa(vg);if(kh&&kh.f7a&&"none"!==kh.f7a.style.display){kh=kh.f7a;var ki=tf.HelperMethods.yLa(kh,Kb);kh=new Sys.UI.Bounds(ki.x,ki.y,kh.offsetWidth,kh.offsetHeight);
if(za.a.IB(kh,Bb)){sd=vg;break}}}}return 0!==sd?(Vd.invoke(sd,qc),!0):!1};ob.ztg=ta;d.a.instance.qa(Sd.a.click,W,ob.ZWi);return ob}function t(W,ta){var ob=S.call(this,W)||this;ob.zh=function(){ob.domElement.classList.remove(Z.selecting);R.c(ob.gridView.$,!0,"FillHandleClickBehavior:OnSelectionEnded")};ob.Gp=function(){ob.domElement.classList.add(Z.selecting)};ob.onPointerDown=function(Kb){2===Kb.zb&&Kb.Vn===Sys.UI.MouseButton.leftButton&&(ob.gridView.ga.selectionType=4,ob.gridView.ga.sourceRange=
ob.gridView.ga.va.xd,R.c(ob.gridView.$,!1,"FillHandleClickBehavior:OnSelectionStarted"));return!1};ob.gda=function(){ob.gridView.$.ae(1983983164,2,30,null);return!0};ob.vd=function(){ef.DOMElementExtensions.setVisible(ob.kba,ob.gridView.$.isEditMode)};ob.l7=function(){ef.DOMElementExtensions.setVisible(ob.kba,!1)};ob.k7=function(){ef.DOMElementExtensions.setVisible(ob.kba,!0)};ob.yCf=function(){ef.DOMElementExtensions.setVisible(ob.kba,!1)};ob.xCf=function(){ef.DOMElementExtensions.setVisible(ob.kba,
!0)};ob.oFb=function(Kb,qc){ef.DOMElementExtensions.setVisible(ob.kba,!qc.roe)};ob.gridView=ta;ta=document.createElement("div");ta.className=Xd.a.WBh;ob.kba=ta;ob.vd(null,null);W.appendChild(ta);Pf.a.instance.qa(Sd.a.pointerDown,ob.kba,ob.onPointerDown);d.a.instance.qa(Sd.a.qk,ob.kba,ob.gda);ob.gridView.ga.x3(ob.Gp);ob.gridView.ga.oZ(ob.zh);ob.gridView.$.fl(ob.vd);ob.gridView.$.yb.v0b(ob.l7);ob.gridView.$.yb.u0b(ob.k7);ob.gridView.Pqe(ob.oFb);ob.gridView.Ac.wl(ob.yCf);ob.gridView.Ac.Wo(ob.xCf);return ob}
function E(W,ta,ob,Kb,qc){var Bb=C.call(this,W,ta,ob,qc)||this;Bb.mA=null;Bb.Uq=!1;Bb.Tq=!1;Bb.oCb=0;Bb.onKeyDown=function(sd){if(Bb.Zh){if(Bb.Cla(sd)||sd.Ca.keyCode===x.a.wfa)return Bb.MNa||(Bg.KeyInputManager.instance.qa(Sd.a.Td,Bb.domElement.ownerDocument.body,Bb.onKeyUp),Bb.MNa=!0),!Bb.ru&&Bb.Cla(sd)&&(Ke.g(Bb.$).Lg.Np(E.Esb),Bb.ru=!0),Bb.su||sd.Ca.keyCode!==x.a.wfa||(Ke.g(Bb.$).Lg.Np(ea.nub),Bb.su=!0,2===Bb.Pn?(Bb.wH(!1),Bb.hF=0,Bb.Di=Bb.Tq?[11]:[12],Bb.Uq=Bb.Tq,Bb.ARa(),Bb.IP()):3===Bb.Pn?(Bb.W3(!1),
Bb.hF=Bb.isRow?1:2,Bb.K7(),Bb.jE()):1===Bb.Pn&&(Bb.$Ha(!1),Bb.K7(),Bb.jE())),!0}else if(!Bb.ru&&(sd.Ca.keyCode===x.a.X8||rf.a.isMac&&sd.Ca.keyCode===x.a.Upa))return Bg.KeyInputManager.instance.qa(Sd.a.Td,Bb.domElement.ownerDocument.body,Bb.onKeyUp),Ke.g(Bb.$).Lg.Np(E.Esb),Bb.ru=!0;return!1};Bb.onKeyUp=function(sd){if(Bb.Zh){if(Bb.Cla(sd)||sd.Ca.keyCode===x.a.wfa)return Bb.oCb=Bb.Cla(sd)?0:1,Bb.Gs&&Ke.g(Bb.$).Lg.Np(ea.nub),sd.Ca.keyCode===x.a.wfa&&(2===Bb.Pn?(Bb.W3(!1),Bb.hF=0,Bb.K7(!0),Bb.jE(!0)):
3===Bb.Pn?(Bb.wH(!1),Bb.hF=Bb.isRow?1:2,Bb.Di=Bb.isRow?[11]:[12],Bb.ARa(!0),Bb.IP(!0)):1===Bb.Pn&&(Bb.wH(!1),Bb.Di=Bb.Tq?[11]:[12],Bb.JIb(!0),Bb.IP(!0))),Bb.Jpa(Bb.oCb),!0}else if(sd.Ca.keyCode===x.a.X8||rf.a.isMac&&sd.Ca.keyCode===x.a.Upa)return Bb.Jpa(),Bb.Gs&&Ke.g(Bb.$).Lg.Np(ea.W9c),!0;return!1};Bb.fX=function(sd){sd=Cf.a(Bb.$).se(sd);5===Bb.Tj?Bb.AEd(sd):(Bb.Gs=!1,Bb.Fb.si(Bb.Di),!Bb.$.Br([Bb.Nb],!1)||Bb.kKd()||Bb.kBb()||(Bb.ga.sourceRange=Bb.sourceRange.clone(),Bb.Zh?Bb.OId():Bb.ovb(),Bb.Vw()?
Bb.Nb.top>Bb.sourceRange.top&&(sd=Bb.Nb.height,Bb.Nb.top-=sd,Bb.Nb.bottom-=sd):Bb.Nb.left>Bb.sourceRange.left&&(sd=Bb.Nb.width,Bb.Nb.left-=sd,Bb.Nb.right-=sd),Bb.mP()));Bb.du(Bb.eX,Bb.fX);Bb.tableRange=null;Bb.Tj=-1;Bb.Zh&&(Bb.mA=null,Bb.Pn=0);return!0};Bb.h7=function(){Bb.Gs=!1;Bb.Pn=0;Bb.Fb.si(Bb.Di);if(!Bb.$.Br([Bb.Nb],!1))return Bb.du(Bb.g7,Bb.h7),Bb.Tj=-1,!0;if(!(Bb.ga.va.xd.equals(Bb.Nb)||Bb.vla(Bb.Nb)||Bb.vla(Bb.sourceRange)||Bb.kBb())){Bb.mP();Bb.ga.sourceRange=Bb.sourceRange.clone();var sd=
Bb.ga.sourceRange,Vd=Bb.ga.va.xd,bf={};Bb.$.ae(-694765314,2,30,(bf[fe.a.eva]=Bb.ru,bf[fe.a.a9b]=!0,bf[fe.a.b9b]=Bb.Uq,bf[fe.a.I4]=sd,bf[fe.a.H4]=Vd,bf[fe.a.iub]=Bb.su,bf));Bb.ru||(Bb.Nb.top>Bb.sourceRange.top&&(Bb.isRow||Bb.Nb.left===Bb.sourceRange.left&&Bb.Uq)?(sd=Bb.Nb.height,Bb.Nb.top-=sd,Bb.Nb.bottom-=sd):Bb.Nb.left>Bb.sourceRange.left&&(Bb.Xf||Bb.Nb.top===Bb.sourceRange.top&&!Bb.Uq)&&(sd=Bb.Nb.width,Bb.Nb.left-=sd,Bb.Nb.right-=sd),Bb.mP())}Bb.du(Bb.g7,Bb.h7);Bb.tableRange=null;Bb.mA=null;Bb.Tj=
-1;Bb.Uq=!1;return!0};Bb.eX=function(sd){var Vd=Td.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");Vd&&(sd=Cf.a(Bb.$).se(sd));var bf=sd.clientPoint;Vd||(sd=Cf.a(Bb.$).se(sd));Bb.Zh&&(Bb.RB=sd);if(sd=Bb.ga.Ip(bf,sd.Mb,5,void 0,void 0,!0)){if(Bb.tableRange.contains(sd.topLeft)){Vd=Ke.g(Bb.$);var Xf=Vd.jg(sd),vg=Vd.Kf(Bb.paneType);bf=ff.a.Vs(vg.view.Ng,Bb.domElement.parentNode,bf,Vd.rtl);vg=!1;var kh=2;Bb.Vw()&&bf.y-Xf.topLeft.y>Xf.height/2?(vg=!0,kh=1):!Bb.Vw()&&
bf.x-Xf.topLeft.x>Xf.width/2&&(vg=!0);if(vg){Vd=Vd.Pk("DragSelectionClickBehaviorTableRange.OnPointerMoveRearrange",Vd.vB,kh);try{Vd.Js(sd),Vd.$$mn(),sd=Vd.$$cu().range}finally{Vd&&Vd.dispose()}}Bb.Nb=Bb.NHa(sd);Bb.ga.sourceRange=Bb.Nb;Bb.Fb.ak(Bb.Nb,Bb.Di);Bb.Fb.co(Bb.Di);Bb.Fb.si(Bb.eD());if(6!==Bb.Tj){for(sd=1;4>=sd;sd++)Vd=Bb.mi[sd.toString()],Vd.parentNode.removeChild(Vd),Bb.Fb.Iw(Bb.Vw()?11:12,sd).Qf.appendChild(Vd);Bb.Tj=6}}else if(Bb.Nb=Bb.yia(sd),Bb.Zh)Bb.gyb(!1);else if(Bb.Fb.ak(Bb.Nb,Bb.eD()),
Bb.Fb.co(Bb.eD()),Bb.Fb.si(Bb.Di),5!==Bb.Tj){for(sd=1;4>=sd;sd++)Vd=Bb.mi[sd.toString()],Vd.parentNode.removeChild(Vd),Bb.Fb.Iw(Bb.uka(),sd).Qf.appendChild(Vd);Bb.Tj=5}Bb.HG()}return!0};Bb.g7=function(sd){var Vd=Td.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");Vd&&(sd=Cf.a(Bb.$).se(sd));var bf=sd.clientPoint;Vd||(sd=Cf.a(Bb.$).se(sd));Bb.RB=sd;if(Vd=Bb.ga.Ip(bf,sd.Mb,5,void 0,void 0,!0)){if(Bb.yyb(Vd))return Bb.Nb=Bb.yia(Vd),Bb.fyb(!1),!0;var Xf=Ke.g(Bb.$),vg=
Xf.jg(Vd),kh=Xf.Kf(Bb.paneType);bf=ff.a.Vs(kh.view.Ng,Bb.domElement.parentNode,bf,Xf.rtl);kh=!1;var ki=2;Bb.Uq=!1;if(Bb.isRow||Bb.Xf){Bb.isRow&&bf.y-vg.topLeft.y>vg.height/2?(kh=!0,ki=1):Bb.Xf&&bf.x-vg.topLeft.x>vg.width/2&&(kh=!0);if(kh){sd=Xf.Pk("DragSelectionClickBehaviorTableRange.OnPointerMoveDragInsert",Xf.vB,ki);try{sd.Js(Vd),sd.$$mn(),Vd=sd.$$cu().range}finally{sd&&sd.dispose()}}Bb.Nb=Bb.yia(Vd)}else{bf.x-vg.topLeft.x===vg.width?(Bb.Uq=!1,kh=!0):bf.y-vg.topLeft.y>vg.height/2&&(kh=!0,Bb.Uq=
!0,ki=1);Bb.mA&&(Bb.Uq=Bb.Tq);if(kh){Xf=Xf.Pk("DragSelectionClickBehaviorTableRange.OnPointerMoveDragInsert",Xf.vB,ki);try{Xf.Js(Vd),Xf.$$mn(),Vd=Xf.$$cu().range}finally{Xf&&Xf.dispose()}}Bb.Fb.si(Bb.Di);Bb.Di=Bb.Uq?[11]:[12];for(Xf=1;4>=Xf;Xf++)(vg=Bb.mi[Xf.toString()])&&vg.parentNode.removeChild(vg),Bb.mi[Xf.toString()]=null;Bb.cE(sd.clientPoint,sd.Mb,Bb.Uq?11:12,!0);Bb.Nb=Bb.NHa(Vd)}Bb.ga.sourceRange=Bb.Nb;Bb.Fb.ak(Bb.Nb,Bb.Di);Bb.Fb.co(Bb.Di);Bb.Fb.si(Bb.eD());if(6!==Bb.Tj){for(sd=1;4>=sd;sd++)Vd=
Bb.mi[sd.toString()],Vd.parentNode.removeChild(Vd),Bb.Fb.Iw(Bb.isRow||Bb.Uq?11:12,sd).Qf.appendChild(Vd);Bb.Tj=6}Bb.HG()}return!0};Bb.lGb=function(){Bb.Zh?Bb.Gs&&5<=Bb.Tj&&(Bb.tableRange?Bb.su?Bb.wH(!0):Bb.$Ha(!0):Bb.su?Bb.isRow||Bb.Xf?Bb.wH(!0):Bb.W3(!0):Bb.isRow||Bb.Xf?Bb.W3(!0):Bb.wH(!0)):Bb.Gs&&5<=Bb.Tj&&(Bb.tableRange?(Bb.Fb.si(Bb.Di),Bb.du(Bb.eX,Bb.fX)):(Bb.Fb.si(Bb.eD()),Bb.du(Object($e.a)(Bb,Bb.Uh,"onPointerMove"),Object($e.a)(Bb,Bb.Sf,"onPointerUp"))))};Bb.tableManager=Kb;Bb.tableRange=null;
Bb.ga.bYc(Bb.lGb);return Bb}function C(W,ta,ob,Kb){var qc=ea.call(this,W,ta,ob,Kb)||this;qc.tja=Ee.a.instance.fa(2200);qc.lub=Ee.a.instance.fa(2201);qc.Roa=Ee.a.instance.fa(2202);qc.sMb=Ee.a.instance.fa(2203);qc.Di=null;qc.isRow=!1;qc.Xf=!1;qc.rN=null;qc.oP=null;qc.Pn=0;qc.zh=function(){qc.domElement.classList.remove(Z.selecting)};qc.Gp=function(){qc.domElement.classList.add(Z.selecting)};qc.ld=function(){if(qc.$.isEditMode){var Bb=qc.pUd();qc.iyc(Bb)}};qc.mi={};qc.Gs=!1;qc.ru=!1;qc.su=!1;qc.MNa=
!1;qc.ga.x3(qc.Gp);qc.ga.oZ(qc.zh);qc.ga.WE(qc.ld);return qc}function H(W,ta,ob,Kb,qc){var Bb=ea.call(this,W,ta,ob,qc)||this;Bb.tja=Ee.a.instance.fa(2200);Bb.lub=Ee.a.instance.fa(2201);Bb.Roa=Ee.a.instance.fa(2202);Bb.sMb=Ee.a.instance.fa(2203);Bb.Di=null;Bb.mA=null;Bb.Uq=!1;Bb.isRow=!1;Bb.Xf=!1;Bb.Tq=!1;Bb.rN=null;Bb.oP=null;Bb.oCb=0;Bb.Pn=0;Bb.onKeyDown=function(sd){if(Bb.Zh){if(Bb.Cla(sd)||sd.Ca.keyCode===x.a.wfa)return Bb.MNa||(Bg.KeyInputManager.instance.qa(Sd.a.Td,Bb.domElement.ownerDocument.body,
Bb.onKeyUp),Bb.MNa=!0),!Bb.ru&&Bb.Cla(sd)&&(Ke.g(Bb.$).Lg.Np(H.Esb),Bb.ru=!0),Bb.su||sd.Ca.keyCode!==x.a.wfa||(Ke.g(Bb.$).Lg.Np(ea.nub),Bb.su=!0,2===Bb.Pn?(Bb.wH(!1),Bb.hF=0,Bb.Di=Bb.Tq?[11]:[12],Bb.Uq=Bb.Tq,Bb.ARa(),Bb.IP()):3===Bb.Pn?(Bb.W3(!1),Bb.hF=Bb.isRow?1:2,Bb.K7(),Bb.jE()):1===Bb.Pn&&(Bb.$Ha(!1),Bb.K7(),Bb.jE())),!0}else if(!Bb.ru&&(sd.Ca.keyCode===x.a.X8||rf.a.isMac&&sd.Ca.keyCode===x.a.Upa))return Bg.KeyInputManager.instance.qa(Sd.a.Td,Bb.domElement.ownerDocument.body,Bb.onKeyUp),Ke.g(Bb.$).Lg.Np(H.Esb),
Bb.ru=!0;return!1};Bb.onKeyUp=function(sd){if(Bb.Zh){if(Bb.Cla(sd)||sd.Ca.keyCode===x.a.wfa)return Bb.oCb=Bb.Cla(sd)?0:1,Bb.Gs&&Ke.g(Bb.$).Lg.Np(ea.nub),sd.Ca.keyCode===x.a.wfa&&(2===Bb.Pn?(Bb.W3(!1),Bb.hF=0,Bb.K7(!0),Bb.jE(!0)):3===Bb.Pn?(Bb.wH(!1),Bb.hF=Bb.isRow?1:2,Bb.Di=Bb.isRow?[11]:[12],Bb.ARa(!0),Bb.IP(!0)):1===Bb.Pn&&(Bb.wH(!1),Bb.Di=Bb.Tq?[11]:[12],Bb.JIb(!0),Bb.IP(!0))),Bb.Jpa(Bb.oCb),!0}else if(sd.Ca.keyCode===x.a.X8||rf.a.isMac&&sd.Ca.keyCode===x.a.Upa)return Bb.Jpa(),Bb.Gs&&Ke.g(Bb.$).Lg.Np(ea.W9c),
!0;return!1};Bb.fX=function(sd){sd=Cf.a(Bb.$).se(sd);5===Bb.Tj?Bb.AEd(sd):(Bb.Gs=!1,Bb.Fb.si(Bb.Di),!Bb.$.Br([Bb.Nb],!1)||Bb.kKd()||Bb.kBb()||(Bb.ga.sourceRange=Bb.sourceRange.clone(),Bb.Zh?Bb.OId():Bb.ovb(),Bb.Vw()?Bb.Nb.top>Bb.sourceRange.top&&(sd=Bb.Nb.height,Bb.Nb.top-=sd,Bb.Nb.bottom-=sd):Bb.Nb.left>Bb.sourceRange.left&&(sd=Bb.Nb.width,Bb.Nb.left-=sd,Bb.Nb.right-=sd),Bb.mP()));Bb.du(Bb.eX,Bb.fX);Bb.tableRange=null;Bb.Tj=-1;Bb.Zh&&(Bb.mA=null,Bb.Pn=0);return!0};Bb.h7=function(){Bb.Gs=!1;Bb.Pn=
0;Bb.Fb.si(Bb.Di);if(!Bb.$.Br([Bb.Nb],!1))return Bb.du(Bb.g7,Bb.h7),Bb.Tj=-1,!0;if(!(Bb.ga.va.xd.equals(Bb.Nb)||Bb.vla(Bb.Nb)||Bb.vla(Bb.sourceRange)||Bb.kBb())){Bb.mP();Bb.ga.sourceRange=Bb.sourceRange.clone();var sd=Bb.ga.sourceRange,Vd=Bb.ga.va.xd,bf={};Bb.$.ae(-694765314,2,30,(bf[fe.a.eva]=Bb.ru,bf[fe.a.a9b]=!0,bf[fe.a.b9b]=Bb.Uq,bf[fe.a.I4]=sd,bf[fe.a.H4]=Vd,bf[fe.a.iub]=Bb.su,bf));Bb.ru||(Bb.Nb.top>Bb.sourceRange.top&&(Bb.isRow||Bb.Nb.left===Bb.sourceRange.left&&Bb.Uq)?(sd=Bb.Nb.height,Bb.Nb.top-=
sd,Bb.Nb.bottom-=sd):Bb.Nb.left>Bb.sourceRange.left&&(Bb.Xf||Bb.Nb.top===Bb.sourceRange.top&&!Bb.Uq)&&(sd=Bb.Nb.width,Bb.Nb.left-=sd,Bb.Nb.right-=sd),Bb.mP())}Bb.du(Bb.g7,Bb.h7);Bb.tableRange=null;Bb.mA=null;Bb.Tj=-1;Bb.Uq=!1;return!0};Bb.eX=function(sd){var Vd=Td.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");Vd&&(sd=Cf.a(Bb.$).se(sd));var bf=sd.clientPoint;Vd||(sd=Cf.a(Bb.$).se(sd));Bb.Zh&&(Bb.RB=sd);if(sd=Bb.ga.Ip(bf,sd.Mb,5,void 0,void 0,!0)){if(Bb.tableRange.contains(sd.topLeft)){Vd=
Ke.g(Bb.$);var Xf=Vd.jg(sd),vg=Vd.Kf(Bb.paneType);bf=ff.a.Vs(vg.view.Ng,Bb.domElement.parentNode,bf,Vd.rtl);vg=!1;var kh=2;Bb.Vw()&&bf.y-Xf.topLeft.y>Xf.height/2?(vg=!0,kh=1):!Bb.Vw()&&bf.x-Xf.topLeft.x>Xf.width/2&&(vg=!0);if(vg){Vd=Vd.Pk("DragSelectionClickBehavior.OnPointerMoveRearrange",Vd.vB,kh);try{Vd.Js(sd),Vd.$$mn(),sd=Vd.$$cu().range}finally{Vd&&Vd.dispose()}}Bb.Nb=Bb.NHa(sd);Bb.ga.sourceRange=Bb.Nb;Bb.Fb.ak(Bb.Nb,Bb.Di);Bb.Fb.co(Bb.Di);Bb.Fb.si(Bb.eD());if(6!==Bb.Tj){for(sd=1;4>=sd;sd++)Vd=
Bb.mi[sd.toString()],Vd.parentNode.removeChild(Vd),Bb.Fb.Iw(Bb.Vw()?11:12,sd).Qf.appendChild(Vd);Bb.Tj=6}}else if(Bb.Nb=Bb.yia(sd),Bb.Zh)Bb.gyb(!1);else if(Bb.Fb.ak(Bb.Nb,Bb.eD()),Bb.Fb.co(Bb.eD()),Bb.Fb.si(Bb.Di),5!==Bb.Tj){for(sd=1;4>=sd;sd++)Vd=Bb.mi[sd.toString()],Vd.parentNode.removeChild(Vd),Bb.Fb.Iw(Bb.uka(),sd).Qf.appendChild(Vd);Bb.Tj=5}Bb.HG()}return!0};Bb.g7=function(sd){var Vd=Td.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");Vd&&(sd=Cf.a(Bb.$).se(sd));
var bf=sd.clientPoint;Vd||(sd=Cf.a(Bb.$).se(sd));Bb.RB=sd;if(Vd=Bb.ga.Ip(bf,sd.Mb,5,void 0,void 0,!0)){if(Bb.yyb(Vd))return Bb.Nb=Bb.yia(Vd),Bb.fyb(!1),!0;var Xf=Ke.g(Bb.$),vg=Xf.jg(Vd),kh=Xf.Kf(Bb.paneType);bf=ff.a.Vs(kh.view.Ng,Bb.domElement.parentNode,bf,Xf.rtl);kh=!1;var ki=2;Bb.Uq=!1;if(Bb.isRow||Bb.Xf){Bb.isRow&&bf.y-vg.topLeft.y>vg.height/2?(kh=!0,ki=1):Bb.Xf&&bf.x-vg.topLeft.x>vg.width/2&&(kh=!0);if(kh){sd=Xf.Pk("DragSelectionClickBehavior.OnPointerMoveDragInsert",Xf.vB,ki);try{sd.Js(Vd),
sd.$$mn(),Vd=sd.$$cu().range}finally{sd&&sd.dispose()}}Bb.Nb=Bb.yia(Vd)}else{bf.x-vg.topLeft.x===vg.width?(Bb.Uq=!1,kh=!0):bf.y-vg.topLeft.y>vg.height/2&&(kh=!0,Bb.Uq=!0,ki=1);Bb.mA&&(Bb.Uq=Bb.Tq);if(kh){Xf=Xf.Pk("DragSelectionClickBehavior.OnPointerMoveDragInsert",Xf.vB,ki);try{Xf.Js(Vd),Xf.$$mn(),Vd=Xf.$$cu().range}finally{Xf&&Xf.dispose()}}Bb.Fb.si(Bb.Di);Bb.Di=Bb.Uq?[11]:[12];for(Xf=1;4>=Xf;Xf++)(vg=Bb.mi[Xf.toString()])&&vg.parentNode.removeChild(vg),Bb.mi[Xf.toString()]=null;Bb.cE(sd.clientPoint,
sd.Mb,Bb.Uq?11:12,!0);Bb.Nb=Bb.NHa(Vd)}Bb.ga.sourceRange=Bb.Nb;Bb.Fb.ak(Bb.Nb,Bb.Di);Bb.Fb.co(Bb.Di);Bb.Fb.si(Bb.eD());if(6!==Bb.Tj){for(sd=1;4>=sd;sd++)Vd=Bb.mi[sd.toString()],Vd.parentNode.removeChild(Vd),Bb.Fb.Iw(Bb.isRow||Bb.Uq?11:12,sd).Qf.appendChild(Vd);Bb.Tj=6}Bb.HG()}return!0};Bb.zh=function(){Bb.domElement.classList.remove(Z.selecting)};Bb.Gp=function(){Bb.domElement.classList.add(Z.selecting)};Bb.ld=function(){if(Bb.$.isEditMode){var sd=Bb.pUd();Bb.iyc(sd)}};Bb.lGb=function(){Bb.Zh?Bb.Gs&&
5<=Bb.Tj&&(Bb.tableRange?Bb.su?Bb.wH(!0):Bb.$Ha(!0):Bb.su?Bb.isRow||Bb.Xf?Bb.wH(!0):Bb.W3(!0):Bb.isRow||Bb.Xf?Bb.W3(!0):Bb.wH(!0)):Bb.Gs&&5<=Bb.Tj&&(Bb.tableRange?(Bb.Fb.si(Bb.Di),Bb.du(Bb.eX,Bb.fX)):(Bb.Fb.si(Bb.eD()),Bb.du(Object($e.a)(Bb,Bb.Uh,"onPointerMove"),Object($e.a)(Bb,Bb.Sf,"onPointerUp"))))};Bb.tableManager=Kb;Bb.tableRange=null;Bb.mi={};Bb.Gs=!1;Bb.ru=!1;Bb.su=!1;Bb.MNa=!1;Bb.ga.x3(Bb.Gp);Bb.ga.oZ(Bb.zh);Bb.ga.bYc(Bb.lGb);Bb.ga.WE(Bb.ld);return Bb}function U(W,ta){this.destinationRange=
this.sourceRange=null;this.sourceRange=W;this.destinationRange=ta}function Q(W,ta,ob,Kb,qc,Bb,sd,Vd){Vd=W.Ma(41,void 0===Vd?null:Vd);Vd.sourceRange=ta;Vd.destinationRange=ob;return $h.i(W,"RearrangeRowColumn",Vd,Kb,qc,Bb,sd,0)}function O(W,ta,ob,Kb,qc,Bb){var sd=ea.call(this,W,ta,ob,qc)||this;sd.cM=null;sd.Za=null;sd.i$e=function(){sd.svb(!0)};sd.gridView=Ke.g(sd.$);sd.Ay=Kb;sd.coloredReferencesManager=sd.$.da.Aa(281);jc.ULS.shipAssertTag(537159391,0,!!sd.coloredReferencesManager,"DragMarqueeClickBehavior Ctor: coloredReferencesManager is null. We already have marquee highlights so it shouldn't happen.");
W=Cl(sd.zs);for(ta=W.next();!ta.done;ta=W.next())ta=ta.value,Pf.a.instance.qa(Sd.a.rX,ta,Object($e.a)(sd.Ay,sd.Ay.ocf,"hoveringStarted")),Pf.a.instance.qa(Sd.a.Ky,ta,Object($e.a)(sd.Ay,sd.Ay.pcf,"hoveringStopped"));sd.r_a(Bb);return sd}function ea(W,ta,ob,Kb){var qc=S.call(this,W)||this;qc.aUa=!1;qc.ooe=null;qc.noe=null;qc.Psa=0;qc.Zh=Td.EwaSettings.getBooleanFeatureGate(cf.a.$8b,!1);qc.hF=0;qc.hgc=0;qc.WEc=0;qc.Ina=null;qc.sourceRange=null;qc.Nb=null;qc.RB=null;qc.onPointerDown=function(Bb){Bb=Cf.a(qc.$).se(Bb);
if(2===Bb.zb&&Bb.Vn===Sys.UI.MouseButton.leftButton&&!qc.aUa){var sd=qc.aec(Bb);if(!sd)return jc.ULS.shipAssertTag(537159379,0,!1,"DragSelectionClickBehaviorBase.OnPointerDown: GetSelectedRange failed"),!1;qc.Nb=sd.clone();qc.sourceRange=qc.Nb.clone();qc.Ina=qc.Nb;if(sd=qc.yYh(Bb))qc.Tj=5,qc.WEc=sd.top-qc.sourceRange.top,qc.hgc=sd.left-qc.sourceRange.left,Ke.g(qc.$).Lg.Np(qc.Zh?ea.nub:ea.W9c),qc.yEd(Bb),qc.aUa=!0,ud.b(qc.$,!0)}return!1};qc.vd=function(Bb,sd){sd.eL||qc.iyc(qc.$.isEditMode)};qc.zs=
[];qc.$=ta;qc.ga=Ke.g(qc.$).ga;qc.paneType=ob;qc.$o=Kb;ta=Td.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");ob=rf.a.uf;ta=Cl(ta&&!ob?[Z.SBh,Z.LBh,Z.OBh,Z.QBh]:[Z.TBh,Z.MBh,Z.PBh,Z.RBh]);for(ob=ta.next();!ob.done;ob=ta.next())ob=qc.$o.oHe(W,ob.value,qc.Zh?[Z.NBh]:[Z.KBh],qc.onPointerDown),Array.add(qc.zs,ob);qc.$.fl(qc.vd);qc.iyc(qc.$.isEditMode);return qc}function Z(){}function S(W){var ta=aa.call(this,W)||this;var ob=document.createElement("div");ob.className=Xd.a.XBh;W.appendChild(ob);
return ta}function I(W,ta,ob,Kb){return P.call(this,W,ta,ob,Kb)||this}function P(W,ta,ob,Kb){var qc=aa.call(this,ta)||this;qc.Ppb=!1;qc.sZc=!1;qc.xud=!1;qc.grb=null;qc.uud=!1;qc.jca=!1;qc.ax=function(){qc.Ppb&&qc.uud?qc.Woa():qc.H5()};qc.ECf=function(sd){3===sd.zb&&(qc.uud=!0,qc.Woa());return!1};qc.FCf=function(sd){if(3===sd.zb){if(!sd.Mb||qc.Jmi(sd))return!1;qc.uud=!1;qc.H5()}return!1};qc.zh=function(){qc.jca&&qc.V_d();qc.Woa();qc.xud=!1};qc.Gp=function(){qc.H5();qc.xud=!0};qc.Pza=function(sd,Vd){Vd.K5===
qc.K5&&(Vd.visible?qc.xud||qc.Woa():qc.H5())};qc.mIf=function(){qc.GCf(qc.HP.domElement,!1)};qc.Oyf=function(){qc.GCf(qc.dN.domElement,!0)};qc.upc=function(sd,Vd){qc.ga.EAa(Vd)};qc.vpc=function(sd,Vd){qc.ga.EAa(ec.b(Vd))};qc.MFb=function(){3===Hb.a.$b?qc.Woa():qc.H5();qc.jca&&1===Hb.a.$b&&qc.V_d()};qc.nIf=function(){qc.euj()};qc.QNe=function(){qc.H5()};qc.Fp=function(){qc.ga.Pa.nc&&qc.H5()};qc.Cyf=function(){qc.H5()};qc.wCf=function(sd,Vd){qc.V_d();3===Vd.zb?qc.Woa():qc.H5()};qc.utc=function(){qc.Ppb&&
(qc.H5(),qc.Woa())};var Bb=ob.$;qc.aw=ob;qc.ga=ob.ga;qc.Rba=W;qc.Grj=ta;qc.paneType=Kb;W=qc.domElement.currentStyle;ta="#000000";W&&(ta=W.borderTopColor);qc.HP=new J(qc.Mdd(),ta,Bb);qc.dN=new J(qc.Mdd(),ta,Bb);qc.sjf=Bb.ea.isNamedObjectViewMode&&1===Bb.workbookContext.NovMode;qc.HP.kre(qc.mIf);qc.HP.jre(qc.upc);qc.HP.lre(qc.vpc);qc.dN.kre(qc.Oyf);qc.dN.jre(qc.upc);qc.dN.lre(qc.vpc);W=Cl(qc.gridView.zn);for(ta=W.next();!ta.done;ta=W.next())ta=ta.value,Mf.a.instance.qa(Sd.a.Mf,ta.domElement,qc.FCf),
Mf.a.instance.qa(Sd.a.Ce,ta.domElement,qc.ECf);ob.view.nt(qc.ax);ob.zc.wl(qc.QNe);ob.Fb.ppb(qc.Pza);ob.L_b(qc.Cyf);Bb.aB(qc.utc);ob.yr(qc.utc);qc.ga.oZ(qc.zh);qc.ga.x3(qc.Gp);ob.RE(qc.Fp);qc.ga.R_b(qc.wCf);Hb.a.vre(qc.MFb);Le.TaskExtensions.Ba(ug.GetServiceTaskFactory.Ua(Bb.da,376,377,0),function(sd){sd.result.pLg(qc.nIf)},Bb.la,3);return qc}function J(W,ta,ob){var Kb=xe.call(this,document.createElement("div"))||this;Kb.e7b=null;Kb.wQb=!1;Kb.onPointerDown=function(Bb){Bb=Cf.a(Kb.$)?Cf.a(Kb.$).se(Bb):
Bb;Kb.wQb=!1;if(3===(Hb.a.$b=Bb.zb)){var sd=Bb.Ca.rawEvent,Vd=sd.srcElement||sd.target;ef.DOMElementExtensions.Se(Kb.domElement,Vd)&&ef.DOMElementExtensions.Se(sd.currentTarget,Vd)&&(Kb.wQb=!0,Kb.e7b=Bb.clientPoint)}return!1};Kb.Sf=function(Bb){Bb=Cf.a(Kb.$)?Cf.a(Kb.$).se(Bb):Bb;Kb.raiseEvent("GrPointerUp",Bb);return Kb.wQb=!1};Kb.Uh=function(Bb){Bb=Cf.a(Kb.$)?Cf.a(Kb.$).se(Bb):Bb;3===Bb.zb&&Kb.wQb&&Kb.Q$h(Bb.clientPoint)&&(Kb.raiseEvent("GrDrag"),Kb.wQb=!1);return!1};Kb.dd=function(Bb){Cf.a(Kb.$)&&
Cf.a(Kb.$).se(Bb);return!0};Kb.$=ob;ob=Td.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");var qc=rf.a.uf;Kb.domElement.classList.add(!ob||qc?Xd.a.HUe:Xd.a.GUe);Kb.domElement.classList.add(Xd.a.H$b);W.appendChild(Kb.domElement);ef.DOMElementExtensions.setVisible(Kb.domElement,!1);Kb.ZLa=document.createElement("div");Kb.ZLa.classList.add(Xd.a.G$b);Kb.ZLa.style.borderColor=ta;Kb.domElement.appendChild(Kb.ZLa);Pf.a.instance.qa(Sd.a.pointerDown,Kb.domElement,Kb.onPointerDown);Pf.a.instance.qa(Sd.a.$d,
Kb.domElement,Kb.Sf);Mf.a.instance.qa(Sd.a.Ce,Kb.domElement,Kb.Sf);Pf.a.instance.qa(Sd.a.ph,Kb.domElement,Kb.Uh);Mf.a.instance.qa(Sd.a.Dg,Kb.domElement,Kb.Uh);d.a.instance.qa(Sd.a.click,Kb.domElement,Kb.dd);return Kb}function aa(W,ta){return Db.call(this,W,void 0===ta?null:ta)||this}function ia(W){var ta=Ra.call(this)||this;ta.gtf=[3];ta.gridView=W;return ta}function ba(W,ta){var ob=Y.call(this)||this;ob.start=W;ob.Czb=ta;return ob}function ra(W){var ta=ni.call(this)||this;ta.$=W;ta.Xb();return ta}
function ka(W){var ta=Hg.call(this)||this;W.da.Ha(376,ta);return ta}function da(W){var ta=yi.call(this)||this;ta.$=W;ta.Xb();return ta}function ha(){this.SOd=rd.AFrameworkApplication.P2d;this.sEi=rd.AFrameworkApplication.U1j;this.GP=rd.AFrameworkApplication.u6h();this.priority=rd.AFrameworkApplication.Q2d;this.Rie=this.Hxj();this.JVc=rd.AFrameworkApplication.t6h();this.VNc=!1;this.Uie=rd.AFrameworkApplication.P2d;rd.AFrameworkApplication.ha&&(this.VNc=rd.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.WordOnline.RetryOverrideOnServerErrorIsEnabled",
!1))&&(this.Uie=rd.AFrameworkApplication.ha.getIntFeatureGate("Microsoft.Office.WordOnline.RetryOverrideOnServerErrorMilliseconds",rd.AFrameworkApplication.P2d))}function qa(W,ta,ob,Kb,qc,Bb,sd){var Vd=this;Kb=void 0===Kb?null:Kb;qc=void 0===qc?!1:qc;Bb=void 0===Bb?null:Bb;sd=void 0===sd?!1:sd;this.lsa=0;this.oha=this.ej=null;this.UYb=new Yc.a;this.bU=new Yc.a;this.gm=null;this.pVb=!1;this.re=W;this.yhe=ta;this.yhe.execute(function(bf){bf.Vl(cc.a.Hnd,Object($e.a)(Vd,Vd.kSi,"onHostResponseReceived"))});
this.h$=ob;this.mme=new yj.a("WebServiceCall","TokenRefresh");this.sj=Kb||new Aa(W);this.Bzg=qc;this.rU=Bb?Bb:Xi.SessionStatusManager.instance;this.m9d=sd}function Aa(W){this.So={};this.BY={};this.Sxg={};this.pqf=15;this.Cce=!1;this.Hzg=new Date;this.xVb=new Date;this.re=W;this.KYb=new he.a(2,2,6E4*this.pqf,Object($e.a)(this,this.$kg,"writeMeasures"),135,"SL",!1);this.re.$g(this.KYb);this.$fi()}function Fa(){}function ab(W,ta){var ob=this;this.documentVisibilityObserver=null;this.Oa=new Be.a;this.Qx=
null;this.ofb=this.Omb=!1;this.Wtc=null;this.MIb=!1;this.Qxd=!0;this.hde=this.Hce=this.IH=this.Unb=!1;this.VT=null;this.o$e=function(){if(!ob.$ac||ob.$ac&&ob.$.ea.sc)ob.P$e(!1);else if(ob.Qxd){ob.Qxd=!1;var Kb=oe.a(ob.$);jc.ULS.sendTraceTag(537170709,0,50,"EwaAccessTokenExpirationRefreshManager.HandleOnTokenExpiring - session is not active - postponing refresh current-activity [{0}] TimeUntilTokenExpirationInMin [{1}]",Kb.Ci?Kb.Ci.activityName:"None",ob.Ncg())}};this.fd=function(Kb,qc){ob.context&&
(Kb=ob.$.ea,qc.gI&&ob.context.GIb&&!ob.context.BCc?(ob.context.BCc=!0,qc={Name:"EwaAccessTokenExpirationRefreshManager.OnSessionIdChanged - reconnect"},qc.IsUserActive=Kb.xf.Kr,qc.RefreshAccessTokenCorrelationID=ob.context.correlationID,qc=oh.a.Kc(qc),jc.ULS.sendTraceTag(537170708,0,50,qc)):ob.$ac&&ob.Omb&&!Kb.sc&&!ob.context.q7c&&(qc={Name:"EwaAccessTokenExpirationRefreshManager.OnSessionIdChanged - consider abort ongoing refresh due to reopen"},ob.Qx&&(ob.Qx.C(),qc.Aborted=!0,Td.EwaSettings.isChangeGateEnabled("OfficeVSO:4877031_allowRefreshExpiringAfterAbort")&&
(qc.ResetStopRefreshRetriesUntilTokenExpired=!0,ob.ofb=!1)),qc.TimeUntilTokenExpirationInMin=ob.Ncg(),qc.RefreshAccessTokenCorrelationID=ob.context.correlationID,qc=oh.a.Kc(qc),jc.ULS.sendTraceTag(572019856,0,50,qc)))};this.Mza=function(){if(ob.context&&ob.context.GIb&&!ob.context.BCc){var Kb={Name:"EwaAccessTokenExpirationRefreshManager.OnOpenWorkbookFailed"};Kb.CreatedForExpired=ob.context.q7c;Kb.RefreshAccessTokenCorrelationID=ob.context.correlationID;Kb.OpenWorkbookErrors=Fh.a.Wc(ob.$.ea.oG);
Kb.ExecutionContextErrors=Fh.a.Wc(oe.a(ob.$).ud.errors);Kb.accesstokenTTL=rd.AFrameworkApplication.zk;Kb=oh.a.Kc(Kb);jc.ULS.sendTraceTag(537170707,0,15,Kb)}};this.O$e=function(){ob.ofb=!1;ob.P$e(!0)};this.pFd=function(){ob.MIb&&(ob.$.ea.xf.YAa(ob.pFd),ob.MIb=!1);ob.s$f()};this.$=W;this.iZd=ta;this.TKd=W.Sb.Kh("WebServiceCall","refreshToken");this.$ac=Td.EwaSettings.isChangeGateEnabled("OfficeVSO:4874136_fixRaceOpenWorkbookRefreshExpiringToken");Te.a.instance.eYc(this.O$e);Te.a.instance.cYc(this.o$e);
ta=this.$.ea;ta.ek(this.fd);ta.h0b(this.Mza);this.FFi=this.$.ya.MinTokenLifetimeForRegularExpirationPromptInMin;this.K5f=this.$.ya.ShortAccessTokenExpirationPromptSeconds;this.ARf=this.$.ya.RefreshAccessTokenDurationLimitInSec;this.qig(W.ea.PJf,rd.AFrameworkApplication.zk);W=new Date;ta={};jc.ULS.sendTraceTag(537170714,217,50,"Initializing EwaAccessTokenExpirationRefreshManager. {0}",(ta.AccessTokenTtl=rd.AFrameworkApplication.zk,ta.NowGetTime=W.getTime(),ta.BootTime=rd.AFrameworkApplication.nia,
ta.WopiTokenExpiresAfterMinutes=rd.AFrameworkApplication.N2d,ta.WopiTokenTaskItemPriority=rd.AFrameworkApplication.Q2d,ta));this.$.da.Ya(291,function(Kb){ob.documentVisibilityObserver=Kb})}function Ua(W,ta){this.UYb=W;this.bU=ta}function bb(){return xa.apply(this,arguments)||this}function xa(){}function Gb(){}function $b(W,ta){this.GIb=!1;this.correlationID=W;this.q7c=ta;this.BCc=!1;this.creationTime=Eh.a.Ra.Ob}function oa(W){var ta=Ma.call(this)||this;ta.Oa=new Be.a;ta.Unb=!1;ta.IH=!1;ta.$=W;return ta}
function Ma(){this.kke=this.iTc=!1;var W=rd.AFrameworkApplication.zk;if(!(0>=W)){this.zk=W;W=new Date;var ta={};jc.ULS.sendTraceTag(17581890,217,50,"Initializing SessionExpirationManager. {0}",(ta.AccessTokenTtl=this.zk,ta.NowGetTime=W.getTime(),ta.BootTime=rd.AFrameworkApplication.nia,ta));Te.a.instance.eYc(Object($e.a)(this,this.hQa,"onSessionExpiredDetected"));Te.a.instance.cYc(Object($e.a)(this,this.RGf,"onSessionExpiringDetected"))}}function Za(W){var ta=ve.call(this)||this;ta.$=W;ta.Xb();return ta}
function gb(W,ta,ob){ob=void 0===ob?null:ob;var Kb=Tc.call(this,ta)||this;Kb.sheetTabActivatePreviousHidden=Ee.a.instance.fa(709);Kb.sheetTabActivateNextHidden=Ee.a.instance.fa(711);Kb.svgIconProvider=null;Kb.Eh=[];Kb.xL=Array(6);Kb.EAd=Array(6);Kb.cl=null;Kb.CTd=null;Kb.dzc=null;Kb.Aeb=null;Kb.bzc=null;Kb.fI=null;Kb.Szb=null;Kb.mTa=null;Kb.isRtl=!1;Kb.jv=0;Kb.hL=0;Kb.zvc=!1;Kb.V8b=!1;Kb.poa=0;Kb.gsc=0;Kb.d9b=null;Kb.Qaa=null;Kb.K4=null;Kb.sN=null;Kb.jD=0;Kb.Hec=0;Kb.cOb=null;Kb.sCb=-1;Kb.VZ=null;
Kb.frc=0;Kb.SAc=-1;Kb.Lna=0;Kb.Sua=new ic;Kb.TNc=!1;Kb.s0=null;Kb.xke=null;Kb.DTd=null;Kb.ETd=null;Kb.Avc=null;Kb.sce=!1;Kb.Eod=null;Kb.Vzd=!1;Kb.wke=null;Kb.zD=function(qc,Bb){Kb.dHf(Bb.item)};Kb.Tza=function(qc,Bb){qc=Kb.$.xa.oa.index;for(var sd=0,Vd=Kb.Eh.length;sd<Vd;sd++){var bf=Kb.QR(sd);if(bf.name===Bb.oldName){bf.name=Bb.newName;Kb.X0();sd===qc&&Kb.l1(6);break}}};Kb.iHf=function(qc,Bb){(qc=Kb.b4a(Bb.item))&&qc.Rgb()};Kb.jHf=function(qc,Bb){Bb.visible?(Kb.eTa(!1),Kb.fHf(Bb.item)):Kb.dHf(Bb.item)};
Kb.AL=function(qc){Kb.YF?(Kb.VZ=qc,Kb.BPb()):(Kb.VZ&&(Kb.gsc+=Kb.VZ.clientPoint.x-qc.clientPoint.x),Kb.VZ=qc,Math.abs(Kb.gsc)>=Kb.jmh&&Kb.BPb());return!0};Kb.IO=function(qc){qc.Ca.preventDefault();return!1};Kb.N_f=function(qc){Kb.K_f(qc,!0)};Kb.M_f=function(qc){Kb.K_f(qc,!1)};Kb.A0=function(qc){if(Kb.YF&&(Kb.Pz||Kb.glf(qc)))if(Kb.V8b=Kb.ohf(qc),Kb.Pz){var Bb;qc=(Bb=Kb.QR(Kb.jD+1))?Bb.sheet:null;Kb.reorderSheets(qc,Kb.jD+1===Kb.ATd,!0)}else qc=Kb.Vzd?null:Kb.Eod,Kb.reorderSheets(qc,Kb.Vzd,!0);Kb.tR();
return!0};Kb.li=function(qc,Bb){Bb.MD&&Kb.c1d(Bb.MD);Kb.hyc(!1);Kb.X0();Bb.oa&&(Kb.c1d(Bb.oa),Kb.l1(6),Kb.ea.rna())};Kb.Sxf=function(qc,Bb){Kb.rEc(Bb.item)};Kb.Txf=function(qc,Bb){Kb.rEc(Bb.item)};Kb.Uxf=function(qc,Bb){Kb.rEc(Bb.item)};Kb.$Pa=function(qc,Bb){Kb.rEc(Bb.item)};Kb.Y6=function(){Kb.p3c()};Kb.vd=function(){Kb.isVisible=!Kb.ea.isNamedObjectViewMode;Kb.p3c();Kb.h7c();Td.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&(td.d(Kb.$)||td.e(Kb.$))&&(Jc.PageLoadTrackingInfo.instance.a1(fe.a.qMb,
["sheetTabBar"]),Jc.PageLoadTrackingInfo.instance.HX(fe.a.qMb,["sheetTabBar"]));Kb.P6c();Kb.X0();Kb.eTa(!0);Kb.l1(6)};Kb.lj=function(){Kb.isVisible&&(Kb.X0(),Kb.l1(6))};Kb.Tf=function(){Object(Jb.a)(pc,Kb.fI)===Zf.k(Kb.$.qg)&&Kb.P6c();for(var qc=Cl(Kb.Eh),Bb=qc.next();!Bb.done;Bb=qc.next())Bb.value.Vtj(!Zf.k(Kb.$.qg))};Kb.hHf=function(qc,Bb){Kb.jjj(Bb.item,Bb.isUserOperation)};Kb.oGb=function(qc,Bb){Kb.fHf(Bb.item)};Kb.onKeyDown=function(qc){switch(qc.keyCode){case 9:var Bb=Kb.domElement.querySelectorAll(ef.DOMElementExtensions.nq),
sd=ef.DOMElementExtensions.Nl(Bb);Bb=ef.DOMElementExtensions.Iz(Bb);ef.DOMElementExtensions.Cea(qc,sd,Bb);break;case 39:case 37:ef.DOMElementExtensions.L2f(qc,Kb.domElement.querySelectorAll(ef.DOMElementExtensions.nq),39===qc.keyCode?!Kb.isRtl:Kb.isRtl)}jc.ULS.sendTraceTag(537153691,0,50,"SheetTabBarControl.OnKeyDown: Press on {0}",qc.keyCode)};Kb.onScroll=function(){Kb.cl.scrollLeft!==Kb.poa&&Kb.JOj()};Kb.d7=function(qc){if(qc.ctrlKey||qc.c4)return!1;Kb.cl.scrollLeft+=Math.floor(30*qc.cDa);if(Kb.Pz&&
Kb.YF){var Bb=Kb.S2e("OnMouseWheel");Bb&&Kb.PXd(0<qc.cDa,Bb.x+Bb.width/2)}return!0};Kb.jG=function(qc,Bb){if(Kb.Sua)Kb.x$e("PartialInteractivity",Bb.tQ?3:0);else{Kb.tR(!1);Kb.hSd(Bb.tQ);qc=Cl(Kb.cxe);for(var sd=qc.next();!sd.done;sd=qc.next())(sd=sd.value)&&sd.kY(Bb.tQ);qc=Cl(Kb.Eh);for(sd=qc.next();!sd.done;sd=qc.next())(sd=sd.value)&&sd.kY(Bb.tQ)}};Kb.oFb=function(qc,Bb){qc=0;Bb.roe&&(qc=2|(Bb.SAj?1:0));Kb.x$e("ComponentRangePicker",qc)};Kb.$=W;Kb.ea=Kb.$.ea;Kb.Pz=Gh.a.fjf();Kb.o9b=Kb.Pz&&!Td.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2");
Kb.sm=Td.EwaSettings.ma(516);Kb.Uw=Gh.a.ytd();Kb.elf=Kb.sm&&!(Td.EwaSettings.isChangeGateEnabled("OfficeVSO:6179307_hideSheetDropDownMenuForMobileMeetings")&&Kb.$.ZN);Kb.Pz&&(Kb.sce=Kb.sm&&!rf.a.vv);Kb.BHi=Kb.$.ya.SheetTabNavigateButtonLongKeyPressPeriodMS;Kb.AHi=Kb.$.ya.SheetTabNavigateButtonIntervalPeriodMS;Kb.jmh=Kb.$.ya.SheetTabDragStartPixelThreshold;Kb.MQa=-1;Kb.LQa=-1;Kb.n5c=!1;Kb.Uw&&(Kb.svgIconProvider=ob);Kb.AC=new wh.a(Kb.domElement,3);Kb.sm&&Kb.domElement.classList.add(rb.eyh);Kb.ebh();
Kb.F9g();Kb.fbh();Kb.hch();Kb.hyc(!0);Kb.vd(null,null);W=Kb.$.xa;W.Nf(Kb.li);W.O_b(Kb.Y6);W.nZ(Kb.zD);W.Oha(Kb.oGb);W.JGa(Kb.Tza);W.sre(Kb.hHf);W.f_a(Kb.jHf);W.sJg(Kb.iHf);W.KXc(Kb.Sxf);W.ore(Kb.Txf);W.qre(Kb.Uxf);W.rre(Kb.$Pa);Kb.$.fl(Kb.vd);Kb.$.aB(Kb.lj);Gf.a(Kb.$).Xg(Kb);Kb.$.da.Ha(32,Kb);Td.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CoauthWorkbookProtectionSupport",!1)&&Kb.$.ea.Yt(Kb.Tf);Kb.czc=Kb.Rd.Gd(Kb.domElement);Kb.czc.ka("keydown",Kb.onKeyDown);Ih.a(Kb.$).Rq()&&Kb.jG(null,
new Ba.a(!0));Ih.a(Kb.$).yg.Pha(Kb.jG);Ke.g(Kb.$).Pqe(Kb.oFb);Td.EwaSettings.isChangeGateEnabled("OfficeVSO:4227145_InEditingDisableInsertSheetButton")&&Kb.czc.ka("mousedown",function(qc){qc.preventDefault()});Fg.a.instance.qa(Sd.a.tD,Kb.domElement,Kb.d7);Kb.BTd=Kb.Rd.Gd(Kb.cl);Kb.BTd.ka("scroll",Kb.onScroll);Kb.JOj=Yg.a(function(){Kb.X0()},200,Kb.$.la,ah.a.XAj,!0);Kb.$.OF(fe.a.MHj);Kb.elf&&(Kb.wke=new Cb(Kb.$,Kb.mTa.domElement));Td.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",
!1)&&Jc.PageLoadTrackingInfo.instance.R7(fe.a.qMb,["sheetTabBar"]);return Kb}function zb(W,ta,ob){ta=Ta.call(this,document.createElement("a"),ta)||this;ta.uia=Td.EwaSettings.ma(516)?cg.a.rbd:cg.a.lzh;ob.Cb(ta.domElement,Ee.a.instance.fa(700),0,ta.uia,Ee.a.instance.fa(700),V.a.C4c,!0);W.appendChild(ta.domElement);ta.xc.ka("contextmenu",function(Kb){Qd.g(Kb)});return ta}function nb(W,ta,ob,Kb,qc,Bb,sd){var Vd=Ta.call(this,document.createElement("li"),W)||this;Vd.C5f=0;Vd.D5f=0;Vd.c4c=0;Vd.d4c=0;Vd.x7c=
.5;Vd.vTd=!1;Vd.RV=!1;Vd.AP=null;Vd.uEb=null;Vd.iF=null;Vd.PJc=null;Vd.color=null;Vd.Nif=!1;Vd.xjc=!1;Vd.k7b="#BEBBB8";Vd.kHc=null;Vd.onKeyDown=function(bf){return 13!==bf.Ca.keyCode||Vd.disabled?!1:(Vd.activateSheet(1),!0)};Vd.Zz=function(bf){return 32!==bf.Ca.charCode||Vd.disabled?!1:(Vd.activateSheet(1),!0)};Vd.iG=function(){Vd.disabled||(Vd.kT.yXi(Vd),Vd.kT.YF||Vd.Ioa(!0,void 0,"OnMouseOver"))};Vd.GI=function(){Vd.disabled||Vd.Ioa(!1,void 0,"OnMouseOut")};Vd.Jza=function(){Vd.kT.YF||(Vd.kKj(),
Vd.sheet.l8||Ke.g(Vd.$).RJb(Vd.sheet.sheetName));return!1};Vd.Kza=function(){Vd.ZOe(!1);return!1};Vd.dd=function(bf){if(Vd.disabled)return!0;var Xf=Ke.g(Vd.$);Vd.sheet.active||3!==bf.zb?Vd.sm?Vd.activateSheet(bf.zb):Gh.a.lud()&&Xf.focus():(!Gh.a.jOa(Vd.$)&&!Vd.aCb||Xf.isEditing||Xf.Vi||Xf.Stb(),Vd.activateSheet(bf.zb));return 3!==bf.zb};Vd.onPointerDown=function(bf){if(Vd.disabled)return!0;Vd.ZOe(!0);Ke.g(Vd.$).inRangePicker&&jc.ULS.sendTraceTag(35985038,0,15,"SheetTabButton:OnPointerDown() - Tried clicking different sheet while in range picker (e.g editing a formula).");
var Xf=3===bf.zb;if(2===bf.zb||Xf&&Vd.lya)Vd.sm?(Vd.Ioa(!0,!Xf,"OnPointerDown"),Xf=Dc.Task.delay(Xf?Vd.D5f:Vd.C5f).CWR(function(){return!0})):Xf=Vd.activateSheet(bf.zb),Vd.p8a&&(Vd.xjc=!0,Vd.kT.Avc=Le.TaskExtensions.Ba(Xf,function(){Vd.xjc&&Vd.kT.AXi(Vd,bf)},Vd.la,11));return!1};Vd.Sf=function(bf){if(Vd.disabled||!Vd.p8a&&Td.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CoauthWorkbookProtectionSupport",!1))return!0;var Xf=Vd.kT.YF&&!Gh.a.fjf();Vd.xjc=!1;Vd.sm&&Vd.Ioa(2===bf.zb,void 0,
"OnPointerUp");Vd.kT.Avc&&(Le.TaskExtensions.Ba(Vd.kT.Avc,function(){Vd.kT.zXi(Vd)},Vd.la,11),Vd.kT.Avc=null);return Xf};Vd.IO=function(){if(!Vd.p8a&&Td.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CoauthWorkbookProtectionSupport",!1))return!0;Vd.xjc=!1;Vd.vTd||Vd.Ioa(!1,void 0,"OnTouchMove");return!1};Vd.XCe=new pa(Vd,W);Vd.sm=Bb;Vd.Uw=sd;Vd.aCb=Gh.a.aCb(W);Vd.Sqd=Td.EwaSettings.isChangeGateEnabled("OfficeVSO:3843903_DelayLoadSheetViewIcon")&&!Vd.Uw;Vd.sm?(Vd.C5f=W.ya.SheetDragReorderDelayInMilliseconds,
Vd.D5f=W.ya.SheetDragReorderDelayInMillisecondsForTouch,Vd.c4c=18,Vd.d4c=20):(Vd.c4c=19,Vd.d4c=22);Vd.$=W;Vd.ZXb=Kb;Vd.kT=qc;Vd.p8a=qc.ote();Vd.udh();Vd.s8g();Vd.Knd=W.Sb.Kh("UserAction",Vd.name);Vd.Vrd=!1;ef.DOMElementExtensions.Rs(Vd.domElement,fe.a.ls,null,null);Vd.domElement.appendChild(Vd.anchor);Vd.anchor.appendChild(Vd.iF);Vd.Noa=new Yc.a;W=new ib(Vd.sheet,Vd.sm,Vd.Uw);Vd.Noa.add(new Ja(Vd.$,W));Vd.$.ea.nMb&&(W=new Rb(Vd.sheet,Vd.sm,Vd.Uw),Vd.Noa.add(new Ja(Vd.$,W)));Vd.Sqd||(W=new Da(Vd.sheet,
Vd.kT.Zyc,function(){return Vd.color?nb.BUd(Vd.color):!1},Vd.Uw),Vd.uEb=new Ja(Vd.$,W),Vd.Noa.add(Vd.uEb));Vd.lya=Vd.kT.lya;Vd.Rgb();Vd.Edj();Vd.dye=new wh.a(Vd.domElement,1);ta.insertBefore(Vd.domElement,ob);R.a(Vd.$)&&Vd.gig(!0);return Vd}function pa(W,ta){var ob=$a.call(this,W.domElement)||this;ob.onKeyDown=function(Kb){121===Kb.keyCode&&Kb.shiftKey&&!ob.Qoa.disabled&&(ob.showContextMenu(new Sys.UI.Point(0,0),1,ob.Qoa.anchor),Qd.g(Kb))};ob.gda=function(Kb){if(!ob.$.isEditMode||ob.Qoa.disabled)return!0;
ob.rename(!1,Kb.zb);return!0};ob.nl=function(Kb){return ob.Qoa.disabled?!0:ob.showContextMenu(Kb.clientPoint,Kb.zb,Kb.Mb)};ob.Bke=W;ob.$=ta;d.a.instance.qa(Sd.a.qk,W.domElement,ob.gda);Oe.a.instance.qa(W.domElement,ob.nl);ob.xc.ka("keydown",ob.onKeyDown);return ob}function Ja(W,ta){var ob=this;this.Dra=this.y2=this.fCa=this.ik=null;this.Ujf=!1;this.VTc=this.lpa=this.Uta=this.Fia=this.Tta=null;this.iG=function(){ob.dataSource.cO()&&Le.TaskExtensions.Ba(ob.nDb,function(){dialogControls.renderToolTip(ob.dataSource.Sv(),
"SheetIconTooltip",ob.dataSource.nZd(),ob.iJ,10,!1,!1,1)},ob.$.la,3)};this.GI=function(){ob.dataSource.cO()&&ob.clearToolTip()};this.$=W;this.dataSource=ta;this.Uw=Gh.a.ytd()}function Da(W,ta,ob,Kb){this.sheet=W;this.altText=Ee.a.instance.fa(1856);this.DQj=ta;this.c7f=ob;this.Uw=Kb}function ib(W,ta,ob){this.sm=ta;this.Uw=ob;this.sheet=W;this.altText=Ee.a.instance.fa(1933)}function Rb(W,ta,ob){this.sm=ta;this.Uw=ob;this.sheet=W;this.altText=Ee.a.instance.fa(1934)}function wc(W,ta,ob){var Kb=Ta.call(this,
document.createElement("a"),W,!0)||this;Kb.fh=function(){Kb.kY(!1);Kb.$.ea.Kp(Kb.fh)};Kb.dd=function(qc){Kb.jdg(qc.zb);return!0};Kb.onKeyDown=function(qc){return 13===qc.Ca.keyCode||32===qc.Ca.keyCode?(Kb.jdg(qc.zb),!0):!1};Kb.Fta=ta.Cb(Kb.domElement,Ee.a.instance.fa(506),0,cg.a.Lxh,Ee.a.instance.fa(506),V.a.t7h,Kb.disabled);Kb.domElement.classList.add(rb.Oxh);ob.appendChild(Kb.domElement);Kb.$.ea.Gm(Kb.fh);Kb.rcj();return Kb}function Cb(W,ta){var ob=ca.call(this,document.createElement("div"))||this;
ob.HS=function(){jc.ULS.sendTraceTag(537153794,0,50,"SheetDropdownMenu.OnSheetsChanges");ob.GVf(!1,"OnSheetsChanged")};ob.VOi=function(){ob.Ik()};ob.UOi=function(){ob.wm()};ob.$=W;ob.FNj=ta;ob.RV=!1;ob.OOb=0;return ob}function lb(W,ta){this.sheetName=null;this.newSheetIndex=0;this.sheetName=W;this.newSheetIndex=ta}function yb(W,ta,ob){var Kb=Ta.call(this,document.createElement("a"),ta)||this;Kb.dd=function(qc){Kb.$.ae(-684145703,qc.zb,0,null);return!0};Kb.TFb=function(qc){tf.HelperMethods.eZd(Kb.Xye,
Kb.uia,Kb.uia+fe.a.ogc,("mouseover"===qc.type||"focus"===qc.type)&&!Ke.g(Kb.$).inRangePicker)};Kb.$=ta;Kb.uia=Td.EwaSettings.ma(516)?cg.a.rbd:cg.a.jTe;Kb.Xye=ob.Cb(Kb.domElement,Ee.a.instance.fa(504),0,Kb.uia,Ee.a.instance.fa(505),V.a.C4c);W.appendChild(Kb.domElement);Kb.xc.ka("contextmenu",function(qc){Qd.g(qc)});Kb.xc.ka("mouseover",Kb.TFb);Kb.xc.ka("mouseout",Kb.TFb);d.a.instance.qa(Sd.a.click,Kb.domElement,Kb.dd);Kb.oOa=Bg.KeyInputManager.instance.Ps(Kb.domElement,Kb.dd,x.a.fi,x.a.d2);return Kb}
function pc(W,ta,ob,Kb){Kb=void 0===Kb?!1:Kb;var qc=Ta.call(this,document.createElement("a"),ta,Kb)||this;qc.dd=function(Bb){qc.disabled||qc.$.ae(-1935155518,Bb.zb,30,null);return!0};qc.TFb=function(Bb){Bb="mouseover"===Bb.type||"focus"===Bb.type;var sd=R.a(qc.$)?qc.tbb:qc.Fta;tf.HelperMethods.eZd(sd,qc.uia,qc.uia+fe.a.ogc,Bb&&!Ke.g(qc.$).inRangePicker)};qc.mj=function(){qc.kY(!0)};qc.Rg=function(){qc.kY(!1)};qc.uia=Td.EwaSettings.ma(516)?cg.a.rbd:cg.a.jTe;qc.Fta=ob.Cb(qc.domElement,Ee.a.instance.fa(502),
0,qc.uia,Ee.a.instance.fa(503),V.a.C4c,Kb);W.appendChild(qc.domElement);qc.xc.ka("contextmenu",function(Bb){Qd.g(Bb)});Td.EwaSettings.ma(516)||(qc.xc.ka("mouseover",qc.TFb),qc.xc.ka("mouseout",qc.TFb));d.a.instance.qa(Sd.a.click,qc.domElement,qc.dd);qc.oOa=Bg.KeyInputManager.instance.Ps(qc.domElement,qc.dd,x.a.fi,x.a.d2);Td.EwaSettings.isChangeGateEnabled("OfficeVSO:4227145_InEditingDisableInsertSheetButton")&&(Ke.g(qc.$).Ac.wl(qc.mj),Ke.g(qc.$).Ac.Wo(qc.Rg));return qc}function Ta(W,ta,ob){ob=void 0===
ob?!1:ob;W=M.call(this,W)||this;W.Fta=null;W.tbb=null;W.$=ta;W.IY=ob;return W}function rb(){}function ic(){this.aMe=new uh.a(!0);this.bKc=0}function Va(W){return Ph.call(this,W)||this}function jb(W){this.zmh=W}function rc(W){return rh.call(this,W)||this}function Cc(W,ta,ob,Kb){var qc=this;this.menuId=null;this.GSa=-1;this.OHf=function(){qc.Vda()};this.UYi=function(Bb){if(!(qc.va.$Ma()||(!Td.EwaSettings.isChangeGateEnabled("OfficeVSO:4124510_JsCrashOnToggleTableStyleOptionSuccessful")||Kg.a(Bb)||qc.qNa())&&
Kg.a(Bb)&&qc.qNa())){Bb=qc.va.activeCell;var sd=qc.va.activeRange,Vd=qc.tableManager.Ig.usedRange;2===qc.GSa&&fg.g(qc.tableManager.Ig)&&Bb.bottom===Vd.bottom&&(sd=sd.Y_?new nf.Range(sd.top-1,sd.left,sd.bottom-1,sd.right,!1,!0):new nf.Range(sd.top,sd.left,sd.bottom-1,sd.right,!1,!0),Bb=sd.contains(Bb)?Bb:nf.Range.kd(sd.bottom,Bb.left),Ke.g(qc.$).ga.updateSelection(sd,Bb,0,3))}};this.lYi=function(Bb){Kg.a(Bb)?(jc.ULS.sendTraceTag(594130062,0,50,"TableManager.OnTableRenameSuccessful-Rename table rename failed due invalid user input"),
qc.$.Cf()):jc.ULS.sendTraceTag(594130061,0,50,"TableManager.OnTableRenameSuccessful-Rename table rename successful")};this.kYi=function(){jc.ULS.sendTraceTag(594130060,0,15,"TableManager.OnTableRenameFailure-Rename table failed");qc.$.Cf()};this.mYi=function(Bb,sd){sd&&qc.tM(sd);Kg.b(Bb,-569193796)&&(oe.a(qc.$).ud.ME(-569193796),qc.Awi(Bb.Errors[0]))};this.$=W;this.tableManager=ta;this.namedSheetViewPublic=ob;this.frame=this.$.frame;this.ga=Ke.g(this.$).ga;this.va=this.ga.va;this.ty=Td.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");
this.tableStyleManager=Kb;this.tableStyleManager.IKg(this.OHf)}function Hc(W){W=sg.call(this,W)||this;var ta=Ke.g(W.$);ta=ta.Tb.Wj(ta.ga.va.activeCell);Of.a.Qh(ta.oUa)?W.PFd="":W.PFd=ta.oUa;Of.a.Qh(ta.pUa)?W.MFd="":W.MFd=ta.pUa;ta=W.iW(W.PFd,W.MFd);W.initializeAndShow(Ee.a.instance.fa(729),W.lNj,ta);return W}function Nb(W){var ta=yf.call(this,W)||this;ta.uNj=function(ob,Kb){1===ob&&ta.SRj(Qe.D(ta.pKf(Kb[Nb.GPf])))};ta.oxb=function(ob){ob=ta.lid(ob);return ta.Dfd(ob)};ta.gridView=Ke.g(W);ta.va=ta.gridView.ga.va;
ta.grc=ta.gridView.Tb.Wj(ta.va.activeCell).usedRange;W=ta.iW(ta.grc.toString());ta.initializeAndShow(Ee.a.instance.fa(720),ta.uNj,W);return ta}function nc(W,ta){W=wb.call(this,W)||this;W.iCa=ta;return W}function Ha(W,ta){W=Ka.call(this,W,Ee.a.instance.fa(719))||this;W.iCa=ta;return W}function tb(W,ta,ob){this.sBb=!1;this.sharedSheetRange=ta;this.$=W;this.qh=this.$.Sb.Kh("UserAction","ConvertToRangeManager");this.tableName=ob}function Ub(W,ta){var ob=this;this.v3d=null;this.w3d=0;this.qj=null;this._state=
0;this.moveNext=function(){try{for(ob._state=1;1===ob._state;)ob.Tu=ob.Tu()}catch(Kb){ob.dispose(),ob._state=3}};this.Ef=W;this.lDa=ta;this.Tu=this.AM;this.moveNext()}function gc(W){this.tableName=null;this.tableName=W}function Eb(W,ta,ob){this.isPivotTable=!1;this.tableRange=null;this.optionType=0;this.tableRange=W;this.optionType=ta;this.isPivotTable=ob}function Tb(W){this.originalRange=null;this.originalRange=W}function Wc(W,ta){this.newName=this.oldName=null;this.oldName=W;this.newName=ta}function T(W,
ta,ob){this.description=this.title=this.tableRange=null;this.tableRange=W;this.title=ta;this.description=ob}function ua(W,ta,ob,Kb){W=ma.call(this,W,ob)||this;W.hasHeaders=!1;W.isCreation=!1;W.hasHeaders=ta;W.isCreation=Kb;return W}function ma(W,ta){this.tableRange=this.tableRanges=null;this.styleIndex=0;this.tableRanges=W;this.tableRange=Qe.l(W.Ranges[0],W.SheetName);this.styleIndex=ta}function wa(W){this.autoFilterOptions=null;this.autoFilterOptions=W}function Ca(W,ta){this.autoFilterOptions=null;
this.sortType=0;this.autoFilterOptions=W;this.sortType=ta}function db(W){var ta=ph.call(this)||this;ta.tableStyleManager=null;ta.$=W;ta.Xb();return ta}function Sa(W,ta,ob){var Kb=Tg.call(this)||this;var qc={};Kb.Z5i=(qc.height="100%",qc);Kb.KIb={};Kb.rkd=0;Kb.TIa=0;Kb.lastSyncTime=new Date;Kb.xea=-1;Kb.PO=null;Kb.Hna={};Kb.nM=null;Kb.LG={};Kb.qUa={};Kb.Ttc=null;Kb.Sjf=!1;Kb.isInitialized=!1;Kb.L7a=!1;Kb.RBb=!1;Kb.Uwc=null;Kb.aZe=!1;Kb.QNb=!1;Kb.hBc=!1;Kb.bFh=function(){Kb.mkc()?Kb.$.ea.mMd(Kb.bFh):
Kb.MLa("tableStyleManagerInitialization")};Kb.qCf=function(Bb,sd,Vd){var bf=!1,Xf=Td.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AccessibleAuthoringTab",!1);if(Kg.a(Bb))-315732528!==Bb.Errors[0].MessageId&&(jc.ULS.sendTraceTag(42821707,0,10,"TableStyleManager.OnGetTableStyleSuccess - Webservice call failed with Unexpected error : {0}",Fh.a.Wc(Bb.Errors)),Kb.IDd(null,sd,Vd));else if(jc.ULS.sendTraceTag(537151202,0,50,"TableStyleManager.OnGetTableStyleSuccess - Webservice call Success"),
(Bb=Bb.Result)&&Bb.TableStyleItems.length){Vd=60<Bb.TableStyleItems.length;var vg=!1,kh=!1;if(Kb.nM)for(var ki=0;60>ki;++ki){var Yd=Bb.TableStyleItems[ki],df=Kb.nM.TableStyleItems[ki];if(Xf&&Yd.HasStyleViolations!==df.HasStyleViolations){bf=kh=!0;break}for(var lh=0;9>lh&&!(lh>=Yd.TableStyleElementsList.length);lh++)if(!Of.a.equals(Yd.TableStyleElementsList[lh].BackgroundColor,df.TableStyleElementsList[lh].BackgroundColor,!1)){bf=vg=!0;break}}else for(Kb.TIa=0,ki=Cl(Bb.TableStyleItems),Yd=ki.next();!Yd.done;Yd=
ki.next())Yd=Yd.value,Yd.TableStyleElementsList&&Yd.TableStyleElementsList.sort(Xb.rrf),Kb.LG[Yd.Name]=Yd;if(vg||kh)for(vg=0;60>vg;++vg)kh=Bb.TableStyleItems[vg],Kb.LG[kh.Name]=kh;if(Vd&&Kb.nM)for(jc.ULS.sendTraceTag(42821700,0,50,"TableStyleManager.OnGetTableStyleSuccess, Number Custom Styles present - {0}",Bb.TableStyleItems.length-60),bf=!0,Vd=60;Vd<Bb.TableStyleItems.length;++Vd)vg=Bb.TableStyleItems[Vd],vg.Name in Kb.LG||vg.TableStyleElementsList&&vg.TableStyleElementsList.sort(Xb.rrf),Kb.LG[vg.Name]=
vg;if(Hi.a(Kb.LG).length!==Bb.TableStyleItems.length)for(bf=!0,vg=Vd=60;vg<Kb.nM.TableStyleItems.length;)Vd>=Bb.TableStyleItems.length?delete Kb.LG[Kb.nM.TableStyleItems[vg].Name]:Vd>=Bb.TableStyleItems.length||!Of.a.equals(Bb.TableStyleItems[Vd].Name,Kb.nM.TableStyleItems[vg].Name,!1)?delete Kb.LG[Kb.nM.TableStyleItems[vg].Name]:++Vd,++vg;Kb.nM=Bb;Kb.URf(bf);bf&&Kb.E0c();Xf&&sd&&("accessibility"===sd?(Kb.QNb=!1,Kb.hBc=!0):Kb.hBc=!1);Kb.Sjf||(Kb.Gsi()&&Kb.$.Cf(),Kb.Sjf=!0);Kb.rkd=0;Kb.RBb||Kb.aZe?
Xf&&Kb.hBc&&Kb.raiseEvent("RefreshTableStyleGallery"):(Kb.raiseEvent("RefreshTableStyleGallery"),Kb.aZe=!0)}};Kb.IDd=function(){jc.ULS.sendTraceTag(42821712,0,10,"TableStyleManager.OnGetTableStyleFailed - Webservice call failed");Kb.rkd++;5>Kb.rkd&&Rg.a.instance.create(function(){Kb.MLa("getTableStylesFailed")},1E3,ah.a.zbg,!0,!0)};Kb.NHf=function(){Kb.RBb&&(Kb.RBb=!1,Kb.Uwc&&Kb.Uwc(),Rg.a.instance.create(function(){Kb.MLa("galleryMenuClosed")},1E3,ah.a.zbg,!0,!0))};Kb.$=W;Kb.Ta=ta;Kb.tableManager=
ob;Kb.$.da.Ha(329,Kb);Kb.c1c=Kb.Uwb();Kb.$.Ka.KGa(Kb.NHf);return Kb}function hb(W,ta,ob,Kb,qc,Bb){this.headerRow=W;this.totalRow=ta;this.firstCol=ob;this.lastCol=Kb;this.bT=qc;this.Qia=Bb}function Xb(){}function xb(){}function Sb(W){var ta=Oh.call(this)||this;ta.tableManager=null;ta.$=W;ta.Xb();return ta}function qb(W){var ta=sc.call(this,Ke.g(W))||this;ta.irb=null;ta.KBc=null;ta.L1=null;ta.krb=null;ta.Tte=!1;ta.Wce=null;ta.hTb=0;ta.m7b=null;ta.V1b=function(){var ob={},Kb=ta.Cjd(),qc;for(qc in Kb){var Bb=
Kb[qc];if(Bb){var sd=ta.H3h(Bb);if(sd){if(sd in ta.vGa){var Vd=ta.vGa[sd];if(Vd.GB){Vd.eo.equals(Bb)||(Vd.eo=Bb);delete ta.vGa[sd];ob[sd]=Vd;continue}}(Vd=Uc.createInstance(Ke.g(ta.$),Bb,ta.eOh(),ta))?ob[sd]=Vd:jc.ULS.sendTraceTag(537151239,0,15,"TableManager.AttachTableResizeBehavior - Attaching Grippie Failed for Range {0}",Bb.AB(!1))}}}ta.$3b(null,null);ta.NRb=ob};ta.$3b=function(){var ob=ta.vGa,Kb;for(Kb in ob){var qc=Kb,Bb=ob[Kb];Bb&&(Bb.dispose(),delete ta.vGa[qc])}ta.NRb={}};ta.KPf=function(){ta.$3b(null,
null);ta.V1b(null,null)};ta.onFocus=function(){ta.Wce=Ke.g(ta.$).ga.va.activeCell};ta.W6=function(){ta.$.isEditMode&&ta.Th(null,null)};ta.Th=function(){!ta.Tte&&fh.c(ta.$,ta.gridView.ga.va.activeCell)&&ta.$xi()};ta.vO=function(){ta.Lzb(1);ta.$.ea.Kp(ta.vO)};ta.DHb=function(){ta.Tte=!0;ta.KBc=new mb(ta.$)};ta.$=W;ta.gridView=Ke.g(ta.$);ta.$.da.Ha(66,ta);ta.NRb={};ta.V1b(null,null);ta.$.xa&&ta.$.xa.Nf(ta.KPf);ta.Qre(ta.V1b);ta.$.ea.A$(ta.W6);ta.gridView.ga.XJ(ta.Th);ta.$.isEditMode&&ta.Th(null,null);
return ta}function mb(W){var ta=th.call(this,document.createElement("div"))||this;ta.WR=!1;ta.kKf=!1;ta.erd=!1;ta.kWc=!1;ta.$Kb=null;ta.Th=function(){fh.c(ta.$,ta.gridView.ga.va.activeCell)?(ta.aNa=!0,ta.Ksb(!1)):(ta.aNa=!1,ta.U5=!1,ta.dgg())};ta.Gt=function(){ta.aNa?ta.Ksb(!0):ta.U5=!1};ta.bzf=function(){ta.kWc=!0;ta.aNa&&(ta.U5=!1)};ta.onContentReady=function(){ta.$.isEditMode?fh.c(ta.$,ta.gridView.ga.va.activeCell)&&(ta.aNa=!0,ta.Ksb(!1)):ta.U5=!1};ta.gFb=function(){ta.kWc=!1;ta.aNa?ta.Ksb(!1):
ta.U5=!1};ta.Xe=function(ob,Kb){ta.aNa&&(ob=ta.gridView.wrc(Kb.gd.block.me.BlockCachePosition.PaneType).lE(Kb.gd.hash))&&(ob.WMd(ta.kMa),ob.lYc(ta.kMa))};ta.kMa=function(){ta.BVf()};ta.$=W;ta.gridView=Ke.g(ta.$);ta.parentElement=ta.domElement;ta.parentElement.className=ac.pyh;ta.ULa=ta.gridView.Fj;ta.aNa=!0;ta.Hfi();ta.hQg();ta.Ksb(!1);jc.ULS.sendTraceTag(537151201,0,50,"TableTotalRowOptions - React Component Created ");return ta}function ac(){}function Uc(W,ta,ob,Kb){var qc=ye.call(this,W)||this;
qc.ybg=[6];qc.tbg=[26];qc.ms=null;qc.vkc=!1;qc.iBb=!1;qc.Lba=null;qc.Ft=null;qc.onPointerDown=function(Bb){if(1!==qc.$.Ka.QH())return!0;Bb=Cf.a(qc.$).se(Bb);if(qc.GB)return!0;var sd=Ih.a(qc.$).Yrd||Ih.a(qc.$).Rq();if(qc.Otd||sd)return qc.Xcb(),!0;qc.Ft=qc.eo;qc.HLd();qc.ond();sd=2===Bb.zb&&Bb.Vn===Sys.UI.MouseButton.leftButton;var Vd=3===Bb.zb;if(sd||Vd)Bb=qc.ga.Ip(Bb.clientPoint,Bb.Mb,5,void 0,void 0,!0),Bb||(Bb=qc.Ft),qc.iBb=sd,qc.vkc=Vd,qc.Ft=qc.Y7e(Bb),qc.ond(),sd?qc.$cj():Vd&&qc.Ndj(),ud.b(qc.$,
!0);return!0};qc.Uh=function(Bb){Bb=Cf.a(qc.$).se(Bb);if(!qc.GB)return!1;if(Bb=qc.iBb?qc.ga.Ip(Bb.clientPoint,Bb.Mb,5,void 0,void 0,!0):qc.ga.Ip(Bb.clientPoint,Bb.Mb,5,!0,!1,!0))Bb=qc.Y7e(qc.vpb(Bb)),qc.z2b(Bb.bottomRight),qc.Ft.equals(Bb)||(qc.Ft=Bb,qc.XIb(!1),qc.HLd(!1),qc.ond(!1),qc.qbi(),qc.Fb.update(!1)),qc.rWj(qc.Ft);return!0};qc.Sf=function(Bb){Cf.a(qc.$).se(Bb);if(!qc.GB)return!1;qc.resizeTable();qc.Xcb();return!0};qc.AGb=function(Bb){Cf.a(qc.$).se(Bb);if(!qc.GB)return jc.ULS.shipAssertTag(537151233,
0,!0,"TableResizeBehavior.OnTouchUp - OnTouchUp Called without Operation in Progress"),!1;qc.resizeTable();qc.Xcb();return!0};qc.kda=function(Bb){Cf.a(qc.$).se(Bb);qc.Xcb();return!0};qc.Xyf=function(){qc.GB&&qc.Xcb()};qc.gridView=ta;qc.$=ta.$;qc.tableManager=Kb;qc.ga=ta.ga;qc.Fb=ta.Fb;qc.parentElement=W;qc.VVg();rf.a.zp||rf.a.dya||Pf.a.instance.qa(Sd.a.pointerDown,qc.Lba,qc.onPointerDown);qc.eo=ob;qc.Otd=!1;qc.fOc=!1;qc.tableManager.YHg(qc.Xyf);return qc}function Zc(W){var ta=ce.call(this)||this;
ta.$=W;ta.Xb();return ta}function Kc(W){var ta=this;this.fh=function(){ta.Xof();ta.$.ea.Kp(ta.fh)};this.$=W;this.gbg={};this.MXd={};var ob=Td.EwaSettings.isChangeGateEnabled("OfficeVSO:4431502_UseCommonIconSpriteInEwa")?"excelInitialAppSprite":"excelAppSprite",Kb=this.p3e(ob);Kb?(this.qqe(Kb),this.$.ea.yh?this.Xof():W.ea.Gm(this.fh),this.$.da.Ha(388,this)):jc.ULS.sendTraceTag(537151263,0,15,"window[{0}].icons returned null.",ob)}function va(){}function fb(W){var ta=yc.call(this)||this;ta.sparklineManager=
null;ta.$=W;ta.Xb();return ta}function Pb(W,ta){W=sc.call(this,W)||this;ta.Ha(240,W);return W}function sc(W){var ta=bc.call(this)||this;ta.kU=[];ta.Xe=function(Vd,bf){var Xf,vg=bf.gd.block;Vd=!1;if(vg.Vj&&vg.state&1&&(Xf=ta.view.Kf(bf.gd.block.me.BlockCachePosition.PaneType).lE(bf.gd.hash))){vg=ta.FJd(vg.ye);if(Xf=Xf.yf)for(var kh=ta.kU.length-1;0<=kh;kh--)Xf.contains(ta.kU[kh].bottomRight)&&(Array.removeAt(ta.kU,kh),Vd=!0);if(vg)for(Xf=0,kh=vg.length;Xf<kh;Xf++)Array.add(ta.rangeList,Qa.a.DR(vg[Xf])),
Vd=!0;Vd&&(bf=(Td.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ApplyHeaderSnappingOnVerticalFreezePane",!1)?ta.view.wrc(bf.gd.block.me.BlockCachePosition.PaneType):ta.view.a4).lE(bf.gd.hash),ta.raiseEvent(sc.GJd,new cb.a(bf)))}};ta.Rm=function(){ta.SIb()};ta.Io=function(){ta.kU=[]};ta.fne=W;var ob=W.Da;ob.xr(ta.Xe);ob.Mha(ta.Xe);ob.M_b(ta.Xe);ob.lH(ta.Rm);W.$.xa.YJ(ta.Io);W.$.Ab.YJ(ta.Io);ob=Cl(W.zn);for(var Kb=ob.next();!Kb.done;Kb=ob.next()){Kb=Cl(Kb.value);for(var qc=Kb.next();!qc.done;qc=
Kb.next()){qc=Cl(qc.value);for(var Bb=qc.next();!Bb.done;Bb=qc.next()){Bb=Bb.value;var sd=W.Da.kl(Bb.hashCode);ta.Xe(ta,new sf.a(new Me.a(sd,Bb.hashCode),null))}}}return ta}function hd(W){var ta=Fd.call(this)||this;ta.$=W;ta.Xb();return ta}function Ob(W,ta){var ob=this;this.gX=function(){ob.Pd||ob.Mte()};this.Pd=!1;this.XZ=ta.pV;this.ariaLiveNotifier=W;this.T2d=new sb(W,ta);this.XZ&&this.XZ.bS?this.Mte():this.Ik()}function Ac(W,ta,ob){var Kb=this;this.oDf=function(){Kb.T2d.vQf();Kb.ariaLiveNotifier.setEnabled(!0)};
this.$=ta;this.ariaLiveNotifier=W;this.T2d=new sb(W,ta);this.jbc=ob.cjd(this.$);this.jbc.yJg(this.oDf)}function sb(W,ta){this.$=ta;this.ariaLiveNotifier=W}function ad(W){var ta=Bd.call(this)||this;ta.$=W;ta.Xb();return ta}function Hd(W,ta,ob,Kb,qc){var Bb=this;this.gridReadoutNotifier=null;this.Vbb=!1;this.Hta=this.cqb=null;this.Mda=function(){Td.EwaSettings.isChangeGateEnabled("OfficeVSO:5963256_DoNotReadActiveItemIfDisposed")&&!Bb.$?jc.ULS.sendTraceTag(526235470,0,15,"calling readActiveItemDescription after dispose, ignoring."):
Ke.g(Bb.$).isEditing||Bb.K1b.hr()};this.lLi=function(){if(!Ke.g(Bb.$).ga.Pa.Qsd){var sd=Bb.FNh();Bb.readText(sd.returnValue,sd.activeCell)}};this.Av=function(){var sd=Bb.activeCell;Bb.readText("Editing",sd);Td.EwaSettings.isChangeGateEnabled("OfficeVSO:5190952_removePhoneticErrorDialog2")||sd&&sd.fMa&&!Ke.g(Bb.$).daf||Bb.K1b.cancel()};this.ld=function(){Td.EwaSettings.isChangeGateEnabled("OfficeVSO:6053639_DoNotHandleSelectionChangedIfDisposed")&&!Bb.$?jc.ULS.sendTraceTag(525366409,0,15,"calling onSelectionChanged after dispose, ignoring."):
(Bb.Mda(),Bb.Vbb&&Ke.g(Bb.$).inRangePicker&&1===Hb.a.$b&&(null===Bb.cqb?Bb.cqb=Rg.a.instance.create(Bb.dKd,Hd.hWc,"readSelectedRanges"):Bb.cqb.hr()))};this.$=ta;this.ariaLiveNotifier=W;this.sparklineManager=Kb;this.tableManager=ob;this.OD=new Ne;this.I7a=Pc.I7a();this.Vbb=Td.EwaSettings.isChangeGateEnabled("OfficeVSO:5888244_FixCellReadoutInRangePicking");this.I7a&&(Td.EwaSettings.Gb()?this.gridReadoutNotifier=qc:this.gridReadoutNotifier=ta.da.Aa(244),jc.ULS.shipAssertTag(537153937,0,!!this.gridReadoutNotifier,
"SelectionReadoutHandler.ctor: gridReadoutNotifier shouldn't be null"),Hd.hWc=700);this.K1b=Rg.a.instance.create(this.lLi,Hd.hWc,ah.a.Xrj,!1);this.Ik()}function Ne(){this.activeItemName=null;this.Rkf=!1;this.tableName=null;this.w1a=0;this.GBc=!1}function Ud(){}function Ge(W){switch(W){case 1:return 1412;case 2:return 1413;case 3:return 1414;case 4:return 1415;case 5:return 1416;case 6:return 1417;case 7:return 1418;case 8:return 1419;case 9:return 1420;case 10:return 1421;case 11:return 1422;case 12:return 1423;
case 13:return 1424;case 14:return 1425;case 15:return 1426;case 16:return 1427;case 17:return 1428;case 18:return 1429;case 19:return 1430;case 20:return 1431;case 21:return 1432;case 22:return 1435;case 23:return 1433;case 24:return 1434;case 25:return 1436;case 26:return 1437;case 27:return 1438;case 28:return 1439;default:return 1440}}function Sc(W){var ta=qf.call(this)||this;ta.$=W;ta.Xb();return ta}function Pc(W,ta){this.W0=this.H7=this.AX=null;this.cka=ta;this.ych(W);this.j5i();Td.EwaSettings.Gb()&&
W.da.Ha(244,this)}function Zd(W){var ta=ng.call(this)||this;ta.$=W;ta.Xb();return ta}function ie(W,ta,ob){var Kb=this;this.Izf=function(qc,Bb){Kb.nQf(Bb.Xd.command)};this.$=W;this.Rfa=document.createElement("div");this.Rfa.setAttribute(fe.a.AQ,fe.a.Dj);this.Rfa.className=Fe.a.fbd;ta.insertBefore(this.Rfa,ob);this.gha=document.createElement("div");this.gha.setAttribute(fe.a.AQ,fe.a.Dj);this.gha.className=Fe.a.fbd;ta.insertBefore(this.gha,this.Rfa);this.jwg=Ee.a.instance.Va(2);this.hia=document.createElement("div");
this.hia.setAttribute(fe.a.Vd,fe.a.mta);this.hia.setAttribute(fe.a.nta,fe.a.Tpb);this.hia.className=Fe.a.fbd;ta.insertBefore(this.hia,this.gha);this.register();this.$.da.Ha(211,this)}function vd(W,ta){ta&&(W.append(ta),W.append(Lb.Uxd))}function Lb(W){this.Gwc=W||""}function id(W){var ta=nd.call(this)||this;ta.$=W;ta.Xb();return ta}function uc(W){var ta=Rc.call(this)||this;ta.mwd=null;ta.$=W;jc.ULS.sendTraceTag(537155201,0,50,"NewAndOpenCoreManager created");return ta}function ed(){return Ib.call(this)||
this}function Cd(W){var ta=lg.call(this)||this;ta.$=W;ta.Xb();return ta}function $d(W){var ta=Eg.call(this,document.documentElement,W)||this;ta.nC=0;ta.JRg=[Uf.a.C5c,Uf.a.tBd,Uf.a.Hfc,Uf.a.udg,Uf.a.XOd,Uf.a.G0c,Uf.a.$ed,Uf.a.h9e,Uf.a.P_c,Uf.a.mOb,Uf.a.THj,Uf.a.Qec,Uf.a.Y1c,Uf.a.Nvb,Uf.a.zTd,Uf.a.e2c,Uf.a.C$f,Uf.a.Sof,Uf.a.j0c];ta.w0j=[Uf.a.Hfc,Uf.a.Kjg,Uf.a.Jjg,Uf.a.Ljg];ta.n6i=[Uf.a.Hfc,Uf.a.eNf,Uf.a.fNf,Uf.a.iNf];ta.RZg=[Uf.a.jZe,Uf.a.g9e,Uf.a.Yed,Uf.a.Ved];ta.Q5i=[Uf.a.C5c,Uf.a.tBd,Uf.a.G0c,Uf.a.$ed,
Uf.a.P_c,Uf.a.mOb,Uf.a.Qec,Uf.a.Y1c,Uf.a.Nvb,Uf.a.zTd,Uf.a.DMf,Uf.a.e2c,Uf.a.j0c];ta.$5i=[Uf.a.Qec,Uf.a.oZe];var ob=Ee.a.instance.Va(251);ta.Pvj=ta.$.shortcutKeyManager.rLa(ob);ta.mode=0;W.da.Ha(15,ta);Le.TaskExtensions.Ba(ug.GetServiceTaskFactory.Ua(W.da,21,137,1),function(Kb){Kb=Kb.result;Kb.mo(cc.a.kob);Kb.Vl(cc.a.kob,ta.cKb)},W.la);return ta}function La(){this.Ynb=this.iie=this.tb=null;this.Cm=!1}function od(W,ta,ob,Kb,qc,Bb,sd){this.aib={};this.P2=W;this.bwg=ta;this.gsa=new qd(rd.AFrameworkApplication.ha.getIntFeatureGate("Microsoft.Office.SharedOnline.MruReadRetryIntervalMs",
5E3),rd.AFrameworkApplication.ha.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxReadRetry",3),this.cx.Unc);this.Msa=new qd(rd.AFrameworkApplication.ha.getIntFeatureGate("Microsoft.Office.SharedOnline.MruWriteRetryIntervalMs",15E3),rd.AFrameworkApplication.ha.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxWriteRetry",3),this.cx.Unc);this.wyg=ob;this.Ane=Kb;this.NCg={};this.hU=new He;this.htg=qc;this.ZVb="";this.$v=Bb;this.n9d=sd;this.xyg=rd.AFrameworkApplication.ha.getIntFeatureGate("Microsoft.Office.WordOnline.recentLinksCount",
25);return this}function ne(){this.mruItemId=this.app=this.documentExt=this.documentName=this.folderName=this.documentUrl=null}function qd(W,ta,ob){this.task=null;this.Ugc=W;this.qEi=ta;this.taskManager=ob;this.retryCount=this.Uzb=0;this.ARc=this.BCb=null}function He(){this._state=0;this.hfe=this.jfe=this.ife=null;this.state=this.lme=0;this.YMc=!1;return this}function Ue(W,ta,ob,Kb,qc){this.kug=6E4;this.edf="inactive";this.hoe="active";this.eU=!0;this.re=W;this.ltg=ta;this.BLc=ob;this.RYb=Kb;this.$a=
new fc.a;qc&&this.mKj();this.Xce=this.M3e()}function zf(W,ta){this.aib={};this.P2=W;this.Wmb=new Hf(ta,this.iEb.Unc,"GetMoreInfo");this.To=new Ae;return this}function Hf(W,ta,ob){this.PXb=this.ej=null;this.sSc=0;this.Dzg=W;this.re=ta;this.r8d=ob}function De(W,ta,ob,Kb,qc,Bb,sd,Vd){this.La=W;this.Yg=ta;this.Rog=ob;this.m2=Kb;this.re=qc;this.BLc=Bb;this.Ftg=sd;this.EYb=Vd}function Ae(){this._state=0;this.gUc=this.umb=null;this.state=0;this.YMc=this.Xae=!1;return this}function yd(){this._state=0}function je(){this.aib=
{}}function we(){this.tb=null}function Bc(){this.DXa=null}function Od(W){return String.format("{0}RoamingServiceHandler.ashx?action={1}&{2}",rd.AFrameworkApplication.ha.appSettings.RoamingServiceHandlerWebServiceBase||"",W,rd.AFrameworkApplication.uj)}function ae(W){var ta=new $c.a;rd.AFrameworkApplication.Ld.jm(Od(W),1,null,null,!0,2,function(ob){200===ob.data.httpStatus?ta.setResult("true"===ob.data.oe.toLowerCase()):ta.setResult(!1)},function(){ta.setResult(!1)},null,void 0,void 0,void 0,void 0,
"7");return ta.task}function Ad(W,ta){this.La=W;this.IRb=ta}function Ve(W){var ta=pe.call(this,!1,!1,!0)||this;ta.IRb=W;return ta}function kf(W,ta){this.ID=W;this.type=ta}function Fc(W,ta){this.value=W;this.contextId=ta}function fd(W,ta,ob,Kb,qc,Bb,sd,Vd){this.type=W;this.startTime=null==ob||void 0==ob.value?new Fc(ob,null):ob;this.endTime=null==Kb||void 0==Kb.value?new Fc(Kb,null):Kb;null!=qc&&void 0!=qc.value||new Fc(qc,null);null!=Bb&&void 0!=Bb.value||new Fc(Bb,null);this.operationType=Vd}function jd(W){this.ID=
W}function zd(){this.Te=[];this.Epb=[];this.WYc=0;this.duration=this.startTime=null;this.v9b={};this.hzd=this.Lzd=this.u_c=-1}b.r(F);var zc=b(0),$e=b(82),Xe=b(149),pe=Xe.a;Am(Ve,pe);Ve.prototype.start=function(){var W={},ta={};W=(ta.id="AccessibilitySettingsDialog",ta.bodyControls=(W.tooltipPersistenceEnabled=this.IRb.mcf,W),ta);this.initializeAndShow("",Object($e.a)(this,this.Vmj,"resultHandler"),W)};Ve.prototype.Vmj=function(W,ta){1===W&&(this.IRb.mcf=ta.tooltipPersistenceEnabled)};Object(zc.a)(Ve,
"AccessibilitySettingsDialog",Xe.a,[]);var Jf=b(105),kc=b(26);Ad.prototype.Sg=function(){this.La.ic(kc.a.pEj,Jf.a.frame,Object($e.a)(this,this.qEj,"showAccessibilitySettingsDialogHandler"))};Ad.prototype.qEj=function(){(new Ve(this.IRb)).start();return 32};Object(zc.a)(Ad,"AccessibilitySettingsDialogActor",null,[501]);var $c=b(161),rd=b(4),me=b(174);Bc.prototype.Pxi=function(){var W=this,ta=new $c.a;if(this.DXa)ta.setResult(this.DXa);else if(this.Fkf()){var ob=ae("getHoverableRibbonTooltipIsEnabled");
ob.continueWith(function(){W.DXa=ob.result;me.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(ob.result);ta.setResult(ob.result)},8)}else ta.setResult(!1)};Bc.prototype.Fkf=function(){var W=rd.AFrameworkApplication.ha.ra("IsRoamingServiceEnabled"),ta=rd.AFrameworkApplication.ha.ra("IsAnonymousUser");return W&&!ta};uk.Object.defineProperties(Bc.prototype,{mcf:{configurable:!0,enumerable:!0,get:function(){return!!this.DXa},set:function(W){W!==this.DXa&&(this.DXa=W,
me.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(W),this.Fkf()&&rd.AFrameworkApplication.Ld.jm(Od("saveHoverableRibbonTooltipIsEnabled"),2,W.toString().toLowerCase(),null,!0,2,null,null,null,void 0,void 0,void 0,void 0,"8"))}}});Object(zc.a)(Bc,"AccessibilitySettingsInfo",null,[494]);var te=b(254),ge=b(169);we.prototype.hi=function(W){var ta=this;this.tb=W;this.tb.register(Bc,"Common.App.AccessibilitySettings.AccessibilitySettingsInfo").as("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo").Nc(function(){return new Bc}).Ic();
this.tb.register(Ad,"Common.App.AccessibilitySettings.AccessibilitySettingsDialogActor").as("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor").Nc(function(){return new Ad(rd.AFrameworkApplication.Ib,ta.tb.Nh("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"))}).Ic()};we.prototype.init=function(){var W=this.tb.Nh("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"),ta=this.tb.Nh("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor");W&&ta?(ta.Sg(),
W.Pxi()):ge.a(539637639,200,15,"Failed to resolve IAccessibilitySettingsDialogActor or IAccessibilitySettingsInfo. A11y dialog feature is not enabled.")};we.prototype.dispose=function(){};we.main=function(){te.a.instance.nj(new we)};uk.Object.defineProperties(we.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.AccessibilitySettings"}}});Object(zc.a)(we,"AccessibilitySettingsPackage",null,[4,5]);var pd=b(613),jc=b(13);je.prototype.xDg=function(W){this.aib[W.id.toString()]=
W};je.prototype.bJi=function(W){var ta=this.aib,ob;for(ob in ta)ta[ob].notify(W,!1);this.aib={}};je.prototype.Z7i=function(W,ta){ta&&this.xDg(ta);return this.$Ff(W,ta)};je.prototype.L$c=function(W){this.bJi(W)};je.prototype.FOe=function(W,ta){W.notify(ta,!0)};Object(zc.a)(je,"AEventEmitter",null,[944]);var jf;(function(W){W[W.notStarted=0]="notStarted";W[W.waiting=1]="waiting";W[W.shouldRetry=2]="shouldRetry";W[W.complete=3]="complete"})(jf||(jf={}));Object(zc.b)("EventResultState",jf);uk.Object.defineProperties(yd.prototype,
{state:{configurable:!0,enumerable:!0,get:function(){return this._state},set:function(W){var ta={};jc.ULS.sendTraceTag(5849616,202,50,"Changing event result state. {0}",(ta.OldState=jf[this._state],ta.NewState=jf[W],ta),"ResultType",this.g6e());this._state=W}}});Object(zc.a)(yd,"AEventResult",null,[983]);Am(Ae,yd);Ae.prototype.g6e=function(){return"GetMoreInfo Result"};uk.Object.defineProperties(Ae.prototype,{PS:{configurable:!0,enumerable:!0,get:function(){return this.umb}},ipa:{configurable:!0,
enumerable:!0,get:function(){return this.gUc}},Zhi:{configurable:!0,enumerable:!0,get:function(){return this.Xae}}});Object(zc.a)(Ae,"GetMoreInfoResult",yd,[982,983]);var dc=b(79),za=b(37),Mb=b(896),hc=b(390),cc=b(166),Ec=b(739),Lc=b(638);De.prototype.fcj=function(){this.s$a.ic(kc.a.openUrlInNewTab,Jf.a.frame,Object($e.a)(this,this.openUrlInNewTab,"openUrlInNewTab"));this.s$a.ic(kc.a.rQa,Jf.a.frame,Object($e.a)(this,this.rQa,"openDocumentUrl"));rd.AFrameworkApplication.oR?this.vqf():this.s$a.gf(kc.a.U8b,
Jf.a.frame,Object($e.a)(this,this.U8b,"documentLoaded"),96)};De.prototype.openUrlInNewTab=function(W,ta,ob,Kb,qc){qc&&qc.MenuItemId&&(W={},jc.ULS.sendTraceTag(5849678,202,50,"Opening new tab {0}",(W.Id=qc.SourceControlId,W.AppType=Lc.a[this.Xca],W)),za.a.wf(qc.MenuItemId.toString(),"_blank",void 0,"NewAndOpenCommonHelpers:OpenUrlInNewTab"));return 32};De.prototype.rQa=function(W,ta,ob,Kb,qc){if(qc&&qc.MenuItemId){var Bb=rd.AFrameworkApplication.ha.ra("WacInTabOpenMRUIsEnabledForUiHost"),sd=rd.AFrameworkApplication.ha.ra("UiHostSupportsDocRebootFeatures");
jc.ULS.sendTraceTag(592237459,202,50,"[InTabOpenMRUIsEnabledForUiEmbed: {0}][UiEmbedSupportsDocReboot: {1}]",Bb,sd);if(Bb&&sd){W={};jc.ULS.sendTraceTag(592237458,202,50,"Opening new tab {0}",(W.Id=qc.SourceControlId,W.AppType=Lc.a[this.Xca],W));qc=qc.MenuItemId.toString();var Vd={};Vd[hc.a.sRa]="1";Vd[hc.a.documentUrl]=qc;Vd[hc.a.reason]=Ec.a.open;jc.ULS.sendTraceTag(592237460,202,50,"Send PostMessage to the Ui host to reboot a document");rd.AFrameworkApplication.jW().execute(function(bf){bf.Nj(cc.a.Zua,
Vd)})}else this.openUrlInNewTab(W,ta,ob,Kb,qc)}return 32};De.prototype.U8b=function(){this.vqf();return 32};De.prototype.Oca=function(W,ta,ob){ob=void 0===ob?"":ob;if(ta&&ta.TF){var Kb=Mb.a[ta.status];ta=ta.TF.getTime();var qc=this.Hw()-ta,Bb={};jc.ULS.sendTraceTag(5849679,202,50,"Making request to the WAC server {0}",(Bb.Caller=W,Bb.RequestStatus=Kb,Bb.ElapsedMs=qc,Bb.StartTime=ta,Bb.Notes=ob,Bb))}else ob={},jc.ULS.sendTraceTag(5849680,202,50,"Attempted to make a request to the WAC server with null request item {0}",
(ob.Caller=W,ob))};De.prototype.vqf=function(){var W=rd.AFrameworkApplication.ha.ra("QPGVCI"),ta=dc.a.fD(document.URL,"wdNewAndOpenCt",W);if(ta){ta=parseInt(ta);var ob=dc.a.fD(document.URL,"wdPreviousSession",W);W=dc.a.fD(document.URL,"wdPreviousCorrelation",W);var Kb=rd.AFrameworkApplication.ha.ra("NAOPLP");if(rd.AFrameworkApplication.oR){var qc=rd.AFrameworkApplication.oR.getTime();if(!ta||ta>qc)Kb={},jc.ULS.sendTraceTag(5849682,202,15,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Invalid timestamp {0}",
(Kb.ClickTimestamp=ta,Kb.DocumentLoadedTime=qc,Kb.SessionId=ob,Kb.Correlation=W,Kb));else{var Bb={};jc.ULS.sendTraceTag(5849683,202,Kb?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Click-to-load perf {0}",(Bb.ClickToLoadTime=qc-ta,Bb.ClickTimestamp=ta,Bb.SessionId=ob,Bb.Correlation=W,Bb))}}else qc={},jc.ULS.sendTraceTag(5849681,202,Kb?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Not logging because document loaded time has not been set {0}",(qc.ClickTimestamp=ta,qc.SessionId=ob,
qc.Correlation=W,qc))}};De.CN=function(){return new De(new pd.a(function(){return rd.AFrameworkApplication.Ib}),new pd.a(function(){return rd.AFrameworkApplication.Ld}),new pd.a(function(){return rd.AFrameworkApplication.sa}),new pd.a(function(){return rd.AFrameworkApplication.sa.Qa.Yj}),new pd.a(function(){return rd.AFrameworkApplication.Yi}),function(){return(new Date).getTime()},new pd.a(function(){return rd.AFrameworkApplication.sa.Qa.ZW}),new pd.a(function(){return rd.AFrameworkApplication.supportsGetMoreInfoForPersonalStorage}))};
uk.Object.defineProperties(De.prototype,{s$a:{configurable:!0,enumerable:!0,get:function(){return this.La.value}},zEb:{configurable:!0,enumerable:!0,get:function(){return this.Yg.value}},Jvf:{configurable:!0,enumerable:!0,get:function(){return this.Rog.value}},Xca:{configurable:!0,enumerable:!0,get:function(){return this.m2.value}},Unc:{configurable:!0,enumerable:!0,get:function(){return this.re.value}},Hw:{configurable:!0,enumerable:!0,get:function(){return this.BLc}},ZW:{configurable:!0,enumerable:!0,
get:function(){return this.Ftg.value}},supportsGetMoreInfoForPersonalStorage:{configurable:!0,enumerable:!0,get:function(){return this.EYb.value}}});uk.Object.defineProperties(De,{instance:{configurable:!0,enumerable:!0,get:function(){return De.Na||(De.Na=De.CN())}}});De.Na=null;Object(zc.a)(De,"NewAndOpenCommonHelpers",null,[943]);var he=b(107);Hf.prototype.xMg=function(){this.sSc=this.jdb+1};Hf.prototype.oOd=function(W){this.ej&&(this.re.kq(this.ej),this.ej=null);W&&(this.sSc=0)};Hf.prototype.uKj=
function(W){var ta=this.EPj;0<=ta?(this.xMg(),this.oOd(!1),this.ej=new he.a(4,1,ta,W,107),this.re.$g(this.ej)):(this.oOd(!0),W={},jc.ULS.sendTraceTag(5849676,202,50,"Retries exhausted {0}",(W.Action=this.r8d,W)))};uk.Object.defineProperties(Hf.prototype,{jdb:{configurable:!0,enumerable:!0,get:function(){return this.sSc}},EPj:{configurable:!0,enumerable:!0,get:function(){return this.jdb>=this.$0f.length?-1:this.$0f[this.jdb]}},$0f:{configurable:!0,enumerable:!0,get:function(){if(!this.PXb){var W=(this.Dzg.value||
"0").split(",");this.PXb=[];for(var ta=0;ta<W.length;ta++){var ob=parseInt(W[ta]);isNaN(ob)?(ob={},jc.ULS.sendTraceTag(5849677,202,15,"Retry interval list contains non-number element {0}",(ob.Action=this.r8d,ob.Entry=W[ta],ob))):Array.add(this.PXb,ob)}}return this.PXb}}});Object(zc.a)(Hf,"RetryHelper",null,[]);var qe=b(40),Af=b(28);Am(zf,je);zf.prototype.QCi=function(){this.Oyd("Document opened")};zf.prototype.Oah=function(W){var ta=this;return function(){ta.Oyd(W,!0)}};zf.prototype.$Ff=function(W,
ta){ta=void 0===ta?null:ta;var ob={};jc.ULS.sendTraceTag(5849617,202,50,"Attempting to get GetMoreInfo properties {0}",(ob.Trigger=W,ob));3===this.To.state?(ta&&this.FOe(ta,this.To),ta={},jc.ULS.sendTraceTag(5849619,202,50,"GetMoreInfo already populated. {0}",(ta.Trigger=W,ta))):this.Oyd(W);return this.To};zf.prototype.Oyd=function(W,ta){this.Wmb.oOd(!(void 0===ta?0:ta));1===this.To.state?(ta={},jc.ULS.sendTraceTag(5849620,202,50,"Not starting new request, because one is already in progress {0}",
(ta.Trigger=W,ta.RetryIndex=this.Wmb.jdb,ta))):(ta={},jc.ULS.sendTraceTag(5849621,202,50,"Making GetMoreInfo request {0}",(ta.Trigger=W,ta.RetryIndex=this.Wmb.jdb,ta)),this.To.state=1,ta=String.format("{0}GetMoreInfoHandler.ashx?{1}",this.iEb.ZW,rd.AFrameworkApplication.uj),this.iEb.zEb.y$(ta,1,null,null,[zf.jhe,zf.qle],!1,5,this.U$g(),this.T$g(W),null))};zf.prototype.U$g=function(){var W=this;return function(ta){var ob=!1,Kb=!1,qc=!1;if(rd.AFrameworkApplication.ha.ra("GetMoreInfoDataFromResponseBody"))if(ta.data.oe){var Bb=
qe.d(ta.data.oe);var sd=Bb.ev;Bb.returnValue?sd?(qc=!0,W.To.gUc=sd.StorageServiceDisplayName,W.To.umb=zf.lmf(sd.PersonalFileStorageUrl)?sd.PersonalFileStorageUrl:"",""===W.To.PS&&"SharePointOnlineConsumer"===rd.AFrameworkApplication.ha.Wa("FileSource")&&(W.To.umb=dc.a.Xda(rd.AFrameworkApplication.breadcrumbFolderUrl)),ob=""===W.To.PS&&""!==W.To.ipa):jc.ULS.sendTraceTag(25298113,202,15,"Response body could not be casted into a GetMoreInfoResponseData type. Will fallback to reading the data from the headers"):
jc.ULS.sendTraceTag(25298112,202,15,"Failed to deserialize GetMoreInfo response body. Will fallback to reading the data from the headers")}else jc.ULS.sendTraceTag(25298083,202,15,"Could not find GetMoreInfo data on the response body. Will fallback to reading the data from the headers");qc||((sd=ta.data.responseHeaders)?(W.To.gUc=(sd[zf.qle]||"").toString(),ob=(sd[zf.jhe]||"").toString(),W.To.umb=zf.lmf(ob)?ob:"",""===W.To.PS&&"SharePointOnlineConsumer"===rd.AFrameworkApplication.ha.Wa("FileSource")?
(W.To.umb=dc.a.Xda(rd.AFrameworkApplication.breadcrumbFolderUrl),ob=""===W.To.PS&&""!==W.To.ipa):ob=""===ob&&""!==W.To.ipa):(jc.ULS.sendTraceTag(5849622,202,50,"Null response headers received."),Kb=!0));qc=String.format("Success at RetryIndex: {0}, InvalidResponse: {1}, InstantiatingPersonalStorage: {2}, InfoFoundInResponseBody: {3}",W.Wmb.jdb,Kb,ob,qc);W.iEb.Oca("GetMoreInfoActor.CreateGetMoreInfoFromServerSuccessCallback",ta.data,qc);W.r1f(3,ob,Kb)}};zf.prototype.T$g=function(W){var ta=this;return function(ob){ta.iEb.Oca("GetMoreInfoActor.CreateGetMoreInfoFromServerFailureCallback",
ob.data,"Failure");ta.r1f(2);ta.Wmb.uKj(ta.Oah(W))}};zf.prototype.r1f=function(W,ta,ob){this.To.state=W;this.To.Xae=void 0===ta?!1:ta;this.To.YMc=void 0===ob?!1:ob;this.L$c(this.To)};zf.CN=function(){return new zf(new pd.a(function(){return De.instance}),new pd.a(function(){return rd.AFrameworkApplication.wYh}))};zf.lmf=function(W){if(!W)return jc.ULS.sendTraceTag(5849624,202,50,"Attempted to check an empty url for validity as a StorageHostUrl."),!1;if(Af.a.Yl(W).startsWith("https://"))return!0;jc.ULS.sendTraceTag(5849625,
202,10,"StorageUrl has invalid scheme.");return!1};uk.Object.defineProperties(zf.prototype,{iEb:{configurable:!0,enumerable:!0,get:function(){return this.P2.value}}});uk.Object.defineProperties(zf,{instance:{configurable:!0,enumerable:!0,get:function(){return zf.Na||(zf.Na=zf.CN())}}});zf.jhe="PersonalFileStorageUrl";zf.qle="StorageServiceDisplayName";zf.Na=null;Object(zc.a)(zf,"GetMoreInfoActor",je,[]);var xf=b(102),fc=b(96);Ue.prototype.IWc=function(W){this.$a.addHandler(this.hoe,W)};Ue.prototype.SFg=
function(W){this.$a.addHandler(this.edf,W)};Ue.prototype.mKj=function(){var W=new he.a(5,2,this.kug,Object($e.a)(this,this.cdi,"inactiveLoop"),108);this.ddi.$g(W)};Ue.prototype.cdi=function(){var W=this.M3e(),ta=this.Hw()-W;if(ta>this.qCc&&this.eU){var ob={};jc.ULS.sendTraceTag(5849626,202,50,"User went inactive {0}",(ob.TimeSinceLastActive=ta,ob));this.eU=!1;this.$a.raiseEvent(this.edf)}W-this.Xce>this.qCc&&(this.eU=!0,this.$a.raiseEvent(this.hoe));this.Xce=W};Ue.CN=function(){return new Ue(new pd.a(function(){return xf.a.instance}),
function(){return rd.AFrameworkApplication.fof.getTime()},function(){return(new Date).getTime()},new pd.a(function(){return rd.AFrameworkApplication.qCc}),!0)};uk.Object.defineProperties(Ue.prototype,{ddi:{configurable:!0,enumerable:!0,get:function(){return this.re.value}},M3e:{configurable:!0,enumerable:!0,get:function(){return this.ltg}},Hw:{configurable:!0,enumerable:!0,get:function(){return this.BLc}},qCc:{configurable:!0,enumerable:!0,get:function(){return this.RYb.value}}});uk.Object.defineProperties(Ue,
{instance:{configurable:!0,enumerable:!0,get:function(){return Ue.Na||(Ue.Na=Ue.CN())}}});Ue.Na=null;Object(zc.a)(Ue,"InactivityManager",null,[]);var Gc=b(81),xd=b(1115);Am(He,yd);He.prototype.g6e=function(){return"MruActor Result"};uk.Object.defineProperties(He.prototype,{eAd:{configurable:!0,enumerable:!0,get:function(){return this.ife}},Xuf:{configurable:!0,enumerable:!0,get:function(){return this.jfe}},dAd:{configurable:!0,enumerable:!0,get:function(){return this.hfe}},JPj:{configurable:!0,enumerable:!0,
get:function(){return this.lme}}});Object(zc.a)(He,"MruResult",yd,[984,983]);var Id=b(242);qd.prototype.Rpi=function(W,ta){return W===Id.a.Led||20===ta||18===ta||3===ta};qd.prototype.ari=function(W){return 3===W||5===W||6===W||7===W||9===W||10===W||11===W||12===W||13===W||14===W||15===W||16===W||23===W||26===W||27===W||28===W};qd.prototype.reset=function(){this.Uzb=this.retryCount=0;this.ARc=this.BCb=null;this.task&&(this.taskManager.kq(this.task),this.task=null)};qd.prototype.$gi=function(W,ta,ob,
Kb){this.ARc=String.format("{0}_{1}",ob,Kb);if(this.retryCount>=this.qEi)return jc.ULS.sendTraceTag(562656907,202,50,"Max retries exceeded"),!1;if(this.Rpi(ob,Kb))return jc.ULS.sendTraceTag(562656908,202,50,"Encountered permanent error. Not retrying"),!1;if(this.ari(Kb)&&1<=this.Uzb)return this.BCb=ob,!1;ta=Math.max(ta,this.Ugc*Math.pow(2,this.Uzb));if(26===Kb)ta=Math.max(ta,3E4);else if(27===Kb||28===Kb)ta=Math.max(ta,6E4);9===Kb||412===ob&&(null==this.BCb||412!==this.BCb)?ta=500:this.Uzb+=1;this.BCb=
ob;this.retryCount+=1;this.task&&this.taskManager.kq(this.task);jc.ULS.sendTraceTag(562656909,202,50,"Scheduling next retry after {0} ms.",ta);this.task=new he.a(2,1,ta,W,107);this.taskManager.$g(this.task);return!0};uk.Object.defineProperties(qd.prototype,{Usc:{configurable:!0,enumerable:!0,get:function(){return this.ARc}}});Object(zc.a)(qd,"RetryManager",null,[]);var le=b(99),Wd=b(134);Object(zc.a)(ne,"WriteOptions",null,[]);var Je=b(618),lf=b(355);Am(od,je);od.prototype.Udj=function(){this.cx.s$a.ic(kc.a.renameMostRecentlyUsedFileEntry,
Jf.a.frame,Object($e.a)(this,this.Tij,"renameMruEntry"))};od.prototype.Tij=function(){return this.Z2d("Rename")};od.prototype.aDi=function(){this.Wsf("File Opened")};od.prototype.bDi=function(){this.Wsf("IntervalUpdate")};od.prototype.Wsf=function(W){var ta={};jc.ULS.sendTraceTag(5849670,202,50,"Starting update of MRU entry {0}",(ta.Trigger=W,ta));this.Z2d(W)};od.prototype.j5=function(W){(W=Af.a.j5(W))&&W.startsWith(".")&&(W=W.substring(1,W.length));return W};od.prototype.X_e=function(){switch(this.cx.Xca){case 3:return"Word";
case 1:return"Excel";case 2:return"PowerPoint";case 5:return"Visio";case 4:return"OneNote";default:return"Unknown"}};od.prototype.n5h=function(W){var ta=this.htg();if(!ta)return null;var ob=new ne;ob.documentUrl=this.n9d.value?encodeURI(ta):ta;ob.mruItemId=this.ZVb;ob.app=this.X_e();if(ta=this.$v())ob.folderName=ta.breadcrumbFolderName,ta=ta.fn,ob.documentName=Af.a.Lq(ta),ob.documentExt=this.j5(ta);W&&(ob.documentName?ob.documentName.length?255<=ob.documentName.length?W.set("DocumentNameLength","Long"):
2084<=ob.documentName.length&&W.set("DocumentNameLength","VeryLong"):W.set("DocumentNameLength","0"):W.set("DocumentNameLength","Null"));return JSON.stringify(ob)};od.prototype.Z2d=function(W,ta){ta=void 0===ta?!1:ta;if(4===this.cx.Xca&&!rd.AFrameworkApplication.Yua)return 2;var ob=Wd.a.us();ob&&(ob.set("Trigger",W),ob.set("IsRetry",ta?"true":"false"),ob.set("MruIdSent",this.ZVb?"true":"false"),ob.set("URLEncoded",this.n9d.value?"true":"false"));le.Health.instance.recordKpiUsage("WriteMru",0,"smartfio",
ob);W=this.n5h(ob);if(!W)return ta=!rd.AFrameworkApplication.webEditingEnabled,ob&&(ob.set("WebEditingIsEnabled",rd.AFrameworkApplication.webEditingEnabled?"true":"false"),ob.set("ProtectedFile",rd.AFrameworkApplication.ctc?"true":"false")),le.Health.instance.recordKpiFailure("WriteMru","MissingDocumentUrl",ta,!1,Object.assign(new lf.a,{extendedProperties:ob})),2;this.Msa&&!ta&&this.Msa.reset();ob=String.format("{0}MruV2ServiceHandler.ashx?rs={1}",this.cx.ZW,this.localeName);this.Ane?this.AFc["X-FileId"]=
rd.AFrameworkApplication.uj:ob+=String.format("&{0}",rd.AFrameworkApplication.uj);rd.AFrameworkApplication.hc&&(this.AFc["X-Office-AudienceGroup"]=Object(Gc.a)(String,rd.AFrameworkApplication.hc.AudienceGroup)||"");this.AFc["X-Timeout"]=15E3;return this.cx.zEb.jm(ob,2,W,this.AFc,!0,5,Object($e.a)(this,this.s2j,"writeMruV2EntryOnServerSuccessCallback"),Object($e.a)(this,this.veh,"createWriteMruV2EntryOnServerFailureCallback"),null,void 0,void 0,void 0,void 0,"4")};od.prototype.s2j=function(W){this.n$e(W.data)};
od.prototype.n$e=function(W){var ta=Wd.a.us();this.Msa&&(ta&&this.Msa.Usc&&(ta.set("LastError",this.Msa.Usc),ta.set("NumRetries",this.Msa.retryCount.toString())),this.Msa.reset());var ob=xd.c(W.oe);ob&&ob.diagnostics_data&&(this.ZVb=ob.diagnostics_data.mru_id);W=+W.f4-+W.TF;ta&&ta.set("RequestDuration",W.toString());le.Health.instance.recordKpiSuccess("WriteMru",Object.assign(new lf.a,{extendedProperties:ta}))};od.prototype.veh=function(W){if(W.data.httpStatus===Id.a.itb)this.n$e(W.data);else{var ta=
W.data.httpStatus===Id.a.GHb,ob=Wd.a.us();this.A$e(this.Msa,W,this.keh(),ob);ob&&(ob.set("StatusCode",W.data.httpStatus.toString()),ta||this.RWc(W.data,ob));le.Health.instance.recordKpiFailure("WriteMru",String.format("RequestFailed_{0}",W.data.httpStatus),ta,!1,Object.assign(new lf.a,{extendedProperties:ob}))}};od.prototype.keh=function(){var W=this;return function(){W.Z2d("Retry",!0)}};od.prototype.DYh=function(){this.U9a("Polling")};od.prototype.CYh=function(){this.U9a("Retry",!0)};od.prototype.UCi=
function(){this.U9a("Open")};od.prototype.TCi=function(){this.U9a("Activity")};od.prototype.SCi=function(){this.U9a("OpenRecentLinks",!1,!0)};od.prototype.RCi=function(){this.U9a("ActivityRecentLinks",!1,!0)};od.prototype.U9a=function(W,ta,ob){ta=void 0===ta?!1:ta;ob=void 0===ob?!1:ob;var Kb={};jc.ULS.sendTraceTag(5849674,202,50,"Making GetMru request {0}",(Kb.Trigger=W,Kb));if(Kb=Wd.a.us())Kb.set("Trigger",W),Kb.set("IsRetry",ta?"true":"false"),ob&&Kb.set("RecentLinks","true");le.Health.instance.recordKpiUsage("GetMru",
0,"smartfio",Kb);this.gsa&&!ta&&this.gsa.reset();ob?this.HHe(Object($e.a)(this,this.EYh,"getMruV2ForRecentLinksFromServerSuccessCallback"),Object($e.a)(this,this.AYh,"getMruForRecentLinksFromServerFailureCallback"),!0):this.HHe(Object($e.a)(this,this.FYh,"getMruV2FromServerSuccessCallback"),Object($e.a)(this,this.BYh,"getMruFromServerFailureCallback"))};od.prototype.RWc=function(W,ta){W&&W.responseHeaders&&(W=W.responseHeaders["X-CorrelationId"])&&ta.set("ServerCorrelationId",W)};od.prototype.Pzi=
function(W,ta){W&&(ta&&ta.set("RequestDuration",(+W.f4-+W.TF).toString()),le.Health.instance.recordKpiSuccess("GetMru",Object.assign(new lf.a,{extendedProperties:ta})))};od.prototype.FYh=function(W){this.o4e(W)};od.prototype.o4e=function(W,ta){ta=void 0===ta?!1:ta;var ob="",Kb=null,qc=null,Bb=null,sd=xd.c(W.data.oe);sd&&(Kb=sd.places?sd.places.items:[],qc=sd.documents?sd.documents.items:[],(Bb=xd.a(sd,ta))&&(ob=qe.c(Bb)));rd.AFrameworkApplication.sa&&rd.AFrameworkApplication.sa.Qa.W_&&me.c()&&!ta&&
appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(ob,!0));ob=Wd.a.us();this.gsa&&(ob&&this.gsa.Usc&&(ob.set("LastError",this.gsa.Usc),ob.set("NumRetries",this.gsa.retryCount.toString())),this.gsa.reset());ta&&ob&&ob.set("RecentLinks","true");Bb||Kb||qc?(ta?this.cx.Oca("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",W.data,"Success"):this.cx.Oca("MruActor.GetMruV2FromServerSuccessCallback",W.data,"Success"),this.fEc(3,Bb,Kb,qc),this.Pzi(W.data,ob)):(ta?this.cx.Oca("MruActor.GetMruV2ForRecentLinksFromServerSuccessCallback",
W.data,"Failure: Invalid JSON"):this.cx.Oca("MruActor.GetMruV2FromServerSuccessCallback",W.data,"Failure: Invalid JSON"),ob&&this.RWc(W.data,ob),le.Health.instance.recordKpiFailure("GetMru","JsonParseFailed",!1,!1,Object.assign(new lf.a,{extendedProperties:ob})),this.fEc(3,null,null,null,!0));this.L$c(this.hU)};od.prototype.EYh=function(W){this.o4e(W,!0)};od.prototype.A$e=function(W,ta,ob,Kb){var qc=0,Bb=0,sd=xd.c(ta.data.oe);sd&&(null!=sd.response_code&&(qc=sd.response_code,Kb&&Kb.set("MruResponseCode",
qc.toString()),9===qc&&(this.ZVb="")),sd.error_data&&null!=sd.error_data.retry_after_ms&&(Bb=sd.error_data.retry_after_ms,Kb&&Kb.set("ExpectedRetryAfter",Bb.toString())));W&&(ta=W.$gi(ob,Bb,ta.data.httpStatus,qc),Kb&&(Kb.set("CurrentRetryCount",W.retryCount.toString()),Kb.set("RetryScheduled",ta?"true":"false")))};od.prototype.BYh=function(W){this.n4e(W)};od.prototype.n4e=function(W,ta){ta=void 0===ta?!1:ta;var ob=W.data.httpStatus===Id.a.GHb,Kb=Wd.a.us();Kb&&(Kb.set("StatusCode",W.data.httpStatus.toString()),
ta&&Kb.set("RecentLinks","true"),ob||this.RWc(W.data,Kb));ta?this.cx.Oca("MruActor.GetMruForRecentLinksFromServerFailureCallback",W.data,"Failure"):this.cx.Oca("MruActor.GetMruFromServerFailureCallback",W.data,"Failure");this.fEc(2);this.A$e(this.gsa,W,Object($e.a)(this,this.CYh,"getMruFromServerRetryTask"),Kb);le.Health.instance.recordKpiFailure("GetMru",String.format("RequestFailed_{0}",W.data.httpStatus),ob,!1,Object.assign(new lf.a,{extendedProperties:Kb}));this.L$c(this.hU);rd.AFrameworkApplication.sa&&
rd.AFrameworkApplication.sa.Qa.W_&&me.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)),ta||appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)))};od.prototype.AYh=function(W){this.n4e(W,!0)};od.prototype.fEc=function(W,ta,ob,Kb,qc){if(3!==this.hU.state||3===W)this.hU.ife=void 0===ta?null:ta,this.hU.jfe=void 0===ob?null:ob,this.hU.hfe=void 0===Kb?null:Kb,this.hU.state=W,this.hU.YMc=void 0===qc?!1:qc,this.hU.lme=this.cx.Hw()};od.prototype.$Ff=function(W,ta){var ob=
{};jc.ULS.sendTraceTag(6029918,202,50,"MRU result requested {0}",(ob.Trigger=W,ob.ResultState=this.hU.state,ob));ta&&3===this.hU.state&&this.FOe(ta,this.hU);return this.hU};od.prototype.HHe=function(W,ta,ob){ob=void 0===ob?!1:ob;this.fEc(1);var Kb={};var qc=ob?String.format(this.cx.ZW+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}&cap={3}",this.xyg,"OfficeSuite",this.localeName,"ClassicMru"):String.format(this.cx.ZW+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}",10,this.X_e(),
this.localeName);this.wyg.value||(qc+="&entity=docs");rd.AFrameworkApplication.hc&&(Kb["X-Office-AudienceGroup"]=Object(Gc.a)(String,rd.AFrameworkApplication.hc.AudienceGroup)||"");ob&&(Kb["X-Office-Application"]="147");this.Ane?Kb["X-FileId"]=rd.AFrameworkApplication.uj:qc+=String.format("&{0}",rd.AFrameworkApplication.uj);this.cx.zEb.jm(qc,1,null,Kb,!0,5,W,ta,null)};od.CN=function(){return new od(new pd.a(function(){return De.instance}),new pd.a(function(){return Je.a.DK(rd.AFrameworkApplication.lcid).name}),
new pd.a(function(){return rd.AFrameworkApplication.sa.Qa.Tw}),rd.AFrameworkApplication.ha.ra("MruWriteFileIdInHeader"),function(){return rd.AFrameworkApplication.sa.Qa.Tx},function(){return rd.AFrameworkApplication.Ll},new pd.a(function(){return rd.AFrameworkApplication.ha.ra("OICEncodeUrlIsEnabled")}))};uk.Object.defineProperties(od.prototype,{AFc:{configurable:!0,enumerable:!0,get:function(){return this.NCg}},cx:{configurable:!0,enumerable:!0,get:function(){return this.P2.value}},localeName:{configurable:!0,
enumerable:!0,get:function(){return this.bwg.value}}});uk.Object.defineProperties(od,{instance:{configurable:!0,enumerable:!0,get:function(){return od.Na||(od.Na=od.CN())}}});od.Na=null;Object(zc.a)(od,"MruActor",je,[]);La.prototype.hi=function(W){this.tb=W;W.register(943,"Common.INewAndOpenCommonHelpers").Ic().Nc(function(){return De.instance});W.register(944,"Common.IEventEmitter<Common.IGetMoreInfoResult>").Ic().Nc(function(){return zf.instance});W.register(944,"Common.IEventEmitter<Common.IMruResult>").Ic().Nc(function(){return od.instance})};
La.prototype.init=function(){var W=this;rd.AFrameworkApplication.ha.tv(function(){W.Fzb()})};La.prototype.Fzb=function(){this.tb.resolve("Common.INewAndOpenCommonHelpers");this.tb.resolve("Common.IEventEmitter<Common.IGetMoreInfoResult>");this.tb.resolve("Common.IEventEmitter<Common.IMruResult>");var W=!1;De.instance.fcj();rd.AFrameworkApplication.Lma&&(W=!0);rd.AFrameworkApplication.pQf&&(od.instance.UCi(),rd.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.WordOnline.recentLinksIsEnabled",
!1)&&od.instance.SCi(),0<rd.AFrameworkApplication.Yuf&&this.Ape(),this.gAj(),W=!0);rd.AFrameworkApplication.supportsGetMoreInfoForPersonalStorage&&W&&zf.instance.QCi();rd.AFrameworkApplication.IXj&&(W=od.instance,W.Udj(),W.aDi(),xf.a.instance.$g(this.JXj))};La.prototype.gAj=function(){Ue.instance.IWc(Object($e.a)(od.instance,od.instance.TCi,"makeGetMruRequestActivityTrigger"));rd.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.WordOnline.recentLinksIsEnabled",!1)&&Ue.instance.IWc(Object($e.a)(od.instance,
od.instance.RCi,"makeGetMruForRecentLinksRequestActivityTrigger"));Ue.instance.IWc(Object($e.a)(this,this.Ape,"addGetMruFromServerTask"));Ue.instance.SFg(Object($e.a)(this,this.whh,"deleteGetMruFromServerTask"))};La.prototype.whh=function(){xf.a.instance.kq(this.Zuf)};La.prototype.Ape=function(){xf.a.instance.$g(this.Zuf)};La.prototype.dispose=function(){this.Cm||(this.Cm=!0,this.Ynb&&(xf.a.instance.kq(this.Ynb),this.Ynb=null))};uk.Object.defineProperties(La.prototype,{name:{configurable:!0,enumerable:!0,
get:function(){return"Common.App.NewAndOpen.Core"}},Zuf:{configurable:!0,enumerable:!0,get:function(){return this.iie||(this.iie=new he.a(5,2,rd.AFrameworkApplication.Yuf,Object($e.a)(od.instance,od.instance.DYh,"getMruFromServerTask"),109))}},JXj:{configurable:!0,enumerable:!0,get:function(){return this.Ynb||(this.Ynb=new he.a(2,2,6E4*rd.AFrameworkApplication.ha.getIntFeatureGate("Microsoft.Office.SharedOnline.MruUpdateIntervalInMinutes",1440),Object($e.a)(od.instance,od.instance.bDi,"makeUpdateMruTask"),
197))}}});Object(zc.a)(La,"CorePackageManager",null,[4,5,3]);var vf=b(556);new kf(0,0,0,0,0,0);new kf(1,1,0,0,0,0);new kf(2,2,0,0,0,0);new kf(3,3,0,0,0,1);new kf(4,3,1,0,1,1);new kf(5,3,0,0,.42,1);new kf(6,3,.83,0,1,1);new kf(7,3,0,0,.58,1);new kf(8,3,.42,0,.58,1);new kf(9,3,.1,.25,.75,.9);new kf(10,3,.1,.9,.2,1);new kf(11,3,.1,.9,.2,1);new kf(12,3,.9,.1,.2,1);new kf(13,3,.4,0,0,1);new kf(14,3,.13,.21,.1,.7);new kf(15,3,.02,.33,.38,.77);new kf(16,3,.57,.17,.95,.75);new kf(17,3,0,.19,.07,.72);new kf(18,
3,0,0,.95,.37);new kf(19,3,.66,0,.34,1);new kf(20,3,.8,0,.2,1);new kf(21,3,.8,0,.2,1);fd.prototype={type:0,startTime:new Fc(0,null),endTime:new Fc(0,null),L5j:new Fc(0,null),x4j:new Fc(0,null),operationType:0};new jd(0,[new fd(5,0,0,0,null,1,1,0)]);new jd(1,[new fd(5,2,0,0,null,0,2,0),new fd(5,2,0,50,null,1,1,0)]);new jd(2,[new fd(1,3,0,167,null,0,1,1),new fd(2,3,0,167,null,0,1,1)]);new jd(3,[new fd(3,3,0,167,null,0,1,1),new fd(4,3,0,167,null,0,1,1)]);new jd(4,[new fd(5,2,0,0,null,0,2,0),new fd(5,
2,0,167,null,1,1,0)]);new jd(5,[new fd(5,2,0,167,null,0,1,0)]);new jd(6,[new fd(1,3,0,100,null,0,1,1),new fd(2,3,0,100,null,0,1,1)]);new jd(7,[new fd(3,3,0,100,null,0,1,1),new fd(4,3,0,100,null,0,1,1)]);new jd(8,[new fd(5,2,0,100,null,1,1,0)]);new jd(9,[new fd(5,2,0,0,null,0,2,0),new fd(5,2,0,100,null,1,1,0)]);new jd(10,[new fd(5,2,0,100,null,0,1,0)]);new jd(11,[new fd(1,3,0,267,null,0,1,1),new fd(2,3,0,267,null,0,1,1)]);new jd(12,[new fd(3,3,0,267,null,0,1,1),new fd(4,3,0,267,null,0,1,1)]);new jd(13,
[new fd(5,2,0,267,null,1,1,0)]);new jd(14,[new fd(5,2,0,0,null,0,2,0),new fd(5,2,0,267,null,1,1,0)]);new jd(15,[new fd(5,2,0,267,null,0,1,0)]);new jd(16,[new fd(6,3,0,267,null,0,1,1),new fd(7,3,0,267,null,0,1,1)]);new jd(17,[new fd(1,3,0,750,null,0,1,1),new fd(2,3,0,750,null,0,1,1)]);new jd(18,[new fd(3,3,0,750,null,0,1,1),new fd(4,3,0,750,null,0,1,1)]);new jd(19,[new fd(5,2,0,750,null,1,1,0)]);new jd(20,[new fd(5,2,0,0,null,0,2,0),new fd(5,2,0,750,null,1,1,0)]);new jd(21,[new fd(6,3,0,1E3,null,0,
1,1),new fd(7,3,0,1E3,null,0,1,1)]);new jd(22,[new fd(1,3,0,367,null,0,1,1),new fd(2,3,0,367,null,0,1,1)]);new jd(23,[new fd(3,3,0,367,null,0,1,1),new fd(4,3,0,367,null,0,1,1)]);new jd(24,[new fd(5,2,0,367,null,1,1,0)]);new jd(25,[new fd(5,2,0,0,null,0,2,0),new fd(5,2,0,367,null,1,1,0)]);new jd(26,[new fd(5,2,0,367,null,0,1,0)]);new jd(27,[new fd(5,2,0,0,null,1,1,0),new fd(5,2,0,50,null,0,1,0)]);new jd(28,[new fd(1,3,0,433,null,0,1,1),new fd(2,3,0,433,null,0,1,1)]);new jd(29,[new fd(5,2,0,0,null,
0,2,0),new fd(5,2,0,50,null,1,1,0),new fd(2,3,0,0,null,40,1,1),new fd(2,3,0,100,null,0,1,1)]);new jd(30,[new fd(2,0,0,0,null,32,1,1),new fd(2,0,0,100,null,32,1,1),new fd(2,3,101,350,null,0,1,1),new fd(3,0,0,0,null,0,2,1),new fd(3,0,0,100,null,0,2,1),new fd(3,3,101,350,null,0,1,1),new fd(5,0,0,0,null,0,2,0),new fd(5,0,0,100,null,1,1,0)]);new jd(31,[new fd(2,3,0,267,null,32,1,1),new fd(3,3,0,267,null,0,2,1),new fd(5,2,0,0,null,1,0,0),new fd(5,2,0,267,null,0,2,0)]);new jd(32,[new fd(5,2,0,0,null,0,2,
0),new fd(5,2,0,100,null,0,2,0),new fd(5,2,101,267,null,1,1,0)]);new jd(33,[new fd(1,10,0,300,null,0,1,1),new fd(2,10,0,300,null,0,1,1)]);new jd(34,[new fd(3,10,0,300,null,0,1,1),new fd(4,10,0,300,null,0,1,1)]);new jd(35,[new fd(1,8,0,750,null,0,1,1),new fd(2,8,0,750,null,0,1,1)]);new jd(36,[new fd(5,2,0,0,null,0,2,0),new fd(5,2,0,200,null,0,2,0),new fd(5,3,201,500,null,1,1,0)]);new jd(37,[new fd(1,2,0,0,null,0,2,1),new fd(2,2,0,0,null,0,2,1),new fd(1,2,0,200,null,0,2,1),new fd(2,2,0,200,null,0,2,
1),new fd(1,3,201,267,null,0,1,1),new fd(2,3,201,267,null,0,1,1)]);new jd(38,[new fd(1,3,0,267,null,0,1,1),new fd(2,3,0,267,null,0,1,1)]);new jd(39,[new fd(5,2,0,0,null,0,2,0),new fd(5,2,0,267,null,1,1,0)]);new jd(40,[new fd(5,2,0,267,null,0,1,0)]);window.location.search.indexOf("AnimationLogging=1");window.requestAnimationFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||
function(W){window.setTimeout(W,16)}}();zd.prototype={Te:null,ANg:5,Epb:null,WYc:0,startTime:null,duration:null,v9b:null,u_c:-1,Lzd:-1,hzd:-1};zd.prototype.Start=function(){this.startTime=new Date;this.v9b={}};zd.prototype.GetRecentAnimationStats=function(){var W,ta=[],ob=0;for(W=se.WYc;W<se.ANg;W++)null!=se.Epb[W]&&(ta[ob]=se.Epb[W],ob++);for(W=0;W<se.WYc;W++)null!=se.Epb[W]&&(ta[ob]=se.Epb[W],ob++);return ta};zd.prototype.GetAnimationSqmStats=function(){var W=[];return W[0]=0>se.u_c?0:se.u_c,W[1]=
0>se.Lzd?0:se.Lzd,W[2]=0>se.hzd?0:se.hzd,W};var se=new zd;var wf=b(224),Uf=b(253),Wf=b(1276),Tf=b(152),ug=b(51),Le=b(35),Qd=b(71),Of=b(21),Ee=b(14),Eg=Wf.a;Am($d,Eg);$d.prototype.cX=function(W){this.$.Dd&65536&&Eg.prototype.cX.call(this,W)};$d.prototype.U9e=function(W){if(Of.a.equals(this.Pvj,this.$.shortcutKeyManager.Vhd(W),!1)){var ta=Tf.b(this.$);if(null===ta||void 0===ta?0:ta.canReceiveFocus)Qd.g(W),ta.Qe(!0,!1)}};uk.Object.defineProperties($d.prototype,{mode:{configurable:!0,enumerable:!0,get:function(){return this.nC},
set:function(W){this.nC=W;switch(W){case 0:this.gma=this.JRg;break;case 2:this.gma=this.w0j;break;case 3:this.gma=this.n6i;break;case 4:this.gma=this.RZg;break;case 5:this.gma=this.Q5i;break;case 6:this.gma=this.$5i;break;default:jc.ULS.shipAssertTag(537170759,0,!0,"Accessibility Mode value is not in allowed values")}}}});Object(zc.a)($d,"EwaAccessibilityManager",Wf.a,[]);var lg=wf.a;Am(Cd,lg);Cd.prototype.create=function(){this.Eb(this.$.da.Aa(15)||new $d(this.$))};Cd.ka=function(W){W.da.Ha(157,
new Cd(W))};Object(zc.a)(Cd,"AccessibilityManagerFactory",wf.a,[]);var Ef=b(10),eg=b(148),Na=b(693),Ib=Na.a;Am(ed,Ib);ed.prototype.dispose=function(){eg.WacAirSpace.aqd()&&eg.WacAirSpace.vCc()};ed.prototype.animate=function(W,ta,ob,Kb,qc){ta&&eg.WacAirSpace.fM(W.element,ta);eg.WacAirSpace.animate(W,Kb,qc);ob&&eg.WacAirSpace.pej(W.element,ob)};Object(zc.a)(ed,"AnimationManager",Na.a,[3]);var vc=b(100),Yc=b(199),Md=b(1019),Ed=b(565),ke=b(84),mc=b(75),Rc=mc.a;Am(uc,Rc);uc.prototype.cnj=function(){var W=
new Yc.a,ta=Ed.a.lr(ke.a.instance.qc("Common.IEventEmitter<Common.IMruResult>")),ob=new pd.a(function(){return ta.result});this.mwd=new pd.a(function(){return new Md.a(ob.value,null)});if(!this.mwd)return W;var Kb=this.mwd.value.Kz("NewAndOpenCoreManager",!1);if(!Kb||3!==Kb.state||!Kb.dAd)return Kb?jc.ULS.sendTraceTag(544289226,0,50,"NewAndOpenCoreManager.RetrieveMruFiles - the mruResult state: {0}, mruResult MruDocuments is null: {1}",Kb.state,!Kb.dAd):jc.ULS.sendTraceTag(544289227,0,50,"NewAndOpenCoreManager.RetrieveMruFiles: the mruResult is null"),
null;Kb=Kb.dAd;for(var qc=["xlsx","xlsb","xlsm"],Bb=0;Bb<Kb.length;Bb++){var sd=Kb[Bb];if(!(0>Array.indexOf(qc,sd.extension))){var Vd=String.format("{0}.{1}",sd.title,sd.extension),bf=xd.b(sd,rd.AFrameworkApplication.isRtl);sd=sd.url;if(Vd&&bf&&sd){var Xf={};W.add((Xf[uc.fileName]=Vd,Xf[uc.friendlyPath]=bf,Xf[uc.section]="mru",Xf[uc.absoluteUrl]=sd,Xf))}else sd||jc.ULS.sendTraceTag(537155200,0,50,"ChangeSourceDialog.GetMruFiles: the DAV url of the file is null")}}return W};uc.prototype.dispose=function(){Rc.prototype.dispose.call(this)};
uc.fileName="FileName";uc.friendlyPath="FriendlyPath";uc.section="Section";uc.absoluteUrl="AbsoluteUrl";Object(zc.a)(uc,"NewAndOpenCoreManager",mc.a,[938,3]);var nd=wf.a;Am(id,nd);id.prototype.create=function(){this.Eb(this.$.da.Aa(451)||this.$.da.Ha(451,new uc(this.$)))};id.ka=function(W){W.da.Ha(164,new id(W))};Object(zc.a)(id,"NewAndOpenCoreFactory",wf.a,[]);var Td=b(1),Fe=b(30),fe=b(5),ef=b(11),If=b(248),Ke=b(20);Lb.x4a=function(W){W=Af.a.Rf(W||"");return new Lb(W)};Lb.Dbc=function(W){return Lb.x4a(Ee.a.instance.fa(W))};
Lb.mfd=function(W){return new Lb(Ee.a.instance.Va(W))};Lb.CKh=function(W,ta){for(var ob=[],Kb=1;Kb<arguments.length;++Kb)ob[Kb-1]=arguments[Kb];return Lb.BKh.apply(null,[Ee.a.instance.Bb(W)].concat(ob))};Lb.BKh=function(W,ta){for(var ob=[],Kb=1;Kb<arguments.length;++Kb)ob[Kb-1]=arguments[Kb];Kb=ob.length;for(var qc=Array(Kb),Bb=0;Bb<Kb;Bb++)qc[Bb]=(ob[Bb]||Lb.KOe).Gwc;return new Lb(String.format.apply(null,[W].concat(qc)))};uk.Object.defineProperties(Lb,{KOe:{configurable:!0,enumerable:!0,get:function(){return Lb.k9d||
(Lb.k9d=new Lb(""))}},Uxd:{configurable:!0,enumerable:!0,get:function(){return Lb.oee||(Lb.oee=Lb.mfd(2).Gwc)}}});Lb.k9d=null;Lb.oee=null;Object(zc.a)(Lb,"SafeHtml",null,[964]);ie.prototype.dispose=function(){this.$&&this.unregister();ef.DOMElementExtensions.vf(this.hia);ef.DOMElementExtensions.vf(this.Rfa);ef.DOMElementExtensions.vf(this.gha);this.gha=this.Rfa=this.hia=this.$=null};ie.prototype.setEnabled=function(W){this.l2f(this.gha,W)};ie.prototype.lvj=function(){this.l2f(this.Rfa,!0)};ie.prototype.readText=
function(W){this.tIb(Lb.x4a(W),!0)};ie.prototype.oRa=function(W){this.tIb(Lb.x4a(W),!1)};ie.prototype.qQf=function(W,ta){if(1>ta||!W)jc.ULS.shipAssertTag(537153954,0,!1,"Skiping listbox description readout");else{var ob=new Sys.StringBuilder;W=String.format(Ee.a.instance.Bb(33),ta,W);vd(ob,W);vd(ob,Ee.a.instance.fa(839));this.tIb(Lb.x4a(ob.toString()),!1)}};ie.prototype.daj=function(W,ta,ob){if(1>ob||1>ta||ta>ob||!W)jc.ULS.shipAssertTag(537153952,0,!1,"Skipping listbox item readout");else{var Kb=
new Sys.StringBuilder;vd(Kb,W);Kb.append(String.format(Ee.a.instance.Bb(54),ta,ob));this.tIb(Lb.x4a(Kb.toString()),!1)}};ie.prototype.nQf=function(W){W=this.i1h(W);this.tIb(W,!1)};ie.prototype.tIb=function(W,ta){if(W=W?W.Gwc:null)ta=ta?this.gha:this.Rfa,Of.a.equals(ta.innerHTML,W,!1)&&(W+=Lb.Uxd),ta.innerHTML=W};ie.prototype.$bb=function(W,ta){this.hia.getAttribute(fe.a.nta)!==ta&&this.hia.setAttribute(fe.a.nta,ta);W=W?Lb.x4a(W).Gwc:"";this.hia.innerHTML=W};ie.prototype.eaj=function(W,ta,ob,Kb,qc){qc=
void 0===qc?!1:qc;var Bb=Ee.a.instance.Bb(53);jc.ULS.shipAssertTag(537153949,0,!(void 0===W||null===W));jc.ULS.shipAssertTag(537153948,0,!(void 0===ta||null===ta));jc.ULS.shipAssertTag(537153947,0,!(void 0===ob||null===ob));jc.ULS.shipAssertTag(537153946,0,!(void 0===Kb||null===Kb));jc.ULS.shipAssertTag(537153945,0,!(void 0===Bb||null===Bb));W=String.format(Bb,W||"",ta||"",ob||"",Kb||"");qc?this.$bb(W,fe.a.P_a):this.readText(W)};ie.prototype.CVj=function(W){var ta=this.gha.style;W?(W=If.a.I2b(W.cell,
ta),ta=W.mM,ta.top=ta.left=ta.bottom=ta.right=null,W.O$()):ta.cssText=""};ie.prototype.i1h=function(W){switch(W){case -1985798686:return Lb.Dbc(12);case -911352779:return Lb.Dbc(11);case 237279923:return Lb.Dbc(13);case -1502853784:return Lb.mfd(81);case -111689794:return Lb.mfd(78);case -287251124:return this.Hjd(1290,function(ta){return ta.bold});case -1925065947:return this.Hjd(1291,function(ta){return ta.italic});case 1764140053:return this.Hjd(1292,function(ta){return ta.underline})}return null};
ie.prototype.register=function(){jc.ULS.shipAssertTag(537153944,0,!!this.$,"Can't register to ewaControl's events");this.$&&(jc.ULS.shipAssertTag(537153943,0,!!this.$.Ka,"Can't register to CommandHandlerManager's event"),this.$.Ka&&this.$.Ka.HGa(this.Izf))};ie.prototype.unregister=function(){this.$&&this.$.Ka.NRa(this.Izf)};ie.prototype.l2f=function(W,ta){var ob=W===this.Rfa;ta?(W.setAttribute(fe.a.nta,fe.a.P_a),ob&&W.setAttribute(fe.a.Vd,fe.a.mta),W.setAttribute(fe.a.AQ,fe.a.Zo),W.removeAttribute(fe.a.AQ),
W.innerHTML+=" "):(W.removeAttribute(fe.a.nta),ob&&W.removeAttribute(fe.a.Vd),W.setAttribute(fe.a.AQ,fe.a.Dj))};ie.prototype.Hjd=function(W,ta){var ob=this.activeCell;if(!ob)return null;ta=ta(ob)?7:8;return Lb.CKh(ta,Lb.Dbc(W))};uk.Object.defineProperties(ie.prototype,{Uya:{configurable:!0,enumerable:!0,get:function(){return this.jwg}},isActive:{configurable:!0,enumerable:!0,get:function(){return!0}},activeCell:{configurable:!0,enumerable:!0,get:function(){return Ke.g(this.$).rc(null)}}});Object(zc.a)(ie,
"AriaLiveNotifier",null,[939,915,3]);var ng=wf.a;Am(Zd,ng);Zd.prototype.create=function(){this.Eb(this.$.da.Aa(211)||new ie(this.$,this.$.xw,this.$.zf))};Zd.ka=function(W){W.da.Ha(212,new Zd(W))};Object(zc.a)(Zd,"AriaLiveNotifierFactory",wf.a,[]);var rf=b(23),dg=b(218);Pc.prototype.readText=function(W){this.AX.setAttribute(fe.a.Zt,W);this.H7.setAttribute(fe.a.Zt,W);this.SMj()};Pc.prototype.dispose=function(){this.W0&&this.W0.parentNode&&this.W0.parentNode.removeChild(this.W0);this.H7=this.AX=this.W0=
this.cka=null};Pc.prototype.ych=function(W){var ta=W.Lb+"readoutElementWrapper",ob=W.Lb+"readoutElement1",Kb=W.Lb+"readoutElement2";this.W0=document.getElementById(ta);this.W0||(this.W0=document.createElement(dg.a.div),this.W0.id=ta,this.AX=document.createElement(dg.a.label),this.AX.id=ob,this.H7=document.createElement(dg.a.label),this.H7.id=Kb,this.AX.style.width="0px",this.AX.style.height="0px",this.H7.style.width="0px",this.H7.style.height="0px",this.AX.tabIndex=-1,this.H7.tabIndex=-1,this.W0.appendChild(this.AX),
this.W0.appendChild(this.H7),W=W.Lb+fe.a.g5c,ta=document.getElementById(W),jc.ULS.shipAssertTag(537153942,3,!!ta,"FocusBasedReadout.CreateReadoutElementsIfNeeded: expected to find contentAreaDiv with id: {0}",W),ta&&ta.appendChild(this.W0))};Pc.prototype.j5i=function(){this.cka&&this.AX&&this.H7&&(this.cka.setAttribute(fe.a.E3,this.AX.id),this.cka.setAttribute(fe.a.EZc,String.format("{0} {1}",this.AX.id,this.H7.id)))};Pc.prototype.SMj=function(){if(this.isActive){var W="";ef.DOMElementExtensions.hasAttribute(this.cka,
fe.a.E3)&&(W=this.cka.getAttribute(fe.a.E3).toString());this.cka.setAttribute(fe.a.E3,W===this.AX.id?this.H7.id:this.AX.id)}else jc.ULS.shipAssertTag(537153941,0,!1,"FocusBasedReadout.SwitchVirtualFocus: called when is not active.")};Pc.I7a=function(){if(null==Pc.Tvb)if(Td.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ActiveDescendantGridReadout",!1))Pc.Tvb=!0,jc.ULS.sendTraceTag(537153940,0,50,"FocusBasedReadout.IsFocusBasedCellReadoutActive: ActiveDescendantGridReadout Flight is enabled");
else if(Pc.Tvb=!1,rf.a.lI||rf.a.Hf)Pc.Tvb=!0,jc.ULS.sendTraceTag(537153939,0,50,"FocusBasedReadout.IsFocusBasedCellReadoutActive: The FocusBasedCellReadout BRS is on");return Pc.Tvb};Pc.ka=function(W){Pc.I7a()&&W.da.Ha(244,new Pc(W,Ke.g(W).Ac.textBox.qf))};uk.Object.defineProperties(Pc.prototype,{isActive:{configurable:!0,enumerable:!0,get:function(){return!!this.cka&&document.activeElement===this.cka}}});Pc.Tvb=null;Object(zc.a)(Pc,"FocusBasedReadout",null,[915,3]);var qf=wf.a;Am(Sc,qf);Sc.prototype.create=
function(){var W=this;Pc.I7a()?Ke.g(this.$).Ac.textBox.aV(function(){var ta=W.$.da.Aa(244)||new Pc(W.$,Ke.g(W.$).Ac.textBox.qf);W.Eb(ta)}):this.Eb(null)};Sc.ka=function(W){W.da.Ha(315,new Sc(W))};Object(zc.a)(Sc,"FocusBasedReadoutFactory",wf.a,[]);var $g=b(89),nf=b(24),Qe=b(45),fh=b(246),Rg=b(46),ah=b(43),pg=b(119);Ud.xjd=function(W){return Ud.K5e(W.toString())};Ud.K5e=function(W){return Ud.k0g.test(W)?W.replace(Ud.U9i,"$1 ").replace(Ud.T9i,' "$1"').trim():W};Ud.Cjj=function(W){var ta=W.lastIndexOf("!");
return W.substring(0,-1<ta?ta+1:0)+Ud.K5e(W.substring(-1<ta?ta+1:0,W.length))};uk.Object.defineProperties(Ud,{U9i:{configurable:!0,enumerable:!0,get:function(){return Ud.aie||(Ud.aie=RegExp("([A-Z]+)","g"))}},T9i:{configurable:!0,enumerable:!0,get:function(){return Ud.$he||(Ud.$he=RegExp("([A-Z])","g"))}},k0g:{configurable:!0,enumerable:!0,get:function(){return Ud.C6d||(Ud.C6d=RegExp("^\\$?[A-Z]+\\$?[0-9]+$|^\\$?[A-Z]+\\$?[0-9]+:\\$?[A-Z]+\\$?[0-9]+$|^\\$?[A-Z]+:\\$?[A-Z]+$|^\\$?[0-9]+:\\$?[0-9]+$"))}}});
Ud.aie=null;Ud.$he=null;Ud.C6d=null;Object(zc.a)(Ud,"RangeAriaExtensions",null,[]);Object(zc.a)(Ne,"SelectionReadoutState",null,[]);var Ga=b(62),Hb=b(78);Hd.prototype.dispose=function(){this.$&&this.wm();$g.a.Fa(this.K1b);this.sparklineManager=this.$=this.K1b=null};Hd.prototype.A0e=function(W,ta,ob){ob=void 0===ob?!0:ob;if(!W)return"";var Kb=this.$.da,qc=new Sys.StringBuilder;this.mOg(qc,W,ta);if(Td.EwaSettings.isChangeGateEnabled("OfficeVSO:4124702_ColumnHeaderReadout")){var Bb=this.tableManager.ALa(W.range);
(null===Bb||void 0===Bb?0:Bb.LUd)&&this.mue(qc,Bb);Bb=this.tableManager.rn(W.range);(null===Bb||void 0===Bb?0:Bb.Pba)&&this.mue(qc,Bb)}Bb=W.Nba?this.n3e(W):W.text;vd(qc,Bb);Bb=this.$.activeItemName;this.OD.activeItemName!==Bb&&(vd(qc,Bb),this.OD.activeItemName=Bb);Bb=1===ta.length?Qe.K(ta).isSingle?"":Ee.a.instance.fa(835):String.format(Ee.a.instance.Bb(30),ta.length);vd(qc,Bb);Bb=Cl(ta);for(var sd=Bb.next();!sd.done;sd=Bb.next())sd=sd.value,vd(qc,Ud.xjd(sd)),1===ta.length&&Hd.iti(sd)&&(sd=Ke.g(this.$).Da.Es(sd.bottomRight),
void 0!==sd&&null!==sd&&sd.text&&(sd=sd.Nba?this.m3e(sd,sd.text):sd.text,vd(qc,sd)));Bb=W.cell;Bb=this.OZh(Bb.goj,Bb.q3g);vd(qc,Bb);this.XNg(qc,W);ob&&(W.h8a?vd(qc,Ee.a.instance.fa(823)):W.QNa&&vd(qc,Ee.a.instance.fa(824)));if(W.hasAutoFilter||W.C5)this.nOg(qc,W.hasAutoFilter?W.cell.$1b:W.cell.O2i),ob&&vd(qc,Ee.a.instance.fa(826));fh.c(this.$,W.range)&&vd(qc,Ee.a.instance.fa(830));this.UNg(qc,W);ob=(ob=Kb.Aa(14))?ob.EOh():"";vd(qc,ob);W.$H&&(ob=Ke.g(this.$).Da.Es(W.range),ob=!!ob&&ob.saf,Hd.nBj(W)?
Hd.VNg(qc,W):Td.EwaSettings.isChangeGateEnabled("OfficeVSO:3286994_NarratorForFormulaErrors")&&ob?vd(qc,Ee.a.instance.fa(828)):vd(qc,Ee.a.instance.fa(827)));W.Mba&&(vd(qc,Ee.a.instance.fa(829)),W.xyb&&vd(qc,String.format(Ee.a.instance.Bb(16),W.Ifh)),vd(qc,W.iconName));W.hasRichValueIcon&&(Bb=this.$.da.Aa(271),ob="",Bb&&W.cell.Lof&&(Bb=Bb.pR(W.cell.Lof))&&Bb.DomainId.Id!==Hd.M1j&&(ob=Bb.Name),W.cell.dki?(vd(qc,String.format(Ee.a.instance.Bb(177),ob)),vd(qc,Ee.a.instance.fa(1762))):(vd(qc,String.format(Ee.a.instance.Bb(175),
ob)),vd(qc,Ee.a.instance.fa(1761))));this.G$h(W)&&vd(qc,Hd.tVh(W));(Kb=Kb.Aa(231))&&vd(qc,Kb.C3e(ta,!0));1===ta.length&&ta[0].isSingle&&Hd.mBj(W,ta[0],this.$)&&(ta=this.$.da.Aa(271))&&vd(qc,ta.POh());W.TOb&&W.UOb&&vd(qc,W.UOb);(ta=W.cell.XZg)&&vd(qc,ta);Td.EwaSettings.isChangeGateEnabled("OfficeVSO:5463515_PhoneticSlice1")&&W.Ola&&W.qHb&&(W=W.OGd)&&(vd(qc,Ee.a.instance.fa(1925)),vd(qc,W));return qc.toString()};Hd.prototype.mze=function(W){this.Hta=this.OD;this.OD=Object.assign(new Ne,{activeItemName:this.Hta.activeItemName,
GBc:W?this.Hta.GBc:!1,tableName:W?this.Hta.tableName:"",w1a:W?this.Hta.w1a:-1})};Hd.prototype.QXf=function(){this.Hta&&(this.OD=this.Hta,this.Hta=null)};Hd.prototype.OZh=function(W,ta){return 2===W||2===ta?Ee.a.instance.fa(856):1===W||1===ta?Ee.a.instance.fa(857):""};Hd.prototype.n3e=function(W){return this.m3e(W.cell,W.text)};Hd.prototype.mOg=function(W,ta,ob){if(ob&&1===ob.length&&ob[0].isSingle){ob="";var Kb=this.tableManager.ALa(ta.range);if(Kb)ob=Kb.pivotTableName,this.cZc(W,ob),this.oue(W,!0,
ob,Kb.ric?Ee.a.instance.fa(818):""),vd(W,this.tableManager.hri(Kb,ta.range)?Ee.a.instance.fa(820):""),vd(W,this.tableManager.qli(Kb,ta.range)?Ee.a.instance.fa(819):"");else if(Kb=this.tableManager.rn(ta.range)){var qc=Ke.g(this.$).Tb.Wj(ta.range);ob=qc?qc.name:"";this.cZc(W,ob);var Bb="";qc&&Td.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableMissingContextMenuOptions",!1)&&(Bb=(qc.oUa?qc.oUa+" . ":"")+(qc.pUa?qc.pUa:""));this.oue(W,!1,ob,Bb);vd(W,this.tableManager.aif(Kb,ta.range)?
Ee.a.instance.fa(819):"")}else this.cZc(W,ob),this.OD.tableName="",this.OD.w1a=-1}};Hd.prototype.cZc=function(W,ta){ta!==this.OD.tableName&&this.OD.tableName&&(W.append(Ee.a.instance.fa(this.OD.GBc?817:816)),vd(W," "+this.OD.tableName))};Hd.prototype.oue=function(W,ta,ob,Kb){ob!==this.OD.tableName&&(W.append(Ee.a.instance.fa(ta?815:814)),vd(W," "+ob),vd(W,Kb),this.OD.tableName=ob,this.OD.GBc=ta,this.OD.w1a=-1)};Hd.prototype.mue=function(W,ta){var ob=Ke.g(this.$).ga.va.activeCell;if(ob.top!==ta.top&&
ob.left!==this.OD.w1a){W.append(Ee.a.instance.fa(819));ta=new nf.Range(ta.top,ob.left,ta.top,ob.left,!0,!0);vd(W,Ud.xjd(ta));if(ta=Ke.g(this.$).rc(ta))ta=ta.Nba?this.n3e(ta):ta.text,vd(W,ta);this.OD.w1a=ob.left}};Hd.prototype.m3e=function(W,ta){var ob=W.J6a;return W.Ayb?String.format(Ee.a.instance.Bb(14),ta,ob):String.format(Ee.a.instance.Bb(13),ta,Ud.Cjj(ob))};Hd.prototype.Ik=function(){jc.ULS.shipAssertTag(537153930,0,!!this.$,"Can't register to ewaControl's events");if(this.$){var W=Ke.g(this.$);
jc.ULS.shipAssertTag(537153929,0,!!W,"Can't register to grid's events");W&&(W.zc.wl(this.Av),W.Da.aq(this.Mda),W.RE(this.Mda),this.Vbb&&W.zc.Wo(this.Rg.bind(this)),W=W.ga,jc.ULS.shipAssertTag(537153928,0,!!W,"Can't register to selectionManager's events"),W&&(W.nH(this.ld),W.XJ(this.Mda),W.Pa.v3(this.Mda),this.Vbb&&(this.dKd=this.dKd.bind(this))))}};Hd.prototype.wm=function(){if(this.$){var W=Ke.g(this.$);W&&(W.zc.$k(this.Av),W.Da.ar(this.Mda),W.wG(this.Mda),this.Vbb&&W.zc.Zn(this.Rg),W=W.ga)&&(W.xG(this.Mda),
W.VO(this.Mda),W.Pa.Wna(this.Mda))}};Hd.prototype.readText=function(W,ta){this.I7a&&this.gridReadoutNotifier&&this.gridReadoutNotifier.isActive?this.gridReadoutNotifier.readText(W):(Td.EwaSettings.isChangeGateEnabled("OfficeVSO:5033038_Embed_Mode_Grid_Narrator_Fix")&&this.ariaLiveNotifier.setEnabled(!0),this.ariaLiveNotifier.readText(W),this.Vbb&&!ta||this.ariaLiveNotifier.CVj(ta))};Hd.prototype.Rg=function(){this.cqb&&this.cqb.cancel()};Hd.prototype.dKd=function(){this.readText(this.S1h())};Hd.prototype.S1h=
function(){var W=this,ta="";Ke.g(this.$).ga.rangePicker.IL.forEach(function(ob){ta+=W.H2h(ob)});return ta+=" selected"};Hd.prototype.H2h=function(W){return" "+(W.sheetId!==Ga.d(this.$.oa)?this.$.xa.Zjd(W.sheetId).name:"")+" "+W.range.topLeft+" "+(W.range.isSingle?"":W.range.bottomRight)};Hd.prototype.FNh=function(){var W=null;var ta=Ke.g(this.$).ga;if(1!==ta.Ye&&!ta.Pa.nc)return jc.ULS.sendTraceTag(537153927,0,15,"selectionManager.CommandSelectionMode={0} and selectionManager.SelectedFloatingObjectControl is null",
ta.Ye),{returnValue:"",activeCell:W};switch(ta.Ye){case 2:return{returnValue:this.yQh(ta),activeCell:W};case 64:var ob=ta.Pa.nc.floatingObject,Kb="";if(ta=ta.Pa.nc.Xs||ta.Pa.nc.Sd)Kb=(Kb=ta.firstChild)?ef.DOMElementExtensions.getTextContent(Kb):"";return{returnValue:String.format(Ee.a.instance.Bb(52),Hd.Qbc(ob.altText,ob.altTextDescription,ob.name),Kb,ob.altTextDescription),activeCell:W};case 4:return{returnValue:Hd.hNg(ta.Pa.nc.floatingObject),activeCell:W};case 512:return{returnValue:pg.a.$1e(ta.Pa.nc.floatingObject.q$c),
activeCell:W};case 8:return ob=(ob=ta.Pa.nc.floatingObject)?ob.name:"",{returnValue:String.format(Ee.a.instance.Bb(50),ob),activeCell:W};case 1:return W=this.activeCell,{returnValue:this.A0e(W,ta.va.selectedRanges),activeCell:W}}return{returnValue:"",activeCell:W}};Hd.prototype.yQh=function(W){var ta=new Sys.StringBuilder;ta.append(Hd.D_g(W));var ob=this.$.da.Aa(231);ob&&vd(ta,ob.C3e(W.Pa.nc.floatingObject,!1));return ta.toString()};Hd.prototype.G$h=function(W){W=W.igf();var ta=!1;this.OD.Rkf!==W&&
(this.OD.Rkf=W,ta=!0);return ta};Hd.prototype.XNg=function(W,ta){if(ta.Iyb)if(ta=this.sparklineManager.P2h(ta)){var ob=Ee.a.instance,Kb=ob.fa;a:switch(ta.type){case 0:var qc=811;break a;case 1:qc=812;break a;default:qc=813}ob=Kb.call(ob,qc);vd(W,String.format(Ee.a.instance.Bb(25),ob));ta=String.format(Ee.a.instance.Bb(24),Ud.xjd(ta.nJj));vd(W,ta)}else jc.ULS.sendTraceTag(537153925,0,15,"No sparkline range was found on a cell with sparkline."),vd(W,String.format(Ee.a.instance.Bb(25),""))};Hd.prototype.nOg=
function(W,ta){switch(ta){case 1:case 11:vd(W,Ee.a.instance.fa(831));break;case 6:vd(W,Ee.a.instance.fa(831));vd(W,Ee.a.instance.fa(833));break;case 7:vd(W,Ee.a.instance.fa(831));vd(W,Ee.a.instance.fa(834));break;case 2:vd(W,Ee.a.instance.fa(832));vd(W,Ee.a.instance.fa(833));break;case 3:vd(W,Ee.a.instance.fa(832));vd(W,Ee.a.instance.fa(834));break;default:vd(W,Ee.a.instance.fa(832))}};Hd.prototype.UNg=function(W,ta){var ob,Kb=this.$.da.Aa(65);ta=Kb?Kb.fLa(ta.range):null;var qc="",Bb=Object(Gc.a)(628,
ta);if(ta)qc=!ta.T7a&&Bb&&Bb.Ksi?String.format(Ee.a.instance.Bb(29),Bb.HNj):String.format(Ee.a.instance.Bb(23),ta.author);else if(null===(ob=null===Kb||void 0===Kb?void 0:Kb.Wn)||void 0===ob?0:ob.NF)qc=String.format(Ee.a.instance.Bb(28),Kb.Wn.rO.author);vd(W,qc)};Hd.hNg=function(W){return String.format(Ee.a.instance.Bb(51),Hd.Qbc(W.altText,W.altTextDescription,W.name),W.altTextDescription)};Hd.tVh=function(W){return Ee.a.instance.fa(W.igf()?821:822)};Hd.Qbc=function(W,ta,ob){return W||ta?W:ob};Hd.D_g=
function(W){var ta=W.Pa.nc;W=ta.floatingObject;var ob=W.Zc,Kb=ob.ChartTitle,qc=W.altText,Bb=W.altTextDescription,sd=!!(ob.Attributes&4);return(ta=ta.getSelectionDescription())?ta:ob.DataRangeForDisplay?String.format(Ee.a.instance.Bb(sd?48:46),Hd.Qbc(qc,Bb,W.name),Bb,Kb,Ee.a.instance.fa(Ge(ob.ChartCategory)),ob.DataRangeForDisplay):String.format(Ee.a.instance.Bb(sd?49:47),Hd.Qbc(qc,Bb,W.name),Bb,Kb,Ee.a.instance.fa(Ge(ob.ChartCategory)))};Hd.nBj=function(W){return Td.EwaSettings.ma(103)&&(W.C7a||W.oic)};
Hd.VNg=function(W,ta){if(!ta.WTa)jc.ULS.shipAssertTag(537153924,0,!1,"SelectionReadoutHandler.AppendAriaDynamicArrayFormulaDescription: This method should only be called with a valid dynamic array range.");else if(ta.C7a)ta=ta.WTa.topLeft.toString(),vd(W,String.format(Ee.a.instance.Bb(26),ta));else if(ta.oic){var ob=ta.WTa.rM();ta=(ob.LastColumn-ob.FirstColumn+1).toString();ob=(ob.LastRow-ob.FirstRow+1).toString();vd(W,String.format(Ee.a.instance.Bb(27),ta,ob))}};Hd.mBj=function(W,ta,ob){return W.$H||
!Td.EwaSettings.ma(139)?!1:(W=ob.da.Aa(271))?W.Nhc(ta):!1};Hd.iti=function(W){return W.top===W.bottom&&W.left+1===W.right||W.top+1===W.bottom&&W.left===W.right};uk.Object.defineProperties(Hd.prototype,{activeCell:{configurable:!0,enumerable:!0,get:function(){return Ke.g(this.$).rc(null)}}});Hd.M1j=268435712;Hd.hWc=500;Object(zc.a)(Hd,"SelectionReadoutHandler",null,[937,3]);var Dc=b(53),Bd=wf.a;Am(ad,Bd);ad.prototype.create=function(){var W=this,ta=this.$.da,ob=ug.GetServiceTaskFactory.Ua(ta,211,212,
this.ub),Kb=ug.GetServiceTaskFactory.Ua(ta,66,134,this.ub),qc=ug.GetServiceTaskFactory.Ua(ta,240,239,this.ub),Bb=Dc.Task.Sa(null);Td.EwaSettings.Gb()&&(Bb=ug.GetServiceTaskFactory.Ua(ta,244,315,this.ub));Le.TaskExtensions.Ba(Le.TaskExtensions.we([ob,Kb,qc,Bb],this.la),function(){var sd=ta.Aa(226)||new Hd(ob.result,W.$,Kb.result,qc.result,Bb.result);W.Eb(sd)},this.$.la,3)};ad.ka=function(W){W.da.Ha(227,new ad(W))};Object(zc.a)(ad,"SelectionReadoutHandlerFactory",wf.a,[]);sb.prototype.vQf=function(){var W=
this.GOh();this.ariaLiveNotifier.$bb(W,fe.a.Tpb)};sb.prototype.GOh=function(){var W=new Sys.StringBuilder;this.$.workbookContext&&vd(W,this.$.workbookContext.WorkbookFileName);vd(W,Ee.a.instance.fa(837));vd(W,this.IOh());vd(W,this.HOh());vd(W,Ee.a.instance.fa(838));return W.toString()};sb.prototype.IOh=function(){return this.$.isEditMode?Ee.a.instance.fa(842):Ee.a.instance.fa(843)};sb.prototype.HOh=function(){var W=this.U0j(),ta=this.$.xa.oa;W=1!==W?String.format(Ee.a.instance.Bb(31),W):Ee.a.instance.fa(836);
W=new Sys.StringBuilder(W);ta&&ta.sheetName&&(W.append(Lb.Uxd),W.append(String.format(Ee.a.instance.Bb(32),ta.sheetName)));return W.toString()};sb.prototype.U0j=function(){for(var W=0,ta=Cl(this.$.xa.items),ob=ta.next();!ob.done;ob=ta.next())ob.value.visible&&W++;return W};Object(zc.a)(sb,"WorkbookReadout",null,[]);Ac.prototype.dispose=function(){this.jbc&&this.jbc.ahj(this.oDf);this.jbc=this.ariaLiveNotifier=this.$=null};Object(zc.a)(Ac,"EmbeddedWorkbookReadoutHandler",null,[3]);Ob.prototype.dispose=
function(){this.wm();this.ariaLiveNotifier=this.XZ=null;this.Pd=!0};Ob.prototype.Ik=function(){if(this.XZ){this.XZ.yr(this.gX);this.XZ.Da.aq(this.gX);this.XZ.RE(this.gX);var W=Object(Gc.a)(446,this.XZ);W&&(W.zc.wl(this.gX),W.ga.nH(this.gX),W.ga.XJ(this.gX),W.ga.Pa.v3(this.gX))}else jc.ULS.sendTraceTag(537153923,0,15,"WorkbookReadoutHandler.RegisterEvents: Can't register to view events")};Ob.prototype.wm=function(){if(this.XZ){this.XZ.Da.ar(this.gX);this.XZ.wG(this.gX);var W=Object(Gc.a)(446,this.XZ);
W&&(W.zc.$k(this.gX),W.ga.xG(this.gX),W.ga.VO(this.gX),W.ga.Pa.Wna(this.gX))}};Ob.prototype.Mte=function(){this.T2d.vQf();this.ariaLiveNotifier.setEnabled(!0);this.ariaLiveNotifier.lvj();this.dispose()};Object(zc.a)(Ob,"WorkbookReadoutHandler",null,[3]);var Fd=wf.a;Am(hd,Fd);hd.prototype.create=function(){var W=this,ta=ug.GetServiceTaskFactory.Ua(this.$.da,211,212,this.ub);if(this.$.bO){var ob=ug.GetServiceTaskFactory.Ua(this.$.da,12,477,this.ub);Le.TaskExtensions.Ba(Le.TaskExtensions.we([ta,ob],
this.$.la),function(){var Kb=new Ac(ta.result,W.$,ob.result);W.Eb(Kb)},this.$.la,3)}else Le.TaskExtensions.Ba(ta,function(Kb){Kb=new Ob(Kb.result,W.$);W.Eb(Kb)},this.$.la,3)};hd.ka=function(W){W.da.Ha(229,new hd(W))};Object(zc.a)(hd,"WorkbookReadoutHandlerFactory",wf.a,[]);var Be=b(36),Me=b(247),sf=b(375),Qa=b(189),cb=b(703),bc=Be.a;Am(sc,bc);sc.prototype.dispose=function(){this.view&&(this.view.Da.Jp(this.Xe),this.view.Da.MI(this.Rm),this.view.Da.zcb(this.Xe),this.view.Da.gJb(this.Xe),this.view.$.xa.vG(this.Io),
this.view.$.Ab.vG(this.Io));this.kU=this.fne=null;bc.prototype.dispose.call(this)};sc.prototype.C_b=function(W){W=this.FJd(W);var ta=Td.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ApplyHeaderSnappingOnVerticalFreezePane",!1)?this.view.vB:this.view.nh;if(W&&0<W.length&&ta)for(var ob=0,Kb=W.length;ob<Kb;ob++)ta.contains(this.kU[ob])||Array.add(this.kU,Qa.a.DR(W[ob]))};sc.prototype.SIb=function(){var W=Td.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ApplyHeaderSnappingOnVerticalFreezePane",
!1)?this.view.vB:this.view.nh;if(this.kU.length&&W)for(var ta=this.kU.length-1;0<=ta;ta--)W.contains(this.kU[ta])||Array.removeAt(this.kU,ta)};sc.prototype.N5e=function(W){return this.g5e(W)};sc.prototype.g5e=function(W){W=Qe.I(W,this.kU,!0);return 0<W.length?W[0]:null};uk.Object.defineProperties(sc.prototype,{rangeList:{configurable:!0,enumerable:!0,get:function(){return this.kU}},view:{configurable:!0,enumerable:!0,get:function(){return this.fne}}});sc.GJd="lrc";Object(zc.a)(sc,"LoadedRangeCollection",
Be.a,[]);Am(Pb,sc);Pb.prototype.P2h=function(W){for(var ta=Cl(this.rangeList),ob=ta.next();!ob.done;ob=ta.next())if(ob=ob.value,W.range.contains(ob))return ob;return null};Pb.prototype.FJd=function(W){return W.GridBlockModel&&(W=gridRenderer.CanvasRendererFactoryGlobal.getModelAccessor(W.GridBlockModel))?W.getSparklineRanges():null};Object(zc.a)(Pb,"SparklineManager",sc,[936]);var yc=wf.a;Am(fb,yc);fb.prototype.create=function(){this.Eb(this.sparklineManager||(this.sparklineManager=new Pb(Ke.g(this.$),
this.$.da)))};fb.ka=function(W){W.da.Ha(239,new fb(W))};Object(zc.a)(fb,"SparklineManagerFactory",wf.a,[]);var bd=b(52),Kd=b(299);va.zSe="ewa-svg-icon";Object(zc.a)(va,"CssClassNames",null,[]);var de=b(324),Re=b(290);Kc.prototype.dispose=function(){this.MXd=null;this.$.ea.Kp(this.fh)};Kc.prototype.Owa=function(W,ta,ob,Kb,qc){Kb=void 0===Kb?null:Kb;qc=void 0===qc?null:qc;var Bb;(Bb=this.MXd[W])||(this.MXd[W]=Bb=this.J1i(this.gbg[W]));if(!Bb)return jc.ULS.shipAssertTag(537151262,0,!1,"SvgIconProvider.GetSvgElement: id {0} was not found in loaded SVG sprites.",
W),null;var sd=Bb.cloneNode(!0);if(!sd.style){var Vd=de.b(Bb),bf=de.b(sd),Xf={};Xf.iconId=W;Xf.isOriginalNodeStyleNull=void 0===Bb.style||null===Bb.style;Xf.isOriginalNodeCurrentStyleNull=void 0===Bb.currentStyle||null===Bb.currentStyle;Xf.isClonedNodeCurrentStyleNull=void 0===sd.currentStyle||null===sd.currentStyle;Xf.originalNode=Vd.substring(0,Vd.indexOf(">")+1);Xf.clonedNode=bf.substring(0,bf.indexOf(">")+1);jc.ULS.sendTraceTag(537151261,0,10,"SvgIconProvider.GetSvgElement: cloned element's style is undefined. data: {0}",
JSON.stringify(Xf))}W=String.format("height: {0}px; width: {0}px;",ta,ob);sd.setAttribute("style",W);qc&&(W=document.createElement("title"),W.innerHTML=qc,sd.insertBefore(W,sd.childNodes[0]));if(Kb)for(Kb=Cl(Kb),qc=Kb.next();!qc.done;qc=Kb.next())Sys.UI.DomElement.addCssClass(sd,qc.value);return sd};Kc.prototype.Zba=function(W,ta,ob,Kb,qc,Bb,sd,Vd){qc=void 0===qc?0:qc;Bb=void 0===Bb?0:Bb;sd=void 0===sd?null:sd;Vd=void 0===Vd?null:Vd;qc&&Bb||(Bb=ef.DOMElementExtensions.getBoundingClientRect(Kb),qc=
Bb.height,Bb=Bb.width);if(sd=this.Owa(W,ta,ob,sd,Vd))Kb.appendChild(sd),(Kb=ef.DOMElementExtensions.r_(sd,"style",null))?sd.setAttribute("style",Kb+String.format(" margin: {0}px {1}px;",(qc-ta)/2,(Bb-ob)/2)):jc.ULS.sendTraceTag(537151260,0,10,'SvgIconProvider.InsertAndCenterSvgElement: svgElement\'s GetAttribte("styl") returned null. Icon ID: {0}',W);return sd};Kc.prototype.Xof=function(){var W=this;Le.TaskExtensions.Ba(ug.GetServiceTaskFactory.Ua(this.$.da,283,284,0),function(ta){ta=Re.c(ta.result.ho.loadScript("excel-uiSlice20-sprite"));
Le.TaskExtensions.Ba(ta,function(){var ob=W.p3e("excelUiSlice20Sprite");ob?W.qqe(ob):jc.ULS.sendTraceTag(537151259,0,15,"window[{0}].icons returned null.","excelUiSlice20Sprite")},W.$.la,3)},this.$.da.la,3)};Kc.prototype.qqe=function(W){W=Cl(W);for(var ta=W.next();!ta.done;ta=W.next())ta=ta.value,ta.type===dg.a.ebg&&(this.gbg[ta.id]=ta)};Kc.prototype.J1i=function(W){if(!W)return null;var ta=W.viewBox;W=W.children;var ob=document.createElementNS(Kd.a.OXd,dg.a.ebg);Sys.UI.DomElement.addCssClass(ob,
va.zSe);ob.setAttribute("focusable","false");ob.setAttribute("viewBox",ta);this.WGg(ob,W);return ob};Kc.prototype.WGg=function(W,ta){ta=Cl(ta);for(var ob=ta.next();!ob.done;ob=ta.next()){ob=ob.value;var Kb=document.createElementNS(Kd.a.OXd,ob.type),qc;for(qc in ob){var Bb=qc,sd=ob[qc];"className"===Bb?Kb.setAttribute("class",sd):Kb.setAttribute(Bb,sd)}W.appendChild(Kb)}};Kc.prototype.p3e=function(W){return(W=window[W])?W.icons:null};Object(zc.a)(Kc,"SvgIconProvider",null,[935,3]);var ce=wf.a;Am(Zc,
ce);Zc.prototype.create=function(){var W=this;Le.TaskExtensions.Ba(bd.a.i0([106],4,this.ub,void 0,void 0,void 0,387),function(){var ta=Td.EwaSettings.isChangeGateEnabled("OfficeVSO:4431502_UseCommonIconSpriteInEwa")?"excelInitialAppSprite":"excelAppSprite";window[ta]?W.Eb(W.$.da.Aa(388)||new Kc(W.$)):jc.ULS.sendTraceTag(537151258,0,50,"window.[{0}] returned null.",ta)},this.la,3)};Zc.ka=function(W){W.da.Ha(387,new Zc(W))};Object(zc.a)(Zc,"SvgIconProviderFactory",wf.a,[]);var Jb=b(437),Mc=b(570),ld=
b(244),fg=b(165),Se=b(127),tf=b(8),af=b(353),Pf=b(177),Sd=b(12),Mf=b(160),mf=b(87),ud=b(243),Vf=b(106),Ih=b(42),Cf=b(32),ye=mf.a;Am(Uc,ye);Uc.prototype.dispose=function(){this.Xcb();this.tableManager.Pfj(this.Xyf);this.Alf||rf.a.zp||rf.a.dya||Pf.a.instance.za(Sd.a.pointerDown,this.Lba,this.onPointerDown);if(this.GB){ud.b(this.$,!1);try{this.Uv()}catch(W){jc.ULS.sendTraceTag(537151236,0,10,"TableResizeBehavior.Dispose: Unregistering of Handlers failed with Exception {0}",W)}}this.parentElement&&this.parentElement.contains(this.Lba)&&
this.parentElement.removeChild(this.Lba);this.Lba=this.parentElement=null;ye.prototype.dispose.call(this)};Uc.prototype.Y7e=function(W){var ta=W.bottom-this.eo.topLeft.bottom-1;return 0<=W.right-this.eo.topLeft.right+1&&0<=ta&&W.bottom>=this.eo.top&&W.right>=this.eo.left?new nf.Range(this.eo.top,this.eo.left,W.bottom,W.right,!1,!1):this.Ft};Uc.prototype.ond=function(W){this.syc([this.Ft],6,void 0===W?!0:W);this.Fb.co(this.ybg)};Uc.prototype.XIb=function(W){W=void 0===W?!0:W;this.Fb.si(this.ybg);this.syc([null],
6,W)};Uc.prototype.HLd=function(W){W=void 0===W?!0:W;this.Fb.si(this.tbg);this.syc([null],26,W)};Uc.prototype.qbi=function(){var W=!1;W=void 0===W?!0:W;var ta=this.tNj();0<ta.length&&(this.syc(ta,26,W),this.Fb.co(this.tbg))};Uc.prototype.tNj=function(){var W=[];this.eo.contains(this.Ft)&&(this.eo.right!==this.Ft.right&&W.push(new nf.Range(this.eo.top,this.Ft.right+1,this.Ft.bottom,this.eo.right,!1,!1)),this.eo.bottom!==this.Ft.bottom&&W.push(new nf.Range(this.Ft.bottom+1,this.eo.left,this.eo.bottom,
this.eo.right,!1,!1)));return W};Uc.prototype.resizeTable=function(){if(!this.Ft.equals(this.eo)){var W=new nf.Range(this.eo.top,this.eo.left,this.Ft.bottom,this.Ft.right,!1,!1);this.XRj(W);this.Otd=!0}};Uc.prototype.onKeyDown=function(W){Cf.a(this.$).se(W);return!0};Uc.prototype.T$a=function(){this.Alf&&(rf.a.zp||rf.a.dya||(Pf.a.instance.qa(Sd.a.pointerDown,this.Lba,this.onPointerDown),this.Lba.classList.remove("ewr-table-resize-default-cursor"),this.fOc=this.Lba.disabled=!1),this.fOc=!1)};Uc.prototype.VVg=
function(){var W=document.createElement("div");W.className="ewr-table-resize-handle";var ta=document.createElement("div");ta.className="ewr-table-resize-fillhandle-higher";var ob=document.createElement("div");ob.className="ewr-table-resize-fillhandle-broader";W.appendChild(ta);W.appendChild(ob);this.Lba=W;this.parentElement.appendChild(this.Lba)};Uc.prototype.z2b=function(W){var ta=this,ob=this.Ft.contains(W),Kb=W.top,qc=W.bottom,Bb=W.left;W=W.right;var sd=null;if(ob){if(this.gridView.h6(this.eo.topLeft)&&
!this.eo.RTa)return;Kb=Math.max(1,qc-5,this.eo.top);Bb=Math.max(1,W-5,this.eo.left);qc=Kb;W=Bb;sd=new nf.Range(Kb,Bb,Kb,Bb,!1,!1)}else qc+=5,W+=5,Kb=qc,Bb=W,sd=new nf.Range(qc,W,qc,W,!1,!1);this.gridView.h6(sd)||(this.ms?this.ms.Ap||(this.ms=Rg.a.instance.create(function(){ta.gridView.mu(sd,60,Vf.a.vbg)},40,ah.a.wbg)):this.ms=Rg.a.instance.create(function(){ta.gridView.mu(sd,60,Vf.a.vbg)},40,ah.a.wbg))};Uc.prototype.vpb=function(W){var ta=W;if(this.gridView.rb.z5){if(!this.gridView.rc(W.topLeft)){var ob=
this.gridView.Pk("TableResizeBehavior.AdjustHiddenRowColumns",this.gridView.vB,this.Ft.top!==W.top?1:2);try{ob.jl=this.Ft.top<W.top||this.Ft.left<W.left,ob.Js(W.topLeft),ta=ob.$$cu().range}finally{ob&&ob.dispose()}}ta.right=ta.left+W.width-1;ta.bottom=ta.top+W.height-1}return ta};Uc.prototype.syc=function(W,ta,ob){ob=void 0===ob?!0:ob;var Kb=[];W=Cl(W);for(var qc=W.next();!qc.done;qc=W.next())Kb.push(new af.a(qc.value,Ga.d(this.$.oa)));this.Fb.ox(Kb,[ta],!0,void 0,ob)};Uc.prototype.$cj=function(){for(var W=
Cl(this.gridView.zn),ta=W.next();!ta.done;ta=W.next())Pf.a.instance.qa(Sd.a.ph,ta.value.domElement,this.Uh);Pf.a.instance.qa(Sd.a.$d,document.documentElement,this.Sf);this.ULe()};Uc.prototype.Ndj=function(){for(var W=Cl(this.gridView.zn),ta=W.next();!ta.done;ta=W.next())Mf.a.instance.qa(Sd.a.Dg,ta.value.domElement,this.Uh);Mf.a.instance.qa(Sd.a.Ce,document.documentElement,this.AGb);this.ULe()};Uc.prototype.Uv=function(){this.iBb&&this.KUj();this.vkc&&this.VUj()};Uc.prototype.KUj=function(){for(var W=
Cl(this.gridView.zn),ta=W.next();!ta.done;ta=W.next())Pf.a.instance.za(Sd.a.ph,ta.value.domElement,this.Uh);Pf.a.instance.za(Sd.a.$d,document.documentElement,this.Sf);this.xRf()};Uc.prototype.VUj=function(){for(var W=Cl(this.gridView.zn),ta=W.next();!ta.done;ta=W.next())Mf.a.instance.za(Sd.a.Dg,ta.value.domElement,this.Uh);Mf.a.instance.za(Sd.a.Ce,document.documentElement,this.AGb);this.xRf()};Uc.prototype.ULe=function(){Pf.a.instance.qa(Sd.a.Ky,document.documentElement,this.kda);this.gridView.Ac.C9b(!0)};
Uc.prototype.xRf=function(){Pf.a.instance.za(Sd.a.Ky,document.documentElement,this.kda);this.gridView.Ac.C9b(!1)};Uc.prototype.XRj=function(W){var ta={};W=(ta.ResizeTableRange=W,ta.OriginalTableRange=this.eo,ta);this.$.ae(-1400250766,Hb.a.$b,30,W)};Uc.prototype.rWj=function(W){if(!this.eo.contains(W)){W=this.sNj();W=Cl(W);for(var ta=W.next();!ta.done;ta=W.next())if(this.tableManager.nud(ta.value)){this.gridView.Lg.Np(fe.a.PIi);return}}this.gridView.rtl?this.gridView.Lg.Np(fe.a.UHi):this.gridView.Lg.Np(fe.a.uKi)};
Uc.prototype.Xcb=function(){if(this.GB){ud.b(this.$,!1);try{this.Uv()}catch(W){jc.ULS.sendTraceTag(537151232,0,10,"TableResizeBehavior.Dispose: Unregistering of Handlers failed with Exception {0}",W)}}this.ms&&(this.ms.cancel(),this.ms.dispose());this.vkc=this.iBb=!1;this.XIb();this.HLd();ud.b(this.$,!1);this.gridView.Lg.Np(fe.a.v5)};Uc.prototype.sNj=function(){var W=[];this.eo.right!==this.Ft.right&&W.push(new nf.Range(this.eo.top,this.eo.right+1,this.Ft.bottom,this.Ft.right,!1,!1));this.eo.bottom!==
this.Ft.bottom&&W.push(new nf.Range(this.eo.bottom+1,this.eo.left,this.Ft.bottom,this.eo.right,!1,!1));return W};Uc.createInstance=function(W,ta,ob,Kb){if(!ta)return null;var qc=W.Fb;qc.ox(ob,[27],!0);qc.co(Uc.nNj);ob=qc.Iw(27,W.rb.wj(ta.bottomRight),Uc.iTh(ta,ob)).Qf;return new Uc(ob,W,ta,Kb)};Uc.iTh=function(W,ta){for(var ob,Kb=0;Kb<ta.length;Kb++)if((null===(ob=ta[Kb])||void 0===ob?0:ob.range)&&ta[Kb].range.equals(W))return Kb;return 0};uk.Object.defineProperties(Uc.prototype,{GB:{configurable:!0,
enumerable:!0,get:function(){return this.iBb||this.vkc}},Alf:{configurable:!0,enumerable:!0,get:function(){return this.fOc}}});Uc.nNj=[27];Object(zc.a)(Uc,"TableResizeBehavior",mf.a,[]);var be=b(240);ac.pyh="ewa-ttrd-buttonarea";Object(zc.a)(ac,"CssClassNames",null,[]);var Pg=b(47),We=b(131),Zh=b(95),hh=b(132),rg=b(270),th=be.a;Am(mb,th);mb.prototype.dispose=function(){this.$&&this.hih();this.$=this.gridView=this.parentElement=this.ULa=null;th.prototype.dispose.call(this)};mb.prototype.aRh=function(W){var ta=
this.B4h(this.gridView.rc(null).range);return ta?String.format("=SUBTOTAL({0},{1})",W,ta):null};mb.prototype.B4h=function(W){var ta=Ke.g(this.$).Tb.Wj(W);if(!ta)return null;ta=fg.a(ta,!1);ta.right=ta.left=W.left;return ta.toString()};mb.prototype.Hfi=function(){mb.aN={};mb.aN["100"]=Ee.a.instance.fa(1058);mb.aN["101"]=Ee.a.instance.fa(1061);mb.aN["102"]=Ee.a.instance.fa(1060);mb.aN["103"]=Ee.a.instance.fa(1065);mb.aN["104"]=Ee.a.instance.fa(1062);mb.aN["105"]=Ee.a.instance.fa(1063);mb.aN["109"]=Ee.a.instance.fa(1059);
mb.aN["107"]=Ee.a.instance.fa(1066);mb.aN["110"]=Ee.a.instance.fa(1068);mb.aN["111"]=Ee.a.instance.fa(1119)};mb.prototype.h1i=function(){var W=this.gridView.rc(null);if(W&&(W=W.$H?W.formulaBarText:null))if("=SUBTOTAL("===W.substring(0,10)){if(W=W.substring(10,13),W in mb.aN)return W}else return"111";return"100"};mb.prototype.hQg=function(){this.gridView.Da.xr(this.Xe);this.gridView.ga.XJ(this.Th);this.gridView.yr(this.onContentReady);this.gridView.Ac.wl(this.bzf);this.gridView.Ac.Wo(this.gFb)};mb.prototype.hih=
function(){this.gridView&&(this.gridView.ga&&(this.gridView.ga.VO(this.Th),this.gridView.Da.Jp(this.Xe)),this.gridView.Nt(this.onContentReady),this.gridView.Ac&&(this.gridView.Ac.$k(this.bzf),this.gridView.Ac.Zn(this.gFb)),this.dgg())};mb.prototype.Ksb=function(W){this.CWj(W);this.VBb&&(this.SLj(),this.wob?(this.kKf||this.sQg(),this.kWc?this.U5=!1:(this.U5=!0,this.BVf())):(jc.ULS.sendTraceTag(537151199,0,15,"TableTotalRowOptions.CreateAndShowDropdownInUpdatedPosition : Offset bounds could not be determined"),
this.U5=!1))};mb.prototype.BVf=function(){var W=this;appChrome.renderTableTotalRowOptions(this.parentElement,mb.aN,mb.aN[this.h1i()].toString(),Math.round(Cf.a(this.$).Mi(17)),function(ta){jc.ULS.sendTraceTag(537151198,0,50,"TableTotalRowOptions.RenderReactTotalRowDropdown - Selected Option : {0}",ta);var ob={};ob=(ob.SelectedOption=mb.aN[ta],ob.FunctionKeyCode=ta,ob.Location="canvas",ob);hh.b(W.$).he(We.a.yNj,ob,null,!0);if("111"===ta)return W.iji(),!0;if("100"!==ta){W.$Kb=W.aRh(ta);if(!W.$Kb)return jc.ULS.sendTraceTag(537151197,
0,50,"TableTotalRowOptions.RenderReactTotalRowDropdown - Selected Option was null"),!0;W.SSa(W.$Kb)}else W.SSa("");ef.DOMElementExtensions.setFocus(W.gridView.zc.textBox.domElement);return!0})};mb.prototype.iji=function(){jc.ULS.sendTraceTag(537151196,0,50,"TableTotalRowOptions.InvokeMoreFunctionsDialog - More Functions dialog invoked");var W=new Zh.a(753860909,0,this.$.isEditMode?2:1,19,null);this.$.Ka.dc(W)};mb.prototype.Dwa=function(W){if(!W)return null;var ta=this.gridView.Ac.textBox.domElement;
var ob=0<ef.DOMElementExtensions.getHeight(ta)&&0<ef.DOMElementExtensions.getWidth(ta)&&0<=ta.offsetTop&&0<=ta.offsetLeft;if(ob)ta=ef.DOMElementExtensions.Dwa(ta,this.gridView.Fj);else{ta=this.gridView.getCellBounds(W.cell);var Kb=ef.DOMElementExtensions.getBoundingClientRect(this.gridView.Fj);ta=new Sys.UI.Bounds(ta.x-Kb.x,ta.y-Kb.y,ta.width,ta.height)}if(ta)if(ob)2<ta.height&&2<ta.height&&(ta.x+=1,ta.y+=1,ta.height-=2,ta.width-=2);else if(ob=Ke.g(this.$).BK(W.cell))ob=ob.width,Kb=Of.a.equals(If.a.X4a(W.cell,
this.gridView.rtl),"right",!0),this.gridView.rtl&&Kb&&(ta.x=ta.x+ta.width-ob),W.Wla&&this.gridView.rtl===Kb&&(ta.width=ob);else return null;return ta};mb.prototype.CWj=function(W){var ta=this.wob;if(ta){var ob=17>=ta.height?ta.y:ta.y+ta.height-17-2;ta=this.Doi?this.gridView.rtl?ta.x:ta.x+ta.width-(17<ta.height?17:ta.height):this.gridView.rtl?ta.x-(17<ta.height?17:ta.height):ta.x+ta.width;var Kb=Cf.a(this.$).Gka(new Sys.UI.Point(ta,ob));this.parentElement.style.top=tf.HelperMethods.Yb(Kb.y);this.parentElement.style.left=
tf.HelperMethods.Yb(Kb.x);Cf.a(this.$).axj(this.parentElement);W&&(this.U5=this.gridView.Fkc(new Pg.a(ta,ob)))}else this.U5=!1};mb.prototype.sQg=function(){this.ULa.insertBefore(this.parentElement,this.ULa.firstChild);this.kKf=!0};mb.prototype.SLj=function(){this.WR||(this.gridView.view.nt(this.Gt),this.WR=!0)};mb.prototype.dgg=function(){this.WR&&this.gridView.view&&(this.gridView.view.fr(this.Gt),this.WR=!1)};mb.prototype.SSa=function(W){var ta=this.gridView.zc,ob=this.gridView.rc(null);ob&&(W=
Object.assign(new rg.a,{Text:W}),this.gridView.setCell(W,ob.range,0,127,null),ta.endEdit(!0,"TableTotalRowOptions.SetCellContent",0))};uk.Object.defineProperties(mb.prototype,{U5:{configurable:!0,enumerable:!0,get:function(){return this.erd},set:function(W){this.erd!==W&&(this.erd=this.isVisible=W)}},VBb:{configurable:!0,enumerable:!0,get:function(){return!!(this.$.Dd&16)}},Doi:{configurable:!0,enumerable:!0,get:function(){var W=this.gridView.ga.va.activeCell;return W.right===W.maxColumns}},wob:{configurable:!0,
enumerable:!0,get:function(){var W=this.gridView.rc(null);return W&&this.gridView.V_(W.range)?this.Dwa(W):(W&&jc.ULS.sendTraceTag(537151200,0,50,"TableTotalRowOptions.ActiveCellOffsetBounds - Active Cell not in viewport area"),null)}}});mb.xNj="TableTotalRowDropDownIconButtonId";mb.aN=null;Object(zc.a)(mb,"TableTotalRowOptions",be.a,[3]);Am(qb,sc);qb.prototype.Qre=function(W){this.addHandler(sc.GJd,W)};qb.prototype.MUf=function(W){this.removeHandler(sc.GJd,W)};qb.prototype.YHg=function(W){this.addHandler("tce",
W)};qb.prototype.Pfj=function(W){this.removeHandler("tce",W)};qb.prototype.nud=function(W){return!!this.g5e(W)};qb.prototype.rn=function(W){return this.q0h(this.N5e(W))};qb.prototype.zwb=function(W){return this.N5e(W)};qb.prototype.Jdj=function(W){W?(this.krb?this.krb!==W&&($g.a.Fa(this.L1),this.L1=null,this.krb=W):this.krb=W,this.L1||(this.L1=Se.a.instance.Gd(this.krb)),this.L1.un("focusin")||this.L1.ka("focusin",this.onFocus)):jc.ULS.sendTraceTag(537151245,0,15,"TableManager.RegisterToTextboxFocusEvent empty textBoxDomElement recieved")};
qb.prototype.aif=function(W,ta){return W?W.Pba&&W.top===ta.top:(jc.ULS.shipAssertTag(537151244,0,!!W,"autofilterRange can't be null"),!1)};qb.prototype.ALa=function(W){W=this.irb?Qe.I(W,this.irb):this.view.getRangeInformation(W);return 0<W.length&&Object(Jb.a)(ld.PivotTableRange,W[0])?W[0]:null};qb.prototype.qli=function(W,ta){return W?!W.ric&&!!W.saa&&W.saa.Od(ta):(jc.ULS.shipAssertTag(537151243,0,!!W,"Pivot table can't be null"),!1)};qb.prototype.hri=function(W,ta){return W?!W.ric&&!!W.pSa&&W.pSa.Od(ta):
(jc.ULS.shipAssertTag(537151242,0,!!W,"Pivot table can't be null"),!1)};qb.prototype.C_b=function(W){sc.prototype.C_b.call(this,W);if((W=tf.HelperMethods.u5e(W))&&0<W.length){this.irb=Array(W.length);for(var ta=0;ta<W.length;ta++)this.irb[ta]=Qa.a.DR(W[ta])}};qb.prototype.SIb=function(){sc.prototype.SIb.call(this);this.irb=null};qb.prototype.Y7g=function(W,ta){return this.zGe(W,ta).returnValue};qb.prototype.zGe=function(W,ta){var ob=this;var Kb=!1;if(!W||!ta)return{returnValue:!1,yZ:Kb};W=W.clone();
W.right+=1;W.left=W.right;if(!W.isValidRange)return{returnValue:!1,yZ:Kb};if(W.top<ta.rb.gj){var qc=W.clone();qc.bottom>=ta.rb.gj&&(qc.bottom=ta.rb.gj-1);if(!function(){var sd=ob.yGe(qc,ta);Kb=sd.yZ;return sd}().returnValue)return{returnValue:!1,yZ:Kb}}if(W.bottom>=ta.rb.gj){var Bb=W.clone();Bb.top<=ta.rb.gj&&(Bb.top=ta.rb.gj);if(!function(){var sd=ob.yGe(Bb,ta);Kb=sd.yZ;return sd}().returnValue)return{returnValue:!1,yZ:Kb}}return{returnValue:!0,yZ:Kb}};qb.prototype.xbg=function(W){(W=this.rn(W.topLeft))&&
W.toString()in this.vGa&&(this.vGa[W.toString()].Otd=!1)};qb.prototype.K8i=function(){this.raiseEvent("tce")};qb.prototype.Yh=function(W,ta){if(!this.KBc)return!1;switch(ta){case -569786022:case 541421805:if(this.KBc.U5){var ob=document.getElementById(mb.xNj);ob&&Rg.a.instance.create(function(){ef.DOMElementExtensions.phc(ob,null)},0,ah.a.qNj,!0,!0)}return!0;default:return!1}};qb.prototype.dispose=function(){this.$3b(null,null);this.MUf(this.V1b);this.$.xa.Ag(this.KPf);this.$.En(this.$3b);this.NRb=
null;this.$.ea&&this.$.ea.N7(this.W6);this.gridView.ga.VO(this.Th);this.KBc=null;Td.EwaSettings.ma(414)&&this.L1&&($g.a.Fa(this.L1),this.L1=null);sc.prototype.dispose.call(this)};qb.prototype.W9h=function(W,ta,ob,Kb){var qc=this.gridView.Tb.Wj(new nf.Range(ta,ob,ta,ob,!1,!1));if(this.m7b=qc){var Bb=qc.usedRange,sd=W.ctrlKey||rf.a.isMac&&Qd.b(W),Vd=!W.shiftKey&&sd;W=W.shiftKey&&!sd;Td.EwaSettings.isChangeGateEnabled("OfficeVSO:5593089_TableSelectorsBugFixes")&&(Ke.g(this.$).ga.selectionType=3);switch(Kb){case 0:this.hTb=
0;Td.EwaSettings.isChangeGateEnabled("OfficeVSO:5501906_TableSelectionEnableShiftSelection")?(ta=this.m7c(W,Bb.top,ob,Bb.bottom,ob),this.zSd(ta,Vd,W)):this.ASd(Bb.top,ob,Bb.bottom,ob,fg.d(qc),fg.g(qc),Vd);break;case 1:this.hTb=1;Td.EwaSettings.isChangeGateEnabled("OfficeVSO:5501906_TableSelectionEnableShiftSelection")?(ta=this.m7c(W,ta,Bb.left,ta,Bb.right),this.zSd(ta,Vd,W)):this.ASd(ta,Bb.left,ta,Bb.right,!1,!1,Vd);break;case 2:this.hTb=2;Td.EwaSettings.isChangeGateEnabled("OfficeVSO:5501906_TableSelectionEnableShiftSelection")?
(ta=this.m7c(W,Bb.top,Bb.left,Bb.bottom,Bb.right),this.zSd(ta,Vd,W)):this.ASd(Bb.top,Bb.left,Bb.bottom,Bb.right,fg.d(qc),fg.g(qc),Vd);break;default:jc.ULS.shipAssertTag(537151240,0,!1,"TableManager.HandleTableSelectorsSelection: Table Selector can not be of type: {0}",Kb.toString());return}Td.EwaSettings.isChangeGateEnabled("OfficeVSO:5501896_TableSelectionDragSelection")&&(Ke.g(this.$).ga.selectionType=3);jc.ULS.sendTraceTag(527212953,0,50,"TableManager.handleTableSelectorsSelection: A table selector was clicked using hover arrows")}else jc.ULS.shipAssertTag(537151241,
0,!1,"TableManager.HandleTableSelectorsSelection: Table for table selector selection can't be null")};qb.prototype.KBj=function(W){var ta=this.m7b.usedRange;return this.bkf(W)||1!==this.aJa&&this.bkf(new nf.Range(ta.top,W.left,ta.bottom,W.right,!1,!1))?!0:!1};qb.prototype.FJd=function(W){return W.Autofilters};qb.prototype.yGe=function(W,ta){var ob=!1;var Kb=ta.rb.wj(W),qc=ta.Kf(Kb).nh;if(!qc)return jc.ULS.sendTraceTag(537151238,0,15,"TableManager.CouldExpandImpl - loadedRange is null. PaneType={0}",
Kb),{returnValue:!1,yZ:ob};if(!qc.We(W))return{returnValue:!0,yZ:ob};W=ta.Pk("TableManager.CouldExpandImpl",W,2);try{for(;W.$$mn();){if(W.$$cu().text||W.to.taf)return ob=!0,{returnValue:!1,yZ:ob};if(W.$$cu().WF)return{returnValue:!1,yZ:ob}}}finally{W&&W.dispose()}return{returnValue:!0,yZ:ob}};qb.prototype.q0h=function(W){if(!W)return null;var ta=new Mc.AutofilterRange(W.top,W.left,W.bottom,W.right,null,null,null,W.id,W.Pba);ta.RTa=W.RTa;for(var ob=0,Kb=this.rangeList.length;ob<Kb;ob++){var qc=this.rangeList[ob];
qc.id===W.id&&qc!==W&&this.pqi(qc)&&(ta.union(qc),qc.RTa&&(ta.RTa=!0))}return ta};qb.prototype.pqi=function(W){return!!Ke.g(this.$).Tb.Wj(W)};qb.prototype.eOh=function(){for(var W=[],ta=Cl(this.rangeList),ob=ta.next();!ob.done;ob=ta.next())ob=new af.a(this.rn(ob.value.topLeft),Ga.d(this.$.oa)),W.push(ob);return W};qb.prototype.Cjd=function(){for(var W={},ta=Cl(this.rangeList),ob=ta.next();!ob.done;ob=ta.next())if(ob=ob.value){var Kb=this.rn(ob.topLeft);Kb&&(W[Kb.toString()]=this.rn(ob.topLeft))}return W};
qb.prototype.$xi=function(){this.$.ea.yh?this.Lzb(0):this.$.ea.Gm(this.vO)};qb.prototype.Lzb=function(W){var ta=this;this.$.gD(function(ob){ob.iwa(W).then(ta.DHb)})};qb.prototype.H3h=function(W){var ta=this.gridView.Tb.Wj(W);return ta?ta.name:W.toString()};qb.prototype.ASd=function(W,ta,ob,Kb,qc,Bb,sd){var Vd=W+(qc?1:0),bf=ob-(Bb?1:0),Xf=this.gridView.inRangePicker||this.gridView.Vi,vg=!1,kh=new nf.Range(Vd,ta,bf,Kb,!1,!1);if(qc||Bb)for(qc=Xf?af.a.btb(this.gridView.ga.rangePicker.IL):this.gridView.ga.va.selectedRanges,
qc=Cl(qc),Bb=qc.next();!Bb.done;Bb=qc.next()){Bb=Bb.value;vg=this.lsb(Bb,Vd,ta,bf,Kb);var ki=this.lsb(Bb,W,ta,ob,Kb);if(Xf&&vg)break;if(!Xf&&(vg||ki)){this.gridView.ga.updateSelection(Bb,Bb.topLeft,0,1);if(sd&&ki)return;break}}vg&&(kh.top=W,kh.bottom=ob);W=kh.topLeft;sd?this.gridView.ga.updateSelection(kh,W,0,1):Xf?this.gridView.ga.bE([kh],0,W,0):this.gridView.ga.updateSelection(kh,W,0,3)};qb.prototype.zSd=function(W,ta,ob){W&&(ob=ob?Ke.g(this.$).ga.va.activeCell:W.topLeft,ta?this.gridView.ga.updateSelection(W,
ob,0,1):this.gridView.ga.bE([W],0,ob,0))};qb.prototype.m7c=function(W,ta,ob,Kb,qc){var Bb=fg.d(this.m7b),sd=fg.g(this.m7b),Vd=ta+(1!==this.aJa&&Bb?1:0),bf=Kb-(1!==this.aJa&&sd?1:0),Xf=this.gridView.inRangePicker||this.gridView.Vi;if(W){var vg=Td.EwaSettings.isChangeGateEnabled("OfficeVSO:5593089_TableSelectorsBugFixes")&&Xf&&!af.a.btb(this.gridView.ga.rangePicker.IL).length?new nf.Range(Vd,ob,bf,qc,!1,!1):Xf?this.gridView.ga.rangePicker.activeCell:this.gridView.ga.va.activeCell;vg=new nf.Range(vg.top<
Vd?vg.top:Vd,vg.left<ob?vg.left:ob,vg.bottom>bf?vg.bottom:bf,vg.right>qc?vg.right:qc,!1,!1)}else vg=new nf.Range(Vd,ob,bf,qc,!1,!1);if(1!==this.aJa&&(Bb||sd)&&(!W||W&&this.lsb(vg,Vd,ob,bf,qc)))for(W=Xf?af.a.btb(this.gridView.ga.rangePicker.IL):this.gridView.ga.va.selectedRanges,W=Cl(W),Bb=W.next();!Bb.done;Bb=W.next())if(this.lsb(Bb.value,Vd,ob,bf,qc)){vg.top=ta;vg.bottom=Kb;break}return vg};qb.prototype.bkf=function(W){var ta=this.gridView.inRangePicker||this.gridView.Vi?af.a.btb(this.gridView.ga.rangePicker.IL):
this.gridView.ga.va.selectedRanges;ta=Cl(ta);for(var ob=ta.next();!ob.done;ob=ta.next())if(this.lsb(ob.value,W.top,W.left,W.bottom,W.right))return!0;return!1};qb.prototype.lsb=function(W,ta,ob,Kb,qc){return!!W&&W.top===ta&&W.bottom===Kb&&W.left===ob&&W.right===qc};uk.Object.defineProperties(qb.prototype,{vGa:{configurable:!0,enumerable:!0,get:function(){return this.NRb}},wvd:{configurable:!0,enumerable:!0,get:function(){return this.Wce}},aJa:{configurable:!0,enumerable:!0,get:function(){return this.hTb}},
Ig:{configurable:!0,enumerable:!0,get:function(){var W=Ke.g(this.$);return W.Tb.Wj(W.ga.va.activeCell,!1)}},oId:{configurable:!0,enumerable:!0,get:function(){return this.wvd?Ke.g(this.$).Tb.Wj(this.wvd,!1):null}}});Object(zc.a)(qb,"TableManager",sc,[930,3]);var Oh=wf.a;Am(Sb,Oh);Sb.prototype.create=function(){this.Eb(this.tableManager||(this.tableManager=new qb(this.$)))};Object(zc.a)(Sb,"TableManagerFactory",wf.a,[]);var Xg=b(111),Sg=b(1025),gg=b(1480),di=b(934),Jg=b(1432),Mh=b(164),$h=b(83),zh=
b(110),Eh=b(27),Xh=b(195),Fh=b(29),Kg=b(289);Object(zc.a)(xb,"TableStyleElement",null,[]);var Sh=b(960),Nh=b(211),Gg=b(88),vh=b(591);Xb.rrf=function(W,ta){return Xb.Abg[W.Type]-Xb.Abg[ta.Type]};Xb.m5a=function(W,ta){try{return appChrome.buildTableStyleGalleryIconNew(Xb.hCa,Xb.opa,W,ta)}catch(ob){return null}};Xb.Clf=function(W){return W&&Hb.a.od in W&&(W=W[Hb.a.od])?Of.a.kM(W,fe.a.LHb):!1};Xb.jua=function(W){var ta=[],ob=0;W=Cl(W);for(var Kb=W.next();!Kb.done;Kb=W.next()){Kb=Kb.value;ta[ob]={};ta[ob].backgroundColor=
"white";ta[ob].color="black";for(var qc in Kb){var Bb=Kb[qc];switch(qc){case "background-color":ta[ob].backgroundColor=Bb;break;case "color":ta[ob].color=Bb;break;case "font-size":ta[ob].fontSize=Bb;break;case "border-bottom":ta[ob].borderBottom=Bb;break;case "border-right":ta[ob].borderRight=Bb;break;case "border-left":ta[ob].borderLeft=Bb;break;case "border-top":ta[ob].borderTop=Bb}}ob++}return ta};Xb.H5b=function(W,ta){var ob=[];if(null===W||void 0===W?0:W.TableStyleElementsList)for(var Kb=0===
W.Category,qc=0;qc<Xb.opa;qc++)ob.push.apply(ob,Xb.$Rh(W,ta,Kb,qc));else{if(Xb.P8c)return Xb.P8c;W={color:"black","background-color":"white"};for(ta=0;ta<Xb.opa;ta++)for(Kb=0;Kb<Xb.hCa;Kb++)ob.push(W);Xb.P8c=ob}return ob};Xb.I3h=function(W,ta){if(!W.TableStyleElementsList)return"";var ob="";W=Cl(W.TableStyleElementsList);for(var Kb=W.next();!Kb.done;Kb=W.next())if(Kb=Kb.value,Kb.BackgroundColor&&"#000000"!==Kb.BackgroundColor)switch(Kb.Type){case 0:ob=Kb.BackgroundColor;break;case 5:case 7:if(ta.Qia||
ta.bT)ob=Kb.BackgroundColor;break;case 3:case 4:if(ta.firstCol||ta.lastCol)ob=Kb.BackgroundColor;break;case 2:ta.totalRow&&(ob=Kb.BackgroundColor);break;case 1:ta.headerRow&&(ob=Kb.BackgroundColor)}return ob};Xb.G4b=function(W){W=new Nh.a(parseInt(String("0x"+W.substr(1,2)),16),parseInt(String("0x"+W.substr(3,2)),16),parseInt(String("0x"+W.substr(5,2)),16));return Sh.a.wLa(W)};Xb.u7e=function(W,ta){if(!W||!ta)return"";ta=(ta=Xb.I3h(W,ta))?Xb.G4b(ta)+", ":Ee.a.instance.fa(2010)+", ";switch(W.Index){case 0:return ta+
Ee.a.instance.fa(1944);case 1:return ta+Ee.a.instance.fa(1945);case 2:return ta+Ee.a.instance.fa(1946);case 3:return ta+Ee.a.instance.fa(1947);case 4:return ta+Ee.a.instance.fa(1948);case 5:return ta+Ee.a.instance.fa(1949);case 6:return ta+Ee.a.instance.fa(1950);case 7:return ta+Ee.a.instance.fa(1951);case 8:return ta+Ee.a.instance.fa(1952);case 9:return ta+Ee.a.instance.fa(1953);case 10:return ta+Ee.a.instance.fa(1954);case 11:return ta+Ee.a.instance.fa(1955);case 12:return ta+Ee.a.instance.fa(1956);
case 13:return ta+Ee.a.instance.fa(1957);case 14:return ta+Ee.a.instance.fa(1958);case 15:return ta+Ee.a.instance.fa(1959);case 16:return ta+Ee.a.instance.fa(1960);case 17:return ta+Ee.a.instance.fa(1961);case 18:return ta+Ee.a.instance.fa(1962);case 19:return ta+Ee.a.instance.fa(1963);case 20:return ta+Ee.a.instance.fa(1964);case 21:return ta+Ee.a.instance.fa(1965);case 22:return ta+Ee.a.instance.fa(1966);case 23:return ta+Ee.a.instance.fa(1967);case 24:return ta+Ee.a.instance.fa(1968);case 25:return ta+
Ee.a.instance.fa(1969);case 26:return ta+Ee.a.instance.fa(1970);case 27:return ta+Ee.a.instance.fa(1971);case 28:return ta+Ee.a.instance.fa(1972);case 29:return ta+Ee.a.instance.fa(1973);case 30:return ta+Ee.a.instance.fa(1974);case 31:return ta+Ee.a.instance.fa(1975);case 32:return ta+Ee.a.instance.fa(1976);case 33:return ta+Ee.a.instance.fa(1977);case 34:return ta+Ee.a.instance.fa(1978);case 35:return ta+Ee.a.instance.fa(1979);case 36:return ta+Ee.a.instance.fa(1980);case 37:return ta+Ee.a.instance.fa(1981);
case 38:return ta+Ee.a.instance.fa(1982);case 39:return ta+Ee.a.instance.fa(1983);case 40:return ta+Ee.a.instance.fa(1984);case 41:return ta+Ee.a.instance.fa(1985);case 42:return ta+Ee.a.instance.fa(1986);case 43:return ta+Ee.a.instance.fa(1987);case 44:return ta+Ee.a.instance.fa(1988);case 45:return ta+Ee.a.instance.fa(1989);case 46:return ta+Ee.a.instance.fa(1990);case 47:return ta+Ee.a.instance.fa(1991);case 48:return ta+Ee.a.instance.fa(1992);case 49:return ta+Ee.a.instance.fa(1993);case 50:return ta+
Ee.a.instance.fa(1994);case 51:return ta+Ee.a.instance.fa(1995);case 52:return ta+Ee.a.instance.fa(1996);case 53:return ta+Ee.a.instance.fa(1997);case 54:return ta+Ee.a.instance.fa(1998);case 55:return ta+Ee.a.instance.fa(1999);case 56:return ta+Ee.a.instance.fa(2E3);case 57:return ta+Ee.a.instance.fa(2001);case 58:return ta+Ee.a.instance.fa(2002);case 59:return ta+Ee.a.instance.fa(2003);default:return W.Name?W.Name:""}};Xb.bZh=function(W){return(W+1)%Xb.jci};Xb.Vxb=function(W,ta,ob){ob=void 0===
ob?"":ob;return W||!ob?String.format("{0}, {1}, -version, {2}",Xb.Ccf,W.Index.toString(),ta.toString()):String.format("{0}, {1}, -version, {2}",Xb.Ccf,ob,ta.toString())};Xb.$Rh=function(W,ta,ob,Kb){for(var qc=[],Bb=0;Bb<Xb.hCa;Bb++)qc.push(Xb.Ugd(W,ta,ob,Kb,Bb));return qc};Xb.Ugd=function(W,ta,ob,Kb,qc){var Bb=W.TableStyleElementsList;W=new xb;var sd={};if(!Bb)return sd;for(var Vd=Cl(Bb),bf=Vd.next();!bf.done;bf=Vd.next())if(bf=bf.value,0===bf.Type){W=bf;break}Vd=!!W.BackgroundColor;var Xf="";!ob&&
W.TableStyleBorderFromatList&&0<W.TableStyleBorderFromatList.length&&(Xf=W.TableStyleBorderFromatList[0].Color);sd["background-color"]=Vd?W.BackgroundColor:"#FFFFFF";W.FontColor||(W.FontColor="#000000");sd.color=W.FontColor;Xb.DBe(Kb,qc,sd,W,Xf,ob,Vd);Bb=Cl(Bb);for(bf=Bb.next();!bf.done;bf=Bb.next())(bf=bf.value)&&0!==bf.Type&&(2!==bf.Type||Vd||(bf.BackgroundColor=W.BackgroundColor),Xb.hud(bf,Kb,qc,ta)&&(bf.BackgroundColor&&(sd["background-color"]=bf.BackgroundColor),sd.color=bf.FontColor||W.FontColor,
Xb.DBe(Kb,qc,sd,bf,Xf,ob,Vd)));return sd};Xb.dW=function(W,ta,ob,Kb,qc,Bb){ob&&(ob.Color&&!ob.Style&&(ob.Style=1),ob.Style&&!ob.Color&&(ob.Color=qc?"#000000":Kb?Kb:Bb?"#FFFFFF":"#000000"),ta[Xb.borders[W]]="1px "+Xb.PW[ob.Style]+" "+ob.Color)};Xb.hud=function(W,ta,ob,Kb){return-1===W.Type?!1:Xb.iud(W,ta,ob,Kb)||Xb.qsi(W,ta,ob,Kb)||Xb.jud(W,ta,ob,Kb)};Xb.qsi=function(W,ta,ob,Kb){return!ta&&Kb.headerRow||ta===Xb.opa-1&&Kb.totalRow?!1:1===ta%2&&5===W.Type&&Kb.bT&&Kb.headerRow||1<ta&&!!((ta-1)%(W.BandSize+
1))&&6===W.Type&&Kb.bT&&Kb.headerRow||!(ta%2)&&5===W.Type&&Kb.bT&&!Kb.headerRow||!!(ta%(W.BandSize+1))&&6===W.Type&&Kb.bT&&!Kb.headerRow||!(ob%2)&&7===W.Type&&Kb.Qia||!!(ob%(W.BandSize+1))&&8===W.Type&&Kb.Qia};Xb.jud=function(W,ta,ob,Kb){return ta===Xb.opa-1&&2===W.Type&&Kb.totalRow||ob===Xb.hCa-1&&ta===Xb.opa-1&&12===W.Type&&Kb.totalRow&&Kb.lastCol||!ob&&ta===Xb.opa-1&&11===W.Type&&Kb.totalRow&&Kb.firstCol||ob===Xb.hCa-1&&4===W.Type&&Kb.lastCol};Xb.iud=function(W,ta,ob,Kb){return!ta&&1===W.Type&&
Kb.headerRow||!ob&&3===W.Type&&Kb.firstCol||!ob&&!ta&&9===W.Type&&Kb.headerRow&&Kb.firstCol||ob===Xb.hCa-1&&!ta&&10===W.Type&&Kb.headerRow&&Kb.lastCol};Xb.DBe=function(W,ta,ob,Kb,qc,Bb,sd){if(Kb.TableStyleBorderFromatList)for(var Vd=Cl(Kb.TableStyleBorderFromatList),bf=Vd.next();!bf.done;bf=Vd.next())if(bf=bf.value,bf.Style)switch(bf.Position){case 0:W&&12!==Kb.Type&&11!==Kb.Type&&2!==Kb.Type&&5!==Kb.Type&&6!==Kb.Type||Xb.dW(0,ob,bf,qc,Bb,sd);break;case 1:W!==Xb.opa-1&&1!==Kb.Type&&10!==Kb.Type&&
9!==Kb.Type&&5!==Kb.Type&&6!==Kb.Type||Xb.dW(1,ob,bf,qc,Bb,sd);break;case 2:ta&&12!==Kb.Type&&10!==Kb.Type&&7!==Kb.Type&&8!==Kb.Type&&4!==Kb.Type||Xb.dW(2,ob,bf,qc,Bb,sd);break;case 3:ta!==Xb.hCa-1&&9!==Kb.Type&&11!==Kb.Type&&3!==Kb.Type&&7!==Kb.Type&&8!==Kb.Type||Xb.dW(3,ob,bf,qc,Bb,sd);break;case 5:ta!==Xb.hCa-1&&3!==Kb.Type&&4!==Kb.Type&&7!==Kb.Type&&8!==Kb.Type&&Xb.dW(3,ob,bf,qc,Bb,sd);break;case 6:W!==Xb.opa-1&&2!==Kb.Type&&1!==Kb.Type&&5!==Kb.Type&&6!==Kb.Type&&Xb.dW(1,ob,bf,qc,Bb,sd)}};Xb.L3h=
function(){var W=Array(12);W[0]=0;W[7]=1;W[8]=2;W[5]=3;W[6]=4;W[4]=5;W[3]=6;W[1]=7;W[2]=8;W[9]=9;W[10]=10;W[11]=11;W[12]=13;return W};Xb.opa=5;Xb.hCa=5;Xb.jci=5;Xb.Ccf="TableStyleIcon";Xb.PW=[null,Gg.a.solid,Gg.a.dashed,Gg.a.dotted,Gg.a.dashed,Gg.a.dotted,Gg.a.dashed,Gg.a.double];Xb.borders=[vh.a.borderTop,vh.a.borderBottom,vh.a.borderLeft,vh.a.borderRight];Xb.Abg=Xb.L3h();Xb.P8c=null;Object(zc.a)(Xb,"TableStyleHelper",null,[]);hb.prototype.equals=function(W){return W?this.headerRow===W.headerRow&&
this.totalRow===W.totalRow&&this.firstCol===W.firstCol&&this.lastCol===W.lastCol&&this.Qia===W.Qia&&this.bT===W.bT:!1};Object(zc.a)(hb,"TableStyleOptions",null,[]);var Hi=b(1004),Tg=Be.a;Am(Sa,Tg);Sa.prototype.X9h=function(W){var ta=this.tableManager.Ig;if(!ta)return!1;W=W[Hb.a.od];if(!W)return!1;switch(Number.parseInvariant(W)){case 0:return fg.d(ta);case 1:return fg.c(ta);case 2:return fg.g(ta);case 3:return fg.e(ta);case 4:return fg.f(ta);case 5:return fg.b(ta);case 6:return ta.hasAutoFilter}return!1};
Sa.prototype.ILf=function(W,ta){if(Xg.a.isEmpty(this.LG))return!0;if("PopulateTableMoreStylesMenu"!==W&&"PopulateTableAccessibleStylesMenu"!==W)return!1;if(Td.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AccessibleAuthoringTab",!1)&&"PopulateTableAccessibleStylesMenu"===W&&!this.hBc)return this.QNb||(this.QNb=!0,this.MLa("accessibilityTab")),!0;this.RBb=!0;var ob=this.Ta.iq("TableStylesMenu"),Kb=this.Ta.oB("Ribbon.TableTools.TableStyles.Gallery.Custom",7,"Size48by48"),qc=this.Ta.oB("Ribbon.TableTools.TableStyles.Gallery.Dark",
7,"Size48by48"),Bb=this.Ta.oB("Ribbon.TableTools.TableStyles.Gallery.Medium",7,"Size48by48"),sd=this.Ta.oB("Ribbon.TableTools.TableStyles.Gallery.Light",7,"Size48by48"),Vd=-123538519;if(ta.MenuId)if(Of.a.contains(ta.MenuId,"FormatAsTable",!0))Vd=753331043,this.L7a=!0;else{var bf=Ee.a.instance.fa(1943);var Xf=Xb.Vxb(null,1,"-1");Td.EwaSettings.isChangeGateEnabled("OfficeVSO:4185429_NonNullIconNameForSLRGalleryItem")?sd.Xt("-1",Vd,"QueryTableStyle",0,"-1",Xf,void 0,void 0,bf):sd.Xt("-1",Vd,"QueryTableStyle",
0,"-1",void 0,void 0,void 0,bf);this.L7a=!1}Xf=0;var vg=this.LG,kh;for(kh in vg){var ki=vg[kh];if(!Td.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AccessibleAuthoringTab",!1)||"PopulateTableAccessibleStylesMenu"!==W||!ki.HasStyleViolations){bf=Xb.u7e(ki,this.Uwb());var Yd=Xb.Vxb(ki,this.TIa);if(ki)switch(ki.Category){case 0:Kb.Xt(ki.Index.toString(),Vd,"QueryTableStyle",0,ki.Index.toString(),Yd,void 0,void 0,bf);Xf++;break;case 3:qc.Xt(ki.Index.toString(),Vd,"QueryTableStyle",0,ki.Index.toString(),
Yd,void 0,void 0,bf);break;case 2:Bb.Xt(ki.Index.toString(),Vd,"QueryTableStyle",0,ki.Index.toString(),Yd,void 0,void 0,bf);break;case 1:sd.Xt(ki.Index.toString(),Vd,"QueryTableStyle",0,ki.Index.toString(),Yd,void 0,void 0,bf)}}}0<Xf&&this.r3(ob,Kb,1911);this.r3(ob,sd,1912);this.r3(ob,Bb,1913);this.r3(ob,qc,1914);ta.MenuItems=ob.BC();this.isInitialized||(this.isInitialized=!0);return!0};Sa.prototype.Y9h=function(W){var ta=this;W[Sg.a.On]=!1;var ob=W[Hb.a.od];if(ob&&!Xg.a.isEmpty(this.LG)){Of.a.contains(W.ParentMenuId,
"FormatAsTable",!0)?this.L7a=!0:this.L7a=!1;this.L7a||this.Qgg();Xb.Clf(W)&&(ob=this.nxb(ob).toString());var Kb=this.Uwb();W[Sg.a.Alt]="-1"===ob?Ee.a.instance.fa(1943):Xb.u7e(this.qkd(ob),Kb);if(ob in this.qUa&&Kb.equals(this.c1c))this.KLf(W,ob,Kb,!0);else{if(!this.Ttc||this.Ttc&&!this.Ttc.Ap)this.Hna={},this.Ttc=Rg.a.instance.create(function(){ta.URf();ta.c1c=ta.Uwb()},0,ah.a.wNj,!0,!0);this.jHd(Kb,W,ob)}}};Sa.prototype.getTableStyleIndexFromName=function(W){if(!W||Xg.a.isEmpty(this.LG))return-1;
if(W in this.LG)return this.LG[W].Index;this.MLa("getTableStyleIndexFromName");return-1};Sa.prototype.mkc=function(){return!!this.nM};Sa.prototype.nxb=function(W){this.PO||this.E0c();return W in this.PO?this.PO[W]:-1};Sa.prototype.MLa=function(W){if(this.$.isEditMode)if(Td.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AccessibleAuthoringTab",!1)){var ta=new Date;if(30<zh.getElapsedSeconds(this.lastSyncTime,ta)||Xg.a.isEmpty(this.LG)||this.QNb){var ob=this.$.na.ta.fc();this.lastSyncTime=
ta;W=this.QNb&&"accessibilityTab"===W||"galleryMenuClosed"===W;$h.s(this.$.na.ta,W,this.qCf,this.IDd,null,W?"accessibility":"normal",ob)}}else if(ob=new Date,30<zh.getElapsedSeconds(this.lastSyncTime,ob)||Xg.a.isEmpty(this.LG))W=this.$.na.ta.fc(),this.lastSyncTime=ob,$h.r(this.$.na.ta,this.qCf,this.IDd,null,null,W)};Sa.prototype.dispose=function(){this.PO=this.qUa=this.nM=this.LG=null;this.$.Ka.Fcb(this.NHf);Tg.prototype.dispose.call(this)};Sa.prototype.IKg=function(W){this.addHandler("RefreshTableStyleGallery",
W)};Sa.prototype.Yhj=function(W){this.removeHandler("RefreshTableStyleGallery",W)};Sa.prototype.E0c=function(){var W={};this.tableManager.Ig&&(this.xea=this.getTableStyleIndexFromName(this.tableManager.Ig.JBc));for(var ta=1;7>=ta;ta++)W["preview"+ta]=this.eYh(ta);this.PO=W};Sa.prototype.eYh=function(W){var ta=this.nM.TableStyleItems.length;ta=4>=this.xea?this.xea+W-1:4<this.xea&&this.xea<ta-4?4===W?this.xea:Math.floor(this.xea+W-4):this.xea+W-1;-1===ta||ta.toString()in this.qUa||(ta=W-3);return ta};
Sa.prototype.Qgg=function(){if(this.tableManager.Ig){var W=!1,ta=this.getTableStyleIndexFromName(this.tableManager.Ig.JBc);if(ta!==this.xea){if(this.PO){var ob=this.PO,Kb;for(Kb in ob)ob[Kb]===ta&&(W=!0)}this.xea=ta;W||Xg.a.isEmpty(this.qUa)||this.E0c()}}};Sa.prototype.r3=function(W,ta,ob){var Kb=this.Ta.Oc();Kb.lq="Thin";Kb.title=Ee.a.instance.fa(ob);Kb.buttons.push(ta);W.Dc.push(Kb)};Sa.prototype.Uwb=function(){var W=this.tableManager.Ig;return this.L7a||!W?new hb(!0,!1,!1,!1,!0,!1):new hb(fg.d(W),
fg.g(W),fg.c(W),fg.e(W),fg.f(W),fg.b(W))};Sa.prototype.URf=function(W){W=void 0===W?!1:W;var ta={},ob={},Kb=this.Uwb();if(!Xg.a.isEmpty(this.LG)&&(this.tableManager.Ig&&this.Qgg(),!Kb.equals(this.c1c)||W||Xg.a.isEmpty(this.qUa))){this.TIa=Xb.bZh(this.TIa);W=this.LG;for(var qc in W){var Bb=W[qc],sd=Xb.Vxb(Bb,this.TIa);ta[Bb.Index.toString()]=Xb.m5a(Xb.jua(Xb.H5b(Bb,Kb)),sd);ob[sd]=ta[Bb.Index.toString()];this.IIb(ob)}qc=Xb.Vxb(null,this.TIa,"-1");ta["-1"]=Xb.m5a(Xb.jua(Xb.H5b(null,Kb)),qc);ob[qc]=
ta["-1"];this.IIb(ob);Xh.c(this.qUa,ta,!1)}};Sa.prototype.Gsi=function(){var W=Mh.a(this.$);return W?W.Um.Po===fe.a.ytc:!1};Sa.prototype.jHd=function(W,ta,ob){Number.parseInvariant(ob);"-1"===ob&&Of.a.contains(ta.ParentMenuId,"FormatAsTable",!0)||this.KLf(ta,ob,W,!1)};Sa.prototype.KLf=function(W,ta,ob,Kb){var qc=Xb.Vxb(null,this.TIa,ta);Xb.Clf(W)?(qc in this.Hna?ob=this.Hna[qc]:(ob=Xb.jua(Xb.H5b(this.qkd(ta),ob)),this.Hna[qc]=ob),W[Sg.a.GalleryButtonProps]=Object.assign(new gg.a,{Command:"-123538519",
QueryCommand:"QueryTableStyle",Id:qc,Alt:W[Sg.a.Alt],MenuItemId:ta,TableCellStyles:ob,TableStyles:this.Z5i})):(W[di.a.Icon]=qc,W[Sg.a.GalleryButtonProps]=Object.assign(new Jg.a,{Command:"-123538519",QueryCommand:"QueryTableStyle",Id:qc,Alt:W[Sg.a.Alt],MenuItemId:ta}),Kb||(Kb=[],this.qkd(ta),"-1"===ta||Of.a.contains(W.ParentMenuId,"FormatAsTable",!0)||(Kb=Xb.H5b(this.nM.TableStyleItems[Number.parseInvariant(ta)],ob)),this.qUa[ta]=Xb.m5a(Xb.jua(Kb),qc)))};Sa.prototype.IIb=function(W){var ta=this;if(this.RBb)this.Uwc=
function(){ta.IIb(W)};else{this.Uwc=null;var ob=[],Kb;for(Kb in W){var qc=Kb;qc in this.KIb?ob.push(qc):this.KIb[qc]=!0}try{0<ob.length&&appChrome.api.unregisterIcons(ob),Xg.a.isEmpty(W)||appChrome.api.registerIconProvider(function(){return W})}catch(Bb){}}};Sa.prototype.qkd=function(W){W=Number.parseInvariant(W);if(-1===W||!this.nM)return null;if(60<W)for(var ta=60;ta<this.nM.TableStyleItems.length;++ta){var ob=this.nM.TableStyleItems[ta];if(ob.Index===W)return ob}return this.nM.TableStyleItems[W]};
Object(zc.a)(Sa,"TableStyleManager",Be.a,[929,3]);var ph=wf.a;Am(db,ph);db.prototype.create=function(){var W=this,ta=ug.GetServiceTaskFactory.create(this.$.da,102,this.la,this.ub),ob=ug.GetServiceTaskFactory.Ua(this.$.da,66,134,this.ub);Le.TaskExtensions.Ba(Dc.Task.WAA(ta,ob),function(){W.Eb(W.tableStyleManager||(W.tableStyleManager=new Sa(W.$,ta.result,ob.result)))},this.$.la,8)};Object(zc.a)(db,"TableStyleManagerFactory",wf.a,[]);var Ag=b(905),oh=b(54);Ca.prototype.$V=function(){return this.autoFilterOptions};
Object(zc.a)(Ca,"MacroRecorderRangeColumnSortedOrFilteredPayload",null,[428]);wa.prototype.$V=function(){return this.autoFilterOptions};Object(zc.a)(wa,"MacroRecorderRangeItemFilteredPayload",null,[428]);var Zg=b(1135),Dg=b(387),li=b(173),zg=b(184),Ah=b(288);Object(zc.a)(ma,"MacroRecorderTableStyleAppliedPayload",null,[428]);Am(ua,ma);Object(zc.a)(ua,"MacroRecorderRangeFormatedAsTablePayload",ma,[]);T.prototype.rn=function(){return this.tableRange};T.prototype.getTitle=function(){return this.title};
T.prototype.getDescription=function(){return this.description};Object(zc.a)(T,"MacroRecorderTableAltTextEditedPayload",null,[428]);Object(zc.a)(Wc,"MacroRecorderTableRenamedPayload",null,[428]);Object(zc.a)(Tb,"MacroRecorderTableResizedPayload",null,[428]);Object(zc.a)(Eb,"MacroRecorderTableStyleOptionToggledPayload",null,[428]);Object(zc.a)(gc,"MacroRecorderTableConvertedToRangePayload",null,[428]);Ub.prototype.AM=function(){jc.ULS.sendTraceTag(537151186,0,50,"ConvertToRangeManager.ShowDialogOld: Time taken to show Get IsRangeQueryTable is {0} milliseconds",
this.Ef.qh.Gc);if(this.lDa&&!Kg.a(this.lDa)){this.Ef.sBb=this.lDa.Result;if(this.Ef.sBb)return this.v3d=Fh.a.ed(3,2,0,725,0,-66108047,"ConvertToRange"),this.qj=Ih.a(this.Ef.$).zi(this.v3d).G(),this.qj.isCompleted||(this._state=2,this.qj.xO(this.moveNext)),this.QFc;this.Ef.kGe();return this.phb}return this.i2};Ub.prototype.i2=function(){this.Ef.qh.stop();jc.ULS.sendTraceTag(537151185,0,50,"ConvertToRangeManager.ShowDialogOld: Total Time taken for complete operation is {0} milliseconds",this.Ef.qh.Gc);
this._state=3};Ub.prototype.phb=function(){return this.i2};Ub.prototype.QFc=function(){this.w3d=this.qj.Kz();jc.ULS.sendTraceTag(537151184,0,50,"ConvertToRangeManager.ShowDialogOld: Time taken for User Input is {0} milliseconds",this.Ef.qh.Gc);0===this.w3d&&this.Ef.jGe();return this.phb};Ub.prototype.dispose=function(){};Object(zc.a)(Ub,"$$sm_Microsoft$Office$Excel$WebUI$Client$TableOperations$ConvertToRangeManager$ShowDialogOld",null,[3]);var Qg=b(955);tb.prototype.ebb=function(){var W=this;this.qh.start();
var ta=this.$.na.ta.fc();return Td.EwaSettings.isChangeGateEnabled("OfficeVSO:5364656_RefactorOutAwaitsInScriptSharpWithContinueWithAndLogExceptionsMethodV2")?Qg.h(this.$.na.ta,this.sharedSheetRange,function(ob){W.showDialog(ob)},null,null,null,ta):Qg.h(this.$.na.ta,this.sharedSheetRange,function(ob){W.aFj(ob)},null,null,null,ta)};tb.prototype.showDialog=function(W){var ta=this;jc.ULS.sendTraceTag(537151193,0,50,"ConvertToRangeManager.ShowDialog: Time taken to show Get IsRangeQueryTable is {0} milliseconds",
this.qh.Gc);W&&!Kg.a(W)&&((this.sBb=W.Result)?(W=Fh.a.ed(3,2,0,725,0,-66108047,"ConvertToRange"),Le.TaskExtensions.Ba(Ih.a(this.$).zi(W),function(ob){jc.ULS.sendTraceTag(537151192,0,50,"ConvertToRangeManager.ShowDialog: Time taken for User Input is {0} milliseconds",ta.qh.Gc);0===ob.result&&ta.jGe()},this.$.la,11)):this.kGe());this.qh.stop();jc.ULS.sendTraceTag(537151191,0,50,"ConvertToRangeManager.ShowDialog: Total Time taken for complete operation is {0} milliseconds",this.qh.Gc)};tb.prototype.aFj=
function(W){new Ub(this,W)};tb.prototype.oye=function(){var W={};W.IsQueryTable=this.sBb;W.Range=this.sharedSheetRange;return W};tb.prototype.jGe=function(){var W=this,ta=this.$.na.ta;jc.ULS.sendTraceTag(537151190,0,50,"Convert To Range initiated for Query Table");this.zff(194,function(ob,Kb,qc){return Qg.d(ta,W.oye(),ob,Kb,qc,null)});jc.ULS.sendTraceTag(537151189,0,50,"Convert To Range completed for Query Table")};tb.prototype.kGe=function(){var W=this,ta=this.$.na.ta;jc.ULS.sendTraceTag(537151188,
0,50,"Convert To Range initiated for Normal Table");this.zff(193,function(ob,Kb,qc){return Qg.c(ta,W.oye(),ob,Kb,qc,null)},function(){return new gc(W.tableName)});jc.ULS.sendTraceTag(537151187,0,50,"Convert To Range completed for Normal Table")};tb.prototype.zff=function(W,ta,ob){ob=void 0===ob?null:ob;Dg.a(this.$.userOperationManager,ta,function(Kb){return new li.a(W,0,Kb,void 0,ob)},null)};Object(zc.a)(tb,"ConvertToRangeManager",null,[]);var Bf=b(1287),Gi=b(1286),Uh=b(1323),Ka=Uh.a;Am(Ha,Ka);Ha.prototype.Bk=
function(){var W=this,ta=Qe.s(this.QC.TableRange);return function(){return new ua(ta,W.n6a.checked,W.iCa,!0)}};Ha.prototype.Ox=function(){var W=this,ta=Qe.s(this.QC.TableRange);return function(ob,Kb,qc){return Qg.g(W.$.na.ta,ta,W.n6a.checked,!1,W.QC.HasTotalRow,W.iCa,ob,Kb,qc,null)}};Ha.prototype.Fy=function(W,ta,ob){Ka.prototype.Fy.call(this,W,ta,ob)};uk.Object.defineProperties(Ha.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"FormatAsTableDialog"}},Mu:{configurable:!0,enumerable:!0,
get:function(){return 215}}});Object(zc.a)(Ha,"FormatAsTableDialogDeprecated",Uh.a,[]);var sa=b(1156),wb=sa.a;Am(nc,wb);nc.prototype.Bk=function(){var W=this,ta=Qe.s(this.QC.TableRange);return function(){return new ua(ta,W.hasHeaders,W.iCa,!0)}};nc.prototype.Ox=function(){var W=this,ta=Qe.s(this.QC.TableRange),ob=this.QC.HasTotalRow;return function(Kb,qc,Bb){return Qg.g(W.$.na.ta,ta,W.hasHeaders,!1,ob,W.iCa,Kb,qc,Bb,null)}};uk.Object.defineProperties(nc.prototype,{Cc:{configurable:!0,enumerable:!0,
get:function(){return"FormatAsTableDialog"}},Mu:{configurable:!0,enumerable:!0,get:function(){return 215}},uo:{configurable:!0,enumerable:!0,get:function(){return Ee.a.instance.fa(719)}}});Object(zc.a)(nc,"FormatAsTableReactDialog",sa.a,[]);var Nd=b(388),ee=b(86),yf=Nd.a;Am(Nb,yf);Nb.prototype.pKf=function(W){W=W.startsWith("=")?W.substring(1,W.length):W;var ta=Qe.Z(W,this.$.xa);W=ta.sheetName;var ob=ta.range;return ta.returnValue&&ob?(ob=Qe.v(ob,this.$),ob.SheetName=Of.a.equals(W,"",!0)?this.$.oa.name:
W,ob):null};Nb.prototype.iW=function(W){var ta={};return ta[Nb.O5]="ResizeTableDialog",ta[Nb.GPf]=W,ta.getInputErrorIfInvalid=this.oxb,ta};Nb.prototype.lid=function(W){W=this.pKf(W);if(!W)return 1;var ta=Qe.D(W);return Of.a.equals(W.SheetName,this.$.oa.sheetName,!0)&&this.grc.top===ta.top&&this.grc.Od(ta)?0:2};Nb.prototype.Dfd=function(W){var ta="";switch(W){case 1:ta=Ee.a.instance.fa(74);break;case 2:ta=ee.a.Il(Ee.a.instance.fa(73))}return ta};Nb.prototype.SRj=function(W){var ta={};W=(ta.ResizeTableRange=
W,ta.OriginalTableRange=this.grc,ta);this.$.ae(-1400250766,Hb.a.$b,8,W)};uk.Object.defineProperties(Nb.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"ResizeTableDialog"}}});Nb.O5="id";Nb.GPf="range";Object(zc.a)(Nb,"ResizeTableDialog",Nd.a,[]);var sg=Nd.a;Am(Hc,sg);Hc.prototype.lNj=function(W,ta){if(1===W&&(W=ta[Hc.PPj],ta=ta[Hc.Phh],W!==this.PFd||ta!==this.MFd)){var ob={};W=(ob.Title=W,ob.Description=ta,ob);this.$.ae(868579142,Hb.a.$b,8,W)}};Hc.prototype.iW=function(W,ta){var ob=
{};return ob.id="AltTextDialog",ob.title=W,ob.description=ta,ob};uk.Object.defineProperties(Hc.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"TableAltTextDialog"}}});Hc.O5="id";Hc.PPj="title";Hc.Phh="description";Object(zc.a)(Hc,"TableAltTextDialog",Nd.a,[]);var bg=b(982),Yf=b(983),xg=b(145),oe=b(65),Gh=b(39);Cc.prototype.$c=function(W,ta){switch(ta){case -544558380:return!(this.tableManager&&this.va.ZK()&&!this.qNa()&&fg.d(this.tableManager.Ig));case 1544516694:return!(this.tableManager&&
(this.va.ZK()?!this.qNa():this.va.$Ma()));case -697806646:case 323142015:return!this.va.ZK();case 341449783:case 2128797448:return Td.EwaSettings.isChangeGateEnabled("OfficeVSO:6083078_HeaderAndTotalRowDisabledFix")?!(this.tableManager&&(this.va.ZK()?!this.qNa():this.va.$Ma())):!(this.tableManager&&this.tableManager.nud(this.va.activeCell));case -123538519:return!(this.va.ZK()&&this.tableStyleManager&&this.tableStyleManager.mkc());case 756677940:return!(Td.EwaSettings.ma(414)&&this.Dji());case 753331043:case 2105103744:case -585683120:return!(this.tableStyleManager&&
this.Eji());case 844144422:return!this.va.ZK();case -723113214:return!(Td.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableMissingContextMenuOptions",!1)&&this.va.ZK())}return!1};Cc.prototype.executeCommand=function(W,ta,ob){var Kb=this,qc;W=Le.TaskExtensions.Dl();var Bb=this.$.na.ta,sd=null,Vd=1,bf=ta.command,Xf=this.$.na.ta.fc(),vg=null;switch(bf){case -2058042992:var kh=oh.a.ui(ob[Hb.a.Gg]);Cc.x1f(this.$,kh);sd=function(Yi,jh,bh){return Qg.a(Bb,kh,null,null,!1,!1,!1,bg.a.Mwa(xg.a.uta,
Yf.a.clearAutoFilter,Yi),jh,bh,null)};Vd=176;vg=function(){return new wa(kh)};break;case 504133448:case -798968736:case 477776686:var ki=oh.a.ui(ob[Hb.a.Gg]),Yd=ob.TopCellAddress;Cc.x1f(this.$,ki);var df=504133448===ta.command?1:-798968736===ta.command?2:3;if(Td.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SheetProtectionSettings",!1)&&Yd){ob=this.tableManager.rn(Yd);if(!ob&&Td.EwaSettings.isChangeGateEnabled("OfficeVSO:5767424_EnablePauseProtectionInViewMode")){var lh=this.$.xa.oa;(null===
(qc=Qe.D(lh.v1))||void 0===qc?0:qc.contains(Yd))?ob=Qe.D(lh.v1):jc.ULS.sendTraceTag(527700033,0,15,"TableCommandHandler.executeCommand: unknown sort range; unable to check for protected ranges")}if(!this.$.isEditMode){if(!Td.EwaSettings.isChangeGateEnabled("OfficeVSO:5767424_EnablePauseProtectionInViewMode")||ob&&!this.$.wZc([ob],!0,1))break}else if(ob&&!this.$.Br([ob],!0,1))break}sd=function(Yi,jh,bh){return $h.ib(Bb,ki,df,Ah.b(Yi,Kb.mYi),jh,bh,Yd,Xf)};Vd=177;vg=function(){return new Ca(ki,df)};
break;case 341449783:case 2128797448:this.GSa=341449783===bf?0:2;qc=this.toggleTableStyleOption(Bb,Xf);sd=qc.ukg;Vd=qc.operationName;vg=qc.Bk;break;case -712419744:this.ty?this.iff(ob[fe.a.event]):this.iff(null);break;case 1868184698:Td.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TablesReactDialog",!1)?new Gi.a(this.$):(qc=new Bf.a(this.$),qc.initialize(),qc.pf());break;case 844144422:new Nb(this.$);break;case 1544516694:case -544558380:if(qc=ob[Hb.a.od])this.GSa=this.K3h(qc),-1!==this.GSa&&
(qc=this.toggleTableStyleOption(Bb,Xf),sd=qc.ukg,Vd=qc.operationName,vg=qc.Bk);break;case 756677940:if(this.qNa()&&this.Vjf()){jc.ULS.sendTraceTag(537151177,0,15,"TableCommandHandler.RenameTable: current table object and previous selected table object both found to be null while executing rename command");break}var Oj=ob.Text,ig=this.iXh();if(ig){sd=function(Yi,jh,bh){return Qg.i(Bb,Oj,ig,Ah.b(Yi,Kb.lYi),Ah.a(jh,Kb.kYi),bh,Xf)};Vd=217;var pj=null;this.tableManager.Ig?pj=this.tableManager.Ig.name:
this.tableManager.oId?pj=this.tableManager.oId.name:jc.ULS.sendTraceTag(537151176,0,15,"TableCommandHandler.RenameTable: current table object and previous selected table object both found to be null while fetching oldName during executing rename command");pj&&(vg=function(){return new Wc(pj,Oj)})}else return jc.ULS.sendTraceTag(537151175,0,10,"TableCommandHandler.RenameTable: Selected Table Range is null"),Dc.Task.Sa(!1);break;case 323142015:if(this.qNa())break;return(new tb(this.$,this.Wfd(),this.tableManager.Ig.name)).ebb();
case -1400250766:Vd=211;sd=this.lmj(ob,Bb,Xf);var qj=Qe.m(ob.OriginalTableRange,this.$.xa.oa);vg=function(){return new Tb(qj)};break;case 1872288872:this.tableManager.K8i();break;case -123538519:var fi=this.J3h(ob);qc=Of.a.contains(ob[Hb.a.od],fe.a.LHb,!0)||Of.a.contains(ob[fe.a.hJ],"TableStyleIcon",!0)?"Preview Gallery":"Pop-out Gallery";jc.ULS.sendTraceTag(51181323,0,50,"TableStyleManager.ApplyTableStyleWebInvocation - Apply Table Style Invoked from {0} with style index {1}",qc,fi.toString());var hg=
this.B6e();hg&&(sd=function(Yi,jh,bh){return Qg.b(Bb,hg,fi,Yi,jh,bh,null,Xf)},vg=function(){return new ma(hg,fi)},Vd=212);break;case 753331043:qc=ob[Hb.a.od];if(!qc)break;var Wh=Number.parseInvariant(qc);if(this.va.ZK()){jc.ULS.sendTraceTag(51181321,0,50,"TableCommandHandler.FormatAsTable invoked on existing table with style index: {0}",Wh);var vi=this.B6e();vi&&(sd=function(Yi,jh,bh){return Qg.g(Bb,vi,!1,!1,!1,Wh,Yi,jh,bh,null,Xf)},vg=function(){return new ua(vi,!1,Wh,!1)},Vd=215)}else jc.ULS.sendTraceTag(51181322,
0,50,"TableCommandHandler.FormatAsTable invoked on newly created table with style index: {0}",Wh),Td.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TablesReactDialog",!1)?new nc(this.$,Number.parseInvariant(qc)):(qc=new Ha(this.$,Number.parseInvariant(qc)),qc.initialize(),qc.pf());break;case 71074531:var Si=ob.HasHeader,Nf=ob.TableRange;sd=function(Yi,jh,bh){return Qg.e(Bb,Nf,Si,!1,!1,Yi,jh,bh,null)};vg=function(){return new Zg.a(Si,Nf)};Vd=206;break;case -723113214:new Hc(this.$);break;
case 868579142:jc.ULS.sendTraceTag(526463700,0,50,"AltText on table changed.");Vd=1022;var ri=ob.Title,Tj=ob.Description,Jh=this.Wfd();sd=function(Yi,jh,bh){return Qg.f(Bb,ri,Tj,Jh,Yi,jh,bh,null)};if(this.tableManager.Ig){lh=Of.a.Qh(this.tableManager.Ig.oUa)?"":this.tableManager.Ig.oUa;var Ui=Of.a.Qh(this.tableManager.Ig.pUa)?"":this.tableManager.Ig.pUa}vg=ri==lh?function(){return new T(Jh,void 0,Tj)}:Tj==Ui?function(){return new T(Jh,ri,void 0)}:function(){return new T(Jh,ri,Tj)};break;default:return zg.a(bf)}if(sd){var Kh=
function(Yi){return new li.a(Vd,0,Yi,void 0,vg)};W=!this.namedSheetViewPublic||-2058042992!==bf&&504133448!==bf&&-798968736!==bf&&477776686!==bf?Dg.a(this.$.userOperationManager,sd,Kh,ta):this.namedSheetViewPublic.TBa().continueWith(function(Yi){Yi.result&&Dg.a(Kb.$.userOperationManager,sd,Kh,ta)})}return W};Cc.prototype.toggleTableStyleOption=function(W,ta){var ob=this,Kb=this.va.$Ma();jc.ULS.sendTraceTag(41996800,0,50,"TableCommandHandler: The selected {0} style option {1} was toggled.",Kb?"PivotTable":
"table",this.GSa);var qc=this.Wfd();return{ukg:function(Bb,sd,Vd){return Qg.k(W,qc,ob.GSa,Ah.b(Bb,ob.UYi),sd,Vd,null,ta)},operationName:196,Bk:function(){return new Eb(qc,ob.GSa,Kb)}}};Cc.prototype.lmj=function(W,ta,ob){function Kb(bf){bf.Errors&&Bb.tableManager.xbg(sd)}function qc(){Bb.tableManager.xbg(sd)}var Bb=this,sd=W.OriginalTableRange,Vd=Qe.m(W.ResizeTableRange,this.$.xa.oa);return function(bf,Xf,vg){return Qg.j(ta,Vd,Ah.b(bf,Kb),Ah.a(Xf,qc),vg,null,ob)}};Cc.prototype.J3h=function(W){var ta=
-1;W[Hb.a.od]&&(ta=W[Hb.a.od],ta=Of.a.contains(ta,fe.a.LHb,!0)?this.tableStyleManager.nxb(ta):Number.parseInvariant(W[Hb.a.od]));return ta};Cc.prototype.Mc=function(W,ta){W=!1;switch(ta.command){case -2058042992:case 504133448:case -798968736:case 477776686:case 341449783:case 2128797448:case -712419744:case 1868184698:case 1872288872:case 323142015:case 1544516694:case -544558380:case -1400250766:case -123538519:case 753331043:case 844144422:case 71074531:W=!0;break;case 756677940:W=Td.EwaSettings.ma(414);
break;case -723113214:case 868579142:W=Td.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableMissingContextMenuOptions",!1)}return W};Cc.prototype.nd=function(W,ta,ob){W=!1;switch(ta){case "PopulateTableMoreStylesMenu":this.menuId=ob.MenuId;this.tableStyleManager.mkc()||this.tableStyleManager.MLa("formatAsTableMenu");W=this.tableStyleManager.ILf(ta,ob);break;case "PopulateTableAccessibleStylesMenu":this.menuId=ob.MenuId,this.tableStyleManager.mkc()||this.tableStyleManager.MLa("accessibilityTab"),
W=this.tableStyleManager.ILf(ta,ob)}return W};Cc.prototype.dispose=function(){this.tableStyleManager.Yhj(this.OHf)};Cc.prototype.Vda=function(){(Of.a.contains(this.menuId,"Format",!0)||Of.a.contains(this.menuId,"Accessible",!0))&&this.menuId&&this.frame.Vv(this.menuId)};Cc.prototype.Wfd=function(){return Qe.v(this.va.activeCell,this.$)};Cc.prototype.iXh=function(){var W=this.tableManager.wvd;return W?Qe.v(W,this.$):null};Cc.prototype.iff=function(W){if(this.tableManager){var ta=Ke.g(this.$),ob=this.va.activeCell,
Kb=this.tableManager.rn(ob),qc=null;if(!Kb||Kb.RTa)for(ta=Cl(ta.a4),Kb=ta.next();!Kb.done;Kb=ta.next()){Kb=Cl(Kb.value);for(var Bb=Kb.next();!Bb.done;Bb=Kb.next()){Bb=Bb.value;var sd=Bb.Sn;ob.left>=sd[0]&&ob.left<=sd[sd.length-1]&&(qc=(Bb=Bb.xt(ob).EK())?ef.DOMElementExtensions.Ij(Bb,Fe.a.Yse):null)}}else{var Vd=ta.rc(nf.Range.kd(Kb.top,ob.left));if(this.ty){Rg.a.instance.create(function(){Vd.invoke(8,W)},0,ah.a.rbg,!0,!0);return}qc=Vd.tLa(56).f7a}qc&&Rg.a.instance.create(function(){ef.DOMElementExtensions.phc(qc,
null)},0,ah.a.rbg,!0,!0)}};Cc.prototype.K3h=function(W){W=Number.parseInvariant(W);return-1<W&&8>=W?W:-1};Cc.prototype.qNa=function(){return!this.tableManager.Ig};Cc.prototype.Vjf=function(){return this.tableManager.oId?!1:(jc.ULS.sendTraceTag(537151173,0,15,"TableCommandHandler.IsPreviousSelectedTableObjectNull PreviousSelectedTableObject is null"),!0)};Cc.prototype.Eji=function(){var W=this.va.ZK(),ta=this.va.Wg&&!Ke.g(this.$).Tb.i6(this.va.xd);return W||ta};Cc.prototype.Dji=function(){return this.va.ZK()||
!this.Vjf()};Cc.prototype.M3h=function(W){var ta=[];W=Cl(W);for(var ob=W.next();!ob.done;ob=W.next())if(ob=fh.b(this.$,ob.value),null===ob||void 0===ob?0:ob.length){ob=Cl(ob);for(var Kb=ob.next();!Kb.done;Kb=ob.next())Kb=Kb.value,Kb.usedRange&&!Array.contains(ta,Kb.usedRange)&&Array.add(ta,Kb.usedRange)}return ta};Cc.prototype.B6e=function(){var W=this.va.selectedRanges,ta=[];if(Td.EwaSettings.isChangeGateEnabled("OfficeVSO:3987000_ApplyTableStylesOnMultipleTablesInSingleRange"))ta=this.M3h(W);else{W=
Cl(W);for(var ob=W.next();!ob.done;ob=W.next())ob=ob.value,Ke.g(this.$).Tb.i6(ob)&&Array.add(ta,ob)}return ta&&ta.length?Qe.r(ta,this.$):null};Cc.prototype.tM=function(W){(Td.EwaSettings.isChangeGateEnabled("OfficeVSO:6063473_PTPSDisableLive")?Gh.a.Pla(this.$):Td.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.PivotTableHandRaise",!1))&&Le.TaskExtensions.Ba(ug.GetServiceTaskFactory.Ua(this.$.da,430,431,1),function(ta){ta.result.ifa(W);jc.ULS.sendTraceTag(537151172,306,50,"TableCommandHandler:TriggerPivotTableHandRaise Trigger hand raise from sort.")},
this.$.la,3)};Cc.prototype.Awi=function(W){var ta=this;Le.TaskExtensions.Ba(ug.GetServiceTaskFactory.Ua(this.$.da,446,447,0),function(ob){ob.result.tdh(ta.$,W)},this.$.la,3)};Cc.x1f=function(W,ta){ta.SheetName=W.oa.name;ta.NamedObjectView=W.ea.isNamedObjectViewMode};Object(zc.a)(Cc,"TableCommandHandler",null,[434]);var rh=Ag.a;Am(rc,rh);rc.prototype.dispose=function(){rh.prototype.dispose.call(this)};rc.prototype.Qd=function(){var W=this,ta=ug.GetServiceTaskFactory.create(this.$.da,134,this.la,this.ub),
ob=ug.GetServiceTaskFactory.create(this.$.da,330,this.la,this.ub),Kb=ug.GetServiceTaskFactory.Ua(this.$.da,309,310,this.ub);Le.TaskExtensions.Ba(Dc.Task.WAA(ta,Kb,ob),function(){W.Jd([new Cc(W.$,ta.result,Kb.result,ob.result)],[2128797448,341449783,1544516694,-544558380,-123538519,753331043,756677940])},this.$.la,3)};rc.ka=function(W){Ag.a.je(86,new rc(W))};Object(zc.a)(rc,"TableCommandHandlerFactory",Ag.a,[]);jb.prototype.$c=function(){return!1};jb.prototype.executeCommand=function(W,ta){W=ta.command;
ta=null;switch(W){case 1243860697:this.zmh.mQj();break;default:ta=zg.a(W)}return ta||Dc.Task.Sa(!0)};jb.prototype.Mc=function(W,ta){return 1243860697===ta.command};jb.prototype.nd=function(){return!1};Object(zc.a)(jb,"SheetDropdownMenuCommandHandler",null,[434]);var Ph=Ag.a;Am(Va,Ph);Va.prototype.Qd=function(){var W=this;this.$.gD(function(ta){ta.Ogc().then(function(){Le.TaskExtensions.Ba(ug.GetServiceTaskFactory.Ua(W.$.da,32,33,W.ub),function(ob){W.Jd([new jb(ob.result.QAj)])},W.$.la)})})};Va.ka=
function(W){Ag.a.je(392,new Va(W))};Object(zc.a)(Va,"SheetDropdownMenuCommandHandlerFactory",Ag.a,[]);var Di=b(74),Fg=b(193),$f=b(41),Bg=b(108),uh=b(34);ic.prototype.yOg=function(W,ta){this.aMe.add(W,ta);this.vT()};ic.prototype.vT=function(){var W=this;this.bKc=0;uh.a.forEach(this.aMe.xv,function(ta){W.bKc=W.t9c|ta.value})};uk.Object.defineProperties(ic.prototype,{t9c:{configurable:!0,enumerable:!0,get:function(){return this.bKc}},navigationButtonsDisabled:{configurable:!0,enumerable:!0,get:function(){return!!(this.t9c&
1)}},operationButtonsDisabled:{configurable:!0,enumerable:!0,get:function(){return!!(this.t9c&2)}}});Object(zc.a)(ic,"SheetTabBarDisabledStateManager",null,[]);rb.eyh="ewa-stb-uir";rb.jSe="ewa-stb-drag";rb.Pxh="ewa-stb-navarea";rb.Qxh="ewa-stb-navarea-dimensions";rb.Sxh="ewa-stb-navbutton";rb.SZ="cui-disabled";rb.hja="cui-img-container";rb.Rxh="ewa-stb-navareaextra";rb.Mxh="ewa-stb-contentarea";rb.kSe="ewa-stb-left-scrollable";rb.wSe="ewa-stb-right-scrollable";rb.cyh="ewa-stb-tabarea";rb.byh="ewa-stb-sheettabmoveindicator";
rb.ySe="ewa-stb-tabs";rb.ZMj="tab-active";rb.fNj="tab-inactive";rb.eNj="tab-hover";rb.dyh="ewa-stb-tabs-ghost";rb.aNj="tab-anchor-text";rb.dark="dark";rb.light="light";rb.$Mj="tab-active-text";rb.cNj="tab-content-container";rb.hNj="tab-text";rb.Vxh="ewa-stb-nsv-inactive";rb.Wxh="ewa-stb-nsv-inactive-svg";rb.Txh="ewa-stb-nsv-active";rb.Uxh="ewa-stb-nsv-active-svg";rb.zwh="ewa_nsv_margin";rb.Nxh="ewa-stb-disable-scrollbar";rb.Mwi="leave-size-fixed-on-tab-hover-old";rb.Lwi="leave-size-fixed-on-tab-hover";
rb.oSe="ewa-stb-locked-sheet";rb.pSe="ewa-stb-locked-sheet-svg";rb.qSe="ewa-stb-locked-sheet-svg-16px";rb.Oxh="ewa-stb-dropdown-menu-button";rb.brh="ewa-active-sheet-menu-item";Object(zc.a)(rb,"CssClassNames",null,[]);var ei=b(562),cg=b(17),Gf=b(269),Zf=b(101),eh=b(561),wh=b(294),Yg=b(328),k=b(98),Ab=b(358),oc=b(249),R=b(389),Ba=b(385),d=b(226),x=b(85),M=be.a;Am(Ta,M);Ta.prototype.dispose=function(){this.tbb=this.Fta=this.$=null;M.prototype.dispose.call(this)};Ta.prototype.kY=function(W){this.IY=
W;this.domElement.setAttribute(fe.a.aia,W.toString());ef.DOMElementExtensions.toggleCssClass(this.domElement,ei.a.SZ,W)};uk.Object.defineProperties(Ta.prototype,{disabled:{configurable:!0,enumerable:!0,get:function(){return this.IY}}});Object(zc.a)(Ta,"SheetBarButton",be.a,[]);var V=b(921);Am(pc,Ta);pc.prototype.dispose=function(){d.a.instance.za(Sd.a.click,this.domElement,this.dd);Bg.KeyInputManager.instance.Tv(this.domElement,this.oOa);Td.EwaSettings.isChangeGateEnabled("OfficeVSO:4227145_InEditingDisableInsertSheetButton")&&
Ke.g(this.$)&&Ke.g(this.$).Ac&&(Ke.g(this.$).Ac.$k(this.mj),Ke.g(this.$).Ac.Zn(this.Rg));Ta.prototype.dispose.call(this)};pc.prototype.kY=function(W){var ta=pc.i6f(this.$);Ta.prototype.kY.call(this,W||ta)};pc.i6f=function(W){return!W.isEditMode||!W.xa.count};Object(zc.a)(pc,"InsertSheetButton",Ta,[]);Am(yb,Ta);yb.prototype.dispose=function(){d.a.instance.za(Sd.a.click,this.domElement,this.dd);Bg.KeyInputManager.instance.Tv(this.domElement,this.oOa);this.Xye=null;Ta.prototype.dispose.call(this)};Object(zc.a)(yb,
"InsertTemplateButton",Ta,[]);lb.prototype.getSheetName=function(){return this.sheetName};Object(zc.a)(lb,"MacroRecorderSheetReorderedPayload",null,[428]);var ca=be.a;Am(Cb,ca);Cb.prototype.dispose=function(){this.wm();ca.prototype.dispose.call(this)};Cb.prototype.mQj=function(){this.GVf(!0,"TogglerSheetDropdownMenu")};Cb.prototype.GVf=function(W,ta){jc.ULS.sendTraceTag(537153795,0,50,"SheetDropdownMenu.RenderSheetMenuInternal: render start. caller: {0}, toggle: {1}, toggleStateId: {2}",ta,W,this.OOb);
W&&(this.OOb+=1);var ob=this.$.Sb.Hc("UserAction",String.format("SheetDropdownMenu.RenderSheetMenuInternal: caller: {0}, toggle: {1}, toggleStateId: {2}, sheetCount: {3}",ta,W,this.OOb,this.$.xa.count));W=this.idh();appChrome.renderSheetDropdownMenu(this.domElement,this.FNj,W,this.OOb,this.VOi,this.UOi,function(){ob.stop()},R.a(this.$))};Cb.prototype.idh=function(){for(var W=this.$.xa,ta=[],ob=0;ob<W.count;ob++){var Kb=Object(Gc.a)(k.a,W.getItem(ob));0===Kb.Vy&&(Kb=this.hdh(Kb),ta.push(Kb))}return ta};
Cb.prototype.hdh=function(W){var ta={};ta.key=W.name;ta.text=W.name;ta.onClick=this.jdh(W);W.active&&(ta.className=R.a(this.$)?"ewa-active-sheet-menu-item-present-mode":rb.brh);return ta};Cb.prototype.jdh=function(W){var ta=this;return function(){var ob=new Zh.a(-1876836819,0,ta.$.jd,30,null),Kb={};ta.$.Ka.dc(ob,(Kb[fe.a.xTd]=W.name,Kb))}};Cb.prototype.Ik=function(){if(!this.RV){var W=this.$.xa;W.Nf(this.HS);W.O_b(this.HS);W.nZ(this.HS);W.Oha(this.HS);W.JGa(this.HS);W.sre(this.HS);W.f_a(this.HS);
this.RV=!0}};Cb.prototype.wm=function(){if(this.RV){var W=this.$.xa;W.Ag(this.HS);W.Muc(this.HS);W.O7(this.HS);W.Xna(this.HS);W.ORa(this.HS);W.CUf(this.HS);W.pJb(this.HS);this.RV=!1}};Object(zc.a)(Cb,"SheetDropdownMenu",be.a,[981,3]);var Oa=b(369);Am(wc,Ta);wc.prototype.dispose=function(){this.CUj();Ta.prototype.dispose.call(this)};wc.prototype.kY=function(W){Ta.prototype.kY.call(this,W||!this.$.ea.Nxa)};wc.prototype.jdg=function(W){this.disabled||(jc.ULS.sendTraceTag(537153793,0,50,"SheetDropdownMenuAnchor.ToggleMenu: inputMethod: {0}",
Oa.a[W]),this.$.Ka.dc(new Zh.a(1243860697,W,this.$.jd,30,null)))};wc.prototype.rcj=function(){d.a.instance.qa(Sd.a.click,this.domElement,this.dd);Bg.KeyInputManager.instance.qa(Sd.a.Ub,this.domElement,this.onKeyDown)};wc.prototype.CUj=function(){d.a.instance.za(Sd.a.click,this.domElement,this.dd);Bg.KeyInputManager.instance.za(Sd.a.Ub,this.domElement,this.onKeyDown)};Object(zc.a)(wc,"SheetDropdownMenuAnchor",Ta,[]);var Fb=b(201),lc=b(125),Oc=b(58),wd=b(225),Rd=b(170);Rb.prototype.cO=function(){return this.sheet.active};
Rb.prototype.Wrd=function(){return this.sheet.isLockPausedInSession};Rb.prototype.Tta=function(){return this.sm?cg.a.nSe:this.cO()?cg.a.mSe:cg.a.lSe};Rb.prototype.lpa=function(){return this.sheet.zj?V.a.$Nf:Td.EwaSettings.isChangeGateEnabled("OfficeVSO:6104844_NewLockAndPauseSheetTabIcon")?V.a.oUj:V.a.nUj};Rb.prototype.LXd=function(){return Td.EwaSettings.isChangeGateEnabled("OfficeVSO:6104844_NewLockAndPauseSheetTabIcon")?16:13};Rb.prototype.NXd=function(){return Td.EwaSettings.isChangeGateEnabled("OfficeVSO:6104844_NewLockAndPauseSheetTabIcon")?
16:12};Rb.prototype.Fia=function(){return null};Rb.prototype.Uta=function(){return this.sm?this.Uw?Td.EwaSettings.isChangeGateEnabled("OfficeVSO:6104844_NewLockAndPauseSheetTabIcon")?rb.qSe:rb.pSe:rb.oSe:null};Rb.prototype.nZd=function(){return null};Rb.prototype.Sv=function(){return null};Rb.prototype.hod=function(){return 0};Rb.prototype.bZc=function(){return!0};Object(zc.a)(Rb,"LockPausedSheetIconDataSource",null,[992]);ib.prototype.cO=function(){return this.sheet.active};ib.prototype.Wrd=function(){return this.sheet.zj};
ib.prototype.Tta=function(){return this.sm?cg.a.nSe:this.cO()?cg.a.mSe:cg.a.lSe};ib.prototype.lpa=function(){return V.a.$Nf};ib.prototype.LXd=function(){return Td.EwaSettings.isChangeGateEnabled("OfficeVSO:6104844_NewLockAndPauseSheetTabIcon")?16:13};ib.prototype.NXd=function(){return Td.EwaSettings.isChangeGateEnabled("OfficeVSO:6104844_NewLockAndPauseSheetTabIcon")?16:12};ib.prototype.Fia=function(){return null};ib.prototype.Uta=function(){return this.sm?this.Uw?Td.EwaSettings.isChangeGateEnabled("OfficeVSO:6104844_NewLockAndPauseSheetTabIcon")?
rb.qSe:rb.pSe:rb.oSe:null};ib.prototype.nZd=function(){return null};ib.prototype.Sv=function(){return null};ib.prototype.hod=function(){return 0};ib.prototype.bZc=function(){return!0};Object(zc.a)(ib,"LockedSheetIconDataSource",null,[992]);Da.prototype.cO=function(){return this.sheet.active};Da.prototype.Wrd=function(){return this.sheet.Yd.vy};Da.prototype.Fia=function(){return this.Uw?this.cO()?rb.Uxh:rb.Wxh:this.cO()?rb.Txh:rb.Vxh};Da.prototype.Tta=function(){return!this.cO()&&this.c7f()?cg.a.Vzh:
cg.a.Uzh};Da.prototype.lpa=function(){return!this.cO()&&this.c7f()?V.a.$Aj:V.a.ZAj};Da.prototype.LXd=function(){return 14};Da.prototype.NXd=function(){return 16};Da.prototype.Uta=function(){return rb.zwh};Da.prototype.nZd=function(){return this.sheet.Yd.Bob};Da.prototype.Sv=function(){return this.DQj};Da.prototype.hod=function(){return 8};Da.prototype.bZc=function(){return!1};Object(zc.a)(Da,"NamedSeetViewSheetIconDataSource",null,[992]);Ja.prototype.phg=function(){if(this.iJ&&(this.ik||this.fCa)){if(this.Uw){var W=
this.dataSource.lpa();this.lpa!==W&&(this.fCa&&this.fCa.parentNode.removeChild(this.fCa),this.xef(),this.lpa=W)}else W=this.dataSource.Tta(),this.Tta!==W&&(this.mNd(this.ik,this.Tta,W),this.Tta=W);W=this.dataSource.Fia();this.Fia!==W&&(this.Uw?this.sjj(this.fCa,this.Fia,W):this.mNd(this.ik,this.Fia,W),this.Fia=W);W=this.dataSource.Uta();this.Uta!==W&&(this.mNd(this.iJ,this.Uta,W),this.Uta=W);this.dataSource.Sv()&&!this.dataSource.cO()&&this.clearToolTip()}};Ja.prototype.EFj=function(W,ta,ob){this.Egi(W,
ta,ob);ef.DOMElementExtensions.setVisible(this.iJ,this.dataSource.Wrd())};Ja.prototype.clearToolTip=function(){var W=this;Le.TaskExtensions.Ba(this.nDb,function(){dialogControls.clearToolTip(W.dataSource.Sv())},this.$.la,3)};Ja.prototype.Egi=function(W,ta,ob){this.iJ&&this.Ujf!==W&&(this.iJ.parentNode.removeChild(this.iJ),this.Uta=this.Fia=this.lpa=this.Tta=this.VTc=null,this.dataSource.Sv()&&(this.xc.detach("mouseover",!0),this.xc.detach("mouseout",!0)));this.iJ||(this.VTc=document.createElement("span"),
Sys.UI.DomElement.addCssClass(this.iJ,ei.a.hja),Sys.UI.DomElement.addCssClass(this.iJ,cg.a.Dr),Td.EwaSettings.ma(516)?W===this.dataSource.bZc()?ta.appendChild(this.iJ):ta.insertBefore(this.iJ,ob):W?ta.insertBefore(this.iJ,ob):ta.appendChild(this.iJ),this.Uw?this.xef():(this.ik=document.createElement("img"),this.ik.tabIndex=-1,this.ik.alt=this.dataSource.altText,this.iJ.appendChild(this.ik),this.ik.src=bd.a.Ge(this.dataSource.hod())),this.dataSource.Sv()&&(this.xc.ka("mouseover",this.iG,!0),this.xc.ka("mouseout",
this.GI,!0)),this.Ujf=W)};Ja.prototype.sjj=function(W,ta,ob){W&&(Sys.UI.DomElement.removeCssClass(W,ta),Sys.UI.DomElement.addCssClass(W,ob))};Ja.prototype.mNd=function(W,ta,ob){ta&&Sys.UI.DomElement.removeCssClass(W,ta);ob&&Sys.UI.DomElement.addCssClass(W,ob)};Ja.prototype.dispose=function(){$g.a.Fa(this.y2)};Ja.prototype.xef=function(){var W=this.$.da.Aa(388);W?(this.fCa=W.Owa(this.dataSource.lpa(),this.dataSource.LXd(),this.dataSource.NXd()))?this.iJ.appendChild(this.fCa):jc.ULS.shipAssertTag(537153763,
0,!1,"Sheeticon.InsertCurrentSvgIcon: Svg with id {0} was not found.",this.dataSource.lpa()):jc.ULS.shipAssertTag(537153792,0,!1,"Sheeticon.InsertCurrentSvgIcon: Unable to recieve SvgIconProvider service.")};uk.Object.defineProperties(Ja.prototype,{xc:{configurable:!0,enumerable:!0,get:function(){return this.y2||(this.y2=Se.a.instance.Gd(this.iJ))}},nDb:{configurable:!0,enumerable:!0,get:function(){var W=this;if(this.Dra)return this.Dra;var ta=new $c.a;this.$.gD(function(ob){Le.TaskExtensions.Ba(ob.Iwd(),
function(){ta.setResult(!0)},W.$.la,3)});return this.Dra=ta.task}},iJ:{configurable:!0,enumerable:!0,get:function(){return this.VTc}}});Object(zc.a)(Ja,"SheetIcon",null,[3]);var Oe=b(367),la=b(157),$a=mf.a;Am(pa,$a);pa.prototype.dispose=function(){this.Qoa&&(d.a.instance.za(Sd.a.qk,this.Qoa.domElement,this.gda),Oe.a.instance.za(this.Qoa.domElement,this.nl),this.Bke=null);this.$=null;$a.prototype.dispose.call(this)};pa.prototype.showContextMenu=function(W,ta,ob){this.Qoa.activate(ta,Gh.a.lud());ta=
new Zh.a(-1075099431,ta,this.$.jd,30,null);var Kb,qc={};return!la.a(Kb=this.$.Ka.dc(ta,(qc[fe.a.G5f]=W,qc[pa.RAj]=this.Qoa.sheet,qc[fe.a.H5f]=ob,qc)))&&(6!==Kb.status||Kb.result)};pa.prototype.rename=function(W,ta){this.$.ae(817296323,ta,W?19:0,null)};uk.Object.defineProperties(pa.prototype,{Qoa:{configurable:!0,enumerable:!0,get:function(){return this.Bke}}});pa.RAj="Sheet";Object(zc.a)(pa,"SheetOpsSheetClickHelper",mf.a,[]);Am(nb,Ta);nb.prototype.ZUh=function(){return ef.DOMElementExtensions.canReceiveFocus(this.anchor)?
this.anchor:null};nb.prototype.dispose=function(){if(this.RV){Pf.a.instance.za(Sd.a.pointerDown,this.domElement,this.onPointerDown);Bg.KeyInputManager.instance.za(Sd.a.Ub,this.domElement,this.onKeyDown);Bg.KeyInputManager.instance.za(Sd.a.Cp,this.domElement,this.Zz);d.a.instance.za(Sd.a.click,this.domElement,this.dd);Pf.a.instance.za(Sd.a.rX,this.domElement,this.Jza);Pf.a.instance.za(Sd.a.Ky,this.domElement,this.Kza);if(this.p8a||Td.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CoauthWorkbookProtectionSupport",
!1))Pf.a.instance.za(Sd.a.$d,this.domElement,this.Sf),this.lya&&(Mf.a.instance.za(Sd.a.Ce,this.domElement,this.Sf),Mf.a.instance.za(Sd.a.Dg,this.domElement,this.IO));this.RV=!1;this.k7b="#BEBBB8"}$g.a.tc([this.XCe,this.dye]);this.AP=this.iF=this.kHc=this.kT=this.dye=this.XCe=null;if(this.Noa){for(var W=Cl(this.Noa),ta=W.next();!ta.done;ta=W.next())ta.value.dispose();this.Noa=null}this.color=this.ZXb=null;Ta.prototype.dispose.call(this)};nb.prototype.kY=function(W){W&&this.Ioa(!1,!1);Ta.prototype.kY.call(this,
W)};nb.prototype.fVd=function(W){if(Oc.a.vg.iS){this.jMe();var ta=ug.GetServiceTaskFactory.Ua(this.$.da,322,323,1);Le.TaskExtensions.Ba(ta,function(ob){Fb.UISurfaces.hW().then(function(Kb){var qc=ob.result;qc.Swj(Kb);qc.show(W);return null},function(Kb){jc.ULS.sendTraceTag(537153688,0,15,"SheetTabButton.ShowNamedSheetViewTeachingUI: Failed to GetNotificationsAPIAsync: {0}",Kb);return null})},this.la,3)}};nb.prototype.aqe=function(){var W=this;if(this.sheet.active&&this.$.zr){var ta=this.$.zr,ob=Ke.g(this.$),
Kb=ob.Sw;if(this.sheet.Yd.vy){if(!this.uEb){var qc=new Da(this.sheet,this.kT.Zyc,function(){return W.color?nb.BUd(W.color):!1},this.Uw);this.uEb=new Ja(this.$,qc);this.Noa.add(this.uEb)}Kb?ob.Igb(1):ta.classList.add(cg.a.ccd);ta=nb.Lid(fe.a.xvf);ob=nb.Lid(fe.a.uAd);Kb=nb.Lid(fe.a.ovf);qc=this.sheet.Yd.mUd;this.sheet.Yd.mUd=!1;"true"===Kb&&qc&&this.$.ea.qUd?(lc.a.Mv(fe.a.ovf,"false",lc.a.XW),this.$.ea.qUd=!1,this.fVd(3)):"true"===ta&&"true"===ob&&"true"===Kb?this.$.ea.rUd&&this.$.ea.MMb&&(this.sheet.Yd.fL?
(ta=1,lc.a.Mv(fe.a.uAd,"false",lc.a.XW),this.$.ea.MMb=!1):ta=0,lc.a.Mv(fe.a.xvf,"false",lc.a.XW),this.$.ea.rUd=!1,this.fVd(ta)):this.sheet.Yd.fL&&"true"===ob&&"true"===Kb&&this.$.ea.MMb&&(lc.a.Mv(fe.a.uAd,"false",lc.a.XW),this.$.ea.MMb=!1,this.fVd(2))}else this.jMe(),Kb?ob.Igb(0):ta.classList.remove(cg.a.ccd)}};nb.prototype.jMe=function(){if(Td.EwaSettings.isChangeGateEnabled("OfficeVSO:5782706_NSVTC")){var W=this.$.da.Aa(322);W&&W.dismiss()}else this.$.Vtd&&(W=ug.GetServiceTaskFactory.Ua(this.$.da,
322,323,0),Le.TaskExtensions.Ba(W,function(ta){ta.result.dismiss()},this.$.la,3))};nb.prototype.Rgb=function(){this.name=this.sheet.name;this.domElement.className=this.sheet.active||this.c8a()?rb.ZMj:rb.fNj;Td.EwaSettings.isChangeGateEnabled("OfficeVSO:5262355_SheetTabFocusBugFix")?this.AP.parentNode.classList.add(rb.Lwi):this.AP.parentNode.classList.add(rb.Mwi);this.hig();this.Sqd&&this.aqe();this.FFj();this.nig();this.ADc();this.Sqd||this.aqe()};nb.prototype.wXi=function(){this.vTd=!0;this.Ioa(!0,
!0,"OnSheetReorderStarted")};nb.prototype.vXi=function(){this.vTd=!1;this.Ioa(!1,void 0,"OnSheetReorderEnded")};nb.prototype.activate=function(W,ta){W=void 0===W?0:W;ta=void 0===ta?!1:ta;this.V3b()||(this.sheet.activate(),ta&&Ke.g(this.$).focus(),ta={},W=(ta.InputMethod=Oa.a[W],ta.AppMode=this.$.jd,ta.Location="canvas",ta),hh.b(this.$).he(We.a.NAj,W))};nb.prototype.gig=function(W){this.k7b=W?"#797775":"#BEBBB8";this.x7c=W?-.5:.5;this.PJc=W?wd.a.pq("#3B3A39"):wd.a.pq("#F5F5F5");this.nig()};nb.prototype.Vtj=
function(W){this.p8a=W};nb.prototype.XCd=function(W){W.R4c();this.pBe(W)};nb.prototype.pBe=function(W){W.G1a();this.sheet.activate()};nb.prototype.HDg=function(W){W=new Zh.a(-1876836819,W,this.$.jd,30,null);var ta={};return this.$.Ka.dc(W,(ta[fe.a.xTd]=this.sheet.name,ta))};nb.prototype.hig=function(){this.AP.parentNode.setAttribute("sheet-title",this.AP.innerText)};nb.prototype.ADc=function(){var W=this.FOh();this.anchor.setAttribute(fe.a.Zt,W);this.anchor.setAttribute(fe.a.bia,this.sheet.active.toString())};
nb.prototype.FOh=function(){var W=this.sheet.Yd.vy,ta=this.sheet.Yd.Bob,ob=this.sheet.zj,Kb=this.sheet.isLockPausedInSession;return W&&ob?String.format(Ee.a.instance.Bb(20),this.name,ta):W&&Kb?String.format(Ee.a.instance.Bb(22),this.name,ta):W?String.format(Ee.a.instance.Bb(19),this.name,ta):ob?String.format(Ee.a.instance.Bb(18),this.name):Kb?String.format(Ee.a.instance.Bb(21),this.name):this.name};nb.prototype.activateSheet=function(W){W=void 0===W?0:W;if(Gh.a.lud()){if(Td.EwaSettings.isChangeGateEnabled("OfficeVSO:4099273_PromptForCommentsOnSheetChange")&&
this.V3b())return Dc.Task.Sa(!1);Rd.a.current.eT="ActivateSheet";this.sheet.activate();return Dc.Task.Sa(!0)}return this.HDg(W)};nb.prototype.nig=function(){var W=this.sheet.tabColor;this.color=W?wd.a.pq(W):this.Tgh;this.Nif=nb.BUd(this.color);this.Ioa(!1,void 0,"UpdateTabColor")};nb.prototype.Ioa=function(W,ta,ob){ta=void 0===ta?!1:ta;ob=void 0===ob?null:ob;if(this.sheet){ob=this.sheet.active;var Kb=this.c8a(),qc=!!this.sheet.tabColor,Bb=wd.a.NG(ob||Kb?Nh.a.white:this.color);this.iF.style.background=
"";ob||Kb?(qc?Td.EwaSettings.isChangeGateEnabled("OfficeVSO:5293663_SheetTabHighContrastBackgroundBug")&&this.$.tMa?this.Lyj():this.sm?this.Kyj():this.Jyj():this.sm||(this.iF.style.backgroundColor=Bb),this.iF.style.height=this.c4c.toString()+"px"):(this.iF.style.filter="",this.iF.style.backgroundColor=Bb,this.iF.style.height=this.d4c.toString()+"px");this.AP.className=ob?rb.$Mj:Kb?rb.dark:this.Nif?rb.light:rb.dark;Bb=Cl(this.Noa);for(var sd=Bb.next();!sd.done;sd=Bb.next())sd.value.phg();this.sm&&
(W&&!qc&&(this.iF.style.backgroundColor="#E1DFDD"),ef.DOMElementExtensions.toggleCssClass(this.domElement,rb.eNj,W),ta?(qc||(this.iF.style.backgroundColor=this.k7b),this.domElement.style.backgroundColor=this.k7b):(qc||(this.iF.style.backgroundColor=""),this.domElement.style.backgroundColor=""));this.AP.style.fontWeight=ob||Kb||!this.sm&&W?this.sm?"600":"bold":""}else jc.ULS.sendTraceTag(537153687,0,15,"SheetTabButton.SetTabColors: can't change colors to a sheet tab without sheet, whihc means its not rendered. caller: {0}",
ob)};nb.prototype.Kyj=function(){var W=this.iF.style,ta=wd.a.NG(nb.n2c(this.color,this.x7c));W.background=ta};nb.prototype.Jyj=function(){var W=this.iF.style,ta=wd.a.NG(nb.n2c(this.color,1)),ob=wd.a.NG(nb.n2c(this.color,this.x7c)),Kb="";if(rf.a.ama)Kb="-webkit-";else if(rf.a.Hf)Kb="-moz-";else if(rf.a.uf){if(Kb="-ms-",!rf.a.R7a){W.filter=String.format("progid:DXImageTransform.Microsoft.gradient(startColorstr={0}, endColorstr={1})",ta,ob);return}}else rf.a.xjf&&(Kb="-o-");W.background=String.format("{0}linear-gradient({1}, {2})",
Kb,ta,ob)};nb.prototype.Lyj=function(){this.iF.style.background="transparent"};nb.prototype.s8g=function(){this.kHc=document.createElement("a");this.anchor.removeAttribute("Href");this.anchor.className=rb.aNj;ef.DOMElementExtensions.Rs(this.anchor,fe.a.Wpb,null,null);this.tabIndex=-1};nb.prototype.udh=function(){this.iF=document.createElement("span");this.iF.className=rb.cNj;this.AP=document.createElement("span");this.AP.className=rb.hNj;this.AP.dir=this.sheet.rtlName?"rtl":"ltr";this.iF.appendChild(this.AP)};
nb.prototype.FFj=function(){for(var W=this.$.UJ,ta=Cl(this.Noa),ob=ta.next();!ob.done;ob=ta.next())ob.value.EFj(W,this.iF,this.AP)};nb.prototype.c8a=function(){return Ke.g(this.$).c8a(this.sheet)};nb.prototype.kKj=function(){this.Knd.start();this.Vrd=!0};nb.prototype.ZOe=function(W){if(this.Vrd){this.Knd.stop();var ta={};W=(ta["Sheet index"]=this.sheet.index,ta["Active Sheet"]=this.sheet.active,ta["Hovering time"]=this.Knd.Gc,ta["Has been clicked"]=W,ta);jc.ULS.sendTraceTag(537153686,0,50,qe.c(W));
this.Vrd=!1}};nb.prototype.Edj=function(){Pf.a.instance.qa(Sd.a.pointerDown,this.domElement,this.onPointerDown);Bg.KeyInputManager.instance.qa(Sd.a.Ub,this.domElement,this.onKeyDown);Bg.KeyInputManager.instance.qa(Sd.a.Cp,this.domElement,this.Zz);this.xc.ka("mouseover",this.iG);this.xc.ka("mouseout",this.GI);Pf.a.instance.qa(Sd.a.rX,this.domElement,this.Jza);Pf.a.instance.qa(Sd.a.Ky,this.domElement,this.Kza);if(this.p8a||Td.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CoauthWorkbookProtectionSupport",
!1))Pf.a.instance.qa(Sd.a.$d,this.domElement,this.Sf),this.lya&&(Mf.a.instance.qa(Sd.a.Ce,this.domElement,this.Sf),Mf.a.instance.qa(Sd.a.Dg,this.domElement,this.IO));d.a.instance.qa(Sd.a.click,this.domElement,this.dd);this.RV=!0};nb.prototype.V3b=function(){var W=this.$.da.Aa(65);return W&&W.eca()?(W.EKb(),this.pBe(W),!0):!1};nb.Lid=function(W){var ta=lc.a.get(W);ta||(lc.a.Mv(W,"true",lc.a.XW),ta=lc.a.get(W));return ta};nb.n2c=function(W,ta){if(1<ta||-1>ta)return W;var ob=W.r,Kb=W.g;W=W.b;0<ta?(ob=
ob*(1-ta)+255*ta,Kb=Kb*(1-ta)+255*ta,W=W*(1-ta)+255*ta):(ob*=1+ta,Kb*=1+ta,W*=1+ta);return Nh.a.iwb(Math.round(ob),Math.round(Kb),Math.round(W))};nb.BUd=function(W){return 128>=(222*W.r+707*W.g+71*W.b)/1E3};uk.Object.defineProperties(nb.prototype,{Tgh:{configurable:!0,enumerable:!0,get:function(){return this.PJc||(this.PJc=wd.a.pq("#F5F5F5"))}},name:{configurable:!0,enumerable:!0,get:function(){return this.AP.innerText},set:function(W){this.AP&&(this.AP.innerText=W,this.ADc(),this.hig())}},sheet:{configurable:!0,
enumerable:!0,get:function(){return this.ZXb}},anchor:{configurable:!0,enumerable:!0,get:function(){return this.kHc}},tabIndex:{configurable:!0,enumerable:!0,get:function(){return this.anchor.tabIndex},set:function(W){this.anchor.tabIndex=W}}});Object(zc.a)(nb,"SheetTabButton",Ta,[]);Am(zb,Ta);Object(zc.a)(zb,"WorkbookProtectionButton",Ta,[]);var Yb=b(49),Jc=b(44),td=b(56),Tc=be.a;Am(gb,Tc);gb.prototype.Cb=function(W,ta,ob,Kb,qc,Bb,sd){sd=void 0===sd?!1:sd;W.removeAttribute("Href");W.setAttribute(fe.a.Vd,
fe.a.ks);W.className=rb.Sxh;W.title=ta;W.tabIndex=0;this.Uw&&Bb?ob=this.svgIconProvider.Zba(Bb,12,12,W,24,24):(ta=document.createElement("span"),ta.className=this.sm?cg.a.g2g:cg.a.Dr,ta.classList.add(ei.a.hja),ta.tabIndex=-1,W.appendChild(ta),Bb=document.createElement("img"),Bb.src=bd.a.Ge(ob),Bb.className=Kb,Bb.alt=qc,Bb.tabIndex=-1,ta.appendChild(Bb),ob=Bb);sd&&W.classList.add(ei.a.SZ);return ob};gb.prototype.dispose=function(){if(this.$){var W=this.$.xa;W.Ag(this.li);W.Muc(this.Y6);W.O7(this.zD);
W.Xna(this.oGb);W.ORa(this.Tza);W.CUf(this.hHf);W.pJb(this.jHf);W.Vgj(this.iHf);W.wMd(this.Sxf);W.zUf(this.Txf);W.AUf(this.Uxf);W.BUf(this.$Pa);this.$.Bl(this.vd);this.$.UD(this.lj);Ih.a(this.$)&&Ih.a(this.$).yg.Yna(this.jG);this.Sua&&Ke.g(this.$).dUf(this.oFb);Fg.a.instance.za(Sd.a.tD,this.domElement,this.d7)}$g.a.tc(this.EAd);this.EAd=null;if(this.xL)for(W=0;W<this.xL.length;W++){var ta=ef.DOMElementExtensions.EK(this.xL[W],this.domElement,!1,"a");ta&&$f.a.Tna(ta)}$g.a.Fa(this.AC);$g.a.Fa(this.czc);
$g.a.Fa(this.BTd);this.BTd=this.czc=this.Szb=this.fI=this.AC=null;this.$&&this.Pz&&this.tR(!1);this.Qaa=null;this.GRd(null,"Dispose");this.cOb=this.sN=this.d9b=null;this.p3c();this.Aeb=this.dzc=this.CTd=this.cl=this.xL=this.$=this.ea=null;Tc.prototype.dispose.call(this)};gb.prototype.Qe=function(W,ta){if(!ta){jc.ULS.shipAssertTag(537153760,0,0<this.Eh.length,"There is no sheet tab button.");if(!this.Eh.length)return!1;W=null;for(var ob=Cl(this.Eh),Kb=ob.next();!Kb.done&&!(W=Kb.value.ZUh());Kb=ob.next());
if(!W)return jc.ULS.shipAssertTag(537153759,0,!1,"There is no focusable tab element."),!1;ef.DOMElementExtensions.setFocus(W)}return!ta};gb.prototype.eg=function(W){return ef.DOMElementExtensions.Se(this.Kb,W)};gb.prototype.ji=function(){};gb.prototype.Xh=function(){};gb.prototype.reorderSheets=function(W,ta,ob){if(this.s0&&this.s0!==W){var Kb=this.s0.index;this.ijj(this.s0,W,ta);W=W?W.index-1:ta?this.$.xa.count-1:0;Kb!==W&&(this.RAi(Kb,W,ob),this.zph(this.s0.name,W))}};gb.prototype.F5h=function(W){W=
this.Vja(W);return-1!==W&&this.jv<=W&&W<=this.hL?this.Eh[W].domElement:null};gb.prototype.JYj=function(W){if(this.Uw){for(var ta=0;ta<this.xL.length;ta++){var ob=this.xL[ta];if(ob&&this.svgIconProvider){var Kb=ob.parentNode;this.ITf(ob);Kb&&(this.xL[ta]=this.svgIconProvider.Zba(W?this.BMf[ta]:this.FAd[ta],12,12,Kb,24,24))}}for(ta=0;ta<this.Eh.length;ta++)this.Eh[ta].gig(W);this.mTa&&this.mTa.Fta&&this.fig(V.a.u7h,this.mTa,W);this.fI&&this.fI.Fta&&this.fig(V.a.r4g,this.fI,W)}};gb.prototype.fig=function(W,
ta,ob){ta.tbb||(ta.tbb=this.svgIconProvider.Zba(W,12,12,ta.Fta.parentNode,24,24));ta.tbb&&(ef.DOMElementExtensions.setVisible(ta.Fta,!ob),ef.DOMElementExtensions.setVisible(ta.tbb,ob))};gb.prototype.AXi=function(W,ta){var ob=Ke.g(this.$),Kb=ob.inRangePicker,qc=tf.HelperMethods.Km(ta);if(ob.isEditing&&!Kb){var Bb=ob.yj?"formulaBar_end_edit_sheet_changed":"cell_text_end_edit_sheet_changed",sd=void 0;Td.EwaSettings.Zxa()&&(sd=ob.Ac.textBox.mCa);Td.EwaSettings.iya?oc.b(this.$).MUa(qc.rawEvent,Bb,sd):
oc.b(this.$).NUa(qc.rawEvent,Bb,sd);ob.endEdit(!0,"SheetTabBar.OnSheetTabMouseDown")}ob=this.lya&&3===ta.zb;!(2===ta.zb&&qc.button===Sys.UI.MouseButton.leftButton||ob)||Kb||this.YF||Ih.a(this.$).Rq()||(ob&&W.wXi(),this.sCb=ta.clientPoint.x,this.VZ=ta,this.cSg(W))};gb.prototype.yXi=function(W){!this.Pz&&this.YF&&this.rVd(W.sheet,!1)};gb.prototype.zXi=function(W){this.Pz||(this.YF&&this.reorderSheets(W.sheet,!1,!0),this.tR());this.X0()};gb.prototype.ote=function(){return this.$.isEditMode&&!Zf.k(this.$.qg)};
gb.prototype.X0=function(){var W=this,ta=tf.HelperMethods.Wca(function(){W.LWj();W.sm&&W.lyj();W.hSd()});jc.ULS.sendTraceTag(537153757,0,50,"SheetTabBarControl.RearrangeContentAreaAndNavAreaExtra: duration = {0}",ta)};gb.prototype.lyj=function(){var W=this.hL===this.Eh.length-1;ef.DOMElementExtensions.toggleCssClass(this.Aeb,this.$.UJ?rb.wSe:rb.kSe,!!this.jv);ef.DOMElementExtensions.toggleCssClass(this.Aeb,this.$.UJ?rb.kSe:rb.wSe,!W)};gb.prototype.hSd=function(W){W=void 0===W?!1:W;var ta=!this.jv,
ob=this.hL===this.Eh.length-1;this.u3f(4,this.sheetTabActivatePreviousHidden,!ta);this.u3f(5,this.sheetTabActivateNextHidden,!ob);this.Ayc(0,ta||W);this.Ayc(1,ta||W);this.Ayc(2,ob||W);this.Ayc(3,ob||W)};gb.prototype.u3f=function(W,ta,ob){if(W=this.xL[W]){ef.DOMElementExtensions.setVisible(W,ob);var Kb=this.w4e(W);Kb.title="img"===W.nodeName?W.alt=0<this.Eh.length&&ob?ta:"":W.title=0<this.Eh.length&&ob?ta:"";Kb.tabIndex=ob?0:-1}};gb.prototype.w4e=function(W){return this.Uw?W.parentNode:W.parentNode.parentNode};
gb.prototype.Ayc=function(W,ta){if(W=this.xL[W])W=this.w4e(W),void 0!==W&&null!==W&&(!this.Eh.length||ta?(W.classList.add(ei.a.SZ),W.setAttribute(fe.a.aia,"true")):(W.classList.remove(ei.a.SZ),W.setAttribute(fe.a.aia,"false")))};gb.prototype.eTa=function(W){var ta=this.$.UJ?this.Eh.length-1:0,ob=this.O6e(this.$.UJ?0:this.Eh.length-1);ob&&(ob.borderRightWidth=W?"1px":"0");this.jv!==this.hL&&(ob=this.O6e(ta))&&(ob.borderRightWidth="0")};gb.prototype.mqe=function(W,ta){this.Eh||(this.Eh=[]);-1===ta?
Array.add(this.Eh,W):Array.insert(this.Eh,ta,W)};gb.prototype.C6b=function(W,ta){var ob=-1,Kb=null;ta||(ob=this.aZh(W.index),-1!==ob&&(Kb=this.JLa(ob)));W=new nb(this.$,this.cl,Kb,W,this,this.sm,this.Uw);this.mqe(W,ob);ef.DOMElementExtensions.setVisible(W.domElement,!0)};gb.prototype.rVd=function(W,ta){var ob=this.b4a(W);if(ob){this.Eod=W;this.Vzd=ta;W=ob.domElement;ob=this.isRtl?W.offsetLeft+(this.cl.scrollWidth-this.cl.clientWidth-this.cl.scrollLeft):W.offsetLeft-this.cl.scrollLeft;if(!this.isRtl&&
ta||this.isRtl&&!ta)ob+=W.offsetWidth;this.bzc.style.left=tf.HelperMethods.Yb(ob-4);ef.DOMElementExtensions.setVisible(this.bzc,!0)}};gb.prototype.Cbf=function(){ef.DOMElementExtensions.setVisible(this.bzc,!1)};gb.prototype.l1=function(W){var ta=this,ob=tf.HelperMethods.Wca(function(){switch(W){case 0:ta.Zwc(0);break;case 1:ta.Zwc(ta.jv-1);break;case 2:ta.Zwc(ta.jv+1);break;case 3:ta.scrollIntoView(ta.Eh.length-1);break;case 4:ta.jv&&1<=ta.Eh.length&&(ta.doe(ta.jv-1),ta.bQd());break;case 5:ta.hL!==
ta.Eh.length-1&&1<=ta.Eh.length&&(ta.doe(ta.hL+1),ta.bQd());break;case 6:ta.bQd()}});this.o9b&&this.YF&&this.BPb();jc.ULS.sendTraceTag(537153755,0,50,"SheetTabBarControl.ScrollSheetTabs: operation = {0}, duration = {1}",W,ob)};gb.prototype.doe=function(W){(W=this.QR(W))&&W.activate()};gb.prototype.tHh=function(W){if(0===W.Vy)for(var ta=this.$.xa,ob=0,Kb=0,qc=ta.count;Kb<qc;Kb++){var Bb=Object(Gc.a)(k.a,ta.getItem(Kb));if(Bb===W)return ob;0===Bb.Vy&&ob++}return-1};gb.prototype.gHh=function(W){var ta=
this.$.xa;W=W.index+1;for(var ob=ta.count;W<ob;W++){var Kb=Object(Gc.a)(k.a,ta.getItem(W));if(0===Kb.Vy)return Kb}return null};gb.prototype.Vja=function(W){for(var ta=0;ta<this.Eh.length;ta++){var ob=this.QR(ta);if(!ob)jc.ULS.sendTraceTag(537153754,0,15,"SheetTabBarControl.FindMatchingSheetTabIndex: sheetTabButton[{0}] is null even though index is not out of bounds!",ta);else if(ob.sheet===W)return ta}return-1};gb.prototype.b4a=function(W){W=this.Vja(W);return this.QR(W)};gb.prototype.RAi=function(W,
ta,ob){var Kb={};Kb.a=this.$.ya.UserSessionId;Kb.b=ob;Kb.c=this.V8b;Kb.d=W;Kb.e=ta;Kb.f=this.$.xa.count;Yb.b().Te(2,Kb,ob)};gb.prototype.ijj=function(W,ta,ob){var Kb=Object(Gc.a)(Ab.a,this.$.xa);ta?(ta=ta.index,ta=W.index<ta?ta-1:ta):ta=ob?Kb.count-1:0;Kb.reorderSheet(W,ta,!0)};gb.prototype.R2f=function(W){Ke.g(this.$).Lg.Np(W)};gb.prototype.cSg=function(W){if(!this.zvc){var ta=this.domElement.ownerDocument.body;this.Pz?(Pf.a.instance.qa(Sd.a.ph,document.documentElement,this.AL),this.lya&&(Mf.a.instance.qa(Sd.a.Dg,
document.documentElement,this.AL),Mf.a.instance.qa(Sd.a.Dg,this.domElement,this.IO))):(Pf.a.instance.qa(Sd.a.ph,ta,this.AL),Mf.a.instance.qa(Sd.a.Dg,ta,this.AL));Pf.a.instance.qa(Sd.a.$d,document.documentElement,this.A0);Mf.a.instance.qa(Sd.a.Ce,ta,this.A0);this.zvc=!0}this.s0=W.sheet;this.V8b=!1;this.Pz?(this.sN=null,this.d9b=W,this.Qaa=W.domElement,this.GRd(ef.DOMElementExtensions.getBoundingClientRect(this.Qaa),"BeginSheetTabButtonDrag")):(jc.ULS.sendTraceTag(537153752,0,50,"SheetTabBarControl.BeginSheetTabButtonDrag: Starting legacy sheet tab drag and drop."),
this.domElement.classList.add(rb.jSe),this.domElement.style.cursor="",this.R2f("pointer"))};gb.prototype.tR=function(W){W=void 0===W?!0:W;if(this.zvc){this.R2f(fe.a.v5);var ta=this.domElement.ownerDocument.body;this.Pz?(Pf.a.instance.za(Sd.a.ph,document.documentElement,this.AL),this.lya&&(Mf.a.instance.za(Sd.a.Dg,document.documentElement,this.AL),Mf.a.instance.za(Sd.a.Dg,this.domElement,this.IO))):(Pf.a.instance.za(Sd.a.ph,ta,this.AL),Mf.a.instance.za(Sd.a.Dg,ta,this.AL));Pf.a.instance.za(Sd.a.$d,
document.documentElement,this.A0);Mf.a.instance.za(Sd.a.Ce,ta,this.A0);this.TNc=this.zvc=!1}this.gsc=0;this.V8b=!1;this.Eod=this.s0=null;this.Pz?(this.Qaa&&(this.Qaa.style.visibility="visible",this.Qaa=null),this.d9b=null,this.GRd(null,"EndSheetTabButtonDrag"),this.sN&&(this.sN.parentNode&&this.sN.parentNode.removeChild(this.sN),this.sN=null),this.wlj(W)):(this.domElement.classList.remove(rb.jSe),this.Cbf())};gb.prototype.wlj=function(W){this.bXd(W);this.jD=this.sCb=-1};gb.prototype.zph=function(W,
ta){function ob(sd,Vd,bf){var Xf=Bb.Ma(9,null);Xf.sheetName=W;Xf.newSheetIndex=ta;return $h.i(Bb,"ReorderSheets",Xf,sd,Vd,bf,null,0)}function Kb(){return new lb(W,ta)}var qc=this.$.na,Bb=qc?qc.ta:null;Td.EwaSettings.uc()?this.$.userOperationManager.jc(new li.a(557,0,ob,64,Kb),null):this.$.userOperationManager.jc(new eh.a(557,0,ob,void 0,Kb),null)};gb.prototype.QR=function(W){return 0<=W&&W<this.Eh.length?this.Eh[W]:null};gb.prototype.N6e=function(W){return(W=this.QR(W))?W.sheet:null};gb.prototype.JLa=
function(W){return(W=this.QR(W))?W.domElement:null};gb.prototype.O6e=function(W){return(W=this.JLa(W))?W.style:null};gb.prototype.aZh=function(W){var ta=this.$.xa;W+=1;for(var ob=-1,Kb=this.Eh?this.Eh.length:0;W<ta.count;){var qc=Object(Gc.a)(k.a,ta.getItem(W));if(0===qc.Vy){for(ob=0;ob<Kb&&this.N6e(ob)!==qc;ob++);break}W++}return-1===ob||ob===Kb?-1:ob};gb.prototype.dHf=function(W){var ta=this.b4a(W);ta&&(this.Pz&&this.YF&&(jc.ULS.sendTraceTag(537153751,0,50,"SheetTabBarControl.OnSheetDeletedOrHidden: A sheet has been deleted while re-order operation is midway."),
Td.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&this.tR()),this.cl.removeChild(ta.domElement),ta=Array.indexOf(this.Eh,ta),Array.removeAt(this.Eh,ta),this.X0(),(!this.isRtl&&ta===this.Eh.length||this.isRtl&&!ta)&&this.eTa(!0),this.o9b&&this.YF?W===this.s0?(this.tR(),this.l1(6)):this.BPb():this.l1(6))};gb.prototype.fHf=function(W){var ta=Object(Gc.a)(k.a,W);this.Pz&&this.YF&&(jc.ULS.sendTraceTag(537153750,0,50,"SheetTabBarControl.OnSheetInsertedOrUnhidden: A sheet has been added to the sheet tab bar while re-order operation is midway."),
Td.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&this.tR());if(0===ta.Vy){this.eTa(!1);var ob=this.Vja(W);-1===ob&&(jc.ULS.sendTraceTag(537153749,0,50,"SheetTabBarControl.OnSheetInsertedOrUnhidden: could not find matching sheet tab index. Creating sheet tab..."),this.C6b(ta,!1),ob=this.Vja(W));this.G$e(ob,!0)}};gb.prototype.jjj=function(W,ta){var ob=this.b4a(W);ob&&(this.Pz&&this.YF&&!ta&&(jc.ULS.sendTraceTag(537153748,0,50,"SheetTabBarControl.ReorderSheetTab: A sheet has been re-ordered while re-order operation is midway."),
Td.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&this.tR()),W=this.VMj(W,ob),!Td.EwaSettings.isChangeGateEnabled("OfficeVSO:4176044_CancelCallsToSetTabColorAfterReorder")&&this.Pz&&W&&ta&&W.vXi())};gb.prototype.VMj=function(W,ta){var ob=Array.indexOf(this.Eh,ta),Kb=this.tHh(Object(Gc.a)(k.a,W));if(-1===Kb||-1===ob)return null;ob!==Kb||this.Pz?(this.eTa(!1),Kb=gb.fjj(ob,Kb,this.jv,this.hL),this.jv=Kb.THh,this.hL=Kb.Pvi,ta&&ta.domElement.parentNode===
this.cl&&(this.cl.removeChild(ta.domElement),Array.removeAt(this.Eh,ob)),ta=this.gHh(W),ob=this.Vja(ta),ta=new nb(this.$,this.cl,this.JLa(ob),Object(Gc.a)(k.a,W),this,this.sm,this.Uw),this.mqe(ta,ob),ob=this.Vja(W),this.G$e(ob,!1,!this.sm)):ta=null;return ta};gb.prototype.lqh=function(){for(var W=this.Eh?this.Eh.length:0,ta=this.jv,ob=this.hL,Kb=0;Kb<W;Kb++){var qc=this.QR(Kb),Bb=Kb>=ta;qc&&(qc.tabIndex=Bb&&Kb<=ob?0:-1)}};gb.prototype.yVj=function(){for(var W=this.Eh?this.Eh.length:0,ta=0;ta<W;ta++){var ob=
this.QR(ta);ob&&ob.Rgb()}};gb.prototype.G$e=function(W,ta,ob){ob=void 0===ob?!0:ob;ta&&W<=this.jv&&this.jv++;this.lqh();this.eTa(!0);this.X0();this.o9b&&this.YF?this.BPb():ob&&this.l1(6)};gb.prototype.hyc=function(W){var ta=this.$.UJ;if(W||this.isRtl!==ta)this.isRtl=ta,this.domElement.classList.remove(this.isRtl?cg.a.rSe:cg.a.xSe),this.domElement.classList.add(this.isRtl?cg.a.xSe:cg.a.rSe),this.domElement.dir=this.isRtl?"rtl":"ltr",this.yVj();W||this.eTa(!0);for(W=0;W<this.xL.length;W++)0!==W&&3!==
W&&(!this.sm||4!==W&&5!==W)&&this.v3f(W)};gb.prototype.ebh=function(){var W=this.CTd=document.createElement("div");W.className=rb.Pxh;this.sm&&W.classList.add(rb.Qxh);this.domElement.appendChild(W);this.v6b(W,1,704,703);this.v6b(W,2,706,705);this.elf&&(this.mTa=new wc(this.$,this,W));this.sm||this.v6b(W,4,710,709)};gb.prototype.fbh=function(){var W=this.dzc=document.createElement("div");W.className=rb.Rxh;this.domElement.appendChild(W);this.sm||this.v6b(W,5,712,711);this.P6c()};gb.prototype.hch=function(){var W=
document.getElementById(fe.a.OAj),ta=document.getElementById(fe.a.PAj);W&&!ta&&jc.ULS.sendTraceTag(537153746,0,50,"CreateProgressBarArea - progressBar div is not null, separator div is null. progressBarDiv parent ID: {0}. progressBar div has child: {1}. ProgressBarMessage div exists: {2}",W.parentNode.id,!!W.firstChild,!!document.getElementById(fe.a.tTd));if(Gh.a.klf(this.$)&&W&&ta)this.domElement.appendChild(W),this.DTd=W.firstChild,this.ETd=document.getElementById(fe.a.tTd),ta.style.visibility=
"visible";else{W=document.createElement("div");ta=document.createElement("div");W.className=cg.a.$xh;ta.className=cg.a.Yxh;ta.style.display="none";var ob=document.createElement("div");ob.className=cg.a.ayh;var Kb=document.createElement("div");Kb.className=cg.a.Zxh;var qc=document.createElement("div");qc.className=cg.a.Xxh;ta.appendChild(ob);ta.appendChild(Kb);ta.appendChild(qc);W.appendChild(ta);this.domElement.appendChild(W);this.DTd=ta;this.ETd=Kb}};gb.prototype.v3f=function(W){var ta=this.xL[W];
if(ta)if(this.Uw){var ob=ta.parentNode;this.ITf(ta);ta=R.a(this.$)?this.BMf[W]:this.FAd[W];this.xL[W]=this.svgIconProvider.Zba(ta,12,12,ob,24,24)}else ta.className=this.DAd[W]};gb.prototype.ITf=function(W){(null===W||void 0===W?0:W.parentNode)&&W.parentNode.removeChild(W)};gb.prototype.F9g=function(){var W=this.Aeb=document.createElement("div");W.className=rb.Mxh;this.domElement.appendChild(W);this.kdh(W)};gb.prototype.kdh=function(W){var ta=document.createElement("div");ta.className=rb.cyh;ta.classList.add(rb.Nxh);
this.$.printingEnabled||ta.classList.add(Fe.a.FUe);W.appendChild(ta);this.cl=document.createElement("ul");ef.DOMElementExtensions.Rs(this.cl,fe.a.IZc,null,null);this.cl.className=Fe.a.ySe;ta.appendChild(this.cl);this.Yah();this.xke=document.createElement("div");this.Zyc.id="SheetIconTooltipContainer";ta.appendChild(this.Zyc)};gb.prototype.Yah=function(){var W=document.createElement("div"),ta="<div class='"+cg.a.j2g+"'>{0}</div>",ob=bd.a.Dgd(cg.a.kzh,0,"55_16_N","");W.innerHTML=String.format(ta,ob);
W.className=rb.byh;ef.DOMElementExtensions.setVisible(W,!1);this.bzc=W;this.cl.appendChild(W)};gb.prototype.h7c=function(){for(var W=this.$.xa,ta=0,ob=W.count;ta<ob;ta++){var Kb=Object(Gc.a)(k.a,W.getItem(ta));0===Kb.Vy&&(this.C6b(Kb,!0),Kb.active&&Kb.activate())}};gb.prototype.p3c=function(){$g.a.tc(this.Eh);this.Eh=[];this.hL=this.jv=0};gb.prototype.v6b=function(W,ta,ob,Kb){function qc(bf){"mouseup"===bf.type&&Bb.Pz&&Bb.YF||Qd.g(bf);sd.classList.contains(ei.a.SZ)||(Vd?Bb.lUi(bf,ta):Bb.sm||Bb.pEf(bf,
ta))}var Bb=this,sd=document.createElement("a");W.appendChild(sd);W=this.FAd[ta];this.xL[ta]=this.Cb(sd,Ee.a.instance.fa(Kb),0,this.DAd[ta],Ee.a.instance.fa(ob),W);if(5===ta||4===ta)ef.DOMElementExtensions.EK(this.xL[ta],sd,!1,"span").style.marginTop="10px";this.v3f(ta);ob=this.EAd[ta]=this.Rd.Gd(sd);Pf.a.instance.qa(Sd.a.pointerDown,sd,function(bf){return bf.ctrlKey&&Bb.lOi(ta)?!0:Bb.nEf(ta)});Pf.a.instance.qa(Sd.a.$d,sd,function(){return Bb.oEf()});Mf.a.instance.qa(Sd.a.Ce,sd,function(){return Bb.oEf()});
Pf.a.instance.qa(Sd.a.pointerOut,sd,function(){return Bb.g3c()});Bg.KeyInputManager.instance.qa(Sd.a.Ub,sd,function(bf){return 13!==bf.Ca.keyCode&&32!==bf.Ca.keyCode||Bb.n5c?!1:(Bb.n5c=!0,Bb.nEf(ta))});Bg.KeyInputManager.instance.qa(Sd.a.Td,sd,function(bf){return 13===bf.Ca.keyCode||32===bf.Ca.keyCode?(Bb.n5c=!1,Bb.g3c()):!1});var Vd=this.ote();ob.ka("mouseover",qc);ob.ka("mouseout",qc);ob.ka("focus",qc);ob.ka("blur",qc);Vd&&ob.ka("mouseup",qc)};gb.prototype.ohf=function(W){var ta=!1,ob=this.$.zf;
ob&&(ta=za.a.IB(ef.DOMElementExtensions.getBoundingClientRect(ob),W.clientPoint));return ta};gb.prototype.glf=function(W){return za.a.IB(ef.DOMElementExtensions.getBoundingClientRect(this.domElement),W.clientPoint)||this.ohf(W)};gb.prototype.pHh=function(W){var ta=null,ob=W.clientPoint,Kb=this.jv;if(this.glf(W))for(Kb=this.jv;Kb<=this.hL;Kb++)if(ta=this.QR(Kb))if(W=ef.DOMElementExtensions.getBoundingClientRect(ta.domElement),!this.isRtl&&ob.x<W.x+W.width||this.isRtl&&ob.x>W.x)break;return{returnValue:ta,
tEj:Kb>this.hL}};gb.prototype.BPb=function(){if(this.Pz){if(!this.sN){jc.ULS.sendTraceTag(537153743,0,50,"SheetTabBarControl.UpdateDragAndDropState: Starting modern sheet tab drag and drop.");this.sN=this.Qaa.cloneNode(!0);if(!this.hZf(this.sN,this.Qaa,!0,"UpdateDragAndDropState"))return;this.Qaa.style.visibility="hidden";this.sN.classList.add(rb.dyh);this.sN.style.borderRightWidth="";this.Hec=this.VZ.clientPoint.x-this.K4.width/2;this.sN.style.left=this.Hec+"px";this.jD=this.Vja(this.s0);0>this.jD&&
jc.ULS.sendTraceTag(537153742,0,15,"SheetTabBarControl.UpdateDragAndDropState: ghostIndex < 0!")}this.o9b&&(this.jD=this.Vja(this.s0));var W=ef.DOMElementExtensions.getBoundingClientRect(this.cl),ta=W.x;W=W.x+W.width;var ob=this.VZ.clientPoint.x-this.K4.width/2;ob=Math.min(ob,W-this.K4.width);ob=Math.max(ob,ta);this.sN.style.transform="translateX("+Math.abs(ob-this.Hec)*(this.Hec<ob?1:-1)+"px)";var Kb=this.VZ.clientPoint.x>this.sCb,qc=this.VZ.clientPoint.x;ob>=W-this.K4.width?(qc=W-this.K4.width/
2,this.$Pd()||this.Lna||(jc.ULS.sendTraceTag(537153741,0,50,"SheetTabBarControl.OnDocumentPointerMove: Starting modern sheet tab bar scroll with drag and drop to the right."),this.frc=this.cl.scrollLeft,this.Lna=window.requestAnimationFrame(this.N_f))):ob<=ta?(qc=ta+this.K4.width/2,this.ZPd()||this.Lna||(jc.ULS.sendTraceTag(537153740,0,50,"SheetTabBarControl.OnDocumentPointerMove: Starting modern sheet tab bar scroll with drag and drop to the left."),this.frc=this.cl.scrollLeft,this.Lna=window.requestAnimationFrame(this.M_f))):
this.Lna&&(jc.ULS.sendTraceTag(537153739,0,50,"SheetTabBarControl.UpdateDragAndDropState: Ending scroll as dragged sheet left renderd edge of stb."),this.bXd());this.VZ.clientPoint.x!==this.sCb&&(this.PXd(Kb,qc),this.sCb=this.VZ.clientPoint.x)}else W=this.pHh(this.VZ),ta=W.tEj,(W=W.returnValue)?this.rVd(W.sheet,ta):this.Cbf();this.TNc=!0};gb.prototype.PXd=function(W,ta){for(var ob=this,Kb;function(){var qc=ob.kmh(ta,W);Kb=qc.s3b;return qc}().returnValue;)this.cOb=Kb,this.wNg(W)};gb.prototype.wNg=
function(W){if(this.cOb){var ta=(W?1:-1)*this.K4.width;if(W&&!this.$.UJ||!W&&this.$.UJ){var ob=this.Qaa;var Kb=this.jD+1;var qc=!0}else ob=(Kb=this.QR(this.jD+1))?Kb.domElement:null,Kb=this.jD-1,qc=!1;if(this.hZf(this.cOb,ob,qc,"AnimateSheetSwap")){jc.ULS.sendTraceTag(537153738,0,50,"SheetTabBarControl.AnimateSheetSwap: Sheet swap between ghost-index {0} and other sheet-index {1}. amount of sheets in the bar: {2} isMovingRight: {3}",this.jD,Kb,this.ATd,W);0<=this.jD&&this.jD<this.Eh.length&&0<=Kb&&
Kb<this.Eh.length?(W=this.Eh[Kb],this.Eh[Kb]=this.Eh[this.jD],this.Eh[this.jD]=W):(jc.ULS.sendTraceTag(537153737,0,15,"SheetTabBarControl.AnimateSheetSwap: indices are out of range! length: {0}, ghostIndex: {1}, swappedSheetIndex: {2}",this.Eh.length,this.jD,Kb),this.tR());this.jD=Kb;var Bb=this.cOb;Bb.style.transform="translateX("+ta+"px)";window.requestAnimationFrame(function(){Bb.style.transform="translateX(0px)"})}}};gb.prototype.hZf=function(W,ta,ob,Kb){function qc(Bb){return Bb?String.format("Node ID: {0} , Node class: {1}, Node name: {2},",
Bb.id,Bb.className,Bb.nodeName):null}try{return this.cl.insertBefore(W,ta),!0}catch(Bb){return W=this.b4a(this.s0),jc.ULS.sendTraceTag(537153736,0,15,"SheetTabBarControl.SafeInsertSheetBefore: Reference node is not a descendant of the sheet tab bar. sheetTabButonState: [{0}], Caller: [{1}], Node to insert before [{2}], That node's parent: [{3}],SheetTabListElement: [{4}], isReferenceSheetTheDraggedSheet:[{5}], ghostIndex:[{6}], sheetTabButtons length:[{7}], Exception: [{8}]",W?W!==this.d9b?"Changed":
"NoChange":"Removed",Kb,qc(ta),qc(ta.parentNode),qc(this.cl),ob,this.jD,this.ATd,Bb),this.tR(),!1}};gb.prototype.kmh=function(W,ta){var ob=this.$.UJ===ta?this.QR(this.jD-1):this.QR(this.jD+1);if(!ob)return{returnValue:!1,s3b:null};ob=ob.domElement;var Kb=ef.DOMElementExtensions.getBoundingClientRect(ob);return this.K4?ta?{returnValue:W+this.K4.width/2>=Kb.x+.5*Kb.width,s3b:ob}:{returnValue:W-this.K4.width/2<=Kb.x+.5*Kb.width,s3b:ob}:(jc.ULS.sendTraceTag(537153735,0,50,"SheetTabBarControl.DraggedSheetCrossesSiblingSheet: Avoding JS crash and ending drag and drop due to client bounds of dragged sheet being null."),
this.tR(),{returnValue:!1,s3b:ob})};gb.prototype.K_f=function(W,ta){var ob=ta?this.N_f:this.M_f;if(-1===this.SAc)this.SAc=W,this.Lna=window.requestAnimationFrame(ob);else{W=Math.floor((W-this.SAc)/1E3*300);var Kb=this.kKb>this.YCb?1:-1;this.scrollLeft(Math.abs(this.cl.scrollLeft-(ta?this.frc+W*Kb:this.frc-W*Kb))*(ta?-1:1));if(W=this.S2e("ScrollStep"))this.PXd(ta,W.x+W.width/2),ta&&!this.$Pd()||!ta&&!this.ZPd()?this.Lna=window.requestAnimationFrame(ob):(jc.ULS.sendTraceTag(537153734,0,50,"SheetTabBarControl.ScrollStep: Ending scroll as dragged sheet reached first/last sheet."),
this.bXd())}};gb.prototype.$Pd=function(){var W=this.kKb>this.YCb;return W&&this.poa>=this.kKb||!W&&this.poa<=this.kKb};gb.prototype.ZPd=function(){var W=this.kKb>this.YCb;return W&&this.poa<=this.YCb||!W&&this.poa>=this.YCb};gb.prototype.bXd=function(W){W=void 0===W?!0:W;this.cl&&(this.poa=this.cl.scrollLeft);window.cancelAnimationFrame(this.Lna);this.Lna=0;this.SAc=-1;W&&this.X0()};gb.prototype.GRd=function(W,ta){W||jc.ULS.sendTraceTag(537153733,0,50,"SheetTabBarControl.SetDraggedSheetTabButtonRect: DraggedSheetTabButtonRect set to null by {0}",
ta);this.K4=W};gb.prototype.lOi=function(W){return 2===W?(this.l1(3),!0):1===W?(this.l1(0),!0):!1};gb.prototype.nEf=function(W){var ta=this;jc.ULS.shipAssertTag(537153732,0,-1===this.MQa&&-1===this.LQa,"SheetTabBarControl.OnNavigateButtonDown: PeriodicNavigateSetTimeoutID and PeriodicNavigateSetIntervalID should be -1 on button down!");-1!==this.MQa&&(window.clearTimeout(this.MQa),this.MQa=-1);-1!==this.LQa&&(window.clearInterval(this.LQa),this.LQa=-1);this.l1(W);this.MQa=window.setTimeout(function(){ta.AKj(W)},
this.BHi);return!0};gb.prototype.AKj=function(W){var ta=this;this.LQa=window.setInterval(function(){ta.l1(W)},this.AHi)};gb.prototype.oEf=function(){this.g3c();return!this.Pz||!this.YF};gb.prototype.g3c=function(){window.clearTimeout(this.MQa);window.clearInterval(this.LQa);this.LQa=this.MQa=-1;return!0};gb.prototype.pEf=function(W,ta){var ob=this.DAd[ta];tf.HelperMethods.eZd(this.xL[ta],ob,ob+fe.a.ogc,"mouseover"===W.type||"focus"===W.type)};gb.prototype.lUi=function(W,ta){var ob=this.Gic(ta),Kb=
5===ta;if("mouseup"===W.type){if(Kb||4===ta)ob||this.reorderSheets(null,Kb,!1),this.tR()}else!this.Pz&&this.YF?(ob||this.rVd(this.N6e(Kb?this.hL:this.jv),Kb),this.l1(Kb?2:1)):this.sm||this.pEf(W,ta)};gb.prototype.Gic=function(W){return!!ef.DOMElementExtensions.zhd(this.xL[W],"a").title};gb.prototype.rEc=function(W){this.c1d(W);this.X0()};gb.prototype.c1d=function(W){(W=this.b4a(W))&&W.Rgb()};gb.prototype.bQd=function(){var W=this.$.xa;if(W.oa&&(!td.e(this.$)||W.count))if(W=this.Vja(W.oa),-1===W)jc.ULS.sendTraceTag(537153729,
0,50,"SheetTabBarControl.ScrollToActiveIndex: shouldn't have an invisible, active sheet");else{var ta=this.JLa(W);W<this.jv?this.Zwc(W):W>this.jv&&!this.mud(ta)&&this.scrollIntoView(W)}};gb.prototype.LWj=function(){this.jv=0;this.hL=this.Eh.length-1;for(var W=!1,ta=0;ta<this.Eh.length;ta++){var ob=this.QR(ta);if(!ob)break;var Kb=this.mud(ob.domElement);ob.tabIndex=Kb?0:-1;if(!W&&Kb)this.jv=ta,W=!0;else if(W&&!Kb){this.hL=ta-1;break}}};gb.prototype.Zwc=function(W){this.$.xa.count&&(this.Eh.length||
this.h7c(),this.A1f(this.JLa(Math.max(0,Math.min(W,this.Eh.length-1)))),this.X0())};gb.prototype.scrollIntoView=function(W){jc.ULS.shipAssertTag(537153697,0,W>=this.jv,"SheetTabBarControl.ScrollIntoView: sheetTabIndex must be greater than the first visisble sheet tab index!");if(this.$.xa.count){this.Eh.length||this.h7c();var ta=this.JLa(Math.max(0,Math.min(W,this.Eh.length-1))),ob=this.JLa(this.jv);if(!this.mud(ta)){ta=ef.DOMElementExtensions.getBoundingClientRect(ta);var Kb=ef.DOMElementExtensions.getBoundingClientRect(this.Aeb);
ta=this.isRtl?Kb.x-ta.x:ta.x+ta.width-(Kb.x+Kb.width);for(Kb=0;ob&&Kb<ta;){var qc=ef.DOMElementExtensions.getBoundingClientRect(ob);Kb+=qc.width;ob=ob.nextSibling}ob?this.A1f(ob):jc.ULS.sendTraceTag(537153696,0,15,"SheetTabBarControl.ScrollIntoView: new firstVisible is null. firstVisibleSheetTabIndex = {0}, lastVisibleSheetTabIndex = {1}, scroll to index: {2}",this.jv,this.hL,W)}this.X0()}};gb.prototype.A1f=function(W){var ta=ef.DOMElementExtensions.getBoundingClientRect(this.cl);W=ef.DOMElementExtensions.getBoundingClientRect(W);
this.isRtl?this.scrollLeft(Math.floor(ta.x+ta.width-(W.x+W.width+.5))):this.scrollLeft(Math.ceil(ta.x-W.x-.5))};gb.prototype.scrollLeft=function(W){(0>W&&this.$Pd()||0<W&&this.ZPd())&&jc.ULS.sendTraceTag(537153695,0,50,"SheetTabBarControl.Scrollleft: attempt to scroll after the edge (overflow) in sheet tab bar.");var ta=this.cl.scrollLeft;if(this.isRtl){if(rf.a.aG||rf.a.Hf){this.cl.scrollLeft=this.poa=ta-W;return}if(rf.a.FB||rf.a.lI){this.cl.scrollLeft=this.poa=ta+W;return}jc.ULS.sendTraceTag(537153694,
0,15,"SheetTabBarControl.ScrollLeft: unknown browser")}this.cl.scrollLeft=this.poa=ta-W};gb.prototype.mud=function(W){W=ef.DOMElementExtensions.getBoundingClientRect(W);var ta=ef.DOMElementExtensions.getBoundingClientRect(this.Aeb);return W&&ta?W.x>=ta.x-1&&W.x+W.width<=ta.x+ta.width+1:(jc.ULS.sendTraceTag(537153693,0,15,"SheetTabBarControl.IsTabCompletelyVisible: sheetTabRect is null or contentAreaRect is null"),!1)};gb.prototype.zbh=function(){var W=this.dzc;if(pc.i6f(this.$))this.sm?($g.a.Fa(this.fI),
this.fI=new pc(W,this.$,this,!0)):($g.a.Fa(this.fI),this.fI=null);else if(!this.fI||this.sm)$g.a.Fa(this.fI),Zf.k(this.$.qg)?this.fI=new zb(W,this.$,this):this.fI=new pc(W,this.$,this)};gb.prototype.iIe=function(W,ta){var ob=this.$.xa;if(!this.$.isEditMode||!ob.count)$g.a.Fa(ta),ta=null;else if(!ta)if(ob=this.sm?this.CTd:this.dzc,Zf.k(this.$.qg))ta=new zb(ob,this.$,this);else switch(W){case 0:ta=new pc(ob,this.$,this);break;case 1:ta=new yb(ob,this.$,this);break;default:jc.ULS.sendTraceTag(537153692,
0,10,"Unsupported SheetTabBarButtonType. Are you trying to create a new button? Make sure to update the SheetTabBarButtonType enum and add a case here to support creation of your new button.")}return ta};gb.prototype.P6c=function(){Td.EwaSettings.ma(432)?(this.fI=this.iIe(0,this.fI),this.Szb=this.iIe(1,this.Szb)):this.zbh()};gb.prototype.S2e=function(W){var ta=ef.DOMElementExtensions.getBoundingClientRect(this.sN);ta||(jc.ULS.sendTraceTag(537153689,0,50,"SheetTabBarControl.{0}: GetBoundingClientRect returned null for the dragged sheet.",
W),this.tR());return ta};gb.prototype.x$e=function(W,ta){this.Sua.yOg(W,ta);this.tR(!1);this.hSd(this.navigationButtonsDisabled);W=Cl(this.gNj);for(ta=W.next();!ta.done;ta=W.next())(ta=ta.value)&&ta.kY(this.navigationButtonsDisabled);W=Cl(this.cxe);for(ta=W.next();!ta.done;ta=W.next())(ta=ta.value)&&ta.kY(this.operationButtonsDisabled)};gb.fjj=function(W,ta,ob,Kb){W<ob?(ta>ob&&ob--,ta>Kb&&Kb--):W>Kb?(ta<ob&&ob++,ta<Kb&&Kb++):ta<ob&&ob++;return{THh:ob,Pvi:Kb}};uk.Object.defineProperties(gb.prototype,
{Kb:{configurable:!0,enumerable:!0,get:function(){return this.domElement}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.isVisible}},de:{configurable:!0,enumerable:!0,get:function(){return Uf.a.zTd}},YF:{configurable:!0,enumerable:!0,get:function(){return this.TNc}},ATd:{configurable:!0,enumerable:!0,get:function(){return this.Eh.length}},Zyc:{configurable:!0,enumerable:!0,get:function(){return this.xke}},lya:{configurable:!0,enumerable:!0,get:function(){return this.sce}},
navigationButtonsDisabled:{configurable:!0,enumerable:!0,get:function(){return!!this.Sua&&this.Sua.navigationButtonsDisabled}},operationButtonsDisabled:{configurable:!0,enumerable:!0,get:function(){return!!this.Sua&&this.Sua.operationButtonsDisabled}},DAd:{configurable:!0,enumerable:!0,get:function(){return this.sm?this.$.UJ?[cg.a.q$b,cg.a.tSe,cg.a.vSe,cg.a.p$b,cg.a.wva,cg.a.wva]:[cg.a.p$b,cg.a.vSe,cg.a.tSe,cg.a.q$b,cg.a.wva,cg.a.wva]:this.$.UJ?[cg.a.q$b,cg.a.sSe,cg.a.uSe,cg.a.p$b,cg.a.wva,cg.a.wva]:
[cg.a.p$b,cg.a.uSe,cg.a.sSe,cg.a.q$b,cg.a.wva,cg.a.wva]}},FAd:{configurable:!0,enumerable:!0,get:function(){return this.$.UJ?[null,V.a.IEe,V.a.GEe]:[null,V.a.GEe,V.a.IEe]}},BMf:{configurable:!0,enumerable:!0,get:function(){return this.$.UJ?[null,V.a.JEe,V.a.HEe]:[null,V.a.HEe,V.a.JEe]}},YCb:{configurable:!0,enumerable:!0,get:function(){if(this.isRtl){if(rf.a.aG)return 0;if(rf.a.Hf)return-1*(this.cl.scrollWidth-this.cl.clientWidth);if(rf.a.vv)return this.cl.scrollWidth-this.cl.clientWidth;jc.ULS.sendTraceTag(537153762,
0,15,"SheetTabBarControl.ScrollLeftEdgeValue: unknown browser")}return 0}},kKb:{configurable:!0,enumerable:!0,get:function(){if(this.isRtl){if(rf.a.aG)return this.cl.scrollWidth-this.cl.clientWidth;if(rf.a.Hf||rf.a.vv)return 0;jc.ULS.sendTraceTag(537153761,0,15,"SheetTabBarControl.ScrollRightEdgeValue: unknown browser")}return this.cl.scrollWidth-this.cl.clientWidth}},cxe:{configurable:!0,enumerable:!0,get:function(){return this.Sua?[this.fI,this.Szb]:[this.fI,this.Szb,this.mTa]}},gNj:{configurable:!0,
enumerable:!0,get:function(){return this.Eh.concat(this.mTa)}},QAj:{configurable:!0,enumerable:!0,get:function(){return this.wke}}});Object(zc.a)(gb,"SheetTabBarControl",be.a,[960,3,451]);var ve=wf.a;Am(Za,ve);Za.prototype.create=function(){var W=this,ta=this.$.Lb;if(!Di.a(this.$.ya,1)){var ob=document.getElementById(ta+fe.a.q8c);ob&&(Td.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&Jc.PageLoadTrackingInfo.instance.zBa(fe.a.qMb),Gh.a.ytd()?Le.TaskExtensions.Ba(ug.GetServiceTaskFactory.Ua(this.$.da,
388,387,this.ub),function(Kb){W.Eb(W.$.da.Aa(32)||new gb(W.$,ob,Kb.result))},this.$.la,3):this.Eb(this.$.da.Aa(32)||new gb(this.$,ob)))}};Za.ka=function(W){W.da.Ha(33,new Za(W))};Object(zc.a)(Za,"SheetTabBarFactory",wf.a,[]);var Ye=b(50),Te=b(197);Ma.prototype.hQa=function(){Te.a.instance.RMd(Object($e.a)(this,this.hQa,"onSessionExpiredDetected"));jc.ULS.sendTraceTag(19247381,217,50,"SessionExpiredDetected");this.H9h()};Ma.prototype.RGf=function(){Te.a.instance.QMd(Object($e.a)(this,this.RGf,"onSessionExpiringDetected"));
this.kke||this.iTc||(jc.ULS.sendTraceTag(20492680,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.kke=!0,this.ZGj())};Ma.prototype.H9h=function(){this.iTc||(rd.AFrameworkApplication.zG(Ye.a.Nxc),this.iTc=!0,this.YGj())};Object(zc.a)(Ma,"ASessionExpirationManager",null,[]);var Qf=b(256),kg=b(6),yg=b(80),Lg=b(258);Am(oa,Ma);oa.prototype.Nre=function(W){this.Oa.addHandler("SessionExpired",W)};oa.prototype.f0b=function(W){this.Oa.addHandler("TokenRefreshed",W)};oa.prototype.GMd=function(W){this.Oa.removeHandler("TokenRefreshed",
W)};oa.prototype.zfc=function(){return Te.a.instance.mS(rd.AFrameworkApplication.zk)};oa.prototype.dispose=function(){$g.a.Fa(this.Oa);this.$=null};oa.prototype.ZGj=function(){this.$.isEditMode&&this.Wec(!1)};oa.prototype.YGj=function(){this.Unb=!0;this.Wec(!0);this.Oa.raiseEvent("SessionExpired")};oa.prototype.Wec=function(W){var ta=this;jc.ULS.sendTraceTag(537170715,0,15,"EwaAccessTokenExpirationManager.HandleAccessTokenExpirationDialog: isExpired {0}, GotDeploymentOrTimedOutError {1}",W,this.$.ea.Iba);
var ob=this.$.yb.jq;W&&ob&&ob.isVisible&&1299163859===ob.error.MessageId&&this.$.yb.jq.eu();var Kb=this.ed(W);Ih.a(this.$).Jt(new Qf.a(kg.a.Hz,5,function(){var qc=oe.a(ta.$),Bb=qc.ud.activityState;Bb[yg.a.j3]=ta.$.Qqb(ta.$.isEditMode);Bb[yg.a.WM]=yg.a.p$a;Bb[Lg.a.tr]=kg.a.accessTokenExpiringWarning;qc.ud.Wt([Kb])}))};oa.prototype.ed=function(W){return W?Fh.a.HIe():this.edh()};oa.prototype.edh=function(){var W=Fh.a.ed(12,1,0,0,0,1299163859,"AccessTokenExpiringWarning");W.Description=this.accessTokenExpiringMessage;
return W};uk.Object.defineProperties(oa.prototype,{accessTokenExpiringMessage:{configurable:!0,enumerable:!0,get:function(){var W=(new Date(this.zk)).format(this.$.ya.ShortTimeFormat);return String.format(Ee.a.instance.Bb(77),W)}},tokenExpired:{configurable:!0,enumerable:!0,get:function(){return this.Unb}},Deb:{configurable:!0,enumerable:!0,get:function(){return!1}},wca:{configurable:!0,enumerable:!0,get:function(){return!1}},VKd:{configurable:!0,enumerable:!0,get:function(){return!1}},u6:{configurable:!0,
enumerable:!0,get:function(){return!1}}});Object(zc.a)(oa,"EwaAccessTokenExpirationManager",Ma,[934,172,3]);var Mg=b(186),ai=b(737);Object(zc.a)($b,"RefreshAccessTokenContext",null,[]);var Ug=b(187),nh=b(116),Og=b(146),Ei=b(33),Vh=b(113);Object(zc.a)(Gb,"Error",null,[]);Object(zc.a)(xa,"NamedResult",null,[]);Am(bb,xa);Object(zc.a)(bb,"ErrorInfo",xa,[]);uk.Object.defineProperties(Ua.prototype,{GP:{configurable:!0,enumerable:!0,get:function(){return this.UYb}},errors:{configurable:!0,enumerable:!0,
get:function(){return this.bU}}});Object(zc.a)(Ua,"TokenRefreshArgs",null,[962]);ab.prototype.Nre=function(W){this.Oa.addHandler("SessionExpired",W)};ab.prototype.f0b=function(W){this.Oa.addHandler("TokenRefreshed",W)};ab.prototype.GMd=function(W){this.Oa.removeHandler("TokenRefreshed",W)};ab.prototype.zfc=function(){return Te.a.instance.mS(rd.AFrameworkApplication.zk)};ab.prototype.dispose=function(){Te.a.instance.RMd(this.O$e);Te.a.instance.QMd(this.o$e);var W=this.$.ea;W&&(W.tk(this.fd),W.gvc(this.Mza));
$g.a.Fa(this.Oa);this.documentVisibilityObserver=this.$=null};ab.prototype.Ncg=function(){return this.zfc()?0:(rd.AFrameworkApplication.zk-(new Date).getTime())/6E4};ab.prototype.qig=function(W,ta){if(0<ta&&!this.zfc()){var ob=rd.AFrameworkApplication.ha.Cd("AccessTokenExpirationPromptSeconds",rd.AFrameworkApplication.hZ),Kb=(ta-W.getTime())/6E4;jc.ULS.shipAssertTag(537170713,0,0<=Kb,"TokenManager.UpdateTokenExpirationPromptByTokenLifeTime the access-token expiration time should be after token creation time accessTokenTTL [{0}] creationTime [{1}] tokenLifetimeInMin [{2}]",
ta,W.getTime(),Kb);Kb<this.FFi?(jc.ULS.sendTraceTag(537170712,0,15,"TokenManager.UpdateTokenExpirationPromptByTokenLifeTime updating AccessTokenExpirationPromptSeconds to [{0}] tokenLifetimeInMin [{1}]",this.K5f,Kb),rd.AFrameworkApplication.hZ=this.K5f):rd.AFrameworkApplication.hZ!==ob&&(jc.ULS.sendTraceTag(537170711,0,15,"TokenManager.UpdateTokenExpirationPromptByTokenLifeTime updating AccessTokenExpirationPromptSeconds to [{0}] tokenLifetimeInMin [{1}]",ob,Kb),rd.AFrameworkApplication.hZ=ob)}};
ab.prototype.B8g=function(W){return!this.context||this.context.GIb||this.context.q7c!==W?(W=new $b(Mg.a.create().toString(),W),this.context&&!this.context.BCc&&jc.ULS.sendTraceTag(537170710,0,15,"TokenManager.InitContext: creating new context [{0}] although previeous one [{1}] not used successfully, isPreviousOneRefreshedSuccessfully [{2}] ",W.correlationID,this.context.correlationID,this.context.GIb),this.VT=W,!0):!1};ab.prototype.zlj=function(W){W&&this.IH&&!this.wca&&this.$.ea.xf.Kr&&!this.u6&&
(this.IH=!1)};ab.prototype.P$e=function(W){var ta=this;this.zlj(W);if(!(this.Omb||this.ofb&&!W||this.IH)&&this.Deb){this.Omb=!0;var ob=this.context?this.context.creationTime:null,Kb=this.B8g(W);this.Qxd=!0;var qc=this.$.ea,Bb={Name:"EwaAccessTokenExpirationRefreshManager.HandleTokenRefresh",newContextCreated:Kb};Bb.IsUserActive=qc.xf.Kr;Bb.IsSessionActive=qc.sc;Bb.ContainsChangesWorkbookOperations=this.$.userOperationManager.xIa();Bb.isSessionExpired=W;Bb.stopRefreshRetriesUntilTokenExpired=this.ofb;
Bb.FailedToRefreshExpiredToken=this.IH;Bb.numOfFailuresWhileUserIsActive=Vh.a.S6;Bb.numOfFailuresWhileUserIsInActive=Vh.a.T6;Bb.numOfFailuresWhileOffline=Vh.a.tza;Bb.RefreshAccessTokenCorrelationID=this.context.correlationID;Kb&&ob&&(Bb.TimeInMinFromPreviosContextCreation=Math.round(nh.b(Eh.a.Ra,ob)/60));ob=oh.a.Kc(Bb);jc.ULS.sendTraceTag(40416199,0,50,ob);this.TKd.start();this.Hce=qc.xf.Kr;this.Qx=new ai.a;this.kxi(W);var sd=this.iZd.Qbj(!W,this.Qx?this.Qx.token:null);sd.continueWith(function(){ta.k1g();
var Vd=ta.iZd.l7i(sd);ta.TKd.stop();var bf=ta.zfc();if(!Vd||Td.EwaSettings.isChangeGateEnabled("OfficeVSO:5348973_FishbowlFixDuringTokenRefresh")&&bf){var Xf=sd.result.errors;Vd&&bf&&ta.aFg(Xf);ta.q9h(Xf,W)}else ta.ofb=!1,ta.r9h(sd.result.GP,W);ta.Omb=!1},this.$ac?8:0)}};ab.prototype.aFg=function(W){var ta=[Object.assign(new Gb,{Id:"200",Details:"Expired accesstoken recieved on successful token request."})];W.add(Object.assign(new bb,{Name:"ExpiredTokenAfterSuccessfulRefresh",Errors:ta}))};ab.prototype.kxi=
function(W){W&&(this.$.ea.xf.Kr?this.s$f():(this.$.ea.xf.Zsa(this.pFd),this.MIb=!0))};ab.prototype.s$f=function(){var W=this;this.Wtc=Ug.AsyncMethodContext.av(function(){W.Pbj()},1E3*this.ARf,ah.a.xbj,this.Wtc)};ab.prototype.k1g=function(){this.Wtc&&this.Wtc.cancel();this.MIb&&(this.$.ea.xf.YAa(this.pFd),this.MIb=!1);this.Qx=null};ab.prototype.Pbj=function(){jc.ULS.sendTraceTag(537170706,0,15,"EwaAccessTokenExpirationRefreshManager.RefreshTokenDurationThresholdReached durationLimitInSec [{0}]",this.ARf);
this.Qx.C()};ab.prototype.q9h=function(W,ta){this.ofb=!0;ta&&(this.IH||(this.Unb=this.IH=!0),this.iZd.rjc(W)&&(this.hde=!0));var ob=!ta||this.Deb&&!Vh.a.uzc?40380379:39982555;ta=this.mHe(ta);ta.Name="EwaAccessTokenExpirationRefreshManager.HandleRefreshError";ta.FailedToRefreshExpiredToken=this.IH;ta.LastErrorIsPermanent=this.u6;if(0<W.count){var Kb=W.pa(0);ta.errorName=Kb.Name;0<Kb.Errors.length&&(ta.ErrorId=Kb.Errors[0].Id,Kb=Kb.Errors[0].Details,ta.ErrorDetails=this.Mlh(Kb.toString())?"PiiScrubbed":
Kb)}ta=oh.a.Kc(ta);jc.ULS.sendTraceTag(ob,0,15,ta);this.Oa.raiseEvent("TokenRefreshed",new Ua(null,W))};ab.prototype.Mlh=function(W){return Of.a.contains(W,"makes the internet safe for businesses",!0)};ab.prototype.mHe=function(W){var ta={},ob=this.$.ea;ta.Name="";ta.IsUserActive=ob.xf.Kr;ta.IsSessionActive=ob.sc;ta.GotDeploymentOrTimedOutError=ob.Iba;ta.TimeInSecFromLastStatefulSuccessfulRequest=ob.C8;ta.TimeFromLastUserActivityInMs=ob.xf.Pfb;ta.calledFromSessionExpiredFlow=W;ta.RefreshTokenDurationInMS=
this.TKd.Gc;ta.numOfFailuresWhileUserIsActive=Vh.a.S6;ta.numOfFailuresWhileUserIsInActive=Vh.a.T6;ta.numOfFailuresWhileOffline=Vh.a.tza;ta.RefreshAccessTokenCorrelationID=this.context.correlationID;ta.accessTokenTTL=rd.AFrameworkApplication.zk;ta.ContainsChangesWorkbookOperations=this.$.userOperationManager.xIa();ta.IsDocumentHidden=this.documentVisibilityObserver?this.documentVisibilityObserver.Hi.toString():"Unknown";ta.TimeFromFirstOpenInHr=Math.floor(nh.b(Eh.a.Ra,zh.toUtc(ob.PJf))/3600);return ta};
ab.prototype.r9h=function(W,ta){this.IH=!1;this.kZj();this.qig(new Date,rd.AFrameworkApplication.zk);var ob=this.$.ea,Kb=!ta&&ob.xf.Kr,qc=!this.$.isEditMode&&ob.bcb;ta=this.mHe(ta);ta.Name="EwaAccessTokenExpirationRefreshManager.HandleRefreshSuccess";ta.shouldTriggerSilentReloadAfterExpiring=Kb;ta.WopiTokenTaskItemPriority=rd.AFrameworkApplication.Q2d;ta.isDirtyViewSession=qc;ta=oh.a.Kc(ta);jc.ULS.sendTraceTag(39982556,0,15,ta);this.Oa.raiseEvent("TokenRefreshed",new Ua(W,null));qc?ob.xf.Kr&&(jc.ULS.sendTraceTag(537170705,
0,15,"EwaAccessTokenExpirationRefreshManager.HandleRefreshSuccess: User active after refresh dirty view session. trigger request to connect the same server."),ob.Qed()):ob.xf.Kr?Kb&&(W=oe.a(this.$).ud.activityState,W[Vh.a.igb]=!0,W[Og.a.lZ]=!0,W[Ei.a.mt]=this.$.isEditMode,Ih.a(this.$).Jt(new Qf.a(kg.a.yoa,2,null))):ob.sc&&$h.m(this.$.na.ta,!0,!1,!1,null,null,null,null,null)};ab.prototype.kZj=function(){void 0!==this.$.ea.workbookContext.WorkbookUri&&null!==this.$.ea.workbookContext.WorkbookUri?(this.$.ea.workbookContext.WorkbookUri=
dc.a.CU(this.$.ea.workbookContext.WorkbookUri,rd.AFrameworkApplication.sQ,rd.AFrameworkApplication.accessToken),this.$.ea.workbookContext.WorkbookUri=dc.a.CU(this.$.ea.workbookContext.WorkbookUri,rd.AFrameworkApplication.iZ,rd.AFrameworkApplication.zk.toString()),this.$.ea.Uqc()):jc.ULS.sendTraceTag(537170704,0,15,"EwaAccessTokenExpirationRefreshManager.UpdateTokensAtContext: WorkbookUri is null");this.$.ya.AccessToken=rd.AFrameworkApplication.accessToken;this.$.ya.AccessTokenValidTo=rd.AFrameworkApplication.zk;
void 0!==this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion&&null!==this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion&&(this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion=dc.a.CU(this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion,rd.AFrameworkApplication.sQ,rd.AFrameworkApplication.accessToken),this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion=dc.a.CU(this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion,rd.AFrameworkApplication.iZ,rd.AFrameworkApplication.zk.toString()));
void 0!==this.$.ya.EmbedConfiguratorUrl&&null!==this.$.ya.EmbedConfiguratorUrl&&(this.$.ya.EmbedConfiguratorUrl=dc.a.CU(this.$.ya.EmbedConfiguratorUrl,rd.AFrameworkApplication.sQ,rd.AFrameworkApplication.accessToken),this.$.ya.EmbedConfiguratorUrl=dc.a.CU(this.$.ya.EmbedConfiguratorUrl,rd.AFrameworkApplication.iZ,rd.AFrameworkApplication.zk.toString()));this.context.GIb=!0};uk.Object.defineProperties(ab.prototype,{tokenExpired:{configurable:!0,enumerable:!0,get:function(){return this.Unb}},wca:{configurable:!0,
enumerable:!0,get:function(){return this.Hce}},u6:{configurable:!0,enumerable:!0,get:function(){return this.hde}},context:{configurable:!0,enumerable:!0,get:function(){return this.VT}},Deb:{configurable:!0,enumerable:!0,get:function(){return this.u6?!1:this.$.ea.xf.Kr?1>Vh.a.S6:6>Vh.a.T6}},VKd:{configurable:!0,enumerable:!0,get:function(){return this.Omb}}});Object(zc.a)(ab,"EwaAccessTokenExpirationRefreshManager",null,[934,172,3]);Fa.ZZb="ActivityDuration";Fa.error="Error";Fa.Gqh="Errors";Fa.failed=
"Failed";Fa.GHh="FirstActivity";Fa.initialized="Initialized";Fa.Cvi="LastActivity";Fa.inj="RetryOverride";Fa.Xkj="RequestGroups";Fa.requests="Requests";Fa.MXf="Responses";Fa.Oxc="SessionDuration";Fa.status="Status";Fa.success="Success";Fa.GP="Tokens";Object(zc.a)(Fa,"SessionExpirationStrings",null,[]);Aa.prototype.$kg=function(){var W={};jc.ULS.sendTraceTag(41964821,217,50,jc.ULS.Kc((W.Aggregate=this.BY,W.Current=this.So,W)))};Aa.prototype.$fi=function(){this.BY[Fa.Xkj]=0;this.BY[Fa.requests]=0;this.BY[Fa.MXf]=
0;this.BY[Fa.status]=Fa.initialized;this.BY[Fa.GHh]=new Date;this.BY[Fa.Oxc]=0;this.BY[Fa.ZZb]=0;this.BY[Fa.Oxc]=0;this.So[Fa.Oxc]=0;this.BY[Fa.ZZb]=0;this.So[Fa.ZZb]=0};Aa.prototype.Aod=function(W,ta){var ob=W[ta];ob=ob?ob:0;ob++;W[ta]=ob;this.ZRd(W)};Aa.prototype.ZRd=function(W){var ta=new Date;W[Fa.ZZb]=+ta-+this.xVb;this.xVb=ta;W[Fa.Oxc]=+this.xVb-+this.Hzg;W[Fa.Cvi]=this.xVb};Aa.prototype.feb=function(W,ta){this.So[W]=ta;this.ZRd(this.So)};Aa.prototype.$1f=function(W,ta){this.So[W]=ta;this.ZRd(this.So)};
Aa.prototype.incrementCounter=function(W){this.Aod(this.So,W);this.Aod(this.BY,W);this.Aod(this.Sxg,W)};Aa.prototype.flush=function(){this.Cce||(this.BY[Fa.status]=this.So[Fa.status],this.$kg(this.KYb),this.re.doa(this.KYb,6E4*this.pqf))};Aa.prototype.stop=function(){jc.ULS.sendTraceTag(41964822,217,100,"Stopping logger. Flushing one last time");this.flush();this.Cce=!0;this.re.kq(this.KYb)};Object(zc.a)(Aa,"SessionLogger",null,[963]);var Xi=b(738),yj=b(1145);qa.prototype.kSi=function(W){if(W.MessageId!==
cc.a.Hnd)ge.a(39408099,306,15,"Unexpected message.");else{var ta=new Yc.a,ob=new Yc.a;this.sj.incrementCounter(Fa.MXf);var Kb=W.Values[hc.a.f1f];if(!Kb||0>=Kb.length)ge.a(40122317,306,15,"Found no tokens in the dictionary"),Kb=W.Values;ge.a(40122318,306,100,"The Tokens array contains {0} tokens",Kb.length);this.sj.feb("Correlation",W.CorrelationId);for(var qc="",Bb=0;Bb<Kb.length;Bb++){this.sj.$1f(Fa.GP,Kb.length);var sd=Kb[Bb],Vd=sd;if(Vd&&Vd.Name){this.sj.incrementCounter(Vd.Name);var bf=sd;if(bf&&
bf.Value)ge.a(39408128,306,100,"Received token with name: {0}",bf.Name),ta.add(bf),this.UYb.add(bf),this.sj.feb(Fa.status,Fa.success),this.m9d&&this.rU&&this.rU.Ylj();else if(sd=this.K1h(sd),ge.a(39408129,306,15,"Received error for token {0}. Creating error object from {1}, TaskId {2}",Vd.Name,JSON.stringify(sd),this.oha),ob.add(sd),this.bU.add(sd),qc=JSON.stringify(sd),this.sj.feb(Fa.error,JSON.stringify(sd)),this.sj.feb(Fa.status,Fa.failed),this.m9d)for(Vd=Cl(sd.Errors),sd=Vd.next();!sd.done;sd=
Vd.next())sd=this.TTh(sd.value),this.rU&&this.rU.oHg(sd)}}0<ob.count&&""!==qc?(Kb=Object.assign(new lf.a,{extendedProperties:new Map}),Kb.extendedProperties.set("Errors",qc),le.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,Kb)):le.Health.instance.recordKpiSuccess("WACTokenRefresh",null);ge.a(39408130,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",ta.count,ob.count,W.CorrelationId,this.oha);0<ob.count&&!this.rjc(ob)?(W=
this.h$.g1h(ob),W!==this.h$.SOd&&(this.sj.$1f(Fa.inj,W),this.re.doa(this.ej,W))):(this.sj.flush(),this.ej&&(ge.a(39408131,306,100,"Deleting task {0} from task manager",this.ej.name),this.re.kq(this.ej)),this.gm&&!this.gm.task.isCompleted&&this.gm.setResult(new Ua(ta,ob)))}};qa.prototype.K1h=function(W){if(!W)return null;var ta=Object.assign(new bb,{Name:W.Name,Errors:[]});W=Cl(W.Errors);for(var ob=W.next();!ob.done;ob=W.next()){ob=ob.value;var Kb=new Gb;Kb.Id=ob.Id;Kb.Details=this.J1h(ob.Details);
ta.Errors.push(Kb)}return ta};qa.prototype.J1h=function(W){if(!W)return"";var ta=W.toLowerCase();return 0<ta.indexOf("<!doctype")?this.Djd("Seems to contain HTML - Contains <!DOCTYPE"):0<ta.indexOf("<html")?this.Djd("Seems to contain HTML - Contains <html>"):500<ta.length?this.Djd(String.format("Error details content too long: Length: {0}",ta.length)):W};qa.prototype.Djd=function(W){return String.format("{0} - Reason: [{1}]","### REDACTED ###",W)};qa.prototype.requestTokensOnce=function(){this.UWf()};
qa.prototype.UWf=function(){rd.AFrameworkApplication.nmc("SendSynchronousPostMessage;SendSynchronousPostMessageIsEnabledCf");this.lsa>=this.h$.sEi?(ge.a(39408132,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",this.oha),this.sHe(this.gm,"TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts")):(le.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null),this.asj())};qa.prototype.asj=function(){var W={};W[hc.a.f1f]=
this.h$.GP;var ta=Mg.a.create().toString();ge.a(39408133,306,50,"Refreshing tokens {0}. Attempt {1}. Correlation {2}. TaskId {3}.",JSON.stringify(this.h$.GP),this.lsa+1,ta,this.oha);this.yhe.execute(function(ob){ob.Nj(cc.a.aue,W,ta)});this.lsa++;this.sj.incrementCounter(Fa.requests)};qa.prototype.sHe=function(W,ta,ob){for(var Kb=new Yc.a,qc=0;qc<this.h$.GP.length;qc++){var Bb=Object.assign(new bb,{Name:this.h$.GP[qc],Errors:[Object.assign(new Gb,{Id:ta,Details:ob})]});Kb.add(Bb);this.bU.add(Bb)}this.re.kq(this.ej);
this.sj.feb(Fa.Gqh,JSON.stringify(this.bU));this.sj.feb(Fa.status,Fa.failed);W&&!W.task.isCompleted&&W.setResult(new Ua(new Yc.a,this.bU))};qa.prototype.Qbj=function(W,ta){var ob=this;ta=void 0===ta?null:ta;this.mme.start();this.pVb=W;this.oha=Mg.a.create().toString();ge.a(41755338,306,50,"RefreshTokens Start, TaskId: [{0}]. IsTokenExpiring: [{1}].",this.oha,this.pVb);this.lsa=0;this.bU.clear();this.UYb.clear();var Kb=new $c.a;this.gm=Kb;ta&&ta.R(function(){var qc=!!Kb&&!Kb.task.isCompleted;ge.a(588096223,
306,50,"RefreshTokens Cancelled, TaskId: [{0}]. IsTokenExpiring: [{1}]. isTaskStillRunning [{2}].",ob.oha,ob.pVb,qc);qc&&ob.sHe(Kb,"ABORTED_BY_CALLER","The refresh was aborted by the caller")});this.ej=new he.a(this.h$.priority,2,this.h$.SOd,Object($e.a)(this,this.requestTokensOnce,"requestTokensOnce"),98,cc.a.aue,!0);this.Bzg&&this.UWf();this.re.$g(this.ej);return this.gm.task};qa.prototype.l7i=function(W){this.mme.stop();var ta=this.C$h(W.result.errors);jc.ULS.sendTraceTag(41755339,217,50,"ProcessTokensOrErrors: TokenRefreshResult:{0},TaskId:{1},IsTriggerByTokenExpiring:{2},RetryCount:{3},TotalErrorCount:{4},LastErrorName:{5},LastErrorId:{6},LastErrorDetail:{7}",
!ta,this.oha,this.pVb,this.lsa,this.bU.count,0<W.result.errors.count?W.result.errors.pa(0).Name:"",0<W.result.errors.count&&0<W.result.errors.pa(0).Errors.length?W.result.errors.pa(0).Errors[0].Id:"",0<W.result.errors.count&&0<W.result.errors.pa(0).Errors.length?W.result.errors.pa(0).Errors[0].Details:"");return ta?!1:this.k7i(W.result.GP)};qa.prototype.rjc=function(W){return this.h$.rjc(W)};qa.prototype.k7i=function(W){for(var ta=0;ta<W.count;ta++){var ob=W.pa(ta);if(ob.Name===hc.a.accessToken){var Kb=
(new Date).getTime();if(ob.Expiry>rd.AFrameworkApplication.zk){var qc={};jc.ULS.sendTraceTag(39706827,217,50,"Updating AccessToken: {0}",(qc.AccessTokenTtl=ob.Expiry,qc.NowGetTime=Kb,qc.BootTime=rd.AFrameworkApplication.nia,qc),"PreviousAccessTokenTtl",rd.AFrameworkApplication.zk);rd.AFrameworkApplication.accessToken=ob.Value;rd.AFrameworkApplication.zk=Math.floor(ob.Expiry);rd.AFrameworkApplication.O2d=Kb;rd.AFrameworkApplication.BZa=Math.floor(ob.Expiry)}else qc={},jc.ULS.sendTraceTag(39706828,
217,15,"Ignoring AccessToken because it expires sooner than the current one: {0}",(qc.AccessTokenTtl=ob.Expiry,qc.NowGetTime=Kb,qc.BootTime=rd.AFrameworkApplication.nia,qc),"PreviousAccessTokenTtl",rd.AFrameworkApplication.zk)}}return!0};qa.prototype.C$h=function(W){for(var ta=!1,ob=0;ob<W.count;ob++){ta=!0;var Kb=W.pa(ob);jc.ULS.sendTraceTag(39706829,217,15,"Received error for token {0}. Errors: {1}. TaskId: {2} ",Kb.Name,JSON.stringify(Kb.Errors),this.oha)}return ta};qa.prototype.TTh=function(W){var ta=
Ye.a.Nxc;W=parseInt(W.Id);if(isNaN(W))ta=Ye.a.Q1j;else{switch(W){case 401:ta=Ye.a.T1j;break;case 403:ta=Ye.a.O1j;break;case 500:ta=Ye.a.P1j;break;case 503:ta=Ye.a.S1j}ta===Ye.a.Nxc&&(ta=500<W?Ye.a.R1j:Ye.a.N1j)}return ta};Object(zc.a)(qa,"TokenRefreshManager",null,[933]);ha.prototype.rjc=function(W){var ta=JSON.stringify(W);if(this.JVc&&0<this.JVc.length)for(var ob=Cl(this.JVc),Kb=ob.next();!Kb.done;Kb=ob.next())if(Kb=Kb.value,0<Kb.length&&0<=ta.indexOf(Kb))return!0;if(rd.AFrameworkApplication.ha&&
rd.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.WordOnline.StopTokenRefreshOn403",!1))for(W=Cl(W),Kb=W.next();!Kb.done;Kb=W.next())if(Kb=Kb.value,Kb.Errors)for(ta=Cl(Kb.Errors),Kb=ta.next();!Kb.done;Kb=ta.next())if((Kb=Kb.value)&&"403"===Kb.Id)return!0;return!1};ha.prototype.g1h=function(W){try{if(W)for(var ta=Cl(W),ob=ta.next();!ob.done;ob=ta.next()){var Kb=ob.value;if(Kb.Errors)for(var qc=Cl(Kb.Errors),Bb=qc.next();!Bb.done;Bb=qc.next()){var sd=Bb.value;if(sd.Id in this.Rie)return Number.parseInvariant(this.Rie[sd.Id].toString());
if(this.VNc)try{if(500<=Number.parseInvariant(sd.Id))return rd.AFrameworkApplication.nmc("RetryIntervalOverrideOnServerError;RetryIntervalOverrideOnServerErrorcf"),this.Uie}catch(Vd){jc.ULS.sendTraceTag(540541017,217,50,"Unable to parse Error id to int. Exception {0}, ErrorId: {1}",Vd.toString(),sd.Id)}}}}catch(Vd){jc.ULS.sendTraceTag(41501720,217,50,"TokenRefreshPolicy:GetRetryIntervalOverride, exception:{0}",Vd.toString())}return this.SOd};ha.prototype.Hxj=function(){var W={};try{if(!rd.AFrameworkApplication.Gec()||
0>=rd.AFrameworkApplication.Gec().length||""===rd.AFrameworkApplication.Gec()[0])return W;for(var ta=Cl(rd.AFrameworkApplication.Gec()),ob=ta.next();!ob.done;ob=ta.next()){var Kb=ob.value;0<Kb.length&&(W[Kb]=rd.AFrameworkApplication.V1j)}}catch(qc){jc.ULS.sendTraceTag(41755340,217,50,"TokenRefreshPolicy:SetRetryIntervalForNetworkIssue, exception:{0}",qc.toString())}return W};Object(zc.a)(ha,"TokenRefreshPolicy",null,[932]);var yi=wf.a;Am(da,yi);da.prototype.create=function(){rd.AFrameworkApplication.kO("Microsoft.Office.Excel.Server.Flighting.IDenyListRefreshAccessTokenSilentlyV2_ManagerCreated");
rd.AFrameworkApplication.ha.ra("RefreshAccessTokenSilently")?this.Eb(this.v$g()):this.Eb(this.$.da.Aa(38)||this.$.da.Ha(38,new oa(this.$)))};da.prototype.v$g=function(){var W=this.$.da.Aa(38);if(W)return W;W=new qa(rd.AFrameworkApplication.Yi,rd.AFrameworkApplication.jW(),new ha);return this.$.da.Ha(38,new ab(this.$,W))};da.ka=function(W){W.da.Ha(39,new da(W))};Object(zc.a)(da,"AccessTokenExpirationManagerFactory",wf.a,[]);var Hg=Be.a;Am(ka,Hg);ka.prototype.pLg=function(W){this.addHandler("TAF",W)};
ka.prototype.Eij=function(W){this.removeHandler("TAF",W)};ka.prototype.X8i=function(){this.raiseEvent("TAF")};Object(zc.a)(ka,"GridHighlightBehaviorEventManager",Be.a,[931,3]);var ni=wf.a;Am(ra,ni);ra.prototype.create=function(){this.Eb(this.$.da.Aa(376)||new ka(this.$))};ra.ka=function(W){W.da.Ha(377,new ra(W))};Object(zc.a)(ra,"GridHighlightBehaviorEventManagerFactory",wf.a,[]);var jj=b(120),Y=Sys.EventArgs;Am(ba,Y);Object(zc.a)(ba,"MarqueeResizeStartedOrEndedEventArgs",Sys.EventArgs,[]);var Ra=
Be.a;Am(ia,Ra);ia.prototype.KJg=function(W){this.addHandler("mrek",W)};ia.prototype.dA=function(W,ta,ob){for(var Kb=Cl(this.gridView.zn),qc=Kb.next();!qc.done;qc=Kb.next())Pf.a.instance.qa(Sd.a.ph,qc.value.domElement,W);Pf.a.instance.qa(Sd.a.$d,document.documentElement,ta);this.gridView.Ac.C9b(!0);ob&&Pf.a.instance.qa(Sd.a.Ky,this.gridView.Fj,ta)};ia.prototype.R_d=function(W,ta,ob){for(var Kb=Cl(this.gridView.zn),qc=Kb.next();!qc.done;qc=Kb.next())Pf.a.instance.za(Sd.a.ph,qc.value.domElement,W);Pf.a.instance.za(Sd.a.$d,
document.documentElement,ta);this.gridView.Ac.C9b(!1);ob&&Pf.a.instance.za(Sd.a.Ky,this.gridView.Fj,ta)};ia.prototype.Lcj=function(W,ta){for(var ob=Cl(this.gridView.zn),Kb=ob.next();!Kb.done;Kb=ob.next())Mf.a.instance.qa(Sd.a.Dg,Kb.value.domElement,W);Mf.a.instance.qa(Sd.a.Ce,document.documentElement,ta)};ia.prototype.GUj=function(W,ta){for(var ob=Cl(this.gridView.zn),Kb=ob.next();!Kb.done;Kb=ob.next())Mf.a.instance.za(Sd.a.Dg,Kb.value.domElement,W);Mf.a.instance.za(Sd.a.Ce,document.documentElement,
ta)};ia.prototype.oHe=function(W,ta,ob,Kb){var qc=document.createElement("div");qc.className=ta;ta=Cl(ob);for(ob=ta.next();!ob.done;ob=ta.next())qc.classList.add(ob.value);W.appendChild(qc);Pf.a.instance.qa(Sd.a.pointerDown,qc,Kb);return qc};ia.prototype.x6e=function(W){W=W.Mb.parentNode;if(!W)return jc.ULS.shipAssertTag(537159394,0,!1,"BehaviorHelperMethods.GetSelectedMarqueeHighlightState: selectedHighlightElement is null."),null;W=parseInt(W.getAttribute(fe.a.Czb),10);return isNaN(W)?(jc.ULS.shipAssertTag(537159393,
0,!1,"BehaviorHelperMethods.GetSelectedMarqueeHighlightState: indexInMarqueeCollection is not a valid number."),null):this.gridView.Fb.Iw(3,1,W)};ia.prototype.ULb=function(W,ta,ob){W=(void 0===ob?!0:ob)&&!!this.coloredReferencesManager&&this.coloredReferencesManager.Qoi(W);ta=Cl(ta);for(ob=ta.next();!ob.done;ob=ta.next())ef.DOMElementExtensions.setVisible(ob.value,W)};ia.prototype.Vfd=function(){return this.gridView.yj?jj.a(this.gridView.$):this.gridView.zc};ia.prototype.RQf=function(){var W=this.Vfd();
W&&this.coloredReferencesManager?this.coloredReferencesManager.mY(W,null):(jc.ULS.sendTraceTag(537159392,0,10,"BehaviorHelperMethods.RecalculateColoredReferences: Can't UpdateColoredReferences, will hide all marquee as a last fallback."),this.gridView.Fb.si(this.gtf),this.gridView.Fb.ak(null,this.gtf))};ia.prototype.cPf=function(W,ta){this.raiseEvent("mrek",new ba(W,ta))};uk.Object.defineProperties(ia.prototype,{coloredReferencesManager:{configurable:!0,enumerable:!0,get:function(){var W=this.gridView.$.da.Aa(281);
W||jc.ULS.sendTraceTag(537159395,0,50,"BehaviorHelperMethods.ColoredReferencesManager: coloredReferencesManager is null. (This is not always an error, for example when called from SetMarqueeHandlesVisibility while moving between view and edit modes).");return W}}});Object(zc.a)(ia,"BehaviorHelperMethods",Be.a,[]);var Db=mf.a;Am(aa,Db);aa.prototype.r_a=function(){};Object(zc.a)(aa,"HighlightFlyweightBehavior",mf.a,[]);var ec=b(494),gd=b(114),Jd=b(9),Xd=b(70),xe=be.a;Am(J,xe);J.prototype.kre=function(W){this.addHandler("GrDrag",
W)};J.prototype.vUf=function(W){this.removeHandler("GrDrag",W)};J.prototype.jre=function(W){this.addHandler("GrContxt",W)};J.prototype.uUf=function(W){this.removeHandler("GrContxt",W)};J.prototype.lre=function(W){this.addHandler("GrPointerUp",W)};J.prototype.wUf=function(W){this.removeHandler("GrPointerUp",W)};J.prototype.dispose=function(){$f.a.Tna(this.domElement);xe.prototype.dispose.call(this)};J.prototype.Jhg=function(W){this.domElement.parentNode.removeChild(this.domElement);W.appendChild(this.domElement)};
J.prototype.w1f=function(){this.domElement.classList.remove(Xd.a.H$b);this.ZLa.classList.remove(Xd.a.G$b);this.ZLa.classList.add(Xd.a.IUe)};J.prototype.Zfg=function(){this.ZLa.classList.remove(Xd.a.IUe);this.ZLa.classList.add(Xd.a.G$b);this.domElement.classList.add(Xd.a.H$b)};J.prototype.Q$h=function(W){return!!this.e7b&&(3<Math.abs(W.x-this.e7b.x)||3<Math.abs(W.y-this.e7b.y))};J.Kwb=function(W){var ta=Td.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest"),ob=rf.a.uf;return ta&&!ob?
(W=Cf.a(W.$)?Cf.a(W.$).zoom:Jd.a.x0,Math.round(9/Math.max(W,1))):9};J.Tyd=0;Object(zc.a)(J,"TouchGrippie",be.a,[]);Am(P,aa);P.prototype.dispose=function(){$g.a.tc([this.HP,this.dN]);this.HP.vUf(this.mIf);this.HP.uUf(this.upc);this.HP.wUf(this.vpc);this.dN.vUf(this.Oyf);this.dN.uUf(this.upc);this.dN.wUf(this.vpc);for(var W=Cl(this.gridView.zn),ta=W.next();!ta.done;ta=W.next())ta=ta.value,Mf.a.instance.za(Sd.a.Mf,ta.domElement,this.FCf),Mf.a.instance.za(Sd.a.Ce,ta.domElement,this.ECf);this.gridView.view.fr(this.ax);
this.gridView.zc.$k(this.QNe);this.gridView.Fb.wJb(this.Pza);this.gridView.Luc(this.Cyf);this.gridView.$.UD(this.utc);this.gridView.Nt(this.utc);this.ga.EX(this.zh);this.ga.Q7(this.Gp);this.gridView.wG(this.Fp);this.ga.Puc(this.wCf);Hb.a.EUf(this.MFb);this.jca&&jc.ULS.sendTraceTag(537159314,0,15,"SelectionTouchGrippiesBehaviorBase.Dispose during autofill mode");(W=this.gridView.$.da.Aa(376))&&W.Eij(this.nIf);aa.prototype.dispose.call(this)};P.prototype.wTa=function(){if(!this.Rba.range||!this.Rba.range.equals(this.Ddb))return!1;
var W=!this.gridView.PNa();return this.gridView.isEditing&&W&&(this.Ddb.isRow||this.Ddb.Xf)?!1:this.jca?!0:3===Hb.a.$b};P.prototype.H5=function(){this.Ppb&&(this.HP.set_visible(!1),this.dN.set_visible(!1),this.Ppb=!1)};P.prototype.Woa=function(){if(this.wTa()){this.bYj();var W=ef.DOMElementExtensions.getBoundingClientRect(this.grb);W||jc.ULS.shipAssertTag(537159313,0,!1,"grippiesParentBounds is null. IsNamedObjectViewMode: {0}, isNov15: {1}, areGrippiesAttachedToNovFocusPane: {2}GridView.ContainerElement: {3}, Freezepanes: {4}",
this.gridView.$.ea.isNamedObjectViewMode,this.sjf,this.sZc,this.gridView.Fj,this.gridView.rb.jj);var ta=ef.DOMElementExtensions.getBoundingClientRect(this.Grj),ob=new Sys.UI.Bounds(ta.x-W.x,ta.y-W.y,ta.width,ta.height),Kb=this.Ddb,qc=Kb.topLeft,Bb=Kb.bottomRight,sd=Kb.isRow||Kb.Xf;if(Kb.Xf){var Vd=this.UGh();Kb=ob.x-2*J.Kwb(this.gridView);var bf=Vd;var Xf=ob.x+ta.width}else Kb.isRow?(Kb=Xf=this.TGh(),bf=ob.y-2*J.Kwb(this.gridView),Vd=ob.y+ta.height):(bf=ob.y,Vd=ob.y+ta.height,this.gridView.rtl?(Kb=
ob.x+ta.width,Xf=ob.x):(Kb=ob.x,Xf=ob.x+ta.width));ta=J.Tyd+(sd?0:J.Kwb(this.gridView));this.HP.style.left=tf.HelperMethods.Yb(Kb-ta);this.HP.style.top=tf.HelperMethods.Yb(bf-ta);this.dN.style.left=tf.HelperMethods.Yb(Xf-ta);this.dN.style.top=tf.HelperMethods.Yb(Vd-ta);this.HP.set_visible(this.Zhf(bf,Kb,qc,sd,W));this.dN.set_visible(this.Zhf(Vd,Xf,Bb,sd,W));this.Ppb=!0}};P.prototype.Zhf=function(W,ta,ob,Kb,qc){var Bb=ef.DOMElementExtensions.getBoundingClientRect(this.gridView.Kf(this.paneType).domElement);
qc=new Sys.UI.Bounds(Bb.x-qc.x-3,Bb.y-qc.y-3,Bb.width+6,Bb.height+6);return(this.gridView.rb.wj(ob)===this.paneType||Kb)&&za.a.IB(qc,new Sys.UI.Point(ta,W))};P.prototype.bYj=function(){if(this.sjf!==this.sZc){this.grb=null;var W=this.Mdd();this.HP.Jhg(W);this.dN.Jhg(W)}};P.prototype.UGh=function(){return(this.gridView.view.visibleArea.height+this.gridView.rb.height+J.Tyd-J.Kwb(this.gridView))/2};P.prototype.TGh=function(){return(this.gridView.view.visibleArea.width+this.gridView.rb.width+J.Tyd-J.Kwb(this.gridView))/
2};P.prototype.uGf=function(){this.Woa()};P.prototype.Jmi=function(W){return ef.DOMElementExtensions.tdb(W.Mb,cg.a.il)&&(this.Lni(W)||this.Mni(W))};P.prototype.Mni=function(W){if(this.gridView.rtl)W=W.clientPoint.x;else{var ta=ef.DOMElementExtensions.getBoundingClientRect(W.Mb);W=W.clientPoint.x-(ta.x+ta.width-gd.a.Mp)}return 0<W&&W<=gd.a.Mp};P.prototype.Lni=function(W){var ta=ef.DOMElementExtensions.getBoundingClientRect(W.Mb);W=W.clientPoint.y-(ta.y+ta.height-gd.a.Mp);return 0<W&&W<=gd.a.Mp};P.prototype.GCf=
function(W,ta){this.jca&&jc.ULS.sendTraceTag(537159312,0,50,"SelectionTouchGrippiesBehaviorBase: Performing Touch Autofill");this.ga.Q1c(W,ta,this.jca);this.H5()};P.prototype.euj=function(){this.jca||(jc.ULS.sendTraceTag(537159311,0,50,"SelectionTouchGrippiesBehaviorBase.SetAutoFillMode"),this.jca=!0,this.HP.w1f(),this.dN.w1f(),this.gridView.ga.sourceRange=this.gridView.ga.va.xd,this.Woa())};P.prototype.V_d=function(){this.jca&&(jc.ULS.sendTraceTag(537159310,0,50,"SelectionTouchGrippiesBehaviorBase.UnsetAutoFillMode"),
this.jca=!1,this.HP.Zfg(),this.dN.Zfg())};P.prototype.Mdd=function(){this.grb||(this.sZc=!1,this.grb=this.gridView.Fj);return this.grb};uk.Object.defineProperties(P.prototype,{gridView:{configurable:!0,enumerable:!0,get:function(){return this.aw}}});Object(zc.a)(P,"SelectionTouchGrippiesBehaviorBase",aa,[]);Am(I,P);I.prototype.wTa=function(){var W=this.gridView.Vi||this.gridView.isEditing;return!this.gridView.ga.va.Wg&&!W&&P.prototype.wTa.call(this)};uk.Object.defineProperties(I.prototype,{K5:{configurable:!0,
enumerable:!0,get:function(){return 19}},Ddb:{configurable:!0,enumerable:!0,get:function(){return this.gridView.ga.va.activeRange}}});Object(zc.a)(I,"DiscontinuousSelectionTouchGrippiesBehavior",P,[]);var cf=b(326);Am(S,aa);Object(zc.a)(S,"SelectionBorderBehavior",aa,[]);Z.KBh="ewr-selection-draghandle";Z.NBh="ewr-selection-draghandle-grab";Z.TBh="ewr-selection-draghandle-top-ie";Z.SBh="ewr-selection-draghandle-top";Z.MBh="ewr-selection-draghandle-bottom-ie";Z.LBh="ewr-selection-draghandle-bottom";
Z.PBh="ewr-selection-draghandle-left-ie";Z.OBh="ewr-selection-draghandle-left";Z.RBh="ewr-selection-draghandle-right-ie";Z.QBh="ewr-selection-draghandle-right";Z.OUe="ewr-selection-dragtooltip";Z.PUe="ewr-selection-dragtooltip-updated";Z.dCh="ewr_selection_rearrangeleft";Z.eCh="ewr_selection_rearrangeright";Z.fCh="ewr_selection_rearrangetop";Z.cCh="ewr_selection_rearrangebottom";Z.selecting="selecting";Z.gCh="ewr-selection-resizemarqueehandle";Z.jCh="ewr-selection-resizemarqueehandle-topleft";Z.kCh=
"ewr-selection-resizemarqueehandle-topright";Z.hCh="ewr-selection-resizemarqueehandle-bottomleft";Z.iCh="ewr-selection-resizemarqueehandle-bottomright";Z.ABh="ewr-marquee-thick";Z.EBh="ewr-resizemarqueehandle-thick";Object(zc.a)(Z,"CssClassNames",null,[]);Am(ea,S);ea.prototype.dispose=function(){var W=this;this.zs.forEach(function(ta){Pf.a.instance.za(Sd.a.pointerDown,ta,W.onPointerDown)});Array.clear(this.zs);this.Ina=this.sourceRange=this.Nb=null;jc.ULS.sendTraceTag(537159381,0,50,"DragSelectionClickBehaviorBase.Dispose: ActiveRegistrationCount = {0}, EwaControl is null : {1}",
this.Psa,!this.$);this.$&&(this.$.Bl(this.vd),1===this.Psa&&(jc.ULS.sendTraceTag(537159380,0,15,"DragSelectionClickBehaviorBase.Dispose: Some handlers are still registered"),this.du(this.noe,this.ooe,!1)));S.prototype.dispose.call(this)};ea.prototype.Sf=function(W){W=Cf.a(this.$).se(W);return this.AEd(W)};ea.prototype.AEd=function(W){if(5!==this.Tj)return!1;(W=this.cQa(W))||this.svb(!1);ud.b(this.$,!1);return W};ea.prototype.Uh=function(W){W=Cf.a(this.$).se(W);if(this.Zh&&this.zEd(W))return!0;if(W=
this.ga.Ip(W.clientPoint,W.Mb,5,void 0,void 0,!0)){W=this.yia(W);if(this.Nb.equals(W))return!0;this.Nb=W;if(!this.jE())return jc.ULS.shipAssertTag(537159378,0,!1,"DragSelectionClickBehaviorBase.OnPointerMove: UpdateHighlightOnMove failed"),this.svb(!0),!1}return!0};ea.prototype.dA=function(W,ta){jc.ULS.shipAssertTag(537159377,0,!this.Psa,"DragSelectionClickBehaviorBase.RegisterHandlersForMouse: More than one active registration is not expected");this.Psa+=1;this.noe=W;this.ooe=ta;this.$o.dA(W,ta,
this.PCc())};ea.prototype.yia=function(W){if(!W||!this.Nb)return jc.ULS.shipAssertTag(537159376,0,!!W,"DragSelectionClickBehaviorBase.CalculateDragRange: mouseSelectionRange is null"),jc.ULS.shipAssertTag(537159375,0,!!this.Nb,"DragSelectionClickBehaviorBase.CalculateDragRange: CurrentRange is null"),null;var ta=this.Nb.clone();1!==this.hF&&(ta.left=Math.max(W.left-this.hgc,1),ta.right=ta.left+this.sourceRange.width-1);2!==this.hF&&(ta.top=Math.max(W.top-this.WEc,1),ta.bottom=ta.top+this.sourceRange.height-
1);return this.vpb(ta)};ea.prototype.du=function(W,ta,ob,Kb){ob=void 0===ob?!0:ob;Kb=void 0===Kb?!0:Kb;jc.ULS.shipAssertTag(537159374,0,1===this.Psa,"DragSelectionClickBehaviorBase.CleanUp: Expected exactly one active registration");--this.Psa;this.Zh||Ke.g(this.$).Lg.Np(fe.a.v5);this.$o.R_d(W,ta,this.PCc());ob&&this.Jrb(Kb);this.hF=0;this.aUa=!1};ea.prototype.vpb=function(W){var ta=Ke.g(this.$),ob=W;if(ta.rb.z5){if(!ta.rc(W.topLeft)){ta=ta.Pk("DragSelectionClickBehaviorBase.AdjustHiddenRowColumns",
ta.vB,this.Ina.top!==W.top?1:2);try{ta.jl=this.Ina.top<W.top||this.Ina.left<W.left,ta.Js(W.topLeft),ob=ta.$$cu().range}finally{ta&&ta.dispose()}}ob.right=ob.left+W.width-1;ob.bottom=ob.top+W.height-1}return this.Ina=ob};ea.prototype.iyc=function(W){this.zs.forEach(function(ta){ef.DOMElementExtensions.setVisible(ta,W)})};ea.prototype.yYh=function(W){var ta=W.Mb;W=W.clientPoint;if(!ta||!W)return jc.ULS.shipAssertTag(537159373,0,!!ta,"DragSelectionClickBehaviorBase.GetMouseSelectionRange: source is null"),
jc.ULS.shipAssertTag(537159372,0,!!W,"DragSelectionClickBehaviorBase.GetMouseSelectionRange: point is null"),null;W.y+=ta===this.zs[ea.IJa]?2:ta===this.zs[ea.a$c]?-2:0;W.x+=ta===this.zs[ea.b$c]?2:ta===this.zs[ea.HJa]?-2:0;return this.ga.Ip(W,ta,5,void 0,void 0,!0)};uk.Object.defineProperties(ea.prototype,{Fb:{configurable:!0,enumerable:!0,get:function(){return Ke.g(this.$).Fb}},Tj:{configurable:!0,enumerable:!0,get:function(){return this.ga.selectionType},set:function(W){this.ga.selectionType=W}}});
ea.W9c="move";ea.nub="grabbing";ea.IJa=0;ea.a$c=1;ea.b$c=2;ea.HJa=3;Object(zc.a)(ea,"DragSelectionClickBehaviorBase",S,[]);Am(O,ea);O.prototype.r_a=function(W){this.$o.ULb(W,this.zs);this.Ay.cBa()};O.prototype.yEd=function(W){jc.ULS.sendTraceTag(537159390,0,50,"DragMarqueeClickBehavior.OnPointerDownInternal: Starting drag marquee operation.");this.gridView.LMa=!0;this.Za.$E(!1);this.Tj=5;this.Ay.wNe(W.Mb);this.Za.textBox.removeSelection();this.Za.a0b(this.i$e);this.dA(Object($e.a)(this,this.Uh,"onPointerMove"),
Object($e.a)(this,this.Sf,"onPointerUp"));this.hF=this.sourceRange.isRow?1:this.sourceRange.Xf?2:0};O.prototype.cQa=function(){var W=this.mP();this.Tj=-1;this.du(Object($e.a)(this,this.Uh,"onPointerMove"),Object($e.a)(this,this.Sf,"onPointerUp"));return W};O.prototype.Jrb=function(){this.gridView.LMa=!1;this.Ay.xNe(this.zs[0]);this.Za.textBox.setCaretPositionToEnd();this.Za.avc(this.i$e);this.$o.RQf()};O.prototype.svb=function(W){jc.ULS.sendTraceTag(537159389,0,10,"DragMarqueeClickBehavior.FailureFallback: Operation failed, will try to recalculate colored references as a fallback in CleanUp.");
W&&this.du(Object($e.a)(this,this.Uh,"onPointerMove"),Object($e.a)(this,this.Sf,"onPointerUp"))};O.prototype.aec=function(W){this.Za=this.$o.Vfd();this.cM=this.$o.x6e(W);return this.Za&&this.cM&&this.cM.range?this.cM.range:(jc.ULS.shipAssertTag(537159388,0,!!this.Za,"DragMarqueeClickBehavior.GetSelectedRange: cellContentEditor is null"),jc.ULS.shipAssertTag(537159387,0,!!this.cM,"DragMarqueeClickBehavior.GetSelectedRange: selectedHighlightState is null"),jc.ULS.shipAssertTag(537159386,0,!!this.cM.range,
"DragMarqueeClickBehavior.GetSelectedRange: selectedHighlightState.Range is null"),null)};O.prototype.mP=function(){return this.cM?this.coloredReferencesManager.Ruf(this.Za,this.cM,this.Nb):(jc.ULS.shipAssertTag(537159385,0,!1,"DragMarqueeClickBehavior.SetSelectedRange called when selectedHighlightState is null. It shouldn't be null while dragging a marquee highlight."),!1)};O.prototype.jE=function(){return this.mP()};O.prototype.PCc=function(){return!0};O.prototype.zEd=function(){return!1};Object(zc.a)(O,
"DragMarqueeClickBehavior",ea,[]);var pf=b(973),ff=b(918),tg=b(118);Object(zc.a)(U,"MacroRecorderTableRowColumnRearrangedPayload",null,[428]);Am(H,ea);H.prototype.dispose=function(){this.ga&&(this.ga.Q7(this.Gp),this.ga.EX(this.zh),this.ga.NMd(this.lGb),this.ga.OI(this.ld));if(this.mi)for(var W=1;4>=W;W++)ef.DOMElementExtensions.vf(this.mi[W.toString()]);this.mi=this.Di=null;this.ru&&this.Jpa();this.Zh&&this.su&&this.Jpa(1);ea.prototype.dispose.call(this)};H.prototype.yEd=function(W){this.Zh&&(this.RB=
W,this.mA=null,this.Tq=this.isRow=this.Xf=this.Uq=!1,Bg.KeyInputManager.instance.qa(Sd.a.Ub,this.domElement.ownerDocument.body,this.onKeyDown));this.Gs=!0;this.tableRange=this.j1c(this.tableManager.rn(this.sourceRange.topLeft));Ke.g(this.$);this.tableRange&&!this.tableRange.equals(this.sourceRange)?this.Zh?(this.mA=this.tableRange,this.Pn=1,this.Di=(this.Tq=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right)?[11]:[12],this.Tj=6,this.dA(this.eX,this.fX),this.rN=
this.tja,this.oP=this.Roa,this.cE(W.clientPoint,W.Mb,this.Tq?11:12,!0,!0),this.IP(!0)):(this.Di=(this.isRow=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right)?[11]:[12],this.Tj=6,this.dA(this.eX,this.fX),this.cE(W.clientPoint,W.Mb,this.isRow?11:12,!0)):(this.tableRange=null,this.Zh?(this.isRow=this.sourceRange.isRow,this.Xf=this.sourceRange.Xf,this.isRow||this.Xf?(this.Pn=3,this.hF=this.isRow?1:2,this.Tj=6,this.Di=this.isRow?[11]:[12],this.dA(this.g7,this.h7),
this.rN=this.tja,this.oP=this.Roa,this.cE(W.clientPoint,W.Mb,this.isRow?11:12,!0,!0),this.IP(!0)):(this.Pn=2,this.hF=0,this.dA(Object($e.a)(this,this.Uh,"onPointerMove"),Object($e.a)(this,this.Sf,"onPointerUp")),this.rN=this.lub,this.oP=this.sMb,this.cE(W.clientPoint,W.Mb,this.uka(),!1,!0),this.jE(!0))):(this.dA(Object($e.a)(this,this.Uh,"onPointerMove"),Object($e.a)(this,this.Sf,"onPointerUp")),Bg.KeyInputManager.instance.qa(Sd.a.Ub,this.domElement.ownerDocument.body,this.onKeyDown),this.hF=this.sourceRange.isRow?
1:this.sourceRange.Xf?2:0,this.cE(W.clientPoint,W.Mb,this.uka(),!1),this.jE()))};H.prototype.cQa=function(){this.Gs=!1;this.Zh&&(this.Pn=0);this.Fb.si(this.eD());if(!this.$.Br([this.Nb],!1))return this.du(Object($e.a)(this,this.Uh,"onPointerMove"),Object($e.a)(this,this.Sf,"onPointerUp")),this.Tj=-1,!0;if(this.ga.va.xd.equals(this.Nb)||this.vla(this.Nb)||this.vla(this.sourceRange))this.Tj=-1;else{this.mP();this.ga.sourceRange=this.sourceRange.clone();var W=this.ga.sourceRange,ta=this.ga.va.xd;if(this.Zh){var ob=
{};this.$.ae(-694765314,2,30,(ob[fe.a.eva]=this.ru,ob[fe.a.I4]=W,ob[fe.a.H4]=ta,ob[fe.a.iub]=this.su,ob))}else ob={},this.$.ae(-694765314,2,30,(ob[fe.a.eva]=this.ru,ob[fe.a.I4]=W,ob[fe.a.H4]=ta,ob))}!this.Zh&&this.tableRange||this.du(Object($e.a)(this,this.Uh,"onPointerMove"),Object($e.a)(this,this.Sf,"onPointerUp"));return!0};H.prototype.Jrb=function(W){W&&(Bg.KeyInputManager.instance.za(Sd.a.Ub,this.domElement.ownerDocument.body,this.onKeyDown),this.Zh&&Ke.g(this.$).Lg.Np(fe.a.v5),this.Gs=!1);for(W=
1;4>=W;W++){var ta=this.mi[W.toString()];ta&&ta.parentNode.removeChild(ta);this.mi[W.toString()]=null}this.Di=null};H.prototype.zEd=function(W){var ta=this.ga.Ip(W.clientPoint,W.Mb,5,void 0,void 0,!0);this.RB=W;return this.yyb(ta)?(this.Nb=this.NHa(ta),this.fyb(!0),!0):this.pmd(ta)?(this.Nb=this.yia(ta),this.gyb(!0),!0):!1};H.prototype.yyb=function(W){return!!this.mA&&1!==this.Pn&&!!W&&this.mA.contains(W.topLeft)};H.prototype.pmd=function(W){return!!this.mA&&1===this.Pn&&!!W&&!this.mA.contains(W.topLeft)};
H.prototype.fyb=function(W){this.tableRange=this.mA;this.Pn=1;var ta=!this.su;W?(this.wH(!1),this.Di=this.Tq?[11]:[12],this.JIb(ta),this.IP(ta)):(this.W3(!1),this.K7(ta),this.jE(ta))};H.prototype.gyb=function(W){this.tableRange=null;this.Pn=2;var ta=!this.su;W?(this.wH(!1),this.Di=this.Tq?[11]:[12],this.Uq=this.Tq,this.ARa(ta),this.IP(ta)):(this.$Ha(!1),this.K7(ta),this.jE(ta))};H.prototype.aec=function(){return this.ga.va.xd};H.prototype.mP=function(){this.ga.updateSelection(this.Nb,this.Nb.topLeft,
0);return!0};H.prototype.jE=function(W){W=void 0===W?!1:W;this.Fb.ak(this.Nb,this.eD());this.Fb.co(this.eD());this.HG(W);return!0};H.prototype.IP=function(W){W=void 0===W?!1:W;this.Fb.ak(this.Nb,this.Di);this.Fb.co(this.Di);this.HG(W)};H.prototype.svb=function(){jc.ULS.sendTraceTag(537159384,0,15,"DragSelectionClickBehavior.FailureFallback: this function was not implemented for dragging selection")};H.prototype.PCc=function(){return!1};H.prototype.pUd=function(){if(!Ke.g(this.$).ga.va.Wg)return!1;
var W=Ke.g(this.$).getRangeInformation(this.ga.va.xd);W=Cl(W);for(var ta=W.next();!ta.done;ta=W.next())if(Object(Jb.a)(ld.PivotTableRange,ta.value))return!1;return!0};H.prototype.j1c=function(W){if(W&&W.contains(this.sourceRange)&&!W.equals(this.sourceRange)){if(W.Pba&&this.sourceRange.bottom===this.sourceRange.top&&this.sourceRange.top===W.top){var ta=new nf.Range(this.sourceRange.top,this.sourceRange.left,W.bottom,this.sourceRange.right,!1,!1);if(!ta.equals(W))return this.sourceRange=ta,this.ga.updateSelection(this.sourceRange,
this.sourceRange.topLeft,0),W}this.Zh?this.Tq=W.left===this.sourceRange.left&&W.right===this.sourceRange.right:this.isRow=W.left===this.sourceRange.left&&W.right===this.sourceRange.right;if(W.top===this.sourceRange.top&&W.bottom===this.sourceRange.bottom||this.Vw())return W}return null};H.prototype.NHa=function(W){var ta=W.clone();this.Vw()?ta.left=Math.max(W.left-this.hgc,1):ta.top=Math.max(W.top-this.WEc,1);ta.right=ta.left+this.sourceRange.width-1;ta.bottom=ta.top+this.sourceRange.height-1;return this.vpb(ta)};
H.prototype.kBb=function(){var W=this.Nb.topLeft.Od(this.sourceRange);return W||this.Zh&&!this.tableRange?W:this.Vw()?this.Nb.top===this.sourceRange.bottom+1:this.Nb.left===this.sourceRange.right+1};H.prototype.kKd=function(){if(this.Vw()&&this.Nb.left!==this.tableRange.left||!this.Vw()&&this.Nb.top!==this.tableRange.top){var W=Fh.a.ed(1,1,0,887,0,2065438552,"RearrangeInvalidDest");Ih.a(this.$).Ss([W]);return!0}return!1};H.prototype.OId=function(){var W=this,ta=this.$.Sb.Hc("UserAction","RearrangeRowColumnClientSide"),
ob={},Kb=(ob.CopyPasteTargetType=1,ob.OperationId=Mg.a.create().toString(),ob.Stopwatch=ta,ob.DragDropIsShiftKeyDown=this.su,ob.EncounteredDeploymentErrors=!1,ob),qc=this.ru?2:1,Bb=this.$.da.Aa(254);(new Promise(function(sd,Vd){W.ovb(function(bf){bf.Errors&&0<bf.Errors.length?Vd(new pf.a(22,bf.Errors)):sd(!0)},function(bf){bf=tg.a.mg(bf.data);Vd(new pf.a(22,bf))})})).then(function(){jc.ULS.sendTraceTag(537159383,0,50,'DragSelectionClickBehavior.RearrangeRowColumn: success. copyPasteTargetType="{0}"',
1);Bb&&Bb.Fqf(Kb,qc,W.sourceRange,W.Nb);return Promise.resolve(!0)},function(sd){jc.ULS.sendTraceTag(537159382,0,10,'DragSelectionClickBehavior.RearrangeRowColumn: {0}, copyPasteTargetType="{1}"',sd?copyPasteInfra.getStringifiedError(sd):"null",1);return Bb?Bb.EFf(sd,Kb,qc,W.sourceRange,W.Nb):Promise.reject(sd)})};H.prototype.ovb=function(W,ta){function ob(){return new U(sd,Bb)}function Kb(Vd,bf,Xf){return Q(qc.$.na.ta,sd,Bb,W?Ah.b(Vd,W):Vd,ta?Ah.a(bf,ta):bf,Xf,null)}var qc=this;W=void 0===W?null:
W;ta=void 0===ta?null:ta;var Bb={};this.Vw()?(Bb.FirstRow=this.Nb.top-1,Bb.FirstColumn=0,Bb.DeltaColumn=0,Bb.DeltaRow=this.Nb.bottom-this.Nb.top+1):(Bb.FirstRow=0,Bb.FirstColumn=this.Nb.left-1,Bb.DeltaColumn=this.Nb.right-this.Nb.left+1,Bb.DeltaRow=0);Bb.LastRow=Jd.a.By;Bb.LastColumn=Jd.a.yv;Bb.SheetName=this.$.xa.oa?this.$.xa.oa.name:this.$.Ab.getItemByName(this.$.Ab.oa.name).sheetName;var sd=Qe.v(this.sourceRange,this.$);Td.EwaSettings.uc()?this.$.userOperationManager.jc(new li.a(514,0,Kb,64,ob),
null):this.$.userOperationManager.jc(new eh.a(514,0,Kb,void 0,ob),null)};H.prototype.vla=function(W){W=Ke.g(this.$).getRangeInformation(W);for(var ta=0,ob=W.length;ta<ob;++ta)if(Object(Jb.a)(ld.PivotTableRange,W[ta]))return W=Fh.a.ed(1,0,0,882,0,2105176604,"InsDelCellsPivotTable"),Ih.a(this.$).Ss([W]),!0;return!1};H.prototype.cE=function(W,ta,ob,Kb,qc){qc=void 0===qc?!1:qc;var Bb=ef.DOMElementExtensions.getBoundingClientRect(ta),sd=ta===this.zs[ea.IJa]||ta===this.zs[ea.a$c];if(this.Zh){var Vd=ta===
this.zs[ea.b$c]||ta===this.zs[ea.HJa];this.isRow&&Vd||this.Xf&&sd?Vd="100px":(sd=this.isRow||sd,Vd=(sd?qc?H.qZd:H.wZd:qc?H.pZd:H.tZd)+"px");ta=sd?ta===this.zs[ea.IJa]?"top":"bottom":ta===this.zs[ea.HJa]?"right":"left";W=100*(sd?W.x-Bb.x:W.y-Bb.y)/(sd?Bb.width:Bb.height);for(Bb=1;4>=Bb;Bb++){Kb=document.createElement("div");var bf=document.createElement("div"),Xf=document.createElement("div");Kb.appendChild(bf);Kb.appendChild(Xf);qc&&(bf=document.createElement("div"),Kb.appendChild(bf),Xf.style.fontWeight=
"bold");Kb.className=Z.PUe;this.mi[Bb.toString()]=Kb;this.Fb.Iw(ob,Bb).Qf.appendChild(Kb);Kb=this.mi[Bb.toString()];Kb.style[ta]=Vd;Kb.style[sd?"left":"top"]=W+"%"}}else for(qc=(sd?-H.vZd:-H.sZd)+"px",Vd=sd?ta===this.zs[ea.IJa]?"top":"bottom":ta===this.zs[ea.HJa]||Kb?"right":"left",ta=100*(sd?Kb?0:W.x-Bb.x:W.y-Bb.y)/(sd?Bb.width:Bb.height),W=1;4>=W;W++)Bb=document.createElement("div"),Bb.className=Z.OUe,this.mi[W.toString()]=Bb,this.Fb.Iw(ob,W).Qf.appendChild(Bb),Bb=this.mi[W.toString()],Bb.style[Vd]=
qc,Bb.style[sd?"left":"top"]=ta+"%"};H.prototype.HG=function(W){W=void 0===W?!1:W;var ta=this.Nb.toString();if(this.Zh)for(var ob=1;4>=ob;ob++)this.mi[ob.toString()].childNodes[0].innerText=ta,this.mi[ob.toString()].childNodes[1].innerText=this.rN,W&&(this.mi[ob.toString()].childNodes[2].innerText=this.oP);else for(W=1;4>=W;W++)this.mi[W.toString()].innerText=ta};H.prototype.Jpa=function(W){W=void 0===W?0:W;0===W?this.ru=!1:1===W&&(this.su=!1);this.Zh&&(this.ru||this.su)||(Bg.KeyInputManager.instance.za(Sd.a.Td,
this.domElement.ownerDocument.body,this.onKeyUp),this.MNa=!1)};H.prototype.wH=function(W){this.Fb.si(this.eD());this.du(Object($e.a)(this,this.Uh,"onPointerMove"),Object($e.a)(this,this.Sf,"onPointerUp"),void 0,W)};H.prototype.W3=function(W){this.Fb.si(this.Di);this.du(this.g7,this.h7,void 0,W)};H.prototype.$Ha=function(W){this.Fb.si(this.Di);this.du(this.eX,this.fX,void 0,W)};H.prototype.K7=function(W){W=void 0===W?!1:W;this.Tj=5;this.dA(Object($e.a)(this,this.Uh,"onPointerMove"),Object($e.a)(this,
this.Sf,"onPointerUp"));this.rN=this.lub;this.oP=this.sMb;this.cE(this.RB.clientPoint,this.RB.Mb,this.uka(),!1,W)};H.prototype.ARa=function(W){W=void 0===W?!1:W;this.Tj=6;this.dA(this.g7,this.h7);this.rN=this.tja;this.oP=this.Roa;this.cE(this.RB.clientPoint,this.RB.Mb,this.isRow||this.Tq?11:12,!0,W)};H.prototype.JIb=function(W){W=void 0===W?!1:W;this.Tj=6;this.dA(this.eX,this.fX);this.rN=this.tja;this.oP=this.Roa;this.cE(this.RB.clientPoint,this.RB.Mb,this.Vw()?11:12,!0,W)};H.prototype.Cla=function(W){return W.Ca.keyCode===
x.a.X8||rf.a.isMac&&W.Ca.keyCode===x.a.Upa};H.prototype.Vw=function(){return!this.Zh&&this.isRow||this.Zh&&this.Tq};H.prototype.uka=function(){return this.Zh?45:6};H.prototype.eD=function(){return this.Zh?H.Y9c:H.c$c};H.sZd=50;H.vZd=25;H.tZd=-85;H.wZd=-40;H.pZd=-120;H.qZd=-50;H.Esb="copy";H.c$c=[6];H.Y9c=[45];Object(zc.a)(H,"DragSelectionClickBehavior",ea,[]);Am(C,ea);C.prototype.dispose=function(){this.ga&&(this.ga.Q7(this.Gp),this.ga.EX(this.zh),this.ga.NMd(this.lGb),this.ga.OI(this.ld));if(this.mi)for(var W=
1;4>=W;W++)ef.DOMElementExtensions.vf(this.mi[W.toString()]);this.mi=this.Di=null;ea.prototype.dispose.call(this)};C.prototype.Jrb=function(){for(var W=1;4>=W;W++){var ta=this.mi[W.toString()];ta&&ta.parentNode.removeChild(ta);this.mi[W.toString()]=null}this.Di=null};C.prototype.aec=function(){return this.ga.va.xd};C.prototype.mP=function(){this.ga.updateSelection(this.Nb,this.Nb.topLeft,0);return!0};C.prototype.jE=function(W){W=void 0===W?!1:W;this.Fb.ak(this.Nb,this.eD());this.Fb.co(this.eD());
this.HG(W);return!0};C.prototype.IP=function(W){W=void 0===W?!1:W;this.Fb.ak(this.Nb,this.Di);this.Fb.co(this.Di);this.HG(W)};C.prototype.svb=function(){jc.ULS.sendTraceTag(523638490,0,15,"DragSelectionClickBehaviorTemporary.FailureFallback: this function was not implemented for dragging selection")};C.prototype.PCc=function(){return!1};C.prototype.cE=function(W,ta,ob,Kb,qc){qc=void 0===qc?!1:qc;var Bb=ef.DOMElementExtensions.getBoundingClientRect(ta),sd=ta===this.zs[ea.IJa]||ta===this.zs[ea.a$c];
if(this.Zh){var Vd=ta===this.zs[ea.b$c]||ta===this.zs[ea.HJa];this.isRow&&Vd||this.Xf&&sd?Vd="100px":(sd=this.isRow||sd,Vd=(sd?qc?C.qZd:C.wZd:qc?C.pZd:C.tZd)+"px");ta=sd?ta===this.zs[ea.IJa]?"top":"bottom":ta===this.zs[ea.HJa]?"right":"left";W=100*(sd?W.x-Bb.x:W.y-Bb.y)/(sd?Bb.width:Bb.height);for(Bb=1;4>=Bb;Bb++){Kb=document.createElement("div");var bf=document.createElement("div"),Xf=document.createElement("div");Kb.appendChild(bf);Kb.appendChild(Xf);qc&&(bf=document.createElement("div"),Kb.appendChild(bf),
Xf.style.fontWeight="bold");Kb.className=Z.PUe;this.mi[Bb.toString()]=Kb;this.Fb.Iw(ob,Bb).Qf.appendChild(Kb);Kb=this.mi[Bb.toString()];Kb.style[ta]=Vd;Kb.style[sd?"left":"top"]=W+"%"}}else for(qc=(sd?-C.vZd:-C.sZd)+"px",Vd=sd?ta===this.zs[ea.IJa]?"top":"bottom":ta===this.zs[ea.HJa]||Kb?"right":"left",ta=100*(sd?Kb?0:W.x-Bb.x:W.y-Bb.y)/(sd?Bb.width:Bb.height),W=1;4>=W;W++)Bb=document.createElement("div"),Bb.className=Z.OUe,this.mi[W.toString()]=Bb,this.Fb.Iw(ob,W).Qf.appendChild(Bb),Bb=this.mi[W.toString()],
Bb.style[Vd]=qc,Bb.style[sd?"left":"top"]=ta+"%"};C.prototype.HG=function(W){W=void 0===W?!1:W;var ta=this.Nb.toString();if(this.Zh)for(var ob=1;4>=ob;ob++)this.mi[ob.toString()].childNodes[0].innerText=ta,this.mi[ob.toString()].childNodes[1].innerText=this.rN,W&&(this.mi[ob.toString()].childNodes[2].innerText=this.oP);else for(W=1;4>=W;W++)this.mi[W.toString()].innerText=ta};C.prototype.wH=function(W){this.Fb.si(this.eD());this.du(Object($e.a)(this,this.Uh,"onPointerMove"),Object($e.a)(this,this.Sf,
"onPointerUp"),void 0,W)};C.prototype.W3=function(W){this.Fb.si(this.Di);this.du(this.g7,this.h7,void 0,W)};C.prototype.$Ha=function(W){this.Fb.si(this.Di);this.du(this.eX,this.fX,void 0,W)};C.prototype.uka=function(){return this.Zh?45:6};C.prototype.eD=function(){return this.Zh?C.Y9c:C.c$c};C.sZd=50;C.vZd=25;C.tZd=-85;C.wZd=-40;C.pZd=-120;C.qZd=-50;C.c$c=[6];C.Y9c=[45];Object(zc.a)(C,"DragSelectionClickBehaviorTemporary",ea,[]);Am(E,C);E.prototype.dispose=function(){this.ru&&this.Jpa();this.Zh&&
this.su&&this.Jpa(1);C.prototype.dispose.call(this)};E.prototype.yEd=function(W){this.Zh&&(this.RB=W,this.mA=null,this.Tq=this.isRow=this.Xf=this.Uq=!1,Bg.KeyInputManager.instance.qa(Sd.a.Ub,this.domElement.ownerDocument.body,this.onKeyDown));this.Gs=!0;this.tableRange=this.j1c(this.tableManager.rn(this.sourceRange.topLeft));Ke.g(this.$);this.tableRange&&!this.tableRange.equals(this.sourceRange)?this.Zh?(this.mA=this.tableRange,this.Pn=1,this.Di=(this.Tq=this.tableRange.left===this.sourceRange.left&&
this.tableRange.right===this.sourceRange.right)?[11]:[12],this.Tj=6,this.dA(this.eX,this.fX),this.rN=this.tja,this.oP=this.Roa,this.cE(W.clientPoint,W.Mb,this.Tq?11:12,!0,!0),this.IP(!0)):(this.Di=(this.isRow=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right)?[11]:[12],this.Tj=6,this.dA(this.eX,this.fX),this.cE(W.clientPoint,W.Mb,this.isRow?11:12,!0)):(this.tableRange=null,this.Zh?(this.isRow=this.sourceRange.isRow,this.Xf=this.sourceRange.Xf,this.isRow||
this.Xf?(this.Pn=3,this.hF=this.isRow?1:2,this.Tj=6,this.Di=this.isRow?[11]:[12],this.dA(this.g7,this.h7),this.rN=this.tja,this.oP=this.Roa,this.cE(W.clientPoint,W.Mb,this.isRow?11:12,!0,!0),this.IP(!0)):(this.Pn=2,this.hF=0,this.dA(Object($e.a)(this,this.Uh,"onPointerMove"),Object($e.a)(this,this.Sf,"onPointerUp")),this.rN=this.lub,this.oP=this.sMb,this.cE(W.clientPoint,W.Mb,this.uka(),!1,!0),this.jE(!0))):(this.dA(Object($e.a)(this,this.Uh,"onPointerMove"),Object($e.a)(this,this.Sf,"onPointerUp")),
Bg.KeyInputManager.instance.qa(Sd.a.Ub,this.domElement.ownerDocument.body,this.onKeyDown),this.hF=this.sourceRange.isRow?1:this.sourceRange.Xf?2:0,this.cE(W.clientPoint,W.Mb,this.uka(),!1),this.jE()))};E.prototype.cQa=function(){this.Gs=!1;this.Zh&&(this.Pn=0);this.Fb.si(this.eD());if(!this.$.Br([this.Nb],!1))return this.du(Object($e.a)(this,this.Uh,"onPointerMove"),Object($e.a)(this,this.Sf,"onPointerUp")),this.Tj=-1,!0;if(this.ga.va.xd.equals(this.Nb)||this.vla(this.Nb)||this.vla(this.sourceRange))this.Tj=
-1;else{this.mP();this.ga.sourceRange=this.sourceRange.clone();var W=this.ga.sourceRange,ta=this.ga.va.xd;if(this.Zh){var ob={};this.$.ae(-694765314,2,30,(ob[fe.a.eva]=this.ru,ob[fe.a.I4]=W,ob[fe.a.H4]=ta,ob[fe.a.iub]=this.su,ob))}else ob={},this.$.ae(-694765314,2,30,(ob[fe.a.eva]=this.ru,ob[fe.a.I4]=W,ob[fe.a.H4]=ta,ob))}!this.Zh&&this.tableRange||this.du(Object($e.a)(this,this.Uh,"onPointerMove"),Object($e.a)(this,this.Sf,"onPointerUp"));return!0};E.prototype.Jrb=function(W){W&&(Bg.KeyInputManager.instance.za(Sd.a.Ub,
this.domElement.ownerDocument.body,this.onKeyDown),this.Zh&&Ke.g(this.$).Lg.Np(fe.a.v5),this.Gs=!1);C.prototype.Jrb.call(this,W)};E.prototype.zEd=function(W){var ta=this.ga.Ip(W.clientPoint,W.Mb,5,void 0,void 0,!0);this.RB=W;return this.yyb(ta)?(this.Nb=this.NHa(ta),this.fyb(!0),!0):this.pmd(ta)?(this.Nb=this.yia(ta),this.gyb(!0),!0):!1};E.prototype.yyb=function(W){return!!this.mA&&1!==this.Pn&&!!W&&this.mA.contains(W.topLeft)};E.prototype.pmd=function(W){return!!this.mA&&1===this.Pn&&!!W&&!this.mA.contains(W.topLeft)};
E.prototype.fyb=function(W){this.tableRange=this.mA;this.Pn=1;var ta=!this.su;W?(this.wH(!1),this.Di=this.Tq?[11]:[12],this.JIb(ta),this.IP(ta)):(this.W3(!1),this.K7(ta),this.jE(ta))};E.prototype.gyb=function(W){this.tableRange=null;this.Pn=2;var ta=!this.su;W?(this.wH(!1),this.Di=this.Tq?[11]:[12],this.Uq=this.Tq,this.ARa(ta),this.IP(ta)):(this.$Ha(!1),this.K7(ta),this.jE(ta))};E.prototype.pUd=function(){if(!Ke.g(this.$).ga.va.Wg)return!1;var W=Ke.g(this.$).getRangeInformation(this.ga.va.xd);W=Cl(W);
for(var ta=W.next();!ta.done;ta=W.next())if(Object(Jb.a)(ld.PivotTableRange,ta.value))return!1;return!0};E.prototype.j1c=function(W){if(W&&W.contains(this.sourceRange)&&!W.equals(this.sourceRange)){if(W.Pba&&this.sourceRange.bottom===this.sourceRange.top&&this.sourceRange.top===W.top){var ta=new nf.Range(this.sourceRange.top,this.sourceRange.left,W.bottom,this.sourceRange.right,!1,!1);if(!ta.equals(W))return this.sourceRange=ta,this.ga.updateSelection(this.sourceRange,this.sourceRange.topLeft,0),
W}this.Zh?this.Tq=W.left===this.sourceRange.left&&W.right===this.sourceRange.right:this.isRow=W.left===this.sourceRange.left&&W.right===this.sourceRange.right;if(W.top===this.sourceRange.top&&W.bottom===this.sourceRange.bottom||this.Vw())return W}return null};E.prototype.NHa=function(W){var ta=W.clone();this.Vw()?ta.left=Math.max(W.left-this.hgc,1):ta.top=Math.max(W.top-this.WEc,1);ta.right=ta.left+this.sourceRange.width-1;ta.bottom=ta.top+this.sourceRange.height-1;return this.vpb(ta)};E.prototype.kBb=
function(){var W=this.Nb.topLeft.Od(this.sourceRange);return W||this.Zh&&!this.tableRange?W:this.Vw()?this.Nb.top===this.sourceRange.bottom+1:this.Nb.left===this.sourceRange.right+1};E.prototype.kKd=function(){if(this.Vw()&&this.Nb.left!==this.tableRange.left||!this.Vw()&&this.Nb.top!==this.tableRange.top){var W=Fh.a.ed(1,1,0,887,0,2065438552,"RearrangeInvalidDest");Ih.a(this.$).Ss([W]);return!0}return!1};E.prototype.OId=function(){var W=this,ta=this.$.Sb.Hc("UserAction","RearrangeRowColumnClientSide"),
ob={},Kb=(ob.CopyPasteTargetType=1,ob.OperationId=Mg.a.create().toString(),ob.Stopwatch=ta,ob.DragDropIsShiftKeyDown=this.su,ob.EncounteredDeploymentErrors=!1,ob),qc=this.ru?2:1,Bb=this.$.da.Aa(254);(new Promise(function(sd,Vd){W.ovb(function(bf){bf.Errors&&0<bf.Errors.length?Vd(new pf.a(22,bf.Errors)):sd(!0)},function(bf){bf=tg.a.mg(bf.data);Vd(new pf.a(22,bf))})})).then(function(){jc.ULS.sendTraceTag(523638492,0,50,'DragSelectionClickBehaviorTableRange.RearrangeRowColumn: success. copyPasteTargetType="{0}"',
1);Bb&&Bb.Fqf(Kb,qc,W.sourceRange,W.Nb);return Promise.resolve(!0)},function(sd){jc.ULS.sendTraceTag(523638491,0,10,'DragSelectionClickBehaviorTableRange.RearrangeRowColumn: {0}, copyPasteTargetType="{1}"',sd?copyPasteInfra.getStringifiedError(sd):"null",1);return Bb?Bb.EFf(sd,Kb,qc,W.sourceRange,W.Nb):Promise.reject(sd)})};E.prototype.ovb=function(W,ta){function ob(){return new U(sd,Bb)}function Kb(Vd,bf,Xf){return Q(qc.$.na.ta,sd,Bb,W?Ah.b(Vd,W):Vd,ta?Ah.a(bf,ta):bf,Xf,null)}var qc=this;W=void 0===
W?null:W;ta=void 0===ta?null:ta;var Bb={};this.Vw()?(Bb.FirstRow=this.Nb.top-1,Bb.FirstColumn=0,Bb.DeltaColumn=0,Bb.DeltaRow=this.Nb.bottom-this.Nb.top+1):(Bb.FirstRow=0,Bb.FirstColumn=this.Nb.left-1,Bb.DeltaColumn=this.Nb.right-this.Nb.left+1,Bb.DeltaRow=0);Bb.LastRow=Jd.a.By;Bb.LastColumn=Jd.a.yv;Bb.SheetName=this.$.xa.oa?this.$.xa.oa.name:this.$.Ab.getItemByName(this.$.Ab.oa.name).sheetName;var sd=Qe.v(this.sourceRange,this.$);Td.EwaSettings.uc()?this.$.userOperationManager.jc(new li.a(514,0,Kb,
64,ob),null):this.$.userOperationManager.jc(new eh.a(514,0,Kb,void 0,ob),null)};E.prototype.vla=function(W){W=Ke.g(this.$).getRangeInformation(W);for(var ta=0,ob=W.length;ta<ob;++ta)if(Object(Jb.a)(ld.PivotTableRange,W[ta]))return W=Fh.a.ed(1,0,0,882,0,2105176604,"InsDelCellsPivotTable"),Ih.a(this.$).Ss([W]),!0;return!1};E.prototype.Jpa=function(W){W=void 0===W?0:W;0===W?this.ru=!1:1===W&&(this.su=!1);this.Zh&&(this.ru||this.su)||(Bg.KeyInputManager.instance.za(Sd.a.Td,this.domElement.ownerDocument.body,
this.onKeyUp),this.MNa=!1)};E.prototype.K7=function(W){W=void 0===W?!1:W;this.Tj=5;this.dA(Object($e.a)(this,this.Uh,"onPointerMove"),Object($e.a)(this,this.Sf,"onPointerUp"));this.rN=this.lub;this.oP=this.sMb;this.cE(this.RB.clientPoint,this.RB.Mb,this.uka(),!1,W)};E.prototype.ARa=function(W){W=void 0===W?!1:W;this.Tj=6;this.dA(this.g7,this.h7);this.rN=this.tja;this.oP=this.Roa;this.cE(this.RB.clientPoint,this.RB.Mb,this.isRow||this.Tq?11:12,!0,W)};E.prototype.JIb=function(W){W=void 0===W?!1:W;this.Tj=
6;this.dA(this.eX,this.fX);this.rN=this.tja;this.oP=this.Roa;this.cE(this.RB.clientPoint,this.RB.Mb,this.Vw()?11:12,!0,W)};E.prototype.Cla=function(W){return W.Ca.keyCode===x.a.X8||rf.a.isMac&&W.Ca.keyCode===x.a.Upa};E.prototype.Vw=function(){return!this.Zh&&this.isRow||this.Zh&&this.Tq};E.Esb="copy";Object(zc.a)(E,"DragSelectionClickBehaviorTableRange",C,[]);Am(t,S);t.prototype.dispose=function(){Pf.a.instance.za(Sd.a.pointerDown,this.kba,this.onPointerDown);d.a.instance.za(Sd.a.qk,this.kba,this.gda);
this.gridView.$&&(this.gridView.ga.Q7(this.Gp),this.gridView.ga.EX(this.zh),this.gridView.$.Bl(this.vd),this.gridView.$.yb.pvc(this.l7),this.gridView.$.yb.ovc(this.k7),this.gridView.dUf(this.oFb),this.gridView.Ac.$k(this.yCf),this.gridView.Ac.Zn(this.xCf));S.prototype.dispose.call(this)};Object(zc.a)(t,"FillHandleClickBehavior",S,[]);Am(A,aa);uk.Object.defineProperties(A.prototype,{Twa:{configurable:!0,enumerable:!0,get:function(){return this.ztg}}});A.eBe=[1,2,32,256,128,64];Object(zc.a)(A,"IPadSelectionClickThroughBehavior",
aa,[]);v.prototype.dispose=function(){this.gridView.ga.Q7(this.Gp);this.gridView.ga.EX(this.zh);this.gridView.ga.NMd(this.zh)};v.prototype.cBa=function(){this.H6a=0;this.Iic=!1;this.w6=Number.NaN};v.prototype.ocf=function(W){this.LDc(W.Mb,1);return!0};v.prototype.pcf=function(W){this.LDc(W.Mb,-1);return!0};v.prototype.wNe=function(W){this.Iic=!0;this.LDc(W,1)};v.prototype.xNe=function(W){this.Iic=!1;this.LDc(W,-1)};v.prototype.LDc=function(W,ta){if(W)if(W.parentNode)if(this.bsd)isNaN(this.w6)||(this.$Dc(this.w6,
!1),this.w6=Number.NaN);else if(W=parseInt(W.parentNode.getAttribute(fe.a.Czb),10),isNaN(W))jc.ULS.shipAssertTag(537159366,0,!1,"MarqueeHoveringManager.UpdateMarqueeStyle: indexInMarqueeCollection is not a valid number.");else{if(!isNaN(this.w6)&&W!==this.w6){if(this.Iic)return;this.$Dc(this.w6,!1)}if(isNaN(this.w6)||W!==this.w6)this.w6=W,this.H6a=0;!this.H6a&&0<ta&&this.$Dc(W,!0);this.H6a=Math.max(this.H6a+ta,0);!this.H6a&&0>ta&&(this.$Dc(W,!1),this.w6=Number.NaN)}else jc.ULS.shipAssertTag(537159367,
0,!!W.parentNode,"MarqueeHoveringManager.UpdateMarqueeStyle: handle.ParentNode is null.");else jc.ULS.shipAssertTag(537159368,0,!!W,"MarqueeHoveringManager.UpdateMarqueeStyle: handle is null.")};v.prototype.$Dc=function(W,ta){for(var ob=1;4>=ob;ob++){var Kb=this.gridView.Fb.Iw(3,ob,W).Qf;ef.DOMElementExtensions.toggleCssClass(Kb,Z.ABh,ta);for(Kb=Kb.firstChild;Kb;Kb=Kb.nextSibling)Of.a.contains(Kb.className,"resizemarqueehandle",!0)&&ef.DOMElementExtensions.toggleCssClass(Kb,Z.EBh,ta)}};Object(zc.a)(v,
"MarqueeHoveringManager",null,[]);var Ig=b(1037),qg=b(1316);Am(y,aa);y.prototype.dispose=function(){Pf.a.instance.za(Sd.a.rX,this.RK,this.bFf);Pf.a.instance.za(Sd.a.Ky,this.RK,this.kda);Pf.a.instance.za(Sd.a.pointerDown,this.RK,this.onPointerDown);Fg.a.instance.za(Sd.a.click,this.RK,this.SFb);Fg.a.instance.za(Sd.a.qk,this.RK,this.onDoubleClick);ef.DOMElementExtensions.vf(this.cI);this.cI=null;ef.DOMElementExtensions.vf(this.RK);this.sv=this.RK=null;aa.prototype.dispose.call(this)};y.prototype.r_a=
function(W){this.sv=Object(Gc.a)(qg.a,W.metadata)};Object(zc.a)(y,"RangeCatchUpActivityHighlightBehavior",aa,[]);Am(B,P);B.prototype.wTa=function(){return(this.gridView.inRangePicker||this.gridView.Vi)&&P.prototype.wTa.call(this)};uk.Object.defineProperties(B.prototype,{K5:{configurable:!0,enumerable:!0,get:function(){return 16}},Ddb:{configurable:!0,enumerable:!0,get:function(){return this.gridView.ga.rangePicker.Yfd(!1)}}});Object(zc.a)(B,"RangePickerTouchGrippiesBehavior",P,[]);Am(r,aa);Object(zc.a)(r,
"RearrangeHighlightBehavior",aa,[]);var pi;(function(W){W[W.topLeft=0]="topLeft";W[W.topRight=1]="topRight";W[W.bottomLeft=2]="bottomLeft";W[W.bottomRight=3]="bottomRight";W[W.error=4]="error"})(pi||(pi={}));Object(zc.b)("Corner",pi);Am(w,aa);w.prototype.dispose=function(){var W=this;this.ZL.forEach(function(ta){Pf.a.instance.za(Sd.a.pointerDown,ta,W.onPointerDown)});Array.clear(this.ZL);aa.prototype.dispose.call(this)};w.prototype.r_a=function(W){this.Rba=W;this.Jse(W);this.$o.ULb(W,this.ZL,this.oUd());
this.Ay.cBa()};w.prototype.Uh=function(W){W=Cf.a(this.$).se(W);W=this.m4e(W,!1);if(!W)return!0;W=this.$He(W);if(!W)return jc.ULS.shipAssertTag(537159327,0,!1,"ResizeMarqueeBehaviorBase.OnPointerMove: newMarqueeRange is null"),this.Mac(!0),!1;if(this.Nb.equals(W))return!0;this.Nb=W;W=this.jE();W||(jc.ULS.shipAssertTag(537159326,0,!1,"ResizeMarqueeBehaviorBase.OnPointerMove: UpdateHighlightOnMove failed"),this.Mac(!0));return W};w.prototype.Sf=function(W){var ta=this;W=Cf.a(this.$).se(W);W=this.mP();
jc.ULS.shipAssertTag(537159325,0,W,"ResizeMarqueeBehaviorBase.OnPointerUp: SetSelectedRange failed");rf.a.FB&&(this.ga.ugc(!0),window.setTimeout(function(){ta.ga.ugc(!1)},100));this.Mac(!W);return W};w.prototype.m4e=function(W,ta){var ob=W.Mb;W=W.clientPoint;if(!ob||!W)return jc.ULS.shipAssertTag(537159324,0,!!ob,"ResizeMarqueeBehaviorBase.GetMouseSelectionRange: source is null"),jc.ULS.shipAssertTag(537159323,0,!!W,"ResizeMarqueeBehaviorBase.GetMouseSelectionRange: point is null"),null;ta&&(W=this.Suf(W));
ta=this.ga.Ip(W,ob,0,!0,!1,!0);ta||(W=this.Suf(W),ta=this.ga.Ip(W,ob,0,!0,!1,!0));return ta};w.prototype.Suf=function(W){W.y+=0===this.n4||1===this.n4?2:-2;W.x+=0===this.n4||2===this.n4?2:-2;return W};w.prototype.$He=function(W){if(!W||!this.sourceRange)return jc.ULS.shipAssertTag(537159322,0,!!W,"ResizeMarqueeBehaviorBase.CreateNewRange: newCorner is null"),jc.ULS.shipAssertTag(537159321,0,!!this.sourceRange,"ResizeMarqueeBehaviorBase.CreateNewRange: sourceRange is null"),null;if(0===this.n4)return new nf.Range(W.top,
W.left,this.sourceRange.bottom,this.sourceRange.right,!0,!1);if(1===this.n4)return new nf.Range(W.top,this.sourceRange.left,this.sourceRange.bottom,W.right,!0,!1);if(2===this.n4)return new nf.Range(this.sourceRange.top,W.left,W.bottom,this.sourceRange.right,!0,!1);if(3===this.n4)return new nf.Range(this.sourceRange.top,this.sourceRange.left,W.bottom,W.right,!0,!1);jc.ULS.shipAssertTag(537159320,0,!1,"ResizeMarqueeBehaviorBase.CreateNewRange: currentFixedCorner is not valid: {0}",pi[this.n4]);return null};
w.prototype.mP=function(){return this.coloredReferencesManager.Ruf(this.Za,this.cM,this.Nb)};w.prototype.jE=function(){return this.mP()};w.prototype.Mac=function(W){W&&jc.ULS.sendTraceTag(537159319,0,10,"ResizeMarqueeBehaviorBase.FinishOrAbortOperation: Aborting operation, will try to recalculate colored references as a fallback.");this.Ay.xNe(this.ZL[0]);this.$o.cPf(!1,this.Rba.oaa);this.Za.textBox.setCaretPositionToEnd();this.Za.avc(this.j$e);this.Tfg();this.aUa=this.gridView.LMa=!1;ud.b(this.$,
!1);this.$o.RQf()};Object(zc.a)(w,"ResizeMarqueeBehaviorBase",aa,[]);Am(u,w);u.prototype.wXf=function(){return[Z.jCh,Z.kCh,Z.hCh,Z.iCh]};u.prototype.zse=function(){return[Z.gCh]};u.prototype.A2e=function(W){W=W.Mb;if(W===this.ZL[0])return 0;if(W===this.ZL[1])return 1;if(W===this.ZL[2])return 2;if(W===this.ZL[3])return 3;jc.ULS.shipAssertTag(537159318,0,!1,"ResizeMarqueeMouseBehavior.GetFixedCorner: source doesn't match any resize handle.");return 4};u.prototype.pSf=function(){this.$o.dA(Object($e.a)(this,
this.Uh,"onPointerMove"),Object($e.a)(this,this.Sf,"onPointerUp"),!0)};u.prototype.Tfg=function(){this.$o.R_d(Object($e.a)(this,this.Uh,"onPointerMove"),Object($e.a)(this,this.Sf,"onPointerUp"),!0)};u.prototype.k6f=function(W){return 2===(Hb.a.$b=W.zb)&&W.Vn===Sys.UI.MouseButton.leftButton};u.prototype.oUd=function(){return!0};u.prototype.Vqf=function(){jc.ULS.sendTraceTag(537159317,0,50,"ResizeMarqueeMouseBehavior.LogStartOperation: Starting resize marquee operation with mouse.")};u.prototype.Jse=
function(W){for(var ta=Cl(this.ZL),ob=ta.next();!ob.done;ob=ta.next())ob.value.style.backgroundColor=W.Qf.style.borderColor};Object(zc.a)(u,"ResizeMarqueeMouseBehavior",w,[]);Am(h,w);h.prototype.dispose=function(){Hb.a.EUf(this.MFb);w.prototype.dispose.call(this)};h.prototype.wXf=function(){return[Xd.a.sBh,Xd.a.rBh]};h.prototype.zse=function(){var W=Td.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest"),ta=rf.a.uf;W=!W||ta;return[W?Xd.a.HUe:Xd.a.GUe,Xd.a.H$b,W?Xd.a.qBh:Xd.a.G$b]};h.prototype.A2e=
function(W){W=W.Mb;if(W===this.ZL[0])return 0;if(W===this.ZL[1])return 3;jc.ULS.shipAssertTag(537159316,0,!1,"ResizeMarqueeTouchBehavior.GetFixedCorner: source doesn't match any resize handle.");return 4};h.prototype.pSf=function(){rf.a.vv?this.$o.dA(Object($e.a)(this,this.Uh,"onPointerMove"),Object($e.a)(this,this.Sf,"onPointerUp"),!1):this.$o.Lcj(Object($e.a)(this,this.Uh,"onPointerMove"),Object($e.a)(this,this.Sf,"onPointerUp"))};h.prototype.Tfg=function(){rf.a.vv?this.$o.R_d(Object($e.a)(this,
this.Uh,"onPointerMove"),Object($e.a)(this,this.Sf,"onPointerUp"),!1):this.$o.GUj(Object($e.a)(this,this.Uh,"onPointerMove"),Object($e.a)(this,this.Sf,"onPointerUp"))};h.prototype.k6f=function(W){return 3===(Hb.a.$b=W.zb)};h.prototype.oUd=function(){return 3===Hb.a.$b};h.prototype.Vqf=function(){jc.ULS.sendTraceTag(537159315,0,50,"ResizeMarqueeTouchBehavior.LogStartOperation: Starting resize marquee operation with touch.")};h.prototype.Jse=function(){};Object(zc.a)(h,"ResizeMarqueeTouchBehavior",
w,[]);Am(n,aa);n.Nsb=function(W,ta){var ob=document.createElement("div");ob.className=ta;W.appendChild(ob)};Object(zc.a)(n,"SelectionCutCopyBehavior",aa,[]);Am(m,aa);Object(zc.a)(m,"SelectionPasteBehavior",aa,[]);Am(l,aa);l.ctb=function(W,ta){var ob=document.createElement("div");ob.className=ta;W.appendChild(ob)};Object(zc.a)(l,"SelectionRangePickerBehavior",aa,[]);Am(e,P);e.prototype.wTa=function(){var W=this.gridView.Vi||this.gridView.isEditing;return this.gridView.ga.va.Wg&&!W&&P.prototype.wTa.call(this)};
uk.Object.defineProperties(e.prototype,{K5:{configurable:!0,enumerable:!0,get:function(){return 0}},Ddb:{configurable:!0,enumerable:!0,get:function(){return this.gridView.ga.va.xd}}});Object(zc.a)(e,"SelectionTouchGrippiesBehavior",P,[]);var Ld=mc.a;Am(c,Ld);c.prototype.dispose=function(){this.gridView.Fb.Ogj(this.iqb);this.Ay&&(this.Ay.dispose(),this.Ay=null);Ld.prototype.dispose.call(this)};Object(zc.a)(c,"GridHighlightsBehaviorManager",mc.a,[]);var qi=wf.a;Am(a,qi);a.prototype.create=function(){var W=
this;Le.TaskExtensions.Ba(ug.GetServiceTaskFactory.create(this.$.da,134,this.la,this.ub),function(ta){W.Eb(W.$.da.Aa(64)||new c(W.$,ta.result))},this.la,3)};a.ka=function(W){W.da.Ha(149,new a(W))};Object(zc.a)(a,"GridHighlightsBehaviorManagerFactory",wf.a,[]);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.GridHighlightsBehavior");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.SheetTabBar");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.SvgIconProvider");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Table");
Type.registerNamespace("_Ewa");Type.registerNamespace("Common.App.AccessibilitySettings");we.main();Type.registerNamespace("Common.App.AltTextDialog");Type.registerNamespace("Common.App.NewAndOpen.Core");te.a.instance.nj(new La);vf.a.Ti('.ewr-selection-draghandle,.ewr-selection-draghandle-grab{position:absolute;cursor:move;background-color:#fff;opacity:.01;z-index:15;pointer-events:auto}.ewr-selection-draghandle-grab{cursor:grab}.ewr-selection-draghandle-top-ie{top:-2px;left:-2px;right:-2px;height:5px}.ewr-selection-draghandle-top{top:-2px;left:-2px;right:-2px;height:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-bottom-ie{right:0;left:-2px;bottom:-2px;height:5px}.ewr-selection-draghandle-bottom{right:0;left:-2px;bottom:-2px;height:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-left-ie{top:0;left:-2px;bottom:0;width:5px}.ewr-selection-draghandle-left{top:0;left:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-right-ie{top:0;right:-2px;bottom:0;width:5px}.ewr-selection-draghandle-right{top:0;right:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1))}.ms-core-needIEFilter .ewr-selection-draghandle{filter:alpha(opacity=1);-ms-filter:"alpha(opacity=1)"}.ewr-selection-dragtooltip{position:absolute;background-color:#fff;z-index:UndefinedLessParam;border:1px solid #6e7b8a;height:18px;font-size:12px;padding-left:2px;padding-right:2px}.ewr-selection-dragtooltip-updated{position:absolute;background-color:#fff;z-index:UndefinedLessParam;border:1px solid #6e7b8a;height:fit-content;width:max-content;font-size:10px;padding-left:2px;padding-right:2px}.ewr_selection_rearrangeleft{border-left:3px solid #217346;position:absolute;height:10px;width:0;left:-2px;top:-4px}.ewr_selection_rearrangeright{border-right:3px solid #217346;position:absolute;height:10px;width:0;right:-5px;top:-4px}.ewr_selection_rearrangetop{border-top:3px solid #217346;position:absolute;width:10px;height:0;top:-2px;left:-4px}.ewr_selection_rearrangebottom{border-bottom:3px solid #217346;position:absolute;width:10px;height:0;bottom:-5px;left:-4px}.ewr-cell-selection-highlight-all.selecting .ewr-selection-draghandle{cursor:unset}.ewr-selection-resizemarqueehandle{position:absolute;width:5px;height:5px;background-color:#217346;border:solid 1px #fff;z-index:16;pointer-events:auto}.ewr-selection-resizemarqueehandle-topleft,.ewr-selection-resizemarqueehandle-topright{top:-4px}.ewr-selection-resizemarqueehandle-bottomleft,.ewr-selection-resizemarqueehandle-bottomright{bottom:-4px}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomright{cursor:nwse-resize}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomright{cursor:nesw-resize}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topright{cursor:nesw-resize}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topright{cursor:nwse-resize}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topright,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomright{left:-4px}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topright,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomright{right:-4px}.ms-core-needIEFilter .ewr-selection-resizemarqueehandle{filter:alpha(opacity=1);-ms-filter:"alpha(opacity=1)"}.ewr-marquee-thick{z-index:calc(10 + 1) !important;border-width:3px !important}.ewr-grdcontarea-ltr .ewr-marquee-thick{margin:-3px 0 0 -3px !important}.ewr-grdcontarea-rtl .ewr-marquee-thick{margin:-3px -3px 0 0 !important}.ewr-resizemarqueehandle-thick{height:6px !important;width:6px !important}');
vf.a.Ti('.ewa-stb-uir{background-color:#f5f5f5;height:32px}.grid-visual-refresh .ewa-stb-ltr,.grid-visual-refresh .ewa-stb-rtl{background-color:#f5f5f5}.ewa-stb-drag{cursor:pointer}.ewa-stb-navarea{position:relative;flex-shrink:0;top:0;border:0;height:27px;width:auto;padding:0;margin:0;overflow:hidden}.ewa-stb-uir .ewa-stb-navarea-dimensions{height:32px}.ewa-stb-ltr .ewa-stb-navarea{left:0}.ewa-stb-rtl .ewa-stb-navarea{right:0}.ewa-stb-navbutton{border:0;padding:0;margin:0;width:27px;height:27px}.ewa-stb-uir .ewa-stb-navbutton{width:24px;height:24px;margin:4px;border-radius:2px}.ewa-stb-uir .ewa-stb-navbutton:hover{background-color:#e1dfdd}.ewa-stb-uir .ewa-stb-navbutton:active{background-color:#bebbb8}.ewa-stb-ltr .ewa-stb-navbutton{float:left}.ewa-stb-rtl .ewa-stb-navbutton{float:right}.ewa-stb-navbutton .clip16x16{display:inline-block;margin:5px 6px 6px 5px}.ewa-stb-uir .ewa-stb-navbutton .clip12x12{display:inline-block;margin:6px}.ewa-stb-uir .cui-disabled svg{fill-opacity:.3}.ewa-stb-navbutton.cui-disabled .cui-img-container{opacity:.3}.ewa-stb-navareaextra{position:relative;flex-shrink:0;top:0;border:0;height:27px;width:auto;padding:0;margin:0;overflow:hidden}.ewa-stb-contentarea{position:relative;flex:0 1 auto;min-width:0%;top:0;left:0;right:0;border:0;height:27px;padding:0;margin:0;white-space:nowrap}.ewa-stb-uir .ewa-stb-contentarea{height:32px}.ewa-stb-uir .ewa-stb-left-scrollable.ewa-stb-contentarea::before{content:"";position:absolute;top:0;left:0;pointer-events:none;background-image:linear-gradient(90deg,#dcdcdc,transparent 1%);width:100%;height:32px;z-index:1}.ewa-stb-uir .ewa-stb-right-scrollable.ewa-stb-contentarea::after{content:"";position:absolute;top:0;left:0;pointer-events:none;background-image:linear-gradient(-90deg,#dcdcdc,transparent 1%);width:100%;height:32px;z-index:1}.ewa-stb-tabarea{position:relative;top:0;height:27px;left:0;right:0}.ewa-stb-uir .ewa-stb-tabarea{height:32px}.ewa-stb-sheettabmoveindicator{position:absolute;top:-4px}.ewa-stb-tabs{display:block;height:27px;list-style:none;left:0;right:0;margin:0;padding:0;overflow-x:scroll;overflow-y:hidden;white-space:nowrap}.ewa-stb-uir .ewa-stb-tabs{height:32px}.ewa-stb-tabs-smooth{scroll-behavior:smooth}@media(prefers-reduced-motion:reduce){.ewa-stb-tabs{scroll-behavior:auto}}.ewa-stb-tabs .tab-active,.ewa-stb-tabs .tab-inactive{background-color:#f6f6f6;background-image:none;border:0 solid #ababab;border-left-width:1px;padding:0;height:22px;margin:2px 0 3px 0;display:inline-block;overflow:hidden;transform:translateX(0);transition:transform .2s}.ewa-stb-tabs .tab-active{border-bottom-width:2px;border-bottom-color:#217346;border-bottom-style:solid;margin:2px 0 3px 0;height:20px;background-color:#f6f6f6;transform:translateX(0);transition:transform .2s}.ewa-stb-uir .tab-active,.ewa-stb-uir .tab-inactive{background-color:#f5f5f5;border:0;margin:0;height:32px}.ewa-stb-uir .tab-hover{background-color:#e1dfdd}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active{background-color:Highlight;forced-color-adjust:none}}.ewa-stb-tabs .tab-active.ewa-stb-tabs-ghost,.ewa-stb-uir .ewa-stb-tabs-ghost{position:fixed;z-index:1000;border-right-width:1px;transition:none}.ewa-stb-tabs .tab-anchor-text{text-decoration:none;white-space:nowrap;height:22px;display:block}.ewa-stb-uir .tab-anchor-text{height:32px}.ewa-stb-tabs .dark{color:#444;white-space:pre;height:18px}.ewa-stb-tabs .light{color:#fff;white-space:pre;height:18px}.ewa-stb-tabs .tab-active-text{color:#217346;height:14px}.ewa-stb-uir .tab-active-text{color:#444;line-height:16px;padding-bottom:5px}.ewa-stb-uir .tab-active .tab-content-container::before{content:"";position:absolute;display:inline-block;top:0;bottom:0;left:0;right:0;color:rgba(0,0,0,0);border-bottom:3px solid #217346;padding-bottom:5px;width:calc(100% - 18px);margin:auto;transition:width 400ms cubic-bezier(.17,.17,0,1) 0s}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active .tab-content-container::before{border-bottom-color:HighlightText}.ewa-stb-uir .tab-active svg>path.OfficeIconColors_HighContrast{fill:HighlightText}}.ewa-stb-uir .tab-active.tab-hover .tab-content-container:hover::before{width:calc(100%)}.ewa-stb-tabs .tab-text,.ewa-stb-tabs .tab-content-container{white-space:pre;font-size:10pt;display:inline-block;text-align:center;margin-bottom:0}.ewa-stb-tabs .tab-content-container{padding:0 18px 0 18px;margin:0 2px 0 2px}.ewa-stb-uir .tab-content-container{padding:3px 6px 3px 6px;border-radius:2px;margin:2px 3px 2px 3px;font-size:14px}.ewa-stb-tabs .cui-img-container{top:1px}.ewa-stb-tabs .tab-content-container .clip12x12,.ewa-stb-tabs .tab-content-container .clip16x16,.ewa-stb-tabs .tab-content-container .clip24x16{display:inline-block}.ewa-stb-nsv-inactive{opacity:.7}.ewa-stb-nsv-inactive-svg{fill-opacity:.7}.ewa-stb-nsv-active{opacity:1}.ewa-stb-nsv-active-svg{fill-opacity:1}.ewa_nsv_margin{margin-left:4px !important;height:14px}.ewa-stb-rtl .ewa_nsv_margin{margin-left:0 !important;margin-right:4px !important}@media screen and (-ms-high-contrast:active){.ewa-stb-tabs .tab-active-text{color:ButtonText}}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active-text{color:HighlightText}}.ewa-stb-disable-scrollbar *::-webkit-scrollbar{display:none}.ewa-stb-disable-scrollbar *{scrollbar-width:none;-ms-overflow-style:none}.leave-size-fixed-on-tab-hover-old::after{display:block;content:attr(sheet-title);font-weight:bold;overflow:hidden;visibility:hidden}.leave-size-fixed-on-tab-hover::after{display:block;content:attr(sheet-title);font-weight:bold;overflow:hidden;visibility:hidden;height:0}.ewa-stb-locked-sheet{margin-right:4px !important;height:13px !important;width:12px !important}.ewa-stb-locked-sheet-svg{margin-right:4px !important;height:15px !important;width:12px !important}.ewa-stb-tabs .ewa-stb-locked-sheet-svg-16px{margin-right:4px}.ewa-stb-rtl .ewa-stb-locked-sheet{margin-right:0 !important;margin-left:4px !important}.ewa-stb-dropdown-menu-button{position:relative;display:inline-block;padding:0;margin:0;border:0}.ewa-active-sheet-menu-item{background-color:#e1dfdd}.ewr-presentMode-on .ewa-stb-uir,.ewr-presentMode-on .ewa-stb-tabs .tab-active,.ewr-presentMode-on .ewa-stb-tabs .tab-inactive,.ewr-presentMode-on .ewa-stb-uir .tab-active,.ewr-presentMode-on .ewa-stb-uir .tab-inactive,.ewr-presentMode-on.grid-visual-refresh .ewa-stb-ltr,.ewr-presentMode-on.grid-visual-refresh .ewa-stb-rtl{background-color:#3b3a39}.ewr-presentMode-on .ewa-stb-uir .tab-hover,.ewr-presentMode-on .ewa-stb-uir .ewa-stb-navbutton:hover{background-color:#484644}.ewr-presentMode-on .ewa-stb-tabs .tab-active :focus,.ewr-presentMode-on .ewa-stb-tabs .tab-inactive :focus,.ewr-presentMode-on .ewa-stb-uir .ewa-stb-navbutton.cui-disabled:focus{background-color:#3b3a39 !important;border:1px solid #e5e5e5 !important}.ewr-presentMode-on .ewa-stb-tabs .tab-active,.ewr-presentMode-on .ewa-stb-tabs .tab-active-text{border-bottom-color:#37a660}.ewr-presentMode-on .ewa-stb-uir .tab-active .tab-content-container::before{border-bottom:3px solid #37a660}.ewr-presentMode-on .ewa-stb-tabs .light{color:#e1dfdd}.ewr-presentMode-on .ewa-stb-uir .tab-active-text{color:#f3f2f1}.ewa-active-sheet-menu-item-present-mode{background-color:#605e5c}.ewr-presentMode-transition .ewa-stb-uir,.ewr-presentMode-transition .ewa-stb-tabs .tab-active,.ewr-presentMode-transition .ewa-stb-tabs .tab-inactive,.ewr-presentMode-transition .ewa-stb-uir .tab-active,.ewr-presentMode-transition .ewa-stb-uir .tab-inactive,.ewr-presentMode-transition.grid-visual-refresh .ewa-stb-ltr,.ewr-presentMode-transition.grid-visual-refresh .ewa-stb-rtl{transition:background-color .4s linear}.ewr-presentMode-transition .ewa-stb-tabs .light,.ewr-presentMode-transition .ewa-stb-uir .tab-active-text{transition:color .4s linear}');
vf.a.Ti(".ewa-svg-icon{height:100%;width:100%}");vf.a.Ti(".ewa-ttrd-buttonarea{position:absolute;z-index:31}.ewr-table-resize-fillhandle-broader{position:absolute;width:6px;height:3px;bottom:0;background-color:#003960;z-index:17;pointer-events:auto}.ewr-table-resize-fillhandle-higher{position:absolute;width:3px;height:6px;bottom:0;background-color:#003960;z-index:17;pointer-events:auto}.ewr-grdcontarea-ltr .ewr-table-resize-fillhandle-higher{right:-6px}.ewr-grdcontarea-rtl .ewr-table-resize-fillhandle-higher{left:-6px}.ewr-grdcontarea-ltr .ewr-table-resize-handle{cursor:nwse-resize;right:6px;bottom:0}.ewr-grdcontarea-rtl .ewr-table-resize-handle{cursor:nesw-resize;left:6px;bottom:0}.ewr-grdcontarea-ltr .ewr-table-resize-handle .ewr-table-resize-default-cursor{cursor:default}.ewr-grdcontarea-rtl .ewr-table-resize-handle .ewr-table-resize-default-cursor{cursor:default}.ewr-cell-selection-highlight-all.Selecting .ewr-table-resize-handle{cursor:nesw-resize}@media screen and (-ms-high-contrast:active),(forced-colors:active){.ewr-table-resize-fillhandle-higher{forced-color-adjust:none;position:absolute;width:3px;height:6px;bottom:0;background-color:#fff;z-index:17;pointer-events:auto}.ewr-table-resize-fillhandle-broader{forced-color-adjust:none;position:absolute;width:6px;height:3px;bottom:0;background-color:#fff;z-index:17;pointer-events:auto}}@media screen and (-ms-high-contrast:black-on-white),(forced-colors:active) and (prefers-color-scheme:light){.ewr-table-resize-fillhandle-higher{background-color:#000}.ewr-table-resize-fillhandle-broader{background-color:#000}}");
Ef.a.Ga(Cd.ka);vc.a.ij.Ha(141,new ed);Ef.a.Ga(id.ka);(function(){Ef.a.Ga(function(W){Zd.ka(W);Td.EwaSettings.Gb()?Sc.ka(W):Pc.ka(W);ad.ka(W);hd.ka(W)})})();Ef.a.Ga(fb.ka);Ef.a.Ga(Zc.ka);(function(){Ef.a.Ga(function(W){W.da.Ha(134,new Sb(W));W.da.Ha(330,new db(W))})})();Ef.a.Ga(rc.ka);(function(){Ef.a.Ga(function(W){Za.ka(W);Va.ka(W)})})();Type.registerNamespace("Common.App.SessionExpiration");Ef.a.Ga(da.ka);Ef.a.Ga(a.ka);Ef.a.Ga(ra.ka)}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.acc.js.map/7c1dbb28efceefbb8df4c27d02d0ef20/EwaDS.acc.js.map