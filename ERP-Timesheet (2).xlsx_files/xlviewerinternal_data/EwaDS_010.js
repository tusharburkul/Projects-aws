(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[4],{1049:function(z,F,b){function a(){}b.d(F,"a",function(){return a});z=b(0);var c=b(13),e=b(4),l=b(37),m=b(23);a.Y_e=function(n,h){switch(n){case 3:return a.Q5h(h);case 2:return a.RZh(h);case 1:return a.bUh(h)}return""};a.Q5h=function(n){switch(n){case 1:return e.AFrameworkApplication.ha.appSettings.WildFireAdjustLinkWordWac.toString();case 2:return e.AFrameworkApplication.ha.appSettings.WildFireAdjustLinkWordWac.toString()}return""};
a.RZh=function(n){switch(n){case 1:return e.AFrameworkApplication.ha.appSettings.WildFireAdjustLinkPptWac.toString();case 2:return e.AFrameworkApplication.ha.appSettings.WildFireAdjustLinkPptWac.toString()}return""};a.bUh=function(n){switch(n){case 1:return e.AFrameworkApplication.ha.appSettings.WildFireAdjustLinkExcelWac.toString();case 2:return e.AFrameworkApplication.ha.appSettings.WildFireAdjustLinkExcelWac.toString()}return""};a.openInClient=function(n,h,u){if(m.a.dh||m.a.xp)window.setTimeout(function(){a.vRf(u,
a.yec())},500),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(a.gue(u),n,0,!1)};a.a2g=function(n,h,u,w){h&&w&&w();a.openInClient(n,h,u)};a.yec=function(){return m.a.dh?1:m.a.xp?2:m.a.V8a?3:m.a.isMac?4:0};a.M5h=function(n){switch(n){case 3:return"WildFireWordBizBar";case 2:return"WildFirePowerPointBizBar";case 1:return"WildFireExcelBizBar";default:return""}};a.N5h=function(n){switch(n){case 3:return"WildFireWordBizBarFlight";case 2:return"WildFirePowerPointBizBarFlight";case 1:return"WildFireExcelBizBarFlight";
default:return""}};a.vRf=function(n,h){1===h?(c.ULS.sendTraceTag(17151569,306,50,"User Directed to App Store"),n=a.Y_e(n,h),8<m.a.K6a?l.a.wf(n,void 0,void 0,"RedirectToAppStore"):l.a.XV(n)):document.hidden||(a.cBb?(n=e.AFrameworkApplication.ha.appSettings.WildFireUrlChinaStoreAndroid.toString())?(c.ULS.sendTraceTag(18088018,306,50,"User Directed to China Proxy Page"),l.a.XV(n)):c.ULS.sendTraceTag(18088019,306,50,"Empty Url in China Proxy Page BRS Setting"):(c.ULS.sendTraceTag(18088020,306,50,"User Directed to Play Store"),
MSOJS.ClientUtils.NavigateToUrlUsingClickingOnATag(a.Y_e(n,h),null,null)))};a.gue=function(n){switch(n){case 3:return 5;case 2:return 3;case 1:return 1;default:return 0}};a.ngd=function(n){switch(n){case 3:return"WordBizBarDismiss";case 2:return"PptBizBarDismiss";case 1:return"ExcelBizBarDismiss";default:return""}};a.osd=function(n){return(n=a.WWh(n))&&""!==n?Boolean.parse(n):!1};a.ESd=function(n){a.rwj(n)};a.WWh=function(n){try{return localStorage.getItem(n)}catch(h){return c.ULS.sendTraceTag(18416668,
306,50,"WildFire LocalStorage GetItem Failed with NullReferenceException : "+h.message),null}};a.rwj=function(n){try{localStorage.setItem(n,"true")}catch(h){c.ULS.sendTraceTag(18416669,306,50,"WildFire LocalStorage SetItem Failed with exception : "+h.message)}};uk.Object.defineProperties(a,{cBb:{configurable:!0,enumerable:!0,get:function(){return"zh-CN"===window.navigator.language}},Gzc:{configurable:!0,enumerable:!0,get:function(){return(m.a.V8a||m.a.isMac)&&m.a.yp}},IDj:{configurable:!0,enumerable:!0,
get:function(){return m.a.dh||m.a.xp}}});a.gCe="ChromeExtensionBarDismiss";Object(z.a)(a,"WildFireUtilities",null,[])},1157:function(z,F,b){function a(v,A){var t=this;this.fd=function(){h.a.Eg(w.a(t.$).ud.activityState,y.a.hCd)||t.jba.reset()};this.$=A;this.Dmc=v;this.ea=A.ea;this.ea.ek(this.fd);this.jba=B.a.pwe(this.$)}function c(v){var A=this;this.qj=this.SFc=null;this._state=0;this.moveNext=function(){try{for(A._state=1;1===A._state;)A.Tu=A.Tu()}catch(t){A.dispose(),A._state=3}};this.Ef=v;this.Tu=
this.AM;this.moveNext()}b.r(F);z=b(0);var e=b(13),l=b(35),m=b(210),n=b(118),h=b(34),u=b(1),w=b(65),r=b(53);c.prototype.AM=function(){this.SFc=this.Ef.$.Sb.Hc("LoadResource","DownloadACopyOperation");return this.r3d};c.prototype.r3d=function(){var v=b(1157).DownloadACopyOperation;if(this.Ef.jba.Kcf||!(this.SFc.Gc<v.Ymc))return this.Alg;this.qj=r.Task.delay(v.qNe).g();this.qj.isCompleted||(this._state=2,this.qj.xO(this.moveNext));return this.ohb};c.prototype.Alg=function(){var v=b(1157).DownloadACopyOperation;
this.SFc.Gc>=v.Ymc&&e.ULS.sendTraceTag(537154819,0,15,"Download did not complete after 10 seconds.");w.a(this.Ef.$).ud.iK();this._state=3};c.prototype.ohb=function(){this.qj.Kz();return this.r3d};c.prototype.dispose=function(){};Object(z.a)(c,"$$sm_Microsoft$Office$Excel$WebUI$Client$OpenInClient$DownloadACopyOperation$IframeCompleteLoadOld",null,[3]);var B=b(1249),y=b(146);b.d(F,"DownloadACopyOperation",function(){return a});a.prototype.$lh=function(){var v=this,A=this.mWg(this.$),t=this.$.userOperationManager.operationCount;
0<t&&e.ULS.sendTraceTag(537154822,0,15,"flushing queue in downloadcopy. Queue is {0}",t);this.$.userOperationManager.d5("DownloadACopyOperation.DownloadForkedFile");this.Dmc&&e.ULS.sendTraceTag(537154821,0,50,"DownloadACopyOperation - Dataloss scenario");this.jba.downloadFile(A,-21742208);u.EwaSettings.isChangeGateEnabled("OfficeVSO:5364656_RefactorOutAwaitsInScriptSharpWithContinueWithAndLogExceptionsMethodV2")?l.TaskExtensions.Ba(r.Task.delay(1),function(){v.Jcf()},this.jba.la,3):l.TaskExtensions.Ba(r.Task.delay(1),
function(){v.Aci()},this.jba.la,3)};a.prototype.dispose=function(){this.ea&&this.ea.tk(this.fd);this.$=this.ea=null};a.prototype.Jcf=function(v){var A=this;(v=void 0===v?null:v)||(v=this.$.Sb.Hc("LoadResource","DownloadACopyOperation"));!this.jba.Kcf&&v.Gc<a.Ymc?window.setTimeout(function(){A.Jcf(v)},a.qNe):(v.Gc>=a.Ymc&&e.ULS.sendTraceTag(537154820,0,15,"Download did not complete after 10 seconds."),w.a(this.$).ud.iK())};a.prototype.Aci=function(){new c(this)};a.prototype.mWg=function(v){var A=new Sys.StringBuilder,
t=v.workbookContext,E=v.ya;A.append(v.Bea);A.append(E.FileHandlerRelativeUri);A.append("?id=");A.append(encodeURIComponent(m.a.dJb(t.WorkbookUri,"sc")));v.ea.sc&&(A.append("&sessionId="),A.append(encodeURIComponent(v.ea.sessionId)));A.append("&workbookType=FullForkedWorkbook");A.append("&dataloss=");A.append(this.Dmc?"true":"false");n.a.lHa(A,E);return A.toString()};a.Ymc=1E5;a.qNe=100;Object(z.a)(a,"DownloadACopyOperation",null,[3])},1241:function(z,F,b){function a(n,h){n=m.call(this,n,h)||this;
c.ULS.sendTraceTag(537170201,0,50,"WacGdprNoticeBusinessBarEntry.WacGdprNoticeBusinessBarEntry: Called");n.title="";n.message=a.Xya;n.bxa=!0;return n}b.d(F,"a",function(){return a});z=b(0);var c=b(13),e=b(37),l=b(79);b=b(917);var m=b.a;Am(a,m);a.prototype.jna=function(n){m.prototype.jna.call(this,n);e.a.openWindow(4,l.a.UH(a.qsf))};a.prototype.wD=function(n){m.prototype.wD.call(this,n);a.nyd&&a.nyd(null)};a.initialize=function(n,h,u,w){c.ULS.sendTraceTag(537170200,0,50,"WacGdprNoticeBusinessBarEntry.Initialize: Called");
a.Xya=n;a.rsf=h;a.qsf=u;a.nyd=w};uk.Object.defineProperties(a.prototype,{linkText:{configurable:!0,enumerable:!0,get:function(){return a.rsf}}});a.Xya=null;a.rsf=null;a.qsf=null;a.nyd=null;Object(z.a)(a,"WacGdprNoticeBusinessBarEntry",b.a,[])},1242:function(z,F,b){function a(){}b.d(F,"a",function(){return a});z=b(0);a.hrh="ewa-bb";a.jrh="ewa-bb-entry";a.krh="ewa-bb-entry-body";a.qrh="ewa-bb-icon";a.mrh="ewa-bb-entry-icon";a.prh="ewa-bb-entry-title";a.orh="ewa-bb-entry-message";a.tQe="ewa-bb-entry-button";
a.nrh="ewa-bb-entry-link";a.lrh="ewa-bb-entry-close";a.uQe="ewa-bb-entry-button-holder";a.jbd="ewa-nov2-ltr";a.irh="ewa-bb-content";a.lbd="ewa-nov2-rtl";Object(z.a)(a,"CssClassNames",null,[])},1243:function(z,F,b){function a(e,l){e=c.call(this,e,l)||this;e.qv=!0;e.title=a.mqa;e.message=a.kqa;return e}b.d(F,"a",function(){return a});z=b(0);b=b(917);var c=b.a;Am(a,c);a.prototype.Ho=function(e){c.prototype.Ho.call(this,e);(e=a.lqa)&&e(null)};a.initialize=function(e,l,m,n){a.mqa=e;a.kqa=l;a.jqa=m;a.lqa=
n};uk.Object.defineProperties(a.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return a.jqa}}});a.mqa=null;a.kqa=null;a.jqa=null;a.lqa=null;Object(z.a)(a,"AutomaticSensitivityLabelBusinessBarEntry",b.a,[])},1244:function(z,F,b){function a(e,l){e=c.call(this,e,l)||this;e.qv=!0;e.title=a.mqa;e.message=a.kqa;return e}b.d(F,"a",function(){return a});z=b(0);b=b(917);var c=b.a;Am(a,c);a.prototype.Ho=function(e){c.prototype.Ho.call(this,e);(e=a.lqa)&&e(null)};a.initialize=function(e,
l,m,n){a.mqa=e;a.kqa=l;a.jqa=m;a.lqa=n};uk.Object.defineProperties(a.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return a.jqa}}});a.mqa=null;a.kqa=null;a.jqa=null;a.lqa=null;Object(z.a)(a,"RecommendedSensitivityLabelBusinessBarEntry",b.a,[])},1245:function(z,F,b){function a(e,l){e=c.call(this,e,l)||this;e.qv=!0;e.title=a.mqa;e.message=a.kqa;return e}b.d(F,"a",function(){return a});z=b(0);b=b(917);var c=b.a;Am(a,c);a.prototype.Ho=function(e){c.prototype.Ho.call(this,e);(e=
a.lqa)&&e(null)};a.initialize=function(e,l,m,n){a.mqa=e;a.kqa=l;a.jqa=m;a.lqa=n};uk.Object.defineProperties(a.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return a.jqa}}});a.mqa=null;a.kqa=null;a.jqa=null;a.lqa=null;Object(z.a)(a,"MandatorySensitivityLabelBusinessBarEntry",b.a,[])},1246:function(z,F,b){function a(e,l){e=c.call(this,e,l)||this;e.qv=!0;e.title=a.LDb;e.message=a.Xya;return e}b.d(F,"a",function(){return a});z=b(0);b=b(917);var c=b.a;Am(a,c);a.prototype.Ho=function(e){c.prototype.Ho.call(this,
e);a.Zya&&a.Zya(null)};a.initialize=function(e,l,m,n){a.LDb=e;a.Xya=l;a.K9a=m;a.Zya=n};uk.Object.defineProperties(a.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return a.K9a}}});a.LDb=null;a.Xya=null;a.K9a=null;a.Zya=null;Object(z.a)(a,"SensitivityLabelMinorVersionLimitReachedBusinessBarEntry",b.a,[])},1247:function(z,F,b){function a(e,l){e=c.call(this,e,l)||this;a.K9a&&a.Zya&&(e.qv=!0);e.title=a.LDb;e.message=a.Xya;return e}b.d(F,"a",function(){return a});z=b(0);b=b(917);
var c=b.a;Am(a,c);a.prototype.Ho=function(e){c.prototype.Ho.call(this,e);a.Zya&&a.Zya(null)};a.initialize=function(e,l,m,n){a.LDb=e;a.Xya=l;a.K9a=m;a.Zya=n};uk.Object.defineProperties(a.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return a.K9a}}});a.LDb=null;a.Xya=null;a.K9a=null;a.Zya=null;Object(z.a)(a,"SensitivityApplicationSetLabelErrorBusinessBarEntry",b.a,[])},1248:function(z,F,b){function a(n,h,u,w,r,B){this.VY=n;this.WY=h;this.uMc=u;this.pE=w;this.vTb=r;this.mWa=B}
b.d(F,"a",function(){return a});z=b(0);var c=b(1304),e=b(4),l=b(50),m=b(84);a.prototype.F$i=function(n){this.Hxf(n)};a.prototype.Xwi=function(n){this.Hxf(n)};a.prototype.Hxf=function(n){var h=10;1===n?(m.a.instance.resolve("Common.IOfficeTrialExperience").Blc(this.mWa),h=3):2===n&&((!this.uMc||this.uMc(this.pE))&&this.WY&&c.a.instance.tbh(this.WY,this.VY,this.pE),h=5);(0===n||1===n)&&this.VY&&this.VY(this.pE);e.AFrameworkApplication.Fvc(l.a.nJf,this.vTb,h);this.dispose()};a.prototype.dispose=function(){this.pE=
this.WY=this.VY=null};uk.Object.defineProperties(a.prototype,{O7f:{configurable:!0,enumerable:!0,get:function(){return!this.WY&&!this.uMc}},oxf:{configurable:!0,enumerable:!0,get:function(){return 2===this.mWa?CommonUIStrings.l_OICErrorC2ROneNoteOffer:CommonUIStrings.l_OICErrorC2ROffer}},id:{configurable:!0,enumerable:!0,get:function(){return"OICErrorDialogWithTrial"}},XPe:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorMessageNoOffice}},wcf:{configurable:!0,enumerable:!0,
get:function(){return CommonUIStrings.l_OICErrorIHaveOfficeButton}},gxa:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorHelpLink}},hbf:{configurable:!0,enumerable:!0,get:function(){return"OICFailure"}},icon:{configurable:!0,enumerable:!0,get:function(){return 3}},BZb:{configurable:!0,enumerable:!0,get:function(){return 2===this.mWa?CommonUIStrings.l_OICErrorC2RInstallOneNoteButton:CommonUIStrings.l_OICErrorC2RInstallButton}},uo:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_DefaultDialogTitle}}});
Object(z.a)(a,"AOICErrorDialogWithTrial",null,[3])},1249:function(z,F,b){function a(B,y){var v=r.call(this,B)||this;v.IZj=["id","sessionId","workbookType","workbookFileType","dataloss"];v.command=0;v.EFb=function(){var A=v.ZTh();if(A){v.$.LI(!0);if(-2028960985!==v.command&&1461300262!==v.command){var t=u.a(v.$).ud.activityState;t[h.a.PZa]=n.a.download;t[w.a.vWc]=v.command}m.a(v.$).Ss(A.Errors)}};v.iframe=B;v.$=y;v.xc.ka("load",v.EFb);return v}b.d(F,"a",function(){return a});z=b(0);var c=b(13),e=b(37);
F=b(240);var l=b(210),m=b(42),n=b(6),h=b(33),u=b(65),w=b(649),r=F.a;Am(a,r);a.prototype.downloadFile=function(B,y){var v={};(B=this.qEh(B,v))&&e.a.vsc("dlfr",B,v);this.command=y};a.prototype.qEh=function(B,y){var v=B.split("?");if(2!==v.length)return B=null,c.ULS.sendTraceTag(537154816,0,15,"FileLoader.ExtractParametersFromUriToDictionary: unable to parse URI (missing '?')"),B;v=v[1].split("&");v=Cl(v);for(var A=v.next();!A.done;A=v.next()){var t=A.value.split("=",2);if(2!==t.length){B=null;c.ULS.sendTraceTag(537154787,
0,15,"FileLoader.ExtractParametersFromUriToDictionary: unable to parse URI (key value pair has no '=' sign)");break}A=t[0];Array.contains(this.IZj,A)&&(t=decodeURIComponent(t[1]),y[A]=t,B=l.a.dJb(B,A))}return B};a.prototype.reset=function(){this.iframe&&(this.iframe.src="about:blank");this.command=1461300262};a.prototype.ZTh=function(){try{return this.iframe.contentWindow.ewaResult}catch(y){if(!this.$.ea.pc.isDivSyndicated){var B=window.document.referrer.match(RegExp("://(.[^/]+)/"));c.ULS.sendTraceTag(537154785,
0,50,"FileLoader.OnFrameLoad: parent domain: {0}, current domain: {1}, iframe domain: {2}. ewaControl IsCrossDomain: {3}",1<B.length?B[1]:"",escape(window.location.host),escape(this.iframe.contentWindow.location.host),this.$.Pxa);throw y;}return null}};a.pwe=function(B){var y=document.createElement("iframe");y.id="ewaFileLoader";y.style.cssText="height:0;width:0;display:none";y.src="about:blank";y.setAttribute("name","dlfr");y=B.domElement.appendChild(y);return new a(y,B)};uk.Object.defineProperties(a.prototype,
{Kcf:{configurable:!0,enumerable:!0,get:function(){return"loading"!=this.iframe.contentDocument.readyState&&"uninitialized"!=this.iframe.contentDocument.readyState}}});Object(z.a)(a,"FileLoader",F.a,[])},1250:function(z,F,b){function a(){this.BaseDocQuerySignature=null;this.RoamingApp=0}b.d(F,"a",function(){return a});z=b(0);var c=b(1405),e=b(4),l=b(40),m=b(79);a.prototype.$Qd=function(){return l.c([this.nka(),this])};a.prototype.execute=function(n,h,u){var w="RoamingAppsHandler.ashx";c.a.instance.roamingAppsAreEnabled&&
0<document.URL.toUpperCase().indexOf("WDENABLEROAMING=1")&&(w=m.a.vl(w,"wdEnableRoaming","1"));e.AFrameworkApplication.Ld.jm(w,2,this.$Qd(),{"Content-Type":"application/json; charset=utf-8"},!1,this.C5a(),n,h,u,void 0,void 0,void 0,void 0,"6")};Object(z.a)(a,"ARoamingAppsRequest",null,[])},1254:function(z,F,b){function a(){this.printOperationCallbacks=this.universalPrintAppSettings=this.setAdditionalHeaderText=this.disableBackToSheetButton=this.disableTellMeControl=this.logger=this.printPreviewPaneCallbacks=
this.backActionButtonText=null}b.d(F,"a",function(){return a});z=b(0);Object(z.a)(a,"PrintPreviewPaneProps",null,[])},1255:function(z,F,b){function a(){}b.d(F,"a",function(){return a});z=b(0);a.h6i="PrintDialogBody";a.printDialogTitle="PrintDialogTitle";a.h$b="ewa-dlg-elements-container-rtl";a.i6i="PrintDialogLeftContainer";a.j6i="PrintDialogRightContainer";a.Ebb="PrintDialogRadioButtonContainer";a.hNf="PrintRadioButtonElementInnerDiv";a.o6i="PrintRadioButtonElementOuterDiv";a.Fbb="PrintDialogTitleSection";
a.tId="PrintDialogComboBoxContainer";a.p6i="PrintRadioButtonIcon";a.g6i="PrintButtonArea";a.gx="PrintPreviewerContainer";Object(z.a)(a,"CssClassNames",null,[])},1296:function(z,F,b){function a(gc,Eb){var Tb=Ub.call(this,Eb)||this;Tb.mJh=P.DOMElementExtensions.nq+",div";Tb.qV=Array(66);Tb.Cm=!1;Tb.dX=function(Wc){if(Wc.Ca.keyCode===Q.a.kE){var T=Tb.Kb.querySelectorAll(Tb.mJh),ua=P.DOMElementExtensions.Nl(T);T=P.DOMElementExtensions.Iz(T);return P.DOMElementExtensions.Cea(Wc.Ca,ua,T)}return!1};Tb.wb=
gc;Tb.set_visible(!1);Tb.addCssClass(aa.a.hrh);O.KeyInputManager.instance.qa(ea.a.Ub,Tb.Kb,Tb.dX);ba.a(gc).Xg(Tb);return Tb}function c(gc,Eb,Tb,Wc,T,ua){var ma=H.call(this,gc,Eb,Tb)||this;nc.a.instance.create(function(){if(ma.businessBar&&ma.businessBar.wNa(Eb.GHa)){var wa=new ha.a(-847286761,0,ma.businessBar.$.jd,0,null),Ca={};Ca=(Ca.CalloutName=Wc,Ca.Target=ma.MT.domElement,Ca);ma.businessBar.$.Ka.dc(wa,Ca)}},T,ua,!0,!0);return ma}function e(gc,Eb,Tb,Wc){gc=Nb.call(this,gc,Eb)||this;gc.automateCommandManager=
Tb.da.Aa(352);U.ULS.shipAssertTag(526787654,0,!!gc.automateCommandManager);gc.id=jb.a.create();gc.$=Tb;gc.title=ab.a.instance.fa(2213);gc.message="";gc.WWd=ab.a.instance.fa(2209);gc.M0j=ab.a.instance.fa(2210);gc.Sjg=ab.a.instance.fa(2211);gc.Y5g=ab.a.instance.fa(2212);gc.update(Wc);return gc}function l(gc,Eb){gc=yb.call(this,gc,Eb)||this;gc.dDa=lb.a.G6b();gc.qv=!0;gc.C_=gc.dDa.SZj;gc.title=gc.dDa.title;gc.message=gc.dDa.message;return gc}function m(gc,Eb){gc=wc.call(this,gc,Eb)||this;gc.qv=!0;gc.title=
"";return gc}function n(gc,Eb){Eb=nb.call(this,gc,Eb)||this;Eb.policyManager=gc.$.da.Aa(274);if(!Eb.policyManager)return U.ULS.sendTraceTag(537170202,306,50,"Tried creating PolicyBusinessBarEntry but policyManager service has not been registered."),Eb;Eb.message=Eb.policyManager.isc;Eb.title=Eb.policyManager.title;Eb.bxa=!0;return Eb}function h(gc,Eb){gc=gb.call(this,gc,Eb)||this;gc.qv=!0;gc.C_=!0;return gc}function u(gc,Eb,Tb,Wc){gc=Za.call(this,gc,Eb)||this;gc.Tyb=Tb;gc.command=Wc;gc.bxa=!0;gc.qv=
1461300262!==Wc;return gc}function w(gc,Eb,Tb){gc=oa.call(this,gc,Eb)||this;gc.Tyb=Tb;gc.bxa=!0;return gc}function r(gc,Eb,Tb){gc=$b.call(this,gc,Eb)||this;gc.Tyb=Tb;gc.qv=!0;return gc}function B(gc,Eb){gc=xa.call(this,gc,Eb)||this;gc.qv=!0;gc.C_=!1;return gc}function y(gc,Eb){gc=bb.call(this,gc,Eb)||this;gc.qv=!0;gc.C_=!0;return gc}function v(gc,Eb,Tb,Wc,T,ua,ma,wa){return A.call(this,gc,0,Eb,Tb,Wc,T,ua,ma,wa)||this}function A(gc,Eb,Tb,Wc,T,ua,ma,wa,Ca){this.KJ=this.g9=this.MT=0;this.Opg=gc;this.OPj=
Eb;this.iQ=Tb;this.$tg=ma;this.vkb=I.a.sw(Ca);this.csg=Ca;this.Tpg=wa;0!==Wc&&(this.MT=Wc);0!==T&&(this.g9=T);0!==ua&&(this.KJ=ua)}function t(gc,Eb,Tb,Wc,T){gc=E.call(this,gc,Eb,Tb,Wc)||this;gc.command=T;gc.C_=!0;return gc}function E(gc,Eb,Tb,Wc){gc=Fa.call(this,gc,Eb)||this;gc.error=Tb;gc.options=Wc;gc.error&&gc.options&2&&(gc.message=gc.error.Description);gc.error&&gc.options&1&&(gc.title=gc.error.Caption);gc.qv=!(Wc&4);return gc}function C(gc,Eb,Tb){return H.call(this,gc,Eb,Tb)||this}function H(gc,
Eb,Tb){gc=qa.call(this,gc,Eb)||this;gc.qv=!0;gc.command=Tb;return gc}b.r(F);z=b(0);var U=b(13),Q=b(85),O=b(108),ea=b(12),Z=b(89),S=b(50),I=b(28),P=b(11),J=b(240),aa=b(1242),ia=b(5),ba=b(269),ra=b(1243),ka=b(917),da=b(1322),ha=b(95),qa=ka.a;Am(H,qa);H.prototype.Ho=function(gc){qa.prototype.Ho.call(this,gc);this.businessBar.$.Ka.dc(new ha.a(this.command,gc,this.businessBar.$.jd,10,null))};Object(z.a)(H,"CommandActionBusinessBarEntry",ka.a,[]);Am(C,H);C.prototype.wD=function(gc){H.prototype.wD.call(this,
gc)};Object(z.a)(C,"EditAttemptReadOnlyBusinessBarEntry",H,[]);var Aa=b(42),Fa=ka.a;Am(E,Fa);E.prototype.Ho=function(gc){Fa.prototype.Ho.call(this,gc);this.error.Appearance&=-33;Aa.a(this.businessBar.$).Ss([this.error])};Object(z.a)(E,"ErrorBusinessBarEntry",ka.a,[]);Am(t,E);t.prototype.y0=function(gc){E.prototype.y0.call(this,gc);this.businessBar.$.Ka.dc(new ha.a(this.command,gc,this.businessBar.$.jd,10,null))};Object(z.a)(t,"ErrorAndCommandBusinessBarEntry",E,[]);var ab=b(14);A.fa=function(gc){return ab.a.instance.fa(gc)};
uk.Object.defineProperties(A.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return A.fa(this.OPj)}},message:{configurable:!0,enumerable:!0,get:function(){return A.fa(this.iQ)}},messageId:{configurable:!0,enumerable:!0,get:function(){return this.iQ}},GHa:{configurable:!0,enumerable:!0,get:function(){return this.Opg}},actionButton:{configurable:!0,enumerable:!0,get:function(){return A.fa(this.MT)}},gHa:{configurable:!0,enumerable:!0,get:function(){return A.fa(this.g9)}},link:{configurable:!0,
enumerable:!0,get:function(){return A.fa(this.KJ)}},Xj:{configurable:!0,enumerable:!0,get:function(){return this.$tg}},vWg:{configurable:!0,enumerable:!0,get:function(){return this.Tpg}},hash:{configurable:!0,enumerable:!0,get:function(){return this.vkb}},alt:{configurable:!0,enumerable:!0,get:function(){var gc=b(1296).BusinessBarControl;switch(this.Xj){case gc.Dja:return A.fa(26);case gc.fC:return A.fa(25);case gc.xj:return A.fa(24);default:return A.fa(0)}}},zad:{configurable:!0,enumerable:!0,get:function(){return this.csg}}});
Object(z.a)(A,"EwaBusinessBarEntry",null,[]);Am(v,A);uk.Object.defineProperties(v.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return""}}});Object(z.a)(v,"EwaNoTitleBusinessBarEntry",A,[]);var Ua=b(71),bb=ka.a;Am(y,bb);y.prototype.Ho=function(gc){bb.prototype.Ho.call(this,gc);this.set_visible(!1);this.businessBar.$.QI();this.businessBar.$.Ka.dc(new ha.a(1038998010,gc,this.businessBar.$.jd,10,null))};y.prototype.y0=function(gc){bb.prototype.y0.call(this,gc);this.businessBar.$.Ka.dc(new ha.a(-722953877,
gc,this.businessBar.$.jd,10,null))};y.prototype.wD=function(gc){this.businessBar.removeEntry(53);Ua.g(gc)};Object(z.a)(y,"ExternalLinksEnableContentBusinessBarEntry",ka.a,[]);var xa=ka.a;Am(B,xa);B.prototype.Ho=function(gc){xa.prototype.Ho.call(this,gc);this.businessBar.$.Ka.dc(new ha.a(-722953877,gc,this.businessBar.$.jd,10,null))};B.prototype.wD=function(gc){this.businessBar.removeEntry(5);Ua.g(gc)};Object(z.a)(B,"ExternalLinksShowErrorBusinessBarEntry",ka.a,[]);var Gb=b(8),$b=ka.a;Am(r,$b);r.prototype.Ho=
function(gc){$b.prototype.Ho.call(this,gc);Gb.HelperMethods.pda(this.businessBar.$.sJ,this.Tyb,this.businessBar.$.qY)};Object(z.a)(r,"HelpButtonBusinessBarEntry",ka.a,[]);var oa=ka.a;Am(w,oa);w.prototype.jna=function(gc){oa.prototype.jna.call(this,gc);Gb.HelperMethods.pda(this.businessBar.$.sJ,this.Tyb,this.businessBar.$.qY)};Object(z.a)(w,"HelpTextBusinessBarEntry",ka.a,[]);var Ma=b(78),Za=ka.a;Am(u,Za);u.prototype.Ho=function(gc){Za.prototype.Ho.call(this,gc);this.businessBar.$.Ka.dc(new ha.a(this.command,
gc,this.businessBar.$.jd,10,null))};u.prototype.jna=function(gc){Za.prototype.jna.call(this,gc);var Eb=new ha.a(-859308420,gc,this.businessBar.$.jd,12,null),Tb={};gc=(Tb[Ma.a.Gg]="HelpID="+this.Tyb,Tb.InputMethod=gc,Tb[Ma.a.od]=ia.a.oW,Tb[ia.a.qpa]=!0,Tb);this.businessBar.$.Ka.dc(Eb,gc)};Object(z.a)(u,"HelpTextTaskPaneAndCommandBusinessBarEntry",ka.a,[]);var gb=ka.a;Am(h,gb);h.prototype.Ho=function(gc){gb.prototype.Ho.call(this,gc);this.set_visible(!1);this.businessBar.$.QI();this.businessBar.$.Ka.dc(new ha.a(-1081442996,
gc,this.businessBar.$.jd,10,null))};h.prototype.y0=function(gc){gb.prototype.y0.call(this,gc);this.businessBar.$.Ka.dc(new ha.a(1702917262,gc,this.businessBar.$.jd,10,null))};h.prototype.wD=function(gc){this.businessBar.removeEntry(57);Ua.g(gc)};Object(z.a)(h,"LinkedEntitiesEnableUntrustedImagesBusinessBarEntry",ka.a,[]);var zb=b(1245),nb=ka.a;Am(n,nb);n.prototype.jna=function(gc){nb.prototype.jna.call(this,gc);(gc=this.policyManager.yTi)&&gc(null)};uk.Object.defineProperties(n.prototype,{linkText:{configurable:!0,
enumerable:!0,get:function(){return this.policyManager.linkText}}});Object(z.a)(n,"PolicyBusinessBarEntry",ka.a,[]);var pa=b(1244),Ja=b(1247),Da=b(1246);b(439);var ib=b(185),Rb=b(26),wc=ka.a;Am(m,wc);m.prototype.Ho=function(gc){wc.prototype.Ho.call(this,gc);ib.c(Rb.a.bIi);window.open("https://www.microsoft.com/edge?form=MI13FQ&OCID=MI13FQ","_blank")};Object(z.a)(m,"UnsupportedBrowserBusinessBarEntry",ka.a,[]);var Cb=b(1241),lb=b(1337),yb=ka.a;Am(l,yb);l.prototype.Ho=function(gc){yb.prototype.Ho.call(this,
gc);this.dDa.Ryf(null)};l.prototype.y0=function(gc){yb.prototype.y0.call(this,gc);this.dDa.Uyf(null)};l.prototype.wD=function(gc){yb.prototype.wD.call(this,gc);this.dDa.fMe(null)};uk.Object.defineProperties(l.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return this.dDa.Zye}},gHa:{configurable:!0,enumerable:!0,get:function(){return this.dDa.aze}}});Object(z.a)(l,"WildFireMobileAppBusinessBarEntry",ka.a,[]);var pc=b(253),Ta=b(21),rb=b(230),ic=b(176),Va=b(44),jb=b(186),rc=b(1168),
Cc=b(76),Hc=b(131),Nb=ka.a;Am(e,Nb);e.prototype.update=function(gc){this.scriptLink=gc.scriptLink;this.runStatus=gc.runStatus;this.buttonText=gc.buttonText||"";this.Ryi(gc.clickId);this.qlj();"preparing"===this.runStatus?(this.message=String.format(ab.a.instance.Bb(198),this.buttonText),this.qv=!0,this.DZa=this.WWd,this.Yrb=this.sGa=this.sab):"running"===this.runStatus?(this.message=String.format(ab.a.instance.Bb(197),this.buttonText),this.qv=!0,this.DZa=this.WWd,this.Yrb=this.sGa=this.sab):"succeeded"===
this.runStatus?(this.message=String.format(ab.a.instance.Bb(200),this.buttonText),this.qv=!0,this.DZa=this.Sjg,this.sGa=this.GIf,this.C_=!0,this.LYc=this.M0j,this.MYc=this.BZi):"runFailed"===this.runStatus?(this.message=String.format(ab.a.instance.Bb(199),this.buttonText),this.L6a=a.Dja,this.qv=!0,this.DZa=this.Sjg,this.sGa=this.GIf,"false"===gc.isOwner&&(this.C_=!0,this.LYc=this.Y5g,this.MYc=this.NNi)):"fetchFailed"===this.runStatus?(this.L6a=a.Dja,this.message=String.format(ab.a.instance.Bb(201),
this.buttonText)):"canceled"===this.runStatus?(this.L6a=a.fC,this.message=String.format(ab.a.instance.Bb(203),this.buttonText)):"alreadyRunning"===this.runStatus?(this.L6a=a.fC,this.message=String.format(ab.a.instance.Bb(202),this.buttonText),this.qv=!0,this.DZa=this.WWd,this.Yrb=this.sGa=this.sab):"initializing"===this.runStatus&&(this.L6a=a.xj,this.message=ab.a.instance.fa(2214))};e.prototype.Ho=function(gc){Nb.prototype.Ho.call(this,gc);this.sGa&&this.sGa()};e.prototype.y0=function(gc){Nb.prototype.y0.call(this,
gc);this.gHa&&this.MYc()};e.prototype.wD=function(gc){Nb.prototype.wD.call(this,gc);this.Yrb&&this.Yrb()};e.prototype.qlj=function(){this.message="";this.L6a=a.xj;this.qv=!1;this.DZa="";this.sGa=void 0;this.C_=!1;this.LYc="";this.MYc=void 0;this.A6a=!1;this.Yrb=void 0};e.prototype.sab=function(){var gc=jb.a.create().toString();this.automateCommandManager.D7h(gc);this.bmc(-2186799,gc)};e.prototype.GIf=function(){var gc=jb.a.create().toString();this.automateCommandManager.C7h(gc);this.bmc(1036446140,
gc)};e.prototype.BZi=function(){var gc=jb.a.create();if(this.scriptLink){var Eb=new rc.b(this.scriptLink);this.automateCommandManager.F$e(this.id.toString(),JSON.stringify(Eb),gc)}this.bmc(-585097204,gc.toString())};e.prototype.NNi=function(){var gc=jb.a.create().toString();this.automateCommandManager.B7h(gc);this.bmc(-639858579,gc)};e.prototype.Ryi=function(gc){var Eb=[];Eb.push(Object.assign(new Cc.a,{name:"id",string:this.id.toString()}));Eb.push(Object.assign(new Cc.a,{name:"hasScriptLink",bool:!!this.scriptLink}));
Eb.push(Object.assign(new Cc.a,{name:"runStatus",string:this.runStatus}));Eb.push(Object.assign(new Cc.a,{name:"clickId",string:gc}));Eb.push(Object.assign(new Cc.a,{name:"hasButtonText",bool:!!this.buttonText&&""!==this.buttonText}));ib.a(Hc.a.LKi,void 0,void 0,Eb)};e.prototype.bmc=function(gc,Eb){var Tb=[];Tb.push(Object.assign(new Cc.a,{name:"id",string:this.id.toString()}));Tb.push(Object.assign(new Cc.a,{name:"hasScriptLink",bool:!!this.scriptLink}));Tb.push(Object.assign(new Cc.a,{name:"runStatus",
string:this.runStatus}));Tb.push(Object.assign(new Cc.a,{name:"clickId",string:Eb}));ib.d(gc,void 0,void 0,void 0,void 0,void 0,Tb)};uk.Object.defineProperties(e.prototype,{Xj:{configurable:!0,enumerable:!0,get:function(){return this.L6a}},actionButton:{configurable:!0,enumerable:!0,get:function(){return this.DZa}},gHa:{configurable:!0,enumerable:!0,get:function(){return this.LYc}}});Object(z.a)(e,"OfficeScriptsRunStatusBusinessBarEntry",ka.a,[]);var nc=b(46);Am(c,H);Object(z.a)(c,"CalloutBusinessBarEntry",
H,[]);var Ha=b(1),tb=b(17);b.d(F,"BusinessBarControl",function(){return a});var Ub=J.a;Am(a,Ub);a.prototype.Qe=function(gc,Eb){Eb||P.DOMElementExtensions.setFocus(this.domElement.firstChild);return!Eb};a.prototype.eg=function(gc){return P.DOMElementExtensions.Se(this.Kb,gc)};a.prototype.ji=function(){};a.prototype.Xh=function(){};a.prototype.dispose=function(){this.Cm||(O.KeyInputManager.instance.za(ea.a.Ub,this.Kb,this.dX),Z.a.tc(this.qV),this.qV=Array(66),this.wb=null,Ub.prototype.dispose.call(this),
this.Cm=!0)};a.prototype.wNa=function(gc){if(!this.get_visible())return!1;gc=this.qV[gc];return!!gc&&gc.isVisible};a.prototype.HC=function(gc){return!!this.qV[gc]};a.prototype.CPb=function(gc,Eb){if(gc=this.qV[gc])gc.update(Eb),gc.NVj()};a.prototype.OE=function(gc,Eb,Tb,Wc){Tb=void 0===Tb?null:Tb;Wc=void 0===Wc?null:Wc;var T=!1;if(this.HC(gc))Tb=this.qV[gc].get_visible();else{this.set_visible(!0);var ua=a.x8e()[gc];this.qV[gc]=this.Caa(gc,Eb,Tb,Wc);Tb=!1;T=!0;Wc="";var ma=0;Eb&&(Wc=Eb.MessageIdName,
ma=Eb.MessageId);var wa=ua.zad;U.ULS.sendTraceTag(537170258,0,50,"BusinessBarControl.AddEntry of type: {0}, time from app interactive: {1}",gc,Va.PageLoadTrackingInfo.instance.Hka(new Date));if(Ha.EwaSettings.isChangeGateEnabled("OfficeVSO:6069521_TelemetryForBusinessBar")){var Ca=this.qV.filter(function(db){return null!=db}).length;1<Ca&&U.ULS.sendTraceTag(525349006,0,50,"Total BizBars: {0}",Ca.toString())}ic.a(this.$).uNd(ua.hash,Wc,ma,S.a.iDc,!0,1,Eb,wa)}Tb||!Array.contains(da.a.Aec(),gc)&&!T||
(this.qV[gc].set_visible(!0),this.$.QI())};a.prototype.removeEntry=function(gc){return this.Jej(gc)};a.prototype.zLd=function(){Z.a.tc(this.qV);this.qV=Array(66);this.set_visible(!1)};a.prototype.Jej=function(gc){if(!this.HC(gc))return!1;Z.a.Fa(this.qV[gc]);this.qV[gc]=null;this.domElement.hasChildNodes()||this.set_visible(!1);this.$.QI();return!0};a.prototype.Caa=function(gc,Eb,Tb,Wc){Tb=void 0===Tb?null:Tb;Wc=void 0===Wc?null:Wc;var T=a.x8e()[gc],ua=!!(this.$.Dd&64);switch(gc){case 2:case 4:case 23:case 25:case 26:case 35:case 34:gc=
new ka.a(this,T);break;case 12:case 29:case 30:case 31:case 32:case 55:gc=ua?new H(this,T,-8805455):new ka.a(this,T);break;case 22:gc=new C(this,T,-8805455);break;case 44:case 43:gc=ua?new t(this,T,Eb,0,-8805455):new E(this,T,Eb,0);break;case 11:case 41:case 7:case 0:case 1:case 3:case 33:gc=new E(this,T,Eb,0);break;case 19:gc=new ka.a(this,T);break;case 45:gc=new E(this,T,Eb,0);break;case 6:case 14:gc=new r(this,T,Eb.HelpTopicId);break;case 64:gc=new w(this,T,Eb.HelpTopicId);break;case 36:gc=new w(this,
T,ia.a.Dfh);break;case 16:gc=new ka.a(this,T);gc.title=I.a.Rf(this.$.workbookContext.FullDocumentInfo.IrmPolicyTitle);gc.message=I.a.Rf(this.$.workbookContext.FullDocumentInfo.IrmPolicyDescription);break;case 18:gc=new H(this,T,-1762562205);gc.A6a=!0;break;case 20:gc=new l(this,T);break;case 21:case 54:gc=new ka.a(this,T);break;case 28:gc=new ka.a(this,T);break;case 24:gc=new m(this,T);break;case 27:gc=new n(this,T);break;case 37:gc=new Cb.a(this,T);break;case 38:gc=new ra.a(this,T);break;case 39:gc=
new pa.a(this,T);break;case 40:gc=new zb.a(this,T);break;case 46:gc=new ka.a(this,T);break;case 47:gc=new ka.a(this,T);break;case 48:gc=new ka.a(this,T);break;case 49:gc=new ka.a(this,T);break;case 50:gc=new ka.a(this,T);break;case 51:gc=new Da.a(this,T);break;case 52:gc=new Ja.a(this,T);break;case 53:gc=new y(this,T);break;case 5:gc=new B(this,T);break;case 56:gc=new H(this,T,-1753056834);Eb?(Eb=Eb.Directive,Ta.a.Co(Eb)||"&nbsp;"===Eb||(gc.message=Eb)):Tb&&(gc.message=Tb);break;case 57:gc=new h(this,
T);break;case 58:gc=new ka.a(this,T);break;case 59:case 62:gc=new w(this,T,ia.a.PJi);break;case 60:gc=new u(this,T,ia.a.GRg,-8805455);break;case 65:gc=new u(this,T,ia.a.jaj,1461300262);break;case 61:gc=Ha.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerBusinessBarTeachingCallout",!1)?new c(this,T,515196233,13,3E5,"OptimizeWorkbookManager.ShowBusinessBarTeachingCallout"):new H(this,T,515196233);break;case 63:gc=new e(this,T,this.$,Wc);break;default:gc=new E(this,
T,Eb,7)}gc.Z5c();return gc};a.x8e=function(){var gc=rb.a.O7a()?259:258;return a.Pye||(a.Pye=[new A(0,274,275,276,0,0,a.Dja,1,"BB_UnableToRefreshLock"),new A(1,274,275,276,0,0,a.Dja,1,"BB_UnableToRefreshLockExpected"),new A(2,266,267,0,0,0,a.fC,5,"BB_WorkbookAlmostTooLarge"),new A(3,268,269,270,0,0,a.Dja,1,"BB_WorkbookTooLarge"),new A(4,257,gc,0,0,0,a.fC,5,"BB_ExternalWorkbookLinksDisabled"),new A(5,261,260,262,0,0,a.Dja,1,"BB_ExternalWorkbookLinksShowError"),new A(6,263,264,265,0,0,a.xj,0,"BB_EditAndRefreshDisabledOnBIAHostedFiles"),
new A(7,249,250,251,0,0,a.xj,0,"BB_UnsupportedFeatures"),new A(8,0,0,0,0,0,a.xj,0,"BB_CollabDataAndDataStringsLocaleMismatch"),new A(9,0,0,0,0,0,a.xj,0,"BB_CollabDataStringsLocaleMismatch"),new A(10,0,0,0,0,0,a.xj,0,"BB_CollabDataLocaleMismatch"),new A(11,277,278,279,0,0,a.Dja,1,"BB_LastGenericStatusError"),new A(12,280,281,282,0,0,a.fC,5,"BB_ScratchPadWarning"),new A(13,283,284,285,0,0,a.Dja,1,"BB_AuthenticationLost"),new A(14,286,287,288,0,0,a.fC,5,"BB_OdfCompatibilityIssues"),new A(15,0,568,0,
0,0,a.fC,5,"BB_PivotChartInteractivityMissingWarning"),new A(16,0,0,0,0,0,a.xj,0,"BB_WorkbookIsIrmProtected"),new A(17,0,0,0,0,0,a.xj,0,"BB_BIFeatureNotAvailable"),new A(18,289,290,285,0,0,a.fC,5,"BB_AnonymousCreateMode"),new A(19,252,253,0,0,0,a.fC,5,"BB_UnsupportedInteractiveReportEditing"),new A(20,0,0,0,0,0,a.xj,0,"BB_MobileAppCampaignBizBar"),new A(21,295,296,0,0,0,a.xj,0,"BB_TransientServerCommunicationFailures"),new A(22,1598,1609,1610,0,0,a.xj,0,"BB_EditAttemptInReadOnly"),new A(23,1598,1609,
0,0,0,a.xj,0,"BB_EditAttemptInReadOnlyNoEditPermissions"),new A(24,0,Gb.HelperMethods.nVj(),1587,0,0,a.xj,0,"BB_UnsupportedBrowser"),new A(25,298,299,0,0,0,a.xj,0,"BB_ReadOnlyPermissions"),new A(26,300,301,0,0,0,a.xj,0,"BB_DocumentIsIrmProtectedWarning"),new A(27,0,0,0,0,0,a.fC,5,"BB_PolicyWarningMessage"),new A(28,1242,297,0,0,0,a.xj,0,"BB_WorkingOnIt"),new A(29,1598,1596,1597,0,0,a.xj,0,"BB_PasswordProtectedWorkbookLockedForEdit"),new A(30,1611,1612,1613,0,0,a.xj,0,"BB_WorkbookIsReadOnlyRecommended"),
new A(31,1598,1614,1615,0,0,a.xj,0,"BB_WorkbookHasPasswordToModify"),new A(32,1598,1616,1619,0,0,a.xj,0,"BB_LegacySharedWorkbookEditWarning"),new A(33,1606,1617,251,0,0,a.xj,0,"BB_LegacyConnectionsWarning"),new A(34,1607,1608,0,0,0,a.xj,0,"BB_GroupedSlicers"),new A(35,311,312,0,0,0,a.fC,5,"BB_ThirdPartyAddinDisabled"),new A(36,1739,1740,0,0,1741,a.xj,0,"BB_FinanceLinkedEntityDisclaimerBar"),new A(37,0,0,0,0,0,a.xj,0,"BB_WacGdprNotice"),new A(38,0,0,0,0,0,a.xj,0,"BB_AutomaticSensitivityLabel"),new A(39,
0,0,0,0,0,a.xj,0,"BB_RecommendedSensitivityLabel"),new A(40,0,0,0,0,0,a.xj,0,"BB_MandatorySensitivityLabel"),new A(41,313,314,315,0,0,a.xj,0,"BB_LocalStorageDisabled"),new A(42,625,626,0,0,0,a.xj,0,"BB_AutoRefreshDisabled"),new A(43,983,981,985,1271,0,a.xj,0,"BB_CorruptedFileRepaired"),new A(44,984,982,985,1271,0,a.xj,0,"CorruptedOdsFileRepaired"),new A(45,271,272,273,0,0,a.fC,5,"BB_MinorVersionLimitReached"),new A(46,302,303,0,0,0,a.fC,5,"BB_SensitivityApplicationGenericError"),new A(47,304,306,
0,0,0,a.fC,5,"BB_SensitivityApplicationTooLargeFileError"),new A(48,305,306,0,0,0,a.fC,5,"BB_SensitivityApplicationLabelNotSupportedError"),new A(49,307,308,0,0,0,a.fC,5,"BB_SensitivityApplicationLabelDisabledError"),new A(50,309,310,0,0,0,a.fC,5,"BB_SensitivityApplicationMandatoryConflictError"),new A(51,0,0,0,0,0,a.fC,5,"BB_SensitivityApplicationMinorVersionLimitReachedError"),new A(52,0,0,0,0,0,a.fC,5,"BB_SensitivityApplicationSetLabelError"),new A(53,2059,2060,2061,2064,0,a.xj,0,"BB_ExternalWorkbookLinksPromptEnableContent"),
new A(54,295,296,0,0,0,a.xj,0,"BB_NetworkDown"),new A(55,316,317,318,0,0,a.xj,0,"BB_DefaultToViewDueToCogs"),new A(56,1765,1766,1767,0,0,a.xj,0,"BB_RefreshLinkedEntityErrorBar"),new A(57,1742,1743,1744,1745,0,a.xj,0,"BB_LinkedEntitiesUntrustedImagesDisabled"),new v(58,248,0,0,0,a.xj,0,"BB_CanvasHealth"),new A(59,319,320,0,0,321,a.xj,0,"BB_NovModeDepreciation"),new A(60,986,987,1271,0,988,a.xj,0,"BB_MismatchedFileFormatConverted"),new A(61,2170,2171,2172,0,0,a.xj,0,"BB_OptimizeWorkbook"),new A(62,
322,323,0,0,324,a.xj,0,"BB_NovModePostDepreciation"),new A(63,0,0,0,0,0,a.xj,0,"BB_OfficeScriptsRunning"),new A(64,2149,2150,0,0,2151,a.xj,0,"BB_PowerQueryRefreshDataSourceNotSupported"),new A(65,325,326,0,0,327,a.xj,0,"BB_ReadOnlyPivotTable")])};uk.Object.defineProperties(a.prototype,{de:{configurable:!0,enumerable:!0,get:function(){return pc.a.G0c}},Kb:{configurable:!0,enumerable:!0,get:function(){return this.domElement}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.get_visible()}},
$:{configurable:!0,enumerable:!0,get:function(){return this.wb}}});a.Dja=tb.a.wvh;a.fC=tb.a.yvh;a.xj=tb.a.xvh;a.Pye=null;Object(z.a)(a,"BusinessBarControl",J.a,[451])},1304:function(z,F,b){function a(){this.Tkb=!!r.AFrameworkApplication.sa&&r.AFrameworkApplication.sa.Qa.Tw}function c(C,H,U){var Q=m.call(this,C,H,U)||this;C={};C=(C.errorMessage=Q.YPe,C.errorFileDownloadOffer=Q.Vub,C);H={};C.helpLink=(H.type="AppLinkProps",H.id="helpLink",H.text=Q.gxa,H.onExecute=function(O){Q.KPa(O)},H);H=new E.a(!1,
!1,!0);H.lc=1;H.Bc(1,Q.Wub);H.Ve=Q.id;U={};C=(U.id=Q.id,U.dialogIcon=Q.icon,U.bodyControls=C,U);H.initializeAndShow(Q.uo,Object(u.a)(Q,Q.TJd,"reactOICErrorDialogHandler"),C);return Q}function e(C,H,U,Q){var O=h.call(this,C,H,U,Q)||this;C={};C=(C.errorMessage=O.errorMessage,C);H={};C.helpLink=(H.type="AppLinkProps",H.id="helpLink",H.text=O.gxa,H.onExecute=function(ea){O.KPa(ea)},H);O.szc?(C.macOfficePreLinkText=O.Qsf,H={},C.macOfficeLink=(H.type="AppLinkProps",H.id="macOfficeLink",H.text=O.Nsf,H.onExecute=
function(ea){O.iCd(ea)},H),C.macOfficePostText=O.Psf):O.n5b&&(C.errorFileDownloadOffer=O.Vub);H=new E.a(!1,!1,!0);O.n5b?(H.lc=1,H.Bc(1,O.Wub)):H.lc=0;H.Ve=O.id;U={};C=(U.id=O.id,U.dialogIcon=O.icon,U.bodyControls=C,U);H.initializeAndShow(O.uo,Object(u.a)(O,O.TJd,"reactOICErrorDialogHandler"),C);return O}function l(C,H,U){C=m.call(this,C,H,U)||this;C.em=null;H=document.createElement("span");H.id="errorMessageText";H.innerText=C.YPe;H.appendChild(document.createElement("br"));H.appendChild(document.createElement("br"));
C.em=document.createElement("a");C.em.href="#";C.em.innerText=C.gxa;H.appendChild(C.em);A.a.addHandler(C.em,"click",Object(u.a)(C,C.KPa,"oicErrorHelpLinkHandler"));H.appendChild(document.createElement("br"));H.appendChild(document.createElement("br"));U=document.createElement("span");U.innerText=C.Vub;H.appendChild(U);U=new t.StandardDialog;U.Ve=C.id;U.lc=1;U.Bc(1,C.Wub);U.Fk(C.uo,null,C.icon,Object(u.a)(C,C.pwd,"legacyOICErrorDialogHandler"),H);U.UX("errorMessageText");return C}function m(C,H,U){this.VY=
H;this.WY=C;this.pE=U}function n(C,H,U,Q){C=h.call(this,C,H,U,Q)||this;C.em=null;C.Ira=null;H=document.createElement("span");H.id="errorMessageText";H.innerText=C.errorMessage;H.appendChild(document.createElement("br"));H.appendChild(document.createElement("br"));C.em=document.createElement("a");C.em.href="#";C.em.innerText=C.gxa;H.appendChild(C.em);A.a.addHandler(C.em,"click",Object(u.a)(C,C.KPa,"oicErrorHelpLinkHandler"));U=new t.StandardDialog;U.Ve=C.id;if(C.szc){Q=document.createElement("span");
var O=document.createElement("span");Q.innerText=C.Qsf;O.innerText=C.Psf;C.Ira=document.createElement("a");C.Ira.href="#";C.Ira.innerText=C.Nsf;H.appendChild(document.createElement("br"));H.appendChild(Q);H.appendChild(C.Ira);H.appendChild(O);A.a.addHandler(C.Ira,"click",Object(u.a)(C,C.iCd,"oicErrorMacOfferLinkHandler"))}else C.n5b&&(H.appendChild(document.createElement("br")),H.appendChild(document.createElement("br")),Q=document.createElement("span"),Q.innerText=C.Vub,H.appendChild(Q));C.n5b?(U.lc=
1,U.Bc(1,C.Wub)):U.lc=0;U.Fk(C.uo,null,C.icon,Object(u.a)(C,C.pwd,"legacyOICErrorDialogHandler"),H);U.UX("errorMessageText");return C}function h(C,H,U,Q){this.APc=null;this.vTb=Q;this.VY=C;this.WY=H;this.pE=U;this.Hke=this.Osf.HCj;C=CommonUIStrings.l_OICErrorMacOfficeOffer.split("{0}");this.mwg=C[0];this.lwg=C[1]}z=b(0);var u=b(82),w=b(13),r=b(4),B=b(50),y=b(439),v=b(84);h.prototype.TJd=function(C){this.bFb(C)};h.prototype.pwd=function(C){this.bFb(C)};h.prototype.bFb=function(C){var H=10;this.WY&&
1===C&&(this.WY(this.pE),H=1);this.VY&&this.VY(this.pE);this.zG(H)};h.prototype.KPa=function(){y.Redirect.showHelp("OICFailure");this.zG(2)};h.prototype.iCd=function(){this.Osf.nof();this.zG(4)};h.prototype.zG=function(C){w.ULS.sendTraceTag(18715410,211,10,"Report OICErrorDialog. Dialog cause: {0}, solution: {1}",this.vTb,C);r.AFrameworkApplication.Fvc(B.a.lJf,this.vTb,C)};h.prototype.dispose=function(){this.pE=this.VY=this.WY=null};uk.Object.defineProperties(h.prototype,{Osf:{configurable:!0,enumerable:!0,
get:function(){return this.APc||(this.APc=v.a.instance.resolve("Common.IMacOfficeOffer"))}},id:{configurable:!0,enumerable:!0,get:function(){return"OICErrorDialog"}},errorMessage:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorMessage}},gxa:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorHelpLink}},szc:{configurable:!0,enumerable:!0,get:function(){return this.Hke}},Qsf:{configurable:!0,enumerable:!0,get:function(){return this.mwg}},Psf:{configurable:!0,
enumerable:!0,get:function(){return this.lwg}},Nsf:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorMacOFficeLink}},icon:{configurable:!0,enumerable:!0,get:function(){return this.Hke?3:2}},Vub:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorFileDownloadOffer}},n5b:{configurable:!0,enumerable:!0,get:function(){return!!this.WY}},Wub:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}},uo:{configurable:!0,
enumerable:!0,get:function(){return CommonUIStrings.l_DefaultDialogTitle}}});Object(z.a)(h,"AOICErrorDialog",null,[3]);var A=b(41),t=b(133);Am(n,h);n.prototype.dispose=function(){this.em&&(A.a.removeHandler(this.em,"click",Object(u.a)(this,this.KPa,"oicErrorHelpLinkHandler")),this.em=null);this.Ira&&(A.a.removeHandler(this.Ira,"click",Object(u.a)(this,this.iCd,"oicErrorMacOfferLinkHandler")),this.Ira=null);h.prototype.dispose.call(this)};Object(z.a)(n,"OICErrorDialog",h,[]);m.prototype.TJd=function(C){this.bFb(C)};
m.prototype.pwd=function(C){this.bFb(C)};m.prototype.bFb=function(C){var H=10;1===C&&(this.WY(this.pE),H=1);this.VY&&this.VY(this.pE);this.zG(H)};m.prototype.KPa=function(){y.Redirect.showHelp("OICFailure");this.zG(2)};m.prototype.zG=function(C){r.AFrameworkApplication.Fvc(B.a.mJf,3,C)};m.prototype.dispose=function(){this.pE=this.WY=this.VY=null};uk.Object.defineProperties(m.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return"OICErrorDialogWithDownload"}},YPe:{configurable:!0,enumerable:!0,
get:function(){return CommonUIStrings.l_OICErrorNoOfficeDetected}},gxa:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorHelpLink}},Vub:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorFileDownloadOffer}},Wub:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}},icon:{configurable:!0,enumerable:!0,get:function(){return 2}},uo:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_DefaultDialogTitle}}});
Object(z.a)(m,"AOICErrorDialogWithDownload",null,[3]);Am(l,m);l.prototype.dispose=function(){this.em&&(A.a.removeHandler(this.em,"click",Object(u.a)(this,this.KPa,"oicErrorHelpLinkHandler")),this.em=null);m.prototype.dispose.call(this)};Object(z.a)(l,"OICErrorDialogWithDownload",m,[]);var E=b(149);Am(e,h);Object(z.a)(e,"ReactOICErrorDialog",h,[]);Am(c,m);Object(z.a)(c,"ReactOICErrorDialogWithDownload",m,[]);b.d(F,"a",function(){return a});a.prototype.sbh=function(C,H,U){this.Tkb?new e(C,H,null,U):
new n(C,H,null,U)};a.prototype.tbh=function(C,H,U){this.Tkb?new c(C,H,U):new l(C,H,U)};a.prototype.ubh=function(C,H,U,Q,O){var ea=b(1385).ReactOICErrorDialogWithTrial,Z=b(1386).OICErrorDialogWithTrial;this.Tkb?new ea(C,H,U,null,Q,O):new Z(C,H,U,null,Q,O)};uk.Object.defineProperties(a,{instance:{configurable:!0,enumerable:!0,get:function(){return a.Na||(a.Na=new a)}}});a.Na=null;Object(z.a)(a,"OICErrorDialogFactory",null,[88])},1322:function(z,F,b){function a(da,ha){var qa=ka.call(this)||this;qa.Oa=
new u.a;qa.YU=null;qa.nKc=[];qa.Ioc=function(){qa.$.na.eNa?qa.removeEntry(13):qa.lg(13,null)};qa.Lza=function(){I.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&e.ULS.sendTraceTag(537170243,0,50,"BusinessBar.OnNetworkResumed: removing TransientServerCommunicationFailures BB");qa.removeEntry(21);qa.HC(54)&&(e.ULS.sendTraceTag(537170242,0,15,"BusinessBar.OnNetworkResumed: removing NetworkDown BB"),qa.removeEntry(54));qa.UVf("OnNetworkResumed")};qa.Vh=function(Fa,ab){Fa=0;
for(var Ua=a.Aec().length;Fa<Ua;Fa++){var bb=a.Aec()[Fa];qa.removeEntry(bb)}ab.context&&0<ab.context.communicationErrorRetryCount&&(e.ULS.sendTraceTag(537170240,0,50,"OnWebMethodSuccess: retry due to previous communication failure succeeded, turning off the TransientServerCommunicationFailures business bar"),qa.removeEntry(21));qa.UVf("OnWebMethodSuccess")};qa.Xn=function(Fa,ab){var Ua;Fa=qa.fGh(ab.errors);for(var bb=[],xa=0,Gb=Fa.length;xa<Gb;++xa){var $b=Fa[xa];if(1===$b.Type&&$b.Appearance&32)bb=
qa.G9h($b,bb);else if(ab.vtj){e.ULS.sendTraceTag(537170210,0,50,"OnWebMethodError: Server communication failure detected, turning on the TransientServerCommunicationFailures business bar");var oa=(null===(Ua=ab.context)||void 0===Ua?0:Ua.stopwatch)?ab.context.stopwatch.Gc:-1;5E3>oa?e.ULS.sendTraceTag(537170208,0,50,"OnWebMethodError:  communication errors duration is below the min time for notification, skipping raise of business bar (duration = {0}ms).",oa):l.AFrameworkApplication.eud()||qa.rHg($b,
ab.context.methodName)}oa=[].concat(Jl(a.Aec()));for(var Ma=0,Za=bb.length;Ma<Za;++Ma){var gb=bb[Ma];qa.lg(gb,$b);Array.remove(oa,gb)}$b=0;for(Ma=oa.length;$b<Ma;++$b)qa.removeEntry(oa[$b])}};qa.YFb=function(Fa,ab){Fa=0;for(var Ua=ab.errors.length;Fa<Ua;++Fa){var bb=ab.errors[Fa];l.AFrameworkApplication.eud()||(I.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&e.ULS.sendTraceTag(537170207,0,15,"BusinessBar.OnNetworkDownEvent: adding NetworkDown BB"),qa.lg(54,bb))}};qa.fd=
function(Fa,ab){qa.rd(Fa,ab)};qa.rd=function(){var Fa=qa.$.ea;Fa.sc||Fa.Vg()||(qa.zLd(),Array.clear(qa.nKc))};qa.vd=function(Fa,ab){qa.$.ea.Vg()&&!ab.kS||qa.wdf(ab.kS)};qa.FGb=function(){var Fa=qa.$.userOperationManager.mec();Fa&&Fa.operation.flags&1&&qa.N7f()};qa.zCf=function(){qa.N7f()};qa.Tf=function(){qa.GBe();qa.W7f()};qa.DO=function(){if(qa.$.k6&&qa.$.ea.Vg()&&qa.$.ea.sc)if(qa.$.ea.isEditMode)qa.removeEntry(43),qa.removeEntry(12),qa.removeEntry(29),qa.removeEntry(30),qa.removeEntry(31),qa.removeEntry(32),
qa.removeEntry(22),qa.removeEntry(55);else{var Fa=qa.$.da.Aa(331);Fa&&Fa.rKa||qa.removeEntry(53);qa.removeEntry(5)}};qa.$=da;qa.w_a=ha;qa.SPg();l.AFrameworkApplication.Ld&&l.AFrameworkApplication.Ld.cXc(qa);qa.zob=Array(66);for(var Aa=0;66>Aa;Aa++)qa.zob[Aa]=null;qa.wh=Z.EcmaDateClock.instance;qa.jnf=qa.wh.Ob.getTime();ha&&(ha=da.na,Aa=ha.tf,ha.mz(qa.Xn),ha.Hq(qa.Vh),ha.Zob(qa.Ioc),ha.$Za(qa.Ioc),I.EwaSettings.isChangeGateEnabled("OfficeVSO:5618594_OfflineModeUXEnabled")||(Aa.SJg(qa.YFb),Aa.jpb(qa.Lza)),
da.ea.ek(qa.fd),da.ea.Yt(qa.Tf),da.fl(qa.vd),da.Gl(qa.rd),da.ea.A$(qa.DO),da.userOperationManager.Xu(qa.FGb),I.EwaSettings.ma(170)&&da.ea.ah.get(45)&&l.AFrameworkApplication.ha.ra("SupportsPolicies")||qa.p$e(),qa.wdf(aa.c(da)));da.da.Ha(5,qa);return qa}function c(da,ha,qa){qa=void 0===qa?null:qa;var Aa=v.call(this)||this;Aa.GHa=da;Aa.C9c=ha;Aa.data=qa;return Aa}z=b(0);var e=b(13),l=b(4),m=b(89),n=b(23),h=b(125),u=b(36),w=b(75),r;(function(da){da[da.unableToRefreshLock=0]="unableToRefreshLock";da[da.unableToRefreshLockExpected=
1]="unableToRefreshLockExpected";da[da.workbookAlmostTooLarge=2]="workbookAlmostTooLarge";da[da.workbookTooLarge=3]="workbookTooLarge";da[da.externalWorkbookLinksDisabled=4]="externalWorkbookLinksDisabled";da[da.externalWorkbookLinksShowError=5]="externalWorkbookLinksShowError";da[da.editAndRefreshDisabledOnBIAHostedFiles=6]="editAndRefreshDisabledOnBIAHostedFiles";da[da.unsupportedFeatures=7]="unsupportedFeatures";da[da.collabDataAndDataStringsLocaleMismatch=8]="collabDataAndDataStringsLocaleMismatch";
da[da.collabDataStringsLocaleMismatch=9]="collabDataStringsLocaleMismatch";da[da.collabDataLocaleMismatch=10]="collabDataLocaleMismatch";da[da.lastGenericStatusError=11]="lastGenericStatusError";da[da.scratchPadWarning=12]="scratchPadWarning";da[da.authenticationLost=13]="authenticationLost";da[da.odfCompatibilityIssues=14]="odfCompatibilityIssues";da[da.pivotChartInteractivityMissingWarning=15]="pivotChartInteractivityMissingWarning";da[da.workbookIsIrmProtected=16]="workbookIsIrmProtected";da[da.biFeatureNotAvailable=
17]="biFeatureNotAvailable";da[da.anonymousCreateSaveWarning=18]="anonymousCreateSaveWarning";da[da.unsupportedInteractiveReportEditing=19]="unsupportedInteractiveReportEditing";da[da.mobileAppCampaignBizBar=20]="mobileAppCampaignBizBar";da[da.transientServerCommunicationFailures=21]="transientServerCommunicationFailures";da[da.editAttemptInReadOnly=22]="editAttemptInReadOnly";da[da.editAttemptInReadOnlyNoEditPermissions=23]="editAttemptInReadOnlyNoEditPermissions";da[da.unsupportedBrowser=24]="unsupportedBrowser";
da[da.readOnlyPermissions=25]="readOnlyPermissions";da[da.documentIsIrmProtectedWarning=26]="documentIsIrmProtectedWarning";da[da.policyWarningMessage=27]="policyWarningMessage";da[da.workingOnIt=28]="workingOnIt";da[da.passwordProtectedWorkbookLockedForEdit=29]="passwordProtectedWorkbookLockedForEdit";da[da.workbookIsReadOnlyRecommended=30]="workbookIsReadOnlyRecommended";da[da.workbookHasPasswordToModify=31]="workbookHasPasswordToModify";da[da.legacySharedWorkbookEditWarningBB=32]="legacySharedWorkbookEditWarningBB";
da[da.legacyConnectionsBB=33]="legacyConnectionsBB";da[da.groupedSlicersBB=34]="groupedSlicersBB";da[da.thirdPartyAddinDisabled=35]="thirdPartyAddinDisabled";da[da.financeLinkedEntityDisclaimerBar=36]="financeLinkedEntityDisclaimerBar";da[da.wacGdprNotice=37]="wacGdprNotice";da[da.automaticSensitivityLabel=38]="automaticSensitivityLabel";da[da.recommendedSensitivityLabel=39]="recommendedSensitivityLabel";da[da.mandatorySensitivityLabel=40]="mandatorySensitivityLabel";da[da.localStorageDisabled=41]=
"localStorageDisabled";da[da.autoRefreshDisabled=42]="autoRefreshDisabled";da[da.corruptedFileRepaired=43]="corruptedFileRepaired";da[da.corruptedOdsFileRepaired=44]="corruptedOdsFileRepaired";da[da.minorVersionLimitReached=45]="minorVersionLimitReached";da[da.sensitivityApplicationGenericError=46]="sensitivityApplicationGenericError";da[da.sensitivityApplicationTooLargeFileError=47]="sensitivityApplicationTooLargeFileError";da[da.sensitivityApplicationLabelNotSupportedError=48]="sensitivityApplicationLabelNotSupportedError";
da[da.sensitivityApplicationLabelDisabledError=49]="sensitivityApplicationLabelDisabledError";da[da.sensitivityApplicationMandatoryConflictError=50]="sensitivityApplicationMandatoryConflictError";da[da.sensitivityApplicationMinorVersionLimitReachedError=51]="sensitivityApplicationMinorVersionLimitReachedError";da[da.sensitivityApplicationSetLabelError=52]="sensitivityApplicationSetLabelError";da[da.promptEnableExternalLinks=53]="promptEnableExternalLinks";da[da.networkDown=54]="networkDown";da[da.defaultToViewDueToCogs=
55]="defaultToViewDueToCogs";da[da.refreshLinkedEntityErrorBar=56]="refreshLinkedEntityErrorBar";da[da.promptEnableLinkedEntitiesUntrustedImages=57]="promptEnableLinkedEntitiesUntrustedImages";da[da.canvasHealth=58]="canvasHealth";da[da.novModeDepreciation=59]="novModeDepreciation";da[da.mismatchedFileFormatConverted=60]="mismatchedFileFormatConverted";da[da.optimizeWorkbook=61]="optimizeWorkbook";da[da.novModePostDepreciation=62]="novModePostDepreciation";da[da.officeScriptsRunning=63]="officeScriptsRunning";
da[da.powerQueryRefreshDataSourceNotSupported=64]="powerQueryRefreshDataSourceNotSupported";da[da.readOnlyPivotTable=65]="readOnlyPivotTable";da[da.count=66]="count"})(r||(r={}));Object(z.b)("EwaBusinessBarEntryType",r);var B=b(5),y=b(1243),v=Sys.EventArgs;Am(c,v);Object(z.a)(c,"BusinessBarEntryDisplayChangedEventArgs",Sys.EventArgs,[]);var A=b(1245),t=b(1244),E=b(1247),C=b(1246),H=b(1241),U=b(520),Q=b(51),O=b(241),ea=b(35),Z=b(741),S=b(29),I=b(1),P=b(8),J=b(20),aa=b(56),ia=b(65),ba=b(1049),ra=b(185);
b.d(F,"a",function(){return a});var ka=w.a;Am(a,ka);a.prototype.p$e=function(){S.a.Ar(this.$.ea.oG)&&this.Xn(this,new U.a(this.$.ea.oG,null,!1,-1,-1,-1,-1,"",-1,"",-1))};a.prototype.VHg=function(da){this.Oa.addHandler("bBarAttachedOrDetached",da)};a.prototype.dispose=function(){if(this.$){var da=this.$,ha=da.na,qa=ha.tf;ha.fA(this.Xn);ha.Rr(this.Vh);ha.Kuc(this.Ioc);ha.fJb(this.Ioc);qa.sJb(this.Lza);qa.uhj(this.YFb);da.ea.tk(this.fd);da.ea.jx(this.Tf);da.Bl(this.vd);da.En(this.rd);da.ea.N7(this.DO);
da.userOperationManager.dr(this.FGb);J.g(da).zc.$k(this.zCf)}m.a.Fa(this.YU);this.$=this.YU=null;ka.prototype.dispose.call(this)};a.prototype.Hki=function(da){switch(da){case 4:case 5:case 11:case 53:case 7:case 36:return!0;case 57:return I.EwaSettings.ma(672);default:return!1}};a.prototype.lg=function(da,ha,qa,Aa,Fa){qa=void 0===qa?null:qa;Aa=void 0===Aa?null:Aa;Fa=void 0===Fa?null:Fa;if(!this.$.isMobileMode||this.Hki(da))this.w_a&&!this.HC(da)&&(I.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&
e.ULS.sendTraceTag(537170254,0,50,"Adding entry to BB: {0}",Enum.toString(r,da)),this.zob[da]=this.wh.vfa,this.YU.OE(da,ha,Aa,Fa),this.Oa.raiseEvent("bBarAttachedOrDetached",new c(da,!0,qa))),ha&&32===ha.Appearance&&ia.a(this.$).ud.wma(ha)};a.prototype.zFj=function(da,ha,qa,Aa){e.ULS.sendTraceTag(537170253,0,50,"BusinessBar.ShowGdprPrivacyNotice: Called");H.a.initialize(da,ha,qa,Aa);this.lg(37,null)};a.prototype.AEj=function(da,ha,qa,Aa){y.a.initialize(da,ha,qa,Aa);this.lg(38,null)};a.prototype.MGj=
function(da,ha,qa,Aa){t.a.initialize(da,ha,qa,Aa);this.lg(39,null)};a.prototype.aGj=function(da,ha,qa,Aa){A.a.initialize(da,ha,qa,Aa);this.lg(40,null)};a.prototype.XGj=function(da,ha,qa,Aa){C.a.initialize(da,ha,qa,Aa);this.lg(51,null)};a.prototype.WGj=function(da,ha,qa,Aa){E.a.initialize(da,ha,qa,Aa);this.lg(52,null)};a.prototype.removeEntry=function(da){this.w_a&&(I.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&e.ULS.sendTraceTag(537170251,0,50,"Removing entry from BB: {0}",
Enum.toString(r,da)),this.zob[da]=null,this.YU.removeEntry(da)&&this.Oa.raiseEvent("bBarAttachedOrDetached",new c(da,!1)))};a.prototype.wNa=function(da){return this.w_a?this.YU.wNa(da):!1};a.prototype.HC=function(da){return this.w_a?this.YU.HC(da):!1};a.prototype.yEb=function(){e.ULS.sendTraceTag(537170248,0,50,"Network disconnect notification received from the app")};a.prototype.Tnc=function(){e.ULS.sendTraceTag(537170247,0,50,"Network resumed notification received from the app, turning off the TransientServerCommunicationFailures business bar");
this.removeEntry(21)};a.prototype.SPg=function(){var da=b(1296).BusinessBarControl;if(this.w_a&&!this.YU){J.g(this.$).zc.wl(this.zCf);var ha=document.getElementById(this.$.Lb+B.a.Rye);this.YU=new da(this.$,ha)}};a.prototype.zLd=function(){this.w_a&&this.YU.zLd()};a.prototype.UVf=function(da){if(I.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")){var ha=this.wh.vfa;if(3E5<=ha-this.jnf){this.jnf=ha;for(var qa=0;66>qa;qa++){var Aa=this.zob[qa];Aa&&(Aa=ha-Aa,3E5<=Aa&&e.ULS.sendTraceTag(537170241,
0,50,"{0}: entry [{1}] was activated but not turned off for {2} Millis",da,Enum.toString(r,qa),Aa))}}}};a.prototype.fGh=function(da){for(var ha=[],qa=Cl(da),Aa=qa.next();!Aa.done;Aa=qa.next())switch(Aa.value.MessageId){case -113742550:Aa=[757111532,2113407564,1393475740,1911608588,104919273,-689453604,157762400,-949523941],(this.$.ea.isNamedObjectViewMode||S.a.uh(da,Aa))&&Array.add(ha,-113742550)}return S.a.uG(da,ha)};a.prototype.G9h=function(da,ha){switch(da.MessageId){case 2113407564:for(var qa=
S.a.w0a([1821390342,-943219229,-502303485,1437034227]),Aa=0;Aa<qa.length;Aa++)qa[Aa].HelpTopicId=da.HelpTopicId,qa[Aa].HelpDescription=da.HelpDescription,Array.add(this.nKc,qa[Aa])}switch(da.MessageId){case -395951567:this.lg(6,da);break;case 1643490758:this.lg(4,da);break;case -907264831:this.lg(5,da);break;case 757111532:case 2113407564:this.lg(7,da);break;case 2010656511:this.lg(15,da);break;case 1321660996:this.$.e8c=!0;this.lg(8,da);break;case 526339737:this.$.e8c=!0;this.lg(9,da);break;case -407088521:this.lg(10,
da);break;case 1756116017:this.lg(14,da);break;case -1703455218:this.lg(17,da);break;case 1393475740:this.lg(25,da);break;case -949523941:this.lg(26,da);break;case 1779381952:this.lg(42,da);break;case 1421575100:this.lg(43,da);break;case 613676060:this.lg(44,da);break;case 1233668252:this.lg(60,da);break;case 1911608588:da=!!(this.$.Dd&64);!this.$.ea.Vg()&&da&&Array.add(ha,29);break;case 1544494907:break;case -655555355:Array.add(ha,this.tud()?1:0);break;case -1221382671:Array.add(ha,2);break;case 1662282929:Array.add(ha,
3);break;case 104919273:this.$.ea.Vg()||Array.add(ha,30);break;case -689453604:da=!!(this.$.Dd&64);this.$.ea.Baf=!0;!this.$.ea.Vg()&&da&&Array.add(ha,31);break;case 157762400:this.$.ea.Ric=!0;!this.$.ea.Vg()&&this.$.Dd&64&&!this.$.isEditMode&&Array.add(ha,32);break;case -73730134:I.EwaSettings.isChangeGateEnabled("OfficeVSO:6079602_EnableEditingOfFilesWithLegacyConnections")&&!this.$.ea.Vg()&&this.$.Dd&64&&Array.add(ha,33);break;case -293349236:Array.add(ha,64);break;case -37299333:break;case 136737622:Array.add(ha,
45);break;case -1780327030:this.lg(53,da);break;case -113742550:this.lg(55,da);break;case -260312420:this.$.ea.Vg()||Array.add(ha,65);break;default:this.lg(11,da)}return ha};a.prototype.Kei=function(){var da=this;if(l.AFrameworkApplication.ha.ra("WildFireExcelBizBar")&&!ba.a.osd(ba.a.ngd(1))&&(n.a.xp||n.a.dh)){var ha=Q.GetServiceTaskFactory.create(this.$.da,155,this.$.la,1);ea.TaskExtensions.Ba(ha,function(){da.lg(20,null)},this.la,3)}};a.prototype.Hei=function(){var da=I.EwaSettings.ma(74),ha=I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IE11SoftBlockConsumerIsEnabled",
!1),qa=I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IE11SoftBlockStringIsEnabled",!1);P.HelperMethods.uUd(qa||ha,da)&&(ra.a("NewBrowserSuggestionShown"),qa||h.a.Mv("NewBrowserSuggestionShown","true",7),this.lg(24,null))};a.prototype.dei=function(da){!da&&O.g(this.$)&&this.lg(59,null)};a.prototype.eei=function(da){!da&&O.h(this.$)&&this.lg(62,null)};a.prototype.wdf=function(da){(!da&&!this.$.printingEnabled||this.$.dg.get(1))&&this.$.workbookContext.FullDocumentInfo.IrmPolicyDescription&&
(e.ULS.sendTraceTag(537170205,0,50,"BusinessBar.InitBusinessBar: Adding bisinessBar for irm protection."),this.lg(16,null));this.Kei();this.Hei();this.GBe();this.W7f();this.dei(da);this.eei(da)};a.prototype.GBe=function(){this.$.workbookContext.Options&32768&&this.oFj()};a.prototype.oFj=function(){this.zob[36]||this.lg(36,null)};a.prototype.W7f=function(){I.EwaSettings.ma(672)&&this.$.workbookContext.Options&524288&&this.lg(57,null)};a.prototype.t8f=function(da,ha){this.lg(56,da,null,ha)};a.prototype.Qpe=
function(da,ha){var qa=null,Aa=null;qa=void 0===qa?null:qa;Aa=void 0===Aa?null:Aa;ha=void 0===ha?null:ha;this.YU.HC(da)?this.YU.CPb(da,ha):this.lg(da,null,qa,Aa,ha)};a.prototype.N7f=function(){this.$.Dd&8&&this.lg(12,null)};a.prototype.tud=function(){var da=this.$.da.Aa(38);return da?da.tokenExpired:!1};a.prototype.rHg=function(da,ha){if(!this.HC(21)&&-1387426400!==da.MessageId){e.ULS.sendTraceTag(537170204,0,50,"BusinessBar: raising the transient communication failures notification.");var qa={};
qa.FailedMethod=ha;this.lg(21,da,qa)}};a.Aec=function(){return a.hte||(a.hte=[0,1,2,3])};uk.Object.defineProperties(a.prototype,{I$c:{configurable:!0,enumerable:!0,get:function(){return this.nKc}},domElement:{configurable:!0,enumerable:!0,get:function(){return this.YU?this.YU.domElement:null}}});a.hte=null;Object(z.a)(a,"BusinessBarManager",w.a,[699,3,73])},1337:function(z,F,b){function a(B,y,v,A,t,E){this.OQc=null;this._id=B;this.uRc=y;this.stg=void 0===t?null:t;this.Mkb=A;this.anb=void 0===E?null:
E;this.vqa=null;this.uZa=v;this.Bnb=c.instance.j3h(y,B)}function c(){this.pHc=new h.a;this.nHc=new h.a;this.mHc=new h.a;this.STg(this.pHc);this.RTg(this.nHc);this.QTg(this.mHc);this.xMc=new h.a;this.wMc=new h.a;this.vMc=new h.a;this.pWg(this.xMc);this.oWg(this.wMc);this.nWg(this.vMc);this.GIc=new h.a;this.kUg(this.GIc);this.BGa(this.GIc);this.BGa(this.mHc);this.BGa(this.nHc);this.BGa(this.pHc);this.BGa(this.wMc);this.BGa(this.xMc);this.BGa(this.vMc)}z=b(0);var e=b(13),l=b(82),m=b(1063),n=b(1049),
h=b(1317);c.prototype.j3h=function(B,y){switch(B){case 1:return this.w6h(y);case 2:return this.tOh(y)}return n.a.Gzc?this.GIc:null};c.prototype.STg=function(B){B.add("Headline",CommonUIStrings.l_WildFireWordBizBarHeadline);B.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);B.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarAndroidCallToAction)};c.prototype.RTg=function(B){B.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);B.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);
B.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarAndroidCallToAction)};c.prototype.QTg=function(B){B.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);B.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);B.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarAndroidCallToAction)};c.prototype.pWg=function(B){B.add("Headline",CommonUIStrings.l_WildFireWordBizBarHeadline);B.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);B.add("InstallButton",
CommonUIStrings.l_WildFireBizBarInstallButtonText);B.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);B.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarIPadCallToAction);B.add("OverlayBig","Get the Word app");B.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");B.add("OverlaySmallSplit1","Discover Word");B.add("OverlaySmallSplit2","designed for the iPad.");B.add("SkipButton","Skip for now")};c.prototype.kUg=function(B){B.add("Headline",
"Get the Office Online extension for Chrome");B.add("UseAppButton","Get the extension");B.add("CallToAction","The quickest way to view, edit, and share Office files in Chrome.")};c.prototype.oWg=function(B){B.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);B.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);B.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);B.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);B.add("CallToAction",
CommonUIStrings.l_WildFirePPTBizBarIPadCallToAction);B.add("OverlayBig","Get the PowerPoint app");B.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");B.add("OverlaySmallSplit1","Discover PowerPoint");B.add("OverlaySmallSplit2","designed for the iPad.");B.add("SkipButton","Skip for now")};c.prototype.nWg=function(B){B.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);B.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);B.add("InstallButton",
CommonUIStrings.l_WildFireBizBarInstallButtonText);B.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);B.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarIPadCallToAction)};c.prototype.BGa=function(B){B.add("Corporation","Microsoft Corporation")};c.prototype.w6h=function(B){switch(B){case 3:return this.xMc;case 2:return this.wMc;case 1:return this.vMc}return null};c.prototype.tOh=function(B){switch(B){case 3:return this.pHc;case 2:return this.nHc;case 1:return this.mHc}return null};
uk.Object.defineProperties(c,{instance:{configurable:!0,enumerable:!0,get:function(){c.Na||(c.Na=new c);return c.Na}}});c.Na=null;Object(z.a)(c,"WildFireStringFactory",null,[]);var u=b(4),w=b(37),r=b(23);b.d(F,"a",function(){return a});a.prototype.Z5c=function(){this.vqa=new m.a(this.title,this.message,null);this.vqa.addButton(this.Zye,Object(l.a)(this,this.Ryf,"onButtonOneClick"),"");this.uZa&&this.vqa.DGg(this.aze,Object(l.a)(this,this.Uyf,"onButtonTwoClick"));this.vqa.maa=Object(l.a)(this,this.fMe,
"dismissBar");this.vqa.image=3;this.vqa.id=16;this.vqa.closeable=!0};a.prototype.Ryf=function(){this.uZa?this.Ohi():this.JZj()};a.prototype.Uyf=function(){this.uZa&&this.k_i()};a.prototype.Ohi=function(){e.ULS.sendTraceTag(17932829,306,50,"Install App Button of BusinessBar Clicked");this.Mkb&&this.anb&&this.anb();n.a.vRf(this._id,this.uRc)};a.prototype.k_i=function(){this.openUrl&&(e.ULS.sendTraceTag(17932830,306,50,"Open App Button of BusinessBar Clicked"),this.Mkb&&this.anb&&this.anb(),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(n.a.gue(this._id),
this.openUrl,0,!1))};a.prototype.JZj=function(){n.a.Gzc?this.xWg():(e.ULS.sendTraceTag(17109255,306,50,"AppBusinessBarNav"),n.a.ESd("BizBarClicked"),1!==this.uRc&&2!==this.uRc||n.a.a2g(this.openUrl,this.Mkb,this._id,this.anb))};a.prototype.xWg=function(){this.Mkb?e.ULS.sendTraceTag(17571974,323,50,"ChromeExtBannerClicked"):e.ULS.sendTraceTag(17571975,301,50,"ChromeExtBannerClicked");w.a.XV(u.AFrameworkApplication.ha.appSettings.WildFireChromeExtensionUrl.toString())};a.prototype.Vjh=function(){this.Mkb?
e.ULS.sendTraceTag(17571976,323,50,"ChromeExtBannerDismissed"):e.ULS.sendTraceTag(17571977,301,50,"ChromeExtBannerDismissed");n.a.ESd(n.a.gCe)};a.prototype.fMe=function(){n.a.Gzc?this.Vjh():(n.a.ESd(n.a.ngd(this._id)),e.ULS.sendTraceTag(17109256,306,50,"AppBusinessBarDismissed"))};a.G6b=function(){var B=u.AFrameworkApplication.sa.Qa,y=new a(B.Yj,n.a.yec(),8<r.a.K6a,1===B.dda,function(){return B.Tx},B.rZf());e.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed");return y};uk.Object.defineProperties(a.prototype,
{title:{configurable:!0,enumerable:!0,get:function(){return this.Bnb.pa("Headline")}},message:{configurable:!0,enumerable:!0,get:function(){return this.Bnb.pa("CallToAction")}},SZj:{configurable:!0,enumerable:!0,get:function(){return this.uZa}},Zye:{configurable:!0,enumerable:!0,get:function(){return this.uZa?this.Bnb.pa("InstallButton"):this.Bnb.pa("UseAppButton")}},aze:{configurable:!0,enumerable:!0,get:function(){return this.uZa?this.Bnb.pa("OpenAppButton"):""}},tWg:{configurable:!0,enumerable:!0,
get:function(){return this.vqa}},openUrl:{configurable:!0,enumerable:!0,get:function(){this.OQc||(this.OQc=this.stg());return this.OQc}}});Object(z.a)(a,"WildFireBusinessBar",null,[])},1385:function(z,F,b){function a(n,h,u,w,r,B){var y=m.call(this,n,h,u,w,r,B)||this;n={};h=(n.errorMessage=y.XPe,n.offerString=y.oxf,n);n=new l.a(!1,!1,!0);y.O7f?(n.lc=1,u={},h.helpLink=(u.type="AppLinkProps",u.id="helpLink",u.text=y.gxa,u.onExecute=function(){e.Redirect.showHelp(y.hbf)},u)):(n.lc=4,n.Bc(2,y.wcf));n.Bc(1,
y.BZb);n.Ve=y.id;u={};h=(u.id=y.id,u.dialogIcon=y.icon,u.bodyControls=h,u);n.initializeAndShow(y.uo,Object(c.a)(y,y.F$i,"reactOICErrorDialogWithTrialHandler"),h);return y}b.r(F);b.d(F,"ReactOICErrorDialogWithTrial",function(){return a});z=b(0);var c=b(82);F=b(1248);var e=b(439),l=b(149),m=F.a;Am(a,m);Object(z.a)(a,"ReactOICErrorDialogWithTrial",F.a,[])},1386:function(z,F,b){function a(m,n,h,u,w,r){m=l.call(this,m,n,h,u,w,r)||this;n=document.createElement("span");n.innerText=m.XPe;n.appendChild(document.createElement("br"));
n.appendChild(document.createElement("br"));h=document.createElement("span");h.innerText=m.oxf;n.appendChild(h);h=new e.StandardDialog;m.O7f?(h.lc=1,h.Cpe(m.gxa,m.hbf)):(h.lc=4,h.Bc(2,m.wcf));h.Bc(1,m.BZb);h.Ve=m.id;h.Fk(m.uo,null,m.icon,Object(c.a)(m,m.Xwi,"legacyOICErrorDialogWithTrialHandler"),n);return m}b.r(F);b.d(F,"OICErrorDialogWithTrial",function(){return a});z=b(0);var c=b(82);F=b(1248);var e=b(133),l=F.a;Am(a,l);Object(z.a)(a,"OICErrorDialogWithTrial",F.a,[])},1387:function(z,F,b){function a(){return c.call(this)||
this}b.r(F);b.d(F,"CheckRoamingRightsRequest",function(){return a});z=b(0);b=b(1250);var c=b.a;Am(a,c);a.prototype.C5a=function(){return 2};a.prototype.nka=function(){return 1};Object(z.a)(a,"CheckRoamingRightsRequest",b.a,[])},1388:function(z,F,b){function a(){return c.call(this)||this}b.r(F);b.d(F,"GetRoamingLauncherRequest",function(){return a});z=b(0);b=b(1250);var c=b.a;Am(a,c);a.prototype.C5a=function(){return 0};a.prototype.nka=function(){return 2};Object(z.a)(a,"GetRoamingLauncherRequest",
b.a,[])},1405:function(z,F,b){function a(u){this.EIc=!1;this.LYa=a.Ugc;this.xSc=this.BQc=0;this.platform=null;this.ezg=u;this.Sme=this.ySc=!1}function c(){this.state=this.callback=null;this.Drd=!1}function e(){this.classId=0}z=b(0);var l=b(82),m=b(40);e.oJa=function(u){try{return m.a(u)}catch(w){}return null};Object(z.a)(e,"ARoamingAppsResponse",null,[]);Object(z.a)(c,"GetRoamingAppsLauncherContext",null,[]);var n=b(4),h=b(107);b.d(F,"a",function(){return a});a.prototype.x0g=function(){n.AFrameworkApplication.jjc&&
this.roamingAppsAreEnabled&&!this.ySc&&!this.EIc&&(this.xSc=1,this.EIc=!0,this.Mlj(),this.nVe())};a.prototype.Mlj=function(){this.LYa=a.Ugc;this.BQc=0};a.prototype.getRoamingAppsLauncher=function(u,w,r){this.b_j?(u=new c,u.callback=w,u.state=r,u.Drd=!0,this.sVe(u)):w(!1,"",r)};a.prototype.nVe=function(){var u=new (b(1387).CheckRoamingRightsRequest);u.RoamingApp=this.xSc;u.BaseDocQuerySignature=n.AFrameworkApplication.uj;u.execute(Object(l.a)(this,this.z0g,"checkUserRoamingRightsSucceeded"),Object(l.a)(this,
this.y0g,"checkUserRoamingRightsFailed"),null)};a.prototype.z0g=function(u){n.AFrameworkApplication.Pg||((u=e.oJa(u.data.oe))?this.GSd(u.HasRights):this.GSd(!1))};a.prototype.y0g=function(){if(!n.AFrameworkApplication.Pg)if(this.BQc>=a.iEi)this.GSd(!1);else{var u=new h.a(2,1,this.LYa,Object(l.a)(this,this.retryCheckUserRoamingRights,"retryCheckUserRoamingRights"),59);n.AFrameworkApplication.Yi.$g(u);this.BQc++;this.LYa*=a.enj;this.LYa>a.Btf&&(this.LYa=a.Btf)}};a.prototype.GSd=function(u){this.Sme=
u;this.ySc=!0;this.EIc=!1};a.prototype.retryCheckUserRoamingRights=function(){this.nVe()};a.prototype.sVe=function(u){var w=new (b(1388).GetRoamingLauncherRequest);w.RoamingApp=this.xSc;w.BaseDocQuerySignature=n.AFrameworkApplication.uj;w.execute(Object(l.a)(this,this.r1h,"getRoamingAppsLauncherSucceeded"),Object(l.a)(this,this.q1h,"getRoamingAppsLauncherFailed"),u)};a.prototype.r1h=function(u){if(!n.AFrameworkApplication.Pg){var w=e.oJa(u.data.oe);u=u.data.state;w?(this.platform=w.Platform,u.callback(!0,
w.Launcher,u.state)):u.callback(!1,"",u.state)}};a.prototype.q1h=function(u){if(!n.AFrameworkApplication.Pg){var w=u.data.state;5===u.data.status&&w.Drd?(w.Drd=!1,this.sVe(w)):w.callback(!1,"",w.state)}};uk.Object.defineProperties(a.prototype,{roamingAppsAreEnabled:{configurable:!0,enumerable:!0,get:function(){return this.ezg}},b_j:{configurable:!0,enumerable:!0,get:function(){return this.roamingAppsAreEnabled&&this.ySc?this.Sme:!1}}});uk.Object.defineProperties(a,{instance:{configurable:!0,enumerable:!0,
get:function(){return a.sC||(a.sC=new a(n.AFrameworkApplication.kPg))}}});a.Ugc=1E3;a.enj=5;a.Btf=12E5;a.iEi=5;a.sC=null;Object(z.a)(a,"RoamingAppsManager",null,[])},1440:function(z,F,b){function a(K){return ok.call(this,K)||this}function c(K,na,Xa){var Qb=this;this.ignorePrintArea=!1;this.yRj=function(){var tc=Og.g(Qb.$).Da;Qb.wTc=!0;tc.CBd()};this.YUi=function(){Qb.Sld()};this.XUi=function(tc,md,Dd){ud.ULS.sendTraceTag(537154272,0,10,"PrintCommandHandler:OnPageLayoutCommandFailure Method : {0} failed to execute",
Dd);Qb.Sld()};this.$=K;this.ea=K.ea;this.pja=na;this.OO=new I(1,this.ignorePrintArea);this.PD=na=new e(K,na,be.AFrameworkApplication.Ld,Xa);this.$.da.Ha(418,na);this.$Mf=new E(K);this.$.da.Ha(384,this);this.wTc=!1}function e(K,na,Xa,Qb){var tc=this;this.activeCell=this.selectedRange=this.zg=this.graphServiceEndpoint=null;this.M0=0;this.Sm=this.Ev=null;this.eI=new t;this.Ck=new t;this.Gca=0;this.g9a=null;this.aOb=!1;this.y4a=this.ZGb=null;this.dtd=!1;this.e8a=this.pBb=this.njc=!0;this.wna=this.dAa=
this.xOa=null;this.rAb=!1;this.d9a=null;this.A7a=this.PNc=!1;this.sDd=function(md){if(!(md&&md.data&&md.data.oe&&md.data.responseHeaders&&md.data.oe.length)){var Dd=md?md.data?md.data.oe?md.data.responseHeaders?md.data.oe.length?null:"requestSucceededEventArgs.Data.ResponseData.Length":"requestSucceededEventArgs.Data.ResponseHeaders":"requestSucceededEventArgs.Data.ResponseData":"requestSucceededEventArgs.Data":"requestSucceededEventArgs";tc.zg&&(md=tc.jBa(Tc.a.instance.fa(1168)),tc.Xoa(md,0));ud.ULS.sendTraceTag(593266765,
0,10,"PrintPreviewManager:OnFileHandlerSuccessCallback - Invalid Parameter : {0}",Dd);tc.ANd&&(md=Object.assign(new oj.a,{extendedProperties:new Map}),md.extendedProperties.set("InvalidParameterName",Dd),Pg.Health.instance.recordQosError(qh.a.bNf,[Ic.a.cNf],!1,!0,!0,!1,md))}else if(0<tc.Gca&&md.data.id===tc.Gca){if(md.data.responseHeaders["Content-Type"]&&(ta.a.contains(md.data.responseHeaders["Content-Type"].toString(),"application/pdf",!0)||ta.a.contains(md.data.responseHeaders["Content-Type"].toString(),
"text/plain",!0))){ud.ULS.sendTraceTag(593266764,0,50,"PrintPreviewManager:OnFileHandlerSuccessCallback - pdf converted successfully");var ue=null;ta.a.contains(md.data.responseHeaders["Content-Type"].toString(),"text/plain",!0)&&(ue=tc.f9g(md));Dd={};tc.qFb(Dd,null,null,ue);md.data.responseHeaders["Total-Pdf-PageCount"]?(ue=parseInt(md.data.responseHeaders["Total-Pdf-PageCount"].toString(),10),tc.rAb||(tc.wId>=ue?tc.wna=ue:tc.rAb=!0),tc.e8a&&tc.zg&&tc.zg.setPageRangeSettings(ue,tc.wId,tc.rAb,tc.dAa,
tc.wna)):ud.ULS.sendTraceTag(537154257,0,15,"PrintPreviewManager:OnFileHandlerSuccessCallback - did not receive the TotalPdfPageCount header.")}else Dd=kk.a.ui(md.data.oe),Mg.a.Q$(Dd.Errors)||Xd.a(tc.$).ud.ME(Dd.Errors[0].MessageId),tc.hbj(Dd.Errors),tc.zg&&(ue=tc.jBa(Dd.Errors[0].Description),-1831476778===Dd.Errors[0].MessageId?(ud.ULS.sendTraceTag(537154256,0,15,"PrintPreviewManager:OnFileHandlerSuccessCallback - showing pdf print timeout error message"),tc.Xoa(ue,0,Tc.a.instance.fa(1171))):tc.Xoa(ue,
0)),297284985===Dd.Errors[0].MessageId?ud.ULS.sendTraceTag(570716892,0,50,"PrintPreviewManager:OnFileHandlerSuccessCallback - Nothing to print. Message Id: {0}",Dd.Errors[0].MessageId):ud.ULS.sendTraceTag(593266763,0,15,"PrintPreviewManager:OnFileHandlerSuccessCallback - Failed to convert workbook. Error message Id: {0}",Dd.Errors[0].MessageId);md=md.data.state;md.pbd(Dd,md.userContext,md.methodName)}};this.rDd=function(md){if(0<tc.Gca&&md.data.id===tc.Gca){var Dd=Ui.a.mg(md.data);tc.zg&&tc.Xoa(tc.jBa(Dd[0].Description),
1);ud.ULS.sendTraceTag(593266762,0,15,"PrintPreviewManager:OnFileHandlerFailureCallback has failed - Errors: [{0}]",Mg.a.Wc(Dd));Dd=md.data.state;Dd.fba(md,Dd.userContext,Dd.methodName);tc.$.userOperationManager.hma.operation.FBa(function(){return tc.aOb})}};this.eOi=function(md,Dd,ue){md.Errors&&0<md.Errors.length&&tc.zg?(Mg.a.Q$(md.Errors)||Xd.a(tc.$).ud.ME(md.Errors[0].MessageId),tc.Xoa(tc.jBa(md.Errors[0].Description),0),ud.ULS.sendTraceTag(537154254,0,50,"PrintPreviewManager: Failed to convert workbook. Error message Id: {0}",
md.Errors[0].MessageId)):(ud.ULS.sendTraceTag(537154253,0,50,"PrintPreviewManager:OnConvertWorkbookToPdfSucceededInWebParts - Pdf conversion succeeded"),tc.qFb(md,Dd,ue,null))};this.dOi=function(md){md=Ui.a.mg(md.data);tc.zg&&tc.Xoa(tc.jBa(md[0].Description),1);ud.ULS.sendTraceTag(537154252,0,15,"PrintPreviewManager:OnConvertWorkbookToPdfFailed invoked - Errors: [{0}]",Mg.a.Wc(md));tc.$.userOperationManager.hma.operation.FBa(function(){return tc.aOb})};this.wEf=function(md,Dd){if(Dd)switch(Dd.l6i){case 1:if(tc.Ck&&
tc.y4a)switch(md=tc.y4a.Gc,tc.y4a.stop(),tc.y4a=null,tc.Ck.Wv){case 1:tc.E2c(md,4800,"ActiveSheet");break;case 0:tc.E2c(md,6100,"CurrentSelection");break;case 2:tc.E2c(md,7500,"EntireWorkbook")}break;case 0:tc.ZGb&&(md=tc.ZGb.Gc,tc.ZGb.stop(),2400<md&&(Dd=Object.assign(new oj.a,{extendedProperties:new Map}),Dd.extendedProperties.set("PaneLoadTime",md.toString()),Pg.Health.instance.recordQosError(qh.a.EIj,[Ic.a.y9f],!1,!0,!0,!1,Dd)),tc.Ev.$ii(function(ue){tc.CGj(ue)}))}};this.kG=function(md,Dd){(1===
Dd.Au&&tc.xOa===Dd.Mg||2===Dd.Au)&&tc.lOd()};this.$=K;this.pja=na;this.Y3=Xa;this.VBd=Qb;this.ANd=Ug.HelperMethods.S_;this.Oa=new Oj.a;this.wId=this.$.ya.PrintPreviewerPaginationRange;this.useMSPdfViewer=this.jEj();this.Sfi();this.ski=this.U_g();this.ctd=Te.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExcelWebPrintFloodgateSurvey",!1);if(this.isUniversalPrintEnabled=!!Qb&&Qb.Ixa()&&Te.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UniversalPrint",!1)&&this.$.dg.get(116))this.graphServiceEndpoint=
this.$.ya.GraphServiceEndpoint}function l(){this.appName=this.disabledChangeGates=this.isUniversalPrintFlowEnabled=this.graphServiceEndpointVersion=this.graphServiceEndpoint=null}function m(){this.onBackToSheet=null}function n(){this.onNotifyPrintJobStatus=this.onClosePreviewer=this.getGraphServiceAuthorizationToken=this.onLocalPrint=null}function h(){this.selectedColor=this.selectedMargin=this.selectedScaling=this.selectedPaperSize=this.selectedOrientation=this.selectedWhatToPrint=0;this.selectedPrintGridlines=
this.selectedIgnorePrintArea=!1;this.selectedRowAndColumnHeadings=this.selectedVerticalCenter=this.selectedHorizontalCenter=this.selectedDraft=this.selectedPageEnd=this.selectedPageStart=null}function u(){this.onDropdownSettingsFocus=this.onPrint=this.onSettingChange=null}function w(K,na,Xa,Qb,tc,md){var Dd=B.call(this,tc)||this;Dd.Pd=!1;Dd.p9f=!1;Dd.CEd=function(ue){Dd.PD.CEd(ue)};Dd.MEd=function(ue){Dd.PD.MEd(ue)};Dd.CWi=function(){ud.ULS.sendTraceTag(537154190,0,50,"PrintSettingsManager.OnSavePrintSettingsToFileSuccess: Saving print settings to file successful.")};
Dd.BWi=function(ue){ue=Ui.a.mg(ue.data);ud.ULS.sendTraceTag(537154189,0,10,"PrintSettingsManager.OnSavePrintSettingsToFileFailure: Save print settings to file failed. Errors: {0}.",Mg.a.Wc(ue))};Dd.kG=function(ue,Ce){2===Ce.Au?Dd.Dv.clear():1===Ce.Au&&Dd.Dv&&Dd.Dv.contains(Ce.Mg)&&(ud.ULS.sendTraceTag(537154188,0,50,"PrintSettingsManager.OnQueueChanged: web method {0} returned, it took {1} milliseconds to complete.",tj.a(Ce.Mg.operation.operationName),Ce.Mg.dequeueUtcTime.getTime()-Ce.Mg.enqueueUtcTime.getTime()),
Dd.Dv.remove(Ce.Mg))};Dd.PD=K;Dd.OO=Xa;Dd.$=na;Dd.sheetName=Qb;Dd.locale=window.navigator.browserLanguage||window.navigator.language||Dd.$.ya.UICultureTag;Dd.U0i=Dd.g7g();Dd.$.userOperationManager.Xu(Dd.kG);Dd.Dv=new wb.a;Dd.isUniversalPrintEnabled=md;return Dd}function r(K,na){this.sheetPrintOptions=this.sheetName=null;this.sheetName=K;this.sheetPrintOptions=na}function B(K){this.KIi=[.75,.75,.7,.7,.3,.3];this.yHi=[.75,.75,.25,.25,.3,.3];this.I1j=[1,1,1,1,.5,.5];this.xee=this.Gje=this.Tge=this.Cge=
this.rne=this.s7=this.narrow=this.wide=this.normal=null;this.sheetPrintOptions={};this.Xm=K;this.fgi();this.ngi()}function y(){this.printSettingOptionKey=0;this.printSettingOptionText=null}function v(){this.footer=this.header=this.bottom=this.top=this.right=this.left=0}function A(){this.marginValue=this.printSettingOption=null}function t(){this.margin=this.i1=this.rda=this.orientation=this.Wv=0;this.ignorePrintArea=!1;this.sheetPrintOptions=null;this.$2a=!1;this.NoColor=null}function E(K){var na=
this;this.ribbonCommandInfo=this.NGb=null;this.FRj=function(Xa,Qb,tc){Qb=!!Xa&&!!Xa.RequestTelemetryData;Og.g(na.$).Ri&&Og.g(na.$).Ri.xma(na.VLa.pa(na.ribbonCommandInfo.command),Xa.StateId,Qb?Xa.RequestTelemetryData.EcsOperationDuration:0,Qb?Xa.RequestTelemetryData.EcsRequestDuration:0,Qb?Xa.RequestTelemetryData.WfeRequestDuration:0);Ug.HelperMethods.S_&&na.P_g(tc)};this.$=K;this.VLa=new Ij.a;this.Uwa=new Ij.a;this.Uwa.add(78661008,12);this.Uwa.add(275604654,13);this.Uwa.add(-13332329,14);this.Uwa.add(-837651977,
9);this.Uwa.add(-1778266776,10);this.Uwa.add(845325699,11);this.ctd=Te.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExcelWebPrintFloodgateSurvey",!1)}function C(){this.LastColumn=this.LastRow=this.FirstColumn=this.FirstRow=0}function H(){this.Max=this.Min=this.Index=0}function U(){this.Col=this.Row=null}function Q(K){this.sheetName=null;this.sheetName=K}function O(K){this.sheetName=null;this.sheetName=K}function ea(K){this.sharedSheetCell=null;this.sharedSheetCell=K}function Z(K){this.sharedSheetCell=
null;this.sharedSheetCell=K}function S(K,na){this.multiRange=null;this.addToPrintArea=!1;this.multiRange=K;this.addToPrintArea=na}function I(K,na){this.t7=0;this.Bae=!1;this.Wv=K;this.ignorePrintArea=na}function P(K,na,Xa,Qb,tc,md,Dd,ue){var Ce=ka.call(this,K,na,Xa,Qb,tc,Te.EwaSettings.ma(401))||this;Ce.Hda=null;Ce.Xaa=null;Ce.ygc=null;Ce.$Vd=!1;Ce.Bya=null;Ce.nbb=null;Ce.fAa=null;Ce.mBa=null;Ce.R6a=null;Ce.wAa=1;Ce.Jna=1;Ce.L0=0;Ce.t7=1;Ce.UHb=!1;Ce.Ns=null;Ce.KKb=0;Ce.JKb=0;Ce.gAa=null;Ce.nBa=null;
Ce.selectedRange=null;Ce.M0=0;Ce.N$a=function(){Ce.M0++;Ce.t7=Ce.g1c();Ce.P$c(Ce.Xaa.checked?!0:!1);Ce.q8&&(Ce.ygc.disabled=Ce.Aw.checked);Ce.FRd(Ce.Xaa.checked?!0:!1);ud.ULS.sendTraceTag(595194762,0,50,"PdfPrintDialog:OnChangeWhatToPrint What to print option changed to {0}",Ce.t7.toString());return!0};Ce.ezf=function(){Ce.M0++;Ce.UHb=Ce.R6a.checked;ud.ULS.sendTraceTag(537154311,0,50,"PdfPrintDialog:OnChangeIgnorePrintArea Setting Ignore print area changed to {0}",Ce.UHb.toString())};Ce.Qoc=function(){Ce.M0++;
Ce.wAa=Ce.Cze();ud.ULS.sendTraceTag(595079450,0,50,"PdfPrintDialog:OnChangeOrienation orientation option changed to {0}",Ce.wAa.toString());return!0};Ce.fzf=function(){Ce.M0++;var Kf=Ce.Jna;Ce.Jna=P.paperSizeOptions[Ce.fAa.selectedIndex];ud.ULS.sendTraceTag(595079449,0,50,"PdfPrintDialog:OnChangePaperSize paperSize option changed from {0} to {1}",Kf.toString(),Ce.Jna.toString());return!0};Ce.gzf=function(){Ce.M0++;var Kf=Ce.L0;Ce.L0=P.scalingOptions[Ce.mBa.selectedIndex];2===Ce.L0?(Ce.KKb=1,Ce.JKb=
0):3===Ce.L0?(Ce.KKb=0,Ce.JKb=1):1===Ce.L0&&(Ce.KKb=1,Ce.JKb=1);ud.ULS.sendTraceTag(595079448,0,50,"PdfPrintDialog:OnChangeScaling scaling option changed from {0} to {1}",Kf.toString(),Ce.L0.toString());return!0};Ce.sDd=function(Kf){if(Kf&&Kf.data&&Kf.data.oe&&Kf.data.responseHeaders&&Kf.data.oe.length){if(Kf.data.responseHeaders["Content-Type"]&&ta.a.contains(Kf.data.responseHeaders["Content-Type"].toString(),"application/pdf",!0)){ud.ULS.sendTraceTag(51676164,0,50,"PdfPrintDialog:OnFileHandlerSuccessCallback - pdf converted successfully");
var Wg={};Ce.qFb(Wg,null,null)}else Wg=kk.a.ui(Kf.data.oe),ud.ULS.sendTraceTag(51676165,0,15,"PdfPrintDialog:OnFileHandlerSuccessCallback - Failed to convert workbook. Error message Id: {0}",Wg.Errors[0].MessageId);Kf=Kf.data.state;Kf.pbd(Wg,Kf.userContext,Kf.methodName)}else ud.ULS.sendTraceTag(51676163,0,10,"PdfPrintDialog:OnFileHandlerSuccessCallback - Invalid Parameter : {0}",Kf?Kf.data?Kf.data.oe?Kf.data.responseHeaders?Kf.data.oe.length?null:"requestSucceededEventArgs.Data.ResponseData.Length":
"requestSucceededEventArgs.Data.ResponseHeaders":"requestSucceededEventArgs.Data.ResponseData":"requestSucceededEventArgs.Data":"requestSucceededEventArgs")};Ce.rDd=function(Kf){var Wg=Ui.a.mg(Kf.data);ud.ULS.sendTraceTag(51676166,0,15,"PdfPrintDialog:OnFileHandlerFailureCallback has failed - Errors: [{0}]",Mg.a.Wc(Wg));Wg=Kf.data.state;Wg.fba(Kf,Wg.userContext,Wg.methodName)};Ce.qFb=function(Kf){Kf.Errors&&0<Kf.Errors.length?ud.ULS.sendTraceTag(51499295,0,50,"PdfPrintDialog: Failed to convert workbook. Error message Id: {0}",
Kf.Errors[0].MessageId):(6===Ce.Xd.ef&&be.AFrameworkApplication.sa.Ue.mk(Og.g(Ce.$).w_f),ud.ULS.shipAssertTag(537154309,0,!!Ce.$.xa.oa,"PdfPrintDialog.OnConvertWorkbookToPdfSucceeded: EwaControl.Sheets.ActiveItem should not be null"),Ce.$.xa.oa&&Ce.pja.p8f(Ce.JIa()))};Ce.pja=md;Ce.activeCell=Ce.$.oa.activeCell.toString();Ce.Sm.SelectedRanges&&Ce.Sm.SelectedRanges.Ranges&&0<Ce.Sm.SelectedRanges.Ranges.length&&Ce.Sm.SelectedRanges.Ranges[0]&&(Ce.selectedRange=ff.B(Ce.Sm.SelectedRanges.Ranges[0]).toString());
Ce.sheetName=Dd;Ce.OO=ue;Ce.hGd={};K=0;for(na=P.paperSizeOptions.length;K<na;++K)Ce.hGd[P.paperSizeOptions[K].toString()]=K;Ce.locale=window.navigator.browserLanguage||window.navigator.language||Ce.$.ya.UICultureTag;Ce.q8=Te.EwaSettings.isChangeGateEnabled("OfficeVSO:4738349_EnableIgnorePrintAreaSettingInPrintDialog");return Ce}function J(K,na){this.printSettings=this.sheetName=null;this.sheetName=K;this.printSettings=na}function aa(K,na,Xa,Qb,tc){K=ka.call(this,K,na,Xa,Qb,tc)||this;K.Qub=null;return K}
function ia(K,na,Xa,Qb,tc,md,Dd,ue){ue=K.Ma(1,void 0===ue?null:ue);ue.sheetName=na;ue.locale=Xa;return Rd.i(K,"GetPrintSettings",ue,Qb,tc,md,Dd,4)}function ba(K,na,Xa,Qb,tc,md,Dd){Dd=K.Ma(1,void 0===Dd?null:Dd);Dd.ConvertInParameters=na;return Rd.i(K,"ConvertWorkbookToPrintPdf",Dd,Xa,Qb,tc,md,4)}function ra(K,na,Xa,Qb,tc,md,Dd,ue){ue=K.Ma(9,void 0===ue?null:ue);ue.sheetName=na;ue.printSettings=Xa;return Rd.i(K,"SetSheetPrintSettings",ue,Qb,tc,md,Dd,0)}function ka(K,na,Xa,Qb,tc,md){K=Oi.call(this,
K,na,Xa,void 0===md?!1:md)||this;K.Aw=null;K.Sm=Qb;K.MSb=tc;return K}function da(){this.C8d=this.tb=null}function ha(K,na,Xa,Qb,tc,md,Dd,ue,Ce,Kf){this.iZb=null;this.Frg=K;this.Slb=na;this.mQc=Xa;this.Qug=Qb;this.uvg=tc;this.GRc=new mf.a(Object(Vf.a)(this,this.U_h,"getProbeResults"));this.TWa=md;this.Kde=Ce;this.JAg=Dd;this.vvg=ue;this.Dvg=Kf}function qa(K,na){this.Rag=K;this.mUa=na}function Aa(K){this.isEnabled=Boolean.parse(K.DirectPrintIsEnabled||"false");Boolean.parse(K.DirectPrintProbeIsEnabled||
"false");this.poi=Boolean.parse(K.DirectPrintEnabledForInternetExplorer||"false");this.lUa=(K.DirectPrintSupportedMimeTypes||"").split(Aa.q9c);this.mUa=(K.DirectPrintSupportedPlugins||"").split(Aa.q9c);this.Uci=(K.DirectPrintImmersivePreviewPlugins||"").split(Aa.q9c);this.ehf=Boolean.parse(K.DirectPrintEnabledForEdge||"false");this.fli=Boolean.parse(K.ChromePrintLayoutFixIsEnabled||"false");this.K0g=parseInt(K.ChromeVersionFromWhichPrintLayoutIsEnabled||"76");this.Jzd=14;this.tuf=14394;if(K=K.DirectPrintMinimalSupportedEdgeVersion){var na=
K.split(".");2===na.length?(this.Jzd=parseInt(na[0]),this.tuf=parseInt(na[1])):ud.ULS.sendTraceTag(20734112,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is invalid: {0}",K)}else ud.ULS.sendTraceTag(20734113,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is not set in BRS")}function Fa(K,na,Xa,Qb,tc){Xa=void 0===Xa?null:Xa;Qb=void 0===Qb?!0:Qb;tc=void 0===tc?!1:tc;na=Wd.call(this,K,!0,!(Fa.nVa&&Qb),new Je(K,na),Xa,tc)||this;Fa.nVa=Fa.nVa&&Qb;if(Fa.nVa){Qb=
document.createElement("iframe");tc=null;var md=na.fjh;Qb.name="pdfObjectFrame";Qb.id="pdfObjectIFrame";if(Xa&&0<Xa.count){var Dd=zg.a.jjd(K,Xa);K=zg.a.YLd(K,Xa);tc=document.createElement("form");tc.id="printPreviewPostForm";tc.method="POST";tc.target=Qb.name;tc.action=K;K=Cl(Dd);for(Xa=K.next();!Xa.done;Xa=K.next())Xa=Xa.value,Dd=document.createElement("input"),Dd.type="hidden",Dd.name=Xa.key,Dd.value=Xa.value,tc.appendChild(Dd)}else Qb.src=K;md.appendChild(Qb);tc&&(md.appendChild(tc),tc.submit());
Sys.UI.DomElement.addCssClass(Qb,"DirectPrintPdfObjectHidden");Uh.a.ih(Qb,Uh.a.zC,Uh.a.Dj)}return na}function ab(K){this.jQ=K}function Ua(K,na,Xa,Qb){Qb=void 0===Qb?null:Qb;var tc=hi.call(this)||this;tc.dra=null;tc.fm=null;tc.nQ=null;tc.en=[];tc.BWb=na;tc.jQ=K;tc.Mtg=Xa;tc.OXb=Qb;tc.Anb=new gh.a("LoadResource","LoadPrintablePdf");return tc}function bb(K){var na=Ai.call(this)||this;na.$=K;na.Xb();return na}function xa(K){this.stopwatch=this.b1b=this.YBc=this.oYd=null;this.Qbg=0;this.$=K;(this.uZc=
Te.EwaSettings.isChangeGateEnabled("OfficeVSO:5782706_NSVTC"))||K.da.Ha(322,this)}function Gb(K){this.Yle=0;this.Rbg=K}function $b(K,na,Xa,Qb,tc,md,Dd){this.title=K;this.body=na;this.e6i=Xa;this.primaryButtonAction=Qb;this.secondaryButtonAction=md;this.W_f=tc;this.targetObject=Dd}function oa(K){var na=sh.call(this)||this;na.$=K;na.Xb();return na}function Ma(K){this.$=K;K.da.Ha(309,this)}function Za(K){var na=jg.call(this,K)||this;na.jp=null;na.stopwatch=null;na.tHi=function(Xa){if(1===Xa)na.$.Ka.dc(new bh.a(-2050946363,
Oa.a.$b,2,8,null)).continueWith(function(tc){na.jp.setResult(!cf.a(tc)&&tc.result)}),Xa="Yes";else{var Qb=2===Xa;na.jp.setResult(Qb);Xa=2===Xa?"No":"Close";Qb&&na.U5i()}na.oAi(Xa);na.hide()};return na}function gb(){}function zb(K){return gf.call(this,K)||this}function nb(K){this.Ki=K}function pa(K){var na=ze.call(this)||this;na.$=K;na.Xb();return na}function Ja(K){K.da.Ha(446,this)}function Da(K){return Pd.call(this,K)||this}function ib(K,na){var Xa=this;this.sortOptions=this.FAc=this.selectedRange=
null;this.Bgf=!1;this.activeCell=this.gg=this.Db=this.Tc=null;this.TXi=function(Qb,tc){Lj.b(Qb,-901005882)?(Xd.a(Xa.$).ud.ME(-901005882),Xa.XId(tc)):Xa.xaf(Qb)?Xa.l$e(Qb.Errors[0]):!Lj.a(Qb)&&Qb.Result&&(Xa.sortOptions=tc,Xa.FAc=ff.D(Qb.Result.ActualSortRange),Xa.Xnf=Xa.ga().kja,Xa.Bgf||(Xa.selectedRange=Xa.ga().va.xd,Xa.selectedRange.equals(Xa.FAc)||Xa.dHj()),Xa.sortOptions&&Xa.sortOptions.ActiveCell&&(Qb=Xa.sortOptions.ActiveCell,Qb=new bj.Range(Qb.FirstRow+1,Qb.FirstColumn+1,Qb.FirstRow+1,Qb.FirstColumn+
1,!0,!1),Xa.tM(Qb),Xa.ZZd(Qb)))};this.onContentReady=function(){Xa.cSf(!1);var Qb=Xa.ga();Qb.va.Wg&&Qb.va.xd.equals(Xa.FAc)&&Qb.updateSelection(Xa.selectedRange,Qb.va.activeCell,0,void 0,void 0,void 0,!0)};this.qRi=function(Qb,tc){Qb&&!Mg.a.vh(Qb.Errors)&&Xa.Tc&&(Xa.Tc.ap=Qb.Result,Xa.BLb(),Xa.applyPivotSort(tc))};this.pRi=function(){};this.$=K;this.Xnf="";this.namedSheetViewPublic=na;this.gridView=Og.g(this.$);this.$.Sb.Kh("LoadResource","LoadDialogControlsStopwatch")}function Rb(K,na,Xa,Qb,tc,md,
Dd){Dd=K.Ma(41,void 0===Dd?null:Dd);Dd.options=na;return Rd.i(K,"Sort",Dd,Xa,Qb,tc,md,0)}function wc(K){this.filterRange=null;this.filterRange=K}function Cb(K){this.selection=null;this.selection=K}function lb(K,na,Xa,Qb){var tc=xc.call(this,K)||this;tc.jUd=!1;tc.gic=!1;tc.o7=[];tc.cji=function(md,Dd){var ue=tc.V$g(md);tc.TMa(214,function(Ce,Kf,Wg){return Rd.H(tc.$.na.ta,ue,tc.a1a(Ce,tc.OLh(Dd)),tc.dV(Kf),Wg,null)},16,!0)};tc.bji=function(md,Dd,ue){md=Rd.G(tc.$.na.ta,Dd,tc.zMh(Dd,ue),tc.IRi,null,md);
Array.add(tc.o7,md)};tc.IRi=function(){ud.ULS.sendTraceTag(529105632,0,10,"CustomSortDialog.OnGetSortConditionColorsOrIconsRequestFailure: GetSortConditionColorsOrIcons request failed.");tc.u8b(lb.Qsb())};tc.k9c=function(md,Dd){if(1===md){md=Dd.sortRangeType;var ue={};ue.SortOptions=Dd.sortOptions;ue.ShouldRestoreSelection=tc.jUd;ue.SelectedRange=tc.selectedRange;ue.OriginalActiveCell=tc.brc;ue.TopCellAddress=tc.JUa;ue.ShouldPromptNamedSheetViewTeachingDialog=Te.EwaSettings.isChangeGateEnabled("OfficeVSO:6170028_HandleSheetProtectionForSortFeatures")?
0===md||3===md:!1;if(!Te.EwaSettings.isChangeGateEnabled("OfficeVSO:6170028_HandleSheetProtectionForSortFeatures")&&tc.RCj(md)){var Ce=tc.$;tc.namedSheetViewPublic.TBa().continueWith(function(Kf){Kf.result&&lb.jPf(Ce,ue)})}else lb.jPf(tc.$,ue)}else tc.jUd&&tc.Qpa(tc.selectedRange,tc.brc)};tc.ubi=function(md,Dd){tc.jUd=!0;tc.Qpa(md,Dd)};tc.getColorName=function(md){return gk.a.wLa(Fk.a.MH(md))};ud.ULS.shipAssertTag(529105669,0,!!na.ActiveCell);ud.ULS.shipAssertTag(529105668,0,!!na.SelectedRange);ud.ULS.shipAssertTag(529105667,
0,ff.D(na.SelectedRange).contains(ff.C(na.ActiveCell)));ud.ULS.shipAssertTag(529105666,0,ta.a.equals(na.SelectedRange.SheetName,na.ActiveCell.SheetName,!0));Te.EwaSettings.isChangeGateEnabled("OfficeVSO:5963270_DialogMergeSuspension")&&(tc.udb=new Zb.a(K,kb.a.efh,function(){return tc.gic},1));tc.selectedRange=na.SelectedRange;tc.brc=na.ActiveCell;tc.pYg=na.ExpandSelection;tc.namedSheetViewPublic=Xa;tc.JUa=Qb;tc.initializeAndShow(Tc.a.instance.fa(182),tc.k9c,tc.rua(na));return tc}function yb(K,na){K=
ya.call(this,K,na)||this;K.cEb=K.Kfd();K.Sr();return K}function pc(K,na){var Xa=K.SortRange;K=K.SortTopToBottom?Xa.LastColumn-Xa.FirstColumn:Xa.LastRow-Xa.FirstRow;return 0<=na&&na<=K}function Ta(K,na){if(!K.SortColumnInfoItems)return ud.ULS.sendTraceTag(537151618,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: SortColumnInfoItems is null"),!1;for(var Xa=new wb.a,Qb=Cl(K.SortColumnInfoItems),tc=Qb.next();!tc.done;tc=Qb.next()){tc=tc.value;if(!pc(K,tc.ColumnOffset))return ud.ULS.sendTraceTag(537151617,
0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: offset [{0}] is out of bounds. sort range: {1}",tc.ColumnOffset,K.SortRange),!1;if(!tc.Name)return ud.ULS.sendTraceTag(537151616,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: invalid column name for offset [{0}]",tc.ColumnOffset),!1;if(tc.CellColors&&!tc.CellColors.length)return ud.ULS.sendTraceTag(537151587,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: cell colors are not null but length = [{0}]",tc.CellColors.length),!1;if(tc.TextColors&&
!tc.TextColors.length)return ud.ULS.sendTraceTag(537151586,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: text colors are not null but length = [{0}]",tc.TextColors.length),!1;if(tc.Icons&&!tc.Icons.length)return ud.ULS.sendTraceTag(537151585,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: icons are not null but length = [{0}]",tc.Icons.length),!1;Xa.add(tc.ColumnOffset)}if(K.SortConditions)for(Qb=Cl(K.SortConditions),tc=Qb.next();!tc.done;tc=Qb.next())if(tc=tc.value,!Xa.contains(tc.RowColOffset))return ud.ULS.shipAssertTag(537151584,
0,!1,"SharedSortInfoResultExtension.VerifyColumnInfo: missing column info item for sort condition [{0}]",tc.RowColOffset),!1;if(K.HeaderColumnInfoItems){if(K.HeaderColumnInfoItems.length!==K.SortColumnInfoItems.length)return ud.ULS.shipAssertTag(537151583,0,!1,"SharedSortInfoResultExtension.VerifyColumnInfo: header columnInfo length doesn't match sort column info length"),!1;for(Xa=0;Xa<K.HeaderColumnInfoItems.length;++Xa){Qb=K.HeaderColumnInfoItems[Xa];if(na&&Qb.ColumnOffset!==K.SortColumnInfoItems[Xa].ColumnOffset)return ud.ULS.shipAssertTag(537151582,
0,!1,"SharedSortInfoResultExtension.VerifyColumnInfo: header columnInfo item offset doesn't match sort columnInfo item offset."),!1;if(Qb.CellColors&&1<Qb.CellColors.length)return ud.ULS.sendTraceTag(537151581,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.CellColors is not null and has more than 1 background color"),!1;if(Qb.TextColors&&1<Qb.TextColors.length)return ud.ULS.sendTraceTag(537151580,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.TextColors is not null and has more than 1 font color"),
!1;if(Qb.Icons&&1<Qb.Icons.length)return ud.ULS.sendTraceTag(537151579,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.Icons is not null and has more than 1 icon"),!1}}return!0}function rb(K){if(!K.SortConditions)return!0;for(var na=Cl(K.SortConditions),Xa=na.next();!Xa.done;Xa=na.next()){Xa=Xa.value;if(!pc(K,Xa.RowColOffset))return ud.ULS.sendTraceTag(537151620,0,10,"SharedSortInfoResultExtension.VerifySortConditions: offset [{0}] is out of bounds. sort range: {1}",Xa.RowColOffset,
K.SortRange),!1;if(1===Xa.SortConditionType&&Xa.FillGradient&&!Va.isValid(Xa.FillGradient))return ud.ULS.sendTraceTag(537151619,0,10,"SharedSortInfoResultExtension.VerifySortConditions: sortCondition contains invalid fillGradient"),!1}return!0}function ic(K){return K.SortRange?4===K.SortRangeType?(ud.ULS.sendTraceTag(537151622,0,10,"SharedSortInfoResultExtension.VerifySortRange: Unsupported sort range type: {0}",K.SortRangeType),!1):2===K.SortRangeType&&K.SortTopToBottom&&(null==K.HeaderRowSize||
0>K.HeaderRowSize)?(ud.ULS.sendTraceTag(537151621,0,10,"SharedSortInfoResultExtension.VerifySortRange: header row size must be equal or greater than 1, when range is sheetrange"),!1):!0:(ud.ULS.sendTraceTag(537151623,0,10,"SharedSortInfoResultExtension.VerifySortRange: sort range is null"),!1)}function Va(){}function jb(K,na,Xa,Qb){new Sys.UI.Point(K,na);new Sys.UI.Point(Xa,Qb)}function rc(){}function Cc(K,na,Xa,Qb){K=K.HeaderColumnInfo;return Qb||K?2===na&&Xa?K.CellColors&&1!==K.CellColors.length?
(ud.ULS.sendTraceTag(537151626,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo.CellColors should be null or have exactly 1 color."),!1):K.TextColors&&1!==K.TextColors.length?(ud.ULS.sendTraceTag(537151625,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo.TextColors should be null or have exactly 1 color"),!1):K.Icons&&1!==K.Icons.length?(ud.ULS.sendTraceTag(537151624,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo.Icons should be null or have exactly 1 icon"),
!1):!0:K?(ud.ULS.sendTraceTag(537151627,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo should be null when range type is not SheetRange, or when headerRowSize{0} == 0.",Xa),!1):!0:!0}function Hc(K,na){K=K.ColumnInfo;switch(na){case 1:return K.CellColors&&K.CellColors.length?!0:(ud.ULS.sendTraceTag(537151631,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: sort on cell color result cell colors is null or there are no colors (must have at least 1)."),
!1);case 2:return K.TextColors&&K.TextColors.length?!0:(ud.ULS.sendTraceTag(537151630,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: sort on font color result text colors is nullor there are no colors (must have at least 1)."),!1);case 3:return K.Icons&&K.Icons.length?!0:(ud.ULS.sendTraceTag(537151629,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: sort on icon result icons is nullor there are no icons (must have at least 1)."),!1);default:return ud.ULS.sendTraceTag(537151628,
0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: illeagl sort condition type."),!1}}function Nb(K){var na=this;this.Cw=function(Xa){switch(Xa){case 0:na.ZOa("Cancel");break;case 1:na.ZOa("Expand and sort");na.AVe(!0);break;case 2:na.ZOa("Just sort"),na.AVe(!1)}};this.AVe=K}function nc(K,na,Xa,Qb,tc,md,Dd){Dd=K.Ma(41,void 0===Dd?null:Dd);Dd.filterRange=na;return Rd.i(K,"ReapplyAutoFilter",Dd,Xa,Qb,tc,md,0)}function Ha(K){this.options=null;this.options=K}function tb(K){return bl.call(this,
K)||this}function Ub(K,na,Xa){var Qb=Nk.call(this)||this;Qb.Sze=!1;Qb.Rze=!1;Qb.uMi=function(){Qb.Sze=!0;Qb.t7f()};Qb.$=K;Qb.Ta=na;Qb.FK=Xa;Xd.a(Qb.$).XKd(new nk.a(Hg.a.igg,Hg.a.idle,Ub.l_g),new Zj.a(Hg.a.tDe,Hg.a.t0,null,Hg.a.LP,Hg.a.idle));return Qb}function gc(K){var na=fk.call(this,K,Tc.a.instance.fa(1228))||this;na.textBox=null;na.DSa=null;na.ZUa=null;na.wIf=function(){var Xa=na.$;na.eu();var Qb=new Eb(Xa,1231,1232,1233,function(tc,md,Dd){var ue=Xa.na.ta.fc(),Ce=Xa.na.ta;ue=Ce.Ma(1,ue);return Rd.i(Ce,
"UnshareForm",ue,tc,md,Dd,null,0)},16);Qb.initialize();Qb.pf()};return na}function Eb(K,na,Xa,Qb,tc,md){md=void 0===md?0:md;K=Sk.call(this,K,Tc.a.instance.fa(na),!1)||this;K.message=Xa;K.bLi=Qb;K.C2d=tc;K.operationFlags=md;return K}function Tb(K,na,Xa){var Qb=ma.call(this,K,new Sys.UI.Point(Tb.Zgh,Tb.Agh),Tc.a.instance.fa(na?1226:1225))||this;Qb.i2a=null;Qb.HNc=!1;Qb.Mqc=function(tc){function md(Kf,Wg,Dh){return Rd.F(Dd.na.ta,nh.b(Kf,Qb.cXi),Wg,Dh,ue)}var Dd=Qb.$,ue=new Wc;ue.XH=tc.Values[T.XH];var Ce=
!1;switch(tc.MessageId){case T.m5f:Qb.eu();Ce=!0;ue.sHd=1334518759;break;case T.view:Qb.uCa=Tc.a.instance.fa(1226);Qb.kig(!0);break;case T.lDe:Qb.eu(),Ce=!0}Te.EwaSettings.uc()?(tc=new Oc.a(140,0,md),tc.flags=Ce?16:80):(tc=Ce?new Oc.a(140,0,md):new Hj.a(140,0,md),tc.flags=16);Dd.userOperationManager.jc(tc,Qb.Xd)};Qb.dPi=function(){var tc=Qb.$;tc.ya.SurveyRedirectUrl?(Qb.eu(),tc.ae(1305810481,0,8,null)):(Qb.uCa=Tc.a.instance.fa(1225),Qb.kig(!1))};Qb.qXi=function(){var tc=Qb.$;Qb.eu();tc.ae(1334518759,
0,8,null)};Qb.Czf=function(tc){var md=Qb.$;Qb.eu();tc.MessageId===T.vDe&&md.ea.Qed()};Qb.KVi=function(){Qb.HNc=!0;Qb.raiseEvent(Tb.qwd)};Qb.cXi=function(tc,md){if(!Lj.a(tc)){tc=Qb.$;if(md.XH){var Dd=tc.ea.xa;if(Dd.contains(md.XH.SheetName))Qb.Epc(md);else{var ue=null;ue=function(){Dd.Xna(ue);Qb.Epc(md)};Dd.Oha(ue)}}1461300262!==md.sHd&&tc.ae(md.sHd,0,8,null)}};Qb.nce=na;Qb.Xd=Xa;return Qb}function Wc(){this.XH=null;this.sHd=1461300262}function T(){}function ua(K){K=ma.call(this,K,new Sys.UI.Point(960,
680),Tc.a.instance.fa(1221))||this;K.name=M.a.EOe;return K}function ma(K,na,Xa,Qb){var tc=xk.call(this,K,Xa,2,void 0===Qb?null:Qb)||this;tc.sMc=null;tc.onResize=function(){var md=tc.pWh();tc.BMa.setAttribute("width",md.x.toString());tc.BMa.setAttribute("height",md.y.toString());tc.uWj(md);tc.NDd()};tc.Nph=function(){var md=tc.Ux.parentNode.style,Dd=md.top;md.top="2px";md.top=Dd};tc.GKe=na;tc.$.aB(tc.onResize);tc.Ofc();return tc}function wa(K){return Mi.call(this,K)||this}function Ca(K){this.$=K}function db(K,
na,Xa,Qb,tc,md,Dd,ue){ue=K.Ma(9,void 0===ue?null:ue);ue.sheetName=na;ue.directionRtl=Xa;return Rd.i(K,"ChangeSheetDirection",ue,Qb,tc,md,Dd,0)}function Sa(K,na,Xa,Qb,tc,md,Dd,ue){ue=K.Ma(9,void 0===ue?null:ue);ue.sheetName=na;ue.show=Xa;return Rd.i(K,"ShowHeadings",ue,Qb,tc,md,Dd,0)}function hb(K,na,Xa,Qb,tc,md,Dd,ue){ue=K.Ma(9,void 0===ue?null:ue);ue.sheetName=na;ue.show=Xa;return Rd.i(K,"ShowGridlines",ue,Qb,tc,md,Dd,0)}function Xb(K,na){this.sheetName=null;this.value=!1;this.sheetName=K;this.value=
na}function xb(K,na){var Xa=wk.call(this)||this;Xa.activityName=K;Xa.oN=na;Xa.Xb();return Xa}function Sb(K,na,Xa,Qb,tc){K=wg.call(this,K,na)||this;Sb.Hyd=[-1468309555,611268539,-2087635043,2100961153,810218235,1112506702];Sb.Gyd=[-1468309555,-315732528,-399065540,810218235,1531005923,1593924569,1112506702,1220851643];Sb.Isf=[-1468309555,611268539,-1750576502,61029505];Sb.Hsf=[-1468309555,-315732528,1112506702,-238814601,-1750576502,61029505,-1337545025];K.lAc=Xa;K.zHj=Qb;K.NQj=tc;return K}function qb(){var K=
hl.call(this)||this;K.Xb();return K}function mb(K,na){return gj.call(this,K,na)||this}function ac(K){var na=Jk.call(this)||this;na.$=K;na.Xb();return na}function Uc(K,na){this.$=K;this.Ki=na;this.$.da.Ha(393,this)}function Zc(K){var na=cj.call(this,K)||this;na.rJh=function(Xa,Qb,tc,md,Dd){return 1===tc?32:Xa===gg.a.wSa&&2===tc?(Xa=na.$.na.ta.fc(),Rd.ab(na.$.na.ta,Dd[0],Dd[1],null,null,Xa),32):8};return na}function Kc(K,na){this.$=K;this.Ki=na}function va(K){return Nj.call(this,K)||this}function fb(K,
na){var Xa=this;this.bWi=function(Qb,tc){if(!Lj.a(Qb)&&tc){var md=!!Qb&&!!Qb.RequestTelemetryData;Og.g(Xa.$).Ri.xma(tc,Qb.StateId,md?Qb.RequestTelemetryData.EcsOperationDuration:0,md?Qb.RequestTelemetryData.EcsRequestDuration:0,md?Qb.RequestTelemetryData.WfeRequestDuration:0)}};this.$=K;this.Jh=na}function Pb(K,na){var Xa=Bj.call(this,K)||this;Xa.oxb=function(Qb){Qb=Xa.lid(Qb);return Xa.Dfd(Qb)};Xa.fmj=function(Qb,tc){var md=Xa.NBb=tc[Pb.Yli];1===Qb?(Qb=tc[Pb.GHj],md=Xa.Z7e(Qb,md),ud.ULS.shipAssertTag(537153996,
0,md!==Pb.bca,"ResizeHeadersDialogHandler - invalid size input, size = {0}",Qb),Qb=md!==Xa.Tod,ud.ULS.sendTraceTag(537153995,0,50,"ResizeHeadersDialog OK button pressed, isRow = {0}, isDefaultUnits = {1}, inputPx = {2}, inputChanged = {3}.",Xa.isRow,Xa.NBb,md,Qb),Qb&&Xa.F8g(md)):ud.ULS.sendTraceTag(537153994,0,50,"ResizeHeadersDialog Cancel button pressed, isRow = {0}.",Xa.isRow)};Xa.isRow=2040891415===na.command;Xa.gridView=Og.g(Xa.$);Xa.awc=new sb(Xa.$.workbookContext.DxDigitNormal);Xa.Tod=Xa.NXg();
K=Xa.r7g(Xa.Tod);na=Xa.t7g(Xa.Tod);Xa.uo=Tc.a.instance.fa(Xa.isRow?470:471);K=Xa.iW(K,na);Xa.initializeAndShow(Xa.uo,Xa.fmj,K);ud.ULS.sendTraceTag(537153997,0,50,"ResizeHeaders React Dialog opened, isRow = {0}.",Xa.isRow);return Xa}function sc(K){this.resizeParameters=null;this.resizeParameters=K}function hd(K,na){this.isRow=!1;this.autoFitRange=null;this.isRow=K;this.autoFitRange=na}function Ob(){var K=zk.call(this)||this;K.Xb();return K}function Ac(K,na){var Xa=jk.call(this,na.domElement)||this;
Xa.AXf=!1;Xa.j6=!1;Xa.bUa=null;Xa.f9a=null;Xa.Iq=null;Xa.offset=0;Xa.mm=0;Xa.IKb=0;Xa.J1=null;Xa.S7=null;Xa.SN=null;Xa.tai="headerResizeTooltip";Xa.Dxd=null;Xa.SG=null;Xa.dBa=!1;Xa.QXa=!1;Xa.r_c=!1;Xa.EO=function(Qb){if(Xa.grid.Sw)return!0;Qb=ik.a(Xa.grid.$).se(Qb);if(3===Qb.zb&&!Xa.Xlf(Qb.Ca)||!Xa.oMf(Qb,!1))return!1;ud.ULS.sendTraceTag(537154058,2,50,"HeaderResizeBehavior.OnMouseDown: About to generate tooltip");var tc=Xa.fAc();Xa.Mfd(Qb.clientPoint,tc,!0);Xa.dBa||(bi.a.instance.qa(Bf.a.ph,Xa.domElement.ownerDocument.body,
Xa.R$a),fj.a.instance.qa(Bf.a.Dg,Xa.domElement.ownerDocument.body,Xa.R$a),Xa.dBa=!0);Xa.bif()&&Xa.j6&&Xa.Qcf(Qb);return!1};Xa.fpc=function(Qb){Qb=ik.a(Xa.grid.$).se(Qb);Xa.bif()&&Xa.r_c&&Xa.Qcf(Qb);if(Te.EwaSettings.isChangeGateEnabled("OfficeVSO:6093232_ResizeRowColUsingTouch")){if(!Qb.Ca.type.includes("touch")&&Qb.Ca.button!==Sys.UI.MouseButton.leftButton||!Xa.j6)return!1}else if(Qb.Ca.button!==Sys.UI.MouseButton.leftButton||!Xa.j6)return!1;ci.g(Qb.Ca);Xa.dPe();Qb=qg.a.h7a;Xa.Iq&&(Qb=Xa.QXa?Xa.jhd():
Xa.Iq.yka());var tc=Qb!==Xa.mm;if(Xa.bUa&&tc&&Qb!==qg.a.h7a){Qb=Xa.grid;tc=Xa.f6e(Qb);var md={};md.SheetMultiRange=ff.r(tc,Qb.$);Ac.oSd(md,Xa.isRow,Xa.mm);Xa.Bph(md);Qb.YMj=!0}else Xa.zh(null,null),Xa.Cuc();return Xa.QXa=!1};Xa.gda=function(Qb){Qb=Qj.a.create(Qb.eventName,Qb.Mb,Qb.Ca,Qb.zb);Qb=ik.a(Xa.grid.$).se(Qb);if(!Xa.oMf(Qb,!0))return!1;Qb=Xa.grid;var tc=Xa.f6e(Qb);tc=ff.r(tc,Qb.$);Qb.Fb.si([Xa.isRow?13:14]);Qb.Fb.Zeb();Xa.Cuc();var md={};Qb.$.ae(Xa.isRow?146338636:1391094586,Oa.a.$b,30,(md.autoFitRanges=
tc,md));return!1};Xa.R$a=function(Qb){Qb=ik.a(Xa.grid.$).se(Qb);if(!Xa.j6)return!1;ci.g(Qb.Ca);var tc=Xa.isRow;if(!Xa.J1){Xa.J1=document.createElement("div");Xa.J1.style.cssText="position: relative; width: inherit; height: inherit;"+(tc?"top: 0px; ":Xa.rtl?"right: 0px:":"left: 0px:");for(var md=Xa.Iq.EK();md.nextSibling;)Xa.J1.appendChild(md.nextSibling);md.parentNode.appendChild(Xa.J1)}md=Qb.clientPoint;var Dd=tc?md.y-Xa.f9a.y:(Xa.rtl?-1:1)*(md.x-Xa.f9a.x),ue=tc?md.y-Xa.bUa.y:(Xa.rtl?-1:1)*(md.x-
Xa.bUa.x),Ce=Xa.Iq.yka();if(Ce===qg.a.h7a)return!1;Dd&&(0<Xa.mm||0<Ce+ue)&&Ce+ue<=Xa.ptf&&(Xa.mm=Xa.fAc(ue),Xa.Mfd(md,Xa.mm,!1),Pe.DOMElementExtensions.gVa(Xa.Iq.EK(),!tc,Math.max(Xa.IKb+ue,0)),Xa.J1.style[tc?"top":Xa.rtl?"right":"left"]=Math.max(ue,-Xa.IKb)+"px",Pe.DOMElementExtensions.gVa(Xa.Iq.Df.domElement,!tc,(tc?Xa.Iq.Df.HQ:Xa.Iq.Df.IQ)+Math.max(ue,-Xa.IKb)),Xa.f9a=new Sys.UI.Point(Qb.clientPoint.x,Qb.clientPoint.y),Pe.DOMElementExtensions.setVisible(Xa.SG,!1));return!0};Xa.FS=function(Qb){if(Xa.grid.Sw)return!0;
Qb=ik.a(Xa.grid.$).se(Qb);var tc;if(!Xa.xkf||-1!==Xa.grid.ga.selectionType)return Ei.a(Xa.grid.$).Rq()&&(tc=Xa.Xhd(Qb))&&(tc.dxa.style.cursor=""),!1;if(Xa.j6)return Xa.sgi(),!1;tc=Xa.Xhd(Qb);if(!tc)return!1;tc.dxa.style.cursor=!Xa.grid.isEditing&&Xa.Rud(tc)?Xa.isRow?"row-resize":"col-resize":"";ci.g(Qb.Ca);return!0};Xa.Gp=function(){Xa.Cuc()};Xa.zh=function(){if((3===Oa.a.$b||Yf.a.zp)&&Xa.grid.ga.va.Wg){var Qb=Xa.grid.ga.va.xd;if(!(!Qb.isRow&&!Qb.Xf||!Xa.domElement||Qb.isRow&&Xa.isRow&&!Array.contains(Xa.Df.Sn,
Qb.top)||Qb.Xf&&!Xa.isRow&&!Array.contains(Xa.Df.Sn,Qb.left))){var tc=Xa.grid.jg(Qb,Xa.Df.Ej.paneType);tc&&(Xa.SG||Xa.Zdh(),Qb.isRow&&Xa.isRow?(Pe.DOMElementExtensions.setVisible(Xa.SG,!0),Xa.SG.style.top=tc.bottomRight.y-Xa.SG.offsetHeight/2+"px"):Qb.isRow||Xa.isRow||(Pe.DOMElementExtensions.setVisible(Xa.SG,!0),Mj.c(Xa.SG.style,Xa.grid.rtl,tc.bottomRight.x-Xa.SG.offsetWidth/2+"px")))}}};Xa.jG=function(Qb,tc){tc.tQ&&Xa.rrb()};Xa.Df=na;Xa.isRow=na.isRow;Xa.rtl=na.Ej.rtl;Xa.grid=K;Xa.ptf=Xa.isRow?
qg.a.gzd:qg.a.Vmc;Xa.pai=Tc.a.instance.fa(429);Xa.yai=Tc.a.instance.fa(428);Xa.sai=Tc.a.instance.fa(430);Ff.a(Xa.grid.$,function(Qb){Xa.Dxd=Qb.eR(Vb.a.nmj,!1)});Xa.tcj();Xa.grid.ga.pZ(Xa.zh);Xa.grid.ga.x3(Xa.Gp);Xa.grid.yr(Xa.zh);Ei.a(Xa.grid.$).yg.Pha(Xa.jG);return Xa}function sb(K){this.k$c=K}function ad(K,na,Xa,Qb,tc,md,Dd){this.dxa=K;this.jEb=na;this.JPa=Xa;this.Jmd=Qb;this.edb=tc;this.Wlf=md;this.y$h=Dd}function Hd(){}function Ne(K){var na=Aj.call(this)||this;na.$=K;na.Xb();return na}function Ud(K){var na=
this;this.Cpa=this.yZe=this.KHb=this.F3a=this.Isc=this.Eda=this.XQa=null;this.Ktd=this.EPb=this.UOd=!1;this.NMb=!0;this.mic=!1;this.lVd=!0;this.DPb=this.p2a=this.DFe=0;this.sxc={};this.rrc={};this.qrc={};this.CMf=0;this.A8a=this.mce=!1;this.ufj=function(){Pe.DOMElementExtensions.toggleCssClass(na.$.zr,"ewr-presentMode-transition",!1);$removeHandler(na.F3a,"transitionend",na.Cpa)};this.lj=function(){parseInt(na.$.xw.style.right,10)!==na.DFe&&window.requestAnimationFrame(function(){na.JDc(0);na.$.DAa(Ya.a.w_("PresentModeManager.OnContentAreaResized"))})};
this.Sza=function(){var Xa=Object(bf.a)(hf.a,na.$.oa);if(Xa&&na.Qz){na.gridView.Qrd=!1;Xa=Xa.headersVisible;var Qb=Og.g(na.$).rtl;Pe.DOMElementExtensions.toggleCssClass(na.$.zr,"ewr-presentMode-on-headers-off",!Xa);Pe.DOMElementExtensions.toggleCssClass(na.$.zr,"ewr-presentMode-on-rtl",Qb);(12!==na.p2a&&!Xa||32!==na.p2a&&Xa&&!Qb||0!==na.p2a&&Xa&&Qb)&&window.requestAnimationFrame(function(){na.JDc(2)})}};this.vd=function(){na.uff();na.Bh("OnWorkbookOpened");ud.ULS.sendTraceTag(537154323,0,50,"PresentModeManager.OnWorkbookOpened: Silent reload happened during present mode")};
this.Gp=function(){na.Ktd=!0;na.ofa("OnSelectionStarted")};this.zh=function(){na.Ktd=!1;na.ofa("OnSelectionEnded");na.LZf()};this.mj=function(){na.ofa("OnEditStarted")};this.Rg=function(){na.ofa("OnEditEnded")};this.ax=function(){if(!na.mic){var Xa=Te.EwaSettings.isChangeGateEnabled("OfficeVSO:5411756_FlickerFixForPresentModeOverlay");na.ofa("OnVisibleAreaChanged",!0,Xa)}};this.yza=function(){na.mic=!0};this.Fp=function(){na.ofa("OnCurrentSelectionModeChanged");na.LZf();na.Bh("OnCurrentSelectionModeChanged")};
this.Rm=function(){na.ofa("OnBlockCacheItemEvicted")};this.Xe=function(){na.ofa("OnBlockCacheItemChanged")};this.gG=function(){na.mic||na.ofa("OnActiveItemPanesChanged")};this.li=function(){na.mic=!1;na.Eda.Bh("ActiveSheetChanged");na.Sza()};this.oGb=function(Xa,Qb){if(Xa=Object(bf.a)(hf.a,Qb.item))Xa.Arb(16,!0),Xa.rpb(na.Sza)};this.cQi=function(){Ge.Ani||(na.Isc&&na.Isc.Sq&&na.Isc.hide(),Og.g(na.$).isEditing&&Og.g(na.$).kr(!0),na.$zc(!1),ud.ULS.sendTraceTag(537154321,0,50,"PresentModeManager.OnFullScreenChangeEventHandler: Esc pressed to exit present mode"))};
this.dQi=function(){ud.ULS.sendTraceTag(537154320,0,10,"PresentModeManager.OnFullScreenErrorEventHandler: Error handling full screen mode")};this.$=K;this.gridView=Og.g(this.$);this.fqj=K.ya.PresentModeRenderUpdateTimeout;this.initialize(K)}function Ge(){}function Sc(K,na){var Xa=Zi.call(this,K)||this;Xa.M5i=function(){Xa.Eda.gVd(!0)};Xa.Eda=na;Xa.domElement.classList.add("ewr-presentMode-on");K={};K=(K[Sc.Cz]=Xa.Cc,K);Xa.lc=0;Xa.initializeAndShow("",Xa.M5i,K);return Xa}function Pc(K){this.H0a=this.THd=
null;this.$=K;this.gridView=Og.g(this.$)}function Zd(){this.overlayCavityInfos=this.overlayContainerInfo=this.containerId=null}function ie(){this.height=this.width=0}function vd(){this.angle=this.translateY=this.translateX=this.height=this.width=this.top=this.left=0}function Lb(K){var na=this;this.gwe=this.VQa=this.RHd=this.SHd=this.Dda=this.ewaAccessibilityManager=null;this.isInitialized=!1;this.msc={};this.lsc={};this.QQa=null;this.uLf=0;this.onKeyDown=function(Xa){Xa=Xa.Ca;if(9===Xa.keyCode){var Qb=
na.Dda.querySelectorAll(Pe.DOMElementExtensions.nq),tc=Pe.DOMElementExtensions.Nl(Qb);Qb=Pe.DOMElementExtensions.Iz(Qb);Pe.DOMElementExtensions.Cea(Xa,tc,Qb);return!0}return!1};this.Tl=function(){var Xa=[];na.$.da.Ya(337,function(Qb){na.VQa.getPresentModeFloatieControlsMap().then(function(tc){for(var md={},Dd=0;Dd<tc.length;Dd++)md[tc[Dd].controlId]=tc[Dd].modelType;Xa.push.apply(Xa,Qb.Kda.N5a(md));0<Xa.length&&appChrome.api.dispatch(Xa);na.upj()})})};this.$=K}function id(){}function uc(K){return oi.call(this,
K)||this}function ed(K,na){this.$=K;this.presentModeManager=na}function Cd(K,na,Xa,Qb){var tc=of.call(this)||this;tc.activityName=K;tc.oN=na;tc.vK=Xa;tc.$=Qb;tc.Xb();return tc}function $d(K,na,Xa){var Qb=Uj.call(this,K,na)||this;Qb.Ei=null;Qb.axi=function(tc){var md=Qb.Zs.ud,Dd=Object(bf.a)(6,md.Me);var ue=tc.Ptb;Qb.unsubscribe(function(Wg){tc.remove_disposing(Wg)});for(var Ce=0,Kf=md.errors.length;Ce<Kf;Ce++)-573864504===md.errors[Ce].MessageId&&md.wma(md.errors[Ce]);switch(ue){case 1:Dd.ea.cDc=
!0;ud.ULS.sendTraceTag(537155485,0,50,"LegacySharedWorkbookActivity.LegacySharedDialogDisposing: User has selected to turn off the Legacy Shared Workbook setting ");Qb.Dh(Dd.isEditMode?Hg.a.XOb:Qb.Jgh);Qb.Ep();break;case 2:Qb.Dh(Hg.a.openInExcelClient);Qb.Ep();break;case 0:md.activityState[Ra.a.mt]=!1,Qb.Dh(Qb.vK),Qb.Ep()}};Qb.Jgh=na;Qb.vK=Xa;return Qb}function La(K,na){K=ck.call(this,K,na)||this;K.Rqa=0;K.Sr();return K}function od(K,na,Xa,Qb){var tc=rj.call(this)||this;tc.activityName=K;tc.oN=na;
tc.vK=Xa;tc.$=Qb;tc.Xb();return tc}function ne(K,na,Xa){return De.call(this,K,na,Xa)||this}function qd(K,na){K=Hf.call(this,K)||this;K.password=null;K.tmf=na;K.mh();return K}function He(K,na,Xa,Qb){var tc=zj.call(this)||this;tc.activityName=K;tc.oN=na;tc.vK=Xa;tc.$=Qb;tc.Xb();return tc}function Ue(K,na,Xa){return De.call(this,K,na,Xa)||this}function zf(K){var na=Hf.call(this,K)||this;na.MOd=5;na.jce=!1;na.passwordToModify=null;na.wKf=function(){na.$.isEditMode&&na.mjc&&(yi.b().cad("PasswordToModifyPasswordVerifiedTillInteractive"),
na.$.Bl(na.wKf))};na.mh();na.$.fl(na.wKf);return na}function Hf(K){var na=Rk.call(this,K)||this;na.Rqa=0;na.Q$i=function(Xa,Qb){na.Ybb(Xa,Qb)};return na}function De(K,na,Xa){var Qb=lj.call(this,K,na)||this;Qb.Ei=null;Qb.tGd=null;Qb.S1i=function(tc,md){Qb.gHb(tc,md)};Qb.vK=Xa;return Qb}function Ae(K){var na=vk.call(this)||this;na.$=K;K.da.Ha(56,new je(K));na.Xb();return na}function yd(K,na){return bk.call(this,K,na)||this}function je(K){var na=Ii.call(this)||this;na.$=K;na.Xb();je.p5g();return na}
function we(K,na,Xa){var Qb=Bc.call(this,!0)||this;Qb.Oa=new Oj.a;Qb.TYe=!1;Qb.U9c=!1;Qb.FDe=null;Qb.Hm=null;Qb.X4b=null;Qb.fd=function(){Wj.a.Eg(Xd.a(Qb.$).ud.activityState,ni.a.hCd)||Qb.jba.reset()};Qb.cPi=function(tc){Qb.YVf(tc)};Qb.bPi=function(){Qb.hFj()};Qb.$=K;Qb.ea=K.ea;Qb.FK=na;Qb.businessBar=Xa;Qb.ea.ek(Qb.fd);Qb.jba=ek.a.pwe(Qb.$);Qb.q5g();K.da.Ha(55,Qb);return Qb}function Bc(K){this.Sga=this.R8d=this.BWa=null;this.gkb=!1;this.APc=this.bge=null;this.HSb=this.rE=this.WXb="";this.application=
this.nC=0;this.FMj=this.HXd=!1;this.MZj=K&&be.AFrameworkApplication.ha.ra("OICLaunchDialogIsEnabled");be.AFrameworkApplication.Ib.i5(gg.a.hSa)||be.AFrameworkApplication.Ib.ic(gg.a.hSa,Sg.a.frame,Object(Vf.a)(this,this.hnj,"retryOpenInClientAction"));this.$8f=!!be.AFrameworkApplication.ha&&be.AFrameworkApplication.ha.ra("SilentExternalHandler")}function Od(){}function ae(){}function Ad(K){var na=Wh.call(this)||this;na.Bq=K;na.Ve="ProtocolLaunchingDialog";be.AFrameworkApplication.Yi.s6a&&be.AFrameworkApplication.Yi.ewc();
be.AFrameworkApplication.sa.Qa.eld&&na.vpe(CommonUIStrings.l_OICStandardDialogSectionGiveFeedback,Object(Vf.a)(na,na.rpc,"onGiveFeedbackClick"));Ad.caf?(na.lc=12,na.Bc(1,CommonUIStrings.l_CloseFile),na.Bc(2,CommonUIStrings.l_OICDialogContinueHere),na.Bc(3,CommonUIStrings.l_OICDialogLaunchAgain)):(na.lc=4,na.Bc(1,CommonUIStrings.l_OICDialogContinueHere),na.Bc(2,CommonUIStrings.l_OICDialogLaunchAgain));na.dEb(CommonUIStrings.l_OICDialog2ndTitle,5===na.Bq.hJf?CommonUIStrings.l_OICBrowserDialogTitle:
CommonUIStrings.l_OICStandardDialogSectionTitle,null,null,Object(Vf.a)(na,na.$Id,"protocolLaunchingDialogResultHandler"),null);return na}function Ve(K){var na=fi.call(this)||this;na.Ufa=null;na.uWa=null;na.Tqa=!1;na.zqa=null;na.Bq=K;na.ig=kf.ig;na.Twe=!0;na.lc=5;na.Ve="ProtocolLaunchingDialog";na.EJc="OICRetryDialog";be.AFrameworkApplication.Yi.s6a&&be.AFrameworkApplication.Yi.ewc();be.AFrameworkApplication.Yi.$g(new Zh.a(2,1,5E3,function(){na.switchToBackupMode()},101));na.showDialog("",Object(Vf.a)(na,
na.$Id,"protocolLaunchingDialogResultHandler"));na.n3f();na.UX("Issues");na.DYe();ud.ULS.sendTraceTag(19239262,211,50,"OIC dialog launched");document.getElementById("WACDialogTitlePanel").className+=" OICDialog";return na}function kf(){}function Fc(K){var na=qj.call(this)||this;na.HDa=null;na.vWa=null;na.Tqa=!1;na.Bq=K;na.ig=fd.ig;na.Twe=!0;na.lc=5;na.Ve="OICLaunchDialog";na.showDialog("",Object(Vf.a)(na,na.$Ki,"oicLaunchDialogResultHandler"));na.n3f();na.UX("ProtocolLaunchingDialogTitle");4!==be.AFrameworkApplication.sa.Qa.editMode&&
(document.getElementById("ProtocolLaunchingDialogTitle").innerText=CommonUIStrings.l_OICLaunchDialogTitleForView);na.jA(na.HDa);ud.ULS.sendTraceTag(22140865,211,50,"OIC launch dialog opened");document.getElementById("WACDialogTitlePanel").className+=" OICDialog";return na}function fd(){}function jd(K,na,Xa,Qb,tc){var md=document.createElement("img");md.alt=K;md.className=kg.getImageClassWithCluster(Xa,Qb);md.src=na;md.setAttribute(Uh.a.Vd,Uh.a.ls);K=document.createElement("span");K.className="ProtocolLaunchingDialogImg32Container";
K.appendChild(md);md=document.createElement("span");md.className="ProtocolLaunchingDialogIconContainer";md.appendChild(K);tc.appendChild(md)}function zd(K,na,Xa,Qb,tc,md,Dd){var ue=document.createElement("a");ue.className="ProtocolLaunchingDialogButtonAnchor";ue.className+=" OICDialog";ue.id=K;ue.setAttribute(Uh.a.Vd,Uh.a.ks);ue.style.padding="0";ue.style.margin="0";Qb&&jd(tc,na,Xa,Qb,ue);K=document.createElement("span");K.className="ProtocolLaunchingDialogButtonLabel";K.innerText=tc;ue.appendChild(K);
ue.tabIndex=0;md&&pj.a.instance.qa(Bf.a.click,ue,md);Dd&&Ye.KeyInputManager.instance.qa(Bf.a.Td,ue,Dd);return ue}function zc(K){return K.Ca.keyCode===Gi.a.fi||K.Ca.keyCode===Gi.a.Xpa?(K.Mb.click(),!0):!1}function $e(K){for(var na=0;na<K.children.length;na++){var Xa=K.children[na];Xa.style.position="relative";Xa.style.top=(Xa.parentNode.offsetHeight-Xa.offsetHeight)/2+"px"}}function Xe(){}function pe(K,na,Xa){var Qb=this;this.La=K;this.cvg=na;this.zHc=null;(this.fZb=be.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",
!1))&&Xh.a.instance.qc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(tc){Qb.zHc=tc});this.K2=Xa}function Jf(K,na,Xa){this.La=K;this.Zug=na;this.K2=Xa}function kc(K){var na=df.call(this)||this;na.$=K;na.Xb();return na}function $c(K){var na=Yd.call(this)||this;na.$=K;na.Xb();return na}function rd(K,na,Xa){Xa=void 0===Xa?!1:Xa;var Qb=ki.call(this,K,na)||this;Qb.EDb=null;Qb.DEd=function(tc){Qb.unsubscribe(function(md){tc.remove_disposing(md)});Qb.Dh(Hg.a.Mk);Qb.Ep()};
Qb.Dmc=Xa;return Qb}function me(K){return sd.call(this,K)||this}function te(K,na){this.Ki=na;this.$=K}function ge(K){var na=Bb.call(this)||this;na.$=K;na.Xb();return na}function pd(K){return qc.call(this,K)||this}function jc(K){this.xo="Excel";this.$=K;this.YV=ob.a.current}function jf(K,na,Xa,Qb,tc,md,Dd){Dd=K.Ma(9,void 0===Dd?null:Dd);Dd.sheetName=na;Dd.confirmationChoice=!0;return Rd.i(K,"DeleteSheet",Dd,Xa,Qb,tc,md,0)}function dc(){}function za(K){var na=Kb.call(this)||this;na.s3d=null;na.u3d=
0;na.qj=null;na._state=0;na.moveNext=function(){try{for(na._state=1;1===na._state;)na.Tu=na.Tu()}catch(Xa){na.dispose(),na.Eea(Xa),na._state=3}};na.Ef=K;na.Tu=na.AM;na.moveNext();return na}function Mb(){}function hc(K){return W.call(this,K)||this}function cc(K,na){this.$=K;this.gridView=na}function Ec(K,na,Xa){var Qb=qi.call(this,K)||this;Qb.Aob=0;Qb.AAb=!1;Qb.S2a=null;Qb.RLe=!1;Qb.Fsb=!0;Qb.nWc=null;Qb.uo=null;Qb.SAd=0;Qb.TAd=null;Qb.RAd=null;Qb.removeHyperLink=!1;Qb.cellValue=null;Qb.location=null;
Qb.Xbi=function(tc,md){1===tc||2===tc?(ud.ULS.sendTraceTag(555755670,0,50,"HyperLink {0} pressed",1===tc?"OK":"Remove"),Qb.TAd=md[Ec.qxi],Qb.SAd=md[Ec.xrj],Qb.RAd=md[Ec.vkh],2===tc&&(Qb.removeHyperLink=!0),Qb.commit()):ud.ULS.sendTraceTag(537157644,0,50,"HyperLink Cancel pressed")};Qb.T_j=function(tc,md){return 0!==md&&tc.length?1===md?Qb.k2e(ff.y(tc,Qb.ea.xa)||Qb.kHi(tc),747):Qb.k2e(Cf.a.mrd(tc),749):null};Qb.selectedRange=na;Qb.VM=Xa;Qb.ea=K.ea;Qb.sheetName=na.SheetName;Qb.PMa();Qb.um();Qb.lc=Qb.AAb?
9:1;Qb.Bc(1,Tc.a.instance.fa(4));Qb.AAb&&Qb.Bc(2,Tc.a.instance.fa(750));K={};K=(K[Ec.Fjh]=Qb.RLe,K[Ec.wkh]=Qb.S2a,K[Ec.JDg]=Qb.Aob,K[Ec.KDg]=Qb.nWc,K[Ec.O7g]=Qb.Fsb,K);na={};K=(na[Ec.Cz]=Qb.Cc,na[Ec.U_j]=Qb.T_j,na[Ec.RSg]=K,na);Qb.initializeAndShow(Qb.uo,Qb.Xbi,K);return Qb}function Lc(K){return pf.call(this,K)||this}function he(K,na,Xa,Qb){var tc=xe.call(this)||this;tc.$=K;tc.businessBar=Qb;tc.openInExcelOperation=na;tc.FK=Xa;return tc}function qe(){}function Af(K){var na=this;this.cci="itms-apps://";
this.dci="apps.apple.com/app/apple-store/id586683407?mt=8&pt=80423&ct=miniWAC";this.mng=function(Xa){1==Xa&&na.sGc()};this.$=K;this.Tx=be.AFrameworkApplication.sa.Qa.Tx;this.Vma="ms-excel:ofe|u|"+this.Tx;this.vm=be.AFrameworkApplication.ha.Wa("AppUrl");Yf.a.ica||Yf.a.dh?this.vm=this.cci+this.dci:Yf.a.xp&&(be.AFrameworkApplication.ha.ra("UseAppAndroidMarketURL")?(ud.ULS.sendTraceTag(523534414,306,100,"OpenInAppDialogReact: Using app android market url"),this.vm=be.AFrameworkApplication.ha.Wa("WildFireMarketUrlExcelAndroid")):
Yf.a.cBb?this.vm=be.AFrameworkApplication.ha.Wa("WildFireUrlChinaStoreAndroid"):4<Yf.a.RYc.S9a&&(this.vm=be.AFrameworkApplication.ha.Wa("WildFireUrlExcelAndroid")))}function xf(K){var na=yg.call(this,K)||this;na.uI=null;na.kFb=function(){ud.ULS.sendTraceTag(574993313,306,50,"MouseClick: Open with redirection timer");if(na.$.ya.IsMeetingLiveSession)return na.sGc(),!0;Yf.a.xp?(ud.ULS.sendTraceTag(574993312,306,50,"Android intent scheme is being used to open android app from browser"),na.Tx&&na.Tx.length||
ud.ULS.sendTraceTag(537162595,306,15,"ClientUrl is null"),na.openUrl("intent:"+na.Tx+"#Intent;scheme=ms-excel;action=android.intent.action.VIEW;S.browser_fallback_url="+na.vm+";end","_top")):9<=Yf.a.Und?(ud.ULS.sendTraceTag(537162594,306,50,"OpenInAppDialog.onClickHandler: Open in app directly if installed for iOS version 9 or above"),na.openUrl(na.Vma,"_top"),window.setTimeout(function(){na.openUrl(na.vm,"_blank")},9E3)):(ud.ULS.sendTraceTag(537162593,306,50,"OpenInAppDialog.onClickHandler: Open in app if installed, else redirection to appstore for iOS version below 9."),
na.openUrl(na.Vma,"_top"),window.setTimeout(function(){na.openUrl(na.vm,"_blank")},500));return!0};na.ina=function(Xa){return Xa.Ca.keyCode===Gi.a.fi||Xa.Ca.keyCode===Gi.a.Xpa?(ud.ULS.sendTraceTag(537162592,306,50,"KeyPress: Open with redirection timer"),Xa.Mb.click(),!0):!1};if(1!==be.AFrameworkApplication.sa.Qa.Yj)return na;na.Tx=na.$.workbookContext.ClientUrl;na.Vma="ms-excel:ofe|u|"+na.Tx;na.vm=be.AFrameworkApplication.ha.Wa("AppUrl");Yf.a.ica?na.vm="itms-apps://"+be.AFrameworkApplication.ha.Wa("WildFireUrlExceliOS")+
"&referrer=utm_source%3Dwac%26utm_medium%3Dweb%26utm_campaign%3Dminiwac":Yf.a.xp&&(Te.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseAppAndroidMarketURL",!1)&&na.$.ya.IsMeetingLiveSession?(ud.ULS.sendTraceTag(529397969,306,100,"Using app android market url"),na.vm=be.AFrameworkApplication.ha.Wa("WildFireMarketUrlExcelAndroid")):Yf.a.cBb?na.vm=be.AFrameworkApplication.ha.Wa("WildFireUrlChinaStoreAndroid"):4<Yf.a.RYc.S9a&&(na.vm=be.AFrameworkApplication.ha.Wa("WildFireUrlExcelAndroid")+
"&referrer=utm_source%3Dwac%26utm_medium%3Dweb%26utm_campaign%3Dminiwac"));return na}function fc(){}function Gc(K){this.calculateType=0;this.calculateType=K}function xd(K){this.calculationMode=0;this.calculationMode=K}function Id(K,na){var Xa=this;this.dialog=null;this.CAf=function(){Xa.dialog&&Xa.dialog.hide()};this.aLi=K;this.yb=na;this.yb.cpb(this.CAf)}function le(K,na){return Wd.call(this,K,void 0,void 0,na)||this}function Wd(K,na,Xa,Qb,tc,md){na=void 0===na?!0:na;Xa=void 0===Xa?!1:Xa;Qb=void 0===
Qb?null:Qb;tc=void 0===tc?null:tc;md=void 0===md?!1:md;var Dd=Yb.call(this)||this;Dd.TY=null;Dd.fm=null;Dd.pXa=null;Dd.qXa=null;var ue=Dd.XYd?Dd.XYd:CommonUIStrings.l_DefaultDialogTitle;Wd.Yyb=md;Dd.CTb=Qb||new Je(K,!0);Dd.CTb.mwe(Dd);var Ce=[],Kf=[];Wd.Yy&&(Dd.sYc&&Dd.sYc.forEach(function(wj){Array.add(Ce,wj)}),Dd.Ase&&Dd.Ase.forEach(function(wj){Array.add(Kf,wj)}));na?Xa?(Dd.lc=4,Dd.Bc(1,Dd.buttonText),Dd.Bc(2,CommonUIStrings.l_DialogClose)):(Dd.lc=6,Dd.Bc(0,CommonUIStrings.l_DialogClose)):Dd.lc=
5;md=document.createElement("span");Dd.s7c&&(md.className=Dd.s7c);Qb=document.createElement("a");Qb.innerText=Dd.Klc;Qb.href=K;Qb.target="_blank";Qb.id=Dd.Jlc;Qb.className=$a.AFrame.jte;var Wg=!Yf.a.oD&&!!tc&&0<tc.count;if(Wg){var Dh=zg.a.jjd(K,tc);tc=zg.a.YLd(K,tc);Qb.href="#";Qb.target="_self";Dd.fm=document.createElement("form");Dd.fm.id="printPreviewPostForm1";Dd.fm.method="post";Dd.fm.target="_blank";Dd.fm.action=tc;tc=Cl(Dh);for(Dh=tc.next();!Dh.done;Dh=tc.next()){Dh=Dh.value;var Ci=document.createElement("input");
Ci.type="hidden";Ci.name=Dh.key;Ci.value=Dh.value;Dd.fm.appendChild(Ci)}}else Dd.fm=null;Dd.fm||Wd.Yyb?Wd.Yyb||(K={},Array.add(Kf,(K.type="AppLinkProps",K.id=Dd.Jlc,K.text=Dd.Klc,K.onExecute=function(){Dd.UPf()},K))):(tc={},Dh={},Array.add(Kf,(Dh.type="AppLinkProps",Dh.id=Dd.Jlc,Dh.text=Dd.Klc,Dh.handler=(tc.href=Wg?"#":K,tc.target=Wg?"_self":"_blank",tc),Dh)));Dd.qPa&&Array.add(Ce,Dd.qPa);Xa?(K=document.createElement("span"),K.innerText=Dd.qPa.replace("{0}",""),md.appendChild(K)):Dd.luf?(K=document.createElement("span"),
K.id=Dd.vi("message"),Wg=document.createElement("span"),tc=document.createElement("span"),Dh=Dd.qPa.split("{0}"),Wg.innerText=Dh[0],tc.innerText=Dh[1],K.appendChild(Wg),K.appendChild(Qb),K.appendChild(tc),md.appendChild(K)):(K=document.createElement("span"),K.innerText=Dd.qPa,md.appendChild(K),md.appendChild(document.createElement("br")),md.appendChild(document.createElement("br")),md.appendChild(Qb),Wd.Yyb||Array.add(Ce,"{0}"));Dd.fm&&md.appendChild(Dd.fm);Wd.Yy&&(Dd.u9a&&(Dd.WCb?Dd.tpe(Dd.u9a,Dd.WCb):
(Array.add(Ce,"{0}"),K={},Array.add(Kf,(K.type="AppLinkProps",K.id="LearnMoreLinkId",K.text=Dd.u9a,K.onExecute=function(){Dd.Dlc()},K)))),Dd.Ssa(Ce,Kf));Dd.dEb(ue,null,Dd.Dcf,null,Object(Vf.a)(Dd,Dd.Cw,"dialogHandler"),Wd.Yy?null:md);Dd.UX(Dd.vi("message"));!Wd.Yy&&Dd.WCb&&Dd.u9a&&(ue=document.createElement("div"),ue.className="WACDialogLearnMoreLinkContainer",Dd.TY=document.createElement("a"),Dd.TY.innerText=Dd.u9a,Dd.TY.href=Dd.WCb,Dd.TY.target="_blank",Dd.TY.id=Dd.vi("LearnMoreLinkId"),Dd.TY.className=
$a.AFrame.jte,ue.appendChild(Dd.TY),na?Dd.Pb.insertBefore(ue,Dd.Pb.lastChild):Dd.Pb.appendChild(ue),Dd.UX(String.format("{0} {1}",Dd.vi("message"),Dd.vi("LearnMoreLinkId"))));Dd.Cjb=Qb;Xa?Dd.jA(Dd.hC):Dd.jA(Dd.Cjb);Dd.Ypf();be.AFrameworkApplication.sa.gY.qa(Bf.a.click,Dd.Cjb,Object(Vf.a)(Dd,Dd.lNe,"downloadLinkClicked"),null);Dd.TY&&be.AFrameworkApplication.sa.gY.qa(Bf.a.click,Dd.TY,Object(Vf.a)(Dd,Dd.Dlc,"learnMoreLinkClicked"),null);Dd.BTb=!1;return Dd}function Je(K,na){this._url=K;this.lxg=na}
function lf(K){return Ab.call(this,K)||this}function vf(K){this.Ki=K}function se(K){var na=cg.call(this)||this;na.$=K;na.Xb();return na}function wf(){}function Uf(){this.tb=null}function Wf(K){this.yMa=this.Jbb=null;this._initialized=!1;this.Fnd=K}function Tf(){this.tb=null}function ug(K,na,Xa,Qb,tc,md){na=eg.call(this,na,Xa,Qb,tc,md)||this;na.La=K;return na}function Le(K,na,Xa,Qb,tc,md,Dd){na=Ed.call(this,na,Xa,Qb,tc,md,Dd)||this;na.Asg=K;return na}function Qd(K,na,Xa,Qb){K=Md.call(this,K,na,Xa,
Qb)||this;K.gxg=na;return K}function Of(K){var na=Di.call(this)||this;na.lc=1;na.Bc(1,CommonUIStrings.l_RetryButtonLabel);na.Bc(0,CommonUIStrings.l_DialogClose);na.La=K;return na}function Ee(K,na,Xa){this.La=K;this.AY=na;this.Znb=Xa}function Eg(K,na,Xa,Qb){var tc=Ph.call(this)||this;tc.E9=null;tc.lUb=null;tc.La=K;tc.AY=na;tc.Znb=Xa;tc.Bc(1,CommonUIStrings.l_SaveButtonLabel);tc.ig=lg.ig;tc.Ve="FileNameDialog-SaveACopy";tc.Oh=Qb;return tc}function lg(){}function Ef(){this.tb=null}function eg(K,na,Xa,
Qb,tc){this.E9=this.Em=this.LDa=null;this.sEa=!1;this.Oh=this.vha=null;this.kVc=K;this.Dmb=na;this.$s=Xa;this.jf=Qb;this.Ih=tc}function Na(K){this.vb=K;this.oGa=K.appSettings.SkyDriveUploadWebServiceBase;this.IA=K.appSettings.FileName;this.vga=K.Wa("SkyDriveUploadHandler")||"skydriveuploadhandler.ashx"}function Ib(K,na,Xa,Qb,tc,md,Dd){this.nGa=K;this.IA=na;this.jXa=Xa;this.lUb=Qb;this.ORc=tc;this.vga=md;this.Oh=Dd}function vc(K,na,Xa){this.La=K;this.W2=na;this.AY=Xa}function Yc(K,na,Xa){var Qb=rh.call(this)||
this;Qb.La=K;Qb.W2=na;Qb.AY=Xa;Qb.cw=!1;Qb.lc=1;Qb.Boa(1);Qb.Bc(1,CommonUIStrings.l_SignIn);Qb.Bc(0,CommonUIStrings.l_SignInToSaveDialogCancelButton);return Qb}function Md(K,na,Xa,Qb){this.vXb=null;this.rzg=K;this.vb=Xa;this.tge=na;this.Tde=new Gg.a;this.Ih=Qb}function Ed(K,na,Xa,Qb,tc,md){this.Oh=null;this.nAg=K;this.W2=na;this.Znb=Xa;this.vb=Qb;this.bSb=tc;this.$s=md}function ke(){}function mc(){var K=oe.call(this)||this;K.lc=0;K.Bc(1,CommonUIStrings.l_DialogClose);return K}function Rc(){this.ysa=
this.cQc=this.YPc=this.tb=null}function nd(K,na,Xa,Qb,tc){this.Em=this.LDa=null;this.hHc=!1;this.PSc=this.E9=null;this.kVc=na;this.Dmb=Xa;this.$s=Qb;this.jf=tc;this.La=K}function Td(K){this.oGa=K.appSettings.SaveAsToHostWebServiceBase;this.IA=K.appSettings.FileName;this.vga=K.Wa("SharePointSaveAsHandler")||"sharepointsaveashandler.ashx"}function Fe(K,na,Xa,Qb,tc,md,Dd,ue){this.nGa=K;this.IA=na;this.jXa=Qb;this.ORc=md;this.E9=Xa;this.uAg=tc;this.vga=Dd;this.Oh=ue}function fe(K,na,Xa,Qb){this.Oh=this.vfe=
null;this.gGa=K;this.$s=na;this.MQc=Xa;this.jf=Qb}function ef(K,na,Xa,Qb,tc,md,Dd){this.vb=K;this.PKc=Xa;this.La=na;this.dnb=Qb;this.Zjb=tc;this.MQc=md;this.eqg=Dd}function If(){return sg.call(this)||this}function Ke(K,na,Xa,Qb){var tc=this;this.Ro=this.bmb=null;this.Zjb=K;this.jf=Xa;this.Jxg=Qb;this.CEa=new mf.a(function(){return new Ih.a(na.value,Object(Vf.a)(tc,tc.uxb,"getMoreInfoEventReceived"))})}function ng(K,na,Xa,Qb,tc,md,Dd,ue,Ce,Kf){this.La=na;this.vb=K;this.AY=Qb;this.wha=md;this.$s=tc;
this.jf=Xa;this.Bje=Dd;this.Rvg=void 0===ue?null:ue;this.gGa=void 0===Ce?null:Ce;this.aZa=void 0===Kf?null:Kf}function rf(K,na,Xa,Qb,tc,md,Dd,ue,Ce){this.aPc=null;this.IA="";this.dnb=K;this.$s=na;this.Oh=Ce;this.wha=Xa;this.jf=tc;this.$v=Qb;this.gGa=Dd;this.aZa=ue;md&&(this.aPc=new mf.a(function(){return new Ih.a(md.value,null)}))}function dg(){this.properties=this.friendlyPath=this.folderName=null}function qf(){this.extension=this.fileName=null;this.enableMoreLocations=!1;this.saveLocations=this.scenario=
null}function $g(K,na,Xa,Qb,tc,md,Dd,ue){K=Dc.call(this,K,na,Xa,Qb,tc,md,ue)||this;K.iz=null;K.TSc=null;K.mra=null;K.KWg=CommonUIStrings.l_SaveToAnotherFolder;K.ig=nf.ig;K.Ve="FileNameDialog-SaveToSharePoint";K.dnb=Dd;K.nxg=ue;return K}function nf(){}function Qe(){var K=Qg.call(this)||this;K.lc=0;K.Bc(1,CommonUIStrings.l_DialogClose);return K}function fh(){this.tb=null}function Rg(K,na,Xa,Qb,tc,md,Dd,ue){this.Em=null;this.uYa=this.sEa=!1;this.vha=this.Oh=this.IA=null;this.vb=na;this.nGa=this.vb.appSettings.SaveAsToHostWebServiceBase;
this.mbe=Qb;this.Dmb=tc;this.Yg=Xa;this.$s=md;this.Ih=ue;this.jf=Dd;this.La=K;this.vga=na.Wa("SaveAsToHostUploadHandler")||"hostuploadhandler.ashx"}function ah(K,na,Xa){this.wha=Xa;this.PKc=na;this.vb=K}function pg(K,na,Xa,Qb,tc,md){this.La=na;this.vb=K;this.AY=Qb;this.wha=md;this.$s=tc;this.jf=Xa}function Ga(K,na,Xa,Qb,tc,md){K=Dc.call(this,K,na,Xa,Qb,tc,md)||this;K.ig=Hb.ig;K.Ve="FileNameDialog-SaveAsToHost";return K}function Hb(){}function Dc(K,na,Xa,Qb,tc,md,Dd){Dd=void 0===Dd?null:Dd;var ue=
Dg.call(this)||this;ue.GJ=null;ue.La=na;ue.AY=Qb;ue.wha=md;ue.vb=K;ue.$s=tc;ue.jf=Xa;ue.Tjb=ue.vb.ra("SaveToHostWithExtraCharsInFileName");ue.Oh=Dd;ue.Bc(1,CommonUIStrings.l_SaveButtonLabel);return ue}function Bd(K,na){this.vb=K;this.La=na;this.Tjb=this.vb.ra("SaveToHostWithExtraCharsInFileName")}function Fd(K,na){var Xa=Ag.call(this)||this;Xa.uYa=!1;Xa.IA=null;Xa.La=K;Xa.Tjb=na;Xa.FTa=!1;return Xa}function Be(){this.tb=null}function Me(K){this.gm=null;this.Yg=K;this.pSc=3}function sf(K,na,Xa,Qb){na=
cb.call(this,K,na,Xa,Qb)||this;na.options.advanced.filter=K.Wa("OneDriveApiV72Filter")||"folder,photo";na.options.advanced.linkType="download";na.options.multiSelect=be.AFrameworkApplication.eue;K.ra("OneDriveApiV72CommandModeEnabled")&&(na.options.commandMode=K.Wa("OneDriveApiV72CommandMode")||"none");K.ra("OneDriveApiV72QosExtraDataEnabled")&&(na.options.qosExtradata=new Qa(be.AFrameworkApplication.userSessionId));return na}function Qa(K){this.olsSessionId=this.value=this.key=null;this.olsSessionId=
K}function cb(K,na,Xa,Qb){na=bd.call(this,K,na,Xa,Qb)||this;na.Tog=K;na.options={};na.options.advanced={};na.options.action="query";na.options.clientId=na.ha.Wa("OneDriveApiV72ClientId");na.options.advanced.trapFocus=!0;return na}function bc(K,na,Xa,Qb,tc){K=bd.call(this,K,na,Xa,Qb)||this;K.sge=null;K.zUb=null;K.$rg=tc;K.options={};K.options.clientId=K.ha.Wa("OneDriveApiV7ClientId");K.options.cancel=Object(Vf.a)(K,K.xCc,"toggleHostDivVisibility");return K}function yc(K,na,Xa,Qb,tc,md){na=bd.call(this,
na,Xa,Qb,md)||this;na.Oh=null;na.W2=K;na.hAg=tc;return na}function bd(K,na,Xa,Qb){this.tFa=this.c7=null;this.lTc=this.nTc=!1;this.tYa=null;this.vb=K;this.bSb=na;this.$Ea=Xa;this.$s=Qb}function Kd(){}function de(){var K=Nh.call(this)||this;K.lc=0;K.Bc(1,CommonUIStrings.l_DialogClose);return K}function Re(){}function ce(K,na,Xa,Qb){this.Yjb=K;this.Qra=na;this.P2=Xa;this.mtg=Qb}function Jb(K,na,Xa,Qb,tc,md,Dd){var ue=this;this.Ro=null;this.Oje=!1;this.gra=this.f6d=0;this.Mwg=K;this.rYa=na;this.aWb=Xa;
this.Yjb=Qb;this.Qra=tc;this.P2=md;this.CEa=new mf.a(function(){return new Ih.a(Dd.value,Object(Vf.a)(ue,ue.uxb,"getMoreInfoEventReceived"))})}function Mc(K,na,Xa,Qb,tc,md,Dd,ue){var Ce=this;this.nIc=null;this.BVc=!0;this.sSb="";this.KBg=0;this.aYa=null;this.LOc=3;this.vb=ue;this.P2=K;this.tj=na;this.Bsg=Xa;this.Hpg=Qb;this.Gpg=tc;this.CEa=new mf.a(function(){return new Ih.a(md.value,null)});this.ntg=new mf.a(function(){return new Ih.a(Dd.value,Object(Vf.a)(Ce,Ce.RGi,"mruEventResultReceived"))});
this.vb.ra("WacInTabOpenMRUIsEnabledForUiHost");this.vb.ra("UiHostSupportsDocRebootFeatures")}function ld(){return Jg.call(this)||this}function fg(K,na,Xa,Qb,tc,md){var Dd=this;this.EUc=this.Ro=this.tSb=null;this.mYb=this.JTc=!1;this.Kee=0;this.xTc=this.RNc=!1;this.P2=K;this.Yjb=na;this.CEa=new mf.a(function(){return new Ih.a(Xa.value,Object(Vf.a)(Dd,Dd.uxb,"getMoreInfoEventReceived"))});this.Dwg=Qb;this.Qra=tc;this.Zzg=md;this.onb=this.Dzc;2===this.yL.Xca&&(this.xTc=!0)}function Se(){this.folderName=
this.folderUrl=this.hostName=this.hostUrl=null}function tf(){}function af(){}b.r(F);var Pf=b(556),Sd=b(0),Mf=b(254);af.prototype.hi=function(){};af.prototype.init=function(){};af.prototype.dispose=function(){};af.main=function(){Mf.a.instance.nj(new af)};uk.Object.defineProperties(af.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.DialogWithLinkToResource"}}});Object(Sd.a)(af,"CommonAppDialogWithLinkToResourcePackage",null,[4,5]);var mf=b(613),ud=b(13),Vf=b(82),Ih=
b(1019),Cf=b(28),ye=b(130);tf.eph=function(K){return tf.Lye("New",K)};tf.fph=function(K){return tf.Lye("Open",K)};tf.uye=function(K,na){return tf.ria("LoadingMenuSection",tf.ryi,K,tf.Rqb("lblLoading",na))};tf.Sqb=function(K,na,Xa,Qb){return tf.ria("MessageMenuSection",tf.Wuf,na,tf.Rqb("lblMessage",K,void 0===Xa?null:Xa,void 0===Qb?null:Qb))};tf.dVg=function(K){return tf.uye(K,CommonUIStrings.l_VoicedLoadingText)};tf.eVg=function(K,na){return tf.Sqb(CommonUIStrings.l_NewCreationLocationMessage,K.Ii,
na.PS,na.ipa)};tf.cVg=function(K,na){return tf.Sqb(String.format(CommonUIStrings.l_NewProvisioningStorageMessage,na.ipa,"\n\n"),K.Ii)};tf.wye=function(K){return tf.Sqb(CommonUIStrings.l_NewGenericErrorMessage,K.Ii)};tf.aVg=function(K,na,Xa){return tf.ria("menuNewBlank",tf.mai,Xa?K.Ii:null,tf.Mqb(K.Taf,K.Uaf,K.Vaf,null,K.gla,K.ozb,na,"blank"))};tf.bWg=function(){return tf.Rqb("lblTemplatesLoading",CommonUIStrings.l_VoicedLoadingText)};tf.Gye=function(){return tf.Rqb("lblTemplatesError",CommonUIStrings.l_NewTemplateErrorMessage)};
tf.cWg=function(K,na){return tf.ria("menuNewTemplates",K,null,na)};tf.ZUg=function(K,na){return tf.ria("menuNewMoreTemplates",tf.RYe,null,tf.Mqb("menuNewMoreTemplatesButton",CommonUIStrings.l_NewMoreTemplates,CommonUIStrings.l_NewMoreTemplates,null,null,null,K,na))};tf.cUg=function(K,na,Xa){var Qb="";Xa&&na&&(Qb=tf.ria("BrowseMoreMenuSection",tf.RYe,null,tf.Mqb("btnBrowseMore",na,na,null,null,null,K||"1959943459",Xa)));return Qb};tf.Rqb=function(K,na,Xa,Qb){Xa=void 0===Xa?null:Xa;var tc=Qb=void 0===
Qb?null:Qb;na&&0<na.length&&(tc=tf.Qvf.Xrc(na).trimEnd(),tc=0<=tc.indexOf("{0}")?String.format(tc,Qb):String.format("{0} {1}",tc,Qb));Xa=Xa&&Qb?String.format('\r\n\t\t\t\t\tInnerLink="{0}"\r\n\t\t\t\t\tInnerLinkText="{1}"\r\n\t\t\t\t\tInnerLinkTitle="{2}"',Cf.a.sf(Xa),Cf.a.sf(Qb),Cf.a.sf(tc)):"";return String.format('\r\n\t\t\t\t<Label\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\t{2}/>',Cf.a.sf(K||""),tf.Qvf.Xrc(Cf.a.sf(na||"")),Xa)};tf.Mqb=function(K,na,Xa,Qb,tc,md,Dd,ue){return String.format('\r\n\t\t\t\t<Button\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\tDescription="{2}"\r\n\t\t\t\t\tImage{3}Class="{4}"\r\n\t\t\t\t\tImage{3}="{5}"\r\n\t\t\t\t\tCommand="{6}"\r\n\t\t\t\t\tMenuItemId="{7}"/>',
Cf.a.sf(K||""),Cf.a.sf(na||""),Cf.a.sf(Xa||""),Qb||"32by32",Cf.a.sf(tc||""),Cf.a.sf(md||""),Dd,Cf.a.sf(ue||""))};tf.Lye=function(K,na){return String.format('\r\n\t\t\t\t<Menu Id="menuJewel{0}">{1}\r\n\t\t\t\t</Menu>',K,na)};tf.ria=function(K,na,Xa,Qb){Xa=Xa?String.format('Title="{0}"',Cf.a.sf(Xa)):"";return String.format('\r\n\t\t\t\t<MenuSection\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tDisplayMode="{1}"\r\n\t\t\t\t\t{2}\r\n\t\t\t\t\tShowMenuSectionSeparator="false">\r\n\t\t\t\t\t<Controls>{3}\r\n\t\t\t\t\t</Controls>\r\n\t\t\t\t</MenuSection>',
Cf.a.sf(K||""),Cf.a.sf(na||""),Xa,Qb)};tf.Wuf="MenuMru";tf.ryi="MenuLoading";tf.mai="MenuHeader";tf.RYe="MenuFooter";tf.Qvf=ye.a.$x("\n","&#10;");Object(Sd.a)(tf,"NewAndOpenXmlUtilities",null,[]);var be=b(4),Pg=b(99),We=b(174);Object(Sd.a)(Se,"HostInformation",null,[]);var Zh=b(107),hh=b(37),rg=b(390),th=b(166),Oh=b(739),Xg=b(638),Sg=b(105),gg=b(26);fg.prototype.Sg=function(){var K=this.yL.s$a;K.ic(gg.a.newDocument,Sg.a.frame,Object(Vf.a)(this,this.newDocument,"newDocument"));K.gf(gg.a.qsc,Sg.a.frame,
Object(Vf.a)(this,this.qsc,"populateNewMenu"),96)};fg.prototype.newDocument=function(K,na,Xa,Qb,tc){return 1===Xa?32:2===Xa&&tc&&tc.MenuItemId&&tc.SourceControlId?this.a2a(tc.MenuItemId,tc.SourceControlId):8};fg.prototype.a2a=function(K,na){var Xa=this.Wnc.N6c;if(null===Xa)return 8;var Qb=be.AFrameworkApplication.ha.ra("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");if(be.AFrameworkApplication.Zla&&Qb){ud.ULS.sendTraceTag(51455198,202,50,"CreateNewActor.CreateNewDocument: Sending CreateNewDocument post message.");
var tc={};tc[rg.a.Ifb]=K;tc[rg.a.yQ]=this.yQ;tc[rg.a.lcid]=be.AFrameworkApplication.lcid.toString();tc[rg.a.reason]=Oh.a.createNew;be.AFrameworkApplication.jW().execute(function(md){md.Nj(th.a.a2a,tc)})}else Qb=(new Date).getTime(),na=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&or=wacFileNew&bid={6}&Canary={7}&{8}",Xa,Cf.a.rf(this.Lma),Cf.a.rf(K),Cf.a.rf(this.yQ),Cf.a.rf(be.AFrameworkApplication.lcid.toString()),Cf.a.rf(Qb.toString()),Cf.a.rf(na),Cf.a.rf(be.AFrameworkApplication.canary),
be.AFrameworkApplication.uj),(Xa=be.AFrameworkApplication.ha.Wa("ScenarioId"))&&""!==Xa&&(na+="&wdscenarioid="+Cf.a.rf(Xa)),na+="&"+be.AFrameworkApplication.bec(),be.AFrameworkApplication.bya&&(na+="&"+be.AFrameworkApplication.rdc()),(Xa=this.Ro?this.Ro.PS:null)&&(na+="&DestinationUrl="+Cf.a.rf(Xa)),hh.a.wf(na,"_blank",void 0,"CreateNewDocument");2===this.yL.Xca&&(na={},ud.ULS.sendTraceTag(24700384,202,50,"CreateNewDocument from New Menu {0}",(na.AppType=Xg.a[this.yL.Xca],na.Template=K,na)));return 32};
fg.prototype.rBi=function(K){var na=Number.MAX_VALUE,Xa=Number.MIN_VALUE,Qb=window.performance;if(Qb&&"undefined"!==typeof Qb.getEntriesByName){for(var tc=0;tc<K.length;tc++){var md=Qb.getEntriesByName(K[tc]);md&&0<md.length&&(md=md[0],na=Math.min(parseInt(String(md.fetchStart)),na),Xa=Math.max(parseInt(String(md.responseEnd)),Xa))}Xa>na&&(K={},ud.ULS.sendTraceTag(5849601,202,50,"Total time to download template thumbnails {0}",(K.TotalElapsedMs=Xa-na,K.MinFetchStart=na,K.MaxResponseEnd=Xa,K)))}};
fg.prototype.qsc=function(K,na,Xa,Qb,tc){if(1===Xa)return this.xTc&&(be.AFrameworkApplication.kO("Microsoft.Office.Server.Powerpoint.Web.IPptMoreThemesInNewMenuSettings"),this.xTc=!1),32;2!==Xa||this.RNc||(this.Kee=(new Date).getTime(),K={},ud.ULS.sendTraceTag(5849602,202,50,"File New menu flyout opened by user {0}",(K.ShouldShowTemplates=this.Dzc,K.CachedNewMenuXmlExists=!!this.tSb,K.ShouldCallGetMoreInfo=this.yL.supportsGetMoreInfoForPersonalStorage,K)));return this.S3i(tc)};fg.prototype.S3i=function(K){K&&
(this.tSb?K.PopulationXML=this.tSb:(this.yL.supportsGetMoreInfoForPersonalStorage&&!this.Ro&&this.lIi.Kz("Opened New menu",!0),K.PopulationXML=this.oNh(this.getTemplateListJson())));return 32};fg.prototype.nkf=function(){return!this.yL.supportsGetMoreInfoForPersonalStorage||!!this.Ro&&3===this.Ro.state&&!!this.Ro.ipa&&!!this.Ro.PS};fg.prototype.Gqi=function(){return be.AFrameworkApplication.sa&&be.AFrameworkApplication.sa.Qa.W_?!0:this.nkf()};fg.prototype.getTemplateListJson=function(){var K=this;
if(!this.Dzc||!this.Gqi())return null;if(this.onb&&!this.mYb){var na="9",Xa=be.AFrameworkApplication.ha.appSettings;"NumberOfTemplatesInBackstage"in Xa&&(na=Xa.NumberOfTemplatesInBackstage);var Qb=this.yQ;"TemplateCollectionId"in Xa&&(Qb=Xa.TemplateCollectionId);na=String.format(this.yL.ZW+"TemplateServiceProxy.ashx?lcid={0}&apps={1}&show={2}",Cf.a.rf(be.AFrameworkApplication.lcid.toString()),Cf.a.rf(Qb),na);Boolean.parse(Xa.AppendOriginQueryParam||"false")&&(na+="&org=backstage");na+="&"+be.AFrameworkApplication.bec();
be.AFrameworkApplication.bya&&(na+="&"+be.AFrameworkApplication.rdc());this.yL.zEb.jm(na,1,null,null,!1,2,function(tc){K.yL.Oca("CreateNewActor.GetTemplateListJson",tc.data);K.ZNj(tc.data.oe)},function(tc){K.yL.Oca("CreateNewActor.GetTemplateListJson",tc.data);K.YNj()},null,void 0,void 0,void 0,void 0,"5");this.onb=!1}return this.EUc};fg.prototype.ZNj=function(K){this.EUc=K;this.onb=!1;this.EIb();if(be.AFrameworkApplication.sa&&be.AFrameworkApplication.sa.Qa.W_&&We.c()){K=be.AFrameworkApplication.ha.ra("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");
var na=be.AFrameworkApplication.Zla;appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson(this.EUc,!0,K&&na))}};fg.prototype.YNj=function(){this.mYb=this.onb=!0;this.EIb();be.AFrameworkApplication.sa&&be.AFrameworkApplication.sa.Qa.W_&&We.c()&&appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson("",!1,!1));Pg.Health.instance.recordQosError("TemplateServiceReturnedFailure",["TemplateServiceFailed"],!1,!0,!0,!1,null)};fg.prototype.d4h=function(K){for(var na=0,Xa=0;Xa<K.length;Xa++)if("ST"===
K[Xa].ImageType){na=Xa;break}var Qb=K.length?K[na]:null;K=Qb?Qb.Url||"":"";var tc,md=Xa=na=!1;if(Qb&&(tc=Qb.AspectRatio))tc=parseFloat(tc),1>tc?na=!0:1.5<tc?Xa=!0:1===tc&&(md=!0);else switch(tc={},ud.ULS.sendTraceTag(5849603,202,10,"Thumbnail aspect ratio missing {0}",(tc.Url=K,tc)),this.yL.Xca){case 3:na=!0;break;case 2:Xa=!0;break;case 5:md=!0}return{returnValue:K,Oci:na?"95by123":Xa?"123by69":md?"100by100":"123by95"}};fg.prototype.oNh=function(K){var na=this.bVg(K,this.Wnc,this.Wnc.HHa||"1056925771");
K=na.returnValue;if(na.fzc){this.tSb=K;na=(new Date).getTime()-this.Kee;var Xa={};ud.ULS.sendTraceTag(5849604,202,50,"New menu rendering completed by GenerateXMLFromJSON {0}",(Xa.ElapsedMsSinceMenuOpened=na,Xa))}return K};fg.prototype.uxb=function(K,na){ud.ULS.sendTraceTag(590964757,202,50,"GetMoreInfoEventReceived");this.Ro||3!==K.state?2===K.state&&(ud.ULS.sendTraceTag(590964759,202,50,"GetMoreInfoResult was bad, need to retry"),this.JTc=!0,this.EIb()):(this.Ro=K,na||this.EIb(),be.AFrameworkApplication.sa&&
be.AFrameworkApplication.sa.Qa.W_&&We.c()&&We.d("setFileMenuHostInformation")&&(K=Object.assign(new Se,{hostUrl:this.Ro.PS,hostName:this.Ro.ipa,folderUrl:be.AFrameworkApplication.breadcrumbFolderUrl,folderName:be.AFrameworkApplication.breadcrumbFolderName}),ud.ULS.sendTraceTag(590964758,202,50,"Sending HostInformation to FileMenu"),appChrome.api.dispatch(appChrome.actions.setFileMenuHostInformation(K))))};fg.prototype.bVg=function(K,na,Xa){var Qb=!1;var tc=this.nkf(),md="";if(this.yL.supportsGetMoreInfoForPersonalStorage)if(this.JTc)md=
tf.wye(na),this.JTc=!1,ud.ULS.sendTraceTag(5849605,202,10,"Rendering File>New with error message due to GetMoreInfo request failure");else if(this.Ro)if(tc)md=tf.eVg(na,this.Ro);else if(this.Ro.Zhi)Qb=!0,this.onb=!1,md=tf.cVg(na,this.Ro),ud.ULS.sendTraceTag(5849607,202,50,"Rendering File>New with personal storage instantiation message");else{Qb=!0;md=tf.wye(na);var Dd={};ud.ULS.sendTraceTag(5849608,202,10,"Rendering File>New with error message due to GetMoreInfo invalid response. {0}",(Dd.PersonalFileStorageUrlIsSet=
!!this.Ro.PS,Dd.StorageServiceDisplayNameIsSet=!!this.Ro.ipa,Dd))}else md=tf.dVg(na.Ii),ud.ULS.sendTraceTag(5849606,202,50,"Rendering File>New with loading spinner");tc&&(tc=md,na=tf.aVg(na,Xa,!md),K=this.aWg(K,Xa),Qb=K.fzc,md=tc+(na+K.returnValue));return{returnValue:tf.eph(md),fzc:Qb}};fg.prototype.aWg=function(K,na){var Xa=!1;if(!this.Dzc)return Xa=!0,ud.ULS.sendTraceTag(5849609,202,50,"Rendering File>New without template buttons due to BRS"),{returnValue:"",fzc:Xa};var Qb="",tc="",md="MenuTemplate";
if(this.mYb)Qb=tf.Gye(),this.mYb=!1,ud.ULS.sendTraceTag(5849610,202,10,"Rendering File>New with template error message");else if(K){try{var Dd=Sys.Serialization.JavaScriptSerializer.deserialize(K,!0);Qb=this.$Vg(Dd,na);ud.ULS.sendTraceTag(5849612,202,50,"Rendering File>New with template buttons");be.AFrameworkApplication.Rvf&&"OneDrive"===this.Lma&&(tc=tf.ZUg(this.mIi,be.AFrameworkApplication.Rvf))}catch(ue){na={},ud.ULS.sendTraceTag(5849613,202,10,"Failed to parse JSON response from template service {0}",
(na.JsonToConvert=K,na)),Qb=tf.Gye()}Xa=!0}else md="MenuLoading",Qb=tf.bWg(),ud.ULS.sendTraceTag(5849611,202,50,"Rendering File>New with template loading spinner");return{returnValue:tf.cWg(md,Qb)+tc,fzc:Xa}};fg.prototype.$Vg=function(K,na){for(var Xa=this,Qb="",tc=[],md=0;md<K.length;md++){var Dd=K[md],ue="";if(Dd){var Ce=Dd.Title,Kf=Dd.AssetId,Wg=Dd.Thumbnails;Kf&&Ce&&Wg&&(Dd=void 0,ue=this.d4h(Wg),Dd=ue.Oci,ue=ue.returnValue,Qb+=tf.Mqb("jbtnNewTemplate"+md,Ce,null,Dd,null,ue,na,Kf))}tc[md]=ue}K=
new Zh.a(4,1,5E3,function(){Xa.rBi(tc)},106);this.yL.Unc.$g(K);return Qb};fg.prototype.EIb=function(){this.RNc=!0;this.yL.Jvf.Vv(this.Wnc.Rvb);this.RNc=!1};uk.Object.defineProperties(fg.prototype,{yQ:{configurable:!0,enumerable:!0,get:function(){switch(this.yL.Xca){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}},yL:{configurable:!0,enumerable:!0,get:function(){return this.P2.value}},Wnc:{configurable:!0,enumerable:!0,get:function(){return this.Yjb.value}},
lIi:{configurable:!0,enumerable:!0,get:function(){return this.CEa.value}},mIi:{configurable:!0,enumerable:!0,get:function(){return this.Dwg.value}},Lma:{configurable:!0,enumerable:!0,get:function(){return this.Qra.value}},Dzc:{configurable:!0,enumerable:!0,get:function(){return this.Zzg.value}}});Object(Sd.a)(fg,"CreateNewActor",null,[]);var di=b(1384),Jg=di.a;Am(ld,Jg);ld.prototype.nqe=function(){this.FU(0,CommonUIStrings.l_OpenMenuEmptyMruMessage);this.FU(1,CommonUIStrings.l_OpenMenuServerErrorMessage);
this.FU(2,CommonUIStrings.l_Open);this.FU(3,CommonUIStrings.l_OpenMenuRecentDocuments);this.FU(4,CommonUIStrings.l_OpenMenuMoreOnHost);this.FU(5,CommonUIStrings.l_VoicedLoadingText)};ld.H_i=function(K){return ld.instance.fa(K)};uk.Object.defineProperties(ld,{instance:{configurable:!0,enumerable:!0,get:function(){return ld.Na||(ld.Na=new ld)}}});ld.Na=null;Object(Sd.a)(ld,"MruActorIntlHelper",di.a,[]);var Mh;(function(K){K[K.success=0]="success";K[K.failure=1]="failure";K[K.spinner=2]="spinner";K[K.none=
3]="none"})(Mh||(Mh={}));Object(Sd.b)("DisplayState",Mh);var $h=b(40);Mc.prototype.RGi=function(K,na){this.aYa=K;na||this.PRf()};Mc.prototype.rdj=function(){this.cx.s$a.gf(gg.a.psc,Sg.a.frame,Object(Vf.a)(this,this.psc,"populateMruMenu"),96)};Mc.prototype.psc=function(K,na,Xa,Qb,tc){return 1!==Xa&&tc?this.P3i(tc):32};Mc.prototype.P3i=function(K){this.Kph();this.Jph();K.PopulationXML=tf.fph(this.sSb+this.nIc);return 32};Mc.prototype.Kph=function(){var K=3,na=!1;if(this.sSb&&this.KBg===this.aYa.JPj)K=
{},ud.ULS.sendTraceTag(5849627,202,50,"Open menu MRU entries to XML conversion not required {0}",(K.CacheRefresh="Not Dirty",K)),K=this.LOc;else{var Xa={};ud.ULS.sendTraceTag(5849628,202,50,"Open menu MRU entries to XML conversion started {0}",(Xa.CacheRefresh="Starting",Xa));Xa=this.cx.Hw();this.aYa=this.QGi.Kz("File Open opened",!0);if(this.sSb&&2!==this.LOc&&3!==this.aYa.state)na=!0;else{K=this.Z1h(this.aYa);be.AFrameworkApplication.sa&&be.AFrameworkApplication.sa.Qa.W_&&We.c()&&K&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(K,
!0));var Qb=this.pNh(this.aYa);K=Qb.dIi;this.sSb=Qb.returnValue}Xa=this.cx.Hw()-Xa;Qb={};ud.ULS.sendTraceTag(5849629,202,50,"Open menu MRU entries to XML conversion ended {0}",(Qb.CacheRefresh="Complete",Qb.ElapsedMs=Xa,Qb))}2!==K&&(Xa={},Xa=(Xa.DisplayState=Mh[K],Xa),1!==K&&(Xa.IsStale=na),ud.ULS.sendTraceTag(5849630,202,50,"MRU section display state {0}",Xa));this.LOc=K};Mc.prototype.Z1h=function(K){try{var na=$h.c(K.eAd)}catch(Xa){na=null,ud.ULS.sendTraceTag(0,202,10,"MruActor.Serialize: Exception thrown from JsonSerializer.Serialize Exception: {0}",
Xa)}return na};Mc.prototype.Jph=function(){if(this.BVc){ud.ULS.sendTraceTag(5849632,202,50,"Open menu Browse More Link creation necessary.");var K=this.MCi();this.BVc=K.n1j;this.nIc=K.returnValue}else ud.ULS.sendTraceTag(5849631,202,50,"Open menu Browse More Link creation not required.");K={};ud.ULS.sendTraceTag(5849633,202,50,"Browse More link display state {0}",(K.WaitingOnLinkInfo=this.BVc,K.NotDisplayingLink=!this.nIc,K))};Mc.prototype.pNh=function(K){if(1===K.state||0===K.state){K={};ud.ULS.sendTraceTag(5849635,
202,50,"Open menu XML built {0}",(K.Display="Spinner",K));K=2;var na=tf.uye(this.Oka(2),this.Oka(5))}else 3===K.state&&K.eAd?(na=this.$Ug(K.eAd),K=0):(K={},ud.ULS.sendTraceTag(5849634,202,50,"Open menu XML built {0}",(K.Display="Server Error",K)),na=tf.Sqb(this.Oka(1),this.Oka(2)),K=1);return{returnValue:na,dIi:K}};Mc.prototype.$Ug=function(K){var na=this.ZDb.HHa||"2155708348";if(K.length){var Xa=tf.Rqb("lblRecentDocuments",this.Oka(3));for(var Qb=0,tc=0;tc<K.length;tc++){var md=K[tc];"FileName"in
md&&"DocumentUrl"in md&&"Path"in md&&(Xa+=tf.Mqb("MruButton"+tc,md.FileName.toString(),md.Path.toString(),null,this.ZDb.gla,this.ZDb.ozb,na,md.DocumentUrl.toString()),md.IsPinned&&Qb++)}Xa=tf.ria("RecentDocumentsMenuSection",tf.Wuf,this.Oka(2),Xa);na={};ud.ULS.sendTraceTag(5849665,202,50,"Open menu XML built {0}",(na.Display="MRU List",na.TotalDocuments=K.length,na.NumPinnedDocuments=Qb,na))}else Xa=tf.Sqb(this.Oka(0),this.Oka(2)),K={},ud.ULS.sendTraceTag(5849664,202,50,"Open menu XML built {0}",
(K.Display="Empty MRU",K));return Xa};Mc.prototype.MCi=function(){var K=!0;var na=this.vTg,Xa=this.uTg;if(na&&Xa||!this.cx.supportsGetMoreInfoForPersonalStorage)K=!1;else{var Qb=this.Bdc.Kz("File Open",!1);3===Qb.state&&(na=Qb.PS,Xa=Qb.ipa,K=!1)}Xa=Xa?String.format(this.Oka(4),Xa):null;return{returnValue:tf.cUg(this.ZDb.HHa,Xa,na),n1j:K}};Mc.prototype.PRf=function(){this.cx.Jvf.Vv(this.ZDb.Rvb)};uk.Object.defineProperties(Mc.prototype,{cx:{configurable:!0,enumerable:!0,get:function(){return this.P2.value}},
Oka:{configurable:!0,enumerable:!0,get:function(){return this.tj.value}},ZDb:{configurable:!0,enumerable:!0,get:function(){return this.Bsg.value}},vTg:{configurable:!0,enumerable:!0,get:function(){return this.Hpg.value}},uTg:{configurable:!0,enumerable:!0,get:function(){return this.Gpg.value}},Bdc:{configurable:!0,enumerable:!0,get:function(){return this.CEa.value}},QGi:{configurable:!0,enumerable:!0,get:function(){return this.ntg.value}}});Object(Sd.a)(Mc,"MruRenderer",null,[]);var zh=b(242),Eh=
b(977);Jb.prototype.a2a=function(){!this.Ro&&this.PAd.supportsGetMoreInfoForPersonalStorage?this.Bdc.Kz("NewDocumentFromStream",!0):this.createNewDocumentFromStream()};Jb.prototype.uxb=function(K){if(!this.Ro&&3===K.state)this.Ro=K;else if(2===K.state){this.Oje?ud.ULS.sendTraceTag(24904471,202,10,"After second try GetMoreResult still fail."):(this.Bdc.Kz("NewDocumentFromStream",!0),this.Oje=!0);return}this.createNewDocumentFromStream()};Jb.prototype.createNewDocumentFromStream=function(){this.f6d=
(new Date).getTime();var K=this.AFh.N6c;if(null===K)this.rYa(null);else{var na=this.aWb.menuItemId,Xa=this.aWb.hJ,Qb=this.aWb.GLj,tc=this.aWb.FFh;this.gra="streamBase64"===Qb?tc.length/1024:0;ud.ULS.sendTraceTag(35156358,202,50,"FileType:{0}, FileSize:{1}",this.yQ,this.gra);var md=(new Date).getTime();K=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&bid={6}&Canary={7}&{8}&sa={9}",K,Cf.a.rf(this.Lma),Cf.a.rf(na),Cf.a.rf(this.yQ),Cf.a.rf(be.AFrameworkApplication.lcid.toString()),
Cf.a.rf(md.toString()),Cf.a.rf(Xa),Cf.a.rf(be.AFrameworkApplication.canary),be.AFrameworkApplication.uj,Cf.a.rf(Qb));K+="&"+be.AFrameworkApplication.bec();be.AFrameworkApplication.bya&&(K+="&"+be.AFrameworkApplication.rdc());(na=this.Ro?this.Ro.PS:null)&&(K+="&DestinationUrl="+Cf.a.rf(na));this.PAd.zEb.jm(K,2,tc,{"Content-Type":"application/json; charset=utf-8"},!0,2,Object(Vf.a)(this,this.gIi,"newDocumentFromStreamSuccessHandler"),Object(Vf.a)(this,this.fIi,"newDocumentFromStreamFailureHandler"),
null,void 0,void 0,void 0,void 0,"31")}};Jb.prototype.gIi=function(K){if(K&&K.data&&K.data.oe){var na=$h.d(K.data.oe);var Xa=na.ev;na.returnValue?Xa.StatusCode!==zh.a.SP&&Xa.StatusCode!==zh.a.itb?(ud.ULS.sendTraceTag(24904475,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: StatusCode: {2}",this.yQ,this.gra,Xa.StatusCode),this.rYa(null)):Xa.NewDocumentUrl&&""!==Xa.NewDocumentUrl?(K=(new Date).getTime()-this.f6d,ud.ULS.sendTraceTag(35156359,202,50,"FileType:{0}, FileSize:{1}, TimeConsumed:{2}",
this.yQ,this.gra,K),this.Mwg(Xa.NewDocumentUrl)):(ud.ULS.sendTraceTag(24904476,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data do not have NewDocumentUrl.",this.yQ,this.gra),this.rYa(null)):(Xa={},ud.ULS.sendTraceTag(24904474,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Failed to deserialize: {2}",this.yQ,this.gra,(Xa.ResponseData=Eh.a.ngb(K.data.oe),Xa)),this.rYa(null))}else ud.ULS.sendTraceTag(24904473,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data is null",
this.yQ,this.gra),this.rYa(null)};Jb.prototype.fIi=function(K){K&&K.data&&ud.ULS.sendTraceTag(24904477,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: ErrorStatus: {2}",this.yQ,this.gra,K.data.status);this.rYa(null)};uk.Object.defineProperties(Jb.prototype,{yQ:{configurable:!0,enumerable:!0,get:function(){switch(this.PAd.Xca){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}},AFh:{configurable:!0,enumerable:!0,
get:function(){return this.Yjb.value}},Lma:{configurable:!0,enumerable:!0,get:function(){return this.Qra.value}},PAd:{configurable:!0,enumerable:!0,get:function(){return this.P2.value}},Bdc:{configurable:!0,enumerable:!0,get:function(){return this.CEa.value}}});Object(Sd.a)(Jb,"NewDocumentFromStreamOperation",null,[]);ce.prototype.create=function(K,na,Xa){return new Jb(K,na,Xa,this.Yjb,this.Qra,this.P2,this.mtg)};Object(Sd.a)(ce,"NewDocumentFromStreamOperationFactory",null,[709]);var Xh=b(84),Fh=
b(565),Kg=b(53);Re.prototype.hi=function(K){K.register(ce,"Common.App.NewAndOpen.UX.NewDocumentFromStreamOperationFactory").as("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory").Ic().Nc(function(){return new ce(new mf.a(function(){return be.AFrameworkApplication.sa.Qa.vhd()}),new mf.a(function(){return be.AFrameworkApplication.Lma}),new mf.a(function(){return K.Nh("Common.INewAndOpenCommonHelpers")}),new mf.a(function(){return K.Nh("Common.IEventEmitter<Common.IGetMoreInfoResult>")}))})};
Re.prototype.init=function(){var K=this;be.AFrameworkApplication.ha.tv(function(){K.Fzb()})};Re.prototype.Fzb=function(){var K=Fh.a.lr(Xh.a.instance.qc("Common.INewAndOpenCommonHelpers")),na=Fh.a.lr(Xh.a.instance.qc("Common.IEventEmitter<Common.IGetMoreInfoResult>"));be.AFrameworkApplication.Lma&&Kg.Task.WAA.call(null,K,na).continueWith(function(){var Qb=new fg(new mf.a(function(){return K.result}),new mf.a(function(){return be.AFrameworkApplication.sa.Qa.vhd()}),new mf.a(function(){return na.result}),
new mf.a(function(){return be.AFrameworkApplication.sa.Qa.whd().HHa||"1959943459"}),new mf.a(function(){return be.AFrameworkApplication.Lma}),new mf.a(function(){return be.AFrameworkApplication.ppi}));Qb.Sg();Qb.EIb()});if(be.AFrameworkApplication.pQf){var Xa=Fh.a.lr(Xh.a.instance.qc("Common.IEventEmitter<Common.IMruResult>"));Kg.Task.WAA.call(null,K,na,Xa).continueWith(function(){var Qb=new Mc(new mf.a(function(){return K.result}),new mf.a(function(){return ld.H_i}),new mf.a(function(){return be.AFrameworkApplication.sa.Qa.whd()}),
new mf.a(function(){return be.AFrameworkApplication.G_i}),new mf.a(function(){return be.AFrameworkApplication.F_i}),new mf.a(function(){return na.result}),new mf.a(function(){return Xa.result}),be.AFrameworkApplication.ha);Qb.rdj();Qb.PRf()})}};Re.prototype.dispose=function(){};uk.Object.defineProperties(Re.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.NewAndOpen.UX"}}});Object(Sd.a)(Re,"UXPackageManager",null,[4,5,3]);var Sh=b(133),Nh=Sh.StandardDialog;Am(de,Nh);
de.prototype.displayError=function(K){this.lA(K,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null)};de.prototype.B9c=function(K){this.lA(K,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null,!0)};Object(Sd.a)(de,"ErrorDialog",Sh.StandardDialog,[882]);var Gg=b(161);Kd.prototype.U_e=function(){ud.ULS.sendTraceTag(24134234,352,50,"Returning endpoint for ODC");var K=new Gg.a;K.setResult("api.onedrive.com");return K.task};Object(Sd.a)(Kd,"OneDriveConsumerEndpointHelper",
null,[725]);var vh=b(50),Hi=b(391),Tg=b(229);bd.prototype.u5a=function(){this.tYa||(this.tYa=this.Cab?Tg.a.create(this.Cab,null,null,null,!1):null);return this.tYa};bd.prototype.setup=function(K){var na=this;this.tFa=K;this.nTc||this.lTc?this.nTc&&this.tFa&&this.tFa(!0):(K=this.u5a())?(this.lTc=!0,K.z9a.continueWith(function(Xa){na.SUi(Xa)}),Hi.a.Bja(K)):(ud.ULS.sendTraceTag(20509837,352,15,"Failure with OneDrive API download as the onedrive url received is empty."),this.tFa(!1))};bd.prototype.YDd=
function(K){ud.ULS.sendTraceTag(20509838,352,15,"Failure during OneDrive API download: {0}",K.exception?K.exception.toString():"No error detail.")};bd.prototype.SUi=function(K){this.lTc=!1;if(K.og)this.YDd(K),this.tFa(!1);else try{this.nTc=!0,ud.ULS.sendTraceTag(17909022,352,50,"Initializing OneDrive API"),this.Yod(),ud.ULS.sendTraceTag(17909023,352,50,"OneDrive API is initialized."),this.tFa(!0)}catch(na){ud.ULS.sendTraceTag(20555412,352,10,"Failed during OneDrive API init: {0}",na.toString()),this.tFa(!1)}};
bd.prototype.startPicker=function(K){this.c7=K;this.$Ea?ud.ULS.sendTraceTag(23881878,216,50,"In limited edit mode, will not show Picker."):(ud.ULS.sendTraceTag(23881877,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(Vf.a)(this,this.sCd,"onApiReady")))};bd.prototype.sCd=function(K){K?this.Alc():this.zi()};bd.prototype.zi=function(){this.$s().displayError(vh.a.f_i)};bd.prototype.onSuccess=function(K){ud.ULS.sendTraceTag(17909057,352,50,"Success Callback called. Calling callback function.");
this.c7&&this.c7(!0,K)};bd.prototype.dispose=function(){this.tYa&&this.tYa.dispose()};uk.Object.defineProperties(bd.prototype,{Wte:{configurable:!0,enumerable:!0,get:function(){return this.bSb}},ha:{configurable:!0,enumerable:!0,get:function(){return this.vb}}});Object(Sd.a)(bd,"AOneDriveFilePickerApiManager",null,[369,3]);Am(yc,bd);yc.prototype.start=function(K,na){this.Oh=K;this.startPicker(na)};yc.prototype.Yod=function(){var K={},na={};K=1===this.Wte||2===this.Wte?(K.client_id=this.ha.appSettings.UploadToSkyDriveClientId,
K):(na.client_id=this.ha.appSettings.UploadToSkyDriveClientId,na.env="INT",na);WL.init(K)};yc.prototype.startPicker=function(K){this.c7=K;!this.$Ea&&this.W2.eNa?(ud.ULS.sendTraceTag(17909025,352,50,"User is signed in. We will show file picker."),this.setup(Object(Vf.a)(this,this.sCd,"onApiReady"))):(ud.ULS.sendTraceTag(17909026,352,50,"User is not signed in. show need to sign in dialog."),this.hAg())};yc.prototype.Alc=function(){try{ud.ULS.sendTraceTag(17909027,352,50,"Launching file dialogue"),WL.fileDialog(this.Oh).then(Object(Vf.a)(this,
this.onSuccess,"onSuccess"),Object(Vf.a)(this,this.b7,"onFailure"))}catch(K){ud.ULS.sendTraceTag(17909056,352,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",K,K.stack),this.zi()}};yc.prototype.b7=function(K){if(K&&K.error){if("user_canceled"===K.error.code){ud.ULS.sendTraceTag(17909058,352,50,"User canceled.");return}ud.ULS.sendTraceTag(17909059,352,50,"File Dialog returned with error code:{0}, and error message: {1}",K.error.code,K.error.message)}else ud.ULS.sendTraceTag(17909060,352,50,
"File Dialog returned with no response");this.c7&&this.c7(!1,K);this.zi()};uk.Object.defineProperties(yc.prototype,{Cab:{configurable:!0,enumerable:!0,get:function(){return this.ha.Wa("OneDriveApiUrl")}}});Object(Sd.a)(yc,"OneDriveFilePickerApiManagerV5",bd,[]);Am(bc,bd);bc.prototype.start=function(K,na){var Xa=this;this.zUb=na;var Qb=this.$rg.U_e();Qb.continueWith(function(){ud.ULS.sendTraceTag(24134241,352,50,"Fetch endpoint task completed, attempting to start OneDrive picker");Xa.sge=Qb.result;
Xa.startPicker(function(tc,md){Xa.xCc();K(tc,md)})},3);Qb.continueWith(function(){ud.ULS.sendTraceTag(24134242,352,15,Qb.exception.message);Xa.xCc()},5)};bc.prototype.Yod=function(){var K=this;this.options.success=function(na){var Xa={};Xa.data=na;K.onSuccess(Xa)};this.options.error=function(na){var Xa={};Xa.error=na;K.b7(Xa)};this.options.advanced={};this.options.advanced.linkType="share";this.options.advanced.endpointHint=this.sge;this.options.advanced.iframeParentDiv=this.zUb};bc.prototype.Alc=
function(){try{ud.ULS.sendTraceTag(22090007,352,50,"Launching OneDrive file picker dialog"),this.xCc(),OneDrive.open(this.options)}catch(K){ud.ULS.sendTraceTag(22090008,352,10,"Opening OneDrive file picker threw an exception: {0}",K.message),this.zi()}};bc.prototype.b7=function(K){this.c7&&this.c7(!1,K);this.zi()};bc.prototype.xCc=function(){this.zUb.style.visibility="hidden"===this.zUb.style.visibility?"":"hidden"};uk.Object.defineProperties(bc.prototype,{Cab:{configurable:!0,enumerable:!0,get:function(){return this.ha.Wa("OneDriveApiV72Url")}}});
Object(Sd.a)(bc,"OneDriveFilePickerApiManagerV7",bd,[]);Am(cb,bd);cb.prototype.start=function(K,na,Xa,Qb){this.options.advanced.iframeParentDiv=Xa;this.options.advanced.endpointHint=Qb;this.options.cancel=na;this.Tog.ra("OneDriveApiV72RecentsViewEnabled")&&(this.options.advanced.navigation={},this.options.advanced.navigation.entryLocation={},this.options.advanced.navigation.entryLocation.oneDrive={},this.options.advanced.navigation.entryLocation.oneDrive.recent={});this.startPicker(K)};cb.prototype.startPicker=
function(K){this.c7=K;this.$Ea?ud.ULS.sendTraceTag(24391838,216,50,"In limited edit mode, will not show Picker."):(ud.ULS.sendTraceTag(24391837,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(Vf.a)(this,this.sCd,"onApiReady")))};cb.prototype.Yod=function(){var K=this;this.options.success=function(na){var Xa={};Xa.data=na;K.onSuccess(Xa)};this.options.error=function(na){var Xa={};Xa.error=na;K.b7(Xa)}};cb.prototype.Alc=function(){try{ud.ULS.sendTraceTag(23881879,216,50,
"Launching OneDrive file picker dialog"),OneDrive.save(this.options)}catch(K){ud.ULS.sendTraceTag(23881880,216,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",K.message,K.stack),this.zi()}};cb.prototype.YDd=function(K){ud.ULS.sendTraceTag(25180160,216,15,"Failure during OneDrive API download: {0}",K.exception?K.exception.toString():"No error detail.");Hi.a.nfj(this.Cab);this.tYa=null};cb.prototype.zi=function(){this.$s().B9c(vh.a.Zoj)};cb.prototype.b7=function(K){this.c7&&
this.c7(!1,K)};uk.Object.defineProperties(cb.prototype,{Cab:{configurable:!0,enumerable:!0,get:function(){return this.ha.Wa("OneDriveApiV72Url")}}});Object(Sd.a)(cb,"OneDriveFilePickerApiManagerV72",bd,[]);Object(Sd.a)(Qa,"IExtraData",null,[]);Am(sf,cb);sf.prototype.Alc=function(){try{ud.ULS.sendTraceTag(26071182,352,50,"Launching OneDrive file picker dialog with filter: {0}, commandMode: {1}, QosExtraData: {2} officeSessionId: {3}",this.options.advanced.filter,this.options.commandMode,this.options.qosExtradata?
this.options.qosExtradata.olsSessionId:"",be.AFrameworkApplication.userSessionId),OneDrive.open(this.options)}catch(K){ud.ULS.sendTraceTag(26071183,352,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",K.message,K.stack),this.zi()}};uk.Object.defineProperties(sf.prototype,{Cab:{configurable:!0,enumerable:!0,get:function(){return this.ha.Wa("OneDriveApiV72Url")}}});Object(Sd.a)(sf,"OneDriveFilePickerApiOpenManagerV72",cb,[]);Me.prototype.U_e=function(){this.gm=new Gg.a;ud.ULS.sendTraceTag(24134235,
352,50,"Sending initial request for OneDrive for Business Endpoint");this.NQd();return this.gm.task};Me.prototype.NQd=function(K){K=void 0===K?null:K;var na=String.format("GetMoreInfoHandler.ashx?{0}",be.AFrameworkApplication.SIa);this.Yg.y$(na,1,null,K,["PersonalFileStorageUrl","X-NewKey"],!1,2,Object(Vf.a)(this,this.xYh,"getMoreInfoSucceeded"),Object(Vf.a)(this,this.vYh,"getMoreInfoFailed"),null,void 0,void 0,void 0,void 0,"21")};Me.prototype.vYh=function(K){if(K.data.httpStatus===zh.a.GHb&&"X-NewKey"in
K.data.responseHeaders){ud.ULS.sendTraceTag(24134236,352,50,"GetMoreInfo request failed due to bad canary. Updating with new canary and resending");var na={};na["X-Key"]=K.data.responseHeaders["X-NewKey"];this.NQd(na)}else 0<this.pSc?(ud.ULS.sendTraceTag(24134237,352,50,"GetMoreInfo request failed, attmepting again. {0} retries remaining",this.pSc),this.pSc--,this.NQd()):(ud.ULS.sendTraceTag(24134238,352,50,"GetMoreInfo request failed, and no more retries remaining. Faulting task"),this.gm.setException(Error.create("GetMoreInfo request failed and no more retries remain")))};
Me.prototype.xYh=function(K){"PersonalFileStorageUrl"in K.data.responseHeaders&&""!==K.data.responseHeaders.PersonalFileStorageUrl?(ud.ULS.sendTraceTag(24134239,352,50,"Successfully received an ODB endpoint"),this.gm.setResult(K.data.responseHeaders.PersonalFileStorageUrl)):(ud.ULS.sendTraceTag(24134240,352,50,"GetMoreInfo request was successful but didn't return an ODB endpoint"),this.gm.setException(Error.create("GetMoreInfo request succeeded but did not have ODB endpoint")))};Object(Sd.a)(Me,"OneDriveForBusinessEndpointHelper",
null,[725]);var ph=b(621);Be.prototype.init=function(){};Be.prototype.dispose=function(){};Be.prototype.hi=function(K){var na=this;this.tb=K;this.tb.register(yc,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV5").as("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager").Ic().Nc(function(){return new yc(ph.a.instance,be.AFrameworkApplication.ha,be.AFrameworkApplication.w3a,be.AFrameworkApplication.limitedEdit,be.AFrameworkApplication.w8f,function(){return new de})});be.AFrameworkApplication.llf?
this.tb.register(725,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").Ic().Nc(function(){return new Kd}):this.tb.register(725,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").Ic().Nc(function(){return new Me(be.AFrameworkApplication.Ld)});this.tb.register(bc,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV7").Ic().Nc(function(){return new bc(be.AFrameworkApplication.ha,be.AFrameworkApplication.w3a,be.AFrameworkApplication.limitedEdit,function(){return new de},
na.tb.resolve("Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper"))});this.tb.register(cb,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72").Ic().Nc(function(){return new cb(be.AFrameworkApplication.ha,be.AFrameworkApplication.w3a,be.AFrameworkApplication.limitedEdit,function(){return new de})});this.tb.register(sf,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiOpenManagerV72").Ic().Nc(function(){return new sf(be.AFrameworkApplication.ha,be.AFrameworkApplication.w3a,
be.AFrameworkApplication.limitedEdit,function(){return new de})})};Be.main=function(){Mf.a.instance.nj(new Be)};uk.Object.defineProperties(Be.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.OneDriveFilePickerApi"}}});Object(Sd.a)(Be,"PackageManager",null,[4,5]);var Ag=Sh.StandardDialog;Am(Fd,Ag);Fd.prototype.displayError=function(K,na,Xa){this.IA=na;this.uYa=Xa;ud.ULS.sendTraceTag(8194008,216,50,"Display error with code:{0}, overwriteTarget:{1}.",K,Xa);K=this.H2c(K);
0===K?(this.lc=6,this.Bc(0,CommonUIStrings.l_DialogClose)):(this.lc=0,this.Bc(1,CommonUIStrings.l_DialogClose));0===K&&ud.ULS.sendTraceTag(8194009,216,50,"Show standard error dialog.");this.lA(vh.a.Yoj,this.bhd(K),this.YSh(K,na),Object(Vf.a)(this,this.ROd,"retryDialogHandler"),!0)};Fd.prototype.ROd=function(K){1===K?(ud.ULS.sendTraceTag(8194010,216,50,"User click to retry button in error dialog."),this.IA?this.La.Be(gg.a.CKb,2,[this.IA,this.uYa]):this.La.processAction(gg.a.CKb,2)):ud.ULS.sendTraceTag(8194011,
216,50,"User cancel the error dialog.")};Fd.prototype.H2c=function(K){return 0>K||6<K?(ud.ULS.sendTraceTag(8194012,216,15,"Unexpected error code {0}.",K),0):K};Fd.prototype.YSh=function(K,na){K=this.H2c(K);return this.Tjb?[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameAllowPercentOctothorpe,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,na),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameDisallowPercentOctothorpe][K]:
[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameText,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,na),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameText][K]};Fd.prototype.bhd=function(K){K=this.H2c(K);return[CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle,CommonUIStrings.l_EmptyNameTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,
CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle][K]};Object(Sd.a)(Fd,"ErrorRetryDialog",Sh.StandardDialog,[885]);Bd.prototype.create=function(){return new Fd(this.La,this.Tjb)};Object(Sd.a)(Bd,"ErrorRetryDialogFactory",null,[869]);var oh=b(149),Zg=b(41),Dg=oh.a;Am(Dc,Dg);Dc.prototype.YLe=function(K,na){this.gM(1,!!K&&K!==na);this.GJ=document.getElementById(Dc.PWe);Zg.a.addHandler(this.GJ,"change",Object(Vf.a)(this,this.lpc,"onFileNameChange"));Zg.a.addHandler(this.GJ,"input",
Object(Vf.a)(this,this.lpc,"onFileNameChange"));this.GJ.focus()};Dc.prototype.uac=function(K){return this.Tjb?(new RegExp("["+this.$9b('\\/:*?"<>|')+"]")).test(K):(new RegExp("["+this.$9b('\\/:*?"<>|#{}%~&')+"]")).test(K)};Dc.prototype.$9b=function(K){return K.replace(RegExp("[.*+?|()\\[\\]{}\\\\]","g"),"\\\\$&")};Dc.prototype.Fld=function(){var K=Cf.a.Lq(be.AFrameworkApplication.Ll.fn);this.gM(1,!!this.GJ&&""!==this.GJ.value&&this.GJ.value!==K)};Dc.prototype.lpc=function(){var K=this;this.GJ&&window.setTimeout(function(){K.Fld()},
0)};Dc.prototype.tac=function(K,na){if(1!==K)ud.ULS.sendTraceTag(23881882,216,50,"User click cancel to cancel upload file in file name dialog.");else{K=na[Dc.PWe];na=Dc.JJf in na?na[Dc.JJf]:!1;ud.ULS.sendTraceTag(23881883,216,50,"User click save to upload file with new name {0} and overwrite the target {1}.",Cf.a.Ntc(K),na);var Xa=Cf.a.j5(be.AFrameworkApplication.fileName);(K=K?K.trim():null)&&""!==K&&""!==Xa||1===this.sa.state?this.uac(K)?this.$s.create().displayError(1,K,na):this.wha.fpa(K+Xa,na,
this.Oh):this.$s.create().displayError(2,K,na)}};Dc.prototype.dispose=function(){this.GJ&&(Zg.a.removeHandler(this.GJ,"change",Object(Vf.a)(this,this.lpc,"onFileNameChange")),Zg.a.removeHandler(this.GJ,"input",Object(Vf.a)(this,this.lpc,"onFileNameChange")),this.GJ=null);Dg.prototype.dispose.call(this)};uk.Object.defineProperties(Dc.prototype,{sa:{configurable:!0,enumerable:!0,get:function(){return this.jf}}});Dc.PWe="txtFileName";Dc.JJf="chkOverwrite";Object(Sd.a)(Dc,"FileNameDialogBase",oh.a,[]);
uk.Object.defineProperties(Hb,{ig:{configurable:!0,enumerable:!0,get:function(){return oh.a.Qn(Hb.fk,CommonUIStrings.l_SaveACopyFileName,CommonUIStrings.l_SaveAsToHostOverwrite)}}});Hb.fk="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='OverwriteBlock'> <span id='OverwriteBlockSpan' class='WACDialogSpan'><input type='checkbox' id='chkOverwrite' class='WACDialogCheckBox'></input> <label id='lbcOverwrite' class='\"WACDialogInlineLabel\"' for='chkOverwrite'>{1}</label></span> </div>";
Object(Sd.a)(Hb,"FileNameDialogHtml",null,[]);Am(Ga,Dc);Ga.prototype.nR=function(K,na){var Xa=Cf.a.Lq(be.AFrameworkApplication.Ll.fn),Qb={};na=(Qb.txtFileName=K||Xa,Qb.lblFolderName=CommonUIStrings.l_ToCurrentFolder,Qb.chkOverwrite=na,Qb);this.initializeAndShow(CommonUIStrings.L_SaveAs,Object(Vf.a)(this,this.tac,"fileNameDialogHandler"),na);this.YLe(K,Xa)};Object(Sd.a)(Ga,"FileNameDialog",Dc,[886]);pg.prototype.create=function(){return new Ga(this.vb,this.La,this.jf,this.AY,this.$s,this.wha)};Object(Sd.a)(pg,
"FileNameDialogFactory",null,[870]);var li=b(738);ah.prototype.Sg=function(){2===be.AFrameworkApplication.sa.Qa.Yj?be.AFrameworkApplication.Ib.gf(gg.a.CKb,Sg.a.frame,Object(Vf.a)(this,this.zZf,"saveAsToHostActionDispatcher"),4):be.AFrameworkApplication.Ib.ic(gg.a.CKb,Sg.a.frame,Object(Vf.a)(this,this.zZf,"saveAsToHostActionDispatcher"))};ah.prototype.zZf=function(K,na,Xa,Qb,tc){return na.contextId!==Sg.a.frame||K!==gg.a.CKb?2:this.vb.ra("SaveAsToHostBrsIsEnabled")?1===Xa?li.SessionStatusManager.instance.zyb||
be.AFrameworkApplication.c6?8:32:2===Xa?(ud.ULS.sendTraceTag(8194015,216,50,"User clicked on SaveAsToHost button from the backstage."),K=this.PKc.create(),tc&&Object.getType(tc)===Array&&2===tc.length?K.nR(tc[0],!!tc[1]):K.nR(null,!1),32):8:8};Object(Sd.a)(ah,"SaveAsToHostActor",null,[]);var zg=b(79);Rg.prototype.kNb=function(){1!==this.jf.state&&(this.Em=this.Dmb(),this.Em.message=CommonUIStrings.l_CommentProgressTooltip,this.Em.lc=5,this.Em.rv=!1,this.Em.UBa(CommonUIStrings.l_DefaultDialogTitle,
null,null))};Rg.prototype.mT=function(K){K=void 0===K?0:K;1!==this.jf.state&&this.$s.create().displayError(K,Cf.a.Lq(this.IA),this.uYa)};Rg.prototype.yRa=function(){var K=this.vb.appSettings.BreadcrumbFolderUrl;ud.ULS.sendTraceTag(8194016,216,50,"Redirecting to OneDrive for business Folder.");hh.a.wf(K,hh.a.sY(3),void 0,"UploadToHostManager.RedirectToFolder")};Rg.prototype.xRa=function(K){var na=!1,Xa=!1;this.vb&&(na=this.vb.ra("SaveACopyIsEnabledForUiHost"),Xa=this.vb.ra("UiHostSupportsDocRebootFeatures"));
ud.ULS.sendTraceTag(8194017,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1} uiHostSupportsFeature {2}",K,na,Xa);if(na&&Xa){ud.ULS.sendTraceTag(51245197,216,50,"UploadToHostManager.RedirectToEditUrl: Sending DocumentRefresh post message.");var Qb={};Qb[rg.a.sRa]="1";Qb[rg.a.documentUrl]=K;Qb[rg.a.reason]=Oh.a.saveAs;be.AFrameworkApplication.jW().execute(function(tc){tc.Nj(th.a.Zua,Qb)})}else na&&!Xa&&be.AFrameworkApplication.mca?hh.a.wf(K,hh.a.sY(4),void 0,"UploadToHostManager.RedirectToEditUrl"):
hh.a.wf(K,hh.a.sY(3),void 0,"UploadToHostManager.RedirectToEditUrl")};Rg.prototype.fpa=function(K,na,Xa){Xa=void 0===Xa?null:Xa;ud.ULS.sendTraceTag(8194018,216,50,"Starting to upload file");this.mbe&&!this.mbe()&&this.Yg&&(this.Ih&&(this.vha=this.Ih.Hc("DialogShown","SaveAsToHostUploadTime")),this.kNb(),this.uYa=na,this.IA=K,(this.Oh=Xa)&&"true"===this.Oh.SkipSaveToHost?this.M$b():this.vR())};Rg.prototype.vR=function(){var K=this;32!==this.La.processAction(gg.a.wSa,1)?(ud.ULS.sendTraceTag(18989378,
219,15,"The save file change is not supported, this operation may exist data losting."),this.M$b()):this.La.Be(gg.a.wSa,2,[function(){ud.ULS.sendTraceTag(18989379,219,50,"Call the force save file change successfully.");K.M$b()},function(na,Xa){ud.ULS.sendTraceTag(18989380,219,15,"The file change is not saved successfully, this operation may lead to data loss.");K.mT(Xa)}])};Rg.prototype.sZi=function(K){this.AJa();this.sEa=!1;if(K&&K.data&&K.data.oe){var na=$h.d(K.data.oe);var Xa=na.ev;if(na.returnValue)if(Xa.StatusCode!==
zh.a.SP&&Xa.StatusCode!==zh.a.itb)ud.ULS.sendTraceTag(8194049,216,10,"UploadToHostManager failure. Response data is not JSON."),K={},K.FailureReason=Xa.StatusCode.toString(),K.ExtraInfo=Xa.ExtraInfo,this.hea(K),this.mT(parseInt(Xa.ExtraInfo));else{ud.ULS.sendTraceTag(8194050,216,50,"UploadToHost execute success.");this.INd();try{Xa.NewDocumentUrl&&""!==Xa.NewDocumentUrl?this.xRa(Xa.NewDocumentUrl):this.yRa()}catch(Qb){ud.ULS.sendTraceTag(37025699,216,15,"Redirect failed with exception: {0}",Qb.toString())}this.nHb()}else Xa=
{},ud.ULS.sendTraceTag(8194048,216,10,"Failed to deserialize : {0}",(Xa.ResponseData=Eh.a.ngb(K.data.oe),Xa)),K={},this.hea((K.FailureReason="Failed to deserialize response",K)),this.mT()}else ud.ULS.sendTraceTag(8194019,216,10,"UploadToHostManager failure. Response data is null"),K={},this.hea((K.FailureReason="null response",K)),this.mT()};Rg.prototype.rZi=function(K){if(5!==K.data.status&&12!==K.data.status||this.sEa){var na={};ud.ULS.sendTraceTag(8194052,216,10,"UploadToHostManager HTTP failure with code: {0}",
(na.Status=K.data.status,na.HttpStatus=K.data.httpStatus,na));na={};this.hea((na.FailureReason=K.data.httpStatus.toString(),na));this.AJa();this.mT();this.nHb()}else ud.ULS.sendTraceTag(8194051,216,10,"UploadToHostManager failure. Retry automatically."),this.sEa=!0,this.Oh&&"true"===this.Oh.SkipSaveToHost?this.M$b():this.vR()};Rg.prototype.AJa=function(){this.Em&&(this.Em.close(),this.Em=null)};Rg.prototype.nHb=function(){this.vha&&(this.vha.stop(),this.vha=null)};Rg.prototype.INd=function(){this.Oh&&
"VersionHistory"===this.Oh.SaveEntryPoint&&this.La.processAction(gg.a.Nvc,2)};Rg.prototype.hea=function(K){this.Oh&&"VersionHistory"===this.Oh.SaveEntryPoint&&this.La.Be(gg.a.KNd,2,K)};Rg.prototype.M$b=function(){var K=this.nGa+this.vga;K=zg.a.vl(K,"qs",Cf.a.rf(be.AFrameworkApplication.uj));K=zg.a.vl(K,"n",Cf.a.rf((new Date).getTime().toString()));K=zg.a.vl(K,"ov",Cf.a.rf(this.uYa.toString()));K=zg.a.vl(K,"fn",Cf.a.rf(this.IA));this.Oh&&this.Oh.FileDownloadUrl&&(K=zg.a.vl(K,"furl",Cf.a.rf(this.Oh.FileDownloadUrl)));
this.Yg.jm(K,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,Object(Vf.a)(this,this.sZi,"onUploadFinished"),Object(Vf.a)(this,this.rZi,"onUploadFailed"),null,void 0,void 0,void 0,void 0,"1")};Object(Sd.a)(Rg,"UploadToHostManager",null,[739]);var Ah=b(991);fh.prototype.init=function(){be.AFrameworkApplication.ha.tv(Object(Vf.a)(this,this.OB,"onFullAppSettingsReady"))};fh.prototype.OB=function(){be.AFrameworkApplication.ha.ra("SaveAsToHostBrsIsEnabled")&&this.tb.resolve("Common.App.SaveAsToHost.SaveAsToHostActor").Sg()};
fh.prototype.hi=function(K){this.tb=K;this.tb.register(Bd,"Common.App.SaveAsToHost.ErrorRetryDialogFactory").as("Common.App.SaveAsToHost.IErrorRetryDialogFactory").Nc(function(){return new Bd(be.AFrameworkApplication.ha,be.AFrameworkApplication.Ib)}).Ic();this.tb.register(Rg,"Common.App.SaveAsToHost.UploadToHostManager").as("Common.App.SaveAsToHost.IUploadToHostManager").Nc(function(){return new Rg(be.AFrameworkApplication.Ib,be.AFrameworkApplication.ha,be.AFrameworkApplication.Ld,function(){return be.AFrameworkApplication.Pg},
function(){return(new Ah.a).create()},K.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),be.AFrameworkApplication.sa,be.AFrameworkApplication.sa.gE)}).Ic();this.tb.register(pg,"Common.App.SaveAsToHost.FileNameDialogFactory").as("Common.App.SaveAsToHost.IFileNameDialogFactory").Nc(function(){return new pg(be.AFrameworkApplication.ha,be.AFrameworkApplication.Ib,be.AFrameworkApplication.sa,be.AFrameworkApplication.sa.Qa,K.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),K.resolve("Common.App.SaveAsToHost.UploadToHostManager"))}).Ic();
this.tb.register(ah,"Common.App.SaveAsToHost.SaveAsToHostActor").Nc(function(){return new ah(be.AFrameworkApplication.ha,K.resolve("Common.App.SaveAsToHost.FileNameDialogFactory"),K.resolve("Common.App.SaveAsToHost.UploadToHostManager"))}).Ic()};fh.prototype.dispose=function(){};fh.main=function(){Mf.a.instance.nj(new fh)};uk.Object.defineProperties(fh.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.SaveAsToHost"}}});Object(Sd.a)(fh,"SaveAsToHostPackage",null,[4,5]);
var Qg=Sh.StandardDialog;Am(Qe,Qg);Qe.prototype.displayError=function(K,na){this.sMe(K,na,vh.a.$oj)};Qe.prototype.sMe=function(K,na,Xa){ud.ULS.sendTraceTag(25180161,216,10,"Show upload error dialog with error code {0}.",Xa);this.lA(Xa,K,na,null)};Qe.prototype.B9c=function(K,na){ud.ULS.sendTraceTag(25235986,216,15,"Show warning dialog of Picker related issue.");this.lA(vh.a.bpj,K,na,null,!0)};Object(Sd.a)(Qe,"ErrorDialog",Sh.StandardDialog,[39]);uk.Object.defineProperties(nf,{ig:{configurable:!0,enumerable:!0,
get:function(){return oh.a.Qn(nf.fk,CommonUIStrings.l_FileNameLabel,CommonUIStrings.l_NewFileLocationLabel,CommonUIStrings.l_CurrentOnlineFolder,"")}}});nf.fk="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='DocumentLocationBlock'> <label id='locationName' class='WACDialogLabel' for='locationName' >{1}</label> <div class='FolderLocationDiv' id='folderLocation'> <label id='currentLocation' class='WACDialogLabel' for='currentLocation' >{2}</label> <span id='anotherFolder' class='WACDialogSpan'>{3}</span> </div> </div>";
Object(Sd.a)(nf,"FileNameDialogHtml",null,[]);var Bf=b(12),Gi=b(85),Uh=b(90);Am($g,Dc);$g.prototype.nR=function(K){var na=Cf.a.Lq(be.AFrameworkApplication.Ll.fn),Xa=be.AFrameworkApplication.breadcrumbFolderName,Qb=be.AFrameworkApplication.breadcrumbBrandName,tc={};tc=(tc.txtFileName=K||na,tc);var md=CommonUIStrings.L_SaveAs;2===be.AFrameworkApplication.sa.Qa.Yj&&(md=CommonUIStrings.L_SaveACopy);this.initializeAndShow(md,Object(Vf.a)(this,this.tac,"fileNameDialogHandler"),tc);this.YLe(K,na);this.rJa.style.width=
"450px";Sys.UI.DomElement.addCssClass(document.getElementById("DocumentLocationBlock"),"SaveAsDialogRow");be.AFrameworkApplication.ha.ra("HideSaveToAnotherFolderButtonforUIHost")||(this.iz=document.getElementById("anotherFolder"),K=document.getElementById("folderLocation"),this.TSc=Uh.a.pue(K,this.iz,"anotherFolderDescribedBy"),this.iz.className="WACButton WACDialogButtonNormal",K=!1,Xa&&Xa.length?(this.bpe(this.iz,this.TSc,String.format(CommonUIStrings.l_ScreenReader_CurrentFileLocation,Qb,Xa)),
K=this.sEg(Qb,Xa)):this.bpe(this.iz,this.TSc,CommonUIStrings.l_CurrentOnlineFolder),this.pFg(this.iz),this.uEg(this.iz),K?(document.getElementById("currentLocation").style.width="100%",Sys.UI.DomElement.addCssClass(this.iz,"SaveToAnotherLocationTwo"),ud.ULS.sendTraceTag(24459297,216,50,"Move save to another folder button to second line.")):Sys.UI.DomElement.addCssClass(this.iz,"SaveToAnotherLocationOne"),Zg.a.addHandler(this.iz,Bf.a.click,Object(Vf.a)(this,this.NEd,"onSaveToAnotherLocationClick")),
Zg.a.addHandler(this.iz,Bf.a.Ub,Object(Vf.a)(this,this.nGf,"onSaveToAnotherLocationKeyDown")))};$g.prototype.sEg=function(K,na){var Xa=!1;var Qb=document.getElementById("currentLocation");Qb.innerText="";var tc=this.q4e(Qb,K),md=this.q4e(Qb,na),Dd=255,ue=255;255<tc+md&&(Dd=Math.max(238,408-tc),ue=Math.max(170,408-md),Xa=!0);this.MGg(Qb,K,ue,na,Dd);return Xa};$g.prototype.q4e=function(K,na){var Xa=document.createElement("div");Xa.innerText=na;Xa.style.visibility="hidden";K.appendChild(Xa);na=Xa.clientWidth;
K.removeChild(Xa);return na};$g.prototype.MGg=function(K,na,Xa,Qb,tc){na&&(this.$oe(K,na,Xa),this.FGg(K));Qb&&this.$oe(K,Qb,tc)};$g.prototype.$oe=function(K,na,Xa){var Qb=document.createElement("div");Qb.innerText=na;Qb.title=na;Qb.className="SaveToAnotherFolderBreadcrumb";Qb.style.maxWidth=Xa.toString()+"px";K.appendChild(Qb)};$g.prototype.FGg=function(K){var na=document.createElement("span");na.id="FolderSeparator";var Xa=document.createElementNS("http://www.w3.org/2000/svg","svg");Xa.setAttribute("class",
"SeparatorCaret");var Qb=document.createElementNS("http://www.w3.org/2000/svg","polygon");Qb.setAttribute("points","1 4 1 11 5 7.5");Xa.appendChild(Qb);na.appendChild(Xa);K.appendChild(na)};$g.prototype.bpe=function(K,na,Xa){Xa=String.format(CommonUIStrings.l_ScreenReader_SaveToAnotherFolderButton,Xa);na&&(na.innerText=Xa);K.tabIndex=0;K.setAttribute(Uh.a.Vd,Uh.a.ks)};$g.prototype.uEg=function(K){var na=document.createElement("span");na.id="anotherFolderText";na.innerText=this.KWg;na.className="AnotherFolderTextSpan";
K.appendChild(na)};$g.prototype.pFg=function(K){var na=document.createElement("span");na.className="cui-img-cont-float cui-img-16by16 ";this.mra=document.createElementNS("http://www.w3.org/2000/svg","svg");this.mra.setAttribute("class","FolderIconSVG");var Xa=document.createElementNS("http://www.w3.org/2000/svg","path");Xa.setAttribute("d","M0,14V4L1.25,3h6.5L9.606,1H13.25L14,2V6h1.5L16,7.25,14.25,14H0ZM13,6V2H10L8.25,4,1.957,3.914,1,4.75V12L3.25,6.75l1-.75H13Z");this.mra.appendChild(Xa);na.appendChild(this.mra);
K.appendChild(na)};$g.prototype.nGf=function(K){!K||K.keyCode!==Gi.a.fi&&K.keyCode!==Gi.a.d2||this.NEd(K)};$g.prototype.NEd=function(){if(this.GJ){var K=Cf.a.j5(be.AFrameworkApplication.fileName),na=this.GJ.value;this.hide();na&&""!==na&&""!==K||1===this.sa.state?(""!==K&&(na+=K),this.uac(na)?this.$s.create().displayError(1,na,!1):this.dnb.start(na,this.nxg)):this.$s.create().displayError(2,na,!1)}};$g.prototype.t_g=function(K){this.iz&&this.mra&&(K?(this.iz.tabIndex=0,Sys.UI.DomElement.removeCssClass(this.iz,
"DisabledSaveAsButton"),Sys.UI.DomElement.removeCssClass(this.mra,"DisabledFolderIconSVG")):(this.iz.tabIndex=-1,Sys.UI.DomElement.containsCssClass(this.iz,"DisabledSaveAsButton")||Sys.UI.DomElement.containsCssClass(this.mra,"DisabledFolderIconSVG")||(Sys.UI.DomElement.addCssClass(this.iz,"DisabledSaveAsButton"),Sys.UI.DomElement.addCssClass(this.mra,"DisabledFolderIconSVG"))))};$g.prototype.Fld=function(){Dc.prototype.Fld.call(this);this.t_g(!!this.GJ&&""!==this.GJ.value)};$g.prototype.dispose=function(){this.iz&&
(Zg.a.removeHandler(this.iz,Bf.a.click,Object(Vf.a)(this,this.NEd,"onSaveToAnotherLocationClick")),Zg.a.removeHandler(this.iz,Bf.a.Ub,Object(Vf.a)(this,this.nGf,"onSaveToAnotherLocationKeyDown")),this.iz=null);Dc.prototype.dispose.call(this)};Object(Sd.a)($g,"FileNameDialog",Dc,[62]);var Ka=b(893),sa=b(614),wb=b(199),Nd=b(1115),ee=b(134);Object(Sd.a)(qf,"SaveAsDialogInput",null,[]);Object(Sd.a)(dg,"SaveLocation",null,[]);var yf=b(355);rf.prototype.eSh=function(){var K=new Ka.a(sa.a.Uk());K.ia("type",
"currentHost");return Object.assign(new dg,{folderName:this.$v.breadcrumbFolderName,friendlyPath:this.$v.breadcrumbBrandName,properties:K})};rf.prototype.Vri=function(K){return!!K&&"ClassicMru"===K.type&&!!K.service_info&&!!K.service_info.service_id&&-1!==K.service_info.service_id.indexOf("SHAREPOINT")};rf.prototype.p2h=function(){if(!this.aPc||!this.gGa)return null;var K=this.aPc.value.Kz("SaveAsToSharePointDialog",!1);if(!K||3!==K.state||!K.Xuf)return null;K=K.Xuf;for(var na=new wb.a,Xa=0,Qb=0,
tc=0;tc<K.length;tc++){var md=K[tc];if(this.Vri(md)&&(Xa++,md.sharepoint_info)){var Dd=md.url,ue=md.sharepoint_info.site_url,Ce=md.title;md=Nd.b(md,be.AFrameworkApplication.isRtl);if(Dd&&ue&&Ce&&md){Qb++;var Kf=new Ka.a(sa.a.Uk());Kf.ia("type","SharePoint");Kf.ia("siteUrl",ue);Kf.ia("folderUrl",Dd);Qb++;na.add(Object.assign(new dg,{folderName:Ce,friendlyPath:md,properties:Kf}))}}}tc=new Map;tc.set("NumPlaces",K.length.toString());tc.set("NumSharepointPlaces",Xa.toString());tc.set("placesWithMetadata",
Qb.toString());Pg.Health.instance.recordKpiUsage("SharePointSaveAsDialogMru",0,"smartfio",tc);0<Xa&&(Qb?.5>1*Qb/Xa&&Pg.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","PartialPlacesMetadataMissing",!1,!1,null):Pg.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","AllPlacesMetadataMissing",!1,!1,null));return na};rf.prototype.XSh=function(){var K=new wb.a;K.add(this.eSh());var na=this.p2h();na&&K.addRange(na);return Object.assign(new qf,{enableMoreLocations:!be.AFrameworkApplication.ha.ra("HideSaveToAnotherFolderButtonforUIHost"),
fileName:this.IA,extension:Cf.a.j5(this.$v.fn),saveLocations:K.toArray(),scenario:"SaveToSharePoint"})};rf.prototype.USh=function(){return{inputPropsCallback:Object(Vf.a)(this,this.XSh,"getDialogInput")}};rf.prototype.nR=function(K){this.IA=K;this.IA||(this.IA=String.format(CommonUIStrings.l_SaveACopy_Filename,Cf.a.Lq(this.$v.fn)));K={};K=(K.id="SaveAsDialog",K.bodyControls=this.USh(),K);var na=CommonUIStrings.L_SaveAs;2===this.jf.Qa.Yj&&(na=CommonUIStrings.L_SaveACopy);var Xa=new oh.a(!1,!1,!0);
Xa.lc=1;Xa.Ve="SaveAsDialog";Xa.Bc(1,CommonUIStrings.l_SaveButtonLabel);Xa.initializeAndShow(na,Object(Vf.a)(this,this.Woj,"saveAsDialogHandler"),K)};rf.prototype.dGj=function(K,na){K&&""!==K&&""!==na||1===this.jf.state?this.Tri()?this.hyi(K,na):(""!==na&&(K+=na),this.dnb.start(K,this.Oh)):(ud.ULS.sendTraceTag(579179796,216,10,"filename is empty but dialog should have handled this error case"),this.$s.create().displayError(2,K,!1))};rf.prototype.hyi=function(K,na){var Xa=this;Pg.Health.instance.recordKpiUsage("SaveACopySFP",
0,"smartfio",null);var Qb=this.aZa.CHe(CommonUIStrings.l_PickerSaveACopyOkButton,CommonUIStrings.l_PickerSaveACopyTitle,!1,!0,null,"SaveACopy",2);this.aZa.xhd(Qb).then(function(tc){if(tc&&0<tc.length){var md=tc[0][rg.a.H2i];tc=tc[0][rg.a.ZKf];if(""!==md&&""!==tc)Xa.gGa.fpa(tc,K+na,md,Xa.Oh),Pg.Health.instance.recordKpiSuccess("SaveACopySFP",null);else{Xa.$s.create().displayError(0,K,!1);var Dd=ee.a.us();Dd&&(Dd.set("SiteUrlAvailable",""===md?"false":"true"),Dd.set("FolderUrlAvailable",""===tc?"false":
"true"));Pg.Health.instance.recordKpiFailure("SaveACopySFP","Not all values Available to start upload",!1,!1,Object.assign(new yf.a,{extendedProperties:Dd}))}}else Xa.$s.create().displayError(0,K,!1),Pg.Health.instance.recordKpiFailure("SaveACopySFP","Picker Data is unavaliable",!1,!1,null)}).catch(function(tc){"Canceled"===tc?((tc=ee.a.us())&&tc.set("IsCanceled","true"),Pg.Health.instance.recordKpiSuccess("SaveACopySFP",Object.assign(new yf.a,{extendedProperties:tc}))):Pg.Health.instance.recordKpiFailure("SaveACopySFP",
tc,!1,!1,null)})};rf.prototype.Tri=function(){return this.aZa?this.aZa.Rtd():(ud.ULS.sendTraceTag(572343636,216,50,"_sharedFilePickerManager is null"),!1)};rf.prototype.Woj=function(K,na){if(na&&1===K){K=na.fileName;var Xa=Cf.a.j5(this.$v.fn);na.moreLocationsSelected&&this.dGj(K,Xa);if(na.locationCallback){var Qb=na.locationCallback();Qb?Qb.properties&&"currentHost"===Qb.properties.pa("type")?this.wha.fpa(K+Xa,!1,this.Oh):Qb.properties&&"SharePoint"===Qb.properties.pa("type")?(na=Qb.properties.pa("siteUrl"),
Qb=Qb.properties.pa("folderUrl"),this.gGa.fpa(Qb,K+Xa,na,this.Oh)):ud.ULS.sendTraceTag(579179799,216,10,"unknown location type sent back"):ud.ULS.sendTraceTag(579179798,216,10,"selected location is empty")}else ud.ULS.sendTraceTag(579179797,216,10,"locationCallback is empty")}};Object(Sd.a)(rf,"ReactSaveAsDialog",null,[62]);ng.prototype.create=function(K){return this.jf&&this.jf.Qa.Tw?new rf(this.Bje,this.$s,this.wha,be.AFrameworkApplication.Ll,this.jf,this.Rvg,this.gGa,this.aZa,K):new $g(this.vb,
this.La,this.jf,this.AY,this.$s,this.wha,this.Bje,K)};Object(Sd.a)(ng,"FileNameDialogFactory",null,[43]);Ke.prototype.start=function(K){var na=this;if(!this.YIf)if(be.AFrameworkApplication.breadcrumbFolderUrl&&be.AFrameworkApplication.breadcrumbFolderUrl.length)this.bmb=be.AFrameworkApplication.breadcrumbFolderUrl;else return ud.ULS.sendTraceTag(23881884,216,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",
!this.Ro),!1;var Xa=this.Jxg();Xa.xGj();var Qb=Xa.b_h();if(!Qb)return ud.ULS.sendTraceTag(24664067,216,10,"Picker container is null, will not show picker."),!1;this.Zjb.start(function(tc,md){Xa.hide();K(tc,md)},function(){na.ICd(Xa)},Qb,this.bmb);return!0};Ke.prototype.ICd=function(K){K.hide();ud.ULS.sendTraceTag(24664068,216,50,"User cancelled save to another folder.")};Ke.prototype.vZh=function(K){K=K.toLowerCase();K.endsWith("/")||(K+="/");var na=K.indexOf("/documents/");return-1!==na?K.substring(0,
na+1)+"_layouts/15/onedrive.aspx":""};Ke.prototype.uxb=function(K){this.Ro||3!==K.state||(this.Ro=K)};uk.Object.defineProperties(Ke.prototype,{YIf:{configurable:!0,enumerable:!0,get:function(){this.bmb||(this.CEa.value.Kz("Save As",!0),this.Ro&&this.Ro.PS&&this.Ro.PS.length&&(this.bmb=this.vZh(this.Ro.PS)));return this.bmb}}});Object(Sd.a)(Ke,"OneDriveFilePickerHelper",null,[41]);var sg=oh.a;Am(If,sg);If.prototype.xGj=function(){this.EJc="FilePickerDialog";this.ig="<div class='FilePickerDiv' id='FilePickerDiv'></div>";
this.Ve="PickerDialog-MsoSp";this.showDialog("",null)};If.prototype.b_h=function(){return document.getElementById("FilePickerDiv")};If.prototype.qP=function(){};If.prototype.lRa=function(){};Object(Sd.a)(If,"PickerDialog",oh.a,[42]);var bg=b(1048),Yf=b(23);ef.prototype.Sg=function(){var K=this,na=this.Zjb.u5a();na?Yf.a.FB||this.vb.ra("SaveToSharePointOnDemandDownloadJsIsEnabled")?this.La.gf(gg.a.saveToSharePoint,Sg.a.frame,Object(Vf.a)(this,this.TZf,"saveToSharePointActionDispatcher"),64):(na.z9a.continueWith(function(Xa){Xa.og&&
K.Zjb.YDd(Xa)}),this.e3b()):ud.ULS.sendTraceTag(25180162,216,15,"Failure with OneDrive API download as the js url is empty.")};ef.prototype.e3b=function(){Hi.a.aLd(Object(Vf.a)(this,this.TZf,"saveToSharePointActionDispatcher"));Hi.a.ead([new bg.a(gg.a.saveToSharePoint,Sg.a.frame,0)],this.Zjb.u5a())};ef.prototype.TZf=function(K,na,Xa,Qb,tc){return na.contextId!==Sg.a.frame||K!==gg.a.saveToSharePoint?2:this.L8a&&(this.MQc.YIf||this.fAe)?1===Xa?li.SessionStatusManager.instance.zyb||be.AFrameworkApplication.c6?
8:this.eqg()?32:8:2===Xa?(ud.ULS.sendTraceTag(23881885,216,50,"User clicked on SaveToSharePoint button from "+(tc&&tc.SaveEntryPoint&&"VersionHistory"===tc.SaveEntryPoint.toString()?"version history.":"the backstage.")),this.fAe?(ud.ULS.sendTraceTag(24524226,216,50,"Show save a copy dialog."),this.PKc.create(tc).nR(null)):(ud.ULS.sendTraceTag(24524225,216,50,"No permission save to current folder, show Picker to save to another folder."),this.dnb.start(null,tc)),32):8:8};uk.Object.defineProperties(ef.prototype,
{L8a:{configurable:!0,enumerable:!0,get:function(){return this.vb.ra("SaveToAnotherFolderBrsIsEnabled")}},fAe:{configurable:!0,enumerable:!0,get:function(){return this.vb.ra("UserCanWriteRelative")}}});Object(Sd.a)(ef,"SaveToSharePointActor",null,[]);fe.prototype.start=function(K,na){var Xa=this;ud.ULS.sendTraceTag(25180163,216,50,"Try launch Picker.");this.vfe=K;this.Oh=na;this.MQc.start(function(Qb,tc){Xa.e7i(Qb,tc)})||this.hVd()};fe.prototype.e7i=function(K,na){if(K)this.onSuccess(na);else this.b7(na)};
fe.prototype.hVd=function(){1!==this.jf.state&&this.$s().B9c(CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError)};fe.prototype.onSuccess=function(K){ud.ULS.sendTraceTag(23881886,216,50,"Success Callback called. Calling UploadToSharePointManager to start upload.");if(K&&K.data&&K.data.value&&K.data.value.length&&K.data.value[0].sharePoint){var na=K.data.value[0].sharePoint.url;K=K.data.value[0].sharePoint.listUrl;var Xa=null;if(na&&(Xa=K?this.K2h(K):this.J2h(na))){this.gGa.fpa(na,
this.vfe,Xa,this.Oh);return}ud.ULS.sendTraceTag(25180164,216,10,"Picker return invalid data, folder url is null: {0}, siteUrl url is null: {1}.",!na,!Xa)}ud.ULS.sendTraceTag(23881887,216,10,"Picker return invalid data or empty SharePoint url.");this.hVd()};fe.prototype.J2h=function(K){K.endsWith("/")||(K+="/");for(var na=0,Xa=0;Xa<K.length;Xa++)if("/"===K.charAt(Xa)&&5===++na)return K.substr(0,Xa);return null};fe.prototype.K2h=function(K){K.endsWith("/")&&(K=K.substring(0,K.length-1));var na=K.lastIndexOf("/");
return-1!==na?K.substring(0,na):null};fe.prototype.b7=function(K){ud.ULS.sendTraceTag(23881888,216,10,"Picker failure Callback called.");K&&K.error?ud.ULS.sendTraceTag(23881889,216,10,"File Dialog returned with error code:{0}, and error message: {1}.",K.error.errorCode,K.error.message):ud.ULS.sendTraceTag(23881890,216,10,"File Dialog returned empty error.");this.hVd()};Object(Sd.a)(fe,"SaveToSharePointManager",null,[745]);Fe.prototype.execute=function(K,na){if(!be.AFrameworkApplication.Pg&&be.AFrameworkApplication.Ld){var Xa=
this.nGa+this.vga;Xa=zg.a.vl(Xa,"fu",Cf.a.rf(this.E9));Xa=zg.a.vl(Xa,"su",Cf.a.rf(this.uAg));Xa=zg.a.vl(Xa,"fn",Cf.a.rf(this.IA));Xa=zg.a.vl(Xa,"n",Cf.a.rf((new Date).getTime().toString()));this.Oh&&this.Oh.FileDownloadUrl&&(Xa=zg.a.vl(Xa,"furl",Cf.a.rf(this.Oh.FileDownloadUrl)));Xa=Xa+"&"+this.ORc;this.jXa&&this.jXa.length?Xa=zg.a.vl(Xa,"fnn",Cf.a.rf(this.jXa)):ud.ULS.sendTraceTag(23881891,216,15,"No new file name in request.");ud.ULS.sendTraceTag(23881920,216,50,"Trying send SharePointSaveAsHandler.ashx request.");
be.AFrameworkApplication.Ld.jm(Xa,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,K,na,null,void 0,void 0,void 0,void 0,"9")}};Object(Sd.a)(Fe,"SharePointSaveAsCaller",null,[788]);Td.prototype.create=function(K,na,Xa,Qb){return new Fe(this.oGa,this.IA,K,na,Xa,be.AFrameworkApplication.uj,this.vga,Qb)};Object(Sd.a)(Td,"SharePointUploadCallerFactory",null,[741]);var xg=b(896);nd.prototype.fpa=function(K,na,Xa,Qb){this.hHc=!1;ud.ULS.sendTraceTag(23881921,216,50,"UploadToSharePointManager.StartUpload : Starting to upload file");
this.kNb();this.E9=K;Qb&&Qb.SaveEntryPoint&&(this.PSc=Qb.SaveEntryPoint);this.LDa=this.kVc.create(K,na,Xa,Qb);Qb&&"true"===Qb.SkipSaveToHost?this.vR():this.sJh()};nd.prototype.sJh=function(){function K(){ud.ULS.sendTraceTag(23881923,216,15,"The file change is not saved successfully, this operation may lead to data loss.");na.vR()}var na=this;32!==this.La.Be(gg.a.wSa,2,[function(){ud.ULS.sendTraceTag(23881922,216,50,"Call the force save file change successfully.");na.vR()},K])&&K()};nd.prototype.vR=
function(){ud.ULS.sendTraceTag(23881924,216,50,"Send SharePointSaveAsHandler.ashx request.");this.LDa.execute(Object(Vf.a)(this,this.GWi,"onSaveToSharePointUploadFinished"),Object(Vf.a)(this,this.FWi,"onSaveToSharePointUploadFailed"))};nd.prototype.GWi=function(K){if(K&&K.data&&K.data.oe){var na=$h.d(K.data.oe);var Xa=na.ev;if(na.returnValue)if(Xa.StatusCode!==zh.a.SP&&Xa.StatusCode!==zh.a.itb)ud.ULS.sendTraceTag(25235987,216,15,"UploadToSharePointManager upload failed with status: {0}, status code: {1}.",
K.data.status,Xa.StatusCode),Xa.StatusCode!==zh.a.LWf&&this.SMe(K.data.status)||(this.hea(Xa.StatusCode.toString()),this.fFj(Xa.StatusCode));else{ud.ULS.sendTraceTag(23881927,216,50,"UploadToSharePointManager upload success.");this.INd();try{Xa.NewDocumentUrl?this.xRa(Xa.NewDocumentUrl):this.yRa()}catch(Qb){ud.ULS.sendTraceTag(37025729,216,15,"Redirect failed with exception: {0}",Qb.toString())}}else Xa={},ud.ULS.sendTraceTag(23881926,216,10,"Failed to deserialize : {0}",(Xa.ResponseData=Eh.a.ngb(K.data.oe),
Xa)),this.P8b()||(this.hea("Failed to deserialize response"),this.iNb())}else ud.ULS.sendTraceTag(23881925,216,10,"Upload failure. Response data is null"),this.P8b()||(this.hea("Unknown"),this.iNb())};nd.prototype.FWi=function(K){K&&K.data?this.SMe(K.data.status)||(ud.ULS.sendTraceTag(23881929,216,10,"Upload failed."),this.hea(xg.a[K.data.status]),this.iNb()):(ud.ULS.sendTraceTag(23881928,216,10,"Upload failure. Response data is null"),this.P8b()||(this.hea("Unknown"),this.iNb()))};nd.prototype.P8b=
function(){if(!this.hHc)return ud.ULS.sendTraceTag(23881930,216,10,"Upload fail. Retrying."),this.hHc=!0,this.vR(),!0;ud.ULS.sendTraceTag(23881931,216,10,"Upload fail. Already retry once but still fail.");return!1};nd.prototype.SMe=function(K){ud.ULS.sendTraceTag(23881932,216,10,"HTTP failure with code: {0}",K);return this.P8b()};nd.prototype.yRa=function(){ud.ULS.sendTraceTag(23881933,216,50,"Redirecting to Folder.");hh.a.wf(this.E9,hh.a.sY(3),void 0,"UploadToSharePointManager.RedirectToFolder")};
nd.prototype.xRa=function(K){var na=!1,Xa=!1;be.AFrameworkApplication.ha&&(na=be.AFrameworkApplication.ha.ra("SaveACopyIsEnabledForUiHost"),Xa=be.AFrameworkApplication.ha.ra("UiHostSupportsDocRebootFeatures"));ud.ULS.sendTraceTag(23881934,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",K,na);if(na&&Xa){ud.ULS.sendTraceTag(51245198,216,50,"UploadToSharePointManager.RedirectToEditUrl: Sending DocumentRefresh post message.");var Qb={};Qb[rg.a.sRa]="1";Qb[rg.a.documentUrl]=K;Qb[rg.a.reason]=
Oh.a.saveAs;be.AFrameworkApplication.jW().execute(function(tc){tc.Nj(th.a.Zua,Qb)})}else hh.a.wf(K,hh.a.sY(3),void 0,"UploadToSharePointManager.RedirectToEditUrl")};nd.prototype.kNb=function(){this.jf&&1===this.jf.state||(this.Em=this.Dmb(),this.Em.message=CommonUIStrings.l_CommentProgressTooltip,this.Em.lc=5,this.Em.rv=!1,this.Em.UBa(CommonUIStrings.l_DefaultDialogTitle,null,null))};nd.prototype.AJa=function(){this.Em&&(this.Em.close(),this.Em=null)};nd.prototype.iNb=function(){this.zi(CommonUIStrings.l_SaveFailedDialogTitle,
CommonUIStrings.l_FailToSaveFile)};nd.prototype.hGj=function(){this.zi(CommonUIStrings.l_NoSavePermissionDialogTitle,CommonUIStrings.l_NoSavePermissionDialogMessage)};nd.prototype.lFj=function(){var K=String.format(CommonUIStrings.l_SaveAsFileTooLargeMessage,250);this.zi(CommonUIStrings.l_SaveAsFileTooLargeTitle,K,vh.a.Xoj)};nd.prototype.zi=function(K,na,Xa){Xa=void 0===Xa?vh.a.apj:Xa;ud.ULS.sendTraceTag(25180165,216,10,"Upload failure with title: {0}, message: {1}",K,na);this.AJa();1!==this.jf.state&&
this.$s().sMe(K,na,Xa)};nd.prototype.fFj=function(K){ud.ULS.sendTraceTag(25180166,216,50,"Upload fail with status code: {0}.",K);switch(K){case zh.a.mfg:this.hGj();break;case zh.a.LWf:this.lFj();break;default:this.iNb()}};nd.prototype.INd=function(){"VersionHistory"===this.PSc&&this.La.processAction(gg.a.Nvc,2)};nd.prototype.hea=function(K){if("VersionHistory"===this.PSc){var na={};this.La.Be(gg.a.KNd,2,(na.FailureReason=K,na))}};Object(Sd.a)(nd,"UploadToSharePointManager",null,[740]);Rc.prototype.init=
function(){};Rc.prototype.dispose=function(){};Rc.prototype.hi=function(K){var na=this;this.tb=K;this.YPc=Fh.a.lr(K.qc("Common.IEventEmitter<Common.IGetMoreInfoResult>"));this.cQc=Fh.a.lr(K.qc("Common.IEventEmitter<Common.IMruResult>"));this.ysa=Fh.a.lr(K.qc("Common.App.SharedFilePicker.ISharedFilePicker"));Kg.Task.WAA.call(null,this.YPc,this.cQc,this.ysa).continueWith(function(){na.Sbj()})};Rc.prototype.Sbj=function(){var K=this;this.tb.register(Td,"Common.App.SaveToSharePoint.SharePointUploadCallerFactory").as("Common.App.SaveToSharePoint.ISharePointUploadCallerFactory").Nc(function(){return new Td(be.AFrameworkApplication.ha)}).Ic();
this.tb.register(nd,"Common.App.SaveToSharePoint.UploadToSharePointManager").as("Common.App.SaveToSharePoint.IUploadToSharePointManager").Nc(function(){return new nd(be.AFrameworkApplication.Ib,K.tb.resolve("Common.App.SaveToSharePoint.SharePointUploadCallerFactory"),function(){return(new Ah.a).create()},function(){return new Qe},be.AFrameworkApplication.sa)}).Ic();this.tb.register(fe,"Common.App.SaveToSharePoint.SaveToSharePointManager").as("Common.App.SaveToSharePoint.ISaveToSharePointManager").Nc(function(){return new fe(K.tb.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),
function(){return new Qe},K.tb.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),be.AFrameworkApplication.sa)}).Ic();this.tb.register(Ke,"Common.App.SaveToSharePoint.OneDriveFilePickerHelper").as("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper").Nc(function(){return new Ke(K.tb.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),new mf.a(function(){return K.YPc.result}),be.AFrameworkApplication.sa,function(){return new If})}).Ic();this.tb.register(ng,
"Common.App.SaveToSharePoint.FileNameDialogFactory").Nc(function(){return new ng(be.AFrameworkApplication.ha,be.AFrameworkApplication.Ib,be.AFrameworkApplication.sa,be.AFrameworkApplication.sa.Qa,K.tb.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),K.tb.resolve("Common.App.SaveAsToHost.IUploadToHostManager"),K.tb.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),new mf.a(function(){return K.cQc.result}),K.tb.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),
K.ysa?K.ysa.result:null)}).Ic();this.tb.register(ef,"Common.App.SaveToSharePoint.SaveToSharePointActor").Nc(function(){return new ef(be.AFrameworkApplication.ha,be.AFrameworkApplication.Ib,K.tb.resolve("Common.App.SaveToSharePoint.FileNameDialogFactory"),K.tb.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),K.tb.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),K.tb.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),function(){return be.AFrameworkApplication.sa.KYg})}).Ic();
be.AFrameworkApplication.ha.ra("SaveToAnotherFolderBrsIsEnabled")&&this.tb.resolve("Common.App.SaveToSharePoint.SaveToSharePointActor").Sg()};Rc.main=function(){Mf.a.instance.nj(new Rc)};uk.Object.defineProperties(Rc.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.SaveToSharePoint"}}});Object(Sd.a)(Rc,"PackageManager",null,[4,5]);var oe=Sh.StandardDialog;Am(mc,oe);mc.prototype.displayError=function(K){this.lA(K,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,
null)};Object(Sd.a)(mc,"ErrorDialog",Sh.StandardDialog,[871]);ke.default=0;Object(Sd.a)(ke,"SaveToCloudErrorCodes",null,[]);Ed.prototype.start=function(K){this.Oh=K;if("SharePointOnlineConsumer"===this.vb.Wa("FileSource")){var na=Xh.a.instance.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager");if(na){na.start(null,K);return}}this.W2.eNa?(ud.ULS.sendTraceTag(6590559,216,50,"User is signed in. We will show file picker."),this.gYg()):(ud.ULS.sendTraceTag(6590560,216,50,"User is not signed in. We will show sign in dialog."),
this.showSignInDialog())};Ed.prototype.showSignInDialog=function(){this.nAg.create().nR()};Ed.prototype.zi=function(){this.$s().displayError(ke.default)};Ed.prototype.gYg=function(){try{ud.ULS.sendTraceTag(6590561,216,50,"Initializing OneDrive API");var K={},na=(K.client_id=this.vb.appSettings.UploadToSkyDriveClientId,K.env="INT",K);if(1===this.bSb||2===this.bSb)K={},na=(K.client_id=this.vb.appSettings.UploadToSkyDriveClientId,K);K={};var Xa=(K.mode="save",K.lightbox="grey",K);WL.init(na);ud.ULS.sendTraceTag(6590562,
216,50,"OneDrive API is initialized. Launching file dialogue");WL.fileDialog(Xa).then(Object(Vf.a)(this,this.onSuccess,"onSuccess"),Object(Vf.a)(this,this.b7,"onFailure"))}catch(Qb){ud.ULS.sendTraceTag(6590563,216,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",Qb,Qb.stack),this.zi()}};Ed.prototype.onSuccess=function(K){ud.ULS.sendTraceTag(6590592,216,50,"Success Callback called. Calling UploadToCloudManger to start upload.");K&&K.data&&K.data.folders&&this.Znb.fpa(K.data.folders[0].id,K.data.folders[0].urls.viewInBrowser,
null,this.Oh)};Ed.prototype.b7=function(K){if(K&&K.error){if("user_canceled"===K.error.code){ud.ULS.sendTraceTag(6590593,216,50,"User cancelled upload to their OneDrive.");return}ud.ULS.sendTraceTag(6590594,216,50,"File Dialog returned with error code:{0}, and error message: {1}",K.error.code,K.error.message)}else ud.ULS.sendTraceTag(6590595,216,50,"File Dialog returned with no response");this.zi()};Object(Sd.a)(Ed,"SaveToCloudManager",null,[876]);Md.prototype.L8a=function(){return this.vb.ra("SaveToCloudStorageUIIsEnabled")};
Md.prototype.z_e=function(){return gg.a.saveToCloudStorage};Md.prototype.e3b=function(){Hi.a.aLd(Object(Vf.a)(this,this.RZf,"saveToCloudActionDispatcher"));Hi.a.ead([new bg.a(gg.a.saveToCloudStorage,Sg.a.frame,0)],this.tge.u5a())};Md.prototype.Sg=function(){var K=this,na=this.tge.u5a();na?(na.C$(function(){K.Tde.setResult(!0)}),this.e3b()):ud.ULS.sendTraceTag(6590596,216,15,"Failure with OneDrive API download as the onedrive url received is empty ")};Md.prototype.jRf=function(){ud.ULS.sendTraceTag(6590597,
216,50,"User clicked on SaveToOneDrive button")};Md.prototype.RZf=function(K,na,Xa,Qb,tc){var md=this;return na.contextId!==Sg.a.frame||K!==this.z_e()?2:this.L8a()?1===Xa?li.SessionStatusManager.instance.zyb||be.AFrameworkApplication.c6?8:32:2===Xa?(this.jRf(),tc&&tc.FileDownloadUrl&&ud.ULS.sendTraceTag(50708835,216,50,"SaveToCloudStorageActor FileDownloadUrl is there"),this.Ih&&(this.vXb=this.Ih.Hc("DialogShown","SaveToOneDriveReponseTime")),this.Tde.task.continueWith(function(){md.vXb&&(md.vXb.stop(),
md.vXb=null);md.rzg.start(tc)}),32):8:8};Object(Sd.a)(Md,"SaveToCloudStorageActor",null,[875]);var Gh=b(292),rh=Sh.StandardDialog;Am(Yc,rh);Yc.prototype.nR=function(){this.W2.$Za(Object(Vf.a)(this,this.nHf,"onSignIn"));this.Fk(CommonUIStrings.l_SignInToSaveDialogTitle,CommonUIStrings.l_SaveToCloudSignInDialog,0,Object(Vf.a)(this,this.lhi,"inputHandler"))};Yc.prototype.lhi=function(K){0===K?(ud.ULS.sendTraceTag(6590598,216,50,"User dismissed SignIn Dialog."),this.hide()):this.p7()};Yc.prototype.T_g=
function(){var K="2";if(this.AY)switch(this.AY.Yj){case 3:K="0";break;case 2:K="3";break;case 1:K="1"}return K};Yc.prototype.hide=function(){this.W2.fJb(Object(Vf.a)(this,this.nHf,"onSignIn"));rh.prototype.hide.call(this)};Yc.prototype.p7=function(){var K=new Gh.QueryStringBuilder("Signin.aspx");K.Li("prompt","1");K.Li("cbcxt",this.T_g());be.AFrameworkApplication.Kob(K);hh.a.wf(K.toString(),"LoginWindow",void 0,"SignInDialog")};Yc.prototype.nHf=function(){this.Sq&&this.hide();ud.ULS.sendTraceTag(7143885,
216,50,"User signed in successfully. Calling Savetocloudstorage action handler");this.La.processAction(gg.a.saveToCloudStorage,2)};Object(Sd.a)(Yc,"SignInDialog",Sh.StandardDialog,[894]);vc.prototype.create=function(){return new Yc(this.La,this.W2,this.AY)};Object(Sd.a)(vc,"SignInDialogFactory",null,[874]);Ib.prototype.execute=function(K,na){if(!be.AFrameworkApplication.Pg&&be.AFrameworkApplication.Ld){var Xa=this.nGa+this.vga;Xa=zg.a.vl(Xa,"fo",Cf.a.rf(this.lUb));Xa=zg.a.vl(Xa,"fn",Cf.a.rf(this.IA));
Xa=zg.a.vl(Xa,"qs",Cf.a.rf(this.ORc));Xa=zg.a.vl(Xa,"n",Cf.a.rf((new Date).getTime().toString()));this.Oh&&this.Oh.FileDownloadUrl&&(Xa=zg.a.vl(Xa,"furl",Cf.a.rf(this.Oh.FileDownloadUrl)));this.jXa&&(Xa=zg.a.vl(Xa,"fnn",Cf.a.rf(this.jXa)));be.AFrameworkApplication.Ld.jm(Xa,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,K,na,null)}};Object(Sd.a)(Ib,"SkyDriveUploadCaller",null,[893]);Na.prototype.create=function(K,na,Xa){return new Ib(this.oGa,this.IA,na,K,be.AFrameworkApplication.uj,
this.vga,Xa)};Object(Sd.a)(Na,"SkydriveUploadCallerFactory",null,[873]);eg.prototype.kNb=function(){this.jf&&1===this.jf.state||(this.Em=this.Dmb(),this.Em.message=CommonUIStrings.l_CommentProgressTooltip,this.Em.lc=5,this.Em.rv=!1,this.Em.UBa(CommonUIStrings.l_DefaultDialogTitle,null,null))};eg.prototype.AJa=function(){this.Em&&(this.Em.close(),this.Em=null)};eg.prototype.mT=function(){1!==be.AFrameworkApplication.sa.state&&this.$s().displayError(ke.default)};eg.prototype.yRa=function(){ud.ULS.sendTraceTag(6590599,
216,50,"Redirecting to OneDrive Folder.");hh.a.wf(this.E9,hh.a.sY(3),void 0,"UploadToCloudManager.RedirectToFolder")};eg.prototype.xRa=function(K){var na=!1,Xa=!1;be.AFrameworkApplication.ha&&(na=be.AFrameworkApplication.ha.ra("SaveACopyIsEnabledForUiHost"),Xa=be.AFrameworkApplication.ha.ra("UiHostSupportsDocRebootFeatures"));ud.ULS.sendTraceTag(6654163,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",K,na);if(na&&Xa){ud.ULS.sendTraceTag(594929733,216,50,"UploadToCloudManager.RedirectToEditUrl: Sending DocumentRefresh post message.");
var Qb={};Qb[rg.a.sRa]="1";Qb[rg.a.documentUrl]=K;be.AFrameworkApplication.jW().execute(function(tc){tc.Nj(th.a.Zua,Qb)})}else hh.a.wf(K,hh.a.sY(3),void 0,"UploadToCloudManager.RedirectToEditUrl")};eg.prototype.fpa=function(K,na,Xa,Qb){Xa=void 0===Xa?null:Xa;Qb=void 0===Qb?null:Qb;ud.ULS.sendTraceTag(7143886,216,50,"Starting to upload file");this.Ih&&(this.vha=this.Ih.Hc("DialogShown","SaveToOneDriveUploadTime"));this.kNb();this.E9=na;this.LDa=this.kVc.create(K,Xa,Qb);this.Oh=Qb;this.vR()};eg.prototype.vR=
function(){ud.ULS.sendTraceTag(6590600,216,50,"Calling SkydriveUploadHandler.");this.LDa.execute(Object(Vf.a)(this,this.EWi,"onSaveToCloudUploadFinished"),Object(Vf.a)(this,this.DWi,"onSaveToCloudUploadFailed"))};eg.prototype.EWi=function(K){this.AJa();this.sEa=!1;if(K&&K.data&&K.data.oe){var na=$h.d(K.data.oe);var Xa=na.ev;if(na.returnValue)if(Xa.StatusCode!==zh.a.SP&&Xa.StatusCode!==zh.a.itb)ud.ULS.sendTraceTag(6590602,216,10,"UploadToCloudManager upload failure. Response data is not JSON."),this.mT();
else{ud.ULS.sendTraceTag(6590603,216,50,"UploadToCloudManager upload success.");try{Xa.NewDocumentUrl&&""!==Xa.NewDocumentUrl?this.xRa(Xa.NewDocumentUrl):this.yRa()}catch(Qb){ud.ULS.sendTraceTag(37025728,216,15,"Redirect failed with exception: {0}",Qb.toString())}this.nHb()}else Xa={},ud.ULS.sendTraceTag(7660114,216,10,"Failed to deserialize : {0}",(Xa.ResponseData=Eh.a.ngb(K.data.oe),Xa)),this.mT()}else ud.ULS.sendTraceTag(6590601,216,10,"UploadToCloudManager upload failure. Response data is null"),
this.mT()};eg.prototype.DWi=function(K){5!==K.data.status&&12!==K.data.status||this.sEa?(ud.ULS.sendTraceTag(6590605,216,10,"UploadToCloudManager HTTP failure with code: {0}",K.data.status),this.AJa(),this.mT(),this.nHb()):(ud.ULS.sendTraceTag(6590604,216,10,"UploadToCloudManager failure. Retrying."),this.sEa=!0,this.vR())};eg.prototype.nHb=function(){this.vha&&(this.vha.stop(),this.vha=null)};Object(Sd.a)(eg,"UploadToCloudManager",null,[737]);Ef.prototype.init=function(){be.AFrameworkApplication.ha.ra("SaveToCloudStorageUIIsEnabled")&&
this.tb.resolve("Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Sg()};Ef.prototype.dispose=function(){};Ef.prototype.hi=function(K){this.tb=K;this.tb.register(vc,"Common.App.SaveToCloudStorage.SignInDialogFactory").as("Common.App.SaveToCloudStorage.ISignInDialogFactory").Nc(function(){return new vc(be.AFrameworkApplication.Ib,ph.a.instance,be.AFrameworkApplication.sa.Qa)}).Ic();this.tb.register(Na,"Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory").as("Common.App.SaveToCloudStorage.ISkydriveUploadCallerFactory").Nc(function(){return new Na(be.AFrameworkApplication.ha)}).Ic();
this.tb.register(Md,"Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Nc(function(){return new Md(K.resolve("Common.App.SaveToCloudStorage.SaveToCloudManager"),K.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),be.AFrameworkApplication.ha,be.AFrameworkApplication.sa.gE)}).Ic();this.tb.register(eg,"Common.App.SaveToCloudStorage.UploadToCloudManager").Nc(function(){return new eg(K.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),function(){return(new Ah.a).create()},
function(){return new mc},be.AFrameworkApplication.sa,be.AFrameworkApplication.sa.gE)}).Ic();this.tb.register(Ed,"Common.App.SaveToCloudStorage.SaveToCloudManager").Nc(function(){return new Ed(K.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),ph.a.instance,K.resolve("Common.App.SaveToCloudStorage.UploadToCloudManager"),be.AFrameworkApplication.ha,be.AFrameworkApplication.w3a,function(){return new mc})}).Ic()};Ef.main=function(){Mf.a.instance.nj(new Ef)};uk.Object.defineProperties(Ef.prototype,
{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.SaveToCloudStorage"}}});Object(Sd.a)(Ef,"PackageManager",null,[4,5]);uk.Object.defineProperties(lg,{ig:{configurable:!0,enumerable:!0,get:function(){return oh.a.Qn(lg.fk,CommonUIStrings.l_SaveACopyFileName)}}});lg.fk="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(Sd.a)(lg,"FileNameDialogHtml",null,[]);var Ph=oh.a;Am(Eg,Ph);Eg.prototype.nR=function(K,na,Xa){this.lUb=K;this.E9=Xa;K={};na=(K.txtFileName=Cf.a.Lq(be.AFrameworkApplication.Ll.fn),K.lblFolderName=String.format(CommonUIStrings.l_DestinationFolder,na),K);this.initializeAndShow(CommonUIStrings.l_SaveToOneDrive,Object(Vf.a)(this,this.tac,"fileNameDialogHandler"),na);ud.ULS.sendTraceTag(7174148,216,50,"The file name dialog is initialized and shown.");document.getElementById("txtFileName").focus()};
Eg.prototype.tac=function(K,na){1!==K?ud.ULS.sendTraceTag(7165650,216,50,"User click cancel to cancel upload file in file name dialog."):(K=na.txtFileName.trim(),ud.ULS.sendTraceTag(7165651,216,50,"User click save to upload file with new name."),na=Cf.a.j5(be.AFrameworkApplication.fileName),K&&""!==K&&""!==na&&(K+=na),this.Znb.fpa(this.lUb,this.E9,K,this.Oh))};Object(Sd.a)(Eg,"FileNameDialog",oh.a,[892]);Ee.prototype.create=function(K){return new Eg(this.La,this.AY,this.Znb,K)};Object(Sd.a)(Ee,"FileNameDialogFactory",
null,[872]);var Di=Sh.StandardDialog;Am(Of,Di);Of.prototype.displayError=function(K){ud.ULS.sendTraceTag(7165652,216,50,"Show error dialog here {0}.",K);this.lA(K,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,Object(Vf.a)(this,this.ROd,"retryDialogHandler"))};Of.prototype.ROd=function(K){1===K?(ud.ULS.sendTraceTag(7165653,216,50,"User click to retry the action."),this.La.processAction(gg.a.saveACopy,2)):ud.ULS.sendTraceTag(7165654,216,50,"User cancel the error dialog.")};
Object(Sd.a)(Of,"RetryDialog",Sh.StandardDialog,[871]);Am(Qd,Md);Qd.prototype.L8a=function(){return this.vb.ra("SaveACopyBrsIsEnabled")};Qd.prototype.z_e=function(){return gg.a.saveACopy};Qd.prototype.e3b=function(){Hi.a.aLd(Object(Vf.a)(this,this.RZf,"saveToCloudActionDispatcher"));Hi.a.ead([new bg.a(gg.a.saveACopy,Sg.a.frame,0)],this.gxg.u5a())};Qd.prototype.jRf=function(){ud.ULS.sendTraceTag(7205456,216,50,"User clicked on SaveAs button from the backstage.")};Object(Sd.a)(Qd,"SaveACopyActor",Md,
[]);Am(Le,Ed);Le.prototype.onSuccess=function(K){K&&K.data&&K.data.folders?(ud.ULS.sendTraceTag(7165655,216,50,"User selected which folder to upload file to."),this.Asg.create(this.Oh).nR(K.data.folders[0].id,K.data.folders[0].name,K.data.folders[0].urls.viewInBrowser)):(ud.ULS.sendTraceTag(7165656,216,10,"Fail to select folder to upload file."),this.zi())};Le.prototype.b7=function(K){K&&K.error&&"user_canceled"===K.error.code&&ud.ULS.sendTraceTag(7205457,216,50,"User cancelled upload to their OneDrive in Save A Copy.");
Ed.prototype.b7.call(this,K)};Le.prototype.zi=function(){ud.ULS.sendTraceTag(7205458,216,50,"Error occur in Save A Copy Manager.");Ed.prototype.zi.call(this)};Object(Sd.a)(Le,"SaveACopyManager",Ed,[]);Am(ug,eg);ug.prototype.Btd=function(){return!!this.Oh&&!!this.Oh.SaveEntryPoint&&"VersionHistory"===this.Oh.SaveEntryPoint.toString()};ug.prototype.mT=function(){ud.ULS.sendTraceTag(7205459,216,50,"Display Error for Save A Copy.");if(this.Btd()){var K={};this.La.Be(gg.a.KNd,2,(K.FailureReason="Unknown",
K))}eg.prototype.mT.call(this)};ug.prototype.yRa=function(){ud.ULS.sendTraceTag(7205460,216,50,"Redirecting to OneDrive Folder for Save A Copy.");this.Btd()&&this.La.processAction(gg.a.Nvc,2);eg.prototype.yRa.call(this)};ug.prototype.xRa=function(K){ud.ULS.sendTraceTag(7205461,216,50,"Redirecting to edit url {0} for Save A Copy.",K);this.Btd()&&this.La.processAction(gg.a.Nvc,2);eg.prototype.xRa.call(this,K)};ug.prototype.vR=function(){var K=this;this.Oh&&"true"===this.Oh.SkipSaveToHost?eg.prototype.vR.call(this):
32!==this.La.processAction(gg.a.wSa,1)?(ud.ULS.sendTraceTag(8741711,216,15,"The save file change is not supported, this operation may result in data loss"),eg.prototype.vR.call(this)):this.La.Be(gg.a.wSa,2,[function(){ud.ULS.sendTraceTag(8741712,216,50,"Call the force save file change successfully.");eg.prototype.vR.call(K)},function(){ud.ULS.sendTraceTag(8741713,216,15,"The file change is not saved successfully, this operation may lead to data loss.");K.mT()}])};Object(Sd.a)(ug,"SaveACopyUploadToCloudManager",
eg,[]);Tf.prototype.init=function(){be.AFrameworkApplication.ha.tv(Object(Vf.a)(this,this.OB,"onFullAppSettingsReady"))};Tf.prototype.OB=function(){be.AFrameworkApplication.ha.ra("SaveACopyBrsIsEnabled")&&this.tb.resolve("Common.App.SaveACopy.SaveACopyActor").Sg()};Tf.prototype.dispose=function(){};Tf.prototype.hi=function(K){this.tb=K;this.tb.register(ug,"Common.App.SaveACopy.SaveACopyUploadToCloudManager").Nc(function(){return new ug(be.AFrameworkApplication.Ib,K.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),
function(){return(new Ah.a).create()},function(){return new Of(be.AFrameworkApplication.Ib)},be.AFrameworkApplication.sa,be.AFrameworkApplication.sa.gE)}).Ic();this.tb.register(Ee,"Common.App.SaveACopy.FileNameDialogFactory").as("Common.App.SaveACopy.IFileNameDialogFactory").Nc(function(){return new Ee(be.AFrameworkApplication.Ib,be.AFrameworkApplication.sa.Qa,K.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"))}).Ic();this.tb.register(Qd,"Common.App.SaveACopy.SaveACopyActor").Nc(function(){return new Qd(K.resolve("Common.App.SaveACopy.SaveACopyManager"),
K.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),be.AFrameworkApplication.ha,be.AFrameworkApplication.sa.gE)}).Ic();this.tb.register(Le,"Common.App.SaveACopy.SaveACopyManager").Nc(function(){return new Le(K.resolve("Common.App.SaveACopy.FileNameDialogFactory"),K.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),ph.a.instance,K.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"),be.AFrameworkApplication.ha,be.AFrameworkApplication.w3a,function(){return new Of(be.AFrameworkApplication.Ib)})}).Ic()};
Tf.main=function(){Mf.a.instance.nj(new Tf)};uk.Object.defineProperties(Tf.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.SaveACopy"}}});Object(Sd.a)(Tf,"PackageManager",null,[4,5]);var Fg;(function(K){K[K.myFiles=0]="myFiles";K[K.recent=1]="recent";K[K.currentFolder=2]="currentFolder";K[K.yourPhone=3]="yourPhone"})(Fg||(Fg={}));Object(Sd.b)("SharedFilePickerLandingLocation",Fg);Wf.prototype.s3a=function(K){this._initialized||(K.mo(th.a.TQf),K.Vl(th.a.TQf,Object(Vf.a)(this,
this.OVi,"onReceivedPickerResponse")),this._initialized=!0)};Wf.prototype.xhd=function(K){var na=this;return this.yMa=new Promise(function(Xa,Qb){var tc={};tc[rg.a.G2i]=K;na.Jbb=function(md,Dd){""===Dd?(ud.ULS.sendTraceTag(572548163,306,50,"Resolving Promise with Picker Data"),Xa(md)):("Canceled"===Dd?ud.ULS.sendTraceTag(572548164,306,50,Dd):ud.ULS.sendTraceTag(556901065,306,10,Dd),Qb(Dd))};na.Fnd.execute(function(md){na.s3a(md);md.Nj(th.a.L_i,tc)})})};Wf.prototype.OVi=function(K){this.Jbb(K.Values[rg.a.zrj],
void 0===K.Values[rg.a.PGd]||null===K.Values[rg.a.PGd]?"":K.Values[rg.a.PGd])};Wf.prototype.Rtd=function(){return be.AFrameworkApplication.ha.ra("UiHostCommonFilePicker")};Wf.prototype.CHe=function(K,na,Xa,Qb,tc,md,Dd){var ue=void 0===ue?null:ue;var Ce={};Ce[rg.a.lrj]=K;Ce[rg.a.titleText]=na;Ce[rg.a.bNg]=Xa;Ce[rg.a.cNg]=Qb;Ce[rg.a.dNg]=!1;Ce[rg.a.lkh]=!0;Ce[rg.a.MFh]=tc;Ce[rg.a.K2i]=md;Ce[rg.a.J2i]=Fg[Dd];We.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()&&(Ce[rg.a.L2i]="Dark");ue&&
(null!=ue.KYc&&(Ce[rg.a.KYc]=ue.KYc),null!=ue.xod&&(Ce[rg.a.xod]=ue.xod));return Ce};Object(Sd.a)(Wf,"SharedFilePickerManager",null,[704]);Uf.prototype.hi=function(K){this.tb=K;K.register(Wf,"Common.App.SharedFilePicker.SharedFilePickerManager").as("Common.App.SharedFilePicker.ISharedFilePicker").Ic().Nc(function(){return new Wf(K.qc("Postmessage.IHostPostmessenger"))})};Uf.prototype.init=function(){var K=this;be.AFrameworkApplication.ha.tv(function(){K.Fzb()})};Uf.prototype.Fzb=function(){this.tb.resolve("Common.App.SharedFilePicker.ISharedFilePicker")};
Uf.prototype.dispose=function(){};Uf.main=function(){Mf.a.instance.nj(new Uf)};uk.Object.defineProperties(Uf.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.SharedFilePicker"}}});Object(Sd.a)(Uf,"SharedFilePickerPackage",null,[4,5]);var $f=b(1337),Bg=b(1049);wf.prototype.ape=function(K){var na=!1;K&&(K.Z5c(),K.tWg&&(na=!1));return na};wf.prototype.m9g=function(){var K=be.AFrameworkApplication.sa.Qa;K=new $f.a(K.Yj,Bg.a.yec(),!1,1===K.dda);this.ape(K)&&ud.ULS.sendTraceTag(17571982,
306,50,"ChromeExtBannerDisplayed")};wf.prototype.G6b=function(K,na,Xa,Qb,tc,md){K=new $f.a(K,Xa,Qb,na,tc,md);this.ape(K)&&ud.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed")};wf.prototype.seh=function(){var K=be.AFrameworkApplication.sa.Qa,na=be.AFrameworkApplication.ha,Xa=K.Yj,Qb=1===K.dda;if(na.ra(Bg.a.M5h(Xa))){var tc=Bg.a.yec(),md=8<Yf.a.K6a;if(2!==Xa||2!==tc||!Qb){na=na.ra(Bg.a.N5h(Xa));var Dd=K.rZf(),ue=function(){return K.Tx};na&&!Bg.a.osd(Bg.a.ngd(Xa))&&this.G6b(Xa,Qb,tc,md,ue,Dd)}}};
wf.prototype.init=function(){var K=be.AFrameworkApplication.ha,na=K.ra("WildFireChromeExtensionEnabled");K=K.ra("WildFireChromeExtensionBar")&&na;Bg.a.Gzc&&K&&!Bg.a.osd(Bg.a.gCe)?this.m9g():(document.body&&Bg.a.IDj&&this.seh(),be.AFrameworkApplication.Ib.ic(gg.a.hwd,Sg.a.frame,Object(Vf.a)(this,this.hwd,"launchWildFireBusinessBar")))};wf.prototype.hwd=function(K,na,Xa,Qb,tc){if(1===Xa)return 32;if(!tc)return 8;this.G6b(tc.app,tc.mode,tc.platform,tc.useTwoButton,null,null);return 32};wf.prototype.dispose=
function(){};wf.prototype.hi=function(){};wf.main=function(){Mf.a.instance.nj(new wf)};uk.Object.defineProperties(wf.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.WildFire"}}});Object(Sd.a)(wf,"PackageManager",null,[4,5]);var uh=b(224),ei=b(1322),cg=uh.a;Am(se,cg);se.prototype.create=function(){this.Eb(this.$.da.Aa(5)||new ei.a(this.$,!this.$.Uba))};se.ka=function(K){K.da.Ha(4,new se(K))};Object(Sd.a)(se,"BusinessBarManagerFactory",uh.a,[]);var Gf=b(10),Zf;"undefined"==
typeof Zf&&(Zf={});window.MSOJS=Zf;Zf.Rhb=function(){function K(){return Dd()&&(Jj()||3<=(Dh()?dk("version/"):0))}function na(){return 0<=window.navigator.userAgent.indexOf("Windows")}function Xa(){return 0<=window.navigator.userAgent.indexOf("Windows Phone")}function Qb(){gl||(gl=!0,$k=tc("Windows Phone"))}function tc(Rf){Rf=(new RegExp(Rf+"\\s+(\\d+(\\.\\d*)?)")).exec(window.navigator.userAgent);var dh=-1;return null!=Rf&&2<=Rf.length&&(dh=parseFloat(Rf[1]),isNaN(dh)&&(dh=-1)),dh}function md(){return"function"==
typeof navigator.msLaunchUri&&!Xa()&&!wj()&&!ue()}function Dd(){return 0<=window.navigator.userAgent.indexOf("Macintosh")}function ue(){return 0<=window.navigator.userAgent.indexOf("Edge/")}function Ce(){return 0<=window.navigator.userAgent.indexOf(" MSIE ")||0<=window.navigator.userAgent.indexOf("Trident/")}function Kf(){return Ce()?8==window.document.documentMode:!1}function Wg(){return 0<=window.navigator.userAgent.indexOf(" Firefox/")}function Dh(){return 0<=window.navigator.userAgent.indexOf(" AppleWebKit/")}
function Ci(){return 0<=window.navigator.userAgent.toLowerCase().indexOf("chrome")}function wj(){var Rf=window.navigator.userAgent.toLowerCase();return 0<=Rf.indexOf("android")&&0<=Rf.indexOf("chrome")}function Jj(){return 3<=(Wg()?dk("firefox/"):0)}function dk(Rf){var dh=window.navigator.userAgent.toLowerCase(),Yh=dh.indexOf(Rf),Lh,Li;return 0<=Yh?(Lh=Yh+Rf.length,Li=dh.length,parseInt(dh.substring(Lh,Li))):0}function vj(Rf,dh,Yh,Lh,Li){if(Lh&&null!=dh)dh();else if(md())navigator.msLaunchUri(Rf,
dh,Yh);else if(!(Ci()||0<=window.navigator.userAgent.indexOf("iPhone")||0<=window.navigator.userAgent.indexOf("iPad")||0<navigator.maxTouchPoints&&Dd())||ue())aj(Rf,dh,Yh);else if(Ci()&&Li)a:{try{window.open(Rf,"_self")}catch(Wi){null!=Yh&&Yh();break a}null!=dh&&dh()}else hj(Rf,dh,Yh)}function hj(Rf,dh,Yh){var Lh=document.getElementById("OICLinkTag"),Li;null==Lh&&(Lh=document.createElement("a"),Lh.id="OICLinkTag",Lh.style.visibility="hidden",Lh.href="",Lh.target=0==(Rh.Options&tk.SupportsTopTargetNavigation)||
Rh.NoBrowserModalDialogs?"_blank":"_top",document.body.appendChild(Lh),null!=Lh.addEventListener&&Lh.addEventListener("click",function(Wi){null!=Wi.stopPropagation&&Wi.stopPropagation()},!1));try{"undefined"==typeof MouseEvent&&(Li=function(Wi){var Pi=document.createEvent("MouseEvent");return Pi.initMouseEvent(Wi,!1,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),Pi},Li.prototype=Event.prototype,window.MouseEvent=Li),Lh.href=Rf,Lh.dispatchEvent(new MouseEvent("click"))}catch(Wi){null!=Yh&&Yh();return}null!=
dh&&dh()}function aj(Rf,dh,Yh){var Lh=document.getElementById("OICFrame");null==Lh&&(Lh=document.createElement("iframe"),Lh.className="ObjectInDialog",Lh.style.visibility="hidden",Lh.src="about:blank",document.body.appendChild(Lh),Lh.id="OICFrame");try{Lh.contentWindow.location.href=Rf}catch(Li){null!=Yh&&Yh();return}null!=dh&&dh()}function Gk(Rf){return 0!=(Rf.Options&tk.SkipProtocolHandler)||Kf()}function Uk(Rf){return Rf===Hk.ReadOnly||Rf===Hk.ReadWrite}function Ok(Rf,dh,Yh,Lh){var Li,Wi;try{if(Li=
new ActiveXObject(G),Li)return Wi=Li.ViewDocument3(window.self,Rf,dh,Lh),Wi?(Xk(Pk.O14ActiveX),ij.None):ij.Failed}catch(Pi){}if(tk.O14Only===(Yh&tk.O14Only))return Rh.DescriptiveUnattemptedEnums?ij.O14AttemptFailure:ij.Unattempted;try{if(Li=new ActiveXObject(ja),Li)return Wi=Li.ViewDocument3(window.self,Rf,dh,Lh),Wi?(Xk(Pk.O12ActiveX),ij.None):ij.Failed}catch(Pi){}if(tk.O12UpOnly===(Yh&tk.O12UpOnly))return Rh.DescriptiveUnattemptedEnums?ij.O12UpOnlyFail:ij.Unattempted;try{if(Li=new ActiveXObject(Wa),
Li)return Wi=Uk(dh)?Li.ViewDocument2(window.self,Rf,Lh):Li.EditDocument2(window.self,Rf,Lh),Wi?(Xk(Pk.O11ActiveX),ij.None):ij.Failed}catch(Pi){}return Rh.DescriptiveUnattemptedEnums?ij.ActiveXUnattempted:ij.Unattempted}function il(Rf,dh,Yh,Lh,Li){var Wi,Pi,ak;Rf==xj.Visio&&Yh==Hk.ReadWrite&&(Yh=Hk.WriteOnly);Rf=Li;(Lh=Lh||Xa()&&!(Qb(),8<=$k))||(Wi="",Wi+=Uk(Yh)?Nc+kd:Xc,Wi+=Ie,Rf+=jl(Wi));Rf+=jl(dh);Rh.NewTelemetryDataIsEnabled&&(Pi=-1!==Rf.indexOf("?")?"&":"?",Pi+=Rh.SessionOrigin?"OR="+Rh.SessionOrigin+
"&":"",Pi+=Rh.ClickTime?"CT="+Rh.ClickTime+"&":"",Pi+=Rh.CorrelationId?"CID="+Rh.CorrelationId:"",Pi="?"!=Pi?Pi:"",Pi="&"!=Pi.slice(-1)?Pi:Pi.slice(0,-1),Rf+=jl(Pi));dh=window.location.href;Yh=Sf;Lh=dh.toLowerCase().indexOf("&"+Yh+"=");var Fj;Yh=-1==Lh?void 0:(ak=Lh+(Yh.length+2),Fj=dh.indexOf("&",ak),-1==Fj)?dh.substr(ak):dh.substring(ak,Fj);if(null!=Yh&&"undefined"!=typeof Yh){ak="";try{ak=decodeURIComponent(Yh)}catch(Qk){}0<ak.length&&RegExp("(c|t)[\\w]{8}-[\\w]{4}-[\\w]{4}-[\\w]{4}-[\\w]{12}").test(ak)&&
(Rf+=Ze,Rf+=ak)}return Rf}function Vk(Rf,dh,Yh,Lh,Li,Wi){var Pi=fl(Rf),ak;return null==Pi?(Yk(Rh.DescriptiveUnattemptedEnums?ij.ProtocolHandlerIsNull:ij.Unattempted,Rh.Application),!1):(ak=il(Rf,dh,Yh,Lh,Pi),vj(ak,pl,ql,Li,Wi),!0)}function jl(Rf){if(Dd()&&Ci()){var dh="";try{dh=decodeURI(Rf)}catch(Yh){}if(dh==Rf)return encodeURI(Rf)}return Rf}function pl(){Xk(Pk.ProtocolHandler)}function ql(){Rh.Options|=tk.SkipProtocolHandler;tl(Rh,Hh,ji)}function vl(){null!=kj&&kj(Pk.RoamingProtocolHandler)}function wl(){null!=
Ej&&Ej(ij.ControlNeeded)}function sl(){var Rf=document.getElementById(Ia),dh;if(null==Rf){if(dh=vb,Dd()&&3<=(Dh()?dk("version/"):0)&&Wk(f,!0)&&(dh=f),!Wk(dh,!0))if(Dd()&&Wk(fa,!0))dh=fa;else return null;Rf=document.createElement("object");Rf.id=Ia;Rf.type=dh;Rf.style.width="0px";Rf.style.height="0px";Rf.style.setProperty("visibility","hidden","");document.body.appendChild(Rf);Rf=document.getElementById(Ia)}return Rf}function Wk(Rf,dh){var Yh=window.navigator.mimeTypes,Lh;return null==Yh?!1:(Lh=Yh[Rf],
Lh)?dh&&!Lh.enabledPlugin?!1:!0:!1}function nl(Rf){try{if(null!=new ActiveXObject(Rf))return!0}catch(dh){}return!1}function kl(Rf){switch(Rf){case xj.OneNote:return Wb;default:return""}}function fl(Rf){if(Rf!=xj.OneNote&&Xa()&&!(Qb(),8<=$k))return"office:";switch(Rf){case xj.Excel:return"ms-excel:";case xj.OneNote:return"onenote:";case xj.PowerPoint:return"ms-powerpoint:";case xj.Visio:return"ms-visio:";case xj.Word:return"ms-word:";case xj.Project:return"ms-project:";case xj.Publisher:return"ms-publisher:";
case xj.Infopath:return"ms-infopath:";case xj.Access:return"ms-access:";default:return""}}function rl(Rf){switch(Rf){case xj.Excel:return"root\\office15\\excel.exe";case xj.PowerPoint:return"root\\office15\\powerpnt.exe";case xj.Visio:return"root\\office15\\visio.exe";case xj.Word:return"root\\office15\\winword.exe";case xj.Project:return"root\\office15\\winproj.exe";case xj.Publisher:return"root\\office15\\mspub.exe";case xj.Infopath:return"root\\office15\\infopath.exe";case xj.Access:return"root\\office15\\msaccess.exe";
default:return null}}function tl(Rf,dh,Yh){if(Rh=Rf,Hh=dh,ji=Yh,Rf.DocumentUrl){var Lh=Yh=dh=Rf.DocumentUrl;try{Lh=decodeURIComponent(Rf.DocumentUrl)}catch(Qk){}try{Yh=encodeURI(Rf.DocumentUrl)}catch(Qk){}dh=dh+""+Rf.CorrelationIdForWinClient;Lh+=Rf.CorrelationIdForWinClient;Yh+=Rf.CorrelationIdForWinClient;Rf.Mode===Hk.ReadWrite&&tk.CheckoutRequired===(Rf.Options&tk.CheckoutRequired)&&(Rf.Mode=Hk.ForceCheckout);tk.HostIsEditOnly===(Rf.Options&tk.HostIsEditOnly)&&(Rf.Mode=Hk.WriteOnly);if(Gk(Rf)?
0:Dd()&&(Rf.Application==xj.OneNote||Wk(D,!1)||Wk(N,!1))||md()||wj()||!(K()||Jj()||"ActiveXObject"in window&&!Xa()||Ci())||15<=ol())Vk(Rf.Application,Rf.EncodeUrl?Yh:dh,Rf.Mode,Rf.Application==xj.OneNote,Rf.SilentExternalHandler,Rf.NavigateUsingWindowOpen);else{var Li;if(Li=Kf())a:{var Wi=Rf.EncodeUrl?dh:Lh,Pi=Rf.Mode,ak=kl(Rf.Application);try{Li=(new ActiveXObject(sk)).ViewDocument3(window.self,Wi,Pi,ak);break a}catch(Qk){}Li=!1}if(Li)Xk(Pk.O15ActiveX);else{if(K()||Jj()){var Fj=Rf.EncodeUrl?dh:Lh;
Lh=Rf.Mode;Li=kl(Rf.Application);Wi=sl();if(null==Wi)Fj=Rh.DescriptiveUnattemptedEnums?ij.PluginIsNull:ij.Unattempted;else{Pi=!1;try{Pi=Wi.ViewDocument3(window.self,Fj,Lh,Li)}catch(Qk){}if(!Pi)try{Pi=Uk(Lh)?Wi.ViewDocument2(window.self,Fj,Li):Wi.EditDocument2(window.self,Fj,Li)}catch(Qk){}Fj=Pi?(Xk(Pk.NpapiPlugin),ij.None):ij.Failed}}else{try{Fj=new ActiveXObject(pb),null!=Fj&&Fj.SaveSSOCreds()}catch(Qk){}Fj=Ok(Rf.EncodeUrl?dh:Lh,Rf.Mode,Rf.Options,kl(Rf.Application))}if(Fj!=ij.None){if(Lh=Rf.CouldUseRoamingApps)Zk||
(Zk=!0,ll=tc("Windows NT")),Lh=6.1<=ll&&!(0<=window.navigator.userAgent.indexOf("ARM;"))&&(Ce()||Jj()||Ci());if(Lh&&Rf.Application!=xj.OneNote){if(!Zf.Rhb.V2j()){Yk(ij.ControlNeeded,Rh.Application);return}if(Rf.RoamingAppsLauncher){"undefined"==typeof Rf.RoamingAppsLauncher||null==Rf.RoamingAppsLauncher?Yk(Rh.DescriptiveUnattemptedEnums?ij.RoamingLauncherIsNull:ij.Unattempted,Rh.Application):"undefined"==typeof Rf.RoamingBitsUrl||null==Rf.RoamingBitsUrl?Zf.Rhb.i3j(Rf.DocumentUrl,Rf.RoamingAppsLauncher,
Rf.Application,Rf.ApplicationParameters,Hh,ji):Zf.Rhb.ang(Rf.DocumentUrl,Rf.RoamingAppsLauncher,Rf.RoamingApplicationExe,Rf.ApplicationParameters,Rf.RoamingPlatform,Rf.RoamingBitsUrl,Hh,ji);return}if(!Rf.ContinueIfLauncherIsNull){Yk(ij.LauncherNeeded,Rh.Application);return}}tk.NoProtocolHandlerFallback==(Rf.Options&tk.NoProtocolHandlerFallback)||Gk(Rf)||Ce()||Dd()&&!(Rh.DescriptiveUnattemptedEnums?Fj>=ij.O14Unattempted&&Fj<=ij.DocumentUrlIsNull:Fj==ij.Unattempted)?Yk(Fj,Rh.Application):Vk(Rf.Application,
Rf.EncodeUrl?Yh:dh,Rf.Mode,Rf.Application==xj.OneNote,Rf.SilentExternalHandler,Rf.NavigateUsingWindowOpen)}}}}else Yk(Rh.DescriptiveUnattemptedEnums?ij.DocumentUrlIsNull:ij.Unattempted,Rh.Application)}function Xk(Rf){null!=Hh&&Hh(Rf)}function Yk(Rf,dh){"undefined"==typeof dh&&(dh=null);null!=ji&&ji(Rf,dh)}function ol(){var Rf=0;if(K()||Jj()||Ci()){var dh=sl();try{null!=dh&&(Rf=dh.GetOfficeVersion())}catch(Yh){}}else nl(sk)?Rf=15:nl(G)?Rf=14:nl(ja)?Rf=12:nl(Wa)&&(Rf=11);return Rf}function ul(){return Dd()&&
(Wk(vb,!0)||Wk(f,!0))}var sk="SharePoint.OpenDocuments.5",G="SharePoint.OpenDocuments.4",ja="SharePoint.OpenDocuments.3",Wa="SharePoint.OpenDocuments.2",vb="application/x-sharepoint",f="application/x-sharepoint-webkit",D="application/x-sharepoint-protocolhandler",N="application/x-sharepoint-webkit-protocolhandler",fa="application/officelive",Ia="npSharePointPlugin",pb="IDBHO.IDBHOCtrl",Wb="OneNote.Notebook",Nc="ofv|",kd="ofc|",Xc="ofe|",Ie="u|",Ze="|f|",Sf="wdlor",ag="",og="",Vg="",Hh,ji,kj,Ej,Rh,
Zk,ll,gl,$k,Hk={ReadWrite:0,ReadOnly:1,WriteOnly:2,ForceCheckout:3,WriteLocalCopy:4,OpenInBrowser:5},tk={None:0,CheckoutRequired:1,O14Only:2,HostIsEditOnly:4,O12UpOnly:8,SkipProtocolHandler:16,NoProtocolHandlerFallback:32,SupportsTopTargetNavigation:64},ij={None:0,Failed:1,Unattempted:2,LauncherNeeded:3,ControlNeeded:4,PopupBlocked:5,O14Unattempted:6,O12UpOnlyUnattempted:7,PluginIsNull:8,ActiveXUnattempted:9,ProtocolHandlerIsNull:10,ProtocolHandlerNoCallbackIsNull:11,RoamingLauncherIsNull:12,DocumentUrlIsNull:13},
Pk={Unknown:0,NpapiPlugin:1,O10ActiveX:2,O11ActiveX:3,O12ActiveX:4,O14ActiveX:5,ProtocolHandler:6,RoamingActiveX:7,RoamingFFExtension:8,RoamingProtocolHandler:9,O15ActiveX:10},xj={Unknown:0,Excel:1,OneNote:2,PowerPoint:3,Visio:4,Word:5,Project:6,Publisher:7,Infopath:8,Access:9};return{OpenDocumentMode:Hk,OpenDocumentOptions:tk,OpenDocumentFailureType:ij,OpenDocumentControl:Pk,OfficeApplication:xj,EditDocumentInClient:tl,EditDocumentInClientParams:function(){this.DocumentUrl="";this.Options=this.Mode=
0;this.Application=xj.Unknown;this.CouldUseRoamingApps=!1;this.RoamingAppsLauncher="";this.ContinueIfLauncherIsNull=!1;this.RoamingBitsUrl=this.RoamingApplicationExe=this.RoamingPlatform=this.ApplicationParameters="";this.EncodeUrl=this.SilentExternalHandler=!1;this.CorrelationIdForWinClient="";this.NewTelemetryDataIsEnabled=this.NoBrowserModalDialogs=this.DescriptiveUnattemptedEnums=this.NavigateUsingWindowOpen=!1;this.SessionOrigin=this.ClickTime=this.CorrelationId=""},OfficeVersionInstalled:ol,
IsO14MacPluginInstalled:ul,OfferOfficeInDialog:function(){return na()&&11>=ol()},OfferOfficeNoIntrusive:function(){return na()&&15>ol()},OfferMacOffice:function(){return Dd()&&!(0<=window.navigator.userAgent.indexOf("PPC Mac"))&&!ul()},InstallRoamingControl:function(){Wg()?window.InstallTrigger.install({Office:{URL:og}}):aj(Vg,null,null)},CanUseRoamingControl:function(){var Rf,dh,Yh;if(md())return!0;if(Ci())return"undefined"!=typeof navigator.plugins.refresh&&navigator.plugins.refresh(!1),!!navigator.mimeTypes["application/x-vnd.officeondemand"];
if(Wg())return Rf=document.createElement("RoamingExtensionElement"),document.documentElement.appendChild(Rf),dh=document.createEvent("Events"),dh.initEvent("RoamingOfficeInstalled",!0,!1),Rf.dispatchEvent(dh),!!Rf.getAttribute("installed");if(Ce())try{return Yh=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),Yh.HrExists()}catch(Lh){}return!1},InitUrls:function(Rf,dh,Yh){ag=Rf;og=Yh;Vg=dh},LaunchRoamingApps:function(Rf,dh,Yh,Lh,Li,Wi){Zf.Rhb.ang(Rf,dh,rl(Yh),Lh,"x86",ag,Li,Wi)},LaunchRoamingApps2:function(Rf,
dh,Yh,Lh,Li,Wi,Pi,ak){var Fj="",Qk;if(null!=Lh&&(Fj+=" "+Lh),null!=Rf&&(Fj+=' "'+Rf+'"'),md()||Ci())kj=Pi,Ej=ak,Pi='office: "'+(Wi+'" "')+(Yh+'" "ROAMING"'),Pi+=' "'+dh+'"',Pi+=' "'+Li+'"',Pi+=" "+Fj,vj(Pi,vl,wl,!1,!1);else if(Wg())Rf=document.createElement("RoamingExtensionElement"),Rf.setAttribute("cabUrl",Wi),Rf.setAttribute("app",Yh),Rf.setAttribute("licensingEntitlements",dh),Rf.setAttribute("platform",Li),Rf.setAttribute("args",Fj),document.documentElement.appendChild(Rf),dh=document.createEvent("Events"),
dh.initEvent("RoamingOfficeLaunch",!0,!1),Rf.dispatchEvent(dh),null!=Pi&&Pi(Pk.RoamingFFExtension);else if(Ce()){if(Qk=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),null!=Qk)try{Qk.HrConfigureSingle(Wi,Yh,dh,Li,Fj),null!=Pi&&Pi(Pk.RoamingActiveX)}catch(xl){}}else null!=ak&&ak(ij.Failed)},ShouldShowDialog:function(){return!Xa()},NavigateToUrlUsingClickingOnATag:hj,OpenDocumentWithProtocolHandler:Vk,OpenDocumentWithProtocolHandlerNoCallBack:function(Rf,dh,Yh,Lh){var Li=fl(Rf),Wi;return null==
Li?(Yk(Rh.DescriptiveUnattemptedEnums?ij.ProtocolHandlerNoCallbackIsNull:ij.Unattempted,Rh.Application),!1):(Wi=il(Rf,dh,Yh,Lh,Li),vj(Wi,null,null,!1,!1),!0)}}}();Zf.ClientUtils=Zf.Rhb;var eh=b(905),wh=b(51),Yg=b(35),k=b(184);vf.prototype.$c=function(){return!1};vf.prototype.executeCommand=function(K,na,Xa){return 2!==this.Ki.Be(gg.a.newDocument,2,Xa)?Kg.Task.Sa(!0):k.a(na.command)};vf.prototype.Mc=function(K,na){return 1056925771===na.command};vf.prototype.nd=function(K,na,Xa){K=!0;switch(na){case "PopulateNewMenu":this.Ki&&
this.Ki.Be(gg.a.qsc,2,Xa);break;default:K=!1}return K};Object(Sd.a)(vf,"CreateNewCommandHandler",null,[434]);var Ab=eh.a;Am(lf,Ab);lf.prototype.Qd=function(){var K=this,na=wh.GetServiceTaskFactory.create(this.$.da,155,this.la,this.ub),Xa=wh.GetServiceTaskFactory.create(this.$.da,165,this.la,this.ub);Yg.TaskExtensions.Ba(Yg.TaskExtensions.we([na,Xa],this.la),function(){K.Jd([new vf(be.AFrameworkApplication.Ib)])},this.la,3)};lf.ka=function(K){eh.a.je(87,new lf(K))};Object(Sd.a)(lf,"CreateNewCommandHandlerFactory",
eh.a,[]);var oc=b(1318),R=b(962),Ba=b(273),d=b(204),x=b(299),M=b(5),V=b(159),ca=b(101),Oa=b(78),Fb=b(74),lc=b(387),Oc=b(173),wd=b(58),Rd=b(83),Oe=b(336),la=b(647);Je.prototype.mwe=function(){};Je.prototype.J9c=function(){this.lxg?hh.a.downloadFile(this._url):hh.a.wf(this._url,"_blank",void 0,"OpenUrlInTabDialogDownloadBehavior:DoDownload")};Je.prototype.dispose=function(){};Object(Sd.a)(Je,"OpenUrlInTabDialogDownloadBehavior",null,[346,3]);var $a=b(255),Yb=Sh.StandardDialog;Am(Wd,Yb);Wd.prototype.WZc=
function(){this.fm&&(this.pXa||(this.pXa=Object(Vf.a)(this,this.iLi,"onActionButtonClicked"),this.cz.qa(Bf.a.click,this.hC,this.pXa)),this.qXa||(this.qXa=Object(Vf.a)(this,this.jLi,"onActionButtonKeyUp"),this.pe.qa(Bf.a.Td,this.hC,this.qXa)));Yb.prototype.WZc.call(this)};Wd.prototype.iLi=function(K){this.qVe(K);return!0};Wd.prototype.jLi=function(K){return this.bnf(K,Object(Vf.a)(this,this.qVe,"executeDismissActionButtonFromArgs"))};Wd.prototype.qVe=function(K){this.fm&&this.fm.submit();this.Dva(K.Mb)};
Wd.prototype.exd=function(){};Wd.prototype.lNe=function(){this.$pf();this.fm?this.fm.submit():this.CTb.J9c();return!0};Wd.prototype.Dlc=function(){return!1};Wd.prototype.dispose=function(){this.CTb.dispose();this.Cjb&&(be.AFrameworkApplication.sa.gY.za(Bf.a.click,this.Cjb,Object(Vf.a)(this,this.lNe,"downloadLinkClicked")),this.Cjb=null);this.TY&&(be.AFrameworkApplication.sa.gY.za(Bf.a.click,this.TY,Object(Vf.a)(this,this.Dlc,"learnMoreLinkClicked")),this.TY=null);this.cz&&this.pXa&&(this.cz.za(Bf.a.click,
this.hC,this.pXa),this.pXa=null);this.pe&&this.qXa&&(this.pe.za(Bf.a.Td,this.hC,this.qXa),this.qXa=null);Yb.prototype.dispose.call(this)};Wd.prototype.UPf=function(){this.fm&&(document.body.appendChild(this.fm),this.fm.submit(),document.body.removeChild(this.fm))};Wd.prototype.Cw=function(K){1===K&&(this.exd(),this.fm?Wd.Yy&&this.UPf():this.CTb.J9c());this.dispose()};uk.Object.defineProperties(Wd.prototype,{Dcf:{configurable:!0,enumerable:!0,get:function(){return null}},XYd:{configurable:!0,enumerable:!0,
get:function(){return null}},qPa:{configurable:!0,enumerable:!0,get:function(){return null}},WCb:{configurable:!0,enumerable:!0,get:function(){return null}},u9a:{configurable:!0,enumerable:!0,get:function(){return null}},luf:{configurable:!0,enumerable:!0,get:function(){return!1}},buttonText:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_Open}},s7c:{configurable:!0,enumerable:!0,get:function(){return null}},sYc:{configurable:!0,enumerable:!0,get:function(){return null}},Ase:{configurable:!0,
enumerable:!0,get:function(){return null}}});uk.Object.defineProperties(Wd,{Yy:{configurable:!0,enumerable:!0,get:function(){return be.AFrameworkApplication.sa.Qa.Tw&&be.AFrameworkApplication.sa.Qa.hkf}},Yyb:{configurable:!0,enumerable:!0,get:function(){return Wd.iae},set:function(K){Wd.iae=K}}});Wd.iae=!1;Object(Sd.a)(Wd,"ADialogWithLinkToResource",Sh.StandardDialog,[]);var Jc=b(439),td=b(331),Tc=b(14);Am(le,Wd);le.prototype.Ypf=function(){ud.ULS.sendTraceTag(537162658,0,50,"DownloadACopyAsOdsDialog.LogDialogDisplayed - ODS download dialog displayed")};
le.prototype.$pf=function(){ud.ULS.sendTraceTag(537162657,0,50,"DownloadACopyAsOdsDialog.LogDownloadLinkClicked - ODS download dialog link clicked")};le.prototype.Dlc=function(){Jc.Redirect.showHelp(td.a.EKi);return!0};uk.Object.defineProperties(le.prototype,{qPa:{configurable:!0,enumerable:!0,get:function(){return Tc.a.instance.Va(410)}},Klc:{configurable:!0,enumerable:!0,get:function(){return Tc.a.instance.Va(411)}},Jlc:{configurable:!0,enumerable:!0,get:function(){return"DownloadOdsLink"}},WCb:{configurable:!0,
enumerable:!0,get:function(){return"#"}},u9a:{configurable:!0,enumerable:!0,get:function(){return Tc.a.instance.Va(412)}},luf:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object(Sd.a)(le,"DownloadACopyAsOdsDialog",Wd,[]);Id.prototype.mwe=function(K){this.dialog=K};Id.prototype.J9c=function(){this.aLi.dJf(-1059172980)};Id.prototype.dispose=function(){this.yb.jJb(this.CAf)};Object(Sd.a)(Id,"DownloadACopyAsOdsDialogDownloadBehavior",null,[346,3]);Object(Sd.a)(xd,"MacroRecorderWorkbookCalculationModeSetPayload",
null,[428]);Object(Sd.a)(Gc,"MacroRecorderWorkbookRecalculatedPayload",null,[428]);var ve=b(193),Ye=b(108),Te=b(1),Qf=b(322);uk.Object.defineProperties(fc,{t_i:{configurable:!0,enumerable:!0,get:function(){return fc.s_i}}});fc.s_i="<div class='\"\"' id='OpenInAppDialog'> <div class='PrivacyDialogTitle UIFontDialogTitle' id='OpenInAppTitle'> <label id='OpenInAppTitle' class='\"\"' style='font-size:16pt' >{0}</label> </div> <div class='WACDialogRow' id='InfoMessageArea'> <label id='InfoMessageAreaLine1' class='\"\"' style='font-size:12pt' >{1}</label> <br/> </div> <br/> <div class='AppInstallButton' id='LinkToInstall' role='button' tabIndex='0'> <div class='clip32x32' id='BottomInfoIconClip' unselectable='on' style='display: inline-block; pointer-events:none;' role='img'> <img id='BottomIconInfo' class='{3}' role='presentation' src={2} /> </div> <div class='\"\"' id='AppstoreLink' style='display:inline-block; padding-top:4px; vertical-align:top;'> <label id='AppstoreLinkTitle' class='PrivacyDialogTitle' unselectable='on' style='font-size: 14pt; margin-left:8px' >{4}</label> </div> </div>";
Object(Sd.a)(fc,"OpenInAppDialogCopyHtml",null,[]);var kg=b(156),yg=Qf.a;Am(xf,yg);xf.prototype.openUrl=function(K,na){var Xa=document.getElementById("link");Xa||(Xa=document.createElement("a"),Xa.id="link",Xa.style.visibility="hidden",Xa.href="",document.body.appendChild(Xa));Xa.target=na;Xa.href=K;Xa.click()};xf.prototype.sGc=function(){var K=this;ud.ULS.sendTraceTag(529397968,306,50,"OpenInAppForLiveFiles API invoked");Yg.TaskExtensions.Ba(wh.GetServiceTaskFactory.Ua(this.$.da,21,137,1),function(na){var Xa=
{};Xa.OpenInAppUrl=K.Vma;Xa.StoreUrl=K.vm;na.result.Nj("UI_OpenInMobileApp",Xa)},this.$.la)};xf.prototype.u_i=function(){ud.ULS.sendTraceTag(529397967,306,100,"OpenInAppDialogHandler invoked")};xf.prototype.mh=function(){this.ig=oh.a.Qn(fc.t_i,Tc.a.instance.fa(655),Tc.a.instance.fa(656),be.AFrameworkApplication.mD,kg.getImageClass(be.AFrameworkApplication.ha.Wa("AppIcon")),Tc.a.instance.fa(657));this.Ve="OpenInAppDialog";this.lc=5;this.initializeAndShow("",this.u_i.bind(this),null);this.jA(this.uI)};
xf.prototype.Kv=function(K){yg.prototype.Kv.call(this,K);document.getElementById("WACDialogBodyPanel").style.padding="0 4px 0 24px";this.uI=document.getElementById("LinkToInstall");ve.a.instance.qa(Bf.a.click,this.uI,this.kFb);Ye.KeyInputManager.instance.qa(Bf.a.Td,this.uI,this.ina)};xf.prototype.dispose=function(){this.uI&&(ve.a.instance.za(Bf.a.click,this.uI,this.kFb),Ye.KeyInputManager.instance.za(Bf.a.Td,this.uI,this.ina),this.uI=null);yg.prototype.dispose.call(this)};uk.Object.defineProperties(xf.prototype,
{Cc:{configurable:!0,enumerable:!0,get:function(){return"OpenInAppDialogCopy"}}});Object(Sd.a)(xf,"OpenInAppDialogCopy",Qf.a,[]);Af.prototype.sGc=function(){var K=this;ud.ULS.sendTraceTag(523534413,306,50,"OpenInAppDialogReact: OpenInAppForLiveFiles API invoked");Yg.TaskExtensions.Ba(wh.GetServiceTaskFactory.Ua(this.$.da,21,137,1),function(na){var Xa={};Xa[rg.a.jJf]=K.Vma;Xa[rg.a.vm]=K.vm;na.result.Nj("UI_OpenInMobileApp",Xa)},this.$.la)};Af.prototype.mh=function(){ud.ULS.sendTraceTag(523534412,0,
50,"initializeAndShowDialog: React Edit in app dialog opened.");var K=new Sh.StandardDialog;K.lc=0;K.Bc(1,Tc.a.instance.fa(657));K.Fk(Tc.a.instance.fa(655),Tc.a.instance.fa(656),0,this.mng)};Object(Sd.a)(Af,"OpenInAppDialogReact",null,[]);var Lg=b(27),Mg=b(29),ai=b(371),Ug=b(8),nh=b(288),Og=b(20),Ei=b(42),Vh=b(256),Xi=b(491),yj=b(394),yi=b(49),Hg=b(6),ni=b(146),jj=b(1190),Y=b(80),Ra=b(33),Db=b(377),ec=b(258);qe.prototype.JR=function(K,na){K=Mg.a.ed(12,1,658,0,0,0,"Blank");K.Description=String.format(Tc.a.instance.fa(659),
na);return K};qe.prototype.Rbc=function(K){switch(K){case 1:case 2:return 0;default:return 2}};Object(Sd.a)(qe,"ReloadCloseConfirmation",null,[707]);var gd=b(154),Jd=b(648),Xd=b(65),xe=d.a;Am(he,xe);he.prototype.$c=function(){return!1};he.prototype.executeCommand=function(K,na,Xa,Qb){var tc=this,md=this.R8b,Dd=this.$,ue=na.command,Ce=this.openInExcelOperation,Kf=this.$.Lb,Wg=Xa.SourceControlId;Dd.Zk.$pe(ue);K=null;switch(ue){case 1455037301:this.$.k6?Ce.NFe():Ce.m5c();break;case -2044628748:case 2004484710:this.$.k6?
Ce.NFe():Ce.openInExcelClient();break;case 213236505:"ContextMenu.ShowOpenInAppDialogOnMobile"===Wg?(this.wDb("CellLongPress"),ud.ULS.sendTraceTag(576495705,0,50,"FileOperationsCommandHandler.ExecuteCommand: Open-in-app dialog invoked from cell long press")):(this.wDb("PencilIcon"),ud.ULS.sendTraceTag(576495704,0,50,"FileOperationsCommandHandler.ExecuteCommand: Open-in-app dialog invoked from pencil icon in toolbar"));this.showOpenInAppDialog();break;case -2028960985:Ce.Z9f();break;case -1059172980:new le(Ce.Kye(ue),
new Id(Ce,Dd.yb));break;case -1285148982:this.clientWorkflow.ud.activityState[Ra.a.xWc]=!0;this.SCc(!1);break;case -75280711:this.SCc(!1);break;case -455164169:this.SCc(!0);break;case -1388494670:this.$.da.Ya(400,function(hj){hj.DDi();tc.SCc(!1)});break;case 810888577:be.AFrameworkApplication.zk=(new Date).getTime();ud.ULS.sendTraceTag(537162656,0,50,"FileOperationsCommandHandler.ExecuteCommand: Set AccessTokenTtl to {0}",be.AFrameworkApplication.zk);break;case -1804063550:case -974518828:na=0;M.a.yFd in
Xa&&(na=Xa[M.a.yFd]);Ce.dJf(ue,na);break;case -1339961039:na=!1;Xa&&M.a.hKb in Xa&&(na=Xa[M.a.hKb]);this.reloadWorkbook(!1,na);break;case -8805455:var Dh=this.workbookContext;Dd.isEditMode||(he.pDe(Dd),K=Yg.TaskExtensions.Ba(this.FK.value,function(hj){hj=hj.result;var aj=hj.isEnabled();aj&&la.a(hj,th.a.copyAndEdit,wd.a.vg.p1e(),tc.$.ea.ah.get(2))?ud.ULS.sendTraceTag(537162655,0,50,"FileOperationsCommandHandler.ExecuteCommand: ReloadInEditMode ribbon command was procesed through SendMessageIfOptionSet()"):
aj&&be.AFrameworkApplication.Iig?(aj={},aj[oc.a.pId]=be.AFrameworkApplication.userSessionId,aj[be.AFrameworkApplication.$Fi]=Lg.a.Ra.Ob.getTime().toString(),ud.ULS.sendTraceTag(537162654,0,50,"FileOperationsCommandHandler.ExecuteCommand: processing ReloadInEditMode ribbon command whike UseEditModePostMessage flag is ON"),hj.Nj(th.a.editMode,aj)):md.CopyAndEditUrl?tc.H7g():(tc.pc.supportsEditing||Dh.EditUrl)&&tc.reloadWorkbookInEditMode()},this.la,3));break;case -723527778:Dd.isEditMode&&(he.pDe(Dd),
this.reloadWorkbookInViewMode());break;case 1783960667:case -1355155015:var Ci=Dd.na.ta.fc(),wj=-1355155015===ue?1:0,Jj=function(){return new Gc(wj)};K=lc.a(this.$.userOperationManager,function(hj,aj,Gk){return Rd.V(Dd.na.ta,wj,null,hj,aj,Gk,null,Ci)},function(hj){return new Oc.a(128,0,hj,void 0,Jj)},na);Og.g(Dd).Lg.xH(!1);break;case -1158102843:K=Og.g(Dd).Lg.recalcSheet(na);Og.g(Dd).Lg.xH(!1);break;case -988468372:if(Te.EwaSettings.ma(305))if(Qb=parseInt(Xa[Oa.a.od],10),0<=Qb&&3>Qb)this.setCalculationMode(na,
Qb);else return ud.ULS.sendTraceTag(537162652,0,10,"SetCalculationMode , unexpected menuItemId: {0}",Xa[Oa.a.od]),k.a(ue);break;case 257398710:V.a.ntw(md.ReportAbuseUrl,Dd);break;case 1800405051:this.cpj();break;case -48469327:this.saveACopy();break;case 214430355:na=!1;Xa&&M.a.u$c in Xa&&(na=Xa[M.a.u$c]);if(!this.PCj(na,Xa))break;be.AFrameworkApplication.c6?this.businessBar.lg(40,null):this.businessBar.lg(na?22:23,null);break;case 1389557314:K=Yg.TaskExtensions.Ba(this.FK.value,function(hj){la.a(hj.result,
th.a.NFh,null,tc.$.ea.ah.get(6))||V.a.ntw(md.FileVersionUrl,Dd)},this.la,3);break;case 2145659238:this.closeWorkbook();break;case 1773624819:Wg===Kf+M.a.Tmf?Ce.uwi():Ce.twi();break;case 512141517:Wg===Kf+M.a.Smf?Ce.Ewi():Ce.Dwi();break;case -1224038235:var dk=R.a.On in Xa?!Xa[R.a.On]:ca.j(Dd.ea.workbookContext.Options);Xa[R.a.Description]=dk?Tc.a.instance.fa(564):Tc.a.instance.fa(565);K=lc.a(this.$.userOperationManager,function(hj,aj,Gk){var Uk=tc.$.na.ta,Ok=Uk.Ma(9,null);Ok.isReadOnlyRecommended=
!dk;return Rd.i(Uk,"SetReadOnlyRecommended",Ok,hj,aj,Gk,null,0)},function(hj){return new Oc.a(129,0,hj)},na);break;case 1118926154:if(this.$.isEditMode){var vj=new Gg.a;this.$.da.Ya(53,function(hj){hj?(hj.Um.owi(tc.$.Lb+M.a.cvd),vj.setResult(!0)):ud.ULS.sendTraceTag(537162649,0,50,"Ignoring RibbonCommand.LaunchFileMenuShortcut, the ribbonManager is null.")});K=vj.task}break;case -1698025133:Ce.openInBrowser();break;case 520859864:K=Yg.TaskExtensions.Ba(wh.GetServiceTaskFactory.Ua(this.$.da,393,394,
Qb.Jka()),function(hj){hj.result||ud.ULS.sendTraceTag(537162648,0,10,"FileMenuCommandHandler::ExecuteCommand Failed to create SaveToHostManager")},this.$.la,3);break;default:K=k.a(ue)}return K||Kg.Task.Sa(!0)};he.prototype.wDb=function(K){if(Te.EwaSettings.isChangeGateEnabled("OfficeVSO:4859963_LogUsageKpiForOpenInAppDialog"))if(Ug.HelperMethods.S_){var na=new Map;na.set("EntryPoint",K);Pg.Health.instance.recordKpiUsage(yj.a.r_i,0,Xi.a.IFi,na)}else ud.ULS.sendTraceTag(537162647,0,15,"FileOperationsCommandHandler.LogUsageKpiOpenInAppDialog: KPI Usage not supported")};
he.prototype.showOpenInAppDialog=function(){be.AFrameworkApplication.isMobileMode&&(this.$.ya.IsMeetingLiveSession&&Te.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OpenInAppExcelReactDialog",!1)?(new Af(this.$)).mh():Te.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseOpenInAppDialogCopyMobile",!1)?(ud.ULS.sendTraceTag(574993315,0,50,"FileOperationsCommandHandler.ShowOpenInAppDialog: SD-side open-in-app dialog used"),(new xf(this.$)).mh()):(ud.ULS.sendTraceTag(574993314,0,
50,"FileOperationsCommandHandler.ShowOpenInAppDialog: Git-side open-in-app dialog used"),be.AFrameworkApplication.showOpenInAppDialog()))};he.prototype.PCj=function(K,na){var Xa=this;return be.AFrameworkApplication.isMobileMode&&!Fb.a(this.$.ya,30)?(this.showOpenInAppDialog(),ud.ULS.sendTraceTag(577300448,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: Open-in-app dialog invoked from cell double tap"),this.wDb("CellDoubleTap"),ud.ULS.sendTraceTag(537162646,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: User attempted to edit in reading view in mobile browser "),
!1):be.AFrameworkApplication.gjc&&(K&&ai.c(this.workbookContext.WorkbookFileName)||!this.workbookContext.FullDocumentInfo.HostEditUrl)?(ud.ULS.sendTraceTag(537162645,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: User attempted to edit in reading view a non-editable format .{0}, HostEditUrl {1}empty. Skipped prompt to edit",ai.d(this.workbookContext.WorkbookFileName)?"xls":"csv",this.workbookContext.FullDocumentInfo.HostEditUrl?"not ":""),!1):Ba.a.any([25,26,30,31,55,32],function(Qb){return Xa.businessBar.wNa(Qb)})?
(ud.ULS.sendTraceTag(537162644,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: User attempted to edit in reading view after opening in Edit by default"),!1):na&&M.a.x7i in na&&!K?!1:!0};he.prototype.Mc=function(K,na){K=!1;switch(na.command){case 1455037301:case -2044628748:case 2004484710:case -2028960985:case -974518828:case -1339961039:case -8805455:case -723527778:case 1783960667:case -1158102843:case -1355155015:case 257398710:case 214430355:case 1389557314:case 2145659238:case 1773624819:case 512141517:case 1118926154:case -1698025133:case 213236505:K=
!0;break;case 520859864:K=Te.EwaSettings.isChangeGateEnabled("OfficeVSO:3773098_SaveDeferredActionDispatcherEnabled")?!0:!1;break;case -1285148982:case -75280711:case -455164169:K=Te.EwaSettings.ma(109);break;case -1388494670:K=Te.EwaSettings.ma(109);break;case 810888577:K=Te.EwaSettings.ma(272);break;case -1224038235:K=this.$.ea.amIAlone;break;case -988468372:K=Te.EwaSettings.ma(305);break;case -1804063550:case -1059172980:case 1800405051:case -48469327:K=!0,ud.ULS.shipAssertTag(537162642,0,this.$.Dla,
"Command execute requested for SaveAs or Copy operation when data duplication is disallowed.")}return K};he.prototype.nd=function(){return!1};he.prototype.cpj=function(){var K=this;if(this.sc){var na=this.$;Ei.a(na).Jt(new Vh.a(Hg.a.Hz,5,function(){na.LI(!1,!0);var Xa=K.clientWorkflow.ud.activityState;Xa[ec.a.tr]=Hg.a.tea;Xa[ni.a.zU]=2;Xa[Ra.a.mt]=na.isEditMode;Xa[ni.a.Cha]=!1}))}};he.prototype.saveACopy=function(){var K=this;if(this.sc){var na=this.$;Ei.a(na).Jt(new Vh.a(Hg.a.Hz,5,function(){na.LI(!1,
!1);var Xa=K.clientWorkflow.ud,Qb=Xa.activityState;Qb[ec.a.tr]=Hg.a.pZf;Qb[Jd.a.k_b]=K.pc.hasUnsupportedFeaturesForEdit;Qb[ni.a.Cha]=!1;Xa.Wt(Mg.a.eba(K.businessBar.I$c,[-502303485]))}))}};he.prototype.SCc=function(K){var na=this;Ei.a(this.$).Jt(new Vh.a(Hg.a.yoa,2,function(){na.$.LI(!0,!0);var Xa=Xd.a(na.$).ud,Qb=na.$.isEditMode;Qb=Mg.a.ed(1,1,0,0,0,Qb?-315732528:-2087635043,Qb?"DeploymentInvalidEditSession":"InvalidOrTimedOutSession");Qb.ForceVersionUpgrade=K;Xa.Wt([Qb]);Xa=Xd.a(na.$).ud.activityState;
Xa[ec.a.tr]=Hg.a.yoa;Xa[Ra.a.mt]=na.$.isEditMode;Xa[ni.a.Cha]=!1}))};he.prototype.closeWorkbook=function(){var K=this;if(this.sc){var na=this.$;wd.a.vg.hzc("2145659238")?Yg.TaskExtensions.Ba(this.FK.value,function(Xa){Xa.result.Nj(th.a.KWe,{})},this.la,3):Ei.a(na).Jt(new Vh.a(Hg.a.Hz,5,function(){na.LI(!0,!1);var Xa=K.clientWorkflow.ud.activityState;Xa[ni.a.lZ]=!1;Xa[ni.a.Cha]=!1;K.pc.inViewerFromWebPart?(Oe.a.dJd(na,K.clientWorkflow.ud),na.Zk.lz("InViewerFromWebPart"),Xa[ec.a.tr]=Hg.a.t0):(Xa[ec.a.tr]=
Hg.a.Mk,na.Dd&32?Xa[ni.a.zU]=0:(Xa[ni.a.zU]=1,Xa[ni.a.$Zb]=new jj.a),Xa[gd.a.zoe]=!0)}))}};he.prototype.H7g=function(){var K=this,na=this.pc.vbaRemovedDuringConversion;ud.ULS.sendTraceTag(537162636,0,50,"FileOperationsCommandHandler.CopyAndEditWorkbook: vbaRemovedDuringConversion = {0}",na);var Xa=this.$;na?Ei.a(Xa).Jt(new Vh.a(Hg.a.Hz,5,function(){var Qb=Mg.a.ed(3,0,0,1222,0,1069271157,"XLSMacroFailure");K.clientWorkflow.ud.Wt([Qb]);K.clientWorkflow.ud.activityState[ec.a.tr]=Hg.a.egb})):be.AFrameworkApplication.hideHeader?
Ug.HelperMethods.wf(this.R8b.CopyAndEditUrl,"_blank",void 0,"FileOperationCommandHandler.CopyAndEditUrl"):V.a.ntw(this.R8b.CopyAndEditUrl,Xa)};he.prototype.reloadWorkbookInEditMode=function(){var K=this;if(this.sc)if(Te.EwaSettings.isChangeGateEnabled("OfficeVSO:4585988_RefreshRibbonCookieOnModeRefresh")&&wd.a.vg.DW&&wd.a.vg.RKd(),be.AFrameworkApplication.gjc&&!be.AFrameworkApplication.Zla)Ug.HelperMethods.wf(this.$.Qqb(!0),x.a.blank,void 0,"FileOperationCommandHandler.BuildHostUrl");else{var na=
this.$,Xa=!1,Qb=this.pc.hasUnsupportedFeaturesForEdit,tc=this.workbookContext.FileWasRepaired;ai.d(this.workbookContext.WorkbookFileName)?(Xa=!0,ud.ULS.sendTraceTag(537162634,0,50,"FileOperationsCommandHandler.ReloadWorkbookInEditMode: working on an XLS file, unsupported features = {0}",Qb)):ai.a(this.workbookContext.WorkbookFileName)&&(Xa=!0,ud.ULS.sendTraceTag(537162633,0,50,"FileOperationsCommandHandler.ReloadWorkbookInEditMode: working on an CSV file"));var md=na.dg.get(59);md=!(na.ea.pc.supportsEditing&&
md);if(Xa&&!Qb||md&&(Xa||Qb)){var Dd=md?Qb?-2066104278:816071846:Te.EwaSettings.isChangeGateEnabled("OfficeVSO:4035916_RemoveConvertInTeams")&&Fb.a(this.$.ya,25)&&!this.$.GBb?765011943:-213064907;Xa=function(){var ue=Mg.a.w0a([Dd]);K.clientWorkflow.ud.Wt(ue);K.clientWorkflow.ud.activityState[ec.a.tr]=Hg.a.egb}}else Xa=function(){na.LI(!0,!1);var ue=K.clientWorkflow.ud,Ce=ue.activityState;Ce[ni.a.zU]=1;Ce[Db.a.e_b]=Oh.a.tnc;Ce[Ra.a.mt]=!0;Ce[Jd.a.k_b]=K.pc.hasUnsupportedFeaturesForEdit;Ce[ni.a.Cha]=
!!K.workbookContext.EditUrl;Ce[Y.a.j3]=K.workbookContext.EditUrl;if(!K.R8b.CopyAndEditUrl){var Kf=[Te.EwaSettings.isChangeGateEnabled("OfficeVSO:4035912_RemoveEditACopyInTeams")&&Fb.a(K.$.ya,25)&&!K.$.GBb?-943219229:1821390342];ue.Wt(Mg.a.eba(K.businessBar.I$c,Kf))}tc&&!Qb?(ai.b(K.workbookContext.WorkbookFileName)&&Te.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConverterOdfFileRepairEnabled",!1)?(ue=Mg.a.w0a([-425642652]),ud.ULS.sendTraceTag(537162631,0,50,"FileOperationsCommandHandler.ReloadWorkbookInEditMode: working on an .ods file")):
ue=Mg.a.w0a([108482388]),K.clientWorkflow.ud.Wt(ue),Ce[ec.a.tr]=Hg.a.EZf):K.$.ea.Baf?(ud.ULS.sendTraceTag(546111811,0,50,"Password-To-Modify Workbook: User trying to switch to edit-mode."),yi.b().NWd("DialogShown","Password-To-Modify Workbook: Logging StopWatch duration after user tries to switch to exclusive edit-session","PasswordToModifyDialogShown"),Ce[ec.a.tr]=Hg.a.fHb):Ce[ec.a.tr]=K.$.ea.Ric?Hg.a.$Cb:Hg.a.egb};Ei.a(na).Jt(new Vh.a(Hg.a.Hz,5,Xa))}};he.prototype.reloadWorkbookInViewMode=function(){var K=
this;if(this.sc){Te.EwaSettings.isChangeGateEnabled("OfficeVSO:4585988_RefreshRibbonCookieOnModeRefresh")&&wd.a.vg.DW&&wd.a.vg.RKd();var na=this.$;Yf.a.dh&&Og.g(na).zc.textBox.blur();Ei.a(na).Jt(new Vh.a(Hg.a.Hz,5,function(){na.LI(!na.ea.isNamedObjectViewMode,!1);var Xa=K.clientWorkflow.ud.activityState;Xa[ec.a.tr]=Hg.a.Oia;Xa[ni.a.zU]=1;Xa[ni.a.lZ]=!0;Xa[Ra.a.mt]=!1;Xa[Ra.a.Eob]=!0;Xa[Db.a.e_b]=Oh.a.tnc}))}};he.prototype.reloadWorkbook=function(K,na){var Xa=this;if(this.sc){var Qb=this.$;Qb.xK&65536&&
Ei.a(Qb).Jt(new Vh.a(Hg.a.Hz,5,function(){Qb.LI(K,!0);var tc=Xa.clientWorkflow.ud.activityState;tc[ec.a.tr]=Hg.a.Nk;tc[Ra.a.AWc]=Xa.workbookContext.NovMode;na||(tc[ni.a.zU]=1,tc[ni.a.$Zb]=new qe)}))}};he.prototype.setCalculationMode=function(K,na){function Xa(){return new xd(na)}var Qb=this;ud.ULS.sendTraceTag(537162629,0,50,"SetCalculationMode ,calculation mode chosen : {0} ",na);var tc=this.$.ea.workbookContext.CalcMode;this.$.ea.workbookContext.CalcMode=na;return lc.a(this.$.userOperationManager,
function(md,Dd,ue){var Ce=Qb.$.na.ta;md=nh.b(md,he.eXi(Qb.$,tc));Dd=nh.a(Dd,he.dXi(Qb.$,tc));var Kf=Ce.Ma(9,null);Kf.calc_type=na;return Rd.i(Ce,"SetCalculationOptions",Kf,md,Dd,ue,null,0)},function(md){return new Oc.a(197,0,md,void 0,Xa)},K)};he.pDe=function(K){K.yb&&0<K.yb.JS&&K.yb.ncd(function(na){na.eu()})};he.eXi=function(K,na){return function(Xa){Mg.a.vh(Xa.Errors)&&(K.ea.workbookContext.CalcMode=na,ud.ULS.sendTraceTag(537162628,0,50,"OnSetCalcModeSucess: successCallback was called with errors for SetCalculationMode. reverting calc mode to {0}.  Error id names: {1}",
na,Mg.a.Wc(Xa.Errors)))}};he.dXi=function(K,na){return function(){K.ea.workbookContext.CalcMode=na;ud.ULS.sendTraceTag(537162627,0,50,"OnSetCalcModeFailure: failedCallback was called for SetCalculationMode. reverting calc mode to {0})",na)}};uk.Object.defineProperties(he.prototype,{sc:{configurable:!0,enumerable:!0,get:function(){return this.$.ea.sc}},workbookContext:{configurable:!0,enumerable:!0,get:function(){return this.$.workbookContext}},R8b:{configurable:!0,enumerable:!0,get:function(){return this.$.workbookContext.FullDocumentInfo}},
clientWorkflow:{configurable:!0,enumerable:!0,get:function(){return Xd.a(this.$)}},pc:{configurable:!0,enumerable:!0,get:function(){return this.$.pc}}});Object(Sd.a)(he,"FileOperationsCommandHandler",d.a,[434]);var cf=b(157),pf=eh.a;Am(Lc,pf);Lc.prototype.Qd=function(){var K=this,na=this.$,Xa=[],Qb=wh.GetServiceTaskFactory.create(na.da,56,this.la,this.ub);Xa.push(Qb);var tc=wh.GetServiceTaskFactory.Ua(na.da,5,4,this.ub);Xa.push(tc);Yg.TaskExtensions.Ba(Kg.Task.WAA.apply(null,Xa),function(){cf.b(Qb)&&
K.Jd([new he(na,Qb.result,new mf.a(function(){return wh.GetServiceTaskFactory.create(na.da,137,K.la,K.ub)}),tc.result)])},this.la,0)};Lc.ka=function(K){eh.a.je(94,new Lc(K))};Object(Sd.a)(Lc,"FileOperationsCommandHandlerFactory",eh.a,[]);var ff=b(45),tg;(function(K){K[K.url=0]="url";K[K.ref=1]="ref";K[K.mailto=2]="mailto"})(tg||(tg={}));Object(Sd.b)("HyperlinkSelectionState",tg);var Ig=b(981),qg=b(9),pi=b(645),Ld=b(86),qi=Ig.a;Am(Ec,qi);Ec.prototype.S3e=function(K,na){switch(na){case 2:return K.startsWith("mailto:")?
K:"mailto:"+K;case 1:return String.format("{0}{1}",qg.a.YLf,this.DXh(K));default:return K}};Ec.prototype.Ox=function(){var K=this,na=this.$;this.location=this.S3e(this.TAd,this.SAd);try{this.location=Ld.a.Il(this.location)}catch(tc){ud.ULS.sendTraceTag(537157643,0,15,"Decoding link text failed")}ud.ULS.sendTraceTag(555755667,0,50,"Committing {0} link",tg[this.SAd]);this.cellValue=this.RAd.length?this.RAd:this.TAd;na.Qy();var Xa=na.na.ta.fc(),Qb=ff.s(this.selectedRange);return function(tc,md,Dd){return Rd.c(na.na.ta,
Qb,K.cellValue,K.location,K.removeHyperLink,!1,123,tc,md,Dd,K.VM.range,Xa)}};Ec.prototype.Bk=function(){var K=this,na=ff.s(this.selectedRange);return function(){return new pi.a(na,K.cellValue,K.location)}};Ec.prototype.pEh=function(){var K=this.VM.cell.J6a;this.VM.cell.Ayb?K&&K.startsWith("mailto:")?(this.Aob=2,K=K.substr(7)):this.Aob=0:this.Aob=1;return K};Ec.prototype.PMa=function(){Te.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")?this.AAb=this.VM.Nba:this.AAb=!!this.VM.tLa(64)||
!!this.VM.tLa(128)};Ec.prototype.um=function(){if(this.AAb){this.S2a=this.VM.text;var K=this.pEh();K&&(this.nWc=K);this.uo=Tc.a.instance.fa(810);this.Fsb=this.nWc===this.S2a}else this.VM.text?(this.S2a=this.VM.text,this.Fsb=!1):(this.S2a="",this.Fsb=!0),this.Aob=0,this.uo=Tc.a.instance.fa(809);this.VM.$H&&(this.Fsb=!1,this.RLe=!0,Te.EwaSettings.isChangeGateEnabled("OfficeVSO:5533269_formulaTextFixInHyperLink")&&(this.S2a=this.VM.formulaBarText))};Ec.prototype.kHi=function(K){return this.ea.Ab.Gj(K)};
Ec.prototype.k2e=function(K,na){return K?null:Tc.a.instance.fa(na)};Ec.prototype.DXh=function(K){var na=ff.Z(K,this.ea.xa);var Xa=na.sheetName;var Qb=na.range;na.returnValue&&Qb&&(K=ff.x(Qb,Xa||this.sheetName,!1));return K};uk.Object.defineProperties(Ec.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"HyperLinkDialog"}},Mu:{configurable:!0,enumerable:!0,get:function(){return 526}}});Ec.U_j="validateLinkValues";Ec.RSg="bodyProps";Ec.Fjh="disableDisplayText";Ec.wkh="displayTextValue";
Ec.JDg="activeLinkOption";Ec.KDg="activeLinkValue";Ec.O7g="copyLinkValueToDisplay";Ec.qxi="linkValue";Ec.xrj="selectedLink";Ec.vkh="displayText";Object(Sd.a)(Ec,"HyperlinkDialog",Ig.a,[]);cc.prototype.$c=function(){return!1};cc.prototype.Mc=function(K,na){return 1===K&&-1583422759===na.command};cc.prototype.nd=function(){return!1};cc.prototype.executeCommand=function(){this.LFj();return Kg.Task.Sa(!0)};cc.prototype.LFj=function(){var K=ff.v(this.gridView.ga.va.xd,this.$),na=Og.e(this.gridView);(!Te.EwaSettings.isChangeGateEnabled("OfficeVSO:5639309_CheckedProtectedRangeUnlockStateWhenInsertHyperlink")||
this.$.Br([this.gridView.ga.va.xd],!0))&&na&&new Ec(this.$,K,na)};Object(Sd.a)(cc,"ShowHyperlinkCommandHandler",null,[434]);var W=eh.a;Am(hc,W);hc.prototype.Qd=function(){this.Jd([new cc(this.$,Og.g(this.$))])};hc.ka=function(K){eh.a.je(105,new hc(K))};Object(Sd.a)(hc,"ShowHyperlinkCommandHandlerFactory",eh.a,[]);var ta=b(21),ob=b(1213);Mb.create="Create";Mb.activate="Activate";Mb.close="Close";Mb.remove="Delete";Mb.duplicate="Duplicate";Object(Sd.a)(Mb,"Actions",null,[]);var Kb=Kg.Task;Am(za,Kb);
za.prototype.AM=function(){this.s3d=Mg.a.ed(3,2,0,1622,0,-1244327602,"MsFormDeleteConfirmation");this.qj=Ei.a(this.Ef.$).zi(this.s3d).G();this.qj.isCompleted||(this._state=2,this.qj.xO(this.moveNext));return this.PFc};za.prototype.PFc=function(){this.u3d=this.qj.Kz();0===this.u3d&&(this.Ef.$.workbookContext.Options=Ug.HelperMethods.kP(!1,this.Ef.$.workbookContext.Options,2048),this.Ef.deleteMsFormMetaDataSheet());this._state=3;this.TSa(!0)};za.prototype.dispose=function(){};Object(Sd.a)(za,"$$sm_Microsoft$Office$Excel$WebUI$Client$MsForm$MsFormCommandHandler$DeleteMsForm",
Kg.Task,[3]);dc.action="Action";dc.cIh="FlexPane";dc.sbc="formId";dc.id="id";dc.title="Title";dc.KQb="XlWorkbookId";dc.eKh="Fragment";dc.host="Host";dc.LQj="TopView";dc.g3="auth_pvr";Object(Sd.a)(dc,"Parameters",null,[]);jc.prototype.$c=function(K,na){switch(na){case -105284469:return!ca.i(this.$.qg)||this.hasMsForm;case -1219864912:case 1674421386:case -1128532220:case 2023601781:return!this.hasMsForm}return!1};jc.prototype.executeCommand=function(K,na){K=Yg.TaskExtensions.Dl();na=na.command;switch(na){case -105284469:this.insertMsForm();
break;case -1219864912:this.previewMsForm();break;case -1128532220:this.editMsForm();break;case 1674421386:this.sendMsForm();break;case 2023601781:K=this.deleteMsForm();break;default:K=k.a(na)}return K};jc.prototype.Mc=function(K,na){if(!this.$.ea.ah.get(61))return!1;K=!1;switch(na.command){case -105284469:K=ca.i(this.$.qg)&&!this.hasMsForm;break;case -1219864912:case 1674421386:case -1128532220:case 2023601781:K=this.hasMsForm}return K};jc.prototype.nd=function(){return!1};jc.prototype.insertMsForm=
function(){var K=Cf.a.Lq(this.$.workbookContext.FullDocumentInfo.BreadcrumbDocName),na={},Xa={};na[dc.action]=Mb.create;na[dc.g3]=this.g3;Xa[dc.action]=Mb.create;Xa[dc.KQb]=encodeURIComponent(this.GQb);Xa[dc.host]=this.xo;Xa[dc.title]=encodeURIComponent(K);this.QDb(na,Xa);this.$.workbookContext.Options=Ug.HelperMethods.kP(!1,this.$.workbookContext.Options,2048)};jc.prototype.editMsForm=function(){var K={},na={};K[dc.g3]=this.g3;na[dc.sbc]=this.Hnc;na[dc.KQb]=encodeURIComponent(this.GQb);na[dc.host]=
this.xo;this.QDb(K,na)};jc.prototype.previewMsForm=function(){var K={},na={};K[dc.g3]=this.g3;na[dc.sbc]=this.Hnc;na[dc.KQb]=encodeURIComponent(this.GQb);na[dc.host]=this.xo;na[dc.LQj]="Preview";this.QDb(K,na)};jc.prototype.sendMsForm=function(){var K={},na={};K[dc.g3]=this.g3;na[dc.sbc]=this.Hnc;na[dc.cIh]="SendForm";na[dc.KQb]=encodeURIComponent(this.GQb);na[dc.host]=this.xo;this.QDb(K,na)};jc.prototype.deleteMsForm=function(){return new za(this)};jc.prototype.deleteMsFormMetaDataSheet=function(){var K=
this;this.$.userOperationManager.ju(new Oc.a(158,0,function(na,Xa,Qb){return jf(K.$.na.Yw,K.YV.$vb,nh.b(na,function(){K.zhh()}),Xa,Qb,null)}))};jc.prototype.zhh=function(){var K={},na={};K[dc.action]=Mb.remove;K[dc.g3]=this.g3;na[dc.action]=Mb.remove;na[dc.host]=this.xo;na[dc.sbc]=encodeURIComponent(this.Hnc);na[dc.KQb]=encodeURIComponent(this.GQb);this.QDb(K,na)};jc.prototype.QDb=function(K,na){var Xa=this.$.ya.MsFormBaseUrl+"/Pages/DesignPage.aspx",Qb="",tc="";if(na){for(var md in na){var Dd=md,
ue=na[md];tc+=tc.length?"&":"";tc+=Dd+"="+ue}K||(K={});K[dc.eKh]=encodeURIComponent(tc)}if(K)for(var Ce in K)na=Ce,tc=K[Ce],Qb+=Qb.length?"&":"?",Qb+=na+"="+tc;window.open(Xa+Qb,"_blank")};uk.Object.defineProperties(jc.prototype,{hasMsForm:{configurable:!0,enumerable:!0,get:function(){return ca.c(this.$.qg)}},Hnc:{configurable:!0,enumerable:!0,get:function(){return this.$.workbookContext.MsFormId}},GQb:{configurable:!0,enumerable:!0,get:function(){return this.$.workbookContext.MsFormDocUrl}},g3:{configurable:!0,
enumerable:!0,get:function(){return ta.a.contains(this.$.Yu.DocumentHostInfo.FileSource,"onedrive",!0)?"MSA":"OrgId"}}});Object(Sd.a)(jc,"MsFormCommandHandler",null,[434]);var qc=eh.a;Am(pd,qc);pd.prototype.Qd=function(){var K=this,na=wh.GetServiceTaskFactory.create(this.$.da,203,this.la,this.ub);Yg.TaskExtensions.Ba(Yg.TaskExtensions.we([na],this.la),function(){K.Jd([new jc(K.$)])},this.la,3)};pd.ka=function(K){K.ea.ah.get(61)&&eh.a.je(215,new pd(K))};Object(Sd.a)(pd,"MsFormCommandHandlerFactory",
eh.a,[]);var Bb=uh.a;Am(ge,Bb);ge.prototype.create=function(){var K=this;Yg.TaskExtensions.Ba(wh.GetServiceTaskFactory.create(this.$.da,164,this.la,this.ub),function(){K.Eb(new Re)},this.la,3)};Object(Sd.a)(ge,"NewAndOpenUXFactory",uh.a,[]);te.prototype.executeCommand=function(K,na,Xa){K=2;switch(na.command){case gg.a.openUrlInNewTab:K=this.Ki.Be(gg.a.openUrlInNewTab,2,Xa);break;case gg.a.rQa:K=this.Ki.Be(gg.a.rQa,2,Xa)}return 2!==K?Kg.Task.Sa(!0):k.a(na.command)};te.prototype.Mc=function(K,na){return na.command===
gg.a.openUrlInNewTab||na.command===gg.a.rQa};te.prototype.nd=function(K,na,Xa){return"PopulateMruMenu"===na?(this.Ki.Be(gg.a.psc,2,Xa),!0):!1};te.prototype.$c=function(){return!1};Object(Sd.a)(te,"OpenFromMruCommandHandler",null,[434]);var sd=eh.a;Am(me,sd);me.prototype.Qd=function(){var K=this,na=wh.GetServiceTaskFactory.create(this.$.da,155,this.la,this.ub),Xa=wh.GetServiceTaskFactory.create(this.$.da,165,this.la,this.ub);Yg.TaskExtensions.Ba(Yg.TaskExtensions.we([na,Xa],this.la),function(){K.Jd([new te(K.$,
be.AFrameworkApplication.Ib)])},this.la,3)};me.ka=function(K){eh.a.je(88,new me(K))};Object(Sd.a)(me,"OpenFromMruCommandHandlerFactory",eh.a,[]);var Vd=b(89),bf=b(81),Xf=b(250),vg=b(716),kh=b(1157),ki=Xf.a;Am(rd,ki);rd.prototype.execute=function(K){var na=Object(bf.a)(6,K.Me);if(!na.Dla)return ud.ULS.sendTraceTag(537154818,0,50,"DownloadAForkedCopyActivity.Execute: blocking Download action as the workbook is protected"),this.Spd(K),this.Dh(Hg.a.idle),1;this.EDb||(this.EDb=new kh.DownloadACopyOperation(this.Dmc,
na));this.EDb.$lh();ud.ULS.shipAssertTag(537154817,0,3!==Xd.a(na).Ci.ku,"The current activity should not be closed.");return 1};rd.prototype.Spd=function(K){var na=Object(bf.a)(6,K.Me),Xa=new vg.a(na);this.subscribe(K,this.DEd,function(Qb){Xa.add_disposing(Qb)});ud.ULS.sendTraceTag(50954707,0,50,"DownloadAForkedCopyActivity.ProtectedFileDataLeakErrorDialog: showing alert dialog to user");Xa.initialize();Xa.pf()};rd.prototype.dispose=function(){Vd.a.Fa(this.EDb);this.EDb=null;ki.prototype.dispose.call(this)};
Object(Sd.a)(rd,"DownloadAForkedCopyActivity",Xf.a,[]);var Yd=uh.a;Am($c,Yd);$c.prototype.create=function(){var K=this;Yg.TaskExtensions.Ba(wh.GetServiceTaskFactory.create(this.$.da,155,this.la,this.ub),function(){K.Eb(new rd(Hg.a.Z2a,Hg.a.Mk,!0))},this.la)};Object(Sd.a)($c,"DownloadACopyPreDatalossActivityFactory",uh.a,[]);var df=uh.a;Am(kc,df);kc.prototype.create=function(){var K=this;Yg.TaskExtensions.Ba(wh.GetServiceTaskFactory.create(this.$.da,155,this.la,this.ub),function(){K.Eb(new rd(Hg.a.unmergeableDownloadCopy,
Hg.a.Hpa))},this.la)};Object(Sd.a)(kc,"DownloadAForkedCopyActivityFactory",uh.a,[]);Jf.prototype.Sg=function(){this.La.ic(gg.a.tryMacOffice,Sg.a.frame,Object(Vf.a)(this,this.ZYi,"onTryMacOffice"));this.La.ic(gg.a.Ieg,Sg.a.frame,Object(Vf.a)(this,this.sIf,"onTryMacOfficeFromViewer"));this.La.ic(gg.a.Heg,Sg.a.frame,Object(Vf.a)(this,this.sIf,"onTryMacOfficeFromViewer"))};Jf.prototype.ZYi=function(K,na,Xa,Qb,tc){if(1===Xa)return 32;tc?(K=tc.SourceControlId,"btnjTryMacOfficeForWordEditor"===K?hh.a.wf(zg.a.v_(12),
"_blank",void 0,"MacOfficeOffer.TriggerFromWordEditor"):"PptJewel.About.TryMacOffice"===K&&hh.a.wf(zg.a.v_(22),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTEditor")):this.nof();return 32};Jf.prototype.sIf=function(K,na,Xa){if(1===Xa)return 32;switch(K){case gg.a.Ieg:hh.a.wf(zg.a.v_(15),"_blank",void 0,"MacOfficeOffer.TriggerFromWordViewer");break;case gg.a.Heg:hh.a.wf(zg.a.v_(25),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTViewer")}return 32};Jf.prototype.nof=function(){var K=void 0===K?null:K;
var na=0;K&&(na=K);hh.a.wf(2===na?"https://go.microsoft.com/fwlink/?LinkId=331579":Jf.BCi,"_blank",void 0,"LaunchMacTrialWindow")};uk.Object.defineProperties(Jf.prototype,{szc:{configurable:!0,enumerable:!0,get:function(){return this.Zug&&Yf.a.isMac&&!Yf.a.$pi&&!MSOJS.ClientUtils.IsO14MacPluginInstalled()}},HCj:{configurable:!0,enumerable:!0,get:function(){return this.szc}}});uk.Object.defineProperties(Jf,{BCi:{configurable:!0,enumerable:!0,get:function(){return zg.a.UH("522401")}}});Object(Sd.a)(Jf,
"MacOfficeOffer",null,[60]);pe.prototype.Sg=function(){this.La.ic(gg.a.tryOffice,Sg.a.frame,Object(Vf.a)(this,this.$Yi,"onTryOffice"));this.La.ic(gg.a.tryOfficeThroughTellMe,Sg.a.frame,Object(Vf.a)(this,this.tryOfficeThroughTellMe,"tryOfficeThroughTellMe"));this.La.ic(gg.a.Leg,Sg.a.frame,Object(Vf.a)(this,this.Meg,"tryOfficeThroughViewer"));this.La.ic(gg.a.Keg,Sg.a.frame,Object(Vf.a)(this,this.Meg,"tryOfficeThroughViewer"))};pe.prototype.$Yi=function(K,na,Xa,Qb,tc){if(this.fZb&&1===Xa)return this.isFreemiumUpsellEnabled&&
this.FMb?32:8;2===Xa&&(tc?(K=tc.SourceControlId,"btnjTryOfficeForWordEditor"===K?hh.a.wf(zg.a.v_(11),"_blank",void 0,"OfficeTrial.TriggerFromWordEditor"):"PptJewel.About.TryOffice"===K?hh.a.wf(zg.a.v_(21),"_blank",void 0,"OfficeTrial.TriggerFromPPTViewer"):this.Blc()):this.Blc());return 32};pe.prototype.tryOfficeThroughTellMe=function(K,na,Xa,Qb,tc){if(this.fZb&&1===Xa)return this.isFreemiumUpsellEnabled&&this.FMb?32:8;2===Xa&&(tc?(K=tc.SourceControlId,hh.a.wf(zg.a.UH("862405")+this.UZh(K),"_blank",
void 0,"TryOfficeThroughTellMe.WithSourceControlId")):hh.a.wf(zg.a.UH("522402"),"_blank",void 0,"TryOfficeThroughTellMe.Legacy"));return 32};pe.prototype.Meg=function(K,na,Xa){if(this.fZb&&1===Xa)return this.isFreemiumUpsellEnabled&&this.FMb?32:8;if(2===Xa)switch(K){case gg.a.Leg:hh.a.wf(zg.a.v_(14),"_blank",void 0,"TryOfficeThroughViewer.Word");break;case gg.a.Keg:hh.a.wf(zg.a.v_(24),"_blank",void 0,"TryOfficeThroughViewer.PPT")}return 32};pe.prototype.Blc=function(K){K=void 0===K?null:K;var na=
0;K&&(na=K);hh.a.wf(pe.EXh(na),"_blank",void 0,"LaunchOfficeOffer")};pe.prototype.UZh=function(K){var na=0;switch(K){case "jbtnTryOfficeThroughTellMeForWordTrackChanges":na=1;break;case "jbtnTryOfficeThroughTellMeForWordShapes":na=2;break;case "jbtnTryOfficeThroughTellMeForWordLabel":na=3;break;case "jbtnTryOfficeThroughTellMeForWordCitations":na=4;break;case "jbtnTryOfficeThroughTellMeForWordTextBox":na=5;break;case "jbtnTryOfficeThroughTellMeForWordTableOfContent":na=6;break;case "jbtnTryOfficeThroughTellMeForWordSmartArt":na=
7;break;case "jbtnTryOfficeThroughTellMeForWordWordArt":na=8;break;case "jbtnTryOfficeThroughTellMeForWordMultiColumnLayout":na=9;break;case "jbtnTryOfficeThroughTellMeForWordEquation":na=10;break;case "jbtnTryOfficeThroughTellMeForPPTGroupShapes":na=16;break;case "jbtnTryOfficeThroughTellMeForPPTWordArt":na=17;break;case "jbtnTryOfficeThroughTellMeForPPTSpellCheckDict":na=18;break;case "jbtnTryOfficeThroughTellMeForPPTInsertAudio":na=19;break;case "jbtnTryOfficeThroughTellMeForPPTInsertChart":na=
20;break;case "TellMe.TryOfficeThroughTellMeForXLSSpellCheck":na=26;break;case "TellMe.TryOfficeThroughTellMeForXLSMacros":na=27;break;case "TellMe.TryOfficeThroughTellMeForXLSPivotTable":na=28;break;case "TellMe.TryOfficeThroughTellMeForXLSHeaderFooter":na=29}return 0===na?"":String.format("&pc={0:D}",na)};pe.EXh=function(K){if(Yf.a.dh)switch(K){case 1:return zg.a.UH("393806");case 2:return zg.a.UH("393810");case 3:return zg.a.UH("393809");case 5:return zg.a.UH("393805")}else if(Yf.a.xp)switch(K){case 1:return zg.a.UH("521979");
case 3:return zg.a.UH("521980");case 5:return zg.a.UH("521978");case 2:return zg.a.UH("522490")}else{if(2===K)return zg.a.UH("517778");if(1===K)return zg.a.v_(30)}return zg.a.UH("522402")};uk.Object.defineProperties(pe.prototype,{nxf:{configurable:!0,enumerable:!0,get:function(){return this.FMb}},GKi:{configurable:!0,enumerable:!0,get:function(){return this.FMb&&MSOJS.ClientUtils.OfferOfficeInDialog()}},FMb:{configurable:!0,enumerable:!0,get:function(){return this.cvg&&!Yf.a.isMac}},isFreemiumUpsellEnabled:{configurable:!0,
enumerable:!0,get:function(){var K=!1;this.zHc&&(K=this.zHc.isFreemiumUpsellEnabled());return K}}});Object(Sd.a)(pe,"OfficeTrialExperience",null,[58]);Xe.prototype.hi=function(K){K.register(pe,"Common.App.OpenInClient.OfficeTrialExperience").as("Common.IOfficeTrialExperience").Ic().Nc(function(){return new pe(be.AFrameworkApplication.Ib,be.AFrameworkApplication.mBb,be.AFrameworkApplication.lcid)});K.register(Jf,"Common.App.OpenInClient.MacOfficeOffer").as("Common.IMacOfficeOffer").Ic().Nc(function(){return new Jf(be.AFrameworkApplication.Ib,
be.AFrameworkApplication.Vic,be.AFrameworkApplication.lcid)})};Object(Sd.a)(Xe,"OpenInClientConfiguration",null,[5]);var lh=b(1405),Oj=b(36),ig=b(1304),pj=b(226);uk.Object.defineProperties(fd,{ig:{configurable:!0,enumerable:!0,get:function(){return oh.a.Qn(fd.fk,CommonUIStrings.l_OICLaunchDialogTitle)}}});fd.fk="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='OICDialogRow' id='OICDialog'> <div class='OICDialogButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonLaunchRichClient'> <div id='OICLaunchRichClient' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonReturn'> <div id='OICReturnToApp' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(Sd.a)(fd,"OICLaunchDialogHtml",null,[]);var qj=oh.a;Am(Fc,qj);Fc.prototype.Y$a=function(){this.HDa=zd("BtnRichClient",this.Bq.Ztb,this.Bq.vzb,this.Bq.mod,CommonUIStrings.l_OICLaunchRichClient,Object(Vf.a)(this,this.gGf,"onRichClientButtonClick"),zc);document.getElementById("OICLaunchRichClient").appendChild(this.HDa);$e(this.HDa);this.vWa=zd("BtnReturn",this.Bq.Ztb,this.Bq.vzb,this.Bq.Ycf,CommonUIStrings.l_OICReturnToOnlineClient,Object(Vf.a)(this,this.dGf,"onReturnButtonClick"),zc);document.getElementById("OICReturnToApp").appendChild(this.vWa);
$e(this.vWa)};Fc.prototype.dGf=function(){this.hide();this.Bq.hdb();return!0};Fc.prototype.gGf=function(){ud.ULS.sendTraceTag(22140866,211,50,"OIC dialog: launch rich client");this.hide();be.AFrameworkApplication.Ib.processAction(gg.a.hSa,2);return!0};Fc.prototype.$Ki=function(){this.Bq.hdb()};Fc.prototype.dispose=function(){this.Tqa||(this.HDa&&(pj.a.instance.za(Bf.a.click,this.HDa,Object(Vf.a)(this,this.gGf,"onRichClientButtonClick")),Ye.KeyInputManager.instance.za(Bf.a.Td,this.HDa,zc)),this.vWa&&
(pj.a.instance.za(Bf.a.click,this.vWa,Object(Vf.a)(this,this.dGf,"onReturnButtonClick")),Ye.KeyInputManager.instance.za(Bf.a.Td,this.vWa,zc)),qj.prototype.dispose.call(this),this.Tqa=!0)};Object(Sd.a)(Fc,"OICLaunchDialog",oh.a,[]);uk.Object.defineProperties(kf,{ig:{configurable:!0,enumerable:!0,get:function(){return oh.a.Qn(kf.fk,CommonUIStrings.l_OICDialogTitle)}}});kf.fk="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='ProtocolLaunchingDialogIssues OICDialog' id='ProtocolhandlerGetHelp'> <div class='UIFontDialogText OICDialog' id='Issues'> </div> <div class='ProtocolLaunchingDialogHelpButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonEdit'> <div id='ProtocolHandlerDialogEditInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonGiveFeedback'> <div id='ProtocolHandlerDialogGiveFeedbackInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonRetryOIC'> <div id='ProtocolHandlerDialogRetryOIC' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(Sd.a)(kf,"ProtocolLaunchingDialogV2Html",null,[]);var fi=oh.a;Am(Ve,fi);Ve.prototype.Y$a=function(){var K=document.getElementById("Issues");if(K){jd("",this.Bq.Ztb,this.Bq.vzb,this.Bq.mod,K);var na=document.createElement("span");na.className="WACDialogSectionTitle";na.innerText=5===this.Bq.hJf?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICDialogSectionTitle;K.appendChild(na);$e(K);K.style.display="none"}be.AFrameworkApplication.sa.Qa.eld?(this.uWa=zd("GiveFeedback",this.Bq.Ztb,
this.Bq.vzb,"",CommonUIStrings.l_OICDialogSectionGiveFeedback,Object(Vf.a)(this,this.rpc,"onGiveFeedbackClick"),Object(Vf.a)(this,this.sCf,"onGiveFeedbackKeyUp")),document.getElementById("ProtocolHandlerDialogGiveFeedbackInApp").appendChild(this.uWa),$e(this.uWa)):document.getElementById("ButtonGiveFeedback").style.display="none";0===be.AFrameworkApplication.sa.Qa.editMode||be.AFrameworkApplication.Gjh?document.getElementById("ButtonEdit").style.display="none":(this.Ufa=zd("Edit",this.Bq.Ztb,this.Bq.vzb,
"",2===be.AFrameworkApplication.sa.Qa.Yj?4===be.AFrameworkApplication.sa.Qa.editMode?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICReturnToOnlineClient:4===be.AFrameworkApplication.sa.Qa.editMode?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICContinueInBrowser,Object(Vf.a)(this,this.TAf,"onEditClick"),Object(Vf.a)(this,this.YAf,"onEditKeyUp")),document.getElementById("ProtocolHandlerDialogEditInApp").appendChild(this.Ufa),$e(this.Ufa));0===be.AFrameworkApplication.sa.Qa.editMode&&
!be.AFrameworkApplication.mBb&&K&&(K.style.display="none")};Ve.prototype.FYe=function(){return this.zqa?(this.jA(this.zqa),!0):!1};Ve.prototype.DYe=function(){return this.Ufa?(this.jA(this.Ufa),!0):!1};Ve.prototype.YAf=function(K){return this.ECd(K,0)};Ve.prototype.sCf=function(K){return this.ECd(K,2)};Ve.prototype.bGf=function(K){return this.ECd(K,1)};Ve.prototype.ECd=function(K,na){var Xa=!1;if(K.Ca.keyCode===Gi.a.fi||K.Ca.keyCode===Gi.a.Xpa)K.Mb.click(),Xa=!0;else if(K.Ca.keyCode===Sys.UI.Key.down||
K.Ca.keyCode===Sys.UI.Key.up)switch(na){case 1:Xa=this.DYe();break;case 0:Xa=this.FYe()}return Xa};Ve.prototype.TAf=function(){this.hide();4===be.AFrameworkApplication.sa.Qa.editMode?(ud.ULS.sendTraceTag(18715411,211,50,"Restart the App and continue editing"),this.Bq.hdb()):(ud.ULS.sendTraceTag(18715412,211,50,"Switch to edit doc in browser"),this.Bq.Dld());return!0};Ve.prototype.rpc=function(){ud.ULS.sendTraceTag(37339423,211,50,"Open give feedback dialog");this.Bq.c$e();return!0};Ve.prototype.oqc=
function(){ud.ULS.sendTraceTag(19239263,211,50,"OIC dialog retry");document.getElementById("WACDialogPanel").style.display="none";be.AFrameworkApplication.Ib.processAction(gg.a.hSa,2);return!0};Ve.prototype.$Id=function(){this.Bq.hdb()};Ve.prototype.switchToBackupMode=function(){var K=document.getElementById("ProtocolLaunchingDialogTitle");if(K){K.innerText=CommonUIStrings.l_OICDialog2ndTitle;if(K=document.getElementById("Issues"))K.style.display="block";(K=document.getElementById("ProtocolHandlerDialogRetryOIC"))&&
!K.children.length&&(this.zqa=zd("RetryOIC","","","",CommonUIStrings.l_OICDialogRetry,Object(Vf.a)(this,this.oqc,"onRetryOICClick"),Object(Vf.a)(this,this.bGf,"onRetryOICKeyUp")),K.appendChild(this.zqa),$e(this.zqa),this.Ufa||this.FYe())}};Ve.prototype.dispose=function(){this.Tqa||(this.Ufa&&(pj.a.instance.za(Bf.a.click,this.Ufa,Object(Vf.a)(this,this.TAf,"onEditClick")),Ye.KeyInputManager.instance.za(Bf.a.Td,this.Ufa,Object(Vf.a)(this,this.YAf,"onEditKeyUp"))),this.uWa&&(pj.a.instance.za(Bf.a.click,
this.uWa,Object(Vf.a)(this,this.rpc,"onGiveFeedbackClick")),Ye.KeyInputManager.instance.za(Bf.a.Td,this.uWa,Object(Vf.a)(this,this.sCf,"onGiveFeedbackKeyUp"))),this.zqa&&(pj.a.instance.za(Bf.a.click,this.zqa,Object(Vf.a)(this,this.oqc,"onRetryOICClick")),Ye.KeyInputManager.instance.za(Bf.a.Td,this.zqa,Object(Vf.a)(this,this.bGf,"onRetryOICKeyUp"))),fi.prototype.dispose.call(this),this.Tqa=!0)};Object(Sd.a)(Ve,"ProtocolLaunchingDialog",oh.a,[]);var hg=b(457),Wh=Sh.StandardDialog;Am(Ad,Wh);Ad.prototype.rpc=
function(K){ud.ULS.sendTraceTag(595342858,211,50,"Open give feedback dialog");this.qBf(K)};Ad.prototype.oqc=function(){ud.ULS.sendTraceTag(595342857,211,50,"OIC dialog retry");be.AFrameworkApplication.Ib.processAction(gg.a.hSa,2)};Ad.prototype.$Id=function(K){Ad.caf?3===K?this.ZXf():2===K||0===K?this.continueEditing():1===K&&this.A2g():2===K?this.ZXf():(1===K||0===K)&&this.continueEditing()};Ad.prototype.A2g=function(){ud.ULS.sendTraceTag(577783557,211,50,"Closing the document");be.AFrameworkApplication.Ib.Be(gg.a.close,
2,hg.a)};Ad.prototype.ZXf=function(){ud.ULS.sendTraceTag(593602691,211,50,"OIC dialog retry");window.setTimeout(Object(Vf.a)(this,this.oqc,"onRetryOICClick"),0)};Ad.prototype.continueEditing=function(){4===be.AFrameworkApplication.sa.Qa.editMode||be.AFrameworkApplication.ha.ra("WordConsumptionViewToEditRedirectIsEnabled")&&1===be.AFrameworkApplication.sa.mode?(ud.ULS.sendTraceTag(593602690,211,50,"Restart the App and continue editing"),this.Bq.hdb()):(ud.ULS.sendTraceTag(593602689,211,50,"Switch to edit doc in browser"),
this.Bq.Dld())};uk.Object.defineProperties(Ad,{caf:{configurable:!0,enumerable:!0,get:function(){return be.AFrameworkApplication.ha.ra("OICDialogThreeActions")&&32===be.AFrameworkApplication.Ib.processAction(gg.a.close,1)}}});Object(Sd.a)(Ad,"StandardProtocolLaunchingDialog",Sh.StandardDialog,[]);Object(Sd.a)(ae,"EditDocumentInClientParams",null,[]);Od.y$c=function(K,na,Xa,Qb,tc,md,Dd,ue,Ce,Kf,Wg,Dh,Ci,wj,Jj,dk){Dd=void 0===Dd?!1:Dd;ue=void 0===ue?!1:ue;Ce=void 0===Ce?"":Ce;Kf=void 0===Kf?!1:Kf;Wg=
void 0===Wg?!1:Wg;Dh=void 0===Dh?!1:Dh;Ci=void 0===Ci?"":Ci;wj=void 0===wj?"":wj;Jj=void 0===Jj?"":Jj;dk=void 0===dk?!1:dk;var vj=new ae;vj.DocumentUrl=K;vj.Mode=na;vj.Options=Xa;vj.Application=Qb;vj.SilentExternalHandler=Dd;vj.EncodeUrl=ue;vj.CorrelationIdForWinClient=Ce;vj.NavigateUsingWindowOpen=Kf;vj.DescriptiveUnattemptedEnums=Wg;vj.NoBrowserModalDialogs=Dh;vj.SessionOrigin=Ci;vj.CorrelationId=wj;vj.ClickTime=Jj;vj.NewTelemetryDataIsEnabled=dk;MSOJS.ClientUtils.EditDocumentInClient(vj,tc,md)};
Object(Sd.a)(Od,"ClientUtils",null,[]);var vi=b(185),Si=b(1036),Nf=b(76),ri=b(186);Bc.prototype.LIi=function(){if(!be.AFrameworkApplication.ha)return 0;switch((be.AFrameworkApplication.ha.Wa(be.AFrameworkApplication.kfa)||"").toLowerCase()){case "teams":var K=524288;break;case "onedrive":K=131072;break;case "owa":K=262144;break;case "assignments":K=65536;break;default:K=0}switch((be.AFrameworkApplication.ha.Wa("FileSource")||"").toLowerCase()){case "exchangeonline":var na=1;break;case "exchangeonlineconsumer":na=
2;break;case "onedrivewopi":na=4;break;case "sharepointonline":na=8;break;default:na=0}return na|K};Bc.prototype.hnj=function(K,na,Xa){return na.contextId!==Sg.a.frame?2:1===Xa?32:this.hSa()};Bc.prototype.CMj=function(){return!(2===this.application&&be.AFrameworkApplication.ha.ra("IsEmbeddedScenario"))};Bc.prototype.closeApplication=function(){this.HXd||this.mDh()};Bc.prototype.hdb=function(){this.FMj||this.ADh()};Bc.prototype.OQf=function(K){this.MZj&&Yf.a.dh?new Fc(this):this.W4b(K)};Bc.prototype.W4b=
function(K){K=this.Xvi(K);var na=K.returnValue;ud.ULS.sendTraceTag(34198736,211,50,"OICLaunchClient,{0},{1}",32===na,K.ACa);return na};Bc.prototype.zHa=function(K,na,Xa,Qb,tc,md){this.BWa=K;this.R8d=na;this.Sga=md;this.application=Xa;this.nC=Qb;be.AFrameworkApplication.downloadCopyOnOpenInClient?this.kof():be.AFrameworkApplication.limitedEdit&&!be.AFrameworkApplication.hostAuthenticatesUsersDuringOpenInClient?be.AFrameworkApplication.w8f():this.TRg(tc)};Bc.prototype.hSa=function(){this.ZKi&&this.Pyi();
return this.W4b(this.gkb)};Bc.prototype.J0f=function(){var K=new Si.a(th.a.openInClient);K.Values["ui-language"]=be.AFrameworkApplication.lcid.toString();K.Values[oc.a.G7c]=be.AFrameworkApplication.userSessionId;return this.Sga.value.send(K)?32:8};Bc.prototype.Pyi=function(){Pg.Health.instance.recordQosError("UserClickedRetryOpenInDesktop",["OpenInClientFailed"],!1,!1,!1,!1,Object.assign(new yf.a,{inStaging:!0}))};Bc.prototype.Psj=function(K){var na=new Si.a(th.a.X0j);na.Values["ui-language"]=be.AFrameworkApplication.lcid.toString();
na.Values[oc.a.G7c]=be.AFrameworkApplication.userSessionId;na.Values[rg.a.W0j]=K;this.Sga.value.send(na)};Bc.prototype.Xvi=function(K){this.gkb=K;this.Psj(5===this.nC?Bc.x_i:Bc.z_i);return 5===this.nC?this.Wvi():this.awi()};Bc.prototype.Wvi=function(){this.qof();return{returnValue:32,ACa:"HostEditUrl,"}};Bc.prototype.awi=function(){var K,na=K="";be.AFrameworkApplication.jqe&&(na="|f|"+be.AFrameworkApplication.userSessionId);var Xa=be.AFrameworkApplication.ha.ra("IsAssignmentMode")&&be.AFrameworkApplication.ha.ra("UseWindowOpenForOpenInClientInChromeAssignmentsIsEnabled")||
be.AFrameworkApplication.isUnifiedHostMode||Yf.a.Yla,Qb=be.AFrameworkApplication.ha.ra("UnattemptedEnumIsEnabled"),tc=be.AFrameworkApplication.ha.ra("NoBrowserModalDialogs");if(be.AFrameworkApplication.Ib.Xnc){var md=be.AFrameworkApplication.Ib.z_(3588168074);md&&(this.WXb=String.format("{0}{1}{2}",Bc.Gtj.toString(),"_",this.LIi().toString()),this.rE=md.correlationId?md.correlationId:"",this.HSb=md.TriggerTime?md.TriggerTime:"")}if(be.AFrameworkApplication.dMf){K+="NewOrder,";md=8;this.Sga&&this.Sga.value&&
this.Sga.value.isEnabled()&&be.AFrameworkApplication.r1d&&(K+="Post,",md=this.J0f());if(32===md)return{returnValue:md,ACa:K};ud.ULS.sendTraceTag(4994821,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage");return be.AFrameworkApplication.Ll.Dab?(ud.ULS.shipAssertTag(5566816,211,!!be.AFrameworkApplication.Ll.Dab),K+="HostUrl,",{returnValue:be.AFrameworkApplication.sa.o$a(be.AFrameworkApplication.Ll.Dab),ACa:K}):this.BWa?(ud.ULS.sendTraceTag(18715405,211,15,"Try to open doc in rich client, SessionId {0}",
be.AFrameworkApplication.userSessionId),K+="DocUrl,",Od.y$c(this.BWa,this.nC,this.options,this.application,Object(Vf.a)(this,this.XAf,"onEditInClientSuccess"),Object(Vf.a)(this,this.WAf,"onEditInClientFailure"),this.$8f,be.AFrameworkApplication.ha.ra("OICEncodeUrlIsEnabled"),na,Xa,Qb,tc,this.WXb,this.rE,this.HSb,be.AFrameworkApplication.Ib.Xnc),{returnValue:32,ACa:K}):{returnValue:8,ACa:K}}K+="OldOrder,";if(!this.BWa&&be.AFrameworkApplication.Ll.Dab)return this.Sga&&this.Sga.value&&this.Sga.value.isEnabled()&&
be.AFrameworkApplication.r1d?(K+="Post,",na=this.J0f()):(ud.ULS.sendTraceTag(22595483,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage"),na=8),32!==na?(ud.ULS.shipAssertTag(22595484,211,!!be.AFrameworkApplication.Ll.Dab),K+="HostUrl,",{returnValue:be.AFrameworkApplication.sa.o$a(be.AFrameworkApplication.Ll.Dab),ACa:K}):{returnValue:na,ACa:K};ud.ULS.sendTraceTag(22595485,211,15,"Try to open doc in rich client, SessionId {0}",be.AFrameworkApplication.userSessionId);K+="DocUrl,";
Od.y$c(this.BWa,this.nC,this.options,this.application,Object(Vf.a)(this,this.XAf,"onEditInClientSuccess"),Object(Vf.a)(this,this.WAf,"onEditInClientFailure"),this.$8f,be.AFrameworkApplication.ha.ra("OICEncodeUrlIsEnabled"),na,Xa,Qb,tc,this.WXb,this.rE,this.HSb,be.AFrameworkApplication.Ib.Xnc);return{returnValue:32,ACa:K}};Bc.prototype.YVf=function(K){be.AFrameworkApplication.Ym.setDw(8981,K)};Bc.prototype.XAf=function(K){this.YVf(K);ud.ULS.sendTraceTag(18715406,211,50,"Open in rich client succeed");
6===K&&MSOJS.ClientUtils.ShouldShowDialog()?(this.$ag||this.qof(),this.qAi()):this.HXd||this.closeApplication()};Bc.prototype.WAf=function(K,na){na=void 0===na?0:na;ud.ULS.sendTraceTag(18715407,211,10,"Fail to open doc in rich client. Failure Type: {0:D2}, Application: {1}",K,na);if(5===K)alert(CommonUIStrings.l_OICErrorPopupBlockerForSafari);else{var Xa=!!this.R8d&&!this.gkb,Qb=0;1===K&&(Qb=2);6<=K&&13>=K&&(Qb=1,1===na&&(this.HXd=!0));this.gCc.GKi?(ud.ULS.sendTraceTag(18715408,211,50,"Open OICErrorDialogWithTrial. Dialog cause: {0}",
Qb),ig.a.instance.ubh(this.gkb?Object(Vf.a)(this,this.Fxf,"oicErrorDialogHandlerCloseForced"):Object(Vf.a)(this,this.Gxf,"oicErrorDialogHandlerNoCloseForced"),Xa?Object(Vf.a)(this,this.vDf,"onLaunchDownload"):null,this.LLe(!1)?Object(Vf.a)(this,this.bci,"iHaveOfficeButtonHandler"):null,Qb,na)):(ud.ULS.sendTraceTag(18715409,211,50,"Open OICErrorDialog. Dialog cause: {0}",Qb),ig.a.instance.sbh(this.gkb?Object(Vf.a)(this,this.Fxf,"oicErrorDialogHandlerCloseForced"):Object(Vf.a)(this,this.Gxf,"oicErrorDialogHandlerNoCloseForced"),
Xa?Object(Vf.a)(this,this.vDf,"onLaunchDownload"):null,Qb))}};Bc.prototype.qAi=function(){try{var K=[Object.assign(new Nf.a,{name:"CorrelationId",string:this.rE}),Object.assign(new Nf.a,{name:"SessionOrigin",string:this.WXb}),Object.assign(new Nf.a,{name:"ClickTime",string:this.HSb}),Object.assign(new Nf.a,{name:"ProtocolHandlerFinishedTimestamp",double:(new Date).getTime()})];vi.a("OpenInClientCompleted",!0,0,K)}catch(na){ud.ULS.sendTraceTag(537773316,306,15,"Record OIC attempt failed: "+na.toString())}};
Bc.prototype.qof=function(){be.AFrameworkApplication.sa&&be.AFrameworkApplication.sa.Qa.Tw&&be.AFrameworkApplication.ha.ra("StandardProtocolDialogIsEnabled")?new Ad(this):new Ve(this)};Bc.prototype.Fxf=function(){this.closeApplication()};Bc.prototype.Gxf=function(){this.hdb()};Bc.prototype.vDf=function(){this.kof()};Bc.prototype.bci=function(){return this.LLe(!0)};Bc.prototype.LLe=function(K){var na=(Yf.a.YN||Yf.a.lI)&&!!be.AFrameworkApplication.k8b;na&&K&&(hh.a.wf(be.AFrameworkApplication.k8b,"_blank",
void 0,"OpenInClient"),this.closeApplication());return na};uk.Object.defineProperties(Bc.prototype,{hJf:{configurable:!0,enumerable:!0,get:function(){return this.nC}},options:{configurable:!0,enumerable:!0,get:function(){var K=0;be.AFrameworkApplication.ilj&&(K|=1);be.AFrameworkApplication.openInClientEditOnly&&(K|=4);this.CMj()&&(K|=64);return K}},Ztb:{configurable:!0,enumerable:!0,get:function(){return be.AFrameworkApplication.mD}},vzb:{configurable:!0,enumerable:!0,get:function(){return be.AFrameworkApplication.qzb}},
Ycf:{configurable:!0,enumerable:!0,get:function(){return""}},mod:{configurable:!0,enumerable:!0,get:function(){return""}},$ag:{configurable:!0,enumerable:!0,get:function(){return be.AFrameworkApplication.ha.ra("OneNoteMobileViewerIsEnabled")}},gCc:{configurable:!0,enumerable:!0,get:function(){return this.bge||(this.bge=Xh.a.instance.resolve("Common.IOfficeTrialExperience"))}},ZKi:{configurable:!0,enumerable:!0,get:function(){return!!be.AFrameworkApplication.ha&&be.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OicAshaLoggingIsEnabled",
!1)}}});Bc.z_i="OpenInDesktop";Bc.x_i="OpenInBrowser";Bc.Gtj=ri.a.tua("B5F65EF9-A5B1-4887-A968-C779537C8303");Object(Sd.a)(Bc,"AOpenInClientOperation",null,[]);var Tj=b(206),Jh=b(210),Ui=b(118),Kh=b(46),Yi=b(43),jh=b(194),bh=b(95),Wj=b(34),Df=b(521),ek=b(1249),Kj=b(649);Am(we,Bc);we.prototype.J4g=function(){this.OQf(this.TYe)};we.prototype.J6g=function(){var K=this,na=this.$;Yg.TaskExtensions.Ba(this.FK.value,function(Xa){K.zHa(na.workbookContext.ClientUrl,be.AFrameworkApplication.G4,1,na.isEditMode?
2:0,!0,new mf.a(function(){return Xa.result}))},this.la,3)};we.prototype.Dld=function(){0!==wd.a.vg.editMode&&(this.$.yb.Tz=!1)};we.prototype.c$e=function(){var K={};K[M.a.kac]=!1;K[M.a.UV]="OpenInExcel";this.$.ae(802602464,Oa.a.$b,8,K)};we.prototype.m5c=function(){var K=this;if(this.ea.sc){var na=this.$;na.isEditMode&&Yg.TaskExtensions.Ba(this.FK.value,function(Xa){K.zHa(na.workbookContext.ClientUrl,be.AFrameworkApplication.G4,1,2,!1,new mf.a(function(){return Xa.result}))},this.la,3)}};we.prototype.NFe=
function(){var K=this;this.ea.sc&&Yg.TaskExtensions.Ba(this.FK.value,function(na){K.zHa(K.$.workbookContext.ClientUrl,be.AFrameworkApplication.G4,1,K.$.isEditMode?2:0,!1,new mf.a(function(){return na.result}))},this.la,3)};we.prototype.openInExcelClient=function(){var K=this;this.ea.sc&&(this.$.isEditMode||Yg.TaskExtensions.Ba(this.FK.value,function(na){K.zHa(K.$.workbookContext.ClientUrl,be.AFrameworkApplication.G4,1,0,!1,new mf.a(function(){return na.result}))},this.la,3))};we.prototype.openInBrowser=
function(){var K=this;this.ea.sc&&Yg.TaskExtensions.Ba(this.FK.value,function(na){K.zHa(K.$.workbookContext.ClientUrl,be.AFrameworkApplication.G4,1,5,!1,new mf.a(function(){return na.result}))},this.la,3)};we.prototype.downloadFile=function(K){var na=this.Kye(K);this.jba.downloadFile(na,K)};we.prototype.dJf=function(K,na){na=void 0===na?0:na;if(this.ea.sc){var Xa=this.$;Xd.a(Xa).fNa?this.eJf(K,Xa):0<na?this.wKj(K,Xa,na):this.i7f(Xa)}};we.prototype.zHa=function(K,na,Xa,Qb,tc,md){this.$.yb.Tz=!Te.EwaSettings.isChangeGateEnabled("OfficeVSO:5209012_KeepMenuEnableAfterOIC")||
!this.$.pc.inWebPart;this.TYe=tc;this.X4b=null;this.U9c=!1;this.YRg(K,na,Qb,tc,md)};we.prototype.W4b=function(K){var na=this.$.pc;ud.ULS.sendTraceTag(537154775,0,50,"OpenInExcelOperation.CompleteClientLaunch: IsEmbedded:{0}, InWebPart:{1}, DivSyndicated:{2}, Mode:{3}",na.inEmbedView,na.inWebPart,na.isDivSyndicated,this.$.isEditMode?Tj.a.edit:Tj.a.view);return we.kjf()?(this.w4b(),Od.y$c(this.BWa,this.nC,this.options,1,this.cPi,this.bPi,!1,be.AFrameworkApplication.ha.ra("OICEncodeUrlIsEnabled")),32):
Bc.prototype.W4b.call(this,K)};we.prototype.mDh=function(){this.ZWf();var K=this.$;if(!this.ea.pc.inWebPart&&this.ea.sc&&!K.isEditMode){var na=new bh.a(2145659238,Oa.a.$b,this.$.jd,0,null);this.FDe=Kh.a.instance.create(function(){K.Ka.dc(na)},0,Yi.a.A_i)}};we.prototype.dispose=function(){this.ea&&this.ea.tk(this.fd);Vd.a.tc([this.Oa,this.FDe,this.Hm]);this.$=this.ea=null};we.prototype.ADh=function(){this.ZWf()};we.prototype.kof=function(){var K=this;Kh.a.instance.create(function(){K.$.Ka.dc(new bh.a(-2028960985,
Oa.a.$b,0,30,null))},0,Yi.a.B_i,!0,!0)};we.prototype.TRg=function(K){var na=this.$,Xa=Xd.a(this.$).ud.activityState;Xa[Df.a.Aoe]=!0;na.isEditMode&&this.ea.sc?(this.w4b(),Ei.a(na).Jt(new Vh.a(Hg.a.Hz,5,function(){na.LI(!1);Xa[ec.a.tr]=Hg.a.y4b;Xa[Df.a.TDg]=K;Xa[ni.a.$dd]=!0;na.isEditMode&&(Xa[ni.a.zU]=1,Xa[ni.a.lZ]=!0,Xa[gd.a.i_b]=!0,Xa[gd.a.BWc]=!0);Xa[Df.a.Doe]=1455037301}))):this.OQf(K)};we.prototype.Z9f=function(){var K=be.AFrameworkApplication.G4;if(this.$.downloadCopyOnOpenInClient){if(8===this.$.frame.o$a(K,
!0)){var na=this.$.ea.pc;ud.ULS.sendTraceTag(537154773,0,50,"Url:[{0}] IsEmbedded:[{1}] InWebPart:[{2}] DivSyndicated:[{3}], Mode:[{4}]",K,na.inEmbedView,na.inWebPart,na.isDivSyndicated,this.$.isEditMode?Tj.a.edit:Tj.a.view)}}else this.jba.downloadFile(K,-2028960985);this.U9c=!0;this.w4b()};we.prototype.twi=function(){this.gCc.nxf&&this.gCc.Blc(1)};we.prototype.uwi=function(){this.gCc.nxf&&Ug.HelperMethods.wf(zg.a.v_(33),"_blank",void 0,"OpenExcelOperation.XLSViewerUnknownTryOffice")};we.prototype.Dwi=
function(){Ug.HelperMethods.wf(zg.a.v_(31),"_blank",void 0,"OpenExcelOperation.XLSBackstageUnknownTryMacOffice")};we.prototype.Ewi=function(){Ug.HelperMethods.wf(zg.a.v_(34),"_blank",void 0,"OpenExcelOperation.XLSViewerUnknownTryMacOffice")};we.prototype.Kye=function(K){var na=new Sys.StringBuilder,Xa=this.$.workbookContext,Qb=this.$.ya;na.append(this.$.Bea);na.append(Qb.FileHandlerRelativeUri);na.append("?id=");na.append(encodeURIComponent(Jh.a.dJb(Xa.WorkbookUri,"sc")));this.$.ea.sc&&(na.append("&sessionId="),
na.append(encodeURIComponent(this.$.ea.sessionId)));switch(K){case -974518828:na.append("&workbookType=PublishedItemsSnapshot");break;case -1804063550:na.append("&workbookType=FullWorkbook");break;case -1059172980:na.append("&workbookType=FullWorkbook&workbookFileType=Odf");break;default:na.clear()}Ui.a.lHa(na,Qb);return na.toString()};we.prototype.q5g=function(){lh.a.instance.x0g();var K=this.$.ya;MSOJS.ClientUtils.InitUrls(K.RoamingAppsX86RootUrl,K.RoamingAppsControlInstallerUrl,K.RoamingAppsFirefoxExtensionUrl)};
we.prototype.ZWf=function(){var K=this.$;this.ea.sc||Oe.a.dJd(K,Xd.a(K).ud);this.w4b();this.X4b&&this.X4b(this,this.U9c);K.frame.Pt.lm(this.$.frame.Bba());K.frame.gY.lm(this.$.frame.Bba());K.yb.Tz=!1;Og.g(K).focus()};we.prototype.YRg=function(K,na,Xa,Qb,tc){var md=this.$;be.AFrameworkApplication.sa&&!we.kjf()&&(md.frame.Pt.sn(md.frame.Bba()),md.frame.gY.sn(md.frame.Bba()));Bc.prototype.zHa.call(this,K,na,1,Xa,Qb,tc)};we.prototype.w4b=function(){var K=this.$;Xd.a(K).Ci.activityName===Hg.a.openInExcelClient&&
Xd.a(K).ud.iK()};we.prototype.hFj=function(){var K=Mg.a.ed(1,0,668,669,0,1341525452,"OpenInExcelActiveXError");Ei.a(this.$).Ss([K])};we.prototype.wKj=function(K,na,Xa){var Qb=this,tc=null,md=window.setTimeout(function(){Xd.a(na).Ruc(tc);Qb.i7f(na)},Xa);tc=function(){Xd.a(na).fNa&&(Xd.a(na).Ruc(tc),window.clearTimeout(md),Qb.eJf(K,na))};Xd.a(na).CXc(tc)};we.prototype.i7f=function(K){var na=Mg.a.ed(1,1,0,683,0,-1753121099,"ProcessingUserChangesFileDownloadIgnored");Ei.a(K).Ss([na])};we.prototype.eJf=
function(K,na){var Xa=this;Ei.a(na).Jt(new Vh.a(Hg.a.Hz,5,function(){na.LI(!1);var Qb=Xd.a(na).ud,tc=Qb.activityState;tc[ec.a.tr]=Hg.a.kNe;tc[Jd.a.k_b]=na.ea.pc.hasUnsupportedFeaturesForEdit;tc[Kj.a.vWc]=K;Qb.Wt(Mg.a.eba(Xa.businessBar.I$c,[1437034227]))}))};we.kjf=function(){return 1<wd.a.getRegisteredEwaInstances().length};uk.Object.defineProperties(we.prototype,{Ycf:{configurable:!0,enumerable:!0,get:function(){return"EditInExcelWebApp_32x32x32"}},la:{configurable:!0,enumerable:!0,get:function(){this.Hm=
this.Hm||new jh.a;return this.Hm.token}},mod:{configurable:!0,enumerable:!0,get:function(){return"excel32"}},$ag:{configurable:!0,enumerable:!0,get:function(){return this.ea.pc.inWebPart}}});Object(Sd.a)(we,"OpenInExcelOperation",Bc,[708,3]);var Ii=uh.a;Am(je,Ii);je.prototype.create=function(){var K=this;if(this.$.da.Aa(55))this.Eb(this.$.da.Aa(55));else{var na=wh.GetServiceTaskFactory.create(this.$.da,155,this.la,this.ub),Xa=wh.GetServiceTaskFactory.Ua(this.$.da,5,4,this.ub);Yg.TaskExtensions.Ba(Kg.Task.WAA(na,
Xa),function(){K.Eb(new we(K.$,new mf.a(function(){return wh.GetServiceTaskFactory.create(K.$.da,137,K.la,K.ub)}),Xa.result))},this.la,3)}};je.p5g=function(){je.Ixf||(je.Ixf=!0,(new Xe).hi(Xh.a.instance),Xh.a.instance.resolve("Common.IOfficeTrialExperience").Sg(),Xh.a.instance.resolve("Common.IMacOfficeOffer").Sg())};je.Ixf=!1;Object(Sd.a)(je,"OpenInClientFactory",uh.a,[]);var Pj=b(112),pk=b(411),bk=Pj.a;Am(yd,bk);yd.prototype.execute=function(K){var na=Object(bf.a)(6,K.Me);Yg.TaskExtensions.Ba(wh.GetServiceTaskFactory.create(na.da,
56,na.la,0),function(Xa){na.downloadCopyOnOpenInClient?(K.activityState[pk.a.Boe]=!0,Xa.result.Z9f()):Xa.result.J6g()},na.la,3);return 1};Object(Sd.a)(yd,"OpenInExcelClientActivity",Pj.a,[]);var vk=uh.a;Am(Ae,vk);Ae.prototype.create=function(){var K=this;Yg.TaskExtensions.Ba(wh.GetServiceTaskFactory.create(this.$.da,155,this.la,this.ub),function(){K.Eb(new yd(Hg.a.openInExcelClient,Hg.a.idle))},this.la)};Object(Sd.a)(Ae,"OpenInExcelClientActivityFactory",uh.a,[]);var lj=Xf.a;Am(De,lj);De.prototype.initialize=
function(K){lj.prototype.initialize.call(this,K)};De.prototype.execute=function(K){this.Ei=K;K=Object(bf.a)(6,this.Ei.Me);this.Ysb(K);return 1};De.prototype.tJ=function(K){lj.prototype.tJ.call(this,K)};De.prototype.Ysb=function(){var K=this;this.subscribe(this.Ei,this.S1i,function(na){K.tGd.add_disposing(na)})};De.prototype.gHb=function(K){this.unsubscribe(function(na){K.remove_disposing(na)});this.Ei.activityState[Ra.a.k3]=0};Object(Sd.a)(De,"PasswordProtectedFileActivity",Xf.a,[]);var zi=b(388),
Rk=zi.a;Am(Hf,Rk);Hf.prototype.Ybb=function(K){this.Rqa=K};Hf.prototype.k4=function(){var K={};K[zi.a.description]=Tc.a.instance.fa(1923);K[zi.a.Bna]=Tc.a.instance.fa(1919);K[zi.a.vKf]=Tc.a.instance.fa(1941);K[zi.a.tKf]=Tc.a.instance.fa(1942);K[zi.a.uKf]=Tc.a.instance.fa(1920);K[zi.a.zod]=Tc.a.instance.fa(1926);K[zi.a.Cwe]=Tc.a.instance.fa(1621);K[zi.a.n0j]=Tc.a.instance.Va(25);K[zi.a.Ejg]=Object(Vf.a)(this,this.yVa,"verifySubmittedPassword");return K};Hf.prototype.rua=function(){var K={};K[Qf.a.Cz]=
this.Cc;K[zi.a.Kxe]=this.k4();return K};Hf.prototype.mh=function(){this.lc=1;this.initializeAndShow(this.uo,this.Q$i,this.rua())};uk.Object.defineProperties(Hf.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"PasswordDialog"}},Ptb:{configurable:!0,enumerable:!0,get:function(){return this.Rqa}},uo:{configurable:!0,enumerable:!0,get:function(){return Tc.a.instance.fa(1922)}}});Object(Sd.a)(Hf,"PasswordProtectedFilePasswordInputDialog",zi.a,[]);var Lj=b(289);Am(zf,Hf);zf.prototype.Ybb=
function(K,na){Hf.prototype.Ybb.call(this,K,na);ud.ULS.sendTraceTag(537154755,0,50,"PasswordProtectedFileModifyActivity.PasswordProtectedFileModifyPasswordInputDialogDisposing: user response: {0}",K)};zf.prototype.yVa=function(K,na){this.passwordToModify=K;var Xa={};Xa.FileModifyPassword=Cf.a.rf(K);Rd.ob(this.$.na.ta,Xa,this.vZi(na),this.uZi(na),null,null)};zf.prototype.k4=function(){var K=Hf.prototype.k4.call(this);K[zi.a.zod]=Tc.a.instance.fa(1927);K[zi.a.description]=Tc.a.instance.Va(24);return K};
zf.prototype.mh=function(){yi.b().cad("PasswordToModifyDialogShown");ud.ULS.sendTraceTag(557446529,0,50,"PasswordProtectedFileModifyPasswordInputDialog.InitializeAndShowDialog: Initializing dialog.");Hf.prototype.mh.call(this)};zf.prototype.vZi=function(K){var na=this;return function(Xa){Mg.a.uh(Xa.Errors,[-2019873242])&&na.u8b(na.Qsb());if(!Xa||Lj.a(Xa))if(0<na.MOd)na.NPf(K);else{ud.ULS.sendTraceTag(537154754,0,10,"VerifyPasswordToModifyOperation.GenerateOnVerifyPasswordToModifyRequestSuccess: Unexpected error: {0}",
Mg.a.Wc(Xa.Errors));na.$.ea.Hp(Xa.Errors);na.hide();return}na.jce=Xa.Result;na.mjc&&(yi.b().NWd("UserAction","Password-To-Modify Workbook: Logging StopWatch duration after user enters corect password","PasswordToModifyPasswordVerifiedTillInteractive"),ud.ULS.sendTraceTag(555758470,0,50,"PasswordProtectedFileModifyPasswordInputDialog.OnVerifyPasswordToModifyRequestSuccess: User entered the correct password."));K(na.mjc?0:1)}};zf.prototype.uZi=function(K){var na=this;return function(){0<na.MOd?na.NPf(K):
(ud.ULS.sendTraceTag(537154753,0,10,"PasswordProtectedFileModifyInputDialog.OnVerifyPasswordToModifyRequestFailure: VerifyPasswordToModify request failed."),K(3))}};zf.prototype.NPf=function(K){--this.MOd;this.yVa(this.passwordToModify,K)};zf.prototype.Qsb=function(){return Mg.a.ed(1,0,1620,1621,1,-2019873242,"TooManyWrongPasswordAttemptFileModifyError")};uk.Object.defineProperties(zf.prototype,{mjc:{configurable:!0,enumerable:!0,get:function(){return this.jce}},uo:{configurable:!0,enumerable:!0,
get:function(){return Tc.a.instance.fa(1924)}}});Object(Sd.a)(zf,"PasswordProtectedFileModifyPasswordInputDialog",Hf,[]);Am(Ue,De);Ue.prototype.Ysb=function(K){this.tGd=new zf(K);De.prototype.Ysb.call(this,K)};Ue.prototype.gHb=function(K,na){var Xa=K.Ptb,Qb=K.mjc,tc=K.passwordToModify;De.prototype.gHb.call(this,K,na);this.Ei.fza([2001366804]);switch(Xa){case 1:Qb?(na=Object(bf.a)(6,this.Ei.Me),this.Ei.activityState[Ra.a.Roe]=Cf.a.rf(tc),this.Ei.activityState[Ra.a.OZa]=!0,K.passwordToModify="",this.Dh(na.isEditMode?
Hg.a.Zj:this.oN)):ud.ULS.sendTraceTag(537154757,0,50,"PasswordProtectedFileModifyActivity.PasswordProtectedFilePasswordInputDialogDisposing: Unexpected State , Dialog disposed but password not verified.");this.Ep();break;case 0:this.Ei.activityState[Ra.a.mt]=!1;this.Dh(this.vK);this.Ep();break;default:ud.ULS.sendTraceTag(537154756,0,50,"PasswordToModifyFileModifyActivity.OnPasswordInputCommited: unhandled user response '{0}'",Xa)}};Object(Sd.a)(Ue,"PasswordProtectedFileModifyActivity",De,[]);var zj=
uh.a;Am(He,zj);He.prototype.create=function(){this.Eb(new Ue(this.activityName,this.oN,this.vK))};He.ka=function(K){K.da.Ha(434,new He(Hg.a.fHb,Hg.a.egb,Hg.a.cIa,K))};Object(Sd.a)(He,"PasswordProtectedFileModifyActivityFactory",uh.a,[]);Am(qd,Hf);qd.prototype.yVa=function(K,na){this.password=K;na(0)};qd.prototype.k4=function(){var K=Hf.prototype.k4.call(this);this.tmf&&(K[zi.a.Aqh]=1);return K};qd.prototype.mh=function(){ud.ULS.sendTraceTag(537154722,0,50,"PasswordProtectedFileOpenPasswordInputDialog.InitializeAndShowDialog: Initializing dialog. isWrongPassword={0}",
this.tmf);Hf.prototype.mh.call(this);Ei.a(this.$).Sse()};Object(Sd.a)(qd,"PasswordProtectedFileOpenPasswordInputDialog",Hf,[]);Am(ne,De);ne.prototype.Ysb=function(K){var na=Mg.a.uh(this.Ei.errors,[1217361942]);this.tGd=new qd(K,na);K.Bhc||K.ELe();De.prototype.Ysb.call(this,K)};ne.prototype.gHb=function(K,na){var Xa=K.password;K.password="";var Qb=K.Ptb;De.prototype.gHb.call(this,K,na);this.Ei.activityState[Ra.a.FWc]=Cf.a.rf(Xa);this.Ei.activityState[Ra.a.OZa]=!0;this.Ei.fza([110414285,1217361942]);
ud.ULS.sendTraceTag(537154752,0,50,"PasswordProtectedFileOpenActivity.PasswordProtectedFileOpenPasswordInputDialogDisposing: user response: {0}",Qb);switch(Qb){case 1:this.Dh(this.oN);this.Ep();break;case 0:this.Dh(this.vK),this.Ep()}};Object(Sd.a)(ne,"PasswordProtectedFileOpenActivity",De,[]);var rj=uh.a;Am(od,rj);od.prototype.create=function(){this.Eb(new ne(this.activityName,this.oN,this.vK))};od.ka=function(K){K.da.Ha(386,new od(Hg.a.Lrc,Hg.a.Zj,Hg.a.Mk,K))};Object(Sd.a)(od,"PasswordProtectedFileOpenActivityFactory",
uh.a,[]);var Th=b(397),ck=Th.a;Am(La,ck);La.prototype.sP=function(K,na){this.Rqa=K;ck.prototype.sP.call(this,K,na)};La.prototype.Sr=function(){ck.prototype.Sr.call(this);this.lc=9;var K=this.vXh();this.Bc(1,Tc.a.instance.fa(1619));this.Bc(2,Tc.a.instance.fa(963));this.Fk(Tc.a.instance.fa(689),Ld.a.Il(K),this.icon,this.tP)};La.prototype.vXh=function(){return String.format(Tc.a.instance.fa(690))};uk.Object.defineProperties(La.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"SharedWorkbookDialog"}},
Ptb:{configurable:!0,enumerable:!0,get:function(){return this.Rqa}}});Object(Sd.a)(La,"LegacySharedWorkbookDialog",Th.a,[]);var Uj=Xf.a;Am($d,Uj);$d.prototype.initialize=function(K){Uj.prototype.initialize.call(this,K)};$d.prototype.execute=function(K){this.Ei=K;this.a$g();return 1};$d.prototype.tJ=function(K){Uj.prototype.tJ.call(this,K)};$d.prototype.a$g=function(){var K=Object(bf.a)(6,this.Ei.Me),na=Mg.a.w0a([-573864504]);na[0].HelpDescription=Tc.a.instance.fa(692);na[0].HelpTopicId=td.a.bxi;var Xa=
new La(K,na[0]);this.subscribe(this.Ei,this.axi,function(Qb){Xa.add_disposing(Qb)})};Object(Sd.a)($d,"LegacySharedWorkbookActivity",Xf.a,[]);var of=uh.a;Am(Cd,of);Cd.prototype.create=function(){this.Eb(new $d(this.activityName,this.oN,this.vK))};Cd.ka=function(K){K.da.Ha(460,new Cd(Hg.a.$Cb,Hg.a.egb,Hg.a.cIa,K))};Object(Sd.a)(Cd,"LegacySharedWorkbookActivityFactory",uh.a,[]);ed.prototype.$c=function(){return!1};ed.prototype.Mc=function(K,na){if(!Te.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PresentMode",
!1))return!1;switch(na.command){case 642419866:return!0;case 588342182:return this.presentModeManager.Qz;default:return!1}};ed.prototype.executeCommand=function(K,na){K=Yg.TaskExtensions.Dl();na=na.command;switch(na){case 642419866:this.presentModeManager.$zc(!this.presentModeManager.Qz);this.presentModeManager.Bh("TogglePresentMode");break;case 588342182:this.presentModeManager.A8a=!this.presentModeManager.A8a;this.presentModeManager.i8f(this.presentModeManager.A8a,"TogglePresentModeOverlay");this.presentModeManager.Bh("TogglePresentModeOverlay");
break;default:K=k.a(na)}return K};ed.prototype.nd=function(){return!1};Object(Sd.a)(ed,"PresentModeCommandHandler",null,[434]);var oi=eh.a;Am(uc,oi);uc.prototype.Qd=function(){var K=this;Yg.TaskExtensions.Ba(wh.GetServiceTaskFactory.Ua(this.$.da,423,424,this.ub),function(na){K.Jd([new ed(K.$,na.result)])},this.la,3)};uc.ka=function(K){eh.a.je(420,new uc(K))};Object(Sd.a)(uc,"PresentModeCommandHandlerFactory",eh.a,[]);var si=b(125),ih=b(111);id.Lwh="ewa-presentMode-overlay";id.Mwh="ewa-presentMode-panel-container";
id.Nwh="ewa-presentMode-rowHdrParent-container";Object(Sd.a)(id,"CssClassNames",null,[]);var L=b(17),Ea=b(152),Ya=b(302),Vb=b(131),Vc=b(120),re=b(465),Pe=b(11),hf=b(98),Lf=b(358),Ff=b(132),Ng=b(442),Cg=b(269),mh=b(253),Qh=b(187);Lb.prototype.dispose=function(){this.$=this.RHd=this.SHd=this.Dda=this.VQa=null};Lb.prototype.wfi=function(){var K=this;window.requestAnimationFrame(function(){K.Dda=document.createElement("div");K.$.xw.insertBefore(K.Dda,K.$.xw.lastChild);K.Dda.id=K.$.Lb+M.a.bbc;K.Dda.classList.add(id.Mwh);
K.SHd=document.getElementById(K.$.Lb+M.a.q8c);K.RHd=[K.$.fF];K.isInitialized=!0});this.VQa=presentMode.PresentModeControllerFactoryGlobal.createPresentModeFloatieController();this.VQa.initializePresentModeFloatie()};Lb.prototype.N3h=function(){var K={};K.PollingCountPerCaller=ih.a.toJSON(this.lsc);K.PollingDurationPerCaller=ih.a.toJSON(this.msc);return K};Lb.prototype.gVd=function(K){this.isInitialized?K?(this.VQa.showPresentModeFloatie(this.Dda,this.SHd,this.RHd),this.Bh("ShowOrHideFloatiePanel"),
this.Wcj()):(this.VQa.hidePresentModeFloatie(),this.IUj()):ud.ULS.sendTraceTag(537154326,0,15,"PresentModeFloatieManager.ShowOrHideFloatiePanel called before initialization complete")};Lb.prototype.Bh=function(K){this.uLf=Ug.HelperMethods.kc();this.QQa=K;this.gwe=Qh.AsyncMethodContext.av(this.Tl,100,Yi.a.L5i+K,this.gwe)};Lb.prototype.Qe=function(K,na){if(na)return!1;K=Pe.DOMElementExtensions.Nl(this.Dda.querySelectorAll(Pe.DOMElementExtensions.nq));if(!K)return ud.ULS.sendTraceTag(537154325,0,10,
"PresentModeFloatieManager.SetFocusOnSection: Could not find first focusable item in present mode toolbar"),!1;K.focus();return!0};Lb.prototype.eg=function(K){return Pe.DOMElementExtensions.Se(this.Kb,K)};Lb.prototype.ji=function(){};Lb.prototype.Xh=function(){};Lb.prototype.Wcj=function(){var K=this;Cg.a(this.$).Xg(this);this.$.da.Ya(15,function(na){K.ewaAccessibilityManager=na;K.ewaAccessibilityManager.mode=5});Ye.KeyInputManager.instance.qa(Bf.a.Ub,this.Kb,this.onKeyDown)};Lb.prototype.IUj=function(){Cg.a(this.$).eA(this);
Og.g(this.$).s1();this.ewaAccessibilityManager&&(this.ewaAccessibilityManager.mode=0);Ye.KeyInputManager.instance.za(Bf.a.Ub,this.Kb,this.onKeyDown)};Lb.prototype.upj=function(){var K=Ug.HelperMethods.kc()-this.uLf,na=this.msc[this.QQa]?this.msc[this.QQa]:0;this.msc[this.QQa]=na>K?na:K;this.lsc[this.QQa]=this.lsc[this.QQa]?this.lsc[this.QQa]+1:1};uk.Object.defineProperties(Lb.prototype,{Kb:{configurable:!0,enumerable:!0,get:function(){return this.Dda}},canReceiveFocus:{configurable:!0,enumerable:!0,
get:function(){this.VQa.updatePresentModeFloatieShyState(2);return!!this.Dda}},de:{configurable:!0,enumerable:!0,get:function(){return mh.a.DMf}}});Object(Sd.a)(Lb,"PresentModeFloatieManager",null,[706,451,3]);var Ji=b(59);Object(Sd.a)(vd,"OverlayCavityInfo",null,[]);Object(Sd.a)(ie,"OverlayContainerInfo",null,[]);Object(Sd.a)(Zd,"PresentModeOverlayProps",null,[]);Pc.prototype.egi=function(){var K=this;this.THd=presentMode.PresentModeControllerFactoryGlobal.createPresentModeOverlayController();window.requestAnimationFrame(function(){K.H0a=
Array(5);for(var na,Xa,Qb=1;4>=Qb;Qb++)na=document.createElement("div"),Pe.DOMElementExtensions.setVisible(na,!1),na.id=String.format("{0}-{1}","PresentModeOverlay",Qb),Pe.DOMElementExtensions.toggleCssClass(na,id.Lwh,!0),Xa=K.gridView.Kf(Qb).domElement,Xa.insertBefore(na,Xa.firstChild),K.H0a[Qb]=na})};Pc.prototype.h8f=function(K){K&&this.YXj();for(var na=1;4>=na;na++)this.Hjf(na)&&Pe.DOMElementExtensions.setVisible(this.H0a[na],K);Pe.DOMElementExtensions.toggleCssClass(this.$.zr,"ewr-presentMode-overlay",
K)};Pc.prototype.YXj=function(){for(var K=this.SXg(),na,Xa=1;4>=Xa;Xa++)na=Xa,K[na]&&this.THd.showOverlayWithCavity(this.H0a[na],K[na])};Pc.prototype.dispose=function(){this.THd=this.H0a=this.gridView=this.$=null};Pc.prototype.SXg=function(){for(var K,na,Xa=Og.g(this.$).rtl,Qb,tc=Array(5),md=1;4>=md;md++)na=md,this.Hjf(md)&&(K=this.gridView.Kf(md),Qb=this.gridView.ga.Pa.W5?this.TUh(md,K,Xa):this.LVh(md,K,Xa),K=this.Fbh(K),tc[na]=this.Ybh(this.H0a[na].id,K,Qb));return tc};Pc.prototype.Hjf=function(K){return this.gridView.rb.QK(K)};
Pc.prototype.Fbh=function(K){return Object.assign(new ie,{width:K.An.width,height:K.An.height})};Pc.prototype.Ybh=function(K,na,Xa){return Object.assign(new Zd,{containerId:K,overlayContainerInfo:na,overlayCavityInfos:Xa?[Xa]:null})};Pc.prototype.TUh=function(K,na,Xa){var Qb=Og.g(this.$).ga.Pa.nc;if(!Qb)return ud.ULS.sendTraceTag(537154317,0,10,"PresentModeOverlayRenderer.GetFloatingObjectOverlayCavityInfo: Selected Floating Object is null."),null;var tc=Qb.extension.WUh(K);K=tc.ZCa;Qb=tc.rotation;
var md=tc.translateX;var Dd=tc.translateY;return tc.returnValue?(tc=K.x-na.An.x,Object.assign(new vd,{left:(Xa?na.An.width-(tc+K.width):tc)-3+1,top:K.y-na.An.y-3+1,width:K.width+5,height:K.height+5,angle:Qb,translateX:md,translateY:Dd})):null};Pc.prototype.LVh=function(K,na,Xa){K=this.gridView.Fb.Ewb(this.gridView.ga.va.activeRange,K)||Ji.a.T4;if(!K.We(na.An))return null;var Qb=K.x-na.An.x;return Object.assign(new vd,{left:Xa?na.An.width-(Qb+K.width)-2:Qb-3,top:K.y-na.An.y-3,width:K.width+5,height:K.height+
5})};Object(Sd.a)(Pc,"PresentModeOverlayRenderer",null,[705,3]);var Zi=zi.a;Am(Sc,Zi);Sc.prototype.hide=function(){Zi.prototype.hide.call(this);si.a.Mv(M.a.n8f,"false",this.$.ya.ShowPresentModeWelcomeDialogCookieExpirationDays)};uk.Object.defineProperties(Sc.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"PresentModeWelcomeDialog"}}});Object(Sd.a)(Sc,"PresentModeWelcomeDialog",zi.a,[]);Ge.requestFullscreen=function(K){K.webkitRequestFullscreen?K.webkitRequestFullscreen():K.msRequestFullscreen?
K.msRequestFullscreen():K.mozRequestFullScreen?K.mozRequestFullScreen():K.requestFullscreen?K.requestFullscreen():ud.ULS.sendTraceTag(7145619,210,50,"RequestFullscreen got invoked in unknown browser")};Ge.exitFullscreen=function(){document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.exitFullscreen?document.exitFullscreen():ud.ULS.sendTraceTag(7145620,210,50,"ExitFullscreen got invoked in unknown browser")};
uk.Object.defineProperties(Ge,{GKh:{configurable:!0,enumerable:!0,get:function(){return document.webkitFullscreenEnabled?"webkitfullscreenchange":document.msFullscreenEnabled?"MSFullscreenChange":document.mozFullScreenEnabled?"mozfullscreenchange":document.fullscreenEnabled?"fullscreenchange":null}},HKh:{configurable:!0,enumerable:!0,get:function(){return"undefined"!==typeof document.webkitFullscreenEnabled?"webkitfullscreenerror":"undefined"!==typeof document.msFullscreenEnabled?"MSFullscreenError":
"undefined"!==typeof document.mozFullScreenEnabled?"mozfullscreenerror":"undefined"!==typeof document.fullscreenEnabled?"fullscreenerror":null}},Ani:{configurable:!0,enumerable:!0,get:function(){return!!document.webkitFullscreenElement||!!document.msFullscreenElement||!!document.mozFullScreenElement||!!document.fullscreenElement}}});Object(Sd.a)(Ge,"FullscreenUtils",null,[]);Ud.prototype.$zc=function(K){var na=this;this.Qz!==K&&(this.mce=K,this.A8a=this.Qz,this.uff(),this.NMb=this.W6f(),window.requestAnimationFrame(function(){Pe.DOMElementExtensions.toggleCssClass(na.$.zr,
"ewr-presentMode-transition",!0);$addHandler(na.F3a,"transitionend",na.Cpa);na.nGj(!K);na.E0i();Pe.DOMElementExtensions.toggleCssClass(na.$.zr,"ewr-presentMode-on",K);na.mGj(K);Ea.b(na.$).f8f(na.Qz);Ea.c(na.$).f8f(na.Qz);na.$.eoa();na.XQa.h8f(na.NMb);if(na.Qz){na.U_a();si.a.get(M.a.n8f)?na.Eda.gVd(na.Qz):na.Isc=new Sc(na.$,na.Eda);var Xa=Ng.b(na.$);Xa&&(na.UOd=Xa.Q$c(!1));na.CMf=Ug.HelperMethods.kc()}else na.Eda.gVd(K),na.UOd&&(Xa=Ng.b(na.$))&&(Xa.Q$c(!0),na.UOd=!1),na.Z7b(),na.FAi()}))};Ud.prototype.i8f=
function(K,na){this.lVd=K;this.ofa(na)};Ud.prototype.Bh=function(K){this.Eda.Bh(K)};Ud.prototype.dispose=function(){this.Z7b();this.XQa&&(this.XQa.dispose(),this.XQa=null);this.gridView=this.$=null};Ud.prototype.nGj=function(K){var na=this.$.da.Aa(25);void 0===na||null===na?ud.ULS.sendTraceTag(537154324,0,10,"PresentModeManager.ShowOrHideGridPresence: presenceView is null"):K?na.Uzc():na.Rfc()};Ud.prototype.E0i=function(){var K=this;Pe.DOMElementExtensions.toggleCssClass(document.getElementById(be.AFrameworkApplication.O3a),
L.a.kp,this.Qz);Pe.DOMElementExtensions.toggleCssClass(this.$.zr,"ewr-presentMode-on",this.Qz);this.qGj(this.Qz);this.gridView.Qrd=!this.Qz;this.nYj();this.$.da.Ya(32,function(na){na.JYj(K.Qz)});Vc.b(this.$,function(na){na.hhg(K.Qz)})};Ud.prototype.qGj=function(K){if(this.KHb)if(K){if(K=Object(bf.a)(hf.a,this.$.oa))Pe.DOMElementExtensions.toggleCssClass(this.$.zr,"ewr-presentMode-on-headers-off",!K.headersVisible),Pe.DOMElementExtensions.toggleCssClass(this.$.zr,"ewr-presentMode-on-rtl",Og.g(this.$).rtl);
this.JDc(0)}else this.$.zr.classList.remove("ewr-presentMode-on-headers-off"),this.$.zr.classList.remove("ewr-presentMode-on-rtl"),this.JDc(1)};Ud.prototype.JDc=function(K){var na=Object(bf.a)(hf.a,this.$.oa);if(na){var Xa=parseInt(this.$.xw.style.right,10);if(1===K||2===K){if(isNaN(Xa)||Xa<this.p2a)return;Xa-=this.p2a}if(0===K||2===K)K=na.headersVisible,na=Og.g(this.$).rtl,K=K?na?0:32:12,Xa=isNaN(Xa)?K:Xa+K,this.p2a=K;this.$.xw.style.right=Ug.HelperMethods.Yb(Xa);this.DFe=Xa}};Ud.prototype.nYj=function(){var K=
document.getElementById(this.$.Lb+M.a.z7b).parentNode;Pe.DOMElementExtensions.toggleCssClass(K,id.Nwh,this.Qz)};Ud.prototype.initialize=function(K){this.XQa=new Pc(K);this.XQa.egi();this.Eda=new Lb(K);this.Eda.wfi();this.F3a=document.getElementById("MainApp");this.yZe=this.cQi;$addHandler(this.F3a,Ge.GKh,this.yZe);$addHandler(this.F3a,Ge.HKh,this.dQi);this.KHb||(this.KHb=document.createElement("div"),this.KHb.className="ewa-presentMode-right-frame",this.$.fF.appendChild(this.KHb));this.Cpa=this.ufj};
Ud.prototype.U_a=function(){this.gridView.ga.x3(this.Gp);this.gridView.ga.oZ(this.zh);this.gridView.Ac.wl(this.mj);this.gridView.Ac.Wo(this.Rg);this.gridView.RE(this.Fp);this.gridView.view.nt(this.ax);this.gridView.L_b(this.yza);this.gridView.Da.lH(this.Rm);this.gridView.Da.xr(this.Xe);this.$.xa.Nf(this.li);this.$.xa.Xsa(this.gG);this.$.xa.Oha(this.oGb);this.$.aB(this.lj);this.$.fl(this.vd);var K=Object(bf.a)(Lf.a,this.$.xa);K=Cl(K.items);for(var na=K.next();!na.done;na=K.next())na.value.rpb(this.Sza)};
Ud.prototype.Z7b=function(){this.gridView&&(this.gridView.ga.Q7(this.Gp),this.gridView.ga.EX(this.zh),this.gridView.Ac.$k(this.mj),this.gridView.Ac.Zn(this.Rg),this.gridView.wG(this.Fp),this.gridView.view.fr(this.ax),this.gridView.Luc(this.yza),this.gridView.Da.MI(this.Rm),this.gridView.Da.Jp(this.Xe));if(this.$){this.$.xa.Ag(this.li);this.$.xa.UAa(this.gG);this.$.xa.Xna(this.oGb);this.$.UD(this.lj);this.$.Bl(this.vd);var K=Object(bf.a)(Lf.a,this.$.xa);K=Cl(K.items);for(var na=K.next();!na.done;na=
K.next())na.value.SMd(this.Sza)}};Ud.prototype.W6f=function(){if(!this.Qz||!this.A8a)return!1;if(1===this.gridView.ga.Ye){var K=this.$.oa.activeRange.isSingle,na=1===this.$.oa.selectedRanges.length&&!K,Xa=this.gridView.isEditing,Qb=this.Ktd;na||ud.ULS.sendTraceTag(537154322,0,50,"PresentModeManager.ShouldShowPresentModeOverlay: Not showing present mode overlay, single cell selection : {0}",K);return this.lVd&&na&&!Xa&&!Qb}return this.lVd};Ud.prototype.mGj=function(K){K?Ge.requestFullscreen(this.F3a):
Ge.exitFullscreen()};Ud.prototype.ofa=function(K,na,Xa){var Qb=this;Xa=void 0===Xa?!1:Xa;void 0!==na&&na||(this.NMb=this.W6f());ud.ULS.sendTraceTag(555356484,0,100,"PresentModeManager.UpdateLayout: UpdateLayout triggered by {0}, visibility: {1}, immediateUpdate: {2}",K,this.NMb,Xa);if(this.EPb&&Xa)ud.ULS.sendTraceTag(543023559,0,50,"PresentModeManager.UpdateLayout: Cancel update layout for {0}",this.DPb),window.cancelAnimationFrame(this.DPb),this.DPb=0;else if(this.EPb){ud.ULS.sendTraceTag(543023558,
0,50,"PresentModeManager.UpdateLayout: Skipping update layout for {0}",K);return}Xa?this.E0d(Ug.HelperMethods.kc(),K):(this.DPb=window.requestAnimationFrame(function(tc){Qb.E0d(tc,K)}),this.EPb=!0)};Ud.prototype.E0d=function(K,na){var Xa=this,Qb=Ug.HelperMethods.kc();if(Qb-K>this.fqj)this.DPb=window.requestAnimationFrame(function(md){Xa.E0d(md,na)}),this.EPb=!1,ud.ULS.sendTraceTag(537154319,0,50,"PresentModeManager.UpdateLayoutCallback: Scheduling update for next frame,  ElapsedTime = {0}ms.",Qb-
K);else{this.XQa.h8f(this.NMb);this.EPb=!1;var tc=Ug.HelperMethods.kc();K=Ug.HelperMethods.kc()-K;Qb=tc-Qb;this.ipj(K,na);ud.ULS.sendTraceTag(537154318,0,50,"PresentModeManager.UpdateLayoutCallback: UpdateLayoutTotalDuration = {0}ms. rafTotalDuration = {1}ms",Qb,K)}};Ud.prototype.uff=function(){var K=this;lc.a(this.$.userOperationManager,function(na,Xa,Qb){var tc=K.$.na.ta,md=K.Qz,Dd=tc.Ma(41,null);Dd.shouldEnablePresentMode=md;return Rd.i(tc,"SetPresentMode",Dd,na,Xa,Qb,null,0)},function(na){return new Oc.a(252,
0,na)},null)};Ud.prototype.LZf=function(){var K=re.a(this.gridView.Ye);1!==this.gridView.Ye||this.$.oa.activeRange.isSingle||(K="Range");this.sxc[K]=this.sxc[K]?this.sxc[K]+1:1};Ud.prototype.ipj=function(K,na){var Xa=this.rrc[na]?this.rrc[na]:0;this.rrc[na]=Xa>K?Xa:K;this.qrc[na]=this.qrc[na]?this.qrc[na]+1:1};Ud.prototype.FAi=function(){var K={},na=Ug.HelperMethods.kc()-this.CMf;K.PresentModeDuration=na;K.SelectionCountPerObject=ih.a.toJSON(this.sxc);K.OverlayCountPerCaller=ih.a.toJSON(this.qrc);
K.OverlayDurationPerCaller=ih.a.toJSON(this.rrc);na=this.Eda.N3h();for(var Xa in na)K[Xa]=na[Xa];Ff.b(this.$).he(Vb.a.K5i,K,void 0,!0)};uk.Object.defineProperties(Ud.prototype,{Qz:{configurable:!0,enumerable:!0,get:function(){return this.mce}}});Object(Sd.a)(Ud,"PresentModeManager",null,[683,3]);var sj=b(290),Aj=uh.a;Am(Ne,Aj);Ne.prototype.create=function(){var K=this,na=wh.GetServiceTaskFactory.Ua(this.$.da,283,284,1);Yg.TaskExtensions.Ba(na,function(){Yg.TaskExtensions.Ba(sj.c(na.result.ho.loadScript("presentMode")),
function(){var Xa=K.$.da.Aa(423);Xa||(Xa=new Ud(K.$),K.$.da.Ha(423,Xa));K.Eb(Xa)},K.$.la,3)},this.$.la,3)};Ne.ka=function(K){K.da.Ha(424,new Ne(K))};Object(Sd.a)(Ne,"PresentModeManagerFactory",uh.a,[]);var bi=b(177),fj=b(160),Qj=b(726),hk=b(87),Qi=b(30);Hd.pxh="ewa-resizehdr-row-hidden";Hd.oxh="ewa-resizehdr-col-hidden";Object(Sd.a)(Hd,"CssClassNames",null,[]);var Xj=b(61),bj=b(24),ch=b(150),$i=b(52),ci=b(71),Mj=b(257),Gj=b(389);Object(Sd.a)(ad,"HeaderEventCachedInfo",null,[]);sb.prototype.dGe=function(K){K=
Ug.HelperMethods.UGd(K);return Math.max(0,Math.min(sb.Etf,K))};sb.prototype.VFe=function(K){return this.d3i(K)};sb.prototype.m3g=function(K){return Math.round(this.k$c*K+2*this.Z1e()+1)};sb.prototype.d3i=function(K){return Math.max(0,Math.min(sb.ntf,(Math.max(0,Math.min(qg.a.Vmc,K))-2*this.Z1e()-1)/this.k$c))};sb.prototype.Z1e=function(){return Math.floor(Math.max((this.k$c+3)/4,2))};sb.prototype.ydc=function(K,na){return na?K?sb.Etf:qg.a.gzd:K?sb.ntf:qg.a.Vmc};sb.Etf=409;sb.ntf=255;Object(Sd.a)(sb,
"ResizeHeadersConverter",null,[]);var ik=b(32),jk=hk.a;Am(Ac,jk);Ac.prototype.YPa=function(K,na,Xa){this.z5i(K,na,Xa);K=this.fAc();this.Mfd(this.bUa,K,!0);this.dBa||(bi.a.instance.qa(Bf.a.ph,this.domElement.ownerDocument.body,this.dDd),this.dBa=!0)};Ac.prototype.dispose=function(){this.k3c();this.grid.ga&&(this.grid.ga.P7(this.zh),this.grid.ga.Q7(this.Gp));this.grid.Nt(this.zh);Ei.a(this.grid.$)&&Ei.a(this.grid.$).yg.Yna(this.jG);pj.a.instance.za(Bf.a.qk,this.domElement,this.gda);bi.a.instance.za(Bf.a.$d,
this.domElement.ownerDocument.body,this.fpc);fj.a.instance.za(Bf.a.Ce,this.domElement.ownerDocument.body,this.fpc);Yf.a.zp||(bi.a.instance.za(Bf.a.pointerDown,this.domElement,this.EO),bi.a.instance.za(Bf.a.ph,this.domElement,this.FS));this.dBa&&(bi.a.instance.za(Bf.a.ph,this.domElement.ownerDocument.body,this.R$a),fj.a.instance.za(Bf.a.Dg,this.domElement.ownerDocument.body,this.R$a),this.dBa=!1);this.SG&&(bi.a.instance.za(Bf.a.pointerDown,this.SG,this.EO),pj.a.instance.za(Bf.a.qk,this.SG,this.gda),
this.k3c(),this.SG=null);this.AXf&&(Pe.DOMElementExtensions.vf(Ac.fdb),Ac.fdb=null);this.Df=null;jk.prototype.dispose.call(this)};Ac.prototype.tcj=function(){pj.a.instance.qa(Bf.a.qk,this.domElement,this.gda);bi.a.instance.qa(Bf.a.$d,this.domElement.ownerDocument.body,this.fpc);fj.a.instance.qa(Bf.a.Ce,this.domElement.ownerDocument.body,this.fpc);Yf.a.zp||(bi.a.instance.qa(Bf.a.pointerDown,this.domElement,this.EO),bi.a.instance.qa(Bf.a.ph,this.domElement,this.FS))};Ac.prototype.jqh=function(){if(!Ac.fdb){document.getElementById(Ac.zXf);
this.AXf=!0;var K=Ac.fdb=document.createElement("div");this.grid.$.frame.Bba().appendChild(K);K.id=Ac.zXf;K.className=Qi.a.qxh;Pe.DOMElementExtensions.setVisible(K,!1)}};Ac.prototype.dPe=function(){this.dBa&&(bi.a.instance.za(Bf.a.ph,this.domElement.ownerDocument.body,this.R$a),fj.a.instance.za(Bf.a.Dg,this.domElement.ownerDocument.body,this.R$a),this.dBa=!1);this.j6=!1;this.knj();this.bMd();Gj.c(this.grid.$,!0,"HeaderResizeBehavior:PrepareResizeOperation")};Ac.prototype.knj=function(){this.grid.Fb.si([this.isRow?
13:14]);this.grid.Fb.Zeb()};Ac.prototype.dDd=function(){return!0};Ac.prototype.Mfd=function(K,na,Xa){this.SN&&Xa&&(ud.ULS.sendTraceTag(537154051,2,15,"HeaderResizeBehavior.GenerateResizeTooltip: headerResizeTooltipElement already created, creating a new element instead"),this.bMd());this.SN||Xa||ud.ULS.sendTraceTag(537154050,2,15,"HeaderResizeBehavior.GenerateResizeTooltip: headerResizeTooltipElement is null, creating a new element instead");this.Dxd&&this.Dxd(function(){var Qb={};return Qb.Location=
"canvas",Qb});this.SN?this.s_e(na):(this.SN=document.createElement("div"),this.SN.id=this.tai,this.s_e(na),this.SN.className=Qi.a.jvh,na=document.getElementById(this.grid.$.Lb+M.a.fvf),na.insertBefore(this.SN,na.firstChild),K=ik.a(this.grid.$).Gka(K),this.SN.style.left=(this.rtl?Math.max(K.x-this.SN.offsetWidth,0):K.x-Math.max(K.x+this.SN.offsetWidth-na.offsetWidth,0)).toString()+"px",na=document.getElementById(M.a.kHa),this.SN.style.top=(K.y-(be.AFrameworkApplication.sa&&be.AFrameworkApplication.sa.Qa.eh?
0:na.offsetHeight)-this.SN.offsetHeight).toString()+"px")};Ac.prototype.bMd=function(){Pe.DOMElementExtensions.vf(this.SN);this.SN=null};Ac.prototype.s_e=function(K){var na=new sb(this.grid.$.workbookContext.DxDigitNormal);na=this.isRow?na.dGe(K).toFixed(2):na.VFe(K).toFixed(2);this.SN.innerText=String.format("{0} {1} ({2} {3})",this.isRow?this.pai:this.yai,na,K.toString(),this.sai)};Ac.prototype.oMf=function(K,na){var Xa;if(-1!==this.grid.ga.selectionType||2===K.zb&&K.Ca.button!==Sys.UI.MouseButton.leftButton||
!this.Rud(Xa=this.Xhd(K))||!this.xkf)return!1;ci.g(K.Ca);this.bUa=this.f9a=new Sys.UI.Point(K.clientPoint.x,K.clientPoint.y);this.nXg(Xa,na);if(!this.Iq)return!1;this.j6=!0;this.Wqi(this.Iq,Xa)&&this.rei();return this.pMf(na)};Ac.prototype.z5i=function(K,na,Xa){this.Iq=K;this.bUa=this.f9a=new Sys.UI.Point(na,Xa);this.pMf(!1)};Ac.prototype.pMf=function(K){var na={};Ff.b(this.grid.$).he(Vb.a.emj,(na.IsResizingHiddenHeader=this.QXa,na.IsAutoFitting=K,na.NumberOfSelectedRanges=this.grid.ga.va.zL,na.Location=
"canvas",na));this.IKb=this.grid.Sw?this.JTh():this.jhd();this.offset=this.Iq.Hba();this.mm=this.Iq.yka();if(this.mm===qg.a.h7a)return!1;Gj.c(this.grid.$,!1,"HeaderResizeBehavior:prepareResizeOperationInternal");return!0};Ac.prototype.Wqi=function(K,na){var Xa=this.Iq.EK();if(!Xa)return ud.ULS.shipAssertTag(537154049,2,!1,"cell being resized element received is null"),!1;Xa=Xa.nextSibling;if(!Xa)return!1;K=K.getRange();Xa=this.Df.nwa(Xa).getRange();if(!K||!Xa)return ud.ULS.shipAssertTag(537154048,
2,!1,"IsResizingHidden: range is null"),!1;var Qb=Te.EwaSettings.isChangeGateEnabled("OfficeVSO:6101474_EnableUnhideRowByMouseDrag");K=Qb&&this.isRow?K.bottom:K.right;Xa=Qb&&this.isRow?Xa.bottom:Xa.right;return K+1!==Xa&&K!==Xa&&this.Rud(na,!0)};Ac.prototype.rei=function(){var K=this.Iq.EK(),na=this.Df.nwa(K.nextSibling);Ac.Xqi(na,this.isRow)?(this.Iq=na,this.S7=this.Iq.getRange()):(this.mFg(K),this.Iq=na,K=this.Iq.getRange(),this.S7=this.isRow?new bj.Range(K.top-1,K.left,K.top-1,K.right,!1,!0):new bj.Range(K.top,
K.left-1,K.bottom,K.left-1,!1,!0),this.QXa=!0)};Ac.prototype.mFg=function(K){var na=this.Df.nwa(K.nextSibling),Xa=Ac.eah(na,this.isRow,this.rtl);Xa&&K.parentNode.insertBefore(Xa,na.EK())};Ac.prototype.f6e=function(K){var na=this.S7,Xa=K.ga.va.selectedRanges;if(K.ga.va.dub(na))if(this.isRow){if(Ba.a.all(Xa,function(Qb){return Qb.isRow}))return Xa}else if(Ba.a.all(Xa,function(Qb){return Qb.Xf}))return Xa;return[na]};Ac.prototype.JTh=function(){return this.Iq.yka()-Ac.Rec};Ac.prototype.jhd=function(){var K=
this.Iq.EK().style;return Math.max(0,Math.min(this.ptf,0|parseInt(this.isRow?K.height:K.width,10)))};Ac.prototype.fAc=function(K){K=void 0===K?0:K;var na=this.grid,Xa=this.Df.Ej.paneType;Xa=this.isRow?3===Xa?[3,2]:[1,4]:4===Xa?[2,4]:[1,3];var Qb=na.view.visibleArea.bottomRight,tc=this.Iq.yka();tc===qg.a.h7a&&(tc=0);K=this.QXa?Math.max(this.jhd(),0):Math.max(tc+K,0);Qb=this.isRow?new Ji.a(0,this.offset,Qb.x,K):new Ji.a(this.offset,0,K,Qb.y);tc=[this.isRow?13:14];na.Fb.ak(bj.Range.kd(1,1),tc,!1);na.Fb.co(tc,
Qb,Xa);return K};Ac.prototype.k3c=function(){this.S7=this.bUa=this.f9a=null;if(this.J1){var K=this.J1.parentNode;if(K)for(K.removeChild(this.J1);this.J1.firstChild;)K.appendChild(this.J1.firstChild);this.J1=null}this.Iq=null;Pe.DOMElementExtensions.setVisible(Ac.fdb,!1);this.j6=!1;this.bMd();Pe.DOMElementExtensions.setVisible(this.SG,!1)};Ac.prototype.Xhd=function(K){if(Pe.DOMElementExtensions.Oz(K.Mb,"a"))return null;var na=this.Xlf(K.Ca);if(na&&this.grid.ga.va.Wg){var Xa=this.grid.ga.va.xd;Xa=this.Df.xt(bj.Range.kd(Xa.bottom,
Xa.right))}else Xa=this.Df.nwa(K.Mb);if(!Xa)return null;var Qb=Xa.EK(),tc=new Sys.UI.Bounds(Qb.offsetLeft,Qb.offsetTop,Qb.offsetWidth,Qb.offsetHeight),md=Pe.DOMElementExtensions.getBoundingClientRect(K.Mb);md=new Sys.UI.Point(K.clientPoint.x-md.x,K.clientPoint.y-md.y);this.isRow&&!na&&(md.y+=Ug.HelperMethods.yB(K.Mb,Qb,this.rtl).y);return new ad(Qb,md,tc,Xa.getRange(),Math.max(Ac.EFi,Math.min(Ac.pEi,(this.isRow?tc.height:tc.width)*Ac.omj)),na,!this.isRow&&0<Qb.getElementsByTagName("input").length)};
Ac.prototype.Rud=function(K,na){na=void 0===na?!1:na;if(!K||this.grid.isEditing)return!1;if(K.Wlf)return!0;var Xa=K.JPa,Qb=K.edb,tc=this.Df.Ej.paneType,md=this.grid.Kf(tc).nh,Dd=!!md&&md.top===K.Jmd.top,ue=!!md&&md.left===K.Jmd.left;tc=!!md&&md.bottom===K.Jmd.bottom&&(3===tc||2===tc);this.isRow?(ue=K.jEb.y,K=ue<=Qb&&!Dd,Xa=ue>=Xa.height-Qb-(tc?Ac.zKh:0),na=na?K:Xa||K):(tc=K.y$h,Dd=this.rtl,md=K.jEb.x,K=md<=Qb&&(!ue||Dd)&&(!tc||!Dd),Xa=md>=Xa.width-Qb&&(!Dd||!ue)&&(!tc||Dd),na=na?Dd?Xa:K:K||Xa);return na};
Ac.prototype.nXg=function(K,na){var Xa=this.isRow;if(K.Wlf)this.Iq=this.Df.nwa(K.dxa);else if(Xa&&K.jEb.y<=K.edb&&K.JPa.height>K.edb||!Xa&&K.JPa.width>K.edb&&(!this.rtl&&K.jEb.x<=K.edb||this.rtl&&K.jEb.x>=K.JPa.width-K.edb)){if(this.Iq=K.dxa.previousSibling?this.Df.nwa(K.dxa.previousSibling):this.lXh(),na&&K.dxa.classList.contains(Xa?Qi.a.$Ue:Qi.a.ZUe)&&(K=this.Df.nwa(K.dxa)))K=K.getRange(),this.S7=Xa?new bj.Range(K.top-1,K.left,K.top-1,K.right,!1,!0):new bj.Range(K.top,K.left-1,K.bottom,K.left-1,
!1,!0)}else this.Iq=this.Df.nwa(K.dxa);!this.S7&&this.Iq&&(this.S7=this.Iq.getRange())};Ac.prototype.lXh=function(){var K=this.isRow?1:0;return(K=this.Df.Ej.lE(this.Df.Ej.Da.Ug(this.grid.$.oa,Xj.a.mN(this.Df.position.X+K-1,this.Df.position.Y-K,this.Df.position.PaneType))))?K.kXh():null};Ac.prototype.sgi=function(){var K=this.pmj;Pe.DOMElementExtensions.setVisible(K,!0);K.style.cursor=this.isRow?Qi.a.iSe:Qi.a.AQe;this.fAc()};Ac.prototype.Bph=function(K){var na={};this.grid.$.ae(this.isRow?745189930:
-445963340,Oa.a.$b,30,(na.resizeRowColumnParameters=K,na))};Ac.prototype.Zdh=function(){var K=document.createElement("div");K.className=Qi.a.oyh;var na=document.createElement("div");na.className=L.a.Dr;K.appendChild(na);var Xa=document.createElement("img");Xa.src=$i.a.Ge(0);Xa.className=this.isRow?L.a.nxh:L.a.ixh;na.appendChild(Xa);this.Df.gB.domElement.parentNode.insertBefore(K,this.Df.gB.domElement);bi.a.instance.qa(Bf.a.pointerDown,K,this.EO);pj.a.instance.qa(Bf.a.qk,K,this.gda);Pe.DOMElementExtensions.setVisible(K,
!1);this.SG=K};Ac.prototype.Cuc=function(){this.k3c();this.SG&&(this.Df.gB.domElement.parentNode.removeChild(this.SG),this.SG=null)};Ac.prototype.Xlf=function(K){return Pe.DOMElementExtensions.Se(this.SG,K.target)};Ac.prototype.rrb=function(){this.j6&&(this.dPe(),Pe.DOMElementExtensions.gVa(this.Iq.EK(),!this.isRow,this.IKb),this.Cuc(),this.QXa=!1)};Ac.prototype.bif=function(){return Te.EwaSettings.ma(699)};Ac.prototype.Qcf=function(K){(K=K.Ca.rawEvent)&&K.detail===Ac.Vqj&&(K.type===Bf.a.tq?(this.j6=
!1,this.r_c=!0):K.type===Bf.a.AI&&(this.j6=!0,this.r_c=!1))};Ac.aah=function(K,na){return new Ac(K,na)};Ac.oSd=function(K,na,Xa){if(na)for(K.ColumnWidth=-1,K.RowHeight=Xa,K=Cl(K.SheetMultiRange.Ranges),na=K.next();!na.done;na=K.next())na=na.value,na.FirstColumn=0,na.LastColumn=0;else for(K.RowHeight=-1,K.ColumnWidth=Xa,K=Cl(K.SheetMultiRange.Ranges),na=K.next();!na.done;na=K.next())na=na.value,na.FirstRow=0,na.LastRow=0};Ac.Xqi=function(K,na){if(!K||!K.EK())return ud.ULS.shipAssertTag(537154014,2,
!1,"header after hidden headers is null"),!1;var Xa=K.getRange();K=K.EK().style;if(!Xa||!K)return ud.ULS.shipAssertTag(537154013,2,!1,"header range or style is null"),!1;K=na?K.height:K.width;return(na?Xa.top:Xa.left)===(na?qg.a.Sh:qg.a.di)&&K===Ac.flg};Ac.eah=function(K,na,Xa){if(!K)return ud.ULS.shipAssertTag(537154012,2,!1,"header after hidden is null"),null;var Qb=K.EK();if(!Qb||!Qb.style)return ud.ULS.shipAssertTag(537154011,2,!1,"header after hidden element or style is null"),null;K=document.createElement("div");
var tc=Qb.style;K.style.top=na?tc.top:Ac.flg;na||(Xa?K.style.right=tc.right:K.style.left=tc.left);K.classList.add(na?Hd.pxh:Hd.oxh);K.classList.add(na?Qi.a.mvb:Qi.a.lvb);Xa=document.createElement("div");Xa.classList.add(na?Qi.a.MUe:Qi.a.Zbd);Qb=na?Number.parseInvariant(Qb.innerText):bj.Range.x1a(Qb.innerText);Xa.innerText=na?(Qb-1).toString():bj.Range.hV(Qb-1);K.appendChild(Xa);return K};uk.Object.defineProperties(Ac.prototype,{xkf:{configurable:!0,enumerable:!0,get:function(){var K=(new ch.a(this.grid.$.xa)).qe(this.isRow?
16:8),na=this.grid.$.yb.Tz,Xa=this.grid.Vi,Qb=Ei.a(this.grid.$).Rq();return K&&!na&&!Xa&&!Qb}},pmj:{configurable:!0,enumerable:!0,get:function(){this.jqh();return Ac.fdb}}});Ac.EFi=0;Ac.pEi=5;Ac.Rec=1;Ac.zKh=3;Ac.omj=.1;Ac.zXf="ewa-rszrbg";Ac.flg="0px";Ac.Vqj=2;Ac.fdb=null;Object(Sd.a)(Ac,"HeaderResizeBehavior",hk.a,[680]);var zk=uh.a;Am(Ob,zk);Ob.prototype.create=function(){this.Eb(Ac.aah)};Ob.ka=function(K){K.da.Ha(136,new Ob)};Object(Sd.a)(Ob,"HeaderResizeBehaviorFactory",uh.a,[]);var qk=b(444),
Hj=b(561),Ik=b(69);Object(Sd.a)(hd,"MacroRecorderSheetRowsColumnsAutoFitPayload",null,[428]);Object(Sd.a)(sc,"MacroRecorderSheetRowsColumnsResizedPayload",null,[428]);var Bj=zi.a;Am(Pb,Bj);Pb.prototype.iW=function(K,na){var Xa={};return Xa[Pb.O5]=this.Cc,Xa[Pb.iri]=this.isRow,Xa[Pb.Pei]=K,Xa[Pb.Oei]=na,Xa[Pb.ioi]=this.NBb,Xa[Pb.kid]=this.oxb,Xa};Pb.prototype.NXg=function(){var K=this.HNh();try{return this.hSh(K)}finally{K&&K.dispose()}};Pb.prototype.F8g=function(K){var na={};na.SheetMultiRange=ff.r(this.gridView.ga.va.selectedRanges,
this.$);Pb.oSd(na,this.isRow,K);K={};this.$.ae(this.isRow?745189930:-445963340,Oa.a.$b,8,(K.resizeRowColumnParameters=na,K))};Pb.prototype.Z7e=function(K,na){return ta.a.f6(K)?na?this.q7g(K):this.s7g(K):Pb.bca};Pb.prototype.s7g=function(K){return Math.floor(parseFloat(K))};Pb.prototype.q7g=function(K){K=parseFloat(K);return 0>K?Pb.bca:K?this.isRow?Ug.HelperMethods.l3i(K):this.awc.m3g(K):0};Pb.prototype.t7g=function(K){return K===Pb.bca?"":this.isRow?this.awc.dGe(K).toString():this.awc.VFe(K).toFixed(2)};
Pb.prototype.r7g=function(K){return K===Pb.bca?"":K.toString()};Pb.prototype.hSh=function(K){if(!K||!K.$$mn()||!K.to)return Pb.bca;var na=Object(bf.a)(579,K.to);if(!na)return Pb.bca;for(na=this.isRow?na.Jzb:na.Rod;K.$$mn();){var Xa=Object(bf.a)(579,K.to);if(Xa&&(this.isRow?Xa.Jzb:Xa.Rod)!==na)return Pb.bca}return na};Pb.prototype.HNh=function(){for(var K=[],na=Cl(this.gridView.ga.va.selectedRanges),Xa=na.next();!Xa.done;Xa=na.next()){Xa=Xa.value.clone();var Qb=this.gridView.Kf(this.gridView.rb.wj(Xa));
Qb=Xa.We(Qb.nh);if(!Qb)return null;this.isRow?Xa.right=Xa.left=Qb.left:Xa.top=Xa.bottom=Qb.top;Array.add(K,Xa)}return K.length?this.gridView.Daa("ResizeHeadersDialog.GetActiveRowColumnLoadedRangeEnumerator",K):null};Pb.prototype.lid=function(K){if(!ta.a.f6(K))return 1;K=this.Z7e(K,this.NBb);return!K&&this.Vqi()?3:this.Nti(K)?0:2};Pb.prototype.Vqi=function(){var K=this.gridView.ga.va.selectedRanges;return this.isRow&&ff.P(K)||!this.isRow&&ff.O(K)};Pb.prototype.Dfd=function(K){var na="";switch(K){case 0:na=
"";break;case 1:na=Tc.a.instance.fa(754);break;case 2:K=this.NBb;na=String.format(Tc.a.instance.Bb(98),0,this.ydc(K));break;case 3:na=Tc.a.instance.fa(755)}return na};Pb.prototype.Nti=function(K){return 0<=K&&K<=this.ydc(!1)};Pb.prototype.ydc=function(K){return this.awc.ydc(K,this.isRow)};Pb.oSd=function(K,na,Xa){if(na)for(K.ColumnWidth=Pb.bca,K.RowHeight=Xa,K=Cl(K.SheetMultiRange.Ranges),na=K.next();!na.done;na=K.next())na=na.value,na.FirstColumn=0,na.LastColumn=0;else for(K.RowHeight=Pb.bca,K.ColumnWidth=
Xa,K=Cl(K.SheetMultiRange.Ranges),na=K.next();!na.done;na=K.next())na=na.value,na.FirstRow=0,na.LastRow=0};uk.Object.defineProperties(Pb.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"ResizeHeadersDialog"}},NBb:{configurable:!0,enumerable:!0,get:function(){return Pb.yce},set:function(K){Pb.yce=K}}});Pb.O5="id";Pb.iri="isRow";Pb.Pei="initialSizeInPx";Pb.Oei="initialSizeInDefaultUnits";Pb.ioi="isInitialUnitsDefaultUnits";Pb.kid="getInputErrorIfInvalid";Pb.GHj="size";Pb.Yli="isDefaultUnits";
Pb.bca=-1;Pb.yce=!0;Object(Sd.a)(Pb,"ResizeHeadersDialog",zi.a,[]);var Ak=b(567);fb.prototype.$c=function(K,na){K=!0;switch(na){case -445963340:case 1391094586:K=this.qe(8);break;case 745189930:case 146338636:K=this.qe(16)}return!K};fb.prototype.executeCommand=function(K,na,Xa){var Qb=Yg.TaskExtensions.Dl();var tc=Og.g(this.$);K=ri.a.create().toString();var md=na.command;switch(md){case 1391094586:case 146338636:var Dd=1391094586===md;(K=Xa.autoFitRanges)&&K.Ranges&&K.Ranges.length||(K=ff.r(tc.ga.va.selectedRanges,
this.$));Qb=this.glh(Dd?1:0,K,na);break;case -445963340:case 745189930:case -706918724:case 1051390410:case 369708605:case 1542466017:Dd=-445963340===md||-706918724===md||369708605===md;if(-445963340===md||745189930===md)Dd=qk.a(na.command),tc.Ri.t8(16,K,Dd),Xa=Xa.resizeRowColumnParameters;else{var ue=tc.ga.va.selectedRanges;if(-706918724===md&&6===na.ef&&ff.O(ue)){ud.ULS.sendTraceTag(537154007,0,50,"ResizeCommandHandler.HandleResizeCommand: Command 'HideColumn' was ignored because entire row is selected");
break}if(1051390410===md&&6===na.ef&&ff.P(ue)){ud.ULS.sendTraceTag(537154006,0,50,"ResizeCommandHandler.HandleResizeCommand: Command 'HideRow' was ignored because entire column is selected");break}tc=369708605===md||1542466017===md?-2:0;Xa={};Xa.SheetMultiRange=ff.r(ue,this.$);if(Dd)for(Qb=Cl(Xa.SheetMultiRange.Ranges),md=Qb.next();!md.done;md=Qb.next())md=md.value,md.FirstRow=0,md.LastRow=0;else for(Qb=Cl(Xa.SheetMultiRange.Ranges),md=Qb.next();!md.done;md=Qb.next())md=md.value,md.FirstColumn=0,
md.LastColumn=0;Xa.RowHeight=Dd?-1:tc;Xa.ColumnWidth=Dd?tc:-1}Qb=this.Alh(Xa,na,K);break;case 957527587:case 2040891415:new Pb(this.$,na)}return Qb};fb.prototype.Mc=function(K,na,Xa,Qb){if(K=!!Xa&&!!Qb&&1===Qb.rz)switch(na.command){case 1391094586:case 146338636:case -445963340:case 745189930:case -706918724:case 1051390410:case 369708605:case 1542466017:case 957527587:case 2040891415:break;default:K=!1}return K};fb.prototype.nd=function(){return!1};fb.prototype.Zzi=function(K){ud.ULS.sendTraceTag(537154004,
0,50,"ResizeCommandHandler.LogInstantaneousResize: Resize operation succeeded: {0}. Reason: {1}.",K.success,Object(Ak.c)(K)?void 0:K.reason)};fb.prototype.qe=function(K){return(new ch.a(this.$.xa)).qe(K)};fb.prototype.glh=function(K,na,Xa){function Qb(){return new hd(Dd,na)}var tc=this,md=this.$.na.ta.fc(),Dd=0===K;return lc.a(this.$.userOperationManager,function(ue,Ce,Kf){var Wg=tc.$.na.ta,Dh=Wg.Ma(41,md);Dh.isRow=Dd;Dh.autoFitRanges=na;return Rd.i(Wg,"AutoFit",Dh,ue,Ce,Kf,null,0)},function(ue){return new Oc.a(135,
0,ue,void 0,Qb)},Xa)};fb.prototype.Alh=function(K,na,Xa){function Qb(){return new sc(K)}function tc(Wg,Dh,Ci){md.$.Qy();ff.i(Dd,",",md.$,!1);var wj=md.$.na.ta;Wg=nh.b(Wg,md.bWi);var Jj=wj.Ma(41,void 0===Kf?null:Kf);Jj.resizeRowColumnParameters=K;return Rd.i(wj,"ResizeRowsColumns",Jj,Wg,Dh,Ci,Xa,0)}var md=this,Dd=ff.g(K.SheetMultiRange.Ranges),ue=na.command;if(745189930===ue||-445963340===ue){ud.ULS.shipAssertTag(537154002,0,this.$.activeItemName===K.SheetMultiRange.SheetName,"ResizeCommandHandler.DoResize: should do CSE for active sheet only!");
var Ce=Og.g(this.$);ue=745189930===ue;Ce=this.Jh.QFj(Ce,Dd,ue?K.RowHeight:K.ColumnWidth,ue);this.Zzi(Ce);Object(Ak.c)(Ce)&&Og.g(this.$).Ri.D1(Xa,Ik.BasicTelemetryCalculator.$R)}var Kf=this.$.na.ta.fc(!0);return Ce&&Object(Ak.c)(Ce)?Te.EwaSettings.uc()?lc.a(this.$.userOperationManager,tc,function(Wg){return new Oc.a(136,0,Wg,64,Qb)},na):lc.a(this.$.userOperationManager,tc,function(Wg){return new Hj.a(136,0,Wg,void 0,Qb)},na):lc.a(this.$.userOperationManager,tc,function(Wg){return new Oc.a(136,0,Wg,
void 0,Qb)},na)};Object(Sd.a)(fb,"ResizeCommandHandler",null,[434]);var Nj=eh.a;Am(va,Nj);va.prototype.Qd=function(){var K=this,na=wh.GetServiceTaskFactory.create(this.$.da,18,this.la,this.ub);Yg.TaskExtensions.Ba(na,function(){K.Jd([new fb(K.$,na.result)])},this.la,3)};va.ka=function(K){eh.a.je(113,new va(K))};Object(Sd.a)(va,"ResizeCommandHandlerFactory",eh.a,[]);Kc.prototype.$c=function(){return!1};Kc.prototype.executeCommand=function(K,na,Xa){K=2;switch(na.command){case -309686558:K=this.Ki.Be(gg.a.saveACopy,
2,Xa);break;case 617689800:K=this.Ki.Be(gg.a.saveToCloudStorage,2,Xa);break;case -1244760097:K=this.Ki.Be(gg.a.saveToSharePoint,2,Xa)}return 2===K&&na?k.a(na.command):Kg.Task.Sa(!0)};Kc.prototype.Mc=function(K,na){K=!1;switch(na.command){case -1244760097:case -309686558:case 617689800:K=!0,ud.ULS.shipAssertTag(537153984,0,this.$.Dla,"Command execute requested for SaveAs operation when data duplication is disallowed.")}return K};Kc.prototype.nd=function(){return!1};Object(Sd.a)(Kc,"SaveToHostCommandHandler",
null,[434]);var cj=eh.a;Am(Zc,cj);Zc.prototype.Qd=function(){var K=this;Yg.TaskExtensions.Ba(wh.GetServiceTaskFactory.create(this.$.da,155,this.la,this.ub),function(){K.Jd([new Kc(K.$,be.AFrameworkApplication.Ib)])},this.la,3);be.AFrameworkApplication.Ib.ic(gg.a.wSa,Sg.a.frame,this.rJh)};Zc.ka=function(K){eh.a.je(267,new Zc(K))};Object(Sd.a)(Zc,"SaveToHostCommandHandlerFactory",eh.a,[]);Uc.prototype.$c=function(K){switch(K){case -309686558:return 8===this.Ki.processAction(gg.a.saveACopy,1,null);case 617689800:return 8===
this.Ki.Be(gg.a.saveToCloudStorage,1,null);case -1244760097:return 8===this.Ki.Be(gg.a.saveToSharePoint,1,null)}return!1};Uc.prototype.dispose=function(){this.$=null};Object(Sd.a)(Uc,"SaveToHostManager",null,[682,3]);var Jk=uh.a;Am(ac,Jk);ac.prototype.create=function(){this.Eb(this.$.da.Aa(393)||new Uc(this.$,be.AFrameworkApplication.Ib))};ac.ka=function(K){K.da.Ha(394,new ac(K))};Object(Sd.a)(ac,"SaveToHostManagerFactory",uh.a,[]);var gj=Pj.a;Am(mb,gj);mb.prototype.execute=function(K){var na=Object(bf.a)(6,
K.Me);ud.ULS.shipAssertTag(537153921,0,Mg.a.Qpb(K.errors),"SessionReloadActivity.Execute: Only recoverable errors should reach this activity.");na.LI(!0,!0);K.activityState[Ra.a.d_b]=na.ea.sessionId;K.activityState[Ra.a.Dob]=!0;K.activityState[Ra.a.j_b]=!0;ud.ULS.sendTraceTag(537153920,0,50,"SessionReloadActivity.Execute: session is going to reopen from cached state");return 3};Object(Sd.a)(mb,"SessionReloadActivity",Pj.a,[]);var hl=uh.a;Am(qb,hl);qb.prototype.create=function(){this.Eb(new mb(Hg.a.Odb,
Hg.a.Nk))};qb.ka=function(K){K.da.Ha(142,new qb)};Object(Sd.a)(qb,"SessionReloadActivityFactory",uh.a,[]);var kk=b(54),rk=b(275),al=b(109),Kk=b(44),Zj=b(252),Bk=b(113),wg=Pj.a;Am(Sb,wg);Sb.prototype.execute=function(K){var na=Object(bf.a)(6,K.Me);K.activityState[Ra.a.Rsa]=!0;var Xa=Sb.G2h(K);if(Sb.zBj(K,Xa))return Sb.FDi(K),Xa=50,0<K.errors.length&&(Xa=15),ud.ULS.sendTraceTag(537153891,0,Xa,"SessionReloadSilentActivity.ShouldCancelReload: ignore session reload, remaining errors : {0}",Mg.a.Wc(K.errors)),
K.activityState[Ra.a.Rsa]=!1,this.Dh(Hg.a.idle),3;switch(Xa){case 1:case 3:this.chi(K,Xa);break;case 2:this.bhi(K);break;case 0:K.activityState[Ra.a.PZa]=null}ud.ULS.sendTraceTag(21837003,0,50,"SessionReloadSilentActivity.Execute: silentReloadType:{0}. activityName:{1}. NextActivityName:{2}. TimeFromLastStatefulResponse:{3}.",Xa,this.activityName,this.w0,na.ea.C8);var Qb=Wj.a.Eg(K.activityState,Bk.a.igb);ud.ULS.shipAssertTag(40502925,0,!Qb||Qb&&(1===Xa||3===Xa),"triggerSilentReloadAfterTokenRefresh: {0}, silentReloadType: {1}",
Qb,Xa);na=na.Zk.reloadCount;return 0!==Xa&&0<na?(Qb=rk.a.Jwa(na,200),ud.ULS.sendTraceTag(537153890,0,50,"SessionReloadSilentActivity.Execute: schedule Silent-Type [{0}] retryNum [{1}] delayInMs [{2}] activityName [{3}]",Xa,na,Qb,this.activityName),Kh.a.instance.create(function(){Sb.iK(K)},Qb,Yi.a.Htj),1):3};Sb.prototype.chi=function(K,na){ud.ULS.sendTraceTag(8438495,0,50,"SessionReloadSilentActivity.InitiateSilentReopen: Silent reopen triggered");var Xa=Object(bf.a)(6,K.Me);K.activityState[Ra.a.Dob]=
!0;Xa.Bhc||Kk.PageLoadTrackingInfo.instance.Qj("ReopenOnLoad");!Sb.isEditMode(K)&&Mg.a.Qpb(K.errors)&&(ud.ULS.sendTraceTag(537153889,0,50,"SessionReloadSilentActivity.ShouldAttemptViewSilentReopen: session is going to reopen from cached state"),K.activityState[Ra.a.d_b]=Xa.ea.sessionId,K.activityState[Ra.a.j_b]=!0);K.Uyd();3===na?(Xa.ea.Vg()||Xa.ea.vJi(),Xa.LI(!0,!0),this.Dh(this.NQj),K.activityState[Ra.a.Hoe]=Xa.workbookContext.CalcMode):(Te.EwaSettings.isChangeGateEnabled("OfficeVSO:5678588_FixSilentReopenAfterTokenRefresh")&&
1===na&&Xa.LI(!0,!0),K.activityState[Ra.a.xWc]=!1,this.Dh(this.lAc))};Sb.prototype.bhi=function(K){ud.ULS.sendTraceTag(537153888,0,15,"SessionReloadSilentActivity.InitiateSilentRefresh: Silent refresh triggered");K.activityState[Ra.a.PZa]=null;K.Uyd();this.Dh(this.zHj);K=Object(bf.a)(6,K.Me);K.Bhc||(Kk.PageLoadTrackingInfo.instance.Qj("RefreshOnLoad"),K.KJb())};Sb.iK=function(K){K.iK()};Sb.G2h=function(K){var na=Object(bf.a)(6,K.Me),Xa=na.ea,Qb=Sb.isEditMode(K),tc=Mg.a.uh(K.errors,Qb?Sb.Gyd:Sb.Hyd),
md=Mg.a.uh(K.errors,Qb?Sb.Hsf:Sb.Isf),Dd=na.aS,ue=na.Zk.reloadCount,Ce=na.ya.MaxConsecutiveSilentReloadAllowed,Kf=na.Zk.waf(),Wg=Mg.a.Wc(K.errors),Dh=Mg.a.Wc(K.yAa),Ci=0<Mg.a.xN(function(dk){return!dk.triggerSilentReopenOnly},K.errors).length,wj=tc,Jj=Wj.a.Eg(K.activityState,Bk.a.igb);Jj&&(wj=!0);tc={name:"SessionReloadSilentActivity.GetSilentReloadType",editMode:Qb,isSilentReopenError:tc,isSilentRefreshError:md};tc.reloadSequenceCount=na.Zk.FRa;tc.reloadCount=ue;tc.maxReloads=Ce;tc.stopSilentReloads=
Kf;tc.errorNames=Wg;tc.processedErrorNames=Dh;tc.isClientDirty=Dd;tc.errorsForSilentReopenOnly=Ci;tc.triggerSilentReloadAfterTokenRefresh=Jj;tc.IsReopenDisabled=na.XNa;Dd=kk.a.Kc(tc);ud.ULS.sendTraceTag(21837004,0,50,Dd);if(!Kf){if(wj&&(Qb?Sb.qBj(K):Sb.sBj(K)))return Zj.a.V5f(K,na)?3:na.XNa?2:1;if(md&&(Qb||!Xa.bcb))return 2}return 0};Sb.zBj=function(K,na){for(var Xa=Cl(K.errors),Qb=Xa.next();!Qb.done;Qb=Xa.next())if(Qb=Qb.value,-1337545025===Qb.MessageId||-238814601===Qb.MessageId)return!1;return Mg.a.xN(function(tc){return!tc.triggerSilentReopenOnly},
K.errors).length?3!==na:!1};Sb.FDi=function(K){var na=Mg.a.xN(function(Qb){return!Qb.triggerSilentReopenOnly},K.errors);na=Cl(na);for(var Xa=na.next();!Xa.done;Xa=na.next())K.wma(Xa.value)};Sb.isEditMode=function(K){var na=Object(bf.a)(6,K.Me);return na.ea.sc?na.uv&&!!(na.Dd&64):Wj.a.Eg(K.activityState,Ra.a.mt)};Sb.sBj=function(K){var na=Object(bf.a)(6,K.Me),Xa=Mg.a.eba(K.errors,Sb.Hyd);if(al.b(Xa,function(Qb){return Qb.ForceVersionUpgrade}))return!1;K=Mg.a.Qpb(K.errors);return!na.ea.bcb||K?!0:!1};
Sb.qBj=function(K){K=Mg.a.eba(K.errors,Sb.Gyd);return!al.b(K,function(na){return na.ForceVersionUpgrade})};Sb.Hyd=null;Sb.Gyd=null;Sb.Isf=null;Sb.Hsf=null;Object(Sd.a)(Sb,"SessionReloadSilentActivity",Pj.a,[]);var wk=uh.a;Am(xb,wk);xb.prototype.create=function(){this.Eb(new Sb(this.activityName,this.oN,Hg.a.Nk,Hg.a.Aj,Hg.a.XOb))};xb.ka=function(K){K.da.Ha(143,new xb(Hg.a.yoa,Hg.a.d2b));K.da.Ha(144,new xb(Hg.a.Sxc,Hg.a.sQa));K.da.Ha(145,new xb(Hg.a.Txc,Hg.a.AFd));K.da.Ha(154,new xb(Hg.a.Pdb,Hg.a.LP))};
Object(Sd.a)(xb,"SessionReloadSilentActivityFactory",uh.a,[]);Xb.prototype.getSheetName=function(){return this.sheetName};Xb.prototype.getValue=function(){return this.value};Object(Sd.a)(Xb,"MacroRecorderSheetOptionToggledPayload",null,[428]);Ca.prototype.$c=function(){return!1};Ca.prototype.executeCommand=function(K,na){function Xa(){return new Xb(Qb.SheetName,Kf)}var Qb={};this.$.Jj(Qb);K=na.command;var tc=Object(bf.a)(hf.a,this.$.xa.getItemByName(Qb.SheetName));if(!tc)return k.a(K);switch(K){case 705559150:case -1411193626:var md=
16;var Dd=!tc.hideGridLines;var ue=hb;var Ce=183;var Kf=tc.hideGridLines;break;case -2052321504:case 515737500:md=4;Dd=!tc.headersVisible;ue=Sa;Ce=184;Kf=!tc.headersVisible;break;case -1478455630:md=2;Dd=!tc.displayRtl;ue=db;Ce=185;Kf=!tc.displayRtl;Og.g(this.$).Da.KVj(Dd);break;default:return k.a(K)}tc.Arb(md,Dd);var Wg=this.$.na.ta;return lc.a(this.$.userOperationManager,function(Dh,Ci,wj){return ue(Wg,Qb.SheetName,Kf,nh.b(Dh,function(Jj){Ca.uGb(Jj,tc,md,Dd)}),nh.a(Ci,function(){Ca.AFb(tc,md,Dd)}),
wj,null)},function(Dh){return new Oc.a(Ce,0,Dh,void 0,Xa)},na)};Ca.prototype.Mc=function(K,na){K=!1;switch(na.command){case -1411193626:case 515737500:case -1478455630:K=!0;break;case 705559150:case -2052321504:K=Gj.a(this.$)}return K};Ca.prototype.nd=function(){return!1};Ca.uGb=function(K,na,Xa,Qb){Mg.a.Ar(K.Errors)&&na.Arb(Xa,!Qb)};Ca.AFb=function(K,na,Xa){K.Arb(na,!Xa)};Object(Sd.a)(Ca,"SheetOptionsToggleCommandHandler",null,[434]);var Mi=eh.a;Am(wa,Mi);wa.prototype.Qd=function(){this.Jd([new Ca(this.$)])};
wa.ka=function(K){eh.a.je(100,new wa(K))};Object(Sd.a)(wa,"SheetOptionsToggleCommandHandlerFactory",eh.a,[]);var Lk=b(62),dj=b(212),xk=dj.a;Am(ma,xk);ma.prototype.initialize=function(){var K=this.$.Lb+"iframeDialog_frame",na=this.$.Lb+"iframeDialog";var Xa=String.format('<iframe id="{0}" frameborder="0" scrolling="auto" src="{1}">\r\n</iframe>',K,this.O2e(na));this.Rb.style.margin=Ug.HelperMethods.Yb(0);this.Rb.style.marginBottom=Ug.HelperMethods.Yb(-2);this.Rb.innerHTML=Xa;this.sMc=document.getElementById(K);
this.domElement.id=na;this.onResize(null,Sys.EventArgs.Empty);Yf.a.Oic&&Kh.a.instance.create(this.Nph,50,Yi.a.$bi,!0,!0);xk.prototype.initialize.call(this)};ma.prototype.dispose=function(){this.$&&this.$.UD(this.onResize);xk.prototype.dispose.call(this)};ma.prototype.setFocus=function(){Pe.DOMElementExtensions.setFocus(this.BMa)};ma.prototype.onHide=function(){this.BMa.contentWindow.close();Pe.DOMElementExtensions.vf(this.BMa);this.sMc=null;xk.prototype.onHide.call(this)};ma.prototype.uWj=function(K){var na=
this.domElement.style;na.width=Ug.HelperMethods.Yb(K.x);na.marginLeft=Ug.HelperMethods.Yb(-K.x/2)};ma.prototype.pWh=function(){var K=Pe.DOMElementExtensions.getBounds(document.body);return new Sys.UI.Point(Math.min(Math.floor(.9*K.width),this.GKe.x),Math.min(Math.floor(.9*K.height),this.GKe.y))};uk.Object.defineProperties(ma.prototype,{BMa:{configurable:!0,enumerable:!0,get:function(){return this.sMc}}});Object(Sd.a)(ma,"IFrameDialog",dj.a,[]);Am(ua,ma);ua.prototype.O2e=function(K){var na=new Sys.StringBuilder(this.$.ya.EmbedConfiguratorUrl);
Jh.a.ag(na,M.a.Vrh,K);Fb.a(this.$.ya,34)&&Jh.a.ag(na,M.a.BQe,"1");Fb.a(this.$.ya,35)&&Jh.a.ag(na,M.a.CQe,"1");return na.toString()};ua.prototype.onShow=function(){ud.ULS.sendTraceTag(537151690,0,50,"EmbeddingDialog.OnShow: the dialog is being shown");ma.prototype.onShow.call(this)};uk.Object.defineProperties(ua.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"EmbeddingDialog"}}});Object(Sd.a)(ua,"EmbeddingDialog",ma,[]);T.m5f="FrameDialog_ShareFromEdit";T.view="FrameDialog_View";
T.lDe="FrameDialog_CloseAndRefresh";T.xAj="FrameDialog_ShareFromView";T.edit="FrameDialog_Edit";T.Jbj="FrameDialog_RefreshGrid";T.E2g="FrameDialog_CloseMe";T.vDe="FrameDialog_CloseMeError";T.ready="FrameDialog_Ready";T.k3i="FrameDialog_PleaseClose";T.XH="GotoRange";Object(Sd.a)(T,"PostMessageConstants",null,[]);var Ki=b(106);Object(Sd.a)(Wc,"SessionUpdateContext",null,[]);Am(Tb,ma);Tb.prototype.CJg=function(K){this.addHandler(Tb.qwd,K)};Tb.prototype.fhj=function(K){this.removeHandler(Tb.qwd,K)};Tb.prototype.dispose=
function(){Vd.a.Fa(this.i2a);this.i2a=null;ma.prototype.dispose.call(this)};Tb.prototype.initialize=function(){ma.prototype.initialize.call(this);var K=zg.a.Fba(this.$.ya.FormLightBoxUrl),na=this.i2a=new oc.a(this.BMa.contentWindow,K);na.isEnabled()&&na.AGa(K)&&(this.Rna(T.m5f,this.Mqc),this.Rna(T.view,this.Mqc),this.Rna(T.lDe,this.Mqc),this.Rna(T.xAj,this.qXi),this.Rna(T.edit,this.dPi),this.Rna(T.Jbj,this.Mqc),this.Rna(T.ready,this.KVi),this.Rna(T.E2g,this.Czf),this.Rna(T.vDe,this.Czf))};Tb.prototype.close=
function(K){K===this.closeAction&&this.Mif&&this.i2a.send(new Si.a(T.k3i))||ma.prototype.close.call(this,K)};Tb.prototype.O2e=function(){return this.AHe(this.Bjc)};Tb.prototype.AHe=function(K){var na=this.$.ya,Xa=new Sys.StringBuilder(na.FormLightBoxUrl);Jh.a.ag(Xa,M.a.OJh,this.$.ea.sessionId);Jh.a.ag(Xa,M.a.MJh,K?M.a.NJh:M.a.LJh);Ui.a.lHa(Xa,na);return Xa.toString()};Tb.prototype.kig=function(K){this.HNc=!1;this.BMa.src=this.AHe(K);this.nce=K};Tb.prototype.Rna=function(K,na){this.i2a.mo(K);this.i2a.Vl(K,
na)};Tb.prototype.Epc=function(K){var na=this.$.ea.xa.getItemByName(K.XH.SheetName);na&&0===na.Vy&&Og.g(this.$).Kg(K.XH,null,null,null,20,Ki.a.wJh)};uk.Object.defineProperties(Tb.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"FormDialog"}},Mif:{configurable:!0,enumerable:!0,get:function(){return this.HNc}},Bjc:{configurable:!0,enumerable:!0,get:function(){return this.nce}}});Tb.Zgh=900;Tb.Agh=1200;Tb.qwd="lightBoxReady";Object(Sd.a)(Tb,"FormDialog",ma,[472]);var yk;(function(K){K[K.comment=
10]="comment";K[K.range=12]="range";K[K.table=13]="table";K[K.chart=14]="chart"})(yk||(yk={}));Object(Sd.b)("NavigationType",yk);var Ck=b(1089),Yj=b(115),lk=b(619),Dk=b(1150),mk=b(293),Ek=b(936),Sk=Ek.a;Am(Eb,Sk);Eb.prototype.initialize=function(){var K="<div class='"+Yj.a.wo+"'>\r\n\t<div class='"+Yj.a.RQe+"'>\r\n\t\t<div class='"+L.a.A3c+"'>\r\n\t\t\t<img src='{0}' class='"+L.a.hUe+"' alt='{1}' />\r\n\t\t</div>\r\n\t</div>\r\n\t<div class='"+Yj.a.VQe+"'>\r\n\t\t<p>{2}</p>\r\n\t</div>\r\n</div>";
K=String.format(K,$i.a.Ge(13),Tc.a.instance.fa(25),Tc.a.instance.fa(this.message));this.Rb.innerHTML=K;this.addButton(0,this.bLi);this.addButton(1);Sk.prototype.initialize.call(this)};Eb.prototype.Ox=function(){return this.C2d};uk.Object.defineProperties(Eb.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"WebMethodConfirmationDialog"}},Mu:{configurable:!0,enumerable:!0,get:function(){return 1005}},aua:{configurable:!0,enumerable:!0,get:function(){return this.operationFlags}}});Object(Sd.a)(Eb,
"WebMethodConfirmationDialog",Ek.a,[]);var fk=Ck.a;Am(gc,fk);gc.prototype.dispose=function(){this.ZUa&&this.ZUa.aea(this.wIf);Vd.a.tc([this.textBox,this.DSa,this.ZUa]);this.ZUa=this.DSa=this.textBox=null;fk.prototype.dispose.call(this)};gc.prototype.initialize=function(){var K="<div class='"+Yj.a.wo+"'>\r\n\t<span>{0}</span>\r\n</div>\r\n<div class='"+Yj.a.cvb+"'>\r\n\t<input type='text' id='{1}' class='"+Yj.a.aD+"' aria-live='polite' aria-atomic='true'/>\r\n\t<br />\r\n\t<a href='#' id='{2}' class='{3}'>{4}</a>\r\n</div>";
K=String.format(K,Tc.a.instance.fa(1229),"sfd_input","sfd_unshare",L.a.kp,Tc.a.instance.fa(1230));this.Rb.innerHTML=K;this.textBox=new mk.a(this.getElementById("sfd_input"));this.DSa=new Dk.a(this.textBox.domElement);this.ZUa=lk.a.create(this.getElementById("sfd_unshare"));this.ZUa.u3(this.wIf);this.textBox.text=Tc.a.instance.fa(723);this.textBox.enabled=!1;this.textBox.readOnly=!Yf.a.dh;this.addButton(1,10);fk.prototype.initialize.call(this)};gc.prototype.pia=function(){var K=this;return function(na,
Xa,Qb){var tc=K.$.na.ta.fc(),md=K.$.na.ta;na=K.mka(na);Xa=K.xba(Xa);tc=md.Ma(1,tc);return Rd.i(md,"ShareForm",tc,na,Xa,Qb,null,0)}};gc.prototype.Fy=function(K,na,Xa){this.textBox.text=K.Result;this.textBox.enabled=!0;Pe.DOMElementExtensions.setVisible(this.ZUa.domElement,!0);fk.prototype.Fy.call(this,K,na,Xa)};gc.prototype.setFocus=function(){if(this.textBox&&this.textBox.enabled)try{this.textBox.focus();return}catch(K){}fk.prototype.setFocus.call(this)};uk.Object.defineProperties(gc.prototype,{Cc:{configurable:!0,
enumerable:!0,get:function(){return"ShareFormDialog"}}});Object(Sd.a)(gc,"ShareFormDialog",Ck.a,[]);var ej=b(717),nk=b(143),gi=b(262),Mk=b(15),Nk=d.a;Am(Ub,Nk);Ub.prototype.$c=function(K,na){K=this.$.workbookContext.FullDocumentInfo;switch(na){case 353606613:case -1099009678:case 192430811:return!Te.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||this.$.ea.isNamedObjectViewMode||this.$.isMobileMode;case 869186573:return na=gi.a()&&this.$.ea.ah.get(5),!K.FileSharingUrl&&
!na;case -1570751769:case 1986648902:return 131072!==(this.$.xK&131072);case 330035228:return!(this.r4a(!0)&&this.yFc);case -509039657:return!(this.r4a()&&this.yFc);case 1334518759:return!(this.r4a()&&this.yFc&&this.aAe())}return!1};Ub.prototype.executeCommand=function(K,na,Xa){K=this.$.workbookContext.FullDocumentInfo;var Qb=gg.a.workflow,tc=Yg.TaskExtensions.Dl(),md=na.command;if(md===Qb||-266099===md)return this.j$h(na,Qb,K);switch(md){case 1986648902:this.y4f();break;case -1570751769:this.X7h(na);
break;case 869186573:na=gg.a.wAj;tc=be.AFrameworkApplication.ha.ra("ShareMenuIsEnabled");Qb=null;(Te.EwaSettings.ma(573)||tc)&&Xa&&"CopyLink"===Xa.SourceControlId?(Qb={},Qb[rg.a.kMb]="copy",na=gg.a.l5f):tc&&Xa&&"ManageAccess"===Xa.SourceControlId?(Qb={},Qb[rg.a.kMb]="manageAccess",na=gg.a.yAj):Xa&&"LinkToComment"===Xa.SourceControlId&&(Qb={},Qb[rg.a.kMb]="copy",Qb[rg.a.n5f]=Xa.navId,na=gg.a.l5f);tc=this.B8f(K,Qb);vi.c(na);break;case -1099009678:tc=this.ZSd(12,K);break;case 192430811:tc=this.ZSd(13,
K);break;case 353606613:tc=this.ZSd(14,K);break;case -59906385:case 1197060601:this.w9h(na,K);break;case 1305810481:this.Z9e(!1,na);break;case 330035228:this.Z9e(!0,na);break;case -509039657:this.deleteForm();break;case 1334518759:na.zAb=!0;this.shareForm();break;case 710925581:wd.a.vg.hzc("710925581")&&(tc=Yg.TaskExtensions.Ba(this.FK.value,function(Dd){Dd.result.Nj(th.a.conversation,{})},this.la,3));break;case 327119921:this.N7h();break;default:tc=k.a(md)}return tc};Ub.prototype.Mc=function(K,na){K=
!1;na=na.command;if(na===gg.a.workflow)return!0;switch(na){case 1986648902:case -1570751769:case 869186573:case -59906385:case 1197060601:case 1305810481:case 330035228:case -509039657:case 1334518759:case -266099:case 710925581:case 327119921:K=!0;break;case 353606613:case -1099009678:case 192430811:K=Te.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)&&!this.$.ea.isNamedObjectViewMode}return K};Ub.prototype.nd=function(K,na,Xa){if("PopulateFormMenu"===na){na=this.yFc?
this.aAe()?Ub.FDh:Ub.GDh:Ub.kIi;K=this.Ta.Oc();for(var Qb=0;Qb<na.length;Qb++)Array.add(K.buttons,this.Ta.Cb(na[Qb]));na=this.Ta.iq("Forms.Flyout");Array.add(na.Dc,K);Xa.MenuItems=na.BC();return!0}return!1};Ub.prototype.j$h=function(K,na,Xa){return this.EPd&&K.command===na?(this.CPd(K,-266099),Yg.TaskExtensions.s5()):Yg.TaskExtensions.Ba(this.FK.value,function(Qb){la.a(Qb.result,th.a.workflow,null,Xa.WorkflowPostMessage)||Ug.HelperMethods.wf(Xa.WorkflowUrl,"_blank",void 0,"SocialSharingCommandHandler.WorkflowUrl")},
this.la,3)};Ub.prototype.aAe=function(){return!!this.$.workbookContext.FullDocumentInfo.ShareFormCommandUrl||this.$.ea.ah.get(26)};Ub.prototype.N7h=function(){var K=ri.a.create().toString();ud.ULS.sendTraceTag(528581128,306,50,"Calling share to teams deeplink with ID: "+K);var na=this.$.frame,Xa=na.o$a,Qb=this.$,tc=new Gh.QueryStringBuilder(be.AFrameworkApplication.ha.Wa("TeamsMeetingShareEndpoint"));tc.Li("deeplinkId",K);tc.Li("lm","deeplink");K=tc.Li;var md={};var Dd=new Gh.QueryStringBuilder(be.AFrameworkApplication.ha.Wa("TeamsAppSharingUrl"));
Dd.Li("auth","2");Dd.Li("flight","officeunihost");Dd.Li("source","TEAMS-ELECTRON.meetingStage.deeplink");var ue={};ue.fileType=Cf.a.j5(Qb.workbookContext.FullDocumentInfo.WorkbookPath).substring(1);ue.objectUrl=Qb.workbookContext.FullDocumentInfo.WorkbookPath;ue.baseUrl=Qb.workbookContext.FullDocumentInfo.BreadcrumbBrandUrl;Qb=Qb.workbookContext.WorkbookFileVersionId;for(var Ce=decodeURIComponent(Qb);Qb!=Ce;)Qb=Ce,Ce=decodeURIComponent(Qb);0>Qb.indexOf("{")||0>Qb.indexOf("}")?(ud.ULS.sendTraceTag(528250338,
306,15,"Decoded fileId does not match expected format. Decoded id: "+Qb),Qb=""):Qb=Qb.substring(Qb.indexOf("{")+1,Qb.indexOf("}")).toLowerCase();ue.fileId=Qb;ue=$h.c($h.c(ue));Dd.Li("subEntityId",ue.substring(1,ue.length-1));md.appSharingUrl=Dd.toString();md.appId=be.AFrameworkApplication.ha.Wa("TeamsAppId");md=JSON.stringify(md);K.call(tc,"appContext",md);Xa.call(na,tc.toString(),!0)};Ub.prototype.X7h=function(K){this.EPd?this.CPd(K,1986648902):this.y4f()};Ub.prototype.Z9e=function(K,na){!K&&this.$.ya.SurveyRedirectUrl?
this.y7i():(K=new Tb(this.$,K,na),K.initialize(),K.pf())};Ub.prototype.w9h=function(K,na){var Xa=this;this.EPd&&1197060601===K.command?this.CPd(K,-59906385):Yg.TaskExtensions.Ba(this.FK.value,function(Qb){Qb=Qb.result;Qb&&la.a(Qb,th.a.replyWithChanges,null,Xa.$.ea.ah.get(8))||(Qb=new Sys.StringBuilder(na.ReplyWithChangesUrl),Jh.a.ag(Qb,hg.e,hg.d),V.a.ntw(Qb.toString(),Xa.$))},this.la,3)};Ub.prototype.CPd=function(K,na){var Xa=this,Qb=Xd.a(this.$).ud.activityState,tc=new bh.a(na,K.method,K.mode,K.ef,
K.tabName);Ei.a(this.$).Jt(new Vh.a(Hg.a.Hz,5,function(){Qb[ec.a.tr]=Hg.a.tZf;Qb[ej.a.tWc]=tc;Xa.$.Zk.lz("SocialSharingSaveBeforeCommand");Xa.$.Zk.$pe(tc.command)}))};Ub.prototype.y4f=function(){var K=this,na=this.$.ya.DocumentHostInfo;na.HostEmbeddedViewUrl||this.Sze?this.t7f():this.$.dg.get(53)&&Yg.TaskExtensions.Ba(this.FK.value,function(Xa){K.pTj(Xa.result)||V.a.ntw(na.FileEmbedCommandUrl,K.$)},this.la,3)};Ub.prototype.pTj=function(K){return K.isEnabled()&&(this.Rze||(this.Rze=K.Vl(th.a.Qze,this.uMi)))?
K.Nj(th.a.pFh,null):!1};Ub.prototype.t7f=function(){if(Yf.a.zp)V.a.ntw(this.$.ya.EmbedConfiguratorUrl,this.$);else{var K=new ua(this.$);K.initialize();K.pf()}};Ub.prototype.deleteForm=function(){var K=this.$,na=new Eb(K,1234,1235,1227,function(Xa,Qb,tc){var md=K.na.ta.fc(),Dd=K.na.ta;md=Dd.Ma(9,md);md.surveyId=null;return Rd.i(Dd,"DeleteSurvey",md,Xa,Qb,tc,null,0)});na.initialize();na.pf()};Ub.prototype.shareForm=function(){var K=this,na=this.$.workbookContext.FullDocumentInfo;if(this.$.ea.ah.get(26)){var Xa=
new gc(this.$);Xa.initialize();Xa.pf()}else Yg.TaskExtensions.Ba(this.FK.value,function(Qb){var tc={};la.a(Qb.result,th.a.shareForm,(tc[rg.a.IMj]=K.$.workbookContext.SurveyTitle,tc),K.$.ea.ah.get(10))||V.a.ntw(na.ShareFormCommandUrl,K.$)},this.la,3)};Ub.prototype.y7i=function(){var K=this.$;K.ya.SurveyRedirectUrl.replace(RegExp("&startupdialog=[formedit|formpreview]","gi"),"");var na=new Sys.StringBuilder(K.ya.SurveyRedirectUrl);Jh.a.ag(na,"startupDialog","FormEdit");var Xa=Xd.a(this.$),Qb=Xa.ud.activityState;
Qb[Y.a.j3]=na.toString();Qb[Y.a.WM]=Y.a.zAd;this.$.Zk.lz("SocialSharingEnvironmentChange");Ei.a(K).Jt(new Vh.a(Hg.a.Hz,5,function(){var tc=Mg.a.ed(3,2,1279,1280,1281,554412057,"FossEnvironmentUnsupported");Xa.ud.Wt([tc]);Qb[ec.a.tr]=Hg.a.igg}))};Ub.prototype.r4a=function(K){return(this.$.ea.isEditMode||(void 0===K?!1:K))&&this.$.ea.ah.get(25)&&gi.a()};Ub.prototype.q2h=function(K){var na=void 0===na?null:na;var Xa=Og.g(this.$).ga;var Qb=this.$.xa.oa?Lk.d(this.$.xa.oa):null;if(!Qb)return ud.ULS.sendTraceTag(537151649,
0,10,"SocialSharingCommandHandler.GetSharingDetail: Unable to find current sheet id for navType: {0}.",yk[K]),null;14===K?na=this.Q1h(Xa):12===K?(na=Xa.kja,na=ta.a.contains(na,"!",!0)?na.split("!")[1]:na):13===K&&(Xa=Xa.va.selectedRanges,Xa[0]&&(Xa=Og.g(this.$).Tb.Wj(Xa[0])))&&(na=Xa.pj);if(!na)return ud.ULS.sendTraceTag(537151648,0,10,"SocialSharingCommandHandler.GetSharingDetail: Unable to find the selected range reference or object id for navType: {0}",yk[K]),null;Xa={};Xa[rg.a.kMb]="copy";Xa[rg.a.n5f]=
this.OTh(K,na,Qb);ud.ULS.sendTraceTag(537151647,0,50,"SocialSharingCommandHandler.GetSharingDetail: Send Section_Sharing post message with navType: {0} and sectionNameOrId: {1} and SheetId: {2}",yk[K],na,Qb);return Xa};Ub.prototype.Q1h=function(K){if(K.Pa.W5&&(K=K.Pa.nc.floatingObject)&&0===K.type){var na=K.id.split(".");if(1<na.length)return na[1];ud.ULS.sendTraceTag(537151646,0,10,"SocialSharingCommandHandler.GetSelectedFloatingObjectXluid: Invalid floating object id =  {0}",K.id)}return null};
Ub.prototype.OTh=function(K,na,Xa){K=btoa(K+"_"+na+"_"+Xa);K=K.replace(RegExp("\\+","g"),"-");K=K.replace(RegExp("\\/","g"),"_");return K=K.replace(RegExp("\\=+$","g"),"")};Ub.prototype.B8f=function(K,na){var Xa=this;return Yg.TaskExtensions.Ba(this.FK.value,function(Qb){la.a(Qb.result,th.a.sharing,na,Xa.$.ea.ah.get(5))?ud.ULS.sendTraceTag(537151644,0,50,"SocialSharingCommandHandler.ShowShareDialog: Send UI_Sharing post message with mode: {0}",na?na[rg.a.kMb]:""):Ug.HelperMethods.wf(K.FileSharingUrl,
"_blank",void 0,"SocialSharingCommandHandler.FileSharingUrl")},this.la,3)};Ub.prototype.ZSd=function(K,na){if(!Te.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||this.$.isMobileMode)return null;var Xa=this.q2h(K);if(Xa)return this.B8f(na,Xa);ud.ULS.sendTraceTag(537151643,0,10,"SocialSharingCommandHandler.ShareExcelSection: Unable to get the sharing details for navType: {0}",yk[K]);return null};uk.Object.defineProperties(Ub.prototype,{yFc:{configurable:!0,enumerable:!0,
get:function(){return ca.b(this.$.qg)}},EPd:{configurable:!0,enumerable:!0,get:function(){return this.$.isEditMode&&(this.$.ea.unh||this.$.aS)}}});Ub.kIi=[103];Ub.FDh=[107,104,105,106];Ub.GDh=[104,105];Ub.l_g=[new Mk.a(Hg.a.tDe,554412057,0,0,1282),new Mk.a(Hg.a.idle,554412057,0,1)];Object(Sd.a)(Ub,"SocialSharingCommandHandler",d.a,[434]);var bl=eh.a;Am(tb,bl);tb.prototype.Qd=function(){var K=this,na=new mf.a(function(){return wh.GetServiceTaskFactory.create(K.$.da,137,K.la,K.ub)});Yg.TaskExtensions.Ba(wh.GetServiceTaskFactory.create(this.$.da,
102,this.la,this.ub),function(Xa){K.Jd([new Ub(K.$,Xa.result,na)])},this.la,3)};tb.ka=function(K){eh.a.je(114,new tb(K))};Object(Sd.a)(tb,"SocialSharingCommandHandlerFactory",eh.a,[]);Object(Sd.a)(Ha,"MacroRecorderRangeCustomSortedPayload",null,[428]);var ml=b(1164),cl=b(1165),dl=b(1007),gk=b(960),Fk=b(211);Nb.prototype.show=function(){var K=new Sh.StandardDialog;K.lc=11;K.Bc(1,Tc.a.instance.fa(2066));K.Bc(2,Tc.a.instance.fa(2067));K.r8f(Tc.a.instance.fa(2065),Tc.a.instance.Va(645),this.Cw)};Nb.prototype.ZOa=
function(K){ud.ULS.sendTraceTag(594125219,0,50,"ExpandSortSelectionDialog: user operation: {0}",K)};Object(Sd.a)(Nb,"ExpandSortSelectionDialog",null,[]);rc.isValid=function(K){return Array.contains(rc.RDh,K.Position)?!0:(ud.ULS.shipAssertTag(537159826,0,!1,"FillGradientStopExtension.IsValid: unexpected position value [{0}]",K.Position),!1)};rc.RDh=[0,.5,1];Object(Sd.a)(rc,"FillGradientStopExtension",null,[]);Object(Sd.a)(jb,"GradientLine",null,[]);Va.isValid=function(K){if(!(K.Degree.toString()in
Va.PDh))return ud.ULS.shipAssertTag(537159829,0,!1,"FillGradientExtension.IsValid: unexpected degree value [{0}]",K.Degree),!1;if(!K.GradientStops)return ud.ULS.shipAssertTag(537159828,0,!1,"FillGradientExtension.IsValid: no gradient stops"),!1;if(K.GradientStops.length<Va.zFi||K.GradientStops.length>Va.ZDi)return ud.ULS.shipAssertTag(537159827,0,!1,"FillGradientExtension.IsValid: unexpected number of gradient stops [{0}]",K.GradientStops.length),!1;K=Cl(K.GradientStops);for(var na=K.next();!na.done;na=
K.next())if(!rc.isValid(na.value))return!1;return!0};Va.zFi=2;Va.ZDi=3;var X={};Va.PDh=(X["0"]=new jb(0,0,1,0),X["180"]=new jb(1,0,0,0),X["90"]=new jb(0,0,0,1),X["270"]=new jb(0,1,0,0),X["45"]=new jb(0,0,1,1),X["225"]=new jb(1,1,0,0),X["135"]=new jb(1,0,0,1),X["315"]=new jb(0,1,1,0),X);Object(Sd.a)(Va,"FillGradientExtension",null,[]);var ya=Th.a;Am(yb,ya);yb.prototype.sP=function(K,na){if(1===K){var Xa=ff.v(this.cEb,this.$);Og.g(this.$).Kg(Xa,null,null,null,0,Ki.a.VIj)}Xa={};Xa=(Xa.DialogButton=K,
Xa.Location="dialog",Xa);Ff.b(this.$).he(Vb.a.XIj,Xa,null,!0);ya.prototype.sP.call(this,K,na)};yb.prototype.Sr=function(){ya.prototype.Sr.call(this);var K=this.UIj();this.lc=1;this.Bc(1,Tc.a.instance.fa(2177));this.Fk(Tc.a.instance.fa(2178),Ld.a.Il(K),1,this.tP)};yb.prototype.UIj=function(){return String.format(Tc.a.instance.Bb(165),this.cEb.toString())};yb.prototype.Kfd=function(){var K=this.error.Description.split("_");return new bj.Range(Number.parseInvariant(K[1])+1,Number.parseInvariant(K[2])+
1,Number.parseInvariant(K[3])+1,Number.parseInvariant(K[4])+1,!0,!1)};uk.Object.defineProperties(yb.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"SortMergedCellsErrorDialog"}}});Object(Sd.a)(yb,"SortMergedCellsErrorDialog",Th.a,[]);var kb=b(637),Zb=b(704),xc=dl.a;Am(lb,xc);lb.prototype.dispose=function(){this.gic||(this.gic=!0,this.q3b(),this.o7=null,Te.EwaSettings.isChangeGateEnabled("OfficeVSO:5963270_DialogMergeSuspension")&&(this.udb.dispose(),this.udb=null));xc.prototype.dispose.call(this)};
lb.prototype.OLh=function(K){var na=this;return function(Xa){if(Lj.b(Xa,-901005882))Xd.a(na.$).ud.ME(-901005882),na.XId();else if(Lj.b(Xa,-569193796))Xd.a(na.$).ud.ME(-569193796),na.hide(),new yb(na.$,Xa.Errors[0]);else if(Lj.a(Xa))ud.ULS.sendTraceTag(529105665,0,10,"CustomSortDialog.GenerateGetSortInfoSuccessCallback: GetSortInfo result contains non-status messages"),na.hide();else{Xa=Xa.Result;na.$.Jj(Xa.SortRange);var Qb=Te.EwaSettings.isChangeGateEnabled("OfficeVSO:4545720_FixingSharedSortInfoResultExtension");
Xa&&ic(Xa)&&rb(Xa)&&Ta(Xa,Qb)?K(Xa):na.u8b(lb.Qsb())}}};lb.prototype.zMh=function(K,na){var Xa=this;return function(Qb,tc){if(Xa.gic)ud.ULS.sendTraceTag(529105635,0,50,"CustomSortDialog.GenerateOnGetSortConditionColorsOrIconsRequestSuccess: response was received after dialog is disposed");else if(!Qb||Lj.a(Qb))ud.ULS.sendTraceTag(529105634,0,10,"CustomSortDialog.GenerateOnGetSortConditionColorsOrIconsRequestSuccess: Unexpected error: {0}",Mg.a.Wc(Qb.Errors)),Xa.$.ea.Hp(Qb.Errors),Xa.hide();else{Qb=
Qb.Result;var md=K.RangeType,Dd=K.HeaderRowSize,ue=K.SortTopToBottom;Qb&&Hc(Qb,K.ConditionType)&&Cc(Qb,md,Dd,ue)?(Qb.ColumnInfo.ColumnOffset=tc,void 0!==Qb.HeaderColumnInfo&&null!==Qb.HeaderColumnInfo&&(Qb.HeaderColumnInfo.ColumnOffset=tc),na(Qb,K.ConditionType,K.SortTopToBottom)):(ud.ULS.sendTraceTag(529105633,0,10,"CustomSortDialog.GenerateOnGetSortConditionColorsOrIconsRequestSuccess: sortConditionColorsOrIconsResult is not valid"),Xa.u8b(lb.Qsb()))}}};lb.prototype.RCj=function(K){return!!this.namedSheetViewPublic&&
(0===K||3===K)};lb.prototype.V$g=function(K){var na={};na.SelectedRange=this.selectedRange;na.ActiveCell=this.brc;na.SortInfoMode=K;na.ExpandSortSelection=this.pYg;na.ExpandSortSelectionSupported=!0;return na};lb.prototype.rua=function(K){var na={};na[Qf.a.Cz]=this.Cc;na.fromAutoFilter=K.FromAutoFilter;na.gridRTL=Og.g(this.$).rtl;na.activeCell=K.ActiveCell;na.selectedRange=K.SelectedRange;na.invokeGetSortInfo=this.cji;na.invokeGetSortConditionColorsOrIcons=this.bji;na.highlightSortRange=this.ubi;
na.getColorName=this.getColorName;return na};lb.prototype.Qpa=function(K,na){K=ff.D(K);this.ga.va.xd.equals(K)||this.ga.updateSelection(K,ff.C(na),0,void 0,void 0,void 0,!0)};lb.prototype.XId=function(){var K=this;(new Nb(function(na){var Xa={};Xa.ActiveCell=K.brc;Xa.SelectedRange=K.selectedRange;Xa.ExpandSelection=na;Xa.FromAutoFilter=!1;na={};K.$.ae(-207540907,Oa.a.$b,8,(na.SortCommandData=Xa,na))})).show()};lb.prototype.q3b=function(){if(void 0!==this.o7&&null!==this.o7)for(var K=Cl(this.o7),na=
K.next();!na.done;na=K.next())this.$.na.ta.ogb(na.value.$t)};lb.jPf=function(K,na){var Xa={};K.ae(1659552324,Oa.a.$b,8,(Xa.CustomSortCommandData=na,Xa))};lb.Qsb=function(){return Mg.a.ed(1,0,26,0,1,-1517197771,"CustomSortValidationError")};uk.Object.defineProperties(lb.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"CustomSortDialog"}},ga:{configurable:!0,enumerable:!0,get:function(){return Og.g(this.$).ga}}});Object(Sd.a)(lb,"CustomSortDialog",dl.a,[]);var cd=b(1251);Cb.prototype.getSelection=
function(){return this.selection};Object(Sd.a)(Cb,"MacroRecorderRangeAutoFilterClearedPayload",null,[428]);Object(Sd.a)(wc,"MacroRecorderRangeFilterReappliedPayload",null,[428]);var dd=b(982),Qc=b(983),Ic=b(145),Gd=b(39);ib.prototype.$c=function(K,na){return!this.wtd(K,na)};ib.prototype.executeCommand=function(K,na,Xa){var Qb=null;K=na.command;switch(K){case -864298118:Qb=this.mlh(na,Xa);break;case -1010737776:Qb=this.O9c(!0,na,Xa);break;case 2123420468:Qb=this.O9c(!1,na,Xa);break;case -1089513346:Xa=
this.C1e(Xa);if(!this.hkc([ff.D(Xa.SortOptions.SelectedRange)]))return Yg.TaskExtensions.Dl();Qb=this.NMe(na,Xa);break;case -207540907:case -1677817820:Qb=this.gridView.Tb.Qla(this.gridView.ga.va.activeCell)?this.z7i():this.w7i(na,Xa);break;case 1659552324:Qb=this.NMe(na,this.C1e(Xa));break;case 368460465:Qb=this.Clh(na);break;case 529856798:Qb=this.hlh(na);break;case 644342024:Qb=this.xlh(na)}return Qb||k.a(K)};ib.prototype.Mc=function(K,na){if(K=1===K)switch(na.command){case -864298118:case -1010737776:case 2123420468:case -1089513346:case -207540907:case -1677817820:case 1659552324:case 368460465:case 529856798:case 644342024:break;
default:K=!1}return K};ib.prototype.nd=function(){return!1};ib.prototype.ga=function(){return this.$&&this.gridView?this.gridView.ga:null};ib.prototype.cSf=function(K){K?this.gridView.yr(this.onContentReady):this.gridView.Nt(this.onContentReady);this.Bgf=K};ib.prototype.XDj=function(K){return!!this.sortOptions&&ta.a.equals(this.Xnf,K.kja,!0)};ib.prototype.wtd=function(K,na){var Xa=Og.g(this.$).ga.va.selectedRanges;return(new ch.a(this.$.xa)).Tn(K,na,Xa,this.gridView)};ib.prototype.O9c=function(K,
na,Xa){var Qb={OperationType:0};Qb.IsAscending=K;Qb.HasHeader=!0;Qb.GuessHeader=!0;Qb.SortTopToBottom=!0;Qb.ExpandSortSelectionSupported=!0;Xa&&void 0!==Xa[ib.STa]&&null!==Xa[ib.STa]?(Xa=Xa[ib.STa],Qb.ActiveCell=Xa.ActiveCell,Qb.SelectedRange=Xa.SelectedRange,Qb.ExpandSortSelection=Xa.ExpandSelection):(Qb.ActiveCell=ff.o(this.ga().va.activeCell,this.$),Qb.SelectedRange=ff.v(this.ga().va.xd,this.$),Qb.ExpandSortSelection=null);return this.hkc([ff.D(Qb.SelectedRange)])?this.gridView.Tb.Qla(ff.D(Qb.SelectedRange))?
this.ulh(K):this.xff(Qb,na):Yg.TaskExtensions.Dl()};ib.prototype.mlh=function(K,na){var Xa=null,Qb=this.ga();Qb&&(this.XDj(Qb)?this.hkc(Qb.va.selectedRanges)&&(this.sortOptions.IsAscending=!this.sortOptions.IsAscending,Xa=this.xff(this.sortOptions,K)):Xa=this.O9c(!0,K,na));return Xa};ib.prototype.hkc=function(K){return Te.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SheetProtectionSettings",!1)&&(Te.EwaSettings.isChangeGateEnabled("OfficeVSO:5767424_EnablePauseProtectionInViewMode")||
this.$.isEditMode)?this.$.isEditMode?this.$.Br(K,!0,1):this.$.wZc(K,!0,1):!0};ib.prototype.ulh=function(K){this.g_h(K);return Kg.Task.Sa(!0)};ib.prototype.VUg=function(K){if(Te.EwaSettings.isChangeGateEnabled("OfficeVSO:4112173_MacroRecorderTableSortOnRange")){var na=this.gridView.Tb.Wj(this.ga().va.xd,!1);if(na){var Xa=na.name;na=na.usedRange;na=this.ga().va.activeCell.left-na.left;return new cl.a(Xa,na,K.IsAscending)}}return new ml.a(K)};ib.prototype.xff=function(K,na){function Xa(){return Qb.VUg(K)}
var Qb=this;this.gridView.Lg.xH(!1);return this.fad(function(tc,md,Dd){return Rb(Qb.$.na.ta,K,nh.b(tc,Qb.TXi),md,Dd,K)},function(tc){return new Oc.a(141,0,tc,void 0,Xa)},na,this.QCj(K))};ib.prototype.QCj=function(K){if(!this.namedSheetViewPublic)return!1;var na=this.ga().va.xd,Xa=ff.v(this.ga().va.xd,this.$),Qb=this.gridView.Tb.jya(na,!0),tc=this.ga().va.uca()&&this.gridView.Tb.jtd(Xa),md=this.gridView.Tb.qqi(Xa);K=Te.EwaSettings.isChangeGateEnabled("OfficeVSO:6195588_fixGetValueOrDefaultDullscriptBug")?
(na.Y_||na.FW)&&!na.isSingle&&(null==K.ExpandSortSelection?!1:K.ExpandSortSelection)&&this.gridView.Tb.jtd(Xa):!na.Y_&&!na.FW||na.isSingle||null!=K.ExpandSortSelection?K.ExpandSortSelection&&this.gridView.Tb.jtd(Xa):!1;return Qb||tc||md||K};ib.prototype.z7i=function(){return this.$.ae(-1556797033,Oa.a.$b,8,null)};ib.prototype.w7i=function(K,na){K=8===K.ef&&na&&void 0!==na[ib.STa]&&null!==na[ib.STa]?na[ib.STa]:19===K.ef&&na&&void 0!==na[Oa.a.Gg]&&null!==na[Oa.a.Gg]?kk.a.ui(na[Oa.a.Gg]):this.X9g();
if(!this.hkc([ff.D(K.SelectedRange)]))return Yg.TaskExtensions.Dl();Og.g(this.$).Lg.xH(!1);var Xa=null;(na=na.TopCellAddress)&&(Xa=ff.o(na,this.$));new lb(this.$,K,this.namedSheetViewPublic,Xa);return Kg.Task.Sa(!0)};ib.prototype.C1e=function(K){return K[ib.dfh]};ib.prototype.NMe=function(K,na){function Xa(Ce){return new Oc.a(187,0,Ce,void 0,Qb)}function Qb(){return new Ha(na.SortOptions)}function tc(Ce,Kf,Wg){return Rb(ue.$.na.ta,na.SortOptions,nh.b(Ce,Dd),nh.a(Kf,md),Wg,ue.sortOptions)}function md(){na.ShouldRestoreSelection&&
ue.Qpa(na.SelectedRange,na.OriginalActiveCell);ud.ULS.sendTraceTag(537151575,0,10,"SortCommandHandler.DoCustomSort.onSortFailedCallback: Custom Sort failed. Called from: {0}",K.ef)}function Dd(Ce){Te.EwaSettings.isChangeGateEnabled("OfficeVSO:5899794_MergedCellsErrorFix")&&ue.xaf(Ce)?ue.l$e(Ce.Errors[0]):(na.ShouldRestoreSelection&&ue.Qpa(na.SelectedRange,na.OriginalActiveCell),ud.ULS.sendTraceTag(537151576,0,50,"SortCommandHandler.DoCustomSort.onSortSuccessCallback: Custom Sort succeeded. Called from: {0}",
K.ef),na.TopCellAddress?Ce=ff.C(na.TopCellAddress):(Ce=na.OriginalActiveCell,Ce=new bj.Range(Ce.FirstRow+1,Ce.FirstColumn+1,Ce.FirstRow+1,Ce.FirstColumn+1,!0,!1)),ue.tM(Ce))}var ue=this;return Te.EwaSettings.isChangeGateEnabled("OfficeVSO:6170028_HandleSheetProtectionForSortFeatures")?this.fad(tc,Xa,null,na.ShouldPromptNamedSheetViewTeachingDialog):lc.a(this.$.userOperationManager,tc,Xa,null)};ib.prototype.Qpa=function(K,na){K=ff.D(K);Og.g(this.$).ga.va.xd.equals(K)||Og.g(this.$).ga.updateSelection(K,
ff.C(na),0,void 0,void 0,void 0,!0)};ib.prototype.X9g=function(){var K={};K.ActiveCell=ff.o(this.ga().va.activeCell,this.$);K.SelectedRange=ff.v(this.ga().va.xd,this.$);K.FromAutoFilter=!1;K.ExpandSelection=null;return K};ib.prototype.Clh=function(K){function na(){return new cd.a(Qb)}var Xa=this,Qb=this.qwa();if(!Qb)return Kg.Task.Sa(!1);var tc=this.$.na.ta.fc();return Te.EwaSettings.uc()?lc.a(this.$.userOperationManager,function(md,Dd,ue){return Rd.kb(Xa.$.na.ta,Qb,dd.a.Mwa(Ic.a.b0a,Qc.a.toggleAutoFilter,
md),Dd,ue,null,tc)},function(md){return new Oc.a(516,0,md,64,na)},K):lc.a(this.$.userOperationManager,function(md,Dd,ue){return Rd.kb(Xa.$.na.ta,Qb,dd.a.Mwa(Ic.a.b0a,Qc.a.toggleAutoFilter,md),Dd,ue,null,tc)},function(md){return new Hj.a(516,0,md,void 0,na)},K)};ib.prototype.hlh=function(K){function na(){return new Cb(Qb)}var Xa=this,Qb=this.qwa();if(!Qb)return Kg.Task.Sa(!1);var tc=this.gridView.Tb.Wj(this.ga().va.xd,!0);tc&&ud.ULS.sendTraceTag(537151574,0,50,"DoClearAutoFilter for namedObject: Type : {0}",
tc.type.toString());var md=this.$.na.ta.fc();tc=Te.EwaSettings.uc()?function(Dd){return new Oc.a(517,0,Dd,64,na)}:function(Dd){return new Hj.a(517,0,Dd,void 0,na)};return this.fad(function(Dd,ue,Ce){var Kf=Xa.$.na.ta;Dd=dd.a.Mwa(Ic.a.uta,Qc.a.clearAutoFilter,Dd);var Wg=Kf.Ma(41,void 0===md?null:md);Wg.selectedRange=Qb;return Rd.i(Kf,"ClearAutoFilter",Wg,Dd,ue,Ce,null,0)},tc,K)};ib.prototype.fad=function(K,na,Xa,Qb){var tc=this;return this.namedSheetViewPublic&&(void 0===Qb||Qb)?this.namedSheetViewPublic.TBa().continueWith(function(md){md.result&&
lc.a(tc.$.userOperationManager,K,na,Xa)}):lc.a(this.$.userOperationManager,K,na,Xa)};ib.prototype.xlh=function(K){function na(){return new wc(Qb)}var Xa=this,Qb=this.qwa();if(!Qb)return Kg.Task.Sa(!1);var tc=this.$.na.ta.fc();return Te.EwaSettings.uc()?lc.a(this.$.userOperationManager,function(md,Dd,ue){return nc(Xa.$.na.ta,Qb,dd.a.Mwa(Ic.a.uta,Qc.a.JPf,md),Dd,ue,null,tc)},function(md){return new Oc.a(518,0,md,64,na)},K):lc.a(this.$.userOperationManager,function(md,Dd,ue){return nc(Xa.$.na.ta,Qb,
dd.a.Mwa(Ic.a.uta,Qc.a.JPf,md),Dd,ue,null,tc)},function(md){return new Hj.a(518,0,md,void 0,na)},K)};ib.prototype.xaf=function(K){return Lj.b(K,-569193796)};ib.prototype.l$e=function(K){Xd.a(this.$).ud.ME(-569193796);new yb(this.$,K)};ib.prototype.XId=function(K){var na=this;(new Nb(function(Xa){var Qb={};Qb.ActiveCell=K.ActiveCell;Qb.SelectedRange=K.SelectedRange;Qb.ExpandSelection=Xa;Xa={};na.$.ae(K.IsAscending?-1010737776:2123420468,Oa.a.$b,8,(Xa[ib.STa]=Qb,Xa))})).show()};ib.prototype.dHj=function(){var K=
this.ga();K.updateSelection(this.FAc,K.va.activeCell,0,void 0,void 0,void 0,!0);this.cSf(!0)};ib.prototype.qwa=function(){var K=this.ga();if(!K)return ud.ULS.shipAssertTag(537151573,0,!!K,"SelectionManger is null"),null;this.gridView.Lg.xH(!1);return ff.v(K.va.xd,this.$)};ib.prototype.BLb=function(){this.Tc&&this.Tc.ap&&(this.gg=this.Tc.ap,this.Db=this.Tc.Hcc())};ib.prototype.g_h=function(K){var na=this;if(this.$.isEditMode&&(this.Tc=this.gridView.Tb.qp(this.gridView.ga.va.activeCell))){this.activeCell=
ff.o(this.gridView.ga.va.activeCell,this.$);if(this.Tc&&this.Tc.ap){var Xa=this.Tc.ap.CurrentCol;if(this.Tc.ap.CurrentRow===this.activeCell.FirstRow&&Xa===this.activeCell.FirstColumn){this.BLb();this.applyPivotSort(K);return}}this.$.na.ta.fc();Xa=new Oc.a(228,0,function(Qb,tc,md){return Rd.C(na.$.na.ta,na.activeCell,nh.b(Qb,na.qRi),nh.a(tc,na.pRi),md,K)},16);this.$.userOperationManager.jc(Xa,null)}};ib.prototype.applyPivotSort=function(K){var na=this;if(this.Tc&&this.Db&&this.activeCell&&this.gg){var Xa=
8===this.gg.CellArea,Qb=1===this.gg.CellArea||2===this.gg.CellArea;(Xa||Qb)&&8!==this.gg.CellType&&4!==this.gg.CellType&&(Xa?lc.a(this.$.userOperationManager,function(tc,md,Dd){return Rd.e(na.$.na.ta,na.activeCell,K?1:2,na.Db.Caption,tc,md,Dd,null)},function(tc){return new Oc.a(1015,0,tc,void 0,null)},null):(Xa=1===this.gg.CellArea?1:2,this.$.ma(716)?V.a.naps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.Tc.externalSourceIndex,this.Db.Index.toString(),this.Db.Caption,
this.Tc.isOlap?"":this.Db.Caption,Xa,K):V.a.aps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.Tc.externalSourceIndex,this.Db.Index.toString(),K)))}};ib.prototype.tM=function(K){(Te.EwaSettings.isChangeGateEnabled("OfficeVSO:6063473_PTPSDisableLive")?Gd.a.Pla(this.$):Te.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.PivotTableHandRaise",!1))&&Yg.TaskExtensions.Ba(wh.GetServiceTaskFactory.Ua(this.$.da,430,431,1),function(na){na.result.ifa(K);ud.ULS.sendTraceTag(537151571,
306,50,"SortCommandHandler:TriggerPivotTableHandRaise Trigger hand raise from sort.")},this.$.la,3)};ib.prototype.ZZd=function(K){Te.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.DataCleansingProactiveSuggestion",!1)&&Yg.TaskExtensions.Ba(wh.GetServiceTaskFactory.Ua(this.$.da,476,475,0),function(na){na.result.ZZd(K,0);ud.ULS.sendTraceTag(537151570,0,50,"SortCommandHandler:TriggerProactiveSuggestion Trigger proactive suggestion from sort.")},this.$.la,3)};ib.dfh="CustomSortCommandData";
ib.STa="SortCommandData";Object(Sd.a)(ib,"SortCommandHandler",null,[434]);var Pd=eh.a;Am(Da,Pd);Da.prototype.Qd=function(){var K=this;Yg.TaskExtensions.Ba(wh.GetServiceTaskFactory.Ua(this.$.da,309,310,this.ub),function(na){K.Jd([new ib(K.$,na.result)])},this.$.la,3)};Da.ka=function(K){eh.a.je(160,new Da(K))};Object(Sd.a)(Da,"SortCommandHandlerFactory",eh.a,[]);Ja.prototype.tdh=function(K,na){new yb(K,na)};Object(Sd.a)(Ja,"SortUtil",null,[677]);var ze=uh.a;Am(pa,ze);pa.prototype.create=function(){var K=
this.$.da.Aa(446);K||(K=new Ja(this.$),this.$.da.Ha(446,K));this.Eb(K)};pa.ka=function(K){K.da.Ha(447,new pa(K))};Object(Sd.a)(pa,"SortUtilFactory",uh.a,[]);nb.prototype.executeCommand=function(K,na,Xa){return 2!==this.Ki.Be(gg.a.tryOfficeThroughTellMe,2,Xa)?Kg.Task.Sa(!0):k.a(na.command)};nb.prototype.Mc=function(K,na){return 215809929===na.command};nb.prototype.nd=function(){return!1};nb.prototype.$c=function(){return!1};Object(Sd.a)(nb,"TryOfficeThroughTellMeCommandHandler",null,[434]);var gf=
eh.a;Am(zb,gf);zb.prototype.Qd=function(){this.Jd([new nb(be.AFrameworkApplication.Ib)])};zb.ka=function(K){eh.a.je(207,new zb(K))};Object(Sd.a)(zb,"TryOfficeThroughTellMeCommandHandlerFactory",eh.a,[]);var uf=b(168);gb.FN=function(){return oh.a.Qn(gb.fk,uf.a.Va(433))};gb.fk="<div class='namedsheetview_teaching_dialog_control' id='IconAndDescriptionRow'> <div class='namedsheetview_teaching_dialog_description_label' id='IconAndDescriptionRow'> <div class='namedsheetview_teaching_dialog_textarea' id='TextArea'> <label id='TeachingDescriptionId' class='WACDialogLabel' >{0}</label> </div> </div> </div>";
Object(Sd.a)(gb,"NamedSheetViewTeachingDialogHtml",null,[]);var jg=Qf.a;Am(Za,jg);Za.prototype.mh=function(){this.lc=4;this.stopwatch=this.$.Sb.Hc("UserAction",this.Cc);var K=Tc.a.instance.fa(1861);this.ig=gb.FN();this.jp=new Gg.a;this.initializeAndShow(K,this.tHi,{});return this.jp.task};Za.prototype.Kv=function(K){jg.prototype.Kv.call(this,K);this.Bc(1,Tc.a.instance.fa(1863));this.Bc(2,Tc.a.instance.Va(446))};Za.prototype.U5i=function(){this.$.ea.Qnc=!1};Za.prototype.oAi=function(K){var na={};na.a=
this.$.ya.UserSessionId;na.b="NamedSheetViewTeachingDialogClose";na.c=K;na.e=!0;this.stopwatch&&(this.stopwatch.stop(),na.d=this.stopwatch.Gc);yi.b().Te(53,na,!0)};uk.Object.defineProperties(Za.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"ShowNamedSheetViewTeachingDialog"}}});Object(Sd.a)(Za,"NamedSheetViewTeachingDialog",Qf.a,[]);var mg=b(175);Ma.prototype.TBa=function(){if(this.rDj()){if(Te.EwaSettings.ma(598)){this.$.xa.oa.Yd.mUd=!0;var K=new Gg.a;this.$.Ka.dc(new bh.a(-2050946363,
Oa.a.$b,2,0,null)).continueWith(function(na){K.setResult(!cf.a(na)&&na.result)});return K.task}return(new Za(this.$)).mh()}return Kg.Task.Sa(!0)};Ma.prototype.rDj=function(){var K=this.$.xa.oa;return this.$.ea.A$a&&this.$.ea.Qnc&&!K.Yd.vy&&this.$.ea.tN&&!mg.e(this.$)};Object(Sd.a)(Ma,"NamedSheetViewPublic",null,[679]);var sh=uh.a;Am(oa,sh);oa.prototype.create=function(){this.Eb(this.$.da.Aa(309)||new Ma(this.$))};oa.ka=function(K){K.da.Ha(310,new oa(K))};Object(Sd.a)(oa,"NamedSheetViewPublicFactory",
uh.a,[]);var Bh=b(1383),yh=b(1072),Ri=b(627);Object(Sd.a)($b,"NamedSheetViewTeachingCalloutContent",null,[]);uk.Object.defineProperties(Gb.prototype,{Pbg:{configurable:!0,enumerable:!0,get:function(){return this.Yle}},G7i:{configurable:!0,enumerable:!0,get:function(){return this.Pbg<this.Rbg.count?this.Rbg.pa(this.Yle++):null}}});Object(Sd.a)(Gb,"NamedSheetViewTeachingCalloutList",null,[]);var mi=b(1252);xa.prototype.Dei=function(K){var na=this;this.Qbg=K;var Xa=Object.assign(new wb.a,{});xa.ani(K)?
(Xa.add(new $b(Tc.a.instance.Va(435),Tc.a.instance.Va(436),Tc.a.instance.fa(1891),function(){na.vI(2,"Continue");na.rK(!0)},Tc.a.instance.fa(1892),function(){na.rK();na.vI(1,"ExitGuide")},mi.a())),1===K&&Xa.add(new $b(Tc.a.instance.fa(1893),Tc.a.instance.Va(438),Tc.a.instance.fa(1891),function(){na.vI(2,"FirstEnterTempViewContinueSecond");na.rK(!0)},Tc.a.instance.fa(1892),function(){na.rK();na.vI(1,"FirstEnterTempViewExitGuideSecond")},mi.a())),Xa.add(new $b(Tc.a.instance.Va(439),Tc.a.instance.Va(440),
Tc.a.instance.fa(1891),function(){na.vI(2,"FirstEnterExitCalloutContinue");na.rK(!0)},Tc.a.instance.fa(1892),function(){na.rK();na.vI(1,"FirstEnterExitCalloutGuide")},xa.v4e())),Xa.add(new $b(Tc.a.instance.fa(1894),Tc.a.instance.Va(437),Tc.a.instance.fa(1895),function(){na.a8f();na.rK();na.vI(1,"LearnMore")},Tc.a.instance.fa(1896),function(){na.rK();na.vI(1,"Done")},xa.u4e()))):2===K?Xa.add(new $b(Tc.a.instance.fa(1893),Tc.a.instance.Va(438),Tc.a.instance.fa(1890),function(){na.rK();na.vI(1,"EnterTempViewAfterPersistedView")},
null,null,mi.a())):3===K&&(Xa.add(new $b(Tc.a.instance.Va(435),Tc.a.instance.fa(1902),Tc.a.instance.fa(1891),function(){na.vI(2,"AutoOptInExitCalloutContinue");na.rK(!0)},Tc.a.instance.fa(1892),function(){na.rK();na.vI(1,"AutoOptInExitGuide")},xa.v4e())),Xa.add(new $b(Tc.a.instance.fa(1893),Tc.a.instance.Va(438),Tc.a.instance.fa(1891),function(){na.vI(2,"Continue");na.rK(!0)},Tc.a.instance.fa(1892),function(){na.rK();na.vI(1,"ExitGuide")},mi.a())),Xa.add(new $b(Tc.a.instance.fa(1894),Tc.a.instance.Va(437),
Tc.a.instance.fa(1895),function(){na.a8f();na.rK();na.vI(1,"LearnMore")},Tc.a.instance.fa(1896),function(){na.rK();na.vI(1,"Done")},xa.u4e())));this.oYd=new Gb(Xa)};xa.prototype.a8f=function(){var K=new bh.a(-859308420,Oa.a.$b,this.$.jd,9,null),na={};na=(na[Oa.a.Gg]="HelpID=SheetViews",na.InputMethod=Oa.a.$b,na[Oa.a.od]=M.a.oW,na.ShouldCanvasTakeFocus=!0,na);this.$.Ka.dc(K,na)};xa.prototype.show=function(K){this.Dei(K);this.Ueb()};xa.prototype.Swj=function(K){this.b1b=K};xa.prototype.Ueb=function(){var K=
this,na=this.oYd.G7i;if(na){var Xa=Object.assign(new Bh.a,{label:na.e6i,onExecute:na.primaryButtonAction}),Qb=null;na.W_f&&(Qb=Object.assign(new Bh.a,{label:na.W_f,onExecute:na.secondaryButtonAction}));na=Object.assign(new yh.a,{target:na.targetObject,content:na.body,title:na.title,showCloseIcon:!0,primaryButtonProps:Xa,secondaryButtonProps:Qb,useTeachingStyles:!0});na=this.b1b.callout(na);Xa=Object.assign(new Ri.a,{onShow:function(){K.vI(0)}});this.YBc=this.b1b.addNotification(na,Xa);this.uZc||(this.$.Vtd=
!0)}};xa.prototype.dismiss=function(){this.rK();this.vI(1,"DismissedByOthers")};xa.prototype.rK=function(K){K=void 0===K?!1:K;this.YBc&&(this.uZc||(this.$.Vtd=!1),this.b1b.removeNotification(this.YBc),this.YBc=null);K&&this.Ueb()};xa.prototype.vI=function(K,na){var Xa={};Xa.a=this.$.ya.UserSessionId;Xa.b=this.Qbg;Xa.c=this.oYd.Pbg;Xa.d=K;Xa.e=void 0===na?null:na;0===K?this.stopwatch=this.$.Sb.Hc("UserAction","ShowNamedSheetViewTeachingCallout"):(this.stopwatch&&(this.stopwatch.stop(),Xa.f=this.stopwatch.Gc,
this.stopwatch=null),2===K&&(this.stopwatch=this.$.Sb.Hc("UserAction","ShowNamedSheetViewTeachingCalloutNext")));yi.b().Te(52,Xa,!0)};xa.u4e=function(){return document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv")};xa.v4e=function(){return document.querySelector("[data-unique-id=Ribbon-NamedSheetViewExit]")};xa.ani=function(K){return 0===K||1===K};Object(Sd.a)(xa,"NamedSheetViewTeachingCallout",null,[675]);var Ai=uh.a;Am(bb,Ai);bb.prototype.create=function(){var K=this.$.da.Aa(322);
K||(K=new xa(this.$),Te.EwaSettings.isChangeGateEnabled("OfficeVSO:5782706_NSVTC")&&this.$.da.Ha(322,K));this.Eb(K)};bb.ka=function(K){K.da.Ha(323,new bb(K))};Object(Sd.a)(bb,"NamedSheetViewTeachingCalloutFactory",uh.a,[]);var Ti=b(94),ti=b(180),nj=b(1253),wi=b(55),gh=b(1145),hi=Sh.StandardDialog;Am(Ua,hi);Ua.prototype.nR=function(){this.lc=5;this.width=40;var K=document.createElement("span");K.id=this.vi("DirectPrintHeaderContent");var na=document.createElement("span");na.innerText=CommonUIStrings.l_DirectPrintDialogHeader;
Sys.UI.DomElement.addCssClass(na,"DirectPrintHeader");this.nQ=document.createElement("iframe");this.nQ.name="pdfObjectFrame";this.nQ.title=CommonUIStrings.l_DirectPrintDialogIFrame;this.nQ.onload=Object(Vf.a)(this,this.q6i,"printablePdfLoaded");if(this.OXb&&0<this.OXb.count){var Xa=zg.a.jjd(this.BWb,this.OXb),Qb=zg.a.YLd(this.BWb,this.OXb);this.fm=document.createElement("form");this.fm.id="printPreviewPostForm";this.fm.method="POST";this.fm.target=this.nQ.name;this.fm.action=Qb;Xa=Cl(Xa);for(Qb=Xa.next();!Qb.done;Qb=
Xa.next()){Qb=Qb.value;var tc=document.createElement("input");tc.type="hidden";tc.name=Qb.key;tc.value=Qb.value;this.fm.appendChild(tc)}}else this.nQ.setAttribute("src",this.BWb);Sys.UI.DomElement.addCssClass(this.nQ,ti.a.Wfe);this.Mtg?(Sys.UI.DomElement.addCssClass(this.nQ,"DirectPrintPdfObjectHidden"),na.innerText=CommonUIStrings.l_DirectPrintDialogSuccessText,Uh.a.ih(this.nQ,Uh.a.zC,Uh.a.Dj)):(Sys.UI.DomElement.addCssClass(this.nQ,"DirectPrintPdfObject"),this.en.push(this.nQ));K.appendChild(na);
K.appendChild(document.createElement("br"));K.appendChild(this.nQ);this.fm&&K.appendChild(this.fm);K.appendChild(document.createElement("br"));K.appendChild(this.N5g(this.fm?"#":this.BWb));this.Anb.start();this.dEb(CommonUIStrings.l_AppTitle,null,null,null,null,K);this.UX(this.vi("DirectPrintHeaderContent"));this.fm&&this.fm.submit();this.L$g();ud.ULS.sendTraceTag(4771852,328,50,"Direct Print Dialog launched.")};Ua.prototype.N5g=function(K){var na=document.createElement("span"),Xa=document.createElement("span");
Xa.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFHeader;na.appendChild(Xa);be.AFrameworkApplication.ha&&(2===be.AFrameworkApplication.sa.Qa.Yj&&be.AFrameworkApplication.ha.ra("PPTDisableDirectPrintDialogDownloadPDFLink")||1===be.AFrameworkApplication.sa.Qa.Yj&&be.AFrameworkApplication.ha.ra("XLODisableDirectPrintDialogOpenPDFLink"))?(K=document.createElement("span"),2===be.AFrameworkApplication.sa.Qa.Yj?K.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLabel:1===be.AFrameworkApplication.sa.Qa.Yj&&
(K.innerText=CommonUIStrings.l_InternalError_Directive,ud.ULS.sendTraceTag(573691527,328,50,"Hyperlink removed from DirectPrintDialog in XLO.")),this.dra=K,na.appendChild(document.createElement("br")),na.appendChild(K)):(Xa=document.createElement("a"),Xa.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLink,Xa.href=K,Xa.target="_blank",Xa.id="PrintPDFLink",Xa.className="AllowBrowserClick",this.dra=Xa,na.appendChild(document.createElement("br")),na.appendChild(Xa),this.fm&&Zg.a.addHandler(Xa,
"click",Object(Vf.a)(this,this.Eqc,"onSubmit")),this.jQ.qa(Bf.a.click,this.dra,Object(Vf.a)(this,this.nNe,"downloadPDFLinkClicked"),null));this.en.push(this.dra);return na};Ua.prototype.Eqc=function(K){this.fm&&(this.fm.target="_blank",this.fm.submit());K.preventDefault()};Ua.prototype.L$g=function(){if(0<this.en.length){var K=new nj.a(this.en),na=Ti.FocusManager.instance().IR();na&&(this.dra.focus(),na.kf=K,na.l0=!0)}};Ua.prototype.nNe=function(){ud.ULS.sendTraceTag(4585050,328,50,"Download PDF from Direct Print dialog clicked.");
return!1};Ua.prototype.exd=function(){ud.ULS.sendTraceTag(21031114,328,50,"Download PDF from Direct Print dialog button clicked")};Ua.prototype.q6i=function(){ud.ULS.sendTraceTag(51426332,328,50,"PDF content loaded successfully");this.Anb&&this.Anb.stop()};Ua.prototype.dispose=function(){this.dra&&(this.jQ.za(Bf.a.click,this.dra,Object(Vf.a)(this,this.nNe,"downloadPDFLinkClicked")),this.dra=null);wi.a.$0(this.nQ);this.nQ=null;hi.prototype.dispose.call(this)};Object(Sd.a)(Ua,"DirectPrintDialog",Sh.StandardDialog,
[700]);ab.prototype.dTh=function(K,na,Xa){return new Ua(this.jQ,K,na,void 0===Xa?null:Xa)};Object(Sd.a)(ab,"DirectPrintDialogFactory",null,[674]);Am(Fa,Wd);Fa.prototype.Ypf=function(){ud.ULS.sendTraceTag(7690390,324,50,"Legacy print dialog displayed")};Fa.prototype.$pf=function(){be.AFrameworkApplication.Ym.Bzb(9540);ud.ULS.sendTraceTag(7690391,324,50,"Legacy print dialog clicked")};Fa.prototype.exd=function(){ud.ULS.sendTraceTag(19462215,324,50,"Legacy print dialog button clicked")};uk.Object.defineProperties(Fa.prototype,
{Dcf:{configurable:!0,enumerable:!0,get:function(){return"Print_32x32x32"}},XYd:{configurable:!0,enumerable:!0,get:function(){return Fa.nVa?CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint:null}},qPa:{configurable:!0,enumerable:!0,get:function(){return Fa.nVa?null:CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint}},sYc:{configurable:!0,enumerable:!0,get:function(){var K=[];Array.add(K,CommonUIStrings.l_PrintDialogCanCloseDocument);if(Wd.Yyb){var na=CommonUIStrings.l_DirectPrintDialogFallbackSuggestion;
""!==be.AFrameworkApplication.sa.Qa.DJe&&(na=be.AFrameworkApplication.sa.Qa.DJe);Array.add(K,na)}return Fa.nVa?K:null}},Klc:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_DirectPrintDialogDownloadPDFLink}},Jlc:{configurable:!0,enumerable:!0,get:function(){return"PrintPDFLink"}},buttonText:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_PrintDialogOpenPDF}},s7c:{configurable:!0,enumerable:!0,get:function(){return be.AFrameworkApplication.wLe?"UIFontDialogTextLarge":
null}}});uk.Object.defineProperties(Fa,{nVa:{configurable:!0,enumerable:!0,get:function(){return!!be.AFrameworkApplication.sa&&be.AFrameworkApplication.sa.Qa.Tw&&be.AFrameworkApplication.ha.ra("DirectPrintDialogAsStandardDialogIsEnabled")&&!(Yf.a.oD||Yf.a.uf||Yf.a.Hf||Yf.a.s8a)&&!be.AFrameworkApplication.isUnifiedHostMode&&be.AFrameworkApplication.ha.ra("ShouldHostDefaultToNativeBrowserPrintExperience")},set:function(){}}});Object(Sd.a)(Fa,"PrintDialogWithLinkToPdf",Wd,[]);Aa.q9c=",";Object(Sd.a)(Aa,
"DirectPrintBrsSettings",null,[]);Object(Sd.a)(qa,"DirectPrintProbeResults",null,[]);ha.prototype.start=function(){};ha.prototype.p8i=function(){var K=Array(this.WC.lUa.length);if(void 0!==this.Slb&&null!==this.Slb)for(var na=0;na<this.WC.lUa.length;na++)K[na]=this.WC.lUa[na]in this.Slb&&this.Qug(this.Slb[this.WC.lUa[na]]);return K};ha.prototype.q8i=function(){for(var K=Array(this.WC.mUa.length),na=!(void 0===this.mQc||null===this.mQc),Xa=0;Xa<this.WC.mUa.length;Xa++){var Qb=this.WC.mUa[Xa];K[Xa]=
na&&Qb in this.mQc?!0:this.uvg(Qb)}return K};ha.prototype.z3h=function(){for(var K=this.p8i(),na=Array(K.length),Xa=0;Xa<K.length;Xa++)na[Xa]=K[Xa]?this.sEh(this.Slb[this.WC.lUa[Xa]]):null;return na};ha.prototype.sEh=function(K){if(void 0===K||null===K)return null;K=K.enabledPlugin;return void 0===K||null===K?null:K.name};ha.prototype.U_h=function(){for(var K=this.z3h(),na=this.q8i(),Xa={},Qb={},tc=0;tc<this.WC.lUa.length;tc++)Xa[this.WC.lUa[tc]]=K[tc];for(K=0;K<this.WC.mUa.length;K++)Qb[this.WC.mUa[K]]=
na[K];return new qa(Xa,Qb)};ha.prototype.gEj=function(){return this.Dvg||!this.WC.isEnabled||be.AFrameworkApplication.isUnifiedHostMode?!1:this.qMj()};ha.prototype.Izc=function(){if(null!=this.iZb)return this.iZb;var K=ha.dhf(this.WC);return this.iZb=this.WC.ehf&&K||this.eli()};ha.prototype.eli=function(){return Yf.a.yp&&this.WC.fli&&Yf.a.iCe>=this.WC.K0g?!0:!1};ha.prototype.qMj=function(){if(!this.vvg(this.WC))return!1;var K=ih.a.Qkd(this.GRc.value.Rag);K=Cl(K);for(var na=K.next();!na.done;na=K.next())if(na=
na.value,void 0!==na&&null!==na)return!0;K=ih.a.Qkd(this.GRc.value.mUa);K=Cl(K);for(na=K.next();!na.done;na=K.next())if(na.value)return!0;return!1};ha.prototype.I$h=function(){var K=ih.a.Qkd(this.GRc.value.Rag);K=Cl(K);for(var na=K.next();!na.done;na=K.next())if(Ba.a.contains(this.WC.Uci,na.value))return!0;return!1};ha.prototype.p8f=function(K){var na=void 0===na?!1:na;var Xa=void 0===Xa?null:Xa;be.AFrameworkApplication.sa&&be.AFrameworkApplication.ha.ra("DirectPrintDialogAsStandardDialogIsEnabled")?
this.Kde(K,Xa):this.gEj()?this.nkh(K,this.I$h()&&!na,Xa):this.Kde(K,Xa)};ha.prototype.nkh=function(K,na,Xa){Xa=void 0===Xa?null:Xa;var Qb=this.JAg.Hc("UserAction","OpenDirectPrintDialog");this.TWa.dTh(K,na,Xa).nR();Qb.stop()};ha.ulf=function(K){try{return new ActiveXObject(K),!0}catch(na){ud.ULS.sendTraceTag(4535642,328,100,"Failed to instantiate {0} as an ActiveX control.",K)}return!1};ha.fhf=function(K){return void 0===K||null===K?!1:!(void 0===K.enabledPlugin||null===K.enabledPlugin)};ha.create=
function(K){var na=new Aa(be.AFrameworkApplication.ha.appSettings),Xa=null;try{Xa=window.navigator.mimeTypes}catch(Kf){ud.ULS.sendTraceTag(573923532,328,15,"Failed to get Window.Navigator.mimeTypes")}var Qb=null;try{Qb=window.navigator.plugins}catch(Kf){ud.ULS.sendTraceTag(573923533,328,15,"Failed to get Window.Navigator.plugins")}var tc=ha.fhf,md=ha.ulf;K=K.resolve("Common.App.DirectPrint.DirectPrintDialogFactory");var Dd=be.AFrameworkApplication.sa.gE,ue=ha.vlf,Ce=!!be.AFrameworkApplication.sa&&
be.AFrameworkApplication.sa.Qa.Tw&&!be.AFrameworkApplication.ha.ra("PrintDialogFallbackLinkEnabled");return new ha(na,Xa,Qb,tc,md,K,Dd,ue,function(Kf,Wg){return new Fa(Kf,!1,Wg,!0,Ce)},be.AFrameworkApplication.uNa)};ha.vlf=function(K){return Yf.a.yp||Yf.a.uf&&K.poi||K.ehf&&ha.dhf(K)?!0:!1};ha.dhf=function(K){var na=Yf.a.yub;if(na){var Xa=na.split(".");if(2===Xa.length)return na=parseInt(Xa[0]),Xa=parseInt(Xa[1]),na>K.Jzd||na===K.Jzd&&Xa>=K.tuf}return!1};uk.Object.defineProperties(ha.prototype,{WC:{configurable:!0,
enumerable:!0,get:function(){return this.Frg}}});Object(Sd.a)(ha,"DirectPrintManager",null,[673]);da.prototype.hi=function(K){var na=this;this.tb=K;K.register(ab,"Common.App.DirectPrint.DirectPrintDialogFactory").Ic().Nc(function(){return new ab(be.AFrameworkApplication.sa.gY)});K.register(673,"Common.App.DirectPrint.IDirectPrintManager").Ic().Nc(function(){return ha.create(na.tb)})};da.prototype.init=function(){this.C8d=this.tb.resolve("Common.App.DirectPrint.IDirectPrintManager");this.C8d.start()};
da.prototype.dispose=function(){};uk.Object.defineProperties(da.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.DirectPrint"}}});Object(Sd.a)(da,"PackageManager",null,[4,5]);var Vi=b(636),Oi=Ck.a;Am(ka,Oi);ka.prototype.setFocus=function(){this.Aw.checked?Pe.DOMElementExtensions.setFocus(this.Aw):Pe.DOMElementExtensions.setFocus(this.getButton(0).get_element())};uk.Object.defineProperties(ka.prototype,{Xd:{configurable:!0,enumerable:!0,get:function(){return this.MSb}}});
ka.h7b="printCurrentSelection";Object(Sd.a)(ka,"BasePrintDialog",Ck.a,[]);var Cj=b(234);Am(aa,ka);aa.prototype.initialize=function(){ud.ULS.sendTraceTag(537154316,0,50,"HtmlPrintDialog:Initialize - Preparing dialog for HTML Legacy print");this.Cfi();this.TZa(1175);this.addButton(1);ka.prototype.initialize.call(this)};aa.prototype.pia=function(){var K=this;return function(na,Xa,Qb){var tc=K.$.na.ta,md=K.Sm;na=K.mka(na);Xa=K.xba(Xa);var Dd=K.Xd,ue=tc.Ma(1,null);ue.printOptions=md;return Rd.i(tc,"ValidatePrint",
ue,na,Xa,Qb,Dd,0)}};aa.prototype.commit=function(){this.m4g();return!0};aa.prototype.Fy=function(K,na,Xa){var Qb,tc=K.Result;if(tc&&na){var md=0,Dd=0;(null===(Qb=tc.SelectedRanges)||void 0===Qb?0:Qb.Ranges)&&0<tc.SelectedRanges.Ranges.length&&tc.SelectedRanges.Ranges[0]&&(md=Math.min(aa.A5f(tc.SelectedRanges.Ranges[0]),65535));tc.UsedRange&&(Dd=Math.min(aa.A5f(ff.j(ff.D(tc.UsedRange))),65535));Cj.h(na,md);Cj.i(na,Dd)}this.Sm=tc;ka.prototype.Fy.call(this,K,na,Xa)};aa.prototype.setFocus=function(){this.Qub.checked?
Pe.DOMElementExtensions.setFocus(this.Qub):ka.prototype.setFocus.call(this)};aa.prototype.Cfi=function(){this.Rb.innerHTML=aa.i5i(this.$.ea.isNamedObjectViewMode);this.Aw=Pe.DOMElementExtensions.getElementById(this.Rb,ka.h7b);this.Qub=Pe.DOMElementExtensions.getElementById(this.Rb,"printEntireItem");0!==this.Sm.Type&&this.Sm.UseSelection?(this.Aw.checked=!0,this.Qub.disabled=!this.Sm.SheetName):(this.Qub.checked=!0,this.Aw.disabled=0===this.Sm.Type||!Og.g(this.$).ga.va.Wg)};aa.prototype.m4g=function(){ud.ULS.sendTraceTag(51499290,
0,50,"HtmlPrintDialog:CommitWithGenerateHtml - CommitWithGenerateHtml called");var K=new Sys.StringBuilder;this.JMh(K);var na=String.format("location=0,scrollbars=1,resizable=1,menubar=1,toolbar={0},status=0",Yf.a.Hf?0:1);Ug.HelperMethods.wf(K.toString(),"",na,"PrintDialog.PrintViewUrl")||ud.ULS.sendTraceTag(51499291,0,10,"HtmlPrintDialog:CommitWithGenerateHtml - A browser blocked the xlprintview.aspx page!")};aa.prototype.JMh=function(K){var na=this.$.ya;K.append(this.$.Bea+na.LayoutsRelativeUri+
"/xlprintview.aspx?");Jh.a.ag(K,M.a.L7i,this.Sm.SessionId);Jh.a.ag(K,M.a.N7i,this.Aw.checked?"1":"0");if(0===this.Sm.Type)Jh.a.ag(K,M.a.I7i,this.Sm.ObjectId);else{if(!this.Sm.UsedRangeTooBig){var Xa=ff.D(this.Sm.UsedRange);(Xa=ff.x(Xa,this.Sm.SheetName))&&Jh.a.ag(K,M.a.O7i,Xa)}1===this.Sm.Type?Jh.a.ag(K,M.a.J7i,this.Sm.ObjectId):(Xa=ff.B(this.Sm.SelectedRanges.Ranges[0]),Xa=ff.x(Xa,this.Sm.SheetName),Jh.a.ag(K,M.a.K7i,Xa))}Ui.a.lHa(K,na);Jh.a.ag(K,M.a.M7i,this.Sm.Title)};aa.i5i=function(K){return String.format("<div class='"+
Yj.a.wo+"'>{0}</div>\r\n\t<div class='"+Yj.a.Vad+"'>\r\n\t\t<input type='radio' id='{1}' name='print' /> <label for='{1}'>{2}</label><br />\r\n\t\t<input type='radio' id='{3}' name='print' /> <label for='{3}'>{4}</label>\r\n\t</div>\r\n</div>",Tc.a.instance.fa(1176),ka.h7b,Tc.a.instance.fa(1179),"printEntireItem",K?Tc.a.instance.fa(1178):Tc.a.instance.fa(1177))};aa.A5f=function(K){return(K.LastColumn-K.FirstColumn+1)*(K.LastRow-K.FirstRow+1)};uk.Object.defineProperties(aa.prototype,{Cc:{configurable:!0,
enumerable:!0,get:function(){return"HtmlPrintDialog"}}});Object(Sd.a)(aa,"HtmlPrintDialog",ka,[]);var Fi=b(616),xh=b(64),Ch=b(1255),Bi=b(979),Ni=b(304),ii=b(1084),xi=b(937);J.prototype.getSheetName=function(){return this.sheetName};J.prototype.getPrintSettings=function(){return this.printSettings};Object(Sd.a)(J,"MacroRecorderSheetPrintSettingsSavedPayload",null,[428]);Am(P,ka);P.prototype.initialize=function(){this.q8&&Te.EwaSettings.isChangeGateEnabled("OfficeVSO:4879681_PrintAreaCheckboxKeyboardFocus")&&
P.tah(this.Rb);this.Pe?this.iFe(990,null):(this.ll(),this.TZa(990));ka.prototype.initialize.call(this)};P.prototype.dispose=function(){this.PTj();ka.prototype.dispose.call(this)};P.prototype.close=function(K){ud.ULS.sendTraceTag(591196544,0,50,"PdfPrintDialog.Close: User changed printSettings {0} times before exiting dialog {1} printing done",this.M0,0===K?"with":"without");this.vpj();if(this.Ns){var na=this.fSh();!this.$Vd&&!this.Xaa.checked&&this.$.isEditMode&&this.Amd(na)&&this.mpj(na)}ka.prototype.close.call(this,
K)};P.prototype.pia=function(){var K=this;return function(na,Xa,Qb){return ia(K.$.na.ta,K.$.xa.oa.name,K.locale,K.mka(na),K.xba(Xa),Qb,null)}};P.prototype.Fy=function(K,na,Xa){this.Ns=K.Result;this.KKb=this.Ns.ScalingWidth;this.JKb=this.Ns.ScalingHeight;this.ced();this.kfi();ka.prototype.Fy.call(this,K,na,Xa)};P.prototype.ll=function(){ud.ULS.sendTraceTag(537154315,0,50,"PdfPrintDialog:InitializeDialogElements - Preparing dialog for Print Pdf");this.Dfi();ka.prototype.ll.call(this)};P.prototype.commit=
function(){this.l4g();return!0};P.prototype.setFocus=function(){this.Pe?dj.a.bDc(this.Hda):this.Hda.checked?Pe.DOMElementExtensions.setFocus(this.Hda):ka.prototype.setFocus.call(this)};P.prototype.Vgi=function(){switch(this.OO.Wv){case 1:this.Hda.checked=!0;break;case 0:this.Aw.disabled?this.Hda.checked=!0:this.Aw.checked=!0;break;case 2:this.Xaa.checked=!0;break;default:ud.ULS.sendTraceTag(537154314,0,10,"Invalid what to print state {0}. Resetting to defaults.",this.OO.Wv),this.OO.Wv=1,this.Hda.checked=
!0}};P.prototype.vpj=function(){this.OO.Wv=this.g1c();this.q8&&(this.OO.ignorePrintArea=this.R6a.checked)};P.prototype.ced=function(){if(100!==this.Ns.ScalingPercent||this.Ns.FitToPage&&(1<this.Ns.ScalingWidth||1<this.Ns.ScalingHeight))this.$Vd=!0,this.Ns.ScalingWidth=P.N8c,this.Ns.ScalingHeight=P.M8c,this.Ns.ScalingPercent=P.I7b,this.Ns.FitToPage=P.G8c;this.Ns.PaperSize.toString()in this.hGd||(this.$Vd=!0,this.Ns.PaperSize=this.Ns.PaperSize===P.ARg?34:P.Gtb)};P.prototype.kfi=function(){this.wAa=
this.Ns.IsLandscape?2:1;this.L0=this.Ns.FitToPage?1===this.Ns.ScalingWidth&&1===this.Ns.ScalingHeight?1:this.Ns.ScalingWidth||1!==this.Ns.ScalingHeight?2:3:0;this.Jna=this.Ns.PaperSize;this.P$c(this.Xaa.checked?!0:!1);this.FRd(this.Xaa.checked?!0:!1)};P.prototype.Rfi=function(){this.ygc.disabled=this.Aw.checked;this.UHb=this.R6a.checked=this.OO.ignorePrintArea};P.prototype.Wch=function(K){this.nBa=document.createElement("select");this.nBa.style.width=224+xh.a.mf;this.nBa.style.height=32+xh.a.mf;this.nBa.setAttribute(M.a.YE,
"scalingElementId");this.mBa=new xi.a(this.nBa,!0);for(var na=0,Xa=P.scalingOptions.length;na<Xa;++na){var Qb=Tc.a.instance.fa(P.Wpj[na]);this.mBa.XM(Qb,P.scalingOptions[na].toString(),!1)}K.appendChild(this.nBa)};P.prototype.rIe=function(K){this.gAa=document.createElement("select");this.gAa.style.width=224+xh.a.mf;this.gAa.style.height=32+xh.a.mf;this.gAa.setAttribute(M.a.YE,"paperSizeElementId");this.fAa=new xi.a(this.gAa,!0);for(var na=0,Xa=P.paperSizeOptions.length;na<Xa;++na){var Qb=Tc.a.instance.fa(P.V0i[na]);
this.fAa.XM(Qb,P.paperSizeOptions[na].toString(),!1)}K.appendChild(this.gAa)};P.prototype.fSh=function(){var K={};K.IsLandscape=2===this.wAa;K.PaperSize=this.Jna;K.ScalingWidth=this.KKb;K.ScalingHeight=this.JKb;K.ScalingPercent=100;K.FitToPage=0===this.L0?!1:!0;return K};P.prototype.JIa=function(){var K=new Sys.StringBuilder;K.append(ii.a(this.$,"Pdf",!0));this.pja.Izc()&&Jh.a.ag(K,qg.a.Nig,"1");Jh.a.ag(K,qg.a.jJd,""+this.t7);Jh.a.ag(K,qg.a.yOf,this.$.xa.oa.name);0===this.t7&&(Jh.a.ag(K,qg.a.xOf,
this.selectedRange),Jh.a.ag(K,qg.a.rOf,this.activeCell));Jh.a.ag(K,qg.a.sOf,""+this.wAa);Jh.a.ag(K,qg.a.tOf,""+this.Jna);Jh.a.ag(K,qg.a.wOf,""+this.L0);Jh.a.ag(K,qg.a.vOf,"1");Jh.a.ag(K,qg.a.qOf,this.UHb?"1":"0");Jh.a.ag(K,qg.a.uOf,"1");ud.ULS.sendTraceTag(51499296,0,50,"PdfPrintDialog: Print Pdf Url {0}",K.toString());return K.toString()};P.prototype.$zb=function(){var K=this,na=null;ud.ULS.sendTraceTag(537154313,0,50,"PdfPrintDialog:InvokeGetFileCopyFileHandler - Invoking GetFileCopyFileHandler");
this.$.userOperationManager.jc(new Oc.a(223,0,function(Xa,Qb,tc){Xa=new Ni.a(Xa,null,Qb,tc,null,!0,!1,"GetFileCopyFileHandler","");Xa.correlationID=ri.a.create().toString();na=Xa;be.AFrameworkApplication.Ld.y$(K.JIa(),1,null,null,P.sdd,!1,2,K.sDd,K.rDd,na,void 0,void 0,void 0,12E4);return Kg.Task.Sa(!0)},16),null)};P.prototype.Dfi=function(){ud.ULS.sendTraceTag(537154312,0,50,"PdfPrintDialog:InitializeForPrintPdf - Preparing full print pdf dialog");this.h5i(this.Rb);this.P$c(!0);this.FRd(!0);this.Aw=
Pe.DOMElementExtensions.getElementById(this.Rb,ka.h7b);this.Hda=Pe.DOMElementExtensions.getElementById(this.Rb,"printActiveSheet");this.Xaa=Pe.DOMElementExtensions.getElementById(this.Rb,"printEntireWorkbook");this.q8&&(this.ygc=Pe.DOMElementExtensions.getElementById(this.Rb,"ignorePrintAreaCheckboxButtonId"),this.R6a=new Bi.a(this.ygc));this.kzc()&&(this.Aw.disabled=!0,this.Sm.SheetName=this.sheetName);this.Vgi();this.q8&&this.Rfi();this.Tcj()};P.prototype.kzc=function(){return!!this.Sm.ObjectId||
!Og.g(this.$).ga.va.Wg};P.prototype.Tcj=function(){Fi.a.instance.qa(Bf.a.change,this.Hda,this.N$a);Fi.a.instance.qa(Bf.a.change,this.Xaa,this.N$a);Fi.a.instance.qa(Bf.a.change,this.Aw,this.N$a);Fi.a.instance.qa(Bf.a.change,this.Bya,this.Qoc);Fi.a.instance.qa(Bf.a.change,this.nbb,this.Qoc);Fi.a.instance.qa(Bf.a.change,this.gAa,this.fzf);Fi.a.instance.qa(Bf.a.change,this.nBa,this.gzf);this.q8&&this.R6a.apb(this.ezf)};P.prototype.PTj=function(){Fi.a.instance.za(Bf.a.change,this.Hda,this.N$a);Fi.a.instance.za(Bf.a.change,
this.Xaa,this.N$a);Fi.a.instance.za(Bf.a.change,this.Aw,this.N$a);Fi.a.instance.za(Bf.a.change,this.Bya,this.Qoc);Fi.a.instance.za(Bf.a.change,this.nbb,this.Qoc);Fi.a.instance.za(Bf.a.change,this.gAa,this.fzf);Fi.a.instance.za(Bf.a.change,this.nBa,this.gzf);this.q8&&this.R6a.$da(this.ezf)};P.prototype.h5i=function(K){K.classList.add(Ch.a.h6i);if(!this.Pe){document.getElementById("ewaDialogTitle").classList.add(Ch.a.printDialogTitle);var na=document.getElementById("ewaDialogCloseButtonLink");na.style.top=
32+xh.a.mf;this.rtl?na.style.left=32+xh.a.mf:na.style.right=32+xh.a.mf}na=P.Az(Ch.a.i6i);K.appendChild(na);var Xa=P.Az(Ch.a.Fbb,1183);Xa.style.marginBottom=12+xh.a.mf;Xa.id="whatToPrintTitleElementId";na.appendChild(Xa);Xa=P.Az(Ch.a.Ebb);na.appendChild(Xa);P.atb(Xa,this.rtl,"printActiveSheet",1187,"whatToPrintRbName","PrintWhatExcelActiveSheets_32x32x32","activeSheetRadioButtonInnerLabelElementId","whatToPrintTitleElementId");na.appendChild(document.createElement("BR"));Xa=P.Az(Ch.a.Ebb);na.appendChild(Xa);
P.atb(Xa,this.rtl,"printEntireWorkbook",1180,"whatToPrintRbName","PrintWhatExcelEntireWorkbook_32x32x32","entireWorkbookRadioButtonInnerLabelElementId","whatToPrintTitleElementId");na.appendChild(document.createElement("BR"));Xa=P.Az(Ch.a.Ebb);na.appendChild(Xa);P.atb(Xa,this.rtl,ka.h7b,1179,"whatToPrintRbName","PrintWhatExcelSelection_32x32x32","currentSelectionRadioButtonInnerLabelElementId","whatToPrintTitleElementId");this.q8?(Xa=P.Az(Ch.a.Fbb,1212),Xa.style.marginTop=24+xh.a.mf,Xa.id="printAreaElementId",
na.appendChild(Xa),Te.EwaSettings.isChangeGateEnabled("OfficeVSO:4879681_PrintAreaCheckboxKeyboardFocus")?(Xa.style.marginBottom=12+xh.a.mf,Xa=P.Az(Yj.a.Wad),Xa.id="ignorePrintAreaCheckboxWarpperId",Pe.DOMElementExtensions.setVisible(Xa,!0),na.appendChild(Xa),na=this.getElementById("ignorePrintAreaCheckboxButtonId"),Pe.DOMElementExtensions.setVisible(na,!0),Xa.appendChild(na),na=this.getElementById("ignorePrintAreaCheckboxLabelId"),Pe.DOMElementExtensions.setVisible(na,!0),Xa.appendChild(na)):(Xa=
P.Az(Ch.a.Ebb),na.appendChild(Xa),P.k9g(Xa,this.rtl))):(Xa=P.Az(Ch.a.Fbb,1185),Xa.style.marginTop=24+xh.a.mf,Xa.id="paperSizeElementId",na.appendChild(Xa),Xa=P.Az(Ch.a.tId),this.rIe(Xa),na.appendChild(Xa));na=P.Az(Ch.a.j6i);K.appendChild(na);K=P.Az(Ch.a.Fbb,1184);K.style.marginBottom=12+xh.a.mf;K.id="orientationTitleElementId";na.appendChild(K);K=P.Az(Ch.a.Ebb);na.appendChild(K);P.atb(K,this.rtl,"portraitRadioButtonId",1190,"orientationRbName","Portrait_32x32x32","portraitRadioButtonInnerLabelElementId",
"orientationTitleElementId");na.appendChild(document.createElement("BR"));K=P.Az(Ch.a.Ebb);na.appendChild(K);P.atb(K,this.rtl,"landscapeRadioButtonId",1189,"orientationRbName","Landscape_32x32x32","landscapeRadioButtonInnerLabelElementId","orientationTitleElementId");this.q8&&(K=P.Az(Ch.a.Fbb,1185),K.style.marginTop=12+xh.a.mf,K.id="paperSizeElementId",na.appendChild(K),K=P.Az(Ch.a.tId),this.rIe(K),na.appendChild(K));K=P.Az(Ch.a.Fbb,1186);K.style.marginTop=(this.q8?10:74)+xh.a.mf;K.id="scalingElementId";
na.appendChild(K);K=P.Az(Ch.a.tId);this.Wch(K);na.appendChild(K);this.Pe||document.getElementById("buttonarea").classList.add(Ch.a.g6i);this.Bya=Pe.DOMElementExtensions.getElementById(this.Rb,"landscapeRadioButtonId");this.nbb=Pe.DOMElementExtensions.getElementById(this.Rb,"portraitRadioButtonId")};P.prototype.l4g=function(){var K=this;ud.ULS.sendTraceTag(51499294,0,50,"PdfPrintDialog:CommitWithConvertPdf - CommitWithConvertPdf called");this.t7=this.g1c();2!==this.t7&&(this.wAa=this.Cze(),this.fAa&&
(this.Jna=P.paperSizeOptions[this.fAa.selectedIndex]),this.mBa&&(this.L0=P.scalingOptions[this.mBa.selectedIndex]));if(this.$.Pxa&&Te.EwaSettings.isChangeGateEnabled("OfficeVSO:4445349_DisablePrintLatencyImprovementForCrossDomain")){var na=this.$.na.ta.fc();this.$.userOperationManager.jc(new Oc.a(133,0,function(Xa,Qb,tc){var md={};md.WhatToPrint=K.t7;md.UseNamedAction=K.pja.Izc();md.SelectedSheetName=K.$.xa.oa.name;md.ActiveCell=K.activeCell;md.SelectedRanges=[K.selectedRange];md.IsPdfDocumentRequired=
!1;md.Orientation=K.wAa;md.PaperSize=K.Jna;md.Scaling=K.L0;md.RichValuesEnabled=!0;K.q8&&(md.IgnorePrintArea=K.UHb);return ba(K.$.na.ta,md,nh.b(K.qFb,Xa),Qb,tc,na)},16),null)}else this.$zb()};P.prototype.P$c=function(K){this.nbb.disabled=K;this.Bya.disabled=K;this.fAa.ao.disabled=K;this.mBa.ao.disabled=K};P.prototype.FRd=function(K){K?(this.Bya.checked=!1,this.nbb.checked=!1,this.fAa.selectedIndex=-1,this.mBa.selectedIndex=-1):(2===this.wAa?this.Bya.checked=!0:this.nbb.checked=!0,this.fAa.selectedIndex=
this.hGd[this.Jna.toString()],this.mBa.selectedIndex=this.L0)};P.prototype.mpj=function(K){var na=this;ud.ULS.sendTraceTag(537154310,0,50,"PdfPrintDialog:SavePrintSettingsToFile - We should make a set SheetPrintSettings call here to set print Settings.");var Xa=this.$.xa.oa.name,Qb=this.$.na.ta.fc();this.$.userOperationManager.jc(new Oc.a(226,0,function(tc,md,Dd){return ra(na.$.na.ta,Xa,K,tc,md,Dd,Qb)},void 0,function(){return new J(Xa,K)}),null)};P.prototype.Amd=function(K){return this.Ns.IsLandscape!==
K.IsLandscape||this.Ns.PaperSize!==K.PaperSize||this.Ns.FitToPage!==K.FitToPage||this.Ns.ScalingHeight!==K.ScalingHeight||this.Ns.ScalingWidth!==K.ScalingWidth?!0:!1};P.prototype.Cze=function(){return this.Bya&&this.Bya.checked?2:1};P.prototype.g1c=function(){return this.Aw.checked?0:this.Hda.checked?1:this.Xaa.checked?2:1};P.Az=function(K,na){K=void 0===K?null:K;na=void 0===na?0:na;var Xa=document.createElement("div");K&&(Xa.className=K);0!==na&&(Xa.innerHTML=Tc.a.instance.fa(na));return Xa};P.tah=
function(K){var na=document.createElement("input");na.setAttribute("type","checkbox");na.className=Yj.a.JQe;na.id="ignorePrintAreaCheckboxButtonId";na.setAttribute("name","ignorePrintAreaCbName");na.style.height=16+xh.a.mf;na.style.width=16+xh.a.mf;Pe.DOMElementExtensions.setVisible(na,!1);var Xa=Tc.a.instance.fa(1212),Qb=Tc.a.instance.fa(1213);na.setAttribute(M.a.Zt,Xa+xh.a.space+Qb);K.appendChild(na);na=document.createElement("label");na.setAttribute("for","ignorePrintAreaCheckboxButtonId");na.id=
"ignorePrintAreaCheckboxLabelId";na.innerHTML=Qb;na.setAttribute(M.a.AQ,"true");na.style.position="relative";na.style.marginLeft=15+xh.a.mf;Pe.DOMElementExtensions.setVisible(na,!1);K.appendChild(na)};P.k9g=function(K,na){var Xa=document.createElement("input");Xa.setAttribute("type","checkbox");Xa.id="ignorePrintAreaCheckboxButtonId";Xa.setAttribute("name","ignorePrintAreaCbName");Xa.setAttribute(M.a.YE,"printAreaElementId"+xh.a.space+"ignorePrintAreaCheckboxButtonInnerLabelElementId");Xa.style.height=
16+xh.a.mf;Xa.style.width=16+xh.a.mf;na?Xa.style.marginRight=0+xh.a.mf:Xa.style.marginLeft=0+xh.a.mf;K.appendChild(Xa);na=document.createElement("label");na.setAttribute("for","ignorePrintAreaCheckboxButtonId");na.setAttribute(M.a.AQ,"true");na.style.position="relative";na.style.marginLeft=15+xh.a.mf;K.appendChild(na);K=P.Az(Ch.a.hNf,1213);K.id="ignorePrintAreaCheckboxButtonInnerLabelElementId";na.appendChild(K)};P.atb=function(K,na,Xa,Qb,tc,md,Dd,ue){var Ce=document.createElement("input");Ce.setAttribute("type",
"radio");Ce.id=Xa;Ce.setAttribute("name",tc);Ce.setAttribute(M.a.YE,ue+xh.a.space+Dd);Ce.style.height=16+xh.a.mf;Ce.style.width=16+xh.a.mf;na?Ce.style.marginRight=0+xh.a.mf:Ce.style.marginLeft=0+xh.a.mf;K.appendChild(Ce);na=document.createElement("label");na.setAttribute("for",Xa);na.style.position="relative";K.appendChild(na);K=kg.createClusteredImage(32,32,md,Ch.a.p6i,!0,Tc.a.instance.fa(Qb));Qb=P.Az(Ch.a.hNf,Qb);Qb.id=Dd;Qb.setAttribute(M.a.AQ,"true");Dd=P.Az(Ch.a.o6i);Dd.appendChild(Qb);na.appendChild(Dd);
na.appendChild(K)};uk.Object.defineProperties(P.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"PdfPrintDialog"}}});P.N8c=1;P.M8c=0;P.I7b=100;P.Gtb=9;P.G8c=!0;P.ARg=13;P.paperSizeOptions=[1,5,6,7,8,9,11,12,3,20,27,28,34,37,43,14];P.V0i=[1192,1193,1200,1194,1195,1196,1197,1198,1191,1201,1202,1203,1204,1205,1206,1207];P.scalingOptions=[0,1,2,3];P.Wpj=[1208,1209,1210,1211];P.sdd=["Content-Type"];Object(Sd.a)(P,"PdfPrintDialog",ka,[]);uk.Object.defineProperties(I.prototype,{Wv:{configurable:!0,
enumerable:!0,get:function(){return this.t7},set:function(K){0<=K&&2>=K?this.t7=K:(ud.ULS.sendTraceTag(537154308,0,10,"Attempt to set invalid state. Setting ActiveSheets instead."),this.t7=1)}},ignorePrintArea:{configurable:!0,enumerable:!0,get:function(){return this.Bae},set:function(K){K||!K?this.Bae=K:ud.ULS.sendTraceTag(537154307,0,10,"Attempt to set invalid ignorePrintArea")}}});Object(Sd.a)(I,"PdfPrintDialogBrowserSessionState",null,[]);var Vj=b(1434);Object(Sd.a)(S,"MacroRecorderPrintAreaSetPayload",
null,[428]);Object(Sd.a)(Z,"MacroRecorderPageBreakInsertedPayload",null,[428]);Object(Sd.a)(ea,"MacroRecorderPageBreakRemovedPayload",null,[428]);O.prototype.getSheetName=function(){return this.sheetName};Object(Sd.a)(O,"MacroRecorderPageBreaksAllResetPayload",null,[428]);Q.prototype.getSheetName=function(){return this.sheetName};Object(Sd.a)(Q,"MacroRecorderPrintAreaClearedPayload",null,[428]);var qh=b(167),oj=b(291);Object(Sd.a)(U,"PageBreaksInformation",null,[]);Object(Sd.a)(H,"RowColBreak",null,
[]);Object(Sd.a)(C,"SharedRange",null,[]);var Ij=b(128);E.prototype.executeCommand=function(K,na,Xa,Qb,tc,md,Dd){tc=void 0===tc?null:tc;md=void 0===md?null:md;Dd=void 0===Dd?null:Dd;this.YZd();this.ribbonCommandInfo=na;this.TJj(na.command);K=nh.b(tc,this.FRj);ud.ULS.sendTraceTag(543794888,0,50,"PrintCommandHandler.ExecuteCommand: {0} command execution started",na.command);switch(na.command){case 78661008:return this.D$e(na,K,md,Dd,!1);case 275604654:return this.D$e(na,K,md,Dd,!0);case -13332329:return this.C9e(na,
K,md,Dd);case -837651977:return this.D8h(na,K,md,Dd);case -1778266776:return this.u9h(na,K,md,Dd);case 845325699:return this.y$e(na,K,md,Dd)}return k.a(na.command)};E.prototype.Mc=function(K,na){switch(na.command){case 78661008:case 275604654:case -837651977:case -1778266776:return 1===K;case 845325699:case -13332329:return!0}return!1};E.prototype.W3f=function(K,na,Xa){var Qb=Og.g(this.$),tc=Qb.Da,md=ff.r(Qb.ga.va.selectedRanges,this.$);if((tc=tc.KF())&&tc.length){tc=Cl(tc);for(var Dd=tc.next();!Dd.done;Dd=
tc.next()){Dd=Dd.value;var ue=Dd.Gf;if(ue){for(var Ce=ff.j(Dd.yf),Kf=[],Wg=Cl(md.Ranges),Dh=Wg.next();!Dh.done;Dh=Wg.next()){var Ci=Dh.value;Ci.FirstRow>Ce.LastRow+1||Ci.LastRow<Ce.FirstRow||Ci.FirstColumn>Ce.LastColumn+1||Ci.LastColumn<Ce.FirstColumn||(Dh=this.J_h(Ce,Ci,ue),Ci=this.I_h(Ce,Ci,ue),Kf.push(Object.assign(new C,{FirstRow:Dh.FirstRow,FirstColumn:Ci.FirstColumn,LastRow:Dh.LastRow,LastColumn:Ci.LastColumn})))}0<Kf.length&&!Xa?ue.setPrintArea(Kf):0<Kf.length&&Xa?ue.addToPrintArea(Kf):!Xa&&
ue.hasPrintArea()&&ue.clearPrintArea();!ue.isDirty()&&ue.hasPageLayout()&&ue.setDirty("PrintAreaBreakManager::SetPrintAreaInstantaneous, hash: "+Dd.Zd,4)}}this.cPb(Qb,K,na)}};E.prototype.G1g=function(K,na){var Xa=Og.g(this.$),Qb=Og.g(this.$).Da.KF();if(Qb&&Qb.length){Qb=Cl(Qb);for(var tc=Qb.next();!tc.done;tc=Qb.next()){tc=tc.value;var md=tc.Gf;md&&(md.clearPrintArea(),!md.isDirty()&&md.hasPageLayout()&&md.setDirty("PrintAreaBreakManager::ClearPrintAreaInstantaneous, hash: "+tc.Zd,4))}this.cPb(Xa,
K,na)}};E.prototype.Dhi=function(K,na){var Xa=Og.g(this.$),Qb=Xa.Da,tc=ff.o(Xa.ga.va.activeCell,this.$);if(tc){var md=Qb.KF();if(md&&md.length){Qb=null;for(var Dd=Cl(md),ue=Dd.next();!ue.done;ue=Dd.next()){ue=ue.value;var Ce=ue.Gf;if(Ce){var Kf=ff.j(ue.yf);if(!(tc.FirstRow>Kf.LastRow||tc.FirstRow<Kf.FirstRow||tc.FirstColumn>Kf.LastColumn||tc.FirstColumn<Kf.FirstColumn)&&(Qb=this.Gbh(Ce,Kf,tc),Ce.insertPageBreak(Qb),!Ce.isDirty()&&Ce.hasPageLayout()&&Ce.setDirty("PrintAreaBreakManager::InsertPageBreakInstantaneous, hash: "+
ue.Zd,4),Qb))break}}if(!Qb)for(md=Cl(md),ue=md.next();!ue.done;ue=md.next())if(Qb=ue.value,Dd=Qb.Gf)Qb=ff.j(Qb.yf),Qb=this.qIe(Dd,Qb,tc),Dd.insertPageBreak(Qb);this.cPb(Xa,K,na)}}};E.prototype.jfj=function(K,na){var Xa=Og.g(this.$),Qb=Xa.Da,tc=ff.o(Xa.ga.va.activeCell,this.$);if(tc&&(Qb=Qb.KF())&&Qb.length){Qb=Cl(Qb);for(var md=Qb.next();!md.done;md=Qb.next()){md=md.value;var Dd=md.Gf;if(Dd){var ue=ff.j(md.yf);(ue=this.qIe(Dd,ue,tc))&&Dd.removePageBreak(ue);!Dd.isDirty()&&Dd.hasPageLayout()&&Dd.setDirty("PrintAreaBreakManager::RemovePageBreakInstantaneous, hash: "+
md.Zd,4)}}this.cPb(Xa,K,na)}};E.prototype.llj=function(K,na){var Xa=Og.g(this.$),Qb=Xa.Da.KF();if(Qb&&Qb.length){Qb=Cl(Qb);for(var tc=Qb.next();!tc.done;tc=Qb.next()){tc=tc.value;var md=tc.Gf;md&&(md.resetAllPageBreak(),!md.isDirty()&&md.hasPageLayout()&&md.setDirty("PrintAreaBreakManager::ResetAllPageBreakInstantaneous, hash: "+tc.Zd,4))}this.cPb(Xa,K,na)}};E.prototype.D$e=function(K,na,Xa,Qb,tc){if(!tc){var md=this.$.Ab.getItemByName("PRINT_AREA");if(md&&(ud.ULS.sendTraceTag(537154306,0,15,"PrintCommandHandler.HandleSetPrintAreaCommand: Print_Area already present as NamedObject of type : {0}",
md.type),2===md.type))return this.jji(),Kg.Task.Sa(!0)}md=Og.g(this.$).ga.va;var Dd=ff.r(md.selectedRanges,this.$);if(1===Dd.Ranges.length&&!tc){if(md.uca())return this.J9h(K,Dd,na,Xa,Qb,tc),Kg.Task.Sa(!0);if(ff.R(Dd.Ranges[0]))return this.$.xa.oa.hasPrintArea?this.C9e(K,na,Xa,Qb):Kg.Task.Sa(!0)}this.W3f(K.command,Qb,tc);return this.wff(K,na,Xa,Dd,tc)};E.prototype.C9e=function(K,na,Xa,Qb){this.G1g(K.command,Qb);return this.Vii(K,na,Xa)};E.prototype.D8h=function(K,na,Xa,Qb){this.Dhi(K.command,Qb);
return this.gji(K,na,Xa)};E.prototype.u9h=function(K,na,Xa,Qb){if(Te.EwaSettings.isChangeGateEnabled("OfficeVSO:4767450_ResetAllPageBreaksOnSelectAllAndRemovePageBreak")){var tc=ff.r(Og.g(this.$).ga.va.selectedRanges,this.$);if(ff.R(tc.Ranges[0]))return this.y$e(K,na,Xa,Qb)}this.jfj(K.command,Qb);return this.lji(K,na,Xa)};E.prototype.y$e=function(K,na,Xa,Qb){this.llj(K.command,Qb);return this.oji(K,na,Xa)};E.prototype.wff=function(K,na,Xa,Qb,tc){function md(){return new S(Qb,tc)}function Dd(Ce,Kf,
Wg){Ce=nh.b(Ce,na);Kf=nh.a(Kf,Xa);var Dh=ue.Ma(1,null);Dh.selectedRanges=Qb;Dh.addToPrintArea=tc;return Rd.i(ue,"SetPrintArea",Dh,Ce,Kf,Wg,null,0)}var ue=this.$.na.ta;return Te.EwaSettings.uc()?lc.a(this.$.userOperationManager,Dd,function(Ce){return new Oc.a(241,0,Ce,64,md)},K):lc.a(this.$.userOperationManager,Dd,function(Ce){return new Hj.a(241,0,Ce,void 0,md)},K)};E.prototype.Vii=function(K,na,Xa){function Qb(){return new Q(md)}function tc(ue,Ce,Kf){ue=nh.b(ue,na);Ce=nh.a(Ce,Xa);var Wg=Dd.Ma(1,
null);Wg.sheetName=md;return Rd.i(Dd,"ClearPrintArea",Wg,ue,Ce,Kf,null,0)}var md=this.$.xa.oa.name,Dd=this.$.na.ta;return Te.EwaSettings.uc()?lc.a(this.$.userOperationManager,tc,function(ue){return new Oc.a(243,0,ue,64,Qb)},K):lc.a(this.$.userOperationManager,tc,function(ue){return new Hj.a(243,0,ue,void 0,Qb)},K)};E.prototype.gji=function(K,na,Xa){function Qb(){return new Z(ue)}function tc(Ce,Kf,Wg){var Dh=md.$.na.ta;Ce=nh.b(Ce,na);Kf=nh.a(Kf,Xa);var Ci=Dh.Ma(9,null);Ci.sheetCell=ue;return Rd.i(Dh,
"InsertPageBreak",Ci,Ce,Kf,Wg,null,0)}var md=this,Dd=Og.g(this.$),ue=ff.o(Dd.ga.va.activeCell,this.$);return Te.EwaSettings.uc()?lc.a(this.$.userOperationManager,tc,function(Ce){return new Oc.a(244,0,Ce,64,Qb)},K):lc.a(this.$.userOperationManager,tc,function(Ce){return new Hj.a(244,0,Ce,void 0,Qb)},K)};E.prototype.lji=function(K,na,Xa){function Qb(){return new ea(ue)}function tc(Ce,Kf,Wg){var Dh=md.$.na.ta;Ce=nh.b(Ce,na);Kf=nh.a(Kf,Xa);var Ci=Dh.Ma(9,null);Ci.sheetCell=ue;return Rd.i(Dh,"RemovePageBreak",
Ci,Ce,Kf,Wg,null,0)}var md=this,Dd=Og.g(this.$),ue=ff.o(Dd.ga.va.activeCell,this.$);return Te.EwaSettings.uc()?lc.a(this.$.userOperationManager,tc,function(Ce){return new Oc.a(245,0,Ce,64,Qb)},K):lc.a(this.$.userOperationManager,tc,function(Ce){return new Hj.a(245,0,Ce,void 0,Qb)},K)};E.prototype.oji=function(K,na,Xa){function Qb(){return new O(Dd)}function tc(ue,Ce,Kf){var Wg=md.$.na.ta;ue=nh.b(ue,na);Ce=nh.a(Ce,Xa);var Dh=Wg.Ma(9,null);Dh.sheetName=Dd;return Rd.i(Wg,"ResetAllPageBreaks",Dh,ue,Ce,
Kf,null,0)}var md=this,Dd=this.$.xa.oa.name;return Te.EwaSettings.uc()?lc.a(this.$.userOperationManager,tc,function(ue){return new Oc.a(246,0,ue,64,Qb)},K):lc.a(this.$.userOperationManager,tc,function(ue){return new Hj.a(246,0,ue,void 0,Qb)},K)};E.prototype.J_h=function(K,na,Xa){if(!K||!na||!Xa)return null;var Qb=new C;Qb.FirstRow=na.FirstRow===K.LastRow+1?Xa.getRowIndex(K.LastRow+1)+1:na.FirstRow<K.FirstRow?0:Xa.getRowIndex(na.FirstRow+1);Qb.LastRow=na.FirstRow===K.LastRow+1||na.LastRow>K.LastRow?
Xa.getRowIndex(K.LastRow+1)+1:Xa.getRowIndex(na.LastRow+1);return Qb};E.prototype.I_h=function(K,na,Xa){if(!K||!na||!Xa)return null;var Qb=new C;Qb.FirstColumn=na.FirstColumn===K.LastColumn+1?Xa.getColumnIndex(K.LastColumn+1)+1:na.FirstColumn<K.FirstColumn?0:Xa.getColumnIndex(na.FirstColumn+1);Qb.LastColumn=na.FirstColumn===K.LastColumn+1||na.LastColumn>K.LastColumn?Xa.getColumnIndex(K.LastColumn+1)+1:Xa.getColumnIndex(na.LastColumn+1);return Qb};E.prototype.Gbh=function(K,na,Xa){if(!na||!Xa||!K)return null;
var Qb=K.getPrintArea();if(!Qb||!Qb.length)return null;var tc=K.getRowIndex(Xa.FirstRow+1),md=K.getColumnIndex(Xa.FirstColumn+1),Dd=null,ue=null;Qb=Cl(Qb);for(var Ce=Qb.next();!Ce.done;Ce=Qb.next())if(Ce=Ce.value,tc>=Ce.FirstRow&&tc<=Ce.LastRow&&md>=Ce.FirstColumn&&md<=Ce.LastColumn){if(Xa.FirstRow===Ce.FirstRow&&Xa.FirstColumn===Ce.FirstColumn)return new U;tc>Ce.FirstRow&&(Dd=Object.assign(new H,{Index:tc-1,Min:Ce.FirstColumn-1,Max:Math.min(Ce.LastColumn,K.getColumnIndex(na.LastColumn+1))}));md>
Ce.FirstColumn&&(ue=Object.assign(new H,{Index:md-1,Min:Ce.FirstRow-1,Max:Math.min(Ce.LastRow,K.getRowIndex(na.LastRow+1))}));break}return Dd||ue?Object.assign(new U,{Row:Dd?[Dd]:null,Col:ue?[ue]:null}):null};E.prototype.Sch=function(K,na,Xa){if(!na||!Xa||!K)return null;var Qb=null;Xa.FirstRow>na.FirstRow&&Xa.FirstRow<=na.LastRow?Qb=Object.assign(new H,{Index:K.getRowIndex(Xa.FirstRow+1)-1,Min:-1,Max:-1}):Xa.FirstRow===na.LastRow+1&&(Qb=Object.assign(new H,{Index:K.getRowIndex(na.LastRow+1),Min:-1,
Max:-1}));return Qb};E.prototype.q9g=function(K,na,Xa){if(!na||!Xa||!K)return null;var Qb=null;Xa.FirstColumn>na.FirstColumn&&Xa.FirstColumn<=na.LastColumn?Qb=Object.assign(new H,{Index:K.getColumnIndex(Xa.FirstColumn+1)-1,Min:-1,Max:-1}):Xa.FirstColumn===na.LastColumn+1&&(Qb=Object.assign(new H,{Index:K.getColumnIndex(na.LastColumn+1),Min:-1,Max:-1}));return Qb};E.prototype.qIe=function(K,na,Xa){if(!Xa||!K||!na)return null;var Qb=this.Sch(K,na,Xa);K=this.q9g(K,na,Xa);return Qb||K?Object.assign(new U,
{Row:Qb?[Qb]:null,Col:K?[K]:null}):null};E.prototype.jji=function(){var K=new Sh.StandardDialog;K.lc=0;K.Bc(1,Tc.a.instance.fa(4));K.Fk(Tc.a.instance.fa(562),Tc.a.instance.fa(563),1,null)};E.prototype.TJj=function(K){if(this.Uwa.xb(K)&&(Ug.HelperMethods.S_&&(this.NGb=this.$.Sb.Hc("UserAction","PrintAreaPageBreaksTimeStopwatch")),this.VLa.xb(K)&&this.VLa.remove(K),this.VLa.add(K,ri.a.create().toString()),Og.g(this.$).Ri)){var na=yi.b()?yi.b().yi(K):"";Og.g(this.$).Ri.t8(this.Uwa.pa(K),this.VLa.pa(K),
na)}};E.prototype.P_g=function(K){if(this.NGb&&K){var na=this.NGb.Gc;this.NGb.stop();this.NGb=null;switch(K){case "SetPrintArea":this.Frb(na,1700,K);break;case "ClearPrintArea":this.Frb(na,1500,K);break;case "InsertPageBreak":this.Frb(na,1500,K);break;case "RemovePageBreak":this.Frb(na,1600,K);break;case "ResetAllPageBreaks":this.Frb(na,1700,K)}}};E.prototype.Frb=function(K,na,Xa){K>na&&(na=Object.assign(new oj.a,{extendedProperties:new Map}),na.extendedProperties.set("OperationName",Xa),na.extendedProperties.set("OperationExecutionTime",
K.toString()),Pg.Health.instance.recordQosError(qh.a.FIj,[Ic.a.AIj],!1,!0,!0,!1,na))};E.prototype.J9h=function(K,na,Xa,Qb,tc,md){var Dd=this,ue=new Sh.StandardDialog,Ce=new Vj.a(Tc.a.instance.fa(560),Tc.a.instance.fa(561),Tc.a.instance.fa(6),Tc.a.instance.fa(5));ue.lc=1;ue.Bc(1,Ce.confirmButton);ue.Bc(0,Ce.cancelButton);ue.Fk(Ce.title,Ce.body,3,function(Kf){1===Kf&&(Dd.W3f(K.command,tc,md),Dd.wff(K,Xa,Qb,na,md))})};E.prototype.cPb=function(K,na,Xa){Xa();this.VLa.xb(na)&&K.Ri.D1(this.VLa.pa(na),Ik.BasicTelemetryCalculator.$R)};
E.prototype.YZd=function(){this.ctd&&this.$.ae(-1753588160,-1,0,null)};Object(Sd.a)(E,"PrintAreaBreakManager",null,[710]);var Tk=b(408);t.prototype.equals=function(K){return K?this.orientation===K.orientation&&this.rda===K.rda&&this.i1===K.i1&&this.margin===K.margin&&this.sheetPrintOptions===K.sheetPrintOptions&&this.$2a===K.$2a&&this.NoColor===K.NoColor:!1};t.rGe=function(K,na){K&&na&&(na.Wv=K.Wv,na.orientation=K.orientation,na.rda=K.rda,na.i1=K.i1,na.margin=K.margin,na.ignorePrintArea=K.ignorePrintArea,
na.sheetPrintOptions=K.sheetPrintOptions,na.$2a=K.$2a,na.NoColor=K.NoColor)};Object(Sd.a)(t,"PrintSettingsContainer",null,[]);var el=b(158),mj=b(356),Dj=b(1024),Rj=b(990),ui=b(736);Object(Sd.a)(A,"PrintSettingMarginOption",null,[]);Object(Sd.a)(v,"PrintSettingMarginValue",null,[]);Object(Sd.a)(y,"PrintSettingOption",null,[]);B.prototype.dispose=function(){};B.prototype.Gxb=function(K){if(!K)return null;var na=new v;na.left=K.Left;na.right=K.Right;na.top=K.Top;na.bottom=K.Bottom;na.header=K.Header;
na.footer=K.Footer;return na};B.prototype.R6c=function(K){ud.ULS.shipAssertTag(537154186,0,6===K.length,"PrintPreviewManager.CreatePageMargin: marginValue array passed in, doesn't contain 6 margin values");var na={};na.Top=K[0];na.Bottom=K[1];na.Left=K[2];na.Right=K[3];na.Header=K[4];na.Footer=K[5];return na};B.prototype.ngi=function(){this.rne=[Object.assign(new y,{printSettingOptionKey:1,printSettingOptionText:this.Xm.fa(1187)}),Object.assign(new y,{printSettingOptionKey:2,printSettingOptionText:this.Xm.fa(1180)}),
Object.assign(new y,{printSettingOptionKey:0,printSettingOptionText:this.Xm.fa(1179)})];this.Cge=[Object.assign(new y,{printSettingOptionKey:1,printSettingOptionText:this.Xm.fa(1190)}),Object.assign(new y,{printSettingOptionKey:2,printSettingOptionText:this.Xm.fa(1189)})];this.Tge=[Object.assign(new y,{printSettingOptionKey:1,printSettingOptionText:this.Xm.fa(1192)}),Object.assign(new y,{printSettingOptionKey:5,printSettingOptionText:this.Xm.fa(1193)}),Object.assign(new y,{printSettingOptionKey:6,
printSettingOptionText:this.Xm.fa(1200)}),Object.assign(new y,{printSettingOptionKey:7,printSettingOptionText:this.Xm.fa(1194)}),Object.assign(new y,{printSettingOptionKey:8,printSettingOptionText:this.Xm.fa(1195)}),Object.assign(new y,{printSettingOptionKey:9,printSettingOptionText:this.Xm.fa(1196)}),Object.assign(new y,{printSettingOptionKey:11,printSettingOptionText:this.Xm.fa(1197)}),Object.assign(new y,{printSettingOptionKey:12,printSettingOptionText:this.Xm.fa(1198)}),Object.assign(new y,{printSettingOptionKey:13,
printSettingOptionText:this.Xm.fa(1199)}),Object.assign(new y,{printSettingOptionKey:3,printSettingOptionText:this.Xm.fa(1191)})];this.Gje=[Object.assign(new y,{printSettingOptionKey:0,printSettingOptionText:this.Xm.fa(1208)}),Object.assign(new y,{printSettingOptionKey:1,printSettingOptionText:this.Xm.fa(1209)}),Object.assign(new y,{printSettingOptionKey:2,printSettingOptionText:this.Xm.fa(1210)}),Object.assign(new y,{printSettingOptionKey:3,printSettingOptionText:this.Xm.fa(1211)})];this.xee=[Object.assign(new A,
{printSettingOption:Object.assign(new y,{printSettingOptionKey:0,printSettingOptionText:this.Xm.fa(1214)}),marginValue:this.Gxb(this.normal)}),Object.assign(new A,{printSettingOption:Object.assign(new y,{printSettingOptionKey:1,printSettingOptionText:this.Xm.fa(1215)}),marginValue:this.Gxb(this.wide)}),Object.assign(new A,{printSettingOption:Object.assign(new y,{printSettingOptionKey:2,printSettingOptionText:this.Xm.fa(1216)}),marginValue:this.Gxb(this.narrow)}),Object.assign(new A,{printSettingOption:Object.assign(new y,
{printSettingOptionKey:3,printSettingOptionText:this.Xm.fa(1217)}),marginValue:this.Gxb(this.s7)})]};B.prototype.fgi=function(){this.normal=this.R6c(this.KIi);this.narrow=this.R6c(this.yHi);this.wide=this.R6c(this.I1j)};uk.Object.defineProperties(B.prototype,{whatToPrintOptions:{configurable:!0,enumerable:!0,get:function(){return this.rne}},orientationOptions:{configurable:!0,enumerable:!0,get:function(){return this.Cge}},paperSizeOptions:{configurable:!0,enumerable:!0,get:function(){return this.Tge}},
scalingOptions:{configurable:!0,enumerable:!0,get:function(){return this.Gje}},marginDetailedOptions:{configurable:!0,enumerable:!0,get:function(){return this.xee}}});B.Ygh=1;B.Kgh=1;B.Gtb=9;B.Pgh=2;B.Igh=0;B.Bgh=!1;B.xgh=!1;B.iJa={PrintGrid:!1,HorizontalCenter:!1,VerticalCenter:!1,PrintHeaders:!1};Object(Sd.a)(B,"PrintSettingsManagerBase",null,[3]);var tj=b(124);r.prototype.getSheetName=function(){return this.sheetName};Object(Sd.a)(r,"MacroRecorderSheetPrintOptionsSavedPayload",null,[428]);Am(w,
B);w.prototype.$ii=function(K){var na=this;this.aji(function(Xa){K&&(Xa=na.O_h(Xa),K(Xa))})};w.prototype.GPd=function(K,na){if(K){var Xa=new I(K.Wv,K.ignorePrintArea);this.lpj(Xa);!na||this.p9f?ud.ULS.sendTraceTag(593294034,0,50,"PrintSettingsManager.SavePrintSettings: Saving of print settings skipped because {0}",na?"skipSaveToFile is true":"shouldFilePersistedPrintSettingsBeSaved is false"):(na=this.Q_h(K.i1),na.IsLandscape=2===K.orientation,na.PaperSize=K.rda,this.isUniversalPrintEnabled&&(na.NoColor=
K.NoColor),na.PageMargin=this.tjd(K.margin),na.SheetPrintOptions=B.iJa,na.SheetPrintOptions.PrintGrid=K.sheetPrintOptions.PrintGrid,na.SheetPrintOptions.HorizontalCenter=K.sheetPrintOptions.HorizontalCenter,na.SheetPrintOptions.VerticalCenter=K.sheetPrintOptions.VerticalCenter,na.SheetPrintOptions.PrintHeaders=K.sheetPrintOptions.PrintHeaders,this.kpj(na))}else ud.ULS.sendTraceTag(593294035,0,10,"PrintSettingsManager.SavePrintSettings: printSettingsContainer passed as parameter is null")};w.prototype.tjd=
function(K){var na={};0===K?na=this.normal:1===K?na=this.wide:2===K?na=this.narrow:3===K&&(na=this.s7);return na};w.prototype.sji=function(K){var na=this;if(K){ud.ULS.sendTraceTag(537154197,0,50,"PrintSettingsManager.InvokeSetPrintOptionsWebMethod: Make server call to save print options to file");var Xa=function(){return new r(na.$.xa.oa.name,K)},Qb=this.$.na.ta,tc=this.$.na.ta.fc(),md=function(Dd,ue,Ce){var Kf=na.$.xa.oa.name;Dd=nh.b(na.CEd,Dd);ue=nh.a(na.MEd,ue);var Wg=Qb.Ma(1,null);Wg.sheetName=
Kf;Wg.printOptions=K;return Rd.i(Qb,"SetPrintOptions",Wg,Dd,ue,Ce,tc,0)};Xa=Te.EwaSettings.uc()?new Oc.a(598,0,md,64,Xa):new Hj.a(598,0,md,void 0,Xa);this.$.userOperationManager.jc(Xa,null)}else ud.ULS.sendTraceTag(537154198,0,10,"PrintSettingsManager.InvokeSetPrintOptionsWebMethod: sheetPrintOptions passed as parameter is null")};w.prototype.dispose=function(){this.Pd||(this.Pd=!0,this.$.userOperationManager.dr(this.kG),this.gZ())};w.prototype.lpj=function(K){this.OO.Wv=K.Wv;this.OO.ignorePrintArea=
K.ignorePrintArea};w.prototype.aji=function(K){function na(ue,Ce,Kf){return ia(tc.$.na.ta,tc.sheetName,tc.locale,nh.b(ue,Qb),nh.a(Ce,Xa),Kf,md)}function Xa(ue){ue=Ui.a.mg(ue.data);ud.ULS.sendTraceTag(537154194,0,10,"PrintSettingsManager.GetPrintSettingsPersistedInFile: Get print settings failed. Errors: {0}.",Mg.a.Wc(ue));K(null)}function Qb(ue){Lj.a(ue)?ud.ULS.sendTraceTag(537154196,0,15,"PrintSettingsManager.GetPrintSettingsPersistedInFile: Get print settings failed. Errors: {0}.",Mg.a.Wc(ue.Errors)):
(ud.ULS.sendTraceTag(537154195,0,50,"PrintSettingsManager.GetPrintSettingsPersistedInFile: Get print settings succeeded."),K(ue.Result))}var tc=this,md=this.$.na.ta.fc();var Dd=Te.EwaSettings.uc()?new Oc.a(247,0,na,80):new Hj.a(247,0,na,16);Dd=this.$.userOperationManager.jc(Dd,null);this.Dv.add(Dd)};w.prototype.kpj=function(K){var na=this;ud.ULS.sendTraceTag(593294031,0,50,"PrintSettingsManager.SavePrintSettingsPersistedInFile: Make server call to save print settings to file");var Xa=this.$.na.ta.fc();
this.$.userOperationManager.jc(new Oc.a(226,0,function(Qb,tc,md){return ra(na.$.na.ta,na.sheetName,K,nh.b(Qb,na.CWi),nh.a(tc,na.BWi),md,Xa)},void 0,function(){return new J(na.sheetName,K)}),null)};w.prototype.gqi=function(K){return this.Lgf(K)||!this.Ijf(K.PaperSize)};w.prototype.ced=function(K){this.Lgf(K)&&(ud.ULS.sendTraceTag(537154192,0,50,"PrintSettingsManager.FixPrintSettingsNotSupportedInXlo: Custom scaling present in file."),K.ScalingWidth=w.N8c,K.ScalingHeight=w.M8c,K.ScalingPercent=w.I7b,
K.FitToPage=w.G8c);this.Ijf(K.PaperSize)||(ud.ULS.sendTraceTag(537154191,0,15,"PrintSettingsManager.FixPrintSettingsNotSupportedInXlo: Paper size {0} present in file which is unsupported by XLO.",K.PaperSize.toString()),K.PaperSize=w.Gtb);return K};w.prototype.M_h=function(K){if(K.FitToPage){if(1===K.ScalingWidth&&1===K.ScalingHeight)return 1;if(!K.ScalingWidth&&1===K.ScalingHeight)return 3}else return 0;return 2};w.prototype.L_h=function(K){return this.Nsd(K,this.normal)?0:this.Nsd(K,this.wide)?
1:this.Nsd(K,this.narrow)?2:3};w.prototype.Nsd=function(K,na){return K.Left===na.Left&&K.Right===na.Right&&K.Top===na.Top&&K.Bottom===na.Bottom&&K.Header===na.Header&&K.Footer===na.Footer};w.prototype.Q_h=function(K){var na={};na.ScalingPercent=w.I7b;na.FitToPage=0!==K;2===K?(na.ScalingWidth=1,na.ScalingHeight=0):3===K?(na.ScalingWidth=0,na.ScalingHeight=1):1===K&&(na.ScalingWidth=1,na.ScalingHeight=1);return na};w.prototype.Ijf=function(K){return this.U0i.contains(K.toString())};w.prototype.Lgf=
function(K){return 100!==K.ScalingPercent||K.FitToPage&&(1<K.ScalingWidth||1<K.ScalingHeight)};w.prototype.g7g=function(){for(var K=new ui.a(sa.a.Uk()),na=0;na<this.paperSizeOptions.length;na++)K.add(this.paperSizeOptions[na].printSettingOptionKey.toString());return K};w.prototype.O_h=function(K){var na=null;if(K){var Xa=this.OO.Wv,Qb=this.OO.ignorePrintArea;this.gqi(K)&&(this.p9f=!0,K=this.ced(K));na=new t;na.Wv=Xa;na.ignorePrintArea=Qb;na.orientation=K.IsLandscape?2:1;na.rda=K.PaperSize;na.i1=this.M_h(K);
na.sheetPrintOptions=B.iJa;na.sheetPrintOptions.PrintGrid=K.SheetPrintOptions.PrintGrid;na.$2a=K.Draft;this.isUniversalPrintEnabled&&(na.NoColor=K.NoColor);na.sheetPrintOptions.HorizontalCenter=K.SheetPrintOptions.HorizontalCenter;na.sheetPrintOptions.VerticalCenter=K.SheetPrintOptions.VerticalCenter;na.sheetPrintOptions.PrintHeaders=K.SheetPrintOptions.PrintHeaders;na.margin=this.L_h(K.PageMargin);Te.EwaSettings.isChangeGateEnabled("OfficeVSO:5466517_AddPageMarginLogs")&&ud.ULS.sendTraceTag(553965398,
0,50,"PageMargin received : {0}",na.margin);3===na.margin&&(this.s7={},this.s7.Left=K.PageMargin.Left,this.s7.Right=K.PageMargin.Right,this.s7.Top=K.PageMargin.Top,this.s7.Bottom=K.PageMargin.Bottom,this.s7.Header=K.PageMargin.Header,this.s7.Footer=K.PageMargin.Footer)}return na};w.prototype.gZ=function(){if(this.Dv){for(var K=Cl(this.Dv),na=K.next();!na.done;na=K.next())na=na.value,this.$&&this.$.userOperationManager&&(na.operation&&ud.ULS.sendTraceTag(537154187,0,50,"PrintSettingsManager.AbortOutstandingUserOperation: Trying to abort pending operation {0}.",
tj.a(na.operation.operationName)),this.$.userOperationManager.nJa(na)),this.Dv.remove(na);this.Dv=null}};w.N8c=1;w.M8c=0;w.I7b=100;w.Gtb=9;w.G8c=!0;Object(Sd.a)(w,"PrintSettingsManager",B,[]);Object(Sd.a)(u,"PrintSettingsTaskPaneCallbacks",null,[]);Object(Sd.a)(h,"SelectedPrintSettings",null,[]);Object(Sd.a)(n,"PrintOperationCallbacks",null,[]);Object(Sd.a)(m,"PrintPreviewPaneCallbacks",null,[]);var uj=b(1254);Object(Sd.a)(l,"UniversalPrintAppSettings",null,[]);var Sj=b(393);e.prototype.CKg=function(K){this.Oa.addHandler("ppocek",
K)};e.prototype.Uhj=function(K){this.Oa.removeHandler("ppocek",K)};e.prototype.BGj=function(K,na){this.Ilj();this.$.userOperationManager.Xu(this.kG);this.Sm=K;this.Oa.raiseEvent("ppocek");this.Sm.SelectedRanges&&this.Sm.SelectedRanges.Ranges&&0<this.Sm.SelectedRanges.Ranges.length&&this.Sm.SelectedRanges.Ranges[0]&&(this.selectedRange=ff.B(this.Sm.SelectedRanges.Ranges[0]).toString());ud.ULS.shipAssertTag(537154268,0,!this.Ev,"PrintPreviewManager.ShowPrintPreviewer: printSettingsManager should be null.");
this.Ev=new w(this,this.$,na,this.$.xa.oa.name,Tc.a.instance,this.isUniversalPrintEnabled);ud.ULS.shipAssertTag(537154267,0,!this.zg,"PrintPreviewManager.ShowPrintPreviewer: printPreviewPane should be null.");this.zg=new Rj.PrintPreviewPane(this.$,this,this.useMSPdfViewer,this.isUniversalPrintEnabled);this.zg.Fkh();this.zg.DGj();this.zg.TJg(this.wEf)};e.prototype.$Xh=function(){this.Ev.s7&&4<=this.Ev.marginDetailedOptions.length&&(this.Ev.marginDetailedOptions[3].marginValue=this.Ev.Gxb(this.Ev.s7));
return this.Ev.marginDetailedOptions};e.prototype.kzc=function(){return!!this.Sm&&!!this.Sm.ObjectId||!Og.g(this.$).ga.va.Wg};e.prototype.R_h=function(){var K=Object.assign(new h,{selectedWhatToPrint:B.Ygh,selectedOrientation:B.Kgh,selectedPaperSize:B.Gtb,selectedScaling:B.Pgh,selectedMargin:B.Igh,selectedIgnorePrintArea:B.Bgh,selectedPrintGridlines:B.iJa.PrintGrid,selectedDraft:B.xgh,selectedHorizontalCenter:B.iJa.HorizontalCenter,selectedVerticalCenter:B.iJa.VerticalCenter,selectedRowAndColumnHeadings:B.iJa.PrintHeaders});
this.eI?(K.selectedWhatToPrint=this.eI.Wv,K.selectedOrientation=this.eI.orientation,K.selectedPaperSize=this.eI.rda,K.selectedScaling=this.eI.i1,K.selectedMargin=this.eI.margin,K.selectedIgnorePrintArea=this.eI.ignorePrintArea,K.selectedPrintGridlines=this.eI.sheetPrintOptions.PrintGrid,K.selectedDraft=this.eI.$2a,this.isUniversalPrintEnabled&&(K.selectedColor=this.eI.NoColor?0:1),K.selectedHorizontalCenter=this.eI.sheetPrintOptions.HorizontalCenter,K.selectedVerticalCenter=this.eI.sheetPrintOptions.VerticalCenter,
K.selectedRowAndColumnHeadings=this.eI.sheetPrintOptions.PrintHeaders):ud.ULS.sendTraceTag(593294038,0,10,"PrintPreviewManager.GetPrintSettingsSelectedOnPaneOpen: initialPrintSettings is null.");return K};e.prototype.E5e=function(){var K=this;return Object.assign(new m,{onBackToSheet:function(){K.Zma()}})};e.prototype.N_h=function(){var K=this;return Object.assign(new uj.a,{backActionButtonText:Tc.a.instance.fa(1167),printPreviewPaneCallbacks:this.E5e(),logger:new Tk.a,disableTellMeControl:!0,printOperationCallbacks:Object.assign(new n,
{onClosePreviewer:function(){K.Zma()},getGraphServiceAuthorizationToken:this.$bc(),onLocalPrint:function(){K.kFf()},onNotifyPrintJobStatus:this.onNotifyPrintJobStatus}),universalPrintAppSettings:Object.assign(new l,{graphServiceEndpoint:this.graphServiceEndpoint,graphServiceEndpointVersion:this.zki()?"testppebeta-print":"v1.0",isUniversalPrintFlowEnabled:this.isUniversalPrintEnabled,appName:"Excel"})})};e.prototype.P_h=function(){var K=this;return Object.assign(new u,{onSettingChange:function(na){K.rVi(na)},
onPrint:function(){K.kFf()}})};e.prototype.rVi=function(K){this.M0++;K?(this.zg&&this.zg.uHj(),this.Ck.Wv=K.selectedWhatToPrint,this.Ck.i1=K.selectedScaling,this.Ck.orientation=K.selectedOrientation,this.Ck.rda=K.selectedPaperSize,this.Ck.margin=K.selectedMargin,this.isUniversalPrintEnabled&&(this.Ck.NoColor=!K.selectedColor),this.Ck.ignorePrintArea=K.selectedIgnorePrintArea,this.exj(K.selectedPageStart,K.selectedPageEnd),this.Ev&&this.S$h(this.Ck,K)?(this.Ck.sheetPrintOptions=B.iJa,this.Ck.sheetPrintOptions.PrintGrid=
K.selectedPrintGridlines,this.Ck.sheetPrintOptions.HorizontalCenter=K.selectedHorizontalCenter,this.Ck.sheetPrintOptions.VerticalCenter=K.selectedVerticalCenter,this.Ck.sheetPrintOptions.PrintHeaders=K.selectedRowAndColumnHeadings,this.Ev.sji(this.Ck.sheetPrintOptions)):this.$zb()):ud.ULS.sendTraceTag(593294037,0,10,"PrintPreviewManager.OnPrintSettingsChange: changedPrintSettings passed as input is null.")};e.prototype.Zma=function(){this.A7a&&(this.aOb=!0);ud.ULS.sendTraceTag(591196513,0,50,"PrintPreviewManager.OnCloseButtonClick: User changed printSettings {0} times before clicking on backToWorkbook icon",
this.M0);this.jFf();this.qCe()};e.prototype.kFf=function(){ud.ULS.sendTraceTag(591196512,0,50,"PrintPreviewManager.OnPrintButtonClick: User changed printSettings {0} times before clicking on print button.",this.M0);Te.EwaSettings.isChangeGateEnabled("OfficeVSO:5466517_AddPageMarginLogs")&&ud.ULS.sendTraceTag(543024129,0,50,"PrintPreviewManager.OnPrintButtonClick: Current margin value : {0}, Initial margin value : {1}",this.Ck.margin,this.eI.margin);if(this.useMSPdfViewer)this.dNf();else if(this.e8a)try{this.zg.printPdf(),
this.O3c()}catch(K){ud.ULS.sendTraceTag(574482433,0,15,"PrintPreviewManager.OnPrintButtonClick: Unable to print. Opening the window."),this.dNf()}else this.pja.p8f(this.JIa(!0)),this.O3c()};e.prototype.dNf=function(){var K=this.JIa(!0);this.O3c();Ug.HelperMethods.wf(K,void 0,void 0,"PrintPreviewManager.CreateFileCopyFileHandlerURL")};e.prototype.dispose=function(){Vd.a.Fa(this.Oa)};e.prototype.$zb=function(){var K=this;if(this.$.Pxa)this.Xii();else{this.gZ();this.eYf();var na=null;this.Gfi();ud.ULS.sendTraceTag(593266766,
0,50,"PrintPreviewManager:InvokeGetFileCopyFileHandler - Invoking GetFileCopyFileHandler");var Xa=function(Qb,tc,md){Qb=new Ni.a(Qb,null,tc,md,null,!0,!1,"GetFileCopyFileHandler","");Qb.correlationID=ri.a.create().toString();na=Qb;K.Gca=K.Y3.y$(K.JIa(K.e8a?!1:!0,K.ski?"Base64":"Pdf"),1,null,null,e.sdd,!1,2,K.sDd,K.rDd,na,void 0,void 0,void 0,12E4);Qb.requestId=K.Gca;ud.ULS.sendTraceTag(537154264,0,50,"PrintPreviewManager.InvokeGetFileCopyFileHandler: Creating request with id: {0}.",K.Gca);return Kg.Task.Sa(!0)};
this.xOa=Te.EwaSettings.uc()?this.$.userOperationManager.jc(new Oc.a(223,0,Xa,80),null):this.$.userOperationManager.jc(new Hj.a(223,0,Xa,16),null)}};e.prototype.O3c=function(){this.jFf();this.qCe()};e.prototype.CEd=function(K){Mg.a.Ar(K.Errors)?this.zg.showErrorMessageForPrintOptions(Tc.a.instance.fa(1218)):(ud.ULS.sendTraceTag(537154263,0,50,"PrintPreviewManager.OnPrintOptionsUpdationSuccess: SetPrintOptions server call is successful."),this.$zb(),this.zg&&this.zg.hideErrorMessageForPrintOptions())};
e.prototype.MEd=function(K){this.zg&&this.zg.showErrorMessageForPrintOptions(Tc.a.instance.fa(1218));K=Ui.a.mg(K.data);ud.ULS.sendTraceTag(537154262,0,10,"PrintPreviewManager.OnSavePrintOptionsToFileFailure: Save print options to file failed. Errors: {0}.",Mg.a.Wc(K))};e.prototype.Xii=function(){function K(Qb,tc,md){var Dd={};Dd.WhatToPrint=na.Ck.Wv;Dd.UseNamedAction=na.pja.Izc();Dd.SelectedSheetName=na.$.xa.oa.name;Dd.ActiveCell=na.activeCell;Dd.SelectedRanges=[na.selectedRange];Dd.IsPdfDocumentRequired=
!1;Dd.Orientation=na.Ck.orientation;Dd.PaperSize=na.Ck.rda;Dd.Scaling=na.Ck.i1;Dd.RichValuesEnabled=!0;Dd.IgnorePrintArea=na.Ck.ignorePrintArea;Dd.Preview=!0;na.isUniversalPrintEnabled&&(Dd.NoColor=na.Ck.NoColor);na.T5f()&&(Dd.PaginationStartPage=na.dAa,Dd.PaginationEndPage=na.wna,Dd.OutputTotalPdfPageCount=!0);var ue=na.Ev.tjd(na.Ck.margin);ue&&(Dd.PageMargin={},Dd.PageMargin.Top=ue.Top,Dd.PageMargin.Bottom=ue.Bottom,Dd.PageMargin.Left=ue.Left,Dd.PageMargin.Right=ue.Right,Dd.PageMargin.Header=ue.Header,
Dd.PageMargin.Footer=ue.Footer);na.g9a=ba(na.$.na.ta,Dd,nh.b(na.eOi,Qb),nh.a(na.dOi,tc),md,Xa);return na.g9a}var na=this;ud.ULS.sendTraceTag(553649883,0,50,"PrintPreviewManager:InvokeConvertWorkbookToPrintPdf - Invoking ConvertWorkbookToPrintPdf");this.gZ();var Xa=this.$.na.ta.fc();Te.EwaSettings.uc()?this.xOa=this.$.userOperationManager.jc(new Oc.a(133,0,K,80),null):this.xOa=this.$.userOperationManager.jc(new Hj.a(133,0,K,16),null)};e.prototype.qCe=function(){this.$.userOperationManager.dr(this.kG);
this.gZ();this.eYf();ud.ULS.shipAssertTag(537154261,0,!!this.zg,"PrintPreviewManager.cleanUpPrintPreviewPanes: printPreviewPane should not be null");this.zg&&(this.zg.vhj(this.wEf),this.zg.Okh(),this.zg=null);this.Sm=null;this.Ev&&(this.Ev.dispose(),this.Ev=null);this.y4a=this.ZGb=null;this.PNc=!1;this.Oa&&this.Oa.raiseEvent("ppocek")};e.prototype.gCj=function(){return this.$.isEditMode&&!!this.eI&&!!this.Ck&&2!==this.Ck.Wv&&this.Amd()};e.prototype.GPd=function(){ud.ULS.shipAssertTag(537154260,0,
!!this.Ev,"PrintPreviewManager.SavePrintSettings: printSettingsManager should not be null");this.Ev&&this.Ev.GPd(this.Ck,this.gCj())};e.prototype.JIa=function(K,na){na=void 0===na?"Pdf":na;var Xa=new Sys.StringBuilder;Xa.append(ii.a(this.$,na,!0));Jh.a.ag(Xa,qg.a.jJd,""+this.Ck.Wv);K&&this.pja.Izc()&&Jh.a.ag(Xa,qg.a.Nig,"1");Jh.a.ag(Xa,qg.a.yOf,this.$.xa.oa.name);0===this.Ck.Wv&&(Jh.a.ag(Xa,qg.a.xOf,this.selectedRange),Jh.a.ag(Xa,qg.a.rOf,this.activeCell));Jh.a.ag(Xa,qg.a.sOf,""+this.Ck.orientation);
Jh.a.ag(Xa,qg.a.tOf,""+this.Ck.rda);Jh.a.ag(Xa,qg.a.wOf,""+this.Ck.i1);Jh.a.ag(Xa,qg.a.vOf,"1");Jh.a.ag(Xa,qg.a.qOf,this.Ck.ignorePrintArea?"1":"0");Jh.a.ag(Xa,qg.a.uOf,"1");this.iOg(Xa);this.isUniversalPrintEnabled&&Jh.a.ag(Xa,qg.a.j8i,this.Ck.NoColor?"1":"0");this.hOg(Xa);ta.a.equals(na,"Pdf",!0)&&(Xa.append("&#toolbar=0"),Xa.append("&zoom=100"));K=Xa.toString().replace("GetFileCopyFileHandler.aspx?","GetFileCopyFileHandler.aspx/?");ud.ULS.sendTraceTag(537154259,0,50,"PrintPreviewManager: Print Pdf Url {0}",
K);return K};e.prototype.exj=function(K,na){K||na?(this.rAb=!0,this.dAa=K,this.wna=na):this.qXf()};e.prototype.iOg=function(K){this.T5f()&&(Jh.a.ag(K,qg.a.l8i,""+this.dAa),Jh.a.ag(K,qg.a.k8i,""+this.wna),Jh.a.ag(K,qg.a.m8i,"1"),ud.ULS.sendTraceTag(537154258,0,50,"PrintPreviewManager: AppendPaginationQueryParameter Print Pdf page range from {0} to {1}",this.dAa,this.wna))};e.prototype.T5f=function(){return null!=this.dAa&&0<this.dAa&&null!=this.wna&&0<this.wna};e.prototype.hOg=function(K){if(this.Ev&&
this.Ck){var na=this.Ev.tjd(this.Ck.margin);na&&Jh.a.ag(K,qg.a.i8i,""+na.Top+" "+na.Bottom+" "+na.Left+" "+na.Right+" "+na.Header+" "+na.Footer)}};e.prototype.qFb=function(K,na,Xa,Qb){this.zg&&(ud.ULS.shipAssertTag(537154255,0,!!this.$.xa.oa,"PrintPreviewManager.OnConvertWorkbookToPdfSucceeded: ewaControl.Sheets.ActiveItem should not be null"),this.$.xa.oa&&(this.e8a?(Qb||(Qb=this.JIa(!1)),this.zg.Yxi(Qb)):this.vGj()))};e.prototype.Amd=function(){return!this.eI.equals(this.Ck)};e.prototype.jFf=function(){!this.aOb&&
0<this.M0&&(this.dtd?this.GPd():ud.ULS.sendTraceTag(537154251,0,50,"PrintPreviewManager:OnPreviewerClose - Previewer is being closed without settings pane being loaded."));ud.ULS.shipAssertTag(537154250,0,!!this.zg,"PrintPreviewManager.OnPreviewerClose: printPreviewPane should not be null");this.zg&&this.zg.abi();this.YZd()};e.prototype.zi=function(){ud.ULS.sendTraceTag(593294036,0,50,"PrintPreviewManager.ShowErrorDialog: Error Dialog displayed.");if(this.zg){var K=this.jBa(Tc.a.instance.fa(1));this.Xoa(K,
1)}else K=Mg.a.ed(1,0,26,0,1,-1100324317,"GetPrintSettingsFailedError"),Te.EwaSettings.Rz()?new mj.a(this.$,K):(new el.ErrorDialog(this.$,K)).pf()};e.prototype.CGj=function(K){K?(0===K.Wv&&this.kzc()&&(ud.ULS.sendTraceTag(537154249,0,50,"PrintPreviewManager.ShowPrintPreviewer: Falling back to ActiveSheet because current selection is a ${0}.",this.Sm.ObjectId?"floatingObject":"discontinuousRange"),K.Wv=1),t.rGe(K,this.eI),t.rGe(K,this.Ck),ud.ULS.shipAssertTag(537154248,0,!!this.zg,"PrintPreviewManager.ShowPrintPreviewer: printPreviewPane should not be null"),
this.zg&&(this.dtd=!0,this.zg.EGj(),this.$zb())):(ud.ULS.sendTraceTag(537154247,0,10,"PrintPreviewManager.ShowPrintPreviewer: printSettings fetched from server is null."),this.zi())};e.prototype.E2c=function(K,na,Xa){K>na&&(na=Object.assign(new oj.a,{extendedProperties:new Map}),na.extendedProperties.set("WtpSelectedValue",Xa),na.extendedProperties.set("FullyRenderedPdfLoadTime",K.toString()),Pg.Health.instance.recordQosError(qh.a.DIj,[Ic.a.y9f],!1,!0,!0,!1,na))};e.prototype.gZ=function(){this.xOa&&
(0<this.Gca||this.g9a)&&(ud.ULS.sendTraceTag(537154246,0,50,"PrintPreviewManager.AbortOutstandingUserOperation: Cancelling request with id: {0}.",this.Gca),this.$.userOperationManager.nJa(this.xOa),this.g9a?Ui.a.Ku(this.g9a.$t):this.Y3.Ku(this.Gca),this.lOd())};e.prototype.lOd=function(){this.g9a=this.xOa=null};e.prototype.Gfi=function(){this.ANd&&this.Ck&&(this.y4a=this.$.Sb.Hc("UserAction",(1===this.Ck.Wv?"ActiveSheet":0===this.Ck.Wv?"CurrentSelection":"EntireWorkbook")+"FullyRenderedPdfLoadTimeStopwatch"))};
e.prototype.qXf=function(){this.rAb=!1;this.dAa=1;this.wna=this.wId};e.prototype.jBa=function(K){if(K)return K.replace("&#39;","'");ud.ULS.sendTraceTag(537154245,0,15,"PrintPreviewManager.SanitizeErrorMessage: error message is null");return K};e.prototype.vGj=function(){ud.ULS.sendTraceTag(537154244,0,50,"PrintPreviewManager.ShowPdfRenderingError invoked");if(this.pBb)if(this.njc)ud.ULS.sendTraceTag(537154243,0,10,"PrintPreviewManager.ShowPdfRenderingError: Called when preview was supported in both host & browser");
else{var K=this.jBa(Tc.a.instance.fa(1172));this.Xoa(K,2)}else K=this.jBa(Tc.a.instance.fa(1173)),this.Xoa(K,3)};e.prototype.Xoa=function(K,na,Xa){this.zg.lA(K,na,void 0===Xa?null:Xa)};e.prototype.Sfi=function(){this.njc=this.$Be();this.pBb=this.l0g();this.e8a=this.m0g();ud.ULS.sendTraceTag(557061534,0,50,"PrintPreviewManager.InitializeIsPdfPreviewSupportedVars: isPdfPreviewSupportedInCurrentBrowser : {0}, isPdfPreviewSupportedInCurrentHost: {1}, isPdfPreviewSupportedInPreviewer: {2}",this.njc,this.pBb,
this.e8a)};e.prototype.Ilj=function(){this.d9a=null;this.lOd();this.qXf();this.ZGb=this.$.Sb.Hc("UserAction","paneLoadTimeStopwatch");this.activeCell=this.$.oa.activeCell.toString();this.M0=0;this.dtd=this.A7a=this.aOb=!1;this.PNc=!0};e.prototype.jEj=function(){var K=this.Nsi()||this.Slf()&&Te.EwaSettings.isChangeGateEnabled("OfficeVSO:6059097_EnablePreviewer3rdParty")?!0:!1;ud.ULS.sendTraceTag(537154242,0,50,"PrintPreviewManager.ShouldUseMSPdfViewer : {0}",K);return K};e.prototype.$Be=function(){return!Yf.a.FB};
e.prototype.U_g=function(){var K=15;Yf.a.lI&&Yf.a.yub&&(K=parseFloat(Yf.a.yub));return this.$Be()&&14<K&&this.pBb};e.prototype.l0g=function(){return this.Slf()&&!Te.EwaSettings.isChangeGateEnabled("OfficeVSO:6059097_EnablePreviewer3rdParty")?!1:!0};e.prototype.Nsi=function(){return Yf.a.oD||be.AFrameworkApplication.isUnifiedHostMode};e.prototype.m0g=function(){return this.njc&&this.pBb};e.prototype.Slf=function(){return!this.$.dg.get(111)};e.prototype.eYf=function(){this.d9a&&(URL.revokeObjectURL(this.d9a),
this.d9a=null)};e.prototype.f9g=function(K){var na=K.data.oe;K=this.$.Sb.Hc("UserAction","PrintPreviewBlobFileCreation");var Xa=window.self.atob(na);na=new Uint8Array(na.length);for(var Qb=0;Qb<Xa.length;Qb++)na[Qb]=Xa.charCodeAt(Qb)&255;Xa=new Blob([na],{type:"application/pdf"});this.d9a=URL.createObjectURL(Xa);ud.ULS.sendTraceTag(537154241,0,50,"PrintPreviewManager:OnFileHandlerSuccessCallback - Blob created. Total time to create : {0} ms. Blob size: {1}",K.Gc,Xa.size);K.stop();return this.d9a+
"#toolbar=0&zoom=100"};e.prototype.hbj=function(K){if(this.ANd&&Mg.a.uh(K,e.f2i)){var na=Object.assign(new oj.a,{extendedProperties:new Map});na.extendedProperties.set("ErrorMessageIdName",K[0].MessageIdName);Pg.Health.instance.recordQosError(qh.a.bNf,[Ic.a.cNf],!1,!0,!0,!1,na)}};e.prototype.S$h=function(K,na){return K.sheetPrintOptions.PrintGrid!==na.selectedPrintGridlines||K.sheetPrintOptions.HorizontalCenter!==na.selectedHorizontalCenter||K.sheetPrintOptions.VerticalCenter!==na.selectedVerticalCenter||
K.sheetPrintOptions.PrintHeaders!==na.selectedRowAndColumnHeadings};e.prototype.YZd=function(){this.ctd&&this.$.ae(-1753588160,-1,0,null)};e.prototype.zki=function(){return!!this.$.ya&&!!this.$.ya.DocumentHostInfo&&"TestHost"===this.$.ya.DocumentHostInfo.HostTier};e.prototype.getToken=function(){return this.VBd.sT("Print",this.graphServiceEndpoint).then(function(K){return K?(K.IsSuccess||ud.ULS.sendTraceTag(537154240,0,15,"PrintPreviewManager:GetToken: failed to get token. Error code: {0}, Error message : {1}",
K.ErrorCode,K.ErrorMessage),K):Object.assign(new Dj.a,{IsSuccess:!1,ErrorMessage:"Missing result object",ErrorCode:"need_result"})}).catch(function(K){var na=new Dj.a;Object.getType(K)===Object.getType(na)?na=K:(na.ErrorMessage=K.toString(),na.ErrorCode="exception");return Promise.resolve(na)})};e.prototype.$bc=function(){var K=this;return function(){var na=Promise.resolve("");try{if(K.VBd&&K.VBd.Ixa())return K.getToken().then(function(Xa){return Xa.IsSuccess?Promise.resolve(Xa.Token):na},function(){return na})}catch(Xa){ud.ULS.sendTraceTag(537154211,
0,10,"PrintPreviewManager:GetAuthTokenDelegate - Exception thrown while fetching token",Xa)}return na}};e.prototype.onNotifyPrintJobStatus=function(K,na){K=Sj.a.kz.notificationBar.Caa(K,!1);"pending"==na&&(K.displayTimeoutSeconds=3);K.image=0;Sj.a.kz.notificationBar.OE(K)};uk.Object.defineProperties(e.prototype,{fqi:{configurable:!0,enumerable:!0,get:function(){return this.PNc}}});e.f2i=[-953554093,1773721536,-1104435974,-1243918982,1205917367,1931972532,1294226134,1239184329,1207537900,-1053855722,
-2077518688,1348242499,2030854436,-1831476778];e.sdd=["Content-Type","Total-Pdf-PageCount"];Object(Sd.a)(e,"PrintPreviewManager",null,[702,3,703]);c.prototype.$c=function(){return!1};c.prototype.executeCommand=function(K,na,Xa,Qb){var tc=na.command;return 1588554917===tc?(na.zAb=!0,Gj.a(this.$)&&this.$.da.Aa(423).$zc(!1),this.vlh(na)?Kg.Task.Sa(!0):k.a(tc)):this.$Mf.executeCommand(K,na,Xa,Qb,this.YUi,this.XUi,this.yRj)};c.prototype.Mc=function(K,na){return 1588554917===na.command?(ud.ULS.shipAssertTag(537154305,
0,this.$.Dla,"Command execute requested for Print operation when data duplication is disallowed."),!0):this.$Mf.Mc(K,na)};c.prototype.nd=function(){return!1};c.prototype.vlh=function(K){return this.$.ea.sc?this.wlh(K):!1};c.prototype.wlh=function(K){ud.ULS.sendTraceTag(21099871,0,50,"PrintCommandHandler:DoPrintHtml");var na=this.$.Sb.Hc("UserAction","DoPrintHtml"),Xa=this.$,Qb=this.ea.isNamedObjectViewMode?Xa.Ab.oa.sheetName:Xa.xa.oa.name,tc=this.ea.isNamedObjectViewMode,md=!tc;Xa=this.K_h(Xa,Qb,
md);var Dd=!0;!Te.EwaSettings.isChangeGateEnabled("OfficeVSO:5315453_MoveWebpartsSessionsToPreviewer")&&this.$.Pxa&&(Dd=!1);md?Dd?Vi.a(this.$)?ud.ULS.sendTraceTag(537154304,0,50,"PrintCommandHandler:DoPrintHtml - Print previewer is already opened."):(this.PD.BGj(Xa,this.OO),ud.ULS.sendTraceTag(591196515,0,50,"PrintCommandHandler:DoPrintHtml Print previewer opened")):((new P(this.$,Tc.a.instance.fa(1181),3,Xa,K,this.pja,Qb,this.OO)).pf(),ud.ULS.sendTraceTag(595194760,0,50,"PrintCommandHandler:DoPrintHtml Print dialog shown in pdf mode in {0} ms.",
na.Gc)):((new aa(this.$,Tc.a.instance.fa(1181),3,Xa,K)).pf(),ud.ULS.sendTraceTag(591196514,0,15,"PrintCommandHandler:DoPrintHtml Print dialog shown in html mode in {0} ms. isNamedObjectViewMode: {1}.",na.Gc,tc));na.stop();this.Sld();return!0};c.prototype.K_h=function(K,na,Xa){var Qb={};Qb.SessionId=this.ea.sessionId;Qb.UsedRangeTooBig=!1;var tc=Og.g(K),md=tc.ga,Dd=md.Ye;if(Lk.e(K.oa))Qb.Type=0,Qb.ObjectId=K.oa.name,Qb.UseSelection=!1;else if(Lk.g(K.oa))Qb.Type=1,Qb.ObjectId=K.oa.hla,Qb.UseSelection=
!0;else if(2===Dd||4===Dd||64===Dd)tc=md.Pa.nc.floatingObject,Qb.Type=1,Qb.SheetName=na,Qb.ObjectId=tc.id,Qb.UseSelection=!0;else if(Xa&&Dd&470)Qb.ObjectId=md.Pa.nc.floatingObject.id,Qb.SheetName=na;else if(Lk.i(K.oa)){Qb.Type=2;Qb.SheetName=na;if(md.va.Wg)if(Xa=md.va.xd,Qb.SelectedRanges=ff.q(Xa,K),20<Xa.OQ)Qb.UseSelection=!0;else{na=0;tc=tc.Pk("PrintCommandHandler.DoPrintHtml",Xa);try{for(tc.$$rst();tc.$$mn()&&2>na;)tc.$$cu().text&&na++;Qb.UseSelection=2<=na}finally{tc&&tc.dispose()}}else Qb.UseSelection=
!1,Qb.SelectedRanges=ff.q(md.va.activeRange,K);this.ea.isNamedObjectViewMode&&(Qb.UsedRange=ff.v(K.oa.usedRange,K))}Qb.Title=K.workbookContext.WorkbookFileName;return Qb};c.prototype.Sld=function(){Og.g(this.$);if(!this.b6f){this.wTc=!0;var K=this.$.Sb.Hc("UserAction","HandlePageLayoutRendering");this.ORj();ud.ULS.sendTraceTag(537154274,0,50,"PrintCommandHandler:HandlePageLayoutRendering rendering is done in {0} ms.",K.Gc);K.stop()}};c.prototype.ORj=function(){for(var K=Og.g(this.$).Da,na=K.KF(),
Xa=!1,Qb=0,tc=0;tc<na.length;tc++){var md=na[tc],Dd=md.Gf;Dd&&Dd.hasPageLayout()&&(Xa=!0,Dd.setDirty("PrintCommandHandler::TriggerPageLayoutRendering, hash: "+md.Zd,4),Qb++)}Xa&&(ud.ULS.sendTraceTag(537154273,0,50,"PrintCommandHandler:TriggerPageLayoutRendering number of total cached blocks is {0}, number of blocks that require re-rendering is {1}",na.length,Qb),K.CBd())};uk.Object.defineProperties(c.prototype,{b6f:{configurable:!0,enumerable:!0,get:function(){return this.wTc}}});Object(Sd.a)(c,"PrintCommandHandler",
null,[434,676]);var ok=eh.a;Am(a,ok);a.prototype.Qd=function(){var K=this,na=be.AFrameworkApplication.ha.appSettings,Xa=this.$.ya.DirectPrintSetting;na.DirectPrintIsEnabled=Xa.DirectPrintIsEnabled.toString();na.DirectPrintProbeIsEnabled=Xa.DirectPrintProbeIsEnabled.toString();na.DirectPrintEnabledForInternetExplorer=Xa.DirectPrintEnabledForInternetExplorer.toString();na.DirectPrintSupportedMimeTypes=Xa.DirectPrintSupportedMimeTypes;na.DirectPrintSupportedPlugins=Xa.DirectPrintSupportedPlugins;na.DirectPrintImmersivePreviewPlugins=
Xa.DirectPrintImmersivePreviewPlugins;na.DirectPrintMinimalSupportedEdgeVersion=Xa.DirectPrintMinimalSupportedEdgeVersion;na.DirectPrintEnabledForEdge=Xa.DirectPrintEnabledForEdge.toString();na=new Aa(na);var Qb=null;Xa=null;try{Xa=window.navigator.mimeTypes}catch(Dd){ud.ULS.sendTraceTag(537154270,0,15,"Failed to get Window.Navigator.mimeTypes")}var tc=null;try{tc=window.navigator.plugins}catch(Dd){ud.ULS.sendTraceTag(537154269,0,15,"Failed to get Window.Navigator.plugins")}Qb=new ha(na,Xa,tc,ha.fhf,
ha.ulf,new ab(be.AFrameworkApplication.sa.gY),be.AFrameworkApplication.sa.gE,ha.vlf,function(Dd,ue){return new Fa(Dd,!1,ue)},!1);if(Te.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UniversalPrint",!1)&&this.$.dg.get(116)){var md=wh.GetServiceTaskFactory.Ua(this.$.da,349,350,this.ub);Yg.TaskExtensions.Ba(md,function(){var Dd=new c(K.$,Qb,md.result);K.Jd([Dd])},this.$.la)}else this.Jd([new c(this.$,Qb,null)])};a.ka=function(K){eh.a.je(73,new a(K))};Object(Sd.a)(a,"PrintCommandHandlerFactory",
eh.a,[]);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.BusinessBar");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.HyperLink");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.MsForm");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.PresentMode");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Print");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Resize");Type.registerNamespace("_Ewa");Pf.a.Ti(".ewa-bb{padding:0;display:block;background-color:#fcf7b6;color:#444;position:relative;overflow:hidden;cursor:default}.ewa-bb-entry{position:relative;height:auto;border-bottom:1px solid #d7d889;overflow:hidden}.ewa-bb-entry:first-child{border-top:1px solid #d7d889}.ewa-bb-entry-body{min-height:24px;position:relative}.ewa-bb-icon{vertical-align:middle;display:inline-block}.ewa-bb-entry-icon{margin:2px 6px 0;display:inline-block}.ewa-bb-entry-title{font-weight:bold}.ewa-bb-entry-message{padding:0 8px}.ewa-bb-entry-button{background-color:#fff;border:1px solid #ababab;color:#444;text-align:center;cursor:default;margin-bottom:1px;padding:3px 10px 4px}.ewa-bb-entry-button:hover{background:#f0f0f0}.ewa-bb-entry-button:active{background:#c6c6c6}.ewa-bb-entry-link{color:#369}.ewa-bb-entry-close{position:absolute;top:50%;margin-top:-8px;cursor:pointer}.ewa-bb-entry-close .clip16x16{display:inline-block}.ewa-bb-entry-title,.ewa-bb-entry-message,.ewa-bb-entry-button-holder,.ewa-bb-entry-link{vertical-align:middle}.ewa-root-ltr .ewa-bb-entry-close,.ewa-nov2-ltr .ewa-bb-entry-close{right:2px}.ewa-root-ltr .ewa-bb-content,.ewa-nov2-ltr .ewa-bb-content{margin-right:26px}.ewa-root-ltr .ewa-bb-entry-button-holder,.ewa-nov2-ltr .ewa-bb-button-holder,.ewa-root-ltr .ewa-bb-entry-link,.ewa-nov2-ltr .ewa-bb-entry-link{margin-left:8px}.ewa-root-rtl .ewa-bb-entry-close,.ewa-nov2-rtl .ewa-bb-entry-close{left:2px}.ewa-root-rtl .ewa-bb-content,.ewa-nov2-rtl .ewa-bb-content{margin-left:26px}.ewa-root-rtl .ewa-bb-entry-button-holder,.ewa-nov2-rtl .ewa-bb-button-holder,.ewa-root-rtl .ewa-bb-entry-link,.ewa-nov2-rtl .ewa-bb-entry-link{margin-right:8px}");
Type.registerNamespace("CADWLTR");af.main();Type.registerNamespace("Common.App.NewAndOpen.UX");Mf.a.instance.nj(new Re);Type.registerNamespace("Common.App.OneDriveFilePickerApi");Be.main();Type.registerNamespace("Common");Type.registerNamespace("Common.App.OpenInClient");Type.registerNamespace("Common.App.SaveAsToHost");fh.main();Type.registerNamespace("Common.App.SaveToSharePoint");Rc.main();Type.registerNamespace("Common.App.SaveToCloudStorage");Ef.main();Type.registerNamespace("Common.App.SaveACopy");
Tf.main();Type.registerNamespace("Common.App.SharedFilePicker");Uf.main();Type.registerNamespace("Common.App.WildFire");wf.main();Gf.a.Ga(se.ka);Gf.a.Ga(lf.ka);Gf.a.Ga(Lc.ka);Pf.a.Ti(".HyperlinkDialog .ewa-dlg-body-sectionlabel{margin-bottom:5px}.HyperlinkDialog .disabledInput{background-color:#ebebe4;border:solid 1px #b5b5b5}.HyperlinkDialog .ewa-dlg-body-fullLine{width:inherit;min-width:318px;padding-right:5px;padding-left:25px}.ewa-dlg-elements-container-rtl .HyperlinkDialog .ewa-dlg-body-fullLine{padding-right:25px;padding-left:5px}.HyperlinkDialog input[type=text]{width:100%;outline:none;padding-left:3px;border:solid 1px #ccc}.HyperlinkDialog .ewa-dlg-body-sectionbreak{height:50px;position:relative}.HyperlinkDialog input[type=radio]{position:absolute;left:0}.ewa-dlg-elements-container-rtl .HyperlinkDialog input[type=radio]{left:auto;right:0}.HyperlinkDialog .ewa-dlg-body-sectionlabel label{margin-left:24px}.ewa-dlg-elements-container-rtl .HyperlinkDialog .ewa-dlg-body-sectionlabel label{margin-right:24px;margin-left:auto}.ValidationLabel{position:relative;display:block}.ValidationLabelWarning{color:#cc4200}.ValidationLabelError{color:#d90000}.ValidationWarningGlowColor,.ValidationErrorGlowColor,.ValidationLableGlow{border-style:solid;border-width:1px;-webkit-transition:all .2s ease-in-out;-moz-transition:all .2s ease-in-out;-ms-transition:all .2s ease-in-out;-o-transition:all .2s ease-in-out}.HyperlinkDialog div .ValidationErrorGlowColor{box-shadow:0 0 2px #d90000;border-color:#d90000}.HyperlinkDialog div .ValidationWarningGlowColor{box-shadow:0 0 2px #cc4200;border-color:#cc4200}");
Gf.a.Ga(hc.ka);Pf.a.Ti(".MsformCalloutContent{color:#fff;font-size:13pt;line-height:1;padding-right:5px;margin-bottom:12px;margin-top:-6px;padding-left:10px;width:90%}.MsFormCalloutOuter{background-color:#107c41;z-index:1030}");(function(){Gf.a.Ga(function(K){pd.ka(K)})})();(function(){Gf.a.Ga(function(K){K.da.Ha(165,new ge(K))})})();Gf.a.Ga(me.ka);(function(){Gf.a.Ga(function(K){K.da.Ha(57,new Ae(K));K.da.Ha(60,new kc(K));K.da.Ha(63,new $c(K))})})();Gf.a.Ga(od.ka);Gf.a.Ga(He.ka);Gf.a.Ga(Cd.ka);Pf.a.Ti(".ewa-presentMode-overlay{pointer-events:none}.ewa-presentMode-panel-container{z-index:1054;position:absolute;bottom:32px;visibility:hidden}.ewr-presentMode-on .ewa-presentMode-panel-container{visibility:visible}.ewa-presentMode-rowHdrParent-container{position:relative;z-index:1055}.ewa-presentMode-right-frame{position:absolute;bottom:32px;top:0;right:0;width:0;opacity:0;background-color:#f5f5f5}.ewr-presentMode-on .ewa-presentMode-right-frame{width:32px;opacity:1;background-color:#323130}.ewr-presentMode-on-rtl .ewa-presentMode-right-frame{width:0;opacity:0}.ewr-presentMode-on-headers-off .ewa-presentMode-right-frame{width:12px !important;opacity:1}.ewr-namedsheetview .ewa-presentMode-right-frame{background-color:#000 !important}.ewr-presentMode-transition .ewa-presentMode-right-frame{transition:background-color .4s linear}.ewr-presentMode-on #dialogHost{z-index:1056 !important}");
(function(){Gf.a.Ga(function(K){Ne.ka(K);uc.ka(K)})})();Pf.a.Ti('.PrintDialogBody{height:260px;width:516px;margin-top:17px}.PrintDialogTitle{font-size:21px;margin-top:14px;margin-left:18px;font-family:"Segoe UI Light"}.ewa-dlg-elements-container-rtl .PrintDialogTitle{margin-left:auto;margin-right:18px}.PrintDialogLeftContainer{float:left;width:240px;height:100%;font-size:14px;margin-left:18px}.ewa-dlg-elements-container-rtl .PrintDialogLeftContainer{float:right;margin-left:auto;margin-right:18px}.PrintDialogRightContainer{float:left;font-size:14px;width:240px;height:inherit;margin-left:18px}.ewa-dlg-elements-container-rtl .PrintDialogRightContainer{float:right;margin-left:auto;margin-right:18px}.PrintDialogRadioButtonContainer{width:224px;height:32px;display:flex;align-items:center}.PrintRadioButtonElementInnerDiv{vertical-align:middle;display:table-cell}.PrintRadioButtonElementOuterDiv{position:absolute;top:0;left:64px;height:32px;width:140px;vertical-align:middle;display:table}.ewa-dlg-elements-container-rtl .PrintRadioButtonElementOuterDiv{left:auto;right:64px}.PrintDialogTitleSection{width:224px;height:19px}.PrintDialogComboBoxContainer{width:224px;height:32px;margin-top:12px}.PrintRadioButtonIcon{margin:0 16px;vertical-align:middle}.PrintButtonArea{margin-right:32px}.ewa-dlg-elements-container-rtl .PrintButtonArea{margin-right:auto;margin-left:32px}.PrintPreviewerContainer{height:100%;width:100%;z-index:998;position:absolute;background:#edebe9}.ewa-hide-print-elements-siblings{display:none}');
Pf.a.Ti(".ewa-resizehdr-row-hidden{width:inherit;height:0}.ewa-resizehdr-col-hidden{width:0;height:inherit}");(function(){Gf.a.Ga(function(K){Ob.ka(K);va.ka(K)})})();Gf.a.Ga(Zc.ka);Gf.a.Ga(ac.ka);(function(){Gf.a.Ga(function(K){qb.ka(K);xb.ka(K)})})();Gf.a.Ga(wa.ka);Gf.a.Ga(tb.ka);(function(){Gf.a.Ga(function(K){Da.ka(K);pa.ka(K)})})();Gf.a.Ga(zb.ka);(function(){Gf.a.Ga(function(K){oa.ka(K);bb.ka(K)})})();Type.registerNamespace("Common.App.DirectPrint");Mf.a.instance.nj(new da);Gf.a.Ga(a.ka)},917:function(z,
F,b){function a(ea,Z){var S=O.call(this,document.createElement("div"))||this;S.Ux=null;S.MT=null;S.g9=null;S.Ica=null;S.v4b=null;S.Tne=null;S.vte=null;S.Kof=null;S.A6a=!1;S.qv=!1;S.C_=!1;S.bxa=!1;S.oNi=function(I){S.wD(I)};S.uNi=function(I){13===I.keyCode&&S.wD(I)};S.lCd=function(I){S.Ho(I.zb);return!0};S.rCd=function(I){S.y0(I.zb);return!0};S.Ipc=function(I){S.jna(I.zb?I.zb:0);return!0};S.pNi=function(I){S.wD(I.Ca);return!0};S.qng=function(I){I=void 0===I?null:I;S.Ho(I.inputMethod?I.inputMethod:
0);return!0};S.rng=function(I){I=void 0===I?null:I;S.y0(I.inputMethod?I.inputMethod:0);return!0};S.o2=ea;S.$C=Z;S.t_c=Z.GHa.toString();S.title=Z.title;S.message=Z.message;S.set_visibilityMode(1);return S}b.d(F,"a",function(){return a});z=b(0);var c=b(13),e=b(89),l=b(226),m=b(12),n=b(108),h=b(201),u=b(85);F=b(240);var w=b(1242),r=b(17),B=b(5),y=b(335),v=b(52),A=b(11),t=b(71),E=b(14),C=b(20),H=b(86),U=b(1109),Q=b(1),O=F.a;Am(a,O);a.prototype.dispose=function(){e.a.tc([this.v4b,this.MT,this.g9]);this.qv&&
this.MT&&(l.a.instance.za(m.a.click,this.MT.domElement,this.lCd),n.KeyInputManager.instance.Tv(this.domElement,this.Tne));this.C_&&this.g9&&(l.a.instance.za(m.a.click,this.g9.domElement,this.rCd),n.KeyInputManager.instance.Tv(this.domElement,this.vte));this.bxa&&this.Ica&&(l.a.instance.za(m.a.click,this.Ica,this.Ipc),n.KeyInputManager.instance.Tv(this.domElement,this.Kof));this.Ica=this.Ux=this.o2=this.g9=this.MT=null;O.prototype.dispose.call(this)};a.prototype.update=function(){};a.prototype.NVj=
function(){this.oIe(!0)};a.prototype.Z5c=function(){this.oIe(!1)};a.prototype.qch=function(){var ea=this;this.message=H.a.Il(this.message);this.title=H.a.Il(this.title);h.UISurfaces.Iid().then(function(Z){Z.initializeMessageBarInStore();var S=Object.assign(new U.a,{messageTitle:ea.title,message:ea.message,isMultiline:!1,messageBarType:ea.$C.vWg,closeable:!ea.A6a,dismissButtonAriaLabel:E.a.instance.fa(10),onDismiss:ea.pNi});if(ea.bxa){var I={};S.linkProps=(I.type="AppLinkProps",I.text=ea.linkText,
I.onExecute=ea.Ipc,I)}ea.qv&&(I={},S.firstActionButtonProps=(I.type="AppButtonProps",I.label=ea.actionButton,I.onExecute=ea.qng,I));ea.C_&&(I={},S.secondActionButtonProps=(I.type="AppButtonProps",I.label=ea.gHa,I.onExecute=ea.rng,I));Z.createNewMessageBar(ea.domElement,S);return null},function(Z){c.ULS.sendTraceTag(524075914,0,10,"Business Bar could not be initialized",Z);return null});this.domElement.tabIndex=0;this.businessBar.domElement.appendChild(this.domElement)};a.prototype.pIe=function(ea){var Z=
"<div class='"+w.a.krh+"' id='{0}'><div class='"+w.a.irh+"'><a class='"+w.a.qrh+"' title='{1}'><span class='"+r.a.t4b+" "+w.a.mrh+"' id='{2}'>";this.Xj.length&&(Z+="<img class='{3}' src='{4}'/>");Z+="</span></a><span class='"+w.a.prh+"' id='{5}'>{6}</span><span class='"+w.a.orh+"' id='message'>{7}</span><a id='link' href='#' class='"+w.a.nrh+"'>{8}</a><span class='"+w.a.uQe+"'><button type='button' id='action' class='"+w.a.tQe+"'>{9}</button></span><span class='"+w.a.uQe+"'><button type='button' id='altAction' class='"+
w.a.tQe+"'>{10}</button></span></div><a class='"+w.a.lrh+"' tabindex='0' role='button'><span id='close' class='"+r.a.Dr+"'><img class='"+r.a.Lbd+"' src='{11}' alt='{12}' title='{12}' role='button'/></span></a></div>";ea||(this.domElement.tabIndex=0,this.businessBar.domElement.appendChild(this.domElement));var S=this.businessBar.$.Lb;ea=S+"ewaBusinessBarEntryBody"+this.t_c;var I=S+"ewaBusinessBarEntryTitle"+this.t_c;S=S+"ewaBusinessBarEntryIcon"+this.t_c;this.domElement.className=w.a.jrh;this.domElement.innerHTML=
String.format(Z,ea,this.alt,S,this.Xj,v.a.Ge(0),I,this.title,this.message,this.linkText,this.actionButton,this.gHa,v.a.Ge(13),E.a.instance.fa(776));A.DOMElementExtensions.Rs(this.domElement,B.a.mta,I,ea);this.Ica=$get("link",this.domElement);A.DOMElementExtensions.setVisible(this.Ica,this.bxa);this.bxa&&(l.a.instance.qa(m.a.click,this.Ica,this.Ipc),this.Kof=n.KeyInputManager.instance.Ps(this.Ica,this.Ipc,u.a.fi,u.a.d2));this.MT=new y.a(A.DOMElementExtensions.getElementById(this.domElement,"action"));
this.MT.isVisible=this.qv;this.g9=new y.a(A.DOMElementExtensions.getElementById(this.domElement,"altAction"));this.g9.isVisible=this.C_;this.qv&&(l.a.instance.qa(m.a.click,this.MT.domElement,this.lCd),this.Tne=n.KeyInputManager.instance.Ps(this.MT.domElement,this.lCd,u.a.fi,u.a.d2),this.C_&&(l.a.instance.qa(m.a.click,this.g9.domElement,this.rCd),this.vte=n.KeyInputManager.instance.Ps(this.MT.domElement,this.rCd,u.a.fi,u.a.d2)));this.Ux=$get("close",this.domElement);this.v4b=this.Rd.Gd(this.Ux);this.v4b.ka("click",
this.oNi);this.v4b.ka("keydown",this.uNi);A.DOMElementExtensions.setVisible(this.Ux,!this.A6a)};a.prototype.oIe=function(ea){63==this.$C.GHa?this.pIe(ea):Q.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReactBusinessBar",!1)?this.qch():this.pIe(ea)};a.prototype.Ho=function(){c.ULS.sendTraceTag(21517968,0,50,"BusinessBar [{0}]: BusinessBarEntry.OnActionClick() for EntryName {1}",this.$C.hash,this.$C.zad);C.g(this.businessBar.$).kr(!0)};a.prototype.y0=function(){c.ULS.sendTraceTag(537170257,
0,50,"BusinessBar [{0}]: BusinessBarEntry.OnAltActionClick()",this.$C.hash);C.g(this.businessBar.$).kr(!0)};a.prototype.jna=function(){c.ULS.sendTraceTag(537170256,0,50,"BusinessBar [{0}]: BusinessBarEntry.OnLinkClick()",this.$C.hash);C.g(this.businessBar.$).kr(!0)};a.prototype.wD=function(ea){c.ULS.sendTraceTag(21517971,0,50,"BusinessBar [{0}]: BusinessBarEntry.OnCloseClick() for EntryName {1}",this.$C.hash,this.$C.zad);this.set_visible(!1);this.businessBar.removeEntry(this.wWg);t.g(ea)};uk.Object.defineProperties(a.prototype,
{wWg:{configurable:!0,enumerable:!0,get:function(){return this.$C.GHa}},businessBar:{configurable:!0,enumerable:!0,get:function(){return this.o2}},actionButton:{configurable:!0,enumerable:!0,get:function(){return this.$C?this.$C.actionButton:""}},gHa:{configurable:!0,enumerable:!0,get:function(){return this.$C?this.$C.gHa:""}},linkText:{configurable:!0,enumerable:!0,get:function(){return this.$C?this.$C.link:""}},Xj:{configurable:!0,enumerable:!0,get:function(){return this.$C?this.$C.Xj:""}},alt:{configurable:!0,
enumerable:!0,get:function(){return this.$C?this.$C.alt:""}}});Object(z.a)(a,"BusinessBarEntry",F.a,[])},990:function(z,F,b){function a(J,aa,ia,ba){var ra=P.call(this)||this;ra.pG=null;ra.QD=null;ra.oX=null;ra.gx=null;ra.VHb=null;ra.FL=null;ra.Tlc=null;ra.mDb=null;ra.lDb=!1;ra.Wxa=!0;ra.Prc=null;ra.ewaAccessibilityManager=null;ra.vId=null;ra.uId=null;ra.yId=null;ra.$qd=!1;ra.ZCf=function(){w.ULS.sendTraceTag(537154206,0,50,"PrintPreviewPane:OnIframeContentChange API invoked with loadPdfCalled: {0}",
ra.lDb);ra.lDb&&(ra.jbi(),ra.FL.style.visibility="visible",ra.Tlc?ra.Tlc.stop():w.ULS.sendTraceTag(537154205,0,10,"PrintPreviewPane:OnIframeContentChange - loadPdfStopwatchForIframe is null."),ra.raiseEvent(a.MEb,new u(1)),ra.MRd(),ra.lDb=!1)};ra.$=J;ra.PD=aa;ra.dch();ra.useMSPdfViewer=ia;ra.isUniversalPrintEnabled=ba;return ra}function c(){this.msPdfViewerFileUrl=null;this.useMSPdfViewer=!1;this.onPdfLoad=null}function e(){this.logger=this.printSettingsTaskPaneCallbacks=this.selectedPrintSettingsValues=
this.colorOptions=this.marginDetailedOptions=this.marginOptions=this.scalingOptions=this.paperSizeOptions=this.orientationOptions=this.whatToPrintOptions=null;this.isViewMode=this.shouldDisableCurrentSelection=!1;this.dataCultureTag=this.isMetricMeasurementUnit=this.isUniversalPrintFlowEnabled=null}function l(){this.msPdfKitWasmUrl=this.msPdfKitJSUrl=this.pdfViewerWorkerUrl=null}function m(J){this.zg=J}function n(J){this.zg=J}function h(J){this.zg=J}function u(J){var aa=U.call(this)||this;aa.l6i=
J;return aa}b.r(F);z=b(0);var w=b(13),r=b(4);b(23);var B=b(408),y=b(36),v=b(51),A=b(11),t=b(127),E=b(1),C=b(14),H=b(20),U=Sys.EventArgs;Am(u,U);Object(z.a)(u,"PrintPreviewPaneOperationStatusEventArgs",Sys.EventArgs,[]);var Q=b(269),O=b(253);h.prototype.Xg=function(){Q.a(this.zg.$).NN(this.de)||Q.a(this.zg.$).Xg(this)};h.prototype.Q8=function(){Q.a(this.zg.$).NN(this.de)&&Q.a(this.zg.$).eA(this)};h.prototype.eg=function(J){return A.DOMElementExtensions.Se(this.Kb,J)};h.prototype.ji=function(){this.zg.$.frame.Ue.mk(this.zg.$.frame.Ue.rF)};
h.prototype.Xh=function(){};h.prototype.Qe=function(J,aa){return aa?!1:(this.zg.enterPrintPreviewHeaderFocusTrapZone(),!0)};uk.Object.defineProperties(h.prototype,{de:{configurable:!0,enumerable:!0,get:function(){return O.a.eNf}},Kb:{configurable:!0,enumerable:!0,get:function(){var J=b(990).PrintPreviewPane;return document.getElementById(J.k6i)}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object(z.a)(h,"PrintPreviewHeaderKeyboardAccessibleSection",null,[451]);n.prototype.Xg=
function(){Q.a(this.zg.$).NN(this.de)||Q.a(this.zg.$).Xg(this)};n.prototype.Q8=function(){Q.a(this.zg.$).NN(this.de)&&Q.a(this.zg.$).eA(this)};n.prototype.eg=function(J){return A.DOMElementExtensions.Se(this.Kb,J)};n.prototype.ji=function(){this.zg.$.frame.Ue.mk(this.zg.$.frame.Ue.rF)};n.prototype.Xh=function(){};n.prototype.Qe=function(J,aa){return aa?!1:(this.zg.useMSPdfViewer?(J=document.getElementById(b(990).PrintPreviewPane.uGd))&&A.DOMElementExtensions.setFocus(J,!0):A.DOMElementExtensions.setFocus(this.zg.FL),
!0)};uk.Object.defineProperties(n.prototype,{de:{configurable:!0,enumerable:!0,get:function(){return O.a.fNf}},Kb:{configurable:!0,enumerable:!0,get:function(){var J=b(990).PrintPreviewPane;return this.zg.useMSPdfViewer?document.getElementById(b(990).PrintPreviewPane.uGd):document.getElementById(J.GKf)}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object(z.a)(n,"PrintPreviewKeyboardAccessibleSection",null,[451]);m.prototype.Xg=function(){Q.a(this.zg.$).NN(this.de)||
Q.a(this.zg.$).Xg(this)};m.prototype.Q8=function(){Q.a(this.zg.$).NN(this.de)&&Q.a(this.zg.$).eA(this)};m.prototype.eg=function(J){return A.DOMElementExtensions.Se(this.Kb,J)};m.prototype.ji=function(){this.zg.$.frame.Ue.mk(this.zg.$.frame.Ue.rF)};m.prototype.Xh=function(){};m.prototype.Qe=function(J,aa){return aa?!1:(this.zg.enterPrintSettingsTaskPaneFocusTrapZone(),!0)};uk.Object.defineProperties(m.prototype,{de:{configurable:!0,enumerable:!0,get:function(){return O.a.iNf}},Kb:{configurable:!0,
enumerable:!0,get:function(){var J=b(990).PrintPreviewPane;return document.getElementById(J.xId)}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object(z.a)(m,"PrintSettingsTaskPaneKeyboardAccessibleSection",null,[451]);Object(z.a)(l,"MSPdfViewerFileUrl",null,[]);Object(z.a)(e,"PrintSettingsTaskPaneProps",null,[]);Object(z.a)(c,"ViewerPaneProps",null,[]);var ea=b(1254),Z=b(395),S=b(5),I=b(1255);b.d(F,"PrintPreviewPane",function(){return a});var P=y.a;Am(a,P);a.prototype.TJg=
function(J){this.addHandler(a.MEb,J)};a.prototype.vhj=function(J){this.removeHandler(a.MEb,J)};a.prototype.DGj=function(){this.Zbh()};a.prototype.EGj=function(){var J=this.$.Sb.Hc("UserAction","createSettingsPaneStopwatch"),aa=document.getElementById(a.xId);this.ech();var ia=this.fch();this.QD.createPrintSettingsTaskPane(aa,ia);J.stop();this.lDb=!1;if(this.isUniversalPrintEnabled&&this.gx){J="A4";switch(ia.selectedPrintSettingsValues.selectedPaperSize){case 8:J="A3";break;case 9:J="A4";break;case 11:J=
"A5";break;case 12:J="JIS B4";break;case 13:J="JIS B5";break;case 5:J="North America Legal";break;case 1:J="North America Letter";break;case 6:J="North America Invoice";break;case 7:J="North America Executive";break;case 3:J="North America Ledger"}this.pG.setDocumentSettings({mediaSize:J,orientation:2===ia.selectedPrintSettingsValues.selectedOrientation?"landscape":"portrait",colorMode:1===ia.selectedPrintSettingsValues.selectedColor?"color":"blackAndWhite"})}this.iLd()};a.prototype.setPageRangeSettings=
function(J,aa,ia,ba,ra){this.QD&&(this.QD.setPageRangeSettings(J,aa,ia,ba,ra),this.J3f(String.format(C.a.instance.Bb(195),ba,ra,J)))};a.prototype.abi=function(){this.gx&&(this.gx.style.display="none")};a.prototype.Okh=function(){this.dispose();this.S_d();this.LTj();this.pG&&this.pG.closePrintPreviewPane();this.oX=this.QD=this.pG=this.gx=null};a.prototype.Yxi=function(J){w.ULS.sendTraceTag(575534018,0,50,"PrintPreviewPane: LoadPdf invoked.");this.hidePreviewError();this.useMSPdfViewer?((this.mDb=this.$.Sb.Hc("UserAction",
"pdfLoadTimeStopwatchForMsPdfViewer"))||w.ULS.sendTraceTag(537154210,0,10,"PrintPreviewPane:LoadPdf - loadPdfStopwatchForMsPdfViewer is null."),this.oX.renderPdf(J)):this.FL&&((this.Tlc=this.$.Sb.Hc("UserAction","loadPdfStopwatch"))||w.ULS.sendTraceTag(537154209,0,10,"PrintPreviewPane:LoadPdf - loadPdfStopwatchForIframe is null."),this.lDb=!0,this.FL.src&&this.FL.src===J?this.ZCf(null):this.FL.src=J);if(this.isUniversalPrintEnabled&&this.gx){var aa=Z.b(this.$.workbookContext);this.pG.setFileUrl(J,
aa)}};a.prototype.onPdfLoad=function(){this.mDb?(w.ULS.sendTraceTag(537154208,0,50,"PrintPreviewPane:onPdfLoad - Rendering time : {0} ms, isFirstTimeLoad: {1}",this.mDb.Gc,this.Wxa),this.mDb.stop()):w.ULS.sendTraceTag(537154207,0,10,"PrintPreviewPane:onPdfLoad - loadPdfStopwatchForMsPdfViewer is null.");this.raiseEvent(a.MEb,new u(1));this.hideWaitCursor();this.MRd()};a.prototype.printPdf=function(){A.DOMElementExtensions.setFocus(this.FL);this.FL.contentWindow.print()};a.prototype.uHj=function(){this.showSpinner();
this.showWaitCursor();this.J3f("")};a.prototype.jbi=function(){this.hideSpinner();this.hideWaitCursor()};a.prototype.lA=function(J,aa,ia){this.gx&&this.oX&&(this.$qd=!1,this.oX.showErrorDetails(aa,J,void 0===ia?null:ia),this.PD.A7a=!0,this.FL&&(this.FL.src=""),this.disablePrintButton(),this.hideWaitCursor(),a.Qpi(aa)&&(this.$qd=!0,this.aVi()))};a.prototype.hidePreviewError=function(){this.PD.A7a=!1;this.oX.hidePreviewError();this.enablePrintButton()};a.prototype.Fkh=function(){(this.VHb=document.getElementById(a.gNf))&&
this.VHb.parentNode&&this.VHb.parentNode.removeChild(this.VHb)};a.prototype.hideErrorMessageForPrintOptions=function(){this.QD&&this.QD.hideErrorMessageForPrintOptions()};a.prototype.showErrorMessageForPrintOptions=function(J){this.QD&&this.QD.showErrorMessageForPrintOptions(J)};a.prototype.showSpinner=function(){this.PD.A7a||E.EwaSettings.isChangeGateEnabled("OfficeVSO:5547045_ShowLoadingIconOnSettingsChange")&&this.$qd?this.hidePreviewError():this.FL&&(this.FL.style.visibility="hidden");this.oX&&
this.oX.showSpinner()};a.prototype.hideSpinner=function(){this.oX&&this.oX.hideSpinner()};a.prototype.enablePrintButton=function(){this.QD&&this.QD.enablePrintButton();this.isUniversalPrintEnabled&&this.gx&&this.pG.updatePrintButtonEnableDisableState(!0)};a.prototype.disablePrintButton=function(){this.QD&&this.QD.disablePrintButton();this.isUniversalPrintEnabled&&this.gx&&this.pG.updatePrintButtonEnableDisableState(!1)};a.prototype.showWaitCursor=function(){this.QD&&this.QD.showWaitCursor();this.isUniversalPrintEnabled&&
this.gx&&this.pG.updatePrintButtonEnableDisableState(!1)};a.prototype.hideWaitCursor=function(){this.QD&&this.QD.hideWaitCursor();this.isUniversalPrintEnabled&&this.gx&&this.pG.updatePrintButtonEnableDisableState(!0)};a.prototype.bch=function(){if(this.gx)w.ULS.sendTraceTag(591927430,0,10,"PrintPreviewerPane:CreatePrintPreviewerContainer - printPreviewerContainer should be null");else if(this.gx=document.createElement("div"),this.gx.id=a.gNf,this.gx.classList.add(a.m6i),this.$.zr.insertBefore(this.gx,
this.$.zr.firstChild),r.AFrameworkApplication.sa&&r.AFrameworkApplication.sa.Qa.eh){var J=document.getElementById(S.a.kHa);J&&(this.gx.style.top=J.clientHeight+"px",this.gx.style.height="calc(100% - "+J.clientHeight+"px)")}};a.prototype.enterPrintPreviewHeaderFocusTrapZone=function(){this.pG.enterPrintPreviewHeaderFocusTrapZone()};a.prototype.enterPrintSettingsTaskPaneFocusTrapZone=function(){this.pG.enterPrintSettingsTaskPaneFocusTrapZone()};a.prototype.W3i=function(){var J=this;this.$.da.Ya(15,
function(aa){J.ewaAccessibilityManager=aa;J.ewaAccessibilityManager.mode=3})};a.prototype.dch=function(){this.yId=new m(this);this.vId=new n(this);this.uId=new h(this)};a.prototype.iLd=function(){this.yId.Xg();this.vId.Xg();this.uId.Xg();this.W3i()};a.prototype.S_d=function(){this.yId.Q8();this.vId.Q8();this.uId.Q8();H.g(this.$).s1();this.ewaAccessibilityManager&&(this.ewaAccessibilityManager.mode=0)};a.prototype.TL=function(){this.Prc=t.a.instance.Gd(this.FL);this.Prc.ka("load",this.ZCf)};a.prototype.LTj=
function(){this.Prc&&this.FL&&this.Prc.detach("load")};a.prototype.MRd=function(){if(this.Wxa){var J=document.getElementById(a.xId);J&&(J=A.DOMElementExtensions.getElementById(J,a.aNf))&&(this.Wxa=!1,J.focus())}};a.prototype.aVi=function(){this.PD.A7a=!1;this.enablePrintButton();this.MRd()};a.prototype.Zbh=function(){var J=this;if(E.EwaSettings.isChangeGateEnabled("OfficeVSO:6068952_FixJSCrahInPrintPreview")){var aa=v.GetServiceTaskFactory.Ua(this.$.da,283,284,0).result.ho;aa.loadScript("excel-print-preview-sprite").then(function(){aa.loadScript("printPreviewer").then(function(){aa.loadScript("excelPrintPreviewer").then(function(){J.xIe()})},
function(){w.ULS.sendTraceTag(525358669,0,10,"PrintPreviewPane.createPreviewerPanes: Failed to load printPreviewer script required for excelPrintPreviewer.")})},function(){w.ULS.sendTraceTag(525358668,0,10,"PrintPreviewPane.createPreviewerPanes: Failed to load excelPrintPreviewSprite script required for excelPrintPreviewer.")})}else v.GetServiceTaskFactory.Ua(this.$.da,283,284,0).result.ho.loadScript("excelPrintPreviewer").then(function(){J.xIe()})};a.prototype.xIe=function(){var J=this,aa=this.$.Sb.Hc("UserAction",
"createEmptyPreviewerStopwatch");this.bch();this.cch();this.isUniversalPrintEnabled?this.pG.createEmptyPrintPreviewPaneAsync(this.gx,this.wIe()).then(function(){aa.stop();J.hFe();J.pG.updatePrintButtonEnableDisableState(!1)}):(this.pG.createEmptyPrintPreviewPane(this.gx,this.wIe()),aa.stop(),this.hFe())};a.prototype.hFe=function(){var J=this.$.Sb.Hc("UserAction","createPdfPreviewPaneStopwatch"),aa=document.getElementById(a.uGd);this.useMSPdfViewer&&(aa.tabIndex=0);this.Mbh();this.Lbh(aa);J.stop();
this.raiseEvent(a.MEb,new u(0))};a.prototype.cch=function(){this.pG||(this.pG=printPreviewer.PrintPreviewPaneControllerFactoryGlobal.createPrintPreviewPaneController());this.pG||w.ULS.sendTraceTag(537154203,0,10,"PrintPreviewerPane:CreatePrintPreviewerController - printPreviewerController should not be null")};a.prototype.ech=function(){this.QD||(this.QD=excelPrintPreviewer.PrintUIControllerFactoryGlobal.createPrintSettingsTaskPaneController());this.QD||w.ULS.sendTraceTag(537154202,0,10,"PrintPreviewerPane:CreatePrintSettingsPaneController - printSettingsPaneController should not be null")};
a.prototype.Mbh=function(){this.oX||(this.oX=excelPrintPreviewer.PrintUIControllerFactoryGlobal.createPrintPreviewController());this.oX||w.ULS.sendTraceTag(537154201,0,10,"PrintPreviewerPane:CreatePdfPreviewPaneController - pdfPreviewerPaneController should not be null")};a.prototype.Lbh=function(J){this.oX.createPrintPreviewPane(J,this.peh());this.useMSPdfViewer||(this.FL=A.DOMElementExtensions.getElementById(this.gx,a.GKf),this.FL.title=C.a.instance.fa(1169),this.TL())};a.prototype.fch=function(){var J=
"en-US";var aa=this.$.ya.IsMetricMeasurementUnit;this.$.ya.DataCultureTag?J=this.$.ya.DataCultureTag:w.ULS.sendTraceTag(536994563,0,50,"PrintPreviewerPane:createPrintSettingsProps - DataCultureTag in ewaControl.bootstrapContext is nullable");return Object.assign(new e,{whatToPrintOptions:this.PD.Ev.whatToPrintOptions,orientationOptions:this.PD.Ev.orientationOptions,paperSizeOptions:this.PD.Ev.paperSizeOptions,scalingOptions:this.PD.Ev.scalingOptions,marginDetailedOptions:this.PD.$Xh(),selectedPrintSettingsValues:this.PD.R_h(),
printSettingsTaskPaneCallbacks:this.PD.P_h(),logger:new B.a,shouldDisableCurrentSelection:this.PD.kzc(),isViewMode:!this.$.isEditMode,isMetricMeasurementUnit:aa,dataCultureTag:J,isUniversalPrintFlowEnabled:this.isUniversalPrintEnabled})};a.prototype.wIe=function(){return this.isUniversalPrintEnabled?this.PD.N_h():Object.assign(new ea.a,{backActionButtonText:C.a.instance.fa(1167),printPreviewPaneCallbacks:this.PD.E5e(),logger:new B.a,disableTellMeControl:!0})};a.prototype.peh=function(){var J=this;
return this.useMSPdfViewer?Object.assign(new c,{useMSPdfViewer:!0,msPdfViewerFileUrl:this.$ah(),onPdfLoad:function(){J.onPdfLoad()}}):Object.assign(new c,{useMSPdfViewer:!1})};a.prototype.$ah=function(){return Object.assign(new l,{pdfViewerWorkerUrl:this.$.ya.PrintPreviewerPdfViewerWorkerUrl,msPdfKitJSUrl:this.$.ya.PrintPreviewerMSPdfKitJsUrl,msPdfKitWasmUrl:this.$.ya.PrintPreviewerMSPdfKitWasmUrl})};a.prototype.J3f=function(J){this.gx&&this.pG.setAdditionalHeaderText(J)};a.Qpi=function(J){return 3===
J||2===J};a.gNf="PrintPreviewerContainer";a.xId="printSettingsTaskPaneId";a.uGd="previewId";a.GKf="printpreviewiframe";a.k6i="printPreviewHeaderId";a.aNf="printButton";a.m6i=I.a.gx;a.MEb="pppnosu";Object(z.a)(a,"PrintPreviewPane",y.a,[712])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.kmhv.js.map/7883cc990f21238fea04aa19785de5a4/EwaDS.kmhv.js.map