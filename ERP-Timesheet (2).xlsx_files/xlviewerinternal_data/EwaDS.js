/*
 The buffer module from node.js, for the browser.

 @author   Feross Aboukhadijeh <http://feross.org>
 @license  MIT
 ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[8],{1020:function(z,F,b){function a(e,l,m){this.QRb=e;this.qog=l;this.rog=m}function c(){this.title=this.id=this.tabs=null}z=b(0);Object(z.a)(c,"AddInDataTransferObject",null,[]);b.d(F,"a",function(){return a});a.nwb=function(e){return(e=e.hX)?Object.assign(new c,{tabs:e.gs.toArray(),id:e.sFg,title:e.tFg}):null};uk.Object.defineProperties(a.prototype,{gs:{configurable:!0,enumerable:!0,get:function(){return this.QRb}},sFg:{configurable:!0,
enumerable:!0,get:function(){return this.qog}},tFg:{configurable:!0,enumerable:!0,get:function(){return this.rog}}});Object(z.a)(a,"OneLineRibbonExtensibility",null,[])},1026:function(z,F,b){function a(){var e={};this.icd=(e.tabhome="Ribbon.Home",e.tabinsert="Ribbon.Insert",e.tabdata="Ribbon.Data",e.tabreview="Ribbon.Review",e.tabview="Ribbon.View",e);e={};this.gcd=(e.tabpagelayoutexcel=["Ribbon.PageLayoutExcel",c.a.instance.fa(1588),c.a.instance.fa(1592)],e.tabformulas=["Ribbon.Formulas",c.a.instance.fa(1589),
c.a.instance.fa(1593)],e.tabdeveloper=["Ribbon.Developer",c.a.instance.fa(1590),c.a.instance.fa(1594)],e.tabaddins=["Ribbon.AddIns",c.a.instance.fa(1591),c.a.instance.fa(1595)],e);this.dDh="Ribbon.Home Ribbon.Insert Ribbon.PageLayoutExcel Ribbon.Formulas Ribbon.Data Ribbon.Review Ribbon.View Ribbon.Developer Ribbon.AddIns".split(" ");this.K3a=null}b.d(F,"a",function(){return a});z=b(0);var c=b(14);a.prototype.hYh=function(){if(this.K3a)return this.K3a;this.K3a={};for(var e=Cl(Object.keys(this.icd)),
l=e.next();!l.done;l=e.next())l=l.value,this.K3a[l]=this.icd[l];e=Cl(Object.keys(this.gcd));for(l=e.next();!l.done;l=e.next())l=l.value,this.K3a[l]=this.gcd[l][0];return this.K3a};uk.Object.defineProperties(a.prototype,{Zia:{configurable:!0,enumerable:!0,get:function(){return"SourceControlId"}},TK:{configurable:!0,enumerable:!0,get:function(){return"Workbook"}},formFactor:{configurable:!0,enumerable:!0,get:function(){return"DesktopFormFactor"}},EBc:{configurable:!0,enumerable:!0,get:function(){return this.icd}},
Jab:{configurable:!0,enumerable:!0,get:function(){return this.dDh}},UFi:{configurable:!0,enumerable:!0,get:function(){return this.gcd}}});Object(z.a)(a,"AddinCommandsStringProvider",null,[991])},1060:function(z,F,b){function a(O,ea,Z){Z=void 0===Z?null:Z;this.XGc=new r.a;var S=new u.a;ea&&S.add(ea.zCi);Z&&S.addRange(Z);this.an=O;this.PBg=S}function c(O,ea,Z,S){this.mU=new u.a;this.cH=new u.a;this.Bqa=null;this.Lmb=new u.a;this.ude=Promise.resolve(null);this.Qke=!1;this.qXb=ea;this.Zqg=O;this.rle=
Z;this.vog=S}function e(){var O=l.call(this)||this;O.errorCode=0;return O}function l(){this.vSb=new u.a;this.K$=this.J$=!1;this.vpa=this.authChallenge=null;this.startTime=this.retryCount=0;this.yse=null}function m(){this.token=null;this.expiresOn=0;this.fia=this.authChallenge=null}function n(){this.accessToken=null}function h(){this.startTime=0;this.callback=null}b.r(F);z=b(0);var u=b(199),w=b(13),r=b(97);Object(z.a)(h,"SSOCallbackInfo",null,[]);Object(z.a)(n,"AccessTokenInformation",null,[145]);
var B=b(1188);Object(z.a)(m,"CachedTokenInfo",null,[]);uk.Object.defineProperties(l.prototype,{callbacks:{configurable:!0,enumerable:!0,get:function(){return this.vSb}}});Object(z.a)(l,"SSORequestInfo",null,[]);Am(e,l);Object(z.a)(e,"SSOFailedRequestInfo",l,[]);var y=b(4);c.prototype.eDj=function(O){if(this.Bqa&&this.Bqa.authChallenge===O.authChallenge){if(Date.now()/1E3+c.XDi>this.Bqa.expiresOn)return this.Bqa=null,!1;O=new B.a;O.token=this.Bqa.token;O.expiresOn=this.Bqa.expiresOn;O.fia=this.Bqa.fia;
O.FUa=!0;O.Wxb=0;this.ryb(O);return!0}return!1};c.prototype.HBj=function(O){for(var ea=0;ea<this.cH.count;ea++)if(this.cH.pa(ea).authChallenge===O.authChallenge&&this.cH.pa(ea).vpa===O.vpa){var Z=void 0;(Z=this.cH.pa(ea)).retryCount=Z.retryCount+1;O.retryCount=this.cH.pa(ea).retryCount;if(this.cH.pa(ea).retryCount<c.tEi||!this.cH.pa(ea).J$&&O.J$||!this.cH.pa(ea).K$&&O.K$){if(!this.cH.pa(ea).J$&&O.J$||!this.cH.pa(ea).K$&&O.K$)O.retryCount=0;this.cH.removeAt(ea);break}O=new B.a;O.errorCode=this.cH.pa(ea).errorCode;
this.ryb(O);return!0}return!1};c.prototype.iHg=function(O,ea){for(var Z=0;Z<this.cH.count;Z++)if(this.cH.pa(Z).vpa===O.vpa&&this.cH.pa(Z).authChallenge===O.authChallenge)return;this.cH.add(Object.assign(new e,{J$:O.J$,K$:O.K$,authChallenge:O.authChallenge,vpa:O.vpa,errorCode:ea,retryCount:O.retryCount}))};c.prototype.Rfd=function(O,ea,Z,S,I,P){var J=this,aa=b(1060).AppsForOfficeSingleSignOnManager;""===Z&&(Z=null);if(this.Qke)aa.B6(P,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null);
else{for(var ia=null,ba=Cl(this.mU),ra=ba.next();!ra.done;ra=ba.next())if(ra=ra.value,ra.J$===O&&ra.K$===ea&&ra.authChallenge===Z&&ra.vpa===I){ia=ra;break}ia||(ia=Object.assign(new l,{J$:O,K$:ea,authChallenge:Z,yse:S,vpa:I,retryCount:0,startTime:aa.Hw()}),this.mU.add(ia));ia.retryCount=0;ia.callbacks.add(P);this.ude=this.ude.then(function(){var ka=b(1060).AppsForOfficeSingleSignOnManager;if(0<J.mU.count){var da=J.mU.pa(0);if(J.eDj(da)||J.HBj(da))return null;for(var ha=0;ha<J.Lmb.count;)J.Lmb.pa(ha)+
c.GOj<ka.Hw()?J.Lmb.removeAt(ha):ha++;if(J.Lmb.count>=c.oEi||J.mU.count>=c.UDi)return da=new B.a,da.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOCallThrottled,J.ryb(da),null;var qa=null;y.AFrameworkApplication.sa&&(ka=y.AFrameworkApplication.sa.gE)&&(qa=ka.Hc("ComponentAttach",J.Zqg+c.KAg));return da.vpa.lDg(J.resource,da.J$,da.K$,da.authChallenge,J.vog,da.yse).then(function(Aa){qa&&qa.stop();J.ryb(Aa)},function(){qa&&qa.stop();var Aa=new B.a;Aa.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;
J.ryb(Aa)})}return null})}};c.prototype.ryb=function(O){var ea=b(1060).AppsForOfficeSingleSignOnManager;try{if(this.mU.count){var Z=this.mU.pa(0);this.mU.removeAt(0);var S=null;O.errorCode||(S=new n,S.accessToken=O.token);O.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl&&O.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant&&O.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError&&O.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError||
this.iHg(Z,O.errorCode);var I={};null!=O.Wxb&&(I.getTokenSilentTime=O.Wxb.toString());null!=O.Akd&&(I.getTokenPopupTime=O.Akd.toString());null!=O.bid&&(I.getIDTokenTime=O.bid.toString());null!=O.FUa&&(I.tokenCached=O.FUa.toString());O.qYd&&(I.detailedError=O.qYd);O.fia&&(I.authLibrary=O.fia);Z.retryCount&&(I.retryCount=Z.retryCount);for(var P=Cl(Z.callbacks),J=P.next();!J.done;J=P.next())ea.B6(J.value,O.errorCode,S,I);null!=O.FUa&&O.FUa||this.Lmb.add(Z.startTime);if(!O.errorCode)for(null!=O.expiresOn&&
(this.Bqa=Object.assign(new m,{token:O.token,expiresOn:O.expiresOn,authChallenge:Z.authChallenge,fia:O.fia})),this.cH.clear(),P=0;P<this.mU.count;)if(this.mU.pa(P).authChallenge===Z.authChallenge){var aa=Cl(this.mU.pa(P).callbacks);for(J=aa.next();!J.done;J=aa.next())ea.B6(J.value,O.errorCode,S,I);this.mU.removeAt(P)}else P++}}catch(ia){w.ULS.sendTraceTag(21628945,344,10,"ReceivedAccessTokenHandler: exception message: {0}",ia.message)}};c.prototype.shutdown=function(){this.Qke=!0;this.mU.clear()};
uk.Object.defineProperties(c.prototype,{resource:{configurable:!0,enumerable:!0,get:function(){return this.qXb}}});c.GOj=6E4;c.oEi=6;c.UDi=6;c.tEi=3;c.XDi=300;c.KAg="GetAccessToken";Object(z.a)(c,"SSOCallbackManager",null,[]);var v=b(930),A=b(942),t=b(122),E=b(79),C=b(23),H=b(28),U=b(153),Q=b(354);b.d(F,"AppsForOfficeSingleSignOnManager",function(){return a});a.prototype.Sfd=function(O,ea,Z,S,I,P,J,aa,ia,ba){ba=Object.assign(new h,{startTime:a.Hw(),callback:ba});try{var ra=!!Z&&""!==Z,ka=ba.startTime,
da=this.getOsfControl(O),ha=da.getStoreType()||"",qa=da.getOwnerAddinStoreType()||"",Aa=da.getSolutionId()||"",Fa=da.getVersion()||"";ha=ha.toLowerCase();qa=qa.toLowerCase();Aa=Aa.toLowerCase();var ab=E.a.aid(ea)||"",Ua=E.a.aid(da.getIframeUrl())||"",bb=ab.toLowerCase()===Ua.toLowerCase();ab=ha;"inmemory"===ha&&(ab=qa);var xa=Telemetry.PrivacyRules.GetAssetId(ab,da.getStoreId(),Aa);da={};var Gb=(da.callInstanceId=ka.toString(),da.controlAssetId=xa,da.controlVersion=Fa,da.storeType=ha,da.ownerStoreType=
qa,da.allowConsentPrompt=S.toString(),da.forMSGraphAccess=I.toString(),da.allowSignInPrompt=P.toString(),da.hasAddinAuthChallenge=ra.toString(),da.securityOriginEqualsSourceLocation=bb.toString(),da.singleSignOnEnabled=J.toString(),da.accountTypeFilter=aa||"",da);w.ULS.sendTraceTag(51401115,344,50,"{0}",Gb);U.a.sendTelemetryEvent(Object.assign(new Q.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2Start",dataFields:t.a.gl(Gb)}));ka=!0;var $b=y.AFrameworkApplication.ha.Wa("HostAuthType");switch(aa){case "aad":ka=
"aad"===$b;break;case "msa":ka="msa"===$b;break;default:ka=!aa||"noFilter"===aa}if(ka){aa=null;if(J)for(var oa=Cl(this.PBg),Ma=oa.next();!Ma.done;Ma=oa.next()){var Za=Ma.value;if(Za.zmi(Aa)){aa=Za;break}}aa?this.isSSOAddin(O)?(J=!0,"omex"===ab&&(J=!1),"spapp"===ab||"spcatalog"===ab?(w.ULS.sendTraceTag(594043737,344,10,"GetAccessToken: SharePoint catalog add-ins not supported."),a.B6(ba,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):I&&!J?(w.ULS.sendTraceTag(51234570,344,
10,"GetAccessToken: Store add-ins do not support tokens for graph access."),a.B6(ba,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):(I&&"exchange"===ab&&(S=!1),this.Rfd(O,ea,Z,ab,S,P,ia,aa,ba))):(w.ULS.sendTraceTag(22402395,344,10,"GetAccessToken: current Addin is not a SSO Addin."),a.B6(ba,OSF.DDA.ErrorCodeManager.errorCodes.ooeNotSSOAgave,null,null)):a.B6(ba,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)}else a.B6(ba,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedUserIdentity,
null,null)}catch(gb){this.cmc(),w.ULS.sendTraceTag(22402397,344,10,"GetAccessToken: action failed. Exception message: {0}",gb.message),a.B6(ba,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null)}};a.prototype.getAccessToken=function(O,ea,Z,S){this.Sfd(O,Z[v.a.oYc]||null,Z[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AuthChallenge]||null,Z[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowConsentPrompt]||!1,Z[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.ForMSGraphAccess]||
!1,Z[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowSignInPrompt]||!1,ea,Z[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AccountTypeFilter]||null,Z[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AddinTrustId]||null,S)};a.prototype.Rfd=function(O,ea,Z,S,I,P,J,aa,ia){this.XGc.xb(O)?S=this.XGc.pa(O):(S=new c(O,this.getWebApplicationResource(O).split(",")[0],S,this.getDefaultDisplayName(O)),this.XGc.add(O,S));var ba=S.resource;O=a.c1h(ba,this.getWebApplicationId(O));var ra=OfficeExt.WACUtils.getHostSecure(ea);
O&&ra?O.toLowerCase()===ra.toLowerCase()?S.Rfd(I,P,Z,J,aa,ia):(a.$Oa('SSO Resource "'+ba+'" cannot be used from "'+ea+'" origin due to domain mismatch.'),w.ULS.sendTraceTag(22402396,344,10,"GetAccessToken: current Addin's host does not match its Web Application's resource."),a.B6(ia,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null)):(O||w.ULS.sendTraceTag(594118746,344,10,"Invalid resource URL for SSO."),ra||w.ULS.sendTraceTag(594118745,344,10,"Invalid page URL for SSO."),a.B6(ia,
OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null))};a.prototype.cmc=function(){var O={};w.ULS.sendTraceTag(39068820,344,50,"Browser information: {0}",(O.UserAgent=window.navigator.userAgent,O))};a.prototype.getOsfControl=function(O){return this.an.getOsfControl(O)};a.prototype.isSSOAddin=function(O){return this.getOsfControl(O).getManifest().isSSOAddin()};a.prototype.getWebApplicationId=function(O){return this.getOsfControl(O).getManifest().getWebApplicationId()};a.prototype.getWebApplicationResource=
function(O){return this.getOsfControl(O).getManifest().getWebApplicationResource()};a.prototype.getDefaultDisplayName=function(O){return this.getOsfControl(O).getManifest().getDefaultDisplayName()};a.I2h=function(){try{var O={};C.a.Yla&&A.a.gzb&&(O.UiHostSupportsAuthTokenAddinList=a.XXe);O.UiHostSupportsAuthToken=A.a.gzb;return O}catch(ea){w.ULS.sendTraceTag(561860814,344,10,"GetSingleSignOnRuntimeSettings: exception message: {0}",ea.message)}return null};a.getInstance=function(O,ea,Z){a.Na||(a.Na=
new a(O,void 0===Z?null:Z));return a.Na};a.$Oa=function(O){window.console.warn&&window.console.warn(O)};a.c1h=function(O,ea){if(!O)return"";ea||(ea="");var Z=O.toLowerCase(),S=ea.toLowerCase();RegExp("^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$").test(S)||(a.$Oa('SSO App Id "'+ea+'" is not a valid format. It will be rejected from store submission.'),w.ULS.sendTraceTag(590962907,344,10,"App id does not match a GUID."));Z.endsWith(S)||(a.$Oa('SSO Resource "'+O+'" does not end with App Id "'+
ea+'". It will be rejected from store submission.'),w.ULS.sendTraceTag(590962908,344,10,"Resource does not end with app id."));if(!Z.startsWith("https://")&&!Z.startsWith("api://"))return a.$Oa('SSO Resource "'+O+'" must be https:// or api:// protocol.'),w.ULS.sendTraceTag(590962909,344,10,"Resource not using https or api protocol."),"";for(ea=0;ea<O.length;ea++){S=O.charAt(ea);var I=H.a.charCodeAt(O,ea);if(33>I||126<I||"&"===S||"?"===S||"#"===S||"%"===S||"\\"===S)return a.$Oa('SSO Resource "'+O+
'" contains an invalid character "'+S+'".'),w.ULS.sendTraceTag(590962910,344,10,"Invalid character '"+S+"' in resource URI."),""}if(0<=O.indexOf("::"))return a.$Oa('SSO Resource "'+O+'" contains an invalid string "::".'),w.ULS.sendTraceTag(590962911,344,10,":: in resource URI."),"";if(120<O.length)return a.$Oa('SSO Resource "'+O+'" is '+O.length+" characters and exceeds the max length of 120 characters."),w.ULS.sendTraceTag(590962912,344,10,"Length of resource: "+O.length+"."),"";Z.startsWith("api://")&&
(Z="https://"+Z.substring(6,Z.length));return 8===Z.length?"":OfficeExt.WACUtils.getHostSecure(Z)||""};a.B6=function(O,ea,Z,S){var I=O.startTime,P=0;0<I&&(P=a.Hw()-I);var J={};I=(J.callInstanceId=I.toString(),J.callDuration=P.toString(),J.errorCode=ea.toString(),J);if(S)for(var aa in S)I[aa]=S[aa];w.ULS.sendTraceTag(51401116,344,50,"{0}",I);U.a.sendTelemetryEvent(Object.assign(new Q.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2End",dataFields:t.a.gl(I)}));O.callback(ea,Z)};a.Hw=function(){try{if(window.performance&&
window.performance.now)return window.performance.now()}catch(O){}return Date.now()};a.XXe="wa200000047 wa104381973 42de5e8d-cfa0-459d-813d-cf777d47ada0 97d94c7b-54e5-4098-8dbb-b486b6c1f049 wa104381526 d98404ac-f9e2-4292-8cb6-eec349559ae5".split(" ");a.Na=null;Object(z.a)(a,"AppsForOfficeSingleSignOnManager",null,[89])},1083:function(z,F,b){function a(){this.NMa=0;this.tia=this.buttonText=this.description=this.title=this.id=null;this.errorCode=0;this.$fc=!1;this.Lcf=this.qja=null}b.d(F,"a",function(){return a});
z=b(0);Object(z.a)(a,"AddInCommandsNotificationParameters",null,[])},1142:function(z,F,b){function a(){}function c(){}function e(P,J,aa,ia,ba,ra){P=l.call(this,P,J,aa,ia,ba,void 0===ra?null:ra)||this;P.dWb=null;return P}function l(P,J,aa,ia,ba,ra){P=m.call(this,P,aa,ba.gY,void 0===ra?null:ra)||this;P.Yee=0;P.h2=P.mYh(ia);P.pZa=J;P.jf=ba;P.HPj=7;P.tl=P.pZa.ownerDocument.createElement("div");P.tl.className="ModalCalloutControlOverlay";P.tl.tabIndex=0;P.pZa.insertBefore(P.tl,P.pZa.firstChild);return P}
function m(P,J,aa,ia){var ba=B.call(this,document.createElement("div"))||this;ba.Wra=null;ba.yqa=null;ba.dH=null;ba.ZG=null;ba.ux=null;ba.RT=null;ba.UT=null;ba.jra=!1;ba.ukb=!1;ba.Zp=null;ba.content=null;ba.h2=0;ba.exe=null;ba.TU=0;ba.lHf=null;ba.Qle=P;ba.Uge=J;ba.jQ=aa;ba.dIa=ia;ba.Fg=J.ownerDocument;ba.Lkb=!1;ba.rv=!1;ba.Dmd=!1;return ba}z=b(0);var n=b(13),h=b(82),u=b(156),w=b(12),r=b(90),B=Sys.UI.Control;Am(m,B);m.prototype.show=function(){this.Lkb||(this.l$g(),this.Rj(),this.Uge.appendChild(this.jX),
this.jX.style.display="Block",this.Ayj(),this.Lkb=!0,this.lHf&&this.lHf())};m.prototype.dismiss=function(){this.Lkb&&(this.pN(),this.Uge.removeChild(this.jX),this.Lkb=!1,this.dIa&&this.dIa())};m.prototype.dispose=function(){this.dismiss();this.RT=this.ux=this.ZG=this.yqa=this.dH=this.Wra=null;Sys.Component.prototype.dispose.call(this)};m.prototype.vi=function(P){return this.get_element().id+P};m.prototype.l$g=function(){this.dH=this.Fg.createElement("div");this.dH.id=this.vi("WACCalloutHeader");this.dH.className=
"WACCalloutHeader";this.rv&&this.epe();this.Dmd&&this.rqe();this.ZG=this.Fg.createElement("div");this.ZG.id=this.vi("WACCalloutContent");this.ZG.className="WACCalloutContent";this.ZG.style.width=190<this.h2?this.h2-26+"px":"164px";this.ZG.appendChild(this.content);this.jX.appendChild(this.i2b);this.jX.appendChild(this.dH);this.jX.appendChild(this.ZG)};m.prototype.epe=function(){this.ux=this.Fg.createElement("a");this.ux.className="WACCalloutCloseAnchor";this.ux.id=this.vi("WACCalloutCloseAnchor");
this.ux.href="#";this.dH.appendChild(this.ux);var P=u.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","WACCalloutCloseIcon",!0,CommonUIStrings.l_DialogClose);this.ux.appendChild(P)};m.prototype.rqe=function(){this.RT=this.Fg.createElement("div");this.RT.className="WACCalloutTitle UIFontBold";this.RT.style.width=190<this.h2?this.h2-30+"px":"160px";this.RT.id=this.vi("WACCalloutTitle");this.RT.innerText=this.title;this.dH.contains(this.ux)?this.dH.insertBefore(this.RT,this.ux):this.dH.appendChild(this.RT)};
m.prototype.Ayj=function(){var P=this.Qle;if(1===this.TU){var J=this.exe.y+16;var aa=-16}else 2===this.TU||3===this.TU||0===this.TU?(J=P.y+P.height+15,aa=-15):(J=P.y-this.jX.clientHeight-15-2,aa=this.jX.clientHeight-1);this.jX.style.top=J+"px";this.i2b.style.top=aa+"px";1===this.TU?(P=this.exe.x-16,this.jX.style.left="50%",this.jX.style.marginLeft=-this.h2/2+"px",J=Sys.UI.DomElement.getBounds(this.jX),this.i2b.style.left=P-J.x+"px"):(J=P.x+this.Qle.width/2,2===this.TU||5===this.TU?(P=20,J-=36):0===
this.TU||4===this.TU?(P=this.h2/2-16,J-=this.h2/2):(P=this.h2-20-32,J=J-this.h2+36),this.jX.style.left=J+"px",this.i2b.style.left=P+"px")};m.prototype.Rj=function(){this.rv&&!this.UT&&(this.UT=Object(h.a)(this,this.maa,"closeHandler"),this.jQ.qa(w.a.click,this.ux,this.UT,null))};m.prototype.pN=function(){this.rv&&this.UT&&(this.jQ.za(w.a.click,this.ux,this.UT),this.UT=null)};m.prototype.maa=function(){this.dismiss();return!0};uk.Object.defineProperties(m.prototype,{jX:{configurable:!0,enumerable:!0,
get:function(){this.Wra||(this.Wra=this.Fg.createElement("div"),this.Wra.id=this.vi("WACCalloutOuter"),this.Wra.className="WACCalloutOuter",this.Wra.setAttribute(r.a.Vd,r.a.M_a),this.Wra.style.width=this.h2+"px");return this.Wra}},i2b:{configurable:!0,enumerable:!0,get:function(){if(!this.yqa){this.yqa=this.Fg.createElement("div");this.yqa.id=this.vi("WACCalloutBeakContainer");this.yqa.className="WACCalloutBeakContainer";var P="CalloutBeakTopFilled_32x16x32";if(5===this.TU||6===this.TU||4===this.TU)P=
"CalloutBeakBottomFilled_32x16x32";P=u.createClusteredImage(32,16,P,"WACCalloutBeak",!0,"");this.yqa.appendChild(P)}return this.yqa},set:function(P){this.yqa=P}},rNa:{configurable:!0,enumerable:!0,get:function(){return this.Lkb}},title:{configurable:!0,enumerable:!0,get:function(){return this.Zp},set:function(P){this.Zp!==P&&(this.Zp=P,this.RT&&(this.RT.innerText=this.Zp))}},rv:{configurable:!0,enumerable:!0,get:function(){return this.jra},set:function(P){this.jra!==P&&(this.jra=P,this.dH&&(this.dH.contains(this.ux)&&
!this.jra?this.dH.removeChild(this.ux):!this.dH.contains(this.ux)&&this.jra&&this.epe()))}},Dmd:{configurable:!0,enumerable:!0,get:function(){return this.ukb},set:function(P){this.ukb!==P&&(this.ukb=P,this.dH&&(this.dH.contains(this.RT)&&!this.ukb?this.dH.removeChild(this.RT):!this.dH.contains(this.RT)&&this.ukb&&this.rqe()))}}});Object(z.a)(m,"Callout",Sys.UI.Control,[184]);Am(l,m);l.prototype.show=function(){this.rNa||(this.jf.Csc(),this.jf.GQ(!1),this.tl.style.zIndex=String(this.jf.h3),m.prototype.show.call(this),
this.Ik(),this.Yee=window.setTimeout(Object(h.a)(this,this.dismiss,"dismiss"),1E3*this.HPj))};l.prototype.dismiss=function(){this.rNa&&(this.jf.vN(!1),this.wm(),this.pZa&&this.pZa.contains(this.tl)&&this.pZa.removeChild(this.tl),m.prototype.dismiss.call(this),window.clearTimeout(this.Yee))};l.prototype.Ik=function(){this.jf.Ysa(Object(h.a)(this,this.dismiss,"dismiss"));this.jf.Wy.qa(w.a.click,this.tl,Object(h.a)(this,this.dd,"onClick"))};l.prototype.wm=function(){this.jf.Hcb(Object(h.a)(this,this.dismiss,
"dismiss"));this.jf.Wy.za(w.a.click,this.tl,Object(h.a)(this,this.dd,"onClick"))};l.prototype.dd=function(){this.dismiss();return!0};l.prototype.mYh=function(P){var J=0;switch(P){case 0:J=190;break;case 1:J=250;break;case 2:J=300;break;case 3:J=360}return J};Object(z.a)(l,"ModalCallout",m,[]);var y=b(627),v=b(201);Am(e,l);e.prototype.show=function(){var P=this;if(!this.rNa){var J=Object.assign(new y.a,{onShow:function(){l.prototype.show.call(P)}});v.UISurfaces.hW().then(function(aa){var ia=aa.externalNotification();
P.dWb=aa.addNotification(ia,J);return null},function(aa){n.ULS.sendTraceTag(593352345,383,15,"Failed to GetNotificationsAPIAsync: {0}",aa);return null})}};e.prototype.dismiss=function(){var P=this;this.rNa&&this.dWb&&(v.UISurfaces.hW().then(function(J){J.removeNotification(P.dWb);return P.dWb=null},function(J){n.ULS.sendTraceTag(593352344,383,15,"Failed to GetNotificationsAPIAsync: {0}",J);return null}),l.prototype.dismiss.call(this))};Object(z.a)(e,"ReactManagedModalCallout",l,[]);var A=b(4);c.Wah=
function(P,J,aa,ia){var ba=void 0===ba?null:ba;return A.AFrameworkApplication.sa.Qa.iS?new e(P,J,aa,ia,A.AFrameworkApplication.sa,ba):new l(P,J,aa,ia,A.AFrameworkApplication.sa,ba)};Object(z.a)(c,"ModalCalloutControlFactory",null,[]);var t=b(50),E=b(1072),C=b(641),H=b(1073),U=b(133),Q=b(55),O=b(37),ea=b(84),Z=b(943),S=b(1020),I=b(906);b.d(F,"a",function(){return a});a.T5c=function(P,J,aa,ia,ba,ra){a.LJ&&a.LJ.rNa&&a.LJ.dismiss();a.LJ=c.Wah(J,P,P,ba);a.LJ.content=aa;I.b(ia)||(a.LJ.title=ia,a.LJ.Dmd=
!0);P=new Sys.UI.Bounds(0,0,Q.a.Q5a(),Q.a.vec());a.LJ.TU=a.bQh(P,J,a.LJ.h2,ra);a.LJ.show();a.E1b&&a.E1b.sendNotification(aa.innerText,!0)};a.V5c=function(P,J,aa,ia){ia=void 0===ia?null:ia;v.UISurfaces.hW().then(function(ba){var ra=null;a.Imb&&(ba.removeNotification(a.Imb),a.Imb=null);var ka=ba.callout(Object.assign(new E.a,{target:P,title:J,content:aa,showCloseIcon:!0,hasDynamicSizing:!0,jumpToCalloutTargetButtonEnabled:!0,calloutProps:Object.assign(new H.a,{onDismiss:function(){ba.removeNotification(ra)},
directionalHint:null!=ia?ia:null})})),da=Object.assign(new y.a,{expirationOptions:Object.assign(new C.a,{displayTimeoutSeconds:7,onExpire:function(){ba.removeNotification(a.Imb)}})});ra=a.Imb=ba.addNotification(ka,da);return null},function(ba){n.ULS.sendTraceTag(593352342,383,15,"Failed to GetNotificationsAPIAsync: {0}",ba);return null})};a.DUd=function(P,J){J=void 0===J?null:J;a.LJ&&a.LJ.rNa&&a.LJ.dismiss();var aa=new U.StandardDialog;aa.FTa=!1;aa.lc=0;aa.lA(t.a.Uvi,CommonUIStrings.l_DialogError,
I.b(P)?a.M1e():P,J)};a.FUd=function(P){a.LJ&&a.LJ.rNa&&a.LJ.dismiss();n.ULS.sendTraceTag(17425951,220,10,String.format("AddinCommandsActivationError : error code {0}.",P.errorCode));var J=I.b(P.description)?a.M1e():P.description,aa=new U.StandardDialog,ia=null;P.tia?(aa.lc=1,aa.Bc(1,P.buttonText),aa.Boa(1)):aa.lc=0;ia=function(ba){1===ba?P.tia():P.qja&&P.qja()};aa.FTa=!1;0===P.NMa?aa.lA(P.errorCode,P.title?P.title:CommonUIStrings.l_DialogError,J,ia):1===P.NMa?aa.$X(P.title?P.title:CommonUIStrings.l_DialogWarning,
J,ia):aa.RBa(P.title?P.title:CommonUIStrings.l_DialogInfo,J,ia)};a.bQh=function(P,J,aa,ia){var ba=0===ia?0:4,ra=P.x+P.width-J.x-J.width;J.x-P.x+J.width/2<=aa/2?ba=0===ia?2:5:ra+J.width/2<=aa/2&&(ba=0===ia?3:6);return ba};a.HEj=function(P,J,aa,ia,ba,ra){ra=void 0===ra?!1:ra;var ka=A.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoLaunchAddinEnabled",!1),da=A.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SkipTeachingCalloutEnabled",!1);
if(a.s1d)(J=S.a.nwb(ia))&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(J,function(Aa){Aa&&(ka&&da&&ra||a.V5c(Aa,ba,aa,5))});else if(P)if(ia&&ia.tabs.count){ia=ia.tabs.pa(0);var ha=ia.nUa[Z.a.id],qa=ia.NK.pa(0).Vwa[Z.a.id];P.uQd(ha)&&(P=ia.isOfficeTab?P.QVh(ha,qa):P.F3h(ha))&&(P.x+P.width/2>Q.a.Q5a()&&(P=new Sys.UI.Bounds(Q.a.Q5a(),P.y+P.height,0,0)),ka&&da&&ra||a.T5c(J,P,a.Hye(aa),ba,2,0))}else n.ULS.sendTraceTag(17326355,220,50,
"There is no tab or group added to ribbon !");else n.ULS.sendTraceTag(594830283,220,50,"ribbonRoot is null, preventing finding the tab or group to which the callout should point.")};a.IEj=function(P,J,aa,ia,ba){ba=void 0===ba?!1:ba;a.HEj(P,J,ia.startedNode?ia.startedNode.description:String.format(CommonUIStrings.l_NewAddInLoadedContent,aa),ia,ia.startedNode?ia.startedNode.title:String.format(CommonUIStrings.l_NewAddInLoadedTitle,aa),ba)};a.GEj=function(P,J,aa,ia){if(a.s1d)P=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentOuterString,
String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,aa,ia,CommonUIStrings.l_InsertionDialogRefresh)),a.V5c(J,P,CommonUIStrings.l_ErrorLoadingAddInsTitle,1);else{J=O.a.Rn(J);var ba=CommonUIStrings.l_ErrorLoadingAddInsContentOuterString.split("{0}"),ra=document.createElement("span");ra.innerText=ba[0];var ka=document.createElement("span");ka.innerText=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,aa,ia,CommonUIStrings.l_InsertionDialogRefresh);ka.className="UIFontBold";
aa=document.createElement("span");aa.innerText=ba[1];ia=document.createElement("div");Sys.UI.DomElement.addCssClass(ia,"ModalCalloutControl");ia.appendChild(ra);ia.appendChild(ka);ia.appendChild(aa);a.T5c(P,J,ia,CommonUIStrings.l_ErrorLoadingAddInsTitle,3,1)}};a.bGj=function(P,J){var aa=CommonUIStrings.l_InstallingCustomFunctionsErrorCalloutMsg,ia=CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg;a.s1d?a.V5c(J,aa,ia):(J=O.a.Rn(J),a.T5c(P,J,a.Hye(ia),aa,3,1))};a.Hye=function(P){var J=document.createElement("div");
Sys.UI.DomElement.addCssClass(J,"ModalCalloutControl");J.innerText=P;return J};a.M1e=function(){return CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive};uk.Object.defineProperties(a,{E1b:{configurable:!0,enumerable:!0,get:function(){return a.Tfa||(a.Tfa=ea.a.instance.Nh("Common.Utils.IAriaNotifier"))}},s1d:{configurable:!0,enumerable:!0,get:function(){return A.AFrameworkApplication.sa.Qa.Wi&&A.AFrameworkApplication.sa.Qa.iS}}});a.LJ=null;a.Imb=null;a.Tfa=null;Object(z.a)(a,
"AddInCommandsNotificationFactory",null,[])},1152:function(z,F,b){function a(v,A,t,E,C){this.it=v;this.EJ=t;this.w2=E;this.ee=C;this.ajb=this.EJ.Ni;this.ez=this.ajb.getOsfControl(A);this.owg=this.ez.getManifest()}function c(v,A,t,E){this._id=v;this.it=A;this.w2=t;this.ee=E}function e(v,A,t,E){this.GA=!1;this._id=v;this.it=A;this.w2=t;this.ee=E}b.r(F);z=b(0);var l=b(13),m=b(1481),n=b(153),h=b(122),u=b(930),w=b(945),r=b(354);e.prototype.setEnabled=function(){};e.prototype._OnAccess=function(){};e.prototype.getTypeName=
function(){return"Microsoft.DynamicRibbon.RibbonButton"};e.prototype.invokePropertyGet=function(v){switch(v){case 3:return this.enabled;case 2:return this.id;case 4:return this.label}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(v);};e.prototype.invokePropertyGetAsync=function(v){v=this.invokePropertyGet(v);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(v)};e.prototype.invokePropertySet=function(v,A){switch(v){case 3:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(A,
0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(v);};e.prototype.invokePropertySetAsync=function(v,A){this.invokePropertySet(v,A);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};e.prototype.invokeMethod=function(v,A){switch(v){case 5:return this.nvj(A);case 1:return this.tDa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(v);};e.prototype.invokeMethodAsync=function(v,A){v=this.invokeMethod(v,A);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(v)};
e.prototype.nvj=function(v){v=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(v,0,"boolean");this.setEnabled(v);return null};e.prototype.tDa=function(){this._OnAccess();return null};uk.Object.defineProperties(e.prototype,{enabled:{configurable:!0,enumerable:!0,get:function(){return this.GA},set:function(v){var A=b(1152).DynamicRibbon,t=this.ee.OwnerAddinStoreType,E=this.ee.PrimaryMarketplace.MarketplaceRef,C={};C=(C.addinAssetId=Telemetry.PrivacyRules.GetAssetId(t,E,this.it),C.ownerAddinAssetId=
Telemetry.PrivacyRules.GetAssetId(t,E,this.ee.OwnerAddinAssetId),C.ownerAddinStoreType=t,C.ribbonControlType="Button",C.toggle=v,C);n.a.sendTelemetryEvent(Object.assign(new r.a,{name:A.ZBc+"ControlUpdate",dataFields:h.a.gl(C)}));this.GA=v;v={};t=(v.DynamicAddinCommandsMethodDispatchId=1,v.SolutionId=this.it,v.PrivacyCompliantSolutionId=Telemetry.PrivacyRules.GetAssetId(t,E,this.it),v.SourceControlId=this.id,v.MethodData=this.GA,v);this.w2.PK(-1014260128,t)}},id:{configurable:!0,enumerable:!0,get:function(){return this._id}},
label:{configurable:!0,enumerable:!0,get:function(){return null}}});Object(z.a)(e,"RibbonButton",null,[]);c.prototype.setVisibility=function(v){var A=b(1152).DynamicRibbon,t=this.ee.OwnerAddinStoreType,E=this.ee.PrimaryMarketplace.MarketplaceRef,C={};C=(C.addinAssetId=Telemetry.PrivacyRules.GetAssetId(t,E,this.it),C.ownerAddinAssetId=Telemetry.PrivacyRules.GetAssetId(t,E,this.ee.OwnerAddinAssetId),C.ownerAddinStoreType=t,C.ribbonControlType="Tab",C.toggle=v,C);n.a.sendTelemetryEvent(Object.assign(new r.a,
{name:A.ZBc+"ControlUpdate",dataFields:h.a.gl(C)}));A={};v=(A.DynamicAddinCommandsMethodDispatchId=2,A.SolutionId=this.it,A.PrivacyCompliantSolutionId=Telemetry.PrivacyRules.GetAssetId(t,E,this.it),A.StoreType=t,A.SourceControlId=this.id,A.MethodData=v,A);this.w2.PK(-1014260128,v)};c.prototype._OnAccess=function(){};c.prototype.getTypeName=function(){return"Microsoft.DynamicRibbon.RibbonTab"};c.prototype.invokePropertyGet=function(v){switch(v){case 2:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(v);
};c.prototype.invokePropertyGetAsync=function(v){v=this.invokePropertyGet(v);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(v)};c.prototype.invokePropertySet=function(v){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(v);};c.prototype.invokePropertySetAsync=function(v,A){this.invokePropertySet(v,A);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};c.prototype.invokeMethod=function(v,A){switch(v){case 3:return this.czj(A);case 1:return this.tDa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(v);
};c.prototype.invokeMethodAsync=function(v,A){v=this.invokeMethod(v,A);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(v)};c.prototype.czj=function(v){v=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(v,0,"boolean");this.setVisibility(v);return null};c.prototype.tDa=function(){this._OnAccess();return null};uk.Object.defineProperties(c.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this._id}}});Object(z.a)(c,"RibbonTab",null,[]);var B=b(1189),y=b(168);
b.d(F,"DynamicRibbon",function(){return a});a.prototype.executeRequestCreate=function(v){try{var A={},t=(A.addinAssetId=Telemetry.PrivacyRules.GetAssetId(this.ee.OwnerAddinStoreType,this.ee.PrimaryMarketplace.MarketplaceRef,this.it),A.ownerAddinAssetId=Telemetry.PrivacyRules.GetAssetId(this.ee.OwnerAddinStoreType,this.ee.PrimaryMarketplace.MarketplaceRef,this.ee.OwnerAddinAssetId),A.ownerAddinStoreType=this.ee.OwnerAddinStoreType,A.ribbonControlType="Ribbon",A);n.a.sendTelemetryEvent(Object.assign(new r.a,
{name:a.ZBc+"ExecuteRequestCreate",dataFields:h.a.gl(t)}));var E=y.a.ui(v);v={};A={};A[u.a.LJa]=this.ez;A[u.a.MJa]=E;A[u.a.m$c]=this.ee;v[u.a.wub]=3;v[u.a.N4]=this.it;v[u.a.n9b]=Telemetry.PrivacyRules.GetAssetId(this.ee.OwnerAddinStoreType,this.ee.PrimaryMarketplace.MarketplaceRef,this.it);v[u.a.L4]=A;this.w2.PK(-1014260128,v);var C=a.Pbc("ExecuteRequestCreate",!0,"");l.ULS.sendTraceTag(538572826,0,50,C)}catch(H){E=a.Pbc("ExecuteRequestCreate",!1,H.toString()),l.ULS.sendTraceTag(538572825,0,50,E)}return null};
a.prototype.executeRequestUpdate=function(v){try{var A=null,t=null;A=this.ee.OwnerAddinStoreType;t=this.ee.PrimaryMarketplace.MarketplaceRef;var E={},C=(E.addinAssetId=Telemetry.PrivacyRules.GetAssetId(A,t,this.it),E.ownerAddinAssetId=Telemetry.PrivacyRules.GetAssetId(A,t,this.ee.OwnerAddinAssetId),E.ownerAddinStoreType=this.ee.OwnerAddinStoreType,E.ribbonControlType="Ribbon",E);n.a.sendTelemetryEvent(Object.assign(new r.a,{name:a.ZBc+"ExecuteRequestUpdate",dataFields:h.a.gl(C)}));var H=y.a.ui(v);
v={};E={};E[u.a.LJa]=this.ez;E[u.a.MJa]=H;E[u.a.m$c]=this.ee;v[u.a.wub]=3;v[u.a.N4]=this.it;v[u.a.n9b]=Telemetry.PrivacyRules.GetAssetId(A,t,this.it);v[u.a.L4]=E;this.w2.PK(-1014260128,v);var U=a.Pbc("ExecuteRequestUpdate",!0,"");l.ULS.sendTraceTag(538572824,0,50,U)}catch(Q){A=a.Pbc("ExecuteRequestUpdate",!1,Q.toString()),l.ULS.sendTraceTag(538572823,0,50,A)}return null};a.prototype.getButton=function(v){var A=null;if(!this.bhf())return this.SGe();if(v&&0<v.length){if(!this.aCe(v))return this.jHe(v);
A=new e(v,this.it,this.w2,this.ee)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(A)};a.prototype.getTab=function(v){var A=null;if(!this.bhf())return this.SGe();if(this.ez.getOwnerAddinControlRecreated())return this.kah();if(v&&0<v.length){if(!this.aCe(v))return this.jHe(v);A=new c(v,this.it,this.w2,this.ee)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(A)};a.prototype._OnAccess=function(){};a.prototype.getTypeName=function(){return"Microsoft.DynamicRibbon.DynamicRibbon"};
a.prototype.invokePropertyGet=function(v){switch(v){case 4:return this.buttons}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(v);};a.prototype.invokePropertyGetAsync=function(v){v=this.invokePropertyGet(v);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(v)};a.prototype.invokePropertySet=function(v){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(v);};a.prototype.invokePropertySetAsync=function(v,A){this.invokePropertySet(v,A);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};
a.prototype.invokeMethod=function(v){switch(v){case 1:return this.tDa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(v);};a.prototype.invokeMethodAsync=function(v,A){switch(v){case 7:return this.yDh(A);case 6:return this.zDh(A);case 3:return this.JPh(A);case 5:return this.E3h(A)}v=this.invokeMethod(v,A);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(v)};a.prototype.yDh=function(v){v=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(v,0,"string");return this.executeRequestCreate(v)};
a.prototype.zDh=function(v){v=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(v,0,"string");return this.executeRequestUpdate(v)};a.prototype.JPh=function(v){v=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(v,0,"string");return this.getButton(v)};a.prototype.E3h=function(v){v=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(v,0,"string");return this.getTab(v)};a.prototype.tDa=function(){this._OnAccess();return null};a.prototype.jHe=function(v){return B.a(w.a.P6g,y.a.fa(1721)+
v)};a.prototype.SGe=function(){return B.a(w.a.pnj,y.a.fa(1717))};a.prototype.kah=function(){return B.a(w.a.hostRestartNeeded,y.a.fa(1722))};a.prototype.bhf=function(){var v=this.ez.getSharedRuntimeId();v=!!v&&0<v.length;l.ULS.sendTraceTag(538572822,0,15,String.format("IsDynamicRibbonApiAvailable check. hasSharedRuntimeId:{0}.",v));return v};a.prototype.aCe=function(v){var A=this.owg.getRibbonExtensionControlMap();return v in A||this.$_g(v)};a.prototype.$_g=function(v){var A=this.kHh();if(A){A=Cl(A.NNe.tabs);
for(var t=A.next();!t.done;t=A.next()){t=t.value;if(t.id===v)return!0;t=Cl(t.groups);for(var E=t.next();!E.done;E=t.next()){E=Cl(E.value.controls);for(var C=E.next();!C.done;C=E.next()){C=C.value;if(C.id===v)return!0;if("Menu"===C.type){C=Cl(C.items);for(var H=C.next();!H.done;H=C.next())if(H.value.id===v)return!0}}}}}return!1};a.prototype.kHh=function(){return m.a.getInstance().Uja(this.ee.PrimaryMarketplace.MarketplaceType,this.ee.PrimaryMarketplace.SolutionId,1)};a.Pbc=function(v,A,t){var E={};
E.methodName="DynamicRibbon."+v;E.result=A?"Succeeded":"Failed";E.message=t;return y.a.Kc(E)};uk.Object.defineProperties(a.prototype,{buttons:{configurable:!0,enumerable:!0,get:function(){return null}}});a.ZBc="Office.Online.Extensibility.Ribbon.";Object(z.a)(a,"DynamicRibbon",null,[])},1167:function(z,F,b){function a(){}b.d(F,"a",function(){return a});z=b(0);a.X$b="extId";a.XEe="ComponentType";a.rIa="ComponentId";a.Gnd="HostProps";a.aAa="OptionalProps";Object(z.a)(a,"ActionPropertyNames",null,[])},
1186:function(z,F,b){function a(c,e){var l=!1;c&&(c=e.osfControl,(e=c.getManifest())&&e.getSharedRuntimeForCustomFunctions("Workbook")&&!c.getIsUpgrading()&&(l=!0));return l}b.d(F,"a",function(){return a})},1188:function(z,F,b){function a(){this.token=null;this.errorCode=0;this.expiresOn=this.fia=this.FUa=this.bid=this.Akd=this.Wxb=this.qYd=null}b.d(F,"a",function(){return a});z=b(0);Object(z.a)(a,"AppsForOfficeOauthResult",null,[])},1189:function(z,F,b){function a(c,e){return OfficeExtension.WacRuntime.Utility.createPromise(function(l,
m){m(OfficeExtension.WacRuntime.Utility.createRichApiException(c,e))})}b.d(F,"a",function(){return a})},1303:function(z,F,b){function a(oa,Ma,Za){this.Yxa=!1;this.SF={};this.$=oa;this.Fh=Ma;this.Cpd().loa();this.indexedDB=Za;this.indexedDB.xg()&&(this.Yxa=!0,this.indexedDB.initialize(a.Cod,a.Dod))}function c(oa,Ma){this.oTc=oa;this._message=Ma}function e(){}function l(){}function m(oa){switch(oa){case 0:return"Medium";case 1:return"Unexpected";case 2:return"Verbose";default:return""}}function n(oa,
Ma){y(b(1303).CustomFunctionsInstaller.T3e("CustomFunctionsRuntimeLogging"),function(Za){if(Za.result&&window.console)switch(Za=m(oa.severity)+" "+oa.message+Ma,oa.severity){case 2:window.console.log&&window.console.log(Za);break;case 0:window.console.info&&window.console.info(Za);break;case 1:window.console.error&&window.console.error(Za)}return!0},"CustomFunctionsInstaller::LogEvent failed due to GetLocalCacheItemSafeFromLocalStorage failed")}function h(oa,Ma,Za,gb,zb){Za=oa.CWCT(function(){Ma(oa)},
Za,3,gb);Za.continueWith(function(){U.ULS.sendTraceTag(537163459,0,10,zb)},4);return Za}function u(oa,Ma,Za){return h(oa,Ma,ka.a.none,da.a.current,Za)}function w(oa,Ma,Za,gb,zb){Za=oa.CWRCT(function(){return Ma(oa)},Za,3,gb);Za.continueWith(function(){U.ULS.sendTraceTag(537163460,0,10,zb)},4);return aa.TaskExtensions.wDc(Za)}function r(oa,Ma,Za){return w(oa,Ma,ka.a.none,da.a.current,Za)}function B(oa,Ma,Za,gb,zb){Za=oa.CWRCT(function(){return Ma(oa)},Za,3,gb);Za.continueWith(function(){U.ULS.sendTraceTag(537163461,
0,10,zb)},4);return Za}function y(oa,Ma,Za){return B(oa,Ma,ka.a.none,da.a.current,Za)}function v(oa,Ma,Za,gb,zb){Za=oa.CWRCT(function(){return Ma(oa)},Za,3,gb);Za.continueWith(function(){U.ULS.sendTraceTag(537163462,0,10,zb)},4);return aa.TaskExtensions.wDc(Za)}function A(oa,Ma,Za){return v(oa,Ma,ka.a.none,da.a.current,Za)}function t(oa,Ma,Za,gb,zb){Za=oa.CWCT(function(){Ma(oa)},Za,3,gb);Za.continueWith(function(){U.ULS.sendTraceTag(537163463,0,10,zb)},4);return Za}function E(oa,Ma,Za){return t(oa,
Ma,ka.a.none,da.a.current,Za)}function C(){}function H(oa){oa=oa.split("|");this.it=oa[1];this.UTc=oa[2];this.iXd=oa[3]}b.r(F);z=b(0);var U=b(13),Q=b(4),O=b(161),ea=b(199),Z=b(81),S=b(561),I=b(173),P=b(83),J=b(51),aa=b(35),ia=b(228),ba=b(118),ra=b(592);uk.Object.defineProperties(H.prototype,{solutionId:{configurable:!0,enumerable:!0,get:function(){return this.it}},solutionVersion:{configurable:!0,enumerable:!0,get:function(){return this.UTc}},needToRestoreManifest:{configurable:!0,enumerable:!0,get:function(){return this.iXd===
OSF.StoreTypeEnum.Registry.toString()}}});Object(z.a)(H,"AddinStoreInfo",null,[]);Object(z.a)(C,"CustomFunctionRegistrationInfos",null,[]);var ka=b(209),da=b(60),ha=b(1186);Object(z.a)(l,"InstallationInfo",null,[]);Object(z.a)(e,"UninstallationInfo",null,[]);var qa=b(27),Aa=b(95),Fa=b(34),ab=b(29),Ua=b(1),bb=b(21),xa=b(288),Gb=b(994),$b=b(53);uk.Object.defineProperties(c.prototype,{severity:{configurable:!0,enumerable:!0,get:function(){return this.oTc}},message:{configurable:!0,enumerable:!0,get:function(){return this._message}}});
Object(z.a)(c,"CustomFunctionLog",null,[]);b.d(F,"CustomFunctionsInstaller",function(){return a});a.prototype.Hef=function(oa,Ma,Za,gb){var zb=this;if(gb.invariantNamespace)for(var nb=0;nb<gb.invariantNamespace.length;++nb){var pa=gb.invariantNamespace.charAt(nb);if("."!==pa&&"_"!==pa&&"a">pa&&"z"<pa&&"A">pa&&"Z"<pa&&"0">pa&&"9"<pa)throw U.ULS.sendTraceTag(537163552,0,10,"CustomFunctionsInstaller::InstallAsync: InvariantNamespace validation failed. Character='{0}', Position={1}.",pa,nb),Error.create("InvariantNamespace validation failed");
}return A(this.pXg(Za,gb.manifest),function(){return A(zb.$Jd(oa),function(Ja){var Da=Ja.result;return(null===Da||void 0===Da?0:Da.isDynamicMetadata)?zb.dLd(oa,Ma,Da,!1,!1,!1):A(zb.w2j(oa,Ma,gb),function(ib){var Rb;Da=(Rb=new l,Rb.addinId=Za,Rb.locale=gb.locale,Rb.addinInvariantNamespace=gb.invariantNamespace,Rb.addinNamespace=gb.namespace,Rb.addinTitle=gb.title,Rb.isXllCompatible=gb.isXllCompatible,Rb.metadataContent=JSON.stringify(JSON.parse(ib.result)),Rb);return zb.dLd(oa,Ma,Da,!1,a.AEh(gb.osfControl.getStoreType()),
ha.a(zb.$,gb))},"CustomFunctionsInstaller::InstallAsync failed due to XhrGetMetadataAsync failed")},"CustomFunctionsInstaller::InstallAsync failed due to ReadInstallationInfoAsync failed")},"CustomFunctionsInstaller::InstallAsync failed due to CacheManifestAsync failed")};a.prototype.Jef=function(oa,Ma,Za,gb){var zb=this;if(!a.Dud(Za))throw U.ULS.sendTraceTag(537163551,0,10,"CustomFunctionsInstaller.InstallDynamicFunctionsAsync: Invalid metadata JSON."),Error.create("Invalid Metadata JSON");return A(this.$Jd(oa),
function(nb){nb=nb.result;if(!nb&&(nb=Fa.a.Fc(zb.uW,oa),!nb))throw U.ULS.sendTraceTag(537163550,0,10,String.format("CustomFunctionsInstaller::InstallDynamicFunctionsAsync: Unexpected error, the addin with solutionId {0} hasn't been installed yet.",Telemetry.PrivacyRules.GetPrivacyCompliantId(oa,Ma,null))),Error.create("Customfunctions dynamic registration failed");nb.metadataContent=JSON.stringify(JSON.parse(Za));nb.isDynamicMetadata=!0;return zb.dLd(oa,Ma,nb,!0,!0,gb)},"CustomFunctionsInstaller::InstallDynamicFunctionsAsync failed due to ReadInstallationInfoAsync failed")};
a.prototype.vfg=function(oa,Ma){var Za=this;this.Fh.Cja();var gb=Object.assign(new e,{solutionId:oa}),zb=String.format("CustomFunctionsInstaller.UninstallAsync: Failed to uninstall Custom Functions for solution: {0}.",Telemetry.PrivacyRules.GetPrivacyCompliantId(oa,Ma,null));return A(this.NLd(oa),function(){return A(Za.ULd(oa),function(){return Za.P_d(Za.Fh,oa,Ma,gb)},"CustomFunctionsInstaller.UninstallAsync failed due to RemoveManifestAsync failed")},zb)};a.prototype.w2j=function(oa,Ma,Za){var gb=
new O.a;OSF.OUtil.xhrGet(Za.metadataUrl,function(zb){zb?gb.setResult(zb):gb.setException(Error.create("Invalid manifest"))},function(zb){U.ULS.sendTraceTag(537163548,0,10,"CustomFunctionsInstaller.XhrGetMetadataAsync: Failed to download Custom Functions metadata for solution {0}. ErrorCode: {1}.",Telemetry.PrivacyRules.GetPrivacyCompliantId(oa,Ma,null),zb);gb.setException(Error.create("Failed to download manifest"))});return gb.task};a.prototype.Cpd=function(){var oa=this;return A(this.Btc(),function(Ma){var Za=
Ma.result;if(!Za.length)return $b.Task.Sa(!0);U.ULS.sendTraceTag(537163547,0,50,"CustomFunctionsInstaller.InstallFromCacheAsync: Custom Functions registration from cache attempted.");Ma=new ea.a;for(var gb=[],zb={},nb=0;nb<Za.length;zb={sRb:zb.sRb},nb++)zb.sRb=Object(Z.a)(String,Za[nb]),Ma.add(y(oa.$Jd(zb.sRb),function(pa){return function(Ja){if(Ja=Ja.result){var Da=Fa.a.Fc(oa.SF,Ja.addinId);Da&&Da===Ja.metadataContent||(oa.SF[Ja.addinId]=Ja.metadataContent,oa.uW[pa.sRb]=Ja,Array.add(gb,Ja))}return!0}}(zb),
"CustomFunctionsInstaller::InstallFromCacheAsync failed due to ReadInstallationInfoAsync failed"));return r($b.Task.WAE(Ma),function(){if(gb.length){var pa,Ja=(pa=new C,pa.registrationInfos=gb,pa);return oa.h2b(oa.Fh,Za,Ja)}U.ULS.sendTraceTag(537163546,0,50,"CustomFunctionsInstaller.InstallFromCacheAsync: There is no custom function to register from cache");return $b.Task.Sa(!0)},"CustomFunctionsInstaller::InstallFromCacheAsync failed due to getInstallationInfoTasks failed")},"CustomFunctionsInstaller::InstallFromCacheAsync failed")};
a.prototype.Kef=function(){var oa=this,Ma=new O.a;new ea.a;var Za=[],gb=[];Object.keys(this.uW).forEach(function(zb){zb=Object(Z.a)(String,zb);var nb=Fa.a.Fc(oa.uW,zb);Array.add(Za,nb);Array.add(gb,zb)});if(!gb.length)return Ma.setResult(!0),Ma.task;Ma=Object.assign(new C,{registrationInfos:Za});return this.h2b(this.Fh,gb,Ma)};a.prototype.Btc=function(){return y(this.Bid(ra.a.p_a),function(oa){oa=oa.result;return Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(oa||"[]"))?Sys.Serialization.JavaScriptSerializer.deserialize(oa||
"[]"):null},"CustomFunctionsInstaller::ReadSolutionIdsLowerCaseAsync failed due to GetLocalCacheItemSafeAsync failed")};a.prototype.clg=function(oa){return this.bSd(ra.a.p_a,Sys.Serialization.JavaScriptSerializer.serialize(oa))};a.prototype.$Jd=function(oa){return A(this.Bid(ra.a.r5a(oa)),function(Ma){Ma=Ma.result||"";return 0<Ma.length?$b.Task.Sa(Sys.Serialization.JavaScriptSerializer.deserialize(Ma,!0)):$b.Task.Sa(null)},"CustomFunctionsInstaller::ReadInstallationInfoAsync failed due to GetLocalCacheItemSafeAsync failed")};
a.prototype.p2j=function(oa,Ma){var Za=this;return A(this.sPe(oa),function(){return A(Za.bSd(ra.a.r5a(oa),Sys.Serialization.JavaScriptSerializer.serialize(Ma)),function(){return a.cSd(ra.a.omd,"true")},"CustomFunctionsInstaller::WriteInstallationInfoAsync failed due to SetLocalCacheItemSafeAsync failed")},"CustomFunctionsInstaller::WriteInstallationInfoAsync failed due to EnsureCacheEntryForAddinAsync failed")};a.prototype.NLd=function(oa){var Ma=this;return A(this.XSf(oa),function(){return A(Ma.qTf(ra.a.r5a(oa)),
function(){return A(Ma.Btc(),function(Za){return Za.result.length?$b.Task.Sa(!0):a.cSd(ra.a.omd,"false")},"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due update ReadSolutionIdsLowerCaseAsync failed")},"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due to RemoveLocalCacheItemSafeAsync failed")},"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due to RemoveCacheEntryForAddinSafeAsync failed")};a.prototype.rQf=function(oa){return this.Bid(ra.a.q5a(oa))};
a.prototype.Zkg=function(oa,Ma){var Za=this;return A(this.sPe(oa),function(){return Za.bSd(ra.a.q5a(oa),Ma)},"CustomFunctionsInstaller::WriteManifestAsync failed due to EnsureCacheEntryForAddinAsync failed")};a.prototype.ULd=function(oa){var Ma=this;return A(this.XSf(oa),function(){return Ma.qTf(ra.a.q5a(oa))},"CustomFunctionsInstaller::RemoveManifestAsync failed due to RemoveCacheEntryForAddinSafeAsync failed")};a.prototype.sPe=function(oa){var Ma=this;return A(this.Btc(),function(Za){Za=Za.result;
var gb=oa.toLowerCase();if(Array.contains(Za,gb))return $b.Task.Sa(!0);Za.push(gb);return Ma.clg(Za)},"CustomFunctionsInstaller::EnsureCacheEntryForAddinAsync failed due to ReadSolutionIdsLowerCaseAsync failed")};a.prototype.XSf=function(oa){var Ma=this;return A(this.Btc(),function(Za){Za=Za.result;var gb=oa.toLowerCase();return Array.contains(Za,gb)?(Za.splice(Array.indexOf(Za,gb),1),Ma.clg(Za)):$b.Task.Sa(!0)},"CustomFunctionsInstaller::RemoveCacheEntryForAddinSafeAsync failed due to ReadSolutionIdsLowerCaseAsync failed")};
a.prototype.pXg=function(oa,Ma){if(Ua.EwaSettings.isChangeGateEnabled("OfficeVSO:5024811_AddinIdInfoDevCatalogCrashFix"))return oa=new OSF.AddinIdInfo(oa),oa.needToRestoreManifest()?this.Zkg(oa.getSolutionId(),Ma):$b.Task.Sa(!0);oa=new H(oa);return oa.needToRestoreManifest?this.Zkg(oa.solutionId,Ma):$b.Task.Sa(!0)};a.prototype.Rmj=function(oa){var Ma=this;if(Ua.EwaSettings.isChangeGateEnabled("OfficeVSO:5024811_AddinIdInfoDevCatalogCrashFix")){var Za=new OSF.AddinIdInfo(oa);return Za.needToRestoreManifest()?
y(this.rQf(Za.getSolutionId()),function(zb){(zb=zb.result)&&OSF.OsfManifestManager.cacheManifestFromXml(Za.getSolutionId(),Za.getSolutionVersion(),zb,Ma.$.ya.UICultureTag);return!0},"CustomFunctionsInstaller::RestoreManifestAsync failed due to ReadManifestAsync failed"):$b.Task.Sa(!0)}var gb=new H(oa);return gb.needToRestoreManifest?y(this.rQf(gb.solutionId),function(zb){(zb=zb.result)&&OSF.OsfManifestManager.cacheManifestFromXml(gb.solutionId,gb.solutionVersion,zb,Ma.$.ya.UICultureTag);return!0},
"CustomFunctionsInstaller::RestoreManifestAsync failed due to ReadManifestAsync failed"):$b.Task.Sa(!0)};a.prototype.qTf=function(oa){return this.Yxa?this.indexedDB.V8c(oa):a.afj(oa)};a.prototype.bSd=function(oa,Ma){return this.Yxa?this.indexedDB.wdb(new Gb.a(oa,Ma)):a.cSd(oa,Ma)};a.prototype.Bid=function(oa){return this.Yxa?this.indexedDB.oLa(oa):a.T3e(oa)};a.prototype.dLd=function(oa,Ma,Za,gb,zb,nb){var pa=this,Ja=String.format("CustomFunctionsInstaller.RegisterFunctionsAsync: Failed to register Custom Functions for solution: {0}.",
Telemetry.PrivacyRules.GetPrivacyCompliantId(oa,Ma,null));return aa.TaskExtensions.wDc(y(this.eLd(this.Fh,oa,Ma,Za,!1,gb,nb),function(){return zb?pa.p2j(oa,Za):$b.Task.Sa(!0)},Ja))};a.prototype.eLd=function(oa,Ma,Za,gb,zb,nb,pa){var Ja=this;if(!nb&&(nb=Fa.a.Fc(this.SF,gb.addinId))&&nb===gb.metadataContent)return $b.Task.Sa(!0);this.SF[gb.addinId]=gb.metadataContent;this.uW[Ma]=gb;pa||oa.VIb(Ma);oa.Cja();return A(this.Dcj(Ma,Za,gb),function(){return Ja.MId(gb.addinId,zb)},"Failed to register functions for customfunction addin")};
a.prototype.Dcj=function(oa,Ma,Za){var gb=this,zb=new O.a,nb=this.Tqb(Za);return this.Kja(function(pa){Ua.EwaSettings.ma(257)&&n(a.wtb,oa);(pa=pa.Result)&&204===pa.ResponseStatusCode?zb.setResult(!0):(delete gb.SF[Za.addinId],delete gb.uW[oa],E(gb.NLd(oa),function(){E(gb.ULd(oa),function(){gb.x7f()},"Failed to show customfunctions installation error info")},String.format("CustomFunctionsInstaller: Failed to register Custom Functions for solution: {0}. Received status code {1}.",oa,pa?pa.ResponseStatusCode.toString():
"Unknown")),zb.setResult(!1))},function(pa){pa=ba.a.mg(pa.data);U.ULS.sendTraceTag(537163544,0,10,"CustomFunctionsInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution {0}. Errors: {1}.",Telemetry.PrivacyRules.GetPrivacyCompliantId(oa,Ma,null),ab.a.Wc(pa));Ua.EwaSettings.ma(257)&&n(a.vtb,oa);delete gb.SF[Za.addinId];delete gb.uW[oa];zb.setResult(!1)},nb,zb,!0)};a.prototype.h2b=function(oa,Ma,Za){var gb=this,zb=new O.a,nb=qa.a.Ra.ke.m;Ma.forEach(function(Ja){Ja=
Object(Z.a)(String,Ja);oa.FBe(Ja)});oa.Cja();var pa=this.u0c(Za);return this.Kja(function(Ja){Ua.EwaSettings.ma(257)&&n(a.wtb,Sys.Serialization.JavaScriptSerializer.serialize(Ma));Ja=Ja.Result;var Da=!0,ib=Sys.Serialization.JavaScriptSerializer.deserialize(Ja.ResponseBody.toString());ib=Array.isArray(ib.value)?ib.value:null;for(var Rb=new ea.a,wc={Jfa:0};wc.Jfa<ib.length;wc={Jfa:wc.Jfa},wc.Jfa++)if(!ib[wc.Jfa]){Da=!1;var Cb=String.format("CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions. Received status code {0}.",
Ja.ResponseStatusCode);Rb.add(A(gb.NLd(Ma[wc.Jfa]),function(lb){return function(){delete gb.SF[Za.registrationInfos[lb.Jfa].addinId];delete gb.uW[Ma[lb.Jfa]];return gb.ULd(Ma[lb.Jfa])}}(wc),Cb))}u($b.Task.WAE(Rb),function(){E(gb.MId("",!1),function(){U.ULS.sendTraceTag(537163542,0,50,"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync takes {0} Millisecond.",qa.a.Ra.ke.m-nb);Da?zb.setResult(Da):u(gb.x7f(),function(){zb.setResult(Da)},"Failed to show customfunctions installation error info")},
String.format("CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to Batch register Custom Functions"))},"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to get registration information")},function(Ja){Ja=ba.a.mg(Ja.data);U.ULS.sendTraceTag(537163541,0,10,"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions. Errors: {0}.",ab.a.Wc(Ja));Ua.EwaSettings.ma(257)&&n(a.vtb,Sys.Serialization.JavaScriptSerializer.serialize(Ma));
for(Ja=0;Ja<Za.registrationInfos.length;Ja++)delete gb.SF[Za.registrationInfos[Ja].addinId],delete gb.uW[Ma[Ja]];zb.setResult(!1)},pa,zb,!0)};a.prototype.P_d=function(oa,Ma,Za,gb){var zb=this;return A(this.DUj(oa,Ma,Za,gb),function(){return zb.MId(gb.solutionId,!1)},"Failed to unregister functions for customfunction addin")};a.prototype.DUj=function(oa,Ma,Za,gb){var zb=new O.a;oa.VIb(Ma);(oa=Fa.a.Fc(this.uW,Ma))&&delete this.SF[oa.addinId];delete this.uW[Ma];gb=this.F0c(gb);return this.Kja(function(){Ua.EwaSettings.ma(257)&&
n(a.S7c,Ma);zb.setResult(!0)},function(nb){nb=ba.a.mg(nb.data);U.ULS.sendTraceTag(537163539,0,10,"CustomFunctionsInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution {0}. Errors: {1}.",Telemetry.PrivacyRules.GetPrivacyCompliantId(Ma,Za,null),ab.a.Wc(nb));Ua.EwaSettings.ma(257)&&n(a.R7c,Ma);zb.setResult(!1)},gb,zb,!1)};a.prototype.Kja=function(oa,Ma,Za,gb,zb){function nb(){function wc(yb,pc,Ta){Ua.EwaSettings.ma(257)&&n(zb?a.Q7c:a.T7c,Cb.RequestBody);return P.i(Ja.ta,
"ExecuteRichApiRequest",Za,xa.b(yb,oa),xa.a(pc,Ma),Ta,null,0)}if(pa.xIa()||0<Ja.ta.X4||0<Ja.Ok.X4)return!1;Da&&pa.dr(Da);ib&&Ja.Rr(ib);Rb&&Ja.fA(Rb);var Cb=Za.request,lb=0;Ua.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")?Cb.RequestFlags&1&&256!==(Cb.RequestFlags&256)||(lb=16):lb=Cb.RequestFlags&1?0:16;Ua.EwaSettings.uc()?pa.ju(new I.a(507,0,wc,lb|64)):pa.ju(new S.a(507,0,wc,lb));return!0}var pa=this.$.userOperationManager,Ja=this.$.na,Da=null,ib=null,Rb=null;
nb()||(Da=function(){nb()},ib=function(){nb()},Rb=function(){nb()},pa.Xu(Da),Ja.Hq(ib),Ja.mz(Rb));return gb.task};a.prototype.Tqb=function(oa){var Ma={HttpMethod:"POST",PathAndQuery:"RegisterCustomFunctions",RequestHeaders:null};Ma.RequestBody=JSON.stringify(oa);Ma.RequestFlags=1;Ua.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(Ma.RequestFlags|=256);oa=this.$.na.ta.Ma(1);oa.request=Ma;return oa};a.prototype.u0c=function(oa){var Ma={HttpMethod:"POST",PathAndQuery:"BatchRegisterCustomFunctions",
RequestHeaders:null};Ma.RequestBody=JSON.stringify(oa);Ma.RequestFlags=1;Ua.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(Ma.RequestFlags|=256);oa=this.$.na.ta.Ma(1);oa.request=Ma;return oa};a.prototype.F0c=function(oa){var Ma={HttpMethod:"POST",PathAndQuery:"UnregisterCustomFunctions",RequestHeaders:null};Ma.RequestBody=JSON.stringify(oa);Ma.RequestFlags=1;Ua.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(Ma.RequestFlags|=
256);oa=this.$.na.ta.Ma(1);oa.request=Ma;return oa};a.prototype.MId=function(oa,Ma){var Za=this,gb=J.GetServiceTaskFactory.create(this.$.da,153,this.$.la,1);return v(gb,function(){gb.result.YNd();return oa&&Ma?Za.Rmj(oa):$b.Task.Sa(!0)},this.$.la,ia.a.instance,"CustomFunctionsInstaller::ProcessPostRegistrationActionsAsync failed due to create IFunctionInfoManager failed")};a.prototype.x7f=function(){var oa=new Aa.a(1949669462,0,this.$.jd,0,null);return this.$.Ka.dc(oa)};a.T3e=function(oa){try{return $b.Task.Sa(localStorage.getItem(oa))}catch(Ma){return U.ULS.sendTraceTag(537163537,
0,50,"CustomFunctionsInstaller.GetLocalCacheItemSafe: Failed to get data from the localStorage. Reason: {0}",Ma.message||"Unknown"),$b.Task.Sa(null)}};a.cSd=function(oa,Ma){try{return localStorage.setItem(oa,Ma),$b.Task.Sa(!0)}catch(Za){return U.ULS.sendTraceTag(537163536,0,50,"CustomFunctionsInstaller.SetLocalCacheItemSafe: Failed to set data into the localStorage. Reason: {0}",Za.message||"Unknown"),$b.Task.Sa(!1)}};a.afj=function(oa){try{return localStorage.removeItem(oa),$b.Task.Sa(!0)}catch(Ma){return U.ULS.sendTraceTag(537163535,
0,50,"CustomFunctionsInstaller.RemoveLocalCacheItemSafeAsync: Failed to set data into the localStorage. Reason: {0}",Ma.message||"Unknown"),$b.Task.Sa(!1)}};a.AEh=function(oa){return bb.a.equals(oa,"registry",!0)||bb.a.equals(oa,"uploadfiledevcatalog",!0)||Q.AFrameworkApplication.userNameUnknown||Q.AFrameworkApplication.limitedEdit};a.Dud=function(oa){if(!oa)return!1;try{JSON.parse(oa)}catch(Ma){return!1}return!0};uk.Object.defineProperties(a.prototype,{uW:{configurable:!0,enumerable:!0,get:function(){return this.Fh.uW}}});
a.Cod="CustomFunctionCache";a.Dod="CustomFunction";a.Q7c=new c(2,"CustomFunctions [Registration] [Begin] SolutionId=");a.wtb=new c(0,"CustomFunctions [Registration] [End] [Success] SolutionId=");a.vtb=new c(1,"CustomFunctions [Registration] [End] [Failure] SolutionId=");a.T7c=new c(2,"CustomFunctions [Unregistration] [Begin] SolutionId=");a.S7c=new c(0,"CustomFunctions [Unregistration] [End] [Success] SolutionId=");a.R7c=new c(1,"CustomFunctions [Unregistration] [End] [Failure] SolutionId=");Object(z.a)(a,
"CustomFunctionsInstaller",null,[970])},1305:function(z,F,b){function a(ia){this.SF={};this.$=ia;this.Cpd().loa()}function c(ia,ba){this.oTc=ia;this._message=ba}function e(){}function l(){}function m(ia){switch(ia){case 0:return"Medium";case 1:return"Unexpected";case 2:return"Verbose";default:return""}}function n(ia,ba){if(b(1305).CustomFunctionsLegacyInstaller.sxb("CustomFunctionsRuntimeLogging")&&window.console)switch(ba=m(ia.severity)+" "+ia.message+ba,ia.severity){case 2:window.console.log&&window.console.log(ba);
break;case 0:window.console.info&&window.console.info(ba);break;case 1:window.console.error&&window.console.error(ba)}}function h(){}function u(ia){ia=ia.split("|");this.it=ia[1];this.UTc=ia[2];this.iXd=ia[3]}b.r(F);z=b(0);var w=b(13),r=b(1142),B=b(161),y=b(81),v=b(561),A=b(173),t=b(83),E=b(51),C=b(35),H=b(118),U=b(592),Q=b(1186);uk.Object.defineProperties(u.prototype,{solutionId:{configurable:!0,enumerable:!0,get:function(){return this.it}},solutionVersion:{configurable:!0,enumerable:!0,get:function(){return this.UTc}},
needToRestoreManifest:{configurable:!0,enumerable:!0,get:function(){return this.iXd===OSF.StoreTypeEnum.Registry.toString()}}});Object(z.a)(u,"AddinStoreInfo",null,[]);Object(z.a)(h,"CustomFunctionRegistrationInfos",null,[]);Object(z.a)(l,"InstallationInfo",null,[]);Object(z.a)(e,"UninstallationInfo",null,[]);var O=b(157),ea=b(34),Z=b(29),S=b(1),I=b(14),P=b(288),J=b(1083),aa=b(53);uk.Object.defineProperties(c.prototype,{severity:{configurable:!0,enumerable:!0,get:function(){return this.oTc}},message:{configurable:!0,
enumerable:!0,get:function(){return this._message}}});Object(z.a)(c,"CustomFunctionLog",null,[]);b.d(F,"CustomFunctionsLegacyInstaller",function(){return a});a.prototype.Hef=function(ia,ba,ra,ka){var da=this,ha=new B.a;if(ka.invariantNamespace)for(ba=0;ba<ka.invariantNamespace.length;++ba){var qa=ka.invariantNamespace.charAt(ba);if("."!==qa&&"_"!==qa&&"a">qa&&"z"<qa&&"A">qa&&"Z"<qa&&"0">qa&&"9"<qa)return w.ULS.sendTraceTag(537163530,0,10,"CustomFunctionsLegacyInstaller.InstallAsync: InvariantNamespace validation failed. Character='{0}', Position={1}.",
qa,ba),ha.setResult(!1),ha.task}a.cacheManifest(ra,ka.manifest);var Aa=a.aKd(ia);(null===Aa||void 0===Aa?0:Aa.isDynamicMetadata)?this.cLd(ia,Aa,ha,!1,!1):OSF.OUtil.xhrGet(ka.metadataUrl,function(Fa){Aa=Object.assign(new l,{addinId:ra,locale:ka.locale,addinInvariantNamespace:ka.invariantNamespace,addinNamespace:ka.namespace,addinTitle:ka.title,isXllCompatible:ka.isXllCompatible,metadataContent:JSON.stringify(JSON.parse(Fa))});da.cLd(ia,Aa,ha,!1,Q.a(da.$,ka))},function(Fa){w.ULS.sendTraceTag(537163528,
0,10,"CustomFunctionsLegacyInstaller.InstallAsync: Failed to download Custom Functions metadata for solution {0}. ErrorCode: {1}.",ia,Fa);ha.setResult(!1)});return ha.task};a.prototype.Jef=function(ia,ba,ra,ka){ba=new B.a;if(!a.Dud(ra))return w.ULS.sendTraceTag(537163527,0,10,"CustomFunctionsLegacyInstaller.InstallDynamicFunctionsAsync: Invalid metadata JSON."),ba.setResult(!1),ba.task;var da=a.aKd(ia);if(!da)return w.ULS.sendTraceTag(537163526,0,10,"CustomFunctionsLegacyInstaller.InstallDynamicFunctionsAsync: Unexpected error, could not read existing solution cache info."),
ba.setResult(!1),ba.task;da.metadataContent=JSON.stringify(JSON.parse(ra));da.isDynamicMetadata=!0;this.cLd(ia,da,ba,!0,ka);return ba.task};a.prototype.vfg=function(ia){var ba=this,ra=new B.a,ka=E.GetServiceTaskFactory.create(this.$.da,106,this.$.la,1);C.TaskExtensions.Ba(ka,function(){var da=ka.result;da.Cja();var ha=Object.assign(new e,{solutionId:ia});a.OLd(ia);a.VLd(ia);C.TaskExtensions.Ba(ba.P_d(da,ia,ha),function(qa){O.b(qa)?ra.setResult(qa.result):(qa.og?w.ULS.sendTraceTag(537163524,0,10,"CustomFunctionsLegacyInstaller.UninstallAsync: Failed to uninstall Custom Functions for solution: {0}.",
ia):qa.Ph&&w.ULS.sendTraceTag(537163523,0,10,"CustomFunctionsLegacyInstaller.UninstallAsync: Uninstall Custom Functions is canceled for solution: {0}.",ia),ra.setResult(!1))},ba.$.la,0)},this.$.la,3);return ra.task};a.prototype.Cpd=function(){var ia=this,ba=new B.a,ra=a.eKd();0<ra.length&&w.ULS.sendTraceTag(537163522,0,50,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Custom Functions registration from cache attempted.");var ka=[];ra.forEach(function(ha){ha=Object(y.a)(String,ha);if(ha=a.aKd(ha)){var qa=
ea.a.Fc(ia.SF,ha.addinId);qa&&qa===ha.metadataContent||(ia.SF[ha.addinId]=ha.metadataContent,Array.add(ka,ha))}});if(!ka.length)return ba.setResult(!0),w.ULS.sendTraceTag(537163521,0,50,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: There is no custom function to register from cache"),ba.task;var da=E.GetServiceTaskFactory.create(this.$.da,106,this.$.la,1);C.TaskExtensions.Ba(da,function(){var ha=da.result,qa=Object.assign(new h,{registrationInfos:ka});C.TaskExtensions.Ba(ia.h2b(ha,ra,qa),
function(Aa){O.b(Aa)?ba.setResult(Aa.result):(Aa.og?w.ULS.sendTraceTag(537163491,0,10,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Failed to register Custom Functions."):Aa.Ph&&w.ULS.sendTraceTag(537163490,0,10,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Registering Custom Functions is canceled."),ba.setResult(!1))},ia.$.la,0)},this.$.la,3);return ba.task};a.prototype.Qmj=function(ia){ia=new u(ia);if(ia.needToRestoreManifest){var ba=a.faj(ia.solutionId);OSF.OsfManifestManager.cacheManifestFromXml(ia.solutionId,
ia.solutionVersion,ba,this.$.ya.UICultureTag)}};a.prototype.cLd=function(ia,ba,ra,ka,da){var ha=this,qa=E.GetServiceTaskFactory.create(this.$.da,106,this.$.la,1);C.TaskExtensions.Ba(qa,function(){C.TaskExtensions.Ba(ha.eLd(qa.result,ia,ba,!1,ka,da),function(Aa){O.b(Aa)?((Aa=Aa.result)&&a.q2j(ia,ba),ra.setResult(Aa)):(Aa.og?w.ULS.sendTraceTag(537163488,0,10,"CustomFunctionsLegacyInstaller.InstallAsync: Failed to register Custom Functions for solution: {0}.",ia):Aa.Ph&&w.ULS.sendTraceTag(537163487,
0,10,"CustomFunctionsLegacyInstaller.InstallAsync: Registering Custom Functions is canceled for solution: {0}.",ia),ra.setResult(!1))},ha.$.la,0)},this.$.la,3)};a.prototype.eLd=function(ia,ba,ra,ka,da,ha){var qa=this;if(!da&&(da=ea.a.Fc(this.SF,ra.addinId))&&da===ra.metadataContent)return aa.Task.Sa(!0);this.SF[ra.addinId]=ra.metadataContent;var Aa=new B.a;ha||ia.VIb(ba);ia.Cja();ia=this.Tqb(ra);return this.Kja(function(Fa){S.EwaSettings.ma(257)&&n(a.wtb,ba);var ab=Fa.Result;204===ab.ResponseStatusCode?
C.TaskExtensions.Ba(qa.LId(Aa,ra.addinId,ka),function(Ua){Ua.og?ba?w.ULS.sendTraceTag(537163485,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution {0}.",ba):w.ULS.sendTraceTag(537163484,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for addinId {0}.",ra.addinId):Ua.Ph&&(ba?w.ULS.sendTraceTag(537163483,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Registering Custom Functions is canceled for solution {0}.",
ba):w.ULS.sendTraceTag(537163482,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Registering Custom Functions is canceled for addinId {0}.",ra.addinId));Aa.setResult(!1)},qa.$.la,4):(Fa=function(){delete qa.SF[ra.addinId];a.OLd(ba);a.VLd(ba);w.ULS.sendTraceTag(537163481,0,10,"CustomFunctionsLegacyInstaller: Failed to register Custom Functions for solution: {0}. Received status code {1}.",ba,ab.ResponseStatusCode);Aa.setResult(!1)},Fa=Object.assign(new J.a,{NMa:OSF.InfoType.Error,
title:ra.addinTitle,description:String.format(I.a.instance.Bb(152),I.a.instance.fa(1840)),buttonText:I.a.instance.fa(4),tia:Fa,$fc:!1,qja:Fa,errorCode:OSF.ErrorStatusCodes.WAC_CustomFunctionsRegistrationError}),r.a.FUd(Fa))},function(Fa){Fa=H.a.mg(Fa.data);w.ULS.sendTraceTag(537163480,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution {0}. Errors: {1}.",ba,Z.a.Wc(Fa));S.EwaSettings.ma(257)&&n(a.vtb,ba);delete qa.SF[ra.addinId];Aa.setResult(!1)},
ia,Aa,!0)};a.prototype.h2b=function(ia,ba,ra){var ka=this,da=new B.a;ba.forEach(function(qa){qa=Object(y.a)(String,qa);ia.FBe(qa)});ia.Cja();var ha=this.u0c(ra);return this.Kja(function(qa){S.EwaSettings.ma(257)&&n(a.wtb,Sys.Serialization.JavaScriptSerializer.serialize(ba));qa=qa.Result;var Aa=!0,Fa=Sys.Serialization.JavaScriptSerializer.deserialize(qa.ResponseBody.toString());Fa=Array.isArray(Fa.value)?Fa.value:null;for(var ab=0;ab<Fa.length;ab++)Fa[ab]||(Aa=!1,delete ka.SF[ra.registrationInfos[ab].addinId],
a.OLd(ba[ab]),a.VLd(ba[ab]),w.ULS.sendTraceTag(537163478,0,10,"CustomFunctionsLegacyInstaller: Failed to register Custom Functions for solutionId: {0}. Received status code {1}.",ba[ab],qa.ResponseStatusCode));C.TaskExtensions.Ba(ka.LId(da,"",!1),function(Ua){Ua.og?w.ULS.sendTraceTag(537163477,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Failed to Batch register Custom Functions"):Ua.Ph&&w.ULS.sendTraceTag(537163476,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Batch register Custom Functions is canceled");
da.setResult(!1)},ka.$.la,4);da.setResult(Aa)},function(qa){qa=H.a.mg(qa.data);w.ULS.sendTraceTag(537163475,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions for solutionIds {0}. Errors: {1}.",Sys.Serialization.JavaScriptSerializer.serialize(ba),Z.a.Wc(qa));S.EwaSettings.ma(257)&&n(a.vtb,Sys.Serialization.JavaScriptSerializer.serialize(ba));qa=Cl(ra.registrationInfos);for(var Aa=qa.next();!Aa.done;Aa=qa.next())delete ka.SF[Aa.value.addinId];
da.setResult(!1)},ha,da,!0)};a.prototype.P_d=function(ia,ba,ra){var ka=this,da=new B.a;ia.VIb(ba);ia=this.F0c(ra);return this.Kja(function(){S.EwaSettings.ma(257)&&n(a.S7c,ba);C.TaskExtensions.Ba(ka.LId(da,ra.solutionId,!1),function(ha){ha.og?ba&&w.ULS.sendTraceTag(537163473,0,10,"CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution {0}.",ba):ha.Ph&&ba&&w.ULS.sendTraceTag(537163472,0,10,"CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Unregistering Custom Functions is canceled for solution {0}.",
ba);da.setResult(!1)},ka.$.la,4)},function(ha){ha=H.a.mg(ha.data);w.ULS.sendTraceTag(537163471,0,10,"CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution {0}. Errors: {1}.",ba,Z.a.Wc(ha));S.EwaSettings.ma(257)&&n(a.R7c,ba);da.setResult(!1)},ia,da,!1)};a.prototype.Kja=function(ia,ba,ra,ka,da){function ha(){function bb($b,oa,Ma){S.EwaSettings.ma(257)&&n(da?a.Q7c:a.T7c,xa.RequestBody);return t.i(Aa.ta,"ExecuteRichApiRequest",ra,P.b($b,ia),
P.a(oa,ba),Ma,null,0)}if(qa.xIa()||0<Aa.ta.X4||0<Aa.Ok.X4)return!1;Fa&&qa.dr(Fa);ab&&Aa.Rr(ab);Ua&&Aa.fA(Ua);var xa=ra.request,Gb=xa.RequestFlags&1?0:16;S.EwaSettings.uc()?qa.ju(new A.a(507,0,bb,Gb|64)):qa.ju(new v.a(507,0,bb,Gb));return!0}var qa=this.$.userOperationManager,Aa=this.$.na,Fa=null,ab=null,Ua=null;ha()||(Fa=function(){ha()},ab=function(){ha()},Ua=function(){ha()},qa.Xu(Fa),Aa.Hq(ab),Aa.mz(Ua));return ka.task};a.prototype.Tqb=function(ia){var ba={HttpMethod:"POST",PathAndQuery:"RegisterCustomFunctions",
RequestHeaders:null};ba.RequestBody=JSON.stringify(ia);ba.RequestFlags=1;ia=this.$.na.ta.Ma(1);ia.request=ba;return ia};a.prototype.u0c=function(ia){var ba={HttpMethod:"POST",PathAndQuery:"BatchRegisterCustomFunctions",RequestHeaders:null};ba.RequestBody=JSON.stringify(ia);ba.RequestFlags=1;ia=this.$.na.ta.Ma(1);ia.request=ba;return ia};a.prototype.F0c=function(ia){var ba={HttpMethod:"POST",PathAndQuery:"UnregisterCustomFunctions",RequestHeaders:null};ba.RequestBody=JSON.stringify(ia);ba.RequestFlags=
1;ia=this.$.na.ta.Ma(1);ia.request=ba;return ia};a.prototype.LId=function(ia,ba,ra){var ka=this,da=E.GetServiceTaskFactory.create(this.$.da,153,this.$.la,1);C.TaskExtensions.Ba(da,function(){da.result.YNd();ba&&ra&&ka.Qmj(ba);ia.setResult(!0)},this.$.la,3);return da};a.prototype.Kef=function(){return aa.Task.Sa(!0)};a.eKd=function(){return(Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(a.sxb(U.a.p_a)||"[]"))?Sys.Serialization.JavaScriptSerializer.deserialize(a.sxb(U.a.p_a)||"[]"):
null)||[]};a.dlg=function(ia){a.dSd(U.a.p_a,Sys.Serialization.JavaScriptSerializer.serialize(ia))};a.aKd=function(ia){ia=a.sxb(U.a.r5a(ia))||"";return 0<ia.length?Sys.Serialization.JavaScriptSerializer.deserialize(ia,!0):null};a.q2j=function(ia,ba){a.rPe(ia);a.dSd(U.a.r5a(ia),Sys.Serialization.JavaScriptSerializer.serialize(ba))};a.OLd=function(ia){a.WSf(ia);a.rTf(U.a.r5a(ia))};a.faj=function(ia){return a.sxb(U.a.q5a(ia))};a.r2j=function(ia,ba){a.rPe(ia);a.dSd(U.a.q5a(ia),ba)};a.VLd=function(ia){a.WSf(ia);
a.rTf(U.a.q5a(ia))};a.rPe=function(ia){var ba=a.eKd();ia=ia.toLowerCase();Array.contains(ba,ia)||(ba.push(ia),a.dlg(ba))};a.WSf=function(ia){var ba=a.eKd();ia=ia.toLowerCase();Array.contains(ba,ia)&&(ba.splice(Array.indexOf(ba,ia),1),a.dlg(ba))};a.cacheManifest=function(ia,ba){ia=new u(ia);ia.needToRestoreManifest&&a.r2j(ia.solutionId,ba)};a.sxb=function(ia){try{return localStorage.getItem(ia)}catch(ba){return w.ULS.sendTraceTag(537163469,0,50,"CustomFunctionsLegacyInstaller.GetLocalStorageItemSafe: Failed to get data from the localStorage. Reason: {0}",
ba.message||"Unknown"),null}};a.dSd=function(ia,ba){try{localStorage.setItem(ia,ba)}catch(ra){w.ULS.sendTraceTag(537163468,0,50,"CustomFunctionsLegacyInstaller.SetLocalStorageItemSafe: Failed to set data into the localStorage. Reason: {0}",ra.message||"Unknown")}};a.rTf=function(ia){try{localStorage.removeItem(ia)}catch(ba){w.ULS.sendTraceTag(537163467,0,50,"CustomFunctionsLegacyInstaller.SetLocalStorageItemSafe: Failed to set data into the localStorage. Reason: {0}",ba.message||"Unknown")}};a.Dud=
function(ia){if(!ia)return!1;try{JSON.parse(ia)}catch(ba){return!1}return!0};a.Q7c=new c(2,"CustomFunctions [Registration] [Begin] SolutionId=");a.wtb=new c(0,"CustomFunctions [Registration] [End] [Success] SolutionId=");a.vtb=new c(1,"CustomFunctions [Registration] [End] [Failure] SolutionId=");a.T7c=new c(2,"CustomFunctions [Unregistration] [Begin] SolutionId=");a.S7c=new c(0,"CustomFunctions [Unregistration] [End] [Success] SolutionId=");a.R7c=new c(1,"CustomFunctions [Unregistration] [End] [Failure] SolutionId=");
Object(z.a)(a,"CustomFunctionsLegacyInstaller",null,[970])},1314:function(z,F,b){function a(O,ea,Z,S,I){this.$=O;this.Le=ea;this.ownerAddinInfo=Z;this.Xd=void 0===I?null:I;this.iSa=(void 0===S?null:S)||U.Task.Sa(!0);return this}function c(O){var ea=H.call(this)||this;ea.aEa="AddInCommandsDialog";ea.Ve=ea.aEa;ea.lc=5;ea.dialogWidth=695;ea.dialogHeight=438;ea.d6g="100%";ea.a6g="408px";ea.b6g="15px";ea.c6g="0";ea.dxg=O;return ea}function e(O,ea,Z,S,I,P){var J=O.Ma(9);J.sharedInfo=ea;return r.i(O,"InsertAgaveTaskpane",
J,Z,S,I,P,0)}function l(){}z=b(0);var m=b(209),n=b(13);Object(z.a)(l,"AddinCommandsHost",null,[]);var h=b(1367),u=b(1433),w=b(1026),r=b(83),B=b(561),y=b(387),v=b(173),A=b(35),t=b(1),E=b(288),C=b(149),H=C.a;Am(c,H);c.prototype.KD=function(){H.prototype.KD.call(this);this.Up.style.width=this.d6g;this.Up.style.height=this.a6g;this.Up.style.marginTop=this.b6g;this.Up.style.padding=this.c6g};c.prototype.qP=function(){H.prototype.qP.call(this);this.Pb.style.width=String.format("{0}px",this.dialogWidth);
this.Pb.style.height=String.format("{0}px",this.dialogHeight)};c.prototype.dispose=function(){H.prototype.dispose.call(this);this.dxg()};uk.Object.defineProperties(c.prototype,{containerDiv:{configurable:!0,enumerable:!0,get:function(){return this.Up}}});Object(z.a)(c,"AddInCommandsDialog",C.a,[]);var U=b(53),Q=b(60);C=b(97);b.d(F,"a",function(){return a});Am(a,l);a.prototype.W5g=function(){var O=this.iSa;this.iSa=U.Task.Sa(!0);return O};a.prototype.disposeHost=function(O){this.Le.KRa(O)};a.prototype.setOwnerAddinEToken=
function(O){this.ownerAddinInfo.eToken=O};a.prototype.showTaskpane=function(O,ea,Z){var S=this;n.ULS.sendTraceTag(537170642,220,50,"ShowTaskpane action called.");var I=null,P=!1,J=(new h.a("m_excelWebRenderer_ewaCtl_",this.ownerAddinInfo.solutionId,new w.a,!0)).IJe(O.solutionId.substr(this.ownerAddinInfo.solutionId.length));I=ea.getSharedRuntimeForTaskpane("Workbook",J);P=!!I&&1===I.LifeTime;this.Le.IBe(P?this.ownerAddinInfo.solutionId:O.solutionId,P?I:null,null)||(this.Sqf(P,!0),this.iSa=this.Apd(O,
I,function(aa,ia){aa?(P&&(aa.PrimaryMarketplace.SolutionId=S.ownerAddinInfo.solutionId,aa.SharedRuntime=I),aa.WebExtensionOsfControlType=3,S.Le.b2a(aa),Z(aa.InstanceId,ia),S.Sqf(P,!1),t.EwaSettings.isChangeGateEnabled("OfficeVSO:6085876_TelemetryForActiveAddinSuccessOnExcelWacEnabled")&&n.ULS.sendTraceTag(524818146,220,50,"ShowTaskpane: succeed to call.")):(n.ULS.sendTraceTag(17306640,220,10,"ShowTaskpane: instance id is null."),Z(null,ia))}))};a.prototype.getSettings=function(O,ea){var Z=this.Le.nba(O.solutionId);
Z?ea(this.Le.j_(Z).OsfPropertyBag):this.iSa=this.Apd(O,null,function(S){S?ea(S.OsfPropertyBag):n.ULS.sendTraceTag(537170641,220,10,"GetSettings: insertData is null.")})};a.prototype.showDialog=function(O,ea,Z){function S(ia,ba,ra){return e(J,aa,E.b(ia,I),ba,ra,null)}function I(ia){var ba=ia.Result,ra=ba?ba.AgaveData:null;ra?(P.Le.DIe(ra,function(){var ka=new c(function(){P.disposeHost(ra.InstanceId)});ka.initializeAndShow("",null,null);return ka.containerDiv}),Z(ra.InstanceId,0)):(n.ULS.sendTraceTag(537170638,
220,10,"ShowDialog: instance id is null."),Z(null,ia.Errors?ia.Errors[0].ErrorCause:5001))}var P=this;n.ULS.sendTraceTag(537170640,220,50,"ShowDialog action called.");var J=this.$.na.ta,aa=a.ftb(O,this.ownerAddinInfo);t.EwaSettings.uc()?this.iSa=y.a(this.$.userOperationManager,S,function(ia){return new v.a(500,0,ia,64)},this.Xd):this.iSa=y.a(this.$.userOperationManager,S,function(ia){return new B.a(500,0,ia)},this.Xd)};a.prototype.createUILessSandbox=function(O,ea,Z){var S=this;n.ULS.sendTraceTag(537170637,
220,50,"UILess action called.");var I=ea.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"),P=!!I&&1===I.LifeTime;(ea=this.Le.oHh(P?this.ownerAddinInfo.solutionId:O.solutionId,P?I:null))?Z(ea,0):this.iSa=this.Apd(O,I,function(J,aa){J?(P?(J.PrimaryMarketplace.SolutionId=S.ownerAddinInfo.solutionId,J.SharedRuntime=I,J.TaskpaneVisible=!1,J.WebExtensionOsfControlType=3,S.Le.b2a(J)):(J.WebExtensionOsfControlType=4,S.Le.DIe(J,function(){a.ugb.ia(J.InstanceId,new u.a);return a.ugb.pa(J.InstanceId).L2a})),
Z(J.InstanceId,aa)):(n.ULS.sendTraceTag(537170636,220,10,"UILess: instance id is null."),Z(null,aa))})};a.prototype.Apd=function(O,ea,Z){function S(da,ha,qa){return e(aa,ia,E.b(da,I),ha,qa,null)}function I(da){var ha=da.Result;(J=ha?ha.AgaveData:null)||Z(null,da.Errors?da.Errors[0].ErrorCause:5001)}var P=this,J=null,aa=this.$.na.ta,ia=a.ftb(O,this.ownerAddinInfo);ea&&(n.ULS.sendTraceTag(537170634,220,50,"Shared runtime agave is inserted."),ia.SharedRuntimeId=ea.Resid);var ba=500,ra=0;void 0===ia.IsToBePersisted||
null===ia.IsToBePersisted||ia.IsToBePersisted||(ba=538,S=function(da,ha,qa){n.ULS.sendTraceTag(537170633,220,50,"Web Method ShowAgaveTaskpane is called, StoreType {0}, StoreId {1}, SolutionId {2}.",Telemetry.PrivacyRules.GetPrivacyCompliantId(P.ownerAddinInfo.solutionId,P.ownerAddinInfo.storeType,P.ownerAddinInfo.assetId,null,null,P.ownerAddinInfo.storeId));da=E.b(da,I);var Aa=aa.Ma(9,null);Aa.sharedInfo=ia;return r.i(aa,"ShowAgaveTaskpane",Aa,da,ha,qa,null,0)},ra=16);if(t.EwaSettings.uc()){ra|=64;
var ka=y.a(this.$.userOperationManager,S,function(da){return new v.a(ba,0,da,ra)},this.Xd)}else ka=y.a(this.$.userOperationManager,S,function(da){return new B.a(ba,0,da,ra)},this.Xd);return A.TaskExtensions.ts(ka,function(){return J?P.Pwd(aa,J.InstanceId,function(da,ha){if(da){ea||(J.PrimaryMarketplace.MarketplaceType=O.storeType);J.OwnerAddinSolutionId=P.ownerAddinInfo.solutionId;J.OwnerAddinStoreType=P.ownerAddinInfo.storeType;J.OsfPropertyBag=[];for(ha=0;ha<da.Settings.length;ha++){var qa=[];qa[0]=
da.Settings[ha].Name;qa[1]=da.Settings[ha].Value;J.OsfPropertyBag[ha]=qa}Z(J,0)}else Z(null,ha.Errors?ha.Errors[0].ErrorCause:5001)}):U.Task.Sa(!1)},m.a.none,3,Q.a.current)};a.prototype.Pwd=function(O,ea,Z){function S(P,J,aa){P=E.b(P,I);var ia=O.Ma(1);ia.controlId=ea;return r.i(O,"DdaLoadSettings",ia,P,J,aa,null,0)}function I(P){Z(P.Result,P)}return t.EwaSettings.uc()?y.a(this.$.userOperationManager,S,function(P){return new v.a(501,0,P,80)},this.Xd):y.a(this.$.userOperationManager,S,function(P){return new B.a(501,
0,P,16)},this.Xd)};a.prototype.Sqf=function(O,ea){var Z;O&&(null===(Z=window.performance)||void 0===Z?0:Z.memory)&&n.ULS.sendTraceTag(537170630,220,50,"Shared runtime memory usage: before={0}, jsHeapSizeLimit={1}, totalJSHeapSize={2}, usedJSHeapSize={3}",ea,window.performance.memory.jsHeapSizeLimit,window.performance.memory.totalJSHeapSize,window.performance.memory.usedJSHeapSize)};a.showUILessDialog=function(O){a.ugb.xb(O)&&a.ugb.pa(O).initializeAndShowWithTitle()};a.hideUILessDialog=function(O){a.ugb.xb(O)&&
a.ugb.pa(O).hide()};a.ftb=function(O,ea){var Z={};Z.SolutionId=O.solutionId;Z.Version=O.version;Z.StoreType=ea.storeType;Z.StoreId=O.storeId;Z.AssetId=O.solutionId;Z.AssetStoreId="omex";Z.TargetType=1;Z.Width=350;Z.OwnerAddinSolutionId=ea.solutionId;Z.OwnerAddinStoreType=ea.storeType;Z.SharedRuntimeId=null;Z.Preload=!1;return Z};a.ugb=new C.a;Object(z.a)(a,"WACExcelAddinCommandsHost",l,[])},1353:function(z,F,b){function a(c,e,l,m){this._id=c;this.LAg=e;this.rle=l;this.lWa=m}b.d(F,"a",function(){return a});
z=b(0);a.prototype.getId=function(){return this._id};a.prototype.getStoreId=function(){return this.LAg};a.prototype.getStoreType=function(){return this.rle};Object(z.a)(a,"ExtensionIdentity",null,[251])},1354:function(z,F,b){function a(c,e,l){this.Yde=l}b.d(F,"a",function(){return a});z=b(0);Object(z.a)(a,"HostProperties",null,[])},1355:function(z,F,b){function a(){this.wi={};this.Fr={}}b.d(F,"a",function(){return a});z=b(0);Object(z.a)(a,"ExtensionLaunchProperties",null,[])},1356:function(z,F,b){function a(){this.La=
h.AFrameworkApplication.Ib}b.d(F,"a",function(){return a});z=b(0);var c=b(1353),e=b(1355),l=b(1167),m=b(1358),n=b(1354),h=b(4),u=b(634),w=b(26);a.prototype.GOa=function(r,B,y,v,A){this.hwi(r,B,y,v,A)};a.prototype.hwi=function(r,B,y,v,A){var t=b(1357).ExtensionComponentInstance,E={};E[l.a.X$b]=r;E[l.a.XEe]=B;E[l.a.rIa]=y;E[l.a.Gnd]=v;E[l.a.aAa]=A;v=8;h.AFrameworkApplication.Bri(r.getId())&&(v=B===m.a.action?this.La.Be(w.a.kVe,2,E):this.La.Be(w.a.F7f,2,E));32===v?(v=u.a.create().toString(),A.wi.InstanceToken&&
(v=A.wi.InstanceToken),r=new t(r,B,y,v),a.fw[v]=r):r=new t(r,B,y,null);r.Ptj(E)};a.prototype.gwi=function(r){var B=r.ExtId,y=r.ComponentType,v=r.ComponentId,A=r.HostProps;r=r.OptionalProps;B=new c.a(B.Id,B.StoreId,B.StoreType,B.AppVersion);A=new n.a(A.HostType,A.FormFactor,A.Locale);var t=new e.a;t.wi=r.OptionalProperties;t.Fr=r.DevProperties;a.instance.GOa(B,y,v,A,t)};a.prototype.getInstance=function(r){return a.fw[r]};a.prototype.Xej=function(r){delete a.fw[r]};uk.Object.defineProperties(a,{instance:{configurable:!0,
enumerable:!0,get:function(){a.CKc||(a.CKc=new a);return a.CKc}}});a.CKc=null;a.fw={};Object(z.a)(a,"ExtensionLifeCycleManager",null,[240])},1357:function(z,F,b){function a(m,n,h,u){this.lWa=this.VG=null;this._id=m;this.Jqg=h;this.xug=u;this.La=e.AFrameworkApplication.Ib?e.AFrameworkApplication.Ib:null}b.r(F);b.d(F,"ExtensionComponentInstance",function(){return a});z=b(0);var c=b(1356),e=b(4),l=b(26);a.prototype.Mgd=function(){return this.Jqg};a.prototype.Ptj=function(m){this.VG=m};a.prototype.stop=
function(){var m=this.La.Be(l.a.B2g,2,this.VG);c.a.instance.Xej(this.xug);return 32===m};a.prototype.ewc=function(){this.La.Be(l.a.NXf,2,this.VG)};uk.Object.defineProperties(a.prototype,{appVersion:{configurable:!0,enumerable:!0,get:function(){return this.lWa}}});Object(z.a)(a,"ExtensionComponentInstance",null,[250])},1358:function(z,F,b){function a(){}b.d(F,"a",function(){return a});z=b(0);a.taskpane="Taskpane";a.action="Action";Object(z.a)(a,"ComponentTypeNames",null,[])},1359:function(z,F,b){(function(a){function c(Q,
O,ea){var Z=U.call(this)||this;Z.Wcf=h.a.getTypeName();Z.Xd=null;Z.iV=null;Z.rzb=null;Z.imageWidth=0;Z.imageHeight=0;Z.tableData=null;Z.errorMessage=null;Z.JMa=null;Z.Nnd=0;Z.XVc=!1;Z.QJe=function(S){if(S){var I={};if(function(){var ra=C.d(Z.ogh(S.data));I=ra.ev;return ra}().returnValue){var P=Object(n.a)(Object,I);if("."===P.DataFromPictureWildcard)if(P.SessionId!==Z.JMa)l.ULS.sendTraceTag(523805139,0,10,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler() - SessionID of received message does not match current Session ID.");
else switch(l.ULS.sendTraceTag(523805138,0,50,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler - Message Received from SDX pane"),P.CmdType){case "ACK":Z.XVc=!0;Z.Lbg.stop();l.ULS.sendTraceTag(523805137,0,50,"DataFromPictureManager.DataFromPictureMessageReceivedEventHandler - SDX pane launched.");Z.wsj();0<Z.errorMessage.length?Z.A0f():0<Z.tableData.length&&Z.R0f();break;case "insert_html":var J=Z.$.na.ta,aa={},ia=E.g(Z.$).ga.va.xd.clone();aa.PasteId=m.a.create().toString();aa.DestinationRanges=
r.s(r.v(ia,Z.$));ia=P.Parameters.split("|",3);l.ULS.sendTraceTag(523805136,0,50,"DataFromPictureManager.dataFromPictureMessageReceivedEventHandler - LCC:{0}|{1}|{2}.",ia[0],ia[1],ia[2]);ia=P.Parameters.indexOf("|");ia=P.Parameters.indexOf("|",ia+1);ia=P.Parameters.indexOf("|",ia+1);aa.SourceHtml=P.Parameters.substring(ia+1);aa.CopyOperationId=null;var ba=J.Ma(1,J.fc());ba.pasteHtmlParameters=aa;B.a(Z.$.userOperationManager,function(ra,ka,da){return v.i(J,"pasteHtmlContent",ba,ra,ka,da,null,64)},function(ra){return new y.a(204,
0,ra,1)},null);Z.Nnd++;l.ULS.sendTraceTag(523805135,0,50,"DataFromPictureManager.dataFromPictureMessageReceivedEventHandler - Number of pastes to workbook per Session ID:{0}",Z.Nnd.toString())}}}};Z.Qci=function(S,I){if(S=I.$J)if(!I.parentPath||1>=I.parentPath.length||I.parentPath[1]!==Z.JMa)l.ULS.sendTraceTag(523805124,0,10,"DataFromPictureManager.ImageToTableAnnotationHandler() - SessionID of received annotation does not match current Session ID.");else{l.ULS.sendTraceTag(523805123,0,50,"DataFromPictureManager.ImageToTableAnnotationHandler() - Annotation Received.");
I=S.errorCode;switch(I){case null:case -1:Z.errorMessage=t.a.instance.fa(2204);break;case 1:Z.errorMessage=t.a.instance.fa(2205);break;case 2:Z.errorMessage=t.a.instance.fa(2206)}0<Z.errorMessage.length&&l.ULS.sendTraceTag(523805122,0,10,"DataFromPictureManager.ImageToTableAnnotationHandler() - ErrorCode:{0}.",I?I.toString():"null");Z.Kte.stop();Z.tableData=S.html;Z.XVc&&(0<Z.errorMessage.length?Z.A0f():0<Z.tableData.length&&Z.R0f())}else l.ULS.sendTraceTag(523805125,0,10,"DataFromPictureManager.ImageToTableAnnotationHandler() - Received annotation is null.")};
Z.$=Q;Z.augmentationLoopManager=O;Z.uploaderCreator=ea;Z.initialize();return Z}b.d(F,"a",function(){return c});var e=b(0),l=b(13),m=b(186),n=b(81),h=b(1364),u=b(36),w=b(243),r=b(45),B=b(387),y=b(173),v=b(83),A=b(95),t=b(14),E=b(20),C=b(40),H=b(1365),U=u.a;Am(c,U);c.prototype.dispose=function(){window.removeEventListener("message",this.QJe,!1);U.prototype.dispose.call(this)};c.prototype.eYi=function(Q,O){var ea=this;l.ULS.sendTraceTag(523805146,0,50,"DataFromPictureManager.onSuccessfulFileLoad - Start function.");
var Z=new Image;Z.onload=function(){var S=document.createElement("canvas");S.width=Z.width;S.height=Z.height;var I=S.getContext("2d");try{I.drawImage(Z,0,0,Z.width,Z.height)}catch(aa){l.ULS.sendTraceTag(523805145,0,10,"DataFromPictureManager.onSuccessfulFileLoad - Can't draw to canvas. ex.Message: {0}",aa.message);return}try{var P=S.toDataURL("image/jpeg")}catch(aa){l.ULS.sendTraceTag(523805144,0,10,"DataFromPictureManager.onSuccessfulFileLoad - Can't render to jpeg. ex.Message: {0}",aa.message);
return}S=P.split(",");if(2>S.length)l.ULS.sendTraceTag(523805143,0,10,"DataFromPictureManager.onSuccessfulFileLoad - Can't render to jpeg.");else{S=S[1];try{var J=window.self.atob(S)}catch(aa){l.ULS.sendTraceTag(523805142,0,10,"DataFromPictureManager.onSuccessfulFileLoad - Can't convert image to byte string. ex.Message: {0}",aa.message);return}28E5<J.length?(l.ULS.sendTraceTag(523805141,0,15,"DataFromPictureManager.onSuccessfulFileLoad - Image exceeds max size limit."),O.mFj()):(ea.Aoj(ea.Xd,ea.iV,
S,Z.width,Z.height),URL.revokeObjectURL(Z.src),Z=null,l.ULS.sendTraceTag(523805140,0,50,"DataFromPictureManager.onSuccessfulFileLoad - End function."))}};Z.src=Q};c.prototype.q5i=function(Q,O,ea,Z){this.Xd=Q;this.iV=Z;this.uploaderCreator.ufi(this.$,O,ea,Z,this)};c.prototype.Aoj=function(Q,O,ea,Z,S){this.JMa=m.a.create().toString();this.Nnd=0;this.rzb=ea;this.imageWidth=Z;this.imageHeight=S;this.errorMessage=this.tableData="";this.XVc=!1;this.Lbg=this.$.Sb.Kh("LoadResource","DataFromPictureTaskpaneLaunch");
this.Lbg.start();this.M_i(Q,O);this.Kte=this.$.Sb.Kh("LoadResource","DataFromPictureAnnotation");this.Kte.start();this.DZj()};c.prototype.DZj=function(){if(this.rzb.length){var Q=window.self.atob(this.rzb);for(var O=new Uint8Array(Q.length),ea=0;ea<Q.length;ea++)O[ea]=Q.charCodeAt(ea);this.augmentationLoopManager.CZj(O,this.JMa,this.imageWidth,this.imageHeight)}else l.ULS.sendTraceTag(523805134,0,10,"DataFromPictureManager.UploadImageToAugmentationLoop - imageDataBase64 is empty")};c.prototype.M_i=
function(Q,O){O.SessionID=this.JMa;O.DataFromPictureAssetId="FA000000050";O.LoadDataFromPictureTaskpane=!0;Q=new A.a(-859308420,Q.method,Q.mode,Q.ef,Q.tabName);this.$.Ka.dc(Q,O)};c.prototype.R$c=function(Q){try{var O=a.from(Q,"utf16le").toString("base64");return H.a.DIa(this.JMa,O)}catch(ea){return l.ULS.sendTraceTag(523805133,0,10,"DataFromPictureManager.encodeAndEncrypt - Buffer can't encode message.",ea.message),""}};c.prototype.ogh=function(Q){try{var O=H.a.DIa(this.JMa,Q);return a.from(O,"base64").toString("utf16le")}catch(ea){return l.ULS.sendTraceTag(523805132,
0,50,"DataFromPictureManager.decryptAndDecode - Buffer can't decode message.",ea.message),""}};c.prototype.wsj=function(){if(this.rzb.length){var Q=w.a(this.$).nba("FA000000050"),O={};O=(O.DataFromPictureWildcard=".",O);O.imageData=this.R$c(this.rzb);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(Q,"onCustomMessage",O,function(ea){ea&&l.ULS.sendTraceTag(523805130,0,10,"DataFromPictureManager.sendImageToTaskPane() - Attempted to send image to Pane - Failed .")})}else l.ULS.sendTraceTag(523805131,
0,10,"DataFromPictureManager.sendImageToTaskPane() - Attempted to send image to Pane - Failed no image Data.")};c.prototype.R0f=function(){if(this.tableData.length){var Q=w.a(this.$).nba("FA000000050"),O={};O=(O.DataFromPictureWildcard=".",O);O.tableHtml=this.R$c(this.tableData);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(Q,"onCustomMessage",O,function(ea){ea&&l.ULS.sendTraceTag(523805128,0,10,"DataFromPictureManager.sendTableToTaskPane() - Attempted to send table data to Pane - Failed.")})}else l.ULS.sendTraceTag(523805129,
0,10,"DataFromPictureManager.sendTableToTaskPane() - Attempted to send table data to Pane - Failed, No Table Data.")};c.prototype.A0f=function(){if(this.errorMessage.length){var Q=w.a(this.$).nba("FA000000050"),O={};O=(O.DataFromPictureWildcard=".",O);O.errorMessage=this.R$c(this.errorMessage);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(Q,"onCustomMessage",O,function(ea){ea&&l.ULS.sendTraceTag(523805126,0,10,"DataFromPictureManager.sendErrorMessageToTaskPane() - Attempted to send ErrorMessage to Pane - Failed .")})}else l.ULS.sendTraceTag(523805127,
0,10,"DataFromPictureManager.sendErrorToTaskPane() - Attempted to send ErrorMessage to Pane - Failed, No valid error message.")};c.prototype.initialize=function(){window.addEventListener("message",this.QJe,!1);this.augmentationLoopManager.activateAnnotation(this.Wcf);this.augmentationLoopManager.uQ(this.Wcf,this.Qci)};Object(e.a)(c,"DataFromPictureManager",u.a,[986])}).call(this,b(1360).Olg)},1360:function(z,F,b){(function(a){function c(){try{var S=new Uint8Array(1);S.__proto__={__proto__:Uint8Array.prototype,
Ied:function(){return 42}};return 42===S.Ied()&&"function"===typeof S.subarray&&0===S.subarray(1,1).byteLength}catch(I){return!1}}function e(S,I){if((l.VP?2147483647:1073741823)<I)throw new RangeError("Invalid typed array length");l.VP?(S=new Uint8Array(I),S.__proto__=l.prototype):(null===S&&(S=new l(I)),S.length=I);return S}function l(S,I,P){if(!(l.VP||this instanceof l))return new l(S,I,P);if("number"===typeof S){if("string"===typeof I)throw Error("If encoding is specified then the first argument must be a string");
return h(this,S)}return m(this,S,I,P)}function m(S,I,P,J){if("number"===typeof I)throw new TypeError('"value" argument must not be a number');if("undefined"!==typeof ArrayBuffer&&I instanceof ArrayBuffer){I.byteLength;if(0>P||I.byteLength<P)throw new RangeError("'offset' is out of bounds");if(I.byteLength<P+(J||0))throw new RangeError("'length' is out of bounds");I=void 0===P&&void 0===J?new Uint8Array(I):void 0===J?new Uint8Array(I,P):new Uint8Array(I,P,J);l.VP?(S=I,S.__proto__=l.prototype):S=u(S,
I);I=S}else if("string"===typeof I){J=S;S=P;if("string"!==typeof S||""===S)S="utf8";if(!l.ghf(S))throw new TypeError('"encoding" must be a valid string encoding');P=B(I,S)|0;J=e(J,P);I=J.write(I,S);I!==P&&(J=J.slice(0,I));I=J}else I=w(S,I);return I}function n(S){if("number"!==typeof S)throw new TypeError('"size" argument must be a number');if(0>S)throw new RangeError('"size" argument must not be negative');}function h(S,I){n(I);S=e(S,0>I?0:r(I)|0);if(!l.VP)for(var P=0;P<I;++P)S[P]=0;return S}function u(S,
I){var P=0>I.length?0:r(I.length)|0;S=e(S,P);for(var J=0;J<P;J+=1)S[J]=I[J]&255;return S}function w(S,I){if(l.isBuffer(I)){var P=r(I.length)|0;S=e(S,P);if(0===S.length)return S;I.copy(S,0,0,P);return S}if(I){if("undefined"!==typeof ArrayBuffer&&I.buffer instanceof ArrayBuffer||"length"in I)return(P="number"!==typeof I.length)||(P=I.length,P=P!==P),P?e(S,0):u(S,I);if("Buffer"===I.type&&O(I.data))return u(S,I.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.");
}function r(S){if(S>=(l.VP?2147483647:1073741823))throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+(l.VP?2147483647:1073741823).toString(16)+" bytes");return S|0}function B(S,I){if(l.isBuffer(S))return S.length;if("undefined"!==typeof ArrayBuffer&&"function"===typeof ArrayBuffer.isView&&(ArrayBuffer.isView(S)||S instanceof ArrayBuffer))return S.byteLength;"string"!==typeof S&&(S=""+S);var P=S.length;if(0===P)return 0;for(var J=!1;;)switch(I){case "ascii":case "latin1":case "binary":return P;
case "utf8":case "utf-8":case void 0:return E(S).length;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return 2*P;case "hex":return P>>>1;case "base64":return H(S).length;default:if(J)return E(S).length;I=(""+I).toLowerCase();J=!0}}function y(S,I,P){var J=!1;if(void 0===I||0>I)I=0;if(I>this.length)return"";if(void 0===P||P>this.length)P=this.length;if(0>=P)return"";P>>>=0;I>>>=0;if(P<=I)return"";for(S||(S="utf8");;)switch(S){case "hex":S=I;I=P;P=this.length;if(!S||0>S)S=0;if(!I||0>I||I>P)I=
P;J="";for(P=S;P<I;++P)S=J,J=this[P],J=16>J?"0"+J.toString(16):J.toString(16),J=S+J;return J;case "utf8":case "utf-8":return t(this,I,P);case "ascii":S="";for(P=Math.min(this.length,P);I<P;++I)S+=String.fromCharCode(this[I]&127);return S;case "latin1":case "binary":S="";for(P=Math.min(this.length,P);I<P;++I)S+=String.fromCharCode(this[I]);return S;case "base64":return 0===I&&P===this.length?Q.vZe(this):Q.vZe(this.slice(I,P));case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":I=this.slice(I,P);
P="";for(S=0;S<I.length;S+=2)P+=String.fromCharCode(I[S]+256*I[S+1]);return P;default:if(J)throw new TypeError("Unknown encoding: "+S);S=(S+"").toLowerCase();J=!0}}function v(S,I,P,J,aa){if(0===S.length)return-1;"string"===typeof P?(J=P,P=0):2147483647<P?P=2147483647:-2147483648>P&&(P=-2147483648);P=+P;isNaN(P)&&(P=aa?0:S.length-1);0>P&&(P=S.length+P);if(P>=S.length){if(aa)return-1;P=S.length-1}else if(0>P)if(aa)P=0;else return-1;"string"===typeof I&&(I=l.from(I,J));if(l.isBuffer(I))return 0===I.length?
-1:A(S,I,P,J,aa);if("number"===typeof I)return I&=255,l.VP&&"function"===typeof Uint8Array.prototype.indexOf?aa?Uint8Array.prototype.indexOf.call(S,I,P):Uint8Array.prototype.lastIndexOf.call(S,I,P):A(S,[I],P,J,aa);throw new TypeError("val must be string, number or Buffer");}function A(S,I,P,J,aa){function ia(da,ha){return 1===ba?da[ha]:da.raj(ha*ba)}var ba=1,ra=S.length,ka=I.length;if(void 0!==J&&(J=String(J).toLowerCase(),"ucs2"===J||"ucs-2"===J||"utf16le"===J||"utf-16le"===J)){if(2>S.length||2>
I.length)return-1;ba=2;ra/=2;ka/=2;P/=2}if(aa)for(J=-1;P<ra;P++)if(ia(S,P)===ia(I,-1===J?0:P-J)){if(-1===J&&(J=P),P-J+1===ka)return J*ba}else-1!==J&&(P-=P-J),J=-1;else for(P+ka>ra&&(P=ra-ka);0<=P;P--){ra=!0;for(J=0;J<ka;J++)if(ia(S,P+J)!==ia(I,J)){ra=!1;break}if(ra)return P}return-1}function t(S,I,P){P=Math.min(S.length,P);for(var J=[];I<P;){var aa=S[I],ia=null,ba=239<aa?4:223<aa?3:191<aa?2:1;if(I+ba<=P)switch(ba){case 1:128>aa&&(ia=aa);break;case 2:var ra=S[I+1];128===(ra&192)&&(aa=(aa&31)<<6|ra&
63,127<aa&&(ia=aa));break;case 3:ra=S[I+1];var ka=S[I+2];128===(ra&192)&&128===(ka&192)&&(aa=(aa&15)<<12|(ra&63)<<6|ka&63,2047<aa&&(55296>aa||57343<aa)&&(ia=aa));break;case 4:ra=S[I+1];ka=S[I+2];var da=S[I+3];128===(ra&192)&&128===(ka&192)&&128===(da&192)&&(aa=(aa&15)<<18|(ra&63)<<12|(ka&63)<<6|da&63,65535<aa&&1114112>aa&&(ia=aa))}null===ia?(ia=65533,ba=1):65535<ia&&(ia-=65536,J.push(ia>>>10&1023|55296),ia=56320|ia&1023);J.push(ia);I+=ba}S=J.length;if(S<=ea)J=String.fromCharCode.apply(String,J);else{P=
"";for(I=0;I<S;)P+=String.fromCharCode.apply(String,J.slice(I,I+=ea));J=P}return J}function E(S,I){I=I||Infinity;for(var P,J=S.length,aa=null,ia=[],ba=0;ba<J;++ba){P=S.charCodeAt(ba);if(55295<P&&57344>P){if(!aa){if(56319<P){-1<(I-=3)&&ia.push(239,191,189);continue}else if(ba+1===J){-1<(I-=3)&&ia.push(239,191,189);continue}aa=P;continue}if(56320>P){-1<(I-=3)&&ia.push(239,191,189);aa=P;continue}P=(aa-55296<<10|P-56320)+65536}else aa&&-1<(I-=3)&&ia.push(239,191,189);aa=null;if(128>P){if(0>--I)break;
ia.push(P)}else if(2048>P){if(0>(I-=2))break;ia.push(P>>6|192,P&63|128)}else if(65536>P){if(0>(I-=3))break;ia.push(P>>12|224,P>>6&63|128,P&63|128)}else if(1114112>P){if(0>(I-=4))break;ia.push(P>>18|240,P>>12&63|128,P>>6&63|128,P&63|128)}else throw Error("Invalid code point");}return ia}function C(S){for(var I=[],P=0;P<S.length;++P)I.push(S.charCodeAt(P)&255);return I}function H(S){var I=Q,P=I.SPj;S=(S.trim?S.trim():S.replace(/^\s+|\s+$/g,"")).replace(Z,"");if(2>S.length)S="";else for(;0!==S.length%
4;)S+="=";return P.call(I,S)}function U(S,I,P,J){for(var aa=0;aa<J&&!(aa+P>=I.length||aa>=S.length);++aa)I[aa+P]=S[aa];return aa}var Q=b(1361);b(1362);var O=b(1363);F.Olg=l;F.x3j=function(S){+S!=S&&(S=0);return l.ite(+S)};F.d3j=50;l.VP=void 0!==a.VP?a.VP:c();F.V4j=l.VP?2147483647:1073741823;l.from=function(S,I,P){return m(null,S,I,P)};l.VP&&(l.prototype.__proto__=Uint8Array.prototype,l.__proto__=Uint8Array,"undefined"!==typeof Symbol&&Symbol.species&&l[Symbol.species]===l&&Object.defineProperty(l,
Symbol.species,{value:null,configurable:!0}));l.ite=function(S){n(S);return e(null,S)};l.XMg=function(S){return h(null,S)};l.isBuffer=function(S){return!(null==S||!S.Iug)};l.compare=function(S,I){if(!l.isBuffer(S)||!l.isBuffer(I))throw new TypeError("Arguments must be Buffers");if(S===I)return 0;for(var P=S.length,J=I.length,aa=0,ia=Math.min(P,J);aa<ia;++aa)if(S[aa]!==I[aa]){P=S[aa];J=I[aa];break}return P<J?-1:J<P?1:0};l.ghf=function(S){switch(String(S).toLowerCase()){case "hex":case "utf8":case "utf-8":case "ascii":case "latin1":case "binary":case "base64":case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return!0;
default:return!1}};l.concat=function(S,I){if(!O(S))throw new TypeError('"list" argument must be an Array of Buffers');if(0===S.length)return l.ite(0);var P;if(void 0===I)for(P=I=0;P<S.length;++P)I+=S[P].length;I=l.XMg(I);var J=0;for(P=0;P<S.length;++P){var aa=S[P];if(!l.isBuffer(aa))throw new TypeError('"list" argument must be an Array of Buffers');aa.copy(I,J);J+=aa.length}return I};l.byteLength=B;l.prototype.Iug=!0;l.prototype.toString=function(){var S=this.length|0;return 0===S?"":0===arguments.length?
t(this,0,S):y.apply(this,arguments)};l.prototype.equals=function(S){if(!l.isBuffer(S))throw new TypeError("Argument must be a Buffer");return this===S?!0:0===l.compare(this,S)};l.prototype.compare=function(S,I,P,J,aa){if(!l.isBuffer(S))throw new TypeError("Argument must be a Buffer");void 0===I&&(I=0);void 0===P&&(P=S?S.length:0);void 0===J&&(J=0);void 0===aa&&(aa=this.length);if(0>I||P>S.length||0>J||aa>this.length)throw new RangeError("out of range index");if(J>=aa&&I>=P)return 0;if(J>=aa)return-1;
if(I>=P)return 1;I>>>=0;P>>>=0;J>>>=0;aa>>>=0;if(this===S)return 0;var ia=aa-J,ba=P-I,ra=Math.min(ia,ba);J=this.slice(J,aa);S=S.slice(I,P);for(I=0;I<ra;++I)if(J[I]!==S[I]){ia=J[I];ba=S[I];break}return ia<ba?-1:ba<ia?1:0};l.prototype.includes=function(S,I,P){return-1!==this.indexOf(S,I,P)};l.prototype.indexOf=function(S,I,P){return v(this,S,I,P,!0)};l.prototype.lastIndexOf=function(S,I,P){return v(this,S,I,P,!1)};l.prototype.write=function(S,I,P,J){if(void 0===I)J="utf8",P=this.length,I=0;else if(void 0===
P&&"string"===typeof I)J=I,P=this.length,I=0;else if(isFinite(I))I|=0,isFinite(P)?(P|=0,void 0===J&&(J="utf8")):(J=P,P=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var aa=this.length-I;if(void 0===P||P>aa)P=aa;if(0<S.length&&(0>P||0>I)||I>this.length)throw new RangeError("Attempt to write outside buffer bounds");J||(J="utf8");for(aa=!1;;)switch(J){case "hex":I=Number(I)||0;J=this.length-I;P?(P=Number(P),P>J&&(P=J)):P=J;J=S.length;if(0!==J%2)throw new TypeError("Invalid hex string");
P>J/2&&(P=J/2);for(J=0;J<P;++J){aa=parseInt(S.substr(2*J,2),16);if(isNaN(aa))break;this[I+J]=aa}return J;case "utf8":case "utf-8":return U(E(S,this.length-I),this,I,P);case "ascii":return U(C(S),this,I,P);case "latin1":case "binary":return U(C(S),this,I,P);case "base64":return U(H(S),this,I,P);case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":J=S;aa=this.length-I;for(var ia=[],ba=0;ba<J.length&&!(0>(aa-=2));++ba){var ra=J.charCodeAt(ba);S=ra>>8;ra%=256;ia.push(ra);ia.push(S)}return U(ia,this,
I,P);default:if(aa)throw new TypeError("Unknown encoding: "+J);J=(""+J).toLowerCase();aa=!0}};l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this.B3j||this,0)}};var ea=4096;l.prototype.slice=function(S,I){var P=this.length;S=~~S;I=void 0===I?P:~~I;0>S?(S+=P,0>S&&(S=0)):S>P&&(S=P);0>I?(I+=P,0>I&&(I=0)):I>P&&(I=P);I<S&&(I=S);if(l.VP)I=this.subarray(S,I),I.__proto__=l.prototype;else{P=I-S;I=new l(P,void 0);for(var J=0;J<P;++J)I[J]=this[J+S]}return I};l.prototype.raj=
function(S){if(0!==S%1||0>S)throw new RangeError("offset is not uint");if(S+2>this.length)throw new RangeError("Trying to access beyond buffer length");return this[S]<<8|this[S+1]};l.prototype.copy=function(S,I,P,J){P||(P=0);J||0===J||(J=this.length);I>=S.length&&(I=S.length);I||(I=0);0<J&&J<P&&(J=P);if(J===P||0===S.length||0===this.length)return 0;if(0>I)throw new RangeError("targetStart out of bounds");if(0>P||P>=this.length)throw new RangeError("sourceStart out of bounds");if(0>J)throw new RangeError("sourceEnd out of bounds");
J>this.length&&(J=this.length);S.length-I<J-P&&(J=S.length-I+P);var aa=J-P;if(this===S&&P<I&&I<J)for(J=aa-1;0<=J;--J)S[J+I]=this[J+P];else if(1E3>aa||!l.VP)for(J=0;J<aa;++J)S[J+I]=this[J+P];else Uint8Array.prototype.set.call(S,this.subarray(P,P+aa),I);return aa};l.prototype.fill=function(S,I,P,J){if("string"===typeof S){"string"===typeof I?(J=I,I=0,P=this.length):"string"===typeof P&&(J=P,P=this.length);if(1===S.length){var aa=S.charCodeAt(0);256>aa&&(S=aa)}if(void 0!==J&&"string"!==typeof J)throw new TypeError("encoding must be a string");
if("string"===typeof J&&!l.ghf(J))throw new TypeError("Unknown encoding: "+J);}else"number"===typeof S&&(S&=255);if(0>I||this.length<I||this.length<P)throw new RangeError("Out of range index");if(P<=I)return this;I>>>=0;P=void 0===P?this.length:P>>>0;S||(S=0);if("number"===typeof S)for(J=I;J<P;++J)this[J]=S;else for(S=l.isBuffer(S)?S:E((new l(S,J)).toString()),aa=S.length,J=0;J<P-I;++J)this[J+I]=S[J%aa];return this};var Z=/[^+\/0-9A-Za-z-_]/g}).call(this,b(742))},1361:function(z,F){function b(l){var m=
l.length;if(0<m%4)throw Error("Invalid string. Length must be a multiple of 4");l=l.indexOf("=");-1===l&&(l=m);return[l,l===m?0:4-l%4]}F.byteLength=function(l){l=b(l);var m=l[1];return 3*(l[0]+m)/4-m};F.SPj=function(l){var m=b(l);var n=m[0];m=m[1];var h=new e(3*(n+m)/4-m),u=0,w=0<m?n-4:n,r;for(r=0;r<w;r+=4)n=c[l.charCodeAt(r)]<<18|c[l.charCodeAt(r+1)]<<12|c[l.charCodeAt(r+2)]<<6|c[l.charCodeAt(r+3)],h[u++]=n>>16&255,h[u++]=n>>8&255,h[u++]=n&255;2===m&&(n=c[l.charCodeAt(r)]<<2|c[l.charCodeAt(r+1)]>>
4,h[u++]=n&255);1===m&&(n=c[l.charCodeAt(r)]<<10|c[l.charCodeAt(r+1)]<<4|c[l.charCodeAt(r+2)]>>2,h[u++]=n>>8&255,h[u++]=n&255);return h};F.vZe=function(l){for(var m=l.length,n=m%3,h=[],u=0,w=m-n;u<w;u+=16383){for(var r=h,B=r.push,y,v=l,A=u+16383>w?w:u+16383,t=[],E=u;E<A;E+=3)y=(v[E]<<16&16711680)+(v[E+1]<<8&65280)+(v[E+2]&255),t.push(a[y>>18&63]+a[y>>12&63]+a[y>>6&63]+a[y&63]);y=t.join("");B.call(r,y)}1===n?(l=l[m-1],h.push(a[l>>2]+a[l<<4&63]+"==")):2===n&&(l=(l[m-2]<<8)+l[m-1],h.push(a[l>>10]+a[l>>
4&63]+a[l<<2&63]+"="));return h.join("")};var a=[],c=[],e="undefined"!==typeof Uint8Array?Uint8Array:Array;for(z=0;64>z;++z)a[z]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[z],c["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(z)]=z;c[45]=62;c[95]=63},1362:function(z,F){F.read=function(b,a,c,e,l){var m=8*l-e-1;var n=(1<<m)-1,h=n>>1,u=-7;l=c?l-1:0;var w=c?-1:1,r=b[a+l];l+=w;c=r&(1<<-u)-1;r>>=-u;for(u+=m;0<u;c=256*c+b[a+l],l+=w,u-=8);m=c&(1<<-u)-1;
c>>=-u;for(u+=e;0<u;m=256*m+b[a+l],l+=w,u-=8);if(0===c)c=1-h;else{if(c===n)return m?NaN:Infinity*(r?-1:1);m+=Math.pow(2,e);c-=h}return(r?-1:1)*m*Math.pow(2,c-e)};F.write=function(b,a,c,e,l,m){var n,h=8*m-l-1,u=(1<<h)-1,w=u>>1,r=23===l?Math.pow(2,-24)-Math.pow(2,-77):0;m=e?0:m-1;var B=e?1:-1,y=0>a||0===a&&0>1/a?1:0;a=Math.abs(a);isNaN(a)||Infinity===a?(a=isNaN(a)?1:0,e=u):(e=Math.floor(Math.log(a)/Math.LN2),1>a*(n=Math.pow(2,-e))&&(e--,n*=2),a=1<=e+w?a+r/n:a+r*Math.pow(2,1-w),2<=a*n&&(e++,n/=2),e+
w>=u?(a=0,e=u):1<=e+w?(a=(a*n-1)*Math.pow(2,l),e+=w):(a=a*Math.pow(2,w-1)*Math.pow(2,l),e=0));for(;8<=l;b[c+m]=a&255,m+=B,a/=256,l-=8);e=e<<l|a;for(h+=l;0<h;b[c+m]=e&255,m+=B,e/=256,h-=8);b[c+m-B]|=128*y}},1363:function(z){var F={}.toString;z.exports=Array.isArray||function(b){return"[object Array]"==F.call(b)}},1364:function(z,F,b){function a(){var l=e.call(this)||this;l.errorCode=null;l.errorDescription=null;l.html=null;l.H_=Object.assign(new c.a,{T_:a.getTypeName(),B_:a.xe()});return l}b.d(F,"a",
function(){return a});z=b(0);F=b(932);var c=b(909),e=F.a;Am(a,e);a.getTypeName=function(){return"AugLoop_ImageToTable_DetectedHtmlTableAnnotation"};a.xe=function(){return["AugLoop_Core_Annotation"]};Object(z.a)(a,"DetectedHtmlTableAnnotation",F.a,[])},1365:function(z,F,b){function a(){}b.d(F,"a",function(){return a});z=b(0);a.DIa=function(c,e){if(!(c&&e&&c.length&&e.length)||256<c.length)return"";var l=Array(256),m=Array(256),n,h=0,u=0,w="";for(n=0;256>n;n++)l[n]=n;for(n=0;256>n;n++){var r=c.charCodeAt(n%
c.length);if(256<=r)return"";h=(h+l[n]+r)%256;r=l[n];l[n]=l[h];l[h]=r}for(n=0;256>n;n++)m[n]=l[256-n-1];for(c=h=n=0;c<e.length;c++){n=(n+1)%256;h=(h+l[n])%256;r=l[n];l[n]=l[h];l[h]=r;r=e.charCodeAt(c);if(256<=r)return"";var B=r^l[(l[n]+l[h])%256];u=(u+m[n])%256;r=m[n];m[n]=m[u];m[u]=r;w+=String.fromCharCode(B^l[(m[n]+m[u])%256])}return w};Object(z.a)(a,"RC4A",null,[])},1367:function(z,F,b){function a(l,m,n,h){this.uUc=this.emb=this.wUc=null;this.qFa=l;e.AFrameworkApplication.ha.ra("AddInCommandsMissingTabIsEnabled")?
(this.wUc=n.hYh(),this.emb=n.Jab,this.uUc=n.UFi):(this.wUc=n.EBc,this.uUc=this.emb=null);this.DHc=this.it=m;this.Tzg=h}b.d(F,"a",function(){return a});z=b(0);var c=b(13),e=b(4);a.prototype.pwa=function(l){l=this.APa+this.solutionId+l;return this.cUd?(l in a.B0b||(a.B0b[l]="AddinControl"+a.MLg++),a.B0b[l]):l};a.prototype.IJe=function(l){if(this.cUd){var m=a.B0b,n;for(n in m){var h=n;if(l===m[n])return h.substr(this.APa.length+this.solutionId.length)}}return l};a.prototype.nkd=function(l){l=this.APa+
this.solutionId+l;return this.cUd?(l in a.qYc||(a.qYc[l]="AddinTab"+a.ULg++),a.qYc[l]):l};a.prototype.rZh=function(l){return l.toLowerCase()in this.EBc?(c.ULS.sendTraceTag(17306646,220,50,"Tab id: {0}.",l.toLowerCase()),this.APa+this.EBc[l.toLowerCase()]):null};a.prototype.EZh=function(){if(!this.Jab)return null;for(var l=[],m=Cl(this.Jab),n=m.next();!n.done;n=m.next())l.push(this.APa+n.value);return l};a.prototype.fXh=function(l){l=this.d0e(l);return null===l?null:l[1]};a.prototype.dXh=function(l){l=
this.d0e(l);return null===l?null:l[2]};a.prototype.d0e=function(l){return this.WXd&&l.toLowerCase()in this.WXd?(c.ULS.sendTraceTag(21017039,220,50,"Get attributes for Tab id: {0}.",l.toLowerCase()),this.WXd[l.toLowerCase()]):null};uk.Object.defineProperties(a.prototype,{APa:{configurable:!0,enumerable:!0,get:function(){return this.qFa}},EBc:{configurable:!0,enumerable:!0,get:function(){return this.wUc}},solutionId:{configurable:!0,enumerable:!0,get:function(){return this.it}},assetId:{configurable:!0,
enumerable:!0,get:function(){return this.DHc}},Jab:{configurable:!0,enumerable:!0,get:function(){return this.emb}},WXd:{configurable:!0,enumerable:!0,get:function(){return this.uUc}},cUd:{configurable:!0,enumerable:!0,get:function(){return this.Tzg}}});a.B0b={};a.qYc={};a.ULg=0;a.MLg=0;Object(z.a)(a,"DefaultRibbonNamingProvider",null,[79])},1410:function(z,F,b){function a(y){var v=this;this.pB=null;this.ydg={};this.Adg={};this.Vdd={};this.pBd={};this.Wld=function(A,t){A=v.$.Sb.Hc("Task","DdaEventDispatch.HandleServerEvent");
t=t.X0f;for(var E=0;E<t.length;E++)switch(t[E].EventType){case 2:var C=t[E],H={};H.Name=C.Name;H.BindingType=C.BindingType;H.ColCount=C.ColCount;H.RowCount=C.RowCount;v.Ywa(C.InstanceId,OSF.DDA.EventDispId.dispidBindingDataChangedEvent,H,null);break;case 4:v.Ywa(t[E].InstanceId,OSF.DDA.EventDispId.dispidSettingsChangedEvent,null,null);break;case 8:if(C=t[E],C.InstanceId){H=Array(C.Entries.length);for(var U=0;U<C.Entries.length;U++)H[U]=a.Vdc(C.Entries[U],C.IsRemoteOverride);0<C.Entries.length&&1===
C.Entries[0].Category?v.M6i(C.InstanceId,H):C.InstanceId&&v.Ywa(C.InstanceId,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,H)}else{v.Vdd={};v.pBd={};for(H=0;H<C.Entries.length;H++)v.rMe(C.Entries[H],C.IsRemoteOverride);c.ULS.sendTraceTag(537170593,0,50,"Number of Fired event: {0}, Number of Not Fired event: {1}, Total Number of Fired event: {2}, Total Number of Not Fired event: {3}",v.Vdd,v.pBd,v.ydg,v.Adg)}}A.stop()};this.dLb=function(A,t){v.Ywa(A,OSF.DDA.EventDispId.dispidRichApiMessageEvent,
null,t)};this.$=y;this.Kxc=this.Wld}b.r(F);z=b(0);var c=b(13),e=b(81),l;(function(y){y[y.none=0]="none";y[y.testEvent=1]="testEvent";y[y.test1Event=2]="test1Event";y[y.worksheetDataChangedEvent=10]="worksheetDataChangedEvent";y[y.worksheetActivatedEvent=11]="worksheetActivatedEvent";y[y.worksheetDeactivatedEvent=12]="worksheetDeactivatedEvent";y[y.worksheetAddedEvent=13]="worksheetAddedEvent";y[y.worksheetSelectionChangedEvent=14]="worksheetSelectionChangedEvent";y[y.worksheetDeletedEvent=15]="worksheetDeletedEvent";
y[y.worksheetCalculatedEvent=16]="worksheetCalculatedEvent";y[y.worksheetFilteredEvent=17]="worksheetFilteredEvent";y[y.worksheetFormatChangedEvent=18]="worksheetFormatChangedEvent";y[y.worksheetRowSortedEvent=19]="worksheetRowSortedEvent";y[y.worksheetColumnSortedEvent=20]="worksheetColumnSortedEvent";y[y.worksheetSingleClickedEvent=21]="worksheetSingleClickedEvent";y[y.worksheetRowHiddenChangedEvent=22]="worksheetRowHiddenChangedEvent";y[y.worksheetFormulaChangedEvent=23]="worksheetFormulaChangedEvent";
y[y.worksheetProtectionChangedEvent=24]="worksheetProtectionChangedEvent";y[y.worksheetNameChangedEvent=25]="worksheetNameChangedEvent";y[y.worksheetVisibilityChangedEvent=26]="worksheetVisibilityChangedEvent";y[y.worksheetMovedEvent=27]="worksheetMovedEvent";y[y.worksheetNavigationObjectChangedEvent=28]="worksheetNavigationObjectChangedEvent";y[y.worksheetRowHeightChangedEvent=29]="worksheetRowHeightChangedEvent";y[y.workbookFormulaReferenceStyleChangedEvent=30]="workbookFormulaReferenceStyleChangedEvent";
y[y.chartAddedEvent=50]="chartAddedEvent";y[y.chartActivatedEvent=51]="chartActivatedEvent";y[y.chartDeactivatedEvent=52]="chartDeactivatedEvent";y[y.chartDeletedEvent=53]="chartDeletedEvent";y[y.tableSelectionChangedEvent=100]="tableSelectionChangedEvent";y[y.tableDataChangedEvent=101]="tableDataChangedEvent";y[y.tableAddedEvent=102]="tableAddedEvent";y[y.tableDeletedEvent=103]="tableDeletedEvent";y[y.tableFilteredEvent=104]="tableFilteredEvent";y[y.agaveVisualUpdateEvent=150]="agaveVisualUpdateEvent";
y[y.customFunctionExecutionBeginEvent=200]="customFunctionExecutionBeginEvent";y[y.customFunctionExecutionEndEvent=201]="customFunctionExecutionEndEvent";y[y.commentAddedEvent=250]="commentAddedEvent";y[y.commentDeletedEvent=251]="commentDeletedEvent";y[y.commentChangedEvent=252]="commentChangedEvent";y[y.invocationMessage=1E3]="invocationMessage";y[y.cancellationMessage=1001]="cancellationMessage";y[y.metadataMessage=1002]="metadataMessage";y[y.visualSelectionChangedEvent=2E3]="visualSelectionChangedEvent";
y[y.visualChangeEvent=2001]="visualChangeEvent";y[y.visualTrackerModelChangedEvent=2002]="visualTrackerModelChangedEvent";y[y.shapeSelectionChangedEvent=2100]="shapeSelectionChangedEvent";y[y.shapeActivatedEvent=2101]="shapeActivatedEvent";y[y.shapeDeactivatedEvent=2102]="shapeDeactivatedEvent";y[y.shapeAddedEvent=2103]="shapeAddedEvent";y[y.shapeDeletedEvent=2104]="shapeDeletedEvent";y[y.workbookAutoSaveSettingChangedEvent=2200]="workbookAutoSaveSettingChangedEvent";y[y.wacOperationEvent=2201]="wacOperationEvent";
y[y.recordingStateChangedEvent=2202]="recordingStateChangedEvent";y[y.workbookActivatedEvent=2203]="workbookActivatedEvent";y[y.workbookNavigationObjectChangedEvent=2204]="workbookNavigationObjectChangedEvent";y[y.ribbonCommandExecutedEvent=2300]="ribbonCommandExecutedEvent";y[y.linkedDataTypeRefreshRequestCompletedEvent=2500]="linkedDataTypeRefreshRequestCompletedEvent";y[y.linkedDataTypeRefreshModeChangedEvent=2501]="linkedDataTypeRefreshModeChangedEvent";y[y.linkedDataTypeLinkedDataTypeAddedEvent=
2502]="linkedDataTypeLinkedDataTypeAddedEvent";y[y.linkedWorkbookWorkbookLinksChangedEvent=2600]="linkedWorkbookWorkbookLinksChangedEvent";y[y.linkedWorkbookRefreshCompletedEvent=2601]="linkedWorkbookRefreshCompletedEvent";y[y.rangePickerSelectionChangedEvent=2700]="rangePickerSelectionChangedEvent";y[y.lineageActivityUpdateAvailableEvent=2800]="lineageActivityUpdateAvailableEvent";y[y.lineageActivityFilterUpdatedEvent=2801]="lineageActivityFilterUpdatedEvent";y[y.lineageActivityLoadCompletedEvent=
2802]="lineageActivityLoadCompletedEvent";y[y.pivotTableAddedEvent=2900]="pivotTableAddedEvent";y[y.pivotTableDeletedEvent=2901]="pivotTableDeletedEvent";y[y.namedItemAddedEvent=3E3]="namedItemAddedEvent";y[y.namedItemDeletedEvent=3001]="namedItemDeletedEvent";y[y.guidedReapplyManagerUpdateAvailableEvent=3100]="guidedReapplyManagerUpdateAvailableEvent";y[y.appRuntimeVisibilityChangedEvent=65539]="appRuntimeVisibilityChangedEvent";y[y.beforeCloseNotifiactionCancelledEvent=65540]="beforeCloseNotifiactionCancelledEvent"})(l||
(l={}));Object(z.b)("MessageType",l);var m=b(976),n=b(243),h=b(947),u=b(54),w=b(35),r=b(157),B=b(1);b.d(F,"DdaEventDispatch",function(){return a});a.prototype.d0b=function(y){y&&(this.Cja(),Array.add(this.pB,y))};a.prototype.bvc=function(y){this.pB&&(Array.remove(this.pB,y),this.pB.length||(this.$.wantServerEvents=!1,this.$.oij(this.Kxc),this.pB=null))};a.prototype.M6i=function(y,v){var A=this,t=Object(e.a)(h.DdaFacade,n.a(this.$));w.TaskExtensions.Ba(t.BZh(y),function(E){if(r.b(E)){var C=E.result;
E=t.nn(C);if(C)if(E.Lsd)A.Ywa(C,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,v);else if(E.P7c)for(C=0;C<v.length;C++)Array.add(E.P7c,v[C]);else E.P7c=v}else E.og?c.ULS.sendTraceTag(537170591,0,10,"DdaEventDispatch.HandleServerEvent: Failed to get or create Custom Functions sandbox."):E.Ph&&c.ULS.sendTraceTag(537170590,0,10,"DdaEventDispatch.HandleServerEvent: Getting or creating Custom Functions sandbox is cancelled.")},this.$.la,0)};a.prototype.g7i=function(y,v){var A=Object(e.a)(h.DdaFacade,
n.a(this.$)),t=A.RNh(y);t?OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(t,v,this.dLb):A.n8g(y,v)};a.prototype.rMe=function(y,v){var A=!1,t=parseInt(y.Type,10),E=y.Target,C=Object(e.a)(h.DdaFacade,n.a(this.$));if((E=C.oj.HZh(t,E))&&0<Object.keys(E).length){A=!0;for(var H in E)if(E=H,C.oj.w1b(E)){var U=Array(1);U[0]=a.Vdc(y,v);if(B.EwaSettings.isChangeGateEnabled("OfficeVSO:5379862_RichApiEventsTriggerSource")){var Q=U[0][3];if(void 0!==Q&&null!==Q&&(Q=Object(e.a)(Object,u.a.ui(Q)))&&
void 0!==Q.triggerControlId&&null!==Q.triggerControlId&&void 0!==Q.triggerSource&&null!==Q.triggerSource){var O=!1;v?(Q.triggerSource="Unknown",O=!0):C.jlh(Q.triggerControlId,E)&&(Q.triggerSource="ThisLocalAddin",O=!0);O&&(U[0][3]=u.a.Kc(Q))}}this.Ywa(E,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,U)}}A?(this.Kgc(l[t],this.Vdd),this.Kgc(l[t],this.ydg)):(this.Kgc(l[t],this.pBd),this.Kgc(l[t],this.Adg))};a.prototype.Cja=function(){this.pB||(this.pB=[],this.$.bse(this.Kxc),this.$.wantServerEvents=
!0)};a.prototype.Kgc=function(y,v){y in v||(v[y]=0);v[y]+=1};a.prototype.zN=function(y,v,A){var t={};t.Target=v;t.Category=65536;t.Type=y;t.Message=A;t.Id=-1;this.rMe(t,!1)};a.prototype.DHh=function(y,v){var A={Target:"",Category:2,Type:1E3};A.Message=v;A.Id=0;v=Array(1);v[0]=a.Vdc(A,!1);this.g7i(y,v)};a.prototype.Qac=function(y,v,A,t){var E={};E.Target=A;E.Category=65536;E.Type=v;E.Message=t;E.Id=-1;v=Array(1);v[0]=a.Vdc(E,!1);this.Ywa(y,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,v)};a.prototype.CHh=
function(y,v){this.Ywa(y,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,v)};a.prototype.Ywa=function(y,v,A,t){if(this.pB){var E=Object(e.a)(h.DdaFacade,n.a(this.$));if(!E||v!==OSF.DDA.EventDispId.dispidBindingDataChangedEvent&&v!==OSF.DDA.EventDispId.dispidSettingsChangedEvent||E.oj.w1b(y))for(y=new m.a(v,y,A,t),v=0,A=this.pB.length;v<A;v++)(t=this.pB[v])&&t(y)}};a.Vdc=function(y,v){var A=Array(6);A[0]=y.Category;A[1]=y.Type;A[2]=y.Target;A[3]=y.Message;A[4]=y.Id;A[5]=v;return A};Object(z.a)(a,
"DdaEventDispatch",null,[])},1433:function(z,F,b){function a(){var l=e.call(this,void 0,void 0,void 0,!0)||this;l.aEa="AddinCommandsUILessDialog";l.WUc="WACDialogTitleText";l.IWa="0";l.dEa=380;l.zjb=190;l.Ve=l.aEa;l.lc=5;l.Qqg=String.format("{0}px",l.dEa);l.HWa=String.format("{0}px",l.zjb);l.rv=!1;l.aaf=!1;l.KD();return l}b.d(F,"a",function(){return a});z=b(0);F=b(149);var c=b(90),e=F.a;Am(a,e);a.prototype.KD=function(){e.prototype.KD.call(this);this.Up.style.width=this.Qqg;this.Up.style.height=this.HWa;
this.Up.style.padding=this.IWa};a.prototype.Kv=function(l){this.qP();document.getElementById(this.vi(this.WUc)).innerText=l};a.prototype.qP=function(){e.prototype.qP.call(this);this.Pb.style.width=String.format("{0}px",this.dEa);this.Pb.style.height=String.format("{0}px",this.zjb);this.Pb.removeAttribute(c.a.Vd);this.Pb.removeAttribute(c.a.YE)};a.prototype.hide=function(){this.bzb()};a.prototype.initializeAndShowWithTitle=function(){this.initializeAndShow(CommonUIStrings.l_NotificationUITitle,null,
null)};uk.Object.defineProperties(a.prototype,{L2a:{configurable:!0,enumerable:!0,get:function(){return this.Up}}});Object(z.a)(a,"AddinCommandsUILessDialog",F.a,[94])},1439:function(z,F,b){function a(G){return sk.call(this,G)||this}function c(G,ja,Wa){this.rangePicker=null;this.$=G;this.Le=ja;this.De=new J(G.ea);this.sA=new Q(G,this.De);this.Nvf=Wa;this.gac=new Map}function e(G,ja,Wa,vb,f){this.zVc=null;this.dSb=G;this.RA=ja;this.EJ=Wa;this.wb=vb;this.FCg=f}function l(){}function m(){this.ysa=null}
function n(G){if(!G)throw OfficeExtension.WacRuntime.Utility.createRichApiException("InvalidArgument","wacApiDelegates parameter is null");this.Myd=G}function h(G,ja,Wa){return function(vb){return function(f,D){Th.TaskExtensions.Ba(cj.GetServiceTaskFactory.create(ja.da,279,ja.la,1),function(N){N=N.result;var fa=!1,Ia=Wa.Ni.getOsfControl(G),pb=null;Ia&&(pb=Ia.getStoreType(),(Ia=Ia.getManifest())&&Ia.getSharedRuntimeForCustomFunctions("Workbook")&&(fa=!0));Th.TaskExtensions.Ba(N.Jef(G,pb,vb,fa),function(Wb){wl.b(Wb)?
Wb.result?f(null):D(OfficeExtension.WacRuntime.Utility.createRichApiException(Xa.a.invalidArgument,Ff.a.instance.fa(1719))):D(OfficeExtension.WacRuntime.Utility.createRichApiException(Xa.a.generalException,Ff.a.instance.fa(1715)))},ja.la,3)},ja.la,3)}}}function u(G,ja){this.XP=Ji.a.instance.qc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");this.RA=G;this.EJ=ja;this.pxg=this.EJ.Ni.getOsfControl(this.RA)}function w(G,ja,Wa,vb){this.g6d="";this.XTb=0;this.XP=G;this._id=ja;this.RA=Wa;
this.EJ=vb}function r(G,ja,Wa){this.Bug=G;this.Cug=ja;this.Ayg=Wa}function B(){this.sle=this.rfe=this.GA=!1}function y(G,ja,Wa,vb){this.it=G;this.w2=Wa;this.ez=vb.Ni.getOsfControl(ja)}function v(G,ja){this.EJ=ja;this.RA=G}function A(G){this.RA=G}function t(G){this.EJa={};this.fEi=G}function E(G,ja){var Wa=this;Wa.hlf=function(vb,f){vb=E.d7g(vb,f);if(!pl.a(Wa.$,vb))return!0;vb=Wa.$.shortcutKeyManager.T6e(vb);return!!vb&&0<vb.length};Wa.addinId=G;Wa.$=ja;return Wa}function C(){}function H(){}function U(G,
ja,Wa,vb){this.uFh=G;this.fileSize=ja;this.$Hj=vb}function Q(G,ja){var Wa=this;this.KI=function(vb,f){Wa.uR.WKa(Kf.a.internalError,f)};this.$=G;this.uR=ja}function O(G,ja,Wa,vb){Wa=jl.call(this,576,0,Wa,vb)||this;Wa.dPd=new Z("576",G,ja);return Wa}function ea(G,ja,Wa,vb,f,D,N,fa){ja=Vk.call(this,10,0,ja,fa)||this;ja.Gnb=Wa;ja.Ujb=vb;ja.t4=f;ja.iGa=D;ja.request=N;ja.dPd=new Z("10",G,N);return ja}function Z(G,ja,Wa){this.parentName=G;this.$=ja;this.request=Wa}function S(G,ja){this.source=G;this.eventId=
ja}function I(G,ja,Wa,vb,f,D){var N=G.Ma(1);N.request=ja;return $i.i(G,"ExecuteRichApiRequest",N,Wa,vb,f,D,0)}function P(G,ja,Wa){this.$=G;this.uR=ja;this.sA=Wa}function J(G){this.ea=G}function aa(G,ja,Wa,vb){G=hj.call(this,G,"Select Data")||this;G.Bqb=null;G.$Je=ja;G.t8c=Wa;G.callback=vb;return G}function ia(G){this.wb=G}function ba(G){G.add("InternalTest","PreviewExecutionMethod",ra)}function ra(G,ja){console.log("InternalTestPreviewExecution.PreviewExecutionMethod: typeof(objectId)="+typeof G+
", objectId="+G+", value="+ja);return null}function ka(G,ja){this.pwg=G;this.Nwg=ja}function da(G){var ja=G.addType("Microsoft.Office.ActionService","{b9b4137f-8502-4b7a-9f64-d9b7c69bf883}","{df562add-0bb3-47cb-9780-0bd6c054e5e8}",3,0);var Wa=ja.addMethod("AreShortcutsInUse",3,"Object[]",1,0,"AreShortcutsInUse",0);Wa.addParameter("shortcuts","String[]",1,null,0);ja.addMethod("GetShortcuts",1,"Object",1,1,"Shortcuts",0);Wa=ja.addMethod("ReplaceShortcuts",2,"Void",0,0,"ReplaceShortcuts",0);Wa.addParameter("shortcuts",
"Object",1,null,0);ja=G.addType("Microsoft.Office.SharedFilePicker","{209dd80f-a169-43dd-be1e-504a1a11a736}","{3f72536f-72cd-42d9-b4fd-eb8f8561e1f5}",3,0);Wa=ja.addMethod("GetSharedFilePickerResponse",1,"Object",1,1,"SharedFilePickerResponse",0);Wa.addParameter("pickerCustomizationJsonString","String",1,null,0);ja=G.addType("Microsoft.ExcelServices.WacWorkbook","{79eea901-609d-4204-a8f6-9f40f367a679}","",3,0);Wa=ja.addMethod("CreateAndOpenWorkbook",1,"Void",0,1,"CreateAndOpenWorkbook",0);Wa.addParameter("base64File",
"String",1,null,0);ja=G.addType("Microsoft.ExcelServices.AppRuntimeService","{21351f4a-8ee5-42e7-9776-62f23a567703}","",3,0);ja.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeState",0);Wa=ja.addMethod("SetAppRuntimeState",1,"Void",0,1,"SetAppRuntimeState",0);Wa.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);ja=G.addType("Microsoft.ExcelServices.CustomFunctionManager","{158db0d2-762c-449f-9917-b7c4778971ef}","{1a8cbe28-44d1-4b9a-9cd2-69311e909c1a}",
3,0);ja.addProperty("Status",2,"Microsoft.ExcelServices.CustomFunctionEngineStatus",2,!0,null,0);Wa=ja.addMethod("Register",1,"Void",0,0,"Register",0);Wa.addParameter("metadata","String",1,null,0);Wa.addParameter("javascript","String",1,null,0);ja=G.addType("Microsoft.ExcelServices.CustomFunctionEngineStatus","{22864d76-d53e-416b-b496-23e5bb38ebd0}","",2,0);ja.addProperty("Enabled",1,"Boolean",1,!1,null,0);ja.addProperty("NativeRuntime",3,"Boolean",1,!1,null,0);ja.addProperty("StreamingEnabled",2,
"Boolean",1,!1,null,0);ja=G.addEnumType("Microsoft.Authentication.IdentityType");ja.addEnumField("OrganizationAccount",0);ja.addEnumField("MicrosoftAccount",1);ja=G.addEnumType("Microsoft.Authentication.AuthorityType");ja.addEnumField("External",0);ja.addEnumField("Msa",1);ja.addEnumField("Aad",2);ja=G.addType("Microsoft.Authentication.OfficeIdentityInfo","{4c070280-74b4-4850-adfd-178c6c287817}","{8b83e3cb-6183-4206-bbcf-cc019d857327}",2,0);ja.addProperty("DisplayName",4,"String",1,!1,null,0);ja.addProperty("Email",
3,"String",1,!1,null,0);ja.addProperty("FederationProvider",2,"String",1,!1,null,0);ja.addProperty("IdentityType",1,"Microsoft.Authentication.IdentityType",1,!1,null,0);ja=G.addType("Microsoft.Authentication.AuthContext","{fd7bb67b-838a-4e86-84df-43023e360260}","{14d05e71-cb07-4eb7-bb51-93bc432750f9}",2,0);ja.addProperty("AppId",4,"String",1,!1,null,0);ja.addProperty("Authority",2,"String",1,!1,null,0);ja.addProperty("AuthorityType",3,"Microsoft.Authentication.AuthorityType",1,!1,null,0);ja.addProperty("IsAnonymous",
5,"Boolean",1,!1,null,0);ja.addProperty("TenantId",6,"String",1,!1,null,0);ja.addProperty("Upn",1,"String",1,!1,null,0);ja=G.addType("Microsoft.Authentication.AuthenticationService","{3084014c-8862-4ad3-adf6-fb105947dd9a}","{799af6f3-8bf5-4859-8aca-7dd712862fca}",3,0);ja.addProperty("RoamingSettings",99,"Microsoft.Authentication.RoamingSettingCollection",3,!0,null,0);Wa=ja.addMethod("GetAccessToken",1,"Microsoft.Authentication.SingleSignOnToken",2,1,"AccessToken",4);Wa.addParameter("tokenParameters",
"Microsoft.Authentication.TokenParameters",2,null,0);ja.addMethod("GetAuthContext",3,"Microsoft.Authentication.AuthContext",2,1,"AuthContext",0);ja.addMethod("GetPrimaryIdentityInfo",2,"Microsoft.Authentication.OfficeIdentityInfo",2,1,"PrimaryIdentityInfo",4);ja=G.addType("Microsoft.Authentication.TokenParameters","{d9b0bca1-16af-48a6-b707-3b2bc97b082e}","{6e979115-496c-4ded-8ffb-b21d9ae45a6c}",2,0);ja.addProperty("AuthChallenge",3,"String",1,!1,null,0);ja.addProperty("CorrelationId",7,"String",1,
!1,null,0);ja.addProperty("Policy",4,"String",1,!1,null,0);ja.addProperty("Resource",2,"String",1,!1,null,0);ja.addProperty("Scope",5,"String",1,!1,null,0);ja.addProperty("SilentLogin",6,"Boolean",1,!1,null,0);ja=G.addType("Microsoft.Authentication.SingleSignOnToken","{dd692cad-089f-4adf-b070-bb12a957fef1}","{21e799a6-33ec-4ec7-8e74-fe7c4765a59f}",2,0);ja.addProperty("AccessToken",2,"String",1,!1,null,0);ja.addProperty("TokenIdenityType",3,"Microsoft.Authentication.IdentityType",1,!1,null,0);ja=G.addType("Microsoft.Authentication.RoamingSetting",
"{4f7e9fad-cbd7-4d76-8dab-9a2f7dc00141}","",3,0);ja.addProperty("Id",1,"String",1,!0,null,0);ja.addProperty("Value",2,"Object",1,!1,null,0);ja=G.addType("Microsoft.Authentication.RoamingSettingCollection","{f9e004e4-a087-42ec-b22d-51ac584551a9}","",3,0);Wa=ja.addMethod("GetItem",1,"Microsoft.Authentication.RoamingSetting",3,1,"Item",0);Wa.addParameter("id","String",1,null,0);Wa=ja.addMethod("GetItemOrNullObject",2,"Microsoft.Authentication.RoamingSetting",3,1,"ItemOrNullObject",0);Wa.addParameter("id",
"String",1,null,0);ja=G.addType("Microsoft.AppRuntime.AppRuntimeService","{a9f1fc0a-741e-4882-87e1-025d6f8024e7}","{43a4559c-806b-4e89-914e-da9256212148}",3,0);ja.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeState",0);Wa=ja.addMethod("SetAppRuntimeState",1,"Void",0,0,"SetAppRuntimeState",0);Wa.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);ja=G.addEnumType("Microsoft.AppRuntime.AppRuntimeState");ja.addEnumField("Inactive",
0);ja.addEnumField("Background",1);ja.addEnumField("Visible",2);ja=G.addEnumType("Microsoft.AppRuntime.Visibility");ja.addEnumField("Hidden",1);ja.addEnumField("Visible",2);ja=G.addType("Microsoft.DynamicRibbon.DynamicRibbon","{967ecb27-5cdb-41a1-8383-04fc1d6e118f}","{a652fd4a-c501-486a-8cb6-ed52946eca50}",3,0);ja.addProperty("Buttons",4,"Microsoft.DynamicRibbon.RibbonButtonCollection",3,!0,null,0);Wa=ja.addMethod("ExecuteRequestCreate",7,"Void",0,1,"ExecuteRequestCreate",0);Wa.addParameter("jsonCreate",
"String",1,null,0);Wa=ja.addMethod("ExecuteRequestUpdate",6,"Void",0,1,"ExecuteRequestUpdate",0);Wa.addParameter("jsonUpdate","String",1,null,0);Wa=ja.addMethod("GetButton",3,"Microsoft.DynamicRibbon.RibbonButton",3,1,"Button",0);Wa.addParameter("id","String",1,null,0);Wa=ja.addMethod("GetTab",5,"Microsoft.DynamicRibbon.RibbonTab",3,1,"Tab",0);Wa.addParameter("id","String",1,null,0);ja.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);ja=G.addType("Microsoft.DynamicRibbon.RibbonTab","{c68e16e8-67dd-48cf-b92f-46b40ca336ee}",
"",3,0);ja.addProperty("Id",2,"String",1,!0,null,0);Wa=ja.addMethod("SetVisibility",3,"Void",0,0,"SetVisibility",0);Wa.addParameter("visibility","Boolean",1,null,0);ja.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);ja=G.addType("Microsoft.DynamicRibbon.RibbonButton","{88e27ee2-4787-4d0d-8ff7-788a8be7c8c5}","",3,0);ja.addProperty("Enabled",3,"Boolean",1,!1,null,0);ja.addProperty("Id",2,"String",1,!0,null,0);ja.addProperty("Label",4,"String",1,!0,null,0);Wa=ja.addMethod("SetEnabled",5,"Void",0,0,
"SetEnabled",0);Wa.addParameter("enabled","Boolean",1,null,0);ja.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);ja=G.addType("Microsoft.DynamicRibbon.RibbonButtonCollection","{208b41cf-a38c-47cd-83fc-0ff0c4848ec3}","",3,0);ja.addMethod("GetCount",3,"Int32",1,1,"Count",0);Wa=ja.addIndexerMethod(2,"Microsoft.DynamicRibbon.RibbonButton",3,0);Wa.addParameter("key","String",1,null,0);ja.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);ja.setCollectionInfo("Microsoft.DynamicRibbon.RibbonButton",!0);
ja=G.addEnumType("Microsoft.Office.Licensing.LicenseFeatureTier");ja.addEnumField("Unknown",0);ja.addEnumField("Basic",1);ja.addEnumField("Premium",2);ja=G.addType("Microsoft.Office.Licensing.License","{db7c13ab-8285-4ff7-88d6-c9e7b2ca9b12}","{89df9b4a-85de-42d7-89d1-de8bc29e6df0}",3,0);Wa=ja.addMethod("GetFeatureTier",2,"Microsoft.Office.Licensing.LicenseFeatureTier",1,1,"FeatureTier",0);Wa.addParameter("feature","String",1,null,0);Wa.addParameter("fallbackValue","Microsoft.Office.Licensing.LicenseFeatureTier",
1,null,0);Wa=ja.addMethod("GetLicenseFeature",5,"Microsoft.Office.Licensing.LicenseFeature",3,1,"LicenseFeature",0);Wa.addParameter("feature","String",1,null,0);Wa=ja.addMethod("IsFeatureEnabled",1,"Boolean",1,1,"IsFeatureEnabled",0);Wa.addParameter("feature","String",1,null,0);Wa.addParameter("fallbackValue","Boolean",1,null,0);ja.addMethod("IsFreemiumUpsellEnabled",3,"Boolean",1,1,"IsFreemiumUpsellEnabled",0);Wa=ja.addMethod("LaunchUpsellExperience",4,"Void",0,1,"LaunchUpsellExperience",0);Wa.addParameter("experienceId",
"String",1,null,0);Wa=ja.addMethod("_TestFireStateChangedEvent",6,"Void",0,0,"_TestFireStateChangedEvent",4);Wa.addParameter("feature","String",1,null,0);ja=G.addType("Microsoft.Office.Licensing.LicenseFeature","{5af0b996-137f-447f-99be-8749e73546c8}","",3,0);ja.addProperty("Id",5,"String",1,!0,null,0);ja.addMethod("_RegisterStateChange",6,"Void",0,1,"_RegisterStateChange",0);ja.addMethod("_UnregisterStateChange",7,"Void",0,1,"_UnregisterStateChange",0);ja=G.addType("Microsoft.InternalService.AddinInternalService",
"{4ddc0abf-728b-44e0-b834-138c166e2651}","{16374866-b755-4a62-8e65-ad23696872b0}",3,0);ja.addMethod("NotifyActionHandlerReady",1,"Void",0,1,"NotifyActionHandlerReady",0);ja=G.addType("Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification","{d689e1c3-2ec7-4e8d-9327-7d6703cde2c5}","{bc4e14a3-3463-425f-8e52-07b578e4c4b7}",3,0);ja.addMethod("Disable",3,"Void",0,1,"Disable",0);ja.addMethod("Enable",2,"Void",0,1,"Enable",0);ja.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0)}function ha(G,
ja,Wa,vb){this.menuItemId=G;this.hJ=ja;this.GLj=Wa;this.FFh=vb}function qa(G){this.zCi=G}function Aa(G){this.Yya=G;this.Xrg=ig.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AppForOfficeSSOV2MSA",!1)}function Fa(){}function ab(){}function Ua(){}function bb(G,ja){this.ajb=ja;this.RA=G}function xa(){this.s5d=null;this.Hje=this.qXb=this.rE="";this.Uke=!0;this.options=null}function Gb(G,ja){this.GRb=G;this.Ckb=ja}function $b(){}function oa(){this.O9d=this.e9d=this.fga=null;
this.Ckb=0}function Ma(G){var ja=na.call(this)||this;ja.$=G;ja.Xb();return ja}function Za(){this.initialized=!1;this.agaveCommandManager=this.Le=this.A1a=null;this.kV={}}function gb(G){var ja=ok.call(this)||this;ja.$=G;ja.Xb();return ja}function zb(G,ja,Wa){this.Qog=null;this.Sog=0;this.vb=G;this.Yg=ja;this.N6d=Wa}function nb(){}function pa(G,ja,Wa,vb,f){var D=Sj.call(this)||this;D.reb={};D.Zdd={};D.yxa=null;D.TQa=null;D.N9h=function(N,fa,Ia,pb,Wb){if(2!==Ia)return 32;N=Wb[uj.a.X$b];Ia=Wb[uj.a.rIa];
Wb=Wb[uj.a.aAa];fa=new Bj.a;fa.Phi=Wb.wi.InstanceToken;fa.ql=Wb.wi[qe.ql];fa.qT=Wb.wi[qe.qT];qe.taskPaneWidth in Wb.wi&&(fa.taskPaneWidth=Wb.wi[qe.taskPaneWidth]);fa.sourceLocationOverrideResourceId=Wb.wi[qe.sourceLocationOverrideResourceId];fa.CI=Wb.Fr;fa.onTaskPaneClose=Wb.wi[qe.onTaskPaneClose];fa.rIa=Ia;Ia=new Qc.a(-859308420,0,2,0,"");pb=N.getStoreType()===OSF.StoreType.Sdx;var Nc=new rd;Nc.Oba=Wb.wi.HeaderCssClass||hf.a.G3a;Nc.JOb=Wb.wi.TitleCssClass;D.x1(Ia,N.getId(),fa,pb,Nc);return 32};D.y9h=
function(N,fa,Ia,pb,Wb){if(2!==Ia)return 32;N=Wb[uj.a.X$b].getId();Wb=Wb[uj.a.aAa].wi[qe.sourceLocationOverrideResourceId];return N?(D.Le.Ni.refreshOsfControl(N,Wb),32):8};D.x4i=function(N){N=N.Result;if(N=null===N?null:N.SolutionId)D.Le.kpe(N),Jk.a(D.$).soa(3,N)};D.TLf=function(N,fa){var Ia,pb=(N=N.Result)?N.AgaveData:null;if(pb){df.ULS.shipAssertTag(537170434,0,pb.TaskpaneWidth===pa.Ugh,"Taskpane width is {0}, assetId is {1}.",pb.TaskpaneWidth,Telemetry.PrivacyRules.GetPrivacyCompliantId(pb.PrimaryMarketplace.SolutionId,
pb.PrimaryMarketplace.MarketplaceType,null===(Ia=null===pb||void 0===pb?void 0:pb.AssetMarketplace)||void 0===Ia?void 0:Ia.SolutionId,null,null,pb.PrimaryMarketplace.MarketplaceRef));if(Ia=D.Zdd[pb.PrimaryMarketplace.SolutionId])Ia.XBc&&(pb.TaskpaneTitle=Ia.XBc),Ia.VBc&&(pb.TaskpaneIconId=Ia.VBc),Ia.mYd&&(pb.TaskpaneButtonTooltip=Ia.mYd),0<Ia.Wr&&(pb.TaskpaneWidth=Ia.Wr);fa&&(pb.FocusOnIframeWhenLoaded=fa.focusOnIframeWhenLoaded,fa.width&&(pb.TaskpaneWidth=fa.width),pb.TaskpaneIconCssClass=fa.Xj,
pb.TaskpaneHeaderCssClass=fa.Oba,pb.TaskpaneTitleCssClass=fa.JOb,pb.IsFirstPartyOptOutAppContextOptmization=fa.isFirstPartyOptOutAppContextOptmization);D.reb[pb.PrimaryMarketplace.SolutionId]&&(pb.OsfPropertyBag=D.Bzd(pb.OsfPropertyBag,pb.PrimaryMarketplace.SolutionId));mj.a(pb)||(pb.WebExtensionOsfControlType=1);pb&&(D.Le.kpe(N.SolutionId),D.Le.b2a(pb))}else df.ULS.sendTraceTag(593285650,220,10,"AgaveCommandHandler.PostInsertAgaveTaskpaneSuccess: failed to return valid response.")};D.OEh=function(N){N&&
(D.Xcd.Vmf(N),D.KAe())};D.VLf=function(N){N=N.toDataURL("image/jpeg");var fa=D.Le.nba(pa.ibf+"."+pa.N8e);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(fa,"onScreenshot",{screenshot:N},function(){})};D.d8h=function(N,fa,Ia,pb,Wb){if(2!==Ia)return 32;if(Ni.a.Qh(Wb)||Wb[uj.a.XEe]!==Ak.a.action)return 8;fa=Wb[uj.a.aAa];return fa?(N=(N=D.GZh(Wb))?D.Le.nba(N):null)?(Wb=D.Le.k8g(Wb[uj.a.rIa],fa.wi[qe.YVc]),Df.EwaSettings.isChangeGateEnabled("OfficeVSO:5295210_SdxTaskpaneTitleOverrideNew")&&(Ia=
D.Le.j_(N),Ia.TaskpaneTitle!==fa.wi[qe.ql]&&(Ia.TaskpaneTitle=fa.wi[qe.ql],Ia.TaskpaneIconCssClass=fa.wi.IconCssClass,Ia.TaskpaneIconUrl=fa.wi.TaskPaneIconUrl,Ia.TaskpaneIconId=fa.wi.TaskPaneIconId,Df.EwaSettings.isChangeGateEnabled("OfficeVSO:5793296_SDXIframeTitleOverride")?(fa=D.Le.Ni,fa.changeIframeTitle(N,Ia.TaskpaneTitle),Ia=fa.getOsfControl(N),fa.raiseOsfControlStatusChange(Ia)):(fa=D.Le.Ni.getOsfControl(N),D.Le.Ni.raiseOsfControlStatusChange(fa)))),OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(N,
Wb,D.dLb),32):8:8};D.dLb=function(N,fa){D.Le.yHh(N,fa)};D.$=G;D.viewBlockContainerHelpers=Wa;D.Le=ja;D.Xcd=vb;D.Ki=f;D.Ki.ic(xc.a.F7f,Bi.a.frame,D.N9h);D.Ki.ic(xc.a.NXf,Bi.a.frame,D.y9h);D.Ki.ic(xc.a.kVe,Bi.a.frame,D.d8h);return D}function Ja(){var G=tj.call(this)||this;G.HWa="calc(100% - 46px)";G.RSb="15px";G.IWa="0";G.Jrg="WACDialogPanel";G.dEa=695;G.Krg=462;G.zjb="80%";G.Apg=350;G.K5d="100%";G.lc=5;G.Ve="AppsForOfficeInsertionDialog";G.pKc=!!ig.AFrameworkApplication.ha&&ig.AFrameworkApplication.ha.ra("OfficeAddinEnableInsertDialogAccessibilityFix");
return G}function Da(){var G=ib.call(this)||this;G.isTable=!1;G.isPivotTable=!1;G.hasTableHeaders=!1;G.tableName=null;G.userSelectedPivotTable=!1;return G}function ib(){this.addressWithSheet=this.address=this.sheetName=this.sheetId=null;this.columnIndex=this.columnCount=this.rowIndex=this.rowCount=0;this.isSheetEmpty=!1;this.selectionType=null}function Rb(){this.mYd=this.XBc=null;this.Wr=0;this.VBc=null}function wc(){var G=this;this.Le=null;this.Mbb=function(ja,Wa,vb,f,D){if(2===vb){ja=D?D:{};Wa=
ja.callback;if(!Wa)return 16;G.Le.Jda(Wa,ja.refresh?ja.refresh:!1)}return 32};this.gdj=function(ja,Wa,vb,f,D){2===vb&&(ja=D?D.callback:null)&&G.Le.sIg(ja);return 32}}function Cb(G,ja){this.d$=ja}function lb(G){return xh.call(this,G)||this}function yb(G){var ja=Fi.call(this)||this;ja.$=G;ja.isFirstLaunch=!1;return ja}function pc(G){df.ULS.sendTraceTag(41521353,1313,50,"SmartLookupManager - Initialize");this.psf=ig.AFrameworkApplication.ha.ra("IsTellMeUpSellEnterpriseEnabled");this.TBi=ig.AFrameworkApplication.ha.Wa("SmartLookupApprovedOriginPattern");
this.Q9a=ig.AFrameworkApplication.ha.Wa("SmartLookupShredderServiceEndpoint");this.xCi=bl.a.HN(ig.AFrameworkApplication.ha.Wa("AppCatalogUrl")||"");this.P9a=new ic;this.P9a.EnableAllTabV2=!0;this.P9a.EnableIntentService=!0;this.P9a.EnableInDocumentSearch=ig.AFrameworkApplication.ha.ra("SmartLookupEnableInDocumentSearch");this.P9a.EnableLocalSearch=ig.AFrameworkApplication.ha.ra("SmartLookupEnableLocalSearch");this.P9a.IntentServiceEndpoint=Ta.c2h();this.sCi=new rb(G,this.Q9a)}function Ta(){}function rb(G,
ja,Wa){this.qQj=9E5;this.tQj=3E5;this.pyd=null;this.Jrf="";this.lyd=0;this.XJe=Date.now;this.Yya=G;this.Q9a=ja;(void 0===Wa||Wa)&&this.hgd()}function ic(){}function Va(){}function jb(){}function rc(){}function Cc(){}function Hc(G,ja,Wa,vb,f,D){this.$=G;this.agaveCommandManager=D}function Nb(G){var ja=Oi.call(this)||this;ja.ddaFacade=null;ja.LQf=null;ja.$=G;G.da.Ha(106,ja);ja.Xb();return ja}function nc(){}function Ha(){}function tb(G){this.oGa=G}function Ub(G,ja,Wa){this.iframe=G;this.onSuccess=ja;
this.onError=Wa;$addHandler(window,"message",Object(lh.a)(this,this.z$e,"handleResponse"))}function gc(G,ja){return Lf.a.Owd(42,function(){return window.OfficeExtension&&window.OfficeExtension.WacRuntime},ig.AFrameworkApplication.ha.Cd("MaxRetriesForLoadingScript",0),G,ja)}function Eb(G){var ja=nj.call(this)||this;ja.$=G;ja.Xb();return ja}function Tb(G,ja){var Wa=this;this.pRa=this.qRa=null;this.Zdg=function(vb,f){var D=null,N=null,fa=null;f?(Object(Kj.a)(489,f)?(D=f.bHa,fa=f.instanceId):Object(Kj.a)(440,
f)&&(D=f.get_element(),fa=f.instanceId),D)?(N=Object(Ii.a)(966,vb),N)?Wa.MQf(fa,D,N)||fa in Wa.pRa||(Wa.qRa[fa]=0,Wa.pRa[fa]=Ti.a.instance.RC(function(){10<=Wa.qRa[fa]||Wa.MQf(fa,D,N)?(delete Wa.qRa[fa],Wa.pRa[fa].dispose(),delete Wa.pRa[fa]):Wa.qRa[fa]+=1},500,ti.a.DMg,!0,!1)):df.ULS.sendTraceTag(537170624,0,10,"The AgaveOnSelectedReadoutEvent raised from a null object."):df.ULS.sendTraceTag(537170625,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."):df.ULS.sendTraceTag(537170626,
0,10,"Invalid parameter for ReadoutSelection")};this.ariaLiveNotifier=G;this.$=ja;this.b_c=!1;this.$.da.Ha(224,this)}function Wc(G){var ja=mi.call(this)||this;ja.$=G;ja.Xb();return ja}function T(G){var ja=Bh.call(this,G)||this;ja.handler=null;ja.BDg=function(){df.ULS.sendTraceTag(38410434,0,50,"AddinUICommandHandlerFactory.ActivateFeature, isEditMode [{0}] ShowCommandUI [{1}]",ja.$.isEditMode,!!(ja.$.Dd&16384));var Wa=new fj.a;ja.$.da.Ya(53,function(Wb){df.ULS.sendTraceTag(38410435,0,50,"AddinUICommandHandlerFactory.ActivateFeature success to get service IRibbonManager");
Wa.setResult(Wb)});var vb=Wa.task,f=new zc,D=Lk.a.getInstance(),N=new ae(ja.$,D),fa=cj.GetServiceTaskFactory.create(ja.$.da,203,ja.la,ja.ub),Ia=ja.gcj(f),pb=cj.GetServiceTaskFactory.Ua(ja.$.da,349,350,ja.ub);return Th.TaskExtensions.Ba(Th.TaskExtensions.we([vb,fa,Ia,pb],ja.la),function(){df.ULS.sendTraceTag(38942482,0,50,"AddinUICommandHandlerFactory.ActivateFeature, ContinueWith after realated task finished.");Th.TaskExtensions.Ba(cj.GetServiceTaskFactory.create(ja.$.da,106,ja.la,ja.ub),function(Wb){ja.handler=
new ua(ja.$,Wb.result,f,new Fc,D,N,Ji.a.instance.Nh("Common.IExternalUICommandDefinitionMapping"));df.ULS.sendTraceTag(38410436,0,50,"AddinUICommandHandlerFactory.ActivateFeature, OnCommandHandlersCreated");ja.Jd([ja.handler]);ja.$.da.Ha(198,ja.handler)},ja.la,3)},ja.la,3)};ja.cgh=function(){void 0!==ja.handler&&null!==ja.handler?(ja.$.Ka.ucb(ja.handler),ja.$.da.yV(198),ja.handler=null):df.ULS.sendTraceTag(42341715,0,50,"AddinUICommandHandlerFactory.DeactivateFeature: handler is not defined, it might have never been activated.");
ja.$.da.yV(204);sh.a(mg.a,21,ja.$.da,198)};return ja}function ua(G,ja,Wa,vb,f,D,N){var fa=this;N=void 0===N?null:N;this.disposed=!1;this.WLi=function(Ia,pb){if(pb)if(pb)if(Ia=pb.ki){pb=pb.Mo;var Wb=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap();if(Ia.solutionId in Wb)pb=Wb[Ia.solutionId];else if(pb=fa.HRh(pb),void 0===pb||null===pb){df.ULS.sendTraceTag(528098434,220,15,"addinCommandControlId is NullOrUndefined");return}Wb=new Qc.a(xc.a.q3,0,0,2,null);var Nc={};fa.executeCommand(0,
Wb,(Nc.SourceControlId=pb,Nc),null);Ia.isAutoLaunched=!0}else df.ULS.sendTraceTag(528098435,220,15,"insertionParam is null");else df.ULS.sendTraceTag(528098436,220,15,"agaveParams is null");else df.ULS.sendTraceTag(528098437,220,15,"No args for OnAutoLaunchAddin event")};this.oTi=function(Ia,pb){Ia=null;pb&&(Ia=pb);(null===Ia||void 0===Ia?0:Ia.Mo)&&fa.Lxj(Ia.Mo);fa.$.Cf();Df.EwaSettings.ma(88)&&Ia&&Ia.ki&&fa.jRg(Ia.ki)};this.$=G;df.ULS.shipAssertTag(537170659,0,!(void 0===ja||null===ja),"AddinUICommandHandler constructor error - ddaFacade param should not be null, stack: {0}",
gf.a.j4());this.Le=ja;this.JFe=Wa;this.x0b=vb;this.Tha=f;this.tpb=D;this.qo=new Ic.a;this.Sha=new Od;this.Kcd=N;fk.a.fzb=fk.a.gVe;this.D8c=new Kh.a;this.Q2a=new Kh.a}function ma(G){var ja=this;this.SGa=this.VGa=this.ki=this.Mo=null;this.hTf=0;this.nTi=function(){if(ja.ki&&ja.SGa){var Wa=new Qc.a(xc.a.q3,0,0,2,null),vb={};ja.addinUICommandHandler.executeCommand(0,Wa,(vb.SourceControlId=ja.SGa,vb),null);df.ULS.sendTraceTag(537170697,220,50,"Launch addin command has been triggered")}};this.JEj=function(Wa,
vb){Wa=null;if(vb)if(Wa=vb,ja.ki=Wa.ki,ja.Mo=Wa.Mo,ja.Mo&&ja.Mo.hX&&ja.Mo.hX.gs&&(ja.VGa=ja.Mo.hX.gs.pa(0)),ja.VGa&&ja.VGa.id)if(ja.VGa.isOfficeTab)if(vb=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap(),ja.ki.assetId in vb?ja.SGa=vb[ja.ki.assetId]:(df.ULS.sendTraceTag(537170695,220,15,"Failed to get button id from controlIdMap for add-in: {0}",Telemetry.PrivacyRules.GetAssetId(ja.ki.storeType,ja.ki.storeId,ja.ki.assetId)),ja.SGa=ja.WNh(ja.Mo)),ja.SGa)if(Xj.a.contains(ja.VGa.id,
Qi.a.yX,!0))appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(ya.a.nwb(ja.Mo),function(){ja.H8f(ja.wjd(ja.SGa))});else{if(vb=ja.$.Ka)vb.lse(ja.MHf),df.ULS.sendTraceTag(537170693,220,50,"ShowCalloutOnAddin registered a tab switched event")}else df.ULS.sendTraceTag(537170694,220,10,"Failed to get button id for addin"),vb={},vb=(vb.AppTeachingUICalloutAction="NoEnabledButtonFound",vb["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(ja.ki.storeType,ja.ki.storeId,ja.ki.assetId),vb.AppTeachingUICalloutGoal=
"NewAdminDeployment",vb["SDX.AppInstallOrigin"]="Organization",vb),Wh.a.sendTelemetryEvent(Object.assign(new ri.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:ej.a.gl(vb)}));else ja.J8f(ja.wjd(ja.VGa.id),0);else df.ULS.sendTraceTag(537170696,220,10,"ShowCalloutOnAddin finds that the ribbon extensibility has no tab id"),vb={},vb=(vb.AppTeachingUICalloutAction="NoTabFound",vb["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(ja.ki.storeType,ja.ki.storeId,ja.ki.assetId),vb.AppTeachingUICalloutGoal=
"NewAdminDeployment",vb["SDX.AppInstallOrigin"]="Organization",vb),Wh.a.sendTelemetryEvent(Object.assign(new ri.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:ej.a.gl(vb)}))};this.MHf=function(){if(Xj.a.contains(ja.VGa.id,appChrome.selectors.getSelectedTabId(),!0)){var Wa=ja.$.Ka;Wa&&Wa.dVf(ja.MHf);ja.H8f(ja.wjd(ja.SGa))}};this.$=G.$;this.addinUICommandHandler=G;this.qo=new Ic.a}function wa(G,ja){this.qFa=G;this.Mfa=new Zc;this.Wfa=new Uc(ja)}function Ca(G,ja,Wa,vb,f,D){G=Sa.call(this,
G,ja)||this;G.v9=null;G.Zfa=null;G.bga=null;G.Wfa=Wa;G.Etg=vb;G.DHc=f;G.sqa=D;return G}function db(G){this.Eje=null;if(Mi.c(G))throw df.ULS.sendTraceTag(9041813,220,10,"ScalingDefinition type should not be null or undefined."),Error.create("ScalingDefinition type should not be null or undefined");this.szg=G}function Sa(G,ja){this.Jle=new Kh.a;this.vx=this.Zv=null;this.Rlb=G;this.Mfa=ja}function hb(G){this.Fje=this.I$d=this.Fle=null;this.isOfficeTab=!1;this.q9e=this.h_f=null;this._id=G;this.nUa[X.a.id]=
this._id}function Xb(G){this.z7d=this.H$d=this.Mnb=null;if(Mi.c(G))throw df.ULS.sendTraceTag(9041811,220,10,"GroupDefinition id should not be null or undefined."),Error.create("GroupDefinition id should not be null or undefined");this._id=G;this.Vwa[X.a.id]=this._id}function xb(G,ja,Wa,vb,f,D){this.QRb=new Kh.a;this.v9=this.vx=this.Zv=null;this.Rlb=G;this.Mfa=ja;this.Wfa=Wa;this.it=vb;this.sqa=f;this.C9d=D}function Sb(){this.groups=this.attributes=this.title=this.id=null;this.visible=this.isOfficeTab=
!1;this.insertAfter=this.insertBefore=this.tabType=null;this.autoFocus=!1}function qb(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.attributes=null}function mb(){this.controls=this.title=this.mlrId=this.id=null;this.groupType=0;this.attributes=null}function ac(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.controlType=0;this.attributes=this.menuItems=null}function Uc(G){this.QDa=G}function Zc(){}function Kc(G,ja){this.Mnb=new va(G,ja)}function va(G,ja){this.vBg=
G;this.$qg=ja}function fb(G){this.qFa=G}function Pb(G,ja,Wa){this.DJ=this.QWa=null;this.Rlb=G;this.Wfa=ja;this.Mfa=Wa;this.vwg=new Kh.a}function sc(G){this.u9=null;if(Mi.c(G))throw df.ULS.sendTraceTag(9175314,220,10,"OfficeMenuDefinition id should not be null or undefined."),Error.create("OfficeMenuDefinition id should not be null or undefined");this._id=G}function hd(G){this.PPc=null;if(Mi.c(G))throw df.ULS.sendTraceTag(9175313,220,10,"MenuItemDefinition id should not be null or undefined."),Error.create("MenuItemDefinition id should not be null or undefined");
this._id=G;this.vS[X.a.id]=this._id}function Ob(G,ja){this.Jga=this.y7d=null;if(Mi.c(G)||Mi.c(ja))throw df.ULS.sendTraceTag(9175312,220,10,"ControlDefinition id or type should not be null or undefined."),Error.create("ControlDefinition id or type should not be null or undefined");this.A7d=ja;this._id=G;this.nB[X.a.id]=this._id}function Ac(G,ja,Wa,vb,f,D,N,fa){fa=void 0===fa?null:fa;this.$a=new Mk.a;this.fWa=G;this.x7d=ja;this.an=Wa;this.ZYb=vb;this.ksa=f;this.sog=D;this.sqa=N;this.fge=fa;this.OEa=
ig.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoLaunchAddinEnabled",!1);this.KXa=ig.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoLaunchAddinTelemetryEnabled",!1);this.Oug=ig.AFrameworkApplication.ha.isChangeGateEnabled("OfficeVSO:5996085_EmailAlertAutolaunchOnWacEnabled")}function sb(G,ja,Wa,vb,f,D,N){this.dUa=new qk.a;this.Is=G;this.Ni=ja;this.qo=Wa;this.ribbonManager=vb;this.contextMenuManager=f;this.AG=D;this.Sha=N;this.uP=
ig.AFrameworkApplication.sa.gE}function ad(G,ja,Wa){this.P4d=this.eventBuilder=this.contextMenuBuilder=this.ribbonBuilder=this.actionBuilder=this.commandSurface=null;this.ribbonBuilder=G;this.eventBuilder=ja;this.contextMenuBuilder=Wa}function Hd(G){this.bsg=G.entitlement}function Ne(G,ja,Wa,vb,f){ja=void 0===ja?null:ja;Wa=void 0===Wa?null:Wa;vb=void 0===vb?null:vb;f=void 0===f?0:f;if(Mi.c(G)&&Mi.c(ja))throw df.ULS.sendTraceTag(9041814,220,10,"One of parameters out of tab and oneLineRibbonExtensibilityObject should not be null or undefined."),
Error.create("One of parameters out of tab and oneLineRibbonExtensibilityObject should not be null or undefined.");this.dZ=G;this.hxg=ja;this.DAg=Wa;this.emb=vb;this.dtg=f}function Ud(G){this.age=null;if(Mi.c(G))throw df.ULS.sendTraceTag(9175315,220,10,"The agave key should not be null or undefined."),Error.create("The agave key should not be null or undefined");this.Aog=G}function Ge(){}function Sc(){}function Pc(G){this.Yce=null;this.Rae=G}function Zd(G,ja,Wa){this.$a=G;this.N9=ja;this.eib=Wa}function ie(G,
ja,Wa,vb,f,D,N){this.Is=G;this.ki=ja;this.e1=Wa;this.sZe=vb;this.jKh=f;this.displayName=D;this.onf=N}function vd(){var G=Fk.call(this)||this;G.ki=null;G.Mo=null;return G}function Lb(){new id(gk.a.instance)}function id(G){this.bFa=G}function uc(){this.Ver=1}function ed(){}function Cd(G){this.oxg=G}function $d(G,ja,Wa){this.Oa=new Mk.a;this.context=new Bc;this.NZc=this.Rha=this.qea=this.TRb=null;this.contextActivationMgr=G;this.NLg=ja;this.y0b=Wa;this.appName=ig.AFrameworkApplication.ha.Wa("WebAppShortName")}
function La(G){var ja=dl.call(this)||this;ja.solutionId=G.solutionId;ja.assetId=G.assetId;ja.storeType=G.storeType;ja.storeId=G.storeId;ja.assetStoreId=G.assetStoreId;ja.targetType=G.targetType;ja.width=G.width;ja.height=G.height;ja.displayName=G.displayName;ja.version=G.version;return ja}function od(){this.addinId=null;this.targetType=0;this.assetId=null}function ne(G,ja,Wa,vb){this.mKb=ig.AFrameworkApplication.ha.Wa("RoamingServiceHandlerWebServiceBase");this.appName=G;this.pkb=ja;this.lkb=Wa;this.ymb=
void 0===vb?null:vb}function qd(G){var ja=cl.call(this)||this;ja.properties=G;return ja}function He(){this.YA=this.xq=null;this._count=0}function Ue(G,ja,Wa){this.next=Wa;this.previous=ja;this.data=G}function zf(G){this.ds=null;this.MA=G}function Hf(G){var ja=-1;switch(G.toLowerCase()){case "omex":ja=0;break;case "spcatalog":ja=1;break;case "spapp":ja=2;break;case "filesystem":ja=3;break;case "exchange":ja=4;break;case "registry":ja=6;break;case "inmemory":ja=7;break;case "uploadfiledevcatalog":ja=
8;break;case "hardcodedpreinstall":ja=9;break;case "excatalog":ja=10;break;case "wopicatalog":ja=16}return ja}function De(G){var ja=null;switch(G){case 0:ja="omex";break;case 1:ja="spcatalog";break;case 2:ja="spapp";break;case 3:ja="filesystem";break;case 4:ja="exchange";break;case 6:ja="registry";break;case 7:ja="inmemory";break;case 8:ja="uploadfiledevcatalog";break;case 9:ja="hardcodedpreinstall";break;case 10:ja="excatalog";break;case 16:ja="wopicatalog"}return ja}function Ae(G){var ja={};ja.solutionId=
G.solutionId;ja.version=G.version;ja.storeType=G.storeType;ja.storeId=G.storeId;ja.assetId=G.assetId;ja.assetStoreId=G.storeType;ja.targetType=G.targetType;ja.requireConsent=G.requireConsent||!1;ja.isAddinCommands=!0;ja.id=G.solutionId;ja.appVersion=G.version;ja.currentStoreType=G.storeType;return ja}function yd(){return bl.a.m5(window.location.href.toLowerCase(),"wdtpl")}function je(){var G=bl.a.m5(window.location.href.toLowerCase(),"wdomexsrctype");return!!G&&"4"===G}function we(){}function Bc(){this.Is=
this.O0=0;this.mYc=null;this.Zsc=this.HCc=0;this.Q1a=this.gka=this.E$=null}function Od(){this.n_a=null}function ae(G,ja){var Wa=Sk.call(this)||this;Wa.statusBarManager=null;Wa.agaveCommandManager=null;Wa.ICe=function(){Wa.AG&&Wa.AG.pCe()};Wa.t9e=function(){Wa.raiseEvent("LAC")};Wa.fd=function(vb,f){!vb.sc&&Ek.b(f)&&Wa.statusBarManager&&(Wa.statusBarManager.tG(Wa),Wa.statusBarManager=null)};Wa.AG=ja;Wa.$=G;Wa.bLj=G.Lb+"OfficeAddinLabel-Medium14";Wa.$.da.Ya(29,function(vb){Wa.statusBarManager=vb;vb.WJ(Wa)});
Wa.$.ea.ek(Wa.fd);Wa.AG.IHg(Wa.t9e);Wa.$.da.Ya(206,function(vb){Wa.agaveCommandManager=vb;vb.mJg(Wa.ICe)});return Wa}function Ad(){}function Ve(){this.Ii=null;this.visible=!1}function kf(G,ja){this.Ta=G;this.s6g=ja}function Fc(){this.v5d=this.IGc=null}function fd(G){this.Wie=new jd(G)}function jd(G){this.k$=G;this.AXb=this.k$.ribbonBuilder}function zd(){var G=Ck.call(this)||this;G.qpd=null;G.Vod=null;G.ribbon=null;return G}function zc(){this.Wpg=new Kh.a}function $e(){}function Xe(G){return Bk.call(this,
G)||this}function pe(G,ja,Wa){this.ztb=null;this.$=G;ja?(df.ULS.sendTraceTag(537163346,0,50,"DataFromPictureCommandHandler.constructor - AugmentationLoopManager and UploaderCreator instantiated."),this.ztb=new al.a(G,ja,Wa)):df.ULS.sendTraceTag(537163347,0,10,"DataFromPictureCommandHandler.constructor - Failed to instantiate AugmentationLoopManager.")}function Jf(G){var ja=kk.call(this)||this;ja.$=G;ja.Xb();return ja}function kc(G,ja){var Wa=Lc.call(this)||this;Wa.$=G;Wa.$ua=new DOMParser;Wa.cache=
new hk.a;Wa.indexedDB=ja;ja.xg()&&Wa.indexedDB.initialize("Scripts","OfficeScriptingCache");Wa.D5=!1;Wa.Tm=new Id([],function(vb){Lc.G9f(vb)});Wa.kg=new Id([],function(vb){Lc.zNb(vb)});Wa.Oo=new Id([],function(vb){Lc.zNb(vb)});Wa.Yk=new Id([],function(){});return Wa}function $c(G,ja,Wa,vb){var f=this;this.z8a=!1;this.I$a=function(){f.w6f()?(f.aMf(),gj.g(f.$).Da.iMd(f.I$a)):f.z8a&&gj.g(f.$).Da.iMd(f.I$a)};this.YNi=function(D,N){Object.getType(N)===String&&N.toString().endsWith(of.a.Hxb(f.$))&&(f.z8a=
!1)};this.$=G;this.vta=ja;this.qw=Wa;this.businessBarManager=vb;this.fAj()}function rd(){this.focusOnIframeWhenLoaded=!1;this.width=0;this.JOb=this.Oba=this.Xj=null;this.isFirstPartyOptOutAppContextOptmization=!1}function me(G,ja,Wa,vb,f,D,N,fa,Ia){var pb=this;this.bB=null;this.cache=new hk.a;this.S$d=this.lie=this.nie=this.kie=this.mie=this.jie=this.Yxa=!1;this.Jhe=this.wje=this.qge=this.The=null;this.aHa={};this.$=G;this.vSc=Wa;this.indexedDB=vb;this.sqb=f;this.qw=D;this.vta=N;this.Ne=fa;this.CQ=
of.a.$q?Ia:new he(G,this);this.nRg=new le(this,G);this.pug=ih.a.Ra.Ob;this.W$f="";this.D5=!1;this.Lzj(new Id([],function(Wb){Lc.G9f(Wb)}));this.Kzj(new Id([],function(Wb){Lc.zNb(Wb)}));this.Ozj(new Id([],function(Wb){Lc.zNb(Wb)}));this.Mzj(new Id([],function(){}));vb.xg()&&(this.Yxa=!0,this.indexedDB.initialize("Scripts","OfficeScriptingCache"));G=!0;if(hg.a.jye){this.cache.xg()&&(ja=this.sgd(of.a.gcc(this.$)),ja.isSuccess&&(G=si.getElapsedSeconds(ja.timeStamp,ih.a.Ra.Ob),this.qw.zy=new xf(!0,!0),
this.bB=new xf(ja.value,!0),G=this.bB.value?604800<G:86400<G,this.Fyb=this.RMb(!0)));this.aOh();if("undefined"!==typeof makerstorage&&this.kmf)if(this.W$f=za(this.$),cc(this.$))Mb(this.$,"localstorageToken"),this.qw.zy=new xf(!0,!0),this.bB=new xf(!0,!0),this.Fyb=this.RMb(!0);else if((ja=of.a.a4e())&&makerstorage.setStorageEnvironmentOverride(ja),G)try{this.$.heb("automateTab",!0),this.Fyb=this.qw.ZBe().then(function(){return pb.vta.sdc()}).then(function(Wb){return pb.p$h(Wb)}).then(function(){return pb.RMb(!1)}).catch(function(){return pb.RMb(!1)})}catch(Wb){df.ULS.sendTraceTag(537170314,
0,15,"AutomateCommandManager: Something went wrong while trying to check the tab state.  Exception: {0}",Wb.message),this.Fyb=Promise.resolve(!1),this.$.heb("automateTab",!1)}Df.EwaSettings.isChangeGateEnabled("OfficeVSO:5925531_useHasShownAutomateTabPromise")&&this.Fyb?this.Fyb.then(function(Wb){return pb.sNd(Wb)}):this.sNd(!1)}else df.ULS.sendTraceTag(537170315,0,15,"IsOfficeScriptingEnabled: Turning off office scripting since fetch api is not supported by current browser."),this.sNd(!1)}function te(G,
ja,Wa,vb,f,D){this.actionName=G;this.shapeId=ja;this.scriptLink=Wa;this.clickId=vb;this.tca=f;this.buttonText=D}function ge(G,ja,Wa,vb){this.Gnd=G;this.VDh=ja;this.aAa=Wa;this.rIa=vb}function pd(G){return Qh.a.Md(G)?hf.a.eSe:hf.a.dSe}function jc(G){return Qh.a.Md(G)?G.isChromeRtl?hf.a.Vwh:hf.a.Uwh:hf.a.G3a}function jf(G){G=G.na.ta.Ma(1);G.request={HttpMethod:"Get",PathAndQuery:"customXmlParts/byNamespace(namespaceUri=@v)/onlyItem/xml?@v='http://schemas.microsoft.com/office/extensibility/maker/v1.0'",
RequestHeaders:null,RequestBody:"",RequestFlags:256};return G}function dc(G,ja,Wa,vb,f){function D(){function Nc(kd,Xc,Ie){return $i.i(fa.ta,"ExecuteRichApiRequest",vb,ci.b(kd,ja),ci.a(Xc,Wa),Ie,null,0)}if(N.xIa()||0<fa.ta.X4||0<fa.Ok.X4)return!1;Ia&&N.dr(Ia);pb&&fa.Rr(pb);Wb&&fa.fA(Wb);Df.EwaSettings.uc()?N.ju(new ch.a(507,0,Nc,80)):N.ju(new bj.a(507,0,Nc,16));return!0}var N=G.userOperationManager,fa=G.na,Ia=null,pb=null,Wb=null;D()||(Ia=function(){D()},pb=function(){D()},Wb=function(){D()},N.Xu(Ia),
fa.Hq(pb),fa.mz(Wb));return f.task}function za(G){if(cc(G))return Df.EwaSettings.getBooleanFeatureGate(of.a.PDb,!1)?"makerservicelocal":"localstorage";G=of.a.a4e();return of.a.c3h(G)}function Mb(G,ja){cc(G)&&(Df.EwaSettings.getBooleanFeatureGate(of.a.PDb,!1)||makerstorage.useLocalStorage(!0),makerstorage.setStorageEnvironmentOverride("local"));makerstorage.setSessionId(G.ya.UserSessionId);makerstorage.setUserAccessInfo(new Ec(ja,null));makerstorage.setFlightValue(makerstorage.restApiVersionFlightKey,
"1")}function hc(G,ja){ja.WacTaskPaneInfra=Qh.a.Md(G);ja.TaskpanelessRFB=Df.EwaSettings.getBooleanFeatureGate(of.a.Nbg,!1);ja.OfficeScriptsAutomateTask=of.a.dCd}function cc(G){return"TestHost"===G.ya.DocumentHostInfo.HostTier}function Ec(G,ja){this.currentUserMlapiToken=this.currentUserToken=null;this.currentUserToken=G;this.currentUserMlapiToken=ja}function Lc(){this.Yk=null;this.D5=this.G7=this.Kt=this.E7=this.IAa=this.acb=this.bKd=this.Nda=this.cxa=!1;this.Oo=this.kg=this.Tm=null}function he(G,
ja){this.Ms=null;this.$=G;this.automateCommandManager=ja;return this}function qe(){}function Af(){this.zy=null;return this}function xf(G,ja,Wa,vb,f){this.value=G;this.isSuccess=ja;this.timeStamp=void 0===Wa?null:Wa;this.errorCode=void 0===vb?"":vb;this.errorMessage=void 0===f?"":f}function fc(){this.zy=null}function Gc(G,ja){this.Ms=null;this.$=G;this.Ne=ja;return this}function xd(G){this.Aaa=mh.b(G)||{};this.shareId=this.shareId||null}function Id(G,ja){this.scripts=G;this.F9f=ja}function le(G,ja){this.automateCommandManager=
G;this.$=ja}function Wd(){this.Ms=null}function Je(G,ja,Wa){var vb,f;this.$=G;this.oAuthManager=ja;this.qw=Wa;this.oqb=new lf;Df.EwaSettings.isChangeGateEnabled("OfficeVSO:6195588_fixGetValueOrDefaultDullscriptBug")?this.g_c=null!==(f=null===(vb=this.oAuthManager)||void 0===vb?void 0:vb.Ixa())&&void 0!==f?f:!1:this.g_c=this.oAuthManager&&null==this.oAuthManager.Ixa()?!1:this.oAuthManager.Ixa()}function lf(){this.token=null;this.timeStamp=0}function vf(G){return Uj.call(this,G)||this}function se(G,
ja){this.automateCommandManager=G;this.$=ja}function wf(G){var ja=Lj.call(this)||this;ja.$=G;ja.Xb();return ja}function Uf(G){this.Hb=null;this.$=G}function Wf(){return Ld.call(this)||this}function Tf(){return Ld.call(this)||this}function ug(){return Ld.call(this)||this}function Le(){return Ld.call(this)||this}function Qd(){return Ld.call(this)||this}function Of(){return Ld.call(this)||this}function Ee(){return Ld.call(this)||this}function Eg(){return Ld.call(this)||this}function lg(){return Ld.call(this)||
this}function Ef(){return Ld.call(this)||this}function eg(){return Ld.call(this)||this}function Na(){return Ld.call(this)||this}function Ib(){return Ld.call(this)||this}function vc(){return Ld.call(this)||this}function Yc(){return Ld.call(this)||this}function Md(){return Ld.call(this)||this}function Ed(){return Ld.call(this)||this}function ke(){return Ld.call(this)||this}function mc(){return Ld.call(this)||this}function Rc(){return Ld.call(this)||this}function nd(){return Ld.call(this)||this}function Td(){return Ld.call(this)||
this}function Fe(){return Ld.call(this)||this}function fe(){return Ld.call(this)||this}function ef(){return Ld.call(this)||this}function If(){return Ld.call(this)||this}function Ke(){return Ld.call(this)||this}function ng(){return Ld.call(this)||this}function rf(){return Ld.call(this)||this}function dg(){return Ld.call(this)||this}function qf(){return Ld.call(this)||this}function $g(){return Ld.call(this)||this}function nf(){return Ld.call(this)||this}function Qe(){return Ld.call(this)||this}function fh(){return Ld.call(this)||
this}function Rg(){return Ld.call(this)||this}function ah(){return Ld.call(this)||this}function pg(){return Ld.call(this)||this}function Ga(){return Ld.call(this)||this}function Hb(){return Ld.call(this)||this}function Dc(){return Ld.call(this)||this}function Bd(){return Ld.call(this)||this}function Fd(){return Ld.call(this)||this}function Be(){return Ld.call(this)||this}function Me(){return Ld.call(this)||this}function sf(){return Ld.call(this)||this}function Qa(){return Ld.call(this)||this}function cb(){return Ld.call(this)||
this}function bc(){return Ld.call(this)||this}function yc(){return Ld.call(this)||this}function bd(){return Ld.call(this)||this}function Kd(){return Ld.call(this)||this}function de(){return Ld.call(this)||this}function Re(){return Ld.call(this)||this}function ce(){return Ld.call(this)||this}function Jb(){return Ld.call(this)||this}function Mc(){return Ld.call(this)||this}function ld(){return mf.call(this,195,16)||this}function fg(){return mf.call(this,194,8)||this}function Se(){return Ld.call(this)||
this}function tf(){return mf.call(this,198,2)||this}function af(){return mf.call(this,197,1)||this}function Pf(){return mf.call(this,196,32)||this}function Sd(){return Ld.call(this)||this}function Mf(){return mf.call(this,193,4)||this}function mf(G,ja){var Wa=Ld.call(this)||this;Wa.mga=G;Wa.J1d=ja;return Wa}function ud(){return Ld.call(this)||this}function Vf(){return Ld.call(this)||this}function Ih(){return Ld.call(this)||this}function Cf(){return Ld.call(this)||this}function ye(){return Ld.call(this)||
this}function be(){return Ld.call(this)||this}function Pg(){return Nd.call(this,11,16)||this}function We(){return Nd.call(this,10,128)||this}function Zh(){return Ld.call(this)||this}function hh(){return Ld.call(this)||this}function rg(){return Ld.call(this)||this}function th(){return Ld.call(this)||this}function Oh(){return Ld.call(this)||this}function Xg(){return Ld.call(this)||this}function Sg(){return Ld.call(this)||this}function gg(){return Ld.call(this)||this}function di(){return Ld.call(this)||
this}function Jg(){return Nd.call(this,9,2)||this}function Mh(){return Nd.call(this,8,1)||this}function $h(){return Nd.call(this,7,8)||this}function zh(){return Nd.call(this,6,32)||this}function Eh(){return Ld.call(this)||this}function Xh(){return Ld.call(this)||this}function Fh(){return Ld.call(this)||this}function Kg(){return Ld.call(this)||this}function Sh(){return Ld.call(this)||this}function Nh(){return Ld.call(this)||this}function Gg(){return Ld.call(this)||this}function vh(){return Ld.call(this)||
this}function Hi(){return Ld.call(this)||this}function Tg(){return Ld.call(this)||this}function ph(){return Ld.call(this)||this}function Ag(){return Ld.call(this)||this}function oh(){return Ld.call(this)||this}function Zg(){return Ld.call(this)||this}function Dg(){return Nd.call(this,4,64)||this}function li(){return Ld.call(this)||this}function zg(){return Ld.call(this)||this}function Ah(){return Ld.call(this)||this}function Qg(){return Ld.call(this)||this}function Bf(){return Ld.call(this)||this}
function Gi(){return Ld.call(this)||this}function Uh(){return Ld.call(this)||this}function Ka(){}function sa(){return Ld.call(this)||this}function wb(){return Nd.call(this,3,4)||this}function Nd(G,ja){var Wa=Ld.call(this)||this;Wa.mga=G;Wa.J1d=ja;return Wa}function ee(){return Ld.call(this)||this}function yf(){return Ld.call(this)||this}function sg(){return Ld.call(this)||this}function bg(){return Ld.call(this)||this}function Yf(){return M.call(this,185,18)||this}function xg(){return Ld.call(this)||
this}function oe(){return M.call(this,181,14)||this}function Gh(){return M.call(this,169,2)||this}function rh(){return M.call(this,168,1)||this}function Ph(){return Ld.call(this)||this}function Di(){return M.call(this,182,15)||this}function Fg(){return Ld.call(this)||this}function $f(){return Ld.call(this)||this}function Bg(){return M.call(this,180,13)||this}function uh(){return M.call(this,186,19)||this}function ei(){return M.call(this,175,8)||this}function cg(){return M.call(this,176,9)||this}function Gf(){return M.call(this,
187,20)||this}function Zf(){return M.call(this,174,7)||this}function eh(){return M.call(this,179,12)||this}function wh(){return M.call(this,178,11)||this}function Yg(){return M.call(this,177,10)||this}function k(){return Ld.call(this)||this}function Ab(){return M.call(this,170,3)||this}function oc(){return M.call(this,172,5)||this}function R(){return M.call(this,173,6)||this}function Ba(){return M.call(this,183,16)||this}function d(){return M.call(this,184,17)||this}function x(){return M.call(this,
171,4)||this}function M(G,ja){var Wa=Ld.call(this)||this;Wa.mga=G;Wa.opType=ja;return Wa}function V(){return Ld.call(this)||this}function ca(){return Ld.call(this)||this}function Oa(){return Ld.call(this)||this}function Fb(){return Ld.call(this)||this}function lc(){return Ld.call(this)||this}function Oc(){return Ld.call(this)||this}function wd(){return Ld.call(this)||this}function Rd(){return Ld.call(this)||this}function Oe(){return Ld.call(this)||this}function la(){return Ld.call(this)||this}function $a(){return Ld.call(this)||
this}function Yb(){return Ld.call(this)||this}function Jc(){return Ld.call(this)||this}function td(){return Ld.call(this)||this}function Tc(){return Ld.call(this)||this}function ve(){return Ld.call(this)||this}function Ye(){return Ld.call(this)||this}function Te(){return Ld.call(this)||this}function Qf(){return Ld.call(this)||this}function kg(){return Ld.call(this)||this}function yg(){return Ld.call(this)||this}function Lg(){return gd.call(this)||this}function Mg(){return Ld.call(this)||this}function ai(){return Ld.call(this)||
this}function Ug(){return Ld.call(this)||this}function nh(){return Ld.call(this)||this}function Og(){return Ld.call(this)||this}function Ei(){return Ld.call(this)||this}function Vh(){return Ld.call(this)||this}function Xi(){return Ld.call(this)||this}function yj(){return Ld.call(this)||this}function yi(){return ff.call(this,78,[-105,-106,-107,-108,-109,-110,-111,-112,-113,-114,-127,-116,-117,-118,-119,-120,-121,-122,-123,-125,-124,-126,-216,-217,-218,-219,-221,-222,-220,-129,-130,-131])||this}function Hg(){return ff.call(this,
79,[0,1,2,-102])||this}function ni(){return ff.call(this,75,[-101])||this}function jj(){return ff.call(this,81,[100,101,102,103,104,105,106])||this}function Y(){return Ld.call(this)||this}function Ra(){return ff.call(this,85,[328,329,330,331,332,333,334,335])||this}function Db(){return gd.call(this)||this}function ec(G,ja,Wa){this.response=this.request=this.eventId=this.source=null;G&&(this.source=G.source,this.eventId=G.eventId,this.request=ja,this.response=Wa)}function gd(){return Ld.call(this)||
this}function Jd(){return ff.call(this,83,[500,501,502])||this}function Xd(){return ff.call(this,76,[-100])||this}function xe(){return ff.call(this,82,[200,201,202,203,204,205,206,207,208,209,210])||this}function cf(){return ff.call(this,80,[-104,-103,300,301,302,303,304,305,306,307,308,309,310,311])||this}function pf(){return ff.call(this,84,[348,349,350,351,352,353,354,355,356,357,372,373,374,375])||this}function ff(G,ja){var Wa=Ld.call(this)||this;Wa.mga=G;Wa.C_j=ja;return Wa}function tg(){return Ld.call(this)||
this}function Ig(){return Ld.call(this)||this}function qg(){return Ld.call(this)||this}function pi(){return Ld.call(this)||this}function Ld(){this.JKc=this.KKc=this.PQc=this.sVc=null}function qi(G,ja,Wa){var vb=this;this.Oac=null;this.DCi=function(f,D){vb.x6f()&&vb.Sdd(D)};this.Ssf=ja;this.Rsf=Wa;this.$=G;this.$.pca&&this.$.dKg(this.DCi);G.da.Ha(297,this)}function W(){}function ta(){}function ob(){this.oib=null}function Kb(){this.tb=null}function qc(G){this._initialized=!1;this.Lab={};this.eBc={};
this.uP=ig.AFrameworkApplication.sa.gE;this.Fnd=G}function Bb(G,ja,Wa){this.expiration=this.authority=this.accessToken=null;this.accessToken=G;this.authority=ja;this.expiration=Wa}function sd(){this.authority=this.email=this.displayName=null;this.authority=this.email=this.displayName=""}function Vd(){this.authority=this.userId=this.upn=null;this.authorityType=0;this.tenantId=null;this.supportsAuthToken=this.isAnonymous=!1;this.authority=this.userId=this.upn="";this.authorityType=0;this.tenantId="";
this.isAnonymous=!0;this.supportsAuthToken=!1}function bf(){}function Xf(G,ja){this.requestCallback=this.requestParameters=null;this.requestParameters=G;this.requestCallback=ja}function vg(){}b.r(F);var kh=b(556),ki=b(1163),Yd=b(0),df=b(13),lh=b(82),Oj;(function(G){G[G.generalException=0]="generalException";G[G.invalidArgument=1]="invalidArgument";G[G.notAllowed=2]="notAllowed";G[G.apiNotAvailable=3]="apiNotAvailable";G[G.unresolvedPendingRequest=4]="unresolvedPendingRequest";G[G.timeout=5]="timeout";
G[G.adalTimeout=6]="adalTimeout";G[G.userNotSignedIn=7]="userNotSignedIn";G[G.userAborted=8]="userAborted";G[G.silentSignInFailed=9]="silentSignInFailed";G[G.invalidResourceUrl=10]="invalidResourceUrl";G[G.invalidGrant=11]="invalidGrant";G[G.connectionLost=12]="connectionLost";G[G.clientError=13]="clientError";G[G.serverError=14]="serverError"})(Oj||(Oj={}));Object(Yd.b)("ErrorCodes",Oj);vg.ZIf="OneDriveWOPI";Object(Yd.a)(vg,"HostApplicationType",null,[]);Object(Yd.a)(Xf,"OutstandingRequest",null,
[]);bf.FIi="AADSTS50058";bf.invalidResourceUrl="AADSTS50001";bf.AIi="AADSTS65001";bf.RIi="AADSTS70011";bf.userAborted="13002";bf.l4i="Popup Window is null";bf.k4i="Popup Window closed";bf.adalTimeout="Token renewal operation failed due to timeout";bf.uQj="tokenRevoked";Object(Yd.a)(bf,"WopiHostErrorType",null,[]);var ig=b(4),pj=b(942),qj=b(634),fi=b(40);Vd.OOh=function(G){switch(G){case 0:return"external";case 2:return"aad";case 1:return"msa";default:return"external"}};Object(Yd.a)(Vd,"WopiAuthContext",
null,[306]);Object(Yd.a)(sd,"WopiIdentityInfo",null,[366]);Object(Yd.a)(Bb,"WopiIdentityToken",null,[365]);var hg=b(23),Wh=b(153),vi=b(390),Si=b(166),Nf=b(76),ri=b(354);qc.prototype.s3a=function(G){this._initialized||(G.mo(Si.a.PLf),G.Vl(Si.a.PLf,Object(lh.a)(this,this.MVi,"onReceivedAccessToken")),this._initialized=!0)};qc.prototype.getAccessToken=function(G,ja,Wa){var vb=this;Wa=void 0===Wa?null:Wa;this.ZOa(G,ja);return new Promise(function(f,D){if(vb.$pd(ja))if(ja in vb.Lab)D("unresolvedPendingRequest");
else{var N=window.setTimeout(function(){var Ia={};df.ULS.sendTraceTag(37856032,344,10,fi.c((Ia.error="Request timeout.",Ia.callerId=ja,Ia)));D("timeout")},12E4);vb.Sfd(G,ja,Wa,function(Ia,pb){window.clearTimeout(N);Ia?f(Ia):(Ia={},df.ULS.sendTraceTag(37856033,369,15,fi.c((Ia.error=Oj[pb],Ia))),D(pb))})}else{var fa={};df.ULS.sendTraceTag(37856034,344,10,fi.c((fa.error="Caller is not allowed.",fa)));D("notAllowed")}})};qc.prototype.getPrimaryIdentityInfo=function(G){var ja=this;return new Promise(function(Wa,
vb){if(ja.$pd(G))ja.H_h(function(D,N){D?Wa(D):(D={},df.ULS.sendTraceTag(37856064,369,10,fi.c((D.error=N.toString(),D))),vb(N))});else{var f={};df.ULS.sendTraceTag(37856065,344,10,fi.c((f.error="Caller is not allowed.",f)));vb("notAllowed")}})};qc.prototype.getAuthContext=function(G){var ja=this;return new Promise(function(Wa,vb){var f=ja.getAuthContextSync(G);f?Wa(f):vb("notAllowed")})};qc.prototype.getAuthContextSync=function(G){if(this.$pd(G)){var ja=new Vd;ja.upn=ig.AFrameworkApplication.ha.Wa("UserPrincipalName");
ja.userId=ig.AFrameworkApplication.ha.Wa("LoggableUserId");ja.authority=ig.AFrameworkApplication.ha.Wa("HostAuthAuthority");ja.tenantId=ig.AFrameworkApplication.ha.Wa("TenantId");ja.isAnonymous=ig.AFrameworkApplication.ha.ra("IsAnonymousUser");ja.supportsAuthToken=this.Obi(G);G=ig.AFrameworkApplication.ha.Wa("HostAuthType");ja.authorityType="aad"===G.toLowerCase()?2:"msa"===G.toLowerCase()?1:0;return ja}ja={};df.ULS.sendTraceTag(40751647,344,10,fi.c((ja.error="Caller is not allowed.",ja)));return null};
qc.prototype.Obi=function(G){var ja=pj.a.gzb;return hg.a.Yla?ja&&pj.a.Sbg?Array.contains(pj.a.Sbg,G.toLowerCase()):!1:ja};qc.prototype.Sfd=function(G,ja,Wa,vb){var f=this,D=[];Array.add(D,Object.assign(new Nf.a,{name:"CallerId",string:ja}));Array.add(D,Object.assign(new Nf.a,{name:vi.a.uWd,string:G.correlationId}));Wh.a.sendTelemetryEvent(Object.assign(new ri.a,{name:"Office.Online.Extensibility.SSO.FirstPartyRequestTokenFromHost",dataFields:D}));D=qj.a.create().toString();var N="getAccessToken_"+
D,fa=this.uP.Hc("ComponentAttach",N);this.eBc[N]=fa;var Ia={};Ia[vi.a.vWd]=D;Ia[vi.a.MJj]=G.resource;Ia[vi.a.NJj]=G.scope;Ia[vi.a.W9f]=ig.AFrameworkApplication.ha.Wa("HostAuthType");Ia[vi.a.QJj]=ig.AFrameworkApplication.ha.Wa("UserPrincipalName");Ia[vi.a.OJj]=G.silentLogin;Ia[vi.a.JJj]=G.options;Ia[vi.a.uWd]=G.correlationId;Ia[vi.a.KJj]=ja;Wa&&(Ia[vi.a.addinName]=Wa.AddinName,Ia[vi.a.IJj]=Wa.AddinTrustId);this.Fnd.execute(function(pb){f.s3a(pb);pb.Nj(Si.a.getAuthToken,Ia)});this.Lab[D]=new Xf(G,vb)};
qc.prototype.H_h=function(G){var ja=ig.AFrameworkApplication.ha.Wa("UserName"),Wa=ig.AFrameworkApplication.ha.Wa("UserPrincipalName"),vb=ig.AFrameworkApplication.ha.Wa("LoggableUserIdSpace"),f=new sd;f.email=Wa;f.displayName=ja;switch(vb){case "OrgIdPuid":f.authority="AzureActiveDirectoryAccount";break;case "MsaCid":case "MsaPuid":f.authority="MicrosoftAccount";break;default:f.authority=vb}G(f,null)};qc.prototype.MVi=function(G){var ja=null;try{var Wa=G.Values[vi.a.vWd],vb=G.Values[vi.a.HJj],f=G.Values[vi.a.W9f],
D=G.Values[vi.a.PJj],N=null,fa=null,Ia=this.Lab[Wa];if("undefined"!==typeof Ia&&Ia){var pb=[];Array.add(pb,Object.assign(new Nf.a,{name:vi.a.uWd,string:Ia.requestParameters.correlationId}));Wh.a.sendTelemetryEvent(Object.assign(new ri.a,{name:"Office.Online.Extensibility.SSO.FirstPartyResponseTokenFromHost",dataFields:pb}));ja=Ia.requestCallback;delete this.Lab[Wa];"undefined"!==typeof vb&&vb&&vb.length?fa=new Bb(vb,f,D):N=Oj[this.uDi(G)];Wa="getAccessToken_"+Wa;Wa in this.eBc&&(this.eBc[Wa].stop(),
delete this.eBc[Wa]);ja(fa,N)}else N={},df.ULS.sendTraceTag(37856066,344,10,fi.c((N.error="No matching outstanding request for request ID.",N.requestId=Wa,N)))}catch(Wb){G=G.Values[vi.a.vWd],G in this.Lab&&delete this.Lab[G],this.cmc(),G={},df.ULS.sendTraceTag(37856067,344,10,fi.c((G.error=Wb.message,G.stack=Wb.stack,G))),ja&&ja(null,"generalException")}};qc.prototype.$pd=function(G){var ja=ig.AFrameworkApplication.s6h();G=G.toLowerCase();ja=Cl(ja);for(var Wa=ja.next();!Wa.done;Wa=ja.next())if(G===
Wa.value.toLowerCase())return!0;ja=pj.a.ZYc;for(var vb in ja)if(G===ja[vb].toLowerCase())return!0;return!1};qc.prototype.uDi=function(G){G=G.Values[vi.a.LJj];this.cmc();var ja={};df.ULS.sendTraceTag(39068821,344,15,fi.c((ja.error=G,ja)));return G?-1<G.indexOf(bf.FIi)?9:-1<G.indexOf(bf.l4i)||-1<G.indexOf(bf.k4i)?12:-1<G.indexOf(bf.invalidResourceUrl)?10:-1<G.indexOf(bf.userAborted)?8:-1<G.indexOf(bf.RIi)||-1<G.indexOf(bf.AIi)||G===bf.uQj?11:-1<G.indexOf(bf.adalTimeout)?6:0:13};qc.prototype.ZOa=function(G,
ja){G=this.wbj(G.resource);var Wa={};df.ULS.sendTraceTag(39921882,344,50,fi.c((Wa.callerId=ja,Wa.resource=G,Wa)))};qc.prototype.cmc=function(){var G={};df.ULS.sendTraceTag(39068822,344,50,fi.c((G.userAgent=window.navigator.userAgent,G)))};qc.prototype.wbj=function(G){return(G?G:"").replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")};Object(Yd.a)(qc,"WopiIdentityManager",null,[347]);var Tj=b(254);Kb.prototype.hi=function(G){this.tb=G;G.register(qc,"Common.App.WopiIdentity.WopiIdentityManager").as("Common.App.WopiIdentity.IWopiIdentity").Ic().Nc(function(){return new qc(G.qc("Postmessage.IHostPostmessenger"))})};
Kb.prototype.init=function(){ig.AFrameworkApplication.ha&&ig.AFrameworkApplication.ha.tv(Object(lh.a)(this,this.OB,"onFullAppSettingsReady"))};Kb.prototype.OB=function(){try{this.tb.resolve("Common.App.WopiIdentity.IWopiIdentity")}catch(G){df.ULS.sendTraceTag(571074327,383,10,"Failed to initialize WopiIdentityPackage with exception: "+G)}};Kb.prototype.dispose=function(){};Kb.main=function(){Tj.a.instance.nj(new Kb)};uk.Object.defineProperties(Kb.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.WopiIdentity"}}});
Object(Yd.a)(Kb,"WopiIdentityPackage",null,[4,5]);var Jh=b(10),Ui=b(224),Kh=b(199),Yi=b(646);ob.prototype.pki=function(G){return this.QRg.contains(G.operation)};ob.prototype.STj=function(G){for(var ja=[],Wa=Cl(G.payload.batchedOperations),vb=Wa.next();!vb.done;vb=Wa.next())ja.push(new Yi.a(G.operation,vb.value));return ja};uk.Object.defineProperties(ob.prototype,{QRg:{configurable:!0,enumerable:!0,get:function(){this.oib||(this.oib=new Kh.a,this.oib.add(12),this.oib.add(11));return this.oib}}});Object(Yd.a)(ob,
"MacroRecorderBatchedEventList",null,[]);var jh=b(54),bh=b(124),Wj=b(736);ta.prototype.equals=function(G,ja){return G===ja};ta.prototype.getHashCode=function(G){return G};ta.prototype.vka=function(G){return G};Object(Yd.a)(ta,"UserOperationNameComparer",null,[27,28]);W.q6h=function(){W.Rc||(W.Rc=new Wj.a(new ta),W.Rc.add(507),W.Rc.add(10),W.Rc.add(576),W.Rc.add(563),W.Rc.add(564),W.Rc.add(565),W.Rc.add(566),W.Rc.add(567),W.Rc.add(568),W.Rc.add(569),W.Rc.add(570),W.Rc.add(571),W.Rc.add(572),W.Rc.add(573),
W.Rc.add(574),W.Rc.add(575),W.Rc.add(501),W.Rc.add(520),W.Rc.add(1),W.Rc.add(1002),W.Rc.add(129),W.Rc.add(198),W.Rc.add(500),W.Rc.add(519),W.Rc.add(538),W.Rc.add(1E3),W.Rc.add(1003),W.Rc.add(144),W.Rc.add(502),W.Rc.add(505),W.Rc.add(179),W.Rc.add(205),W.Rc.add(134),W.Rc.add(230),W.Rc.add(103),W.Rc.add(110),W.Rc.add(112),W.Rc.add(113),W.Rc.add(124),W.Rc.add(133),W.Rc.add(154),W.Rc.add(162),W.Rc.add(168),W.Rc.add(172),W.Rc.add(201),W.Rc.add(222),W.Rc.add(227),W.Rc.add(513),W.Rc.add(534),W.Rc.add(539),
W.Rc.add(545),W.Rc.add(600),W.Rc.add(547),W.Rc.add(555),W.Rc.add(558),W.Rc.add(562),W.Rc.add(585),W.Rc.add(1001),W.Rc.add(1005),W.Rc.add(1008),W.Rc.add(1010),W.Rc.add(1011),W.Rc.add(1012),W.Rc.add(1018),W.Rc.add(252),W.Rc.add(253),W.Rc.add(258),W.Rc.add(101),W.Rc.add(102),W.Rc.add(108),W.Rc.add(118),W.Rc.add(257),W.Rc.add(119),W.Rc.add(120),W.Rc.add(123),W.Rc.add(126),W.Rc.add(127),W.Rc.add(130),W.Rc.add(140),W.Rc.add(159),W.Rc.add(160),W.Rc.add(165),W.Rc.add(166),W.Rc.add(167),W.Rc.add(169),W.Rc.add(189),
W.Rc.add(223),W.Rc.add(214),W.Rc.add(228),W.Rc.add(233),W.Rc.add(247),W.Rc.add(504),W.Rc.add(511),W.Rc.add(512),W.Rc.add(525),W.Rc.add(533),W.Rc.add(537),W.Rc.add(542),W.Rc.add(544),W.Rc.add(548),W.Rc.add(550),W.Rc.add(551),W.Rc.add(552),W.Rc.add(554),W.Rc.add(577),W.Rc.add(584),W.Rc.add(586),W.Rc.add(587),W.Rc.add(588),W.Rc.add(592),W.Rc.add(1009),W.Rc.add(1016),W.Rc.add(1017));return W.Rc};W.Rc=null;Object(Yd.a)(W,"MacroRecorderUnrecognizedEventList",null,[]);qi.prototype.init=function(G){this.$.pca&&
(G?this.Oac=G:df.ULS.sendTraceTag(537155424,0,10,"MacroRecorderEventHandler.Init failed because the function passed in is null."))};qi.prototype.Sdd=function(G){if(this.x6f())try{if(this.Rsf.pki(G))for(var ja=this.Rsf.STj(G),Wa=Cl(ja),vb=Wa.next();!vb.done;vb=Wa.next())this.QXe(vb.value);else this.QXe(G)}catch(f){G=String.format("MacroRecorderEventHandler.FireMacroRecorderEvent: Error: {0}, Exception: {1}",bh.a(G.operation),f.stack),df.ULS.sendTraceTag(537155423,0,10,G)}};qi.prototype.QXe=function(G){var ja=
this.Ssf.Z3e(G,!0);ja?(this.Oac(ja.eventId,jh.a.Kc(G.payload)),G=String.format("MacroRecorderEventHandler.FireMacroRecorderEvent: Matched: {0}",ja.eventId),df.ULS.sendTraceTag(537155422,0,50,G)):(ja=this.Ssf.Z3e(G,!1))?(G=String.format("MacroRecorderEventHandler.FireMacroRecorderEvent: Matched: {0}, but failed to match filters",ja.eventId),df.ULS.sendTraceTag(537155421,0,50,G)):W.q6h().contains(G.operation)||(this.Oac(0,jh.a.Kc(G.operation)),G=String.format("MacroRecorderEventHandler.FireMacroRecorderEvent: Unrecognized: {0}",
bh.a(G.operation)),df.ULS.sendTraceTag(537155420,0,50,G))};qi.prototype.x6f=function(){return this.$.Nla&&this.Oac&&this.$.lca?!0:!1};Object(Yd.a)(qi,"MacroRecorderEventHandler",null,[971]);var Df=b(1);Ld.prototype.wg=function(){};Ld.prototype.wxa=function(){};Ld.prototype.Bd=function(G){this.REc.add(G)};Ld.prototype.Zb=function(G){this.operations.contains(G)||this.operations.add(G)};Ld.prototype.Qob=function(){this.featureGates.add(694)};Ld.prototype.upe=function(G){this.kWe.add(G)};uk.Object.defineProperties(Ld.prototype,
{operations:{configurable:!0,enumerable:!0,get:function(){this.PQc||(this.PQc=new Kh.a,this.mc());return this.PQc}},REc:{configurable:!0,enumerable:!0,get:function(){this.sVc||(this.sVc=new Kh.a,this.wg());return this.sVc}},kWe:{configurable:!0,enumerable:!0,get:function(){this.JKc||(this.JKc=new Kh.a);return this.JKc}},featureGates:{configurable:!0,enumerable:!0,get:function(){this.KKc||(this.KKc=new Kh.a,this.wxa());return this.KKc}}});Object(Yd.a)(Ld,"MacroRecorderEventBase",null,[]);Am(pi,Ld);
pi.prototype.mc=function(){this.Zb(100)};uk.Object.defineProperties(pi.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 130}}});Object(Yd.a)(pi,"AccessibilityCheckRunEvent",Ld,[]);Am(qg,Ld);qg.prototype.mc=function(){this.Zb(241)};qg.prototype.wg=function(){this.Bd(function(G){return G.addToPrintArea})};uk.Object.defineProperties(qg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 160}}});Object(Yd.a)(qg,"AddedToPrintAreaEvent",Ld,[]);Am(Ig,Ld);Ig.prototype.mc=
function(){this.Zb(516)};uk.Object.defineProperties(Ig.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 65}}});Object(Yd.a)(Ig,"AutoFilterToggledEvent",Ld,[]);Am(tg,Ld);tg.prototype.mc=function(){this.Zb(502)};tg.prototype.wg=function(){this.Bd(function(G){return!(G.I5a().FirstColumn===G.I5a().LastColumn&&G.I5a().FirstRow===G.I5a().LastRow)})};uk.Object.defineProperties(tg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 118}}});Object(Yd.a)(tg,"AutoSumEvent",
Ld,[]);Am(ff,Ld);ff.prototype.mc=function(){this.Zb(529);this.Zb(594)};ff.prototype.wg=function(){var G=this;this.Bd(function(ja){return Array.contains(G.C_j,ja.$id())})};uk.Object.defineProperties(ff.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return this.mga}}});Object(Yd.a)(ff,"ChartPropertyAppliedEventBase",Ld,[]);Am(pf,ff);Object(Yd.a)(pf,"ChartAxisChangedEvent",ff,[]);Am(cf,ff);Object(Yd.a)(cf,"ChartAxisTitleChangedEvent",ff,[]);Am(xe,ff);Object(Yd.a)(xe,"ChartDataLabelsChangedEvent",
ff,[]);Am(Xd,ff);Object(Yd.a)(Xd,"ChartDataSelectedEvent",ff,[]);Am(Jd,ff);Object(Yd.a)(Jd,"ChartDataTableChangedEvent",ff,[]);var ek=b(614),Kj=b(437),Ii=b(81);Am(gd,Ld);Object(Yd.a)(gd,"RichApiRequestExecutedEventBase",Ld,[]);uk.Object.defineProperties(ec.prototype,{isValid:{configurable:!0,enumerable:!0,get:function(){return!(void 0===this.source||null===this.source)&&!(void 0===this.eventId||null===this.eventId)&&!0}}});Object(Yd.a)(ec,"MacroRecorderRichApiRequestExecutedPayload",null,[428]);Am(Db,
gd);Db.prototype.XF=function(G){Db.L7||(Db.L7=new Wj.a(ek.a.Uk()),Db.L7.add("907dd90f-a82f-4bbf-b4f2-fcd4868a5e14"),Db.L7.add("fa000000014"));return!!G&&Db.L7.contains(G.toLowerCase())};Db.prototype.mc=function(){this.Zb(507);this.Zb(10);this.Zb(576)};Db.prototype.wg=function(){var G=this;this.Bd(function(ja){return Object(Kj.a)(ec,ja)&&(ja=Object(Ii.a)(ec,ja),ja.isValid&&G.XF(ja.source))?(df.ULS.sendTraceTag(537155427,0,50,"[RichApiRecorder]: A ChartFormatRichApiRequestExecutedEvent is matched! eventId: {0}",
ja.eventId),!0):!1})};uk.Object.defineProperties(Db.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 117}}});Db.L7=null;Object(Yd.a)(Db,"ChartFormatRichApiRequestExecutedEvent",gd,[]);Am(Ra,ff);Object(Yd.a)(Ra,"ChartGridlinesChangedEvent",ff,[]);Am(Y,Ld);Y.prototype.mc=function(){this.Zb(528)};uk.Object.defineProperties(Y.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 66}}});Object(Yd.a)(Y,"ChartInsertedEvent",Ld,[]);Am(jj,ff);Object(Yd.a)(jj,"ChartLegendChangedEvent",
ff,[]);Am(ni,ff);Object(Yd.a)(ni,"ChartRowColumnSwitchedEvent",ff,[]);Am(Hg,ff);Object(Yd.a)(Hg,"ChartTitleChangedEvent",ff,[]);Am(yi,ff);Object(Yd.a)(yi,"ChartTypeChangedEvent",ff,[]);Am(yj,Ld);yj.prototype.mc=function(){this.Zb(521)};uk.Object.defineProperties(yj.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 131}}});Object(Yd.a)(yj,"ConnectorFloatingObjectResizedEvent",Ld,[]);Am(Xi,Ld);Xi.prototype.mc=function(){this.Zb(109)};uk.Object.defineProperties(Xi.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 129}}});Object(Yd.a)(Xi,"EntitySelectedEvent",Ld,[]);Am(Vh,Ld);Vh.prototype.mc=function(){this.Zb(149);this.Zb(147)};uk.Object.defineProperties(Vh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 49}}});Object(Yd.a)(Vh,"FindCellEvent",Ld,[]);Am(Ei,Ld);Ei.prototype.mc=function(){this.Zb(122)};uk.Object.defineProperties(Ei.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 96}}});Object(Yd.a)(Ei,"FloatingObjectAltTextAppliedEvent",
Ld,[]);Am(Og,Ld);Og.prototype.mc=function(){this.Zb(522)};uk.Object.defineProperties(Og.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 93}}});Object(Yd.a)(Og,"FloatingObjectDeletedEvent",Ld,[]);Am(nh,Ld);nh.prototype.mc=function(){this.Zb(524)};uk.Object.defineProperties(nh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 94}}});Object(Yd.a)(nh,"FloatingObjectMovedAndResizedEvent",Ld,[]);Am(Ug,Ld);Ug.prototype.mc=function(){this.Zb(523)};uk.Object.defineProperties(Ug.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 95}}});Object(Yd.a)(Ug,"FloatingObjectRotatedEvent",Ld,[]);Am(ai,Ld);ai.prototype.mc=function(){this.Zb(543)};uk.Object.defineProperties(ai.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 100}}});Object(Yd.a)(ai,"GroupDetailsShownOrHiddenEvent",Ld,[]);Am(Mg,Ld);Mg.prototype.mc=function(){this.Zb(125)};uk.Object.defineProperties(Mg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 154}}});Object(Yd.a)(Mg,
"HyperlinksRemovedFromRangeEvent",Ld,[]);Am(Lg,gd);Lg.prototype.XF=function(G){Lg.L7||(Lg.L7=new Wj.a(ek.a.Uk()),Lg.L7.add("f438b4e6-2b49-466f-9a91-b75f473eba96"),Lg.L7.add("fa000000005"));return!!G&&Lg.L7.contains(G.toLowerCase())};Lg.prototype.mc=function(){this.Zb(507);this.Zb(10);this.Zb(576)};Lg.prototype.wg=function(){var G=this;this.Bd(function(ja){return Object(Kj.a)(ec,ja)?(ja=Object(Ii.a)(ec,ja),ja.isValid&&G.XF(ja.source)):!1})};uk.Object.defineProperties(Lg.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 125}}});Lg.L7=null;Object(Yd.a)(Lg,"IdeasRichApiRequestExecutedEvent",gd,[]);Am(yg,Ld);yg.prototype.mc=function(){this.Zb(115)};uk.Object.defineProperties(yg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 136}}});Object(Yd.a)(yg,"LinkedEntityConvertedEvent",Ld,[]);Am(kg,Ld);kg.prototype.mc=function(){this.Zb(114)};uk.Object.defineProperties(kg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 148}}});Object(Yd.a)(kg,
"LinkedEntityDisambiguationPaneToggledEvent",Ld,[]);Am(Qf,Ld);Qf.prototype.mc=function(){this.Zb(119)};uk.Object.defineProperties(Qf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 127}}});Object(Yd.a)(Qf,"MovedToEdgeEvent",Ld,[]);Am(Te,Ld);Te.prototype.mc=function(){this.Zb(191)};Te.prototype.wxa=function(){this.Qob()};uk.Object.defineProperties(Te.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 135}}});Object(Yd.a)(Te,"NamedSheetViewCreatedEvent",
Ld,[]);Am(Ye,Ld);Ye.prototype.mc=function(){this.Zb(200)};Ye.prototype.wxa=function(){this.Qob()};uk.Object.defineProperties(Ye.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 166}}});Object(Yd.a)(Ye,"NamedSheetViewDeletedEvent",Ld,[]);Am(ve,Ld);ve.prototype.mc=function(){this.Zb(192)};ve.prototype.wxa=function(){this.Qob()};uk.Object.defineProperties(ve.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 133}}});Object(Yd.a)(ve,"NamedSheetViewExitedEvent",
Ld,[]);Am(Tc,Ld);Tc.prototype.mc=function(){this.Zb(199)};Tc.prototype.wxa=function(){this.Qob()};uk.Object.defineProperties(Tc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 162}}});Object(Yd.a)(Tc,"NamedSheetViewRenamedEvent",Ld,[]);Am(td,Ld);td.prototype.mc=function(){this.Zb(195)};td.prototype.wxa=function(){this.Qob()};uk.Object.defineProperties(td.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 167}}});Object(Yd.a)(td,"NamedSheetViewSwitchedEvent",
Ld,[]);Am(Jc,Ld);Jc.prototype.mc=function(){this.Zb(174)};uk.Object.defineProperties(Jc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 99}}});Object(Yd.a)(Jc,"OutlineLevelSetEvent",Ld,[]);Am(Yb,Ld);Yb.prototype.mc=function(){this.Zb(244)};uk.Object.defineProperties(Yb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 156}}});Object(Yd.a)(Yb,"PageBreakInsertedEvent",Ld,[]);Am($a,Ld);$a.prototype.mc=function(){this.Zb(245)};uk.Object.defineProperties($a.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 157}}});Object(Yd.a)($a,"PageBreakRemovedEvent",Ld,[]);Am(la,Ld);la.prototype.mc=function(){this.Zb(246)};uk.Object.defineProperties(la.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 158}}});Object(Yd.a)(la,"PageBreaksAllResetEvent",Ld,[]);Am(Oe,Ld);Oe.prototype.mc=function(){this.Zb(503)};Oe.prototype.wg=function(){this.Bd(function(G){return!!G.pasteParameters.ClientEstimationFloatingObjectId&&2===G.pasteParameters.CopyPasteTargetType&&
!G.isFromCurrentSession})};uk.Object.defineProperties(Oe.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 112}}});Object(Yd.a)(Oe,"PasteArtOtherWorkbookEvent",Ld,[]);Am(Rd,Ld);Rd.prototype.mc=function(){this.Zb(503)};Rd.prototype.wg=function(){this.Bd(function(G){return!!G.pasteParameters.ClientEstimationFloatingObjectId&&2===G.pasteParameters.CopyPasteTargetType&&G.isFromCurrentSession})};uk.Object.defineProperties(Rd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 52}}});
Object(Yd.a)(Rd,"PasteArtSameWorkbookEvent",Ld,[]);Am(wd,Ld);wd.prototype.mc=function(){this.Zb(204)};uk.Object.defineProperties(wd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 110}}});Object(Yd.a)(wd,"PasteHtmlEvent",Ld,[]);Am(Oc,Ld);Oc.prototype.mc=function(){this.Zb(506)};uk.Object.defineProperties(Oc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 35}}});Object(Yd.a)(Oc,"PasteRangeEvent",Ld,[]);Am(lc,Ld);lc.prototype.mc=function(){this.Zb(503)};
lc.prototype.wg=function(){this.Bd(function(G){return 1===G.pasteParameters.CopyPasteTargetType})};uk.Object.defineProperties(lc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 111}}});Object(Yd.a)(lc,"PasteShadowWorkbookRangeEvent",Ld,[]);Am(Fb,Ld);Fb.prototype.mc=function(){this.Zb(180)};uk.Object.defineProperties(Fb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 42}}});Object(Yd.a)(Fb,"PasteStringEvent",Ld,[]);Am(Oa,Ld);Oa.prototype.mc=function(){this.Zb(220)};
uk.Object.defineProperties(Oa.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 134}}});Object(Yd.a)(Oa,"PendingMergeEvent",Ld,[]);Am(ca,Ld);ca.prototype.mc=function(){this.Zb(510)};uk.Object.defineProperties(ca.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 122}}});Object(Yd.a)(ca,"PictureInsertedEvent",Ld,[]);Am(V,Ld);V.prototype.mc=function(){this.Zb(161)};uk.Object.defineProperties(V.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 153}}});
Object(Yd.a)(V,"PivotDrillToggledEvent",Ld,[]);Am(M,Ld);M.prototype.mc=function(){this.Zb(225)};M.prototype.wg=function(){var G=this;this.Bd(function(ja){return ja.opType===G.opType})};uk.Object.defineProperties(M.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return this.mga}}});Object(Yd.a)(M,"PivotTableSettingsChangedEventBase",Ld,[]);Am(x,M);Object(Yd.a)(x,"PivotTableAllItemLabelsRepeatedEvent",M,[]);Am(d,M);Object(Yd.a)(d,"PivotTableAltTextDescriptionChangedEvent",M,[]);Am(Ba,
M);Object(Yd.a)(Ba,"PivotTableAltTextTitleChangedEvent",M,[]);Am(R,M);Object(Yd.a)(R,"PivotTableAutoFitColumnWidthsOnRefreshToggledEvent",M,[]);Am(oc,M);Object(Yd.a)(oc,"PivotTableBlankLineAfterEachItemToggledEvent",M,[]);Am(Ab,M);Object(Yd.a)(Ab,"PivotTableColumnGrandTotalShownEvent",M,[]);Am(k,Ld);k.prototype.mc=function(){this.Zb(132)};uk.Object.defineProperties(k.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 98}}});Object(Yd.a)(k,"PivotTableCreatedEvent",Ld,[]);Am(Yg,
M);Object(Yd.a)(Yg,"PivotTableDisplayErrorStringToggledEvent",M,[]);Am(wh,M);Object(Yd.a)(wh,"PivotTableDisplayNullStringToggledEvent",M,[]);Am(eh,M);Object(Yd.a)(eh,"PivotTableErrorStringChangedEvent",M,[]);Am(Zf,M);Object(Yd.a)(Zf,"PivotTableExpandCollapseButtonsShownEvent",M,[]);Am(Gf,M);Object(Yd.a)(Gf,"PivotTableIndentChangedEvent",M,[]);Am(cg,M);Object(Yd.a)(cg,"PivotTableItemsWithNoDataOnColumnsShownEvent",M,[]);Am(ei,M);Object(Yd.a)(ei,"PivotTableItemsWithNoDataOnRowsShownEvent",M,[]);Am(uh,
M);Object(Yd.a)(uh,"PivotTableLayoutTypeSetEvent",M,[]);Am(Bg,M);Object(Yd.a)(Bg,"PivotTableNullStringChangedEvent",M,[]);Am($f,Ld);$f.prototype.mc=function(){this.Zb(219)};uk.Object.defineProperties($f.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 149}}});Object(Yd.a)($f,"PivotTablePivotLocationChangedEvent",Ld,[]);Am(Fg,Ld);Fg.prototype.mc=function(){this.Zb(145)};uk.Object.defineProperties(Fg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 102}}});
Object(Yd.a)(Fg,"PivotTablePivotedEvent",Ld,[]);Am(Di,M);Object(Yd.a)(Di,"PivotTableRefreshDataOnLoadToggledEvent",M,[]);Am(Ph,Ld);Ph.prototype.mc=function(){this.Zb(50)};Ph.prototype.wg=function(){this.Bd(function(G){return!!G.pivotTableId&&!!G.pivotTableName})};uk.Object.defineProperties(Ph.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 104}}});Object(Yd.a)(Ph,"PivotTableRefreshedEvent",Ld,[]);Am(rh,M);Object(Yd.a)(rh,"PivotTableRenamedEvent",M,[]);Am(Gh,M);Object(Yd.a)(Gh,
"PivotTableRowGrandTotalShownEvent",M,[]);Am(oe,M);Object(Yd.a)(oe,"PivotTableSaveSourceDataWithFileToggledEvent",M,[]);var Pj=b(701);Am(xg,Ld);xg.prototype.mc=function(){this.Zb(131)};xg.prototype.wg=function(){this.Bd(function(G){G=Object(Ii.a)(Pj.a,G);return!!G&&!!G.kLa()&&!!G.hierarchyName})};uk.Object.defineProperties(xg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 155}}});Object(Yd.a)(xg,"PivotTableSortedEvent",Ld,[]);Am(Yf,M);Object(Yd.a)(Yf,"PivotTableSubTotalsVisibilitySettingSetEvent",
M,[]);Am(bg,Ld);bg.prototype.mc=function(){this.Zb(560)};uk.Object.defineProperties(bg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 206}}});Object(Yd.a)(bg,"PivotValueFieldSettingAppliedEvent",Ld,[]);Am(sg,Ld);sg.prototype.mc=function(){this.Zb(243)};uk.Object.defineProperties(sg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 161}}});Object(Yd.a)(sg,"PrintAreaClearedEvent",Ld,[]);Am(yf,Ld);yf.prototype.mc=function(){this.Zb(241)};yf.prototype.wg=
function(){this.Bd(function(G){return!G.addToPrintArea})};uk.Object.defineProperties(yf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 159}}});Object(Yd.a)(yf,"PrintAreaSetEvent",Ld,[]);Am(ee,Ld);ee.prototype.mc=function(){this.Zb(517)};uk.Object.defineProperties(ee.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 57}}});Object(Yd.a)(ee,"RangeAutoFilterClearedEvent",Ld,[]);Am(Nd,Ld);Nd.prototype.mc=function(){this.Zb(11)};Nd.prototype.wg=function(){var G=
this;this.Bd(function(ja){return 16===ja.s_().ValidMembers});this.Bd(function(ja){return ja.s_().Font.ValidMembers===G.J1d})};uk.Object.defineProperties(Nd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return this.mga}}});Object(Yd.a)(Nd,"RangeFontFormattedEventBase",Ld,[]);Am(wb,Nd);Object(Yd.a)(wb,"RangeBoldedEvent",Nd,[]);Am(sa,Ld);sa.prototype.mc=function(){this.Zb(11)};sa.prototype.wg=function(){this.Bd(function(G){return 128===G.s_().ValidMembers})};uk.Object.defineProperties(sa.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 2}}});Object(Yd.a)(sa,"RangeBorderedEvent",Ld,[]);Ka.Gab="Table";Ka.Zqc="Sheet";Object(Yd.a)(Ka,"MacroRecorderEventConstants",null,[]);Am(Uh,Ld);Uh.prototype.mc=function(){this.Zb(208)};Uh.prototype.wg=function(){this.Bd(function(G){return G.getParameters().FilterType===Ka.Zqc})};uk.Object.defineProperties(Uh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 113}}});Object(Yd.a)(Uh,"RangeCheckedItemsFilteredEvent",
Ld,[]);Am(Gi,Ld);Gi.prototype.mc=function(){this.Zb(106);this.Zb(105)};uk.Object.defineProperties(Gi.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 109}}});Object(Yd.a)(Gi,"RangeConditionalFormattingChangedEvent",Ld,[]);Am(Bf,Ld);Bf.prototype.mc=function(){this.Zb(221)};uk.Object.defineProperties(Bf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 124}}});Object(Yd.a)(Bf,"RangeConditionalFormattingRuleDeletedEvent",Ld,[]);Am(Qg,Ld);Qg.prototype.mc=function(){this.Zb(508)};
Qg.prototype.wg=function(){this.Bd(function(G){return 3===G.yt()||1===G.yt()||4===G.yt()})};uk.Object.defineProperties(Qg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 29}}});Object(Yd.a)(Qg,"RangeContentClearedEvent",Ld,[]);Am(Ah,Ld);Ah.prototype.mc=function(){this.Zb(104)};uk.Object.defineProperties(Ah.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 40}}});Object(Yd.a)(Ah,"RangeCopiedCutCellsInsertedEvent",Ld,[]);Am(zg,Ld);zg.prototype.mc=function(){this.Zb(209)};
zg.prototype.wg=function(){this.Bd(function(G){return G.getParameters().FilterType===Ka.Zqc})};uk.Object.defineProperties(zg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 114}}});Object(Yd.a)(zg,"RangeCustomFilteredEvent",Ld,[]);Am(li,Ld);li.prototype.mc=function(){this.Zb(121)};uk.Object.defineProperties(li.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 106}}});Object(Yd.a)(li,"RangeDataValidationChangedEvent",Ld,[]);Am(Dg,Nd);Object(Yd.a)(Dg,"RangeDoubleUnderlinedEvent",
Nd,[]);Am(Zg,Ld);Zg.prototype.mc=function(){this.Zb(190)};uk.Object.defineProperties(Zg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 69}}});Object(Yd.a)(Zg,"RangeDuplicatesRemovedEvent",Ld,[]);Am(oh,Ld);oh.prototype.mc=function(){this.Zb(527);this.Zb(12)};uk.Object.defineProperties(oh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 1}}});Object(Yd.a)(oh,"RangeEditedEvent",Ld,[]);Am(Ag,Ld);Ag.prototype.mc=function(){Df.EwaSettings.isChangeGateEnabled("OfficeVSO:5347704_WebExternalLinksEnableBreakLinksErrors")?
this.Zb(255):this.Zb(232)};Ag.prototype.wg=function(){this.Bd(function(G){return 4===G.actionType})};uk.Object.defineProperties(Ag.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 164}}});Object(Yd.a)(Ag,"RangeExternalLinksBrokeAllLinksEvent",Ld,[]);Am(ph,Ld);ph.prototype.mc=function(){Df.EwaSettings.isChangeGateEnabled("OfficeVSO:5347704_WebExternalLinksEnableBreakLinksErrors")?this.Zb(255):this.Zb(232)};ph.prototype.wg=function(){this.Bd(function(G){return 3===G.actionType})};
uk.Object.defineProperties(ph.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 119}}});Object(Yd.a)(ph,"RangeExternalLinksBrokeLinkEvent",Ld,[]);Am(Tg,Ld);Tg.prototype.mc=function(){Df.EwaSettings.isChangeGateEnabled("OfficeVSO:5347704_WebExternalLinksEnableBreakLinksErrors")?this.Zb(256):this.Zb(249)};Tg.prototype.wxa=function(){this.upe("Microsoft.Office.Excel.WebExternalLinksChangeSourceMacroRecorder")};uk.Object.defineProperties(Tg.prototype,{eventId:{configurable:!0,enumerable:!0,
get:function(){return 205}}});Object(Yd.a)(Tg,"RangeExternalLinksChangeSourceEvent",Ld,[]);Am(Hi,Ld);Hi.prototype.mc=function(){this.Zb(553)};Hi.prototype.wg=function(){this.Bd(function(G){return 1===G.actionType})};uk.Object.defineProperties(Hi.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 163}}});Object(Yd.a)(Hi,"RangeExternalLinksRefreshedAllEvent",Ld,[]);Am(vh,Ld);vh.prototype.mc=function(){this.Zb(553)};vh.prototype.wg=function(){this.Bd(function(G){return 0===G.actionType})};
uk.Object.defineProperties(vh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 77}}});Object(Yd.a)(vh,"RangeExternalLinksRefreshedEvent",Ld,[]);Am(Gg,Ld);Gg.prototype.mc=function(){this.Zb(224)};uk.Object.defineProperties(Gg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 165}}});Object(Yd.a)(Gg,"RangeExternalLinksSetAutoRefreshEvent",Ld,[]);Am(Nh,Ld);Nh.prototype.mc=function(){this.Zb(11)};Nh.prototype.wg=function(){this.Bd(function(G){return 64===G.s_().ValidMembers})};
uk.Object.defineProperties(Nh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 5}}});Object(Yd.a)(Nh,"RangeFillColoredEvent",Ld,[]);Am(Sh,Ld);Sh.prototype.mc=function(){this.Zb(155)};uk.Object.defineProperties(Sh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 59}}});Object(Yd.a)(Sh,"RangeFilledEvent",Ld,[]);Am(Kg,Ld);Kg.prototype.mc=function(){this.Zb(176)};Kg.prototype.wg=function(){this.Bd(function(G){return G.$V().AutoFilterType===Ka.Zqc&&!!G.$V().CriteriaType})};
uk.Object.defineProperties(Kg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 115}}});Object(Yd.a)(Kg,"RangeFilterAppliedEvent",Ld,[]);Am(Fh,Ld);Fh.prototype.mc=function(){this.Zb(176)};Fh.prototype.wg=function(){this.Bd(function(G){return G.$V().AutoFilterType===Ka.Zqc&&!G.$V().CriteriaType})};uk.Object.defineProperties(Fh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 58}}});Object(Yd.a)(Fh,"RangeFilterClearedEvent",Ld,[]);Am(Xh,Ld);Xh.prototype.mc=
function(){this.Zb(518)};uk.Object.defineProperties(Xh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 41}}});Object(Yd.a)(Xh,"RangeFilterReappliedEvent",Ld,[]);Am(Eh,Ld);Eh.prototype.mc=function(){this.Zb(150)};uk.Object.defineProperties(Eh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 86}}});Object(Yd.a)(Eh,"RangeFlashFilledEvent",Ld,[]);Am(zh,Nd);Object(Yd.a)(zh,"RangeFontColoredEvent",Nd,[]);Am($h,Nd);Object(Yd.a)($h,"RangeFontItalicizedEvent",
Nd,[]);Am(Mh,Nd);Object(Yd.a)(Mh,"RangeFontNamedEvent",Nd,[]);Am(Jg,Nd);Object(Yd.a)(Jg,"RangeFontSizedEvent",Nd,[]);Am(di,Ld);di.prototype.mc=function(){this.Zb(215)};uk.Object.defineProperties(di.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 74}}});Object(Yd.a)(di,"RangeFormattedAsTableEvent",Ld,[]);Am(gg,Ld);gg.prototype.mc=function(){this.Zb(188)};uk.Object.defineProperties(gg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 97}}});Object(Yd.a)(gg,
"RangeGroupedOrUngroupedEvent",Ld,[]);Am(Sg,Ld);Sg.prototype.mc=function(){this.Zb(11)};Sg.prototype.wg=function(){this.Bd(function(G){return 2===G.s_().ValidMembers})};uk.Object.defineProperties(Sg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 60}}});Object(Yd.a)(Sg,"RangeHorizontallyAlignedEvent",Ld,[]);Am(Xg,Ld);Xg.prototype.mc=function(){this.Zb(526)};uk.Object.defineProperties(Xg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 43}}});Object(Yd.a)(Xg,
"RangeHyperlinkAppliedEvent",Ld,[]);Am(Oh,Ld);Oh.prototype.mc=function(){this.Zb(11)};Oh.prototype.wg=function(){this.Bd(function(G){return 256===G.s_().ValidMembers})};uk.Object.defineProperties(Oh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 63}}});Object(Yd.a)(Oh,"RangeIndentChangedEvent",Ld,[]);Am(th,Ld);th.prototype.mc=function(){this.Zb(156)};th.prototype.wg=function(){this.Bd(function(G){return 2===G.yt()||5===G.yt()||6===G.yt()||7===G.yt()})};uk.Object.defineProperties(th.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 53}}});Object(Yd.a)(th,"RangeMergedEvent",Ld,[]);Am(rg,Ld);rg.prototype.mc=function(){this.Zb(216)};uk.Object.defineProperties(rg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 107}}});Object(Yd.a)(rg,"RangeNamedCellStyleAppliedEvent",Ld,[]);Am(hh,Ld);hh.prototype.mc=function(){this.Zb(11)};hh.prototype.wg=function(){this.Bd(function(G){return 32===G.s_().ValidMembers})};uk.Object.defineProperties(hh.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 12}}});Object(Yd.a)(hh,"RangeNumberFormattedEvent",Ld,[]);var pk=b(1164);Am(Zh,Ld);Zh.prototype.mc=function(){this.Zb(141)};Zh.prototype.wg=function(){this.Bd(function(G){return Object(Kj.a)(pk.a,G)})};uk.Object.defineProperties(Zh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 108}}});Object(Yd.a)(Zh,"RangeSortedEvent",Ld,[]);Am(We,Nd);Object(Yd.a)(We,"RangeStrikedThroughEvent",Nd,[]);Am(Pg,Nd);Object(Yd.a)(Pg,
"RangeUnderlinedEvent",Nd,[]);Am(be,Ld);be.prototype.mc=function(){this.Zb(11)};be.prototype.wg=function(){this.Bd(function(G){return 1===G.s_().ValidMembers})};uk.Object.defineProperties(be.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 61}}});Object(Yd.a)(be,"RangeVerticallyAlignedEvent",Ld,[]);Am(ye,Ld);ye.prototype.mc=function(){this.Zb(11)};ye.prototype.wg=function(){this.Bd(function(G){return 8===G.s_().ValidMembers})};uk.Object.defineProperties(ye.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 62}}});Object(Yd.a)(ye,"RangeWrapTextToggledEvent",Ld,[]);Am(Cf,Ld);Cf.prototype.mc=function(){this.Zb(51)};uk.Object.defineProperties(Cf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 103}}});Object(Yd.a)(Cf,"RefreshedAllEvent",Ld,[]);Am(Ih,Ld);Ih.prototype.mc=function(){this.Zb(148)};uk.Object.defineProperties(Ih.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 47}}});Object(Yd.a)(Ih,"ReplaceAllEvent",Ld,[]);Am(Vf,
Ld);Vf.prototype.mc=function(){this.Zb(532)};Vf.prototype.wg=function(){this.Bd(function(G){return 95!==G.getShapeType()&&96!==G.getShapeType()&&97!==G.getShapeType()&&98!==G.getShapeType()&&100!==G.getShapeType()&&102!==G.getShapeType()&&103!==G.getShapeType()})};uk.Object.defineProperties(Vf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 91}}});Object(Yd.a)(Vf,"ShapeInsertedEvent",Ld,[]);Am(ud,Ld);ud.prototype.mc=function(){this.Zb(531)};uk.Object.defineProperties(ud.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 92}}});Object(Yd.a)(ud,"ShapeStyleSetEvent",Ld,[]);var bk=b(1023);Am(mf,Ld);mf.prototype.mc=function(){this.Zb(581)};mf.prototype.wg=function(){var G=this;this.Bd(function(ja){return Object(Kj.a)(bk.a,ja)&&4===ja.getShapeTextFormat().ValidMembers});this.Bd(function(ja){return Object(Kj.a)(bk.a,ja)&&ja.getShapeTextFormat().Font.ValidMembers===G.J1d})};uk.Object.defineProperties(mf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return this.mga}}});
Object(Yd.a)(mf,"ShapeTextFontFormattedEventBase",Ld,[]);Am(Mf,mf);Object(Yd.a)(Mf,"ShapeTextBoldedEvent",mf,[]);var vk=b(1166);Am(Sd,Ld);Sd.prototype.mc=function(){this.Zb(581)};Sd.prototype.wg=function(){this.Bd(function(G){return Object(Kj.a)(vk.a,G)})};uk.Object.defineProperties(Sd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 191}}});Object(Yd.a)(Sd,"ShapeTextChangedEvent",Ld,[]);Am(Pf,mf);Object(Yd.a)(Pf,"ShapeTextFontColorChangedEvent",mf,[]);Am(af,mf);Object(Yd.a)(af,
"ShapeTextFontNameChangedEvent",mf,[]);Am(tf,mf);Object(Yd.a)(tf,"ShapeTextFontSizeChangedEvent",mf,[]);Am(Se,Ld);Se.prototype.mc=function(){this.Zb(581)};Se.prototype.wg=function(){this.Bd(function(G){return Object(Kj.a)(bk.a,G)&&2===G.getShapeTextFormat().ValidMembers})};uk.Object.defineProperties(Se.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 199}}});Object(Yd.a)(Se,"ShapeTextHorizontallyAlignedEvent",Ld,[]);Am(fg,mf);Object(Yd.a)(fg,"ShapeTextItalicizedEvent",mf,[]);
Am(ld,mf);Object(Yd.a)(ld,"ShapeTextUnderlinedEvent",mf,[]);Am(Mc,Ld);Mc.prototype.mc=function(){this.Zb(581)};Mc.prototype.wg=function(){this.Bd(function(G){return Object(Kj.a)(bk.a,G)&&1===G.getShapeTextFormat().ValidMembers})};uk.Object.defineProperties(Mc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 200}}});Object(Yd.a)(Mc,"ShapeTextVerticallyAlignedEvent",Ld,[]);Am(Jb,Ld);Jb.prototype.mc=function(){this.Zb(138)};uk.Object.defineProperties(Jb.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 13}}});Object(Yd.a)(Jb,"SheetAddedEvent",Ld,[]);var lj=b(9);Am(ce,Ld);ce.prototype.mc=function(){this.Zb(237)};ce.prototype.wg=function(){this.Bd(function(G){return!!G.insertDeleteMultiRangeParameters});this.Bd(function(G){return!G.insertDeleteMultiRangeParameters.IsTableCommand});this.Bd(function(G){G=G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0];return 0>G.DeltaColumn&&!G.DeltaRow&&(!!G.InsertDeleteRange.FirstRow||G.InsertDeleteRange.LastRow!==
lj.a.By)||!G.DeltaColumn&&0>G.DeltaRow&&(!!G.InsertDeleteRange.FirstColumn||G.InsertDeleteRange.LastColumn!==lj.a.yv)})};uk.Object.defineProperties(ce.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 142}}});Object(Yd.a)(ce,"SheetCellsDeletedEvent",Ld,[]);Am(Re,Ld);Re.prototype.mc=function(){this.Zb(237)};Re.prototype.wg=function(){this.Bd(function(G){return!!G.insertDeleteMultiRangeParameters});this.Bd(function(G){return!G.insertDeleteMultiRangeParameters.IsTableCommand});
this.Bd(function(G){G=G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0];return 0<G.DeltaColumn&&!G.DeltaRow&&(!!G.InsertDeleteRange.FirstRow||G.InsertDeleteRange.LastRow!==lj.a.By)||!G.DeltaColumn&&0<G.DeltaRow&&(!!G.InsertDeleteRange.FirstColumn||G.InsertDeleteRange.LastColumn!==lj.a.yv)})};uk.Object.defineProperties(Re.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 143}}});Object(Yd.a)(Re,"SheetCellsInsertedEvent",Ld,[]);Am(de,Ld);de.prototype.mc=function(){this.Zb(237)};
de.prototype.wg=function(){this.Bd(function(G){return!!G.insertDeleteMultiRangeParameters});this.Bd(function(G){return!G.insertDeleteMultiRangeParameters.IsTableCommand});this.Bd(function(G){return 0>G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.Bd(function(G){return!G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow});this.Bd(function(G){return!G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstRow});this.Bd(function(G){return G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastRow===
lj.a.By})};uk.Object.defineProperties(de.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 139}}});Object(Yd.a)(de,"SheetColumnDeletedEvent",Ld,[]);Am(Kd,Ld);Kd.prototype.mc=function(){this.Zb(237)};Kd.prototype.wg=function(){this.Bd(function(G){return!!G.insertDeleteMultiRangeParameters});this.Bd(function(G){return!G.insertDeleteMultiRangeParameters.IsTableCommand});this.Bd(function(G){return 0<G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.Bd(function(G){return!G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow});
this.Bd(function(G){return!G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstRow});this.Bd(function(G){return G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastRow===lj.a.By})};uk.Object.defineProperties(Kd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 138}}});Object(Yd.a)(Kd,"SheetColumnInsertedEvent",Ld,[]);Am(bd,Ld);bd.prototype.mc=function(){this.Zb(137)};uk.Object.defineProperties(bd.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 14}}});Object(Yd.a)(bd,"SheetDeletedEvent",Ld,[]);Am(yc,Ld);yc.prototype.mc=function(){this.Zb(185)};uk.Object.defineProperties(yc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 137}}});Object(Yd.a)(yc,"SheetDirectionChangedEvent",Ld,[]);Am(bc,Ld);bc.prototype.mc=function(){this.Zb(139)};uk.Object.defineProperties(bc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 54}}});Object(Yd.a)(bc,"SheetDuplicatedEvent",Ld,
[]);Am(cb,Ld);cb.prototype.mc=function(){this.Zb(207)};uk.Object.defineProperties(cb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 15}}});Object(Yd.a)(cb,"SheetNameEditedEvent",Ld,[]);Am(Qa,Ld);Qa.prototype.mc=function(){this.Zb(151)};uk.Object.defineProperties(Qa.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 90}}});Object(Yd.a)(Qa,"SheetPaneFrozenEvent",Ld,[]);Am(sf,Ld);sf.prototype.mc=function(){this.Zb(226)};uk.Object.defineProperties(sf.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 120}}});Object(Yd.a)(sf,"SheetPrintSettingsSavedEvent",Ld,[]);var zi=b(1069);Am(Me,Ld);Me.prototype.mc=function(){this.Zb(507)};Me.prototype.wxa=function(){this.upe("Microsoft.Office.Excel.SheetProtectionMacroRecording")};Me.prototype.wg=function(){this.Bd(function(G){return Object.getType(G)===zi.a})};uk.Object.defineProperties(Me.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 215}}});Object(Yd.a)(Me,"SheetProtectionPausedResumedEvent",
Ld,[]);Am(Be,Ld);Be.prototype.mc=function(){this.Zb(557)};uk.Object.defineProperties(Be.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 64}}});Object(Yd.a)(Be,"SheetReorderedEvent",Ld,[]);Am(Fd,Ld);Fd.prototype.mc=function(){this.Zb(237)};Fd.prototype.wg=function(){this.Bd(function(G){return!!G.insertDeleteMultiRangeParameters});this.Bd(function(G){return!G.insertDeleteMultiRangeParameters.IsTableCommand});this.Bd(function(G){return!G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});
this.Bd(function(G){return 0>G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow});this.Bd(function(G){return!G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstColumn});this.Bd(function(G){return G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastColumn===lj.a.yv})};uk.Object.defineProperties(Fd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 141}}});Object(Yd.a)(Fd,"SheetRowDeletedEvent",Ld,
[]);Am(Bd,Ld);Bd.prototype.mc=function(){this.Zb(237)};Bd.prototype.wg=function(){this.Bd(function(G){return!!G.insertDeleteMultiRangeParameters});this.Bd(function(G){return!G.insertDeleteMultiRangeParameters.IsTableCommand});this.Bd(function(G){return!G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.Bd(function(G){return 0<G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow});this.Bd(function(G){return!G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstColumn});
this.Bd(function(G){return G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastColumn===lj.a.yv})};uk.Object.defineProperties(Bd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 140}}});Object(Yd.a)(Bd,"SheetRowInsertedEvent",Ld,[]);Am(Dc,Ld);Dc.prototype.mc=function(){this.Zb(135)};uk.Object.defineProperties(Dc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 39}}});Object(Yd.a)(Dc,"SheetRowsColumnsAutoFitEvent",Ld,[]);
Am(Hb,Ld);Hb.prototype.mc=function(){this.Zb(136)};uk.Object.defineProperties(Hb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 36}}});Object(Yd.a)(Hb,"SheetRowsColumnsResizedEvent",Ld,[]);Am(Ga,Ld);Ga.prototype.mc=function(){this.Zb(183)};uk.Object.defineProperties(Ga.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 68}}});Object(Yd.a)(Ga,"SheetShowGridlinesToggledEvent",Ld,[]);Am(pg,Ld);pg.prototype.mc=function(){this.Zb(184)};uk.Object.defineProperties(pg.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 67}}});Object(Yd.a)(pg,"SheetShowHeadingsToggledEvent",Ld,[]);Am(ah,Ld);ah.prototype.mc=function(){this.Zb(213)};uk.Object.defineProperties(ah.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 89}}});Object(Yd.a)(ah,"SheetSpellCheckedEvent",Ld,[]);Am(Rg,Ld);Rg.prototype.mc=function(){this.Zb(515)};uk.Object.defineProperties(Rg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 70}}});Object(Yd.a)(Rg,
"SheetTabColoredEvent",Ld,[]);Am(fh,Ld);fh.prototype.mc=function(){this.Zb(157)};uk.Object.defineProperties(fh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 71}}});Object(Yd.a)(fh,"SheetVisibilityChangedEvent",Ld,[]);Am(Qe,Ld);Qe.prototype.mc=function(){this.Zb(239)};uk.Object.defineProperties(Qe.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 126}}});Object(Yd.a)(Qe,"SheetsVisibilityChangedEvent",Ld,[]);Am(nf,Ld);nf.prototype.mc=function(){this.Zb(203)};
uk.Object.defineProperties(nf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 188}}});Object(Yd.a)(nf,"SlicerInsertedEvent",Ld,[]);Am($g,Ld);$g.prototype.mc=function(){this.Zb(173)};$g.prototype.wg=function(){this.Bd(function(G){return!G.clearFilter})};uk.Object.defineProperties($g.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 189}}});Object(Yd.a)($g,"SlicerSelectionAppliedEvent",Ld,[]);Am(qf,Ld);qf.prototype.mc=function(){this.Zb(173)};qf.prototype.wg=
function(){this.Bd(function(G){return G.clearFilter})};uk.Object.defineProperties(qf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 190}}});Object(Yd.a)(qf,"SlicerSelectionClearedEvent",Ld,[]);Am(dg,Ld);dg.prototype.mc=function(){this.Zb(208)};dg.prototype.wg=function(){this.Bd(function(G){return G.getParameters().FilterType===Ka.Gab})};uk.Object.defineProperties(dg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 27}}});Object(Yd.a)(dg,"TableCheckedItemsFilteredEvent",
Ld,[]);Am(rf,Ld);rf.prototype.mc=function(){this.Zb(237)};rf.prototype.wg=function(){this.Bd(function(G){return!!G.insertDeleteMultiRangeParameters});this.Bd(function(G){return G.insertDeleteMultiRangeParameters.IsTableCommand});this.Bd(function(G){return 0>G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.Bd(function(G){return!G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow})};uk.Object.defineProperties(rf.prototype,{eventId:{configurable:!0,enumerable:!0,
get:function(){return 144}}});Object(Yd.a)(rf,"TableColumnDeletedEvent",Ld,[]);Am(ng,Ld);ng.prototype.mc=function(){this.Zb(237)};ng.prototype.wg=function(){this.Bd(function(G){return!!G.insertDeleteMultiRangeParameters});this.Bd(function(G){return G.insertDeleteMultiRangeParameters.IsTableCommand});this.Bd(function(G){return 0<G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.Bd(function(G){return!G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow})};
uk.Object.defineProperties(ng.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 145}}});Object(Yd.a)(ng,"TableColumnInsertedEvent",Ld,[]);var Rk=b(1165);Am(Ke,Ld);Ke.prototype.mc=function(){this.Zb(141)};Ke.prototype.wg=function(){this.Bd(function(G){return Object(Kj.a)(Rk.a,G)})};uk.Object.defineProperties(Ke.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 121}}});Object(Yd.a)(Ke,"TableColumnSortedEvent",Ld,[]);Am(If,Ld);If.prototype.mc=function(){this.Zb(193)};
uk.Object.defineProperties(If.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 105}}});Object(Yd.a)(If,"TableConvertedToRangeEvent",Ld,[]);Am(ef,Ld);ef.prototype.mc=function(){this.Zb(206)};uk.Object.defineProperties(ef.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 16}}});Object(Yd.a)(ef,"TableCreatedEvent",Ld,[]);Am(fe,Ld);fe.prototype.mc=function(){this.Zb(209)};fe.prototype.wg=function(){this.Bd(function(G){return G.getParameters().FilterType===
Ka.Gab})};uk.Object.defineProperties(fe.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 30}}});Object(Yd.a)(fe,"TableCustomFilteredEvent",Ld,[]);Am(Fe,Ld);Fe.prototype.mc=function(){this.Zb(187)};Fe.prototype.wg=function(){this.Bd(function(G){return 1===G.options.OperationType})};uk.Object.defineProperties(Fe.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 25}}});Object(Yd.a)(Fe,"TableCustomSortedEvent",Ld,[]);Am(Td,Ld);Td.prototype.mc=function(){this.Zb(176)};
Td.prototype.wg=function(){this.Bd(function(G){return G.$V().AutoFilterType===Ka.Gab});this.Bd(function(G){return 0===G.$V().CriteriaType})};uk.Object.defineProperties(Td.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 28}}});Object(Yd.a)(Td,"TableFilterClearedEvent",Ld,[]);Am(nd,Ld);nd.prototype.mc=function(){this.Zb(176)};nd.prototype.wg=function(){this.Bd(function(G){return G.$V().AutoFilterType===Ka.Gab});this.Bd(function(G){var ja=new Kh.a;ja.add(1);ja.add(2);ja.add(8);
ja.add(9);ja.add(10);ja.add(11);ja.add(12);ja.add(13);ja.add(14);ja.add(15);ja.add(16);ja.add(17);ja.add(18);ja.add(19);ja.add(20);ja.add(21);ja.add(22);ja.add(23);ja.add(24);ja.add(25);ja.add(26);ja.add(27);ja.add(28);ja.add(29);ja.add(30);ja.add(31);ja.add(32);ja.add(33);ja.add(34);ja.add(35);ja.add(36);ja.add(37);ja.add(38);ja.add(39);return ja.contains(G.$V().CriteriaType)})};uk.Object.defineProperties(nd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 32}}});Object(Yd.a)(nd,
"TableItemFilteredEvent",Ld,[]);Am(Rc,Ld);Rc.prototype.mc=function(){this.Zb(217)};uk.Object.defineProperties(Rc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 101}}});Object(Yd.a)(Rc,"TableRenamedEvent",Ld,[]);Am(mc,Ld);mc.prototype.mc=function(){this.Zb(211)};uk.Object.defineProperties(mc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 73}}});Object(Yd.a)(mc,"TableResizedEvent",Ld,[]);Am(ke,Ld);ke.prototype.mc=function(){this.Zb(514)};uk.Object.defineProperties(ke.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 44}}});Object(Yd.a)(ke,"TableRowColumnRearrangedEvent",Ld,[]);Am(Ed,Ld);Ed.prototype.mc=function(){this.Zb(237)};Ed.prototype.wg=function(){this.Bd(function(G){return!!G.insertDeleteMultiRangeParameters});this.Bd(function(G){return G.insertDeleteMultiRangeParameters.IsTableCommand});this.Bd(function(G){return!G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.Bd(function(G){return 0>G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow})};
uk.Object.defineProperties(Ed.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 146}}});Object(Yd.a)(Ed,"TableRowDeletedEvent",Ld,[]);Am(Md,Ld);Md.prototype.mc=function(){this.Zb(237)};Md.prototype.wg=function(){this.Bd(function(G){return!!G.insertDeleteMultiRangeParameters});this.Bd(function(G){return G.insertDeleteMultiRangeParameters.IsTableCommand});this.Bd(function(G){return!G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.Bd(function(G){return 0<
G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow})};uk.Object.defineProperties(Md.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 147}}});Object(Yd.a)(Md,"TableRowInsertedEvent",Ld,[]);Am(Yc,Ld);Yc.prototype.mc=function(){this.Zb(177)};Yc.prototype.wg=function(){this.Bd(function(G){return G.$V().AutoFilterType===Ka.Gab})};uk.Object.defineProperties(Yc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 26}}});Object(Yd.a)(Yc,"TableSortedEvent",
Ld,[]);Am(vc,Ld);vc.prototype.mc=function(){this.Zb(212)};uk.Object.defineProperties(vc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 87}}});Object(Yd.a)(vc,"TableStyleAppliedEvent",Ld,[]);Am(Ib,Ld);Ib.prototype.mc=function(){this.Zb(196)};uk.Object.defineProperties(Ib.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 88}}});Object(Yd.a)(Ib,"TableStyleOptionToggledEvent",Ld,[]);Am(Na,Ld);Na.prototype.mc=function(){this.Zb(210)};Na.prototype.wg=function(){this.Bd(function(G){return G.getParameters().FilterType===
Ka.Gab})};uk.Object.defineProperties(Na.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 31}}});Object(Yd.a)(Na,"TableTop10FilteredEvent",Ld,[]);Am(eg,Ld);eg.prototype.mc=function(){this.Zb(238)};uk.Object.defineProperties(eg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 207}}});Object(Yd.a)(eg,"TextToColumnsEvent",Ld,[]);Am(Ef,Ld);Ef.prototype.mc=function(){this.Zb(559)};uk.Object.defineProperties(Ef.prototype,{eventId:{configurable:!0,enumerable:!0,
get:function(){return 128}}});Object(Yd.a)(Ef,"ValuesSortedEvent",Ld,[]);Am(lg,Ld);lg.prototype.mc=function(){this.Zb(197)};uk.Object.defineProperties(lg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 55}}});Object(Yd.a)(lg,"WorkbookCalculationModeSetEvent",Ld,[]);Am(Eg,Ld);Eg.prototype.mc=function(){this.Zb(181)};Eg.prototype.wg=function(){this.Bd(function(G){return!!G.parentCommentId})};uk.Object.defineProperties(Eg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 34}}});
Object(Yd.a)(Eg,"WorkbookCommentRepliedEvent",Ld,[]);Am(Ee,Ld);Ee.prototype.mc=function(){this.Zb(181)};Ee.prototype.wg=function(){this.Bd(function(G){return!G.parentCommentId})};uk.Object.defineProperties(Ee.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 33}}});Object(Yd.a)(Ee,"WorkbookCommentedEvent",Ld,[]);Am(Of,Ld);Of.prototype.mc=function(){this.Zb(128)};uk.Object.defineProperties(Of.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 56}}});Object(Yd.a)(Of,
"WorkbookRecalculatedEvent",Ld,[]);Am(Qd,Ld);Qd.prototype.mc=function(){this.Zb(171)};uk.Object.defineProperties(Qd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 46}}});Object(Yd.a)(Qd,"WorkbookRedoEvent",Ld,[]);Am(Le,Ld);Le.prototype.mc=function(){this.Zb(170)};uk.Object.defineProperties(Le.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 45}}});Object(Yd.a)(Le,"WorkbookUndoEvent",Ld,[]);Am(ug,Ld);ug.prototype.mc=function(){this.Zb(507);this.Zb(576);
this.Zb(10)};ug.prototype.wg=function(){this.Bd(function(G){if(Object(Kj.a)(ec,G)&&(G=Object(Ii.a)(ec,G),void 0!==G.source&&null!==G.source&&void 0!==G.eventId&&null!==G.eventId))return df.ULS.sendTraceTag(537155426,0,50,"[RichApiRecorder]: received a valid but unhandled event: source: {0}; eventId: {1}.",G.source,G.eventId),!0;df.ULS.sendTraceTag(537155425,0,50,"[RichApiRecorder]: an invalid event was ignored.");return!1})};uk.Object.defineProperties(ug.prototype,{eventId:{configurable:!0,enumerable:!0,
get:function(){return 116}}});Object(Yd.a)(ug,"DefaultRichApiRequestExecutedEvent",Ld,[]);Am(Tf,Ld);Tf.prototype.mc=function(){this.Zb(1022)};uk.Object.defineProperties(Tf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 216}}});Object(Yd.a)(Tf,"TablelAltTextEditedEvent",Ld,[]);Am(Wf,Ld);Wf.prototype.mc=function(){this.Zb(263)};uk.Object.defineProperties(Wf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 217}}});Object(Yd.a)(Wf,"FloatingObjectZOrderChangedEvent",
Ld,[]);Uf.prototype.Z3e=function(G,ja){var Wa=this.$3e(G,this.macroRecorderEvents,ja);Wa||(Wa=this.$3e(G,Uf.l6h(),ja),!Wa&&this.Wif(G,Uf.DKe,ja)&&(Wa=Uf.DKe));return Wa};Uf.prototype.$3e=function(G,ja,Wa){var vb=new Kh.a;ja=Cl(ja);for(var f=ja.next();!f.done;f=ja.next())f=f.value,this.Wif(G,f,Wa)&&vb.add(f);return 1===vb.count?vb.pa(0):1<vb.count?Uf.cPh(vb):null};Uf.prototype.Wif=function(G,ja,Wa){var vb=Uf.S_i(G,ja);return Wa?vb&&Uf.g0j(G,ja):vb};Uf.prototype.Eej=function(){for(var G=new Kh.a,ja=
Cl(this.Hb),Wa=ja.next();!Wa.done;Wa=ja.next()){Wa=Wa.value;for(var vb=!1,f=Cl(Wa.featureGates),D=f.next();!D.done;D=f.next())if(!Df.EwaSettings.ma(D.value)){G.add(Wa);vb=!0;break}if(!vb)for(vb=Cl(Wa.kWe),f=vb.next();!f.done;f=vb.next())if(!Df.EwaSettings.getBooleanFeatureGate(f.value,!1)){G.add(Wa);break}}G=Cl(G);for(ja=G.next();!ja.done;ja=G.next())this.Hb.remove(ja.value)};Uf.l6h=function(){Uf.NDb||(Uf.NDb=new Kh.a,Uf.NDb.add(new Db),Uf.NDb.add(new Lg));return Uf.NDb};Uf.S_i=function(G,ja){return ja.operations.contains(G.operation)};
Uf.g0j=function(G,ja){var Wa=ja.REc;if(!Wa.count)return!0;ja=!0;Wa=Cl(Wa);for(var vb=Wa.next();!vb.done;vb=Wa.next())if(vb=vb.value,!vb(G.payload)){ja=!1;break}return ja};Uf.cPh=function(G){var ja=G.pa(0);G=Cl(G);for(var Wa=G.next();!Wa.done;Wa=G.next())Wa=Wa.value,Wa.REc.count>ja.REc.count&&(ja=Wa);return ja};uk.Object.defineProperties(Uf.prototype,{macroRecorderEvents:{configurable:!0,enumerable:!0,get:function(){this.Hb||(this.Hb=new Kh.a,this.Hb.add(new oh),this.Hb.add(new sa),this.Hb.add(new wb),
this.Hb.add(new Dg),this.Hb.add(new Nh),this.Hb.add(new zh),this.Hb.add(new $h),this.Hb.add(new Mh),this.Hb.add(new Jg),this.Hb.add(new We),this.Hb.add(new Pg),this.Hb.add(new hh),this.Hb.add(new Jb),this.Hb.add(new bd),this.Hb.add(new cb),this.Hb.add(new ef),this.Hb.add(new rf),this.Hb.add(new ng),this.Hb.add(new Ed),this.Hb.add(new Md),this.Hb.add(new Kd),this.Hb.add(new de),this.Hb.add(new Bd),this.Hb.add(new Fd),this.Hb.add(new Fe),this.Hb.add(new Yc),this.Hb.add(new dg),this.Hb.add(new Td),this.Hb.add(new Qg),
this.Hb.add(new fe),this.Hb.add(new Na),this.Hb.add(new nd),this.Hb.add(new Ee),this.Hb.add(new Eg),this.Hb.add(new Oc),this.Hb.add(new Hb),this.Hb.add(new ce),this.Hb.add(new Re),this.Hb.add(new Dc),this.Hb.add(new Ah),this.Hb.add(new Xh),this.Hb.add(new Xg),this.Hb.add(new Fb),this.Hb.add(new ke),this.Hb.add(new Qd),this.Hb.add(new Le),this.Hb.add(new Ih),this.Hb.add(new Vh),this.Hb.add(new Rd),this.Hb.add(new th),this.Hb.add(new bc),this.Hb.add(new lg),this.Hb.add(new Of),this.Hb.add(new ee),this.Hb.add(new Fh),
this.Hb.add(new Sh),this.Hb.add(new Sg),this.Hb.add(new be),this.Hb.add(new ye),this.Hb.add(new Oh),this.Hb.add(new Be),this.Hb.add(new Ig),this.Hb.add(new Y),this.Hb.add(new pg),this.Hb.add(new Ga),this.Hb.add(new Zg),this.Hb.add(new fh),this.Hb.add(new Rg),this.Hb.add(new mc),this.Hb.add(new di),this.Hb.add(new ni),this.Hb.add(new Xd),this.Hb.add(new vh),this.Hb.add(new yi),this.Hb.add(new Hg),this.Hb.add(new cf),this.Hb.add(new jj),this.Hb.add(new xe),this.Hb.add(new Jd),this.Hb.add(new pf),this.Hb.add(new Ra),
this.Hb.add(new Eh),this.Hb.add(new vc),this.Hb.add(new Ib),this.Hb.add(new ah),this.Hb.add(new Qa),this.Hb.add(new Vf),this.Hb.add(new ud),this.Hb.add(new Og),this.Hb.add(new nh),this.Hb.add(new Ug),this.Hb.add(new Ei),this.Hb.add(new gg),this.Hb.add(new k),this.Hb.add(new Jc),this.Hb.add(new ai),this.Hb.add(new Rc),this.Hb.add(new Fg),this.Hb.add(new Cf),this.Hb.add(new Ph),this.Hb.add(new If),this.Hb.add(new li),this.Hb.add(new rg),this.Hb.add(new Zh),this.Hb.add(new Gi),this.Hb.add(new wd),this.Hb.add(new lc),
this.Hb.add(new Oe),this.Hb.add(new Uh),this.Hb.add(new zg),this.Hb.add(new Kg),this.Hb.add(new tg),this.Hb.add(new ca),this.Hb.add(new ph),this.Hb.add(new sf),this.Hb.add(new Ke),this.Hb.add(new Bf),this.Hb.add(new Qe),this.Hb.add(new Qf),this.Hb.add(new Ef),this.Hb.add(new Xi),this.Hb.add(new pi),this.Hb.add(new yj),this.Hb.add(new ve),this.Hb.add(new Oa),this.Hb.add(new Te),this.Hb.add(new yg),this.Hb.add(new yc),this.Hb.add(new kg),this.Hb.add(new $f),this.Hb.add(new V),this.Hb.add(new Mg),this.Hb.add(new xg),
this.Hb.add(new Yb),this.Hb.add(new $a),this.Hb.add(new la),this.Hb.add(new yf),this.Hb.add(new qg),this.Hb.add(new sg),this.Hb.add(new Tc),this.Hb.add(new Hi),this.Hb.add(new Ag),this.Hb.add(new Gg),this.Hb.add(new Ye),this.Hb.add(new td),this.Hb.add(new rh),this.Hb.add(new Gh),this.Hb.add(new Ab),this.Hb.add(new x),this.Hb.add(new oc),this.Hb.add(new R),this.Hb.add(new Zf),this.Hb.add(new ei),this.Hb.add(new cg),this.Hb.add(new Yg),this.Hb.add(new wh),this.Hb.add(new eh),this.Hb.add(new Bg),this.Hb.add(new oe),
this.Hb.add(new Di),this.Hb.add(new Ba),this.Hb.add(new d),this.Hb.add(new Yf),this.Hb.add(new uh),this.Hb.add(new Gf),this.Hb.add(new nf),this.Hb.add(new $g),this.Hb.add(new qf),this.Hb.add(new Sd),this.Hb.add(new Mf),this.Hb.add(new fg),this.Hb.add(new ld),this.Hb.add(new Pf),this.Hb.add(new af),this.Hb.add(new tf),this.Hb.add(new Se),this.Hb.add(new Mc),this.Hb.add(new Tg),this.Hb.add(new bg),this.Hb.add(new eg),this.Hb.add(new Me),this.Hb.add(new Tf),this.Hb.add(new Wf),Df.EwaSettings.isChangeGateEnabled("OfficeVSO:4825267_RemoveDisabledEvents")&&
this.Eej());return this.Hb}}});Uf.NDb=null;Uf.DKe=new ug;Object(Yd.a)(Uf,"MacroRecorderEventList",null,[]);var Lj=Ui.a;Am(wf,Lj);wf.prototype.create=function(){this.Eb(this.$.da.Aa(297)||new qi(this.$,new Uf(this.$),new ob))};wf.ka=function(G){G.da.Ha(298,new wf(G))};Object(Yd.a)(wf,"MacroRecorderEventHandlerFactory",Ui.a,[]);var zj=b(905),rj=b(78),Th=b(35);se.prototype.$c=function(){return!1};se.prototype.executeCommand=function(G,ja,Wa){G=Th.TaskExtensions.Dl();ja=ja.command;switch(ja){case 1845457202:case -1342227603:case -45542983:case 1904816141:case 1606046412:case 971811139:this.$.ae(2045014907,
-1,0,null),this.automateCommandManager.zwi(ja,1904816141===ja?Wa[rj.a.od].toString():null)}return G};se.prototype.Mc=function(G,ja){G=!1;switch(ja.command){case 1845457202:case -45542983:case -1342227603:case 971811139:case 1904816141:case 1606046412:G=this.$.pca}return G};se.prototype.nd=function(G,ja,Wa){return"PopulateAutomateGalleryMenu"===ja&&this.$.pca?(this.automateCommandManager.nd(ja,Wa),!0):!1};Object(Yd.a)(se,"AutomateCommandHandler",null,[434]);var ck=b(490),Uj=zj.a;Am(vf,Uj);vf.prototype.Qd=
function(){var G=this;ck.a(this.$,374,375,this.ub,function(){var ja=G.$.da.Aa(352);ja?G.Jd([new se(ja,G.$)]):df.ULS.sendTraceTag(537170316,0,15,"AutomateCommandManager should already been initialized before AutomateCommandHandler.")})};vf.ka=function(G){G.da.Ha(308,new vf(G))};Object(Yd.a)(vf,"AutomateCommandHandlerFactory",zj.a,[]);Object(Yd.a)(lf,"AuthContext",null,[]);var of=b(440),oi=b(131),si=b(110),ih=b(27),L=b(1024),Ea=b(185);Je.prototype.getAuthContext=function(){return this.oqb};Je.prototype.sdc=
function(){function G(D,N){return(new Promise(function(fa){window.setTimeout(function(){fa(D)},N)})).then(function(fa){vb.push(Object.assign(new Nf.a,{name:"Error"+f,string:fa.ErrorMessage}));vb.push(Object.assign(new Nf.a,{name:"ErrorCode"+f,string:fa.ErrorCode}));f++;return ja.xeg()})}var ja=this,Wa=ih.a.Ra.Ob,vb=[];if(this.oAuthManager)vb.push(Object.assign(new Nf.a,{name:"IsAuthSupported",bool:this.g_c}));else return this.fac(vb,Wa,"need_OAuthManager","No OAuthManager");if(!this.qw.zy||!this.qw.zy.value)return this.fac(vb,
Wa,"need_license","No License");if(ig.AFrameworkApplication.ha.ra("IsAnonymousUser"))return this.fac(vb,Wa,"need_user","Anonymous User");if(33E5>Date.now()-this.oqb.timeStamp)return vb.push(Object.assign(new Nf.a,{name:"UsedCachedToken",bool:!0})),Ea.a(oi.a.cCd,!0,0,vb),Promise.resolve(Object.assign(new L.a,{IsSuccess:!0,Token:this.oqb.token}));vb.push(Object.assign(new Nf.a,{name:"UsedCachedToken",bool:!1}));var f=1;return this.xeg().catch(function(D){return G(D,200)}).catch(function(D){return G(D,
400)}).then(function(D){D.IsSuccess?(ja.oqb.token=D.Token,ja.oqb.timeStamp=Date.now()):(vb.push(Object.assign(new Nf.a,{name:"Error"+f,string:D.ErrorMessage})),vb.push(Object.assign(new Nf.a,{name:"ErrorCode"+f,string:D.ErrorCode})));vb.push(Object.assign(new Nf.a,{name:"Attempts",int64:f}));vb.push(Object.assign(new Nf.a,{name:"Error",string:D.ErrorMessage}));vb.push(Object.assign(new Nf.a,{name:"ErrorCode",string:D.ErrorCode}));Ea.a(oi.a.cCd,D.IsSuccess,si.getElapsedMilliseconds(Wa,ih.a.Ra.Ob),
vb);return Promise.resolve(D)}).catch(function(D){vb.push(Object.assign(new Nf.a,{name:"Error"+f,string:D.ErrorMessage}));vb.push(Object.assign(new Nf.a,{name:"ErrorCode"+f,string:D.ErrorCode}));vb.push(Object.assign(new Nf.a,{name:"Attempts",int64:f}));return ja.fac(vb,Wa,D.ErrorCode,D.ErrorMessage)})};Je.prototype.fac=function(G,ja,Wa,vb){G.push(Object.assign(new Nf.a,{name:"Error",string:vb}));G.push(Object.assign(new Nf.a,{name:"ErrorCode",string:Wa}));Ea.a(oi.a.cCd,!1,si.getElapsedMilliseconds(ja,
ih.a.Ra.Ob),G);return Promise.resolve(Object.assign(new L.a,{IsSuccess:!1,ErrorMessage:vb,ErrorCode:Wa}))};Je.prototype.xeg=function(){var G=this,ja=of.a.l4h(),Wa=0;ja=this.oAuthManager.sT("Maker",ja).then(function(vb){if(vb)return!vb.IsSuccess&&G.cDj(vb)?Promise.reject(vb):Promise.resolve(vb);vb=Object.assign(new L.a,{IsSuccess:!1,ErrorMessage:"Missing result object",ErrorCode:"need_result"});return Promise.reject(vb)}).catch(function(vb){var f=new L.a;Object.getType(vb)===Object.getType(f)?f=vb:
(f.ErrorMessage=vb.toString(),f.ErrorCode="exception");return Promise.reject(f)});return Promise.race([ja,new Promise(function(vb,f){Wa=window.setTimeout(function(){f(Object.assign(new L.a,{IsSuccess:!1,ErrorCode:"Timeout",ErrorMessage:"Timed out waiting auth token promise"}))},2E4)})]).then(function(vb){window.clearTimeout(Wa);return vb})};Je.prototype.cDj=function(G){return"interaction_required"===G.ErrorCode||"InitFailed"===G.ErrorCode||"invalid_resource"===G.ErrorCode||"login_required"===G.ErrorCode&&
G.ErrorMessage.startsWith("AADSTS500341")?!1:!0};Object(Yd.a)(Je,"AutomateCommandAuth",null,[977]);var Ya=b(1025);Object(Yd.a)(Wd,"AutomateCommandGalleryBase",null,[]);var Vb=b(392),Vc=b(28),re=b(620),Pe=b(1432),hf=b(17),Lf=b(52),Ff=b(14),Ng=b(321),Cg=b(651);le.prototype.QMh=function(G){var ja=this.automateCommandManager.Ta.iq().BC(),Wa=le.nV(G,Ff.a.instance.fa(2079));this.nXc(Wa,of.a.DYi,this.automateCommandManager.kg,of.a.dKi,Ff.a.instance.fa(2075),this.automateCommandManager.Ta);Array.add(ja.MenuSectionList,
Wa);Wa=le.nV(G,Ff.a.instance.fa(2080));this.nXc(Wa,of.a.cHi,of.a.uL?this.automateCommandManager.Yk.HXe(this.automateCommandManager.kg):this.automateCommandManager.Tm.HXe(this.automateCommandManager.kg),of.a.Ywf,Ff.a.instance.fa(2076),this.automateCommandManager.Ta);Array.add(ja.MenuSectionList,Wa);Wa=le.nV(G,Ff.a.instance.fa(2081));this.nXc(Wa,of.a.Soj,this.automateCommandManager.Oo,of.a.Ywf,"",this.automateCommandManager.Ta);Array.add(ja.MenuSectionList,Wa);Wa=Object.assign(new Vb.a,{Id:of.a.dte,
ExternalId:of.a.dte,Command:"1606046412",LabelText:Ff.a.instance.fa(2072),Alt:Ff.a.instance.fa(2073),Image16by16:Lf.a.Ge(16),Image16by16Class:hf.a.BSe,Visible:!0});G=le.nV(G,null);G.ControlsId="myScriptsSection.Controls";Array.add(G.ControlList,Wa);Array.add(ja.MenuSectionList,G);return ja};le.prototype.nXc=function(G,ja,Wa,vb,f,D){if(Wa&&0<Wa.length){ja=D.oB(ja,1,"Size150by20").E2b();f={};D={};D.root=le.vua(320,30);D.flexContainer={display:"flex",height:"100%",flexWrap:"nowrap",justifyContent:"left",
alignItems:"left",lineHeight:"normal"};D.label={margin:"0px 3px"};f.galleryButtonInExpanded=D;ja.GalleryStyle=f;for(f=0;f<Wa.length&&f<vb;f++)D=Wa.hD(f),Array.add(ja.GalleryItems,le.p6b(D.id,D,!1));Array.add(G.ControlList,ja)}else Wa=Object.assign(new Cg.a,{Id:ja,ExternalId:ja,LabelText:f}),G.ControlsId=Wa.Id+".Controls",Array.add(G.ControlList,Wa)};le.d_e=function(G){if(G){var ja=String.format(of.a.jhi,G.isShared?of.a.Vdg:of.a.A_f,Lf.a.Ge(16));G=String.format(of.a.khi,Vc.a.Rf(G.name));return String.format(of.a.ihi,
ja,G)}return""};le.nV=function(G,ja){return Object.assign(new re.a,{Id:G,Title:ja,MenuSectionTitleFocusable:!0,ShowMenuSectionTitleBackground:!0,ShowMenuSectionTitleIcon:!0,ControlList:[]})};le.p6b=function(G,ja,Wa){var vb=Wa?of.a.HRj:of.a.GRj,f=Wa?of.a.kqj:of.a.jqj,D=Wa?of.a.Vdg:of.a.IRj,N=Wa?of.a.A_f:of.a.lqj;return ja?le.GHe(ja.shareId||ja.id,ja.name,Wa,ja.isShared?vb:f,G,G,ja.isShared?D:N):le.GHe("","",Wa,"",G,G)};le.GHe=function(G,ja,Wa,vb,f,D,N){f=void 0===f?null:f;D=void 0===D?null:D;N=void 0===
N?null:N;var fa=void 0===fa?null:fa;var Ia={},pb={};Wa?(Ia.root=le.vua(32,32),pb.root=le.vua(32,32)):(Ia.root=le.vua(20,20),pb.root=le.vua(20,20));return Object.assign(new Pe.a,{Id:G,ExternalId:f||G,MenuItemId:D||G,Command:"1904816141",Icon:vb,Image:Lf.a.Ge(16),ImageClass:N,LabelText:ja,FullIconStyle:Ia,PreviewIconStyle:pb,Alt:fa||ja})};le.vua=function(G,ja){var Wa={};Wa.width=G;Wa["min-width"]=G;Wa.height=ja;return Wa};Object(Yd.a)(le,"AutomateCommandRenderer",null,[]);Id.prototype.HLa=function(G){for(var ja=
0;ja<this.scripts.length;ja++)if(this.scripts[ja].id===G||this.scripts[ja].shareId===G)return ja;return-1};Id.prototype.sort=function(){this.F9f(this.scripts)};Id.prototype.im=function(G){return-1===this.HLa(G.id)?(this.scripts.push(G),!0):!1};Id.prototype.WZa=function(G){return-1===this.HLa(G.id)?(this.scripts=[G].concat(this.scripts),!0):!1};Id.prototype.Tuf=function(G){G=this.HLa(G.id);if(-1!==G){for(var ja=this.scripts[G].Lia();0<G;)this.scripts[G]=this.scripts[G-1],G--;this.scripts[0]=ja}};Id.prototype.qfa=
function(G){var ja=this.HLa(G.id);if(-1!==ja){var Wa=this.scripts[ja].shareId;this.scripts[ja]=G;this.scripts[ja].shareId=Wa}};Id.prototype.djc=function(G){var ja=this.HLa(G.id);return-1!==ja?G.name===this.scripts[ja].name:!1};Id.prototype.nja=function(G){G=this.HLa(G);return-1!==G?(this.scripts.splice(G,1),!0):!1};Id.prototype.clear=function(){this.scripts=[]};Id.prototype.getScripts=function(){return this.scripts};Id.prototype.Lw=function(G){G=this.HLa(G);return-1!==G?this.scripts[G]:null};Id.prototype.hD=
function(G){return 0<=G&&this.length>G?this.scripts[G]:null};Id.prototype.HXe=function(G){for(var ja=new Id([],this.F9f),Wa=0;Wa<this.scripts.length;Wa++){var vb=this.scripts[Wa];G.Lw(vb.id)||ja.im(vb)}return ja};Id.prototype.Rfb=function(){for(var G=[],ja=Cl(this.scripts),Wa=ja.next();!Wa.done;Wa=ja.next())G.push(Wa.value.ZYd());return G};uk.Object.defineProperties(Id.prototype,{length:{configurable:!0,enumerable:!0,get:function(){return this.scripts.length}}});Object(Yd.a)(Id,"ScriptCollection",
null,[]);var mh=b(195);xd.prototype.Lia=function(){return new xd(this.Aaa)};xd.prototype.ZYd=function(){return this.Aaa};uk.Object.defineProperties(xd.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this.Aaa.id}},shareId:{configurable:!0,enumerable:!0,get:function(){return this.Aaa.shareId},set:function(G){this.Aaa.shareId=G||null}},name:{configurable:!0,enumerable:!0,get:function(){return this.Aaa.name}},WJe:{configurable:!0,enumerable:!0,get:function(){return this.Aaa.dateLastPublished}},
body:{configurable:!0,enumerable:!0,get:function(){return this.Aaa.body}},description:{configurable:!0,enumerable:!0,get:function(){return this.Aaa.description}},Egf:{configurable:!0,enumerable:!0,get:function(){return this.Aaa.isCreator}},isShared:{configurable:!0,enumerable:!0,get:function(){return!!this.shareId&&0<this.shareId.length}}});Object(Yd.a)(xd,"ScriptCore",null,[]);var Qh=b(39);Am(Gc,Wd);Gc.prototype.$dc=function(G){switch(G){case "1":case "2":case "3":return this.Ms.hD(parseInt(G,10)-
1);default:return this.Ne.Yk.Lw(G)||this.Ne.Tm.Lw(G)||this.Ne.kg.Lw(G)||this.Ne.Oo.Lw(G)}};Gc.prototype.bdc=function(G,ja,Wa){var vb=null;if(this.Ne.eMa)switch(G){case "1":case "2":case "3":vb=this.Ms.hD(parseInt(G,10)-1);break;case "4":case "5":case "6":vb=of.a.C1?this.Ms.hD(parseInt(G,10)-1):this.Ms.Lw(G);break;default:vb=this.Ms.Lw(G)}Qh.a.isReactRibbonEnabled()?ja[Ya.a.GalleryButtonProps]=le.p6b(G,vb,2===Wa&&!of.a.C1):ja[Ya.a.InnerHTML]=le.d_e(vb);ja[Ya.a.Alt]=vb?vb.name:""};Gc.prototype.UB=function(G){this.Ms=
this.uIb();this.$.Cf();var ja=[];ja.push(Object.assign(new Nf.a,{name:"Operation",string:G}));ja.push(Object.assign(new Nf.a,{name:"HasReadRecentCachedScripts",bool:this.Ne.cxa}));ja.push(Object.assign(new Nf.a,{name:"ReadScriptsDone",bool:this.Ne.gMa}));ja.push(Object.assign(new Nf.a,{name:"ReadSamplesScriptsDone",bool:this.Ne.G7}));ja.push(Object.assign(new Nf.a,{name:"SamplesScriptCount",int64:this.Ne.Oo.length}));ja.push(Object.assign(new Nf.a,{name:"ReadRecentScriptsDone",bool:this.Ne.Nda}));
ja.push(Object.assign(new Nf.a,{name:"RecentScriptCount",int64:this.Ne.Yk.length}));ja.push(Object.assign(new Nf.a,{name:"ReadWorkbookScriptsDone",bool:this.Ne.Kt}));ja.push(Object.assign(new Nf.a,{name:"WorkbookScriptCount",int64:this.Ne.kg.length}));Ea.a(oi.a.bCd,!0,0,ja)};Gc.prototype.hfc=function(G){var ja=!1,Wa="",vb=new xd(G.scriptMetadata),f={Operation:"HandleRefreshRibbonGallery"};f.RefreshOperation=G.operationName;switch(G.operationName){case of.a.PKd:G=this.pyb(vb);Wa=G.message;ja=G.returnValue;
break;case of.a.NKd:G=this.nyb(vb);Wa=G.message;ja=G.returnValue;break;case of.a.MKd:G=this.myb(vb);Wa=G.message;ja=G.returnValue;break;case of.a.OKd:G=this.oyb(vb);Wa=G.message;ja=G.returnValue;break;case of.a.QRf:G=this.Vld(vb),Wa=G.message,ja=G.returnValue}(f.GalleryUpdated=ja)?(df.ULS.sendTraceTag(537170322,0,50,"AutomateCommandGallery: Calling UpdateToolbarsAndRibbons. Message: {0}",Wa),this.UB("RefreshGallery")):df.ULS.sendTraceTag(537170321,0,15,"AutomateCommandGallery: Something went wrong while trying to refresh ribbon gallery.  Message: {0}",
Wa);f.Message=Wa;df.ULS.sendTraceTag(537170320,0,50,fi.c(f))};Gc.prototype.uIb=function(){for(var G=new Id([],function(){}),ja=this.Ne.kg?this.Ne.kg.length:0,Wa=this.Ne.Yk?this.Ne.Yk.length:0,vb=this.Ne.Oo?this.Ne.Oo.length:0,f=0,D=of.a.C1?6:of.a.XHd,N=0;N<D;N++)if(N<ja)G.im(this.Ne.kg.hD(N));else if(N-ja+f<Wa){var fa=this.Ne.Yk.hD(N-ja+f);this.Ne.kg.Lw(fa.id)?(f++,N--):G.im(fa)}else N-ja-Wa+f<vb&&G.im(this.Ne.Oo.hD(N-ja+f-Wa));return G};Gc.prototype.pyb=function(G){if(this.Ne.Yk.WZa(G))var ja="";
else{ja="";var Wa=G.Lia();this.Ne.kg.qfa(Wa);this.Ne.kg.sort();this.Ne.Yk.qfa(G)}return{returnValue:!0,message:ja}};Gc.prototype.nyb=function(G){this.Ne.kg.nja(G.id);return this.Ne.Yk.nja(G.id)?{returnValue:!0,message:""}:{returnValue:!1,message:"Deleting a script but script could not be found in recent script collection."}};Gc.prototype.myb=function(G){var ja=G.Lia();ja.shareId=null;this.Ne.Yk.WZa(ja);return this.Ne.kg.im(G)?(this.Ne.kg.sort(),{returnValue:!0,message:""}):{returnValue:!1,message:"Could not attach a script that is already attached."}};
Gc.prototype.oyb=function(G){return this.Ne.kg.nja(G.id)?{returnValue:!0,message:""}:{returnValue:!1,message:"Detaching a script but the script could not be found in the collection."}};Gc.prototype.Vld=function(G){var ja=G.Lia(),Wa=!1;this.Ne.kg.djc(ja)&&(this.Ne.kg.qfa(ja),this.Ne.kg.sort(),Wa=!0);this.Ne.Yk.WZa(G)?Wa=!0:this.Ne.Yk.djc(G)&&(this.Ne.Yk.qfa(G),this.Ne.Yk.Tuf(G),Wa=!0);return{returnValue:Wa,message:""}};Object(Yd.a)(Gc,"AutomateCommandGallery",Wd,[]);var Ji=b(84);Object(Yd.a)(fc,"AutomateCommandLicensingBase",
null,[]);Object(Yd.a)(xf,"BoolResultWrapper",null,[]);Am(Af,fc);Af.prototype.ZBe=function(){var G=this,ja=ih.a.Ra.Ob,Wa=[];return new Promise(function(vb){Ji.a.instance.qc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(f){f.isFeatureEnabled("ExcelOfficeScripting",!1).then(function(D){Wa.push(Object.assign(new Nf.a,{name:"IsLicensed",bool:D}));Ea.a(oi.a.zxf,!0,si.getElapsedMilliseconds(ja,ih.a.Ra.Ob),Wa);G.zy=new xf(D,!0);vb(D)}).catch(function(D){Wa.push(Object.assign(new Nf.a,
{name:"IsLicensed",bool:!1}));Wa.push(Object.assign(new Nf.a,{name:"Error",string:D.toString()}));Wa.push(Object.assign(new Nf.a,{name:"ErrorCode",string:"exception"}));Ea.a(oi.a.zxf,!1,si.getElapsedMilliseconds(ja,ih.a.Ra.Ob),Wa);G.zy=new xf(!1,!1,void 0,"exception",D.toString());vb(!1)})})})};Object(Yd.a)(Af,"AutomateCommandLicensing",fc,[]);var Zi=b(1356),sj=b(1354),Aj=b(1353),bi=b(1355);qe.taskPaneWidth="TaskPaneWidth";qe.sourceLocationOverrideResourceId="SourceLocationOverrideResourceId";qe.ql=
"TaskPaneTitle";qe.Xj="IconCssClass";qe.hYd="TaskPaneIconUrl";qe.qT="TaskPaneIconId";qe.CI="NonPersistedSettings";qe.onTaskPaneClose="OnTaskPaneClose";qe.YVc="ActionArgs";Object(Yd.a)(qe,"PropertyNames",null,[]);var fj=b(161),Qj=b(186),hk=b(323),Qi=b(5);Am(he,Wd);he.prototype.$dc=function(G){switch(G){case "1":case "2":case "3":return this.Ms.hD(parseInt(G,10)-1);default:return this.automateCommandManager.Yk.Lw(G)||this.automateCommandManager.kg.Lw(G)||this.automateCommandManager.Oo.Lw(G)}};he.prototype.bdc=
function(G,ja,Wa){var vb=null;if(this.automateCommandManager.eMa)switch(G){case "1":case "2":case "3":vb=this.Ms.hD(parseInt(G,10)-1);break;default:vb=this.Ms.Lw(G)}Qh.a.isReactRibbonEnabled()?ja[Ya.a.GalleryButtonProps]=le.p6b(G,vb,2===Wa):ja[Ya.a.InnerHTML]=le.d_e(vb);ja[Ya.a.Alt]=vb?vb.name:""};he.prototype.UB=function(G){this.Ms=this.uIb();this.$.Cf();var ja=[];ja.push(Object.assign(new Nf.a,{name:"Operation",string:G}));ja.push(Object.assign(new Nf.a,{name:"HasReadRecentCachedScripts",bool:this.automateCommandManager.cxa}));
ja.push(Object.assign(new Nf.a,{name:"ReadScriptsDone",bool:this.automateCommandManager.gMa}));ja.push(Object.assign(new Nf.a,{name:"ReadSamplesScriptsDone",bool:this.automateCommandManager.G7}));ja.push(Object.assign(new Nf.a,{name:"SamplesScriptCount",int64:this.automateCommandManager.Oo.length}));ja.push(Object.assign(new Nf.a,{name:"ReadRecentScriptsDone",bool:this.automateCommandManager.Nda}));ja.push(Object.assign(new Nf.a,{name:"RecentScriptCount",int64:this.automateCommandManager.Yk.length}));
ja.push(Object.assign(new Nf.a,{name:"ReadWorkbookScriptsDone",bool:this.automateCommandManager.Kt}));ja.push(Object.assign(new Nf.a,{name:"WorkbookScriptCount",int64:this.automateCommandManager.kg.length}));Ea.a(oi.a.bCd,!0,0,ja)};he.prototype.hfc=function(G){var ja=!1,Wa="",vb=new xd(G.scriptMetadata),f={Operation:"HandleRefreshRibbonGallery"};f.RefreshOperation=G.operationName;switch(G.operationName){case of.a.PKd:G=this.pyb(vb);Wa=G.message;ja=G.returnValue;break;case of.a.NKd:G=this.nyb(vb);
Wa=G.message;ja=G.returnValue;break;case of.a.MKd:G=this.myb(vb);Wa=G.message;ja=G.returnValue;break;case of.a.OKd:G=this.oyb(vb);Wa=G.message;ja=G.returnValue;break;case of.a.QRf:G=this.Vld(vb),Wa=G.message,ja=G.returnValue}(f.GalleryUpdated=ja)?(df.ULS.sendTraceTag(537170319,0,50,"AutomateCommandManager: Calling UpdateToolbarsAndRibbons. Message: {0}",Wa),this.UB("RefreshGallery")):df.ULS.sendTraceTag(537170318,0,15,"AutomateCommandManager: Something went wrong while trying to refresh ribbon gallery.  Message: {0}",
Wa);f.Message=Wa;df.ULS.sendTraceTag(537170317,0,50,fi.c(f))};he.prototype.uIb=function(){for(var G=new Id([],function(){}),ja=this.automateCommandManager.kg?this.automateCommandManager.kg.length:0,Wa=this.automateCommandManager.Yk?this.automateCommandManager.Yk.length:0,vb=this.automateCommandManager.Oo?this.automateCommandManager.Oo.length:0,f=0,D=0;D<of.a.XHd;D++)if(D<ja)G.im(this.automateCommandManager.kg.hD(D));else if(D-ja+f<Wa){var N=this.automateCommandManager.Yk.hD(D-ja+f);this.automateCommandManager.kg.Lw(N.id)?
(f++,D--):G.im(N)}else D-ja-Wa+f<vb&&G.im(this.automateCommandManager.Oo.hD(D-ja+f-Wa));return G};he.prototype.pyb=function(G){if(this.automateCommandManager.Yk.WZa(G))var ja="";else{ja="";var Wa=G.Lia();this.automateCommandManager.kg.qfa(Wa);this.automateCommandManager.kg.sort();this.automateCommandManager.Yk.qfa(G)}return{returnValue:!0,message:ja}};he.prototype.nyb=function(G){this.automateCommandManager.kg.nja(G.id);return this.automateCommandManager.Yk.nja(G.id)?{returnValue:!0,message:""}:{returnValue:!1,
message:"Deleting a script but script could not be found in recent script collection."}};he.prototype.myb=function(G){var ja=G.Lia();ja.shareId=null;this.automateCommandManager.Yk.WZa(ja);return this.automateCommandManager.kg.im(G)?(this.automateCommandManager.kg.sort(),{returnValue:!0,message:""}):{returnValue:!1,message:"Could not attach a script that is already attached."}};he.prototype.oyb=function(G){return this.automateCommandManager.kg.nja(G.id)?{returnValue:!0,message:""}:{returnValue:!1,
message:"Detaching a script but the script could not be found in the collection."}};he.prototype.Vld=function(G){var ja=G.Lia(),Wa=!1;this.automateCommandManager.kg.djc(ja)&&(this.automateCommandManager.kg.qfa(ja),this.automateCommandManager.kg.sort(),Wa=!0);this.automateCommandManager.Yk.WZa(G)?Wa=!0:this.automateCommandManager.Yk.djc(G)&&(this.automateCommandManager.Yk.qfa(G),this.automateCommandManager.Yk.Tuf(G),Wa=!0);return{returnValue:Wa,message:""}};Object(Yd.a)(he,"AutomateCommandGalleryOld",
Wd,[]);var Xj=b(21);Lc.G9f=function(G){G.sort(function(ja,Wa){return Wa.WJe-ja.WJe})};Lc.zNb=function(G){G.sort(function(ja,Wa){return Xj.a.compare(ja.name,Wa.name,!0)})};Lc.f7e=function(G){var ja;var Wa=ja=null;if(G){var vb=G.indexOf(":");if(-1!==vb)return ja=G.substr(0,vb),Wa=G.substr(vb+1),{returnValue:!0,eXd:ja,shareId:Wa}}return{returnValue:!1,eXd:ja,shareId:Wa}};Lc.a2h=function(G,ja){var Wa={};Wa[of.a.Vkg]=encodeURIComponent(G.workbookContext.WorkbookFileName);Wa[of.a.E_f]=ja.Rfb();return fi.c(Wa)};
Lc.wQf=function(G,ja){return Th.TaskExtensions.yaa(ja.oLa(of.a.mhb),function(Wa){Wa=Wa.result;if(""!==Wa){Wa=fi.b(Wa);var vb=Wa[of.a.E_f];if(Wa[of.a.Vkg]===encodeURIComponent(G.workbookContext.WorkbookFileName)){Wa=new Id([],function(D){Lc.zNb(D)});vb=Cl(vb);for(var f=vb.next();!f.done;f=vb.next())Wa.im(new xd(f.value));Wa.sort();return Wa}}},G.la,3)};uk.Object.defineProperties(Lc.prototype,{eMa:{configurable:!0,enumerable:!0,get:function(){var G=of.a.uL?this.cxa:this.D5;return this.G7||G||this.gMa}},
gMa:{configurable:!0,enumerable:!0,get:function(){return(of.a.uL?this.Nda:this.E7)&&this.Kt&&this.G7}}});Object(Yd.a)(Lc,"AutomateCommandStorageBase",null,[]);Object(Yd.a)(Ec,"UserInfo",null,[]);var bj=b(561),ch=b(173),$i=b(83),ci=b(288);Object(Yd.a)(ge,"LaunchSDXParams",null,[]);Object(Yd.a)(te,"RunfromButtonParameters",null,[]);var Mj=b(164),Gj=b(118),ik=b(29),jk=b(994),zk=b(49),qk=b(97),Hj=b(44),Ik=b(174);me.prototype.Lzj=function(G){of.a.$q?this.Ne.Tm=G:this.The=G};me.prototype.Kzj=function(G){of.a.$q?
this.Ne.kg=G:this.qge=G};me.prototype.Ozj=function(G){of.a.$q?this.Ne.Oo=G:this.wje=G};me.prototype.Mzj=function(G){this.Ne.Yk=G};me.prototype.RMb=function(G){var ja=ig.AFrameworkApplication.ha.ra("IsO365CommercialHost"),Wa="",vb="",f=!1;var D=!(this.qw.zy&&this.qw.zy.isSuccess&&this.qw.zy.value&&(!this.bB||!this.bB.isSuccess));this.qw.zy&&!this.qw.zy.isSuccess?(vb=this.qw.zy.errorCode,Wa=this.qw.zy.errorMessage):this.bB&&!this.bB.isSuccess&&(vb=this.bB.errorCode,Wa=this.bB.errorMessage);var N=[];
N.push(Object.assign(new Nf.a,{name:"IsScriptingEnabled",bool:this.tca}));N.push(Object.assign(new Nf.a,{name:"IsValidHost",bool:ja}));N.push(Object.assign(new Nf.a,{name:"IsUserLicensed",bool:this.qw.zy?this.qw.zy.value:!1}));N.push(Object.assign(new Nf.a,{name:"IsAdminSwitchOn",bool:this.bB?this.bB.value:!1}));N.push(Object.assign(new Nf.a,{name:"ShowTab",bool:this.tca}));N.push(Object.assign(new Nf.a,{name:"ServiceChecked",bool:!G}));this.tca&&Qh.a.kya(this.$)&&(G=Mj.a(this.$),(null===G||void 0===
G?0:G.Um)?(N.push(Object.assign(new Nf.a,{name:"RibbonType",string:"React"})),G.Um.TGj(Qi.a.qIb),ja=["AutomateRecorder","AutomateNewScript","AutomateGallery","AutomateAllScripts"],Df.EwaSettings.getBooleanFeatureGate(of.a.gwf,!1)?G.Um.XLb(["AutomateAutomateTask"],!of.a.dCd):(G.Um.XLb(ja,!1),of.a.dCd&&G.Um.XLb(["AutomateAutomateTask"],!1)),Df.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&!Df.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",
!1)&&(f=!0)):(vb="ribbon_manager_error",Wa="The RibbonManager or RibbonUser is null"));N.push(Object.assign(new Nf.a,{name:"Error",string:Wa}));N.push(Object.assign(new Nf.a,{name:"ErrorCode",string:vb}));Ea.a(oi.a.SKi,D,si.getElapsedMilliseconds(this.initTime,ih.a.Ra.Ob),N);this.$.heb("automateTab",!1);return Promise.resolve(f)};me.prototype.nd=function(G,ja){if(!ja)return!1;ja.MenuItems=this.nRg.QMh(ja.MenuId);return!0};me.prototype.y3i=function(){var G=this;if(this.Yxa)if(of.a.uL)this.Ne.tQf(this.CQ).continueWith(function(vb){vb.result&&
G.CQ.UB(of.a.uRa)});else if(of.a.$q)this.Ne.naj(this.CQ);else{var ja=ih.a.Ra.Ob,Wa=[];Th.TaskExtensions.Ba(this.indexedDB.oLa(of.a.gRa),function(vb){var f=!G.E7||!G.Tm.length;vb=vb.result;Wa.push(Object.assign(new Nf.a,{name:"ExistingScriptCount",int64:G.Tm.length}));if(""!==vb)if(vb=fi.b(vb),Wa.push(Object.assign(new Nf.a,{name:"CachedScriptCount",int64:vb.length})),f){for(var D=Cl(vb),N=D.next();!N.done;N=D.next())G.Tm.im(new xd(N.value));G.Tm.sort();G.D5=!0;G.acb=0<vb.length;Ea.a(oi.a.$Eb,f,si.getElapsedMilliseconds(ja,
ih.a.Ra.Ob),Wa);G.UB("CachedScripts")}else Ea.a(oi.a.$Eb,f,si.getElapsedMilliseconds(ja,ih.a.Ra.Ob),Wa);else Ea.a(oi.a.$Eb,f,si.getElapsedMilliseconds(ja,ih.a.Ra.Ob),Wa)},this.$.la,3)}cc(this.$)?this.q6e(Object.assign(new L.a,{IsSuccess:!0,Token:"FakeToken"})):this.vta.sdc().then(function(vb){G.q6e(vb)})};me.prototype.bdc=function(G,ja,Wa){if(of.a.uL)this.CQ.bdc(G,ja,Wa);else{var vb=null;if(this.eMa)switch(G){case "1":case "2":case "3":vb=this.Ms.hD(parseInt(G,10)-1);break;case "4":case "5":case "6":vb=
of.a.C1?this.Ms.hD(parseInt(G,10)-1):this.Ms.Lw(G);break;default:vb=this.Ms.Lw(G)}ja[Ya.a.GalleryButtonProps]=le.p6b(G,vb,2===Wa&&!of.a.C1);ja[Ya.a.Alt]=vb?vb.name:""}};me.prototype.hfc=function(G){if(of.a.uL)this.CQ.hfc(G);else{var ja=!1,Wa="",vb=new xd(G.scriptMetadata),f={Operation:"HandleRefreshRibbonGallery"};f.RefreshOperation=G.operationName;switch(G.operationName){case of.a.PKd:G=this.pyb(vb);Wa=G.message;ja=G.returnValue;break;case of.a.NKd:G=this.nyb(vb);Wa=G.message;ja=G.returnValue;break;
case of.a.MKd:G=this.myb(vb);Wa=G.message;ja=G.returnValue;break;case of.a.OKd:G=this.oyb(vb),Wa=G.message,ja=G.returnValue}(f.GalleryUpdated=ja)?(df.ULS.sendTraceTag(537170313,0,50,"AutomateCommandManager: Calling UpdateToolbarsAndRibbons. Message: {0}",Wa),this.UB("RefreshGallery")):df.ULS.sendTraceTag(537170312,0,15,"AutomateCommandManager: Something went wrong while trying to refresh ribbon gallery.  Message: {0}",Wa);f.Message=Wa;df.ULS.sendTraceTag(537170311,0,50,fi.c(f))}};me.prototype.K9h=
function(G,ja,Wa,vb){this.$.Br(null,!1,1023)&&(G=new te(of.a.aZf,G,ja,Wa,this.tca,vb),this.sqb.qyb(G))};me.prototype.F$e=function(G,ja,Wa){G=new te(of.a.L0j,G,ja,Wa,this.tca);this.sqb.qyb(G)};me.prototype.C7h=function(G){this.sqb.vld(of.a.fHj,G)};me.prototype.B7h=function(G){this.sqb.vld(of.a.X5g,G)};me.prototype.D7h=function(G){this.sqb.vld(of.a.pLj,G)};me.prototype.zwi=function(G,ja){var Wa=zk.b().yi(G),vb=[];vb.push(Object.assign(new Nf.a,{name:"SessionId",string:this.$.ya.UserSessionId}));vb.push(Object.assign(new Nf.a,
{name:"MenuItemId",string:ja}));vb.push(Object.assign(new Nf.a,{name:"WorkbookScriptCount",int64:this.kg.length}));vb.push(Object.assign(new Nf.a,{name:"PublishedScriptCount",int64:this.Tm.length}));vb.push(Object.assign(new Nf.a,{name:"RecentScriptCount",int64:this.Yk.length}));vb.push(Object.assign(new Nf.a,{name:"Command",string:Wa}));ja=ja?this.$dc(ja):null;if(Wa=this.qXh(G,Wa,ja))vb.push(Object.assign(new Nf.a,{name:of.a.kaa,string:Wa.aAa.Fr[of.a.kaa]})),Zi.a.instance.GOa(Wa.VDh,"Taskpane",Wa.rIa,
Wa.Gnd,Wa.aAa),1904816141===G&&(vb.push(Object.assign(new Nf.a,{name:"ScriptId",string:ja.id})),vb.push(Object.assign(new Nf.a,{name:"ShareId",string:ja.shareId})),vb.push(Object.assign(new Nf.a,{name:"IsPreviewGallery",bool:of.a.uL?!!this.CQ.Ms.Lw(ja.id):!!this.Ms.Lw(ja.id)})),vb.push(Object.assign(new Nf.a,{name:"IsOwner",bool:ja.Egf||!!this.Tm.Lw(ja.id)})),this.$.Cf());Ea.a(oi.a.PKi,void 0,void 0,vb)};me.prototype.qXh=function(G,ja,Wa){var vb=null,f=of.a.Wr,D=new sj.a(of.a.Zbf,of.a.$Ye,of.a.locale),
N=new Aj.a(of.a.solutionId,OSF.StoreType.Sdx,OSF.StoreType.Sdx,of.a.dQd),fa=new bi.a;fa.Fr.AdminPolicyForFeedback=fi.c(this.aHa);fa.Fr.DocumentHostInfo=jh.a.Kc(this.$.ya.DocumentHostInfo);fa.Fr.CodeEditorUrl=of.a.Wwb(this.$);fa.Fr.MakerTestService=Df.EwaSettings.getBooleanFeatureGate(of.a.PDb,!1);fa.Fr[of.a.tYf]=of.a.L4a(this.$);fa.Fr.StorageModePreference=this.W$f||"";fa.Fr.Source="Ribbon";fa.Fr.IsTeams=hg.a.Yla;fa.Fr[of.a.Mbg]=jh.a.Kc(f);fa.Fr[of.a.yxe]=this.$.yxf?"true":"false";fa.Fr[of.a.kaa]=
Qj.a.create().toString();var Ia=jc(this.$),pb=pd(this.$);fa.wi.HeaderCssClass=Ia;fa.wi.TitleCssClass=pb;fa.Fr[of.a.Waf]=Ia;fa.Fr[of.a.Scg]=pb;Ia={};Ia.ribbonCommand=ja;Ia[of.a.V$f]=this.vta.getAuthContext();Ia[of.a.gRa]=this.acb?this.Tm.Rfb():null;Ia[of.a.mhb]=this.IAa?this.kg.Rfb():null;of.a.uL&&(Ia[of.a.uRa]=this.Ne.bKd?this.Yk.Rfb():null);fa.Fr[of.a.fff]=jh.a.Kc(Ia);ja={};hc(this.$,ja);fa.Fr[of.a.kYe]=jh.a.Kc(ja);switch(G){case -45542983:fa.Fr.Script="";fa.Fr.Destination="Editor";fa.Fr.IsOwner=
!0;fa.wi[qe.ql]=Ff.a.instance.fa(2068);fa.wi[qe.taskPaneWidth]=f;fa.wi[qe.sourceLocationOverrideResourceId]=of.a.Wwb(this.$);vb=of.a.W3c;break;case -1342227603:fa.wi[qe.ql]=Ff.a.instance.fa(2070);fa.wi[qe.taskPaneWidth]=f;fa.wi[qe.sourceLocationOverrideResourceId]=of.a.B5e(this.$);break;case 971811139:case 1606046412:fa.Fr.Script="";fa.Fr.Destination="BackStage";fa.Fr.IsOwner=!0;fa.wi[qe.ql]=Ff.a.instance.fa(2068);fa.wi[qe.taskPaneWidth]=f;fa.wi[qe.sourceLocationOverrideResourceId]=of.a.Wwb(this.$);
vb=of.a.W3c;break;case 1845457202:fa.wi[qe.ql]=Ff.a.instance.fa(2069);fa.wi[qe.taskPaneWidth]=f;fa.wi[qe.sourceLocationOverrideResourceId]=of.a.S5e(this.$);vb=of.a.pqj;break;case 1904816141:if(Wa)fa.Fr.Script=jh.a.Kc(Wa.ZYd()),fa.Fr.Destination="Details",fa.Fr.IsOwner=Wa.Egf||!!this.Tm.Lw(Wa.id),fa.wi[qe.ql]=Ff.a.instance.fa(2068),fa.wi[qe.taskPaneWidth]=f,fa.wi[qe.sourceLocationOverrideResourceId]=of.a.Wwb(this.$),vb=of.a.W3c;else return null;break;default:return null}return new ge(D,N,fa,vb)};me.prototype.aOh=
function(){var G=this;Ji.a.instance.qc("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(function(ja){G.aHa.FeedbackEnabled=!0;G.aHa.ScreenshotEnabled=!0;G.aHa.EmailEnabled=!0;ja.AK("Enabled").then(function(Wa){G.aHa.FeedbackEnabled=Wa},function(){});ja.AK("IncludeScreenshot").then(function(Wa){G.aHa.ScreenshotEnabled=Wa},function(){});ja.AK("IncludeEmail").then(function(Wa){G.aHa.EmailEnabled=Wa},function(){})})};me.prototype.p$h=function(G){var ja=this,Wa=ih.a.Ra.Ob,vb=[];
if(!G||!G.IsSuccess){var f=G?G.ErrorCode:"need_token";G=G?G.ErrorMessage:"No Access Token";vb.push(Object.assign(new Nf.a,{name:"ServiceChecked",bool:!1}));vb.push(Object.assign(new Nf.a,{name:"Error",string:G}));vb.push(Object.assign(new Nf.a,{name:"ErrorCode",string:f}));Ea.a(oi.a.$Bd,!1,si.getElapsedMilliseconds(Wa,ih.a.Ra.Ob),vb);this.bB=new xf(!1,!1,void 0,f,G);return Promise.resolve(!1)}vb.push(Object.assign(new Nf.a,{name:"ServiceChecked",bool:!0}));Mb(this.$,G.Token);return makerstorage.getUserPermissions(this.$.ya.UserSessionId).then(function(D){ja.bB=
new xf(D.OfficeScriptingEnabled,!0);ja.X0c(of.a.gcc(ja.$),D.OfficeScriptingEnabled);vb.push(Object.assign(new Nf.a,{name:"IsEnabled",bool:ja.bB.value}));Ea.a(oi.a.$Bd,!0,si.getElapsedMilliseconds(Wa,ih.a.Ra.Ob),vb);return Promise.resolve(ja.bB.value)}).catch(function(D){Object.getType(D)===makerstorage.StorageServiceError?(vb.push(Object.assign(new Nf.a,{name:"Error",string:D.message})),vb.push(Object.assign(new Nf.a,{name:"ErrorCode",string:String.format("makerstorage_{0}_{1}",D.errorCode.toString(),
D.status.toString())}))):(vb.push(Object.assign(new Nf.a,{name:"Error",string:D.toString()})),vb.push(Object.assign(new Nf.a,{name:"ErrorCode",string:"exception"})));Ea.a(oi.a.$Bd,!1,si.getElapsedMilliseconds(Wa,ih.a.Ra.Ob),vb);ja.bB=new xf(!1,!1,void 0,"exception",D.toString());return Promise.resolve(!1)})};me.prototype.cKd=function(G){var ja=this;if(of.a.$q)return this.Ne.cKd(G,this.CQ);var Wa=new fj.a,vb=jf(this.$);return dc(this.$,function(f){if((f=f.Result)&&200===f.ResponseStatusCode)f=f.ResponseBody.join(""),
f=JSON.parse(f),G(ja.pGd(f.value)),Wa.setResult(!0);else{f=f?"RichApi_"+f.ResponseStatusCode:"RichApiError";var D=[];D.push(Object.assign(new Nf.a,{name:"Error",string:"Failed to read shared script ids from document"}));D.push(Object.assign(new Nf.a,{name:"ErrorCode",string:f}));ja.Kt=!0;ja.eV(ih.a.Ra.Ob,0,D);Wa.setResult(!1)}},function(f){f=Gj.a.mg(f.data);df.ULS.sendTraceTag(537170310,0,15,"REST API failed to fetch the CustomXmlPart for Automate Gallery. {0}",ik.a.Wc(f));var D=[];D.push(Object.assign(new Nf.a,
{name:"Error",string:"Failure using rich api: "+f}));D.push(Object.assign(new Nf.a,{name:"ErrorCode",string:"RichApiFailure"}));ja.Kt=!0;ja.eV(ih.a.Ra.Ob,0,D);Wa.setResult(!1)},vb,Wa)};me.prototype.q6e=function(G){var ja=this;this.Kjd();of.a.uL?this.Ne.A0h(G,this.CQ,this.cache):this.$_h(G);this.cKd(function(Wa){ja.Xjd(Wa,G)})};me.prototype.Kjd=function(){if(of.a.$q)this.Ne.Kjd(this.CQ);else{var G={};of.a.C1&&(G.id="samples-6",G.name=Ff.a.instance.fa(2085),this.Oo.im(new xd(G)),G.id="samples-8",G.name=
Ff.a.instance.fa(2086),this.Oo.im(new xd(G)));G.id="samples-2";G.name=Ff.a.instance.fa(2082);this.Oo.im(new xd(G));G.id="samples-4";G.name=Ff.a.instance.fa(2083);this.Oo.im(new xd(G));G.id="samples-5";G.name=Ff.a.instance.fa(2084);this.Oo.im(new xd(G));of.a.C1&&(G.id="samples-9",G.name=Ff.a.instance.fa(2087),this.Oo.im(new xd(G)));this.G7=!0;this.UB("SampleScripts")}};me.prototype.$_h=function(G){var ja=this,Wa=ih.a.Ra.Ob,vb=[];if(G&&G.IsSuccess){Mb(this.$,G.Token);var f=qj.a.create().toString();
vb.push(Object.assign(new Nf.a,{name:"CorrelationId",string:f}));makerstorage.getScripts(f).then(function(D){vb.push(Object.assign(new Nf.a,{name:"HasReadCachedScripts",bool:ja.D5}));ja.Tm.clear();D=Cl(D);for(var N=D.next();!N.done;N=D.next())ja.Tm.im(new xd(N.value));ja.Tm.sort();ja.acb=!0;ja.E7=!0;ja.Yxa&&(D=jh.a.Kc(ja.Tm.Rfb()),ja.indexedDB.wdb(new jk.a(of.a.gRa,D)));vb.push(Object.assign(new Nf.a,{name:"ScriptCount",int64:ja.Tm.length}));Ea.a(oi.a.aFb,!0,si.getElapsedMilliseconds(Wa,ih.a.Ra.Ob),
vb);ja.UB(of.a.gRa)}).catch(function(D){Object.getType(D)===makerstorage.StorageServiceError?(vb.push(Object.assign(new Nf.a,{name:"Error",string:D.message})),vb.push(Object.assign(new Nf.a,{name:"ErrorCode",string:String.format("makerstorage_{0}_{1}",D.errorCode.toString(),D.status.toString())})),17===D.errorCode&&ja.cache.PLd(of.a.gcc(ja.$))):(vb.push(Object.assign(new Nf.a,{name:"Error",string:D.toString()})),vb.push(Object.assign(new Nf.a,{name:"ErrorCode",string:"exception"})));Ea.a(oi.a.aFb,
!1,si.getElapsedMilliseconds(Wa,ih.a.Ra.Ob),vb);ja.E7=!0;ja.UB(of.a.gRa)})}else f=G?G.ErrorCode:"need_token",G=G?G.ErrorMessage:"No Access Token",vb.push(Object.assign(new Nf.a,{name:"ServiceChecked",bool:!1})),vb.push(Object.assign(new Nf.a,{name:"Error",string:G})),vb.push(Object.assign(new Nf.a,{name:"ErrorCode",string:f})),Ea.a(oi.a.aFb,!1,si.getElapsedMilliseconds(Wa,ih.a.Ra.Ob),vb),this.E7=!0,this.UB(of.a.gRa)};me.prototype.Xjd=function(G,ja){var Wa=this;if(of.a.$q)this.Ne.Xjd(G,ja,this.CQ);
else{var vb=ih.a.Ra.Ob,f=0,D=0;this.Kt=f===G.count;var N=[];N.push(Object.assign(new Nf.a,{name:"ScriptIds",int64:G.count}));if(G.count)if(ja&&ja.IsSuccess){Mb(this.$,ja.Token);var fa={};ja=Cl(G);for(var Ia=ja.next();!Ia.done;fa={xhb:fa.xhb},Ia=ja.next())Ia=Ia.value,fa.xhb=qj.a.create().toString(),makerstorage.getSharedScript(Ia.value,fa.xhb).then(function(pb){return function(Wb){var Nc=[];Nc.push(Object.assign(new Nf.a,{name:"BodySize",int64:Wb.body.length}));Nc.push(Object.assign(new Nf.a,{name:"CorrelationId",
string:pb.xhb}));Ea.a(oi.a.woc,!0,si.getElapsedMilliseconds(vb,ih.a.Ra.Ob),Nc);f++;Wb=new xd(Wb);Wb.shareId=G.pa(Wb.id);Wa.kg.im(Wb);Wa.Kt=f===G.count;Wa.IAa=!0;Wa.eV(vb,D,N)}}(fa)).catch(function(pb){return function(Wb){var Nc=[];Object.getType(Wb)===makerstorage.StorageServiceError?(N.push(Object.assign(new Nf.a,{name:"Error",string:Wb.message})),N.push(Object.assign(new Nf.a,{name:"ErrorCode",string:String.format("makerstorage_{0}_{1}",Wb.errorCode.toString(),Wb.status.toString())}))):(Nc.push(Object.assign(new Nf.a,
{name:"Error",string:Wb.toString()})),Nc.push(Object.assign(new Nf.a,{name:"ErrorCode",string:"exception"})));Nc.push(Object.assign(new Nf.a,{name:"CorrelationId",string:pb.xhb}));Ea.a(oi.a.woc,!1,si.getElapsedMilliseconds(vb,ih.a.Ra.Ob),Nc);f++;D++;Wa.Kt=f===G.count;Wa.eV(vb,D,N)}}(fa))}else fa=ja?ja.ErrorCode:"need_token",ja=ja?ja.ErrorMessage:"No Access Token",N.push(Object.assign(new Nf.a,{name:"Error",string:ja})),N.push(Object.assign(new Nf.a,{name:"ErrorCode",string:fa})),this.Kt=!0,this.eV(vb,
D,N);else this.Kt=this.IAa=!0,this.eV(vb,D,N)}};me.prototype.eV=function(G,ja,Wa){this.Kt&&(Wa.push(Object.assign(new Nf.a,{name:"ScriptCount",int64:this.kg.length})),Wa.push(Object.assign(new Nf.a,{name:"ScriptErrorCount",int64:ja})),Ea.a(oi.a.Bxf,!ja,si.getElapsedMilliseconds(G,ih.a.Ra.Ob),Wa),this.kg.sort(),this.UB(of.a.mhb))};me.prototype.pGd=function(G){var ja=new qk.a;if(G=me.$ua.parseFromString(G,"text/xml").querySelector('[id="script-ids-node-id"]')){G=G.getElementsByTagName("scriptId");for(var Wa=
{},vb=0;vb<G.length;Wa={yRb:Wa.yRb,uRb:Wa.uRb,oRb:Wa.oRb},vb++)Wa.yRb=G[vb].getAttribute("id"),Wa.yRb&&(Wa.uRb=void 0,Wa.oRb=void 0,function(f){return function(){var D=Lc.f7e(f.yRb);f.uRb=D.eXd;f.oRb=D.shareId;return D}}(Wa)().returnValue&&ja.ia(Wa.uRb,Wa.oRb))}return ja};me.prototype.$dc=function(G){if(of.a.uL)return this.CQ.$dc(G);switch(G){case "1":case "2":case "3":return this.Ms.hD(parseInt(G,10)-1);default:return!of.a.C1||"4"!==G&&"5"!==G&&"6"!==G?this.Tm.Lw(G)||this.kg.Lw(G)||this.Oo.Lw(G):
this.Ms.hD(parseInt(G,10)-1)}};me.prototype.pyb=function(G){if(this.Tm.im(G)){this.Tm.sort();var ja=""}else{ja="";var Wa=G.Lia();this.kg.qfa(Wa);this.kg.sort();this.Tm.qfa(G);this.Tm.sort()}return{returnValue:!0,message:ja}};me.prototype.nyb=function(G){this.kg.nja(G.id);return this.Tm.nja(G.id)?{returnValue:!0,message:""}:{returnValue:!1,message:"Deleting a script but script could not be found in published collection."}};me.prototype.myb=function(G){var ja=G.Lia();ja.shareId=null;this.Tm.im(ja)&&
this.Tm.sort();return this.kg.im(G)?(this.kg.sort(),{returnValue:!0,message:""}):{returnValue:!1,message:"Could not attach a script that is already attached."}};me.prototype.oyb=function(G){return this.kg.nja(G.id)?{returnValue:!0,message:""}:{returnValue:!1,message:"Detaching a script but the script could not be found in the collection."}};me.prototype.UB=function(G){if(of.a.uL)this.CQ.UB(G);else{this.uIb();this.$.Cf();var ja=[];ja.push(Object.assign(new Nf.a,{name:"Operation",string:G}));ja.push(Object.assign(new Nf.a,
{name:"HasReadCachedScripts",bool:this.D5}));ja.push(Object.assign(new Nf.a,{name:"ReadScriptsDone",bool:this.gMa}));ja.push(Object.assign(new Nf.a,{name:"ReadSamplesScriptsDone",bool:this.G7}));ja.push(Object.assign(new Nf.a,{name:"SamplesScriptCount",int64:this.Oo.length}));ja.push(Object.assign(new Nf.a,{name:"ReadPublishedScriptsDone",bool:this.E7}));ja.push(Object.assign(new Nf.a,{name:"PublishedScriptCount",int64:this.Tm.length}));ja.push(Object.assign(new Nf.a,{name:"ReadWorkbookScriptsDone",
bool:this.Kt}));ja.push(Object.assign(new Nf.a,{name:"WorkbookScriptCount",int64:this.kg.length}));Ea.a(oi.a.bCd,!0,0,ja)}};me.prototype.uIb=function(){this.Ms=new Id([],function(){});for(var G=this.kg?this.kg.length:0,ja=this.Tm?this.Tm.length:0,Wa=this.Oo?this.Oo.length:0,vb=0,f=of.a.C1?6:of.a.XHd,D=0;D<f;D++)if(D<G)this.Ms.im(this.kg.hD(D));else if(D-G+vb<ja){var N=this.Tm.hD(D-G+vb);this.kg.Lw(N.id)?(vb++,D--):this.Ms.im(N)}else D-G-ja+vb<Wa&&this.Ms.im(this.Oo.hD(D-G+vb-ja))};me.prototype.X0c=
function(G,ja){if(of.a.$q)this.Ne.X0c(G,ja);else if(this.cache.xg()){var Wa={};Wa.TimeStamp=ih.a.Ra.Ob;Wa.IsEnabled=ja;this.cache.xyc(G,jh.a.Kc(Wa))}};me.prototype.sgd=function(G){if(of.a.$q)return this.Ne.sgd(G);var ja=!1,Wa=!1,vb=null;this.cache.xg()&&(G=fi.b(this.cache.o5a(G)))&&(Wa=G.IsEnabled,vb=new Date(G.TimeStamp),ja=!0);return new xf(Wa,ja,vb)};me.prototype.sNd=function(G){Df.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&!Df.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",
!1)&&(G?(Hj.PageLoadTrackingInfo.instance.R7(Qi.a.ZO,["automateTab"]),Hj.PageLoadTrackingInfo.instance.a1(Qi.a.ZO,["automateTab"]),Hj.PageLoadTrackingInfo.instance.HX(Qi.a.ZO,["automateTab"])):(Hj.PageLoadTrackingInfo.instance.WRa(Qi.a.ZO,["automateTab"]),Df.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CacheAutomateVisibility",!1)&&Ik.c()&&appChrome.api.dispatch(appChrome.actions.deactivateRibbonTab(Qi.a.qIb))))};uk.Object.defineProperties(me.prototype,{Tm:{configurable:!0,enumerable:!0,
get:function(){return of.a.$q?this.Ne.Tm:this.The}},kg:{configurable:!0,enumerable:!0,get:function(){return of.a.$q?this.Ne.kg:this.qge}},Oo:{configurable:!0,enumerable:!0,get:function(){return of.a.$q?this.Ne.Oo:this.wje}},Yk:{configurable:!0,enumerable:!0,get:function(){return this.Ne.Yk}},Ta:{configurable:!0,enumerable:!0,get:function(){return this.vSc}},G7:{configurable:!0,enumerable:!0,get:function(){return of.a.$q?this.Ne.G7:this.lie},set:function(G){of.a.$q?this.Ne.G7=G:this.lie=G}},Kt:{configurable:!0,
enumerable:!0,get:function(){return of.a.$q?this.Ne.Kt:this.nie},set:function(G){of.a.$q?this.Ne.Kt=G:this.nie=G}},Nda:{configurable:!0,enumerable:!0,get:function(){return this.Ne.Nda}},cxa:{configurable:!0,enumerable:!0,get:function(){return this.Ne.cxa}},gMa:{configurable:!0,enumerable:!0,get:function(){return of.a.$q?this.Ne.gMa:(of.a.uL?this.Nda:this.E7)&&this.Kt&&this.G7}},eMa:{configurable:!0,enumerable:!0,get:function(){return of.a.$q?this.Ne.eMa:(of.a.uL?this.cxa:this.D5)||this.gMa}},Ms:{configurable:!0,
enumerable:!0,get:function(){return of.a.$q||of.a.uL?this.CQ.Ms:this.Jhe},set:function(G){of.a.$q||of.a.uL?this.CQ.Ms=G:this.Jhe=G}},initTime:{configurable:!0,enumerable:!0,get:function(){return this.pug}},tca:{configurable:!0,enumerable:!0,get:function(){var G=!!this.qw.zy&&this.qw.zy.isSuccess&&this.qw.zy.value,ja=!!this.bB&&!this.bB.isSuccess,Wa=!!this.bB&&this.qw.zy.isSuccess&&this.bB.value;return this.kmf&&G&&(Wa||ja&&!hg.a.Ula(11))}},acb:{configurable:!0,enumerable:!0,get:function(){return of.a.$q?
this.Ne.acb:this.jie},set:function(G){of.a.$q?this.Ne.acb=G:this.jie=G}},IAa:{configurable:!0,enumerable:!0,get:function(){return of.a.$q?this.Ne.IAa:this.mie},set:function(G){of.a.$q?this.Ne.IAa=G:this.mie=G}},D5:{configurable:!0,enumerable:!0,get:function(){return of.a.$q?this.Ne.D5:this.S$d},set:function(G){of.a.$q?this.Ne.D5=G:this.S$d=G}},E7:{configurable:!0,enumerable:!0,get:function(){return of.a.$q?this.Ne.E7:this.kie},set:function(G){of.a.$q?this.Ne.E7=G:this.kie=G}},kmf:{configurable:!0,
enumerable:!0,get:function(){var G="TestHost"===this.$.ya.DocumentHostInfo.HostTier,ja=ig.AFrameworkApplication.ha.Wa("UserPrincipalName");ja=!ig.AFrameworkApplication.ha.ra("IsAnonymousUser")&&!!ja&&!ja.includes("ext#")&&!ja.includes("guest#");return!hg.a.dya&&(G||this.vta.g_c&&ja)}}});me.$ua=new DOMParser;Object(Yd.a)(me,"AutomateCommandManager",null,[976]);var Bj=b(1407),Ak=b(1358),Nj=b(243);rd.key="InsertAgaveClientSideParametersKey";Object(Yd.a)(rd,"InsertAgaveClientSideParameters",null,[]);
var cj=b(51),Jk=b(103),gj=b(20),hl=b(1168);$c.prototype.qyb=function(G){if(G.tca){var ja=[];ja.push(Object.assign(new Nf.a,{name:"isSharedRuntimeInstanceInitialized",bool:this.z8a}));ja.push(Object.assign(new Nf.a,{name:"actionName",string:G.actionName}));ja.push(Object.assign(new Nf.a,{name:of.a.kaa,string:G.clickId.toString()}));this.z8a?this.v0f(G):this.j8h(G);Ea.a(oi.a.QKi,void 0,void 0,ja)}};$c.prototype.vld=function(G,ja){var Wa={};Wa[of.a.kaa]=ja;this.PQd(G,Wa)};$c.prototype.fAj=function(){this.w6f()?
this.aMf():gj.g(this.$).Da.Iqe(this.I$a)};$c.prototype.w6f=function(){if(this.z8a||cc(this.$))return!1;var G=Jk.a(this.$);return gj.g(this.$).Da.V0b&&G.fki()};$c.prototype.aMf=function(){var G=this;this.qw.zy?this.qw.zy.value&&this.vta.sdc():this.qw.ZBe().then(function(ja){ja&&G.vta.sdc()});Ea.a(oi.a.MKi)};$c.prototype.ysj=function(){var G=Qj.a.create().toString(),ja={};hc(this.$,ja);var Wa={};Wa[of.a.V$f]=this.vta.getAuthContext();var vb={};vb[of.a.kYe]=jh.a.Kc(ja);vb[of.a.fff]=jh.a.Kc(Wa);vb[of.a.Flh]=
jh.a.Kc(this.$.ya.DocumentHostInfo);vb[of.a.wLj]=za(this.$);vb[of.a.Mbg]=jh.a.Kc(of.a.Wr);vb[of.a.yxe]=this.$.yxf?"true":"false";vb[of.a.tYf]=of.a.L4a(this.$);vb[of.a.Waf]=jc(this.$);vb[of.a.Scg]=pd(this.$);vb[of.a.kaa]=G;ja=[];ja.push(Object.assign(new Nf.a,{name:of.a.kaa,string:G}));Ea.a(oi.a.OKi,void 0,void 0,ja);this.PQd(of.a.Rei,vb)};$c.prototype.j8h=function(G){var ja=this;this.DEj(G);cc(this.$)&&Mb(this.$,"localstorage");Th.TaskExtensions.Ba(cj.GetServiceTaskFactory.Ua(this.$.da,374,375,1),
function(Wa){ja.dyi(Wa.result).continueWith(function(){ja.xsj(G)});ja.z8a=!0},this.$.la,3)};$c.prototype.dyi=function(G){var ja={};ja.SolutionId=of.a.solutionId;ja.Version=of.a.dQd;ja.StoreType=OSF.StoreType.Sdx;ja.StoreId=OSF.StoreType.Sdx;ja.AssetId=of.a.solutionId;ja.AssetStoreId=OSF.StoreType.Sdx;ja.TargetType=1;ja.SharedRuntimeId=of.a.Hxb(this.$);ja.SourceLocationOverrideResourceId=of.a.Hxb(this.$);ja.IsToBePersisted=!1;var Wa=new Bj.a;Wa.ql=Ff.a.instance.fa(2089);Wa.taskPaneWidth=of.a.Wr;var vb=
new rd;vb.JOb=pd(this.$);vb.Oba=jc(this.$);return G.OPd(ja,Wa,void 0,void 0,vb)};$c.prototype.xsj=function(G){this.ysj();Nj.a(this.$)&&Nj.a(this.$).Uqe(this.YNi);this.v0f(G)};$c.prototype.v0f=function(G){var ja={};ja[of.a.Eoj]=G.shapeId;ja[of.a.Doj]=G.scriptLink;ja[of.a.kaa]=G.clickId.toString();ja[of.a.Coj]=G.buttonText;this.PQd(G.actionName,ja)};$c.prototype.PQd=function(G,ja){var Wa=new Aj.a(of.a.solutionId,OSF.StoreType.Sdx,OSF.StoreType.Sdx,of.a.dQd),vb=new sj.a(of.a.Zbf,of.a.$Ye,this.$.ya.UICultureTag),
f=new bi.a;f.wi[qe.ql]=Ff.a.instance.fa(2089);f.wi[qe.sourceLocationOverrideResourceId]=of.a.Hxb(this.$);f.wi[qe.YVc]=ja;f.wi[qe.taskPaneWidth]=of.a.Wr;Zi.a.instance.GOa(Wa,Ak.a.action,G,vb,f)};$c.prototype.DEj=function(G){Df.EwaSettings.getBooleanFeatureGate(of.a.Nbg,!1)&&G.actionName===of.a.aZf&&(G=new hl.a(G.scriptLink,"initializing",G.clickId.toString(),G.buttonText),this.businessBarManager.Qpe(63,G))};Object(Yd.a)($c,"AutomateCommandRunFromButton",null,[975]);Am(kc,Lc);kc.prototype.X0c=function(G,
ja){if(this.cache.xg()){var Wa={};Wa.TimeStamp=ih.a.Ra.Ob;Wa.IsEnabled=ja;this.cache.xyc(G,jh.a.Kc(Wa))}};kc.prototype.sgd=function(G){var ja=!1,Wa=!1,vb=null;this.cache.xg()&&(G=fi.b(this.cache.o5a(G)))&&(Wa=G.IsEnabled,vb=new Date(G.TimeStamp),ja=!0);return new xf(Wa,ja,vb)};kc.prototype.tQf=function(G){var ja=this,Wa=ih.a.Ra.Ob,vb=[];return Th.TaskExtensions.yaa(this.indexedDB.oLa(of.a.uRa),function(f){var D=!ja.Nda||!ja.Yk.length;f=f.result;vb.push(Object.assign(new Nf.a,{name:"ExistingScriptCount",
int64:ja.Yk.length}));if(""!==f&&(f=fi.b(f),vb.push(Object.assign(new Nf.a,{name:"CachedScriptCount",int64:f.length})),D)){for(var N=Cl(f),fa=N.next();!fa.done;fa=N.next())ja.Yk.im(new xd(fa.value));ja.cxa=!0;ja.bKd=0<f.length;Ea.a(oi.a.Axf,D,si.getElapsedMilliseconds(Wa,ih.a.Ra.Ob),vb);ja.KKd(G);return!0}Ea.a(oi.a.Axf,D,si.getElapsedMilliseconds(Wa,ih.a.Ra.Ob),vb);return!1},this.$.la,3)};kc.prototype.naj=function(G){Df.EwaSettings.getBooleanFeatureGate(of.a.s_c,!1)&&this.taj(G);of.a.uL?this.tQf(G):
this.maj(G)};kc.prototype.A0h=function(G,ja,Wa){var vb=this,f=ih.a.Ra.Ob,D=[];if(G&&G.IsSuccess){Mb(this.$,G.Token);var N=qj.a.create().toString();D.push(Object.assign(new Nf.a,{name:"CorrelationId",string:N}));makerstorage.getRecentScripts(N).then(function(fa){D.push(Object.assign(new Nf.a,{name:"HasReadCachedScripts",bool:vb.cxa}));vb.Yk.clear();fa=Cl(fa);for(var Ia=fa.next();!Ia.done;Ia=fa.next())vb.Yk.im(new xd(Ia.value));vb.bKd=!0;vb.Nda=!0;vb.indexedDB.xg()&&(fa=jh.a.Kc(vb.Yk.Rfb()),vb.indexedDB.wdb(new jk.a(of.a.uRa,
fa)));D.push(Object.assign(new Nf.a,{name:"ScriptCount",int64:vb.Yk.length}));Ea.a(oi.a.aFb,!0,si.getElapsedMilliseconds(f,ih.a.Ra.Ob),D);ja.UB(of.a.uRa)}).catch(function(fa){Object.getType(fa)===makerstorage.StorageServiceError?(D.push(Object.assign(new Nf.a,{name:"Error",string:fa.message})),D.push(Object.assign(new Nf.a,{name:"ErrorCode",string:String.format("makerstorage_{0}_{1}",fa.errorCode.toString(),fa.status.toString())})),17===fa.errorCode&&Wa.PLd(of.a.gcc(vb.$))):(D.push(Object.assign(new Nf.a,
{name:"Error",string:fa.toString()})),D.push(Object.assign(new Nf.a,{name:"ErrorCode",string:"exception"})));Ea.a(oi.a.NKi,!1,si.getElapsedMilliseconds(f,ih.a.Ra.Ob),D);vb.Nda=!0;ja.UB(of.a.uRa)})}else N=G?G.ErrorCode:"need_token",G=G?G.ErrorMessage:"No Access Token",D.push(Object.assign(new Nf.a,{name:"ServiceChecked",bool:!1})),D.push(Object.assign(new Nf.a,{name:"Error",string:G})),D.push(Object.assign(new Nf.a,{name:"ErrorCode",string:N})),Ea.a(oi.a.aFb,!1,si.getElapsedMilliseconds(f,ih.a.Ra.Ob),
D),this.Nda=!0,ja.UB(of.a.uRa)};kc.prototype.cKd=function(G,ja){var Wa=this,vb=new fj.a,f=jf(this.$);return dc(this.$,function(D){if((D=D.Result)&&200===D.ResponseStatusCode)D=D.ResponseBody.join(""),D=JSON.parse(D),G(Wa.pGd(D.value)),vb.setResult(!0);else{D=D?"RichApi_"+D.ResponseStatusCode:"RichApiError";var N=[];N.push(Object.assign(new Nf.a,{name:"Error",string:"Failed to read shared script ids from document"}));N.push(Object.assign(new Nf.a,{name:"ErrorCode",string:D}));Wa.Kt=!0;Wa.eV(ja,ih.a.Ra.Ob,
0,N);vb.setResult(!1)}},function(D){D=Gj.a.mg(D.data);df.ULS.sendTraceTag(537170309,0,15,"REST API failed to fetch the CustomXmlPart for Automate Gallery.");var N=[];N.push(Object.assign(new Nf.a,{name:"Error",string:"Failure using rich api: "+D}));N.push(Object.assign(new Nf.a,{name:"ErrorCode",string:"RichApiFailure"}));Wa.Kt=!0;Wa.eV(ja,ih.a.Ra.Ob,0,N);vb.setResult(!1)},f,vb)};kc.prototype.Xjd=function(G,ja,Wa){var vb=this,f=ih.a.Ra.Ob,D=0,N=0;this.Kt=D===G.count;var fa=[];fa.push(Object.assign(new Nf.a,
{name:"ScriptIds",int64:G.count}));if(G.count)if(ja&&ja.IsSuccess){Mb(this.$,ja.Token);var Ia={};ja=Cl(G);for(var pb=ja.next();!pb.done;Ia={yhb:Ia.yhb},pb=ja.next())pb=pb.value,Ia.yhb=qj.a.create().toString(),makerstorage.getSharedScript(pb.value,Ia.yhb).then(function(Wb){return function(Nc){var kd=[];kd.push(Object.assign(new Nf.a,{name:"BodySize",int64:Nc.body.length}));kd.push(Object.assign(new Nf.a,{name:"CorrelationId",string:Wb.yhb}));Ea.a(oi.a.woc,!0,si.getElapsedMilliseconds(f,ih.a.Ra.Ob),
kd);D++;Nc=new xd(Nc);Nc.shareId=G.pa(Nc.id);vb.kg.im(Nc);vb.Kt=D===G.count;vb.IAa=!0;vb.eV(Wa,f,N,fa)}}(Ia)).catch(function(Wb){return function(Nc){var kd=[];Object.getType(Nc)===makerstorage.StorageServiceError?(fa.push(Object.assign(new Nf.a,{name:"Error",string:Nc.message})),fa.push(Object.assign(new Nf.a,{name:"ErrorCode",string:String.format("makerstorage_{0}_{1}",Nc.errorCode.toString(),Nc.status.toString())}))):(kd.push(Object.assign(new Nf.a,{name:"Error",string:Nc.toString()})),kd.push(Object.assign(new Nf.a,
{name:"ErrorCode",string:"exception"})));kd.push(Object.assign(new Nf.a,{name:"CorrelationId",string:Wb.yhb}));Ea.a(oi.a.woc,!1,si.getElapsedMilliseconds(f,ih.a.Ra.Ob),kd);D++;N++;vb.Kt=D===G.count;vb.eV(Wa,f,N,fa)}}(Ia)).finally(function(){if(Df.EwaSettings.getBooleanFeatureGate(of.a.s_c,!1)&&vb.indexedDB.xg()&&vb.Kt){var Wb=Lc.a2h(vb.$,vb.kg);vb.indexedDB.wdb(new jk.a(of.a.mhb,Wb))}})}else Ia=ja?ja.ErrorCode:"need_token",ja=ja?ja.ErrorMessage:"No Access Token",fa.push(Object.assign(new Nf.a,{name:"Error",
string:ja})),fa.push(Object.assign(new Nf.a,{name:"ErrorCode",string:Ia})),this.Kt=!0,this.eV(Wa,f,N,fa);else this.Kt=this.IAa=!0,this.eV(Wa,f,N,fa),Df.EwaSettings.getBooleanFeatureGate(of.a.s_c,!1)&&Th.TaskExtensions.yaa(Lc.wQf(this.$,this.indexedDB),function(Wb){Wb.result&&(vb.indexedDB.V8c(of.a.mhb),vb.kg.clear(),Wa.UB("CachedScripts"))},this.$.la,3)};kc.prototype.Kjd=function(G){var ja={id:"samples-6"};ja.name=Ff.a.instance.fa(2085);this.Oo.im(new xd(ja));ja.id="samples-8";ja.name=Ff.a.instance.fa(2086);
this.Oo.im(new xd(ja));ja.id="samples-2";ja.name=Ff.a.instance.fa(2082);this.Oo.im(new xd(ja));ja.id="samples-4";ja.name=Ff.a.instance.fa(2083);this.Oo.im(new xd(ja));ja.id="samples-5";ja.name=Ff.a.instance.fa(2084);this.Oo.im(new xd(ja));of.a.C1&&(ja.id="samples-9",ja.name=Ff.a.instance.fa(2087),this.Oo.im(new xd(ja)));this.G7=!0;G.UB("SampleScripts")};kc.prototype.pGd=function(G){var ja=new qk.a;if(G=this.$ua.parseFromString(G,"text/xml").querySelector('[id="script-ids-node-id"]')){G=G.getElementsByTagName("scriptId");
for(var Wa={},vb=0;vb<G.length;Wa={zRb:Wa.zRb,vRb:Wa.vRb,pRb:Wa.pRb},vb++)Wa.zRb=G[vb].getAttribute("id"),Wa.zRb&&(Wa.vRb=void 0,Wa.pRb=void 0,function(f){return function(){var D=Lc.f7e(f.zRb);f.vRb=D.eXd;f.pRb=D.shareId;return D}}(Wa)().returnValue&&ja.ia(Wa.vRb,Wa.pRb))}return ja};kc.prototype.taj=function(G){var ja=this,Wa=ih.a.Ra.Ob,vb=[];Th.TaskExtensions.yaa(Lc.wQf(this.$,this.indexedDB),function(f){var D=f.result;vb.push(Object.assign(new Nf.a,{name:"ExistingScriptCount",int64:ja.kg.length}));
if(D){vb.push(Object.assign(new Nf.a,{name:"CachedScriptCount",int64:D.length}));if(f=!ja.Kt||0===ja.kg.length){D=Cl(D.getScripts());for(var N=D.next();!N.done;N=D.next())ja.kg.im(N.value);ja.kg.sort();Ea.a(oi.a.aCd,f,si.getElapsedMilliseconds(Wa,ih.a.Ra.Ob),vb);ja.KKd(G);return!0}Ea.a(oi.a.aCd,f,si.getElapsedMilliseconds(Wa,ih.a.Ra.Ob),vb)}else Ea.a(oi.a.aCd,!1,si.getElapsedMilliseconds(Wa,ih.a.Ra.Ob),vb);return!1},this.$.la,3)};kc.prototype.maj=function(G){var ja=this,Wa=ih.a.Ra.Ob,vb=[];Th.TaskExtensions.yaa(this.indexedDB.oLa(of.a.gRa),
function(f){var D=!ja.E7||!ja.Tm.length;f=f.result;vb.push(Object.assign(new Nf.a,{name:"ExistingScriptCount",int64:ja.Tm.length}));if(""!==f&&(f=fi.b(f),vb.push(Object.assign(new Nf.a,{name:"CachedScriptCount",int64:f.length})),D)){f=Cl(f);for(var N=f.next();!N.done;N=f.next())ja.Tm.im(new xd(N.value));ja.Tm.sort();Ea.a(oi.a.$Eb,D,si.getElapsedMilliseconds(Wa,ih.a.Ra.Ob),vb);ja.KKd(G);return!0}Ea.a(oi.a.$Eb,D,si.getElapsedMilliseconds(Wa,ih.a.Ra.Ob),vb);return!1},this.$.la,3)};kc.prototype.eV=function(G,
ja,Wa,vb){this.Kt&&(vb.push(Object.assign(new Nf.a,{name:"ScriptCount",int64:this.kg.length})),vb.push(Object.assign(new Nf.a,{name:"ScriptErrorCount",int64:Wa})),Ea.a(oi.a.Bxf,!Wa,si.getElapsedMilliseconds(ja,ih.a.Ra.Ob),vb),this.kg.sort(),G.UB(of.a.mhb))};kc.prototype.KKd=function(G){this.D5=!0;G.UB("CachedScripts")};Object(Yd.a)(kc,"AutomateCommandStorage",Lc,[]);var kk=Ui.a;Am(Jf,kk);Jf.prototype.create=function(){var G=this,ja=cj.GetServiceTaskFactory.Ua(this.$.da,349,350,this.ub),Wa=Lf.a.loadScript(109,
4,this.ub,void 0,void 0,351),vb=cj.GetServiceTaskFactory.create(this.$.da,102,this.$.la,this.ub),f=cj.GetServiceTaskFactory.create(this.$.da,396,this.$.la,this.ub),D=cj.GetServiceTaskFactory.Ua(this.$.da,5,4,this.ub);Th.TaskExtensions.Ba(Th.TaskExtensions.we([ja,Wa,vb,f,D],this.la,3),function(){var N=ja.result,fa=f.result,Ia=D.result,pb=new Af,Wb=new Je(G.$,N,pb),Nc=new kc(G.$,fa),kd=new Gc(G.$,Nc);Ia=new $c(G.$,Wb,pb,Ia);G.Eb(G.$.da.Aa(352)||new me(G.$,N,vb.result,fa,Ia,pb,Wb,Nc,kd))},this.la,3)};
Jf.ka=function(G){G&&G.da.Ha(351,new Jf(G))};Object(Yd.a)(Jf,"AutomateCommandManagerFactory",Ui.a,[]);var rk=b(102),al=b(1359),Kk=b(184),Zj=b(53);pe.prototype.$c=function(){return!1};pe.prototype.executeCommand=function(G,ja,Wa){G=!1;switch(ja.command){case 73979048:this.ztb&&this.ztb.q5i(ja,rk.a.instance,ig.AFrameworkApplication.ha,Wa),G=!0}return G?Zj.Task.Sa(!0):Kk.a(ja.command)};pe.prototype.Mc=function(G,ja){return 73979048===ja.command&&Df.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataFromPictureOnXLO",
!1)};pe.prototype.nd=function(){return!1};pe.prototype.dispose=function(){this.ztb&&this.ztb.dispose()};Object(Yd.a)(pe,"DataFromPictureCommandHandler",null,[434,3]);var Bk=zj.a;Am(Xe,Bk);Xe.prototype.Qd=function(){var G=this,ja=cj.GetServiceTaskFactory.Ua(this.$.da,328,327,1),Wa=cj.GetServiceTaskFactory.Ua(this.$.da,484,485,1);Th.TaskExtensions.Ba(Th.TaskExtensions.we([ja,Wa],this.$.la),function(){G.Jd([new pe(G.$,ja.result,Wa.result)])},this.$.la,3)};Xe.ka=function(G){zj.a.je(452,new Xe(G))};Object(Yd.a)(Xe,
"DataFromPictureCommandHandlerFactory",zj.a,[]);var wg=b(930),wk=b(90),Mi=b(906);$e.hE=function(G,ja,Wa){Wa?$e.Vc(G,ja):$e.Al(G,ja)};$e.Vc=function(G,ja){if(!Mi.c(G)){var Wa=G.className;if(Mi.c(Wa)||-1===Wa.indexOf(ja))ja=Wa.trim()+" "+ja,ja=ja.trim(),G.className=ja}};$e.Al=function(G,ja){if(!(Mi.c(G)||Mi.c(ja)||Mi.c(G.className))){var Wa=G.className;Wa!==Wa.replace(ja,"")&&(G.className=Wa.replace(ja,""))}};$e.g8=function(G,ja,Wa,vb){Wa=void 0===Wa?!1:Wa;vb=void 0===vb?!1:vb;Mi.c(G)||Wa||($e.hE(G,
"cui-disabled",!ja),ja=ja?wk.a.Zo:wk.a.Dj,wk.a.ih(G,wk.a.aia,ja),vb&&wk.a.ih(G,wk.a.GZc,ja))};Object(Yd.a)($e,"Helper",null,[]);zc.prototype.pZh=function(G){df.ULS.sendTraceTag(17306645,220,50,"Context menu id: {0}",G);for(var ja=new Kh.a,Wa=Cl(this.V2b),vb=Wa.next();!vb.done;vb=Wa.next()){vb=Cl(vb.value.XEb);for(var f=vb.next();!f.done;f=vb.next())f=f.value,f.id===G&&ja.add(f)}return ja};zc.prototype.hpe=function(G){this.V2b.add(G)};zc.prototype.Aej=function(G){for(var ja=Cl(this.V2b),Wa=ja.next();!Wa.done;Wa=
ja.next())if(Wa=Wa.value,Wa.Zse===G.Zse){this.V2b.remove(Wa);break}};zc.Cjh=function(G,ja,Wa){Wa=void 0===Wa?null:Wa;G=zc.DRh(G);0<G.length&&(zc.lyc(G,!1),Wa&&Wa(ja,G))};zc.DRh=function(G){var ja=[];if(G&&G.XEb&&0<G.XEb.count){G=Cl(G.XEb);for(var Wa=G.next();!Wa.done;Wa=G.next())if(Wa=Wa.value,Wa.controls&&0<Wa.controls.count){Wa=Cl(Wa.controls);for(var vb=Wa.next();!vb.done;vb=Wa.next())if(vb=vb.value,vb.menuItems&&0<vb.menuItems.count){vb=Cl(vb.menuItems);for(var f=vb.next();!f.done;f=vb.next())Array.add(ja,
f.value.id)}}}return ja};zc.lyc=function(G,ja){if(G.length){G=Cl(G);for(var Wa=G.next();!Wa.done;Wa=G.next())Wa=document.querySelector('[id^="'+Wa.value+'"]'),$e.g8(Wa,ja)}};uk.Object.defineProperties(zc.prototype,{V2b:{configurable:!0,enumerable:!0,get:function(){return this.Wpg}}});Object(Yd.a)(zc,"ContextMenuExtensibilityCache",null,[91,92]);var Lk=b(1481),dj=b(1083),xk=b(967),Ki=b(938),yk=b(975),Ck=yk.a;Am(zd,Ck);zd.prototype.clone=function(){var G=new zd;G.qpd=this.qpd;G.Vod=this.Vod;G.ribbon=
this.ribbon;return G};Object(Yd.a)(zd,"RibbonBuildContext",yk.a,[]);jd.prototype.Jha=function(G,ja,Wa){ja=void 0===ja?null:ja;Wa=void 0===Wa?null:Wa;var vb=xk.Builder.I5b(G);if(Mi.c(vb))Wa&&Wa(!1);else if(G=new zd,G.Vod=this.k$.homeTab.id,G.qpd=this.k$.homeTab,G.ribbon=this.k$,vb=new Ki.a(vb),vb=Ki.a.fW(vb.node,Ki.a.g4d),Mi.c(vb))Wa&&Wa(!1);else{vb=Ki.a.Lm(vb);for(var f=0;f<vb.length;f++){var D=vb[f],N=(new Ki.a(D)).attributes[Ki.a.id];if(this.k$.yba(N))this.AXb.a4j(N,D,G);else{var fa=-1;ja&&(fa=
this.ZGh(N,ja));-1!==fa?this.AXb.$Gg(D,G,fa):this.AXb.$Gg(D,G)}}Wa&&Wa(!0)}};jd.prototype.ZGh=function(G,ja){G=Array.indexOf(ja,G);if(-1===G)return-1;--G;for(var Wa=-1;0<=G;){Wa=this.yWh(ja[G]);if(-1!==Wa)break;G--}return Wa+1};jd.prototype.yWh=function(G){for(var ja=0,Wa=!1,vb=Cl(this.k$.children),f=vb.next();!f.done;f=vb.next()){f=f.value;if(f.id===G){Wa=!0;break}f.visible&&ja++}return Wa?ja:-1};jd.prototype.wcb=function(G){G=xk.Builder.I5b(G);if(!Mi.c(G)&&(G=new Ki.a(G),G=Ki.a.fW(G.node,Ki.a.g4d),
!Mi.c(G))){G=Ki.a.Lm(G);for(var ja=0;ja<G.length;ja++){var Wa=G[ja],vb=(new Ki.a(Wa)).attributes[Ki.a.id];Wa=Ki.a.fW(Wa,Ki.a.Shb);Wa=Ki.a.Lm(Wa);for(var f=0;f<Wa.length;f++){var D=Ki.a.J4e(Wa[f],Ki.a.id);Mi.c(D)||this.AXb.E5j(vb,D)}}}};Object(Yd.a)(jd,"RibbonExtensibilityBuilder",null,[]);var Yj=b(907);fd.prototype.Jha=function(G,ja){ja=void 0===ja?null:ja;var Wa=G.w_e();this.Wie.Jha(Wa,G.Jab,ja)};fd.prototype.wcb=function(G){G=G.w_e();this.Wie.wcb(G)};fd.Ljh=function(G,ja,Wa){Wa=void 0===Wa?null:
Wa;G=fd.h1h(G);0<G.length&&(fd.lyc(G,!1),Wa&&Wa(ja,G))};fd.h1h=function(G){var ja=[];if(G){var Wa=G.hX;if(!Wa){if(G.tabs&&0<G.tabs.count)for(G=Cl(G.tabs),Wa=G.next();!Wa.done;Wa=G.next())if(Wa=Wa.value,0<Wa.NK.count){var vb=Cl(Wa.NK);for(Wa=vb.next();!Wa.done;Wa=vb.next())if(Wa=Wa.value,0<Wa.Yia.count){var f=Cl(Wa.Yia);for(Wa=f.next();!Wa.done;Wa=f.next())Array.add(ja,Wa.value.id)}}}else if(Wa.gs&&0<Wa.gs.count)for(G=Cl(Wa.gs),Wa=G.next();!Wa.done;Wa=G.next())if(Wa=Wa.value,Wa.groups&&0<Wa.groups.length)for(vb=
Cl(Wa.groups),Wa=vb.next();!Wa.done;Wa=vb.next())if(Wa=Wa.value,Wa.controls&&0<Wa.controls.length)for(f=Cl(Wa.controls),Wa=f.next();!Wa.done;Wa=f.next())Array.add(ja,Wa.value.id)}return ja};fd.lyc=function(G,ja){if(G.length){G=Cl(G);for(var Wa=G.next();!Wa.done;Wa=G.next())Wa=document.querySelector('[id^="'+Wa.value+'"]'),Yj.a.g8(Wa,ja)}};Object(Yd.a)(fd,"RibbonExtensibilityManager",null,[121]);var lk=b(1142);Fc.prototype.getTaskPaneControlIdFromAssetIdRuntimeId=function(G,ja){return OfficeExt.DefaultControlActionBinder.getTaskPaneControlIdFromAssetIdRuntimeId(G,
ja)};Fc.prototype.tld=function(G,ja,Wa,vb,f,D,N){D=void 0===D?null:D;N=void 0===N?null:N;df.ULS.sendTraceTag(17138449,220,50,"Control id: {0}.",G);if((G=ja.Uja(f.ownerAddinInfo.storeType,f.ownerAddinInfo.solutionId))&&G.QB&&!G.QB.getIsUpgrading())if(ja=null,0<G.QB.getNotificationParams().length&&(ja=this.xye(G.QB.getNotificationParams()[0]),ig.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoLaunchAddinEnabled",!1)&&ja&&2147758681===ja.errorCode&&(G.isUpgraded=!0),
ig.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UpgradeAddinUsageEnabled",!1)&&ja&&2147758681===ja.errorCode&&df.ULS.sendTraceTag(529278163,220,50,"Upgrade")),2!==G.QB.getStatus()&&(1!==G.QB.getStatus()||ja&&2147758681===ja.errorCode))ja&&this.f7f(G,ja,N);else try{Wa.setOwnerAddinEToken(G.QB.getEToken()),f.action(Wa,vb.vna),D&&D()}catch(fa){df.ULS.sendTraceTag(17425949,220,10,String.format("HandleAddinCommandsAction error info : {0}.",ig.AFrameworkApplication.ha.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.LogStackInfo")?
fa.stack:fa.message)),lk.a.DUd(CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)}};Fc.prototype.f7f=function(G,ja,Wa){var vb=this;Wa=void 0===Wa?null:Wa;var f=G.QB;if(1===f.getNotificationParams().length||ja.$fc){var D=ja.tia,N=ja.qja;ja.tia=function(){f.removeFirstNotification();if(0<f.getNotificationParams().length){var fa=vb.xye(f.getNotificationParams()[0]);vb.f7f(G,fa)}2147758681===ja.errorCode&&(fd.Ljh(G.Mo,f,Object(lh.a)(vb,vb.Ldf,"initUpgradeStateDetectTask")),
zc.Cjh(G.Asb,f,Object(lh.a)(vb,vb.Ldf,"initUpgradeStateDetectTask")));D&&D()};ja.qja=function(){N&&N();Wa&&Wa()};lk.a.FUd(ja)}};Fc.prototype.Ldf=function(G,ja){var Wa=null;Wa=function(){G.getIsUpgrading()?window.setTimeout(Wa,1E3):G.getUpgradingFailed()?fd.lyc(ja,!0):ig.AFrameworkApplication.sa.updateCommandUI()};window.setTimeout(Wa,1E3)};Fc.prototype.xye=function(G){var ja=new dj.a;ja.NMa=G.infoType;ja.id=G.id;ja.title=G.title;ja.description=G.description;ja.buttonText=G.buttonTxt;ja.tia=G.buttonCallback;
ja.$fc=G.highPriority;ja.qja=G.dismissCallback;ja.errorCode=G.errorCode;ja.Lcf=G.iframeNotificationUrl;return ja};uk.Object.defineProperties(Fc.prototype,{Une:{configurable:!0,enumerable:!0,get:function(){return this.IGc||(this.IGc=OfficeExt.DefaultControlActionBinder.retrieveActionContext)},set:function(G){this.IGc=G}},kRg:{configurable:!0,enumerable:!0,get:function(){return this.v5d||(this.v5d=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap())}}});Object(Yd.a)(Fc,"AddinCommandsActionHandler",
null,[96]);kf.prototype.pMh=function(G){if(void 0!==G&&null!==G&&G===Qi.a.KFe)G="ContextMenuCell";else return null;var ja=this.Ta.Oc();this.HLh(ja,G);return ja};kf.prototype.HLh=function(G,ja){ja=this.s6g.pZh(ja);ja=Cl(ja);for(var Wa=ja.next();!Wa.done;Wa=ja.next()){Wa=Cl(Wa.value.controls);for(var vb=Wa.next();!vb.done;vb=Wa.next())this.uLh(G,vb.value)}};kf.prototype.uLh=function(G,ja){var Wa=ja.nB[Ki.a.id],vb=ja.nB[Ki.a.pDa],f=ja.nB[Ki.a.sDa],D="Image16by16",N=ja.nB[Ki.a.YVa];Mi.c(f)&&(D="None");
0<ja.menuItems.count?(Wa=this.Ta.yw(Wa,Wa,vb,798637440),Wa.GLb(D,f,null),this.nMh(Wa.menu,ja),Array.add(G.buttons,Wa)):Array.add(G.buttons,this.Ta.GIa(Wa,vb,N,f,D,null,!1))};kf.prototype.nMh=function(G,ja){var Wa,vb=this.Ta.Oc();ja=Cl(ja.menuItems);for(Wa=ja.next();!Wa.done;Wa=ja.next()){var f=Wa.value;Wa=f.vS[Ki.a.id];var D=f.vS[Ki.a.pDa],N=f.vS[Ki.a.sDa],fa="Image16by16";f=f.vS[Ki.a.YVa];Mi.c(N)&&(fa="None");Wa=this.Ta.GIa(Wa,D,f,N,fa,null,!1);Array.add(vb.buttons,Wa)}Array.add(G.Dc,vb)};Object(Yd.a)(kf,
"AddInCommandsContextMenuExtensibilityHandler",null,[997]);var Dk=b(1071);Object(Yd.a)(Ve,"AddinStatusCommandValues",null,[]);Ad.$7i=function(G){var ja=new Ve;ja.Ii=G.o_a;ja.visible=ja.Ii?!0:!1;return ja};Ad.Yzc=function(G,ja,Wa,vb,f){var D=document.getElementById(Wa);D?Ad.WFj(G,ja,D,vb,f):df.ULS.sendTraceTag(17662423,220,100,String.format("{0} element is not availiable",Wa))};Ad.WFj=function(G,ja,Wa,vb,f){Wa?G.o_a===CommonUIStrings.l_ErrorLoadingAddInsTitle?lk.a.GEj(ja,Wa,vb,f):G.o_a===CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg&&
lk.a.bGj(ja,Wa):df.ULS.sendTraceTag(543801756,220,100,String.format("addinLabelElement element is not available"))};Object(Yd.a)(Ad,"AddinCommandsStatusHandler",null,[]);var mk=b(36),Ek=b(227),Sk=mk.a;Am(ae,Sk);ae.prototype.Gq=function(G){this.addHandler("LAC",G)};ae.prototype.er=function(G){this.removeHandler("LAC",G)};ae.prototype.Bs=function(G,ja){var Wa=this;if("QueryAddinLabel"!==G)return!1;ja[Dk.a.LabelText]!==this.AG.o_a&&(G=Ad.$7i(this.AG),ja[Dk.a.LabelText]=G.Ii,ja[Dk.a.Visible]=G.visible,
window.setTimeout(function(){Wa.Yzc()},0));return!0};ae.prototype.wn=function(){return!0};ae.prototype.Yzc=function(){this.$&&Ad.Yzc(this.AG,this.$.domElement,this.bLj,Ff.a.instance.fa(334),Ff.a.instance.fa(335))};ae.prototype.dispose=function(){this.$.ea.tk(this.fd);this.AG.Ffj(this.t9e);this.agaveCommandManager&&(this.agaveCommandManager.Ugj(this.ICe),this.agaveCommandManager=null);this.statusBarManager&&(this.statusBarManager.tG(this),this.statusBarManager=null);this.AG=this.$=null;Sk.prototype.dispose.call(this)};
Object(Yd.a)(ae,"AddinCommandsStatusBarManager",mk.a,[533,299]);var fk=b(1366),ej=b(122),nk=b(140);Od.prototype.setErrorMessageForAddin=function(G,ja){this.n_a||(this.n_a={});this.n_a[G]=ja};Od.prototype.WTh=function(G){return this.n_a&&G in this.n_a?this.n_a[G]:null};Object(Yd.a)(Od,"AddinCommandsErrorManager",null,[]);var gi=b(344),Mk=b(96);Object(Yd.a)(Bc,"AddinCommandsListLoaderContext",null,[]);var Nk=b(1027);Object(Yd.a)(we,"AppsForOfficeEntitlementQueryInfo",null,[]);var bl=b(79),ml=b(892);
zf.prototype.get_current=function(){if(!this.ds)throw Error.argumentOutOfRange();return this.ds.data};zf.prototype.moveNext=function(){if(!this.ds)return this.ds=this.MA,!!this.MA;if(!this.ds.next)return!1;this.ds=this.ds.next;return!0};zf.prototype.Dnc=function(){if(!this.ds)return this.ds=this.MA,!!this.MA;if(!this.ds.previous)return!1;this.ds=this.ds.previous;return!0};zf.prototype.reset=function(){this.ds=this.MA};Object(Yd.a)(zf,"ListEnumerator",null,[0]);Object(Yd.a)(Ue,"ListNode",null,[]);
He.prototype.add=function(G){this.xq?this.YA=this.YA.next=new Ue(G,this.YA,null):this.xq=this.YA=new Ue(G,null,null);this._count=this.count+1};He.prototype.insert=function(G,ja){if(G>this.count||0>G)throw Error.argumentOutOfRange("pos");if(G===this.count)this.add(ja);else{for(var Wa=this.xq;0!==G--;)Wa=Wa.next;G=new Ue(ja,Wa.previous,Wa);G.previous?G.previous.next=G:this.xq=G;G.next?G.next.previous=G:this.YA=G;this._count=this.count+1}};He.prototype.remove=function(G){for(var ja=this.xq;ja&&ja.data!==
G;)ja=ja.next;if(!ja)return!1;ja.previous?ja.previous.next=ja.next:this.xq=ja.next;ja.next?ja.next.previous=ja.previous:this.YA=ja.previous;this._count=this.count-1;return!0};He.prototype.clear=function(){var G=this.xq;for(this.YA=this.xq=null;G;){var ja=G.next;G.previous=null;G.next=null;G=ja}this._count=0};He.prototype.indexOf=function(G){for(var ja=this.xq,Wa=0;ja&&ja.data!==G;)ja=ja.next,Wa++;return ja?Wa:-1};He.prototype.pa=function(G){return this.at(G).data};He.prototype.getEnumerator=function(){return new zf(this.xq)};
He.prototype[Symbol.iterator]=function(){return Object(ml.a)(this.getEnumerator())};He.prototype.Tcc=function(G){G=this.at(G);return new zf(G)};He.prototype.toArray=function(){for(var G=Array(this.count),ja=0,Wa=Cl(this),vb=Wa.next();!vb.done;vb=Wa.next())G[ja]=vb.value,ja++;return G};He.prototype.at=function(G){for(var ja=this.xq,Wa=0;Wa!==G;){if(!ja)throw Error.argumentOutOfRange("pos");ja=ja.next;Wa++}return ja};uk.Object.defineProperties(He.prototype,{count:{configurable:!0,enumerable:!0,get:function(){return this._count}}});
Object(Yd.a)(He,"List",null,[1]);var cl=Sys.EventArgs;Am(qd,cl);Object(Yd.a)(qd,"AddinCommandsEntitlementsRetrievedEventArgs",Sys.EventArgs,[]);ne.prototype.ocd=function(G){var ja=new Sys.StringBuilder(this.mKb);ja.append("RoamingServiceHandler.ashx?action=");ja.append("getAddinTeachingCalloutSettings");ja.append("&");ja.append(this.vjd(G));ja.append("&");ja.append(ig.AFrameworkApplication.uj);ig.AFrameworkApplication.Ld.jm(ja.toString(),1,null,null,!0,2,Object(lh.a)(this,this.FLa,"getRequestSuccessCallback"),
Object(lh.a)(this,this.Ika,"getRequestFailureCallback"),null)};ne.prototype.pcd=function(G){var ja=new Sys.StringBuilder(this.mKb);ja.append("RoamingServiceHandler.ashx?action=");ja.append("saveAddinTeachingCalloutSettings");ja.append("&");ja.append(ig.AFrameworkApplication.uj);ja=ja.toString();G=fi.c(G);ig.AFrameworkApplication.Ld.jm(ja,2,G,null,!0,4,null,Object(lh.a)(this,this.SQa,"postRequestFailureCallback"),null)};ne.prototype.FLa=function(G){var ja=!1,Wa=null;try{if(0<G.data.oe.length){var vb=
Object(Ii.a)(Object,fi.a(G.data.oe)),f=vb?vb[this.appName]:null;f&&(Wa=Object(Ii.a)(Object,fi.a(f.toString())))}ja=!0}catch(D){this.Ika(null)}ja&&this.pkb&&this.pkb(Wa)};ne.prototype.Ika=function(G){this.lkb&&this.lkb(G?G.data:null)};ne.prototype.SQa=function(G){this.ymb&&this.ymb(G?G.data:null)};ne.prototype.vjd=function(G){for(var ja=new Sys.StringBuilder("requestedsettings="),Wa=0;Wa<G.count;Wa++)ja.append(G.pa(Wa)),Wa<G.count-1&&ja.append(";");return ja.toString()};Object(Yd.a)(ne,"AddinTeachingUIRoamingRequestHandler",
null,[]);Object(Yd.a)(od,"MiniAddinInfo",null,[]);var dl=Sys.EventArgs;Am(La,dl);Object(Yd.a)(La,"ShowTeachingCalloutForContentAddinEventArgs",Sys.EventArgs,[]);$d.prototype.GHg=function(G){this.Oa.addHandler(wg.a.z0b,G)};$d.prototype.eLg=function(G){this.Oa.addHandler(wg.a.l7f,G)};$d.prototype.nTj=function(G){var ja=this;null!==G&&(this.context.O0=G[wg.a.y3],this.context.Is=G[wg.a.$M],this.context.HCc=this.context.Zsc=0,G=wg.a.TGa in G?G[wg.a.TGa]:0,-1!==this.context.O0&&0!==this.context.Is&&(this.context.E$=
new He,this.context.gka=new He,this.context.Q1a=new He,this.context.mYc=this.NLg.createAddinDataProvider(De(this.context.O0),this.contextActivationMgr),this.context.mYc?this.context.mYc.getEntitlementsAsync(this.contextActivationMgr.vna,!0,G,function(Wa){ja.CTi(Wa)}):df.ULS.sendTraceTag(17638145,220,10,"Create AddinDataProvider fails for {0}",this.context.O0)))};$d.prototype.CTi=function(G){var ja=this;if(G&&0<G.length){this.context.HCc=G.length;for(var Wa=0;Wa<G.length;Wa++){var vb=G[Wa];if(!vb||
1!==vb.targetType&&-1!==vb.targetType)this.oCd();else{var f={};f.marketplaceId=vb.solutionId;f.marketplaceVersion=vb.version;f.storeType=vb.storeType;f.storeId=vb.storeId;f.targetData=vb;this.contextActivationMgr.isAddinCommandsAsync(f,function(D,N,fa){D?(N&&ja.context.E$.add(fa.targetData),10===ja.context.O0&&(D=fa.targetData,N=D.targetType,ig.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PropertiesForTeachingUIOfPrivateCatelogEnabled",!1)&&!Mi.c(fa.targetTypeForExp)&&
(N=fa.targetTypeForExp,D.targetType=N),ig.AFrameworkApplication.ha.isChangeGateEnabled("TelemetryFixForTeachingUIOnPrivateCatelogEnabled")&&ja.context.gka.add(D),ig.AFrameworkApplication.ha.isChangeGateEnabled("OfficeVSO:5837059_TeachingUIForPrivateCatelogOnContentAddinEnabled")&&0===N&&ja.context.Q1a.add(D))):df.ULS.sendTraceTag(542978528,220,15,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetAssetId(fa.targetData.storeType,fa.targetData.storeId,fa.targetData.assetId),fa.targetData.storeType);
ja.oCd()})}}}else this.oCd()};$d.prototype.oCd=function(){var G;(G=this.context).Zsc=G.Zsc+1;this.context.Zsc>=this.context.HCc&&(this.y0b.l1f(this.context.O0,!1),0<this.context.HCc&&10===this.context.O0&&("Excel"===this.appName||"PowerPoint"===this.appName||"Word"===this.appName)?(G=!1,ig.AFrameworkApplication.ha.isChangeGateEnabled("OfficeVSO:5996085_EmailAlertAutolaunchOnWacEnabled")&&je()&&(G=this.szi()),ig.AFrameworkApplication.ha.isChangeGateEnabled("TelemetryFixForTeachingUIOnPrivateCatelogEnabled")&&
this.Iyi(),ig.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&!G?this.XNh(this.context.E$):this.v_b(this.context.E$)):this.v_b(this.context.E$))};$d.prototype.v_b=function(G){var ja=new Kh.a;if(G){G=Cl(this.context.E$);for(var Wa=G.next();!Wa.done;Wa=G.next())ja.add(Ae(Wa.value))}this.context.E$&&1>this.context.E$.count&&Nk.a.hPb(wg.a.A0b,"false",this.context.O0);G={};ja=(G.ack2=ja,G);ja[wg.a.y3]=this.context.O0;ja[wg.a.$M]=this.context.Is;
this.Oa.raiseEvent(wg.a.z0b,new qd(ja),this)};$d.prototype.sZf=function(G){if(this.appName){var ja={},Wa={};Wa.LastTeachingUIShowTime=(new Date).toUTCString();Wa.AddinHasShown=G;ja[this.appName]=fi.c(Wa);this.TRb&&(this.TRb.pcd(ja),df.ULS.sendTraceTag(539530527,306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service"))}else df.ULS.sendTraceTag(539530528,306,10,"Fail to save roaming service since AppName is null")};$d.prototype.XNh=function(G){if(this.Rha=
G)G=new Kh.a,G.add(this.appName),this.TRb=new ne(this.appName,Object(lh.a)(this,this.FLa,"getRequestSuccessCallback"),Object(lh.a)(this,this.Ika,"getRequestFailureCallback"),Object(lh.a)(this,this.SQa,"postRequestFailureCallback")),this.TRb.ocd(G);else{G=new Kh.a;var ja={};G=(ja.ack2=G,ja);G[wg.a.y3]=this.context.O0;G[wg.a.$M]=this.context.Is;this.Oa.raiseEvent(wg.a.z0b,new qd(G),this)}};$d.prototype.FLa=function(G){G?this.EDj(G)?(df.ULS.sendTraceTag(527523845,306,50,"should show teaching UI"),this.qea=
"AddinHasShown"in G&&G.AddinHasShown?G.AddinHasShown.toString():null,this.YEe()):(df.ULS.sendTraceTag(538248466,306,50,"Not Show TeachingUI this time"),this.v_b(this.Rha)):(df.ULS.sendTraceTag(527523844,306,50,"userSettings is null"),this.qea=null,this.YEe())};$d.prototype.Ika=function(G){df.ULS.sendTraceTag(539530529,306,10,"GET data from Roaming Settings Service with status: {0}, fallback",G?G.httpStatus:-1);this.v_b(this.Rha)};$d.prototype.SQa=function(G){df.ULS.sendTraceTag(539530530,306,10,"failed to POST data to Roaming Settings Service with status: {0}",
G?G.httpStatus:-1)};$d.prototype.YEe=function(){if(ig.AFrameworkApplication.ha.isChangeGateEnabled("OfficeVSO:5837059_TeachingUIForPrivateCatelogOnContentAddinEnabled")){var G=this.vih();0===G.targetType?(G.assetId?(this.NZc=G.assetId,this.W7i()):this.Kpf("NoAssetId"),G.addinId&&this.sZf(this.qea?this.qea+","+G.addinId:G.addinId),this.ZWc(null)):this.ZWc(G.addinId);df.ULS.sendTraceTag(528023563,306,50,"Show teaching callout for: {0}",G.addinId)}else G=this.uih(),this.ZWc(G),df.ULS.sendTraceTag(538248464,
306,50,"Show teaching callout for taskpane addin: {0}",G)};$d.prototype.W7i=function(){var G=this,ja=new we;ja.callbackFunc=function(Wa){if(Wa.errorCode)G.Kpf("FailToGetAppDetails");else if(Wa.value){Wa=Cl(Wa.value);for(var vb=Wa.next();!vb.done;vb=Wa.next()){vb=vb.value;var f=vb[1];if(f===G.NZc){Wa={solutionId:f,assetId:f};Wa.storeType=vb[6];Wa.storeId=vb[11];Wa.assetStoreId=vb[6];Wa.targetType=vb[3];Wa.width=vb[7];Wa.height=vb[8];Wa.displayName=vb[0];Wa.version=vb[4];Wa=new La(Wa);G.Oa.raiseEvent(wg.a.l7f,
Wa);break}}}};ja.storeType=OSF.StoreTypeEnum.PrivateCatalog;ja.fromInsertDialog=!1;ig.AFrameworkApplication.ha.isChangeGateEnabled("AvoidRefreshCacheEnabled")?ja.refresh=!1:ja.refresh=!0;this.contextActivationMgr.queryEntitlementDetails(ja)};$d.prototype.EDj=function(G){if("LastTeachingUIShowTime"in G){if(G=+new Date-+new Date(G.LastTeachingUIShowTime.toString()),G<ig.AFrameworkApplication.ha.NR("AddinShowTeachingUIIntervalInMS",864E5))return df.ULS.sendTraceTag(538248467,306,50,"ShouldShowTeachingUI: False, Teaching callout is shown {0}MS ago",
G),!1}else df.ULS.sendTraceTag(527523846,306,50,"userSetting has no date key");return!0};$d.prototype.uih=function(){for(var G=new gi.a("",0),ja=new gi.a("",0),Wa=0,vb=0,f=0,D=Cl(this.Rha),N=D.next();!N.done;N=D.next())if(N=N.value,!("excatalog"!==N.storeType||Mi.c(N.installTimeInMS)||!N.installTimeInMS||N.installTimeInMS<=ig.AFrameworkApplication.ha.NR("DateTimeInMSForNewAddin",16409664E5))){var fa=this.cgd(N);if(this.qea){var Ia=this.qea.split(",");if(0<Ia.length&&Array.contains(Ia,fa)){f++;df.ULS.sendTraceTag(538817694,
306,50,"This addin has shown teaching UI before");continue}}fa.startsWith("private_")?(G.value<N.installTimeInMS&&(G=new gi.a(fa,N.installTimeInMS)),vb++):(ja.value<N.installTimeInMS&&(ja=new gi.a(fa,N.installTimeInMS)),Wa++)}df.ULS.sendTraceTag(538817695,306,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",vb,Wa,f);return 0<ja.value?ja.key:0<G.value?G.key:null};$d.prototype.vih=function(){var G=new gi.a(new od,0),ja=new gi.a(new od,0),Wa=0,vb=0,f=
0;if(ig.AFrameworkApplication.ha.isChangeGateEnabled("FixAlertPeakEnabled")){var D=new He;if(0<this.context.E$.count)for(var N=Cl(this.context.E$),fa=N.next();!fa.done;fa=N.next())D.add(fa.value);if(0<this.context.Q1a.count)for(N=Cl(this.context.Q1a),fa=N.next();!fa.done;fa=N.next())D.add(fa.value)}else if(D=this.Rha,0<this.context.Q1a.count)for(N=Cl(this.context.Q1a),fa=N.next();!fa.done;fa=N.next())D.add(fa.value);D=Cl(D);for(fa=D.next();!fa.done;fa=D.next())if(fa=fa.value,!("excatalog"!==fa.storeType||
Mi.c(fa.installTimeInMS)||!fa.installTimeInMS||fa.installTimeInMS<=ig.AFrameworkApplication.ha.NR("DateTimeInMSForNewAddin",16409664E5))){N=this.cgd(fa);if(this.qea){var Ia=this.qea.split(",");if(0<Ia.length&&Array.contains(Ia,N)){f++;df.ULS.sendTraceTag(528345032,306,50,"This addin has shown teaching UI before");continue}}N.startsWith("private_")?(G.value<fa.installTimeInMS&&(G=new gi.a(Object.assign(new od,{addinId:N,targetType:fa.targetType,assetId:fa.assetId}),fa.installTimeInMS)),vb++):(ja.value<
fa.installTimeInMS&&(ja=new gi.a(Object.assign(new od,{addinId:N,targetType:fa.targetType,assetId:fa.assetId}),fa.installTimeInMS)),Wa++)}df.ULS.sendTraceTag(528345033,306,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",vb,Wa,f);return 0<ja.value?ja.key:0<G.value?G.key:Object.assign(new od,{addinId:null,targetType:-1,assetId:null})};$d.prototype.ZWc=function(G){for(var ja=new Kh.a,Wa=Cl(this.Rha),vb=Wa.next();!vb.done;vb=Wa.next()){var f=vb.value;
vb=Ae(f);G&&(f=this.cgd(f),G===f&&(vb.showCallout=!0,this.sZf(this.qea?this.qea+","+G:G)));ja.add(vb)}this.Rha&&1>this.Rha.count&&Nk.a.hPb(wg.a.A0b,"false",this.context.O0);G={};ja=(G.ack2=ja,G);ja[wg.a.y3]=this.context.O0;ja[wg.a.$M]=this.context.Is;this.Oa.raiseEvent(wg.a.z0b,new qd(ja),this)};$d.prototype.cgd=function(G){return Telemetry.PrivacyRules.IsPrivateAddin(G.storeType,G.storeId,G.assetId)?"private_"+G.installTimeInMS:G.assetId};$d.prototype.szi=function(){var G=!1;if(this.context.gka&&
1>this.context.gka.count)return G;var ja=yd();if(!ja)return G;for(var Wa=Cl(this.context.gka),vb=Wa.next();!vb.done;vb=Wa.next())if(vb=vb.value,vb.storeId&&vb.storeId.toLowerCase()===ja.toLowerCase()||vb.assetId&&vb.assetId.toLowerCase()===ja.toLowerCase()){G=Telemetry.PrivacyRules.GetAssetId(vb.storeType,vb.storeId,vb.solutionId);var f={};vb=(f.SDX_Id=G,f.SDX_TargetType=Mi.c(vb.targetType)?"":vb.targetType.toString(),f);Wh.a.sendTelemetryEvent(Object.assign(new ri.a,{name:"Office.Extensibility.Host.EmailAlertNotification",
dataFields:ej.a.gl(vb)}));G=!0}return G};$d.prototype.Iyi=function(){if(!(this.context.gka&&1>this.context.gka.count))if(this.y0b.Koi()){var G=this.y0b.D_h();G?(G=this.u1e(this.context.gka,G),df.ULS.sendTraceTag(527523848,306,50,"detect new addins using localStorage")):(G=this.u1e(this.context.gka,null),df.ULS.sendTraceTag(527523847,306,50,"no data from cache"));this.y0b.vxj(G)}else df.ULS.sendTraceTag(528589915,306,50,"Local storage got disabled")};$d.prototype.u1e=function(G,ja){var Wa={},vb=!1;
G=Cl(G);for(var f=G.next();!f.done;f=G.next()){f=f.value;var D=Telemetry.PrivacyRules.GetAssetId(f.storeType,f.storeId,f.assetId);D&&(!ja||D in ja||(this.Sya(f,D),df.ULS.sendTraceTag(527523849,306,50,"New addin detected,log to AppInstall")),"private"===D.toLowerCase()?vb||(vb=!0,Wa[D]=null):Wa[D]=null)}return Wa};$d.prototype.Sya=function(G,ja){var Wa=G.installTimeInMS?(new Date(G.installTimeInMS)).toISOString():"";if(ig.AFrameworkApplication.ha.isChangeGateEnabled("TargetTypeAndStoreIdFixEnabled")){var vb=
{};Wa=(vb["SDX.Id"]=ja,vb["SDX.AppInstallOrigin"]="Organization",vb["SDX.TargetType"]=Mi.c(G.targetType)?"":G.targetType.toString(),vb["SDX.AdminDeploymentTime"]=Wa,vb)}else vb={},Wa=(vb["SDX.Id"]=ja,vb["SDX.AppInstallOrigin"]="Organization",vb["SDX.TargetType"]=G.targetType,vb["SDX.AdminDeploymentTime"]=Wa,vb);Wh.a.sendTelemetryEvent(Object.assign(new ri.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:ej.a.gl(Wa)}));1===G.targetType&&(G={},ja=(G["SDX.Id"]=ja,G["SDX.AppInstallOrigin"]="Organization",
G["SDX.CommandPlacement"]="Ribbon",G),Wh.a.sendTelemetryEvent(Object.assign(new ri.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:ej.a.gl(ja)})))};$d.prototype.Kpf=function(G){var ja={};G=(ja.AppTeachingUICalloutAction=G,ja["SDX.Id"]=this.NZc,ja.AppTeachingUICalloutGoal="NewAdminDeployment",ja["SDX.AppInstallOrigin"]="Organization",ja);Wh.a.sendTelemetryEvent(Object.assign(new ri.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:ej.a.gl(G)}))};Object(Yd.a)($d,"AddInCommandsListLoader",
null,[]);Cd.prototype.insertOsfControl=function(G){return this.vna.insertOsfControl(G)};Cd.prototype.getManifestInvaildErrorString=function(){return this.vna.getManifestInvaildErrorString()};Cd.prototype.isAddinCommandsAsync=function(G,ja){this.vna.isAddinCommandsAsync(G,ja)};Cd.prototype.ownerAddinControlRecreated=function(G,ja){this.vna.ownerAddinControlRecreated(G,ja)};Cd.prototype.queryEntitlementDetails=function(G){this.vna.queryEntitlementDetails(G)};uk.Object.defineProperties(Cd.prototype,
{vna:{configurable:!0,enumerable:!0,get:function(){return this.oxg}}});Object(Yd.a)(Cd,"ContextActivationMgrWrapper",null,[98]);ed.prototype.createAddinDataProvider=function(G,ja){return OfficeExt.AddinDataProviderFactory.createAddinDataProvider(G,ja.vna)};uk.Object.defineProperties(ed,{instance:{configurable:!0,enumerable:!0,get:function(){ed.Na||(ed.Na=new ed);return ed.Na}}});ed.Na=null;Object(Yd.a)(ed,"OSFAddinDataProviderFactory",null,[77]);Object(Yd.a)(uc,"CacheItem",null,[]);id.prototype.kl=
function(G){df.ULS.sendTraceTag(526989510,220,15,"GetCacheItem");var ja=this.bFa.getItem(G);if(ja){var Wa=new uc;try{Wa=Sys.Serialization.JavaScriptSerializer.deserialize(ja,!0)}catch(vb){return this.bFa.removeItem(G),null}return Wa.Data?Wa.Data:Wa.data}return null};id.prototype.SAa=function(G){df.ULS.sendTraceTag(526989512,220,15,"RemoveCacheItem");this.bFa.removeItem(G)};Object(Yd.a)(id,"AppsDataCacheManager",null,[114]);var gk=b(1028);Lb.prototype.l1f=function(G,ja){G=wg.a.B2e()+G;gk.a.instance.setItem(G,
ja.toString())};Lb.prototype.D_h=function(){var G=wg.a.F5e();df.ULS.sendTraceTag(527523850,306,50,"set cache key:{0}",G);G=gk.a.instance.getItem(G);return fi.a(G)};Lb.prototype.vxj=function(G){var ja=wg.a.F5e();df.ULS.sendTraceTag(527523851,306,50,"get cache key:{0}",ja);gk.a.instance.setItem(ja,fi.c(G))};Lb.prototype.Koi=function(){return!!gk.a.instance.localStorage};uk.Object.defineProperties(Lb,{instance:{configurable:!0,enumerable:!0,get:function(){Lb.Na||(Lb.Na=new Lb);return Lb.Na}}});Lb.Na=
null;Object(Yd.a)(Lb,"AddInCommandsCacheManager",null,[80]);var Fk=Sys.EventArgs;Am(vd,Fk);Object(Yd.a)(vd,"InsertionParamEventArgs",Sys.EventArgs,[]);Object(Yd.a)(ie,"PostLaunchAddinCommandsParameters",null,[]);Zd.prototype.YEg=function(){window.addEventListener?(window.addEventListener("LaunchAddinTaskpane",Object(lh.a)(this,this.pTi,"onLaunchButtonClickedEventHandler"),!0),window.addEventListener("DismissCallout",Object(lh.a)(this,this.HOi,"onDismissButtonClickedEventHandler"),!0),window.addEventListener("CloseCallout",
Object(lh.a)(this,this.lNi,"onCloseButtonClickedEventHandler"),!0)):df.ULS.sendTraceTag(525112601,306,15,"AddEventListenerForTeachingCallout failed to get Window")};Zd.prototype.pTi=function(){var G=this,ja={};ja=(ja.AppTeachingUICalloutAction="ClickOnLaunch",ja["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.N9.storeType,this.N9.storeId,this.N9.assetId),ja.AppTeachingUICalloutGoal="NewAdminDeployment",ja["SDX.AppInstallOrigin"]="Organization",ja);ig.AFrameworkApplication.ha.isChangeGateEnabled("TeachingUIExtraLogForLaunch")&&
this.eib&&this.eib.tabs&&!this.eib.tabs[0].isOfficeTab&&(ja["SDX.FeatureFlags"]="NonOfficeTab");Wh.a.sendTelemetryEvent(Object.assign(new ri.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:ej.a.gl(ja)}));this.eib?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(this.eib,function(){var Wa=new vd;Wa.ki=G.N9;G.$a.raiseEvent(wg.a.hof,Wa)}):df.ULS.sendTraceTag(525112602,306,10,"onLaunchButtonClickedEventHandler failed to get a valid addinObj")};Zd.prototype.lNi=function(){var G=
{};G=(G.AppTeachingUICalloutAction="ClickOnClose",G["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.N9.storeType,this.N9.storeId,this.N9.assetId),G.AppTeachingUICalloutGoal="NewAdminDeployment",G["SDX.AppInstallOrigin"]="Organization",G);Wh.a.sendTelemetryEvent(Object.assign(new ri.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:ej.a.gl(G)}))};Zd.prototype.HOi=function(){var G={};G=(G.AppTeachingUICalloutAction="ClickOnDismiss",G["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.N9.storeType,
this.N9.storeId,this.N9.assetId),G.AppTeachingUICalloutGoal="NewAdminDeployment",G["SDX.AppInstallOrigin"]="Organization",G);Wh.a.sendTelemetryEvent(Object.assign(new ri.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:ej.a.gl(G)}))};Object(Yd.a)(Zd,"PrivateCatalogTeachingCalloutHandler",null,[]);Pc.prototype.Jha=function(G,ja){this.Rae.Jha(G,void 0===ja?null:ja);this.Yce=G};Pc.prototype.wcb=function(G){this.Rae.wcb(G)};uk.Object.defineProperties(Pc.prototype,{Cya:{configurable:!0,
enumerable:!0,get:function(){return this.Yce}}});Object(Yd.a)(Pc,"RibbonExtensibilityManagerWithChangeDetection",null,[121]);var X=b(943),ya=b(1020);Sc.prototype.Jha=function(G,ja){ja=void 0===ja?null:ja;if(G=ya.a.nwb(G)){appChrome.addInApi.dispatchActionsToInstallAddIn(G,ja);ja=Cl(G.tabs);for(var Wa=ja.next();!Wa.done;Wa=ja.next())if(Wa.value.autoFocus){appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(G,function(){});break}}};Sc.prototype.wcb=function(G){(G=ya.a.nwb(G))&&appChrome.addInApi.dispatchActionsToRemoveAddIn(G)};
Object(Yd.a)(Sc,"OneLineRibbonExtensibilityManager",null,[121]);var kb=b(1082);Ge.l3e=function(G){var ja=new Kh.a;if(Ge.LEe)for(var Wa=Cl(Ge.LEe),vb=Wa.next();!vb.done;vb=Wa.next())ja.add(vb.value);vb=null;switch(G){case "Workbook":vb=Ge.b2j;break;case "Document":vb=Ge.Elh;break;case "Presentation":vb=Ge.O5i}if(vb)for(G=Cl(vb),vb=G.next();!vb.done;vb=G.next())ja.add(vb.value);return ja};Ge.LEe=["PrimaryCommandSurface","ContextMenu"];Ge.b2j=null;Ge.Elh=null;Ge.O5i=null;Object(Yd.a)(Ge,"ExtensionPointType",
null,[]);uk.Object.defineProperties(Ud.prototype,{XEb:{configurable:!0,enumerable:!0,get:function(){return this.age||(this.age=new Kh.a)}},Zse:{configurable:!0,enumerable:!0,get:function(){return this.Aog}}});Object(Yd.a)(Ud,"ContextMenuExtensibility",null,[90]);Ne.prototype.w_e=function(){for(var G=new Sys.StringBuilder,ja=Cl(this.dZ),Wa=ja.next();!Wa.done;Wa=ja.next())G.append(Wa.value.G8());return this.zGg(G.toString())};Ne.prototype.zGg=function(G){var ja=new Sys.StringBuilder;ja.append("<Ribbon><Tabs>");
ja.append(G);ja.append("</Tabs></Ribbon>");return ja.toString()};uk.Object.defineProperties(Ne.prototype,{tabs:{configurable:!0,enumerable:!0,get:function(){return this.dZ}},hX:{configurable:!0,enumerable:!0,get:function(){return this.hxg}},startedNode:{configurable:!0,enumerable:!0,get:function(){return this.DAg}},Jab:{configurable:!0,enumerable:!0,get:function(){return this.emb}},lNh:{configurable:!0,enumerable:!0,get:function(){return this.dtg}}});Object(Yd.a)(Ne,"RibbonExtensibility",null,[160]);
Hd.prototype.createActionContext=function(G,ja){G={};G.ownerAddinInfo=this.entitlement;G.action=ja;return G};uk.Object.defineProperties(Hd.prototype,{entitlement:{configurable:!0,enumerable:!0,get:function(){return this.bsg}}});Object(Yd.a)(Hd,"AddInCommandsContextProvider",null,[]);ad.prototype.K9g=function(G){return new Hd(G)};ad.prototype.createActionBuilder=function(G,ja){return OfficeExt.DefaultControlActionBinder.createActionBuilder(G,ja.entitlement,ja.manifest)};ad.prototype.startApplyAddin=
function(G){this.P4d=G;var ja=this.K9g(G);this.actionBuilder=this.createActionBuilder(ja,G)};ad.prototype.endApplyAddin=function(){};ad.prototype.Nfd=function(G,ja,Wa){Wa=void 0===Wa?0:Wa;return this.ribbonBuilder.FBc&&0<this.ribbonBuilder.FBc.count||this.ribbonBuilder.gs&&0<this.ribbonBuilder.gs.count?new Ne(this.ribbonBuilder.FBc,this.AMh(G,ja),this.wse.startedNode,this.ribbonBuilder.P6.EZh(),Wa):null};ad.prototype.WZe=function(){var G=void 0===G?null:G;if(this.contextMenuBuilder.lnc&&0<this.contextMenuBuilder.lnc.count){G||
(G=this.wse.entitlement.solutionId);G=new Ud(G);for(var ja=Cl(this.contextMenuBuilder.lnc),Wa=ja.next();!Wa.done;Wa=ja.next())G.XEb.add(Wa.value);return G}return null};ad.prototype.AMh=function(G,ja){return this.ribbonBuilder.gs&&0<this.ribbonBuilder.gs.count?new ya.a(this.ribbonBuilder.gs,G,ja):null};uk.Object.defineProperties(ad.prototype,{wse:{configurable:!0,enumerable:!0,get:function(){return this.P4d}}});Object(Yd.a)(ad,"AddinCommandsBuilder",null,[]);sb.prototype.FOa=function(G,ja,Wa,vb,f,
D,N){function fa(kd,Xc,Ie,Ze){f(kd,Xc,Ie,Ze);kd=kb.a[Ia.Is]+Xc.assetId;Ie=Ia.dUa.Fc(kd);Xc=Ie.value;Ie.returnValue&&(Xc.stop(),Ia.dUa.remove(kd))}var Ia=this;if(0!==this.Is&&G)for(df.ULS.sendTraceTag(17326351,220,50,"Addin count {0}.",G.count),4===this.Is&&(df.ULS.sendTraceTag(17586256,220,100,String.format("Refresh AddinCommands for dataprovider : {0}",vb)),this.Z0g(G,vb),D()),G=Cl(G),vb=G.next();!vb.done;vb=G.next())if(vb=vb.value,vb.solutionId=vb.solutionId||vb.assetId,vb.storeType=vb.storeType||
vb.currentStoreType,vb.version=vb.version||vb.appVersion,df.ULS.sendTraceTag(17638144,220,50,String.format("{0}: Install addin {1}",this.qo.TK,Telemetry.PrivacyRules.GetAssetId(vb.storeType,vb.storeId,vb.solutionId))),this.Djg(vb))if(N&&vb.requireConsent)N(vb,function(kd){try{if(Ia.uP){var Xc=kb.a[Ia.Is]+kd.solutionId,Ie=Ia.uP.Hc("ComponentAttach",Xc);Ia.dUa.ia(Xc,Ie)}var Ze=Ia.AG.Uja(kd.storeType,kd.solutionId);6!==Ia.Is&&(Ze&&(Ia.d4b(Ze),Ze.QB.purge(!1)),Ia.Ni.insertOsfControl(Ia.IHb(kd,ja,Wa,fa)),
Ze&&Ia.Ni.ownerAddinControlRecreated(kd.solutionId,kd.storeType))}catch(Sf){df.ULS.sendTraceTag(572839882,220,10,String.format("{0}: AddinCommands SolutionId={1} Version={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",Ia.qo.TK,Telemetry.PrivacyRules.GetAssetId(kd.storeType,kd.storeId,kd.solutionId),kd.version,kd.storeType,kd.storeId,Sf.message)),fa(!1,kd,null,null)}});else try{if(this.uP){var pb=kb.a[this.Is]+vb.solutionId,Wb=this.uP.Hc("ComponentAttach",pb);this.dUa.ia(pb,
Wb)}var Nc=this.AG.Uja(vb.storeType,vb.solutionId);6!==this.Is&&(Nc&&(this.d4b(Nc),Nc.QB.purge(!1)),this.Ni.insertOsfControl(this.IHb(vb,ja,Wa,fa)),Nc&&this.Ni.ownerAddinControlRecreated(vb.solutionId,vb.storeType))}catch(kd){df.ULS.sendTraceTag(17388185,220,10,String.format("{0}: AddinCommands SolutionId={1} AppVersion={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",this.qo.TK,Telemetry.PrivacyRules.GetAssetId(vb.storeType,vb.storeId,vb.solutionId),vb.version,vb.storeType,
vb.storeId,kd.message)),fa(!1,vb,null,null)}else fa(!1,vb,null,null)};sb.prototype.dwi=function(G,ja,Wa,vb,f,D){function N(Nc,kd,Xc,Ie){D(Nc,kd,Xc,Ie);Nc=kb.a[fa.Is]+kd.solutionId;Xc=fa.dUa.Fc(Nc);kd=Xc.value;Xc.returnValue&&(kd.stop(),fa.dUa.remove(Nc))}var fa=this;if(6===this.Is&&G)if(G.solutionId=G.solutionId||G.assetId,G.storeType=G.storeType||G.currentStoreType,G.version=G.version||G.appVersion,df.ULS.sendTraceTag(592290762,220,50,String.format("{0}: Install dynamic ribbon {1}",this.qo.TK,Telemetry.PrivacyRules.GetAssetId(G.storeType,
G.storeId,G.solutionId))),this.Djg(G))try{if(this.uP){var Ia=kb.a[this.Is]+G.solutionId,pb=this.uP.Hc("ComponentAttach",Ia);this.dUa.ia(Ia,pb)}var Wb=this.AG.Uja(G.storeType,G.solutionId);Wb||N(!1,G,null,null);ig.AFrameworkApplication.sa&&ig.AFrameworkApplication.sa.Qa.delayInstallAddInIsEnabled?this.u_e(G,ja,vb,f,Wa,function(Nc){N(Nc,G,Wa,Wb.displayName)}):(this.u_e(G,ja,vb,f,Wa),N(!0,G,Wa,Wb.displayName))}catch(Nc){df.ULS.sendTraceTag(592290764,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to launch dynamic commands. Error message : {5}.",
this.qo.TK,Telemetry.PrivacyRules.GetAssetId(G.storeType,G.storeId,G.solutionId),G.version,G.storeType,G.storeId,Nc.message)),N(!1,G,null,null)}else N(!1,G,null,null)};sb.prototype.rLi=function(G,ja,Wa,vb,f,D){if(D)if(D._isAddinCommandsManifest(this.qo.TK))try{ig.AFrameworkApplication.sa&&ig.AFrameworkApplication.sa.Qa.delayInstallAddInIsEnabled?this.t_e(G,ja,Wa,f,D,function(N){vb(N,G,D,D.getDefaultDisplayName())}):(this.t_e(G,ja,Wa,f,D),vb(!0,G,D,D.getDefaultDisplayName()))}catch(N){df.ULS.sendTraceTag(17586257,
220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to generate ui extensibility. Error message : {5}.",this.qo.TK,Telemetry.PrivacyRules.GetAssetId(G.storeType,G.storeId,G.solutionId),G.version,G.storeType,G.storeId,N.message)),vb(!1,G,D,D.getDefaultDisplayName())}else df.ULS.sendTraceTag(17586258,220,10,String.format("{0}: Regular content/taskpane addin AssetId={1} AppVersion={2} StoreType={3} StoreId={4} is not supported for addincommands.",this.qo.TK,
Telemetry.PrivacyRules.GetAssetId(G.storeType,G.storeId,G.solutionId),G.version,G.storeType,G.storeId)),vb(!1,G,null,null);else df.ULS.sendTraceTag(17586259,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to get manifest.",this.qo.TK,Telemetry.PrivacyRules.GetAssetId(G.storeType,G.storeId,G.solutionId),G.version,G.storeType,G.storeId)),vb(!1,G,null,null)};sb.prototype.IHb=function(G,ja,Wa,vb){var f=this,D={},N=document.createElement("div");N.setAttribute("visible",
"false");D.div=N;D.id=G.solutionId||G.id;D.solutionId=G.solutionId||G.id;D.version=G.version||G.appVersion;D.storeType=G.storeType||G.currentStoreType;D.storeId=G.storeId;D.assetId=G.assetId;D.assetStoreId=G.assetStoreId;D.isvirtualOsfControl=!0;D.virtualOsfControlActivationCallback=function(fa,Ia){var pb=f.AG.Uja(G.storeType||G.currentStoreType,G.solutionId||G.id);pb&&(pb.isUpgraded&&(G.isUpgraded=!0),f.d4b(pb));f.rLi(G,ja,Wa,vb,fa,Ia)};D.reason=3===this.Is?Microsoft.Office.WebExtension.InitializationReason.Inserted:
Microsoft.Office.WebExtension.InitializationReason.DocumentOpened;D.marketplaceID=G.id;D.marketplaceVersion=G.appVersion;D.store=G.storeId;return D};sb.prototype.t_e=function(G,ja,Wa,vb,f,D){D=void 0===D?null:D;var N={};N.solutionId=vb.getSolutionId();N.version=vb.getVersion();N.storeType=vb.getStoreType();N.storeId=vb.getStoreId();N.assetId=vb.getSolutionId();N.assetStoreId=vb.getAssetStoreId();N.targetType=vb.getOsfControlType();N.appVersion=vb.getMarketplaceVersion();var fa=null,Ia=null;if(ig.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",
!1))fa=(new OfficeExt.Parser.AddinCommandsManifestParser(this.qo.TK,this.qo.formFactor)).parseExtensions(N,f,this.Sha),Ia=Ge.l3e(this.qo.TK);else try{fa=(new OfficeExt.Parser.AddinCommandsManifestParser(this.qo.TK,this.qo.formFactor)).parseExtensions(N,f,this.Sha),Ia=Ge.l3e(this.qo.TK)}catch(Vg){throw df.ULS.sendTraceTag(538752131,220,10,"Exception encounter while parsing manifest. Exception: "+Vg.message),Vg;}if(Ia&&0<Ia.count){if(ig.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",
!1)){var pb=ja(G);var Wb=Wa(G);Wa=!!ig.AFrameworkApplication.ha&&ig.AFrameworkApplication.ha.ra("AddinCommandsMultipleCustomTabsEnabled");pb=new ad(pb,null,Wb);Ia=Cl(Ia);for(Wb=Ia.next();!Wb.done;Wb=Ia.next())pb.commandSurface=Wb.value,fa.apply(pb,this.Sha,Wa)}else try{var Nc=ja(G),kd=Wa(G),Xc=!!ig.AFrameworkApplication.ha&&ig.AFrameworkApplication.ha.ra("AddinCommandsMultipleCustomTabsEnabled");pb=new ad(Nc,null,kd);var Ie=Cl(Ia);for(Wb=Ie.next();!Wb.done;Wb=Ie.next())pb.commandSurface=Wb.value,
fa.apply(pb,this.Sha,Xc)}catch(Vg){throw df.ULS.sendTraceTag(538752132,220,10,"Exception encounter while building ribbon. Exception: "+Vg.message),Vg;}if(OSF.OUtil.checkFlight(14))try{var Ze=pb.Nfd(G.solutionId||G.id,f.getDefaultDisplayName()),Sf=pb.WZe();Ze&&this.ribbonManager.Jha(Ze,D);Sf&&this.contextMenuManager.hpe(Sf);this.AG.Jpe(vb,Ze,Sf,f.getDefaultDisplayName());df.ULS.sendTraceTag(17326353,220,100,"Add-in name: {0}.",f.getDefaultDisplayName())}catch(Vg){throw OfficeExt.DevConsole.log(Vg),
df.ULS.sendTraceTag(539870850,220,10,"Error generating ribbon extensibility. Exception: "+Vg.message),Vg;}else try{var ag=pb.Nfd(G.solutionId||G.id,f.getDefaultDisplayName()),og=pb.WZe();ag&&this.ribbonManager.Jha(ag);og&&this.contextMenuManager.hpe(og);this.AG.Jpe(vb,ag,og,f.getDefaultDisplayName());df.ULS.sendTraceTag(579376721,220,100,"Add-in name: {0}.",f.getDefaultDisplayName())}catch(Vg){throw df.ULS.sendTraceTag(539870851,220,10,"Error generating ribbon extensibility. Exception: "+Vg.message),
Vg;}}};sb.prototype.u_e=function(G,ja,Wa,vb,f,D){D=void 0===D?null:D;var N={};N.solutionId=G.solutionId||G.assetId;N.version=G.version||G.appVersion;N.storeType=G.storeType||G.currentStoreType;N.storeId=G.assetStoreId;N.assetId=G.assetId;N.assetStoreId=G.assetStoreId;N.targetType=G.targetType;N.appVersion=G.appVersion;var fa=new OfficeExt.JsonParser.AddinCommandsJsonParser(this.qo.TK,this.qo.formFactor);try{var Ia=ja.getManifest(),pb=fa.parse(N,Ia,f,this.Sha,ja.getSharedRuntimeId()),Wb=Wa(G),Nc=vb(G),
kd=new ad(Wb,null,Nc);kd.commandSurface="PrimaryCommandSurface";pb.apply(kd,this.Sha,!0);if(kd.ribbonBuilder.gs&&0<kd.ribbonBuilder.gs.count){var Xc=kd.Nfd(G.solutionId||G.id,ja.getManifest().getDefaultDisplayName(),1);ig.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RibbonExtensibilityNullCheckKillSwitch",!1)?this.ribbonManager.Jha(Xc,D):Xc&&this.ribbonManager.Jha(Xc,D);this.AG.PFg(ja,Xc,f,ja.getManifest().getDefaultDisplayName());df.ULS.sendTraceTag(592290767,220,
100,"Add-in name: {0}.",ja.getManifest().getDefaultDisplayName())}}catch(Ie){df.ULS.sendTraceTag(592290768,220,15,"Failed to generate dynamic Add-in commands. Add-in name: {0}. Error: {1}",ja.getManifest().getDefaultDisplayName(),Ie.toString()),OSF.OUtil.checkFlight(14)&&OfficeExt.DevConsole.log(Ie)}};sb.prototype.d4b=function(G){G.Mo&&this.ribbonManager.wcb(G.Mo);G.Asb&&this.contextMenuManager.Aej(G.Asb);this.AG.hej(G.QB.getStoreType(),G.QB.getSolutionId())};sb.prototype.Z0g=function(G,ja){ja=De(ja);
for(var Wa=Cl(this.AG.d7a),vb=Wa.next();!vb.done;vb=Wa.next())if(vb=vb.value,vb.QB.getStoreType()===ja){for(var f=!0,D=Cl(G),N=D.next();!N.done;N=D.next())if((N=N.value)&&vb.Ikf(N.storeType||N.currentStoreType,N.solutionId||N.id)){f=!1;break}f&&(this.d4b(vb),vb.QB.purge(!1))}};sb.prototype.Djg=function(G){G.solutionId!==G.assetId&&df.ULS.sendTraceTag(540379092,220,50,"VerifyInsertAgaveParameter solutionId != AssetId");G.id!==G.assetId&&df.ULS.sendTraceTag(540379093,220,50,"VerifyInsertAgaveParameter Id != AssetId");
return!!G&&!!G.solutionId&&!!G.version&&!!G.storeType&&!!G.storeId};Object(Yd.a)(sb,"AddInCommandsIntegration",null,[]);var Zb=b(948);Ac.prototype.HHg=function(G){this.$a.addHandler(wg.a.vse,G)};Ac.prototype.BJg=function(G){this.$a.addHandler(wg.a.hof,G)};Ac.prototype.dLg=function(G){this.$a.addHandler(wg.a.n7f,G)};Ac.prototype.NHg=function(G){this.$a.addHandler(wg.a.p_c,G)};Ac.prototype.FOa=function(G,ja,Wa){var vb=this,f=Wa[wg.a.m_a],D=void 0===Wa[wg.a.$M]?0:Wa[wg.a.$M];if(f&&0!==D)if(0>=f.count&&
4!==D)this.tsc(new ie(D,null,null,G,ja,null,!0));else{var N=f.count,fa=new Pc(new fd(G));Wa=void 0===Wa[wg.a.y3]?-1:Wa[wg.a.y3];(new sb(D,this.an,this.fWa,fa,this.x7d,this.ksa,this.sqa)).FOa(f,function(Ia){return vb.ZYb.wVg(Ia.solutionId,vb.sqa,vb.fWa)},function(Ia){return vb.ZYb.nye(Ia.solutionId)},Wa,function(Ia,pb,Wb,Nc){N--;Wb=new ie(D,pb,fa,G,ja,Nc,0>=N);Ia&&pb?vb.tsc(Wb):(vb.KXa&&(3===D||pb&&pb.isUpgraded)&&(Ia="",pb&&(Ia=Telemetry.PrivacyRules.GetAssetId(pb.storeType,pb.storeId,pb.solutionId)),
pb={},pb=(pb.SDX_AppInstallOrigin="User",pb.SDX_IsAutoLaunchEnabled=vb.OEa,pb.SDX_AppInstallErrorCode="onAddinCompleted.fail",pb.SDX_Id=Ia,pb),Wh.a.sendTelemetryEvent(Object.assign(new ri.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:ej.a.gl(pb)}))),vb.ssc(Wb))},function(){vb.ioc();0>=f.count&&4===D&&vb.ksa.myc()},this.fge)}else this.KXa&&(Wa={},Wa=(Wa.SDX_AppInstallOrigin="User",Wa.SDX_IsAutoLaunchEnabled=this.OEa,Wa.SDX_AppInstallErrorCode="LaunchAddinCommands.fail",Wa.SDX_Id="",Wa),
Wh.a.sendTelemetryEvent(Object.assign(new ri.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:ej.a.gl(Wa)}))),df.ULS.sendTraceTag(17638115,220,10,String.format("{0}: parameters are invalid for LaunchAddinCommands.",this.fWa.TK)),this.ssc(new ie(D,null,null,G,ja,null,!0))};Ac.prototype.vwi=function(G,ja,Wa){var vb=this,f=Wa[wg.a.m_a],D=void 0===Wa[wg.a.$M]?0:Wa[wg.a.$M];if(f&&0!==D)if(0>=f.count&&4!==D)this.tsc(new ie(D,null,null,null,ja,null,!0));else{var N=f.count,fa=new Pc(new Sc),Ia=void 0===
Wa[wg.a.y3]?-1:Wa[wg.a.y3],pb=new sb(D,this.an,this.fWa,fa,this.x7d,this.ksa,this.sqa),Wb=function(Ze){return vb.ZYb.hVg(Ze.solutionId,vb.sqa,vb.fWa,G)},Nc=function(Ze){return vb.ZYb.nye(Ze.solutionId)},kd=function(Ze,Sf,ag){N--;ag=new ie(D,Sf,fa,null,ja,ag,0>=N);Ze&&Sf?vb.tsc(ag):(vb.KXa&&(3===D||Sf&&Sf.isUpgraded)&&(Ze="",Sf&&(Ze=Telemetry.PrivacyRules.GetAssetId(Sf.storeType,Sf.storeId,Sf.solutionId)),Sf={},Sf=(Sf.SDX_AppInstallOrigin="User",Sf.SDX_IsAutoLaunchEnabled=vb.OEa,Sf.SDX_AppInstallErrorCode=
"onAddinCompletedBase.fail",Sf.SDX_Id=Ze,Sf),Wh.a.sendTelemetryEvent(Object.assign(new ri.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:ej.a.gl(Sf)}))),vb.ssc(ag));N||ig.AFrameworkApplication.sa.updateCommandUI()},Xc=function(Ze,Sf,ag,og){kd(Ze,Sf,og)},Ie=function(){vb.ioc();0>=f.count&&4===D&&vb.ksa.myc()};6===D?(Ia=Wa[wg.a.LJa],Wa=Wa[wg.a.MJa],pb.dwi(f.pa(0),Ia,Wa,Wb,Nc,function(Ze,Sf,ag,og){kd(Ze,Sf,og)})):pb.FOa(f,Wb,Nc,Ia,Xc,Ie,this.fge)}else this.KXa&&(pb={},pb=(pb.SDX_AppInstallOrigin=
"User",pb.SDX_IsAutoLaunchEnabled=this.OEa,pb.SDX_AppInstallErrorCode="LaunchOneLineRibbonAddinCommands.fail",pb.SDX_Id="",pb),Wh.a.sendTelemetryEvent(Object.assign(new ri.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:ej.a.gl(pb)}))),df.ULS.sendTraceTag(24786637,220,10,String.format("{0}: parameters are invalid for LaunchOnlineAddinCommands.",this.fWa.TK)),this.ssc(new ie(D,null,null,null,ja,null,!0))};Ac.prototype.ssc=function(G){this.ioc(G);this.e8f(!1,G)};Ac.prototype.tsc=function(G){var ja=
G.ki,Wa=null;null!==ja&&(Wa=ja.storeType||ja.currentStoreType,Wa=Wa.toLowerCase());if(this.KXa&&G&&"omex"===Wa&&(3===G.Is||ja.isUpgraded)){var vb={};vb=(vb.SDX_AppInstallOrigin="User",vb.SDX_IsAutoLaunchEnabled=this.OEa,vb.SDX_AppInstallErrorCode="0",vb.SDX_Id=Telemetry.PrivacyRules.GetAssetId(Wa,ja.storeId,ja.solutionId),vb);Wh.a.sendTelemetryEvent(Object.assign(new ri.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:ej.a.gl(vb)}))}this.ioc(G);this.OEa&&"omex"===Wa&&G.e1&&(3===G.Is||ja.isUpgraded)&&
(vb=new vd,vb.ki=ja,vb.Mo=G.e1.Cya,this.$a.raiseEvent(wg.a.p_c,vb));if(this.Oug){vb=je();var f=yd();vb&&ja&&"excatalog"===ja.storeType&&G.e1&&5===G.Is&&f&&(ja.storeId&&ja.storeId.toLowerCase()===f.toLowerCase()||ja.assetId&&ja.assetId.toLowerCase()===f.toLowerCase())&&(vb=new vd,vb.ki=ja,vb.Mo=G.e1.Cya,this.$a.raiseEvent(wg.a.p_c,vb),df.ULS.sendTraceTag(525362254,220,50,"Email alert triggers AutoLaunchAddin event."))}ja&&(Lb.instance.l1f(Hf(Wa),!0),"uploadfiledevcatalog"===Wa&&(vb=this.sog.createAddinDataProvider(Wa,
this.an))&&vb.localCacheAddinCommands(this.an.vna,ja.solutionId||ja.id,ja.version||ja.appVersion,ja.storeId),this.Npj(G.e1.Cya,Wa,G.Is,G.sZe),Nk.a.hPb(wg.a.A0b,"true",Hf(Wa)));this.e8f(!0,G)};Ac.prototype.e8f=function(G,ja){if(G)if(ig.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&ja.e1&&5===ja.Is&&ja.e1.Cya&&void 0!==ja.ki.showCallout&&null!==ja.ki.showCallout&&ja.ki.showCallout)(new Zd(this.$a,ja.ki,ya.a.nwb(ja.e1.Cya))).YEg(),
G=new vd,G.Mo=ja.e1.Cya,G.ki=ja.ki,this.$a.raiseEvent(wg.a.n7f,G);else if(3!==ja.Is)ja.onf&&this.ksa.myc();else{if(ja.e1&&ja.e1.Cya&&(G=Object(Ii.a)(Zb.Ribbon,ja.sZe),"hardcodedpreinstall"!==ja.ki.storeType)){var Wa=!1;this.OEa&&(Wa=ja.ki.isAutoLaunched);lk.a.IEj(G,ja.jKh,ja.displayName,ja.e1.Cya,Wa)}}else 3===ja.Is?ja.ki&&"uploadfiledevcatalog"===ja.ki.storeType.toLowerCase()?(ja=this.sqa.WTh(ja.ki.solutionId),lk.a.DUd(ja?ja:CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)):
this.ksa.r2f():ja.onf&&this.ksa.myc()};Ac.prototype.ioc=function(G){var ja=(G=void 0===G?null:G)?G.ki:null,Wa=new vd;if(Wa.ki=ja){var vb;(vb=this.ksa.Uja(ja.storeType||ja.currentStoreType,ja.solutionId||ja.id,6===G.Is?1:0))&&vb.Mo&&(Wa.Mo=vb.Mo,this.KXa&&3===G.Is&&"hardcodedpreinstall"!==ja.storeType)&&(G="",vb.Mo.hX&&vb.Mo.hX.gs&&(vb=vb.Mo.hX.gs.pa(0))&&(G=vb.id),vb={},ja=(vb.SDX_CommandPlacement=G,vb.SDX_PinningAction="Pinning",vb.SDX_PinningActionErrorCode="0",vb.SDX_Id=Telemetry.PrivacyRules.GetAssetId(ja.storeType,
ja.storeId,ja.solutionId),vb),Wh.a.sendTelemetryEvent(Object.assign(new ri.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:ej.a.gl(ja)})))}this.$a.raiseEvent(wg.a.vse,Wa)};Ac.prototype.Npj=function(G,ja,Wa,vb){vb=Object(Ii.a)(Zb.Ribbon,vb);G&&vb&&(G=G.tabs.pa(0).nUa[X.a.id],3===Wa&&"hardcodedpreinstall"!==ja&&vb.uQd(G),vb.Fri(G)&&vb.Mpj())};Object(Yd.a)(Ac,"LaunchAddinCommandsHandler",null,[97]);b(630);b(623);Ob.prototype.G8=function(){return Ng.k(this.A7d,this.bFi(),this.nB)};Ob.prototype.bFi=
function(){var G=null;if(this.Jga){G=new Sys.StringBuilder('<Menu><MenuSection DisplayMode="Menu16"><Controls>');for(var ja=Cl(this.Jga),Wa=ja.next();!Wa.done;Wa=ja.next())G.append(Wa.value.G8());G.append("</Controls></MenuSection></Menu>")}return G?G.toString():""};uk.Object.defineProperties(Ob.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this._id||""}},nB:{configurable:!0,enumerable:!0,get:function(){return this.y7d||(this.y7d={})}},controlType:{configurable:!0,enumerable:!0,
get:function(){return this.A7d||""}},menuItems:{configurable:!0,enumerable:!0,get:function(){return this.Jga||(this.Jga=new Kh.a)}}});Object(Yd.a)(Ob,"ControlDefinition",null,[95]);hd.prototype.G8=function(){return Ng.k(X.a.button,null,this.PPc)};uk.Object.defineProperties(hd.prototype,{vS:{configurable:!0,enumerable:!0,get:function(){return this.PPc||(this.PPc={})}},id:{configurable:!0,enumerable:!0,get:function(){return this._id||""}}});Object(Yd.a)(hd,"MenuItemDefinition",null,[135]);sc.prototype.G8=
function(){var G=null;if(this.u9){G=new Sys.StringBuilder;for(var ja=Cl(this.u9),Wa=ja.next();!Wa.done;Wa=ja.next())G.append(Wa.value.G8())}return G?G.toString():""};uk.Object.defineProperties(sc.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this._id}},controls:{configurable:!0,enumerable:!0,get:function(){return this.u9||(this.u9=new Kh.a)}}});Object(Yd.a)(sc,"OfficeMenuDefinition",null,[93]);var xc=b(26);Pb.prototype.addButton=function(G){df.ULS.sendTraceTag(17085952,220,50,
"ContextMenu button actiontype: {0}.",G.actionType);this.DJ=new Ob(this.KQ(G.id),X.a.button);this.DJ.nB[X.a.Whb]=G.label;this.DJ.nB[X.a.pDa]=G.label;this.DJ.nB[X.a.sDa]=G.icon["16"];this.xta(this.DJ.nB[X.a.id],G.action);this.m3(this.DJ.nB);this.QWa.controls.add(this.DJ);this.DJ=null};Pb.prototype.startBuildMenu=function(G){if(Mi.c(this.QWa))this.QWa=new sc(G.id);else{var ja=this.KQ(G.id);this.DJ=new Ob(ja,X.a.n_);this.oia(this.DJ.nB,G);this.DJ.nB[X.a.sDa]=G.icon["16"];this.DJ.nB[X.a.YVa]=xc.a.alwaysEnabled}};
Pb.prototype.addMenuItem=function(G){df.ULS.sendTraceTag(17085953,220,50,"ContextMenu menu item actiontype: {0}.",G.actionType);var ja=new hd(this.KQ(G.id));this.oia(ja.vS,G);G.icon&&(ja.vS[X.a.sDa]=G.icon["16"]);this.xta(ja.vS[X.a.id],G.action);this.m3(ja.vS);this.DJ.menuItems.add(ja)};Pb.prototype.endBuildMenu=function(){Mi.c(this.DJ)?(this.lnc.add(this.QWa),this.QWa=null):(this.QWa.controls.add(this.DJ),this.DJ=null)};Pb.prototype.xta=function(G,ja){this.nob.bindAction(G,ja)};Pb.prototype.m3=function(G){this.kIa.m3(G)};
Pb.prototype.KQ=function(G){return this.P6.pwa(G)};Pb.prototype.oia=function(G,ja){G[X.a.Whb]=ja.label;G[X.a.pDa]=ja.label};uk.Object.defineProperties(Pb.prototype,{P6:{configurable:!0,enumerable:!0,get:function(){return this.Rlb}},kIa:{configurable:!0,enumerable:!0,get:function(){return this.Wfa}},nob:{configurable:!0,enumerable:!0,get:function(){return this.Mfa}},lnc:{configurable:!0,enumerable:!0,get:function(){return this.vwg}}});Object(Yd.a)(Pb,"ContextMenuExtensibilityCreator",null,[110,105]);
fb.prototype.pwa=function(G){return this.APa+G};uk.Object.defineProperties(fb.prototype,{APa:{configurable:!0,enumerable:!0,get:function(){return this.qFa}}});Object(Yd.a)(fb,"DefaultContextMenuNamingProvider",null,[109]);va.prototype.KRh=function(G){return this.Q6g+G};uk.Object.defineProperties(va.prototype,{XNj:{configurable:!0,enumerable:!0,get:function(){return this.vBg}},Q6g:{configurable:!0,enumerable:!0,get:function(){return this.$qg}}});Object(Yd.a)(va,"DefaultRibbonGroupTemplate",null,[136]);
uk.Object.defineProperties(Kc.prototype,{Ifb:{configurable:!0,enumerable:!0,get:function(){return this.Mnb}}});Object(Yd.a)(Kc,"DefaultRibbonGroupTemplateResolver",null,[108]);var cd=b(1367);Zc.prototype.bindAction=function(G,ja){OfficeExt.DefaultControlActionBinder.bindAction(G,ja)};Object(Yd.a)(Zc,"DefaultUIControlActionBinder",null,[107]);Uc.prototype.m3=function(G){G[X.a.YVa]=this.command};uk.Object.defineProperties(Uc.prototype,{command:{configurable:!0,enumerable:!0,get:function(){return this.QDa}}});
Object(Yd.a)(Uc,"DefaultUIControlCommandBinder",null,[103]);var dd=b(31);Object(Yd.a)(ac,"AddInControl",null,[]);Object(Yd.a)(mb,"AddInGroup",null,[]);Object(Yd.a)(qb,"AddInMenuItem",null,[]);Object(Yd.a)(Sb,"AddInTab",null,[]);xb.prototype.startBuildTab=function(G){var ja=G.isOfficeTab?G.id:this.P6.nkd(G.id),Wa=G.isOfficeTab?null:G.label;this.Zv=Object.assign(new Sb,{id:ja,title:Wa,isOfficeTab:G.isOfficeTab,visible:G.visible,groups:[],tabType:G.tabType,insertBefore:G.insertBefore,insertAfter:G.insertAfter,
autoFocus:G.autoFocus})};xb.prototype.startBuildGroup=function(G){var ja=this.KQ(G.id);this.vx=Object.assign(new mb,{id:ja,mlrId:G.mlrId,title:G.label,controls:[],groupType:0})};xb.prototype.addNativeGroup=function(G){this.vx=Object.assign(new mb,{id:G.id,mlrId:G.mlrId,title:G.label,controls:[],groupType:1});this.Zv.groups.push(this.vx)};xb.prototype.addButton=function(G){var ja=this.KQ(G.id);ja&&(this.xta(ja,G.action),df.ULS.sendTraceTag(24786640,220,50,"AddInDataTransferObject button actiontype: {0}.",
G.actionType),G=Object.assign(new ac,{id:ja,title:G.label,iconLocation:this.did(G),enabled:G.enabled,controlType:0,attributes:this.oia()}),this.C9d.Xoe(new dd.a(ja,this.kIa.command.toString())),this.vx.controls.push(G))};xb.prototype.addNativeControl=function(G){G.id&&(df.ULS.sendTraceTag(590709920,220,50,"AddInDataTransferObject button actiontype: {0}.",G.actionType),G=Object.assign(new ac,{id:G.id,title:"",iconLocation:"",enabled:G.enabled,controlType:2,attributes:this.oia()}),this.vx.controls.push(G))};
xb.prototype.startBuildMenu=function(G){var ja=this.KQ(G.id);ja&&(this.v9=Object.assign(new ac,{id:ja,title:G.label,iconLocation:this.did(G),controlType:1,attributes:{},menuItems:[]}))};xb.prototype.addMenuItem=function(G){var ja=this.KQ(G.id);ja&&(this.xta(ja,G.action),df.ULS.sendTraceTag(24786642,220,50,"AddInDataTransferObject menu item actiontype: {0}.",G.actionType),G=Object.assign(new qb,{id:ja,title:G.label,iconLocation:this.did(G),enabled:G.enabled,attributes:this.oia()}),this.C9d.Xoe(new dd.a(ja,
this.kIa.command.toString())),this.v9.menuItems.push(G))};xb.prototype.endBuildMenu=function(){Mi.c(this.v9.id)||this.vx.controls.push(this.v9);this.v9=null};xb.prototype.endBuildGroup=function(){Mi.c(this.vx.id)||this.Zv.groups.push(this.vx);this.vx=null};xb.prototype.endBuildTab=function(){Mi.c(this.Zv.id)||this.QRb.add(this.Zv);this.Zv=null};xb.prototype.oia=function(){var G={};this.m3(G);return G};xb.prototype.did=function(G){return G.icon["80"]?G.icon["80"]:G.icon["32"]};xb.prototype.m3=function(G){this.kIa.m3(G)};
xb.prototype.KQ=function(G){return this.P6.pwa(G)};xb.prototype.xta=function(G,ja){this.nob.bindAction(G,ja)};uk.Object.defineProperties(xb.prototype,{P6:{configurable:!0,enumerable:!0,get:function(){return this.Rlb}},gs:{configurable:!0,enumerable:!0,get:function(){return this.QRb}},FBc:{configurable:!0,enumerable:!0,get:function(){return null}},nob:{configurable:!0,enumerable:!0,get:function(){return this.Mfa}},kIa:{configurable:!0,enumerable:!0,get:function(){return this.Wfa}}});Object(Yd.a)(xb,
"OneLineRibbonExtensibilityCreator",null,[104,105]);Xb.prototype.G8=function(){for(var G=new Kh.a,ja=Cl(this.Yia),Wa=ja.next();!Wa.done;Wa=ja.next())G.add(Wa.value.G8());G=Ng.e.apply(null,[X.a.ZVa,null].concat(G.toArray()));return Ng.e(X.a.GROUP,this.Vwa,G)};uk.Object.defineProperties(Xb.prototype,{Ifb:{configurable:!0,enumerable:!0,get:function(){return this.Mnb},set:function(G){this.Mnb=G;this.Vwa[X.a.h4d]=this.Mnb}},Vwa:{configurable:!0,enumerable:!0,get:function(){return this.H$d||(this.H$d={})}},
Yia:{configurable:!0,enumerable:!0,get:function(){return this.z7d||(this.z7d=new Kh.a)}}});Object(Yd.a)(Xb,"GroupDefinition",null,[]);hb.prototype.G8=function(){for(var G=new Kh.a,ja=new Kh.a,Wa=Cl(this.LPd),vb=Wa.next();!vb.done;vb=Wa.next())G.add(vb.value.G8());Wa=Cl(this.NK);for(vb=Wa.next();!vb.done;vb=Wa.next())ja.add(vb.value.G8());ja=this.Jye(X.a.Shb,this.q9e,ja.toArray());G=this.Jye(X.a.uGc,this.h_f,G.toArray());return Ng.e(X.a.f4d,this.nUa,G,ja)};hb.prototype.Jye=function(G,ja,Wa){var vb=
{};vb[X.a.id]=ja;return Ng.e.apply(null,[G,vb].concat(Wa))};uk.Object.defineProperties(hb.prototype,{gCa:{configurable:!0,enumerable:!0,get:function(){return this._id}},nUa:{configurable:!0,enumerable:!0,get:function(){return this.Fle||(this.Fle={})}},NK:{configurable:!0,enumerable:!0,get:function(){return this.I$d||(this.I$d=new Kh.a)}},LPd:{configurable:!0,enumerable:!0,get:function(){return this.Fje||(this.Fje=new Kh.a)}}});Object(Yd.a)(hb,"TabDefinition",null,[]);Sa.prototype.startBuildTab=function(G){G=
G.isOfficeTab?this.P6.rZh(G.id):this.P6.nkd(G.id);this.Zv=new hb(G)};Sa.prototype.startBuildGroup=function(G){G=this.KQ(G.id);this.vx=new Xb(G)};Sa.prototype.addButton=function(G){var ja=this.KQ(G.id);this.xta(ja,G.action)};Sa.prototype.startBuildMenu=function(){};Sa.prototype.addMenuItem=function(G){var ja=this.KQ(G.id);this.xta(ja,G.action)};Sa.prototype.endBuildMenu=function(){};Sa.prototype.endBuildGroup=function(){this.Zv.NK.add(this.vx);this.vx=null};Sa.prototype.endBuildTab=function(){Mi.c(this.Zv.gCa)||
this.Jle.add(this.Zv);this.Zv=null};Sa.prototype.xta=function(G,ja){this.nob.bindAction(G,ja)};Sa.prototype.KQ=function(G){return this.P6.pwa(G)};uk.Object.defineProperties(Sa.prototype,{gs:{configurable:!0,enumerable:!0,get:function(){return null}},P6:{configurable:!0,enumerable:!0,get:function(){return this.Rlb}},nob:{configurable:!0,enumerable:!0,get:function(){return this.Mfa}},FBc:{configurable:!0,enumerable:!0,get:function(){return this.Jle}}});Object(Yd.a)(Sa,"RibbonExtensibilityCreatorBase",
null,[104,105]);db.prototype.G8=function(){return Ng.k(this.szg,null,this.h1)};uk.Object.defineProperties(db.prototype,{h1:{configurable:!0,enumerable:!0,get:function(){return this.Eje||(this.Eje={})}}});Object(Yd.a)(db,"ScalingDefinition",null,[]);Am(Ca,Sa);Ca.prototype.startBuildTab=function(G){Sa.prototype.startBuildTab.call(this,G);this.Zv.isOfficeTab=G.isOfficeTab;if(!this.Zv.isOfficeTab)this.Zv.nUa[X.a.Lfa]=this.G9b(G.label);else if(this.Zv.gCa){var ja=this.P6.fXh(G.id);ja&&(this.Zv.nUa[X.a.Lfa]=
ja);(G=this.P6.dXh(G.id))&&(this.Zv.nUa[X.a.Z3d]=G)}G=this.Zv.gCa;this.Zv.h_f=G+"."+X.a.uGc;this.Zv.q9e=G+"."+X.a.Shb};Ca.prototype.startBuildGroup=function(G){Sa.prototype.startBuildGroup.call(this,G);this.vx.Vwa[X.a.Lfa]=this.G9b(G.label)};Ca.prototype.addButton=function(G){Sa.prototype.addButton.call(this,G);df.ULS.sendTraceTag(17085954,220,50,"RibbonExtensibility button actiontype: {0}.",G.actionType);var ja=this.WU(G,X.a.button);this.m3(ja.nB);ja.nB[X.a.rDa]=G.enabled;this.vx.Yia.add(ja)};Ca.prototype.startBuildMenu=
function(G){this.v9=this.WU(G,X.a.n_)};Ca.prototype.addMenuItem=function(G){Sa.prototype.addMenuItem.call(this,G);df.ULS.sendTraceTag(17085955,220,50,"RibbonExtensibility menu item actiontype: {0}.",G.actionType);var ja=this.KQ(G.id);ja=new hd(ja);this.oia(ja.vS,G);this.m3(ja.vS);ja.vS[X.a.rDa]=G.enabled;this.v9.menuItems.add(ja)};Ca.prototype.endBuildMenu=function(){this.vx.Yia.add(this.v9);this.v9=null};Ca.prototype.endBuildGroup=function(){this.zVg();this.Zv.LPd.add(this.Zfa);this.bga&&(this.Zv.LPd.add(this.bga),
this.bga=null);this.Zfa=null;Sa.prototype.endBuildGroup.call(this)};Ca.prototype.m3=function(G){this.kIa.m3(G)};Ca.prototype.WU=function(G,ja){var Wa=this.KQ(G.id);ja=new Ob(Wa,ja);this.oia(ja.nB,G);return ja};Ca.prototype.oia=function(G,ja){G[X.a.Whb]=this.G9b(ja.label);G[X.a.pDa]=this.G9b(ja.label);G[X.a.sDa]=ja.icon["16"];G[X.a.W3d]=ja.icon["32"]};Ca.prototype.zVg=function(){var G=this.p7h.Ifb;this.vx.Ifb=G.XNj;var ja=this.vx.Yia.count;df.ULS.sendTraceTag(17085956,220,50,"Control count: {0}.",
ja);var Wa=this.vx.Vwa[X.a.id];this.Zfa=new db(X.a.rGc);this.Zfa.h1[X.a.id]=Wa+".Scaling."+X.a.rGc;this.Zfa.h1[X.a.oGc]=this.vx.Vwa[X.a.id];2<ja&&(this.bga=new db(X.a.tGc),this.bga.h1[X.a.id]=Wa+".Scaling."+X.a.tGc,this.bga.h1[X.a.oGc]=this.vx.Vwa[X.a.id]);this.ayj(ja,G)};Ca.prototype.ayj=function(G,ja){var Wa=1;switch(G){case 1:case 2:this.Zfa.h1[X.a.hqa]=X.a.LARGE;break;case 3:this.Zfa.h1[X.a.hqa]=X.a.LARGE;this.bga.h1[X.a.hqa]=X.a.CRb;break;case 4:this.Zfa.h1[X.a.hqa]=X.a.CRb+"TwoRow";this.bga.h1[X.a.hqa]=
X.a.SMALL+"TwoRow";break;case 5:case 6:this.Zfa.h1[X.a.hqa]=X.a.CRb;this.bga.h1[X.a.hqa]=X.a.SMALL;break;default:throw df.ULS.sendTraceTag(9041819,220,10,"Addin commands does not support {0} controls.",G),this.sqa.setErrorMessageForAddin(this.DHc,CommonUIStrings.l_AddinManifestInvalid_Message),Error.create(String.format("AddinManifestError: Addin commands does not support {0} controls",G));}for(var vb=Cl(this.vx.Yia),f=vb.next();!f.done;f=vb.next())f.value.nB[X.a.i4d]=ja.KRh(Wa),Wa+=3!==G?1:2};Ca.prototype.G9b=
function(G){return G?(G=Vc.a.replaceAll(G,"&","&amp;"),G=Vc.a.replaceAll(G,"'","&apos;"),G=Vc.a.replaceAll(G,'"',"&quot;"),G=Vc.a.replaceAll(G,">","&gt;"),G=Vc.a.replaceAll(G,"<","&lt;")):null};uk.Object.defineProperties(Ca.prototype,{p7h:{configurable:!0,enumerable:!0,get:function(){return this.Etg}},kIa:{configurable:!0,enumerable:!0,get:function(){return this.Wfa}}});Object(Yd.a)(Ca,"RibbonExtensibilityCreator",Sa,[]);wa.prototype.nye=function(G){G=new fb(G);return new Pb(G,this.Wfa,this.Mfa)};
wa.prototype.wVg=function(G,ja,Wa){Wa=new cd.a(this.qFa,G,Wa,!0);var vb=new Kc(this.qFa+"Ribbon.Templates.AddInCommandsControlGroup","addinControl");return new Ca(Wa,this.Mfa,this.Wfa,vb,G,ja)};wa.prototype.hVg=function(G,ja,Wa,vb){Wa=new cd.a(this.qFa,G,Wa,!0);return new xb(Wa,this.Mfa,this.Wfa,G,ja,vb)};Object(Yd.a)(wa,"UIExtensibilityFactory",null,[78]);var Qc=b(95),Ic=b(1026);ma.prototype.Cdj=function(G){this.ep=G;window.addEventListener&&(window.addEventListener("LaunchContentAddin",Object(lh.a)(this,
this.qTi,"onLaunchButtonClicked_ContentAddin"),!0),window.addEventListener("DismissCallout",Object(lh.a)(this,this.IOi,"onDismissButtonClicked_ContentAddin"),!0),window.addEventListener("CloseCallout",Object(lh.a)(this,this.mNi,"onCloseButtonClicked_ContentAddin"),!0))};ma.prototype.wjd=function(G){return"[id="+G+"]"};ma.prototype.J8f=function(G,ja){var Wa=this;ja>ig.AFrameworkApplication.ha.Cd("AddinMaxDOMElementDetectionTimesForTeachingUI",10)?(window.clearTimeout(this.hTf),this.I8f("[data-unique-id='pivotOverflowButton']"),
df.ULS.sendTraceTag(537170692,220,50,"ShowTeachingCalloutWithPoll did not find the DOM element in time")):document.querySelector("button"+G)?this.I8f(G):this.hTf=window.setTimeout(function(){Wa.J8f(G,ja+1)},1E3)};ma.prototype.H8f=function(G){var ja=document.querySelector("button[data-unique-id='RightPaddle']");if(ja)G={},G=(G.AppTeachingUICalloutAction="RightPaddlePresent",G["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.ki.storeType,this.ki.storeId,this.ki.assetId),G.AppTeachingUICalloutGoal="NewAdminDeployment",
G["SDX.AppInstallOrigin"]="Organization",G),Wh.a.sendTelemetryEvent(Object.assign(new ri.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:ej.a.gl(G)}));else if(ja=document.querySelector("button"+G),!ja&&(ja=document.querySelector("button[id='RibbonOverflowMenu-overflow']"),!ja)){ja={};ja=(ja.AppTeachingUICalloutAction="NoAnchor",ja["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.ki.storeType,this.ki.storeId,this.ki.assetId),ja.AppTeachingUICalloutGoal="NewAdminDeployment",ja["SDX.AppInstallOrigin"]=
"Organization",ja);Wh.a.sendTelemetryEvent(Object.assign(new ri.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:ej.a.gl(ja)}));df.ULS.sendTraceTag(537170691,220,15,"ShowTeachingCallout failed to get an anchorElement");return}this.Wdg(ja,"ShowTeachingUIForAddinButton")};ma.prototype.I8f=function(G){G=document.querySelector("button"+G);if(!G&&(G=document.querySelector("button[data-unique-id='pivotOverflowButton']"),!G)){G={};G=(G.AppTeachingUICalloutAction="NoAnchor",G["SDX.Id"]=
Telemetry.PrivacyRules.GetAssetId(this.ki.storeType,this.ki.storeId,this.ki.assetId),G.AppTeachingUICalloutGoal="NewAdminDeployment",G["SDX.AppInstallOrigin"]="Organization",G);Wh.a.sendTelemetryEvent(Object.assign(new ri.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:ej.a.gl(G)}));df.ULS.sendTraceTag(537170690,220,15,"ShowTeachingCalloutToAddinTab failed to get an anchorElement");return}this.Wdg(G,"ShowTeachingUIForAddinTab")};ma.prototype.Wdg=function(G,ja){G.setAttribute("lpp-id",
"latestAddin");var Wa=Ji.a.instance.qc("Common.ISystemInitiatedFeedback");Wa&&G?(Wa.execute(function(vb){vb.logActivity(ja,null)}),G={},G=(G.AppTeachingUICalloutAction="Show",G["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.ki.storeType,this.ki.storeId,this.ki.assetId),G.AppTeachingUICalloutGoal="NewAdminDeployment",G["SDX.AppInstallOrigin"]="Organization",G),Wh.a.sendTelemetryEvent(Object.assign(new ri.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:ej.a.gl(G)})),df.ULS.sendTraceTag(537170688,
220,50,"ShowTeachingCalloutToAddinTab triggered an LPP activity")):(df.ULS.sendTraceTag(537170689,220,15,"ShowTeachingCalloutToAddinTab failed to get a sifFuture"),G={},G=(G.AppTeachingUICalloutAction="NoSifFutureObject",G["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.ki.storeType,this.ki.storeId,this.ki.assetId),G.AppTeachingUICalloutGoal="NewAdminDeployment",G["SDX.AppInstallOrigin"]="Organization",G),Wh.a.sendTelemetryEvent(Object.assign(new ri.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",
dataFields:ej.a.gl(G)})))};ma.prototype.WNh=function(G){if(!G)return null;G=G.hX;if((null===G||void 0===G?0:G.gs)&&0<G.gs.count){G=Cl(G.gs);for(var ja=G.next();!ja.done;ja=G.next())if(ja=ja.value,ja.groups&&0<ja.groups.length){ja=Cl(ja.groups);for(var Wa=ja.next();!Wa.done;Wa=ja.next())if(Wa=Wa.value,Wa.controls&&0<Wa.controls.length){Wa=Cl(Wa.controls);for(var vb=Wa.next();!vb.done;vb=Wa.next()){vb=vb.value;if(vb.attributes&&0===vb.controlType&&vb.enabled)return vb.id;if(vb.menuItems)for(var f=Cl(vb.menuItems),
D=f.next();!D.done;D=f.next())if(D=D.value,D.attributes&&D.enabled)return vb.id}}}}return null};ma.prototype.hHj=function(){var G=document.querySelector("button[data-unique-id = 'Ribbon-InsertAppsForOffice']");if(null==G){G=document.querySelector("button[data-unique-id = 'Overflow-RibbonOverflowMenu-overflow']");if(null==G){G={};G=(G.AppTeachingUICalloutAction="NoAnchor",G["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.ep.storeType,this.ep.storeId,this.ep.assetId),G.AppTeachingUICalloutGoal="NewAdminDeployment",
G["SDX.AppInstallOrigin"]="Organization",G);Wh.a.sendTelemetryEvent(Object.assign(new ri.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:ej.a.gl(G)}));df.ULS.sendTraceTag(527286668,220,15,"ShowTeachingCalloutToContentAddin failed to get an anchorElement");return}df.ULS.sendTraceTag(527286667,220,15,"Callout show on Overflow button")}else df.ULS.sendTraceTag(527286666,220,15,"Callout show on OfficeAddin Button");var ja=Ji.a.instance.qc("Common.ISystemInitiatedFeedback");null==ja||
null==G?(G={},G=(G.AppTeachingUICalloutAction="NoSifFutureObject",G["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.ep.storeType,this.ep.storeId,this.ep.assetId),G.AppTeachingUICalloutGoal="NewAdminDeployment",G["SDX.AppInstallOrigin"]="Organization",G),Wh.a.sendTelemetryEvent(Object.assign(new ri.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:ej.a.gl(G)})),df.ULS.sendTraceTag(527286665,220,15,"ShowTeachingCalloutToContentAddin failed to get a sifFuture")):(ja.execute(function(Wa){Wa.logActivity("ShowTeachingUIForContentAddin",
null)}),G={},G=(G.AppTeachingUICalloutAction="Show",G["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.ep.storeType,this.ep.storeId,this.ep.assetId),G.AppTeachingUICalloutGoal="NewAdminDeployment",G["SDX.AppInstallOrigin"]="Organization",G),Wh.a.sendTelemetryEvent(Object.assign(new ri.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:ej.a.gl(G)})),df.ULS.sendTraceTag(527286664,220,50,"ShowTeachingCalloutToContentAddin triggered an LPP activity"))};ma.prototype.qTi=function(){var G=
{};G=(G.AppTeachingUICalloutAction="ClickOnLaunch",G["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.ep.storeType,this.ep.storeId,this.ep.assetId),G.AppTeachingUICalloutGoal="NewAdminDeployment",G["SDX.AppInstallOrigin"]="Organization",G);Wh.a.sendTelemetryEvent(Object.assign(new ri.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:ej.a.gl(G)}));var ja={};ja[rj.a.Gg]=this.ep;G={};G.solutionId=this.ep.solutionId;G.assetId=this.ep.assetId;G.assetStoreId=this.ep.assetStoreId;G.height=
0!=this.ep.height?this.ep.height:600;G.storeId=this.ep.storeId;G.storeType=this.ep.storeType;G.targetType=this.ep.targetType;G.width=0!=this.ep.width?this.ep.width:600;G.displayName=this.ep.displayName;G.version=this.ep.version;G.isAddinCommands=!1;ja[wg.a.$sa]=G;var Wa=new Qc.a(-741808261,0,0,2,null);Th.TaskExtensions.Ba(cj.GetServiceTaskFactory.Ua(this.$.da,374,375,1),function(vb){vb=vb.result;null!=vb&&vb.insertAgave(ja,Wa)},this.$.la,3)};ma.prototype.mNi=function(){var G={};G=(G.AppTeachingUICalloutAction=
"ClickOnClose",G["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.ep.storeType,this.ep.storeId,this.ep.assetId),G.AppTeachingUICalloutGoal="NewAdminDeployment",G["SDX.AppInstallOrigin"]="Organization",G);Wh.a.sendTelemetryEvent(Object.assign(new ri.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:ej.a.gl(G)}))};ma.prototype.IOi=function(){var G={};G=(G.AppTeachingUICalloutAction="ClickOnDismiss",G["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.ep.storeType,this.ep.storeId,this.ep.assetId),
G.AppTeachingUICalloutGoal="NewAdminDeployment",G["SDX.AppInstallOrigin"]="Organization",G);Wh.a.sendTelemetryEvent(Object.assign(new ri.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:ej.a.gl(G)}))};Object(Yd.a)(ma,"AddinTeachingCalloutHandler",null,[]);var Gd=b(1314),Pd=b(393),ze=b(8),gf=b(38);ua.prototype.dispose=function(){void 0!==this.tpb&&null!==this.tpb&&(this.tpb.dispose(),this.tpb=null);this.Le=this.$=null;this.disposed=!0};ua.prototype.ZBj=function(G,ja){switch(G){case xc.a.q3:G=
this.LBj(ja);break;default:G=!1}return G};ua.prototype.$c=function(){return!1};ua.prototype.executeCommand=function(G,ja,Wa){var vb=this;G=Th.TaskExtensions.Dl();ja=ja.command;switch(ja){case 843847158:break;case -2025863019:lk.a.DUd(Wa[wg.a.nYc].toString(),function(){gj.g(vb.$).focus()});break;case -1777565636:Gd.a.showUILessDialog(Wa[wg.a.upb].toString());this.Le.XEj(Wa[wg.a.upb].toString());break;case 1592314317:Gd.a.hideUILessDialog(Wa[wg.a.upb].toString());this.Le.Pai(Wa[wg.a.upb].toString());
break;case xc.a.q3:G=this.tld(Wa);break;case xc.a.TCb:this.FOa(Wa);break;case xc.a.hoa:this.hoa(Wa);break;case xc.a.EUd:this.tpb.Yzc();break;case xc.a.refreshAddinCommands:this.ybj();break;case 1949669462:this.Tha.r2f(!0);break;case -1014260128:G=this.executeDynamicAddInCommandsAPI(Wa);break;default:G=Kk.a(ja)}return G};ua.prototype.Mc=function(G,ja){G=!1;switch(ja.command){case 843847158:case -2025863019:case -1777565636:case 1592314317:case xc.a.hoa:case xc.a.EUd:case xc.a.refreshAddinCommands:case 1949669462:case xc.a.TCb:case -1014260128:G=
!0;break;case xc.a.q3:G=!ig.AFrameworkApplication.protectedFile}return G};ua.prototype.nd=function(){return!1};ua.prototype.HRh=function(G){if(!G)return df.ULS.sendTraceTag(528098432,220,10,"Failed to get button id for addin"),null;if((G=G.hX)&&G.gs&&0<G.gs.count){G=Cl(G.gs);for(var ja=G.next();!ja.done;ja=G.next()){ja=ja.value;if(ja.groups&&1===ja.groups.length){var Wa=ja.groups[0];if(Wa.controls&&1===Wa.controls.length){var vb=Wa.controls[0];if(vb.attributes&&!vb.controlType&&vb.enabled)return vb.id}Wa.controls&&
df.ULS.sendTraceTag(528098403,220,15,"It has multiple buttons")}ja.groups&&df.ULS.sendTraceTag(528098402,220,15,"It has multiple groups")}}return null};ua.prototype.ybj=function(){if(this.Tha.Swd()){this.Tha.pCe();var G=this.lgd();if(G&&0<G.count){G=Cl(G);for(var ja=G.next();!ja.done;ja=G.next()){var Wa={};ja=(Wa[wg.a.y3]=ja.value,Wa[wg.a.$M]=4,Wa[wg.a.TGa]=(new Date).getTime(),Wa);this.hoa(ja)}}}};ua.prototype.hoa=function(G){var ja=this;df.ULS.sendTraceTag(537170657,220,50,"Launch AddinCommands entitlements list, LaunchOperationType {0}, DataProvider {1}.",
G[wg.a.$M],G[wg.a.y3]);this.Tha.huj();window.setTimeout(function(){if(void 0===ja.Le||null===ja.Le)df.ULS.sendTraceTag(537170656,220,10,String.format("AddinUICommandHandler RetrieveAddInCommandsEntitlementsList error - DdaFacadeService should not be null, stack: {0}",gf.a.j4()));else{var Wa=new $d(new Cd(ja.Le.Ni),ed.instance,Lb.instance);Wa.GHg(function(vb,f){ja.FOa(f.properties)});ig.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",
!1)&&ig.AFrameworkApplication.ha.isChangeGateEnabled("OfficeVSO:5837059_TeachingUIForPrivateCatelogOnContentAddinEnabled")&&Wa.eLg(function(vb,f){null==f?(vb={},vb=(vb.AppTeachingUICalloutAction="InvalidEventArgs",vb.AppTeachingUICalloutGoal="NewAdminDeployment",vb["SDX.AppInstallOrigin"]="Organization",vb),Wh.a.sendTelemetryEvent(Object.assign(new ri.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:ej.a.gl(vb)}))):(ja.Obg=new ma(ja),ja.Obg.Cdj(f),vb=ja.$.Ka,null!=vb&&(vb.lse(Object(lh.a)(ja,
ja.Cef,"onTabSwitched")),df.ULS.sendTraceTag(527286663,220,50,"Register tab switched event")))});Wa.nTj(G)}},0)};ua.prototype.Cef=function(G,ja){"Insert"==ja.tabName&&(G=this.$.Ka,null!=G&&(G.dVf(Object(lh.a)(this,this.Cef,"onTabSwitched")),df.ULS.sendTraceTag(527286662,220,50,"Remove insertTabSwitched handler")),this.Obg.hHj())};ua.prototype.FOa=function(G){var ja=this;if(!this.disposed){df.ULS.sendTraceTag(537170655,220,50,"LaunchOperationType {0}.",G[wg.a.$M]);try{if(Df.EwaSettings.ma(187)){var Wa=
G[wg.a.m_a];if(Wa&&0<Wa.count){for(var vb=Wa.count,f=vb-1;0<=f;f--){var D=Wa.pa(f);OSF.OsfControl.isFirstPartyStoreString(D.storeType)||Wa.remove(Wa.pa(f))}if(Wa.count<vb){var N=cj.GetServiceTaskFactory.Ua(this.$.da,5,4,0);Th.TaskExtensions.Ba(N,function(){N.result.lg(35,null)},this.$.la,3)}if(!Wa.count)return}}if(void 0===this.Le||null===this.Le)df.ULS.sendTraceTag(537170654,220,10,String.format("LaunchAddinCommands error - this.DdaFacadeService should not be null, stack: {0}",gf.a.j4()));else{var fa=
null;fa=ig.AFrameworkApplication.ha.ra("HostInstallAddInsIsEnabled")?new Ac(this.qo,this.JFe,new Cd(this.Le.Ni),new wa(this.$.Lb,xc.a.q3),this.Tha,ed.instance,this.Sha,function(pb,Wb){var Nc={};Nc.InstanceId=qj.a.create().toString();Nc.PrimaryMarketplace={};Nc.PrimaryMarketplace.SolutionId=pb.solutionId;Nc.PrimaryMarketplace.SolutionVersion=pb.version;Nc.PrimaryMarketplace.MarketplaceType=pb.storeType;Nc.PrimaryMarketplace.MarketplaceRef=pb.storeId;Nc.WebExtensionType=1;ja.Le.oHj(Nc,function(){Wb(pb)})}):
new Ac(this.qo,this.JFe,new Cd(this.Le.Ni),new wa(this.$.Lb,xc.a.q3),this.Tha,ed.instance,this.Sha);(ig.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoLaunchAddinOnExcelWacEnabled",!1)||ig.AFrameworkApplication.ha.isChangeGateEnabled("OfficeVSO:5996085_EmailAlertAutolaunchOnWacEnabled"))&&fa.NHg(this.WLi);fa.HHg(this.oTi);if(ig.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)){var Ia=new ma(this);
fa.BJg(Ia.nTi);fa.dLg(Ia.JEj)}this.$.da.Aa(53).Um&&nk.a.get_instance().Qk(5,null).continueWith(function(){ja.disposed||fa.vwi(ja.Kcd,ja.$.domElement,G)})}}catch(pb){df.ULS.sendTraceTag(537170653,220,10,String.format("LaunchAddinCommands error message : {0}.",pb.message))}}};ua.prototype.tld=function(G){var ja=Th.TaskExtensions.Dl();G=G[this.qo.Zia];var Wa=this.x0b.Une(G),vb=new Gd.a(this.$,this.Le,Wa.ownerAddinInfo,ja);return this.s9e(ja,G,Wa,vb)};ua.prototype.s9e=function(G,ja,Wa,vb){var f=this;
this.x0b.tld(ja,this.Tha,vb,new Cd(this.Le.Ni),Wa,function(){G=vb.W5g()},function(){gj.g(f.$).focus()});return G};ua.prototype.jRg=function(G){var ja=this,Wa=Th.TaskExtensions.Dl(),vb=this.Le.nba(G.solutionId);if(vb){var f=this.Le.j_(vb);if(ze.HelperMethods.Mw(f)&&0!==f.SharedRuntime.State)return}f=this.x0b.kRg;var D=G.solutionId in f?f[G.solutionId]:null;if(D){var N=this.x0b.Une(D),fa=new Gd.a(this.$,this.Le,N.ownerAddinInfo,Wa);f=function(pb){if(pb){var Wb={};pb=Cl(pb);for(var Nc=pb.next();!Nc.done;Nc=
pb.next())Nc=Nc.value,Wb[Nc[0]]=Nc[1];(Wb=wg.a.tse in Wb?Wb[wg.a.tse]:null)&&"true"===Wb.toLowerCase()&&(df.ULS.sendTraceTag(537170652,220,50,"Auto-Show AddinCommands TaskPane, StoreType {0}, StoreId {1}, SolutionId {2}.",G.storeType,G.storeId,Telemetry.PrivacyRules.GetPrivacyCompliantId(G.solutionId,null!==N.ownerAddinInfo?N.ownerAddinInfo.storeType:G.storeType,G.assetId,null,null,G.storeId)),ja.s9e(Wa,D,N,fa))}};df.ULS.sendTraceTag(537170651,220,50,"Check Auto-Show AddinCommands TaskPane, StoreType {0}, StoreId {1}, SolutionId {2}.",
G.storeType,G.storeId,Telemetry.PrivacyRules.GetPrivacyCompliantId(G.solutionId,null!==N.ownerAddinInfo?N.ownerAddinInfo.storeType:G.storeType,G.assetId,null,null,G.storeId));if(vb)f(this.Le.j_(vb).OsfPropertyBag);else if(vb=this.$.ea.workbookContext.WebExtensions){vb=Cl(vb);for(var Ia=vb.next();!Ia.done;Ia=vb.next())if(Ia=Ia.value,(1===Ia.WebExtensionType?OSF.OsfControlTarget.TaskPane:OSF.OsfControlTarget.InContent)===G.targetType&&Ia.PrimaryMarketplace.MarketplaceType.toLowerCase()===G.storeType.toLowerCase()&&
Ia.PrimaryMarketplace.MarketplaceRef.toLowerCase()===G.storeId.toLowerCase()&&Ia.PrimaryMarketplace.SolutionId.toLowerCase()===G.solutionId.toLowerCase()){f(Ia.OsfPropertyBag);break}}}};ua.prototype.eOb=function(G,ja,Wa){G&&(void 0===Wa||!Wa||ja||this.D8c.contains(G)||this.D8c.add(G),(Wa=this.Q2a.contains(G))&&ja&&this.Q2a.remove(G),Wa||ja||this.Q2a.add(G))};ua.prototype.Lxj=function(G){var ja=G.hX;if(ja){if(ja.gs)for(G=Cl(ja.gs),ja=G.next();!ja.done;ja=G.next())if(ja=ja.value,ja.groups){ja=Cl(ja.groups);
for(var Wa=ja.next();!Wa.done;Wa=ja.next())if(Wa=Wa.value,Wa.controls){var vb=Cl(Wa.controls);for(Wa=vb.next();!Wa.done;Wa=vb.next())if(Wa=Wa.value,this.eOb(Wa.id,Wa.enabled,!0),1===Wa.controlType&&Wa.menuItems){var f=Cl(Wa.menuItems);for(Wa=f.next();!Wa.done;Wa=f.next())Wa=Wa.value,this.eOb(Wa.id,Wa.enabled,!0)}}}}else if(G.tabs)for(G=Cl(G.tabs),ja=G.next();!ja.done;ja=G.next())if(ja=ja.value,ja.NK)for(ja=Cl(ja.NK),Wa=ja.next();!Wa.done;Wa=ja.next())if(Wa=Wa.value,Wa.Yia)for(vb=Cl(Wa.Yia),Wa=vb.next();!Wa.done;Wa=
vb.next())if(Wa=Wa.value,this.eOb(Wa.id,Ki.a.rDa in Wa.nB?Wa.nB[Ki.a.rDa]:!0,!0),Wa.controlType===Ki.a.n_&&Wa.menuItems)for(f=Cl(Wa.menuItems),Wa=f.next();!Wa.done;Wa=f.next())Wa=Wa.value,this.eOb(Wa.id,Ki.a.rDa in Wa.vS?Wa.vS[Ki.a.rDa]:!0,!0)};ua.prototype.lgd=function(){var G=new Kh.a;Df.EwaSettings.ma(54)&&(this.$.ea.ah.get(27)&&(G.add(0),G.add(16)),this.$.ea.ah.get(33)&&G.add(1),G.add(8));return G};ua.prototype.executeDynamicAddInCommandsAPI=function(G){var ja=!0;if(void 0===G||null===G||void 0===
G[wg.a.wub]||null===G[wg.a.wub])return Zj.Task.Sa(!1);switch(G[wg.a.wub]){case 1:ja=this.mWj(G);break;case 2:ja=this.Pxj(G);break;case 4:this.Q2a.clear();this.Q2a.addRange(this.D8c);break;case 3:ja=this.installContextualTab(G);break;default:ja=!1}return Zj.Task.Sa(ja)};ua.prototype.LBj=function(G){return G&&this.qo.Zia in G?(G=G[this.qo.Zia])?this.Q2a.contains(G):!1:!1};ua.prototype.mWj=function(G){var ja=null,Wa=null,vb=null,f=!0;void 0!==G[wg.a.N4]&&null!==G[wg.a.N4]&&void 0!==G[this.qo.Zia]&&null!==
G[this.qo.Zia]&&void 0!==G[wg.a.L4]&&null!==G[wg.a.L4]&&(ja=G[wg.a.N4],Wa=G[wg.a.n9b],vb=G[this.qo.Zia],f=G[wg.a.L4]);if(!ja||!vb)return df.ULS.sendTraceTag(537170649,220,15,"UpdateControlEnableState failed to get solutionId or controlId."),!1;G=(new cd.a(this.$.Lb,ja,this.qo,!0)).pwa(vb);ja={DynamicAddinCommandsApiName:"UpdateControlEnableState"};ja.AssetId=Wa;ja.MaskedTabId=G;ja.IsToEnable=f;df.ULS.sendTraceTag(537170648,220,15,jh.a.Kc(ja));this.eOb(G,f);Pd.a.kz.updateCommandUI();return!0};ua.prototype.Pxj=
function(G){var ja,Wa,vb=null,f=null,D=null,N=null,fa=!0;void 0!==G[wg.a.l$c]&&null!==G[wg.a.l$c]&&void 0!==G[wg.a.N4]&&null!==G[wg.a.N4]&&void 0!==G[this.qo.Zia]&&null!==G[this.qo.Zia]&&void 0!==G[wg.a.L4]&&null!==G[wg.a.L4]&&(vb=G[wg.a.l$c],f=G[wg.a.N4],D=G[wg.a.n9b],N=G[this.qo.Zia],fa=G[wg.a.L4]);if(!vb||!f||!N)return df.ULS.sendTraceTag(537170647,220,15,"SetRibbonTabVisible failed to get storeType or solutionId or tabId."),!1;G=(new cd.a(this.$.Lb,f,this.qo,!0)).nkd(N);N={DynamicAddinCommandsApiName:"SetRibbonTabVisible"};
N.StoreType=vb;N.AssetId=D;N.MaskedTabId=G;N.IsToShow=fa;df.ULS.sendTraceTag(537170646,220,15,jh.a.Kc(N));f=this.Tha.Uja(vb,f,1);vb=!1;if(null===(Wa=null===(ja=null===f||void 0===f?void 0:f.Mo)||void 0===ja?void 0:ja.hX)||void 0===Wa?0:Wa.gs)for(ja=Cl(f.Mo.hX.gs),Wa=ja.next();!Wa.done;Wa=ja.next())if(Wa.value.id===G){vb=!0;break}if(!vb)return df.ULS.sendTraceTag(537170645,220,15,"SetRibbonTabVisible failed to get contextual tabs"),!1;ja=[];fa?appChrome.selectors.getSelectedTabId()!==G&&ja.push(appChrome.actions.activateRibbonTab(G)):
(appChrome.selectors.getSelectedTabId()===G&&ja.push(appChrome.actions.setCurrentTab(Qi.a.yX)),ja.push(appChrome.actions.deactivateRibbonTab(G)));appChrome.api.dispatch(ja);return!0};ua.prototype.installContextualTab=function(G){var ja=null,Wa=null,vb=null,f=null;if(void 0!==G[wg.a.N4]&&null!==G[wg.a.N4]&&void 0!==G[wg.a.L4]&&null!==G[wg.a.L4]){var D=G[wg.a.L4];ja=G[wg.a.N4];void 0!==D[wg.a.LJa]&&null!==D[wg.a.LJa]&&void 0!==D[wg.a.MJa]&&null!==D[wg.a.MJa]&&(Wa=D[wg.a.LJa],vb=D[wg.a.MJa],f=D[wg.a.m$c])}if(!(ja&&
vb&&Wa&&f))return df.ULS.sendTraceTag(537170644,220,15,"InstallContextualTab failed to invalid parameters"),!1;G=this.Tha.Uja(f.PrimaryMarketplace.MarketplaceType,f.PrimaryMarketplace.SolutionId,1);if(null===G||void 0===G?0:G.Mo)return df.ULS.sendTraceTag(537170643,220,15,"InstallContextualTab was called multiple times"),!1;G={};G.solutionId=f.PrimaryMarketplace.SolutionId;G.version=f.PrimaryMarketplace.SolutionVersion;G.storeType=f.PrimaryMarketplace.MarketplaceType;G.storeId=f.PrimaryMarketplace.MarketplaceRef;
G.assetId=f.PrimaryMarketplace.SolutionId;G.assetStoreId=f.PrimaryMarketplace.MarketplaceRef;G.targetType=f.WebExtensionOsfControlType;G.width=f.TaskpaneWidth;G.height=0;G.isAddinCommands=!0;f=new Kh.a;f.add(G);G={};G[wg.a.m_a]=f;G[wg.a.$M]=6;G[wg.a.LJa]=Wa;G[wg.a.MJa]=vb;this.FOa(G);return!0};Object(Yd.a)(ua,"AddinUICommandHandler",null,[996,434,3]);var uf=b(68),jg=b(694),mg=b(19),sh=b(16),Bh=zj.a;Am(T,Bh);T.prototype.Qd=function(){var G=this;df.ULS.sendTraceTag(38410432,0,50,"AddinUICommandHandlerFactory.CreateCommandHandlersAsync");
uf.a(this.$).add(Object.assign(new jg.a,{ezc:function(){var ja=G.$.ea.ZF&&G.$.ea.sc&&!!(G.$.Dd&16384)&&G.$.isEditMode;G.$.ea.sc&&df.ULS.sendTraceTag(38410433,0,50,"AddinUICommandHandlerFactory.CreateCommandHandlersAsync FeatureActivator: shouldActivate [{0}] IsSessionFullyLoaded [{1}] IsSessionActive [{2}] ShowCommandUI [{3}] IsEditMode [{4}]",ja,G.$.ea.ZF,G.$.ea.sc,!!(G.$.Dd&16384),G.$.isEditMode);return ja},IZb:this.BDg,A7b:this.cgh,tvb:2}))};T.prototype.gcj=function(G){var ja=this,Wa=cj.GetServiceTaskFactory.create(this.$.da,
102,this.la,this.ub);return Th.TaskExtensions.Ba(Wa,function(){df.ULS.sendTraceTag(38942483,0,50,"AddinUICommandHandlerFactory.RegisterContextMenuExtensibilityService ribbonControlManagerTask finished.");ja.$.da.Ha(204,new kf(Wa.result,G))},this.la,3)};T.ka=function(G){zj.a.je(199,new T(G))};Object(Yd.a)(T,"AddinUICommandHandlerFactory",zj.a,[]);var yh=b(1303),Ri=b(1305),mi=Ui.a;Am(Wc,mi);Wc.prototype.create=function(){var G=this,ja;if(Df.EwaSettings.ma(407)){var Wa=cj.GetServiceTaskFactory.create(this.$.da,
106,this.$.la,this.ub),vb=cj.GetServiceTaskFactory.create(this.$.da,396,this.$.la,this.ub);Th.TaskExtensions.Ba(Zj.Task.WAA(Wa,vb),function(){G.Eb(G.$.da.Aa(278)||new yh.CustomFunctionsInstaller(G.$,Wa.result,vb.result))},this.$.la,3)}else(ja=this.$.da.Aa(278))||(ja=this.$.da.Ha(278,new Ri.CustomFunctionsLegacyInstaller(this.$))),this.Eb(ja)};Wc.ka=function(G){G.da.Ha(279,new Wc(G))};Object(Yd.a)(Wc,"CustomFunctionsInstallerFactory",Ui.a,[]);var Ai=b(89),Ti=b(46),ti=b(43);Tb.prototype.ka=function(G){this.b_c?
df.ULS.sendTraceTag(537170629,0,10,"The instance AgaveOnSelectedReadoutHandler should not attach multiple times."):(this.b_c=!0,this.pRa={},this.qRa={},G?G.tIg(this.Zdg):df.ULS.sendTraceTag(537170628,0,10,"The AgaveOnSelectedReadoutHandler should not attach to a null object."))};Tb.prototype.detach=function(G){if(G){G.igj(this.Zdg);G=this.pRa;for(var ja in G)Ai.a.Fa(G[ja]);this.qRa=this.pRa=null;this.b_c=!1}else df.ULS.sendTraceTag(537170627,0,10,"The AgaveOnSelectedReadoutHandler should not detach from a null object.")};
Tb.prototype.MQf=function(G,ja,Wa){if(this.Vji(Wa,G))return!1;G=ja.querySelector("iframe");if(!G)return df.ULS.sendTraceTag(537170595,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."),!0;G=G.title;if(!G||!G.length)return df.ULS.sendTraceTag(537170594,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."),!0;this.ariaLiveNotifier.readText(G);return!0};Tb.prototype.Vji=function(G,ja){return(G=G.Ni.getOsfControl(ja))?G.getPageStatus()!==OSF.OsfControlPageStatus.Ready:
!0};Object(Yd.a)(Tb,"AgaveOnSelectedReadoutHandler",null,[967]);var nj=Ui.a;Am(Eb,nj);Eb.prototype.create=function(){var G=this,ja=this.$.da;Th.TaskExtensions.Ba(cj.GetServiceTaskFactory.Ua(ja,211,212,this.ub),function(Wa){Wa=ja.Aa(224)||new Tb(Wa.result,G.$);G.Eb(Wa)},this.la,3)};Eb.ka=function(G){G.da.Ha(225,new Eb(G))};Object(Yd.a)(Eb,"AgaveOnSelectedReadoutHandlerFactory",Ui.a,[]);var wi=b(947),gh=b(242);Ub.prototype.z$e=function(G){try{if(G&&G.rawEvent&&G.rawEvent.origin&&this.iframe&&this.iframe.id){var ja=
this.oKf(G.rawEvent.origin),Wa=this.oKf(document.domain);if(ek.a.Uk().equals(Wa,ja))if(G.rawEvent.source&&G.rawEvent.source.frameElement&&G.rawEvent.source.frameElement.id&&ek.a.Uk().equals(G.rawEvent.source.frameElement.id,this.iframe.id)){ja=null;try{ja=JSON.parse(G.rawEvent.data)}catch(vb){df.ULS.sendTraceTag(39112971,344,50,"AuthenticationProxy.HandleResponse: The received response is malformed or not intended for the privateCatalogIframe: {0}",vb.message)}ja?(ja.statusCode!==gh.a.SP||void 0!==
ja.error&&ja.error?(df.ULS.sendTraceTag(23707648,344,50,"Authentication proxy returned a result but the operation failed. statusCode '{0}', Error: '{1}'",ja.statusCode,ja.error),this.onError()):(df.ULS.sendTraceTag(23705827,344,100,"Received response from authentication proxy."),this.onSuccess(ja.authorizationCode?ja.authorizationCode:ja.signInUrl)),$removeHandler(window,"message",Object(lh.a)(this,this.z$e,"handleResponse")),this.iframe?document.body.contains(this.iframe)?document.body.removeChild(this.iframe):
df.ULS.sendTraceTag(24978499,344,15,"The iframe is not a child of Body."):df.ULS.sendTraceTag(24978500,344,15,"The iframe is null.")):df.ULS.sendTraceTag(575976219,344,50,"AuthenticationProxy.HandleResponse: this was not our message, just wait for right one.")}else df.ULS.sendTraceTag(51451614,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Event does not originate from expected iFrame.");else df.ULS.sendTraceTag(51451613,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Failed validate event origin.")}else df.ULS.sendTraceTag(51418200,
344,50,"AuthenticationProxy ResponseHandler skipped processing for event.")}catch(vb){df.ULS.sendTraceTag(23707649,344,10,"Exception in authentication proxy message handler: {0}.",vb.message)}};Ub.prototype.oKf=function(G){var ja="";try{G&&(ja=-1<G.indexOf("//")?G.split("/")[2]:G.split("/")[0])&&(ja=ja.split(":")[0],ja=ja.split("?")[0])}catch(Wa){df.ULS.sendTraceTag(51451615,344,10,"Failed to parse host name from url: {0}",Wa.message)}return ja};Ub.ka=function(G,ja,Wa){new Ub(G,ja,Wa)};Object(Yd.a)(Ub,
"ResponseHandler",null,[]);var hi=b(292);tb.prototype.tryAuthenticate=function(G,ja){this.ebb(tb.cug,function(){G()},ja)};tb.prototype.tryAuthorize=function(G,ja){this.ebb(tb.lpg,G,ja)};tb.prototype.getSignInUrl=function(G,ja){this.ebb(tb.Ske,G,ja)};tb.prototype.signOut=function(G,ja){this.ebb(tb.oAg,G,ja)};tb.prototype.ebb=function(G,ja,Wa){var vb=new hi.QueryStringBuilder("AuthenticationProxyHandler.aspx");vb.Li("responseType",G);ig.AFrameworkApplication.Kob(vb);vb=String.format("{0}{1}&{2}",this.oGa,
vb.toString(),ig.AFrameworkApplication.uj);var f=document.createElement("iframe");f.setAttribute("id","privateCatalogIframe");f.setAttribute("name","privateCatalogIframe");f.setAttribute("style","display: none");ek.a.Uk().equals(G,tb.Ske)||f.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin allow-popups allow-pointer-lock");Ub.ka(f,ja,Wa);f.setAttribute("src",vb);document.body.appendChild(f)};tb.lpg="authcode";tb.cug="identitytoken";tb.Ske="signinurl";tb.oAg="signout";Object(Yd.a)(tb,
"AuthenticationProxy",null,[]);Ha.getUserId="getUserId";Ha.getLastStoreUpdate="laststoreupdate";Ha.getEntitlement="getEntitlements";Ha.getEToken="getEToken";Ha.getManifest="getManifest";Ha.getAppState="getAppState";Ha.getKilledApps="getRemovedAddins";Ha.getAppDetails="getAppDetails";Ha.removeApps="removeAddin";Ha.getLastPrivateCatalogUpdate="getLastPrivateCatalogUpdate";Ha.getPrivateCatalogAddIns="getAddIns";Ha.getPrivateCatalogManifests="getAppManifests";Ha.isStoreDisabled="isStoreDisabled";Object(Yd.a)(Ha,
"S2SWebRequestActions",null,[]);var Vi=b(638);nc.prototype.getUserId=function(G,ja){var Wa=new Kh.a;Wa.add(new gi.a("corr",G));this.TX(Ha.getUserId,Wa,1,ja)};nc.prototype.getLastStoreUpdate=function(G,ja,Wa){var vb=new Kh.a;vb.add(new gi.a("lc",G));vb.add(new gi.a("corr",ja));this.TX(Ha.getLastStoreUpdate,vb,1,Wa)};nc.prototype.getEntitlement=function(G,ja,Wa,vb){G=new Kh.a;G.add(new gi.a("av",ja));G.add(new gi.a("corr",Wa));this.TX(Ha.getEntitlement,G,1,vb)};nc.prototype.getEToken=function(G,ja,
Wa,vb,f,D){var N=new Kh.a;N.add(new gi.a("cmu",G));N.add(new gi.a("cmf",ja));N.add(new gi.a("assetid",Wa));N.add(new gi.a("expver",vb));N.add(new gi.a("corr",f));this.TX(Ha.getEToken,N,1,D)};nc.prototype.getManifest=function(G,ja,Wa,vb){var f=new Kh.a;f.add(new gi.a("cmu",G));f.add(new gi.a("assetid",ja));f.add(new gi.a("corr",Wa));this.TX(Ha.getManifest,f,1,vb)};nc.prototype.getAppState=function(G,ja,Wa){var vb=new Kh.a;vb.add(new gi.a("ma",G));vb.add(new gi.a("corr",ja));this.TX(Ha.getAppState,
vb,1,Wa)};nc.prototype.getKilledApps=function(G,ja){var Wa=new Kh.a;Wa.add(new gi.a("corr",G));this.TX(Ha.getKilledApps,Wa,1,ja)};nc.prototype.getAppDetails=function(G,ja,Wa,vb){var f=new Kh.a;f.add(new gi.a("cmo",G));f.add(new gi.a("corr",Wa));this.Ldb(Ha.getAppDetails,f,ja,2,vb,!1)};nc.prototype.removeApps=function(G,ja,Wa){var vb=new Kh.a;vb.add(new gi.a("corr",ja));this.Ldb(Ha.removeApps,vb,G,2,Wa,!1)};nc.prototype.getLastPrivateCatalogUpdate=function(G,ja,Wa,vb,f,D){var N=new Kh.a;N.add(new gi.a("catalog",
"privatecatalog"));N.add(new gi.a("clientCode",G));N.add(new gi.a("clientVersion",ja));N.add(new gi.a("corr",f));G=String.format("authorizationCode={0}&refreshToken={1}",Wa?Vc.a.rf(Wa):"",vb?Vc.a.rf(vb):"");this.Ldb(Ha.getLastPrivateCatalogUpdate,N,G,2,D,!0)};nc.prototype.getPrivateCatalogAddIns=function(G,ja,Wa,vb,f,D){var N=new Kh.a;N.add(new gi.a("catalog","privatecatalog"));N.add(new gi.a("clientCode",G));N.add(new gi.a("clientVersion",ja));N.add(new gi.a("corr",f));G=String.format("authorizationCode={0}&refreshToken={1}",
Wa?Vc.a.rf(Wa):"",vb?Vc.a.rf(vb):"");this.Ldb(Ha.getPrivateCatalogAddIns,N,G,2,D,!0)};nc.prototype.getPrivateCatalogManifests=function(G,ja,Wa,vb,f){var D=new Kh.a;D.add(new gi.a("catalog","privatecatalog"));D.add(new gi.a("corr",vb));G=String.format("extensionIds={0}&authorizationCode={1}&refreshToken={2}",Vc.a.rf(G),ja?Vc.a.rf(ja):"",Wa?Vc.a.rf(Wa):"");this.Ldb(Ha.getPrivateCatalogManifests,D,G,2,f,!0)};nc.prototype.isStoreDisabled=function(G,ja){var Wa=new Kh.a;Wa.add(new gi.a("corr",G));this.TX(Ha.isStoreDisabled,
Wa,2,ja)};nc.prototype.TX=function(G,ja,Wa,vb){this.Ldb(G,ja,null,Wa,vb,!1)};nc.prototype.Ldb=function(G,ja,Wa,vb,f,D){var N=new hi.QueryStringBuilder("AddinServiceHandler.ashx");N.Li("action",G);N.Li("app",Vi.a[ig.AFrameworkApplication.sa.Qa.Yj]);ja=Cl(ja);for(var fa=ja.next();!fa.done;fa=ja.next())fa=fa.value,N.Li(fa.key,fa.value);N=String.format("{0}{1}&{2}",ig.AFrameworkApplication.sa.Qa.ZW,N.toString(),ig.AFrameworkApplication.uj);ig.AFrameworkApplication.Ld.jm(N,vb,Wa,null,!1,2,function(Ia){var pb=
null;Ia&&Ia.data&&(Ia.data.responseHeaders["X-BlockedForMinor"]&&"1"===Ia.data.responseHeaders["X-BlockedForMinor"].toString()&&(Ia.data.httpStatus=451),pb=Ia.data.oe);f(Ia.data.httpStatus,pb)},function(Ia){var pb=null;D&&Ia&&Ia.data&&Ia.data.oe&&(pb=Ia.data.oe);f(Ia.data.httpStatus,pb);if(ig.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OEP.AddinServiceHandlerTelemetry",!0)){pb={message:"AddinServiceHandler request failed"};pb.code=Ia.data.httpStatus;pb.action=G;if(Ia.data.request||
Ia.data.request.get_headers())pb["X-UserSessionId"]=Ia.data.request.get_headers()["X-UserSessionId"];408===Ia.data.httpStatus||503===Ia.data.httpStatus?df.ULS.sendTraceTag(538784582,220,10,JSON.stringify(pb)):df.ULS.sendTraceTag(18392345,220,50,JSON.stringify(pb))}else df.ULS.sendTraceTag(538736349,220,50,"S2S web request failed with {0}.",Ia.data.httpStatus)},null,void 0,void 0,void 0,void 0,"AddinServiceHandler_"+G)};Object(Yd.a)(nc,"S2SWebRequestManager",null,[]);var Oi=Ui.a;Am(Nb,Oi);Nb.prototype.create=
function(){var G=this;df.ULS.sendTraceTag(537170507,0,50,"DdaFacadeServiceFactory:Create.");ig.AFrameworkApplication.disableWholeAppsForOfficeFeature?df.ULS.sendTraceTag(537170506,0,50,"DdaFacadeServiceFactoryError.Create not creating DdaFacadeService : DisableWholeAppsForOfficeFeature [{0}]",ig.AFrameworkApplication.disableWholeAppsForOfficeFeature):Df.EwaSettings.ma(411)?Ji.a.instance.qc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(ja){ja.isFeatureEnabled("mso_officeStore",
!0).then(function(Wa){wi.DdaFacade.p5c=Wa;G.MHe();return null})}):this.MHe()};Nb.prototype.MHe=function(){var G=this,ja=cj.GetServiceTaskFactory.Ua(this.$.da,224,225,this.ub),Wa=Lf.a.Owd(41,function(){return!(void 0===window.OSF||null===window.OSF)},this.$.ya.MaxRetriesForLoadingScript,this.$.la,this.ub,106),vb=gc(this.la,this.ub);Th.TaskExtensions.Ba(Th.TaskExtensions.we([ja,Wa,vb],this.$.la),function(){"undefined"===typeof OfficeExt||"undefined"===typeof OSF?df.ULS.sendTraceTag(537170505,0,15,"DdaFacadeServiceFactoryError.Create not creating DdaFacadeService. OfficeExt/OSF shouldn't be undefined. Stack: {0}",
gf.a.j4()):G.qei();df.ULS.sendTraceTag(537170504,0,50,"DdaFacadeServiceFactoryError.Create: DdaFacadeService created");G.LQf=ja.result;G.Eb(G.Le);df.ULS.sendTraceTag(537170503,0,50,"VSO#2693929: ServiceCreatedEvent is registered.")},this.la,3)};Nb.prototype.qei=function(){Df.EwaSettings.ma(65)&&OfficeExt.S2SOmexCatalogService.initRequestHandler(new nc);this.$.dg.get(35)&&OfficeExt.PrivateCatalogService.initRequestHandler(new nc,new tb(ig.AFrameworkApplication.ha.appSettings.WebServiceBase),Df.EwaSettings.ma(72),
Df.EwaSettings.ma(439))};Nb.prototype.dispose=function(){Ai.a.Fa(this.ddaFacade);this.$=this.ddaFacade=null;Oi.prototype.dispose.call(this)};Nb.ka=function(G){new Nb(G)};uk.Object.defineProperties(Nb.prototype,{Le:{configurable:!0,enumerable:!0,get:function(){return this.ddaFacade||(this.ddaFacade=new wi.DdaFacade(this.$,this.LQf))}}});Object(Yd.a)(Nb,"DdaFacadeServiceFactory",Ui.a,[]);Hc.prototype.nd=function(){return!1};Hc.prototype.$c=function(){return!1};Hc.prototype.Mc=function(G,ja,Wa,vb){var f=
!1;switch(ja.command){case -684355545:f=!0;break;case -741808261:f=!!Wa;break;case -859308420:f=!!vb&&1===vb.rz;break;case 418618014:f=1===G&&!!vb&&1===vb.rz;break;case -515602470:ja=Df.EwaSettings.ma(235)&&2===G;f=(1===G||ja)&&!!vb&&1===vb.rz;break;case 2086613372:f=Df.EwaSettings.ma(235)&&2===G&&!!vb&&1===vb.rz;break;case -1336341324:f=Df.EwaSettings.ma(491)&&1===G&&!!vb&&1===vb.rz;break;case -1444574190:case -336193495:f=1===G&&!!vb&&1===vb.rz;break;case 1296389134:f=1===G&&!!vb&&1===vb.rz;break;
case -1473679467:f=Df.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InstalledContentAddinsRibbonExperiment",!1)&&1===G&&!!vb&&1===vb.rz;break;case 1221897806:f=Df.EwaSettings.ma(167)&&2===G;break;case 1172793074:case 1930653487:f=Df.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1)&&2===G;break;case -1753056834:f=Df.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityRefreshMenu",!1);break;case 932597253:f=!0;break;case 301511274:f=
Df.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NavigationPaneWeb",!1);break;case 515196233:f=Df.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammer",!1)&&this.$.isEditMode;break;case 1723441034:f=this.$.isEditMode&&this.$.ea.nMb}return f};Hc.prototype.executeCommand=function(G,ja,Wa){var vb=Th.TaskExtensions.Dl(),f=ja.command;switch(ja.command){case -1473679467:ck.a(this.$,488,489,1,function(D){vb=D.qhi(Wa.SourceControlId,ja)});break;case 1296389134:this.agaveCommandManager.oKj(Wa.SourceControlId,
Wa.LabelText);break;case -684355545:this.agaveCommandManager.C1c();break;case -741808261:vb=this.agaveCommandManager.insertAgave(Wa,ja);ck.a(this.$,488,489,1,function(D){D.bEg(Wa)});break;case -1336341324:Df.EwaSettings.ma(491)&&(vb=this.agaveCommandManager.Hld(Wa,G,ja));break;case 1172793074:Df.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1)&&(vb=this.agaveCommandManager.Hld(Wa,G,ja));break;case -859308420:case -515602470:case 2086613372:case -336193495:case -1444574190:case 418618014:case 1221897806:case 1930653487:case -1753056834:case 932597253:case 301511274:case 515196233:case 1723441034:vb=
this.agaveCommandManager.Hld(Wa,G,ja);break;default:vb=Kk.a(f)}return vb};Object(Yd.a)(Hc,"AgaveCommandHandler",null,[434]);Object(Yd.a)(Cc,"Selection",null,[]);Object(Yd.a)(rc,"SmartLookupApplicationInterface",null,[]);Object(Yd.a)(jb,"ApplicationProperties",null,[]);Object(Yd.a)(Va,"EnterpriseUserInfo",null,[]);Object(Yd.a)(ic,"FeatureGates",null,[]);rb.prototype.D2h=function(){var G=void 0===G?!0:G;var ja=this.XJe();if(ja<this.lyd+this.qQj)return ja>this.lyd+this.tQj&&this.hgd(),this.Jrf;G&&this.hgd();
return""};rb.prototype.hgd=function(){var G=this;this.pyd=this.pyd||new Promise(function(ja){G.E2h().then(function(Wa){G.Jrf=Wa;G.lyd=G.XJe();G.pyd=null;ja(Wa)})})};rb.prototype.E2h=function(){var G=this;return this.Q9a&&this.Q9a.length?new Promise(function(ja){G.Yya.sT("SmartLookup",G.Q9a).then(function(Wa){Wa.IsSuccess?Wa.Token||(ja(""),df.ULS.sendTraceTag(51446545,1313,15,"SmartLookupManager - The AAD token is empty")):(df.ULS.sendTraceTag(51446544,1313,15,"SmartLookupManager - Failed to get AAD token with error: "+
Wa.ErrorCode+": "+Wa.ErrorMessage),ja(""));ja(Wa.Token)}).catch(function(Wa){Wa=fi.c(Wa);df.ULS.sendTraceTag(51446546,1313,15,"SmartLookupManager - Failed to get AAD token with exception: "+Wa);ja("")})}):(df.ULS.sendTraceTag(51446543,1313,10,"SmartLookupManager - Missing service endpoint: "),Promise.resolve(""))};Object(Yd.a)(rb,"SmartLookupAuthenticationManager",null,[174]);Ta.QTh=function(){switch(Object(Ii.a)(String,ig.AFrameworkApplication.hc.AudienceGroup)||""){case "Dogfood":if(ig.AFrameworkApplication.ha){var G=
ig.AFrameworkApplication.ha.Wa("UserPrincipalName");G=Vc.a.Yl(G);var ja=ig.AFrameworkApplication.ha.wz("SmartLookupINTEnabledForSKITeam")?ig.AFrameworkApplication.ha.Jw("SmartLookupINTEnabledForSKITeam"):[];return 0<=Array.indexOf(ja,G)?"INT":"EDOG"}return"EDOG";default:return"PROD"}};Ta.c2h=function(){switch(ig.AFrameworkApplication.ha.ra("IntentSvcEnableEdogSourceLocationOverride")?"EDOG":ig.AFrameworkApplication.ha.ra("IntentSvcEnableProdSourceLocationOverride")?"PROD":ig.AFrameworkApplication.ha.ra("IntentSvcEnableIntSourceLocationOverride")?
"INT":Ta.QTh()){case "INT":return"wss://augmentation.osi.office-int.net/officeaugmentation/searchendpoint/";case "EDOG":return"wss://augmentation.osi.officeppe.net/officeaugmentation/searchendpoint/";default:return"wss://augmentation.osi.office.net/officeaugmentation/searchendpoint/"}};Object(Yd.a)(Ta,"Utils",null,[]);var Cj=b(618);pc.prototype.zOh=function(){return Promise.resolve(this.AOh())};pc.prototype.AOh=function(){var G=new jb;G.anid="";G.applicationVersion=ig.AFrameworkApplication.buildVersion;
G.appCorrelationId=Qj.a.create().toString();G.themePlatform=pc.f1j;G.lcid=ig.AFrameworkApplication.lcid;G.launchUtcTime=(new Date).toUTCString();G.featureGates=this.P9a;var ja=Cj.a.DK(ig.AFrameworkApplication.lcid);ja=ja?ja.name:null;G.market=this.Gcc(ja);G.uiLanguage=ja;G.sessionId=ig.AFrameworkApplication.userSessionId;G.themeId=0;G.parentalControl=pc.g1i;var Wa=new Va;Wa.CountryCode=this.Gcc(ja);Wa.ServiceEndpoint=this.Q9a;Wa.IsGoLocal=!1;Wa.IsEnabled=this.psf;Wa.IsEnterpriseEnabled=this.psf;Wa.TenantRoot=
this.xCi;G.enterpriseUserInfo=Wa;G.accessToken=this.sCi.D2h();return G};pc.prototype.Gcc=function(G){G=G.split("-");return G[G.length-1]};uk.Object.defineProperties(pc.prototype,{approvedOriginPattern:{configurable:!0,enumerable:!0,get:function(){return this.TBi}}});pc.f1j="web";pc.g1i="yes";Object(Yd.a)(pc,"SmartLookupManager",null,[141]);var Fi=mk.a;Am(yb,Fi);yb.prototype.nd=function(){return!1};yb.prototype.$c=function(){return!1};yb.prototype.Mc=function(G,ja){G=Df.EwaSettings.ma(135);return-983891024===
ja.command&&G};yb.prototype.executeCommand=function(G,ja){G=Th.TaskExtensions.Dl();-983891024===ja.command&&this.ewi();return G};yb.prototype.ewi=function(){var G=this,ja=new pc(null),Wa={},vb=gj.g(this.$).rc(null).originalText;vb=Object.assign(new Cc,{neighborhood:vb,mentionStart:0,mentionLength:vb?vb.length:0});var f=Object.assign(new rc,{selection:vb,entryPoint:0});ja.zOh().then(function(N){N.applicationName=yb.appName;N.isFirstLaunch=G.isFirstLaunch;N.themeId=5;Wa[yb.smartLookupApplicationInterface]=
JSON.stringify(f);Wa[yb.ONg]=JSON.stringify(N);G.isFirstLaunch=!1});ja=new sj.a("ExcelOnline","Web","en-Us");vb=new Aj.a("FA000000006",OSF.StoreType.FirstParty,OSF.StoreType.FirstParty,"1.0.0.0");var D=new bi.a;D.wi[qe.ql]=Ff.a.instance.fa(1760);D.wi[qe.taskPaneWidth]=350;D.wi[qe.sourceLocationOverrideResourceId]="WAC.PROD.URL";D.Fr=Wa;Zi.a.instance.GOa(vb,"Taskpane","SmartLookupSDXTaskpane",ja,D)};yb.ONg="AppProperties";yb.appName="Excel";yb.smartLookupApplicationInterface="SmartLookupApplicationInterface";
Object(Yd.a)(yb,"SmartLookupCommandHandler",mk.a,[434]);var xh=zj.a;Am(lb,xh);lb.prototype.Qd=function(){var G=this;ck.a(this.$,374,375,this.ub,function(ja){G.Jd([new Hc(G.$,null,null,null,null,ja),new yb(G.$)])})};lb.ka=function(G){zj.a.je(76,new lb(G))};Object(Yd.a)(lb,"AgaveCommandHandlerFactory",zj.a,[]);Object(Yd.a)(function(){},"AppInfoDetail",null,[]);b(1153);Object(Yd.a)(function(){},"AppsForOfficeUtils",null,[]);Object(Yd.a)(Cb,"AppsDataManager",null,[44]);var Ch=b(1368),Bi=b(105);wc.prototype.initialize=
function(G){wc.initialized||(this.Le=G,this.Sg(),wc.initialized=!0)};wc.prototype.Sg=function(){ig.AFrameworkApplication.Ib.gf(xc.a.Mbb,Bi.a.frame,this.Mbb,96);ig.AFrameworkApplication.Ib.ic(xc.a.Xbj,Bi.a.frame,this.gdj)};uk.Object.defineProperties(wc,{instance:{configurable:!0,enumerable:!0,get:function(){wc.Na||(wc.Na=new wc);return wc.Na}}});wc.Na=null;wc.initialized=!1;Object(Yd.a)(wc,"AgaveCommandActor",null,[]);var Ni=b(111),ii=b(372),xi=b(369),Vj=b(1327),qh=b(357);Object(Yd.a)(Rb,"FirstPartyAddinTaskpaneOverrides",
null,[]);Object(Yd.a)(ib,"IdeasSelectionContext",null,[]);Am(Da,ib);Object(Yd.a)(Da,"IdeasTableSelectionContext",ib,[]);var oj=b(62),Ij=b(45),Tk=b(387),el=b(165),mj=b(628),Dj=b(132),Rj=b(149),ui=b(180),tj=Rj.a;Am(Ja,tj);Ja.prototype.KD=function(){tj.prototype.KD.call(this);this.Up.style.width=this.K5d;this.Up.style.height=this.HWa;this.Up.style.marginTop=this.RSb;this.Up.style.padding=this.IWa};Ja.prototype.lRa=function(){this.Up.style.width=this.K5d;this.Up.style.height=this.HWa;this.Up.style.marginTop=
this.RSb;this.Up.style.padding=this.IWa;this.dEa>ui.a.Qab?(this.Pb.style.width=String.format("{0}px",ui.a.Qab),this.Pb.style.overflowX="scroll",ig.AFrameworkApplication.isRtl?this.Pb.style.right="0":this.Pb.style.left="0"):(this.Pb.style.width=String.format("{0}px",this.dEa),this.Pb.style.overflowX="hidden");this.Pb.offsetHeight>ui.a.Pab||this.Krg+50>ui.a.Pab?(this.Pb.style.height=String.format("{0}px",ui.a.Pab),this.Pb.style.overflowY="scroll",this.Pb.style.top="0",ig.AFrameworkApplication.isRtl?
this.Pb.style.right="0":this.Pb.style.left="0",this.pKc||(this.Pb.style.marginTop="-48px"),this.Up.style.minHeight=String.format("{0}px",this.Apg)):(this.Pb.style.overflowY="hidden",this.Pb.style.top="10%",this.Pb.style.height=this.zjb);this.$0a()};Ja.prototype.$0a=function(){if(this.Pb){var G=this.Pb.style.zIndex;this.Pb.style.zIndex="-9999";if(this.dEa>ui.a.Qab)ig.AFrameworkApplication.isRtl?this.Pb.style.marginRight="0":this.Pb.style.marginLeft="0";else{var ja=String.format("{0}px",Math.floor(-this.Pb.offsetWidth/
2));ig.AFrameworkApplication.isRtl?this.Pb.style.marginRight=ja:this.Pb.style.marginLeft=ja;ig.AFrameworkApplication.isRtl?this.Pb.style.right="50%":this.Pb.style.left="50%"}this.Pb.style.zIndex=String(G)}else df.ULS.sendTraceTag(19976784,306,10,"_divMessageBox is null in CenterDialog()")};Ja.prototype.qP=function(){tj.prototype.qP.call(this);var G=document.getElementById(this.vi(this.Jrg));G.style.width=String.format("{0}px",this.dEa);G.style.height=this.zjb};uk.Object.defineProperties(Ja.prototype,
{L2a:{configurable:!0,enumerable:!0,get:function(){return this.Up}}});Object(Yd.a)(Ja,"AppsForOfficeInsertionDialog",Rj.a,[238]);var uj=b(1167),Sj=mk.a;Am(pa,Sj);pa.prototype.mJg=function(G){this.addHandler(pa.CFd,G)};pa.prototype.Ugj=function(G){this.removeHandler(pa.CFd,G)};pa.prototype.dispose=function(){Ai.a.Fa(this.yxa);this.yxa=null;Sj.prototype.dispose.call(this)};pa.prototype.C1c=function(){this.yxa.hide()};pa.prototype.oKj=function(G,ja){if(G){this.raiseEvent(pa.CFd);var Wa=G.split("|");
this.eAi(G,ja,Wa);this.yxa=new Ja;this.yxa.initializeAndShow("",null,null);this.Le.xwi(this.yxa.L2a,Wa)}};pa.prototype.Hld=function(G,ja,Wa){var vb=Th.TaskExtensions.Dl();if(-515602470===Wa.command||-336193495===Wa.command||2086613372===Wa.command||-1444574190===Wa.command||-1336341324===Wa.command)vb=this.w8h(G,ja,Wa);418618014===Wa.command&&(ja=new Bj.a,ja.ql=Ff.a.instance.fa(1771),vb=this.x1(Wa,pa.Aai,ja,!0));if((Wa.tabName===this.$.Lb+Qi.a.kYf||Wa.tabName===Qi.a.V0)&&2===Wa.ef||-1!==Array.indexOf("A0 A1 Help ContactSupport WhatsNew GiveFeedback".split(" "),
G[rj.a.od])||G[rj.a.od]===Qi.a.oW)return this.e$e(G,Wa);if(7===Wa.ef&&G.SourceControlId===this.$.Lb+Qi.a.Iec)return G.MenuItemId=Qi.a.gKd,this.e$e(G,Wa);1221897806===Wa.command&&(vb=this.q7f(Wa,"Format"));if(1930653487===Wa.command||1172793074===Wa.command)vb=this.q7f(Wa,"Data");-1753056834===Wa.command&&(vb=this.UFj(Wa));932597253===Wa.command&&(df.ULS.sendTraceTag(537170445,0,50,"InsertPowerBIPivotTable - addin launch requested"),Ea.c(932597253,!0),ja=new Bj.a,ja.ql=Ff.a.instance.fa(2100),ja.sourceLocationOverrideResourceId=
Df.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerBIUseDevURL",!1)?pa.G4i:pa.I4i,ja.focusOnIframeWhenLoaded=!0,ja.taskPaneWidth=pa.Hcf,vb={},vb.LaunchSource=Object(Ii.a)(String,G.SourceControlId),vb.LaunchMode="Default",ja.CI=vb,vb=this.x1(Wa,pa.H4i,ja,!0));301511274===Wa.command&&(vb=this.eGj(Wa));515196233===Wa.command&&((ja=this.$.da.Aa(465))&&ja.obf(),ja=new Bj.a,ja.ql=Ff.a.instance.fa(2169),vb={},vb.SourceUILocation=ii.a[Wa.ef],ja.CI=vb,vb=new rd,vb.Oba=hf.a.G3a,vb=this.x1(Wa,
pa.T_i,ja,!0,vb,void 0,ja.ql));1723441034===Wa.command&&(ja=new Bj.a,ja.ql=Ff.a.instance.fa(2181),ja.focusOnIframeWhenLoaded=!0,ja.taskPaneWidth=pa.E7i,vb=new rd,vb.Oba=hf.a.Kuh,vb=this.x1(Wa,pa.D7i,ja,!0,vb));Df.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataFromPictureOnXLO",!1)&&G.LoadDataFromPictureTaskpane&&(ja={},vb=new Bj.a,vb.ql=Ff.a.instance.fa(2207),ja.SessionID=G.SessionID,vb.CI=ja,vb.focusOnIframeWhenLoaded=!0,vb=this.x1(Wa,G.DataFromPictureAssetId,vb,!0));return vb};pa.prototype.insertAgave=
function(G,ja){var Wa=this,vb=Th.TaskExtensions.Dl(),f=this.$,D=G[wg.a.$sa];if("SourceControlId"in G){var N={};df.ULS.sendTraceTag(523819228,220,15,"insertAgave with SourceControlId called.");var fa=G.SourceControlId.split("|");if(8!==fa.length||!(fa[0]&&fa[1]&&fa[2]&&!isNaN(parseInt(fa[2],10))&&fa[3]&&!isNaN(parseInt(fa[3],10))&&fa[4]&&fa[5]&&!isNaN(parseInt(fa[5],10))&&fa[6]&&fa[7]))return Th.TaskExtensions.s5();D={};D.version=N.Version=fa[0];D.assetId=N.AssetId=fa[1];D.solutionId=N.SolutionId=
fa[1];D.height=N.Height=parseInt(fa[2],10);D.width=N.Width=parseInt(fa[3],10);D.storeId=N.StoreId=fa[4];D.targetType=N.TargetType=parseInt(fa[5],10);D.assetStoreId=N.AssetStoreId=fa[6];D.storeType=N.StoreType=fa[7]}else N=G[rj.a.Gg];fa=null;rd.key in G&&(fa=G[rd.key]);this.yxa&&this.yxa.hide();if(!N||!D)return df.ULS.sendTraceTag(537170444,220,10,"Inserting addin needs inserted agave parameters"),vb;this.$.k6&&Qi.a.qpa in G&&(N.EnabledInViewMode=G[Qi.a.qpa]);G=this.dRh(ja.command);if(!N.EnabledInViewMode&&
!f.Br(null,!1,G))return vb;var Ia=void 0===N.IsToBePersisted||null===N.IsToBePersisted||N.IsToBePersisted?0:16;if(1===N.TargetType)vb=this.Lhi(N,D,ja,fa,Ia);else{D=gj.g(f);vb=this.viewBlockContainerHelpers.ehb(D);var pb=f.ea.isNamedObjectViewMode?f.oa.sheetName:f.oa.name;if(vb){D=vb.Df;var Wb=D.yf.top;var Nc=D.yf.left;var kd=vb.vJ.x;var Xc=vb.vJ.y}else Wb=Nc=1,vb=this.viewBlockContainerHelpers.QLa(D),kd=vb.x,Xc=vb.y;var Ie=this.$.na.ta.fc();vb=function(Ze,Sf,ag){var og=f.na.ta,Vg=N,Hh=Wb,ji=Nc,kj=
kd,Ej=Xc;Ze=ci.b(Ze,Wa.x4i);var Rh=og.Ma(9,Ie);Rh.sharedInfo=Vg;Rh.sheetName=pb;Rh.positionRow=Hh;Rh.positionCol=ji;Rh.positionOffsetX=kj;Rh.positionOffsetY=Ej;return $i.i(og,"InsertWebExtension",Rh,Ze,Sf,ag,null,0)};Df.EwaSettings.uc()?(Ia|=64,vb=Tk.a(this.$.userOperationManager,vb,function(Ze){return new ch.a(534,0,Ze,Ia)},ja)):vb=Tk.a(this.$.userOperationManager,vb,function(Ze){return new bj.a(534,0,Ze,Ia)},ja)}return vb};pa.prototype.O5g=function(){var G=Ji.a.instance.qc("Common.App.ICustomerFeedbackUiWrapper"),
ja=Ji.a.instance.qc("Common.App.CustomerFeedback.ICustomerFeedbackResourceDownloadManager");this.Xcd?this.Xcd.alb?this.KAe():ja.instance.T9c(this.OEh):df.ULS.sendTraceTag(537170443,1302,15,"feedbackFormManager is undefined");ja={};ig.AFrameworkApplication.ha.Dpe(ja);G=G.instance.getContext(ja);ja={};"telemetryGroup"in G&&(ja=G.telemetryGroup);ja.processSessionId=G.sessionId;ja.officeBuild=G.build;G.telemetryGroup=ja;G.feedbackType=-1;G.userVoiceEnabled=!1;"disableIncludeScreenshot"in G||(G.disableIncludeScreenshot=
!1);"screenshot"in G||(G.screenshot=!1);G.disableScreenshotPreview=!1;G.includeScreenshotSelectedDefault=!0;return G};pa.prototype.V4i=function(G){if(!this.TQa&&Df.EwaSettings.ma(727)&&Df.EwaSettings.getBooleanFeatureGate(pa.tci,!1)){var ja=Df.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?"Insights.Https.PPE.Bundle":"Insights.Https.Bundle";ja=this.rye(ja);var Wa=new rd;Wa.Xj=hf.a.Sbd;this.TQa=this.OPd(ja,null,!1,null,Wa);ja={};Dj.b(this.$).he(oi.a.W4i,(ja.Location=
ii.a[G.ef],ja.InputMethod=xi.a[G.method],ja),void 0,!0)}};pa.prototype.s2f=function(G){var ja=this.$.ea.ah.get(17);Ji.a.instance.qc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(Wa){Wa.isFeatureEnabled("mso_sendASmile",ja).then(function(vb){G.FeedbackEnabled=ja&&vb;return null})})};pa.prototype.q7f=function(G,ja){var Wa=gj.g(this.$),vb=new Bj.a,f={};f.ActiveTab=ja;f.DatapaneFlighting=Df.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",
!1);f.RangePickerFlighting=Df.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneDataRangePicker",!1);f.AceFlighting=!0;f.ChartNewSDXRecording=Df.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OfficeScriptingChartTaskPaneNewRecording",!1);f.ThemeColorsFlighting=Df.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1)&&Df.EwaSettings.isChangeGateEnabled("OfficeVSO:5732064_ThemeColorsInChartsTaskpaneEnabled");f.UOMirror=Df.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UOMirror",
!1);this.s2f(f);f.startTimeMs=Date.now();f.UserSessionId=this.$.ya.UserSessionId;(ja=Wa.ga.Pa.Qo)&&(f.SubSelection=ja);df.ULS.sendTraceTag(592524688,0,50,"Chart task pane launched. UserSessionId: {0}, UILocation: {1}, SubSelection: {2}",f.UserSessionId,void 0===G.ef||null===G.ef?"Null":ii.a[G.ef],ja||"ChartRoot");vb.CI=f;vb.ql=Ff.a.instance.fa(953);f=new rd;f.Oba=hf.a.G3a;return this.x1(G,pa.H_g,vb,!0,f)};pa.prototype.UFj=function(G){var ja=new Bj.a;ja.CI={};ja.ql=Ff.a.instance.fa(1759);ja.qT=pa.Oof;
var Wa=new rd;Wa.Oba=hf.a.G3a;return this.x1(G,pa.Oof,ja,!0,Wa,void 0,ja.ql)};pa.prototype.eGj=function(G){var ja=new Bj.a;ja.CI={};ja.ql=Ff.a.instance.fa(2124);var Wa=new rd;Wa.Oba=hf.a.Wwh;Wa.JOb=hf.a.fSe;return this.x1(G,pa.PHi,ja,!0,Wa)};pa.prototype.e$e=function(G,ja){var Wa=pa.ibf,vb=G[rj.a.od].toString(),f={},D=new Bj.a;D.ql=Ff.a.instance.fa(9);switch(vb){case "A0":f.query=(G[rj.a.Gg]||"").split("|").slice(2,qh.a.KT).join("|");break;case "A1":f.query=G.CommandValueId;break;case "Help":f.gwdropdownflightinfo=
Df.EwaSettings.ma(240);f.query="";break;case Qi.a.gKd:Df.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",!1)?(D.ql=Ff.a.instance.fa(1725),D.sourceLocationOverrideResourceId=pa.N8e,f.feedback=this.O5g()):f.query=vb;break;case "HelpArticle":f.query=G[rj.a.Gg];break;case "ContactSupport":case "ShowTraining":case "WhatsNew":f.query=vb;break;default:return Zj.Task.Sa(!0)}D.CI=f;vb=new rd;vb.Oba=hf.a.G3a;return this.x1(ja,Wa,D,!1,vb,G[Qi.a.qpa]||!1)};pa.prototype.rye=
function(G){var ja={Version:"0.0.0.0"};ja.AssetId=pa.FMa;ja.SolutionId=pa.FMa;ja.AssetStoreId="";ja.StoreType=OSF.StoreType.Sdx;ja.Height=0;ja.Width=0;ja.StoreId=OSF.StoreType.Sdx;ja.TargetType=OSF.OsfControlTarget.TaskPane;ja.IsToBePersisted=!1;ja.SourceLocationOverrideResourceId=G;ja.SharedRuntimeId=G;return ja};pa.prototype.w8h=function(G,ja,Wa){var vb=this,f=new Bj.a,D=new rd,N={};this.TQa&&this.s2f(N);N.LaunchSource="";N.StartTimeMs=Date.now();N.CorrelationId=Qj.a.create().toString();f.CI=N;
f.focusOnIframeWhenLoaded=!0;f.taskPaneWidth=pa.Hcf;D.Oba=hf.a.Twh;D.JOb=hf.a.cSe;switch(Wa.command){case -1444574190:var fa,Ia;N.LaunchMode="RecommendedPivotTables";N.SelectionContext="";N.LaunchSource="PivotTableHandRaise"===Object(Ii.a)(String,G.SourceControlId)?"PivotTableHandRaise":"InsertPivotTable";if(this.$&&Df.EwaSettings.isChangeGateEnabled("OfficeVSO:4618462_PassSourceSelectionToIdeas")&&G.SourceSelection){var pb=G.SourceSelection.split(",")[0];ja=Df.EwaSettings.isChangeGateEnabled("OfficeVSO:4701499_IdeasSelectionIndexing")?
-1:0;if(function(){var kd=Ij.Z(pb,vb.$.xa);fa=kd.sheetName;Ia=kd.kIb;Wb=kd.range;return kd}().returnValue&&!gj.g(this.$).Tb.Qla(Wb))G=this.$.xa.getItemByName(fa),N.SelectionContext=JSON.stringify(Object.assign(new ib,{address:Ia,addressWithSheet:fa+"!"+Wb.AB(!1),sheetId:oj.d(G),sheetName:fa,isSheetEmpty:!1,columnCount:Wb.width,rowCount:Wb.height,columnIndex:Wb.left+ja,rowIndex:Wb.top+ja,selectionType:"Continuous"}));else if((G=this.$.Ab.getItemByName(Object(Ii.a)(String,G.SourceSelection)))&&oj.o(G)){var Wb=
el.a(G,!0);var Nc=this.$.xa.getItemByName(G.sheetName);N.SelectionContext=JSON.stringify(Object.assign(new Da,{tableName:G.name,hasTableHeaders:el.d(G),isPivotTable:!1,isTable:!0,userSelectedPivotTable:!1,address:Wb.AB(!1),addressWithSheet:Nc.name+"!"+Wb.AB(!1),sheetId:oj.d(Nc),sheetName:Nc.name,isSheetEmpty:!1,columnCount:Wb.width,rowCount:Wb.height,columnIndex:Wb.left+ja,rowIndex:Wb.top+ja,selectionType:"Continuous"}))}}Df.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",
!1)?f.sourceLocationOverrideResourceId="RecommendPivotTables.PPE.Bundle":f.sourceLocationOverrideResourceId="RecommendPivotTables.Bundle";f.ql=Ff.a.instance.fa(1769);Df.EwaSettings.isChangeGateEnabled("OfficeVSO:5995559_IdeasReactSvgIcons")&&(f.qT=pa.X2i);f.Xj=hf.a.wUe;D.Xj=hf.a.wUe;break;case -336193495:N.LaunchMode="RecommendedCharts";Df.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?f.sourceLocationOverrideResourceId="RecommendCharts.PPE.Bundle":f.sourceLocationOverrideResourceId=
"RecommendCharts.Bundle";f.ql=Ff.a.instance.fa(1768);Df.EwaSettings.isChangeGateEnabled("OfficeVSO:5995559_IdeasReactSvgIcons")&&(f.qT=pa.Laj);f.Xj=hf.a.xUe;D.Xj=hf.a.xUe;break;case -1336341324:if(!Df.EwaSettings.ma(491))return Zj.Task.Sa(!1);N.LaunchMode="NL";Df.EwaSettings.isChangeGateEnabled("OfficeVSO:5995559_IdeasReactSvgIcons")&&(f.qT=pa.QYc);Df.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?f.sourceLocationOverrideResourceId="IdeasNL.PPE.Bundle":f.sourceLocationOverrideResourceId=
"IdeasNL.Bundle";switch(Df.EwaSettings.getIntFeatureGate("Microsoft.Office.ExcelOnline.Insights.GridContextMenuQnABrandingCandidatesIndex",0)){case 1:f.ql=Ff.a.instance.fa(1773);N.NLLaunchModeBrandingCandidatesIndex=1;break;case 2:f.ql=Ff.a.instance.fa(1774);N.NLLaunchModeBrandingCandidatesIndex=2;break;default:f.ql=Ff.a.instance.fa(1772),N.NLLaunchModeBrandingCandidatesIndex=0}break;case 2086613372:if(!Df.EwaSettings.ma(235))return Zj.Task.Sa(!1);N.LaunchMode="ChartDesigner";N.LaunchSelectionMode=
ja.toString();Df.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?f.sourceLocationOverrideResourceId="Insights.Https.PPE.Bundle":f.sourceLocationOverrideResourceId="Insights.Https.Bundle";f.ql=Ff.a.instance.fa(1775);Df.EwaSettings.isChangeGateEnabled("OfficeVSO:5995559_IdeasReactSvgIcons")&&(f.qT=pa.QYc);break;default:N.LaunchMode="Default",Df.EwaSettings.ma(235)&&(N.LaunchSelectionMode=ja.toString()),Df.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",
!1)?f.sourceLocationOverrideResourceId="Insights.Https.PPE.Bundle":f.sourceLocationOverrideResourceId="Insights.Https.Bundle",f.ql=Ff.a.instance.fa(1770),Df.EwaSettings.isChangeGateEnabled("OfficeVSO:5995559_IdeasReactSvgIcons")&&(f.qT=pa.QYc),f.Xj=hf.a.Sbd,D.Xj=hf.a.Sbd}return Df.EwaSettings.ma(727)?(Df.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?f.sourceLocationOverrideResourceId="Insights.Https.PPE.Bundle":f.sourceLocationOverrideResourceId="Insights.Https.Bundle",
this.TQa?this.TQa.CWR(function(){return vb.u0f(N,f)}):this.Qfi(Wa,f,D,N)):this.x1(Wa,pa.FMa,f,!0,D)};pa.prototype.Qfi=function(G,ja,Wa,vb){var f=this;this.TQa=this.OPd(this.rye(ja.sourceLocationOverrideResourceId),ja,!1,G,Wa,!1);return this.TQa.CWR(function(){return f.u0f(vb,ja)})};pa.prototype.u0f=function(G,ja){var Wa=this.Le.nba(this.Le.E4a(pa.FMa,ja.sourceLocationOverrideResourceId));if(Wa){this.reb[pa.FMa]=G;var vb=this.Bzd(this.Le.j_(Wa).OsfPropertyBag,pa.FMa);this.Le.j_(Wa).OsfPropertyBag=
vb}this.GOa(pa.FMa,"LaunchIdeasAction",G,ja);return Zj.Task.Sa(!0)};pa.prototype.x1=function(G,ja,Wa,vb,f,D,N){Wa=void 0===Wa?null:Wa;vb=void 0===vb?!1:vb;f=void 0===f?null:f;D=void 0===D?!1:D;N=void 0===N?null:N;Th.TaskExtensions.Dl();Wa||(Wa=new Bj.a);var fa={Version:"0.0.0.0"};fa.AssetId=ja;fa.SolutionId=ja;fa.AssetStoreId="";fa.StoreType=vb?OSF.StoreType.Sdx:OSF.StoreType.FirstParty;fa.Height=0;fa.Width=0;fa.StoreId=vb?OSF.StoreType.Sdx:OSF.StoreType.FirstParty;fa.TargetType=OSF.OsfControlTarget.TaskPane;
fa.IsToBePersisted=!1;fa.SourceLocationOverrideResourceId=Wa.sourceLocationOverrideResourceId;if(Wa.ql||N)this.Zdd[ja]=Object.assign(new Rb,{XBc:Wa.ql,mYd:N,VBc:Wa.qT});Df.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1)?(Wa.CI||(Wa.CI={}),Wa.CI.ShowFeedback=this.$.isFeedbackEnabled,this.reb[ja]=Wa.CI):Wa.CI&&(this.reb[ja]=Wa.CI);ja={};ja[rj.a.Gg]=fa;N={};N.solutionId=fa.SolutionId;N.version=fa.Version;N.storeType=fa.StoreType;
N.storeId=fa.StoreId;N.assetId=fa.AssetId;N.assetStoreId=fa.AssetStoreId;N.height=fa.Height;N.targetType=fa.TargetType;N.width=fa.Width;N.isAddinCommands=!vb;ja[wg.a.$sa]=N;f||(f=new rd);f.focusOnIframeWhenLoaded=Wa.focusOnIframeWhenLoaded;f.width=Wa.taskPaneWidth;ja[rd.key]=f;ja[Qi.a.qpa]=D;return this.insertAgave(ja,G)};pa.prototype.Lhi=function(G,ja,Wa,vb,f){function D(Wb){df.ULS.sendTraceTag(537170440,220,50,"Insert addincommands for {0} from {1}.",Telemetry.PrivacyRules.GetPrivacyCompliantId(Wb.solutionId,
Wb.storeType,Wb.assetId,null,null,Wb.storeId),Wb.storeType);var Nc={},kd=new Kh.a;kd.add(Wb);Nc[wg.a.m_a]=kd;Nc[wg.a.$M]=3;Wb=new Qc.a(xc.a.TCb,0,fa.$.jd,0,null);return fa.$.Ka.dc(Wb,Nc)}function N(Wb,Nc){var kd=Wb.SolutionId;var Xc=OSF.OsfControl.isFirstPartyStoreString(Wb.StoreType);Xc&&Wb.SourceLocationOverrideResourceId&&(kd=fa.Le.E4a(kd,Wb.SourceLocationOverrideResourceId));var Ie=fa.Le.IBe(kd,null,Wb.SharedRuntimeId);Xc&&(Df.EwaSettings.ma(299)&&Ie&&(Xc=fa.Le.nba(kd))&&(kd=null,kd=fa.Bzd(fa.Le.j_(Xc).OsfPropertyBag,
Wb.SolutionId),(Xc=fa.Le.Ni.getOsfControl(Xc))&&Xc.setSettings(kd)),Wb.SharedRuntimeId&&Ie||fa.Le.Ni.refreshOsfControl(Wb.SolutionId,Wb.SourceLocationOverrideResourceId));if(!Ie){var Ze=fa.$.na.ta.fc(),Sf=519;Ie=function(ag,og,Vg){var Hh=fa.$.na.ta;ag=ci.b(ag,fa.TLf);var ji=Hh.Ma(9,Ze);ji.sharedInfo=Wb;return $i.i(Hh,"InsertAgaveTaskpane",ji,ag,og,Vg,vb,0)};void 0===Wb.IsToBePersisted||null===Wb.IsToBePersisted||Wb.IsToBePersisted||(Sf=538,Ie=function(ag,og,Vg){df.ULS.sendTraceTag(537170442,220,50,
"Web Method ShowAgaveTaskpane is called, StoreType {0}, StoreId {1}, SolutionId {2}.",Wb.StoreType,Wb.StoreId,Telemetry.PrivacyRules.GetPrivacyCompliantId(Wb.SolutionId,Wb.StoreType,Wb.AssetId,null,null,Wb.StoreId));var Hh=fa.$.na.ta;ag=ci.b(ag,fa.TLf);var ji=Hh.Ma(9,void 0===Ze?null:Ze);ji.sharedInfo=Wb;return $i.i(Hh,"ShowAgaveTaskpane",ji,ag,og,Vg,vb,0)});return Df.EwaSettings.uc()?(f|=64,Tk.a(fa.$.userOperationManager,Ie,function(ag){return new ch.a(Sf,0,ag,f)},Nc)):Tk.a(fa.$.userOperationManager,
Ie,function(ag){return new bj.a(Sf,0,ag,f)},Nc)}return Th.TaskExtensions.s5()}var fa=this;if(!Df.EwaSettings.ma(54)||G.StoreId===OSF.StoreType.FirstParty)return N(G,Wa,vb);if(ja.isAddinCommands)return D(ja);var Ia=new fj.a,pb={};pb.marketplaceId=G.SolutionId;pb.marketplaceVersion=G.Version;pb.storeType=G.StoreType;pb.storeId=G.StoreId;pb.targetData=G;Df.EwaSettings.ma(94)&&(pb.clearCache=!0);this.Le.Ni.isAddinCommandsAsync(pb,function(Wb,Nc,kd){Ia.setResult(Nc);Wb||(Wb=kd.targetData,df.ULS.sendTraceTag(537170438,
220,10,"Judging AddinCommands failed for {0} from {1} during addin inserting",Telemetry.PrivacyRules.GetPrivacyCompliantId(Wb.SolutionId,Wb.StoreType,Wb.AssetId,null,null,Wb.StoreId),Wb.StoreType))});return Th.TaskExtensions.ts(Ia.task,function(Wb){return Wb.result?D(ja):N(G,Wa,vb)},this.$.la)};pa.prototype.Bzd=function(G,ja){if(!this.reb[ja])return G;var Wa={};if(G){G=Cl(G);for(var vb=G.next();!vb.done;vb=G.next())vb=vb.value,Wa[vb[0]]=vb[1]}G=this.reb[ja];vb=Cl(Object.keys(G));for(ja=vb.next();!ja.done;ja=
vb.next())ja=ja.value,ja===pa.QEh&&Df.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",!1)?Wa[ja]=Sys.Serialization.JavaScriptSerializer.serialize(G[ja]):Wa[ja]=Sys.Serialization.JavaScriptSerializer.serialize(G[ja].toString());ja=Object.keys(Wa).length;G=Array(ja);vb=0;var f=Cl(Object.keys(Wa));for(ja=f.next();!ja.done;ja=f.next())ja=ja.value,G[vb]=[ja,Wa[ja].toString()],vb++;return G};pa.prototype.eAi=function(G,ja,Wa){var vb=this.$.ya.UserSessionId,f=
this.$.ya.UICultureTag,D=this.$.ya.UICultureTagLcid,N=this.$.ya.WacHostId,fa="",Ia="";5<=Wa.length&&(fa=Wa[3],Ia=Wa[4]);this.fAi(fa,Ia,G,ja,f,D,vb,N)};pa.prototype.fAi=function(G,ja,Wa,vb,f,D,N,fa){var Ia={};Ia.a=N;Ia.b=Wa;Ia.c=vb;Ia.d=G;Ia.e=ja;Ia.f=f;Ia.g=D;Ia.h=fa;zk.b().Te(36,Ia)};pa.prototype.KAe=function(){if(Vj.a.qxf())df.ULS.sendTraceTag(537170433,1302,15,"OBF is undefined");else{try{OfficeBrowserFeedback.createScreenshot(document.body).then(this.VLf);return}catch(G){df.ULS.sendTraceTag(537170432,
1302,15,"Failed to use createScreenshot "+(G?G.toString():null))}try{OfficeBrowserFeedback.html2canvas(document.body,null)().then(this.VLf)}catch(G){df.ULS.sendTraceTag(537170403,1302,15,"Failed to use html2canvas"+(G?G.toString():null))}}};pa.prototype.OPd=function(G,ja,Wa,vb,f,D){ja=void 0===ja?null:ja;Wa=void 0===Wa?!1:Wa;vb=void 0===vb?null:vb;f=void 0===f?null:f;D=void 0===D?!0:D;var N=G.SolutionId,fa=Zj.Task.Sa(!1);G&&N&&G.SharedRuntimeId&&(vb=vb||new Qc.a(-859308420,0,2,0,""),N={},N.solutionId=
G.SolutionId,N.version=G.Version,N.storeType=G.StoreType,N.storeId=G.StoreId,N.assetId=G.AssetId,N.assetStoreId=G.AssetStoreId,N.height=G.Height,N.targetType=G.TargetType,N.width=0,N.isAddinCommands=!1,N.sharedRuntimeId=G.SharedRuntimeId,G.Preload=D,f=f?f:new rd,f.width=0,ja&&(f.focusOnIframeWhenLoaded=ja.focusOnIframeWhenLoaded,D=new Rb,ja.ql&&(D.XBc=ja.ql),0<ja.taskPaneWidth&&(D.Wr=ja.taskPaneWidth),ja.qT&&Df.EwaSettings.isChangeGateEnabled("OfficeVSO:5995559_IdeasReactSvgIcons")&&(D.VBc=ja.qT),
this.Zdd[G.SolutionId]=D),ja={},ja[rj.a.Gg]=G,ja[wg.a.$sa]=N,ja[rd.key]=f,ja[Qi.a.qpa]=Wa,fa=this.insertAgave(ja,vb));return fa};pa.prototype.GOa=function(G,ja,Wa,vb){vb=void 0===vb?null:vb;if(G&&ja){G=new Aj.a(G,OSF.StoreType.Sdx,OSF.StoreType.Sdx,"1.0.0.0");var f=new sj.a("ExcelOnline","Web",this.$.ya.UICultureTag),D=new bi.a;D.wi[qe.YVc]=Wa;vb&&(Wa=vb,Wa.sourceLocationOverrideResourceId&&(D.wi[qe.sourceLocationOverrideResourceId]=Wa.sourceLocationOverrideResourceId),Wa.ql&&(D.wi[qe.ql]=Wa.ql),
Wa.Xj&&(D.wi.IconCssClass=Wa.Xj),Wa.hYd&&(D.wi.TaskPaneIconUrl=Wa.hYd),Wa.qT&&(D.wi.TaskPaneIconId=Wa.qT));Zi.a.instance.GOa(G,Ak.a.action,ja,f,D)}};pa.prototype.GZh=function(G){if(!Ni.a.Qh(G)){var ja=G[uj.a.X$b];if(ja&&(ja=ja.getId(),G=G[uj.a.aAa],ja&&G))return this.E4a(ja,G.wi[qe.sourceLocationOverrideResourceId])}return null};pa.prototype.E4a=function(G,ja){ja=void 0===ja?null:ja;return G&&ja?String.format("{0}.{1}",G,ja):G};pa.prototype.dRh=function(G){switch(G){case 1172793074:case 1221897806:case 1930653487:return 2;
case -515602470:case 2086613372:return Df.EwaSettings.ma(235)?1023:1;case 1723441034:return 1023;case -859308420:return 1023;case 515196233:return 1023;default:return 1}};pa.tci="Microsoft.Office.Excel.IdeasXLOPreload";pa.CFd="IDS";pa.ibf="FA000000012";pa.FMa="FA000000005";pa.Aai="HelloWorld";pa.H_g="FA000000014";pa.N8e="Help.GiveFeedback.Url";pa.QEh="feedback";pa.Oof="FA000000066";pa.I4i="PowerBi.Url";pa.G4i="PowerBi.DevUrl";pa.H4i="FA000000054";pa.PHi="FA000000064";pa.T_i="FA000000075";pa.D7i="FA000000080";
pa.QYc="AnalyzeDataTaskPane";pa.Laj="RecommendedChartsTaskPane";pa.X2i="PivotTableTaskPane";pa.Ugh=350;pa.Hcf=320;pa.E7i=320;Object(Yd.a)(pa,"AgaveCommandManager",mk.a,[998,999]);uk.Object.defineProperties(nb,{instance:{configurable:!0,enumerable:!0,get:function(){return nb.Na}}});nb.Na=new nb;Object(Yd.a)(nb,"AppsDataManagerFactory",null,[]);Object(Yd.a)(function(G,ja){this.httpStatus=G;this.data=ja},"AppData",null,[]);zb.prototype.Zzb=function(G){this.Qog(this.Sog,G)};zb.prototype.TX=function(G,
ja,Wa,vb){0===G?this.vb&&this.Yg&&ja?this.Yg.jm(String.format("{0}AppsForOfficeProxy.ashx?lcid={1}&syslcid={1}&uilcid={1}&rt=xml&client={2}&cv=16.1.0.0",this.vb.appSettings.WebServiceBase,ig.AFrameworkApplication.lcid,ja),1,"",null,!0,2,Wa,vb,null):df.ULS.sendTraceTag(6070476,344,10,"The request objects are not available"):(ja={},df.ULS.sendTraceTag(6070477,344,15,"The request datatype is not supported.  {0}",(ja.dataType=G,ja)))};Object(Yd.a)(zb,"AppsDataProvider",null,[242]);var ok=Ui.a;Am(gb,ok);
gb.prototype.create=function(){var G=this,ja=this.$.da,Wa=cj.GetServiceTaskFactory.create(ja,106,this.la,this.ub),vb=cj.GetServiceTaskFactory.create(ja,104,this.la,this.ub),f=Lf.a.loadScript(36,0,this.ub,void 0,void 0,375);Th.TaskExtensions.Ba(Th.TaskExtensions.we([vb,Wa,f],this.la),function(){var D=new id(gk.a.instance),N=new zb(ig.AFrameworkApplication.ha,ig.AFrameworkApplication.Ld,"WAC_Excel");new Cb(D,N,"PreinstalledAppsData_Excel");D=null;Df.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",
!1)&&(D=Ji.a.instance.qc("Common.App.CustomerFeedback.ICustomerFeedbackFormManager").instance);wc.instance.initialize(Wa.result);D=new pa(G.$,Wa.result,vb.result,D,ig.AFrameworkApplication.Ib);ja.Ha(206,D);G.Eb(ja.Aa(374)||ja.Ha(374,D))},this.la,3);Ji.a.instance.register(Ch.a,"Common.Utils.AriaNotifier").as("Common.Utils.IAriaNotifier").Ic().Nc(function(){return new Ch.a(G.$.xw)})};gb.ka=function(G){G.da.Ha(375,new gb(G))};Object(Yd.a)(gb,"AgaveCommandManagerFactory",Ui.a,[]);var K=b(624);Za.prototype.initialize=
function(G){Df.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InstalledContentAddinsRibbonExperiment",!1)&&!this.initialized&&this.Foj(G)};Za.prototype.qhi=function(G,ja){var Wa=Th.TaskExtensions.Dl();if(this.initialized&&G&&0<G.length){var vb=this.cOh(G);G in this.kV&&(Wa=this.agaveCommandManager.insertAgave(vb,ja))}return Wa};Za.prototype.bEg=function(G){var ja=this;this.initialized&&(G=G[rj.a.Gg]||{},!G.SolutionId||G.SolutionId in this.kV||this.Le.Jda(function(Wa){ja.Jda(Wa)},
!0))};Za.prototype.t9h=function(G){var ja=this;this.initialized&&(G=G||"")&&0<G.length&&G in this.kV&&(delete this.kV[G],this.Le.Jda(function(Wa){ja.Jda(Wa)},!0))};Za.prototype.cOh=function(G){return G in this.kV?this.kV[G]:{}};Za.prototype.Jda=function(G){var ja=!1;if(G&&!G.errorCode){if(G.value){G=Cl(G.value);for(var Wa=G.next();!Wa.done;Wa=G.next()){Wa=Wa.value;var vb=Wa[1];Wa[3]==OSF.OsfControlTarget.InContent&&vb&&0<vb.length&&!(vb in this.kV)&&(ja={NoReporting:!1,IsSystemInitiated:!1},ja.description=
Wa[2],ja.iconUrl=Wa[9],ja[wg.a.$sa]={solutionId:Wa[1],version:Wa[4],storeType:Wa[6],storeId:Wa[11],assetId:Wa[5],assetStoreId:Wa[6],targetType:Wa[3],width:Wa[7],height:Wa[8],displayName:Wa[0],id:Wa[1],appVersion:Wa[4],currentStoreType:Wa[6]},ja[rj.a.Gg]={SolutionId:Wa[1],Version:Wa[4],StoreType:Wa[6],StoreId:Wa[11],AssetId:Wa[5],AssetStoreId:Wa[6],TargetType:Wa[3],Width:Wa[7],Height:Wa[8],Id:Wa[1],AppVersion:Wa[4],CurrentStoreType:Wa[6]},this.kV[vb]=ja,ja=!0)}}ja&&this.E9g()}};Za.prototype.E9g=function(){var G=
[],ja;for(ja in this.kV)G.push({id:ja,controlType:0,title:this.kV[ja][wg.a.$sa].displayName});if(0<G.length){for(var Wa in this.kV)appChrome.addInApi.registerAddinIcon("AddinIcon_"+Wa,this.kV[Wa].iconUrl);this.Q0g();appChrome.addInApi.dispatchActionsToInstallAddIn({tabs:[{id:Za.xxf,isOfficeTab:!0,groups:[{id:Za.Lef,title:Za.Mef,controls:G}]}]});for(var vb in this.kV)this.A1a.addCommandToMaps(Object.assign(new dd.a(vb,"-1473679467"),{legacyControlId:vb}))}};Za.prototype.Q0g=function(){appChrome.addInApi.dispatchActionsToRemoveAddIn({tabs:[{id:Za.xxf,
isOfficeTab:!0,groups:[{id:Za.Lef,title:Za.Mef,controls:[]}]}]})};Za.prototype.Foj=function(G){var ja=this,Wa=cj.GetServiceTaskFactory.Ua(G.da,374,375,1),vb=cj.GetServiceTaskFactory.create(G.da,106,G.la,1);Th.TaskExtensions.Ba(Th.TaskExtensions.we([Wa,vb],G.la),function(){ja.agaveCommandManager=Wa.result;ja.A1a=Ji.a.instance.Nh("Common.IExternalUICommandDefinitionMapping")||new K.a(G.Lb,G);ig.AFrameworkApplication.Ib.ic(xc.a.SSf,Bi.a.frame,function(f,D,N,fa,Ia){ja.t9h(Ia)});ja.Le=vb.result;ja.Le.Jda(function(f){ja.Jda(f)},
!0);ja.initialized=!0},G.la,3)};Za.xxf="tabinsert";Za.Lef="installedContentAddins";Za.Mef=Ff.a.instance.fa(2215);Object(Yd.a)(Za,"AgaveCommandRibbon",null,[968]);var na=Ui.a;Am(Ma,na);Ma.prototype.create=function(){if(Df.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InstalledContentAddinsRibbonExperiment",!1)){var G=this.$.da,ja=new Za;ja.initialize(this.$);this.Eb(G.Aa(488)||G.Ha(488,ja))}};Ma.ka=function(G){G.da.Ha(489,new Ma(G))};Object(Yd.a)(Ma,"AgaveCommandRibbonFactory",Ui.a,
[]);var Xa=b(945);oa.prototype.getTypeName=function(){return"Microsoft.Authentication.OfficeIdentityInfo"};oa.prototype.invokePropertyGet=function(G){switch(G){case 4:return this.displayName;case 3:return this.email;case 2:return this.federationProvider;case 1:return this.identityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};oa.prototype.invokePropertyGetAsync=function(G){G=this.invokePropertyGet(G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};
oa.prototype.invokePropertySet=function(G,ja){switch(G){case 4:this.displayName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ja,0,"string");return;case 3:this.email=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ja,0,"string");return;case 2:this.federationProvider=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ja,0,"string");return;case 1:this.identityType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ja,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);
};oa.prototype.invokePropertySetAsync=function(G,ja){this.invokePropertySet(G,ja);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};oa.prototype.invokeMethod=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};oa.prototype.invokeMethodAsync=function(G,ja){G=this.invokeMethod(G,ja);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};oa.S$g=function(G){var ja=new oa;ja.displayName=G.displayName;ja.email=G.email;switch(G.authority){case vg.ZIf:ja.identityType=
1;break;default:ja.identityType=0}ja.federationProvider="";return ja};uk.Object.defineProperties(oa.prototype,{displayName:{configurable:!0,enumerable:!0,get:function(){return this.fga},set:function(G){this.fga=G}},email:{configurable:!0,enumerable:!0,get:function(){return this.e9d},set:function(G){this.e9d=G}},federationProvider:{configurable:!0,enumerable:!0,get:function(){return this.O9d},set:function(G){this.O9d=G}},identityType:{configurable:!0,enumerable:!0,get:function(){return this.Ckb},set:function(G){this.Ckb=
G}}});Object(Yd.a)(oa,"OfficeIdentityInfo",null,[]);$b.Ucc=function(G){return G in $b.WPe?$b.WPe[G].toString():G};uk.Object.defineProperties($b,{WPe:{configurable:!0,enumerable:!0,get:function(){return $b.fsg}}});$b.map=null;var Qb={};$b.fsg=(Qb.GeneralException=Xa.a.generalException,Qb.AccessDenied=Xa.a.UVc,Qb.ApiNotAvailable=Xa.a.apiNotAvailable,Qb.UserNotSignedIn=Xa.a.userNotSignedIn,Qb.UserAborted=Xa.a.userAborted,Qb.UnsupportedUserIdentity=Xa.a.rVj,Qb.InvalidResourceUrl=Xa.a.invalidResourceUrl,
Qb.InvalidGrant=Xa.a.invalidGrant,Qb.AddinIsAlreadyRequestingToken=Xa.a.PLg,Qb.ResourceNotAllowed=Xa.a.Bmj,Qb.ClientError=Xa.a.clientError,Qb.ServerError=Xa.a.serverError,Qb);Object(Yd.a)($b,"SingleSignOnErrorCodeMap",null,[]);Gb.prototype.getTypeName=function(){return"Microsoft.Authentication.SingleSignOnToken"};Gb.prototype.invokePropertyGet=function(G){switch(G){case 2:return this.accessToken;case 3:return this.tokenIdenityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);
};Gb.prototype.invokePropertyGetAsync=function(G){G=this.invokePropertyGet(G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};Gb.prototype.invokePropertySet=function(G,ja){switch(G){case 2:this.accessToken=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ja,0,"string");return;case 3:this.tokenIdenityType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ja,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};Gb.prototype.invokePropertySetAsync=
function(G,ja){this.invokePropertySet(G,ja);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};Gb.prototype.invokeMethod=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};Gb.prototype.invokeMethodAsync=function(G,ja){G=this.invokeMethod(G,ja);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};uk.Object.defineProperties(Gb.prototype,{accessToken:{configurable:!0,enumerable:!0,get:function(){return this.GRb},set:function(G){this.GRb=
G}},tokenIdenityType:{configurable:!0,enumerable:!0,get:function(){return this.Ckb},set:function(G){this.Ckb=G}}});Object(Yd.a)(Gb,"SingleSignOnToken",null,[]);xa.prototype.getTypeName=function(){return"Microsoft.Authentication.TokenParameters"};xa.prototype.invokePropertyGet=function(G){switch(G){case 3:return this.authChallenge;case 7:return this.correlationId;case 4:return this.policy;case 2:return this.resource;case 5:return this.scope;case 6:return this.silentLogin}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);
};xa.prototype.invokePropertyGetAsync=function(G){G=this.invokePropertyGet(G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};xa.prototype.invokePropertySet=function(G,ja){switch(G){case 3:this.authChallenge=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ja,0,"string");return;case 7:this.correlationId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ja,0,"string");return;case 4:this.policy=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ja,0,"string");
return;case 2:this.resource=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ja,0,"string");return;case 5:this.scope=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ja,0,"string");return;case 6:this.silentLogin=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ja,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};xa.prototype.invokePropertySetAsync=function(G,ja){this.invokePropertySet(G,ja);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};
xa.prototype.invokeMethod=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};xa.prototype.invokeMethodAsync=function(G,ja){G=this.invokeMethod(G,ja);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};uk.Object.defineProperties(xa.prototype,{authChallenge:{configurable:!0,enumerable:!0,get:function(){return this.s5d},set:function(G){this.s5d=G}},correlationId:{configurable:!0,enumerable:!0,get:function(){return this.rE},set:function(G){this.rE=G}},
policy:{configurable:!0,enumerable:!0,get:function(){return null},set:function(){}},resource:{configurable:!0,enumerable:!0,get:function(){return this.qXb},set:function(G){this.qXb=G}},scope:{configurable:!0,enumerable:!0,get:function(){return this.Hje},set:function(G){this.Hje=G}},silentLogin:{configurable:!0,enumerable:!0,get:function(){return this.Uke},set:function(G){this.Uke=G}}});Object(Yd.a)(xa,"TokenParameters",null,[903]);bb.prototype.getAccessToken=function(G){var ja=this,Wa=this.ajb.getOsfControl(this.RA),
vb=Wa.getManifest(),f=vb.getMarketplaceID();this.ZOa(G,f);return OfficeExtension.WacRuntime.Utility.createPromise(function(D,N){Wa.isFirstParty()&&ja.ajb._enableFirstPartySSO?ja.kki(vb,G)?Ji.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAccessToken(G,f).then(function(fa){D(fa)},function(fa){N(fa)}):N(Xa.a.UVc):N(Xa.a.apiNotAvailable)}).then(function(D){switch(D.authority){case vg.ZIf:var N=1;break;default:N=0}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new Gb(D.accessToken,
N))},function(D){ja.logErrorResponse(G,f,D);return D?OfficeExtension.WacRuntime.Utility.createPromise(function(N,fa){fa(OfficeExtension.WacRuntime.Utility.createRichApiException(D,$b.Ucc(D)))}):OfficeExtension.WacRuntime.Utility.createPromise(function(N,fa){fa(OfficeExtension.WacRuntime.Utility.createRichApiException(Xa.a.generalException,$b.Ucc(Xa.a.generalException)))})})};bb.prototype.getAuthContext=function(){return null};bb.prototype.getPrimaryIdentityInfo=function(){var G=this.ajb.getOsfControl(this.RA);
G.getManifest();var ja=G.getManifest().getMarketplaceID();return OfficeExtension.WacRuntime.Utility.createPromise(function(Wa,vb){Ji.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getPrimaryIdentityInfo(ja).then(function(f){Wa(f)},function(f){vb(f.toString())})}).then(function(Wa){Wa=oa.S$g(Wa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Wa)},function(Wa){return Wa?OfficeExtension.WacRuntime.Utility.createPromise(function(vb,f){f(OfficeExtension.WacRuntime.Utility.createRichApiException(Wa,
$b.Ucc(Wa)))}):OfficeExtension.WacRuntime.Utility.createPromise(function(vb,f){f(OfficeExtension.WacRuntime.Utility.createRichApiException(Xa.a.generalException,$b.Ucc(Xa.a.generalException)))})})};bb.prototype.getTypeName=function(){return"Microsoft.Authentication.AuthenticationService"};bb.prototype.invokePropertyGet=function(G){switch(G){case 99:return this.roamingSettings}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};bb.prototype.invokePropertyGetAsync=function(G){G=
this.invokePropertyGet(G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};bb.prototype.invokePropertySet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};bb.prototype.invokePropertySetAsync=function(G,ja){this.invokePropertySet(G,ja);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};bb.prototype.invokeMethod=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};bb.prototype.invokeMethodAsync=
function(G,ja){switch(G){case 1:return this.wNh(ja);case 3:return this.MOh();case 2:return this.G_h()}G=this.invokeMethod(G,ja);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};bb.prototype.wNh=function(G){G=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,xa);return this.getAccessToken(G)};bb.prototype.MOh=function(){return this.getAuthContext()};bb.prototype.G_h=function(){return this.getPrimaryIdentityInfo()};bb.prototype.kki=function(G,ja){var Wa=!1,vb=G.getWebApplicationAuthorizations();
G=null;vb=Cl(vb);for(var f=vb.next();!f.done;f=vb.next())if(f=f.value,f.getResource().toLowerCase()===ja.resource.toLowerCase()){G=f;Wa=!0;break}if(!Wa)return!1;ja=ja.scope.split(" ,+");ja=Cl(ja);for(Wa=ja.next();!Wa.done;Wa=ja.next())if((Wa=Wa.value)&&Wa.length){vb=!1;f=Cl(G.getScopes());for(var D=f.next();!D.done;D=f.next())Wa.toLowerCase()===D.value.toLowerCase()&&(vb=!0);if(!vb)return!1}return!0};bb.prototype.ZOa=function(G,ja){G=this.jxf(G.resource);var Wa={};df.ULS.sendTraceTag(538572831,369,
50,"{0}",(Wa.manifestId=ja,Wa.resource=G,Wa))};bb.prototype.logErrorResponse=function(G,ja,Wa){G=this.jxf(G.resource);var vb={};df.ULS.sendTraceTag(538572830,369,10,"{0}",(vb.manifestId=ja,vb.resource=G,vb.error=Wa,vb))};bb.prototype.jxf=function(G){return G.replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")};uk.Object.defineProperties(bb.prototype,{roamingSettings:{configurable:!0,enumerable:!0,get:function(){return null}}});Object(Yd.a)(bb,"AuthenticationService",null,[]);
Ua.prototype.create=function(G,ja){return new bb(G,ja)};Object(Yd.a)(Ua,"AuthenticationServiceFactory",null,[]);var tc=b(1060),md=b(1188),Dd=b(1155);ab.generalException="generalException";ab.invalidArgument="invalidArgument";ab.notAllowed="notAllowed";ab.apiNotAvailable="apiNotAvailable";ab.unresolvedPendingRequest="unresolvedPendingRequest";ab.timeout="timeout";ab.adalTimeout="adalTimeout";ab.userNotSignedIn="userNotSignedIn";ab.userAborted="userAborted";ab.silentSignInFailed="silentSignInFailed";
ab.invalidResourceUrl="invalidResourceUrl";ab.invalidGrant="invalidGrant";ab.connectionLost="connectionLost";ab.clientError="clientError";ab.serverError="serverError";Object(Yd.a)(ab,"WopiHostErrorCodes",null,[]);Object(Yd.a)(Fa,"OAuthCallerMetadata",null,[]);Aa.prototype.lDg=function(G,ja,Wa,vb,f,D){var N=this;if(!this.Yya)return vb=new md.a,vb.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,Promise.resolve(vb);var fa=new Fa;fa.AddinName=f;fa.AddinTrustId=D;var Ia=-1;D=null;if(vb&&
this.wif())D=this.Yya.Ceg(wg.a.kCc,G,vb,Aa.H5e(f),fa);else{var pb=Date.now();D=this.Yya.sT(wg.a.kCc,G,fa).then(function(Wb){Ia=Date.now()-pb;var Nc=(ja||Wa)&&"login_required"===Wb.ErrorCode;return(ja&&("interaction_required"===Wb.ErrorCode||"consent_required"===Wb.ErrorCode||"invalid_grant"===Wb.ErrorCode)||Nc)&&N.wif()?N.Yya.Ceg(wg.a.kCc,G,null,Aa.H5e(f),fa):Promise.resolve(Wb)})}return D.then(function(Wb){var Nc=new md.a;Wb.IsSuccess?(Nc.token=Wb.Token,Wb.Telemetry&&(Nc.FUa=Wb.Telemetry.fromCache,
Nc.expiresOn=Wb.Telemetry.expiresOn)):(Nc.errorCode=N.tDi(Wb),Nc.qYd=N.i1i(Wb));return Nc}).catch(function(){var Wb=new md.a;Wb.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;return Promise.resolve(Wb)}).then(function(Wb){Wb.fia="OauthManager";0<=Ia&&(Wb.Wxb=Ia);return Wb})};Aa.prototype.zmi=function(G){var ja=(ig.AFrameworkApplication.ha.Wa(ig.AFrameworkApplication.kfa)||"").toLowerCase();return(hg.a.Yla||"teams"===ja&&pj.a.gzb)&&!Aa.dmi(G)||!this.Yya||!this.Yya.Ixa()?!1:!0};Aa.prototype.wif=
function(){return this.Xrg||1!==Dd.a.acc()};Aa.prototype.tDi=function(G){switch(G.ErrorCode){case "UserCancelled":case "interaction_required":G=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted;break;case "consent_required":case "invalid_grant":G=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant;break;case "login_required":G=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform;break;case "invalid_client":case "invalid_application_ID":G=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;
break;case "invalid_resource":G=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl;break;case "popup_window_error":G=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost;break;default:G=G.ErrorCode===ab.userAborted?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted:G.ErrorCode===ab.silentSignInFailed?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform:G.ErrorCode===ab.invalidResourceUrl?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl:G.ErrorCode===ab.invalidGrant?
OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant:G.ErrorCode===ab.connectionLost?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost:OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError}return G};Aa.prototype.i1i=function(G){var ja="";(G=RegExp("AADSTS(\\d+)").exec(G.ErrorMessage))&&1<G.length&&(ja=G[1]);return ja};Aa.H5e=function(G){return String.format(CommonUIStrings.l_SSOSignInNeededNotification_Description_Text_Addins,G)};Aa.dmi=function(G){if(!G)return!1;G=G.toLowerCase();for(var ja=
Cl(tc.AppsForOfficeSingleSignOnManager.XXe),Wa=ja.next();!Wa.done;Wa=ja.next())if(Wa.value===G)return!0;return!1};Object(Yd.a)(Aa,"AppsforOfficeTokenFromOauthManager",null,[59]);qa.Epa=function(){if(ig.AFrameworkApplication.ha.ra("AppForOfficeSSOV2IsEnabled")){var G=null;try{G=Ji.a.instance.resolve("Common.App.OAuth.IOAuthManager")}catch(ja){df.ULS.sendTraceTag(592061330,1300,10,"Unable to resolve IOAuthManager: "+ja)}G=new Aa(G);qa.Na=new qa(G)}};qa.getInstance=function(){qa.Jae||(qa.Epa(),qa.Jae=
!0);return qa.Na};qa.Na=null;qa.Jae=!1;Object(Yd.a)(qa,"AppsForOfficeOauthManagerFactory",null,[38]);var ue=b(133);Object(Yd.a)(ha,"NewDocumentParameters",null,[]);var Ce=b(168);ka.prototype.createAndOpenWorkbook=function(G){var ja=this;if(G&&G.length>this.pwg)throw df.ULS.sendTraceTag(538572821,0,15,"Too large base64 stream size:{0}",G.length),OfficeExtension.WacRuntime.Utility.createRichApiException(Xa.a.invalidArgument,Ce.a.fa(1719));var Wa=new ha("blank","agave",G?"streamBase64":"streamEmpty",
G),vb=null;return OfficeExtension.WacRuntime.Utility.createPromise(function(f,D){var N=new ue.StandardDialog;N.lc=4;N.Fk(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_NewFileAPIConsentMessage,1,function(fa){2===fa||0===fa?D("Cancelled"):(vb=window.open(""),ja.Nwg.create(f,D,Wa).a2a())})}).then(function(f){if(!f)throw OfficeExtension.WacRuntime.Utility.createRichApiException(Xa.a.generalException,Ce.a.fa(1715));try{vb.top.location.href=f}catch(D){df.ULS.sendTraceTag(538572820,
0,10,"CreateWorkbook API - exception while trying to change Window.Top.Location.Href, isChrome:{0}, exception:{1}",hg.a.yp,D),df.ULS.sendTraceTag(538572819,0,50,"CreateWorkbook API: calling self Window.Location.Replace instead of Window.Top.Location.Replace"),vb.location.replace(f)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},function(f){if("Cancelled"===f)throw OfficeExtension.WacRuntime.Utility.createRichApiException(Xa.a.FFd,Ce.a.fa(1718));vb.close();ja.OOj();return null})};
ka.prototype.getTypeName=function(){return"Microsoft.ExcelServices.WacWorkbook"};ka.prototype.invokePropertyGet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};ka.prototype.invokePropertyGetAsync=function(G){G=this.invokePropertyGet(G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};ka.prototype.invokePropertySet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};ka.prototype.invokePropertySetAsync=function(G,
ja){this.invokePropertySet(G,ja);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};ka.prototype.invokeMethod=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};ka.prototype.invokeMethodAsync=function(G,ja){switch(G){case 1:return this.D8g(ja)}G=this.invokeMethod(G,ja);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};ka.prototype.D8g=function(G){G=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"string");return this.createAndOpenWorkbook(G)};
ka.prototype.OOj=function(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(Xa.a.generalException,Ce.a.fa(1715));};Object(Yd.a)(ka,"WacWorkbook",null,[]);var Kf=b(944),Wg=b(952);uk.Object.defineProperties(ia.prototype,{$:{configurable:!0,enumerable:!0,get:function(){return this.wb}}});Object(Yd.a)(ia,"RichApiPreviewExecutionContext",null,[]);var Dh=b(24),Ci=b(1084),wj=b(210),Jj=b(212),dk=b(115),vj=b(11),hj=Jj.a;Am(aa,hj);aa.prototype.start=function(G,ja){var Wa="<div class='"+dk.a.qsh+
" "+hf.a.il+"'><label for='{1}'>{0}</label></div>\r\n<div><input type='text' id='{1}' maxlength='388' class='"+dk.a.aD+"' /></div>";Wa=String.format(Wa,Vc.a.Rf(this.t8c.DdaBindingsMethod.PromptText.substr(0,200)),"bindingText");this.Rb.innerHTML=Wa;this.Bqb=vj.DOMElementExtensions.getElementById(this.Rb,"bindingText");G=ja?G.$3a(ja,this.t8c.DdaBindingsMethod.BindingId):null;(null===G||void 0===G?0:G.IsValidRef)?(ja=new Dh.Range(G.Reference.FirstRow+1,G.Reference.FirstColumn+1,G.Reference.LastRow+
1,G.Reference.LastColumn+1,!1,!1),this.Bqb.value=G.Reference.SheetName+"!"+ja):(G=gj.g(this.$).ga,this.Bqb.value=oj.f(this.$.oa)||!G.va.Wg?"":G.kja);this.initialize();this.pf()};aa.prototype.um=function(){this.X2c();this.addButton(0);this.addButton(1);hj.prototype.um.call(this)};aa.prototype.setFocus=function(){vj.DOMElementExtensions.setFocus(this.Bqb)};aa.prototype.validate=function(){return!0};aa.prototype.commit=function(){var G=this.Bqb.value.trim(),ja=G.indexOf("!");-1!==ja&&(G=this.w2h(G.substring(0,
ja))+G.substr(ja));this.$Je.addBinding(this.t8c,G,0,this.callback);return!0};aa.prototype.Jta=function(){this.$Je.uR.Bf(Kf.a.internalError,this.callback);hj.prototype.Jta.call(this)};aa.prototype.w2h=function(G){G=Xj.a.trimStart(G.trim(),"=");return G.length?G.startsWith("'")&&G.endsWith("'")?G:ze.HelperMethods.a$b(G):""};uk.Object.defineProperties(aa.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"DdaBindingPrompt"}}});Object(Yd.a)(aa,"DdaBindingPrompt",Jj.a,[]);J.prototype.Bf=
function(G,ja){if(ja){var Wa={};Wa.Error=G;Wa.Version=this.ea.af;ja(Wa)}};J.prototype.WKa=function(G,ja){this.Bf(G,ja)};J.prototype.OH=function(G,ja){this.Bf(Kf.a.wZe(G.Errors[0].MessageId),ja)};J.prototype.mv=function(G){G&&G(this.bR())};J.prototype.bR=function(){var G={Error:0};G.Version=this.ea.af;return G};Object(Yd.a)(J,"DdaErrorGenerator",null,[]);var aj=b(289),Gk=b(106);P.prototype.wAd=function(G,ja){function Wa(fa){var Ia=vb.$.xa.getItemByName(fa.SheetName);(null===Ia||void 0===Ia?0:Ia.visible)?
(gj.g(vb.$).Kg(fa,null,null,null,3,Gk.a.Zfh,void 0,void 0,void 0,void 0,!0),vb.uR.mv(ja)):vb.uR.Bf(Kf.a.jZg,ja)}var vb=this,f=G.DdaGoToByIdMethod.GoToType,D=G.DdaGoToByIdMethod.SelectionMode,N=G.DdaGoToByIdMethod.Id.toString().trim();0===f?this.FHi(N,D,G.DdaMethod.ControlId,Wa,ja):1===f?this.JHi(N,D,Wa,ja):this.uR.Bf(Kf.a.oVj,ja)};P.prototype.FHi=function(G,ja,Wa,vb,f){var D=this;this.sA.ddaGetBinding(Wa,G,function(N){if(!aj.a(N)&&N.Result&&N.Result.Reference){N=N.Result;var fa={};fa.SheetName=N.Reference.SheetName;
fa.FirstRow=N.Reference.FirstRow;fa.FirstColumn=N.Reference.FirstColumn;fa.LastRow=N.Reference.LastRow;fa.LastColumn=N.Reference.LastColumn;P.DYc(fa,ja);1!==N.BindingType?vb(fa):D.sA.ddaGetBindingData(Wa,G,1,0,2,0,0,-1,-1,function(Ia){aj.a(Ia)||!Ia.Result?D.uR.OH(Ia,f):(Ia=Ia.Result,2!==ja&&(fa.FirstRow-=Ia.Headers.length,0>fa.FirstRow&&(fa.FirstRow=0)),vb(fa))},f)}else D.uR.WKa(Kf.a.N9f,f)},f)};P.prototype.JHi=function(G,ja,Wa,vb){var f=this,D=Ij.z(G);D?(D=Ij.v(D,this.$),P.DYc(D,ja),Wa(D)):this.$.ea.isNamedObjectViewMode&&
this.$.Ab.Gj(G)?this.$.Ab.oa=this.$.Ab.getItemByName(G):(D=function(N){aj.a(N)||!N.Result?f.$.xa.contains(G)?(N={},N.SheetName=G,N.FirstRow=0,N.FirstColumn=0,N.LastRow=0,N.LastColumn=0,Wa(N)):f.uR.WKa(Kf.a.N9f,vb):(N=N.Result,P.DYc(N,ja),Wa(N))},this.$.xa.oa?this.sA.parseRangeForGoto(G,this.$.xa.oa.name,D,vb):this.sA.parseRange(G,D,vb))};P.DYc=function(G,ja){G.LastRow=2===ja?G.FirstRow:G.LastRow;G.LastColumn=2===ja?G.FirstColumn:G.LastColumn};Object(Yd.a)(P,"DdaNavigator",null,[]);var Uk=b(306),Ok;
(function(G){G[G.unsupported=0]="unsupported";G[G.surface=1]="surface";G[G.combo=2]="combo";G[G.column=3]="column";G[G.column3D=4]="column3D";G[G.bar=5]="bar";G[G.bar3D=6]="bar3D";G[G.line=7]="line";G[G.line3D=8]="line3D";G[G.pie=9]="pie";G[G.pie3D=10]="pie3D";G[G.scatter=11]="scatter";G[G.bubble=12]="bubble";G[G.area=13]="area";G[G.area3D=14]="area3D";G[G.doughnut=15]="doughnut";G[G.radar=16]="radar";G[G.stock=17]="stock";G[G.waterfall=18]="waterfall";G[G.funnel=19]="funnel";G[G.treemap=20]="treemap";
G[G.sunburst=21]="sunburst";G[G.boxWhisker=22]="boxWhisker";G[G.histogram=23]="histogram";G[G.pareto=24]="pareto";G[G.regionMap=25]="regionMap";G[G.noVisibleSeries=26]="noVisibleSeries";G[G.complexDataSource=27]="complexDataSource";G[G.pivotChart=28]="pivotChart"})(Ok||(Ok={}));Object(Yd.b)("ChartCategory",Ok);Object(Yd.a)(S,"MacroRecorderEventData",null,[]);Z.prototype.V0h=function(G){var ja;if(void 0===G||null===G||void 0===G.RequestBody||null===G.RequestBody)return null;var Wa=JSON.parse(G.RequestBody);
if(void 0!==G.ActiveChartId&&null!==G.ActiveChartId){Wa.ActiveChartId=G.ActiveChartId;var vb=gj.g(this.$).ga.Pa.nc;if(null===(ja=null===vb||void 0===vb?void 0:vb.floatingObject)||void 0===ja?0:ja.Zc)Wa.ActiveChartType=Ok[vb.floatingObject.Zc.ChartCategory]}void 0!==G.SheetMultiRange&&null!==G.SheetMultiRange&&(Wa.SheetName=G.SheetMultiRange.SheetName);return Wa};Z.prototype.d1h=function(G){if(void 0===G||null===G||void 0===G.Result||null===G.Result)return null;G=G.Result;return void 0===G.ResponseBody||
null===G.ResponseBody||G.ResponseBody[0].startsWith('{"Error":')?null:JSON.parse(G.ResponseBody.join(""))};Z.prototype.Jqi=function(G){return!!G&&!(void 0===G.eventId||null===G.eventId)&&0<G.eventId.length};Z.prototype.Bk=function(G){var ja=this;return function(){if(ja.$.lca){var Wa=ja.qVg(ja.request);if(ja.Jqi(Wa)){var vb=ja.V0h(ja.request),f=ja.d1h(G);if(vb&&!Ni.a.isEmpty(vb)&&f&&!Ni.a.isEmpty(f))return df.ULS.sendTraceTag(537163164,0,50,"[RichApiRecorder]: Creating a MacroRecorderRichApiRequestExecutedPayload object."),
new ec(Wa,vb,f);Wa=String.format("requestInfo: {0}; responseInfo: {1}",vb?"(not null)":"(null)",f?"(not null)":"(null)");df.ULS.sendTraceTag(537163163,0,50,"[RichApiRecorder]: Failed due to bad data: {0}",Wa)}}return new ec(null,null,null)}};Z.prototype.qVg=function(G){var ja=this.Kqi(G.SolutionId),Wa=Z.C0h(G);if(Wa&&ja)return ja={},df.ULS.sendTraceTag(537163162,0,50,"[RichApiRecorder][{0}]: {1}",this.parentName,(ja.recorderEventId=Wa,ja["request.SolutionId"]=G.SolutionId,ja)),new S(G.SolutionId,
Wa);var vb={};df.ULS.sendTraceTag(537163161,0,50,"[RichApiRecorder][{0}]: {1}",this.parentName,(vb.recorderEventId=Wa,vb.isRecorderAwareAddin=ja,vb["request.SolutionId"]=G.SolutionId,vb));return null};Z.prototype.Kqi=function(G){if(!G)return!1;G=G.toLowerCase();return Z.n6h().contains(G)};Z.n6h=function(){Z.KAa||(Z.KAa=new Wj.a(ek.a.Uk()),Z.KAa.add("f438b4e6-2b49-466f-9a91-b75f473eba96"),Z.KAa.add("fa000000005"),Z.KAa.add("907dd90f-a82f-4bbf-b4f2-fcd4868a5e14"),Z.KAa.add("fa000000014"),Z.KAa.add("c5daabb3-e185-4e8c-adfc-1a7b7283fb6f"));
return Z.KAa};Z.C0h=function(G){var ja=null,Wa=RegExp('"Name":"EnableOfficeScriptRecording".*?Arguments":\\[.*?"(.*?)"',"mi");if(Wa.test(G.RequestBody))ja=Wa.exec(G.RequestBody)[1];else{G=G.RequestHeaders;if(!G)return ja;Wa=lj.a.JKi.toLowerCase();for(var vb=0;vb<G.length;vb++)if(G[vb].Name.toLowerCase()===Wa){ja=G[vb].Value;break}}return ja};Z.KAa=null;Object(Yd.a)(Z,"DdaRichApiRequestRecorder",null,[]);var il=b(66),Vk=Uk.a;Am(ea,Vk);ea.prototype.J3=function(G){return Vk.prototype.J3.call(this,G)||
this.fYg(G)};ea.prototype.Bk=function(){return this.dPd.Bk(this.qd)};ea.prototype.Sfb=function(){var G={OperationType:3};G.RichApiRequest=this.request;return G};ea.prototype.fYg=function(G){var ja=this;return function(Wa,vb,f){return I(G,ja.request,ci.b(Wa,ja.Gnb),ci.a(vb,ja.Ujb),f,ja.t4)}};uk.Object.defineProperties(ea.prototype,{operationWorkingState:{configurable:!0,enumerable:!0,get:function(){return Df.EwaSettings.uc()?Object(il.a)(ea.prototype,this,"operationWorkingState"):2}},EEc:{configurable:!0,
enumerable:!0,get:function(){return this.iGa}},Ur:{configurable:!0,enumerable:!0,get:function(){return this.Gnb}},a5:{configurable:!0,enumerable:!0,get:function(){return this.Ujb}}});Object(Yd.a)(ea,"DdaRichApiRequestBatchOperation",Uk.a,[]);var jl=ch.a;Am(O,jl);O.prototype.Bk=function(){return this.dPd.Bk(this.qd)};uk.Object.defineProperties(O.prototype,{operationWorkingState:{configurable:!0,enumerable:!0,get:function(){return Df.EwaSettings.uc()?Object(il.a)(O.prototype,this,"operationWorkingState"):
0}}});Object(Yd.a)(O,"DdaRichApiRequestOperation",ch.a,[]);Q.prototype.ddaAddBinding=function(G,ja,Wa,vb,f,D,N){var fa=this;this.tK(function(Ia,pb,Wb){var Nc=fa.$.na.ta,kd=fa.rka();Ia=ci.b(Ia,D);pb=ci.a(pb,fa.KI);var Xc=Nc.Ma(9);Xc.controlId=G;Xc.bindingId=ja;Xc.bindingType=Wa;Xc.currentSheetName=kd;Xc.formula=vb;Xc.options=f;return $i.i(Nc,"DdaAddBinding",Xc,Ia,pb,Wb,N,0)},N,563)};Q.prototype.ddaReleaseBinding=function(G,ja,Wa,vb){var f=this;this.tK(function(D,N,fa){var Ia=f.$.na.ta;D=ci.b(D,Wa);
N=ci.a(N,f.KI);var pb=Ia.Ma(9);pb.controlId=G;pb.bindingId=ja;return $i.i(Ia,"DdaReleaseBinding",pb,D,N,fa,vb,0)},vb,564)};Q.prototype.ddaGetBinding=function(G,ja,Wa,vb){var f=this;this.tK(function(D,N,fa){var Ia=f.$.na.ta;D=ci.b(D,Wa);N=ci.a(N,f.KI);var pb=Ia.Ma(1);pb.controlId=G;pb.bindingId=ja;return $i.i(Ia,"DdaGetBinding",pb,D,N,fa,vb,0)},vb,565,16)};Q.prototype.ddaGetAllBindings=function(G,ja,Wa){var vb=this;this.tK(function(f,D,N){var fa=vb.$.na.ta;f=ci.b(f,ja);D=ci.a(D,vb.KI);var Ia=fa.Ma(1);
Ia.controlId=G;return $i.i(fa,"DdaGetAllBindings",Ia,f,D,N,Wa,0)},Wa,566,16)};Q.prototype.ddaGetBindingData=function(G,ja,Wa,vb,f,D,N,fa,Ia,pb,Wb){var Nc=this;this.tK(function(kd,Xc,Ie){var Ze=Nc.$.na.ta,Sf=Nc.rka();kd=ci.b(kd,pb);Xc=ci.a(Xc,Nc.KI);var ag=Ze.Ma(1);ag.controlId=G;ag.bindingId=ja;ag.coerceType=Wa;ag.valueFormat=vb;ag.filterType=f;ag.startRow=D;ag.startCol=N;ag.rowCount=fa;ag.colCount=Ia;ag.currentSheetName=Sf;return $i.i(Ze,"DdaGetBindingData",ag,kd,Xc,Ie,Wb,0)},Wb,567,16)};Q.prototype.ddaSetBindingData=
function(G,ja,Wa,vb,f,D,N){var fa=this;this.tK(function(Ia,pb,Wb){var Nc=fa.$.na.ta,kd=fa.rka();Ia=ci.b(Ia,D);pb=ci.a(pb,fa.KI);var Xc=Nc.Ma(9);Xc.controlId=G;Xc.bindingId=ja;Xc.startRow=Wa;Xc.startCol=vb;Xc.currentSheetName=kd;Xc.bindingData=f;return $i.i(Nc,"DdaSetBindingData",Xc,Ia,pb,Wb,N,0)},N,568)};Q.prototype.ddaGetSelectedData=function(G,ja,Wa,vb,f,D,N){var fa=this;this.tK(function(Ia,pb,Wb){var Nc=fa.$.na.ta,kd=fa.rka();Ia=ci.b(Ia,D);pb=ci.a(pb,fa.KI);var Xc=Nc.Ma(1);Xc.controlId=G;Xc.coerceType=
ja;Xc.valueFormat=Wa;Xc.filterType=vb;Xc.currentSheetName=kd;Xc.formula=f;return $i.i(Nc,"DdaGetSelectedData",Xc,Ia,pb,Wb,N,0)},N,569,16)};Q.prototype.ddaSetSelectedData=function(G,ja,Wa,vb,f){var D=this;this.tK(function(N,fa,Ia){var pb=D.$.na.ta,Wb=D.rka();N=ci.b(N,vb);fa=ci.a(fa,D.KI);var Nc=pb.Ma(9);Nc.controlId=G;Nc.currentSheetName=Wb;Nc.formula=ja;Nc.bindingData=Wa;return $i.i(pb,"DdaSetSelectedData",Nc,N,fa,Ia,f,0)},f,570)};Q.prototype.ddaLoadSettings=function(G,ja,Wa){var vb=this;this.tK(function(f,
D,N){var fa=vb.$.na.ta;f=ci.b(f,ja);D=ci.a(D,vb.KI);var Ia=fa.Ma(1);Ia.controlId=G;return $i.i(fa,"DdaLoadSettings",Ia,f,D,N,Wa,0)},Wa,501,16)};Q.prototype.ddaSaveSettings=function(G,ja,Wa,vb,f){var D=this;this.tK(function(N,fa,Ia){var pb=D.$.na.ta;N=ci.b(N,vb);fa=ci.a(fa,D.KI);var Wb=pb.Ma(9);Wb.controlId=G;Wb.settings=ja;Wb.overwriteIfStale=Wa;return $i.i(pb,"DdaSaveSettings",Wb,N,fa,Ia,f,0)},f,571)};Q.prototype.ddaAddRowsColumns=function(G,ja,Wa,vb,f,D){var N=this;this.tK(function(fa,Ia,pb){var Wb=
N.$.na.ta,Nc=N.rka();fa=ci.b(fa,f);Ia=ci.a(Ia,N.KI);var kd=Wb.Ma(9);kd.controlId=G;kd.bindingId=ja;kd.isRow=Wa;kd.currentSheetName=Nc;kd.bindingData=vb;return $i.i(Wb,"DdaAddRowsColumns",kd,fa,Ia,pb,D,0)},D,572)};Q.prototype.ddaDeleteAllDataValues=function(G,ja,Wa,vb){var f=this;this.tK(function(D,N,fa){var Ia=f.$.na.ta,pb=f.rka();D=ci.b(D,Wa);N=ci.a(N,f.KI);var Wb=Ia.Ma(9);Wb.controlId=G;Wb.bindingId=ja;Wb.currentSheetName=pb;return $i.i(Ia,"DdaDeleteAllDataValues",Wb,D,N,fa,vb,0)},vb,573)};Q.prototype.ddaClearBindingFormats=
function(G,ja,Wa,vb){var f=this;this.tK(function(D,N,fa){var Ia=f.$.na.ta,pb=f.rka();D=ci.b(D,Wa);N=ci.a(N,f.KI);var Wb=Ia.Ma(9);Wb.controlId=G;Wb.bindingId=ja;Wb.currentSheetName=pb;return $i.i(Ia,"DdaClearBindingFormats",Wb,D,N,fa,vb,0)},vb,574)};Q.prototype.ddaSetBindingFormats=function(G,ja,Wa,vb,f,D){var N=this;this.tK(function(fa,Ia,pb){var Wb=N.$.na.ta,Nc=N.rka();fa=ci.b(fa,f);Ia=ci.a(Ia,N.KI);var kd=Wb.Ma(9);kd.controlId=G;kd.bindingId=ja;kd.currentSheetName=Nc;kd.bindingData=Wa;kd.isSetFormats=
vb;return $i.i(Wb,"DdaSetBindingFormats",kd,fa,Ia,pb,D,0)},D,575)};Q.prototype.parseRange=function(G,ja,Wa){var vb=this;this.tK(function(f,D,N){var fa=vb.$.na.ta.fc();return $i.Q(vb.$.na.ta,G,-1,ci.b(f,ja),ci.a(D,vb.KI),N,Wa,fa)},Wa,162,16)};Q.prototype.parseRangeForGoto=function(G,ja,Wa,vb){var f=this;this.tK(function(D,N,fa){var Ia=f.$.na.ta.fc();return $i.R(f.$.na.ta,G,ja,ci.b(D,Wa),ci.a(N,f.KI),fa,vb,Ia)},vb,562,16)};Q.prototype.executeRichApiRequest=function(G,ja,Wa){var vb=this;Df.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&
(G.RequestFlags&=8191);if(Df.EwaSettings.ma(259))this.DDh(this.$.na.ta.fc(),ja,function(){vb.uR.WKa(Kf.a.internalError,Wa)},Wa,G);else{var f=wi.DdaFacade.Zid(G);!Df.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")||!this.$.yb.Tz||f&16?(Df.EwaSettings.uc()&&(f|=64),this.$.userOperationManager.ju(new O(this.$,G,function(D,N,fa){return I(vb.$.na.ta,G,ci.b(D,ja),ci.a(N,vb.KI),fa,Wa)},f))):(this.uR.WKa(Kf.a.BFc,Wa),df.ULS.sendTraceTag(537163160,0,50,"Write operation is not allowed"))}};
Q.prototype.rka=function(){return this.$.ea.isNamedObjectViewMode?this.$.oa.sheetName:this.$.activeItemName};Q.prototype.tK=function(G,ja,Wa,vb){vb=void 0===vb?0:vb;!Df.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")||!this.$.yb.Tz||vb&16?Df.EwaSettings.uc()?this.$.userOperationManager.ju(new ch.a(Wa,0,G,vb|64)):this.$.userOperationManager.ju(new bj.a(Wa,0,G,vb)):(this.uR.WKa(Kf.a.BFc,ja),df.ULS.sendTraceTag(537163159,0,50,"Write operation is not allowed"))};
Q.prototype.DDh=function(G,ja,Wa,vb,f){var D=wi.DdaFacade.Zid(f);if(!Df.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")||!this.$.yb.Tz||D&16){var N=this.$.Sb.Hc("UserAction","Rich Api request");Df.EwaSettings.uc()&&(D|=64);this.$.userOperationManager.jc(new ea(this.$,G,ja,Wa,vb,N,f,D),null)}else this.uR.WKa(Kf.a.BFc,vb),df.ULS.sendTraceTag(537163158,0,50,"Write operation is not allowed")};Object(Yd.a)(Q,"DdaWebServiceHelper",null,[]);Object(Yd.a)(U,"DocumentFile",
null,[]);H.generalException="GeneralException";H.ENg="ApiNotFound";H.FFd="OperationCancelled";H.invalidArgument="InvalidArgument";Object(Yd.a)(H,"ErrorCodes",null,[]);C.prototype.replaceShortcuts=function(){return Promise.reject("ReplaceShortcuts method is not overridden")};C.prototype.getShortcuts=function(){return Promise.reject("GetShortcuts method is not overridden")};C.prototype.checkShortcutsInUse=function(){return Promise.reject("CheckShortcutsInUse method is not overridden")};Object(Yd.a)(C,
"WacApiDelegates",null,[]);var pl=b(710);Am(E,C);E.prototype.replaceShortcuts=function(G){return OfficeExt.ShortcutKeyDispatchManager.replaceShortcuts(this.addinId,G,this.hlf)};E.prototype.getShortcuts=function(){return OfficeExt.ShortcutKeyDispatchManager.getShortcuts(this.addinId)};E.prototype.checkShortcutsInUse=function(G){return OfficeExt.ShortcutKeyDispatchManager.checkShortcutsInUse(G,this.hlf)};E.zah=function(G,ja){var Wa=document.createEvent("KeyboardEvent");if(hg.a.aG)Wa.initKeyboardEvent("keydown",
!1,!1,window.self,"A",0,!!(G&8),!!(G&32),!!(G&4),!!(G&256));else{var vb=[];G&4&&vb.push("Shift");G&8&&vb.push("Control");G&32&&vb.push("Alt");Wa.initKeyboardEvent("keydown",!1,!1,window.self,"A",0,vb,!1,"en-US")}G=new Sys.UI.DomEvent(Wa);G.keyCode=ja;return G};E.d7g=function(G,ja){if(hg.a.Hf)switch(ja){case 189:ja=173;break;case 187:ja=61;break;case 186:ja=59}return E.zah(G,ja)};Object(Yd.a)(E,"ExcelWacApiDelegates",C,[]);t.prototype.UEg=function(G,ja){this.vfc(G)||(this.EJa[G]={});if(this.cmi(G))return df.ULS.sendTraceTag(537163157,
344,50,"App {0} has reach the limit of number of cached files.",G),Kf.a.LEi;this.EJa[G][ja.uFh.toString()]=ja;return Kf.a.success};t.prototype.pTh=function(G,ja){var Wa=null;this.vfc(G)&&(Wa=this.EJa[G][ja.toString()]);Wa||df.ULS.sendTraceTag(537163156,344,15,"File cache for [agave:{0}, fileHandler:{1}] doesn't exist",G,ja);return Wa};t.prototype.vfc=function(G){return G in this.EJa};t.prototype.$dj=function(G,ja){if(this.vfc(G)){var Wa=this.EJa[G];delete Wa[ja.toString()];1>Object.keys(Wa).length&&
delete this.EJa[G];return ja.toString()in Wa?Kf.a.internalError:Kf.a.success}return Kf.a.internalError};t.prototype.cmi=function(G){return this.vfc(G)?Object.keys(this.EJa[G]).length>=this.fEi:!1};t.getInstance=function(G){return G.da.Aa(200)||G.da.Ha(200,new t(t.gEi))};t.rIi=function(){return++t.uXg};t.MDi=4194304;t.gEi=1;t.uXg=0;Object(Yd.a)(t,"GetFileApiHelper",null,[]);A.prototype.notifyActionHandlerReady=function(){OfficeExt.ShortcutKeyDispatchManager.sendQueuedActions(this.RA)};A.prototype.getTypeName=
function(){return"Microsoft.InternalService.AddinInternalService"};A.prototype.invokePropertyGet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};A.prototype.invokePropertyGetAsync=function(G){G=this.invokePropertyGet(G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};A.prototype.invokePropertySet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};A.prototype.invokePropertySetAsync=function(G,ja){this.invokePropertySet(G,
ja);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};A.prototype.invokeMethod=function(G){switch(G){case 1:return this.aJi()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};A.prototype.invokeMethodAsync=function(G,ja){G=this.invokeMethod(G,ja);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};A.prototype.aJi=function(){this.notifyActionHandlerReady();return null};Object(Yd.a)(A,"AddinInternalService",null,[]);v.prototype.getAppRuntimeState=
function(){return this.EJ.getAppRuntimeState(this.RA)?2:1};v.prototype.setAppRuntimeState=function(G){switch(G){case 2:G=!0;break;case 1:G=!1;break;default:throw OfficeExtension.WacRuntime.Utility.createRichApiException(Xa.a.invalidArgument,Ce.a.fa(1719));}this.EJ.setAppRuntimeState(this.RA,G)};v.prototype.getTypeName=function(){return"Microsoft.AppRuntime.AppRuntimeService"};v.prototype.invokePropertyGet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};v.prototype.invokePropertyGetAsync=
function(G){G=this.invokePropertyGet(G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};v.prototype.invokePropertySet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};v.prototype.invokePropertySetAsync=function(G,ja){this.invokePropertySet(G,ja);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};v.prototype.invokeMethod=function(G,ja){switch(G){case 2:return this.BOh();case 1:return this.Ztj(ja)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);
};v.prototype.invokeMethodAsync=function(G,ja){G=this.invokeMethod(G,ja);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};v.prototype.BOh=function(){return this.getAppRuntimeState()};v.prototype.Ztj=function(G){G=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"int");this.setAppRuntimeState(G);return null};Object(Yd.a)(v,"AppRuntimeService",null,[]);var ql=b(1189);y.prototype.disable=function(){try{if(!Ce.a.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled"))return this.TGe();
if(!this.Hkf())return this.UGe();this.w2.uUj(this.it)}catch(G){return df.ULS.sendTraceTag(538572829,0,15,"BeforeDocumentCloseNotification.Disable() Failed. reason: {0}",G.message||"Unknown"),this.RGe()}return null};y.prototype.enable=function(){try{if(!Ce.a.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled"))return this.TGe();if(!this.Hkf())return this.UGe();this.w2.bcj(this.it)}catch(G){return df.ULS.sendTraceTag(538572828,0,15,"BeforeDocumentCloseNotification.Enable() Failed. reason: {0}",
G.message||"Unknown"),this.RGe()}return null};y.prototype._OnAccess=function(){};y.prototype.getTypeName=function(){return"Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification"};y.prototype.invokePropertyGet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};y.prototype.invokePropertyGetAsync=function(G){G=this.invokePropertyGet(G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};y.prototype.invokePropertySet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);
};y.prototype.invokePropertySetAsync=function(G,ja){this.invokePropertySet(G,ja);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};y.prototype.invokeMethod=function(G){switch(G){case 1:return this.tDa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};y.prototype.invokeMethodAsync=function(G,ja){switch(G){case 3:return this.Hjh();case 2:return this.Zoh()}G=this.invokeMethod(G,ja);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};y.prototype.Hjh=
function(){return this.disable()};y.prototype.Zoh=function(){return this.enable()};y.prototype.tDa=function(){this._OnAccess();return null};y.prototype.TGe=function(){return ql.a(Xa.a.notImplemented,Ce.a.fa(1720))};y.prototype.UGe=function(){return ql.a(Xa.a.sharedRuntimeNotAvailable,Ce.a.fa(1724))};y.prototype.RGe=function(){return ql.a(Xa.a.generalException,Ce.a.fa(1715))};y.prototype.Hkf=function(){var G=this.ez.getSharedRuntimeId();return!!G&&0<G.length};Object(Yd.a)(y,"BeforeDocumentCloseNotification",
null,[]);B.prototype.getTypeName=function(){return"Microsoft.ExcelServices.CustomFunctionEngineStatus"};B.prototype.invokePropertyGet=function(G){switch(G){case 1:return this.enabled;case 3:return this.nativeRuntime;case 2:return this.streamingEnabled}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};B.prototype.invokePropertyGetAsync=function(G){G=this.invokePropertyGet(G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};B.prototype.invokePropertySet=function(G,
ja){switch(G){case 1:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ja,0,"boolean");return;case 3:this.nativeRuntime=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ja,0,"boolean");return;case 2:this.streamingEnabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ja,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};B.prototype.invokePropertySetAsync=function(G,ja){this.invokePropertySet(G,ja);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};
B.prototype.invokeMethod=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};B.prototype.invokeMethodAsync=function(G,ja){G=this.invokeMethod(G,ja);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};uk.Object.defineProperties(B.prototype,{enabled:{configurable:!0,enumerable:!0,get:function(){return this.GA},set:function(G){this.GA=G}},nativeRuntime:{configurable:!0,enumerable:!0,get:function(){return this.rfe},set:function(G){this.rfe=G}},streamingEnabled:{configurable:!0,
enumerable:!0,get:function(){return this.sle},set:function(G){this.sle=G}}});Object(Yd.a)(B,"CustomFunctionEngineStatus",null,[]);r.prototype.register=function(G){return OfficeExtension.WacRuntime.Utility.createPromise(this.Ayg(G))};r.prototype.getTypeName=function(){return"Microsoft.ExcelServices.CustomFunctionManager"};r.prototype.invokePropertyGet=function(G){switch(G){case 2:return this.status}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};r.prototype.invokePropertyGetAsync=
function(G){G=this.invokePropertyGet(G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};r.prototype.invokePropertySet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};r.prototype.invokePropertySetAsync=function(G,ja){this.invokePropertySet(G,ja);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};r.prototype.invokeMethod=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};r.prototype.invokeMethodAsync=
function(G,ja){switch(G){case 1:return this.Ucj(ja)}G=this.invokeMethod(G,ja);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};r.prototype.Ucj=function(G){var ja=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"string");G=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,1,"string");return this.register(ja,G)};uk.Object.defineProperties(r.prototype,{status:{configurable:!0,enumerable:!0,get:function(){var G=new B;G.enabled=this.Bug;G.streamingEnabled=this.Cug;
G.nativeRuntime=!1;return G}}});Object(Yd.a)(r,"CustomFunctionManager",null,[]);var vl=b(1152);w.prototype._RegisterStateChange=function(){var G=this;this.XTb||this.XP.execute(function(ja){G.g6d=ja.NAa(G._id,function(Wa){G.EJ.BHh(G.RA,G._id,JSON.stringify(Wa))})});this.XTb++;return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};w.prototype._UnregisterStateChange=function(){var G=this;this.XTb--;this.XTb||this.XP.execute(function(ja){ja.ILd(G._id,G.g6d)});return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};
w.prototype.getTypeName=function(){return"Microsoft.Office.Licensing.LicenseFeature"};w.prototype.invokePropertyGet=function(G){switch(G){case 5:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};w.prototype.invokePropertyGetAsync=function(G){G=this.invokePropertyGet(G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};w.prototype.invokePropertySet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};w.prototype.invokePropertySetAsync=
function(G,ja){this.invokePropertySet(G,ja);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};w.prototype.invokeMethod=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};w.prototype.invokeMethodAsync=function(G,ja){switch(G){case 6:return this.eog();case 7:return this.gog()}G=this.invokeMethod(G,ja);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};w.prototype.eog=function(){return this._RegisterStateChange()};w.prototype.gog=
function(){return this._UnregisterStateChange()};uk.Object.defineProperties(w.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this._id}}});Object(Yd.a)(w,"LicenseFeature",null,[]);u.prototype.getFeatureTier=function(G,ja){var Wa=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(vb){var f=1===ja?1:2===ja?2:0;Wa.XP.execute(function(D){D.getFeatureTier(G,f).then(function(N){vb(Wa.BXh(N))},function(){vb(ja)})})})};u.prototype.getLicenseFeature=function(G){G=new w(this.XP,
G,this.RA,this.EJ);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};u.prototype.isFeatureEnabled=function(G,ja){var Wa=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(vb){Wa.XP.execute(function(f){f.isFeatureEnabled(G,ja).then(function(D){vb(D)},function(){vb(ja)})})})};u.prototype.isFreemiumUpsellEnabled=function(){var G=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(ja){G.XP.execute(function(Wa){Wa=Wa.isFreemiumUpsellEnabled();ja(Wa)})})};
u.prototype.launchUpsellExperience=function(G){var ja=this;if(this.pxg.isFirstParty())return OfficeExtension.WacRuntime.Utility.createPromise(function(){ja.XP.execute(function(Wa){Wa.launchUpsellExperience(G)})});throw OfficeExtension.WacRuntime.Utility.createRichApiException(Xa.a.UVc,"");};u.prototype._TestFireStateChangedEvent=function(){};u.prototype.getTypeName=function(){return"Microsoft.Office.Licensing.License"};u.prototype.invokePropertyGet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);
};u.prototype.invokePropertyGetAsync=function(G){G=this.invokePropertyGet(G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};u.prototype.invokePropertySet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};u.prototype.invokePropertySetAsync=function(G,ja){this.invokePropertySet(G,ja);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};u.prototype.invokeMethod=function(G,ja){switch(G){case 6:return this.fog(ja)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);
};u.prototype.invokeMethodAsync=function(G,ja){switch(G){case 2:return this.kUh(ja);case 5:return this.AXh(ja);case 1:return this.Smi(ja);case 3:return this.yni();case 4:return this.Fwi(ja)}G=this.invokeMethod(G,ja);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};u.prototype.kUh=function(G){var ja=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"string");G=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,1,"int");return this.getFeatureTier(ja,G)};u.prototype.AXh=
function(G){G=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"string");return this.getLicenseFeature(G)};u.prototype.Smi=function(G){var ja=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"string");G=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,1,"boolean");return this.isFeatureEnabled(ja,G)};u.prototype.yni=function(){return this.isFreemiumUpsellEnabled()};u.prototype.Fwi=function(G){G=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"string");
return this.launchUpsellExperience(G)};u.prototype.fog=function(G){G=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"string");this._TestFireStateChangedEvent(G);return null};u.prototype.BXh=function(G){switch(G){case 1:return 1;case 2:return 2;default:return 0}};Object(Yd.a)(u,"License",null,[]);var wl=b(157);n.prototype.areShortcutsInUse=function(G){var ja=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(Wa,vb){ja.Myd.checkShortcutsInUse(G).then(function(f){Wa(f)}).catch(function(f){vb(f)})})};
n.prototype.getShortcuts=function(){var G=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(ja,Wa){G.Myd.getShortcuts().then(function(vb){ja(vb)}).catch(function(vb){Wa(vb)})})};n.prototype.replaceShortcuts=function(G){var ja=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(Wa,vb){ja.Myd.replaceShortcuts(G).then(function(){Wa(null)}).catch(function(f){vb(f)})})};n.prototype.getTypeName=function(){return"Microsoft.Office.ActionService"};n.prototype.invokePropertyGet=
function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};n.prototype.invokePropertyGetAsync=function(G){G=this.invokePropertyGet(G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};n.prototype.invokePropertySet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};n.prototype.invokePropertySetAsync=function(G,ja){this.invokePropertySet(G,ja);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};n.prototype.invokeMethod=
function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};n.prototype.invokeMethodAsync=function(G,ja){switch(G){case 3:return this.nPg(ja);case 1:return this.A2h();case 2:return this.Ejj(ja)}G=this.invokeMethod(G,ja);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};n.prototype.nPg=function(G){G=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"Array<string>");return this.areShortcutsInUse(G)};n.prototype.A2h=function(){return this.getShortcuts()};
n.prototype.Ejj=function(G){G=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"any");return this.replaceShortcuts(G)};Object(Yd.a)(n,"ActionService",null,[]);var sl=b(565);m.prototype.o2h=function(){this.ysa||(this.ysa=sl.a.lr(Ji.a.instance.qc("Common.App.SharedFilePicker.ISharedFilePicker")));return this.ysa};m.prototype.getSharedFilePickerResponse=function(G){var ja=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(Wa,vb){try{var f=ja.o2h();Zj.Task.WAA.call(null,
f).continueWith(function(){var D=f.result;if(D){var N={};(function(){var fa=fi.d(G);N=fa.ev;return fa})().returnValue?D.xhd(N).then(function(fa){fa&&0<fa.length?Wa(fa):vb(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The picker returned null or an empty array."))}).catch(function(fa){vb(fa)}):vb(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The dialog customazation json string can not be deserialized."))}else vb(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException",
"The picker is resolved as null."))})}catch(D){vb(D)}})};m.prototype.getTypeName=function(){return"Microsoft.Office.SharedFilePicker"};m.prototype.invokePropertyGet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};m.prototype.invokePropertyGetAsync=function(G){G=this.invokePropertyGet(G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};m.prototype.invokePropertySet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);
};m.prototype.invokePropertySetAsync=function(G,ja){this.invokePropertySet(G,ja);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};m.prototype.invokeMethod=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};m.prototype.invokeMethodAsync=function(G,ja){switch(G){case 1:return this.n2h(ja)}G=this.invokeMethod(G,ja);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};m.prototype.n2h=function(G){G=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,
0,"string");return this.getSharedFilePickerResponse(G)};Object(Yd.a)(m,"SharedFilePicker",null,[]);l.prototype.createInstance=function(G,ja){switch(G){case "Microsoft.Office.ActionService":return new n(ja);case "Microsoft.Office.SharedFilePicker":return new m}return null};Object(Yd.a)(l,"WacApiHost",null,[]);e.prototype.hostName=function(){return"ExcelOnline"};e.prototype.appId=function(){return this.dSb};e.prototype.createInstance=function(G){switch(G){case "Microsoft.Authentication.AuthenticationService":return Ji.a.instance.resolve("Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory").create(this.RA,
this.EJ.Ni);case "Microsoft.Authentication.TokenParameters":return new xa;case "Microsoft.ExcelServices.CustomFunctionManager":G=this.wb.ma(122);var ja=this.wb.ma(123);return new r(G,ja,h(this.dSb,this.wb,this.EJ));case "Microsoft.AppRuntime.AppRuntimeService":return new v(this.RA,this.EJ);case "Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification":return G=Nj.a(this.wb),new y(this.dSb,this.RA,G,this.EJ);case "Microsoft.DynamicRibbon.DynamicRibbon":return G=Nj.a(this.wb),new vl.DynamicRibbon(this.dSb,
this.RA,this.EJ,G,G.nn(this.RA).rl);case "Microsoft.Office.Licensing.License":return new u(this.RA,this.EJ);case "Microsoft.InternalService.AddinInternalService":return new A(this.RA);default:if(this.zVc||(this.zVc=new l),ja=this.zVc.createInstance(G,this.FCg))return ja}df.ULS.sendTraceTag(537163155,0,10,"Typename: {0} is an invalid parameter for the RichApiHost.CreateInstance method.",G);throw OfficeExtension.WacRuntime.Utility.createRichApiException(Xa.a.generalException,Xa.a.generalException);
};Object(Yd.a)(e,"RichApiHost",null,[]);var Wk=b(406),nl=b(116),kl=b(34),fl=b(98),rl=b(293),tl=b(42),Xk=b(256),Yk=b(6),ol=b(65),ul=b(202);c.prototype.dispose=function(){this.$=this.gac=null};c.prototype.$c=function(){return!1};c.prototype.nd=function(){return!1};c.prototype.executeCommand=function(G,ja,Wa){G=ja.command;switch(G){case 451041795:this.De.Bf(Wa[rj.a.Gg],Wa[rj.a.t4]);break;case 974713501:this.M8h(Wa[rj.a.Gg],Wa[rj.a.t4]);break;case 1237877382:this.De.mv(Wa[rj.a.t4]);break;default:return Kk.a(G)}return Zj.Task.Sa(!0)};
c.prototype.Mc=function(G,ja,Wa){if(G=!!Wa)switch(ja.command){case 974713501:case 1237877382:case 451041795:break;default:G=!1}return G};c.prototype.M8h=function(G,ja){var Wa,vb=G.DdaMethod;if("undefined"===typeof vb.DispatchId)this.De.Bf(Kf.a.internalError,ja);else if(c.Wli(G)||this.$.Dd&1){if(vb.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromPromptMethod?(new aa(this.$,this,G,ja)).start(this.Le,G.DdaMethod.ControlId):vb.DispatchId===OSF.DDA.MethodDispId.dispidGetSelectedDataMethod?this.O1h(G,
ja):vb.DispatchId===OSF.DDA.MethodDispId.dispidSetSelectedDataMethod?this.oyj(G,ja):vb.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromSelectionMethod?this.addBinding(G,this.Xgd(G.DdaMethod.ControlId),0,ja):vb.DispatchId===OSF.DDA.MethodDispId.dispidGetBindingDataMethod?this.ePh(G,ja):vb.DispatchId===OSF.DDA.MethodDispId.dispidSetBindingDataMethod?this.iuj(G,ja):vb.DispatchId===OSF.DDA.MethodDispId.dispidGetBindingMethod?this.dPh(G,ja):vb.DispatchId===OSF.DDA.MethodDispId.dispidReleaseBindingMethod?
this.Zdj(G,ja):vb.DispatchId===OSF.DDA.MethodDispId.dispidGetAllBindingsMethod?this.fOh(G,ja):vb.DispatchId===OSF.DDA.MethodDispId.dispidLoadSettingsMethod?this.Pwd(G,ja):vb.DispatchId===OSF.DDA.MethodDispId.dispidSaveSettingsMethod?this.saveSettings(G,ja):vb.DispatchId===OSF.DDA.MethodDispId.dispidAddRowsMethod?(G.DdaAddRowsColumns.IsRow=!0,this.dqe(G,ja)):vb.DispatchId===OSF.DDA.MethodDispId.dispidAddColumnsMethod?(G.DdaAddRowsColumns.IsRow=!1,this.dqe(G,ja)):vb.DispatchId===OSF.DDA.MethodDispId.dispidClearAllRowsMethod?
this.nhh(G,ja):vb.DispatchId===OSF.DDA.MethodDispId.dispidClearFormatsMethod?this.d1g(G,ja):vb.DispatchId===OSF.DDA.MethodDispId.dispidSetFormatsMethod?(G.DdaSetBindingFormats.IsSetFormats=!0,this.B1f(G,ja)):vb.DispatchId===OSF.DDA.MethodDispId.dispidSetTableOptionsMethod?(G.DdaSetBindingFormats.IsSetFormats=!1,this.B1f(G,ja)):vb.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromNamedItemMethod?this.addBinding(G,G.DdaBindingsMethod.ItemName,G.DdaBindingsMethod.FailOnCollision?2:1,ja):vb.DispatchId===
OSF.DDA.MethodDispId.dispidGetFilePropertiesMethod?this.oUh(ja):vb.DispatchId===OSF.DDA.MethodDispId.dispidNavigateToMethod?this.wAd(G,ja):vb.DispatchId===OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod?this.executeRichApiRequest(G,ja):vb.DispatchId===OSF.DDA.MethodDispId.dispidGetDocumentCopyMethod?this.mTh(G,ja):vb.DispatchId===OSF.DDA.MethodDispId.dispidGetDocumentCopyChunkMethod?this.nTh(G,ja):vb.DispatchId===OSF.DDA.MethodDispId.dispidReleaseDocumentCopyMethod?this.aej(G,ja):vb.DispatchId===
OSF.DDA.MethodDispId.dispidAppCommandInvocationCompletedMethod?(OfficeExt.AddinCommandsRuntimeManager.invocationCompleted(G.DdaMethod.ControlId,G),this.De.mv(ja)):vb.DispatchId===OSF.DDA.MethodDispId.dispidMessageParentMethod?Df.EwaSettings.ma(24)?this.De.Bf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,ja):this.sFi(G,ja):vb.DispatchId===OSF.DDA.MethodDispId.dispidSendMessageMethod?Df.EwaSettings.ma(24)?this.De.Bf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,ja):this.oFi(G,
ja):vb.DispatchId===OSF.DDA.MethodDispId.dispidGetAccessTokenMethod?this.getAccessToken(G,ja):vb.DispatchId===OSF.DDA.MethodDispId.dispidGetAuthContextMethod?this.getAuthContext(G,ja):this.De.Bf(Kf.a.IFd,ja),Df.EwaSettings.isChangeGateEnabled("OfficeVSO:5649666_AddLogForExcelOnlineCommonAPIUsage")&&vb.DispatchId!==OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod){G=this.Le.j_(G.DdaMethod.ControlId);ja="";if(G){ja=wi.DdaFacade.getSolutionId(G,this.$);var f=G.PrimaryMarketplace.MarketplaceType;
f===OSF.StoreType.InMemory?G.OwnerAddinSolutionId&&G.AssetMarketplace&&(f=G.AssetMarketplace.MarketplaceType):f===OSF.StoreType.WopiCatalog&&(f=OSF.StoreType.OMEX);ja=Telemetry.PrivacyRules.GetPrivacyCompliantId(ja,f,null===(Wa=G.AssetMarketplace)||void 0===Wa?void 0:Wa.SolutionId,null,null,G.PrimaryMarketplace.MarketplaceRef)}df.ULS.sendTraceTag(537163224,344,50,"DDA method Id: {0}, AppID: {1}",vb.DispatchId,ja)}}else this.De.Bf(Kf.a.WMe,ja)};c.prototype.ePh=function(G,ja){var Wa=this;G.DdaGetBindingData.CoerceType=
c.C4b(G.DdaGetBindingData.CoerceType);G.DdaGetBindingData.FilterType=c.cXe(G.DdaGetBindingData.FilterType);G.DdaGetBindingData.ValueFormat=c.xjg(G.DdaGetBindingData.ValueFormat);if(this.Akc(G.DdaGetBindingData.CoerceType,ja)){if(G.DdaGetBindingData){var vb=G.DdaGetBindingData;0===vb.FilterType&&(vb.FilterType=2);vb.StartCol|=0;vb.StartRow|=0;vb.ColCount=void 0===vb.ColCount?-1:vb.ColCount;vb.RowCount=void 0===vb.RowCount?-1:vb.RowCount}this.sA.ddaGetBindingData(G.DdaMethod.ControlId,G.DdaGetBindingData.BindingId,
G.DdaGetBindingData.CoerceType,G.DdaGetBindingData.ValueFormat,G.DdaGetBindingData.FilterType,G.DdaGetBindingData.StartRow,G.DdaGetBindingData.StartCol,G.DdaGetBindingData.RowCount,G.DdaGetBindingData.ColCount,function(f){if(aj.a(f)||!f.Result)Wa.De.OH(f,ja);else{var D=Wa.De.bR();D.Data=c.pye(f.Result);ja(D)}},ja)}};c.prototype.iuj=function(G,ja){var Wa=this;G.DdaSetBindingData.CoerceType=c.C4b(G.DdaSetBindingData.CoerceType);if(this.Akc(G.DdaSetBindingData.CoerceType,ja)){var vb=c.v0c(G.DdaSetBindingData.CoerceType,
G.DdaSetBindingData.Data);c.Fhc(vb)?this.De.Bf(Kf.a.tDc,ja):(1===vb.CoerceType&&(vb.CellFormat||(vb.CellFormat=G.DdaSetBindingData.CellFormat),vb.TableOptions||(vb.TableOptions=G.DdaSetBindingData.TableOptions)),G.DdaSetBindingData&&(G.DdaSetBindingData.StartCol|=0,G.DdaSetBindingData.StartRow|=0),this.sA.ddaSetBindingData(G.DdaMethod.ControlId,G.DdaSetBindingData.BindingId,G.DdaSetBindingData.StartRow,G.DdaSetBindingData.StartCol,vb,function(f){aj.a(f)?Wa.De.OH(f,ja):Wa.De.mv(ja)},ja))}};c.prototype.O1h=
function(G,ja){var Wa=this;G.DdaGetBindingData.CoerceType=c.C4b(G.DdaGetBindingData.CoerceType);G.DdaGetBindingData.ValueFormat=c.xjg(G.DdaGetBindingData.ValueFormat);G.DdaGetBindingData.FilterType=c.cXe(G.DdaGetBindingData.FilterType);if(this.Akc(G.DdaGetBindingData.CoerceType,ja)){var vb=this.Xgd(G.DdaMethod.ControlId);vb?this.sA.ddaGetSelectedData(G.DdaMethod.ControlId,G.DdaGetBindingData.CoerceType,G.DdaGetBindingData.ValueFormat,G.DdaGetBindingData.FilterType,vb,function(f){if(aj.a(f))Wa.De.OH(f,
ja);else{var D=Wa.De.bR();D.Data=c.pye(f.Result);ja(D)}},ja):this.De.Bf(Kf.a.C6e,ja)}};c.prototype.mTh=function(G,ja){var Wa=this;if(hg.a.fsd)this.De.Bf(Kf.a.wTg,ja);else{var vb=G[OSF.DDA.Marshaling.File.ParameterKeys.FileType.toString()],f=G[OSF.DDA.Marshaling.File.ParameterKeys.SliceSize.toString()],D=G.DdaMethod.ControlId,N=t.getInstance(this.$);if(0>=f)df.ULS.sendTraceTag(537163221,344,15,"Invalid slice size. It should be greater than 0."),this.De.Bf(Kf.a.Mii,ja);else if(f>t.MDi)df.ULS.sendTraceTag(537163220,
344,15,"Invalid slice size. It should be not greater than 4MB."),this.De.Bf(Kf.a.F1e,ja);else{var fa=null;switch(vb){case 1:fa="Compressed";break;case 0:fa="Text";break;case 2:fa="Pdf";break;default:df.ULS.sendTraceTag(537163219,344,15,"Requested file type {0} is not supported.",vb);this.De.Bf(Kf.a.RWe,ja);return}if("Text"===fa)df.ULS.sendTraceTag(537163218,344,15,"Requested file type {0} is not supported.",fa),this.De.Bf(Kf.a.RWe,ja);else{Df.EwaSettings.isChangeGateEnabled("OfficeVSO:4182305_AddWholeWorkbookPrintOptionToGetFileAPI")?
(G=new Sys.StringBuilder,G.append(Ci.a(this.$,fa)),"Pdf"===fa&&wj.a.ag(G,lj.a.jJd,"WholeWorkbook"),G=G.toString()):G=Ci.a(this.$,fa);var Ia=null,pb=new XMLHttpRequest;pb.onreadystatechange=function(){if(4===pb.readyState)if(200===pb.status){var Wb=pb.response;if(Wb){Ia=new Uint8Array(Wb);Wb=Wa.De.bR();for(var Nc=Ia.length,kd=t.rIi(),Xc={},Ie=0,Ze=0;Ze<Nc;Ze+=f){for(var Sf=[],ag=Ze+f<Nc?Ze+f:Nc,og=0,Vg=Ze;Vg<ag;og++,Vg++)Sf[og]=Ia[Vg];Xc[(Ie++).toString()]=Sf}Xc=new U(kd,Nc,f,Xc);Xc=N.UEg(D,Xc);Xc!==
Kf.a.success?Wa.De.Bf(Xc,ja):(Wb[OSF.DDA.Marshaling.File.FilePropertiesKeys.Handle.toString()]=kd,Wb[OSF.DDA.Marshaling.File.FilePropertiesKeys.FileSize.toString()]=Nc,df.ULS.sendTraceTag(537163216,344,50,"GetFileAsync get file successfully for file type {0}, the file size is {1}",fa,Nc),ja(Wb))}else df.ULS.sendTraceTag(537163217,344,15,"Request is successful, but respone have no data for file type {0}.",fa),Wa.De.Bf(Kf.a.internalError,ja)}else 500===pb.status?Wa.De.Bf(Kf.a.wZe(parseInt(pb.statusText,
10)),ja):(df.ULS.sendTraceTag(537163215,344,15,"Request failed to obtain the file for type {0}.",fa),Wa.De.Bf(Kf.a.ZHi,ja))};pb.open("GET",G,!0);pb.responseType="arraybuffer";pb.setRequestHeader("If-Modified-Since","0");pb.send(null)}}}};c.prototype.nTh=function(G,ja){var Wa=G[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()],vb=G[OSF.DDA.Marshaling.File.ParameterKeys.SliceIndex.toString()];G=G.DdaMethod.ControlId;(Wa=t.getInstance(this.$).pTh(G,Wa))?(Wa=Wa.$Hj,0>vb||vb>=Object.keys(Wa).length?
this.De.Bf(Kf.a.tdi,ja):(vb=Wa[vb.toString()],Wa=this.De.bR(),Wa[OSF.DDA.Marshaling.File.SlicePropertiesKeys.Data.toString()]=vb,Wa[OSF.DDA.Marshaling.File.SlicePropertiesKeys.SliceSize.toString()]=vb.length,ja(Wa))):this.De.Bf(Kf.a.internalError,ja)};c.prototype.aej=function(G,ja){var Wa=G[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()];G=G.DdaMethod.ControlId;Wa=t.getInstance(this.$).$dj(G,Wa);Wa===Kf.a.success?this.De.mv(ja):this.De.Bf(Wa,ja)};c.prototype.oyj=function(G,ja){var Wa=this;
G.DdaSetBindingData.CoerceType=c.C4b(G.DdaSetBindingData.CoerceType);if(this.Akc(G.DdaSetBindingData.CoerceType,ja)){var vb=this.Xgd(G.DdaMethod.ControlId);if(vb){var f=c.v0c(G.DdaSetBindingData.CoerceType,G.DdaSetBindingData.Data),D=gj.g(this.$).ga;1===f.CoerceType&&(!f.Data&&D.va.X_&&(f.Headers||(f.Headers=[]),f.Headers.length||Array.add(f.Headers,[]),f.Headers[0].length||Array.add(f.Headers[0],"")),c.Fhc(f)||(f.CellFormat||(f.CellFormat=G.DdaSetBindingData.CellFormat),f.TableOptions||(f.TableOptions=
G.DdaSetBindingData.TableOptions)));if(c.Fhc(f))this.De.Bf(Kf.a.tDc,ja);else{var N=D.va.xd.clone(),fa=D.va.activeCell.clone();this.sA.ddaSetSelectedData(G.DdaMethod.ControlId,vb,f,function(Ia){var pb;if(aj.a(Ia))Wa.De.OH(Ia,ja);else{Ia=N.clone();var Wb=f.Headers?f.Headers[0].length:f.Data[0].length;1!==f.CoerceType||f.Data?1===f.CoerceType&&(null===(pb=f.TableOptions)||void 0===pb?0:pb.length)&&0==f.TableOptions[0]?(Ia.top+=1,Ia.bottom=Ia.top+f.Data.length-1):Ia.bottom=Ia.top+f.Data.length-(1===f.CoerceType?
0:1):Ia.bottom=Ia.top+1;Ia.right=Ia.left+Wb-1;pb=Ia.contains(fa)?fa:Ia.topLeft;D.updateSelection(Ia,pb,0);Wa.De.mv(ja)}},ja)}}else this.De.Bf(Kf.a.HAe,ja)}};c.prototype.addBinding=function(G,ja,Wa,vb){var f=this;ja?this.sA.ddaAddBinding(G.DdaMethod.ControlId,G.DdaBindingsMethod.BindingId,G.DdaBindingsMethod.BindingType,ja,Wa,function(D){if(aj.a(D))f.De.OH(D,vb);else{var N=f.De.bR();N.Bindings=Array(1);N.Bindings[0]=f.Le.m2b(D.Result);vb(N)}},vb):this.De.Bf(Kf.a.Drj,vb)};c.prototype.dPh=function(G,
ja){var Wa=this;this.sA.ddaGetBinding(G.DdaMethod.ControlId,G.DdaBindingsMethod.BindingId,function(vb){if(aj.a(vb)||!vb.Result)Wa.De.OH(vb,ja);else{var f=Wa.De.bR();f.Bindings=Array(1);f.Bindings[0]=Wa.Le.m2b(vb.Result);ja(f)}},ja)};c.prototype.oUh=function(G){var ja=this.De.bR(),Wa={};Wa[OSF.DDA.Marshaling.FilePropertiesKeys.Url.toString()]=this.$.workbookContext.ClientUrl;ja[OSF.DDA.Marshaling.FilePropertiesKeys.Properties.toString()]=Wa;G(ja)};c.prototype.Zdj=function(G,ja){var Wa=this;this.sA.ddaReleaseBinding(G.DdaMethod.ControlId,
G.DdaBindingsMethod.BindingId,function(vb){aj.a(vb)?Wa.De.OH(vb,ja):Wa.De.mv(ja)},ja)};c.prototype.fOh=function(G,ja){var Wa=this;this.sA.ddaGetAllBindings(G.DdaMethod.ControlId,function(vb){if(aj.a(vb))Wa.De.OH(vb,ja);else{var f=Wa.De.bR();if(vb.Result){vb=vb.Result;f.Bindings=Array(vb.length);for(var D=0;D<vb.length;D++)f.Bindings[D]=Wa.Le.m2b(vb[D])}else f.Bindings=null;ja(f)}},ja)};c.prototype.Pwd=function(G,ja){var Wa=this;this.sA.ddaLoadSettings(G.DdaMethod.ControlId,function(vb){if(aj.a(vb))Wa.De.OH(vb,
ja);else{var f=Wa.De.bR();f.Properties=vb.Result;ja(f)}},ja)};c.prototype.saveSettings=function(G,ja){for(var Wa=this,vb={Settings:[]},f=0;f<G.DdaSettingsMethod.Properties.length;f++){var D={};D.Name=G.DdaSettingsMethod.Properties[f][0];D.Value=G.DdaSettingsMethod.Properties[f][1];vb.Settings[f]=D}this.sA.ddaSaveSettings(G.DdaMethod.ControlId,vb,G.DdaSettingsMethod.OverwriteIfStale,function(N){aj.a(N)?Wa.De.OH(N,ja):Wa.De.mv(ja)},ja)};c.prototype.dqe=function(G,ja){var Wa=this,vb=c.v0c(1,G.DdaAddRowsColumns.Data);
c.Fhc(vb)?this.De.Bf(Kf.a.tDc,ja):this.sA.ddaAddRowsColumns(G.DdaMethod.ControlId,G.DdaAddRowsColumns.BindingId,G.DdaAddRowsColumns.IsRow,vb,function(f){aj.a(f)?Wa.De.OH(f,ja):Wa.De.mv(ja)},ja)};c.prototype.nhh=function(G,ja){var Wa=this;this.sA.ddaDeleteAllDataValues(G.DdaMethod.ControlId,G.DdaBindingsMethod.BindingId,function(vb){aj.a(vb)?Wa.De.OH(vb,ja):Wa.De.mv(ja)},ja)};c.prototype.d1g=function(G,ja){var Wa=this;this.sA.ddaClearBindingFormats(G.DdaMethod.ControlId,G.DdaClearBindingFormats.BindingId,
function(vb){aj.a(vb)?Wa.De.OH(vb,ja):Wa.De.mv(ja)},ja)};c.prototype.B1f=function(G,ja){var Wa=this,vb={},f=G.DdaSetBindingFormats.IsSetFormats;f?vb.CellFormat=G.DdaSetBindingFormats.CellFormat:vb.TableOptions=G.DdaSetBindingFormats.TableOptions;this.sA.ddaSetBindingFormats(G.DdaMethod.ControlId,G.DdaSetBindingFormats.BindingId,vb,f,function(D){aj.a(D)?Wa.De.OH(D,ja):Wa.De.mv(ja)},ja)};c.prototype.executeRichApiRequest=function(G,ja){var Wa=this,vb,f=G.ArrayData,D={},N=gj.g(this.$).ga;if(f){if("WacPartition"===
f[0]){this.lDh(G,ja);return}var fa=Object(Ii.a)(wi.DdaFacade,Nj.a(this.$));if("SetOsfControlContainerReadyForCustomFunctions"===f[0]){var Ia=fa.nn(G.DdaMethod.ControlId);Ia&&(Ia.Lsd=!0,Ia.JNf())}D.HttpMethod=f[1];D.PathAndQuery=f[2];D.RequestHeaders=c.c3e(f[3]);D.RequestBody=f[4];D.AppPermission=f[5];Ia=f[6];D.RequestFlags=Ia;var pb=0;if(oj.i(this.$.oa))switch(N.Ye){case 1:pb=2;break;case 2:pb=3;break;case 128:pb=4;break;default:pb=1}var Wb=null;N.Pa.VC&&(Wb=N.Pa.VC.pj);D.SheetMultiRange=Ij.r(N.va.selectedRanges,
this.$);D.ActiveCell=Ij.v(N.va.activeCell,this.$);D.ActiveChartId=Wb;D.SelectionState=pb;pb=this.Le.j_(G.DdaMethod.ControlId);D.InstanceId=pb?pb.InstanceId:"";if(pb&&pb.PrimaryMarketplace){Wb=wi.DdaFacade.getSolutionId(pb,this.$);var Nc=pb.PrimaryMarketplace.MarketplaceType;if(Nc===OSF.StoreType.InMemory){if(!pb.OwnerAddinSolutionId){this.De.Bf(Kf.a.Wzb,ja);return}if(pb.AssetMarketplace)Nc=pb.AssetMarketplace.MarketplaceType;else{this.De.Bf(Kf.a.Wzb,ja);return}}else Nc===OSF.StoreType.WopiCatalog&&
(Nc=OSF.StoreType.OMEX);var kd=Telemetry.PrivacyRules.GetPrivacyCompliantId(Wb,Nc,null===(vb=pb.AssetMarketplace)||void 0===vb?void 0:vb.SolutionId,null,null,pb.PrimaryMarketplace.MarketplaceRef);D.CompliantSolutionId=kd;D.SolutionId=Wb;D.MarketplaceType=Nc;D.SolutionVersion=pb.PrimaryMarketplace.SolutionVersion;D.StoreLocation=pb.PrimaryMarketplace.MarketplaceRef}else D.SolutionId=D.MarketplaceType="",D.CompliantSolutionId="";D.IsEventsEnabled=void 0===fa||null===fa||fa.oj.w1b(D.InstanceId);D.RequestGuid=
Qj.a.create().toString();vb=D.RequestBody.length;if(Df.EwaSettings.isChangeGateEnabled("OfficeVSO:4444309_RichApiPayloadSizeLimit")&&vb>this.$.ya.ExcelRichApiMaxAllowedRequestPayloadSize){this.De.Bf(Kf.a.$kj,ja);df.ULS.sendTraceTag(537163213,0,50,"Request payload size:{0} exceeded the limit",vb);return}Df.EwaSettings.isChangeGateEnabled("OfficeVSO:5079365_RichApiPreviewExecution")&&Ia&4096&&(vb=new ia(this.$),OfficeExtension.WacRuntime.RichApi.previewExecute(vb,ba,f),D.RequestBody=f[4])}var Xc=c.i6e(D.RequestHeaders);
c.BGd++;var Ie=ih.a.Ra.Ob;Df.EwaSettings.isChangeGateEnabled("OfficeVSO:4316383_RichApiLogRequestBodySize")&&D&&D.RequestBody&&df.ULS.sendTraceTag(537163212,0,50,String.format("Richapi json request body size is {0}",D.RequestBody.length));this.sA.executeRichApiRequest(D,function(Ze){var Sf;Wa.L0f(Ie,!0,Ze.ServerCorrelationId);var ag=null,og=null,Vg=Ze.ServerCorrelationId;if(null===(Sf=null===Ze||void 0===Ze?void 0:Ze.Errors)||void 0===Sf?0:Sf[0])ag=Ze.Errors[0].MessageIdName,og=Ze.Errors[0].Description,
Df.EwaSettings.isChangeGateEnabled("OfficeVSO:4513856_NotShowApiExceptionOnUI")&&ol.a(Wa.$).ud.ME(Ze.Errors[0].MessageId);if(aj.a(Ze)||!Ze.Result)Wa.YOa(Vg,Xc,"Server error",ag,og),Wa.De.OH(Ze,ja);else{var Hh=null;if(Df.EwaSettings.ma(259))if((Sf=Ze.Result)&&Sf.length){for(var ji=0;ji<Sf.length;ji++)if(Sf[ji].RequestGuid===D.RequestGuid){Hh=Sf[ji];break}Hh||Wa.De.OH(Ze,ja)}else Hh=Ze.Result;else Hh=Ze.Result;if(!ag&&Hh&&Hh.ResponseBody&&Hh.ResponseBody[0])if(Ze=Hh.ResponseBody[0],Ze.startsWith('{"Error":')){1<
Hh.ResponseBody.length&&(Ze=Ze.substring(0,Ze.indexOf("}")+1),Ze+="}");try{var kj=jh.a.ui(Ze);kj.Error&&Wa.YOa(Vg,Xc,"Pipeline error",kj.Error.Code,kj.Error.Message)}catch(Hk){Wa.YOa(Vg,Xc,"Json deserialize error",null,"Error info cannot be deserialized.")}}else Wa.YOa(Vg,Xc);else Wa.YOa(Vg,Xc,"Server error",ag,og);var Ej=(kj=Hh.SheetMultiRange)?kj.SheetName:null;Ze=Hh.ActiveChartId;var Rh=Hh.SelectionState;ag=5===Rh&&!!kj||6===Rh||7===Rh||8===Rh;if(Df.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")&&
Wa.$.yb.Tz&&ag)Wa.De.Bf(Kf.a.BFc,ja),df.ULS.sendTraceTag(537163211,0,50,String.format("{0} is not allowed",Rh.toString()));else if(5===Rh&&kj){if(Wa.$.xa&&Ej)if(Wa.$.xa.Gj(Ej))Wa.qWc(Ej);else{var Zk=null;Zk=function(){Wa.$.xa.Gj(Ej)&&(df.ULS.sendTraceTag(537163210,0,50,"Sheets item add event handler called"),Wa.qWc(Ej),Wa.$.xa.Ecb(Zk))};Wa.$.xa.g_a(Zk);if(Df.EwaSettings.isChangeGateEnabled("OfficeVSO:3973943_RichApiFixSheetActivateOnNewWorkbookEnabled")){var ll=null;ll=function(){Wa.$.xa.Gj(Ej)&&
(Wa.qWc(Ej),Wa.$.xa.Xna(ll))};Wa.$.xa.Oha(ll)}}}else if(6===Rh||7===Rh||8===Rh||9===Rh){if(kj){var gl=Ij.g(kj.Ranges);if(Ej&&Ij.cb(gl,!0))if(Df.EwaSettings.isChangeGateEnabled("OfficeVSO:4211161_RichApiUpdateSelectionWithoutExistsWorksheet")&&!Wa.$.xa.Gj(Ej)){var $k=null;$k=function(){Wa.$hg(N,gl,Ej,Rh);Wa.$.xa.Xna($k)};Wa.$.xa.Oha($k)}else Wa.$hg(N,gl,Ej,Rh)}7===Rh?(Ze="38.{"+ul.c(Ze)+"}",Jk.a(Wa.$).soa(0,Ze,!0)):8===Rh&&Jk.a(Wa.$).soa(2,Ze,!0);9===Rh&&(Wa.$.ya.ApiCallToSetPageLayout=!0)}Hh.PostProcessActions?
Wa.$.Zjf?(Vg=jh.a.ui(Hh.PostProcessActions),Wa.C4i(Vg).then(function(){Wa.Idb(Hh,ja);Wa.Tdd(G.DdaMethod.ControlId,D);return Promise.resolve(null)},function(Hk){Wa.Idb(Hh,ja,Hk);return Promise.reject(Hk)})):(Wa.YOa(Vg,Xc,"Promise not supported",null,"Promise is not supported on this browser."),Wa.De.Bf(Kf.a.internalError,ja)):Wa.Idb(Hh,ja)}},function(Ze){Wa.L0f(Ie,!1,null);Wa.YOa(null,Xc,"Web service error");ja(Ze)})};c.prototype.Tdd=function(G,ja){var Wa=Object(Ii.a)(wi.DdaFacade,Nj.a(this.$));(null===
Wa||void 0===Wa?0:Wa.cPd)&&Wa.nn(G)&&c.hCj(ja.RequestHeaders)&&(df.ULS.sendTraceTag(537163209,0,50,"ExecuteRichApiRequest(PostProcess): fire a RecordingStateChanged event to ControlId: {0}; SolutionId: {1}.",G,ja.SolutionId),Wa.cPd.gqh(G))};c.prototype.lDh=function(G,ja){var Wa=this,vb=this.Le.j_(G.DdaMethod.ControlId),f=wi.DdaFacade.getSolutionId(vb,this.$),D=null;D=wi.DdaFacade.gwa(vb,this.$);D=new E(D,this.$);D=new e(f,G.DdaMethod.ControlId,this.Le,this.$,D);var N={ResponseHeaders:[]};N.ResponseBody=
Array(1);vb=c.c3e(G.ArrayData[3]);var fa=c.i6e(vb);vb=new ka(this.$.ya.CreateWorkbookMaxAllowedBase64Size,this.Nvf);OfficeExtension.WacRuntime.RichApi.executeRichApiRequest(D,da,vb,G.ArrayData).then(function(Ia){if(!Ia)return Wa.Exd(!1,"The rich api executor call failed",fa),df.ULS.sendTraceTag(537163208,0,10,"The rich api executor call failed"),N.ResponseStatusCode=500,Wa.Idb(N,ja),null;Wa.Exd(!0,"The rich api executor call succeeded",fa);N.ResponseStatusCode=Ia[0];N.ResponseBody[0]=Ia[2];Wa.Idb(N,
ja);return null},function(Ia){N.ResponseStatusCode=400;N.ResponseBody[0]=Ia.toString();Wa.Exd(!1,"The rich api executor call failed",fa);df.ULS.sendTraceTag(537163207,0,10,"A Excel Rich API batch execution was failed, AppId:{0}",f);Wa.Idb(N,ja);return null})};c.prototype.L0f=function(G,ja,Wa){c.BGd--;G=nl.a(ih.a.Ra,G);df.ULS.sendTraceTag(36763356,0,50,"Rich Api perf log -- total milliseconds used:{0}, requests pending:{1}, request result:{2}, server correlationid: {3}.",G,c.BGd,ja?"success":"false",
Wa)};c.prototype.Idb=function(G,ja,Wa){Wa=void 0===Wa?null:Wa;var vb=Array(3);vb[0]=G.ResponseStatusCode;vb[1]=c.f3h(G.ResponseHeaders);var f=[],D=!1;if(Wa&&G.ResponseBody){var N=jh.a.ui(G.ResponseBody.join(""));N.Error||(D={},D.Error=Wa,D.TraceIds=N.TraceIds,D.ProcessedResults={},D.ProcessedResults.Results=N.Results,f[0]=jh.a.Kc(D),D=!0)}vb[2]=D?f:G.ResponseBody;G=this.De.bR();G.Data=vb;ja(G)};c.prototype.wAd=function(G,ja){(new P(this.$,this.De,this.sA)).wAd(G,ja)};c.prototype.sFi=function(G,ja){df.ULS.sendTraceTag(537163206,
0,50,"MessageParent API called!");var Wa=G[OSF.DDA.Marshaling.MessageParentKeys.MessageToParent],vb=G[wg.a.oYc],f=G[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin];G=this.$.da.Aa(232).M2a.tFi(G.DdaMethod.ControlId,Wa,vb,f);G===Kf.a.success?this.De.mv(ja):(df.ULS.sendTraceTag(537163205,0,10,"MessageParent API Failed!"),this.De.Bf(G,ja))};c.prototype.oFi=function(G,ja){df.ULS.sendTraceTag(537163204,0,50,"MessageChild API called!");var Wa=G[OSF.DDA.Marshaling.SendMessageKeys.MessageContent],vb=G[wg.a.oYc],
f=G[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin];this.$.da.Aa(232).M2a.Csj(G.DdaMethod.ControlId,Wa,vb,f);this.De.mv(ja)};c.prototype.getAccessToken=function(G,ja){function Wa(D,N){var fa;if(D===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)D=vb.De.bR(),D[OSF.DDA.Marshaling.SingleSignOn.AccessTokenResultKeys.AccessToken]=N.accessToken,ja(D);else{N=vb.Le.j_(G.DdaMethod.ControlId);var Ia=null!==N.OwnerAddinSolutionId?N.OwnerAddinSolutionId:N.PrimaryMarketplace.MarketplaceType,pb={};df.ULS.sendTraceTag(537163202,
0,10,"{0}.",(pb.errorCode=D.toString(),pb.appId=Telemetry.PrivacyRules.GetPrivacyCompliantId(wi.DdaFacade.getSolutionId(N,vb.$),Ia,null===(fa=N.AssetMarketplace)||void 0===fa?void 0:fa.SolutionId,null,null,N.PrimaryMarketplace.MarketplaceRef),pb.storeType=Ia,pb));vb.De.Bf(D,ja)}}var vb=this;df.ULS.sendTraceTag(537163203,0,50,"GetAccessToken API called!");var f=!Df.EwaSettings.ma(24);Th.TaskExtensions.Ba(cj.GetServiceTaskFactory.create(this.$.da,137,this.$.la,1),function(D){var N=vb.Le.Ni,fa=qa.getInstance();
tc.AppsForOfficeSingleSignOnManager.getInstance(N,D.result,fa).getAccessToken(G.DdaMethod.ControlId,f,G,Wa)},this.$.la)};c.prototype.getAuthContext=function(G,ja){var Wa=this;Th.TaskExtensions.Ba(cj.GetServiceTaskFactory.create(this.$.da,137,this.$.la,1),function(){var vb=Wa.Le.Ni.getOsfControl(G.DdaMethod.ControlId);if(!Df.EwaSettings.getBooleanFeatureGate("Microsoft.Office.OEP.Block3PGetAuthContext",!0)||vb.isFirstParty()){vb=vb.getManifest();var f=vb.getMarketplaceID(),D=vb.getWebApplicationId(),
N=vb.getWebApplicationMsaId();Ji.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAuthContext(f).then(function(fa){var Ia=Wa.De.bR(),pb={};pb[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=D;pb[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=N||D;pb[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=fa.upn;pb[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=fa.userId;pb[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=fa.authority;
pb[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=Vd.OOh(fa.authorityType);pb[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=fa.isAnonymous;pb[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=fa.tenantId;pb[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=fa.supportsAuthToken;Ia[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=pb;ja(Ia)},function(fa){var Ia=Wa.De.bR(),pb={},Wb=new Vd;pb[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=
D;pb[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=N||D;pb[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=Wb.upn;pb[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=Wb.userId;pb[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=Wb.authority;pb[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=Wb.authorityType;pb[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=Wb.isAnonymous;pb[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=
Wb.tenantId;pb[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Error]=fa;pb[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=Wb.supportsAuthToken;Ia[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=pb;Ia.Error=1;ja(Ia)})}},this.$.la)};c.prototype.Mli=function(G){var ja=gj.g(this.$).ga;return 16===ja.Ye&&!!ja.Pa.nc&&!!ja.Pa.nc.floatingObject&&Xj.a.equals(ja.Pa.nc.floatingObject.id,G,!0)};c.prototype.Xgd=function(G){var ja=gj.g(this.$).ga;return ja.va.Wg?1===
ja.Ye||this.Mli(G)?ja.kja:null:null};c.prototype.Akc=function(G,ja){return 1!==G&&2!==G&&3!==G?(this.De.Bf(Kf.a.VDe,ja),!1):!0};c.prototype.Exd=function(G,ja,Wa){var vb={};vb.a=this.$.ya.UserSessionId;vb.b=G;vb.c=ja;vb.d=null;vb.e=Wa;zk.b().Te(37,vb)};c.prototype.YOa=function(G,ja,Wa,vb,f){Wa=void 0===Wa?null:Wa;vb=void 0===vb?null:vb;f=void 0===f?null:f;var D={};G&&(D.ServerCorrelationId=G);void 0!==ja&&null!==ja&&(D.Source=ja);Wa&&(D.ErrorType=Wa);vb&&(D.MessageId=vb);f&&(D.StatusDescription=f);
Df.EwaSettings.isChangeGateEnabled("OfficeVSO:6144055_EUIIDataInDbxheTag")&&vb&&"ExternalDataRefreshFailed"===vb&&(D.StatusDescription="");df.ULS.sendTraceTag(50688452,0,50,jh.a.Kc(D))};c.prototype.C4i=function(G){for(var ja=new Promise(function(vb){vb(null)}),Wa=0;Wa<G.length;Wa++)ja=this.B4i(ja,G[Wa]);return ja};c.prototype.B4i=function(G,ja){var Wa=this;if(!ja)return df.ULS.sendTraceTag(537163201,0,10,"Null PostProcessAction."),G.then(function(){return Promise.reject(c.F4a(H.generalException,Ff.a.instance.fa(1715),
null))});switch(ja.actionType){case 1:case 2:G=G.then(function(){var vb=Object(Ii.a)(wi.DdaFacade,Nj.a(Wa.$));if(vb.nn(ja.controlId))switch(vb.oj.c8h(ja),ja.messageType){case 14:case 100:vb.bPd.U1b(ja);break;case 11:case 12:vb.Mnj.kqb(ja);break;case 51:case 52:vb.Knj.kqb(ja);break;case 2101:case 2102:vb.Lnj.kqb(ja);break;case 2E3:vb.Nnj.U1b(ja);break;case 2201:Wa.$.Nla&&vb.cPd.jQg(ja);break;case 2203:vb.Onj.kQg(ja);break;case 2700:Df.EwaSettings.isChangeGateEnabled("OfficeVSO:4251858_RangePicker")&&
vb.aPd.U1b(ja)}else df.ULS.sendTraceTag(537163171,0,10,"OsfControl with instanceId[{0}] doesn't exist.",ja.controlId);return Promise.resolve(null)});break;case 3:G=G.then(function(){Wa.R7h(ja);return Promise.resolve(null)});break;case 15:Df.EwaSettings.isChangeGateEnabled("OfficeVSO:4251858_RangePicker")&&(G=G.then(function(){Wa.o9h(ja);return Promise.resolve(null)}));break;case 4:G=G.then(function(){if(Df.EwaSettings.ma(105)){var vb=gj.g(Wa.$).ga.va.activeCell;vb.top!==ja.row+1&&vb.left!==ja.column+
1&&(vb=Ij.v(Dh.Range.kd(ja.row+1,ja.column+1),Wa.$),gj.g(Wa.$).Kg(vb,null,null,null,3,Gk.a.Xfh));ck.a(Wa.$,243,242,0,function(f){f.Seb(ja.row+1,ja.column+1,1,!1,!1)})}return Promise.resolve(null)});break;case 7:G=G.then(function(){Object(Ii.a)(wi.DdaFacade,Nj.a(Wa.$)).oj.QOe(ja.controlId,ja.isEnableEvents);return Promise.resolve(null)});break;case 5:G=G.then(function(){return Wa.ueh(ja)});break;case 6:G=G.then(function(){return Wa.N_i(ja)});break;case 8:G=G.then(function(){Df.EwaSettings.isChangeGateEnabled("OfficeVSO:5333368_ClearBeforeCloseRegistrationsInWorkbookCloseApi")&&
Object(Ii.a)(wi.DdaFacade,Nj.a(Wa.$)).c1g();var vb=new Xk.a(Yk.a.Mk,5,null);tl.a(Wa.$).Jt(vb);return Promise.resolve(null)});break;case 9:G=G.then(function(){return Wa.luj(ja)});break;case 10:G=G.then(function(){return Wa.i2j(ja)});break;case 11:G=G.then(function(){return Wa.h2j()});break;case 12:G=G.then(function(){return Wa.e2j()});break;case 13:G=G.then(function(){return Wa.f2j(ja)});break;case 14:G=G.then(function(){return Wa.g2j(ja)});break;case 16:G=G.then(function(){return Promise.resolve(ja)});
break;case 17:G=G.then(function(){return Wa.Cqj(ja,Object(Ii.a)(wi.DdaFacade,Nj.a(Wa.$)))});break;case 18:gj.g(this.$).focus();break;case 19:this.x9e(ja.entryType,!1,ja.options);break;case 20:this.x9e(ja.entryType,!0,ja.options);break;default:G=G.then(function(){return Promise.reject(c.F4a(H.ENg,Ff.a.instance.fa(1716),null))})}return G};c.prototype.o9h=function(G){var ja=Object(Ii.a)(wi.DdaFacade,Nj.a(this.$)).nn(G.controlId);if(ja&&!(0===G.operationType^!ja.pea)){gj.g(this.$).Qjc=!0;switch(G.operationType){case 0:var Wa=
new rl.a(document.createElement("input"));Wa.text=G.range;ja.wgi(gj.g(this.$).Lg.Pch(Wa,new Wk.a(this.$)));ja.pea.startEdit(!0);break;case 1:ja.FTf();this.rangePicker=null;break;case 2:ja.pea.pig(G.range);break;case 3:ja.pea.pig(G.startingRange);ja=G.expandSelection;Wa=G.getNextDataRegionCell;var vb=0;switch(G.keyboardDirectionValue){case 2:vb=38;G=ja&&Wa?105288353:ja?-31900117:Wa?542791952:137938150;break;case 3:vb=40;G=ja&&Wa?-1297307319:ja?-1603798598:Wa?1713663844:-798660877;break;case 0:vb=37;
G=ja&&Wa?-403586027:ja?2039316657:Wa?-2012742350:-1470715894;break;case 1:vb=39;G=ja&&Wa?784916030:ja?589730764:Wa?1324884057:-1231471547;break;default:G=1461300262}ja=this.s6b("keydown",vb,ja,Wa);gj.g(this.$).oKb(ja,new Qc.a(G,1,0,8,null))}gj.g(this.$).Qjc=!1}};c.prototype.s6b=function(G,ja,Wa,vb){var f=document.createEvent("KeyboardEvent");if(hg.a.aG)f.initKeyboardEvent(G,!1,!1,window.self,"A",0,vb,!1,Wa,!1);else{var D="";Wa&&(D+="Shift");vb&&(D+=0<D.length?" Control":"Control");f.initKeyboardEvent(G,
!1,!1,window.self,"A",0,D,!1,"en-US")}G=new Sys.UI.DomEvent(f);G.keyCode=ja;return G};c.prototype.R7h=function(G){switch(G.operationType){case 1:Th.TaskExtensions.Ba(cj.GetServiceTaskFactory.create(this.$.da,153,this.$.la,1),function(ja){ja.result.YNd()},this.$.la,3);break;case 2:if(G=Object(Ii.a)(wi.DdaFacade,Nj.a(this.$)).nn(G.controlId))G.Lsd=!0,G.JNf()}};c.prototype.ueh=function(G){var ja=this,Wa=G.fileBase64;return Wa&&Wa.length>this.$.ya.CreateWorkbookMaxAllowedBase64Size?Promise.reject(c.F4a(H.invalidArgument,
Ff.a.instance.fa(1719),"Application.CreateWorkbook")):(new Promise(function(vb,f){var D=new ue.StandardDialog;D.lc=4;D.Fk(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_NewFileAPIConsentMessage,1,function(N){2!==N&&0!==N||f(c.F4a(H.FFd,Ff.a.instance.fa(1718),"Application.CreateWorkbook"));N=new ha("blank","agave",Wa?"streamBase64":"streamEmpty",Wa);ja.Nvf.create(vb,f,N).a2a()})})).then(function(vb){ja.gac.set(G.fakeFileId,vb);return Promise.resolve(null)},function(vb){return vb?
Promise.reject(vb):Promise.reject(c.F4a(H.generalException,Ff.a.instance.fa(1715),"Application.CreateWorkbook"))})};c.prototype.N_i=function(G){var ja=this;return new Promise(function(Wa,vb){if(ja.gac.has(G.fakeFileId)){var f=ja.gac.get(G.fakeFileId);vb=new ue.StandardDialog;vb.lc=4;vb.Fk(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_OpenWindowConsentMessage,1,function(D){1===D&&ze.HelperMethods.wf(f,void 0,void 0,"DdaMethodHandler.fileUrl");Wa(null)})}else vb(c.F4a(H.generalException,
Ff.a.instance.fa(1715),"Document.Open"))})};c.prototype.luj=function(G){var ja=this;return new Promise(function(Wa){Object(Ii.a)(wi.DdaFacade,Nj.a(ja.$)).pYf=G.runtimeCalculationMode;var vb=ja.$.da.Aa(268);vb&&vb.wBd(3===G.runtimeCalculationMode);Wa(null)})};c.prototype.i2j=function(G){Qh.a.cCb(this.$)&&this.$.da.Aa(331).Jdb(0,G.urlStr,!0,!0,null);return Promise.resolve(null)};c.prototype.h2j=function(){Qh.a.cCb(this.$)&&this.$.da.Aa(331).Jdb(1,null,!0,!0,null);return Promise.resolve(null)};c.prototype.e2j=
function(){Qh.a.cCb(this.$)&&this.$.da.Aa(331).NOe();return Promise.resolve(null)};c.prototype.f2j=function(G){Qh.a.cCb(this.$)&&this.$.da.Aa(331).Jdb(5,G.urlStr,!0,!0,null);return Promise.resolve(null)};c.prototype.g2j=function(G){if(Qh.a.cCb(this.$)){var ja=this.$.da.Aa(331);ja=Cl(ja.dba);for(var Wa=ja.next();!Wa.done;Wa=ja.next())Wa=Wa.value,Wa.IsActive&&Wa.HostEditUrl&&Wa.UrlStr===G.hostEditUrlStr&&ze.HelperMethods.wf(Wa.HostEditUrl,"_blank")}return Promise.resolve(null)};c.prototype.Cqj=function(G,
ja){var Wa=Wg.a.OX;G=jh.a.ui(G.payload);var vb={};"eventId"in G&&"payload"in G&&(vb.eventId=G.eventId,vb.payload=G.payload);ja.zN(2201,Wa,jh.a.Kc(vb));return Promise.resolve(null)};c.prototype.x9e=function(G,ja,Wa){var vb=this.$.da.Aa(5);vb&&(G=this.HPh(G))&&(ja?vb.removeEntry(G):vb.Qpe(G,Wa))};c.prototype.HPh=function(G){switch(G){case 0:return 63}};c.prototype.qWc=function(G){G=Object(Ii.a)(fl.a,this.$.xa.getItemByName(G));(null===G||void 0===G?0:G.visible)&&G.activate(!0)};c.prototype.$hg=function(G,
ja,Wa,vb){var f=G.va.CB,D=f<ja.length&&ja[f].contains(G.va.activeCell);G=D?G.va.activeCell:ja[0].topLeft;f=D?f:0;gj.g(this.$).kW(ja,f,Wa,null,G,null,null,3,Gk.a.Yfh,void 0,void 0,void 0,6===vb)};c.c3e=function(G){if(!G||!G.length)return null;for(var ja=Array(G.length/2),Wa=0;Wa<G.length/2;Wa++)ja[Wa]={},ja[Wa].Name=G[2*Wa],ja[Wa].Value=G[2*Wa+1];return ja};c.f3h=function(G){if(!G||!G.length)return null;for(var ja=Array(2*G.length),Wa=0;Wa<G.length;Wa++)ja[2*Wa]=G[Wa].Name,ja[2*Wa+1]=G[Wa].Value;return ja};
c.eed=function(G){if(!G||!G.length)return null;for(var ja=Array(G.length),Wa=0,vb=G.length;Wa<vb;Wa++){var f=G[Wa].length;if(f){ja[Wa]=Array(f);for(var D=0;D<f;D++)ja[Wa][D]=null==G[Wa][D]?null:G[Wa][D].toString()}else return null}return ja};c.C4b=function(G){return"string"===typeof G?kl.a.fo(c.Tfh,G,0):G};c.cXe=function(G){return"string"===typeof G?kl.a.fo(c.Wfh,G,0):G};c.xjg=function(G){return"string"===typeof G?kl.a.fo(c.$fh,G,0):G};c.Wli=function(G){switch(G.DdaMethod.DispatchId){case 68:case 74:case 70:case 77:case 80:case 64:case 75:case 81:return!0}return!1};
c.v0c=function(G,ja){var Wa={};Wa.CoerceType=G;1===Wa.CoerceType?(Wa.Data=c.eed(ja.Rows),Wa.Headers=c.eed(ja.Headers)):Wa.Data=c.eed(ja);return Wa};c.pye=function(G){if(1===G.CoerceType){var ja={};return ja.Headers=G.Headers,ja.Rows=G.Data,ja}return G.Data};c.Fhc=function(G){return 1===G.CoerceType?!G.Data&&!G.Headers:!G.Data};c.i6e=function(G){var ja="Unknown";if(!G)return ja;for(var Wa=0;Wa<G.length;Wa++)if(G[Wa].Name.toLowerCase()===lj.a.Pnj){ja=G[Wa].Value;break}return ja};c.hCj=function(G){if(!G)return!1;
for(var ja=lj.a.KKi.toLowerCase(),Wa=0;Wa<G.length;Wa++)if(G[Wa].Name.toLowerCase()===ja)return!0;return!1};c.F4a=function(G,ja,Wa){var vb={};vb.Code=G;vb.Message=ja;vb.Location=Wa;vb.ActionIndex=0;return vb};uk.Object.defineProperties(c.prototype,{uR:{configurable:!0,enumerable:!0,get:function(){return this.De}}});uk.Object.defineProperties(c,{Tfh:{configurable:!0,enumerable:!0,get:function(){c.Pqa||(c.Pqa={},c.Pqa[Microsoft.Office.WebExtension.CoercionType.Table]=1,c.Pqa[Microsoft.Office.WebExtension.CoercionType.Text]=
2,c.Pqa[Microsoft.Office.WebExtension.CoercionType.Matrix]=3,c.Pqa[Microsoft.Office.WebExtension.CoercionType.Html]=4,c.Pqa[Microsoft.Office.WebExtension.CoercionType.Ooxml]=5);return c.Pqa}},Wfh:{configurable:!0,enumerable:!0,get:function(){c.njb||(c.njb={},c.njb[Microsoft.Office.WebExtension.FilterType.All]=1,c.njb[Microsoft.Office.WebExtension.FilterType.OnlyVisible]=2);return c.njb}},$fh:{configurable:!0,enumerable:!0,get:function(){c.ojb||(c.ojb={},c.ojb[Microsoft.Office.WebExtension.ValueFormat.Unformatted]=
2,c.ojb[Microsoft.Office.WebExtension.ValueFormat.Formatted]=1);return c.ojb}}});c.Pqa=null;c.njb=null;c.ojb=null;c.BGd=0;Object(Yd.a)(c,"DdaMethodHandler",null,[434,3]);var sk=zj.a;Am(a,sk);a.prototype.Qd=function(){var G=this,ja=cj.GetServiceTaskFactory.create(this.$.da,106,this.la,this.ub),Wa=cj.GetServiceTaskFactory.create(this.$.da,165,this.la,this.ub),vb=gc(this.la,this.ub);Th.TaskExtensions.Ba(Th.TaskExtensions.we([ja,Wa,vb],this.la),function(){var D=ja.result,N=Ji.a.instance.resolve("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory");
G.Jd([new c(G.$,D,N)])},this.la,3);var f=Ji.a.instance;Th.TaskExtensions.Ba(cj.GetServiceTaskFactory.create(this.$.da,137,this.$.la,this.ub),function(){f.register(Ua,"Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory").Ic().Nc(function(){return new Ua})},this.$.la)};a.ka=function(G){zj.a.je(82,new a(G))};Object(Yd.a)(a,"DdaCommandHandlerFactory",zj.a,[]);Type.registerNamespace("Microsoft.AppRuntime");Type.registerNamespace("Microsoft.InternalService");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Agave");
Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.WebExtension");Type.registerNamespace("_Ewa");kh.a.Ti("");kh.a.Ti(".ewa-wx-disabled-div{position:absolute;height:100%;width:100%}.ewa-wx-container-div{position:relative}.ewa-ptp-nov2-flex .ewa-wx-container-div{flex:1}");Type.registerNamespace("Common.App.AppsForOffice");window.Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper=ki.a;Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.WopiIdentity");
Kb.main();(function(){Jh.a.Ga(function(G){wf.ka(G)})})();Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.AppsForOfficeCommon");(function(){Jh.a.Ga(function(G){vf.ka(G);Jf.ka(G)})})();(function(){Jh.a.Ga(function(G){Xe.ka(G)})})();Type.registerNamespace("CommandUI.AddInCommands");(function(){Jh.a.Ga(function(G){Df.EwaSettings.ma(54)&&T.ka(G)})})();(function(){Jh.a.Ga(function(G){Df.EwaSettings.ma(122)&&Wc.ka(G)})})();Jh.a.Ga(Eb.ka);Jh.a.Ga(Nb.ka);Type.registerNamespace("Common.App.AppsForOfficeOauth");
Type.registerNamespace("Common.App.SmartLookup");(function(){Jh.a.Ga(function(G){lb.ka(G);gb.ka(G);Ma.ka(G)})})();Jh.a.Ga(a.ka)},1481:function(z,F,b){function a(){this.YGc=null;this.MLc=0;this.sNc=!1;this.$a=new l.a;this.vug=new e.a}function c(){this.NNe=this.displayName=this.Asb=this.Mo=this.QB=null;this.isUpgraded=!1}z=b(0);var e=b(199),l=b(96);c.prototype.Ikf=function(m,n){return this.QB.getStoreType().toLowerCase()===m.toLowerCase()&&this.QB.getSolutionId().toLowerCase()===n.toLowerCase()};Object(z.a)(c,
"AddinCommandsResourceItem",null,[]);b.d(F,"a",function(){return a});a.prototype.IHg=function(m){this.$a.addHandler("AddinCommandsLoadingMessageChanged",m)};a.prototype.Ffj=function(m){this.$a.removeHandler("AddinCommandsLoadingMessageChanged",m)};a.prototype.peb=function(m){m!==this.YGc&&(this.YGc=m,this.$a.raiseEvent("AddinCommandsLoadingMessageChanged"))};a.prototype.huj=function(){this.MLc++;this.o_a||this.peb(CommonUIStrings.l_LoadingAddInsTitle)};a.prototype.myc=function(){this.MLc--;this.Swd()&&
(this.sNc?this.o_a!==CommonUIStrings.l_ErrorLoadingAddInsTitle&&this.peb(CommonUIStrings.l_ErrorLoadingAddInsTitle):this.peb(null))};a.prototype.r2f=function(m){this.sNc=!0;this.peb((void 0===m?0:m)?CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg:CommonUIStrings.l_ErrorLoadingAddInsTitle)};a.prototype.pCe=function(){this.sNc=!1;this.Swd()?this.peb(null):this.peb(CommonUIStrings.l_LoadingAddInsTitle)};a.prototype.Swd=function(){return 0>=this.MLc};a.prototype.Uja=function(m,n,h){h=void 0===
h?0:h;for(var u=Cl(this.d7a),w=u.next();!w.done;w=u.next())if(w=w.value,w.Ikf(m,n)&&(!w.Mo||w.Mo.lNh===h))return w;return null};a.prototype.Jpe=function(m,n,h,u){var w=new c;w.QB=m;w.Mo=n;w.Asb=h;w.displayName=u;this.d7a.add(w)};a.prototype.PFg=function(m,n,h,u){var w=new c;w.QB=m;w.Mo=n;w.Asb=null;w.NNe=h;w.displayName=u;this.d7a.add(w)};a.prototype.hej=function(m,n){for(var h=0,u=Cl(this.d7a),w=u.next();!w.done;w=u.next())w=w.value,w.QB.getStoreType()===m&&w.QB.getSolutionId()===n?this.d7a.removeAt(h):
h++};a.getInstance=function(){a.Na||(a.Na=new a);return a.Na};uk.Object.defineProperties(a.prototype,{o_a:{configurable:!0,enumerable:!0,get:function(){return this.YGc}},d7a:{configurable:!0,enumerable:!0,get:function(){return this.vug}}});a.Na=null;Object(z.a)(a,"AddinCommandsResourceManager",null,[])},943:function(z,F,b){function a(){}b.d(F,"a",function(){return a});z=b(0);a.pDa="Alt";a.YVa="Command";a.rDa="Enabled";a.oGc="GroupId";a.id="Id";a.sDa="Image16by16";a.W3d="Image32by32";a.Z3d="Keytip";
a.Whb="LabelText";a.hqa="Size";a.i4d="TemplateAlias";a.Lfa="Title";a.f4d="Tab";a.uGc="Scaling";a.rGc="MaxSize";a.tGc="Scale";a.GROUP="Group";a.Shb="Groups";a.ZVa="Controls";a.h4d="Template";a.button="Button";a.n_="FlyoutAnchor";a.LARGE="Large";a.CRb="Medium";a.SMALL="Small";Object(z.a)(a,"DataNodeWrapper",null,[])},944:function(z,F,b){function a(){}b.d(F,"a",function(){return a});z=b(0);var c=b(34);a.wZe=function(e){return c.a.fo(a.qFi,e.toString(),a.internalError)};uk.Object.defineProperties(a,{qFi:{configurable:!0,
enumerable:!0,get:function(){var e={};return a.Pee||(a.Pee=(e["-2002156328"]=a.VDe,e["-1954750170"]=a.C6e,e["317650254"]=a.X2g,e["-1005263101"]=a.Fii,e["1353664579"]=a.Wrj,e["159671765"]=a.Gii,e["1446690022"]=a.F1e,e["1150069548"]=a.tDc,e["-1409306331"]=a.HAe,e["338507772"]=a.RJe,e["-457159301"]=a.H0i,e["-1037701970"]=a.ufh,e["-1893322318"]=a.Lii,e["965579896"]=a.wfh,e["93287890"]=a.vfh,e["358088857"]=a.Tuj,e["-1223650923"]=a.RJe,e["2007306190"]=a.PZg,e["1549955423"]=a.uxe,e["-1275974171"]=a.Kii,
e["382101082"]=a.Q_i,e["-898776235"]=a.iHi,e["335464256"]=a.YGi,e["1677378049"]=a.Jii,e["-261992848"]=a.mUj,e["-980820954"]=a.uxe,e["-931375837"]=a.P_i,e["929186550"]=a.Fnh,e["-982144310"]=a.C7i,e["-785741187"]=a.Dii,e["2125217573"]=a.Nii,e["299124955"]=a.Eii,e["1669853884"]=a.doj,e["-1515932330"]=a.Y2g,e["314621024"]=a.IJh,e["-300049690"]=a.TZg,e["14766835"]=a.Xzj,e["-1251992761"]=a.WMe,e["-2087635043"]=a.invalidOrTimedOutSession,e["2100961153"]=a.invalidOrTimedOutSession,e["-1218744139"]=a.invalidSheetName,
e["-1468309555"]=5006,e["-315732528"]=a.invalidOrTimedOutSession,e["611268539"]=a.invalidOrTimedOutSession,e["1531005923"]=5006,e["1593924569"]=5006,e["299476328"]=a.wGa,e["49173765"]=a.wGa,e["-907155566"]=a.wGa,e["-1201603824"]=a.wGa,e["1541165282"]=a.wGa,e["-1347753427"]=a.wGa,e["134912532"]=a.wGa,e["1780971550"]=a.responsePayloadSizeLimitExceeded,e))}}});a.success=0;a.VDe=1E3;a.C6e=1001;a.X2g=1002;a.Fii=1003;a.Wrj=1004;a.Gii=1005;a.F1e=1008;a.RWe=1009;a.invalidSheetName=1014;a.tDc=2E3;a.HAe=2001;
a.RJe=2002;a.H0i=2003;a.ufh=2004;a.Lii=2005;a.wfh=2007;a.vfh=2008;a.Tuj=2009;a.PZg=2014;a.Drj=3E3;a.uxe=3002;a.Kii=3004;a.Q_i=3005;a.iHi=3006;a.YGi=3007;a.Jii=3008;a.mUj=3009;a.P_i=3010;a.Xzj=4002;a.IFd=5E3;a.internalError=5001;a.WMe=5002;a.Wzb=5004;a.oVj=5007;a.tdi=5008;a.wTg=5009;a.invalidOrTimedOutSession=5012;a.BFc=5016;a.wGa=5102;a.$kj=5103;a.responsePayloadSizeLimitExceeded=5104;a.jZg=7001;a.N9f=7002;a.Fnh=8E3;a.C7i=8001;a.Dii=8010;a.Nii=8011;a.Eii=8012;a.doj=8020;a.Y2g=8021;a.IJh=8022;a.TZg=
8023;a.LEi=11E3;a.ZHi=11001;a.Mii=11002;a.Pee=null;Object(z.a)(a,"DdaErrorIds",null,[])},945:function(z,F,b){function a(){}b.d(F,"a",function(){return a});z=b(0);a.generalException="GeneralException";a.invalidArgument="InvalidArgument";a.notImplemented="NotImplemented";a.UVc="AccessDenied";a.notSupported="NotSupported";a.apiNotAvailable="ApiNotAvailable";a.notAllowed="NotAllowed";a.FFd="OperationCancelled";a.userNotSignedIn="UserNotSignedIn";a.userAborted="UserAborted";a.rVj="UnsupportedUserIdentity";
a.invalidResourceUrl="InvalidResourceUrl";a.invalidGrant="InvalidGrant";a.PLg="AddinIsAlreadyRequestingToken";a.Bmj="ResourceNotAllowed";a.clientError="ClientError";a.serverError="ServerError";a.P6g="ControlIdNotFound";a.pnj="RibbonApiNotAvailable";a.hostRestartNeeded="HostRestartNeeded";a.invalidRibbonDefinition="InvalidRibbonDefinition";a.sharedRuntimeNotAvailable="SharedRuntimeNotAvailable";Object(z.a)(a,"ErrorCodes",null,[])},947:function(z,F,b){function a(za,Mb){var hc=dc.call(this)||this;hc.ea=
null;hc.an=null;hc.ii=null;hc.Jf=[];hc.SJa=null;hc.wJe=!1;hc.JQb=!1;hc.initialized=!1;hc.disposed=!1;hc.aDa=null;hc.crc=[];hc.rJe=[];hc.GQa=[];hc.A2a=null;hc.MGd=new Cc.a(Hc.a.Uk());hc.w0b=new Nb.a(Hc.a.Uk());hc.jHb=[];hc.UKf=[];hc.J7b=350;hc.Tfa=null;hc.Aya=null;hc.EVc=!1;hc.aje=null;hc.Yie=null;hc.bje=null;hc.$ie=null;hc.dje=null;hc.czg=null;hc.Zie=null;hc.cje=null;hc.eje=null;hc.fje=null;hc.gje=null;hc.Tf=function(){hc.aDa=hc.ea.Pm.WebExtensions;for(var cc=hc.Jf.length-1;0<=cc;--cc){var Ec=hc.Jf[cc],
Lc;if(Lc=!hc.uHh(Ec.controlId))Lc=Ec,Lc=hb.EwaSettings.ma(122)?!Lc.cJa:!0;Lc&&(Ec.apc(),Array.removeAt(hc.Jf,cc))}if(hc.aDa)for(cc=0,Ec=hc.aDa.length;cc<Ec;cc++){Lc=hc.aDa[cc];var he=hc.nn(Lc.WebExtensionId);he&&he.gEd(Lc)}};hc.lna=function(cc){hc.raiseEvent("csc",cc.getID())};hc.HEf=function(cc,Ec,Lc){if(hb.EwaSettings.isChangeGateEnabled("OfficeVSO:4841553_AddinKeyboardShortcutsInTaskpane")&&Ec===OSF.AgaveHostAction.KeyboardShortcuts){var he=Object(nc.a)(Object,Lc);Ec={};Ec.keyCode=he.keyCode;Ec.type=
"keydown";Ec.ctrlKey=he.ctrlKey;Ec.shiftKey=he.shiftKey;Ec.altKey=he.altKey;Ec.metaKey=he.metaKey;cc=hc.nn(cc);he=cc.cia;Ec.srcElement=Object(Ha.a)(489,he)?he.bHa:Xb.g(hc.$).Kb;Ec=new Sys.UI.DomEvent(Ec);cc={focusedAddinId:a.gwa(cc.rl,hc.$)};he=new hd.a(1461300262,1,hc.$.jd,6,null);Xb.g(hc.$).oKb(Ec,he,cc)}else if(Ec===OSF.AgaveHostAction.Select)hc.u9e(!0);else if(Ec===OSF.AgaveHostAction.UnSelect)hc.u9e(!1);else if(Ec===OSF.AgaveHostAction.CancelDialog)hc.PK(-684355545,null);else if(Ec===OSF.AgaveHostAction.InsertAgave)cc=
{},Lc&&(cc[Ta.a.$sa]=Lc,cc[ma.a.Gg]=a.ftb(Lc),hc.PK(-741808261,cc));else if(Ec===OSF.AgaveHostAction.InsertDevManifest)cc={},Lc&&(cc[Ta.a.$sa]=Lc,cc[ma.a.Gg]=a.ftb(Lc),hc.PK(-741808261,cc));else if(Ec===OSF.AgaveHostAction.InsertDevManifestError)cc=Object(nc.a)(Object,Lc),Ec={},cc=(Ec[Ta.a.nYc]=hc.an.getDevManifestInvalidUrlErrorString(cc.manifestUrl),Ec),hc.PK(-2025863019,cc);else if(Ec===OSF.AgaveHostAction.NotifyHostError)cc={},cc=(cc[Ta.a.nYc]=hc.an.getManifestInvaildErrorString(),cc),hc.PK(-2025863019,
cc);else if(Ec===OSF.AgaveHostAction.RefreshAddinCommands)hb.EwaSettings.ma(54)&&hc.PK(jf.a.refreshAddinCommands,null);else if(Ec===OSF.AgaveHostAction.CtrlF6Exit||Ec===OSF.AgaveHostAction.CtrlF6ExitShift){if(he=hc.$.da.Aa(15)){(cc=hc.nn(cc).cia)&&cc.aBc();zb.a.Hf&&document.activeElement.blur();var qe={keyCode:117,type:"keydown",ctrlKey:!0};qe.shiftKey=Ec===OSF.AgaveHostAction.CtrlF6ExitShift;qe.srcElement=Object(Ha.a)(489,cc)?cc.bHa:Xb.g(hc.$).Kb;cc=new Sys.UI.DomEvent(qe);he.cX(cc)}}else if(Ec===
OSF.AgaveHostAction.PageIsReady){if((cc=hc.nn(cc).cia)&&cc.u_a===OSF.OsfControlTarget.TaskPane&&(cc=hc.$.da.Aa(183))&&hc.Jf)for(Ec=Kc.a.Md(hc.$),he=Cl(hc.Jf),qe=he.next();!qe.done;qe=he.next())a.kNa(qe.value.mV)&&(Ec?cc.Qe(!0,!1):cc.setFocusOnToolbarFirstElement())}else if(Ec===OSF.AgaveHostAction.TabExit){Ec=hc.nn(cc);var Af=Ec.cia;if(Af)if(Af.u_a===OSF.OsfControlTarget.InContent)Af.enf();else{if(Af.u_a===OSF.OsfControlTarget.TaskPane)if(Kc.a.Md(hc.$))zb.a.Hf&&document.activeElement.blur(),rb.UISurfaces.Tk().then(function(Gc){var xd=
Object(Ha.a)(489,Af)?Af:null;xd?xd.isResizable?Gc.focusResizeHandle():Gc.focusTabbedTaskPaneArea():Gc.focusTabbedTaskPaneArea();return null});else if(cc=hc.$.da.Aa(183))zb.a.Hf&&document.activeElement.blur(),(Ec=document.getElementById(hc.$.Lb+Eb.a.koc))&&Ob.DOMElementExtensions.isVisible(Ec)?Ob.DOMElementExtensions.setFocus(Ec):cc.setFocusOnToolbarFirstElement()}else Ec&&4===Ec.osfControlType&&hc.an.notifyAgave(cc,OSF.AgaveHostAction.TabIn)}else if(Ec===OSF.AgaveHostAction.TabExitShift)(Ec=hc.nn(cc),
he=Ec.cia)?he.u_a===OSF.OsfControlTarget.InContent?he.fnf():he.u_a===OSF.OsfControlTarget.TaskPane&&(cc=Object(Ha.a)(489,he)?he:null)&&(zb.a.Hf&&document.activeElement.blur(),cc.D2f()):Ec&&4===Ec.osfControlType&&hc.an.notifyAgave(cc,OSF.AgaveHostAction.TabIn);else if(Ec===OSF.AgaveHostAction.EscExit||Ec===OSF.AgaveHostAction.ExitNoFocusable||Ec===OSF.AgaveHostAction.ExitNoFocusableShift)if(he=hc.nn(cc).cia)he.aBc();else{if(Ec===OSF.AgaveHostAction.EscExit){Ec=null;he=Cl(ia.Y5h());for(qe=he.next();!qe.done;qe=
he.next())if(qe=qe.value,qe.value.Ve===cc){qe.value.dialog.hide();Ec=qe.key;break}Ec&&(cc=hc.nn(Ec))&&4!==cc.osfControlType&&hc.Ni.notifyAgave(Ec,OSF.AgaveHostAction.TabIn)}}else if(Ec===OSF.AgaveHostAction.InstallCustomFunctions)if(hb.EwaSettings.ma(122)){zc.a(hc.$).UYe(function(){return!1});var xf=hc.$.da;va.TaskExtensions.Ba(Uc.GetServiceTaskFactory.Ua(xf,278,279,1),function(Gc){Gc=Gc.result;xf.Aa(278)||xf.Ha(278,Gc);var xd=Lc.osfControl.getStoreType();Gc.Hef(Lc.osfControl.getSolutionId(),xd,a.rSh(Lc.osfControl),
Lc).loa()},hc.la,3)}else xa.ULS.sendTraceTag(537170577,0,10,"DdaFacade.OnOsfNotifyHost: Cannot install Custom Functions because this feature is not enabled.");else if(Ec===OSF.AgaveHostAction.UninstallCustomFunctions)if(hb.EwaSettings.ma(122)){zc.a(hc.$).UYe(function(){return!1});var fc=hc.$.da;va.TaskExtensions.Ba(Uc.GetServiceTaskFactory.Ua(fc,278,279,1),function(Gc){Gc=Gc.result;fc.Aa(278)||fc.Ha(278,Gc);Gc.vfg(Lc.solutionId,Lc.storeType).loa()},hc.la,3)}else xa.ULS.sendTraceTag(537170574,0,10,
"DdaFacade.OnOsfNotifyHost: Cannot uninstall Custom Functions because this feature is not enabled.");else Ec===OSF.AgaveHostAction.SendTelemetryEvent?e(Lc):Ec===OSF.AgaveHostAction.SendCustomerContent?c(Lc):Ec===OSF.AgaveHostAction.LaunchExtensionComponent?Gb.a.instance.gwi(Lc):Ec===OSF.AgaveHostAction.RefreshRibbonGallery?(cc=hc.$.da.Aa(352))&&cc.hfc(Lc):Ec===OSF.AgaveHostAction.RemoveAppCommandsAddin?(hc.ifj(Lc.solutionId),Kc.a.Md(hc.$)||(cc=hc.$.da.Aa(183))&&cc.Zr(),hb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.InstalledContentAddinsRibbonExperiment",
!1)&&Za.AFrameworkApplication.Ib.Be(jf.a.SSf,2,Lc.assetId)):Ec===OSF.AgaveHostAction.GetOriginalControlId&&(cc=new lb.a(hc.$.Lb,Lc.ownerAddinSolutionId,new Tb.a,!0),Lc.originalControlId=cc?cc.IJe(Lc.controlId):Lc.controlId)};hc.HZi=function(){hc.$.oa&&De.p(hc.$.oa)&&hc.$.da.Aa(34).$od()};hc.vd=function(){hc.bpf()};hc.GS=function(cc,Ec){var Lc,he;1===Ec.Au&&(cc=Ec.Mg)&&(Ec=new m(zd.toTimestamp(cc.enqueueUtcTime),zd.toTimestamp(cc.processUtcTime),zd.toTimestamp(cc.dequeueUtcTime),zd.getElapsedMilliseconds(cc.enqueueUtcTime,
cc.processUtcTime),zd.getElapsedMilliseconds(cc.processUtcTime,cc.dequeueUtcTime),cc.operationCount,(null===(he=null===(Lc=cc.operation)||void 0===Lc?void 0:Lc.qd)||void 0===he?0:he.ServerCorrelationId)?cc.operation.qd.ServerCorrelationId:null,cc.operation?Enum.toString(ae.a,cc.operation.operationName):null,rd.a.nD(zd.getElapsedMilliseconds(cc.enqueueUtcTime,$e.a.Ra.Ob))),Lc=Sys.Serialization.JavaScriptSerializer.serialize(Ec),xa.ULS.sendTraceTag(50872916,0,50,Lc))};hc.fd=function(cc,Ec){!hc.ea.sc&&
we.a(Ec)?(Array.forEach(hc.Jf,hc.pAf),Array.clear(hc.Jf),hc.JQb=!1):(Ec.gI&&(xa.ULS.sendTraceTag(537170516,0,50,"Silent Reload require reset osf controls."),hc.pXf()),hc.YL(),hb.EwaSettings.isChangeGateEnabled("OfficeVSO:4058224_ResetWorkbookContextLoadedAfterSilentReload")&&(hc.JQb=!1))};hc.Yq=function(){hb.EwaSettings.isChangeGateEnabled("OfficeVSO:4441876_ResetOsfControlsAfterServerReload")&&(xa.ULS.sendTraceTag(537170515,0,50,"Load on demand occurred require reset osf controls."),hc.pXf());hc.YL();
hb.EwaSettings.isChangeGateEnabled("OfficeVSO:4441876_ResetOsfControlsAfterServerReload")&&(hc.JQb=!1)};hc.pAf=function(cc){cc.apc();hc.raiseEvent("cd",cc.controlId)};hc.wb=za;hc.HYc=Mb;hc.initialize();S.ka(hc);hc.pYf=0;(za=(za=!(zb.a.zp||zb.a.dya))&&(!hb.EwaSettings.isChangeGateEnabled("OfficeVSO:5763473_DisableAddinKeyboardShortcutsInFirefox")||!zb.a.Hf))&&OfficeExt.ShortcutKeyDispatchManager.init();hc.wug={};return hc}function c(za){te.a.sendOtelCustomerContent(Object.assign(new ge.a,{otelEvent:za}))}
function e(za){te.a.sendOtelEvent(Object.assign(new ge.a,{otelEvent:za}))}function l(za,Mb,hc){var cc=je.call(this,hc,za)||this;cc.hashCode=null;cc.Rwa=null;cc.r5b=!1;cc.Rm=function(Ec,Lc){Lc.gd.hash===cc.hashCode&&cc.Rwa&&Object(nc.a)(b(947).DdaFacade,cc.$.da.Aa(35)).DFj(cc.Rwa.InstanceId)};cc.Xe=function(Ec,Lc){switch(Lc.gd.block.state){case 1:case 3:case 5:cc.Hoa(Lc)}};cc.Qg=function(){cc.gIb(!0)};cc.Io=function(Ec,Lc){cc.isVisible&&cc.$Ua(Lc.MD);cc.clearCache()};cc.Ie=function(Ec,Lc){cc.ZTa(Lc.oa,
!!Lc.MD)};cc.EO=function(){cc.$.ea.rna()};cc.JVa=Mb;cc.domElement.classList.add(qd.a.D$b);cc.domElement.classList.add(He.a.il);hc.tabIndex=0;cc.ZTa(cc.$.oa,!1);cc.xc.ka("mousedown",cc.EO);cc.xc.ka("contextmenu",function(Ec){yd.g(Ec)});cc.$.xa.YJ(cc.Io);cc.$.Ab.YJ(cc.Io);cc.$.Ab.Nf(cc.Ie);cc.$.xa.Nf(cc.Ie);cc.Da.xr(cc.Xe);cc.Da.lH(cc.Rm);cc.Da.aq(cc.Qg);hb.EwaSettings.uc()&&cc.yr(cc.Aza);return cc}function m(za,Mb,hc,cc,Ec,Lc,he,qe,Af){this.dequeueUtcTime=this.processUtcTime=this.enqueueUtcTime=null;
this.operationCount=this.executionDurationInMS=this.inQueueDurationInMS=0;this.UserOperationName=this.ServerCorrelationId=null;this.IsDocumentHidden=!1;this.enqueueUtcTime=za;this.processUtcTime=Mb;this.dequeueUtcTime=hc;this.inQueueDurationInMS=cc;this.executionDurationInMS=Ec;this.operationCount=Lc;this.ServerCorrelationId=he;this.UserOperationName=qe;this.IsDocumentHidden=Af}function n(za,Mb,hc){this.$=za;this.oj=Mb;this.runtimeCalculationMode=hc}function h(){}function u(za,Mb,hc){var cc=this;
this.DJf=null;this.Sdd=function(Ec,Lc){var he=Ge.a.OX,qe={};qe.eventId=Ec;qe.payload=Lc;cc.oj.P_(2201,he)&&cc.ii.zN(2201,he,Ud.a.Kc(qe))};this.$=za;this.oj=Mb;this.ii=hc;this.Zfi()}function w(za,Mb,hc){var cc=this;this.OIb=0;this.Wkg=!0;this.ibc=0;this.ttd=!0;this.TBe=function(){var Ec=document.hasFocus();if(cc.Wkg!==Ec){if(Ec){var Lc=Ud.a.Kc({});cc.ii.zN(2203,Ge.a.OX,Lc)}cc.Wkg=Ec}};this.UBe=function(Ec){(0<Ec.timeRemaining()||Ec.didTimeout)&&cc.TBe();window.requestIdleCallback(cc.UBe)};this.$=za;
this.oj=Mb;this.ii=hc;window.requestIdleCallback||(this.ttd=!1)}function r(za,Mb,hc){var cc=this;this.NIb=0;this.qbb=this.xbb=null;this.KIf=function(){var Ec=Xb.g(cc.$).ga.Pa.VC;if(Ec)if(cc.omf(Ec)){var Lc=cc.ska();cc.Udd(Lc);cc.xbb=Ec.floatingObject.id;cc.qbb=Lc}else cc.xbb&&(cc.Udd(cc.qbb),cc.xbb=null,cc.qbb=null);else cc.xbb&&(cc.Udd(cc.qbb),cc.xbb=null,cc.qbb=null)};this.$=za;this.oj=Mb;this.ii=hc}function B(za,Mb,hc){var cc=this;this.r4b=null;this.vud=!1;this.onPointerDown=function(Ec){if(3===
Ec.zb){var Lc=cc.gridView.lcc(Ec.clientPoint).m1a;cc.vud=!!Lc&&cc.gridView.ga.va.XMe(Lc)}else cc.vud=!1;cc.r4b=Ec.clientPoint;return!1};this.dd=function(Ec){if(cc.gridView.inRangePicker||cc.gridView.Vi||cc.vud||Ec.shiftKey||Ec.ctrlKey||Ec.Ca.button!==Sys.UI.MouseButton.leftButton||!cc.r4b||!Ec.clientPoint||Ec.clientPoint.x!==cc.r4b.x||Ec.clientPoint.y!==cc.r4b.y)return!1;var Lc=cc.gridView.lcc(Ec.clientPoint);Ec=Lc.m1a;Lc=Lc.returnValue;var he=Object(nc.a)(Zd.a,cc.$.xa.oa);if(Lc&&he&&0===he.fJ){if(!cc.gridView.ga.va.g5.contains(Ec))return!1;
Ec=new y(he,Ec,Ac.HelperMethods.UGd(Lc.x),Ac.HelperMethods.UGd(Lc.y));cc.c_i(Ec)}return!1};this.$=za;this.gridView=Xb.g(za);this.oj=Mb;this.ii=hc;this.Fdj()}function y(za,Mb,hc,cc){var Ec=$d.call(this)||this;Ec.sheet=za;Ec.MZg=Mb;Ec.offsetX=hc;Ec.offsetY=cc;return Ec}function v(za,Mb,hc){var cc=this;this.CSf=this.BSf=this.DSf=this.ASf=0;this.ZZi=function(Ec,Lc){Ec=Object(nc.a)(Zd.a,Lc.oa);cc.P8a(Ec)&&(Lc={},Lc.worksheetId=Ec.sheetId,Lc=Ud.a.Kc(Lc),cc.Xja(11,Ec.sheetId,Lc))};this.b_i=function(Ec,Lc){Ec=
Object(nc.a)(Zd.a,Lc.MD);cc.P8a(Ec)&&(Lc={},Lc.worksheetId=Ec.sheetId,Lc=Ud.a.Kc(Lc),cc.Xja(12,Ec.sheetId,Lc))};this.$Zi=function(Ec,Lc){Ec=Object(nc.a)(Zd.a,Lc.oa);cc.P8a(Ec)&&(Lc={},Lc.worksheetId=Ec.sheetId,Ec=Ud.a.Kc(Lc),cc.Xja(11,null,Ec,!0))};this.a_i=function(Ec,Lc){Ec=Object(nc.a)(Zd.a,Lc.MD);cc.P8a(Ec)&&(Lc={},Lc.worksheetId=Ec.sheetId,Ec=Ud.a.Kc(Lc),cc.Xja(12,null,Ec,!0))};this.$=za;this.oj=Mb;this.ii=hc}function A(za,Mb,hc){var cc=this;this.DRa=this.CRa=0;this.MHa=this.wia=null;this.FBf=
function(){var Ec=Xb.g(cc.$).ga.Pa.VC;if(0<cc.DRa&&cc.wia&&cc.MHa){var Lc={};Lc.shapeId=cc.wia;Lc.worksheetId=cc.MHa;Lc=Ud.a.Kc(Lc);cc.fireEvent(2102,cc.wia,Lc)}cc.Qri(Ec)?(cc.wia=cc.LSj(Ec),cc.MHa=cc.ska(),cc.wia&&cc.MHa)?0<cc.CRa&&(Ec={},Ec.shapeId=cc.wia,Ec.worksheetId=cc.MHa,Ec=Ud.a.Kc(Ec),cc.fireEvent(2101,cc.wia,Ec)):xa.ULS.sendTraceTag(537170458,344,10,"Something goes wrong, we got invalid shape id: '{0}', or worksheet id: '{1}' from a Floating object or gridview.",cc.wia,cc.MHa):(cc.wia=null,
cc.MHa=null)};this.$=za;this.oj=Mb;this.ii=hc}function t(za,Mb,hc){za=E.call(this,za,Mb,hc)||this;za.znf=null;za.ynf=null;return za}function E(za,Mb,hc){var cc=Lb.call(this)||this;cc.QAa=0;cc.AV=0;cc.ld=function(Ec,Lc){if(cc.enabled&&!(cc.Aif()||null!==Lc&&void 0!==Lc&&Lc.Nlf)&&(Ec=Object(nc.a)(Zd.a,cc.$.xa.oa))&&0===Ec.fJ){var he=Ec.sheetId,qe=cc.y1e(),Af=null,xf=null;cc.oj.Blf()&&(Af=cc.grid.Tb.Wj(cc.grid.ga.va.activeCell),xf=he in cc.ilc?cc.ilc[he]:null);cc.Dve(he,qe)&&va.TaskExtensions.Ba(vd.Task.Sa(!0),
function(){cc.k$h(he,qe);cc.V9h(he,qe,Af,xf)},cc.la);cc.RMe(he,qe,Af)}};cc.$=za;cc.oj=Mb;cc.ii=hc;cc.grid=Xb.g(za);cc.wOa={};cc.ilc={};return cc}function C(za,Mb,hc){var cc=this;this.ySf=this.xSf=0;this.mMb=this.Abb=null;this.IMi=function(){var Ec=Xb.g(cc.$).ga.Pa.VC;if(cc.Aqd(Ec)&&(Ec=cc.occ(Ec))){var Lc={chartId:Ec};Lc.worksheetId=cc.ska();Lc=Ud.a.Kc(Lc);cc.Xja(51,Ec,Lc);cc.Xja(51,cc.ska(),Lc)}};this.JMi=function(){if(cc.Abb){var Ec={};Ec.chartId=cc.Abb;Ec.worksheetId=cc.mMb;Ec=Ud.a.Kc(Ec);cc.Xja(52,
cc.Abb,Ec);cc.Xja(52,cc.mMb,Ec)}Ec=Xb.g(cc.$).ga.Pa.VC;cc.Aqd(Ec)?(cc.Abb=cc.occ(Ec),cc.mMb=cc.ska()):(cc.Abb=null,cc.mMb=null)};this.$=za;this.oj=Mb;this.ii=hc}function H(){this.q_a={}}function U(za,Mb,hc,cc){cc=void 0===cc?!1:cc;var Ec=Ne.call(this)||this;Ec.Ndb=0;Ec.pF=null;Ec.oxa=!1;Ec.Qsc=null;Ec.AV=0;Ec.r5d=null;Ec.FJc=null;Ec.SWa=null;Ec.s7b=null;Ec.ice=!1;Ec.B2d=null;Ec.pea=null;Ec.QQc=null;Ec.ld=function(){Ec.enabled&&(Ec.Msj(),Ec.Qsc=ac.d(Xb.g(Ec.$).ga.va.selectedRanges))};Ec.F9e=function(Lc){Lc.controlId===
Ec.ee.InstanceId&&Array.forEach(Ec.pF,function(he){he.KDi(Lc)&&he.f3b(Lc)})};Ec.fyf=function(Lc){if((Lc=Object(nc.a)(489,Lc))&&!Lc.qq())if(!Ec.ee||OSF.OsfControl.isFirstPartyStoreString(Ec.ee.PrimaryMarketplace.MarketplaceType)||Ec.$.$ha){Lc.Af=Ec.ee;Lc.Fh=Ec.kh;Ec.B2d=Lc;Ec.Dyc(Lc.bHa);var he=hb.EwaSettings.isChangeGateEnabled("OfficeVSO:5947100_createHiddenTaskpanePreload")&&Kc.a.Md(Ec.$)&&Ac.HelperMethods.Mw(Ec.ee)&&Ec.ee.Preload&&!Ec.ee.TaskpaneVisible;he?Lc.RDd():hb.EwaSettings.isChangeGateEnabled("OfficeVSO:5550690_FixHiddenStartupStateUnderReactPaneInfra")?
(Lc.RDd(),(Ec.ee.SharedRuntime&&1===Ec.ee.SharedRuntime.LifeTime||Ec.ee.SharedRuntimeId)&&!Ec.ee.TaskpaneVisible&&Lc.Uf(!1)):((Ec.ee.SharedRuntime&&1===Ec.ee.SharedRuntime.LifeTime||Ec.ee.SharedRuntimeId)&&!Ec.ee.TaskpaneVisible&&Lc.Uf(!1),Lc.RDd());Ec.m7a||(Kc.a.Md(Ec.$)?he||Lc.LS():Zc.a(Ec.$).result.XD(Lc,!0));Ec.$.da.Aa(77).VTf(Ec.fyf);Ec.cia=Object(nc.a)(601,Lc)}else xa.ULS.sendTraceTag(537170464,0,50,"Taskpane web add-in disabled by doc IRM")};Ec.onFloatingObjectControlAdded=function(Lc,he){3===
he.control.floatingObject.type&&he.control.floatingObject.rl.InstanceId===Ec.g2.WebExtensionId&&(Ec.cia=Object(nc.a)(601,he.control),Ec.Dyc(he.control.Sd.firstChild),sb.a(Ec.$).Vuc(Ec.onFloatingObjectControlAdded))};Ec.wb=za.$;Ec.kh=za;Ec.ee=hc;Ec.ee.InstanceId=hc.SrcLocationOverrideResourceId?za.E4a(hc.InstanceId,hc.SrcLocationOverrideResourceId):hc.InstanceId;Ec.ii=Mb;Ec.g2={};Ec.g2.WebExtensionId=hc.InstanceId;Ec.CJf="osfControl_"+hc.InstanceId;Ec.s9c="disabled_"+hc.InstanceId;Ec.g2.BindingData=
hc.BindingData;Ec.m7a=Ec.kh.m7a(hc.InstanceId);Ec.yhc=Ec.kh.yhc(hc.InstanceId);Ec.Hge=hc.WebExtensionOsfControlType;Ec.HMf=cc;return Ec}function Q(){}function O(za,Mb,hc,cc,Ec,Lc,he,qe){za=Sb.call(this,za,Mb,hc)||this;za.startRow=0;za.startColumn=0;za.rowCount=0;za.columnCount=0;za.startColumn=Lc-cc.Reference.FirstColumn;za.columnCount=qe;Lc=Math.max(Ec,cc.Reference.FirstRow);Ec=Math.min(Ec+he-1,cc.Reference.LastRow);Lc>Ec?za.startRow=za.rowCount=void 0:(za.startRow=Lc-cc.Reference.FirstRow,za.rowCount=
Ec-Lc+1);return za}function ea(za){var Mb=this;this.pF=null;this.oxa=!1;this.ld=function(){Mb.pF.forEach(function(hc){hc.eventId===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&hc.f3b(new Ca.a(hc.eventId,"",null))})};this.kh=za}function Z(za,Mb){this.pB=null;this.mga=za;this.fBg=Mb}function S(za){var Mb=this;this.Ni=this.oZc=null;this.$Ti=function(hc,cc){Mb.handlers.xb(cc.controlId)&&(hc=new P(OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent,cc.controlId,null,cc.messageType,cc.messageContent,
cc.messageOrigin,cc.targetOrigin),Mb.handlers.pa(cc.controlId)(hc),cc.messageType===OSF.DialogMessageType.DialogClosed&&Mb.handlers.remove(cc.controlId))};this.ZTi=function(hc,cc){Mb.onc.xb(cc.controlId)&&(hc=new I(OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent,cc.controlId,null,cc.messageType,cc.messageContent,cc.messageOrigin,cc.targetOrigin),Mb.onc.pa(cc.controlId)(hc))};this.handlers=new wc.a;this.onc=new wc.a;this.kh=za;this.M2a.gKg(this.$Ti);this.M2a.fKg(this.ZTi)}function I(za,
Mb,hc,cc,Ec,Lc,he){za=Sa.call(this,za,Mb,hc)||this;za.messageType=0;za.messageContent=null;za.messageOrigin=null;za.targetOrigin=null;za.messageType=cc;za.messageContent=Ec;za.messageOrigin=Lc;za.targetOrigin=he;return za}function P(za,Mb,hc,cc,Ec,Lc,he){za=db.call(this,za,Mb,hc)||this;za.messageType=0;za.messageContent=null;za.messageOrigin=null;za.targetOrigin=null;za.messageType=cc;za.messageContent=Ec;za.messageOrigin=Lc;za.targetOrigin=he;return za}function J(za,Mb){var hc=wa.call(this)||this;
hc.requests=[];hc.z3b=!1;hc.disposed=!1;hc.Rg=function(){if(!hc.disposed){hc.grid.zc.Zn(hc.Rg);hc.z3b=!1;var cc=hc.requests;hc.requests=[];cc=Cl(cc);for(var Ec=cc.next();!Ec.done;Ec=cc.next())Ec=Ec.value,hc.ddaFacade.PK(Ec.command,Ec.properties)}};hc.ddaFacade=za;hc.grid=Mb;return hc}function aa(){this.command=0;this.properties=null}function ia(za){this.$a=new oa.a;this.an=za}function ba(za,Mb,hc,cc,Ec){hc=void 0===hc?null:hc;cc=void 0===cc?"":cc;Ec=void 0===Ec?"":Ec;var Lc=Ja.call(this)||this;Lc.controlId=
za;Lc.messageType=Mb;Lc.messageContent=hc;Lc.messageOrigin=cc;Lc.targetOrigin=Ec;return Lc}function ra(za,Mb,hc,cc,Ec){hc=void 0===hc?null:hc;cc=void 0===cc?"":cc;Ec=void 0===Ec?"":Ec;var Lc=pa.call(this)||this;Lc.controlId=za;Lc.messageType=Mb;Lc.messageContent=hc;Lc.messageOrigin=cc;Lc.targetOrigin=Ec;return Lc}function ka(){this.height=this.width=0;this.Ve=this.controlId=this.pageUrl=null;this.Zfc=this.y9c=!1}function da(){}function ha(){this.dialog=this.Ve=null}function qa(za,Mb,hc){var cc=nb.call(this)||
this;cc.p$=null;cc.WUc="WACDialogTitleText";cc.IWa="0";cc.RSb="15px";cc.Pqg="0px";cc.HWa="calc(100% - 30px)";cc.Oqg="100%";cc.yie=0;cc.$a=new oa.a;cc.wog=new Fa;cc.lc=5;cc.aEa=hc;cc.Ve=hc;cc.aKc=za;cc.u8d=Mb;cc.pKc=!!Za.AFrameworkApplication.ha&&Za.AFrameworkApplication.ha.ra("OfficeAddinEnableInsertDialogAccessibilityFix");return cc}function Aa(){}function Fa(){}function ab(za,Mb){za=Ua.call(this,1,za,Mb)||this;za.rff=OfficeExt.CommandInvokeMode.ExclusiveForNew;return za}function Ua(za,Mb,hc){this._id=
za;this.uog=Mb;this.Aqg=hc;this.rff=OfficeExt.CommandInvokeMode.Default}b.r(F);var bb=b(0),xa=b(13),Gb=b(1356),$b=b(82),oa=b(96);Ua.prototype.execute=function(za,Mb,hc){var cc=this;hc=hc||{};hc.commandMode=this.rff;Mb.invokeAppCommand(this.OLg,this.B3g,hc,function(){za.kUi(cc.id)})};uk.Object.defineProperties(Ua.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this._id}},OLg:{configurable:!0,enumerable:!0,get:function(){return this.uog}},B3g:{configurable:!0,enumerable:!0,get:function(){return this.Aqg}}});
Object(bb.a)(Ua,"AddinNativeActionBase",null,[295]);Am(ab,Ua);Object(bb.a)(ab,"AddinTakeSnapshotAction",Ua,[]);Fa.prototype.o8g=function(za){return new Ua(3,za,this.UNh().getNativeActionName(3))};Fa.prototype.UNh=function(){return OfficeExt.AddinNativeActionRuntimeManager.getInstance()};Object(bb.a)(Fa,"AddinNativeActionManager",null,[274]);var Ma=b(149);Aa.prototype.invokeAppCommand=function(za,Mb,hc,cc){OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(za,Mb,hc,cc)};Aa.getInstance=function(){Aa.Na||
(Aa.Na=new Aa);return Aa.Na};Aa.Na=null;Object(bb.a)(Aa,"OSFAddinCommandsRuntimeManager",null,[273]);var Za=b(4),gb=b(180),zb=b(23),nb=Ma.a;Am(qa,nb);qa.prototype.ZJg=function(za){this.$a.addHandler("OnDialogClosedEventKey",za)};qa.prototype.Kwj=function(){this.jFa=null};qa.prototype.KD=function(){nb.prototype.KD.call(this);this.Up.style.width="100%";this.Up.style.height=this.Afc?this.HWa:this.Oqg;this.Up.style.marginTop=this.Afc?this.RSb:this.Pqg;this.Up.style.padding=this.IWa};qa.prototype.qP=function(){nb.prototype.qP.call(this);
this.Pb.style.width=String.format("{0}px",this.aKc*window.innerWidth/100);this.Pb.style.height=String.format("{0}px",this.u8d*window.innerHeight/100);this.Pb.style.minWidth="0px";this.pKc&&Za.AFrameworkApplication.isRtl&&100===this.aKc&&(this.Pb.style.right="0px",this.Pb.style.marginRight="0px");this.p$=document.getElementById(this.vi(this.WUc));this.p$.style.position="absolute";this.p$.style.whiteSpace="nowrap";this.p$.style.textOverflow="ellipsis";Za.AFrameworkApplication.isRtl?(this.p$.style.right=
"14px",this.p$.style.left="44px"):(this.p$.style.right="44px",this.p$.style.left="14px")};qa.prototype.Kv=function(za){nb.prototype.Kv.call(this,za);this.p$&&this.p$.setAttribute("title",za)};qa.prototype.dOd=function(){this.Pb.style.width=String.format("{0}px",this.aKc*window.innerWidth/100);this.Pb.style.height=String.format("{0}px",this.u8d*window.innerHeight/100);this.Pb.style.overflowY="hidden";this.Pb.style.overflowX="hidden";this.Pb.style.marginTop="";this.Pb.style.top="";zb.a.gS&&Za.AFrameworkApplication.isRtl?
(this.Pb.style.right="",this.Pb.style.marginRight=""):(this.Pb.style.left="",this.Pb.style.marginLeft="")};qa.prototype.hide=function(){var za=this;this.wog.o8g(this.aEa).execute(this,Aa.getInstance(),{});this.yie=window.setTimeout(function(){za.$a.raiseEvent("OnDialogClosedEventKey",za.aEa);gb.a.prototype.hide.call(za)},500)};qa.prototype.kUi=function(za){3===za&&(window.clearTimeout(this.yie),this.$a.raiseEvent("OnDialogClosedEventKey",this.aEa),nb.prototype.hide.call(this))};uk.Object.defineProperties(qa.prototype,
{L2a:{configurable:!0,enumerable:!0,get:function(){return this.Up}}});Object(bb.a)(qa,"AppsForOfficeDialog",Ma.a,[253,254]);Object(bb.a)(ha,"DialogInfo",null,[]);da.url="url";da.height="height";da.width="width";da.y9c="displayInIframe";da.Zfc="hideTitle";Object(bb.a)(da,"DialogSettings",null,[]);Object(bb.a)(ka,"DisplayDialogParams",null,[]);var pa=Sys.EventArgs;Am(ra,pa);Object(bb.a)(ra,"OnMessageDialogEventArgs",Sys.EventArgs,[]);var Ja=Sys.EventArgs;Am(ba,Ja);Object(bb.a)(ba,"OnMessageParentEventArgs",
Sys.EventArgs,[]);var Da=b(40),ib=b(28),Rb=b(186),wc=b(97);ia.prototype.gKg=function(za){this.$a.addHandler("OnMessageParentEventKey",za)};ia.prototype.fKg=function(za){this.$a.addHandler("OnMessageDialogEventKey",za)};ia.prototype.showDialog=function(za,Mb,hc,cc){if(ia.f9.xb(Mb))xa.ULS.sendTraceTag(18896285,344,100,"ShowDialog: agave dialog map already has dialog info for this control."),hc(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);else try{var Ec=Da.b(za),Lc=Ec[da.url];if(this.an.getOsfControl(Mb).checkAppDomains(Lc)){var he=
new ka;he.width=Ec[da.width];he.height=Ec[da.height];he.pageUrl=Lc;he.y9c=Ec[da.y9c];he.Zfc=Ec[da.Zfc];he.controlId=Mb;he.Ve=Rb.a.create().toString();var qe=new ha;qe.Ve=he.Ve;var Af=this.an.getOsfControl(he.controlId).getManifest().getDefaultDisplayName(),xf=this.an.getOsfControl(he.controlId).getStoreType().toLowerCase();za=null;var fc=Za.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.HideDialogTitleOption",!1);za=(4===Za.AFrameworkApplication.sa.Qa.Yj&&"hardcodedpreinstall"===
xf||fc&&"sdxcatalog"===xf)&&he.Zfc?this.createAndShowAppsForOfficeDialog(he.width,he.height,he.Ve,!0,Af):this.createAndShowAppsForOfficeDialog(he.width,he.height,he.Ve,!1,Af);var Gc=this.an.getOsfControl(he.controlId),xd=Gc.getManifest();fc={};fc.id=he.Ve;fc.solutionId=Gc.getSolutionId();fc.version=Gc.getVersion();fc.storeType=xf;fc.storeId=Gc.getStoreId();fc.assetId=Gc.getAssetId();fc.assetStoreId=Gc.getAssetStoreId();fc.ownerAddinSolutionId=Gc.getOwnerAddinSolutionId();fc.ownerAddinStoreType=Gc.getOwnerAddinStoreType();
fc.appDomains=xd.getAppDomains();fc.dialogUrl=Lc;fc.osfControlType=1;fc.marketplaceID=xd.getMarketplaceID();fc.marketplaceVersion=xd.getMarketplaceVersion();fc.store=Gc.getStoreLocator();fc.ownerAddinAssetId=Gc.getOwnerAddinAssetId();fc.agaveName=Af;fc.div=za.L2a;xa.ULS.sendTraceTag(542978531,344,50,"ShowDialog: asset id {0}, url hash code {1}",Telemetry.PrivacyRules.GetAssetId(null!==fc.ownerAddinStoreType?fc.ownerAddinStoreType:fc.storeType,fc.storeId,fc.solutionId),ib.a.sw(he.pageUrl));this.an.insertDialogControl(fc);
za.ZJg(Object($b.a)(this,this.COi,"onDialogClosed"));qe.dialog=za;ia.f9.ia(he.controlId,qe);cc&&cc(fc);hc(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}else xa.ULS.sendTraceTag(19940611,344,10,"ShowDialog: dialog url not in app domains list."),hc(OSF.DDA.ErrorCodeManager.errorCodes.ooeAppDomains)}catch(Id){xa.ULS.sendTraceTag(18371104,344,10,"ShowDialog: action failed. Exception message: {0}",Id.message),hc(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}};ia.prototype.tFi=function(za,Mb,
hc,cc){Za.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MessageParentOriginLeaveTargetOrigin",!1)||""===cc&&(cc=hc);try{var Ec=this.pwa(za);Ec&&this.$a.raiseEvent("OnMessageParentEventKey",new ba(Ec,OSF.DialogMessageType.DialogMessageReceived,Mb,hc,cc))}catch(Lc){return xa.ULS.sendTraceTag(555238219,344,10,"MessageParentOrigin: action failed. Exception message: {0}",Lc.message),OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess};
ia.prototype.K3c=function(za,Mb){if(ia.f9.xb(za))try{var hc=ia.f9.pa(za);hc.dialog&&hc.dialog.hide();this.an.purgeDialogControl(hc.Ve);ia.f9.remove(za);Mb(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}catch(cc){xa.ULS.sendTraceTag(18371106,344,10,"CloseDialog: action failed. Exception message: {0}",cc.message),Mb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}else xa.ULS.sendTraceTag(18896286,344,10,"CloseDialog: agave dialog map does not has dialog info for this control."),Mb(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)};
ia.prototype.Csj=function(za,Mb,hc,cc){Za.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SendMessageOriginLeaveTargetOrigin",!1)||""===cc&&(cc=hc);if(ia.f9.xb(za)&&(za=ia.f9.pa(za),za.dialog))try{this.$a.raiseEvent("OnMessageDialogEventKey",new ra(za.Ve,OSF.DialogMessageType.DialogParentMessageReceived,Mb,hc,cc))}catch(Ec){xa.ULS.sendTraceTag(555045763,344,10,"SendMessageOrigin: action failed. Exception message: {0}",Ec.message)}};ia.prototype.pwa=function(za){for(var Mb=
null,hc=Cl(ia.f9),cc=hc.next();!cc.done;cc=hc.next())if(cc=cc.value,cc.value.Ve===za){Mb=cc.key;break}return Mb};ia.prototype.COi=function(za,Mb){if(za=this.pwa(Mb))this.an.purgeDialogControl(Mb),ia.f9.remove(za),this.$a.raiseEvent("OnMessageParentEventKey",new ba(za,OSF.DialogMessageType.DialogClosed,null,null,"*"))};ia.prototype.createAndShowAppsForOfficeDialog=function(za,Mb,hc,cc,Ec){za=new qa(za,Mb,hc);Ec=cc?"":String.format(CommonUIStrings.l_ShowDialogApiInlineDialogTitle,Ec);cc&&(za.Afc=!1,
za.rv=!1);za.initializeAndShow(Ec,null,null);za.Kwj();return za};ia.Y5h=function(){return ia.f9};ia.getInstance=function(za){ia.Na||(ia.Na=new ia(za));return ia.Na};ia.Na=null;ia.f9=new wc.a;Object(bb.a)(ia,"AppsForOfficeDialogManager",null,[239]);var Cb=b(1060),lb=b(1367),yb=b(1433),pc=b(1142),Ta=b(930),rb=b(201),ic=b(1368),Va=b(117),jb=b(84),rc=b(89),Cc=b(736),Hc=b(614),Nb=b(893),nc=b(81),Ha=b(437),tb=b(161),Ub=b(199),gc=b(36),Eb=b(5),Tb=b(1026),Wc=b(1314),T=b(75);Object(bb.a)(aa,"DdaRequestInfo",
null,[]);var ua=b(944),ma=b(78),wa=T.a;Am(J,wa);J.prototype.dhh=function(za,Mb){this.disposed||(this.z3b||(this.grid.zc.Wo(this.Rg),this.z3b=!0),this.requests.push(Object.assign(new aa,{command:za,properties:Mb})))};J.prototype.dispose=function(){if(!this.disposed){this.disposed=!0;this.z3b&&this.grid.zc.Zn(this.Rg);var za=this.requests;this.requests=null;za=Cl(za);for(var Mb=za.next();!Mb.done;Mb=za.next())Mb=Mb.value,(Mb=Mb.properties?Mb.properties[ma.a.t4]:null)&&this.ddaFacade.Bf(ua.a.Wzb,Mb);
this.ddaFacade=this.grid=null;wa.prototype.dispose.call(this)}};J.E3g=function(za,Mb){var hc=!1;974713501===za&&(Mb=(za=Mb?Mb[ma.a.Gg]:null)?za.DdaMethod:null)&&Mb.DispatchId===OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod&&(hc=za.ArrayData,hc=!!hc&&64===(hc[6]&64));return hc};Object(bb.a)(J,"DdaCellEditDelayRequestHandler",T.a,[]);var Ca=b(976),db=Ca.a;Am(P,db);Object(bb.a)(P,"DialogMessageReceivedEventArgs",Ca.a,[]);var Sa=Ca.a;Am(I,Sa);Object(bb.a)(I,"DialogParentMessageReceivedEventArgs",
Ca.a,[]);var hb=b(1);S.prototype.addHandler=function(za,Mb,hc,cc){var Ec=this;if(hb.EwaSettings.ma(24))this.kh.Bf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,hc);else{xa.ULS.sendTraceTag(537170502,0,50,"DialogMessageReceivedEventManager.AddHandler called!");var Lc=function(he){he===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?(Ec.handlers.ia(za,Mb),Ec.kh.mv(hc)):(xa.ULS.sendTraceTag(537170501,0,10,"DialogMessageReceivedEventManager.AddHandler failed!"),Ec.kh.Bf(he,hc))};this.handlers.xb(za)?
Lc(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.showDialog(za,cc,Lc)}};S.prototype.GFg=function(za,Mb,hc){hb.EwaSettings.ma(24)?this.kh.Bf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,hc):(xa.ULS.sendTraceTag(537170500,0,50,"DialogMessageReceivedEventManager.AddMessageChildHandler called!"),this.onc.ia(za,Mb),this.kh.mv(hc))};S.prototype.removeHandler=function(za,Mb){var hc=this;hb.EwaSettings.ma(24)?this.kh.Bf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,
Mb):this.handlers.xb(za)?(xa.ULS.sendTraceTag(537170499,0,50,"DialogMessageReceivedEventManager.RemoveHandler called!"),this.M2a.K3c(za,function(cc){hc.handlers.remove(za);cc===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?hc.kh.mv(Mb):(xa.ULS.sendTraceTag(537170498,0,10,"DialogMessageReceivedEventManager.RemoveHandler failed!"),hc.kh.Bf(cc,Mb))})):this.kh.Bf(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,Mb)};S.prototype.cfj=function(za,Mb){hb.EwaSettings.ma(24)?this.kh.Bf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,
Mb):(xa.ULS.sendTraceTag(537170497,0,50,"DialogMessageReceivedEventManager.RemoveHandler called!"),this.onc.remove(za),this.kh.mv(Mb))};S.prototype.showDialog=function(za,Mb,hc){var cc=this;try{this.M2a.showDialog(Mb,za,hc,function(Ec){cc.kh.YFg(cc.lWg(Ec))})}catch(Ec){xa.ULS.sendTraceTag(537170496,0,10,"DialogMessageReceivedEventManager: show dialog failed. Exception message: {0}",Ec.message),hc(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}};S.prototype.lWg=function(za){var Mb={};Mb.InstanceId=
za.id;Mb.WebExtensionType=za.osfControlType===OSF.OsfControlTarget.InContent?0:1;Mb.PrimaryMarketplace={};Mb.PrimaryMarketplace.SolutionId=za.solutionId;Mb.PrimaryMarketplace.SolutionVersion=za.version;Mb.PrimaryMarketplace.MarketplaceRef=za.storeId;Mb.PrimaryMarketplace.MarketplaceType=za.storeType;return Mb};S.ka=function(za){if(!za.$.da.Aa(232)){var Mb=new S(za);za.$.da.Ha(232,Mb)}};uk.Object.defineProperties(S.prototype,{M2a:{configurable:!0,enumerable:!0,get:function(){this.oZc||(this.oZc=ia.getInstance(this.contextActivationMgr));
return this.oZc}},contextActivationMgr:{configurable:!0,enumerable:!0,get:function(){!this.Ni&&this.kh&&(this.Ni=this.kh.Ni);return this.Ni}}});Object(bb.a)(S,"DialogMessageReceivedEventManager",null,[990]);Z.prototype.d0b=function(za){za&&(this.pB||(this.pB=[]),Array.add(this.pB,za))};Z.prototype.bvc=function(za){this.pB&&Array.remove(this.pB,za)};Z.prototype.KDi=function(za){return this.eventId!==za.dispid?!1:this.eventId===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||this.eventId===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent?
this.targetId===za.ddaBinding.Name:!0};Z.prototype.f3b=function(za){this.pB&&Array.forEach(this.pB,function(Mb){Mb(za)})};Z.prototype.Tna=function(){this.pB=[]};uk.Object.defineProperties(Z.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return this.mga}},targetId:{configurable:!0,enumerable:!0,get:function(){return this.fBg}},L$h:{configurable:!0,enumerable:!0,get:function(){return 0<this.pB.length}}});Object(bb.a)(Z,"DdaEventRegistration",null,[]);var Xb=b(20);ea.prototype.invokeDdaMethod=
function(za,Mb){var hc={};hc[ma.a.Gg]=za;hc[ma.a.t4]=Mb;this.kh.PK(974713501,hc)};ea.prototype.registerDdaEventAsync=function(za,Mb,hc,cc,Ec){ea.DAb(za)?(ea.Rqd(za)&&this.tnd(),this.pF||(this.pF=[]),Mb=this.Avb(za,hc),Mb||(Mb=new Z(za,hc),Array.add(this.pF,Mb)),Mb.d0b(cc),this.kh.mv(Ec)):this.kh.Bf(-1,Ec)};ea.prototype.unregisterDdaEventAsync=function(za,Mb,hc,cc,Ec){ea.DAb(za)?((za=this.Avb(za,hc))&&za.bvc(cc),this.kh.mv(Ec)):this.kh.Bf(-1,Ec)};ea.prototype.tnd=function(){this.oxa||(Xb.g(this.kh.$).ga.WE(this.ld),
this.oxa=!0)};ea.prototype.Avb=function(za,Mb){if(!this.pF)return null;for(var hc=0;hc<this.pF.length;hc++){var cc=this.pF[hc];if(cc.eventId===za&&cc.targetId===Mb)return cc}return null};ea.DAb=function(za){return za===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent};ea.Rqd=function(za){return za===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent};Object(bb.a)(ea,"EmbeddingPage",null,[974]);var xb=b(204),Sb=Ca.a;Am(O,Sb);O.prototype.getStartRow=function(){return this.startRow};O.prototype.getStartColumn=
function(){return this.startColumn};O.prototype.getRowCount=function(){return this.rowCount};O.prototype.getColumnCount=function(){return this.columnCount};Object(bb.a)(O,"DdaBindingSelectionEventArgs",Ca.a,[]);var qb=b(200),mb=b(24),ac=b(45),Uc=b(51),Zc=b(438),Kc=b(39),va=b(35),fb=b(628),Pb=b(109),sc=b(52),hd=b(95),Ob=b(11),Ac=b(8),sb=b(103);Q.vyh="ewa-wx-disabled-div";Q.uyh="ewa-wx-container-div";Q.bSe="ewa-ptp-nov2-flex";Object(bb.a)(Q,"CssClassNames",null,[]);var ad=Q.vyh,Hd=Q.uyh,Ne=xb.a;Am(U,
Ne);U.prototype.wgi=function(za){this.pea||(this.pea=za)};U.prototype.FTf=function(){this.pea&&(this.pea.dispose(),this.pea=null)};U.prototype.Mod=function(){var za=this;if(!OSF.OsfControl.isFirstPartyStoreString(this.ee.PrimaryMarketplace.MarketplaceType)&&hb.EwaSettings.ma(187)){var Mb=Uc.GetServiceTaskFactory.Ua(this.$.da,5,4,0);va.TaskExtensions.Ba(Mb,function(){Mb.result.lg(35,null)},this.la,3);return this}if(1===this.ee.WebExtensionType)va.TaskExtensions.Ba(Zc.a(this.$),function(Ec){Ec.result.Ssb(za.$.da,
77,6,za.fyf,1)},this.la,3);else{var hc=this.jXe(),cc=sb.a(this.$);hc||(hc={Type:3},hc.Id=this.g2.WebExtensionId,hc.WebExtensionData=this.ee,hc.ContentHtml="<div/>",hc.Version=0,hc.AbsoluteLeft=0,hc.AbsoluteTop=0,hc.AbsoluteRight=0,hc.AbsoluteBottom=0,hc.Width=0,hc.Height=0,hc.ZOrder=0,hc.OriginDeltaX=0,hc.OriginDeltaY=0,hc=new qb.a(hc),cc.Y5b(hc,null),hc=cc.Mq(hc.Ug()));hc?(this.Dyc(hc.Sd.firstChild),this.cia=Object(nc.a)(601,hc)):cc.W_b(this.onFloatingObjectControlAdded)}return this};U.prototype.Fdf=
function(za){this.Dyc(za);return this};U.prototype.apc=function(){this.HMf||this.kh.Ni.purgeOsfControl(this.controlId,!1);this.sfg(!0);var za=this.jXe();za&&sb.a(this.$).deleteFloatingObject(za);this.kh.oj.Mej(this.controlId);this.kh.oj.QOe(this.controlId,!0);this.QQc=null};U.prototype.gEd=function(za){this.g2=za};U.prototype.invokeDdaMethod=function(za,Mb){if(hb.EwaSettings.isChangeGateEnabled("OfficeVSO:3614837_disableDragCheck")||this.enabled){var hc={};hc[ma.a.Gg]=za;hc[ma.a.t4]=Mb;this.kh.PK(974713501,
hc)}else this.kh.Bf(ua.a.Wzb,Mb)};U.prototype.icj=function(za,Mb,hc,cc){if(hb.EwaSettings.isChangeGateEnabled("OfficeVSO:3614837_disableDragCheck")||this.enabled)if(!U.Nlh(za)||void 0!==Mb&&null!==Mb&&void 0!==this.$3a(Mb)&&null!==this.$3a(Mb))if(xa.ULS.sendTraceTag(36444195,0,50,"eventId: {0}, targetId: {1}",za,Mb),U.Rgf(za)&&this.ybi(),U.Rqd(za)&&this.tnd(),U.Pgf(za))hb.EwaSettings.ma(24)?this.kh.Bf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,cc):this.kh.$.da.Aa(232).addHandler(this.controlId,
hc,cc,Mb);else if(U.Qgf(za))hb.EwaSettings.ma(24)?this.kh.Bf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,cc):this.kh.$.da.Aa(232).GFg(this.controlId,hc,cc);else{U.Ogf(za)&&this.H9e(-1777565636,cc);this.pF||(this.pF=[]);var Ec=this.Avb(za,Mb);Ec||(Ec=new Z(za,Mb),Array.add(this.pF,Ec));Ec.Tna();Ec.d0b(hc);this.kh.mv(cc);za===OSF.DDA.EventDispId.dispidRichApiMessageEvent&&this.SWa&&(this.s7b=hc)}else this.kh.Bf(3002,cc);else this.kh.Bf(-1,cc)};U.prototype.yUj=function(za,Mb,hc,cc){U.Pgf(za)?
hb.EwaSettings.ma(24)?this.kh.Bf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,cc):this.kh.$.da.Aa(232).removeHandler(this.controlId,cc):U.Qgf(za)?hb.EwaSettings.ma(24)?this.kh.Bf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,cc):this.kh.$.da.Aa(232).cfj(this.controlId,cc):(U.Ogf(za)&&this.H9e(1592314317,cc),Mb=this.Avb(za,Mb),this.enabled?(Mb&&(Mb.bvc(hc),Mb.L$h||Array.remove(this.pF,Mb),this.pF.length?U.Rgf(za)&&this.tfg(!1):this.sfg(!1)),this.kh.mv(cc)):this.kh.Bf(-1,
cc))};U.prototype.ka=function(za){Ob.DOMElementExtensions.getElementById(za,this.CJf)||za.appendChild(Ob.DOMElementExtensions.vf(this.Iy))};U.prototype.showHide=function(za){Ob.DOMElementExtensions.setVisible(this.Iy,za)};U.prototype.resize=function(za,Mb){Ob.DOMElementExtensions.nr(this.Iy,za);Ob.DOMElementExtensions.UG(this.Iy,Mb)};U.prototype.OLe=function(za){if(!this.AV&&!Ob.DOMElementExtensions.getElementById(this.Iy,this.s9c)&&this.Iy){var Mb=document.createElement("div");Mb.id=this.s9c;Mb.className=
ad;Mb.style.backgroundImage="url("+sc.a.current.Bo(81)+")";Mb.style.opacity=za?"1":"0";Mb.style.backgroundRepeat="no-repeat";Mb.style.backgroundPosition="center";this.Iy.insertBefore(Mb,this.Iy.firstChild)}this.AV++};U.prototype.Woh=function(){0<this.AV&&this.AV--;this.AV||(Ob.DOMElementExtensions.vf(Ob.DOMElementExtensions.getElementById(this.Iy,this.s9c)),this.oxa&&!ac.Q(this.Qsc,Xb.g(this.$).ga.va.selectedRanges)&&this.ld(null,null))};U.prototype.$3a=function(za){if(!this.g2||!this.g2.BindingData)return null;
for(var Mb=0;Mb<this.g2.BindingData.length;Mb++)if(this.g2.BindingData[Mb].Name===za)return this.g2.BindingData[Mb];return null};U.prototype.getDefaultIconUrl=function(){var za=this.d5e();return za?za.getDefaultIconUrl():null};U.prototype.getDefaultDisplayName=function(){if(this.ee.TaskpaneTitle)return this.ee.TaskpaneTitle;var za=this.d5e();return za?za.getDefaultDisplayName():null};U.prototype.JNf=function(){if(this.SWa&&this.s7b){var za=new Ca.a(OSF.DDA.EventDispId.dispidRichApiMessageEvent,this.controlId,
null,this.SWa);this.s7b(za);this.s7b=this.SWa=null}};U.prototype.Uf=function(za){this.B2d&&this.B2d.Uf(za)};U.prototype.Guj=function(){var za=this;this.$.ea.isNamedObjectViewMode&&this.iqi()&&(this.$.da.Aa(34).Fuj(this.Iy),this.showHide(!1));if(this.kh.t1j){if(!this.HMf){var Mb={};Mb.div=this.Iy;Mb.id=this.ee.InstanceId;Mb.solutionId=this.ee.PrimaryMarketplace.SolutionId;Mb.version=this.ee.PrimaryMarketplace.SolutionVersion;Mb.storeId=this.ee.PrimaryMarketplace.MarketplaceRef;Mb.storeType=this.ee.PrimaryMarketplace.MarketplaceType;
Mb.ownerAddinSolutionId=this.ee.OwnerAddinSolutionId;Mb.ownerAddinStoreType=this.ee.OwnerAddinStoreType;this.ee.AssetMarketplace&&(Mb.assetId=this.ee.AssetMarketplace.SolutionId,Mb.assetStoreId=this.ee.AssetMarketplace.MarketplaceRef);Mb.settings=this.ee.OsfPropertyBag;hb.EwaSettings.isChangeGateEnabled("OfficeVSO:5022710_EnableAgaveInitReasonControlActivation")?Mb.reason=this.m7a?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:this.yhc?Microsoft.Office.WebExtension.InitializationReason.Inserted:
Microsoft.Office.WebExtension.InitializationReason.ControlActivation:Mb.reason=this.m7a?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:Microsoft.Office.WebExtension.InitializationReason.Inserted;Mb.osfControlType=0===this.ee.WebExtensionType?OSF.OsfControlTarget.InContent:OSF.OsfControlTarget.TaskPane;Mb.isForUILessAction=4===this.ee.WebExtensionOsfControlType;Mb.sourceLocationOverrideResourceId=this.ee.SrcLocationOverrideResourceId;Mb.focusOnIframeWhenLoaded=this.ee.FocusOnIframeWhenLoaded;
fb.a(this.ee)&&(Mb.featureGates=Za.AFrameworkApplication.ha.NUh(Mb.solutionId));Mb.hostInfoFlags=0;this.cJa&&(Mb.hostInfoFlags|=2);Ac.HelperMethods.Mw(this.ee)&&(Mb.hostInfoFlags|=1);this.$.$ha||(xa.ULS.sendTraceTag(537170466,0,50,"Content web add-in disabled by doc IRM"),Mb.hostInfoFlags|=4);hb.EwaSettings.ma(654)&&(Mb.hostInfoFlags|=8);hb.EwaSettings.ma(54)&&hb.EwaSettings.ma(94)&&!this.FJc&&(Mb.virtualOsfControlActivationCallback=function(){za.kh.mFd(za.ee)});Mb.sharedRuntimeId=this.ee.SharedRuntime?
this.ee.SharedRuntime.Resid:this.ee.SharedRuntimeId;!Ac.HelperMethods.Mw(this.ee)||this.ee.Preload||fb.a(this.ee)||this.kh.Ni.getOsfControl(b(947).DdaFacade.getSolutionId(this.ee,this.$))||(hb.EwaSettings.isChangeGateEnabled("OfficeVSO:5707326_FixBackgroundAppCrashInViewMode")?this.$.isEditMode&&this.kh.mFd(this.ee):this.kh.mFd(this.ee));Mb.initialDisplayMode=this.ee.TaskpaneVisible?2:1;hb.EwaSettings.isChangeGateEnabled("OfficeVSO:5793296_SDXIframeTitleOverride")&&(Mb.titleOverride=this.rl.TaskpaneTitle);
this.kh.Ni.insertOsfControl(Mb)}this.AV=0}else this.OLe(!0)};U.prototype.sfg=function(za){this.tfg(za);this.fUj()};U.prototype.ybi=function(){this.Ndb||this.ii.d0b(this.F9e);this.Ndb++};U.prototype.tfg=function(za){0<this.Ndb&&(za?this.Ndb=0:this.Ndb--,this.Ndb||this.ii.bvc(this.F9e))};U.prototype.tnd=function(){if(!this.oxa){var za=Xb.g(this.$).ga;this.Qsc=ac.d(Xb.g(this.$).ga.va.selectedRanges);za.WE(this.ld);this.oxa=!0}};U.prototype.fUj=function(){this.oxa&&(Xb.g(this.$).ga.OI(this.ld),this.oxa=
!1)};U.prototype.Erj=function(za){var Mb=new mb.Range(za.Reference.FirstRow+1,za.Reference.FirstColumn+1,za.Reference.LastRow+1,za.Reference.LastColumn+1,!1,!1);1===za.BindingType&&(za.HasHeaders&&--Mb.top,za.HasTotals&&(Mb.bottom+=1));var hc=Xb.g(this.$).ga.va.selectedRanges;za=Mb.Vzb(this.Qsc);hc=Mb.Vzb(hc);return(Mb=Mb.We(Xb.g(this.$).ga.va.activeRange))&&(Pb.e(za)&&!Pb.e(hc)||!Pb.e(za)&&!Pb.e(hc)&&!ac.Q(za,hc))?Mb:null};U.prototype.Msj=function(){var za=this;Array.forEach(this.pF,function(Mb){if(Mb.eventId!==
OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&Mb.eventId!==OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||za.kh.oj.w1b(za.controlId))if(Mb.eventId===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent)Mb.f3b(new Ca.a(Mb.eventId,za.controlId,null));else if(Mb.eventId===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent){var hc=za.$3a(Mb.targetId);if((null===hc||void 0===hc?0:hc.IsValidRef)&&(za.$.ea.isNamedObjectViewMode?za.$.Ab.oa.sheetName:za.$.xa.oa.name)===hc.Reference.SheetName){var cc=
za.Erj(hc);cc&&Mb.f3b(new O(Mb.eventId,za.controlId,za.kh.m2b(hc),hc,cc.top-1,cc.left-1,cc.height,cc.width))}}})};U.prototype.Avb=function(za,Mb){if(!this.pF)return null;for(var hc=0;hc<this.pF.length;hc++){var cc=this.pF[hc];if(cc.eventId===za&&cc.targetId===Mb)return cc}return null};U.prototype.jXe=function(){for(var za=sb.a(this.$).Gz,Mb=za.length-1;0<=Mb;--Mb){var hc=za[Mb];if(3===hc.floatingObject.type&&hc.floatingObject.rl.InstanceId===this.g2.WebExtensionId)return hc}return null};U.prototype.iqi=
function(){for(var za=0;za<this.$.Ab.count;za++)if(this.$.Ab.getItem(za).hla===this.g2.WebExtensionId)return!0;return!1};U.prototype.Dyc=function(za){this.QQc=za;this.Iy.id=this.CJf;this.Iy.className=Hd;this.Iy.dir=this.$.isChromeRtl?"rtl":"ltr";this.Guj()};U.prototype.d5e=function(){if(!this.enabled)return null;var za=fb.a(this.rl)?"":this.rl.PrimaryMarketplace.SolutionVersion;return OSF.OsfManifestManager.getCachedManifest(this.rl.PrimaryMarketplace.SolutionId,za)};U.prototype.H9e=function(za,Mb){if(hb.EwaSettings.ma(24))this.kh.Bf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,
Mb);else try{if(xa.ULS.sendTraceTag(537170462,0,50,"HandleDialogNotificationShownInAddinEvent called!"),4!==this.Hge)this.kh.Bf(OSF.DDA.ErrorCodeManager.errorCodes.ooeNotUILessDialog,Mb);else{var hc={};hc[Ta.a.upb]=this.controlId;var cc=new hd.a(za,0,this.$.isEditMode?2:1,0,null);this.$.Ka.dc(cc,hc);this.kh.mv(Mb)}}catch(Ec){xa.ULS.sendTraceTag(537170461,0,10,"HandleDialogNotificationShownInAddinEvent called. Error message: {0}.",Ec.message),this.kh.Bf(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,
Mb)}};U.Nlh=function(za){return za===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||za===OSF.DDA.EventDispId.dispidBindingDataChangedEvent};U.Rgf=function(za){return za===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||za===OSF.DDA.EventDispId.dispidSettingsChangedEvent||za===OSF.DDA.EventDispId.dispidRichApiMessageEvent};U.Rqd=function(za){return za===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||za===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent};U.Pgf=function(za){return za===
OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent};U.Qgf=function(za){return za===OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent};U.Ogf=function(za){return za===OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent};uk.Object.defineProperties(U.prototype,{controlId:{configurable:!0,enumerable:!0,get:function(){return this.ee.InstanceId}},controlType:{configurable:!0,enumerable:!0,get:function(){return this.ee.WebExtensionType}},ownerAddinSolutionId:{configurable:!0,enumerable:!0,
get:function(){return this.ee.OwnerAddinSolutionId}},$:{configurable:!0,enumerable:!0,get:function(){return this.wb}},enabled:{configurable:!0,enumerable:!0,get:function(){return!this.AV}},Iy:{configurable:!0,enumerable:!0,get:function(){return this.QQc}},mV:{configurable:!0,enumerable:!0,get:function(){return this.ee.SrcLocationOverrideResourceId?this.kh.E4a(this.ee.PrimaryMarketplace.SolutionId,this.ee.SrcLocationOverrideResourceId):this.ee.PrimaryMarketplace.SolutionId}},sourceLocationOverrideResourceId:{configurable:!0,
enumerable:!0,get:function(){return this.ee.SrcLocationOverrideResourceId}},rl:{configurable:!0,enumerable:!0,get:function(){return this.ee}},cia:{configurable:!0,enumerable:!0,get:function(){return this.r5d},set:function(za){this.r5d=za}},osfControlType:{configurable:!0,enumerable:!0,get:function(){return this.Hge}},cJa:{configurable:!0,enumerable:!0,get:function(){return this.FJc},set:function(za){this.FJc=za}},P7c:{configurable:!0,enumerable:!0,get:function(){return this.SWa},set:function(za){this.SWa=
za}},focusOnIframeWhenLoaded:{configurable:!0,enumerable:!0,get:function(){return this.ee.FocusOnIframeWhenLoaded}},Lsd:{configurable:!0,enumerable:!0,get:function(){return this.ice},set:function(za){this.ice=za}}});Object(bb.a)(U,"OsfControl",xb.a,[989]);H.prototype.add=function(za){this.q_a[za]=!0};H.prototype.remove=function(za){delete this.q_a[za]};H.prototype.clear=function(){for(var za=Cl(Object.keys(this.q_a)),Mb=za.next();!Mb.done;Mb=za.next())delete this.q_a[Mb.value]};H.prototype.W$e=function(){return 0<
Object.keys(this.q_a).length};H.prototype.TNh=function(){return Object.keys(this.q_a)};Object(bb.a)(H,"RichApiBeforeDocumentCloseNotificationRegistrationManager",null,[]);var Ud=b(54);C.prototype.kqb=function(za){51===za.messageType?this.xSf=this.tHa(za.actionType,this.xSf,this.IMi):52===za.messageType&&(this.ySf=this.tHa(za.actionType,this.ySf,this.JMi))};C.prototype.tHa=function(za,Mb,hc){if(1===za)Mb||Xb.g(this.$).ga.Pa.EXc(hc),Mb++,this.nyj();else if(2===za){if(1>Mb)return Mb;1===Mb&&Xb.g(this.$).ga.Pa.rMd(hc);
Mb--}return Mb};C.prototype.Xja=function(za,Mb,hc){Mb&&this.oj.P_(za,Mb)&&this.ii.zN(za,Mb,hc)};C.prototype.occ=function(za){return za&&za.floatingObject?(za=za.floatingObject.id.match(RegExp("\\{\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}\\}")))&&1===za.length?za[0]:null:null};C.prototype.ska=function(){var za=this.$.xa.oa;return za&&0===za.fJ?za.sheetId:null};C.prototype.nyj=function(){var za=Xb.g(this.$).ga.Pa.VC;this.Aqd(za)&&(this.Abb=this.occ(za),this.mMb=this.ska())};C.prototype.Aqd=function(za){return!!za&&
!!za.floatingObject&&0===za.floatingObject.type};Object(bb.a)(C,"RichApiEventChartActivatedDeactivatedHandler",null,[]);var Ge=b(952),Sc=b(195),Pc=b(706),Zd=b(98),ie=b(358),vd=b(53),Lb=T.a;Am(E,Lb);E.prototype.U1b=function(za){Object(nc.a)(ie.a,this.$.xa);1===za.actionType?(this.QAa||this.grid.ga.WE(this.ld),this.QAa++):2!==za.actionType||1>this.QAa||(1===this.QAa&&this.grid.ga.OI(this.ld),this.QAa--)};E.prototype.jyc=function(za){za?this.AV++:(0<this.AV&&this.AV--,this.AV||this.ld(null,new Pc.a(!1)))};
E.prototype.y1e=function(){return this.grid.ga.va.selectedRanges};E.prototype.Dve=function(za,Mb){return hb.EwaSettings.isChangeGateEnabled("OfficeVSO:4233860_EnableSelectionChangedEventForFirstTimeOnOpenSheet")?(!!za&&Sc.e(this.wOa)||za in this.wOa)&&!ac.Q(this.wOa[za],Mb):za in this.wOa&&!ac.Q(this.wOa[za],Mb)};E.prototype.RMe=function(za,Mb,hc){this.wOa[za]=ac.d(Mb);this.ilc[za]=hc};E.prototype.Aif=function(){return this.grid.isEditing||this.grid.Vi};E.prototype.MXe=function(za,Mb){this.oj.P_(14,
za)&&this.ii.zN(14,za,Mb);this.oj.P_(14,Ge.a.OX)&&this.ii.zN(14,Ge.a.OX,Mb)};E.prototype.k$h=function(za,Mb){var hc={};hc.worksheetId=za;hc.address=this.Bjd(Mb);Mb=Ud.a.Kc(hc);this.MXe(za,Mb)};E.prototype.V9h=function(za,Mb,hc,cc){if(this.oj.Blf()){var Ec="",Lc="";cc&&(Ec=cc.pj);hc&&(Lc=hc.pj);cc?hc?(Mb=hc.usedRange.Vzb(Mb),Ec!==Lc&&this.Rac(Ec,"",za),this.Rac(Lc,this.Bjd(Mb),za)):this.Rac(Ec,"",za):hc&&(Ec=hc.usedRange.Vzb(Mb),this.Rac(Lc,this.Bjd(Ec),za))}};E.prototype.Rac=function(za,Mb,hc){if(this.oj.P_(100,
za)){var cc={};cc.address=Mb;cc.worksheetId=hc;this.ii.zN(100,za,Ud.a.Kc(cc))}};E.prototype.Bjd=function(za){return ac.i(za,",",this.$,!1)};E.prototype.dispose=function(){0<this.QAa&&this.grid.ga.OI(this.ld);this.ilc=this.wOa=null;this.QAa=0;this.ii=this.oj=this.$=this.grid=null};uk.Object.defineProperties(E.prototype,{enabled:{configurable:!0,enumerable:!0,get:function(){return!this.AV&&0<this.QAa}}});Object(bb.a)(E,"RichApiEventSelectionChangedHandler",T.a,[]);var id=b(353);Am(t,E);t.prototype.y1e=
function(){return id.a.btb(this.grid.ga.rangePicker.IL)};t.prototype.Dve=function(za,Mb){return this.znf!==za||!ac.Q(this.ynf,Mb)};t.prototype.RMe=function(za,Mb){this.znf=za;this.ynf=ac.d(Mb)};t.prototype.Aif=function(){return!this.grid.isEditing&&!this.grid.Vi};t.prototype.MXe=function(za,Mb){this.oj.P_(2700,Ge.a.OX)&&this.ii.zN(2700,Ge.a.OX,Mb)};Object(bb.a)(t,"RichApiEventPickedRangesChangedHandler",E,[]);A.prototype.kqb=function(za){var Mb=Xb.g(this.$).ga;1===za.actionType?(this.CRa||this.DRa||
Mb.Pa.EXc(this.FBf),2101===za.messageType?this.CRa++:2102===za.messageType&&this.DRa++):2===za.actionType&&(2101===za.messageType?this.CRa=0<this.CRa?this.CRa-1:0:2102===za.messageType&&(this.DRa=0<this.DRa?this.DRa-1:0),this.CRa||this.DRa||Mb.Pa.rMd(this.FBf))};A.prototype.Qri=function(za){return!!za&&!!za.floatingObject&&(0===za.floatingObject.type||7===za.floatingObject.type||1===za.floatingObject.type||3===za.floatingObject.type||5===za.floatingObject.type)};A.prototype.LSj=function(za){if(!za||
!za.floatingObject)return null;za=za.floatingObject.id;var Mb=za.match(RegExp("\\{\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}\\}"));Mb=Mb&&1===Mb.length?Mb[0]:null;return Mb?Mb:(xa.ULS.sendTraceTag(537170457,344,10,"Expect get the guid like shape id from the floating object id: '{0}', but we failed.",za),null)};A.prototype.ska=function(){var za=this.$.xa.oa;return za&&0===za.fJ?za.sheetId:null};A.prototype.fireEvent=function(za,Mb,hc){Mb&&this.oj.P_(za,Mb)&&this.ii.zN(za,Mb,hc)};Object(bb.a)(A,"RichApiEventShapeActivatedDeactivatedHandler",
null,[]);v.prototype.kqb=function(za){11===za.messageType?za.targetId===Ge.a.OX?this.mQg(za.actionType):this.lQg(za.actionType):12===za.messageType&&(za.targetId===Ge.a.OX?this.nQg(za.actionType):this.oQg(za.actionType))};v.prototype.lQg=function(za){this.ASf=this.tHa(za,this.ASf,this.ZZi)};v.prototype.oQg=function(za){this.DSf=this.tHa(za,this.DSf,this.b_i)};v.prototype.mQg=function(za){this.BSf=this.tHa(za,this.BSf,this.$Zi)};v.prototype.nQg=function(za){this.CSf=this.tHa(za,this.CSf,this.a_i)};
v.prototype.tHa=function(za,Mb,hc){1===za?Mb=this.$Zc(Mb,hc):2===za&&(Mb=this.d9c(Mb,hc));return Mb};v.prototype.$Zc=function(za,Mb){za||this.$.xa.Nf(Mb);za++;return za};v.prototype.d9c=function(za,Mb){if(1>za)return za;1===za&&this.$.xa.Ag(Mb);za--;return za};v.prototype.P8a=function(za){return!!za&&0===za.fJ};v.prototype.Xja=function(za,Mb,hc,cc){Mb=(void 0===cc?0:cc)?Ge.a.OX:Mb;this.oj.P_(za,Mb)&&this.ii.zN(za,Mb,hc)};Object(bb.a)(v,"RichApiEventSheetActivatedDeactivatedHandler",null,[]);var uc=
b(177),ed=b(12),Cd=b(226),$d=Sys.EventArgs;Am(y,$d);Object(bb.a)(y,"ClickInActiveCellEventArgs",Sys.EventArgs,[]);B.prototype.dispose=function(){this.TUj()};B.prototype.Fdj=function(){for(var za=Cl(this.gridView.zn),Mb=za.next();!Mb.done;Mb=za.next())Mb=Mb.value.domElement,uc.a.instance.qa(ed.a.pointerDown,Mb,this.onPointerDown),Cd.a.instance.qa(ed.a.click,Mb,this.dd)};B.prototype.TUj=function(){for(var za=Cl(this.gridView.zn),Mb=za.next();!Mb.done;Mb=za.next())Mb=Mb.value.domElement,uc.a.instance.za(ed.a.pointerDown,
Mb,this.onPointerDown),Cd.a.instance.za(ed.a.click,Mb,this.dd)};B.prototype.c_i=function(za){var Mb=za.sheet;if(this.P8a(Mb)){var hc={};hc.worksheetId=Mb.sheetId;hc.address=za.MZg.toString();hc.offsetX=za.offsetX;hc.offsetY=za.offsetY;za=Mb.sheetId;this.oj.P_(21,za)&&(Mb=Ud.a.Kc(hc),this.ii.zN(21,za,Mb));za=Ge.a.OX;this.oj.P_(21,za)&&(hc=Ud.a.Kc(hc),this.ii.zN(21,za,hc))}};B.prototype.P8a=function(za){return!!za&&0===za.fJ};Object(bb.a)(B,"RichApiEventSingleClickedHandler",null,[]);r.prototype.U1b=
function(za){2E3===za.messageType&&(1===za.actionType?(this.NIb||Xb.g(this.$).ga.Pa.EXc(this.KIf),this.NIb++,this.Nuj()):2===za.actionType&&this.NIb&&(1===this.NIb&&Xb.g(this.$).ga.Pa.rMd(this.KIf),this.NIb--))};r.prototype.Udd=function(za){var Mb,hc={};hc.worksheetId=za;hc.revisionLoad=!1;if(hb.EwaSettings.isChangeGateEnabled("OfficeVSO:5509495_SelectedVisualIdVisualSelectionChangedEventArgs")&&(hb.EwaSettings.ma(738)||hb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartBRSChartPlayerManualPlacement",
!1))){var cc=Xb.g(this.$).ga.Pa.VC;(null===(Mb=null===cc||void 0===cc?void 0:cc.floatingObject)||void 0===Mb?0:Mb.Zc)?hc.selectedVisualId=cc.floatingObject.Zc.VisualID:hc.selectedVisualId=null}Mb=Ud.a.Kc(hc);za&&this.oj.P_(2E3,za)&&this.ii.zN(2E3,za,Mb)};r.prototype.ska=function(){var za=this.$.xa.oa;return za&&0===za.fJ?za.sheetId:null};r.prototype.Nuj=function(){var za=Xb.g(this.$).ga.Pa.VC;this.omf(za)&&(this.xbb=za.floatingObject.id,this.qbb=this.ska())};r.prototype.omf=function(za){return!!za&&
za.Nud()};Object(bb.a)(r,"RichApiEventVisualSelectionChangedHandler",null,[]);w.prototype.kQg=function(za){1===za.actionType?(this.OIb||this.EQg(),this.OIb++):2!==za.actionType||1>this.OIb||(1===this.OIb&&this.lih(),this.OIb--)};w.prototype.EQg=function(){if(this.oj.P_(2203,Ge.a.OX))if(this.ttd){var za={};za.timeout=this.$.ya.CheckFocusTimeout;this.ibc=window.requestIdleCallback(this.UBe,za)}else this.ibc=window.setInterval(this.TBe,this.$.ya.CheckFocusTimeInterval)};w.prototype.lih=function(){this.ttd?
window.cancelIdleCallback(this.ibc):window.clearInterval(this.ibc)};Object(bb.a)(w,"RichApiEventWorkbookActivatedHandler",null,[]);var La;(function(za){za[za.none=0]="none";za[za.registerEvent=1]="registerEvent";za[za.unregisterEvent=2]="unregisterEvent";za[za.customFunction=3]="customFunction";za[za.showCard=4]="showCard";za[za.createWorkbook=5]="createWorkbook";za[za.openWorkbook=6]="openWorkbook";za[za.enableEvents=7]="enableEvents";za[za.closeWorkbook=8]="closeWorkbook";za[za.setCalculationMode=
9]="setCalculationMode";za[za.workbookLinksRequestRefresh=10]="workbookLinksRequestRefresh";za[za.workbookLinksRequestRefreshAll=11]="workbookLinksRequestRefreshAll";za[za.workbookLinksEnableContent=12]="workbookLinksEnableContent";za[za.workbookLinksFindNextLink=13]="workbookLinksFindNextLink";za[za.workbookLinksOpenWorkbook=14]="workbookLinksOpenWorkbook";za[za.rangePicker=15]="rangePicker";za[za.enableRichApiRecording=16]="enableRichApiRecording";za[za.recordAction=17]="recordAction";za[za.focus=
18]="focus";za[za.businessBarShow=19]="businessBarShow";za[za.businessBarHide=20]="businessBarHide"})(La||(La={}));Object(bb.b)("PostProcessActionType",La);var od=b(243);u.prototype.jQg=function(za){1===za.actionType?(this.$.lca=!0,Object(nc.a)(b(947).DdaFacade,od.a(this.$)).Tdd(!0)):2===za.actionType&&(this.$.lca=!1);this.DJf=za.controlId;xa.ULS.sendTraceTag(537170456,0,50,"AttachOrDetachMacroRecorderEventHandler: actionType: {0}; controlId: {1}; this.ewaControl.IsMacroRecorderListening: {2}.",La[za.actionType],
this.DJf,this.$.lca)};u.prototype.gqh=function(za){Object(nc.a)(b(947).DdaFacade,od.a(this.$)).PXe(za,this.$.lca)};u.prototype.Zfi=function(){var za=this;this.$.pca&&va.TaskExtensions.Ba(Uc.GetServiceTaskFactory.Ua(this.$.da,297,298,1),function(Mb){(Mb=Mb.result)&&Mb.init(za.Sdd)},this.$.la,3)};Object(bb.a)(u,"RichApiMacroRecorderEventHandler",null,[]);Object(bb.a)(h,"SessionRecreationInfo",null,[]);n.prototype.SHi=function(){return hb.EwaSettings.ma(260)?this.oj.U$h()||0!==this.runtimeCalculationMode:
!1};n.prototype.vVg=function(){var za={};za.eventRegistrationInfos=this.oj.aUh();za.runtimeCalculationMode=this.runtimeCalculationMode;za=Object.assign(new h,{runtimeState:za});var Mb={HttpMethod:"POST",PathAndQuery:"RestoreRuntimeState",RequestHeaders:null};Mb.RequestBody=JSON.stringify(za);Mb.RequestFlags=1;return Mb};Object(bb.a)(n,"RichApiRuntimeStateHandler",null,[]);Object(bb.a)(m,"UserOperationQueueItemsStatisticsData",null,[]);var ne=b(341),qd=b(30),He=b(17),Ue=b(305),zf=b(47),Hf=b(655),De=
b(62),Ae=b(58),yd=b(71),je=ne.a;Am(l,je);l.prototype.dispose=function(){this.$&&(this.$.xa.vG(this.Io),this.$.Ab.vG(this.Io),this.$.Ab.Ag(this.Ie),this.$.xa.Ag(this.Ie));this.JVa&&(this.JVa.Jp(this.Xe),this.JVa.MI(this.Rm),this.JVa.ar(this.Qg));hb.EwaSettings.uc()&&this.Nt(this.Aza);this.clearCache();rc.a.Fa(this.JVa);this.JVa=null;Ob.DOMElementExtensions.vf(this.domElement);je.prototype.dispose.call(this)};l.prototype.Fuj=function(za){Ob.DOMElementExtensions.vf(Ob.DOMElementExtensions.getElementById(this.domElement,
za.id));this.domElement.appendChild(za)};l.prototype.$od=function(){if(this.Rwa&&!this.r5b){var za=Object(nc.a)(b(947).DdaFacade,od.a(this.$)).nn(this.Rwa.InstanceId);za&&(za.resize(this.Rwa.Width,this.Rwa.Height),za.ka(this.domElement),za.showHide(!0),this.r5b=!0)}};l.prototype.R8a=function(){return!0};l.prototype.Hoa=function(za){this.Rwa=za.gd.block.ye;this.r5b=!1;this.$od()};l.prototype.$Ua=function(za){this.$.ea.O_&&za&&(za.Ou||(za.Ou=new Ue.a),za.Ou.Ng=new zf.a(this.domElement.scrollLeft,this.domElement.scrollTop),
za.Ou.CHb=20)};l.prototype.clearCache=function(){this.Da.SAa(this.hashCode);this.Rwa=this.hashCode=null;this.r5b=!1};l.prototype.ZTa=function(za,Mb){if(this.isVisible=!!za&&De.p(za))this.hashCode=this.Da.Gha(za,Ae.a.Etb,this.hashCode),this.Pyc(Mb)};l.uHa=function(za){if(!za.da.Aa(34)){var Mb=za.zf;za.da.Ha(34,new l(za,new Hf.a(za,za.ea,za.na.Ok,3,0),Mb.appendChild(Mb.ownerDocument.createElement("div"))))}};uk.Object.defineProperties(l.prototype,{Da:{configurable:!0,enumerable:!0,get:function(){return this.JVa}}});
Object(bb.a)(l,"WebExtensionView",ne.a,[987,450,3]);var we=b(227),Bc=b(561),Od=b(387),ae=b(466),Ad=b(173),Ve=b(83),kf=b(118),Fc=b(46),fd=b(43),jd=b(157),zd=b(110),zc=b(68),$e=b(27),Xe=b(29),pe=b(289),Jf=b(21),kc=b(14),$c=b(288),rd=b(951),me=b(49),te=b(153),ge=b(1187),pd=b(202),jc=b(1083),jf=b(26);b.d(F,"DdaFacade",function(){return a});var dc=gc.a;Am(a,dc);a.prototype.Uqe=function(za){this.addHandler("cd",za)};a.prototype.hgj=function(za){this.removeHandler("cd",za)};a.prototype.Vqe=function(za){this.addHandler("csc",
za)};a.prototype.Quc=function(za){this.removeHandler("csc",za)};a.prototype.rIg=function(za){this.addHandler("ca",za)};a.prototype.ggj=function(za){this.removeHandler("ca",za)};a.prototype.sIg=function(za){this.addHandler("ci",za)};a.prototype.tIg=function(za){this.addHandler("ekros",za)};a.prototype.igj=function(za){this.removeHandler("ekros",za)};a.prototype.qGd=function(za,Mb){try{return JSON.parse(za)[Mb].toLowerCase()}catch(hc){return""}};a.prototype.kBj=function(za){var Mb=this.qGd(za,"AudienceGroup"),
hc=this.qGd(za,"SessionOrigin");try{var cc=parseInt(this.qGd(za,"Ring"),10);if("automation"!==Mb&&"bluechicken"!==hc&&-2<=cc)return!0}catch(Ec){if("automation"!==Mb&&"bluechicken"!==hc)return!0}return!1};a.prototype.m2b=function(za){var Mb={};Mb.Name=za.Name;Mb.BindingType=za.BindingType;Mb.HasHeaders=za.HasHeaders;za.IsValidRef&&(Mb.ColCount=za.Reference.LastColumn-za.Reference.FirstColumn+1,Mb.RowCount=za.Reference.LastRow-za.Reference.FirstRow+1);return Mb};a.prototype.xwi=function(za,Mb){this.an.launchInsertDialog(za,
null,this.zUg(Mb))};a.prototype.Jda=function(za,Mb){var hc={};hc.callbackFunc=za;hc.storeType=OSF.StoreTypeEnum.MarketPlace;hc.fromInsertDialog=!1;hc.refresh=Mb;this.an.queryEntitlementDetails(hc)};a.prototype.invokeDdaMethod=function(za,Mb){var hc=this.nn(za.DdaMethod.ControlId);hc?hc.invokeDdaMethod(za,Mb):this.Bf(ua.a.internalError,Mb)};a.prototype.registerDdaEventAsync=function(za,Mb,hc,cc,Ec){(Mb=this.nn(Mb))?a.DAb(za)?Mb.icj(za,hc,cc,Ec):this.Bf(ua.a.IFd,Ec):this.Bf(ua.a.internalError,Ec)};
a.prototype.unregisterDdaEventAsync=function(za,Mb,hc,cc,Ec){(Mb=this.nn(Mb))?a.DAb(za)?Mb.yUj(za,hc,cc,Ec):this.Bf(ua.a.IFd,Ec):this.Bf(ua.a.internalError,Ec)};a.prototype.dispose=function(){this.disposed||(this.$.Bl(this.vd),this.ea.tk(this.fd),this.ea.DX(this.Yq),this.ea.jx(this.Tf),this.HYc.detach(this),this.$.userOperationManager.dr(this.GS),this.crc=this.Jf=this.ii=this.HYc=this.wb=null,this.SJa&&(this.SJa.dispose(),this.SJa=null),rc.a.Fa(this.bPd),rc.a.Fa(this.aPd),this.A2a&&(this.A2a.dispose(),
this.A2a=null),dc.prototype.dispose.call(this),this.disposed=!0,xa.ULS.sendTraceTag(537170583,0,50,"DdaFacade is disposed"))};a.prototype.Kcc=function(za){return(za=this.nn(za))?za.getDefaultIconUrl():null};a.prototype.jyc=function(za){if(this.wJe!==za){this.wJe=za;for(var Mb=0,hc=this.Jf.length;Mb<hc;Mb++){var cc=this.Jf[Mb];za?cc.OLe(!1):cc.Woh()}this.bPd.jyc(za);this.aPd.jyc(za)}};a.prototype.MSh=function(za){return(za=this.nn(za))?za.getDefaultDisplayName():null};a.prototype.Bf=function(za,Mb,
hc){var cc={};cc[ma.a.Gg]=za;cc[ma.a.t4]=Mb;this.PK(451041795,cc,void 0===hc?!0:hc)};a.prototype.mv=function(za){var Mb={};Mb[ma.a.t4]=za;this.PK(1237877382,Mb)};a.prototype.PK=function(za,Mb,hc){var cc=this;hc=void 0===hc?!0:hc;var Ec=new hd.a(za,0,this.$.jd,0,null),Lc=Mb?Mb[ma.a.t4]:null;this.A2a&&Xb.g(this.$).isEditing&&J.E3g(za,Mb)?this.A2a.dhh(za,Mb):(za=this.$.Ka.dc(Ec,Mb),hc&&va.TaskExtensions.Ba(za,function(he){jd.a(he)?cc.Bf(ua.a.internalError,Lc,!1):he.result||(Xb.g(cc.$).isEditing?cc.Bf(ua.a.Wzb,
Lc,!1):cc.Bf(ua.a.internalError,Lc,!1))},this.la,8))};a.prototype.e6g=function(za){var Mb=this;return!!this.Wja(function(hc){return a.getSolutionId(hc.rl,Mb.$)===a.getSolutionId(za,Mb.$)&&hc.rl.PrimaryMarketplace.MarketplaceType===za.PrimaryMarketplace.MarketplaceType&&hc.rl.PrimaryMarketplace.MarketplaceRef===za.PrimaryMarketplace.MarketplaceRef&&hc.rl.PrimaryMarketplace.SolutionVersion===za.PrimaryMarketplace.SolutionVersion})};a.prototype.nn=function(za){return this.Wja(function(Mb){return Mb.controlId.startsWith(za)})};
a.prototype.hHh=function(za){return this.Wja(function(Mb){return Mb.cJa===za})};a.prototype.kXe=function(za){return this.Wja(function(Mb){return Mb.mV===za&&!!Mb.cJa})};a.prototype.EXe=function(za,Mb,hc,cc){return this.Wja(function(Ec){return Ec.mV===za&&Ec.rl.PrimaryMarketplace.MarketplaceRef.toLowerCase()===Mb.toLowerCase()&&Ec.rl.PrimaryMarketplace.MarketplaceType.toLowerCase()===hc.toLowerCase()&&!!Ec.rl.SharedRuntime&&!!Ec.rl.SharedRuntime.Resid&&!!cc&&!!cc.Resid&&Ec.rl.SharedRuntime.Resid.toLowerCase()===
cc.Resid.toLowerCase()})};a.prototype.XPg=function(za,Mb){if(za=this.nn(za))za.ka(Mb),za.showHide(!0)};a.prototype.DFj=function(za){(za=this.nn(za))&&za.showHide(!1)};a.prototype.b2a=function(za){var Mb;if(1!==za.WebExtensionType||this.$.Dd&8388608&&za.TaskpaneVisible||this.$.Dd&8388608&&!za.TaskpaneVisible&&Ac.HelperMethods.Mw(za)){var hc=null;Ac.HelperMethods.Mw(za)&&(hc=a.gwa(za,this.$),za.TaskpaneWidth||(za.TaskpaneWidth=this.J7b));var cc=(new U(this,this.ii,za)).Mod();xa.ULS.sendTraceTag(51263011,
0,50,"DdaFacade::CreateOsfControl: SolutionId: {0}, StoreType: {1}, UseShareRuntime: {2}",Telemetry.PrivacyRules.GetPrivacyCompliantId(za.PrimaryMarketplace.SolutionId,za.PrimaryMarketplace.MarketplaceType,null===(Mb=za.AssetMarketplace)||void 0===Mb?void 0:Mb.SolutionId,null,null,za.PrimaryMarketplace.MarketplaceRef),za.PrimaryMarketplace.MarketplaceType,Ac.HelperMethods.Mw(za));hc&&(cc.cJa=hc);Array.add(this.Jf,cc);this.Aya=null;this.m7a(za.InstanceId)||(za=String.format("{0}|{1}|{2}|{3}|{4}",za.PrimaryMarketplace.SolutionId,
za.PrimaryMarketplace.SolutionVersion,za.PrimaryMarketplace.MarketplaceRef,za.PrimaryMarketplace.MarketplaceType,za.WebExtensionType),this.raiseEvent("ci",za))}};a.prototype.oHj=function(za,Mb){function hc(){cc.KRa(Lc.controlId);cc.Ni.purgeOsfControl(Lc.controlId,!1);Mb()}var cc=this;za.TaskpaneWidth=this.J7b;za.TaskpaneVisible=!0;var Ec={};Ec.SolutionId=za.PrimaryMarketplace.SolutionId;Ec.TargetType=za.WebExtensionType;Ec.Version=za.PrimaryMarketplace.SolutionVersion;Ec.StoreType=za.PrimaryMarketplace.MarketplaceType;
Ec.StoreId=za.PrimaryMarketplace.MarketplaceRef;Ec.AssetId=za.PrimaryMarketplace.SolutionId;Ec.AssetStoreId=za.PrimaryMarketplace.MarketplaceRef;Ec.Width=za.TaskpaneWidth;var Lc=new U(this,this.ii,za,!0);Lc.Mod();Array.add(this.Jf,Lc);var he=null;he=Fc.a.instance.RC(function(){Lc.Iy&&(rc.a.Fa(he),he=null,cc.Ni.insertBlankControlWithErrorUX(cc.IHb(Lc,Ec),hc))},100,fd.a.Vfh)};a.prototype.R9g=function(za){var Mb=this;if(za&&za.length){var hc=[];za.forEach(function(cc){if(cc.ContainsCustomFunctions){var Ec=
a.gwa(cc,Mb.$);Mb.MGd.contains(Ec)||(Mb.MGd.add(Ec),Array.add(Mb.UKf,cc));Mb.e6g(cc)||Array.add(hc,cc)}});hc.length&&this.KGe(hc)}};a.prototype.DIe=function(za,Mb){this.nn(za.InstanceId)||(Mb=Mb(),za=(new U(this,this.ii,za)).Fdf(Mb),Array.add(this.Jf,za),this.Aya=null)};a.prototype.XEj=function(za){a.t2a.xb(za)&&a.t2a.pa(za).initializeAndShowWithTitle()};a.prototype.Pai=function(za){a.t2a.xb(za)&&a.t2a.pa(za).hide()};a.prototype.BZh=function(za){var Mb=this,hc=null,cc,Ec=null;var Lc=a.Vkd(za,!0);
if(!Lc)return xa.ULS.sendTraceTag(537170570,0,10,"DdaFacade.GetOrCreateCustomFunctionSandboxAsync: webextension data is null"),vd.Task.Sa(null);(cc=this.an.getOsfControl(a.getSolutionId(Lc,this.$)))&&(hc=cc.getManifest())&&(Ec=hc.getSharedRuntimeForCustomFunctions("Workbook"));if(hc=Ec&&1===Ec.LifeTime?this.EXe(Lc.PrimaryMarketplace.SolutionId,Lc.PrimaryMarketplace.MarketplaceRef,Lc.PrimaryMarketplace.MarketplaceType,Ec):this.hHh(za))return vd.Task.Sa(hc.controlId);var he=new tb.a;Ac.HelperMethods.Dkc(Ec)&&
(Lc.SharedRuntime=Ec);za=cc?cc.getNotificationParams():[];if(!za.length)return this.kHe(Lc);this.h7f(za,function(){va.TaskExtensions.Ba(he.task,function(){Mb.kHe(Lc)},Mb.la,3)},function(){});return he.task};a.prototype.RNh=function(za){za=a.Vkd(za,!1);if(!za)return xa.ULS.sendTraceTag(537170569,0,10,"DdaFacade.GetAddinCommandSandbox: webextension data is null"),null;var Mb=null,hc=this.an.getOsfControl(a.getSolutionId(za,this.$));hc&&(hc=hc.getManifest())&&(Mb=hc.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"));
return Ac.HelperMethods.Dkc(Mb)&&(za=this.EXe(za.PrimaryMarketplace.SolutionId,za.PrimaryMarketplace.MarketplaceRef,za.PrimaryMarketplace.MarketplaceType,Mb))?za.controlId:null};a.prototype.n8g=function(za,Mb){var hc=this,cc=a.Vkd(za,!1);if(cc){var Ec=null,Lc=this.an.getOsfControl(a.getSolutionId(cc,this.$));Lc&&(Lc=Lc.getManifest())&&(Ec=Lc.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"));if(Ac.HelperMethods.Dkc(Ec)){cc.SharedRuntime=Ec;var he=cc.PrimaryMarketplace.SolutionId;Lc=cc.PrimaryMarketplace.SolutionVersion;
var qe=OSF.OsfManifestManager.getCachedManifest(he,Lc);if(qe)if(this.w0b.xb(za))Ec=this.w0b.pa(za),va.TaskExtensions.Ba(Ec,function(fc){(fc=fc.result)&&OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(fc,Mb,hc.ii.dLb)},this.la,3);else{var Af={solutionId:he,version:Lc};Af.storeType=cc.PrimaryMarketplace.MarketplaceType;Af.storeId=cc.PrimaryMarketplace.MarketplaceRef;Af.assetId=he;Af.assetStoreId=null;Af.targetType=OSF.OsfControlTarget.TaskPane;var xf=new tb.a;cc=va.TaskExtensions.Dl();
cc=new Wc.a(this.$,this,Af,cc);Ec=OSF.OsfManifestManager.getSharedRuntimeManifestCacheKey(he,Ec.Resid);OfficeExt.AddinCommandsManifestManager.cacheManifestForAction(qe,Ec,Lc);cc.createUILessSandbox(Af,qe,function(fc,Gc){fc&&!Gc?(OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(fc,Mb,hc.ii.dLb),xf.setResult(fc)):xf.setResult(null);hc.w0b.remove(za)});this.w0b.ia(za,xf.task)}}}else xa.ULS.sendTraceTag(537170568,0,10,"DdaFacade.CreateAddinCommandSandboxAsync: webextension data is null")};
a.prototype.FBe=function(za){(za=this.kXe(za))&&(za.rl.SharedRuntime||this.VIb(za.controlId))};a.prototype.VIb=function(za){(za=this.kXe(za))&&this.KRa(za.controlId)};a.prototype.jlh=function(za,Mb){if(!this.Jf||!za||!Mb)return!1;if(za.toLowerCase()===Mb.toLowerCase())return!0;for(var hc=null,cc=null,Ec=0,Lc=this.Jf.length;Ec<Lc;Ec++){var he=this.Jf[Ec];if(he.ownerAddinSolutionId&&(he.controlId===za&&(hc=he.ownerAddinSolutionId.toLowerCase()),he.controlId===Mb&&(cc=he.ownerAddinSolutionId.toLowerCase()),
hc&&cc))break}return hc&&hc===cc?!0:!1};a.prototype.YFg=function(za){this.nn(za.InstanceId)||(za=new U(this,this.ii,za),Array.add(this.Jf,za),this.Aya=null)};a.prototype.wTf=function(za){if(this.Jf&&0<=za&&za<this.Jf.length){var Mb=this.Jf[za],hc=Mb.Iy;Array.removeAt(this.Jf,za);this.pAf(Mb);Ob.DOMElementExtensions.vf(hc)}};a.prototype.KRa=function(za){if(this.Jf)for(var Mb=0,hc=this.Jf.length;Mb<hc;Mb++)if(this.Jf[Mb].controlId===za){this.wTf(Mb);break}};a.prototype.ifj=function(za){if(this.Jf){za=
za.toLowerCase();for(var Mb=0,hc=this.Jf.length;Mb<hc;Mb++)if(za===this.Jf[Mb].ownerAddinSolutionId.toLowerCase()){this.wTf(Mb);break}}};a.prototype.DQg=function(za){za.un&&(this.nn(za.floatingObject.rl.InstanceId)||(this.yhc(za.floatingObject.rl.InstanceId)||Array.add(this.crc,za.floatingObject.rl.InstanceId),this.b2a(za.floatingObject.rl)),this.ea.isNamedObjectViewMode&&this.XPg(za.floatingObject.rl.InstanceId,za.Sd))};a.prototype.nba=function(za){if(this.Jf)for(var Mb=0,hc=this.Jf.length;Mb<hc;Mb++)if(1===
this.Jf[Mb].controlType&&Jf.a.equals(this.Jf[Mb].mV,za,!0))return this.Jf[Mb].controlId;return null};a.prototype.HGh=function(za){var Mb=[];if(this.Jf)for(var hc=0,cc=this.Jf.length;hc<cc;hc++)Jf.a.equals(this.Jf[hc].mV,za,!0)&&Mb.push(this.Jf[hc].controlId);return Mb};a.prototype.oHh=function(za,Mb){if(!Mb||!za)return null;if(this.Jf)for(var hc=0,cc=this.Jf.length;hc<cc;hc++)if(1===this.Jf[hc].controlType&&Jf.a.equals(this.Jf[hc].mV,za,!0)&&this.Jf[hc].rl.SharedRuntime&&Jf.a.equals(this.Jf[hc].rl.SharedRuntime.Resid,
Mb.Resid,!0))return this.Jf[hc].controlId;return null};a.prototype.E4a=function(za,Mb){Mb=void 0===Mb?null:Mb;return za?Mb?String.format("{0}.{1}",za,Mb):za:""};a.prototype.IBe=function(za,Mb,hc){if(this.Aya===za)return!0;this.Aya=za;var cc=null,Ec=!1;if(!cc&&this.Jf)for(var Lc=0,he=this.Jf.length;Lc<he;Lc++)if(1===this.Jf[Lc].controlType&&Jf.a.equals(this.Jf[Lc].mV,za,!0)){var qe=!1,Af=!1;Mb?(qe=!0,Af=!!this.Jf[Lc].rl.SharedRuntime&&Jf.a.equals(this.Jf[Lc].rl.SharedRuntime.Resid,Mb.Resid,!0)):hc&&
(qe=!0,Af=Jf.a.equals(this.Jf[Lc].rl.SharedRuntimeId,hc,!0));if(!qe||Af){Af&&this.Jf[Lc].Uf(!0);cc=this.Jf[Lc].controlId;Ec=!0;this.Aya=null;break}}cc&&this.raiseEvent("ca",cc);return Ec};a.prototype.setAppRuntimeState=function(za,Mb){var hc;if(za){var cc=this.nn(za);if(cc&&Ac.HelperMethods.Mw(cc.rl))cc.Uf(Mb),Mb&&(this.raiseEvent("ca",za),(null===(hc=cc.Iy)||void 0===hc?0:hc.firstChild)&&(za=cc.Iy.firstChild.title)&&0<za.length&&this.E1b.Esj(za));else throw xa.ULS.sendTraceTag(537170565,0,50,"SetAppRuntimeState: run on non-shared runtime app."),
Error.invalidOperation(kc.a.instance.fa(2182));}else throw xa.ULS.sendTraceTag(537170564,0,15,"SetAppRuntimeState: Invalid controlId."),Error.invalidOperation(kc.a.instance.fa(2183));};a.prototype.getAppRuntimeState=function(za){if(za)if((za=this.nn(za))&&Ac.HelperMethods.Mw(za.rl))za=za.rl.TaskpaneVisible;else throw xa.ULS.sendTraceTag(537170563,0,50,"GetAppRuntimeState: run on non-shared runtime app."),Error.invalidOperation(kc.a.instance.fa(2182));else throw xa.ULS.sendTraceTag(537170562,0,15,
"GetAppRuntimeState: Invalid controlId."),Error.invalidOperation(kc.a.instance.fa(2183));return za};a.prototype.$3a=function(za,Mb){return(za=this.nn(za))?za.$3a(Mb):null};a.prototype.m7a=function(za){return this.KBe(this.crc,za)};a.prototype.yhc=function(za){return this.KBe(this.rJe,za)};a.prototype.kpe=function(za){Array.add(this.rJe,za)};a.prototype.j_=function(za){return(za=this.nn(za))?za.rl:null};a.prototype.yBd=function(za){this.raiseEvent("ekros",za,this)};a.prototype.mFd=function(za){if(za){var Mb=
this.nn(za.InstanceId);Mb&&(za.SharedRuntime||za.SharedRuntimeId||(this.KRa(Mb.controlId),this.Ni.purgeOsfControl(Mb.controlId,!1)),Mb={},Mb.SolutionId=za.PrimaryMarketplace.SolutionId,Mb.TargetType=za.WebExtensionType,Mb.Version=za.PrimaryMarketplace.SolutionVersion,Mb.StoreType=za.PrimaryMarketplace.MarketplaceType,Mb.StoreId=za.PrimaryMarketplace.MarketplaceRef,Mb.AssetId=za.PrimaryMarketplace.SolutionId,Mb.AssetStoreId=za.PrimaryMarketplace.MarketplaceRef,Mb.Width=za.TaskpaneWidth,Mb.SharedRuntimeId=
za.SharedRuntimeId,this.Xdg(Mb))}};a.prototype.Cja=function(){this.ii.Cja()};a.prototype.zN=function(za,Mb,hc){this.ii.zN(za,Mb,hc)};a.prototype.Nsj=function(za,Mb){var hc=Array(2);hc[0]=Mb;hc[1]=null;this.ii.DHh(za,JSON.stringify(hc))};a.prototype.PXe=function(za,Mb){Mb=a.zch(Mb);za=this.j_(za);this.ii.Qac(za.InstanceId,2202,Ge.a.OX,Mb)};a.prototype.Tdd=function(za){for(var Mb=0,hc=this.Jf.length;Mb<hc;Mb++)this.PXe(this.Jf[Mb].controlId,za)};a.prototype.zHh=function(za,Mb){Mb=a.T8g(Mb);this.ii.Qac(za,
65539,"",Mb)};a.prototype.BHh=function(za,Mb,hc){this.ii.Qac(za,1,Mb,hc)};a.prototype.yHh=function(za,Mb){this.ii.CHh(za,Mb)};a.prototype.k8g=function(za,Mb){return[[2,1E3,"",JSON.stringify([za,Mb]),0,!1]]};a.prototype.qki=function(){return!!this.ioa&&this.ioa.W$e()};a.prototype.c1g=function(){this.ioa&&this.ioa.clear()};a.prototype.AHh=function(){if(this.ioa&&this.ioa.W$e()){var za=this.ioa.TNh();za=Cl(za);for(var Mb=za.next();!Mb.done;Mb=za.next()){Mb=this.HGh(Mb.value);Mb=Cl(Mb);for(var hc=Mb.next();!hc.done;hc=
Mb.next())this.ii.Qac(hc.value,65540,"","{}")}}};a.prototype.bcj=function(za){this.ioa.add(za)};a.prototype.uUj=function(za){this.ioa.remove(za)};a.prototype.Wja=function(za){if(!this.Jf)return null;for(var Mb=Cl(this.Jf),hc=Mb.next();!hc.done;hc=Mb.next())if(hc=hc.value,za(hc))return hc;return null};a.prototype.kHe=function(za){var Mb=this,hc=new tb.a,cc=a.gwa(za,this.$);if(Ac.HelperMethods.Mw(za))xa.ULS.sendTraceTag(537170531,0,50,"Shared runtime custom function agave is started."),this.RKf(za,
function(Lc){Lc?(za.InstanceId=Lc.InstanceId,za.WebExtensionOsfControlType=3,za.TaskpaneVisible=!1,Mb.b2a(za),hc.setResult(za.InstanceId)):(xa.ULS.sendTraceTag(537170530,0,10,"InsertAgaveTaskPane for customfunction: {0} failed",Telemetry.PrivacyRules.GetPrivacyCompliantId(za.PrimaryMarketplace.SolutionId,za.PrimaryMarketplace.MarketplaceType,null,null,null,za.PrimaryMarketplace.MarketplaceRef)),hc.setException(Error.create("Null insert data")))});else{a.t2a.ia(za.InstanceId,new yb.a);var Ec=a.t2a.pa(za.InstanceId).L2a;
this.Q9g(za,Ec,cc);this.RKf(za,null);hc.setResult(za.InstanceId)}return hc.task};a.prototype.Q9g=function(za,Mb,hc){this.nn(za.InstanceId)||(za=new U(this,this.ii,za),za.cJa=hc,za.Fdf(Mb),Array.add(this.Jf,za),this.Aya=null)};a.prototype.RKf=function(za,Mb){var hc=a.gwa(za,this.$);if(!this.MGd.contains(hc))this.jHb.push(za),1<=this.jHb.length&&this.SKf(za,Mb);else if(Mb){za=Cl(this.UKf);for(var cc=za.next();!cc.done;cc=za.next())if(cc=cc.value,a.gwa(cc,this.$)===hc){Mb(cc,0);break}}};a.prototype.SKf=
function(za,Mb){function hc(fc){fc&&!pe.a(fc)||xa.ULS.sendTraceTag(537170527,0,10,"InsertAgaveTaskPane for addin {0} finish with errors: {1}",Telemetry.PrivacyRules.GetPrivacyCompliantId(he.SolutionId,he.StoreType,he.AssetId,null,null,he.StoreId),Xe.a.Wc(fc.Errors));Ec.jHb.shift();0<Ec.jHb.length&&Ec.SKf(Ec.jHb[0],Mb)}function cc(fc){fc=kf.a.mg(fc.data);xa.ULS.sendTraceTag(537170528,0,10,"DdaFacade.CreateCustomFunctionSandbox failed on InsertAgaveTaskpane for persistenting CustomFunctions. errors: {0}",
Xe.a.Wc(fc))}var Ec=this,Lc=null,he={};he.SolutionId=a.getSolutionId(za,this.$);he.TargetType=za.WebExtensionType;he.Version=za.PrimaryMarketplace.SolutionVersion;he.StoreType=za.PrimaryMarketplace.MarketplaceType;he.StoreId=za.PrimaryMarketplace.MarketplaceRef;he.AssetId=za.PrimaryMarketplace.SolutionId;he.AssetStoreId=za.PrimaryMarketplace.MarketplaceRef;he.Width=za.TaskpaneWidth;he.ContainsCustomFunctions=!0;Ac.HelperMethods.Mw(za)&&(he.SharedRuntimeId=za.SharedRuntime.Resid);var qe=this.$.na.ta;
za=this.$.na.ta.fc();var Af=qe.Ma(9,za);Af.sharedInfo=he;if(Mb){var xf=function(fc){var Gc=fc.Result;(Lc=Gc?Gc.AgaveData:null)||Mb(null,fc.Errors?fc.Errors[0].ErrorCause:5001);Mb(Lc,0)};za=function(fc,Gc,xd){return Ve.i(qe,"InsertAgaveTaskpane",Af,$c.b(fc,hc,xf),$c.a(Gc,cc),xd,null,0)}}else za=function(fc,Gc,xd){return Ve.i(qe,"InsertAgaveTaskpane",Af,$c.b(fc,hc),$c.a(Gc,cc),xd,null,0)};hb.EwaSettings.uc()?Od.a(this.$.userOperationManager,za,function(fc){return new Ad.a(519,0,fc,64)},null):Od.a(this.$.userOperationManager,
za,function(fc){return new Bc.a(519,0,fc)},null)};a.prototype.aCj=function(){return this.$.dg.get(35)};a.prototype.$Ld=function(za){za=this.nn(za);(null===za||void 0===za?0:za.pea)&&za.FTf()};a.prototype.fJi=function(za){var Mb=this.Wja(function(hc){return a.kNa(hc.mV)});Mb&&(Mb=this.Ni.getOsfControl(Mb.controlId))&&Mb.notifyAgave(OSF.AgaveHostAction.SendMessage,za)};a.prototype.cli=function(){return!!this.Wja(function(za){return 1===za.controlType&&a.kNa(za.mV)})};a.prototype.bli=function(){var za=
this.Wja(function(Mb){return a.kNa(Mb.mV)});return za?za.Iy?Ob.DOMElementExtensions.isVisible(za.Iy):!1:!1};a.prototype.Evj=function(){var za=this.Wja(function(Mb){return a.kNa(Mb.mV)});za&&(za.Uf(!0),this.raiseEvent("ca",za.controlId))};a.prototype.initialize=function(){var za=b(1410).DdaEventDispatch,Mb=void 0===this.$||null===this.$||hb.EwaSettings.ma(260);void 0!==this.$&&null!==this.$||xa.ULS.sendTraceTag(537170525,0,50,"VSO#2693929: Initialize is called. EwaControl is null");Mb&&xa.ULS.sendTraceTag(537170524,
0,50,"VSO#2693929: Initialize is called. this.initialized is "+this.initialized);this.initialized||(l.uHa(this.$),this.ea=this.$.ea,this.ii=new za(this.$),this.$.fl(this.vd),this.ea.ek(this.fd),this.ea.xQ(this.Yq),this.ea.Yt(this.Tf),this.$.userOperationManager.Xu(this.GS),this.bpf(),this.GTi(),this.mfi(),this.$.da.Ha(35,this),this.HYc.ka(this),Mb&&xa.ULS.sendTraceTag(537170522,0,50,"VSO#2693929: SessionIdChanged event is registered"),this.aje=new Ge.a,Mb&&xa.ULS.sendTraceTag(537170521,0,50,"VSO#2693929: RichApiEventRegistration is constructed"),
this.dje=new v(this.$,this.oj,this.ii),this.czg=new B(this.$,this.oj,this.ii),this.bje=new E(this.$,this.oj,this.ii),this.$ie=new t(this.$,this.oj,this.ii),this.Zie=new C(this.$,this.oj,this.ii),this.cje=new A(this.$,this.oj,this.ii),this.eje=new r(this.$,this.oj,this.ii),this.fje=new w(this.$,this.oj,this.ii),this.$.pca&&(this.gje=new u(this.$,this.oj,this.ii)),hb.EwaSettings.ma(191)&&(this.A2a=new J(this,Xb.g(this.$))),hb.EwaSettings.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled")&&
(this.Yie=new H),this.initialized=!0,xa.ULS.sendTraceTag(537170520,0,50,"DdaFacade is initialized"))};a.prototype.uHh=function(za){if(!this.aDa)return null;for(var Mb=0,hc=this.aDa.length;Mb<hc;Mb++)if(za.startsWith(this.aDa[Mb].WebExtensionId))return this.aDa[Mb];return null};a.prototype.bpf=function(){var za,Mb=this.ea;if(Mb.sc&&!this.JQb){if(Mb.workbookContext){if(this.EVc=this.$.ea.ah.get(22),null===(za=Mb.workbookContext.WebExtensions)||void 0===za?0:za.length){za=Mb.workbookContext.WebExtensions;
Mb=!1;for(var hc={},cc=za.length-1;0<=cc;hc={cRb:hc.cRb},cc--){if(!this.ea.isNamedObjectViewMode){Array.add(this.crc,za[cc].InstanceId);if(1!==za[cc].WebExtensionType){Array.removeAt(za,cc);continue}if(Ac.HelperMethods.Mw(za[cc])&&0!==za[cc].SharedRuntime.State)1===za[cc].SharedRuntime.State?za[cc].TaskpaneVisible=!1:2===za[cc].SharedRuntime.State?za[cc].TaskpaneVisible=!0:xa.ULS.sendTraceTag(537170519,0,10,"The sharedRuntime state is invalid");else if(!za[cc].ContainsCustomFunctions&&!za[cc].TaskpaneVisible&&
!fb.a(za[cc])){Array.removeAt(za,cc);continue}}var Ec=OSF.OsfControl.isFirstPartyStoreString(za[cc].PrimaryMarketplace.MarketplaceType);hb.EwaSettings.ma(187)&&!Ec&&(Array.removeAt(za,cc),Mb||(Mb=!0,hc.cRb=Uc.GetServiceTaskFactory.Ua(this.$.da,5,4,3),va.TaskExtensions.Ba(hc.cRb,function(Lc){return function(){Lc.cRb.result.lg(35,null)}}(hc),this.la,3)));hb.EwaSettings.isChangeGateEnabled("OfficeVSO:3937070_RemoveChartTaskPaneExtensionDuringLoad")&&za[cc].PrimaryMarketplace&&a.kNa(za[cc].PrimaryMarketplace.SolutionId)&&
(xa.ULS.sendTraceTag(537170518,0,50,"chart task pane info stored in workbook context webextensions"),Array.removeAt(za,cc))}this.KGe(za)}}else this.EVc=!1;this.JQb=!0}};a.prototype.u9e=function(za){var Mb=Xb.g(this.$),hc=Mb.ga.Pa.nc;if(hc&&za){za=!1;if(this.Jf)for(var cc=Cl(this.Jf),Ec=cc.next();!Ec.done;Ec=cc.next())if(Ec=Ec.value,a.kNa(Ec.mV)||a.coi(Ec.mV)){za=!0;break}za||Mb.ga.Pa.DH(hc)}};a.prototype.GTi=function(){this.Ni&&this.ea.isNamedObjectViewMode&&this.$.oa&&De.p(this.$.oa)&&(this.$.da.Aa(34).bS?
this.$.da.Aa(34).$od():this.$.da.Aa(34).yr(this.HZi))};a.prototype.KGe=function(za){var Mb=this,hc=null;hc=function(Lc){function he(){Mb.GQa.shift();0<Mb.GQa.length&&hc(Mb.GQa[0])}var qe=Lc.WebExtensionData,Af=Lc.IsTaskPane,xf=Lc.RecordHandler;if(Mb.nba(qe.PrimaryMarketplace.SolutionId))he();else{Af&&(qe.WebExtensionOsfControlType=1);var fc=fb.a(qe);if(!Af||qe.TaskpaneVisible||fc||qe.SharedRuntime&&0!==qe.SharedRuntime.State||qe.ContainsCustomFunctions){var Gc=new U(Mb,Mb.ii,qe,!Af);xa.ULS.sendTraceTag(537170517,
0,50,"DdaFacade::CreateAllOsfControls: SolutionId: {0}, StoreType: {1}, UseShareRuntime: {2}",Telemetry.PrivacyRules.GetPrivacyCompliantId(qe.PrimaryMarketplace.SolutionId,qe.PrimaryMarketplace.MarketplaceType,null,null,null,qe.PrimaryMarketplace.MarketplaceRef),qe.PrimaryMarketplace.MarketplaceType,Ac.HelperMethods.Mw(qe));Gc.Mod();Ac.HelperMethods.Mw(qe)&&(Gc.cJa=a.gwa(qe,Mb.$),qe.TaskpaneWidth=Mb.J7b);fc&&(qe.WebExtensionToolTip="");Af&&qe.TaskpaneVisible&&!fc&&(qe.TaskpaneWidth=Mb.J7b);Array.add(Mb.Jf,
Gc);var xd=Mb.Aya=null;xd=Fc.a.instance.RC(function(){Gc.Iy&&(rc.a.Fa(xd),xd=null,xf&&xf(Lc,Gc),he())},100,fd.a.Ufh)}else he()}};for(var cc={},Ec=0;Ec<za.length;cc={j2:cc.j2},Ec++)if(!this.nn(za[Ec].InstanceId))if(1!==za[Ec].WebExtensionType)this.b2a(za[Ec]);else if(!hb.EwaSettings.ma(54))this.tob(za[Ec],hc);else if(this.$.Dd&8388608||za[Ec].TaskpaneVisible)cc.j2={},cc.j2.marketplaceId=za[Ec].PrimaryMarketplace.SolutionId,cc.j2.marketplaceVersion=za[Ec].PrimaryMarketplace.SolutionVersion,cc.j2.storeType=
za[Ec].PrimaryMarketplace.MarketplaceType,cc.j2.storeId=za[Ec].PrimaryMarketplace.MarketplaceRef,cc.j2.targetData=za[Ec],this.Ni.isAddinCommandsAsync(cc.j2,function(Lc){return function(he,qe,Af){if(he){var xf=Af.targetData;if(qe){if(hb.EwaSettings.ma(88))if(Lc.j2.storeType.toLowerCase()!==OSF.StoreType.OMEX.toLowerCase())he=Lc.j2.storeType.toLowerCase()===OSF.StoreType.UploadFileDevCatalog.toLowerCase(),qe=hb.EwaSettings.isChangeGateEnabled("OfficeVSO:4484894_FixBackgroundAppNotLoadForPrivateCatalog")&&
Lc.j2.storeType.toLowerCase()===OSF.StoreType.PrivateCatalog.toLowerCase(),(he||qe)&&Ac.HelperMethods.Mw(xf)&&Mb.tob(xf,hc);else if(hb.EwaSettings.isChangeGateEnabled("OfficeVSO:4484894_FixBackgroundAppNotLoadForUploadFileCatalog"))Mb.X8h(Af,hc);else{var fc=!1;Mb.Jda(function(Gc){if(!Gc.errorCode){if(Gc.value){Gc=Cl(Gc.value);for(var xd=Gc.next();!xd.done&&!fc;xd=Gc.next())fc=pd.c(xd.value[1])===pd.c(xf.PrimaryMarketplace.SolutionId)}fc?Ac.HelperMethods.Mw(xf)&&Mb.tob(xf,hc):(Gc={},Gc.SolutionId=
Af.marketplaceId,Gc.TargetType=xf.WebExtensionType,Gc.Version=Af.marketplaceVersion,Gc.StoreType=xf.PrimaryMarketplace.MarketplaceType,Gc.StoreId=Af.storeId,Gc.AssetId=Af.marketplaceId,Gc.AssetStoreId=Af.storeId,Gc.Width=xf.TaskpaneWidth,xf.TaskpaneVisible=!0,Mb.Xne(Gc,xf,hc))}},!0)}}else Mb.tob(xf,hc)}else he=Af.targetData,xa.ULS.sendTraceTag(542185164,220,15,"Judging AddinCommands failed for {0} from {1} during document loading",Telemetry.PrivacyRules.GetPrivacyCompliantId(he.PrimaryMarketplace.SolutionId,
he.PrimaryMarketplace.MarketplaceType,null,null,null,he.PrimaryMarketplace.MarketplaceRef),he.PrimaryMarketplace.MarketplaceType)}}(cc))};a.prototype.X8h=function(za,Mb){var hc=this,cc=!1;this.Jda(function(Ec){var Lc=za.targetData;if(!Ec.errorCode){if(Ec.value){Ec=Cl(Ec.value);for(var he=Ec.next();!he.done&&!cc;he=Ec.next())cc=pd.c(he.value[1])===pd.c(Lc.PrimaryMarketplace.SolutionId)}cc?Ac.HelperMethods.Mw(Lc)&&hc.tob(Lc,Mb):(Ec={},Ec.SolutionId=za.marketplaceId,Ec.TargetType=Lc.WebExtensionType,
Ec.Version=za.marketplaceVersion,Ec.StoreType=Lc.PrimaryMarketplace.MarketplaceType,Ec.StoreId=za.storeId,Ec.AssetId=za.marketplaceId,Ec.AssetStoreId=za.storeId,Ec.Width=Lc.TaskpaneWidth,Lc.TaskpaneVisible=!0,hc.Xne(Ec,Lc,Mb))}},!0)};a.prototype.tob=function(za,Mb){var hc={};hc.WebExtensionData=za;hc.IsTaskPane=!0;this.GQa.push(hc);1===this.GQa.length&&Mb(hc)};a.prototype.Xne=function(za,Mb,hc){var cc=this,Ec={};Ec.ActivationInfo=za;Ec.WebExtensionData=Mb;Ec.IsTaskPane=!1;Ec.RecordHandler=function(Lc,
he){var qe=Lc.ActivationInfo;cc.Ni.insertBlankControlWithErrorUX(cc.IHb(he,qe),function(){cc.KRa(he.controlId);cc.Ni.purgeOsfControl(he.controlId,!1);cc.Xdg(qe)})};this.GQa.push(Ec);1===this.GQa.length&&hc(Ec)};a.prototype.Xdg=function(za){var Mb={};Mb.solutionId=za.SolutionId;Mb.version=za.Version;Mb.storeType=za.StoreType;Mb.storeId=za.StoreId;Mb.assetId=za.AssetId;Mb.assetStoreId=za.AssetStoreId;Mb.targetType=za.TargetType;Mb.sharedRuntimeId=za.SharedRuntimeId;za=new Ub.a;za.add(Mb);Mb={};Mb[Ta.a.m_a]=
za;Mb[Ta.a.$M]=3;za=new hd.a(jf.a.TCb,0,this.$.jd,0,null);this.$.Ka.dc(za,Mb)};a.prototype.IHb=function(za,Mb){var hc={};hc.div=za.Iy;hc.id=za.controlId;hc.solutionId=Mb.SolutionId;hc.version=Mb.Version;hc.storeId=Mb.StoreId;hc.storeType=Mb.StoreType;hc.osfControlType=OSF.OsfControlTarget.TaskPane;return hc};a.prototype.pXf=function(){var za=this;if(hb.EwaSettings.isChangeGateEnabled("OfficeVSO:3935411_RemoveOsfControlsAferSilentReload")){for(var Mb=[],hc=0;hc<this.Jf.length;hc++){var cc=this.Jf[hc];
0!==cc.osfControlType&&3!==cc.osfControlType&&4!==cc.osfControlType||Array.add(Mb,cc)}hc=!1;for(cc=0;cc<Mb.length;cc++){var Ec=Mb[cc];this.KRa(Ec.controlId);!hc&&Ec&&Ec.rl&&(hc=Ac.HelperMethods.Mw(Ec.rl))}hc&&(Mb={},Mb=(Mb.DynamicAddinCommandsMethodDispatchId=4,Mb),this.PK(-1014260128,Mb))}hb.EwaSettings.ma(407)&&va.TaskExtensions.Ba(Uc.GetServiceTaskFactory.Ua(this.$.da,278,279,3),function(Lc){Lc&&(Lc=Lc.result)&&(za.$.da.Aa(278)||za.$.da.Ha(278,Lc),Lc.Kef().loa())},this.la,3)};a.prototype.YL=function(){var za=
this,Mb=new n(this.$,this.oj,this.pYf);void 0===this.$||null===this.$?xa.ULS.sendTraceTag(537170514,0,50,"VSO#2693929: ResetStateForWorkbookReload is called. EwaControl is null"):hb.EwaSettings.ma(260)&&xa.ULS.sendTraceTag(537170513,0,50,"VSO#2693929: ResetStateForWorkbookReload is called. RichAPiEventRegistration is null: "+(void 0===this.oj||null===this.oj));if(Mb.SHi()){var hc=function(){},cc=function(he){he=kf.a.mg(he.data);xa.ULS.sendTraceTag(537170511,0,10,"ResetStateForWorkbookReload: Failed to recreate event registration information. Errors: {0}.",
Xe.a.Wc(he))},Ec=Mb.vVg();Mb=function(he,qe,Af){return Ve.i(za.$.na.ta,"ExecuteRichApiRequest",za.xVg(Ec),$c.b(he,hc),$c.a(qe,cc),Af,null,0)};var Lc=a.Zid(Ec);hb.EwaSettings.uc()?this.$.userOperationManager.ju(new Ad.a(507,0,Mb,Lc|64)):this.$.userOperationManager.ju(new Bc.a(507,0,Mb,Lc))}};a.prototype.xVg=function(za){var Mb=this.$.na.ta.Ma(1);Mb.request=za;return Mb};a.prototype.KBe=function(za,Mb){if(za)for(var hc=0;hc<za.length;hc++)if(Jf.a.equals(za[hc],Mb,!0))return!0;return!1};a.prototype.zUg=
function(za){var Mb={};Mb.navigationMode=OSF.OsfNavigationMode.DefaultMode;Mb.assetId=null;Mb.category=null;if(!za||3>za.length)return Mb;if(za[0]){var hc=parseInt(za[0],10);isNaN(parseInt(hc,10))||(Mb.navigationMode=hc)}za[1]&&(Mb.assetId=za[1]);za[2]&&(Mb.category=za[2]);return Mb};a.prototype.mfi=function(){if(hb.EwaSettings.ma(62)){var za=this.$.workbookContext.FullDocumentInfo.EmbeddingPageOrigin;if(za&&"*"!==za.trim()){this.SJa=OsfRuntime.Embedded.createOrReplaceEmbeddingEndpoint(new ea(this),
za,this.$.workbookContext.FullDocumentInfo.EmbeddingPageSessionInfo,this.$.dg.get(2));try{this.SJa.init()}catch(Mb){try{this.SJa.dispose()}catch(hc){}this.SJa=null;xa.ULS.sendTraceTag(537170510,0,10,"EmbeddingEnpoint failed to initialize. Error message: "+Mb.message)}za={};za.a=this.$.ya.UserSessionId;me.b().Te(39,za)}}};a.prototype.h7f=function(za,Mb,hc){var cc=this,Ec=a.NTg(za[0]),Lc=Ec.tia,he=Ec.qja;Ec.tia=function(){Lc&&Lc();var qe=Ec.NMa!==OSF.InfoType.Error?Mb:null;za.shift();za.length?cc.h7f(za,
qe,hc):qe&&qe()};Ec.qja=function(){he&&he();hc&&Ec.NMa!==OSF.InfoType.Error&&hc()};pc.a.FUd(Ec)};a.prototype.kWh=function(){var za={};za.AddinRibbonControlsOverriddenByApi=hb.EwaSettings.isChangeGateEnabled("OfficeVSO:4373039_AddinRibbonControlsOverriddenByApi").toString();za.AddinActionDefinitionHybridMode=hb.EwaSettings.ma(657).toString();za.UseActionIdForUILessCommand=hb.EwaSettings.ma(661).toString();za.AllowStorageAccessByUserActivationOnIFrame=hb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.AllowStorageAccessByUserActivationOnIFrame",
!1).toString();za.RequirementSetRibbonApiOnePointTwo=hb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.RequirementSetRibbonApiOnePointTwo",!1).toString();za.flightingTreatmentVariables=Za.AFrameworkApplication.ha.abc;za.ShortcutInfoArrayInUserPreferenceData=hb.EwaSettings.isChangeGateEnabled("OfficeVSO:5232658_ShortcutInfoArrayInUserPreferenceData").toString();return za};a.getSolutionId=function(za){var Mb=za.PrimaryMarketplace.SolutionId;hb.EwaSettings.ma(297)&&za.OwnerAddinSolutionId&&
(Mb=za.OwnerAddinSolutionId);return Mb};a.Zid=function(za){var Mb=0;hb.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")?za.RequestFlags&1&&256!==(za.RequestFlags&256)||(Mb=16):Mb=za.RequestFlags&1?0:16;return Mb};a.gwa=function(za,Mb){Mb=a.getSolutionId(za,Mb);return a.B1e(Mb,za.PrimaryMarketplace.SolutionVersion,za.PrimaryMarketplace.MarketplaceType,za.PrimaryMarketplace.MarketplaceRef)};a.zch=function(za){var Mb={};za=(Mb.recording=za,Mb);return JSON.stringify(za)};
a.T8g=function(za){var Mb={};Mb.visibility=za?"Visible":"Hidden";return JSON.stringify(Mb)};a.rSh=function(za){var Mb=za.getSolutionId(),hc=za.getVersion(),cc=za.getStoreType();za=za.getStoreId();return a.B1e(Mb,hc,cc,za)};a.B1e=function(za,Mb,hc,cc){return String.format("{0}|{1}|{2}|{3}|{4}|||","2",za,Mb,a.d3h(hc).toString(),cc)};a.Vkd=function(za,Mb){var hc=za.split("|");if(7>hc.length)return xa.ULS.sendTraceTag(537170509,0,10,"DdaEventDispatch.GetWebExtensionDataFromAddinId: Unexpected customFunctionAddinId."),
null;if("2"!==hc[0])return xa.ULS.sendTraceTag(537170508,0,10,"DdaEventDispatch.GetWebExtensionDataFromAddinId: Unexpected format='{0}'.",hc[0]),null;var cc=hc[1],Ec=hc[2],Lc=a.e3h(hc[3]),he=hc[4];hc=hc[5];cc&&cc.length||(cc=hc);hc={};hc.InstanceId=String.format("{{{0}}}",Rb.a.create().toString());hc.WebExtensionOsfControlType=4;hc.WebExtensionType=1;hc.PrimaryMarketplace={};hc.PrimaryMarketplace.SolutionId=cc;hc.PrimaryMarketplace.SolutionVersion=Ec;hc.PrimaryMarketplace.MarketplaceRef=he;hc.PrimaryMarketplace.MarketplaceType=
Lc;hc.ContainsCustomFunctions=Mb?!0:!1;Mb&&(hc.OsfPropertyBag=[["customFunctionAddinId",za]]);return hc};a.e3h=function(za){za=parseInt(za,10);return za===OSF.StoreTypeEnum.MarketPlace?OSF.StoreType.OMEX:za===OSF.StoreTypeEnum.Catalog?OSF.StoreType.SPCatalog:za===OSF.StoreTypeEnum.SPApp?OSF.StoreType.SPApp:za===OSF.StoreTypeEnum.Exchange?OSF.StoreType.Exchange:za===OSF.StoreTypeEnum.FileSystem?OSF.StoreType.FileSystem:za===OSF.StoreTypeEnum.Registry?OSF.StoreType.Registry:za===OSF.StoreTypeEnum.PrivateCatalog?
OSF.StoreType.PrivateCatalog:za===OSF.StoreTypeEnum.HardCodedPreinstall?OSF.StoreType.HardCodedPreinstall:za===OSF.StoreTypeEnum.FirstParty?OSF.StoreType.FirstParty:za===OSF.StoreTypeEnum.UploadFileDevCatalog?OSF.StoreType.UploadFileDevCatalog:za===OSF.StoreTypeEnum.WopiCatalog?OSF.StoreType.WopiCatalog:null};a.d3h=function(za){return za===OSF.StoreType.OMEX?OSF.StoreTypeEnum.MarketPlace:za===OSF.StoreType.SPCatalog?OSF.StoreTypeEnum.Catalog:za===OSF.StoreType.SPApp?OSF.StoreTypeEnum.SPApp:za===OSF.StoreType.Exchange?
OSF.StoreTypeEnum.Exchange:za===OSF.StoreType.FileSystem?OSF.StoreTypeEnum.FileSystem:za===OSF.StoreType.Registry?OSF.StoreTypeEnum.Registry:za===OSF.StoreType.PrivateCatalog?OSF.StoreTypeEnum.PrivateCatalog:za===OSF.StoreType.HardCodedPreinstall?OSF.StoreTypeEnum.HardCodedPreinstall:za===OSF.StoreType.FirstParty?OSF.StoreTypeEnum.FirstParty:za===OSF.StoreType.UploadFileDevCatalog?OSF.StoreTypeEnum.UploadFileDevCatalog:za===OSF.StoreType.WopiCatalog?OSF.StoreTypeEnum.WopiCatalog:-1};a.ftb=function(za){var Mb=
{};Mb.Version=za.version;Mb.AssetId=za.assetId;Mb.AssetStoreId=null!==za.assetStoreId?za.assetStoreId.toString():null;Mb.StoreType=za.storeType;Mb.Height=za.height;Mb.SolutionId=za.solutionId;Mb.StoreId=za.storeId;Mb.TargetType=za.targetType;Mb.Width=1===Mb.TargetType?0:za.width;Mb.SharedRuntimeId=za.sharedRuntimeId;return Mb};a.DAb=function(za){return za===OSF.DDA.EventDispId.dispidSettingsChangedEvent||za===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent||za===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||
za===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||za===OSF.DDA.EventDispId.dispidRichApiMessageEvent||za===OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent||za===OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent||za===OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent};a.NTg=function(za){return Object.assign(new jc.a,{NMa:za.infoType,id:za.id,title:za.title,description:za.description,buttonText:za.buttonTxt,tia:za.buttonCallback,$fc:za.highPriority,qja:za.dismissCallback,
errorCode:za.errorCode,Lcf:za.iframeNotificationUrl})};a.kNa=function(za){var Mb="FA000000014"===za;Mb||(Mb="907DD90F-A82F-4BBF-B4F2-FCD4868A5E14ButtonId1"===za);return Mb};a.coi=function(za){return"FA000000005"===za};uk.Object.defineProperties(a.prototype,{E1b:{configurable:!0,enumerable:!0,get:function(){return this.Tfa||(this.Tfa=new ic.a(this.$.xw))}},Ni:{configurable:!0,enumerable:!0,get:function(){if(!this.an){var za={},Mb=!(this.$.Dd&1),hc=sc.a.current.JL,cc=this.$.workbookContext,Ec=Va.a.lM+
Va.a.R4b,Lc=0;hb.EwaSettings.ma(499)&&(Lc|=2);za.pageBaseUrl=hc.LayoutsContentUrlPrefix;za.appName=OSF.AppName.ExcelWebApp;za.appVersion="16";za.appSettings=this.kWh();za.singleSignOnSettings=Cb.AppsForOfficeSingleSignOnManager.I2h();za.clientMode=Mb?OSF.ClientMode.ReadOnly:OSF.ClientMode.ReadWrite;za.appUILocale=this.$.ya.UICultureTag;za.dataLocale=this.$.ya.DataCultureTag;za.docUrl=cc.ClientUrl;za.hostControl=this;za.formFactor=OSF.FormFactor.Default;za.lcid=this.$.sJ.toString();za.localizedScriptsUrl=
Va.a.lM+Va.a.E4c;za.localizedImagesUrl=Ec;za.localizedStylesUrl=Va.a.lM+Va.a.KEe;za.localizedResourcesUrl=Ec;za.osfOmexBaseUrl=hc.OsfOmexBaseUrl;za.firstPartyManifestCDNUrl=hc.FirstPartyAddInManifestCDN;za.sdxAssetsToPrefetchMapping=Za.AFrameworkApplication.ha.Wa("SdxAssetsToPrefetchMapping");za.sdxCdnUrl=hc.SdxCdnUrl;za.sdxDmsUrl=hc.SdxDmsUrl;za.devCatalogUrl=hc.DevCatalogUrl;za.controlStatusChanged=this.lna;za.notifyHost=this.HEf;za.allowExternalMarketplace=this.$.ea.ah.get(27)&&a.p5c;za.enableAddinCommands=
hb.EwaSettings.ma(54);za.enableBlackForestRedirect=hb.EwaSettings.ma(89);za.enableMyOrg=this.$.ea.ah.get(33);za.enableMyApps=this.$.ea.ah.get(34);za.enableDevCatalog=hb.EwaSettings.ma(45);za.enablePrivateCatalog=this.aCj();za.enableTaskpaneUpgradeToAppCommand=hb.EwaSettings.ma(94);za.showSignOutFromPrivateCatalogMessage=this.$.ea.ah.get(36);za.enableUploadFileDevCatalog=hb.EwaSettings.ma(54)&&!hb.EwaSettings.ma(285);za.userNameHashCode=ib.a.sw(Za.AFrameworkApplication.userName);za.envCode=this.$.ya.OfficeAddinTelemetryDataSourceCode.toString();
za.enableSingleSignOnForAddin=!hb.EwaSettings.ma(24)&&Za.AFrameworkApplication.isAppsForOfficeSingleSignOnSupportedOnHost;za.enableDisplayBlockedMinorError=hb.EwaSettings.ma(184);za.hideAppsExtensionUrl=Za.AFrameworkApplication.hideAppsExtensionUrl;za.enableAnonymousUseLegacyCatalogService=hb.EwaSettings.ma(174);za.enableInsertDialogAccessibilityFix=hb.EwaSettings.ma(181);za.disableAppsForOfficeThirdParty=hb.EwaSettings.ma(187);za.enableFirstPartySSO=hb.EwaSettings.ma(199);za.wacSessionId=this.$.ya.UserSessionId;
za.disableLogging=!this.$.ya.AriaLoggingIsEnabled;za.enableFirstPartySDXErrorMessages=hb.EwaSettings.ma(212);za.enableRichApiCellEditDelay=hb.EwaSettings.ma(191);za.isHostDocumentDomain=hb.EwaSettings.ma(227);za.loggableUserId=Za.AFrameworkApplication.ha.Wa("LoggableUserId");za.sessionStartInfoJson=Za.AFrameworkApplication.ha.Wa("SessionStartInfoJson");za.wopiHostOriginFromPostMessage=Za.AFrameworkApplication.wopiHostOriginFromPostMessage;za.wopiHostOriginFromWacPropBag=Za.AFrameworkApplication.ha.Wa("PostMessageOrigin");
za.wacIsEmbedded=Za.AFrameworkApplication.ha.ra("IsEmbedded");za.accessibilityAllowFocusAddinTaskpane=Za.AFrameworkApplication.ha.ra("AccessibilityAllowFocusAddinTaskpane");za.enableRemoveAppCommandsAddin=Za.AFrameworkApplication.ha.ra("RemoveAppCommandsAddinIsEnabled");za.isHostFrameTrustCheckEnabledForAddIns=Za.AFrameworkApplication.ha.ra("HostFrameTrustCheckIsEnabledForAddIns");za.isHostFrameTrusted=Za.AFrameworkApplication.isHostFrameTrusted;za.agaveAddinUploadEnabled=hb.EwaSettings.ma(47);za.hostAllowedOfficeStore=
Za.AFrameworkApplication.ha.ra("HostAllowedOfficeStore");za.hostAllowedSdxEmbedding=Za.AFrameworkApplication.ha.ra("HostAllowedSdxEmbedding");za.hostInstallAddIns=Za.AFrameworkApplication.ha.Wa("HostInstallAddIns");za.hostInstallAddInsIsEnabled=Za.AFrameworkApplication.ha.ra("HostInstallAddInsIsEnabled");za.approvedAddIns=Za.AFrameworkApplication.ha.Wa("ApprovedAddIns");za.addinEnforceHttpsIsEnabled=this.kBj(za.sessionStartInfoJson);za.hostFeatureGateFlag=Lc;za.isUpnCheckEnabled=Za.AFrameworkApplication.ha.ra("IsUpnCheckEnabled");
za.wacUpn=Za.AFrameworkApplication.ha.Wa("UserPrincipalName");za.isReactRibbonEnabled=Kc.a.isReactRibbonEnabled();za.enableSetFocusOnTaskpaneOnUserAction=hb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.SetFocusOnTaskpaneOnUserActionIsEnabled",!1);za.isSafariWithIndexedDBDisabled=hb.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&zb.a.s8a;za.isIndexedDBDisabled=hb.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&zb.a.s8a||hb.EwaSettings.isChangeGateEnabled("OfficeVSO:5735286_IDBBuggedInFirefox")&&
zb.a.Hf;za.enableCustomShortcuts=hb.EwaSettings.isChangeGateEnabled("OfficeVSO:5325526_EnableCustomShortcuts");za.changeGetModifierKeyStringOutputOrder=hb.EwaSettings.isChangeGateEnabled("OfficeVSO:5426302_ChangeGetModifierKeyStringOutputOrder");this.an=new OSF.ContextActivationManager(za);za={};this.an.setIframeAttributeBag((za.frameborder=0,za.marginheight=0,za.marginwidth=0,za));this.an.setWSA(Za.AFrameworkApplication.Ym);this.an&&"undefined"!==typeof this.an.hostCheckReadyHandler&&Za.AFrameworkApplication.rJg(Object($b.a)(this.an,
this.an.hostCheckReadyHandler,"hostCheckReadyHandler"));try{var he=jb.a.instance.resolve("Common.App.OAuth.IOAuthManager");this.an.setOAuthManager(he)}catch(qe){}}return this.an}},t1j:{configurable:!0,enumerable:!0,get:function(){return this.EVc}},oj:{configurable:!0,enumerable:!0,get:function(){return this.aje}},ioa:{configurable:!0,enumerable:!0,get:function(){return this.Yie}},bPd:{configurable:!0,enumerable:!0,get:function(){return this.bje}},aPd:{configurable:!0,enumerable:!0,get:function(){return this.$ie}},
Mnj:{configurable:!0,enumerable:!0,get:function(){return this.dje}},Knj:{configurable:!0,enumerable:!0,get:function(){return this.Zie}},Lnj:{configurable:!0,enumerable:!0,get:function(){return this.cje}},Nnj:{configurable:!0,enumerable:!0,get:function(){return this.eje}},Onj:{configurable:!0,enumerable:!0,get:function(){return this.fje}},cPd:{configurable:!0,enumerable:!0,get:function(){return this.gje}},uW:{configurable:!0,enumerable:!0,get:function(){return this.wug}},$:{configurable:!0,enumerable:!0,
get:function(){return this.wb}}});uk.Object.defineProperties(a,{p5c:{configurable:!0,enumerable:!0,get:function(){return a.B7d},set:function(za){a.B7d=za}}});a.t2a=new wc.a;a.B7d=!0;Object(bb.a)(a,"DdaFacade",gc.a,[470,972,966,973,974,3])},952:function(z,F,b){function a(){this.uLd=0;this.CX={};this.hua={}}b.d(F,"a",function(){return a});z=b(0);var c=b(13),e=b(111);a.prototype.HZh=function(l,m){return this.CX[a.x0c(l,m)]};a.prototype.QOe=function(l,m){m||void 0!==this.hua[l]&&null!==this.hua[l]?m&&
void 0!==this.hua[l]&&null!==this.hua[l]&&delete this.hua[l]:this.hua[l]=1};a.prototype.w1b=function(l){return void 0===this.hua[l]||null===this.hua[l]};a.prototype.c8h=function(l){var m=a.x0c(l.messageType,l.targetId);1===l.actionType?this.s9h(l.controlId,l.messageType,m):2===l.actionType&&this.d$h(l.controlId,l.messageType,m)};a.prototype.Mej=function(l){if(l){var m=Object.keys(this.CX);if(!(void 0===m||null===m||0>=m.length)){m=Cl(m);for(var n=m.next();!n.done;n=m.next()){n=n.value;var h=this.CX[n];
h[l]&&(delete h[l],Object.keys(h).length||delete this.CX[n])}}}};a.prototype.P_=function(l,m){l=a.x0c(l,m);l=this.CX[l];return!!l&&0<Object.keys(l).length};a.prototype.U$h=function(){return!e.a.isEmpty(this.CX)};a.prototype.Blf=function(){return 0<this.uLd};a.prototype.aUh=function(){var l=[],m=this.CX,n;for(n in m){var h=n,u=m[n],w;for(w in u){u=w;var r={};r.eventType=parseInt(h.split("#")[0],10);r.targetId=h.split("#")[1];r.addinId=u;l.push(r)}}return l};a.prototype.s9h=function(l,m,n){if(this.CX[n])n=
this.CX[n],n[l]=n[l]?n[l]+1:1;else{var h={};h[l]=1;this.CX[n]=h}100===m&&this.uLd++};a.prototype.d$h=function(l,m,n){if(this.CX[n]){var h=this.CX[n];if(l){var u=h[l];1===u?(delete h[l],Object.keys(h).length||delete this.CX[n]):h[l]=u-1;100===m&&this.uLd--}else c.ULS.sendTraceTag(537170459,0,50,"The OsfControl[{0}] doesn't register event with key[{1}].",l,n)}else c.ULS.sendTraceTag(537170460,0,50,"The event with key[{0}] that will be unregistered doesn't exist.",n)};a.x0c=function(l,m){return String.format("{0}#{1}",
l,m)};a.OX="Workbook";Object(z.a)(a,"RichApiEventRegistration",null,[])},976:function(z,F,b){function a(c,e,l,m){this.ddaBinding=null;this.dispid=0;this.ArrayData=this.controlId=null;this.dispid=c;this.controlId=e;this.ddaBinding=l;this.ArrayData=void 0===m?null:m}b.d(F,"a",function(){return a});z=b(0);a.prototype.getDispid=function(){return this.dispid};a.prototype.getDdaBinding=function(){return this.ddaBinding};Object(z.a)(a,"DdaEventArgs",null,[])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.agave.js.map/7fc721de1aba361fa21fb3ac1e285fe1/EwaDS.agave.js.map