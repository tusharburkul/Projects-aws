(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[18],{1064:function(z,F,b){function a(B){var y=this;this.businessBar=this.i9a=null;this.iMi=function(v,A){A.C9c?y.kMi(A):y.jMi(A)};this.Vh=function(v,A){v=A.context.methodName;y.i9a&&v===y.i9a&&(l.ULS.sendTraceTag(537155230,0,50,'NetworkConnectionHealthChecker.OnWebMethodSuccess: Failed web method "{0}" has now succeeded. Querying local storage for BB showings.',y.i9a),y.C9a(a.qLb,!0),y.i9a=null);y.Cqf(!1);y.g5b=!1};this.Xn=function(v,
A){n.a.uh(A.errors,[-1387426400])&&!y.g5b&&(y.g5b=!0,y.s6f()&&window.performance.mark(a.Dxf),(new c(y)).Yvi())};this.fh=function(){y.Cqf(!0);y.C9a(a.xEb,!1);y.C9a(a.qLb,!1)};this.Lza=function(){l.ULS.sendTraceTag(537155225,0,50,"NetworkConnectionHealthChecker.OnNetworkResumed: Network resumed for session. Querying local storage for BB showings.");y.C9a(a.xEb,!0)};this.$=B;this.na=this.$.na;this.localStorage=new u.a;this.g5b=!1;this.$.ea.Gm(this.fh);this.na.tf.jpb(this.Lza);this.na.Hq(this.Vh);this.$.da.Ya(5,
function(v){y.businessBar=v;v.VHg(y.iMi)});this.na.mz(this.Xn)}function c(B){var y=this;this.Jnd=[w.a.Plg,w.a.jGc];this.Vo=function(v,A){y.YO[A]=v;y.W$h()&&y.Akj("OnNetworkDownImmediatePing"===v.caller)};this.Jma=B;this.$=B.$;this.YO={}}function e(){this.scenario=null;this.timeElapsed=0;this.isNewSession=!1;this.rawData=null}b.r(F);z=b(0);var l=b(13),m=b(332),n=b(29),h=b(8),u=b(323);Object(z.a)(e,"ConnectionErrorLogInfo",null,[]);var w=b(1280),r=b(1325);c.prototype.Yvi=function(){var B=r.a.Jfd(this.Vo,
"OnNetworkDownImmediatePing",this.$,this.Jnd);B=Cl(B);for(var y=B.next();!y.done;y=B.next())y.value.runTest()};c.prototype.W$h=function(){for(var B=Cl(this.Jnd),y=B.next();!y.done;y=B.next())if(y=y.value,void 0===this.YO[y]||null===this.YO[y])return!1;return!0};c.prototype.Akj=function(B){var y=this.$.tf.zW;B&&this.CLj(y);B=Cl(this.Jnd);for(var v=B.next();!v.done;v=B.next())v=v.value,this.YO[v]=Sys.Serialization.JavaScriptSerializer.serialize(this.YO[v]);B=Date.now();v=this.Jma.zkd(b(1064).NetworkConnectionHealthChecker.xEb).returnValue;
var A=this.Jma.zkd(b(1064).NetworkConnectionHealthChecker.qLb).returnValue;this.YO.isOfflineMode=y;this.YO.networkDownBBAge=-1===v?v:B-v;this.YO.transientServerCommunicationFailuresBBAge=-1===A?A:B-A;this.Jma.businessBar?(this.YO.isNetworkDownBBShown=this.Jma.businessBar.HC(54).toString(),this.YO.isServerErrorBBShown=this.Jma.businessBar.HC(21).toString()):(this.YO.isNetworkDownBBShown="unknown",this.YO.isServerErrorBBShown="unknown");l.ULS.sendTraceTag(537155224,0,50,"ConnectionHealthTestsRunner.ReportPingResults: {0}",
Sys.Serialization.JavaScriptSerializer.serialize(this.YO))};c.prototype.CLj=function(B){for(var y=b(1064).NetworkConnectionHealthChecker,v={},A=Cl(Object.keys(this.YO)),t=A.next();!t.done;t=A.next())t=this.YO[t.value],v[t.testName]=t.isSuccess;v.isOfflineMode=B;this.Jma.gXd(y.T4c,Sys.Serialization.JavaScriptSerializer.serialize(v))};Object(z.a)(c,"ConnectionHealthTestsRunner",null,[]);b.d(F,"NetworkConnectionHealthChecker",function(){return a});a.prototype.dispose=function(){this.$&&(this.$.ea&&this.$.ea.Kp(this.fh),
this.na&&(this.na.tf.sJb(this.Lza),this.na.fA(this.Xn),this.na.Rr(this.Vh)))};a.prototype.kMi=function(B){var y={};y.Timestamp=Date.now().toString();switch(B.GHa){case 21:this.i9a=B.data.FailedMethod;y.FailedMethod=this.i9a;this.gXd(a.qLb,JSON.stringify(y));break;case 54:this.gXd(a.xEb,JSON.stringify(y))}};a.prototype.jMi=function(B){switch(B.GHa){case 21:this.C9a(a.qLb,!0);break;case 54:this.C9a(a.xEb,!0)}};a.prototype.gXd=function(B,y){try{this.localStorage.xg()&&this.localStorage.setItem(B,y)}catch(v){l.ULS.sendTraceTag(537155231,
0,15,"NetworkConnectionHealthChecker.StoreDataInLocalStorage: Failed to set item to local storage. reason: {0}",v.message||"Unknown")}};a.prototype.zkd=function(B){if(this.localStorage.xg()&&(B=this.localStorage.o5a(B))&&"null"!==B){var y=JSON.parse(B);B=parseInt(y.Timestamp,10);y=Sys.Serialization.JavaScriptSerializer.serialize(y);return{returnValue:B,rawData:y}}return{returnValue:-1,rawData:null}};a.prototype.Cqf=function(B){if(this.localStorage.xg()){var y=this.localStorage.o5a(a.T4c);if(y&&"null"!==
y){var v=-1;this.g5b&&(v=this.xTh(a.Dxf,a.WKi));l.ULS.sendTraceTag(537155229,0,50,"NetworkConnectionHealthChecker.LogPingResultsFromLocalStorage: Ping Results: {0}, Period offline: {1}, New session: {2}",Sys.Serialization.JavaScriptSerializer.serialize(y),v,B);this.localStorage.removeItem(a.T4c)}}};a.prototype.xTh=function(B,y){if(!this.s6f())return-1;window.performance.measure(y,B);B=window.performance.getEntriesByName(y);return B.length&&B[B.length-1]?B[B.length-1].duration:(l.ULS.sendTraceTag(537155228,
0,10,"NetworkConnectionHealthChecker.LogPingResultsFromLocalStorage: measure name {0} returned no measures.",y),-1)};a.prototype.C9a=function(B,y){try{var v=this.zkd(B);var A=v.rawData;var t=v.returnValue;if(-1!==t){var E=Object.assign(new e,{timeElapsed:Date.now()-t,scenario:B,isNewSession:!y,rawData:A});l.ULS.sendTraceTag(537155227,0,50,"NetworkConnectionHealthChecker.LogNetworkIssueBBShown: {0}",JSON.stringify(E))}this.localStorage.removeItem(B)}catch(C){l.ULS.sendTraceTag(537155226,0,15,"NetworkConnectionHealthChecker.LogNetworkIssueBBShown: Failed to get item from local storage. reason: {0}",
C.message||"Unknown")}};a.prototype.s6f=function(){return h.HelperMethods.o0c&&m.a.Kqb};a.xEb="NetworkDownBBShown";a.qLb="ServerCommunicationFailureBBShown";a.T4c="ConnectionHealthPingRsults";a.Dxf="offMoStMa";a.WKi="offMoDuMea";Object(z.a)(a,"NetworkConnectionHealthChecker",null,[3])},1280:function(z,F,b){function a(){}b.d(F,"a",function(){return a});z=b(0);a.jGc="b-ring_Apc_Trans";a.Plg="cdn_static_resource_ewa_image";Object(z.a)(a,"ResourceHosts",null,[])},1325:function(z,F,b){function a(){}function c(u,
w,r,B,y){this.url="";this.Y6a=!1;this.D8=-1;this.testIteration=0;this.baseUrl=r;this.Ozf=B;this.znd=w;this.result=new e(w,y)}function e(u,w){this.testName=null;this.startTimeMs=0;this.isSuccess=!1;this.caller=this.errorStatusCode=this.errorMessage=null;this.reqTotalDurationMs=0;this.browserResourceTiming=null;this.testIteration=0;this.testName=u;this.caller=w;this.reset()}z=b(0);var l=b(54),m=b(13),n=b(292);e.prototype.reset=function(){this.isSuccess=!1;this.startTimeMs=-1;this.errorStatusCode=this.errorMessage=
"";this.reqTotalDurationMs=-1;this.browserResourceTiming=null};Object(z.a)(e,"NetworkTestResult",null,[]);var h=b(640);c.prototype.runTest=function(){try{if(this.Y6a)return m.ULS.sendTraceTag(537155206,0,50,"NetworkTestReq.RunTest: a test for the host {0} is already mid way, not starting a new one.",this.znd),!1;this.reset();this.Y6a=!0;this.result.startTimeMs=Date.now();var u=new n.QueryStringBuilder(this.baseUrl);u.x$("tid",this.result.startTimeMs.toString());this.url=u.toString();this.bsj();this.testIteration++;
this.result.testIteration=this.testIteration;return!0}catch(w){return this.Cvb("Exeption: "+w.message),!1}};c.prototype.reset=function(){this.url="";this.result.reset();this.Y6a=!1;this.D8=-1};c.prototype.clearTimeout=function(){-1!==this.D8&&(window.clearTimeout(this.D8),this.D8=-1)};c.prototype.bsj=function(){var u=this;try{var w=new XMLHttpRequest;w.onreadystatechange=function(){4===w.readyState&&(200===w.status?u.wHh():u.Cvb(String.format("Error when downloading resource. status code: {0}, status text: {1}",
w.status,w.statusText),w.status.toString()))};w.onerror=function(){u.Cvb(String.format("Client error when attempting to download resource. status code: {0}, response: {1}",w.status,w.statusText))};this.D8=window.setTimeout(function(){u.D8=-1;u.Cvb("Request timeout")},1E4);w.open("GET",this.url,!0);w.send(null)}catch(r){this.Cvb("Exeption: "+r.message)}};c.prototype.wHh=function(){this.Y6a&&(this.result.reqTotalDurationMs=Date.now()-this.result.startTimeMs,this.clearTimeout(),this.result.browserResourceTiming=
h.a(this.url),this.result.isSuccess=!0,this.V4b())};c.prototype.Cvb=function(u,w){w=void 0===w?null:w;this.Y6a&&(this.clearTimeout(),this.result.errorMessage=u,this.result.isSuccess=!1,this.result.errorStatusCode=w,this.V4b())};c.prototype.V4b=function(){this.Y6a=!1;this.Ozf&&this.Ozf(this.result,this.znd)};Object(z.a)(c,"NetworkTestReq",null,[]);b.d(F,"a",function(){return a});a.Jfd=function(u,w,r,B){B=void 0===B?null:B;a.Snc||(a.Snc=Array.isArray(l.a.ui(r.ya.NetworkMeasurementUrlList))?l.a.ui(r.ya.NetworkMeasurementUrlList):
null);for(var y=[],v=0;v<a.Snc.length;v++){var A=a.Snc[v],t=A.key;t||(t=A.Key);if(!B||Array.contains(B,t)){var E=A.value;E||(E=A.Value);t&&E&&y.push(new c(r,t,E,u,w))}}return y};a.Snc=null;Object(z.a)(a,"NetworkConnectionHelpers",null,[])},1442:function(z,F,b){function a(Y){var Ra=jj.call(this)||this;Ra.$=Y;Ra.Xb();return Ra}function c(){}function e(Y,Ra,Db,ec,gd,Jd,Xd){Y=m.call(this,Y,Ra,Db,ec,gd,!1)||this;Y.o1d=!1;Y.K1=Xd;Y.Agc=e.JLh(Jd);Jd=Y.P1d(Y.Agc.name,Y.Agc.size);if(0!==Jd)return Y.$Ud(Jd),
Y.K1.setException(Error.create("DataUrlUploaderWrapper: Invlid data url")),Y.dispose(),Y;Y.Oj=new r(Y.$.domElement,Object(za.a)(Y,Y.CGb,"onUploadFrameInitialized"),Object(za.a)(Y,Y.Tpa,"uploadResponseReceived"),ec,!1,Y.$);return Y}function l(Y,Ra){this.filename=Y;this.blob=Ra}function m(Y,Ra,Db,ec,gd,Jd){Jd=void 0===Jd?!0:Jd;Y=u.call(this,Y,Db,ec,gd,!1)||this;Y.Xd=Ra;Jd&&Y.showDialog();return Y}function n(Y,Ra){this.dataUri=this.sheetName=null;this.sheetName=Y;this.dataUri=Ra}function h(Y,Ra,Db,ec,
gd,Jd){Jd=void 0===Jd?!0:Jd;Ra=u.call(this,Y,Ra,Db,ec,!1)||this;Ra.CFh=gd;Ra.wac=Y.Sb.Kh("LoadResource","FileReaderUploaderLoadResource");Jd&&Ra.showDialog();return Ra}function u(Y,Ra,Db,ec,gd){gd=void 0===gd?!0:gd;var Jd=rb.call(this,null,Ra,Db)||this;Jd.Ur=null;Jd.fba=null;Jd.J8a=!1;Jd.QGd=null;Jd.Tpa=function(Xd){Jd.H2d.stop();Jd.O1b.cancel();if(r.Pmi(Xd))Jd.tCc?Jd.L9e(4):(Xd=new Og.a(0,2,null,null,!1,null,null,null),Xd.status=8,Jd.VZd(new Ei.a(Xd),null,"InsertPictureWebMethod")),jc.ULS.sendTraceTag(526399121,
0,50,"Http Error occurred, isTimeoutError: {0}",Jd.tCc);else{var xe=u.W_j(Xd);0!==xe?(jc.ULS.sendTraceTag(526399122,0,50,"Server returned error, response: {0}",Xd),Jd.L9e(xe)):Jd.R9h(Xd)}Jd.Nqc();Jd.dispose()};Jd.APi=function(Xd){Jd.UCa(Xd,Jd.Oj)&&Jd.finalizeUpload(Jd.Oj,null)};Jd.CGb=function(Xd){jc.ULS.sendTraceTag(526399120,0,50,"Upload frame initialized");Jd.Oj=Xd;if(!Jd.N2a){if(Jd.o1d){if(Jd.Vze()||Jd.m$a&&xd.a.aG){Xd.L8b(Jd.APi);return}var xe=Xd.L8b(null);if(!Jd.UCa(xe,Xd))return}Jd.finalizeUpload(Xd,
null)}};Jd.LYi=function(){Jd.tCc=!0};Jd.wb=Y;Jd.H2d=Y.Sb.Kh("WebServiceCall","InsertPictureOperation");Jd.O1b=Eh.a.instance.create(Jd.LYi,1E5,Xh.a.NRg,!1);Jd.tCc=!1;Jd.Umc=Jd.$.ya.InsertPictureMaxFileSizeBytes;ec&&(Jd.J8a="TestOnly"in ec);gd&&Jd.showDialog();return Jd}function w(Y,Ra,Db){var ec=v.call(this,Y,!1)||this;ec.OV=null;ec.eCa=!1;ec.cpc=function(){ec.r0d("");ec.rDc();return!1};ec.$=Ra;ec.yEc=Y;ec.YR=yi.a.instance;ec.ha=Db;ec.A4f();ec.bpd();ec.$.yb.Tz=!0;return ec}function r(Y,Ra,Db,ec,gd,
Jd,Xd){Y=B.call(this,Y,Ra,Db,ec,gd,"UploadFrame",Jd.ea.sessionId,"image/*",!1,null,void 0===Xd?!1:Xd)||this;Y.$=Jd;Y.Mig=!0;nd.EwaSettings.isChangeGateEnabled("OfficeVSO:5329840_InsertPictureOpenFileBrowserDirectly")?Y.mef():Y.tue();return Y}function B(Y,Ra,Db,ec,gd,Jd,Xd,xe,cf,pf,ff){cf=void 0===cf?!0:cf;ff=void 0===ff?!1:ff;this.SWe="FileUpload.ashx";this.io=null;this._initialized=!1;this.Tg=this.Xjb=this.NKc=this.uha=this.$Tb=this.qr=this.dt=null;this.Cm=!1;this.rE=this.aUb=this.mVc=null;this._parent=
Y;this.qug=Ra;this.Uyg=Db;this.z$d=gd;this.jTc=Xd;this.u4d=xe;this.t6d=void 0===pf?null:pf;this.lVc=!1;this.Kug=ec.ra("CanaryRenewalForFileUploadIsEnabled");this.Mig=!1;(this.Tra=ff)||this.C8g(Jd);cf&&this.mef()}function y(Y,Ra,Db){if(Y){var ec=0;do{try{Y();break}catch(gd){if(jc.ULS.sendTraceTag(50946190,306,10,"RetryOnException: [Retries: {0}] [Caller: {1}] [Exception: {2}] [Callstack: {3}].",ec,Db,gd.message,gd.stack),ec>=Ra)break}ec++}while(1)}}function v(Y,Ra){return t.call(this,Y,void 0===Ra?
!0:Ra)||this}function A(){}function t(Y,Ra){Ra=void 0===Ra?!0:Ra;var Db=yj.call(this,!1,!1,t.Yy)||this;Db.DYa=null;Db.T9d=!1;Db.en=[];Db.Oj=null;Db.eZb=Y;Db.Izg=Ra;Db.Kle=!1;Db.cw=!1;Db.uha=null;Db.OKc=!1;Db.ig=Db.ajh;Db.Ve="InsertFileDialog";Db.Bc(1,Db.BZb);if(t.Yy){Y={};Ra={};var ec={};Db.DYa=(ec.id=Db.Ve,ec.bodyControls=(Ra.uploadButtonProps=(Y.label=CommonUIStrings.l_DialogChooseFile,Y.onExecute=Object(za.a)(Db,Db.pZi,"onUploadButtonClick"),Y),Ra),ec.uploadStatusLabel=CommonUIStrings.l_DialogNoFileChosen,
ec.onFrameReady=Object(za.a)(Db,Db.bQi,"onFrameReady"),ec);Db.initializeAndShow(Db.titleText,Object(za.a)(Db,Db.fhc,"insertDialogHandler"),Db.DYa);Db.BTb=!0}else Db.showDialog(Db.titleText,Object(za.a)(Db,Db.fhc,"insertDialogHandler")),Ra&&Db.A4f(),(Y=Db.aW(1))&&Db.en.push(Y),(Y=Db.aW(0))&&Db.en.push(Y),Db.yhg(),Db.BTb=!1;return Db}function E(Y){var Ra=nh.call(this)||this;Ra.$=Y;Ra.Xb();return Ra}function C(Y,Ra,Db,ec){var gd=this;this.RL=null;this.Ohg=function(){gd.RL&&(gd.u2d=Oc.a.Ra.ke.m,gd.hide(),
Eh.a.instance.create(function(){gd.jYj()},250,"RecoveryUI.UpdatePositionOnVisibleAreaChanged",void 0,!0))};this.lMe=function(Jd){10===Jd&&gd.yJa()};this.$jh=function(){if(gd.RL){var Jd=document.getElementById("PasteRecoveryUI");Jd&&Jb.a.Dj===Jd.getAttribute(Jb.a.tZ)&&Jd.click();gd.documentHidden=!0;gd.yJa()}};this.mMe=function(){gd.yJa()};this.nMe=function(){gd.yJa()};this.onKeyUp=function(Jd){if(gd.RL){if(gd.c0)return!1;if(17===Jd.Ca.keyCode&&gd.W$b){Jd=document.getElementById("PasteRecoveryUI");
if(!Jd)return jc.ULS.shipAssertTag(537154070,0,!1,"RecoveryUIController.OnKeyUp: recoveryUIElement is null."),!1;var Xd=Jd.getAttribute(Jb.a.tZ)||"";if(Jb.a.Zo===Xd)return Jd.click(),!0}}return!1};this.onKeyDown=function(Jd){if(gd.RL){gd.W$b=!1;gd.c0=Jd.ctrlKey;Jd=Jd.Ca.keyCode;if(27===Jd)return gd.yJa(),!0;if(17===Jd)return gd.W$b=!0}return!1};this.z0=function(Jd,Xd){Jd=Xd.Xd;gd.tCb=Jd;-1027730316!==Jd.command&&-1059615499!==Jd.command?gd.yJa():(Xd=Xd.properties)&&Xd.launcherId!==gd.sXh()&&gd.yJa()};
this.$=Y;this.vtc=Ra;this.Lr=Db;this.xk=ec;this.Ivd=this.tCb=this.xvd=null;this.c0=this.W$b=this.r8b=this.Pfc=!1;this.u2d=0;this.documentHidden=!1;nd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ServiceInit",!1)||this.$.da.Ha(406,this)}function H(Y){var Ra=Mg.call(this)||this;Ra.$=Y;Ra.Xb();return Ra}function U(Y,Ra,Db){Db=void 0===Db?!0:Db;var ec=Lg.call(this)||this;ec.JTa=null;ec.Yoa=null;ec.IPa=null;ec.h5b=null;ec.z1=null;ec.Hvf=0;ec.ocb=!1;ec.ncb=!1;ec.fuc=!1;ec.documentVisibilityObserver=
null;ec.Ivf=null;ec.BHj=null;ec.Aga=!1;ec.B8=0;ec.vod=0;ec.zBb=!1;ec.a9f=0;ec.XTd=!1;ec.P1=null;ec.YFb=function(){jc.ULS.sendTraceTag(537155219,0,50,"NetworkConnectionStateManager.OnNetworkDownEvent: Network down.");ec.unc(1,!1)};ec.Dza=function(){ec.Ela||ec.zDb?window.setTimeout(function(){ec.fZd()},ec.Hvf):ec.fZd();ec.documentVisibilityObserver.kJb(ec.Dza);ec.zBb=!1};ec.Rg=function(){jc.ULS.sendTraceTag(537155218,0,50,"NetworkConnectionStateManager.OnEditEnded: Edit ended. IsInOfflineMode:{0}, IsInDuringWorkSilentReopenMode:{1}",
ec.zDb&&ec.nzc,ec.tmc&&!ec.Aga&&ec.BMb);ec.zDb&&ec.nzc&&ec.boe();ec.tmc&&!ec.Aga&&ec.BMb&&ec.Yne();qf.g(ec.$).Ac.Zn(ec.Rg);ec.ncb=!1;ec.ocb=!1};ec.sEf=function(){jc.ULS.sendTraceTag(537155213,0,50,"NetworkConnectionStateManager.OnNetworkResumedEvent: network was resumed.");ec.unc(1,!0);ec.ncb&&!ec.ocb&&qf.g(ec.$).Ac.Zn(ec.Rg);ec.ncb=!1};ec.mda=function(gd,Jd){ec.vod=ec.B8;ec.B8=Jd.oCc};ec.sHf=function(){ec.$&&(ec.fuc||(eh.a(ec.$).ER(Zf.a.sQa).KIg(ec.DEf),ec.$.fl(ec.vd),ec.fuc=!0),ec.Aga=ec.oki(),
ec.unc(2,!1))};ec.DEf=function(){var gd=eh.a(ec.$).Ci,Jd=gd.WOg();gd=di.f(gd.Zs.ud.errors,function(Xd){return Xd.MessageIdName});jc.ULS.sendTraceTag(545842889,0,50,"NetworkConnectionStateManager.OnOpenWebMethodErrorUserAlertExecuting: IsStateUnrecoverable:{0}, IsB2W:{1}, Errors: {2}",Jd,ec.Aga,Sg.a.Kc(gd));Jd&&(ec.JTa?(ec.Aga=!1,ec.dKe(),ec.oDc()):ec.Yoa&&(ec.eKe(),ec.oDc()))};ec.vd=function(){ec.$?(jc.ULS.sendTraceTag(541193955,0,50,"NetworkConnectionStateManager.OnWorkbookOpened: Workbook opened."),
ec.Aga=!1,nd.EwaSettings.isChangeGateEnabled("OfficeVSO:5543662_StopSilentReopenDuringWorkTimerMethodContextOnWorkbookOpened")&&ec.z1&&ec.z1.Ap&&(zh.a.Fa(ec.z1),ec.z1=null),nd.EwaSettings.isChangeGateEnabled("OfficeVSO:5533387_ReportLongSilentReopenBackToWorkVeto")&&ec.P1&&ec.P1.Ap&&(zh.a.Fa(ec.P1),ec.P1=null),ec.unc(2,!0),ec.oDc()):jc.ULS.sendTraceTag(537155212,0,10,"NetworkConnectionStateManager.OnWorkbookOpened: bug monitoring: EwaControl is null.")};ec.Wzf=function(){ec.Duf(!0)};ec.Xzf=function(){ec.Duf(!1)};
ec.RXb=ra.zxi;ec.U4c=ra.connected;ec.$=Y;ec.tf=Y.na.tf;ec.f6f=nd.EwaSettings.isChangeGateEnabled("OfficeVSO:5618694_BackToWorkLoadingUIEnabled");ec.BMb=nd.EwaSettings.isChangeGateEnabled("OfficeVSO:5798300_SilentReopenDuringWorkUIEnabled");ec.nzc=nd.EwaSettings.isChangeGateEnabled("OfficeVSO:5618594_OfflineModeUXEnabled");Db&&(ec.Ivf=new ea(Y,Ra));nd.EwaSettings.isChangeGateEnabled("OfficeVSO:5589104_AlwaysInitDocumentVisibilityObserver")&&ec.$.da.Ya(291,function(gd){ec.documentVisibilityObserver=
gd});ec.nzc&&(nd.EwaSettings.isChangeGateEnabled("OfficeVSO:5589104_AlwaysInitDocumentVisibilityObserver")||ec.$.da.Ya(291,function(gd){ec.documentVisibilityObserver=gd}),ec.Hvf=ec.$.ya.ExcelNetworkCheckAfterTabActivationDelayMs,ec.tf.RJg(ec.YFb),ec.tf.jpb(ec.sEf),ec.tf.Rqe(ec.Wzf),ec.tf.pIg(ec.Xzf));if(ec.f6f||ec.BMb)ec.BHj=new Q(ec.$,ec);ec.mrf=ec.$.ya.LongInactivityTimePeriodSeconds;ec.$.ea.iYc(ec.sHf);ec.$.ea.xf.Zsa(ec.mda);ec.BMb&&(ec.a9f=ec.$.ya.SilentReopenDuringWorkDelayMs);return ec}function Q(Y){var Ra=
this;this.s8=null;this.tHf=function(Db,ec){Ra.qHf(ec,3)};this.ODf=function(Db,ec){Ra.qHf(ec,2)};this.$=Y;this.yg=Tc.a(this.$).yg;this.yg.xre(this.ODf);this.yg.fLg(this.tHf)}function O(Y,Ra,Db,ec){Y=ba.call(this,Y,Ra,Db)||this;Y.wasInteruptedByOfflineMode=!1;Y.type=ec;Y.wasInteruptedByOfflineMode=!1;return Y}function ea(Y,Ra){this.Jma=this.NAd=this.Exf=null;this.$=Y;!nd.EwaSettings.isChangeGateEnabled("OfficeVSO:5618594_OfflineModeUXEnabled")||nd.EwaSettings.isChangeGateEnabled("OfficeVSO:4956381_DisableNetworkLoggingInFirefox")&&
xd.a.Hf||(this.Exf=new Z(Y,Ra));nd.EwaSettings.ma(213)&&(this.NAd=new P(this.$),this.NAd.Zdi());!nd.EwaSettings.ma(578)||nd.EwaSettings.isChangeGateEnabled("OfficeVSO:4956381_DisableNetworkLoggingInFirefox")&&xd.a.Hf||(this.Jma=new Te.NetworkConnectionHealthChecker(this.$));this.I5g=new J(this.$)}function Z(Y,Ra){var Db=this;this.HPa=this.rV=null;this.lId=-1;this.Pvb=null;this.Snf=Eg.Task.delay(0);this.lab=function(ec,gd){gd.tQ?Db.OUi(gd.mpa):Db.PUi()};this.nda=function(ec,gd){5===gd.rKf&&Db.h4a()};
this.CZf=function(ec,gd){Db.rV.tvj(gd.NV)};this.h4a=function(){Db.HPa.pWj();Db.ypj(Z.rGd,Sys.Serialization.JavaScriptSerializer.serialize(Db.HPa))};this.vkj=function(ec){if(ec=ec.result)Db.mkg=!0,jc.ULS.sendTraceTag(576811915,0,50,"OfflineModeTelemetryManager.ReportOfflinePartialInteractivityDataFromIDB: Previous session's offline partial interactivy data: {0}",ec)};this.Dej=function(){Db.mkg&&(Db.$?Hb.TaskExtensions.Ba(Db.indexedDB.V8c(Z.rGd),function(){jc.ULS.sendTraceTag(537155204,0,50,"OfflineModeTelemetryManager.RemoveDataFromIDB: Previous session's offline partial interactivy data successfuly removed from IDB.")},
Db.$.la):jc.ULS.sendTraceTag(537155203,0,10,"OfflineModeTelemetryManager.RemoveDataFromIDB: EwaControl is null when attempting to remove offline mode data stored in IDB."))};this.NPa=function(){if(Db.HPa&&0<Db.HPa.count){var ec=Sys.Serialization.JavaScriptSerializer.serialize(Db.HPa);jc.ULS.sendTraceTag(560791644,0,50,"OfflineModeTelemetryManager.OnBeforeUnload: This session's offline partial interactivy data: {0}",ec)}};this.$=Y;this.indexedDB=Ra;this.mkg=!1;this.indexedDB.xg()&&(this.indexedDB.initialize(Z.Cod,
Z.Dod),this.Pjj(),this.HPa=new I(this.$.ya.UserSessionId),Tc.a(this.$).yg.QXc(this.lab));this.xk=Tg.a.instance.TC();this.xk.ka("beforeunload",this.NPa)}function S(Y,Ra,Db){Y=ba.call(this,Y,Ra,Db)||this;Y.timeFromLastOffline=0;Y._errorDataDuringOfflineMode=null;Y.timeFromLastOffline=-1;Y.type=5;return Y}function I(Y){this._count=0;this.sessionID=this.allOfflinePartialInteractivitiesDataInSession=null;this.allOfflinePartialInteractivitiesDataInSession=[];this.sessionID=Y}function P(Y){var Ra=this;this.FYf=
null;this.Evd=this.Mzd=this.TEb=this.UEb=0;this.dUd=!1;this.K4c=this.OTa=this.AAc=this.r$a=null;this.Z4c=0;this.esj=function(){if(12E4>Ra.$.ea.xf.Pfb)for(var Db=Cl(Ra.AAc),ec=Db.next();!ec.done;ec=Db.next())ec.value.runTest();else Ra.XWd("UserInactive")};this.Fkj=function(Db){Db=Sys.Serialization.JavaScriptSerializer.serialize(Db);jc.ULS.sendTraceTag(388821830,0,50,Db)};this.Ujj=function(Db){if(Db){var ec=Ra.K4c[Db.testIteration.toString()];ec?ec.push(Db):(ec=[Db],Ra.K4c[Db.testIteration.toString()]=
ec);if(ec.length===Ra.FYf.length){ec=Sys.Serialization.JavaScriptSerializer.serialize(ec);if(Ra.$&&Ra.$.tf){if(Db.EstimatedLatency=Ra.$.tf.Xwe,Ra.$.tf.Xwe>Ra.$.Yu.ExcelRountripThresholdMs){jc.ULS.sendTraceTag(570712144,0,50,"Periodic ping tests results when network is slow: {0}, consequtive slow ping iteration #: {1}",ec,Ra.Z4c++);return}}else jc.ULS.sendTraceTag(537155209,0,50,"EwaControl/ConnectivityObserver is null when conducting slow connection speed tests");jc.ULS.sendTraceTag(570712142,0,50,
"Periodic ping tests results: {0}",ec);Ra.Z4c=1}}};this.Vh=function(Db,ec){Db=ec.context.methodName;if(Db===Fe.a.Ixb||Db===Fe.a.BLa)Ra.TEb++,Db=Date.now(),Ra.CCj(Db)&&(Ra.TEb=0,Ra.Evd=Db,Ra.GKj())};this.mda=function(){Ra.DWd("OnThrottledUserActivity")};this.bX=function(){Ra.XWd("OnDocumentHidden")};this.Dza=function(){Ra.DWd("OnDocumentUnhidden")};this.$=Y;if(this.eUd=nd.EwaSettings.isChangeGateEnabled("OfficeVSO:5186511_SendSlowNetworkPingTests")&&this.g0g())this.FYf=[kg.a.jGc],this.Z4c=1,this.K4c=
{},this.$.ea.xf.Zsa(this.mda),this.$.da.Ya(291,function(Db){Db.IGa(Ra.bX);Db.dpb(Ra.Dza)})}function J(Y){var Ra=this;this.flc=this.data=null;this.Ncd=0;this.sFe=null;this.Yzf=function(Db,ec){ec.tQ?(Ra.data=new ia(Oc.a.Ra.Ob,Ra.$,5===ec.mpa,0!==ec.mpa,Ra.$.tf.disconnectionSource,Ra.sFe),Ra.flc=Ra.$.tf.Ynf,Ra.Ncd=1,Ra.$.na.tf.HLg(Ra.Xn),Ye.a(Ra.$).DXc(Ra.BZf)):(Ra.data.JNi(Ra.$,5===ec.mpa),Ra.$.na.tf.fVf(Ra.Xn),Ra.data.lastFailedRequestToOnlineTimeGapSec=Jc.getElapsedSeconds(Ra.flc,Oc.a.Ra.Ob),nd.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_7pzab_ConnectivityIssues")?
Ke.b().mLb(557682689,0,50,aa.connectivityIssues,Ra.data.durationMs,"ConnectivityIssuesTelemetryManager.OnConnectivityIssuesEnded: this partial interactivity's info: {0}",Sg.a.Kc(Ra.data)):jc.ULS.sendTraceTag(557682689,0,50,"ConnectivityIssuesTelemetryManager.OnConnectivityIssuesEnded: this partial interactivity's info: {0}",Sg.a.Kc(Ra.data)),nd.EwaSettings.isChangeGateEnabled("OfficeVSO:5508233_ReportNetworkDownVeto")&&Ra.data&&Ra.data.isToastShown&&cc.Health.instance.recordQosError(cb.a.V1g,[bc.a.Hlc],
!0,!1,!1,!1,null),Ye.a(Ra.$).qMd(Ra.BZf),Ra.data=null)};this.BZf=function(Db,ec){Ra.data.svj(ec.NV)};this.Xn=function(Db,ec){Ra.data.Yaj(ec.context.methodName);Db=Oc.a.Ra.Ob;ec=Jc.getElapsedSeconds(Ra.flc,Db);Ra.flc=Db;ec>Ra.data.longestDurationBetweenFailedRequestsSec&&(Ra.data.longestDurationBetweenFailedRequestsSec=ec);Ra.Ncd++;Ra.data.averageDurationBetweenFailedRequestsSec=Ra.AXg(ec)};this.Vzf=function(Db,ec){Ra.sFe=ec.aSj};this.$=Y;Tc.a(this.$).yg.Sqe(this.Yzf);this.$.tf.Rqe(this.Vzf)}function aa(){}
function ia(Y,Ra,Db,ec,gd,Jd){Y=ba.call(this,Y,Ra,ec)||this;Y.swappedByOffline=!1;Y.swappedOffline=!1;Y.averageDurationBetweenFailedRequestsSec=0;Y.longestDurationBetweenFailedRequestsSec=0;Y.lastFailedRequestToOnlineTimeGapSec=0;Y.disconnectionSource=null;Y.errorDataDuringConnectivityIssuesMode=null;Y.failedRequests=[];Y.triggeringRequest=null;Y.type=4;Y.swappedOffline=Db;Y.disconnectionSource=Enum.toString(ve.a,gd);Y.triggeringRequest=Jd;return Y}function ba(Y,Ra,Db){var ec=this,gd;this.type=0;
this.startTime=null;this.blockedOperationsCount=this.durationMs=0;this.blockedActions=null;this.blockedUserOperationsWhileToastShown=this.durationUntilToastShownMs=0;this.toastRaiser=null;this.wasUserActiveOnPIEnd=this.wasUserActiveOnPIStart=this.hasTabbedOut=this.isToastShown=!1;this.durationUntilUserInactive=-1;this.isTaskPaneCollapsed=this.isTaskPaneShown=this.isDialogShown=!1;this.Myf=function(Jd,Xd){ec.blockedOperationsCount++;Jd=String.format("{0}_{1}_{2})",Xd.componentName,Xd.actionName,Xd.details);
ec.blockedActions[Jd]=ec.blockedActions[Jd]?ec.blockedActions[Jd]+1:1;ec.isToastShown&&ec.blockedUserOperationsWhileToastShown++};this.qFd=function(Jd){ec.durationUntilUserInactive=Jc.getElapsedSeconds(ec.startTime,Oc.a.Ra.Ob);Jd.XMd(ec.qFd)};this.bX=function(){ec.hasTabbedOut=!0};this.nda=function(Jd,Xd){Xd.rKf!==ec.type||ec.isToastShown||(ec.durationUntilToastShownMs=td.a(Oc.a.Ra,ec.startTime),ec.toastRaiser=Xd.toastRaiser,ec.isToastShown=!0)};this.startTime=Y;this.durationUntilToastShownMs=0;this.blockedActions=
{};this.isToastShown=Db;if(null===(gd=Ra.ea)||void 0===gd?0:gd.xf)this.wasUserActiveOnPIStart=Ra.ea.xf.Kr;this.Ik(Ra);nd.EwaSettings.isChangeGateEnabled("OfficeVSO:5340853_ImprovePIData")?(this.isDialogShown=0<Ra.yb.JS,Y=Ra.da.Aa(183),this.isTaskPaneShown=!!Y&&Y.isVisible&&!Y.isCollapsed,this.isTaskPaneCollapsed=!!Y&&Y.isVisible&&Y.isCollapsed):this.isTaskPaneCollapsed=this.isTaskPaneShown=this.isDialogShown=!1}function ra(){}function ka(Y){var Ra=Yb.call(this)||this;Ra.Qc=Y;Ra.Xb();return Ra}function da(Y,
Ra,Db){Db=void 0===Db?null:Db;var ec=$a.call(this)||this;ec.Y0a=null;ec.O6a=null;ec.Lgc=null;ec.PDa=null;jc.ULS.sendTraceTag(537155417,0,50,"MergeSuspensionManager.ctor started");ec.$=Y;ec.qmb=new Gb(Y);nd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SelectionAdjust",!1)&&(ec.Z7=new ha(ec.$));ec.T2a=new Fa(ec.$.na.ta,ec.$,void 0,void 0,ec.Z7);ec.uei(Y,Db);ec.Lga=new $b(ec.PDa,ec.qmb);ec.NNd=new ab(Y,ec.Lga,Ra,ec.T2a);nd.EwaSettings.ma(255)&&(ec.Lgc=new nb(Y,ec));jc.ULS.sendTraceTag(588276810,
0,50,"MergeSuspensionManager created");return ec}function ha(Y){var Ra=this;this.XAc=0;this.ow=this.Ow=null;this.U4d=new Aa;this.V4d=new Aa(!0);this.rD=0;this.dOj=!1;this.GFi=1E4;this.Qg=function(){Ra.c_c(!0,!1)};this.M$a=function(){Ra.c_c(!1,!1)};this.$=Y;this.gridView=qf.g(this.$);this.gridView.Da.aq(this.Qg);this.gridView.Da.xr(this.M$a);this.gridView.Da.Jqe(this.M$a);this.gridView.Da.Mha(this.M$a);this.Gkj=nd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReportSelections",!1);this.n0f=
nd.EwaSettings.isChangeGateEnabled("OfficeVSO:6065693_SelectionAdjustManagerRefactor");this.cte=nd.EwaSettings.isChangeGateEnabled("OfficeVSO:6177968_aggregateSelectionAdjustStatsByVisibillity");this.$.da.Ya(276,function(){Rd.a(Ra.$).t3(Ra.U4d);Ra.cte&&Rd.a(Ra.$).t3(Ra.V4d)})}function qa(Y,Ra,Db,ec,gd){this.WG=Ra;this.m$=Db;this.$Xb=ec;this.nog=gd;this.Thb&&(this.H5d=qf.g(Y).Da.N4a(this.selectedRanges[0],gd))}function Aa(Y){this.differentSheetAdjust=this.parallel=this.errors=this.nonContinuous=this.divergence=
this.adjusted=this.adjustedDidntChange=0;this.Xci=void 0===Y?!1:Y}function Fa(Y,Ra,Db,ec,gd){Db=void 0===Db?null:Db;ec=void 0===ec?null:ec;gd=void 0===gd?null:gd;var Jd=wd.call(this)||this;Jd.klc=null;Jd.vFd=0;Jd.documentVisibilityObserver=null;Jd.ta=Y;Jd.SNd=Ra.ya.MergeSuspensionRequestThrottlingTimeInMs;var Xd=Ra.ya.GetRangeContentPrefetchDelayForMergeInMs;Jd.Qy=function(){Ra.o_f(Xd)};Jd.wh=Db||Oc.a.Ra;Jd.G1d=0;Jd.xP=ec;Jd.Z7=gd;Jd.Y7c=nd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DPMHiddenTabRequestThrottling",
!1);Jd.q9f=nd.EwaSettings.isChangeGateEnabled("OfficeVSO:6101783_SkipVirtualGetRangeForDPMWhenTabHidden2");Jd.yRf=nd.EwaSettings.isChangeGateEnabled("OfficeVSO:6126617_RefactorSelectionAdjustRequestsManagement");Jd.Y7c&&(Jd.Hai=Ra.ya.MergeSuspensionHiddenTabRequestThrottlingTimeInMs);(Jd.q9f||Jd.Y7c)&&Ra.da.Ya(291,function(xe){Jd.documentVisibilityObserver=xe});return Jd}function ab(Y,Ra,Db,ec){var gd=Fb.call(this)||this;gd.T2a=null;gd.Z7=null;gd.kCb=0;gd.Z8a=null;gd.lCb=null;gd.DFf=function(Jd,Xd){gd.T2a.FQg(Xd.Bma)};
gd.zGb=function(Jd,Xd){Xd.hya?gd.nKj():gd.bBc()};gd.TDf=function(){gd.kCb=0};gd.E0f=function(){var Jd=gd.J6.Hid();Ua(gd.ta,null!=Jd.SuspensionStartTimestamp?Jd.SuspensionStartTimestamp:0,null,function(){gd.aTi(Jd)},null,null,gd.ta.fc())};gd.Z8=function(Jd,Xd){if(Xd){Xd.cHa.MergeCount=gd.J6.Hid();var xe=qf.g(gd.$).CFi();Jd=xe.min;xe=xe.max;nd.EwaSettings.isChangeGateEnabled("OfficeVSO:5524817_LogOnMergeRaceCondition2")?Xd.cHa.ClientRevisions=Object.assign(new xa,{Min:Jd,Max:xe,MaxFromBlockCache:qf.g(gd.$).Da.Ctf}):
Xd.cHa.ClientRevisions=Object.assign(new xa,{Min:Jd,Max:xe})}};gd.$=Y;gd.pta=Db;gd.J6=Ra;gd.J6.DKg(gd.DFf);gd.J6.q0b(gd.zGb);gd.J6.LJg(gd.TDf);gd.$.na.D$(gd.Z8);gd.ta=gd.$.na.ta;gd.SNd=gd.$.ya.MergeSuspensionRequestThrottlingTimeInMs;gd.gvi=gd.$.ya.KeepBlockingPendingMergesRequestIntervalMs;gd.T2a=ec;jc.ULS.sendTraceTag(588276807,0,50,"RequestController initialized");return gd}function Ua(Y,Ra,Db,ec,gd,Jd,Xd){Xd=Y.Ma(1,void 0===Xd?null:Xd);Xd.suspensionStartTimestamp=Ra;return Mc.i(Y,"KeepBlockingPendingMerges",
Xd,Db,ec,gd,Jd,0)}function bb(Y,Ra,Db,ec,gd,Jd,Xd,xe){xe=Y.Ma(1,void 0===xe?null:xe);xe.viewportState=Ra;xe.allowViewAdjustment=Db;return Mc.i(Y,"DoPendingMergeNew",xe,ec,gd,Jd,Xd,0)}function xa(){}function Gb(Y){var Ra=Oa.call(this)||this;Ra.L2=null;Ra.llc=0;Ra.Y8=function(Db,ec){var gd;if(null===(gd=null===ec||void 0===ec?void 0:ec.qd)||void 0===gd?0:gd.MergeCount)sf.a.equals(ec.qd.SessionId,Ra.$.ea.sessionId,!1)?Ra.bQa(ec.qd.MergeCount,Gb.h$c):jc.ULS.sendTraceTag(579737049,0,50,"Stale merge counter ({0}/{1})",
ec.qd.MergeCount.Current,ec.qd.MergeCount.Pending)};Ra.aEb=function(Db,ec){(null===ec||void 0===ec?0:ec.Bma)&&Ra.bQa(ec.Bma,Gb.I2d)};Ra.Rxc=function(){Ra.oXf();Ra.dPf(Ra.L2)};Ra.T$a=function(Db,ec){ec.FEe&&Ra.L2.SuspensionStartTimestamp&&jc.ULS.sendTraceTag(17318084,0,50,"PendingMergeMonitor.OnEditCellEnded: committed with counter {0}",zb(Ra.L2))};Ra.oXf();Ra.$=Y;Ra.$.na.Hq(Ra.Y8);Ra.$.ea.ek(Ra.Rxc);Ra.$.ea.xQ(Ra.Rxc);qf.g(Ra.$).zc.Wo(Ra.T$a);Ra.$.da.Ya(292,function(Db){Db.ipb(Ra.aEb);jc.ULS.sendTraceTag(588276809,
0,50,"PendingMergeMonitor initialized")});return Ra}function $b(Y,Ra){var Db=ca.call(this)||this;Db.RFb=function(ec,gd){ec=Db.getState();var Jd=Db.Cma;Db.Cma=gd.Bma;gd=Db.getState();Db.yAi(ec,gd,Jd);Db.raiseEvent($b.Azd);Db.NXe(ec,gd)};Db.gQa=function(ec,gd){ec=Db.getState();Db.qL=gd.qL;gd=Db.getState();Db.NXe(ec,gd)};Db.Jia=Y;Db.Jia.m0b(Db.gQa);Db.$ab=Ra;Db.$ab.ipb(Db.RFb);Db.Cma=Object.assign(new R.a,{Pending:0,Current:0,SuspensionStartTimestamp:null});Db.qL=Db.$di();return Db}function oa(){return this}
function Ma(){}function Za(Y){var Ra=Ba.call(this)||this;Ra.hya=Y;return Ra}function gb(Y){return(null===Y||void 0===Y?void 0:Y.SuspensionStartTimestamp)&&Y.Pending>Y.Current}function zb(Y){return Y?String.format("{0} / {1} @{2}",Y.Current,Y.Pending,Y.SuspensionStartTimestamp):null}function nb(Y,Ra){var Db=oc.call(this)||this;Db.statusBarManager=null;Db.$Ad=!1;Db.RFb=function(ec,gd){ec=String.format("{0}{1}",gd.Bma.Current===gd.Bma.Pending?"\u26ad":"\u26ae",gd.Bma.Current);sf.a.equals(Db.Vnc,ec,!1)||
(Db.Vnc=ec,Db.Xz())};Db.gQa=function(ec,gd){ec=0==gd.qL;Db.$Ad!==ec&&(Db.$Ad=ec,Db.Xz())};Db.mergeSuspensionManager=Ra;Db.mergeSuspensionManager.$ab.ipb(Db.RFb);Db.Vnc="";Yg.a.n3(1905775613,k.a.Lc,0,1);Db.Ka=Y.Ka;Db.MOb=new pa;Y.da.Ya(29,function(ec){Db.mergeSuspensionManager&&(Db.statusBarManager=ec,ec.WJ(Db),Db.mergeSuspensionManager.Jia.m0b(Db.gQa))});Db.Ka.o3(Db.MOb);return Db}function pa(){return Ab.call(this)||this}function Ja(Y,Ra){Ra=void 0===Ra?null:Ra;var Db=wh.call(this,1)||this;Db.Dga=
!1;Db.AO=function(){Db.refresh()};Db.hAf=function(){Db.refresh()};Db.$=Y;Db.xae=Ra||eh.a(Y).ER(Zf.a.idle);eh.a(Y).CXc(Db.hAf);Db.N6a.Gq(Db.AO);Db.refresh();return Db}function Da(Y){var Ra=Gf.call(this)||this;Ra.Qnf=null;Ra.tSa=new se.a;Ra.Y3j=Y;return Ra}function ib(Y,Ra){this.handler=null;this.publisher=Y;this.qL=Ra}function Rb(Y){var Ra=ei.call(this,1)||this;Ra.Dga=!1;Ra.czf=function(){Ra.refresh()};Ra.dzf=function(){Ra.refresh()};Ra.gridView=qf.g(Y);Ra.gridView.zc.wl(Ra.dzf);Ra.gridView.zc.Wo(Ra.czf);
Ra.refresh();return Ra}function wc(Y){return Ph.call(this,Y)||this}function Cb(Y,Ra){this.$=Y;this.uploaderCreator=Ra}function lb(Y,Ra,Db,ec,gd,Jd){var Xd=rb.call(this,null,Db,ec)||this;Xd.urf=0;Xd.hVi=function(xe){Ka.a(xe)?jc.ULS.sendTraceTag(537155799,0,10,"OnlinePictureUploaderWrapper.OnPictureUploadSuccess: Operation succeeded with errors. Errors: {0}",Fd.a.Wc(xe.Errors)):(jc.ULS.sendTraceTag(537155801,0,50,"OnlinePictureUploaderWrapper.OnPictureUploadSuccess: Operation succeeded."),xe.Result?
Xg.a(Xd.$).soa(1,xe.Result):jc.ULS.sendTraceTag(537155800,0,10,"OnlinePictureUploaderWrapper.OnPictureUploadSuccess:Result.result is null"))};Xd.gVi=function(){jc.ULS.sendTraceTag(537155798,0,10,"OnlinePictureUploaderWrapper.OnPictureUploadFailed: Operation failed")};Xd.$=Y;Xd.Xd=Ra;Xd.K1=Jd;Xd.Xte=Je.a.instance.qc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");Xd.showDialog();return Xd}function yb(Y,Ra,Db,ec,gd,Jd){var Xd=oe.call(this)||this;Xd.Kic=!1;Xd.zxa=null;Xd.SS=null;Xd.KOa=
null;Xd.wMi=function(){Xd.Dva(Xd.Lqb)};Xd.rvd=function(xe){xe.keyCode===Sys.UI.Key.tab&&("KeepFocusDiv"!==xe.target.id||xe.shiftKey?"KeepFocusStartDiv"===xe.target.id&&xe.shiftKey&&(xe.preventDefault(),document.getElementById("KeepFocusDiv").focus()):(xe.preventDefault(),document.getElementById("KeepFocusStartDiv").focus()))};Xd.rTi=function(){Xd.Gpb&&(Xd.Gpb.launchUpsellExperience("stockimages"),jc.ULS.sendTraceTag(537155807,0,50,"OnLaunchM365Upsell: Launched Dime Upsell flow"))};Xd.uo=Jd;Xd.$=Y;
Xd.zef=Ra;Xd.Gpb=Db;Xd.sBa=[];Xd.Utf=ec;Xd.bjh=gd;Xd.qte=Xd.$.ya.InsertOnlinePictureMaxCountOfImagesToInsert;Xd.ig=Xd.uah();return Xd}function pc(){}function Ta(Y,Ra){return Yf.call(this,Y,bg.a.Fba(Ra))||this}function rb(Y,Ra,Db){Y=ic.call(this,Y,Ra,Db)||this;Y.Isa=null;Y.KWb=null;return Y}function ic(Y,Ra,Db){this.Oj=this.nFd=null;this.NFa=this.lsa=0;this.bUb=null;this.VT=Y;this.re=Ra;this.vb=Db;this.N2a=!1;this.o1d=!0;this.Llj();this.m$a=this.ha.ra("NativeFileOpenDialogIsEnabled")}function Va(Y){var Ra=
Zg.call(this)||this;Ra.tod=null;Ra.$=Y;Ra.Xb();return Ra}function jb(Y){var Ra=Ag.call(this)||this;Ra.$=Y;Ra.Xb();return Ra}function rc(Y,Ra){this.bYe=Y;this.RHh=Ra}function Cc(Y){this.$=Y}function Hc(Y){var Ra=ph.call(this)||this;Ra.$=Y;Ra.Xb();return Ra}function Nb(Y,Ra,Db){var ec=Hi.call(this)||this;ec.statusBarManager=null;ec.WLe=function(){ec.n8b()};ec.Ijh=function(){ec.n8b()};ec.VLe=function(gd){10===gd&&ec.n8b()};ec.onKeyDown=function(gd){if(13===gd.Ca.keyCode){gd=new ye.a(237279923,1,2,6,
null);var Jd={};ec.$.Ka.dc(gd,(Jd[Jb.a.skipClipboardAccess]=!0,Jd[Jb.a.NPe]=!0,Jd));return!0}return!1};ec.$=Y;ec.Lr=Ra;ec.xk=Db;ec.wad=!1;ec.U6f=nd.EwaSettings.getBooleanFeatureGate(Qe.a.$Qa,!1);ec.slf=nd.EwaSettings.isChangeGateEnabled("OfficeVSO:6082903_PasteToEnterKeyDownEventForGrid");ec.U6f&&ec.$.da.Ya(29,function(gd){ec.statusBarManager=gd;gd.WJ(ec)});return ec}function nc(Y){var Ra=Sh.call(this)||this;Ra.$=Y;Ra.Xm=ef.a.instance;Ra.Xb();return Ra}function Ha(Y){var Ra=this;this.d7b="";this.i3=
this.ot=null;this.Esc=!1;this.mbf=function(Db,ec){Ra.hide(void 0===Db?null:Db,void 0===ec?null:ec)};this.gridView=qf.g(Y);this.gridView.ga.nH(this.mbf)}function tb(){}function Ub(Y,Ra){var Db=Mh.call(this,Y)||this;Db.jp=null;Db.thi=function(ec,gd){1===ec?(ec=Ub.zjh[gd[Ub.yjh]],jc.ULS.sendTraceTag(537167683,0,50,"InsertCopiedCutCellsDialog.InsertCopiedCutCellsDialogHandler OK button pressed with valid input, shift direction = {0}",0===ec?"Horizontal":"Vertical"),Db.jp.setResult(ec)):(jc.ULS.sendTraceTag(537167682,
0,50,"InsertCopiedCutCellsDialog.InsertCopiedCutCellsDialogHandler cancel button pressed"),Db.jp.Hu())};Db.mh(Ra);return Db}function gc(Y){this.CHc=this.RRc=null;this.$=Y}function Eb(){}function Tb(){}function Wc(){}function T(){}function ua(Y){this.D5c=this.mua=null;this.Xab=15;this.$=Y}function ma(Y,Ra){this.$=Y;this.Zpb=Ra}function wa(Y,Ra,Db,ec){Y=sc.call(this,Y)||this;Y.isFromCurrentSession=!1;Y.top=0;Y.left=0;Y.isFromCurrentSession=Ra;Y.top=Db;Y.left=ec;return Y}function Ca(Y,Ra,Db,ec,gd){gd=
void 0===gd?null:gd;var Jd=ac.call(this,Y,"ArtCopyPasteHandler")||this;Jd.o2g="XLO";Jd.p2g="3";Jd.xV=new Sb(Y);Jd.laa=Ra;Jd.Q_a=Db;Jd.ga=qf.g(Y).ga;Jd.F5c=gd||new mb(Jd.laa);Jd.U1i=new db(Db,Y);Jd.Zpb=ec;return Jd}function db(Y,Ra){this.QJb=new bd.a;this.Q_a=Y;this.$=Ra;this.B7i=function(Db){return Promise.resolve(Db)};this.dGb=function(Db){return Promise.reject(Db)}}function Sa(Y,Ra,Db,ec,gd,Jd,Xd,xe,cf){this.promise=null;this.ribbonCommandInfo=Y;this.destination=Ra;this.hLe=Db;this.y1d=gd;this.u1=
Jd;this.item=Xd;this.pasteContext=xe;this.bPa=Db||Ra.FirstRow+"_"+Ra.FirstColumn;this.Dif=!0;this.aDe=cf}function hb(Y,Ra,Db,ec,gd,Jd,Xd){this.floatingObjectId=Y;this.commandParameters=Ra;this.Ur=Db;this.gfh=ec;this.a5=void 0===Jd?null:Jd;this.y1d=void 0===Xd?null:Xd;this.G7g=gd}function Xb(Y,Ra,Db,ec){Ra=qb.call(this,Y,Ra,Db,"AcrossSessionRangeCopyPasteHandler",void 0===ec?null:ec)||this;Ra.xV=new Sb(Y);return Ra}function xb(Y,Ra){Ra=void 0===Ra?null:Ra;var Db=rg.call(this,We[Y])||this;Db.copyErrorName=
0;Db.ewaErrors=null;Db.copyErrorName=Y;Db.ewaErrors=Ra;if(null===Ra||void 0===Ra?0:Ra.length)Db.innerError=new hh.a(Ra,null);return Db}function Sb(Y){this.xV=new Pg.a(!0);this.$=Y}function qb(Y,Ra,Db,ec,gd){gd=void 0===gd?null:gd;ec=ac.call(this,Y,ec)||this;ec.Q7g=Ra;ec.laa=Db;ec.G5c=gd||new mb(ec.laa);ec.gridView=qf.g(Y);ec.ga=ec.gridView.ga;ec.clipboardRangeFactory=Y.da.Aa(169);return ec}function mb(Y){this.clipboardItems=this.key=null;this.laa=Y}function ac(Y,Ra){this._name=Ra;this.$=Y;this.Xm=
ef.a.instance;this.rs=new fb(Y,qf.g(Y))}function Uc(Y){return Y.shadowWorkbookSizeExceedsLimit?!0:Zc(Y)>Fe.a.Xmc}function Zc(Y){return Y?Y.shadowWorkbookSizeExceedsLimit&&void 0!==Y.shadowWorkbookBlockedSize&&null!==Y.shadowWorkbookBlockedSize?Y.shadowWorkbookBlockedSize:Y.shadowWorkbookBase64?Y.shadowWorkbookBase64.length:0:0}function Kc(){}function va(Y){var Ra={};this.jag=(Ra["SourceItemType.Range"]=0,Ra["SourceItemType.Art"]=1,Ra);this.CNb={};Ra={};this.fag=(Ra["FloatingObjectType.Unknown"]=99,
Ra["FloatingObjectType.CardView"]=6,Ra["FloatingObjectType.Chart"]=0,Ra["FloatingObjectType.Group"]=7,Ra["FloatingObjectType.Image"]=1,Ra["FloatingObjectType.Ink"]=8,Ra["FloatingObjectType.InteractiveReport"]=4,Ra["FloatingObjectType.ModernOfficeExtension"]=3,Ra["FloatingObjectType.Shape"]=5,Ra["FloatingObjectType.Slicer"]=2,Ra["FloatingObjectType.Unsupported"]=100,Ra);Ra={};this.MZc=(Ra["99"]="FloatingObjectType.Unknown",Ra["6"]="FloatingObjectType.CardView",Ra["0"]="FloatingObjectType.Chart",Ra["7"]=
"FloatingObjectType.Group",Ra["1"]="FloatingObjectType.Image",Ra["8"]="FloatingObjectType.Ink",Ra["4"]="FloatingObjectType.InteractiveReport",Ra["3"]="FloatingObjectType.ModernOfficeExtension",Ra["5"]="FloatingObjectType.Shape",Ra["2"]="FloatingObjectType.Slicer",Ra["100"]="FloatingObjectType.Unsupported",Ra);Ra={};this.iag=(Ra["RibbonCommand.Copy"]=-911352779,Ra["RibbonCommand.Cut"]=-1985798686,Ra);Ra={};this.WOd=(Ra["-911352779"]="RibbonCommand.Copy",Ra["-1985798686"]="RibbonCommand.Cut",Ra);Ra=
{};this.hag=(Ra["InputManager.InputMethod.NotDefined"]=-1,Ra["InputManager.InputMethod.Unknown"]=0,Ra["InputManager.InputMethod.Keyboard"]=1,Ra["InputManager.InputMethod.Mouse"]=2,Ra["InputManager.InputMethod.Touch"]=3,Ra["InputManager.InputMethod.CrossSlide"]=9,Ra);this.qla={};Ra={};this.gag=(Ra["FrameMode.None"]=0,Ra["FrameMode.Reading"]=1,Ra["FrameMode.Edit"]=2,Ra);this.v4a={};Ra={};this.kag=(Ra["UILocation.Unknown"]=0,Ra["UILocation.UpperRibbon"]=1,Ra["UILocation.Ribbon"]=2,Ra["UILocation.QAT"]=
3,Ra["UILocation.Jewel"]=4,Ra["UILocation.NavigationPane"]=5,Ra["UILocation.KeyboardShortcut"]=6,Ra["UILocation.StatusBar"]=7,Ra["UILocation.Dialog"]=8,Ra["UILocation.Floatie"]=9,Ra["UILocation.NotificationBar"]=10,Ra["UILocation.StandaloneCuiRoot"]=11,Ra["UILocation.TaskPane"]=12,Ra["UILocation.HeroDock"]=13,Ra["UILocation.SingleLineRibbon"]=14,Ra["UILocation.MultilineRibbon"]=15,Ra["UILocation.Overflow"]=16,Ra["UILocation.TellMe"]=17,Ra["UILocation.FarPeripheralControls"]=18,Ra["UILocation.ContextMenu"]=
19,Ra["UILocation.DialogMenu"]=20,Ra["UILocation.Header"]=21,Ra["UILocation.FileMenu"]=22,Ra["UILocation.Toolbar"]=26,Ra["UILocation.Canvas"]=30,Ra);this.Yr={};this.$=Y;this.qla.notDefined="InputManager.InputMethod.NotDefined";this.qla.unknown="InputManager.InputMethod.Unknown";this.qla.keyboard="InputManager.InputMethod.Keyboard";this.qla.mouse="InputManager.InputMethod.Mouse";this.qla.touch="InputManager.InputMethod.Touch";this.qla.crossSlide="InputManager.InputMethod.CrossSlide";this.v4a.none=
"FrameMode.None";this.v4a.reading="FrameMode.Reading";this.v4a.edit="FrameMode.Edit";this.Yr.unknown="UILocation.Unknown";this.Yr.upperRibbon="UILocation.UpperRibbon";this.Yr.ribbon="UILocation.Ribbon";this.Yr.QAT="UILocation.QAT";this.Yr.jewel="UILocation.Jewel";this.Yr.navigationPane="UILocation.NavigationPane";this.Yr.keyboardShortcut="UILocation.KeyboardShortcut";this.Yr.statusBar="UILocation.StatusBar";this.Yr.dialog="UILocation.Dialog";this.Yr.floatie="UILocation.Floatie";this.Yr.notificationBar=
"UILocation.NotificationBar";this.Yr.standaloneCuiRoot="UILocation.StandaloneCuiRoot";this.Yr.taskPane="UILocation.TaskPane";this.Yr.heroDock="UILocation.HeroDock";this.Yr.singleLineRibbon="UILocation.SingleLineRibbon";this.Yr.multilineRibbon="UILocation.MultilineRibbon";this.Yr.overflow="UILocation.Overflow";this.Yr.tellMe="UILocation.TellMe";this.Yr.farPeripheralControls="UILocation.FarPeripheralControls";this.Yr.header="UILocation.Header";this.Yr.fileMenu="UILocation.FileMenu";this.Yr.contextMenu=
"UILocation.ContextMenu";this.Yr.dialogMenu="UILocation.DialogMenu";this.Yr.toolbar="UILocation.Toolbar";this.Yr.canvas="UILocation.Canvas";this.CNb.range="SourceItemType.Range";this.CNb.art="SourceItemType.Art"}function fb(Y,Ra){this.blc=this.sOa=null;this.Zhc=nd.EwaSettings.getBooleanFeatureGate(Qe.a.L6b,!1);this.Upd=!1;this.KNa=nd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CopyPasteWFEIncreasedLimits",!1);this.$=Y;this.gridView=Ra;this.Upd&&(this.$.userOperationManager.Xu(Object(za.a)(this,
this.kG,"onQueueChanged")),this.Dv=new se.a)}function Pb(Y){this.parameters=null;this.parameters=Y}function sc(Y){this.pasteParameters=null;this.pasteParameters=Y}function hd(Y,Ra){this.content=this.destinationRange=null;this.destinationRange=Y;this.content=Ra}function Ob(Y,Ra,Db){this.destinationRange=this.sourceRange=null;this.pasteFlags=0;this.sourceRange=Y;this.destinationRange=Ra;this.pasteFlags=Db}function Ac(Y,Ra,Db,ec,gd,Jd,Xd,xe){xe=void 0===xe?null:xe;Xd=Y.Ma(1,void 0===Xd?null:Xd);Xd.pasteParameters=
Ra;return Mc.i(Y,"Paste",Xd,Db,ec,gd,Jd,64,xe)}function sb(Y,Ra,Db,ec,gd,Jd,Xd,xe){xe=void 0===xe?null:xe;Xd=Y.Ma(1,void 0===Xd?null:Xd);Xd.copyParameters=Ra;return Mc.i(Y,"Copy",Xd,Db,ec,gd,Jd,0,xe)}function ad(Y,Ra,Db,ec,gd,Jd,Xd,xe,cf){cf=void 0===cf?null:cf;xe=Y.Ma(9,xe);xe.destinationRange=Ra;xe.source=Db;return Mc.i(Y,"PasteString",xe,ec,gd,Jd,Xd,64,cf)}function Hd(Y,Ra,Db,ec,gd,Jd,Xd,xe){xe=void 0===xe?null:xe;Xd=Y.Ma(1,Xd);Xd.pasteHtmlParameters=Ra;return Mc.i(Y,"PasteHtmlContent",Xd,Db,ec,
gd,Jd,64,xe)}function Ne(){this.o1a=this.eDe=null}function Ud(Y,Ra,Db,ec,gd,Jd,Xd,xe,cf){cf=void 0===cf?null:cf;var pf=de.call(this)||this;pf.pasteShortcutManager=null;pf.pgf=nd.EwaSettings.Gb();pf.KNa=nd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CopyPasteWFEIncreasedLimits",!1);pf.scg=null;pf.y8a=!1;pf.$if=nd.EwaSettings.isChangeGateEnabled("OfficeVSO:6004791_MergedCellOverlapTelemetry");pf.gEd=function(ff){pf.CBj(ff)&&(pf.rs.Wyb(),jc.ULS.sendTraceTag(537167777,0,50,"CopyPasteInfrastructure.OnMetadataChanged: found that cut/copy operation was preformed in another session therefore removed the highlight in this session."))};
pf.dBi=function(ff,tg){jc.ULS.sendTraceTag(537167768,0,50,"CopyPasteInfrastructure.LogShortcutDialogAndRestoreFocus: Got shortcut dialog, user pressed [{0}]. userPressedExtensionLink={1}",ff,tg);pf.gridView.focus()};pf.vd=function(ff,tg){tg.eL||tg.Vg||pf.ps("OnWorkbookOpened",!1).catch(function(){})};pf.li=function(ff,tg){ff=id(pf.rL);var Ig=pf.rs.Mxb(ff);Ig&&(tg.oa&&tg.oa.sheetName===Ig.sheetName&&Ig.isFromCurrentSession(pf.$)?pf.rs.Ibf(Ig.ranges,ff.commandParameters.commandType):pf.rs.Wyb())};pf.Dpc=
function(ff,tg){ff=id(pf.rL);(ff=pf.rs.Mxb(ff))&&tg.item&&tg.item.sheetName===ff.sheetName&&ff.isFromCurrentSession(pf.$)&&pf.ps("OnItemDeleting",!1).catch(function(){})};pf.tGb=function(ff,tg){pf.pgf?pf.scg(ff,tg):pf.FHf()};pf.GS=function(ff,tg){1===tg.Au&&tg.Mg.operation.flags&2&&pf.ps("OnQueueItemChanged/ItemRemoved",!1).catch(function(){})};pf.$=Y;pf.Jh=Db;pf.gridView=qf.g(Y);pf.rs=gd;pf.shi=Jd;pf.rL=Ra;pf.J5b=ec;pf.getStringifiedError=cf||copyPasteInfra.getStringifiedError;pf.S6f=1===xe;pf.Ik();
pf.copyPasteShortcutDialogFactory=pf.$.da.Aa(85);jc.ULS.shipAssertTag(537167825,0,!!pf.copyPasteShortcutDialogFactory,"CopyPasteInfrastructure.ctor: this.copyPasteShortcutDialogFactory shouldn't be null.");Xd||(jc.ULS.sendTraceTag(537167824,0,50,"CopyPasteInfrastructure.ctor: userId is null, using default userId."),Xd=Ud.Xgh);pf.userHash=Ee.a.sw(Xd);pf.nFi="CultureTag: "+ef.a.instance.Itb+" HASH: ";pf.rL.addMetadataChangeListener(Ud.muf,pf.gEd);pf.bzd=pf.$.ya.MaxCopyPasteLength;pf.mPa=pf.KNa?nd.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.CopyPasteHtmlImportMaxLength",
pf.$.ya.CopyPasteMaxPayloadLength):Fe.a.mPa;pf.Do=nd.EwaSettings.getBooleanFeatureGate(Qe.a.$Qa,!1);pf.Do&&Y.da.Ya(478,function(ff){pf.pasteShortcutManager=ff});pf.pgf&&(pf.scg=Be.a(function(){pf.FHf()},1,pf.$.la,"CopyPasteInfrastructure.OnStartEditInternal",!0));return pf}function Ge(Y){if(!Y)return"null";var Ra=[];Y=Cl(Y.get());for(var Db=Y.next();!Db.done;Db=Y.next())Db=Db.value,Db=String.format("{0}({1})",Db.clipboardDataFormat,Db.data.length),Array.add(Ra,Db);Ra.sort();return Ra.join(",")}function Sc(Y){switch(Y){case 0:return"None";
case 2:return"Art";case 1:return"Range";default:return"Unknown"}}function Pc(Y,Ra){return Y?Ra&&Ra.ya?Y.sessionId!==Ra.ya.UserSessionId:(jc.ULS.shipAssertTag(537166209,0,!1,"ewaControl shouldn't be null"),!1):(jc.ULS.shipAssertTag(537166210,0,!1,"copyContext shouldn't be null"),!1)}function Zd(){}function ie(){}function vd(){}function Lb(Y,Ra,Db,ec){this.$=Y;this.originalDestinations=Ra;this.V$b=Db;this.xog=ec;this.yyg=this.originalDestinations;this.nsg=this.V$b;this.Ovg="PasteRecoveryUI"}function id(Y){return Y&&
(Y=Y.getCachedMetadata(),null===Y||void 0===Y?0:Y.lastCopy)?Y.lastCopy:null}function uc(Y){return Y.clipboardItems&&(Y=Y.clipboardItems.getItem($d.jli))&&"1"===Y?!0:!1}function ed(Y){return Cd(Y)&&!(void 0===Y.clipboardItems||null===Y.clipboardItems)&&!!Y.clipboardItems.getItem($d.png)&&!Y.clipboardItems.getItem($d.qX)}function Cd(Y){return Y.clipboardItems&&(Y=Y.clipboardItems.getItem($d.Foi))&&"1"===Y?!0:!1}function $d(){}function La(){}function od(Y){return!!Y&&Object.getType(Y)===ne}function ne(Y,
Ra,Db,ec,gd){ec=He.call(this,ec,gd)||this;jc.ULS.shipAssertTag(537167645,0,!!Ra&&0<Ra.length,"RangeSourceItem.ctor: ranges should not be null or empty");ec.$=Y;ec.ranges=Ra;ec.sheetName=Db;return ec}function qd(Y,Ra,Db,ec,gd){Db=He.call(this,Db,ec)||this;Db.activeFloatingObjectControlId=Y;Db.sheetName=Ra;Db.type=gd;return Db}function He(Y,Ra){var Db=this;this.xLh=function(){var ec={};ec.SourceItem=Db.toString();return ec};this.sessionStateId=Y;this.sessionId=Ra;this.toJSON=this.xLh}function Ue(Y,
Ra,Db,ec,gd){var Jd=Y.Stopwatch,Xd={};Xd.a=gd;Xd.e=Jd.id;Xd.c="RearrangeRowColumn";Xd.b="mouse";Xd.d=Y.OperationId.toString();Xd.f=Db.toString();Xd.g=ec.toString();Xd.h=Ra.toString();Xd.i=Y.DragDropIsShiftKeyDown;Xd.j=!0;Xd.o=Jd.Gc;Xd.q=!1;Xd.r=Y.CopyPasteTargetType.toString();Xd.s=Y.EncounteredDeploymentErrors;return Xd}function zf(Y){Y=If.call(this,Y)||this;Y.n2g=function(){jc.ULS.sendTraceTag(537167827,0,50,"ClipboardReadPermissionAskDialog OK button pressed")};jc.ULS.sendTraceTag(537167828,0,
50,"ClipboardReadPermissionAskDialog.ClipboardReadPermissionAskDialog");Y.lc=0;Y.Bc(1,ef.a.instance.fa(2192));var Ra=ef.a.instance.fa(2190),Db=Y.iW();Y.initializeAndShow(Ra,Y.n2g,Db);return Y}function Hf(){this.tb=null}function De(){this.ckb=this.hUb=this.gw=null}function Ae(Y,Ra,Db,ec,gd){this.gw=Y;this.pkb=Ra;this.lkb=Db;this.xhe=void 0===ec?null:ec;this.ymb=void 0===gd?null:gd}function yd(){this.tb=null}function je(Y){this.oc=Y}function we(){this.rme=0;this.dYa=Array(5);this.dYa[0]=10;this.dYa[1]=
15;this.dYa[2]=50;this.dYa[3]=100;this.dYa[4]=200}function Bc(Y,Ra,Db,ec,gd){this.zbc=!1;this.Rtb=null;this.La=Y;this.sZa=Ra;this.rXb=Db;this.m2=ec;this.uHc=gd}function Od(){this.HSf=this.BXf=this.Hbg=this.zlc=this.instance=null}function ae(Y,Ra,Db){this.La=Y;this.jf=Ra;this.LUb=Db}function Ad(){this.completed=this.fej=!1}function Ve(){this.Pke=this.afe=this.u5d=!0;this.Jjj=this.i3i=null;this.bHi=!1;this.locale=null;this.gfg={}}function kf(){}function Fc(){this.QWb=this.gUb=null}function fd(Y){return Of.call(this,
Y)||this}function jd(){this.tb=null}function zd(Y,Ra){if(void 0===Y||null===Y||void 0===Ra||null===Ra)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.vb=Y;this.Yg=Ra;this.mTc=this.Ee=null}function zc(){this.iNe=this.Uig=this.fu=0;this.jNe=this.Vig=this.CIa="";this.YTc=this.ufa=2}function $e(Y,Ra){this.DIc=0;this.z4b=null;this.Bkb=new te(Y,Ra);this.vb=Y;Ra=Y.Wa("HostAuthType");this.sFa=Y.ra("OcpsIsEnabled")&&Y.ra("IsO365CommercialHost")&&!(void 0===Ra||null===Ra)&&"aad"===
Ra.toLowerCase();this.Yfe=Af.b(Y.Wa("OcpsDefaultSettings")||"{}");this.qlb=this.pdc();Ra=this.vb.wz("ServicesControlsMicrosoftControllerServicesList")?this.vb.Jw("ServicesControlsMicrosoftControllerServicesList")||[]:[];this.$Sb=new xf.a;for(var Db=0;Db<Ra.length;Db++)this.$Sb.add(Ra[Db]);this.sFa&&!Y.ra("IsAnonymousUser")&&Y.ra("SideCarIsEnabled")?this.z4b=this.SSj():this.z4b=this.Epa(this.sFa,this.vwa("/afhs/CloudPolicySettings.ashx"),Object(za.a)(this,this.n1i,"parseCloudPolicySettingsResponse"));
this.z4b.then(function(){return null}).catch(function(ec){jc.ULS.sendTraceTag(50622685,3004,10,JSON.stringify(ec))})}function Xe(){this.ControllerConnectedServicesFeatureNames=this.PolicySettings=null}function pe(){}function Jf(Y,Ra){this.PolicySettings=null;this.ExpirationTime=0;this.PolicySettings=Y.PolicySettings;Y=new Date;Y.setMinutes(Y.getMinutes()+Ra);this.ExpirationTime=Y.getTime()}function kc(Y,Ra,Db,ec,gd){var Jd=this;Db=void 0===Db?null:Db;ec=void 0===ec?null:ec;gd=void 0===gd?null:gd;
this.Gva=this.uXb=this.Hie=this.Cra=this.xYb=null;this.Bkb=new te(Y,Ra);this.vb=Y;this.Tvg=Y.Cd("LicensingMaxRetryAttempts",0);this.MNc=Y.ra("IsO365ConsumerHost");this.LNc=Y.ra("IsO365CommercialHost");this.bVb=Y.ra("PremiumUpsellIsEnabled");this.R6d=Db;this.Wme=ec;this.La=gd;this.Bra=Y.ra("LicensingIsEnabled");this.sFa=Y.ra("OcpsIsEnabled")&&this.LNc;this.qVc=Y.ra("ShowPrivacyDialog")&&!!ec;this.hbe=Y.ra("IsAnonymousUser");this.Qcd=new Promise(function(Xd){Xd(!1)});this.BCa=new Promise(function(Xd){Xd(!0)});
this.Fva=new jf.a(dc.a.Uk());this.lZb=this.vb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SupportUserConsentBasedFeaturesInAFH",!1);this.Mde=this.CXh();this.Fsd()&&!this.hbe?(void 0!==Lc.AFrameworkApplication.sa&&null!==Lc.AFrameworkApplication.sa&&(this.xYb=Lc.AFrameworkApplication.sa.gE,void 0!==this.xYb&&null!==this.xYb&&(this.Cra=this.xYb.Kh("WebServiceCall","ApplicationFeatureHelperService"))),this.Gva=this.p_d()):this.Gva=new Promise(function(Xd){Xd({})});this.Gva.catch(function(Xd){jc.ULS.sendTraceTag(42513088,
3004,10,JSON.stringify(Xd))});this.lZb&&(this.bVb=!1,this.isFeatureEnabled("FreemiumUpsell",!0).then(function(Xd){Jd.bVb=Jd.vb.ra("PremiumUpsellIsEnabled")&&Xd;return null}))}function $c(Y,Ra,Db){this.featureName=null;this.isEnabled=!1;this.tierName=0;this.featureName=Y;this.isEnabled=Ra;this.tierName=Db}function rd(Y,Ra){this.rQj=3E5;if(void 0===Y||null===Y||void 0===Ra||null===Ra)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.vb=Y;this.YRb=new jf.a(dc.a.Uk());this.Bkb=
new te(Y,Ra);void 0!==qe.a.Txd&&null!==qe.a.Txd&&void 0!==qe.a.smc&&null!==qe.a.smc&&0<qe.a.smc&&(Y=new me,Y.Token=qe.a.Txd,Y.ExpirationTime=qe.a.smc,this.YRb.ia("loki",Y))}function me(){this.Token=null;this.ExpirationTime=0}function te(Y,Ra){this.vb=Y;this.Yg=Ra}function ge(){this.message=null;this.pgc=0}b.r(F);var pd=b(0),jc=b(13),jf=b(893),dc=b(614),za=b(82),Mb=b(81),hc;(function(Y){Y[Y.applicationFeatureHelperHandler=0]="applicationFeatureHelperHandler";Y[Y.cloudPolicySettings=1]="cloudPolicySettings";
Y[Y.alternateAuthToken=2]="alternateAuthToken"})(hc||(hc={}));Object(pd.b)("ApplicationFeatureHelperRequestType",hc);Object(pd.a)(ge,"HttpRequstToPromiseRejectData",null,[]);var cc=b(99),Ec=b(242);te.prototype.z6c=function(Y,Ra,Db,ec,gd,Jd,Xd,xe){var cf=this;ec=void 0===ec?null:ec;gd=void 0===gd?null:gd;Jd=void 0===Jd?null:Jd;Xd=void 0===Xd?null:Xd;xe=void 0===xe?null:xe;var pf=hc[Db],ff=pf+"RequestFailure";cc.Health.instance.recordKpiUsage(ff,0,"jpittsdirects",null);return new Promise(function(tg,
Ig){jc.ULS.sendTraceTag(50622688,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Initializing HttpRequest {0}.",pf);var qg=null!=Xd?Xd:cf.vb.Cd("ApplicationFeatureHelperRequestQueueTimeout",15E3),pi=null!=xe?xe:cf.vb.Cd("ApplicationFeatureHelperRequestSentTimeout",3E4);cf.Yg.y$(Y,1,null,cf.eWh(Db,ec),Jd,!1,1,function(Ld){jc.ULS.sendTraceTag(50622689,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: HttpRequest {0} Succeeded.",pf);try{if(void 0===Ld||null===Ld||void 0===
Ld.data||null===Ld.data||void 0===Ld.data.oe||null===Ld.data.oe){cc.Health.instance.recordKpiFailure(ff,"Invalid RequestSucceededEventArgs",!1,!0,null);var qi=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}",pf);Ig(cf.Nxb(qi,Ld))}else if(Ld.data.httpStatus!==Ec.a.SP){cc.Health.instance.recordKpiFailure(ff,"HttpStatusCode_"+Ld.data.httpStatus.toString(),!1,!0,null);var W=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",
Ld.data.httpStatus,pf);Ig(cf.Nxb(W,Ld))}else{void 0!==gd&&null!==gd&&void 0!==Ld.data.responseHeaders&&null!==Ld.data.responseHeaders&&gd(Ld.data.responseHeaders);var ta=Ra(Ld.data.oe);if(ta)jc.ULS.sendTraceTag(50622690,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Successfully parsed response for request {0}",pf),tg(ta);else{cc.Health.instance.recordKpiFailure(ff,"Parse Failure",!1,!0,null);var ob=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}",
pf);Ig(cf.Nxb(ob,Ld))}}}catch(Kb){cc.Health.instance.recordKpiFailure(ff,"Unexpected Failure",!1,!0,null),qi=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",Kb,pf),Ig(cf.Nxb(qi,Ld))}},function(Ld){jc.ULS.sendTraceTag(50622691,3004,10,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: HttpRequest {0} failed.",pf);if(Ld.data){cc.Health.instance.recordKpiFailure(ff,"HttpStatusCode_"+Ld.data.httpStatus.toString(),!1,!0,null);var qi=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, ResponseData - {1} for Request - {2}",
Ld.data.httpStatus,Ld.data.oe||"No Data",pf)}else cc.Health.instance.recordKpiFailure(ff,"Invalid RequestFailedEventArgs",!1,!0,null),qi=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data is null or undefined for request {0}",pf);Ig(cf.Nxb(qi,Ld))},null,void 0,void 0,qg,pi)})};te.prototype.Nxb=function(Y,Ra){var Db=new ge;Db.message=Y;Db.pgc=Ra&&Ra.data?Ra.data.httpStatus:-1;return Db};te.prototype.eWh=function(Y,Ra){var Db={};Db["x-UserDataSignature"]=this.vb.Wa("UserDataSignature");
Db["x-LicensingIsEnabled"]=this.vb.ra("LicensingIsEnabled").toString();Db["x-CacheIsEnabled"]=this.vb.ra("LicensingRedisIsEnabled").toString();Db["x-OcpsIsEnabled"]=this.vb.ra("OcpsIsEnabled").toString();Db["x-LicensingAADIdIsEnabled"]=this.vb.ra("LicensingAadIdIsEnabled").toString();0===Y&&(Db["x-LicenseCheckOnTenantEnabled"]=this.vb.ra("LicensingForSafeLinksIsEnabled").toString(),Db["x-SupportUserConsentDependentFeatures"]=this.vb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SupportUserConsentBasedFeaturesInAFH",
!1).toString(),Db["x-AFHUserConsentGroupValue"]=this.vb.getIntFeatureGate("Microsoft.Office.SharedOnline.AFHUserConsentGroupValue",0).toString(),Db["x-UseShellServiceForUserConsentGroup"]=this.vb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseShellServiceForUserConsentGroup",!1).toString(),Db["x-UseSALForLicensing"]=this.vb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseSALForLicensingAFHS",!1).toString(),Db["x-SMBUserLicensingEnabled"]=this.vb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SMBUserLicensingEnabled",
!1).toString());if(Ra){Y=Cl(Ra.keys);for(var ec=Y.next();!ec.done;ec=Y.next())ec=ec.value,Db[ec]=Ra.pa(ec)}return Db};Object(pd.a)(te,"HttpRequestToPromiseUtility",null,[]);var Lc=b(4),he;(function(Y){Y[Y.loki=0]="loki";Y[Y.augloopACLP=1]="augloopACLP"})(he||(he={}));Object(pd.b)("AlternateAuthSupportApp",he);var qe=b(942),Af=b(40);Object(pd.a)(me,"WacAlternateAuthToken",null,[]);rd.prototype.rOh=function(){var Y=null;this.YRb.xb(he[0])&&(Y=this.YRb.pa(he[0]));return void 0===Y||null===Y||this.tud(Y)?
this.$Eh():Promise.resolve(Y.Token)};rd.prototype.tud=function(Y){return Y.ExpirationTime-Date.now()<this.rQj};rd.prototype.$Eh=function(){var Y=this,Ra=new jf.a(dc.a.Uk());Ra.ia("X-AlternateAuthApp",he[0]);return this.Bkb.z6c(this.vwa("/afhs/AlternateAuthHelperHandler.ashx"),Object(za.a)(this,this.j1i,"parseAlternateAuthTokenResponse"),2,Ra).then(function(Db){jc.ULS.sendTraceTag(545821456,3004,50,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Retrieved WacAlternateAuthToken for {0}",he[0]);
Y.YRb.ia(he[0],Db);return Db.Token},function(Db){Db=Object(Mb.a)(ge,Db);jc.ULS.sendTraceTag(545604827,3004,10,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Error: {0}, status code: {1}",Db.message,Db.pgc);return null})};rd.prototype.j1i=function(Y){var Ra=Af.d(Y).ev;jc.ULS.sendTraceTag(545821457,3004,Ra?50:10,"ParseAlternateAuthTokenResponse: fetched WacAlternateAuthToken from {0}",Y);return Ra};rd.prototype.vwa=function(Y){return String.format("{0}{1}?{2}",this.vb.Wa("WebServiceBase"),Y,Lc.AFrameworkApplication.uj)};
Object(pd.a)(rd,"AlternateAuthHelper",null,[481]);var xf=b(489);Object(pd.a)($c,"FeatureStateChangeArgs",null,[]);var fc=b(134),Gc=b(292),xd=b(23),Id=b(111),le=b(186),Wd;(function(Y){Y[Y.Enabled=0]="Enabled";Y[Y.Disabled=1]="Disabled"})(Wd||(Wd={}));Object(pd.b)("FeatureState",Wd);var Je=b(84),lf=b(26),vf=b(355);kc.prototype.CXh=function(){for(var Y=this.vb.wz("AllLicensedFeatures")?this.vb.Jw("AllLicensedFeatures"):[],Ra=new xf.a,Db=0;Db<Y.length;Db++)Ra.add(Y[Db]);return Ra};kc.prototype.Fsd=function(){return this.LNc||
this.MNc};kc.prototype.p_d=function(Y,Ra){var Db=this;Y=void 0===Y?0:Y;Ra=void 0===Ra?!1:Ra;jc.ULS.sendTraceTag(51185368,3004,50,"ApplicationFeatureHelper_TryInitializeLicensing: forceRefresh = {0}",Ra);var ec=fc.a.us();ec&&(ec.set("retryAttempt",Y.toString()),ec.set("forceRefresh",Ra.toString()),ec.set("isO365ConsumerHost",this.MNc.toString()),ec.set("isO365CommercialHost",this.LNc.toString()),ec.set("isFreemiumUpsellEnabled",this.bVb.toString()));cc.Health.instance.recordKpiUsageForAlertableKpi("AFHSLicensingFailedRequest",
"waclicensing",ec);cc.Health.instance.recordKpiUsage("AFHSLicensingSuccessfulRequest",1,"waclicensing",ec);void 0!==this.Cra&&null!==this.Cra&&this.Cra.start();var gd=null;Ra&&(gd=new jf.a(dc.a.Uk()),gd.ia("x-LicensingForceRefresh","true"));this.Hie=new Date;return(this.Bra?this.Bkb.z6c(this.vwa("/afhs/ApplicationFeatureHelperHandler.ashx"),Object(za.a)(this,this.m1i,"parseApplicationFeatureHelperResponse"),0,gd,Object(za.a)(this,this.E6i,"processApplicationFeatureHelperResponseHeaders"),["Date"]):
Promise.resolve({})).then(function(Jd){var Xd=Object.assign(new vf.a,{durationMs:Db.F$f()});Xd.extendedProperties=ec;Xd.extendedProperties&&Jd&&(Xd.extendedProperties.set("featureCount",Id.a.count(Jd).toString()),Xd.extendedProperties.set("licensingTestFeatureEnabled",("LicensingTestFeature"in Jd).toString()),Xd.extendedProperties.set("msoPremiumBadgeEnabled",("MsoPremiumBadge"in Jd).toString()),Db.uXb&&Xd.extendedProperties.set("fromCache",(Db.uXb<Db.Hie).toString()));cc.Health.instance.recordKpiSuccess("AFHSLicensingSuccessfulRequest",
Xd);return Jd},function(Jd){var Xd=Object.assign(new vf.a,{durationMs:Db.F$f()}),xe=Object(Mb.a)(ge,Jd);if(!xe)return jc.ULS.sendTraceTag(51491471,3004,10,"ApplicationFeatureHelper_TryInitializeLicensing: Invalid cast to HttpRequestToPromiseRejectData"),cc.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","InvalidCastToHttpRequestToPromiseRejectData",!1,!0,Xd),new Promise(function(cf,pf){pf(Jd)});Xd.extendedProperties=ec;Xd.extendedProperties&&Xd.extendedProperties.set("status",xe.pgc.toString());
cc.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","RequestFailed",!1,!0,Xd);return 408===xe.pgc&&++Y<=Db.Tvg?Db.p_d(Y):new Promise(function(cf,pf){pf(xe)})})};kc.prototype.m1i=function(Y){(Y=Af.b(Y))?(jc.ULS.sendTraceTag(50436170,3004,50,"ParseApplicationFeatureHelperResponse: Successfully fetched features"),jc.ULS.sendTraceTag(50938594,3004,50,"{0}",Y)):jc.ULS.sendTraceTag(50436171,3004,10,"ParseApplicationFeatureHelperResponse: ApplicationFeatureHelper Service returned a null feature set");
return Y.Features};kc.prototype.vwa=function(Y){var Ra=String.format("{0}{1}",this.vb.Wa("WebServiceBase"),Y);this.vb.wz("ApplicationFeatureHelperHttpCachingEnabled")&&this.vb.ra("ApplicationFeatureHelperHttpCachingEnabled")&&(Y=kc.pdc(this.vb))&&0<Y.length&&(this.lZb&&(Y+="ucbf"),Ra=new Gc.QueryStringBuilder(Ra),Ra.Li("afhskey",Y),Ra=Ra.toString());return Ra};kc.prototype.isFeatureEnabled=function(Y,Ra){var Db=this;if(!this.sFa&&!this.qVc&&!this.Bra)return this.BCa;jc.ULS.sendTraceTag(42513091,3004,
50,"ApplicationFeatureHelper.IsFeatureEnabled: Call made to check if feature: {0} is enabled.",Y);if("ConnectedServices"===Y){var ec=this.sFa?this.R6d.AK("ControllerConnectedServicesEnabled"):this.BCa,gd=this.qVc?this.Wme.getSettings().then(function(xe){return 2!==xe.fu},function(){return Ra}):this.BCa;return ec.then(function(xe){return xe?gd:Db.Qcd})}ec=null;ec=this.sFa?this.R6d.isFeatureEnabled(Y):this.BCa;var Jd=null;Jd=this.Bra?this.Rmi(Y,Ra):this.BCa;var Xd=null;Xd=this.qVc?this.Wme.isFeatureEnabled(Y):
this.BCa;return ec.then(function(xe){return xe?Xd.then(function(cf){return cf?Jd:Db.Qcd}):Db.Qcd}).then(function(xe){Db.fqf(Y,xe,!0);return xe},function(){Db.fqf(Y,Ra,!1);return Ra})};kc.prototype.fqf=function(Y,Ra,Db){jc.ULS.sendTraceTag(526713106,3004,50,"FeatureName={0}, IsEnabled={1}, IsSuccess={2}",Y,Ra,Db)};kc.prototype.getFeatureTier=function(Y,Ra){var Db=this;if(!this.Bra)return new Promise(function(ec){ec(2)});jc.ULS.sendTraceTag(42804871,3004,50,"ApplicationFeatureHelper.GetFeatureTier: Call made to get Feature's Tier.",
Y);return this.Gva.then(function(ec){return Db.qec(Y,ec,Ra)},function(){return Ra})};kc.prototype.isFreemiumUpsellEnabled=function(){return this.bVb&&this.MNc&&!this.hbe};kc.prototype.launchUpsellExperience=function(Y,Ra){Ra=void 0===Ra?null:Ra;jc.ULS.sendTraceTag(594564814,3004,50,String.format("ApplicationFeatureHelper_LaunchUpsellExperience: Launching upsell experience for experienceId: {0}",Y));var Db=fc.a.us();Db&&(Db.set("experienceId",Y),Ra&&Db.set("campaignId",Ra));cc.Health.instance.recordKpiUsage("AFHCLaunchUpsellSuccess",
1,"waclicensing",Db);if(Db=Je.a.instance.Nh("Common.IInProductMessagingUIManager")){var ec=Object(za.a)(this,this.T7h,"handleDimeTaskComplete");Db.jof(Y,ec,Ra)}else jc.ULS.sendTraceTag(594367561,3004,15,"InProductMessaging was not initialized"),cc.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","InProductMessagingNotInitialized",!1,!0,null),Ra={},this.La.Be(lf.a.Abc,2,(Ra.experience=Y,Ra))};kc.prototype.NAa=function(Y,Ra){if(!this.Bra)return null;if(!Y||!Ra)return jc.ULS.sendTraceTag(594564813,
3004,10,"ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: Invalid input."),null;var Db=le.a.create().toString();this.Fva.xb(Y)||this.Fva.ia(Y,new jf.a(dc.a.Uk()));this.Fva.pa(Y).add(Db,Ra);jc.ULS.sendTraceTag(594564812,3004,50,String.format("ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: registered callback {0} for feature {1}",Db,Y));return Db};kc.prototype.ILd=function(Y,Ra){this.Bra&&(Y&&this.Fva.xb(Y)?Ra&&le.a.isValid(Ra)?this.Fva.pa(Y).xb(Ra)?(jc.ULS.sendTraceTag(594564808,
3004,50,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: Removing callback {0} for feature {1}",Ra,Y)),this.Fva.pa(Y).remove(Ra)):jc.ULS.sendTraceTag(594564809,3004,15,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: callbackId {0} not registered for feature {1} ",Ra,Y)):jc.ULS.sendTraceTag(594564810,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid callbackId {0} for feature {1}",Ra,Y)):jc.ULS.sendTraceTag(594564811,
3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid or non registered featureName {0}",Y)))};kc.prototype.qec=function(Y,Ra,Db){return this.lZb?Y in Ra?Ra[Y].LicenseTier:Db:Y in Ra?this.K1i(Ra[Y],Db):Db};kc.prototype.K1i=function(Y,Ra){switch(Y.toLowerCase()){case "unknown":return 0;case "basic":return 1;case "premium":return 2;default:return Ra}};kc.prototype.T7h=function(){var Y=this;jc.ULS.sendTraceTag(594367560,3004,50,"ApplicationFeatureHelper_HandleDimeTaskComplete");
this.Gva.then(function(Ra){Y.NRf(Ra)}).catch(function(){Y.NRf({})})};kc.prototype.NRf=function(Y){var Ra=this;jc.ULS.sendTraceTag(594051087,3004,50,"ApplicationFeatureHelper_RefreshLicensingAndNotifyUpdatedFeatures");var Db=this.p_d(0,!0);Db.then(function(ec){Ra.Gva=Db;Id.a.count(ec)>Id.a.count(Y)?cc.Health.instance.recordKpiSuccess("AFHCLaunchUpsellSuccess",null):cc.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","FeatureCountNotIncreased",!1,!0,null);for(var gd=Cl(Ra.Fva.keys),Jd=gd.next();!Jd.done;Jd=
gd.next())if(Jd=Jd.value,Jd in ec){var Xd=Ra.qec(Jd,ec,0);Jd in Y?Ra.qec(Jd,Y,0)!==Xd&&Ra.zBd(Jd,!0,Xd):Ra.zBd(Jd,!0,Xd)}else Jd in Y&&Ra.zBd(Jd,!1,Ra.qec(Jd,Y,0))}).catch(function(ec){cc.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","LicensingRefreshFailed",!1,!0,null);jc.ULS.sendTraceTag(594051086,3004,10,JSON.stringify(ec))})};kc.prototype.zBd=function(Y,Ra,Db){jc.ULS.sendTraceTag(594051085,3004,50,"ApplicationFeatureHelper_NotifyFeatureStateChanged: Notify feature state changed callbacks for feature {0}, {1}, {2}",
Y,Ra,Db);Ra=new $c(Y,Ra,Db);Db=this.Fva.pa(Y);Db=Cl(Db);for(var ec=Db.next();!ec.done;ec=Db.next()){ec=ec.value;try{ec.value(Ra)}catch(gd){jc.ULS.sendTraceTag(594051084,3004,10,String.format("ApplicationFeatureHelper_NotifyFeatureStateChanged: Exception when calling registered callback: feature: {0} callbackId: {1}, exception {2}",Y,ec.key,gd.message))}}};kc.prototype.qe=function(Y,Ra){var Db=this;if(this.Bra){var ec=this.Mde.contains(Y),gd=!0,Jd="",Xd=!1;return this.Gva.then(function(xe){Y in xe?
(xe=xe[Y],Jd=Wd[xe.FeatureState],gd=1!==xe.FeatureState):gd=!ec;Db.qqf(Y,ec,Jd,Xd,Ra,gd);return gd},function(){Xd=!0;ec&&(gd=Ra);Db.qqf(Y,ec,Jd,Xd,Ra,gd);return gd})}return this.BCa};kc.prototype.qqf=function(Y,Ra,Db,ec,gd,Jd){jc.ULS.sendTraceTag(557389507,3004,50,"featureName : {0}, isLicenseControlledFeature={1}, encounteredError = {2}, featureData={3}, fallbackValue={4}, isAllowed={5}",Y,Ra,ec,Db,gd,Jd)};kc.prototype.Rmi=function(Y,Ra){if(this.lZb)return this.qe(Y,Ra);if(this.Bra){if(this.Mde.contains(Y))return this.Gva.then(function(Db){return Y in
Db},function(){return Ra});jc.ULS.sendTraceTag(590385821,3004,50,"ApplicationFeatureHelper_IsFeatureAllowedByUserLicense: Feature '{0}' requested while not in the licensed features set.",Y)}return this.BCa};kc.prototype.E6i=function(Y){try{Y&&"Date"in Y&&(this.uXb=new Date(Y.Date),jc.ULS.sendTraceTag(578863817,3004,50,"ProcessApplicationFeatureHelperResponseHeaders Date {0}",this.uXb.toString()))}catch(Ra){jc.ULS.sendTraceTag(578863818,3004,10,"ProcessApplicationFeatureHelperResponseHeaders Exception {0}",
Ra)}};kc.prototype.F$f=function(){if(void 0!==this.Cra&&null!==this.Cra){var Y=this.Cra.Gc;this.Cra.stop();return Y}return null};kc.pdc=function(Y){try{if(xd.a.DMj){var Ra=Y.Wa("UserDataSignature").split(".");if(1<Ra.length){var Db=window.self.atob(Ra[1]),ec=JSON.parse(Db).LocalStorageKey;if(void 0!==ec&&null!==ec&&0<ec.length)return ec}}}catch(gd){jc.ULS.sendTraceTag(578863816,3004,10,"GetLocalStorageCacheKey exception {0}",gd.toString())}return null};Object(pd.a)(kc,"ApplicationFeatureHelper",null,
[482]);var se=b(199);Object(pd.a)(Jf,"CloudPolicySettingsCacheData",null,[]);var wf=b(1028),Uf=b(391),Wf=b(229);pe.S8f=function(){return Lc.AFrameworkApplication.ha.ra("SideCarIsEnabled")?pe.Xwc&&pe.crd?new Promise(function(Y){Y(!0)}):new Promise(function(Y,Ra){pe.Xwc=Wf.a.create(Lc.AFrameworkApplication.ha.Wa("SideCarUrl"));Uf.a.Bja(pe.Xwc);pe.Xwc.C$(function(Db,ec){(pe.crd=ec.succeeded)?Y(ec.succeeded):Ra(ec.succeeded)})}):new Promise(function(Y){Y(!1)})};pe.crd=!1;pe.Xwc=null;Object(pd.a)(pe,"SideCarLoader",
null,[]);Object(pd.a)(Xe,"CloudPolicySettingsData",null,[]);$e.prototype.AK=function(Y,Ra){Ra=void 0===Ra?!0:Ra;if(!this.sFa){var Db=this;return new Promise(function(Xd){Xd(Db.zxb(Y))})}var ec=this,gd=this,Jd=this.z4b.then(function(Xd){try{var xe=null;Xd.PolicySettings&&"unknown"in Xd.PolicySettings&&(xe=Xd.PolicySettings.unknown);if(xe){if(Y in xe&&void 0!==xe[Y]&&null!==xe[Y])return new Promise(function(pf){pf("0"!==xe[Y])});var cf=Y.toLowerCase();if(cf in xe&&void 0!==xe[cf]&&null!==xe[cf])return new Promise(function(pf){pf("0"!==
xe[cf])});jc.ULS.sendTraceTag(51512667,3004,50,"Policy"+Y+" not found, using default");return new Promise(function(pf){pf(ec.zxb(Y))})}return new Promise(function(pf){pf(ec.zxb(Y))})}catch(pf){return jc.ULS.sendTraceTag(50622686,3004,10,"Failed to get "+Y+" policy value. Error Message: {0}",pf.message),ec.handleError(pf.toString(),Ra,ec.zxb(Y))}},function(Xd){return gd.handleError(Xd,Ra,gd.zxb(Y))});Jd.then(function(Xd){jc.ULS.sendTraceTag(50651667,3004,50,"CloudPolicySettingsHelper.GetBooleanPolicySetting: policy: {0}, value: {1}",
Y,Xd);return null});return Jd};$e.prototype.isFeatureEnabled=function(Y,Ra){Ra=void 0===Ra?!0:Ra;if(this.vb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))return this.Tmi(Y,Ra);var Db=new Promise(function(gd){gd(!0)}),ec="";this.$Sb.contains(Y)&&(ec="ControllerConnectedServicesEnabled",Db=this.AK(ec,Ra));Db.then(function(gd){jc.ULS.sendTraceTag(50651668,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabled: Feature: {0}, enabled or not: {1}, by policy: {2}",
Y,gd,ec);return null});return Db};$e.prototype.Tmi=function(Y,Ra){Ra=void 0===Ra?!0:Ra;var Db=new Promise(function(gd){gd(!0)}),ec="";"mso_sendASmile"===Y?ec="Enabled":"Survey"===Y||"FloodgateSurvey"===Y?ec="SurveyEnabled":this.$Sb.contains(Y)&&(ec="ControllerConnectedServicesEnabled");""!==ec&&(Db=this.AK(ec,Ra));Db.then(function(gd){jc.ULS.sendTraceTag(558187080,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabledV2: Feature: {0}, enabled or not: {1}, by policy: {2}",Y,gd,ec);return null});return Db};
$e.prototype.handleError=function(Y,Ra,Db){return Ra?new Promise(function(ec){ec(Db)}):new Promise(function(ec,gd){gd(Y)})};$e.prototype.Epa=function(Y,Ra,Db){var ec=this;if(!Y)return Promise.resolve(new Xe);var gd=!1,Jd=null;cc.Health.instance.recordKpiUsage("GetCloudPolicySettings",1,"jpittsdirects",null);var Xd=this.W5c("GetCloudPolicySettings");return(new Promise(function(xe,cf){if(void 0!==ec.qlb&&null!==ec.qlb&&0<ec.qlb.length){var pf=ec.CSj();if(void 0!==pf&&null!==pf){gd=!0;xe(pf);return}}ec.Bkb.z6c(Ra,
Db,1,null,Object(za.a)(ec,ec.I6i,"processCloudPolicySettingsResponseHeaders"),["CheckIn-Interval"],ec.vb.Cd("CloudPolicySettingsRequestQueueTimeout",15E3),ec.vb.Cd("CloudPolicySettingsRequestSentTimeout",3E4)).then(function(ff){jc.ULS.sendTraceTag(51662933,3004,50,"Retrieved CloudPolicySettingsData from OCPS");ec.rTj(ff);xe(ff);return ff},function(ff){cf(ff);return null})})).then(function(xe){var cf=ec.ZAc(Xd);Xd=cf.stopwatch;Jd=cf.returnValue;(cf=fc.a.us())&&cf.set("FromCache",gd.toString());cf=
Object.assign(new vf.a,{durationMs:Jd,extendedProperties:cf});cc.Health.instance.recordKpiSuccess("GetCloudPolicySettings",cf);return xe})};$e.prototype.SSj=function(){return pe.S8f().then(function(){jc.ULS.sendTraceTag(593282845,3004,50,"CloudPolicySettingsHelper - Retrieving CloudPolicySettingsData Promise from Sidecar");return sidecar.cloudPolicy.GetCloudPolicySettingsData()})};$e.prototype.vwa=function(Y){return String.format("{0}{1}",this.vb.Wa("WebServiceBase"),Y)};$e.prototype.n1i=function(Y){var Ra=
Af.d(Y).ev;jc.ULS.sendTraceTag(50622687,3004,Ra?50:10,"ParseCloudPolicySettingsResponse: fetched CloudPolicySettingsData from {0}",Y);return Ra};$e.prototype.I6i=function(Y){try{if(void 0!==Y&&null!==Y&&"CheckIn-Interval"in Y){var Ra=parseInt(Y["CheckIn-Interval"]);void 0!==Ra&&null!==Ra&&0<Ra&&(this.DIc=Ra)}}catch(Db){jc.ULS.sendTraceTag(51662934,3004,10,"ProcessCloudPolicySettingsResponseHeaders Exception {0}",Db)}};$e.prototype.zxb=function(Y){return Y in this.Yfe?"0"!==this.Yfe[Y]:!0};$e.prototype.CSj=
function(){try{var Y=wf.a.instance.getItem(this.qlb);if(void 0===Y||null===Y)return jc.ULS.sendTraceTag(51662936,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null"),null;jc.ULS.sendTraceTag(51662937,3004,50,"TryGetCloudPolicySettingsDataFromCache retrieved data {0} from LocalStorage",Y);var Ra=JSON.parse(Y);if(void 0===Ra||null===Ra)return jc.ULS.sendTraceTag(51662938,3004,15,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null after parsing"),null;if(void 0===
Ra.ExpirationTime||null===Ra.ExpirationTime)return jc.ULS.sendTraceTag(51662939,3004,15,"TryGetCloudPolicySettingsDataFromCache ExpirationTime from LocalStorage is null after parsing"),null;if((new Date(Ra.ExpirationTime)).getTime()<Date.now())return jc.ULS.sendTraceTag(51662940,3004,50,"TryGetCloudPolicySettingsDataFromCache Cache is expired"),null;var Db=new Xe;Db.PolicySettings=Ra.PolicySettings;Db.ControllerConnectedServicesFeatureNames=new se.a;this.vb.wz("ServicesControlsMicrosoftControllerServicesList")&&
this.vb.Jw("ServicesControlsMicrosoftControllerServicesList");for(var ec=Cl(this.$Sb),gd=ec.next();!gd.done;gd=ec.next())Db.ControllerConnectedServicesFeatureNames.add(gd.value);jc.ULS.sendTraceTag(51662941,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage retrieved");return Db}catch(Jd){return jc.ULS.sendTraceTag(51662942,3004,10,"TryGetCloudPolicySettingsDataFromCache exception {0}",Jd.toString()),null}};$e.prototype.rTj=function(Y){try{if(void 0===Y||null===Y||void 0===Y.PolicySettings||
null===Y.PolicySettings)jc.ULS.sendTraceTag(51662944,3004,15,"TrySetCloudPolicySettingsDataIntoCache data/PolicySettings is null");else if(0>=this.DIc)jc.ULS.sendTraceTag(51662945,3004,15,"TrySetCloudPolicySettingsDataIntoCache _checkInInterval is Invalid");else{var Ra=new Jf(Y,this.DIc),Db=JSON.stringify(Ra);jc.ULS.sendTraceTag(51662946,3004,50,"TrySetCloudPolicySettingsDataIntoCache data to cache {0}",Db);wf.a.instance.setItem(this.qlb,Db);jc.ULS.sendTraceTag(51662947,3004,50,"TrySetCloudPolicySettingsDataIntoCache set data to cache")}}catch(ec){jc.ULS.sendTraceTag(51662976,
3004,10,"TrySetCloudPolicySettingsDataIntoCache exception {0}",ec.toString())}};$e.prototype.pdc=function(){var Y=kc.pdc(this.vb);return Y&&0<Y.length?"OCPS"+Y:null};$e.prototype.W5c=function(Y){var Ra=Je.a.instance.Nh("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder");return void 0!==Ra&&null!==Ra?Ra.Hc("WebServiceCall",Y):null};$e.prototype.ZAc=function(Y){if(void 0!==Y&&null!==Y){var Ra=Y.Gc;Y.stop();return{returnValue:Ra,stopwatch:null}}return{returnValue:null,stopwatch:Y}};Object(pd.a)($e,
"CloudPolicySettingsHelper",null,[479]);zc.prototype.clone=function(){var Y=new zc;Y.fu=this.fu;Y.Uig=this.Uig;Y.iNe=this.iNe;Y.CIa=this.CIa;Y.Vig=this.Vig;Y.jNe=this.jNe;Y.ufa=this.ufa;Y.YTc=this.src;return Y};zc.prototype.serialize=function(Y){Y=void 0===Y?null:Y;var Ra={};if(!Y||Y.contains(zc.GPa))Ra[zc.GPa]=this.fu;if(!Y||Y.contains(zc.YEb))Ra[zc.YEb]=this.CIa;if(!Y||Y.contains(zc.ZEb))Ra[zc.ZEb]=this.ufa;return JSON.stringify(Ra)};zc.create=function(Y,Ra){Ra=void 0===Ra?null:Ra;var Db=new zc;
Db.YTc=Y;void 0!==Ra&&null!==Ra&&(zc.GPa in Ra&&(Db.fu=Ra[zc.GPa]),zc.YEb in Ra&&(Db.CIa=Ra[zc.YEb]),zc.ZEb in Ra&&(Db.ufa=Ra[zc.ZEb]));return Db};zc.deserialize=function(Y,Ra){try{var Db=JSON.parse(Y);if(void 0!==Db&&null!==Db)return zc.create(Ra,Db);jc.ULS.sendTraceTag(50860946,306,10,"UserPrivacySettings Deserialize: Unable to convert {0} to dict",Y);throw Error.argument("settingsData");}catch(ec){throw jc.ULS.sendTraceTag(50860947,306,10,"UserPrivacySettings Deserialize Exception = {0}",ec.toString()),
ec;}};uk.Object.defineProperties(zc.prototype,{src:{configurable:!0,enumerable:!0,get:function(){return this.YTc}}});zc.GPa="CCS";zc.YEb="CCSTime";zc.ZEb="OfficePrivacyRoamedNoticeShown";Object(pd.a)(zc,"UserPrivacySettings",null,[]);var Tf=b(125);zd.prototype.vwa=function(Y){var Ra=String.format("{0}RoamingServiceHandler.ashx?action=",this.vb.appSettings.RoamingServiceHandlerWebServiceBase||"");Ra=new Sys.StringBuilder(Ra);Ra.append(Y);Ra.append("&");Ra.append(Lc.AFrameworkApplication.uj);return Ra.toString()};
zd.prototype.executeRequest=function(Y,Ra,Db,ec){return this.Yg.F_b(Y,Ra,void 0===ec?null:ec,null,Db,"33",!1,null,6E4)};zd.prototype.saveSettings=function(Y){var Ra=this;return new Promise(function(Db,ec){try{if(void 0===Ra.Ee||null===Ra.Ee||void 0===Y||null===Y)jc.ULS.sendTraceTag(51258443,3004,15,"SaveUserPrivacySettings: Can't determine setting changes to save"),ec("Can't determine setting changes to save");else{var gd=Ra.Ee.fu!==Y.fu;if(2===Ra.Ee.src&&gd)Ra.spj(Y),Db(!0);else{var Jd=Ra.ptj(Y);
if(void 0===Jd||null===Jd||!Jd.length)jc.ULS.sendTraceTag(50917389,3004,15,"SaveUserPrivacySettings: returning since nothing changed"),ec("No changes to save");else if(1===Ra.Ee.src)Db(Ra.Reg(Jd));else if(0===Ra.Ee.src){jc.ULS.sendTraceTag(51258444,3004,50,"UserPrivacySettingsHelper: SaveSettings to Roaming {0}",Jd);var Xd=Ra.executeRequest(Ra.vwa("saveUserPrivacySettings"),2,"SaveUserPrivacySettingsRequest",Jd);Xd.continueWith(function(){if(Xd.Ph||Xd.og)jc.ULS.sendTraceTag(50860929,3004,10,"SaveUserPrivacySettings: Roaming Request Cancelled/Failed"),
Db(!1);else{var xe=Xd.result;void 0!==xe.jh&&null!==xe.jh&&void 0!==xe.jh.data&&null!==xe.jh.data&&xe.jh.data.httpStatus===Ec.a.SP?(jc.ULS.sendTraceTag(51258445,3004,50,"SaveUserPrivacySettings: Roaming Request Succeeded"),Db(!0)):(jc.ULS.sendTraceTag(51258446,3004,10,"SaveUserPrivacySettings: Roaming Request Failed"),Db(!1))}})}}}}catch(xe){jc.ULS.sendTraceTag(50860930,3004,10,"SaveUserPrivacySettings: Exception = {0}",xe.toString()),Db(!1)}})};zd.prototype.ptj=function(Y){if(void 0===this.Ee||null===
this.Ee||void 0===Y||null===Y)throw Error.invalidOperation("User Privacy settings have not been initialized");var Ra=new se.a;0===Y.src?(this.Ee.fu!==Y.fu&&(Ra.add(zc.GPa),Ra.add(zc.YEb)),this.Ee.ufa!==Y.ufa&&Ra.add(zc.ZEb)):1===Y.src&&this.Ee.fu!==Y.fu&&Ra.add(zc.GPa);return Ra.count?Y.serialize(Ra):(jc.ULS.sendTraceTag(50860931,3004,50,"SaveUserPrivacySettings: returning since nothing changed"),null)};zd.prototype.getSettings=function(){if(!this.mTc){var Y=this;this.mTc=new Promise(function(Ra){try{Y.Ee?
Ra(Y.Ee.clone()):Y.KSj().then(function(Db){Y.Ee=Db;Ra(Y.Ee.clone());return null},function(){Y.ISj().then(function(Db){Y.Ee=Db;Ra(Y.Ee.clone());return null},function(){Y.JSj().then(function(Db){Y.Ee=Db;Ra(Y.Ee.clone());return null},function(){jc.ULS.sendTraceTag(50967430,3004,10,"UserPrivacySettings TryGetSettingsFromQueryParams returned an error)");Y.Ee=new zc;Ra(Y.Ee.clone());return null});return null});return null})}catch(Db){jc.ULS.sendTraceTag(50860932,3004,10,"UserPrivacySettings GetSettings: Exception = {0}",
Db.toString()),Y.Ee=new zc,Ra(Y.Ee.clone())}})}return this.mTc};zd.prototype.KSj=function(){var Y=this;return new Promise(function(Ra,Db){try{var ec=-1!==window.location.href.indexOf("&wd_pn=2");if(Y.vb.ra("PrivacyDialogShouldCheckRoaming")||ec){var gd=Y.executeRequest(Y.vwa("getUserPrivacySettings"),1,"GetUserPrivacySettingsRequest");gd.continueWith(function(){try{if(gd.Ph||gd.og)jc.ULS.sendTraceTag(50860934,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Request failure");else{var Jd=gd.result;
if(Jd&&Jd.jh&&Jd.jh.data)if(Jd.jh.data.httpStatus!==Ec.a.SP)jc.ULS.sendTraceTag(50860936,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Received error response {0}",Jd.jh.data.httpStatus);else{if(Jd.jh.data.oe){Ra(zd.parse(Jd.jh.data.oe,0));jc.ULS.sendTraceTag(51258447,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Success, Settings {0}",Jd.jh.data.oe);return}jc.ULS.sendTraceTag(50860937,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: ResponseData is null")}else jc.ULS.sendTraceTag(50860935,
3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Data is null");Db("UserPrivacySettings TryGetSettingsFromRoaming Request Faillure")}}catch(Xd){jc.ULS.sendTraceTag(50860938,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming Exception handling request {0}",Xd.toString()),Db("UserPrivacySettings TryGetSettingsFromRoaming Request Exception")}})}else jc.ULS.sendTraceTag(50860933,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Roaming should not be used"),Db("Roaming should not be used")}catch(Jd){jc.ULS.sendTraceTag(50860939,
3004,10,"TryGetSettingsFromRoaming Exception = {0}",Jd.toString()),Db("UserPrivacySettings TryGetSettingsFromRoaming Exception")}})};zd.prototype.ISj=function(){var Y=this;return new Promise(function(Ra,Db){try{var ec=Tf.a.get("WacUPToggleState"),gd=null;void 0!==ec&&null!==ec&&0<ec.length&&(gd=decodeURIComponent(ec));if(void 0!==gd&&null!==gd&&0<gd.length){var Jd=zd.parse(gd,1);jc.ULS.sendTraceTag(51258448,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings retrieved from cookie {0}",Jd.toString());
Ra(Jd)}else{var Xd=zc.create(1),xe=new se.a;xe.add(zc.GPa);var cf=Xd.serialize(xe);Y.Reg(cf)?(jc.ULS.sendTraceTag(51258449,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings initialized and retrieved from cookie {0}",cf),Ra(Xd)):(jc.ULS.sendTraceTag(51258450,3004,15,"TryGetSettingsFromCookie: Failure initializing cookie with settings {0}",cf),Db("UserPrivacySettings TryGetSettingsFromCookie Failure in TrySaveSettingsToCookie"))}}catch(pf){jc.ULS.sendTraceTag(50860941,3004,10,"TryGetSettingsFromCookie from Cookie Exception = {0}",
pf.toString()),Db("UserPrivacySettings TryGetSettingsFromCookie Eception")}})};zd.prototype.JSj=function(){return new Promise(function(Y){try{var Ra=-1!==window.location.href.indexOf("&wdccsoff=1"),Db=zc.create(2);Ra?(Db.fu=2,Lc.AFrameworkApplication.PLe(),jc.ULS.sendTraceTag(51258451,3004,50,"TryGetSettingsFromQueryParams: Retrieved from query param {0}",Db.toString())):(Db.fu=1,jc.ULS.sendTraceTag(51258452,3004,50,"TryGetSettingsFromQueryParams: Initialized with query param as data source for {0}",
Db.toString()));Y(Db)}catch(ec){jc.ULS.sendTraceTag(50967431,3004,50,"TryGetSettingsFromCookie from Query Params Exception = {0}",ec.toString()),Ra=zc.create(2),Ra.fu=1,Y(Ra)}})};zd.prototype.spj=function(Y){jc.ULS.sendTraceTag(51258453,3004,50,"UserPrivacySettingsHelper: SaveSettingsToQueryParam");2===Y.fu?Lc.AFrameworkApplication.PLe():Lc.AFrameworkApplication.Xoh();jc.ULS.sendTraceTag(51258454,3004,50,"SaveSettingsToQueryParam saved settings = {0}",Y)};zd.prototype.Reg=function(Y){try{jc.ULS.sendTraceTag(51258455,
3004,50,"UserPrivacySettingsHelper: TrySaveSettingsToCookie Saving settings {0}",Y);var Ra=this.vb.Wa("PrivacyCookieDomain")||"";if(!Ra||!Ra.length)throw Error.invalidOperation("PrivacyCookieDomain is null or empty");jc.ULS.sendTraceTag(51258456,3004,50,"SaveUserPrivacySettings to Cookie {0}",Y);return Tf.a.JSd("WacUPToggleState",Y,Tf.a.XW,"/",Ra)}catch(Db){return jc.ULS.sendTraceTag(50860942,3004,50,"SaveUserPrivacySettings to Cookie Exception = {0}",Db.toString()),!1}};zd.prototype.isFeatureEnabled=
function(Y){var Ra=this;return this.getSettings().then(function(Db){for(var ec=Ra.vb.wz("ServicesControlsMicrosoftControllerServicesList")?Ra.vb.Jw("ServicesControlsMicrosoftControllerServicesList"):[],gd=new xf.a,Jd=0;Jd<ec.length;Jd++)gd.add(ec[Jd]);return gd.contains(Y)?2!==Db.fu:!0},function(){jc.ULS.sendTraceTag(50860945,3004,10,"Failed to get privacy setting for feature {0}",Y);return!0})};zd.parse=function(Y,Ra){try{return jc.ULS.sendTraceTag(50860943,3004,50,"Parsing user privacy settings {0} from {1}",
Y,Ra),zc.deserialize(Y,Ra)}catch(Db){throw jc.ULS.sendTraceTag(50860944,3004,10,"GetUserPrivacySettings Exception = {0}",Db.toString()),Db;}};Object(pd.a)(zd,"UserPrivacySettingsHelper",null,[480]);var ug=b(254);jd.prototype.hi=function(Y){var Ra=this;this.tb=Y;this.tb.register(479,"Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").Ic().Nc(function(){return new $e(Lc.AFrameworkApplication.ha,Lc.AFrameworkApplication.Ld)});this.tb.register(480,"Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper").Ic().Nc(function(){return new zd(Lc.AFrameworkApplication.ha,
Lc.AFrameworkApplication.Ld)});this.tb.register(481,"Common.App.ApplicationFeatureHelper.IAlternateAuthHelper").Ic().Nc(function(){return new rd(Lc.AFrameworkApplication.ha,Lc.AFrameworkApplication.Ld)});this.tb.register(482,"Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").Ic().Nc(function(){return new kc(Lc.AFrameworkApplication.ha,Lc.AFrameworkApplication.Ld,Ra.tb.resolve("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper"),Ra.tb.resolve("Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper"),
Lc.AFrameworkApplication.Ib)})};jd.prototype.init=function(){var Y=this;Lc.AFrameworkApplication.ha.tv(function(){var Ra=Y.tb.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");Lc.AFrameworkApplication.ha.ra("LicensingIsEnabled")&&(Ra.isFeatureEnabled("LicensingTestFeature",!1).then(function(Db){jc.ULS.sendTraceTag(42513092,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned IsFeatureEnabled as {0}. IsAnonymousUser : {1}.",Db,Lc.AFrameworkApplication.ha.Wa("IsAnonymousUser"));
return null}),Ra.getFeatureTier("LicensingTestFeature",0).then(function(Db){jc.ULS.sendTraceTag(42804872,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned GetFeatureTier as {0}. IsAnonymousUser : {1}.",Db,Lc.AFrameworkApplication.ha.Wa("IsAnonymousUser"));return null}));Y.tb.resolve("Common.App.ApplicationFeatureHelper.IAlternateAuthHelper");Y.$Nj()})};jd.prototype.dispose=function(){};jd.prototype.$Nj=function(){try{Lc.AFrameworkApplication.ha.ra("SideCarIsEnabled")&&pe.S8f().then(function(Y){jc.ULS.sendTraceTag(594057429,
3004,50,"Sidecar Loader attempted to load Sidecar.  SideCarIsAvailable:{0}",Y);return Y})}catch(Y){}};jd.main=function(){ug.a.instance.nj(new jd)};uk.Object.defineProperties(jd.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.ApplicationFeatureHelper.ApplicationFeatureHelperPackage"}}});Object(pd.a)(jd,"ApplicationFeatureHelperPackage",null,[4,5]);var Le=b(117),Qd=b(419),Of=Qd.a;Am(fd,Of);fd.prototype.createElement=function(){var Y=document.createElement("link");Y.setAttribute("rel",
"stylesheet");Y.setAttribute("type","text/css");Y.setAttribute("href",this.Du);return Y};fd.prototype.x6c=function(){return null};fd.prototype.luc=function(){this.element.setAttribute("href","");this.element.setAttribute("href",this.RI.Du)};uk.Object.defineProperties(fd.prototype,{O5b:{configurable:!0,enumerable:!0,get:function(){return!1}}});Object(pd.a)(fd,"CssResource",Qd.a,[]);var Ee=b(28),Eg=b(53);Fc.prototype.Mxi=function(){this.gUb||(jc.ULS.sendTraceTag(21030598,324,50,"InProductMessagingDependenciesLoad usage"),
this.gUb=Eg.Task.WAA(Fc.Rxi(),Fc.Jxi()),this.gUb.continueWith(function(Y){jc.ULS.sendTraceTag(21030599,324,10,"{0}",Ee.a.nhd(Y.exception))},5));return this.gUb};Fc.prototype.Oxi=function(){if(!this.QWb)try{jc.ULS.sendTraceTag(39978390,324,50,"InProductMessagingFreemiumDependenciesLoad usage"),this.QWb=Eg.Task.WAA(Fc.dad(Wf.a.create(Lc.AFrameworkApplication.ha.Wa("DimeUrl"),null,null))),this.QWb.continueWith(function(Y){jc.ULS.sendTraceTag(39978391,324,10,"{0}",Ee.a.nhd(Y.exception))},5)}catch(Y){jc.ULS.sendTraceTag(594874951,
324,10,"{0}",Ee.a.nhd(Y))}return this.QWb};Fc.Rxi=function(){var Y=Fc.sec("inproductmessaging.js");Y=Wf.a.create(Y,null,null);return Fc.dad(Y)};Fc.Jxi=function(){var Y=Fc.sec("inproductmessaging.css");Y=new fd(Y);return Fc.dad(Y)};Fc.sec=function(Y){return Le.a.S4b(String.format("ipm/{0}",Y))};Fc.dad=function(Y){Uf.a.Bja(Y);return Y.z9a};Object(pd.a)(Fc,"DependencyDownloader",null,[851]);kf.x0i="inProductMessagingOverlayDiv";kf.h3i="PlayButtonImage";kf.Ijj="ReplayButtonImage";Object(pd.a)(kf,"Constants",
null,[]);Ve.prototype.pxj=function(){this.zqe(kf.h3i,this.i3i);this.zqe(kf.Ijj,this.Jjj)};Ve.prototype.zqe=function(Y,Ra){Ra&&(this.gfg[Y]=Ra)};uk.Object.defineProperties(Ve.prototype,{gRg:{configurable:!0,enumerable:!0,get:function(){return this.u5d},set:function(Y){this.u5d=Y}},dGi:{configurable:!0,enumerable:!0,get:function(){return this.afe},set:function(Y){this.afe=Y}},TFj:{configurable:!0,enumerable:!0,get:function(){return this.Pke},set:function(Y){(this.Pke=Y)&&this.pxj()}}});Object(pd.a)(Ve,
"FirstRunExperienceUISettings",null,[850]);Object(pd.a)(Ad,"FirstRunExperienceViewData",null,[849]);var lg=b(178),Ef=b(105);ae.prototype.Sg=function(){this.La.gf(lf.a.SHh,Ef.a.frame,Object(za.a)(this,this.QHh,"firstRunExperienceHandler"),64);this.La.ic(lf.a.aYe,Ef.a.frame,Object(za.a)(this,this.$ci,"inProductMessagingTabHandler"));this.La.ic(lf.a.$Xe,Ef.a.frame,Object(za.a)(this,this.Zci,"inProductMessagingShiftTabHandler"));this.La.ic(lf.a.tjh,Ef.a.frame,Object(za.a)(this,this.ujh,"dimeLaunchHandler"));
this.La.ic(lf.a.cWf,Ef.a.frame,lg.ActionManager.ug);this.La.ic(lf.a.gkj,Ef.a.frame,lg.ActionManager.ug);this.La.ic(lf.a.hkj,Ef.a.frame,lg.ActionManager.ug);this.jf&&this.jf.updateCommandUI()};ae.prototype.QHh=function(Y,Ra,Db,ec,gd){2===Db&&this.LUb.nwi(gd);return 32};ae.prototype.ujh=function(Y,Ra,Db,ec,gd){2===Db&&this.LUb.kwi(gd);return 32};ae.prototype.$ci=function(Y,Ra,Db){return 2===Db?this.LUb.Yzd():32};ae.prototype.Zci=function(Y,Ra,Db){return 2===Db?this.LUb.Wzd():32};Object(pd.a)(ae,"InProductMessagingActor",
null,[]);Object(pd.a)(Od,"DimeExperienceUISettings",null,[]);var eg=b(174),Na=b(496);Bc.prototype.Jfi=function(Y){eg.b("getHeaderApi")?Y.isFeatureEnabled("MsoPremiumBadge",!0).then(function(Ra){var Db=Y.isFreemiumUpsellEnabled();Db&&(appChrome.getHeaderApi().then(function(ec){ec.updatePremiumStatus(Ra,Db);return null}),Y.NAa("MsoPremiumBadge",function(ec){appChrome.getHeaderApi().then(function(gd){gd.updatePremiumStatus(ec.isEnabled,Db);return null})}));return null}):jc.ULS.sendTraceTag(593859840,
324,10,"getHeaderApi not available")};Bc.prototype.nwi=function(Y){var Ra=this;this.rXb.Mxi().continueWith(function(){Ra.sZa.pHj(Y)})};Bc.prototype.kwi=function(Y){function Ra(){}var Db="gopremium",ec=null;Y?(Y.experience&&""!==Object(Mb.a)(String,Y.experience)&&(Db=Object(Mb.a)(String,Y.experience)),Y.onTaskComplete&&(Ra=Y.onTaskComplete),Y.campaignId&&""!==Object(Mb.a)(String,Y.campaignId)&&(ec=Object(Mb.a)(String,Y.campaignId))):jc.ULS.sendTraceTag(51675402,324,50,"Experience not given, using default experience");
this.jof(Db,Ra,ec)};Bc.prototype.jof=function(Y,Ra,Db){var ec=this;Db=void 0===Db?null:Db;if(this.zbc&&this.Rtb){var gd={};gd.experience=Y||"gopremium";gd.campaignId=Db||Na.b(this.m2,this.uHc,Object(Mb.a)(String,gd.experience),!0);this.La.processAction(lf.a.cWf,2);jc.ULS.sendTraceTag(51675403,324,50,"Launching Freemium Upsell dialog: "+gd.experience);try{var Jd=Object.assign(new Od,{instance:this.Rtb,zlc:gd,Hbg:Ra||function(){},BXf:function(Xd){jc.ULS.sendTraceTag(51675405,324,50,"Dime launch result: "+
Xd.status)},HSf:function(){jc.ULS.sendTraceTag(51675406,324,10,"Dime launch error");ec.zbc=!1;ec.Rtb=null}});this.sZa.yFj(Jd)}catch(Xd){jc.ULS.sendTraceTag(51675407,324,10,"Dime launch error: "+Xd.message),this.zbc=!1,this.Rtb=null,Y={},this.La.Be(lf.a.Abc,2,(Y.experience=gd.experience,Y))}}else jc.ULS.sendTraceTag(39978392,324,10,"FreemiumUpsellDialogDependencies not loaded"),gd={},this.La.Be(lf.a.Abc,2,(gd.experience=Y,gd))};Bc.prototype.apf=function(){var Y=this;this.rXb.Oxi().continueWith(function(){try{var Ra=
Ee.a.Yl(Lc.AFrameworkApplication.uiCulture),Db=Na.c(Y.m2);if(Db){Ra={partnerId:Db,language:Ra};Ra.sessionId=Lc.AFrameworkApplication.userSessionId;Ra.authHint=Lc.AFrameworkApplication.ha.Wa("UserPrincipalName");var ec=Lc.AFrameworkApplication.ha.Wa("Puid")||"";""!==ec&&(Ra.userInfo={puid:ec});Y.Rtb=new Dime(Ra);Y.zbc=!0;jc.ULS.sendTraceTag(592721856,324,50,"Dime initialized")}else jc.ULS.sendTraceTag(51675409,324,15,"App not supported")}catch(gd){jc.ULS.sendTraceTag(51675410,324,10,"FreemiumUpsellDialogDependencies failed: "+
gd.message)}},3)};Bc.prototype.Yzd=function(){return this.sZa.Yzd()};Bc.prototype.Wzd=function(){return this.sZa.Wzd()};Object(pd.a)(Bc,"InProductMessagingUIManager",null,[848]);we.prototype.Init=function(Y){this.rme=Y};we.prototype.SendTrace=function(Y,Ra){jc.ULS.sendTraceTag(34182235,this.rme,this.dYa[Y],"{0}",Ra)};Object(pd.a)(we,"DefaultNetworkingManager",null,[881]);var Ib=b(255),vc=b(325),Yc=b(94);je.prototype.pHj=function(Y){Y&&(InProductMessaging.Networking.NetworkingMgr=new we,InProductMessaging.Networking.NetworkingMgr.Init(387),
InProductMessaging.Init(Y.TFj,Y.dGi,Y.gRg,Y.bHi,Y.locale,Object(za.a)(this,this.JOi,"onDismissFirstRunExperience"),Y.gfg),this.aTa(kf.x0i,!0))};je.prototype.yFj=function(Y){var Ra=this;if(Y&&Y.instance&&Y.zlc){var Db=document.getElementById("wacDimeContainer");Db||(Db=document.createElement("div"),Db.id="wacDimeContainer",document.body.appendChild(Db));Lc.AFrameworkApplication.ha.ra("DimeFocusManagerIsEnabled")&&this.aTa("wacDimeContainer",!1);Y.zlc.parentElementId="wacDimeContainer";Y.instance.launch(Y.zlc,
Y.Hbg).then(function(ec){Ra.WIb();document.body.removeChild(Db);Y.BXf(ec)}).catch(function(ec){Ra.WIb();document.body.removeChild(Db);Y.HSf(ec)})}else throw Error.argument("DimeExperienceUISettings");};je.prototype.aTa=function(Y,Ra){if(this.oc&&Y&&(Y=document.getElementById(Y),this.Afi(Y),Y=this.oc.JN("InProductMessagingFocusId"))){var Db=this.oc.Pi;Db&&"InProductMessagingFocusId"===Db.name||this.oc.US("InProductMessagingFocusId",!1);Ra&&this.PQf(Y.scope)}};je.prototype.Afi=function(Y){var Ra=!1;
Ra=void 0===Ra?!0:Ra;var Db=this.oc.Gi("InProductMessagingFocusId");Db.parent=Ib.AFrame.OU;var ec=new vc.DOMFocusListing(function(){return Y});ec.rcb=Ra;ec.oo(3);ec.oo(2);ec.oo(4);Ra=this.oc.Dta(function(){return Y},Db,ec);Ra.RIb();Ra.l0=!0;Ra.vIa=!0};je.prototype.PQf=function(Y){Y.el(Yc.FocusManager.instance().Z2);Y.el(Yc.FocusManager.instance().a3);Y.bindAction(Yc.FocusManager.instance().Z2,lf.a.aYe);Y.bindAction(Yc.FocusManager.instance().a3,lf.a.$Xe)};je.prototype.WIb=function(){this.oc&&(this.oc.Bda("InProductMessagingFocusId"),
this.oc.LRa("InProductMessagingFocusId"))};je.prototype.JOi=function(Y,Ra){this.WIb();Y=Object.assign(new Ad,{completed:Y,fej:Ra});Lc.AFrameworkApplication.Ib.Be(lf.a.PHh,2,Y)};je.prototype.Yzd=function(){var Y=document.activeElement,Ra=this.oc.IR();return Y&&Ra&&Ra.kf&&Y===Ra.kf.Eo?(Ra.kf.Cl(Y),Ra.kza()?32:8):4};je.prototype.Wzd=function(){var Y=document.activeElement,Ra=this.oc.IR();return Y&&Ra&&Ra.kf&&Y===Ra.kf.firstElement?(Ra.kf.Cl(Y),Ra.vPa()?32:8):4};Object(pd.a)(je,"InProductMessagingUIWrapper",
null,[847]);var Md=b(140);yd.prototype.hi=function(Y){Y.register(Fc,"Common.App.InProductMessaging.DependencyDownloader").as("Common.App.InProductMessaging.IDependencyDownloader").Ic().Nc(function(){return new Fc});Y.register(je,"Common.App.InProductMessaging.InProductMessagingUIWrapper").as("Common.IInProductMessagingUIWrapper").Ic().Nc(function(){return new je(Yc.FocusManager.instance())});Y.register(Bc,"Common.App.InProductMessaging.InProductMessagingUIManager").as("Common.IInProductMessagingUIManager").Ic().Nc(function(){return new Bc(Lc.AFrameworkApplication.Ib,
Y.resolve("Common.IInProductMessagingUIWrapper"),Y.resolve("Common.App.InProductMessaging.IDependencyDownloader"),Lc.AFrameworkApplication.sa.Qa.Yj,Lc.AFrameworkApplication.sa.Qa.dda)});Y.register(ae,"Common.App.InProductMessaging.InProductMessagingActor").Ic().Nc(function(){return new ae(Lc.AFrameworkApplication.Ib,Lc.AFrameworkApplication.sa,Y.resolve("Common.IInProductMessagingUIManager"))});Y.register(Ve,"Common.App.InProductMessaging.FirstRunExperienceUISettings").as("Common.IFirstRunExperienceUISettings").Ic().Nc(function(){return new Ve});
Y.register(Ad,"Common.App.InProductMessaging.FirstRunExperienceViewData").as("Common.IFirstRunExperienceViewData").Ic().Nc(function(){return new Ad});this.tb=Y};yd.prototype.init=function(){var Y=this;this.tb.resolve("Common.App.InProductMessaging.InProductMessagingActor").Sg();Lc.AFrameworkApplication.ha.tv(function(){Lc.AFrameworkApplication.sa.Qa.isReactSharedHeaderUxEnabled&&Md.a.get_instance().Qk(15,function(){Y.tb.qc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(Ra){Y.tb.resolve("Common.App.InProductMessaging.InProductMessagingUIManager").Jfi(Ra)})});
Lc.AFrameworkApplication.ha.ra("FreemiumUpsellShowDialogIsEnabled")&&Na.a()&&!xd.a.FB&&1!==Lc.AFrameworkApplication.sa.Qa.Yj&&Y.tb.qc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(Ra){Ra.isFeatureEnabled("MsoPremiumBadge",!0).then(function(Db){!Db&&Ra.isFreemiumUpsellEnabled()&&Y.tb.resolve("Common.App.InProductMessaging.InProductMessagingUIManager").apf();return null})})})};yd.prototype.dispose=function(){};yd.main=function(){ug.a.instance.nj(new yd)};uk.Object.defineProperties(yd.prototype,
{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.InProductMessaging"}}});Object(pd.a)(yd,"InProductMessagingPackage",null,[4,5]);Ae.prototype.ocd=function(Y){var Ra=new Sys.StringBuilder(this.gw.mKb);Ra.append("RoamingServiceHandler.ashx?action=");Ra.append("getFirstRunExperienceSettings");Ra.append("&");Ra.append(this.vjd(Y));Ra.append("&");Ra.append(Lc.AFrameworkApplication.uj);Lc.AFrameworkApplication.Ld.jm(Ra.toString(),1,null,null,!0,2,Object(za.a)(this,this.FLa,"getRequestSuccessCallback"),
Object(za.a)(this,this.Ika,"getRequestFailureCallback"),null)};Ae.prototype.pcd=function(Y){var Ra=new Sys.StringBuilder(this.gw.mKb);Ra.append("RoamingServiceHandler.ashx?action=");Ra.append("saveFirstRunExperienceSettings");Ra.append("&");Ra.append(Lc.AFrameworkApplication.uj);Ra=Ra.toString();Y=Af.c(Y);Lc.AFrameworkApplication.Ld.jm(Ra,2,Y,null,!0,4,Object(za.a)(this,this.E4i,"postRequestSuccessCallback"),Object(za.a)(this,this.SQa,"postRequestFailureCallback"),null)};Ae.prototype.FLa=function(Y){var Ra=
!1,Db=null;try{if(0<Y.data.oe.length){var ec=Object(Mb.a)(Object,Af.a(Y.data.oe)),gd=ec?ec[this.gw.$Yc]:null;gd&&(Db=Object(Mb.a)(Object,Af.a(gd.toString())))}Ra=!0}catch(Jd){this.Ika(null)}Ra&&this.pkb&&this.pkb(Y.data,Db)};Ae.prototype.Ika=function(Y){this.lkb&&this.lkb(Y?Y.data:null)};Ae.prototype.E4i=function(Y){this.xhe&&this.xhe(Y?Y.data:null)};Ae.prototype.SQa=function(Y){this.ymb&&this.ymb(Y?Y.data:null)};Ae.prototype.vjd=function(Y){for(var Ra=new Sys.StringBuilder("requestedsettings="),
Db=0;Db<Y.count;Db++)Ra.append(Y.pa(Db)),Db<Y.count-1&&Ra.append(";");return Ra.toString()};Object(pd.a)(Ae,"FirstRunExperienceRequestHandler",null,[]);De.prototype.VUd=function(Y){Y?(this.gw=Y,this.Woi()&&(jc.ULS.sendTraceTag(51675532,306,50,"Initiating call to get FRE data for current user from Roaming Settings Service"),Y=new se.a,Y.add(this.gw.$Yc),this.hUb=new Ae(this.gw,Object(za.a)(this,this.FLa,"getRequestSuccessCallback"),Object(za.a)(this,this.Ika,"getRequestFailureCallback"),null,Object(za.a)(this,
this.SQa,"postRequestFailureCallback")),this.hUb.ocd(Y)),(this.gw.J8a||Lc.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUITest",!1))&&this.WUd()):jc.ULS.sendTraceTag(51675531,306,10,"Invalid launcherSettings")};De.prototype.Woi=function(){try{if(this.gw.J8a)return!0;if(!Lc.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceEnabled",!0)||Lc.AFrameworkApplication.ha.ra("IsAnonymousUser"))return!1;if(this.gw.Tli||
this.gw.L8a||Lc.AFrameworkApplication.ha.ra("IsO365ConsumerHost"))return!0;var Y=Lc.AFrameworkApplication.ha.Wa("FlightId");return-1!==(Y?Y.toString().toLowerCase():"").indexOf("firstrunexperienceui")}catch(Ra){jc.ULS.sendTraceTag(576582624,306,10,"Error checking setting {0}",Ra?Ra.toString():null)}return!1};De.prototype.DZf=function(Y){var Ra={},Db={};Db.FREDisplayedDate=(new Date).toUTCString();Db.VersionDisplayed=Y;Db.RemindMeLater=!1;Ra[this.gw.$Yc]=Af.c(Db);jc.ULS.sendTraceTag(51675533,306,50,
"Initiating call to save FRE data for current user from Roaming Settings Service");this.hUb&&this.hUb.pcd(Ra)};De.prototype.FLa=function(Y,Ra){Y=Y?+Y.f4-+Y.TF:-1;Y>this.gw.uYf?jc.ULS.sendTraceTag(51675534,306,50,"Call to Roaming Settings Service took {0}ms. This is more than the {1}ms threshold. A new attempt will be made next time the user starts a new session.",Y,this.gw.uYf):Ra?this.mEj(Ra)?(jc.ULS.sendTraceTag(51675536,306,50,"FRE data already exists for current user. FRE UI should be displayed again. User selected 'Remind me later' option more than {0} hours ago.",
this.gw.uuf),this.WUd()):jc.ULS.sendTraceTag(51675537,306,100,"Current user has already seen this version of the FRE. No further action required."):(jc.ULS.sendTraceTag(51675535,306,50,"No FRE data found for current user. FRE UI should be displayed."),this.WUd())};De.prototype.Ika=function(Y){jc.ULS.sendTraceTag(51675541,306,10,"First Run Experience failed to GET data from Roaming Settings Service with status: {0}",Y?Y.httpStatus:-1)};De.prototype.SQa=function(Y){jc.ULS.sendTraceTag(51675542,306,
10,"First Run Experience failed to POST data to Roaming Settings Service with status: {0}",Y?Y.httpStatus:-1)};De.prototype.WUd=function(){var Y=this,Ra=Je.a.instance.Nh("Common.ISystemInitiatedFeedback");Ra?this.G7f(Ra):(jc.ULS.sendTraceTag(51675543,306,50,"Error resolving ISystemInitiatedFeedback"),Lc.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUIResolveFuture",!0)&&((Ra=Je.a.instance.qc("Common.ISystemInitiatedFeedback"))?Ra.execute(function(Db){Y.G7f(Db)}):
jc.ULS.sendTraceTag(539494111,306,50,"Error resolving ISystemInitiatedFeedback Future")))};De.prototype.G7f=function(Y){if(Y){var Ra=this.gw.eIh;Ra&&(Lc.AFrameworkApplication.oma(Ra),Lc.AFrameworkApplication.gmc(Ra));jc.ULS.sendTraceTag(51675544,306,50,"Attempting to display First Run Experience UI using floodgate.",Ra);Y.logActivity("ShowFirstRunExperienceUIV2",null);window.addEventListener?(this.ckb=Object(za.a)(this,this.FPi,"onFirstRunExperienceCampaignEvent"),window.addEventListener("FGWebSurfaceEvent",
this.ckb,!0),window.addEventListener("FRELaunchedEvent",this.ckb,!0)):(jc.ULS.sendTraceTag(51675545,306,50,"FRE V2 UI triggered. Attempting to save FRE data."),this.DZf(this.gw.currentVersion))}else jc.ULS.sendTraceTag(539494112,306,50,"Invalid ISystemInitiatedFeedback")};De.prototype.FPi=function(Y){if(Y){var Ra=Y.detail;Y=Y.type;var Db=this.gw&&this.gw.campaignId?this.gw.campaignId.split("-")[0]:null;if("FRELaunchedEvent"===Y||Db&&Ra&&Ra.id&&-1!==Ra.id.indexOf(Db))Ra.success&&(jc.ULS.sendTraceTag(51675546,
306,50,"FRE V2 UI has been launched. Attempting to save FRE data."),this.DZf(this.gw.currentVersion)),window.removeEventListener&&(window.removeEventListener("FGWebSurfaceEvent",this.ckb,!0),window.removeEventListener("FRELaunchedEvent",this.ckb,!0))}};De.prototype.mEj=function(Y){if("RemindMeLater"in Y&&"FREDisplayedDate"in Y){if("true"===Y.RemindMeLater.toString()&&(+new Date-+new Date(Y.FREDisplayedDate.toString()))/36E5>this.gw.uuf)return!0}else if(Lc.AFrameworkApplication.ha.ra("WacShowVersionBasedFREToAllUsers")&&
"VersionDisplayed"in Y&&Y.VersionDisplayed<this.gw.currentVersion)return jc.ULS.sendTraceTag(528262853,306,50,"Current version is higher so FRE V2 UI should be displayed again."),!0;return!1};Object(pd.a)(De,"FirstRunExperienceLauncher",null,[729]);Hf.prototype.hi=function(Y){this.tb=Y;this.tb.register(729,"Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher").Ic().Nc(function(){return new De})};Hf.prototype.init=function(){};Hf.prototype.dispose=function(){};Hf.main=function(){ug.a.instance.nj(new Hf)};
uk.Object.defineProperties(Hf.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.FirstRunExperienceLauncher"}}});Object(pd.a)(Hf,"FirstRunExperienceLauncherPackage",null,[4,5]);var Ed=b(224),ke=b(369),mc=b(273),Rc=b(372),nd=b(1),Td=b(36),Fe=b(9),fe=b(388),ef=b(14),If=fe.a;Am(zf,If);zf.prototype.iW=function(){var Y={};Y.id=this.Cc;var Ra=ef.a.instance.fa(2191);Y.DialogMessage=Ra;return Y};uk.Object.defineProperties(zf.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"ClipboardReadPermissionAskDialog"}}});
Object(pd.a)(zf,"ClipboardReadPermissionAskDialog",fe.a,[]);var Ke=b(49);He.prototype.jhf=function(Y){return Y?this.sessionStateId===Y.sessionStateId&&this.sessionId===Y.sessionId:!1};He.prototype.isFromCurrentSession=function(Y){return this.sessionId===Y.ya.UserSessionId};Object(pd.a)(He,"SourceItem",null,[]);Am(qd,He);qd.prototype.isEqual=function(Y){return Y&&Object.getType(Y)===qd?this.jhf(Y)&&this.activeFloatingObjectControlId===Y.activeFloatingObjectControlId&&this.sheetName===Y.sheetName:!1};
qd.prototype.toString=function(){return this.type.toString()};Object(pd.a)(qd,"ArtSourceItem",He,[]);var ng;(function(Y){Y[Y.valid=0]="valid";Y[Y.notPairwiseDisjoint=1]="notPairwiseDisjoint";Y[Y.cutNotSupportedInDiscontinuousSelection=2]="cutNotSupportedInDiscontinuousSelection";Y[Y.notValidForm=3]="notValidForm";Y[Y.temporarilyBlockedCopy=4]="temporarilyBlockedCopy"})(ng||(ng={}));Object(pd.b)("CopySourceValidationOptions",ng);var rf=b(45);Am(ne,He);ne.prototype.isEqual=function(Y){return Y&&Object.getType(Y)===
ne?this.jhf(Y)&&rf.Q(this.ranges,Y.ranges)&&this.sheetName===Y.sheetName:!1};ne.prototype.toString=function(){return rf.i(this.ranges,",",this.$,!1)};Object(pd.a)(ne,"RangeSourceItem",He,[]);La.c_j="PasteError_FailedToReadFromClipboard_UserHashMismatchError";Object(pd.a)(La,"ExpectedErrorNames",null,[]);$d.qX="text/plain";$d.html="text/html";$d.png="image/png";$d.nP="data/shadow-workbook";$d.Foi="metadata/is-last-copy-was-external";$d.jli="metadata/is-last-copy-was-external-XLO-source";$d.J0g="metadata/chrome-extension-id";
$d.H5c="copyId";$d.ZLg="metadata/additional-signature-data-attributes";Object(pd.a)($d,"ClipboardDataFormat",null,[]);var dg=b(47),qf=b(20),$g=b(32);Lb.prototype.hLa=function(){return Lb.a2i};Lb.prototype.gTh=function(){return this.V$b&&1===this.V$b.length?this.hTh(this.V$b[0]):null};Lb.prototype.hTh=function(Y){var Ra=qf.g(this.$),Db=Ra.rb.wj(Y),ec=Ra.jg(Y,Db);Ra=Ra.rtl;if(!ec)return null;Y=qf.g(this.$).Kf(Db);var gd=Y.An;if(!gd.Od(ec))return null;ec=gd.We(ec);var Jd=ec.topLeft.y,Xd=ec.bottomRight.y,
xe=Ra?ec.bottomRight.x:ec.topLeft.x;ec=Ra?ec.topLeft.x:ec.bottomRight.x;var cf=new dg.a(ec+(Ra?-81:81),Xd+38+6);if(gd.yIa(cf))return this.z5a(Y,gd,Db,ec,Xd,Ra?12:-3,66);cf=new dg.a(ec+(Ra?-81:81),Xd);if(gd.yIa(cf))return this.z5a(Y,gd,Db,ec,Xd,Ra?20:3,22);cf=new dg.a(ec,Xd+38+6);if(gd.yIa(cf))return this.z5a(Y,gd,Db,ec,Xd,-81+(Ra?18:0),66);ec=new dg.a(xe+(Ra?81:-81),Xd);if(gd.yIa(ec))return this.z5a(Y,gd,Db,xe,Xd,-81+(Ra?12:-6),22);Xd=new dg.a(xe,Jd-38-6);return gd.yIa(Xd)?this.z5a(Y,gd,Db,xe,Jd,
Ra?15:0,16):this.z5a(Y,gd,Db,Ra?gd.topLeft.x:gd.bottomRight.x,gd.bottomRight.y,-81+(Ra?15:-6),22)};Lb.prototype.z5a=function(Y,Ra,Db,ec,gd,Jd,Xd){var xe=qf.g(this.$),cf=xe.rtl;Y=Sys.UI.DomElement.getLocation(Y.domElement);ec=new Sys.UI.Point(ec+(cf?0:Y.x)-Ra.topLeft.x,gd+Y.y-Ra.topLeft.y);cf&&(xe=xe.view.visibleArea,ec.x=xe.bottomRight.x-xe.topLeft.x-ec.x,2===Db||4===Db)&&(ec.x+=Ra.bottomRight.x);ec=$g.a(this.$).Gka(ec);return new Sys.UI.Point(ec.x+Jd,ec.y+Xd)};uk.Object.defineProperties(Lb.prototype,
{YLg:{configurable:!0,enumerable:!0,get:function(){return this.xog}},Gwi:{configurable:!0,enumerable:!0,get:function(){return this.Ovg}},rbj:{configurable:!0,enumerable:!0,get:function(){return this.yyg}},ODh:{configurable:!0,enumerable:!0,get:function(){return this.nsg}}});Lb.a2i=["PasteRecoveryUI"];Object(pd.a)(Lb,"PasteRecoveryUI",null,[899]);var nf=b(78),Qe=b(326);vd.MDg="ActiveSelection";vd.nP="ShadowWorkbook";vd.Omg="GVML";vd.qX="PlainText";vd.html="Html";vd.qSg="Bitmap";Object(pd.a)(vd,"PayloadType",
null,[]);ie.XHj="Slice4";ie.YHj="Slice5";ie.ZHj="Slice6";Object(pd.a)(ie,"SliceName",null,[]);Zd.QIi="NotCalled";Zd.success="Success";Zd.failed="Failed";Object(pd.a)(Zd,"SucceededPopulatingSystemClipboardOptions",null,[]);var fh=b(374),Rg;(function(Y){Y[Y.valid=0]="valid";Y[Y.destinationRangesIsEmpty=1]="destinationRangesIsEmpty";Y[Y.discontinuousSelectionNotSupportPasteFromExternal=2]="discontinuousSelectionNotSupportPasteFromExternal";Y[Y.discontinuousSelectionNotSupportPasteCrossSession=3]="discontinuousSelectionNotSupportPasteCrossSession";
Y[Y.multipleSourcesAndMultipleDestinationsAreNotSupported=4]="multipleSourcesAndMultipleDestinationsAreNotSupported";Y[Y.multipleDestinationsAreNotMultiplyOfSourceRange=5]="multipleDestinationsAreNotMultiplyOfSourceRange";Y[Y.sourceAndDestinationAreOverlapping=6]="sourceAndDestinationAreOverlapping";Y[Y.copySourceNotValid=7]="copySourceNotValid";Y[Y.cutNotSupportedInDiscontinuousSelection=8]="cutNotSupportedInDiscontinuousSelection";Y[Y.pasteLinkNotSupportMultipleDestination=9]="pasteLinkNotSupportMultipleDestination";
Y[Y.temporarilyBlockedPaste=10]="temporarilyBlockedPaste";Y[Y.unknown=100]="unknown"})(Rg||(Rg={}));Object(pd.b)("PasteValidationOptions",Rg);var ah=b(51),pg=b(39),Ga=b(150),Hb=b(35),Dc=b(158),Bd=b(356),Fd=b(29),Be=b(328),Me=b(8),sf=b(21),Qa=b(106),cb=b(167),bc=b(145),yc=b(626),bd=b(97),Kd=b(290),de=Td.a;Am(Ud,de);Ud.prototype.lKg=function(Y){this.addHandler(Ud.fFd,Y)};Ud.prototype.Ghj=function(Y){this.removeHandler(Ud.fFd,Y)};Ud.prototype.copy=function(Y){var Ra=this;Y.stopwatch=this.$.Sb.Hc("UserAction",
Ke.b().yi(Y.ribbonCommandInfo.command)+"ClientSide");if(this.Do){var Db=ah.GetServiceTaskFactory.Ua(this.$.da,478,479,0);Hb.TaskExtensions.Ba(Db,function(){Ra.pasteShortcutManager=Db.result},this.la,3)}var ec=!!id(this.rL);nd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!xd.a.oD&&(this.y8a=!1);this.ps("Copy/before/"+ke.a[Y.ribbonCommandInfo.method],!1,void 0,!0,Y.copyPasteTargetType).catch(function(){});var gd=-1985798686===Y.ribbonCommandInfo.command;
if(1===this.gridView.Ye&&(gd=this.rs.Cgf(this.gridView.ga.va.selectedRanges,gd),0!==gd)){var Jd=Ud.W6g(gd);this.pAa(Jd,ng[gd],!1);return Promise.reject(!1)}Y.userHash=this.userHash;Y.id=le.a.create().toString();var Xd=this,xe=this;return this.J5b.onCopy(Y).then(function(cf){cf.isAsyncCopy||Y.stopwatch.stop();Xd.pasteIndicationManager.oNe();jc.ULS.sendTraceTag(24150883,0,50,"CopyPasteInfrastructure.OnCopy: Copy operation finished successfully. {0}",fh.d(Y));Xd.kzi(cf,ec);!Y.isFormatPainter&&Xd.Do&&
(Xd.pasteShortcutManager?Xd.pasteShortcutManager.bph():jc.ULS.shipAssertTag(537167823,0,!1,"Copy: pasteShortcutManager is null."));return Promise.resolve(!0)},function(cf){var pf=!1,ff="none",tg=Ud.Ftb,Ig=!0,qg=-1,pi=Ud.copyErrorName+Ud.XJa,Ld=!1,qi=null;if(cf){qi=cf.copyContext;qg=cf.reason;pi+=Ud.pLa(cf);cf.message&&(tg=cf.message);var W=Ud.V6g(cf);if(W)if(3===W.copyErrorName)pf=!0,tg=ff="Async Copy canceled by the user.",Ig=!1;else if(Fd.a.Ar(W.ewaErrors))if(tg=xe.Wcc(W.ewaErrors),Fd.a.uh(W.ewaErrors,
Ud.operationSucceededWithAlert))Ld=pf=!0;else if(Fd.a.uh(W.ewaErrors,Ud.pasteDataLimitHit)||Fd.a.uh(W.ewaErrors,Ud.copyThrottlingError))pf=!0;13===cf.reason?(pf=!0,Ig=!1):11===cf.reason&&(Ig=!1)}pf?jc.ULS.sendTraceTag(36304157,0,15,"CopyPasteInfrastructure.OnCopy: Copy operation failed with an expected error. clearStateNeeded: {0}, Friendly message: {1}, Error Message: {2}, CommandParameters: {3}",Ig,ff,cf?xe.getStringifiedError(cf):"null",fh.d(Y)):jc.ULS.sendTraceTag(24150912,0,10,"CopyPasteInfrastructure.OnCopy: Copy operation failed with an unexpected error. clearStateNeeded: {0}, Error Message: {1}, CommandParameters: {2}",
Ig,cf?xe.getStringifiedError(cf):"null",fh.d(Y));Ig&&xe.ps("Copy/fail/"+ke.a[Y.ribbonCommandInfo.method],!0,void 0,void 0,Y.copyPasteTargetType).catch(function(){});xe.jzi(Y,pf,tg,pi,qg,Ld,qi);return Promise.reject(cf)})};Ud.prototype.paste=function(Y){var Ra=this;Y.stopwatch=this.$.Sb.Hc("UserAction",Ke.b().yi(Y.ribbonCommandInfo.command)+"ClientSide");nd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!xd.a.oD&&(jc.ULS.sendTraceTag(537167822,0,50,"CopyPasteInfrastructure.OnPaste: Cross-app shadow workbook paste is enabled"),
this.y8a=!1,Y.clipboardPicklingApiDataFormatsToRead=[$d.nP]);qf.g(this.$).Ri&&qf.g(this.$).Ri.t8(this.$id(Y.ribbonCommandInfo.command),Y.stopwatch.id);if(Y.isPasteCommandFromRecoveryUI){var Db=this.$.da.Aa(406);var ec=mc.a.clone(Db.Ivd);Db=Db.xvd;Y.pasteRecoveryCachedClipboardItems=Db?Db[Ud.DKf]:null}else ec=mc.a.clone(this.gridView.ga.va.selectedRanges);Y.originalDestinations=ec;Y.expandDestinations=this.h1c(Y.originalDestinations,Y.commandType);if(this.u1c(Y.commandType,Y.expandDestinations)||this.HYg())return Y.userHash=
this.userHash,Y.id=le.a.create().toString(),nd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PerfImpactExperimentForAsyncApi",!1)&&!xd.a.oD&&(Y.clipboardReadPermissionPromptShown=!1,Y.clipboardAsyncApiDataFormatsToRead=[$d.qX+"Async"],this.J5b.shouldShowClipboardReadPermissionDialog().then(function(gd){gd&&(Y.clipboardReadPermissionPromptShown=!0,new zf(Ra.$));return Promise.resolve(!0)},function(){return Promise.resolve(!0)})),this.J5b.onPaste(Y).then(function(gd){return Ra.cqc(gd,Y)},
function(gd){return Ra.dGb(Y,gd)});this.$.ae(927125067,nf.a.$b,30,null);jc.ULS.sendTraceTag(24150913,0,15,'CopyPasteInfrastructure.OnPaste: paste was triggered but the estimated destination range is not editable, do nothing. ExpandDestinations: {0}, CommandType: {1}, copyPasteTargetType="{2}"',rf.i(Y.expandDestinations,",",this.$,!1),Y.commandType,Y.copyPasteTargetType);return Promise.resolve(!0)};Ud.prototype.$id=function(Y){if(nd.EwaSettings.isChangeGateEnabled("OfficeVSO:4313497_PasteOptionPerfTelemetry"))switch(Y){case 1804571062:return 6;
case -185374993:return 7;case 1766348718:return 8}return 3};Ud.prototype.HYg=function(){return!!qf.g(this.$).ga.Pa.activeFloatingObjectControlId&&this.$.Br(null,!1,470)};Ud.prototype.ICb=function(){var Y=id(this.rL);return Y&&Y.commandParameters?Y.commandParameters.copyPasteTargetType:0};Ud.prototype.Eoi=function(){return!!id(this.rL)&&Pc(id(this.rL),this.$)};Ud.prototype.ps=function(Y,Ra,Db,ec,gd){var Jd=this;Db=void 0===Db?!1:Db;ec=void 0===ec?!1:ec;gd=void 0===gd?0:gd;try{this.Do&&this.pasteShortcutManager&&
this.pasteShortcutManager.n8b();var Xd=gd,xe=this.Evi();if(!ec&&2===xe)return jc.ULS.sendTraceTag(537167821,0,50,"CopyPasteInfrastructure.ClearState clipboard won't be cleared as there's art in the clipboard. clearClipboardContent = '{0}', isExplicit = '{1}', isForce = '{2}', Current CCP operation copyPasteTargetType = '{3}', LastCopyPasteTargetType = '{4}'",Ra,Db,ec,gd,xe),Promise.reject(null);0===Xd&&(Xd=xe);var cf=this.$.Sb.Hc("UserAction","ClearCopyState"),pf=cf.id;jc.ULS.sendTraceTag(537167820,
0,50,"CopyPasteInfrastructure.ClearState clear clipboard state. clearClipboardContent = '{0}', isExplicit = '{1}', isForce = '{2}', Current CCP operation copyPasteTargetType = '{3}', LastCopyPasteTargetType = '{4}'",Ra,Db,ec,gd,xe);this.rs.Wyb();this.F9i();return this.J5b.onCancelCopy(Ra).then(function(){Ra&&nd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!xd.a.oD&&(Jd.y8a=!1);cf.stop();Jd.Vpf(Y,pf,!0,Db,Ra,"","",cf.Gc,Xd);return Promise.resolve(!0)},
function(ff){jc.ULS.sendTraceTag(24150915,0,15,"CopyPasteInfrastructure.ClearState: error during call to copyPasteFlowManager.OnClear(). error: {0}",ff?Jd.getStringifiedError(ff):"null");cf.stop();var tg=Ud.WYg+Ud.XJa,Ig=Ud.Ftb;ff&&(tg+=Ud.pLa(ff),ff.message&&(Ig=ff.message));Jd.Vpf(Y,pf,!1,Db,Ra,Ig,tg,cf.Gc,Xd);return Promise.reject(ff)})}catch(ff){return Promise.reject(null)}};Ud.prototype.j4b=function(Y,Ra,Db,ec,gd){Db=void 0===Db?!1:Db;ec=void 0===ec?!1:ec;gd=void 0===gd?0:gd;return ec||!nd.EwaSettings.ma(676)||
this.Llh()?this.ps(Y,Ra,Db,ec,gd):(jc.ULS.sendTraceTag(537167819,0,50,"CopyPasteInfrastructure.ClearStateOnlyIfClipboardHasContentFromSameSession clipboard won't be cleared as there is no content in the clipboard from the current session"),Promise.reject(null))};Ud.prototype.pAa=function(Y,Ra,Db){jc.ULS.sendTraceTag(590705172,0,50,"CopyPasteInfrastructure.PopupDiscontinuousSelectionErrorDialog: Blocked CCP due to discontinuous selection, reason: {0}",Ra);var ec=new bd.a;ec.ia("reason",Ra);yc.a(cb.a.discontinuousSelectionBlocking,
[Db?bc.a.W1i:bc.a.M7g],!0,!0,!1,!1,ec);Y=Fd.a.ed(1,1,738,Y,0,371863010,"DiscontinuousSelectionBlocking");nd.EwaSettings.Rz()?new Bd.a(this.$,Y):(Y=new Dc.ErrorDialog(this.$,Y),Y.initialize(),Y.pf())};Ud.prototype.Evi=function(){var Y=id(this.rL);return Y&&Y.sourceItem?Object.getType(Y.sourceItem)===qd?2:1:0};Ud.prototype.dragDropCells=function(Y,Ra,Db,ec,gd){var Jd=this;gd=void 0===gd?!1:gd;Y.stopwatch=this.$.Sb.Hc("UserAction","DragDropClientSide");this.ps("DragDrop/before/"+ke.a[Y.ribbonCommandInfo.method],
!1,void 0,void 0,Y.copyPasteTargetType).catch(function(){});var Xd=gd?2:1,xe=0;xe=gd?4:ec?256:128;var cf={encounteredDeploymentErrors:!1};cf.commandParameters=Y;Y.userHash=this.userHash;Y.id=le.a.create().toString();return this.rs.pasteRange(Y.ribbonCommandInfo,rf.q(Ra,this.$),rf.q(Db,this.$),Xd,xe,[Y.stopwatch],cf,!1).then(function(){jc.ULS.sendTraceTag(537167818,0,50,'CopyPasteInfrastructure.DragDropCells: success. copyPasteTargetType="{0}"',Y.copyPasteTargetType);Jd.gridView.ga.selectionType=-1;
Jd.fxd(Y,Xd,Ra,Db,cf);return Promise.resolve(!0)},function(pf){jc.ULS.sendTraceTag(537167817,0,10,'CopyPasteInfrastructure.DragDropCells: {0}, copyPasteTargetType="{1}"',pf?Jd.getStringifiedError(pf):"null",Y.copyPasteTargetType);return Jd.iDd(pf,Y,Xd,Ra,Db,cf)})};Ud.prototype.emh=function(Y,Ra,Db,ec,gd){var Jd=this;gd=void 0===gd?!1:gd;Y.stopwatch=this.$.Sb.Hc("UserAction","DragDropReplaceClientSide");this.j4b("DragDropReplace/before/"+ke.a[Y.ribbonCommandInfo.method],!1,void 0,void 0,Y.copyPasteTargetType).catch(function(){});
var Xd=gd?2:1,xe=0;xe=gd?4:ec?256:128;var cf={encounteredDeploymentErrors:!1};cf.commandParameters=Y;nd.EwaSettings.getBooleanFeatureGate(Qe.a.$8b,!1)&&(Y.isDragInsert=!1);Y.userHash=this.userHash;Y.id=le.a.create().toString();return this.rs.pasteRange(Y.ribbonCommandInfo,rf.q(Ra,this.$),rf.q(Db,this.$),Xd,xe,[Y.stopwatch],cf,!1).then(function(){jc.ULS.sendTraceTag(537167816,0,50,'CopyPasteInfrastructure.DragDropReplaceCells: success. copyPasteTargetType="{0}"',Y.copyPasteTargetType);Jd.gridView.ga.selectionType=
-1;Jd.fxd(Y,Xd,Ra,Db,cf);return Promise.resolve(!0)},function(pf){jc.ULS.sendTraceTag(537167815,0,10,'CopyPasteInfrastructure.DragDropReplaceCells: {0}, copyPasteTargetType="{1}"',pf?Jd.getStringifiedError(pf):"null",Y.copyPasteTargetType);return Jd.iDd(pf,Y,Xd,Ra,Db,cf)})};Ud.prototype.dmh=function(Y,Ra,Db,ec,gd){var Jd=this;gd=void 0===gd?!1:gd;Y.stopwatch=this.$.Sb.Hc("UserAction","DragDropInsertClientSide");this.j4b("DragDropInsert/before/"+ke.a[Y.ribbonCommandInfo.method],!1,void 0,void 0,Y.copyPasteTargetType).catch(function(){});
var Xd=gd?2:1,xe=rf.K(this.h1c([Db],Xd)),cf=this.$.ea.oa.sheetName,pf=this.$.ea.oa.sheetName,ff=rf.v(Ra,this.$);ff.SheetName=cf;cf=rf.v(xe,this.$);cf.SheetName=pf;ec=xe.isRow||Ra.isRow||ec?1:0;var tg={encounteredDeploymentErrors:!1};Y.isDragInsert=!0;tg.commandParameters=Y;Y.userHash=this.userHash;Y.id=le.a.create().toString();gd=this.rs.gmh(tg,ff,cf,gd,ec,Y.ribbonCommandInfo);var Ig=this;return Kd.c(gd.then(function(){jc.ULS.sendTraceTag(537167814,0,50,'CopyPasteInfrastructure.DragDropInsertCells: success. copyPasteTargetType="{0}"',
Y.copyPasteTargetType);Jd.gridView.ga.selectionType=-1;Jd.fxd(Y,Xd,Ra,Db,tg);return Promise.resolve(!0)},function(qg){jc.ULS.sendTraceTag(537167813,0,10,'CopyPasteInfrastructure.DragDropInsertCells: {0}, copyPasteTargetType="{1}"',qg?Ig.getStringifiedError(qg):"null",Y.copyPasteTargetType);return Ig.iDd(qg,Y,Xd,Ra,Db,tg)})).CWR(function(){return!0})};Ud.prototype.rhi=function(Y,Ra){var Db=this,ec=id(this.rL);if(!ec)return jc.ULS.sendTraceTag(537167812,0,50,"InsertCopiedCutCells: CopyContext must not be null or undefined"),
Eg.Task.Sa(!1);if(!od(ec.sourceItem))return jc.ULS.sendTraceTag(537167811,0,50,"InsertCopiedCutCells: CopyContext must be a Range"),Eg.Task.Sa(!1);var gd=ec.sourceItem;if(!gd)return jc.ULS.shipAssertTag(537167810,0,!!gd,"InsertCopiedCutCells: rangeSourceItem must not be null or undefined"),Eg.Task.Sa(!1);if(!gd.isFromCurrentSession(this.$))return jc.ULS.sendTraceTag(537167809,0,50,"InsertCopiedCutCells: rangeSourceItem is from a different session"),Eg.Task.Sa(!1);if(1<gd.ranges.length)return jc.ULS.sendTraceTag(537167808,
0,50,"InsertCopiedCutCells: multiple source ranges are not supported"),this.pAa(2129,"InsertCopiedCutCells",!0),Eg.Task.Sa(!1);ec=rf.K(gd.ranges);var Jd=this.gridView.ga.va.xd.clone();Y=rf.K(this.h1c([Jd],Y));var Xd=this.Jnf();gd=gd.sheetName;Jd=this.$.ea.oa.sheetName;var xe=rf.v(ec,this.$);xe.SheetName=gd;var cf=rf.v(Y,this.$);cf.SheetName=Jd;return(Y.Xf||ec.Xf?Eg.Task.Sa(0):Y.isRow||ec.isRow?Eg.Task.Sa(1):this.shi.$5b(this.$,qf.g(this.$).rtl)).CWR(function(pf){return Db.rs.executeInsertCopiedCutCellsOperation(xe,
cf,Xd,pf.result,Ra)}).continueWith(function(){Xd?Db.rs.Wyb():Db.ps("InsertCopiedCutCells/success/"+ke.a[Ra.method],!0)})};Ud.prototype.csd=function(){var Y=id(this.rL),Ra=this.gridView.ga.va.Wg;return!!Y&&od(Y.sourceItem)&&Ra&&1===Y.sourceItem.ranges.length};Ud.prototype.Jnf=function(){return this.Knf(-911352779)};Ud.prototype.nlc=function(){return this.Knf(-1985798686)};Ud.prototype.u1c=function(Y,Ra){var Db=new Ga.a(this.$.xa),ec=36===Y,gd=Db.qe(4);Y=2===this.ICb()&&Db.qe(1);ec=ec&&gd;Db=!Db.zj||
!this.nlc()||!Ga.a.N8b(Ra,qf.g(this.$));return ec||Y||this.$.Br(Ra,!0)&&Db};Ud.prototype.Aic=function(Y,Ra){return this.rs.Aic(Y,Ra)};Ud.prototype.dispose=function(){de.prototype.dispose.call(this);this.wm();this.rL.removeMetadataChangeListener(Ud.muf)};Ud.prototype.L9c=function(Y,Ra,Db,ec,gd,Jd){if(!this.X1g(Y.commandParameters.ribbonCommandInfo.command))return Y.cseStatus=2,!1;if(Jd&&Ra.Od(ec))return Y.cseStatus=4,!1;if(Db!==gd)return Y.cseStatus=6,!1;if(nd.EwaSettings.isChangeGateEnabled("OfficeVSO:5593878_PasteCSE_CCPErrorTests")&&
(ec.width%Ra.width||ec.height%Ra.height))return Y.cseStatus=16,!1;if(nd.EwaSettings.getBooleanFeatureGate(Qe.a.jJe,!1)){if(Db=Ra,ec=ec.We(this.gridView.nh),Ra=null===Ra.We(this.gridView.nh),gd=Y.commandParameters.ribbonCommandInfo.command,Ra&&1804571062!==gd&&-185374993!==gd||!ec)return Y.cseStatus=7,!1}else if(Db=Ra.We(this.gridView.nh),ec=ec.We(this.gridView.nh),!Db||!ec)return Y.cseStatus=7,!1;Ra=rf.v(Db,this.$);Ra=this.Jh.Z1i(this.gridView,Ra,rf.v(ec,this.$),Y.commandParameters.ribbonCommandInfo.command,
Y.commandParameters.stopwatch);1===Ra&&(Jd&&(this.Jh.i3c(Db,!1),this.Jh.i3c(Db,!0)),-185374993===Y.commandParameters.ribbonCommandInfo.command&&qf.g(this.$).r9i(),this.pasteIndicationManager.Vmd(Y.commandParameters.id),this.nxc(Y.commandParameters.expandDestinations,Y.commandParameters.isPasteCommandFromRecoveryUI),this.RCe("DoPasteClientEstimation/"+ke.a[Y.commandParameters.ribbonCommandInfo.method],Y));Y.cseStatus=Ra;return 1===Ra};Ud.prototype.MLf=function(){this.copyPasteShortcutDialogFactory.create(this.$).showDialog(!0,
!1,!1,this.dBi)};Ud.prototype.Fqf=function(Y,Ra,Db,ec){Y=Ue(Y,Ra,Db,ec,this.$.ya.UserSessionId);Y.k=!0;Ke.b().Te(45,Y,!0)};Ud.prototype.EFf=function(Y,Ra,Db,ec,gd){var Jd=!1,Xd=!1,xe=Ud.Ftb,cf=Ud.sNe+Ud.XJa;Y&&(cf+=Ud.pLa(Y),Fd.a.Ar(Y.ewaErrors)?(xe=this.Wcc(Y.ewaErrors),Fd.a.uh(Y.ewaErrors,[-103190598])&&(Jd=!0)):Y.message&&(xe=Y.message));Xd||(Xd=this.vrd(Y));Ra=Ue(Ra,Db,ec,gd,this.$.ya.UserSessionId);Ra.k=!1;Ra.l=Xd;Ra.n=xe;Ra.p=cf;Ra.q=Jd;Ke.b().Te(45,Ra,!0);return Promise.reject(Y)};Ud.prototype.X1g=
function(Y){switch(Y){case 237279923:case 808159687:return Qe.a.Npi;case -185374993:return!0;case 1804571062:return!0;default:return!1}};Ud.prototype.Knf=function(Y){var Ra=id(this.rL);if(!Ra)return!1;var Db=Ra.sourceItem;return Db&&!Db.isFromCurrentSession(this.$)?(jc.ULS.sendTraceTag(537167779,0,50,"CopyPasteInfrastructure.LastOperationWasCopyCut: Last copy operation was from a different session."),!1):Ra.commandParameters.ribbonCommandInfo.command===Y};Ud.prototype.Llh=function(){var Y=id(this.rL);
return Y?(Y=Y.sourceItem)&&!Y.isFromCurrentSession(this.$)?(jc.ULS.sendTraceTag(537167778,0,50,"CopyPasteInfrastructure.DoesClipboardHaveCopiedOrCutContent: Last copy/cut operation was from a different session."),!1):!0:!1};Ud.prototype.CBj=function(Y){return Y&&Y.lastCopy?Pc(Y.lastCopy,this.$):!0};Ud.prototype.V1e=function(Y,Ra,Db,ec,gd){var Jd={};Jd.a=this.$.ya.UserSessionId;Jd.e=Y.stopwatch.id;Jd.c=Ke.b().yi(Y.ribbonCommandInfo.command);Jd.b=ke.a[Y.ribbonCommandInfo.method];Jd.d=Y.id;Jd.f=Db.toString();
Jd.g=ec.toString();Jd.h=Ra.toString();Jd.o=Y.stopwatch.Gc;Jd.q=!1;Jd.r=Y.copyPasteTargetType.toString();Jd.s=gd.encounteredDeploymentErrors;nd.EwaSettings.getBooleanFeatureGate(Qe.a.$8b,!1)&&(Jd.i=gd.commandParameters.dragDropIsShiftKeyDown,Jd.j=gd.commandParameters.isDragInsert);return Jd};Ud.prototype.fxd=function(Y,Ra,Db,ec,gd){Y=this.V1e(Y,Ra,Db,ec,gd);Y.k=!0;Ke.b().Te(45,Y,!0)};Ud.prototype.qzi=function(Y,Ra,Db,ec,gd,Jd,Xd,xe,cf){Y=this.V1e(Y,Ra,Db,ec,cf);Y.k=!1;Y.l=gd;Y.n=Jd;Y.p=Xd;Y.q=xe;Ke.b().Te(45,
Y,!0)};Ud.prototype.Vpf=function(Y,Ra,Db,ec,gd,Jd,Xd,xe,cf){var pf={};pf.a=this.$.ya.UserSessionId;pf.b=Ra;pf.c=Y;pf.f=Db;pf.e=ec;pf.d=gd;pf.g=Jd;pf.h=Xd;pf.i=xe;pf.j=cf.toString();Ke.b().Te(46,pf,!0)};Ud.prototype.kzi=function(Y,Ra){Y=this.q1e(Y.commandParameters,Y);Y.l=!0;Y.j=Ra;Ke.b().Te(43,Y,!0)};Ud.prototype.jzi=function(Y,Ra,Db,ec,gd,Jd,Xd){Y=this.q1e(Y,Xd);Y.l=!1;Y.m=Ra;Y.o=Db;Y.y=ec;Y.x=gd;Y.z=Jd;Ke.b().Te(43,Y,!0);jc.ULS.sendTraceTag(537167776,0,15,"CopyPasteInfrastructure.LogCopyFailedTelemetry: ErrorName={0},ErrorReason={1},IsExpectedError={2},IsSucceededWithAlert={3},ErrorMessage={4}",
Y.y,Y.x,Y.m,Y.z,Y.o)};Ud.prototype.q1e=function(Y,Ra){var Db={};Db.a=this.$.ya.UserSessionId;Db.f=Y.stopwatch.id;Db.g=Y.id;Db.c=Ke.b().yi(Y.ribbonCommandInfo.command);Db.b=ke.a[Y.ribbonCommandInfo.method];Db.q=Y.stopwatch.Gc;Db.bd=Ud.fcc();Db.bg=Y.copyPasteHandlerName;Db.bj=void 0===Y.ribbonCommandInfo.ef||null===Y.ribbonCommandInfo.ef?null:Rc.a[Y.ribbonCommandInfo.ef];Db.bq=Y.uploadToClipService;Db.br=Y.floatingObjectType;Db.s=Y.copyPasteTargetType.toString();Db.bc=Sc(Y.copyPasteTargetType);Db.z=
!1;if(Ra){Db.bk=Ra.id;Db.bl=Ra.serverRequestTimeInMs;Ra.requestTelemetryData&&(Db.bm=Ra.requestTelemetryData.EcsOperationDuration,Db.bn=Ra.requestTelemetryData.EcsRequestDuration,Db.bo=Ra.requestTelemetryData.WfeRequestDuration);Db.d=Ra.sourceItem?Ra.sourceItem.toString():null;Db.e=-1;if(od(Ra.sourceItem)){Db.e=0;Y=Cl(Ra.sourceItem.ranges);for(var ec=Y.next();!ec.done;ec=Y.next())Db.e+=ec.value.OQ}Db.h=Ra.isAsyncCopy;Db.i=Ra.isFromCache;Db.k=Ra.isSelectionAllowed;Db.r=Ra.plainTextPayloadSize;Db.u=
Ra.htmlPayloadSize;Db.v=Ra.htmlSizeExceedsLimit;Db.w=Ra.copyTotalSizeExceedsLimit;Db.t=Ra.shadowWorkbookPayloadSize;Db.p=Ra.clientSideCopyTime;Db.ba=Ra.encounteredDeploymentErrors;Db.bb=Ra.shadowWorkbookSizeExceedsLimit;Db.be=Ra.syncClipboardItemsKeys;Db.bf=Ra.asyncClipboardItemsKeys;Db.bh=this.iGe(Ra.succeededPopulatingSystemClipboardSync);Db.bi=this.iGe(Ra.succeededPopulatingSystemClipboardAsync)}return Db};Ud.prototype.nxc=function(Y,Ra){Ra=void 0===Ra?!1:Ra;if(!this.gridView.isEditing&&!this.gridView.Vi){var Db=
this.gridView.ga.va,ec=!Ra&&1===Y.length&&rf.Q(Y,Db.selectedRanges),gd=ec?Db.activeCell:Y[0].topLeft;Y[0].contains(gd)||(jc.ULS.shipAssertTag(537167775,0,!1,"CopyPasteInfrastructure.SelectPastedRange: SelectedRanges {0}, IndexOfActiveRange {1}, ActiveCell {2}, calculatedDestinationRanges {3}, keepThePreviousActiveCell {4}, newActiveCell {5}, isPasteCommandFromRecoveryUI {6}",Db.selectedRanges,Db.CB,Db.activeCell,Y,ec,gd,Ra),gd=Y[0].topLeft);this.gridView.ga.bE(Y,0,gd,0,void 0,Qa.a.R7g)}};Ud.prototype.l5e=
function(Y,Ra){var Db={};Db.a=this.$.ya.UserSessionId;Db.g=Y.stopwatch.id;Db.t=Y.stopwatch.Gc;Db.bz=!1;Ra&&(Db.bv=Ra.id,Db.bw=Ra.serverRequestTimeInMs,Db.n=Ra.commandParameters.clipboardFormatReadTimes,Db.o=Ra.commandParameters.clipboardFormatReadStatus,Db.p=Ra.commandParameters.clipboardReadPermissionPromptShown,Db.q=Ra.commandParameters.asyncApiReadTimedOut,Ra.requestTelemetryData&&(Db.cb=Ra.requestTelemetryData.EcsOperationDuration,Db.cc=Ra.requestTelemetryData.EcsRequestDuration,Db.cd=Ra.requestTelemetryData.WfeRequestDuration));
Db.x=Y.copyPasteTargetType.toString();Db.bl=Sc(Y.copyPasteTargetType);Db.br=Y.copyPasteHandlerName;Db.i=rf.i(Y.expandDestinations,",",this.$,!1);Db.h=rf.i(Y.originalDestinations,",",this.$,!1);Db.e=Y.id;Db.d=Y.commandType;Db.c=Ke.b().yi(Y.ribbonCommandInfo.command);Db.b=ke.a[Y.ribbonCommandInfo.method];Db.bf=!1;Db.bg=!1;Db.bp=Ud.fcc();Db.bt=void 0===Y.ribbonCommandInfo.ef||null===Y.ribbonCommandInfo.ef?null:Rc.a[Y.ribbonCommandInfo.ef];Db.cj=Y.isPasteCommandFromEnterShortcut;if(Db.ca=Y.isPasteCommandFromRecoveryUI)Db.cf=
Y.pasteRecoveryUndoStopwatch.id,Db.cg=Y.pasteRecoveryUndoStopwatch.Gc;if(Ra){if((Y=Ra.copyContextSnapshot)&&!Ra.wasLastCopyExternal){Db.f=Y.commandParameters.id;Db.j=Y.sourceItem.toString();Db.k=-1;if(od(Y.sourceItem)){Db.k=0;for(var ec=Cl(Y.sourceItem.ranges),gd=ec.next();!gd.done;gd=ec.next())Db.k+=gd.value.OQ}Db.bg=1===Y.commandParameters.commandType}else Ra.clipboardItems?Db.f=Ra.clipboardItems.getItem($d.H5c):jc.ULS.sendTraceTag(537167774,0,50,"CopyPasteInfrastructure.GetPasteUsageData: pasteContext.ClipboardItems is null");
Db.bz=Ra.pasteRecoveryUIDisplayed;Db.ci=Ra.cseStatus}else jc.ULS.sendTraceTag(537167773,0,50,"CopyPasteInfrastructure.GetPasteUsageData: pasteContext is null");return Db};Ud.prototype.wAi=function(Y,Ra,Db,ec,gd,Jd,Xd,xe,cf){Y=this.l5e(Y,xe);Y.l=!1;Y.m=Ra;Y.s=Db;Y.bc=ec;Y.be=gd;Y.bd=Jd;Y.bf=Xd;xe?(Y.y=Cd(xe)||!xe.copyContextSnapshot,Y.bi=!Y.y&&Pc(xe.copyContextSnapshot,this.$),Y.bj=xe.shadowWorkbookSizeExceedsLimit,Y.v=xe.shadowWorkbookPayloadSize,Y.w=xe.htmlPayloadSize,Y.bq=Ge(xe.clipboardItems),
Y.bb=xe.activeSelectionType,Y.bs=xe.isSameSession,Y.bn=xe.payloadOrigin,Y.bo=xe.payloadType,Y.bu=xe.externalAppSource,Y.bx=xe.indicationDisplayScheduled,Y.by=xe.pasteIndicationDisplayStatus,Y.ck=xe.pasteDestinationHasMergedCells):Y.bi=Pc(cf,this.$);Ke.b().Te(44,Y,!0);jc.ULS.sendTraceTag(537167772,0,15,"CopyPasteInfrastructure.LogPasteFailedTelemetry: ErrorName={0},ErrorReason={1},IsExpectedError={2},IsSucceededWithAlert={3},ErrorMessage={4}",Y.be,Y.bd,Y.m,Y.bf,Y.s)};Ud.prototype.xAi=function(Y){var Ra=
this.l5e(Y.commandParameters,Y);Ra.y=Y.wasLastCopyExternal;Ra.l=!0;Ra.u=Y.plainTextPayloadSize;Ra.v=Y.shadowWorkbookPayloadSize;Ra.w=Y.htmlPayloadSize;Ra.z=Y.isClipboardDataContainShadowWorkbook;Ra.ba=Y.isShadowWorkbookParsedSuccessfully;Ra.bb=Y.activeSelectionType;Ra.bc=Y.pasteResult;Ra.bh=Y.encounteredDeploymentErrors;Ra.bj=Y.shadowWorkbookSizeExceedsLimit;Ra.bk=uc(Y);Ra.bq=Ge(Y.clipboardItems);Ra.bs=Y.isSameSession;Ra.bn=Y.payloadOrigin;Ra.bo=Y.payloadType;Ra.bu=Y.externalAppSource;Ra.bx=Y.indicationDisplayScheduled;
Ra.by=Y.pasteIndicationDisplayStatus;Ra.ck=Y.pasteDestinationHasMergedCells;Ra.bm=Y.clipboardItems?Y.clipboardItems.getItem($d.J0g):null;Ra.bi=!Y.isSameSession&&!Y.wasLastCopyExternal;Ke.b().Te(44,Ra,!0)};Ud.prototype.Ik=function(){this.$.xa.Nf(this.li);this.$.xa.nre(this.Dpc);this.$.userOperationManager.Xu(this.GS);this.$.fl(this.vd);qf.g(this.$).zc.wl(this.tGb)};Ud.prototype.wm=function(){this.$&&this.$.xa&&(this.$.xa.Ag(this.li),this.$.xa.yUf(this.Dpc));this.$&&this.$.userOperationManager&&this.$.userOperationManager.dr(this.GS);
this.gridView&&this.gridView.zc&&this.gridView.zc.$k(this.tGb)};Ud.prototype.dGb=function(Y,Ra){var Db=null,ec=!1,gd=null,Jd="UnknownFailure",Xd=-1,xe=Ud.Ftb,cf=Ud.pasteErrorName+Ud.XJa,pf=!1;this.pasteIndicationManager.Vmd(Y.id);this.$if&&this.pasteDestinationHasMergedCells(Y.expandDestinations)&&(Ra.pasteContext.pasteDestinationHasMergedCells=!0);var ff=id(this.rL);(Y.clearStateOnFinish||Y.clearSystemClipboard)&&this.ps("Paste/fail/"+ke.a[Y.ribbonCommandInfo.method],!0,void 0,void 0,Y.copyPasteTargetType).catch(function(){});
if(Ra){Xd=Ra.reason;cf+=Ud.pLa(Ra);Ra.message&&(xe=Ra.message);if(Db=Ud.h7g(Ra))if(1===Db.pasteErrorName)ec=!0,Jd="CopyPasteLengthTooLongPopup",xe=gd="The pasted content is too long. Popup a dialog to the user.",jc.ULS.sendTraceTag(25216992,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',gd,Y.copyPasteTargetType),Db=Fd.a.ed(1,0,26,677,0,1306609195,"CopyPasteOversizeError"),nd.EwaSettings.Rz()?new Bd.a(this.$,Db):(Db=new Dc.ErrorDialog(this.$,Db),Db.initialize(),Db.pf());
else if(7===Db.pasteErrorName)ec=!0,Jd="No-Op",xe=gd="The shadow workbook is not ready yet and an async copy failed to populate the clipboard. Do nothing (by the spec)",jc.ULS.sendTraceTag(33948251,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',gd,Y.copyPasteTargetType);else if(8===Db.pasteErrorName)ec=!0,Jd="UseShortcutsPopup",xe=gd="Unable to paste content from the system clipboard. Popup dialog to the user.",jc.ULS.sendTraceTag(25216994,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',
gd,Y.copyPasteTargetType),this.MLf();else if(18===Db.pasteErrorName){ec=!0;Jd="PasteExternalNotSupportMultipleSelectionPopup";xe="Paste external not support multiple selection.";gd="Unknown";var tg=2129;100!==Db.validationFailureReason&&(gd=Rg[Db.validationFailureReason],tg=Ud.bGe(Db.validationFailureReason));this.pAa(tg,gd,!0)}else 20===Db.pasteErrorName||19===Db.pasteErrorName?(ec=!0,20===Db.pasteErrorName?(Jd="PasteAcrossSessionNotSupportMultipleSelectionPopup",xe="Paste across session does not support multiple selection."):
(Jd="PasteInSameSessionNotSupportMultipleSelectionPopup",xe="This kind of multiple selection is not supported for same session paste."),gd="Unknown",tg=2129,100!==Db.validationFailureReason&&(gd=Rg[Db.validationFailureReason],tg=Ud.bGe(Db.validationFailureReason)),Db=6===Db.validationFailureReason,this.u1c(Y.commandType,Y.expandDestinations)&&Db&&this.nxc(Y.expandDestinations),this.pAa(tg,gd,!0)):6===Db.pasteErrorName?(ec=!0,Jd="No-Op",xe=gd="Paste Formatting/Transpose is not yet a supported operation on System Clipboard based content",
jc.ULS.sendTraceTag(36263241,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',gd,Y.copyPasteTargetType)):17===Db.pasteErrorName?(ec=!0,Jd="No-Op",xe=gd="Paste text on Art is not yet a supported operation",jc.ULS.sendTraceTag(0,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',gd,Y.copyPasteTargetType)):16===Db.pasteErrorName?(ec=!0,Jd="No-Op",xe=gd="Paste has failed because the previous copy has failed",jc.ULS.sendTraceTag(537167771,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}", error={2}',
gd,Y.copyPasteTargetType,this.getStringifiedError(Db))):Fd.a.Ar(Db.ewaErrors)?(Fd.a.Q$(Db.ewaErrors)||Fd.a.uh(Db.ewaErrors,Fd.a.Fec())?(ec=!0,Jd="CommunicationError",gd=Fd.a.Wc(Db.ewaErrors),jc.ULS.sendTraceTag(36304159,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0} copyPasteTargetType="{1}"',xe,Y.copyPasteTargetType)):Fd.a.uh(Db.ewaErrors,Ud.Fpj)?(ec=!0,Jd="SavingWorkbookError",gd=Fd.a.Wc(Db.ewaErrors),jc.ULS.sendTraceTag(36304160,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0} copyPasteTargetType="{1}"',
xe,Y.copyPasteTargetType)):Fd.a.uh(Db.ewaErrors,Ud.operationSucceededWithAlert)&&(pf=ec=!0,Jd="OperationSucceededWithAlert",gd=Fd.a.Wc(Db.ewaErrors),jc.ULS.sendTraceTag(36304161,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0} copyPasteTargetType="{1}"',xe,Y.copyPasteTargetType)),ec||(xe=this.Wcc(Db.ewaErrors),ec=this.vrd(Ra))):11===Db.pasteErrorName&&(ec=!0,Jd="No-Op",xe="Paste has failed because user try copy cross-session oart object");15===Ra.reason&&(ec=!0,Jd="No-Op",xe="Rejecting deferred paste there is metadata update without copy context. Usually it means that copy canceled before finished.");
sf.a.equals(cf,La.c_j,!1)&&(ec=!0,Jd="No-Op",xe="User hash of the copy is different then the user hash of the paste during cross-session copy-paste. Do nothing.")}ec||jc.ULS.sendTraceTag(24150916,0,10,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',Ra?this.getStringifiedError(Ra):"null",Y.copyPasteTargetType);this.wAi(Y,ec,xe,Jd,cf,Xd,pf,Ra.pasteContext,ff);return Promise.reject(Ra)};Ud.prototype.cqc=function(Y,Ra){var Db;jc.ULS.sendTraceTag(24150917,0,50,'CopyPasteInfrastructure.OnPasteSuccess: paste succeed. copyPasteTargetType="{0}"',
Ra.copyPasteTargetType);this.pasteIndicationManager.Vmd(Ra.id);if(this.d2i(Ra.copyPasteTargetType,Y)){nd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!xd.a.oD&&Y.wasLastCopyExternal&&Y.payloadType===vd.nP&&(this.y8a=!0);var ec=null;(null===(Db=Y.pastedRange)||void 0===Db?0:Db.Ranges)&&0<Y.pastedRange.Ranges.length?ec=rf.g(Y.pastedRange.Ranges):Y.wasLastCopyExternal||(ec=Ra.expandDestinations);this.srj(Y,ec);if(this.zDj(Y,ec)){Db=mc.a.clone(Ra.originalDestinations);
ec=1028===Ra.commandType?mc.a.clone(Ra.expandDestinations):mc.a.clone(ec);var gd=null;Y.wasLastCopyExternal&&(Ra.isKeyboardEvent||Ra.isPasteCommandFromRecoveryUI)&&(gd={},gd=(gd[Ud.DKf]=Y.clipboardItems,gd));this.$if&&this.pasteDestinationHasMergedCells(Ra.expandDestinations)&&(Y.pasteDestinationHasMergedCells=!0);Y.pasteRecoveryUIDisplayed=!0;var Jd=new Lb(this.$,Db,ec,gd),Xd=ah.GetServiceTaskFactory.Ua(this.$.da,406,405,0);Hb.TaskExtensions.Ba(Xd,function(){var xe=Xd.result;xe.pSg(Jd);xe.NGj(Ra.ribbonCommandInfo.method)},
this.la,8)}}this.RCe("Paste/success/"+ke.a[Ra.ribbonCommandInfo.method],Y);this.xAi(Y);this.S6f&&(!Ra.isKeyboardEvent||uc(Y))&&this.$.ea.ah.get(66)&&(jc.ULS.sendTraceTag(537167770,0,15,"CopyPasteInfrastructure.OnPasteSuccess: show localStorage disable notification"),this.S6f=!1,this.I8g());return Promise.resolve(!0)};Ud.prototype.zDj=function(Y,Ra){return!Ra||1!==Ra.length||Y.commandParameters.clearSystemClipboard||Y.commandParameters.clearStateOnFinish||Y.commandParameters.skipClipboardAccess?!1:
Cd(Y)&&(Ra=Y.clipboardItems.getItem($d.qX),Y=Y.clipboardItems.getItem($d.html),void 0===Ra||null===Ra||Ra.length>this.bzd||void 0===Y||null===Y||Y.length>this.mPa)?(jc.ULS.sendTraceTag(537167769,0,50,"CopyPasteInfrastructure.ShouldShowPasteRecoveryUI: Not showing PasteRecoveryUI for external copy."),!1):!0};Ud.prototype.d2i=function(Y,Ra){return 1===Y||Ra.payloadType===vd.qX||nd.EwaSettings.ma(162)&&Ra.payloadType===vd.html||nd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",
!1)&&!xd.a.oD&&Ra.payloadType===vd.nP};Ud.prototype.pasteDestinationHasMergedCells=function(Y){var Ra=qf.g(this.$).Da.KF();if(!Ra||!Ra.length)return!1;Ra=Cl(Ra);for(var Db=Ra.next();!Db.done;Db=Ra.next())if(Db.value.Kw(Y[0]))return!0;return!1};Ud.prototype.RCe=function(Y,Ra){var Db=this,ec;(function(){var gd=Db.ili(Ra);ec=gd.aIa;return gd})().returnValue&&this.ps(Y,ec,void 0,void 0,Ra.commandParameters.copyPasteTargetType).catch(function(){})};Ud.prototype.iDd=function(Y,Ra,Db,ec,gd,Jd){jc.ULS.sendTraceTag(24150918,
0,10,"CopyPasteInfrastructure.OnDragAndDropCellsFailed: {0}",Y?this.getStringifiedError(Y):"null");var Xd=!1,xe=!1,cf=!1,pf=Ud.Ftb,ff=Ud.sNe+Ud.XJa;Y&&(ff+=Ud.pLa(Y),Fd.a.Ar(Y.ewaErrors)?(pf=this.Wcc(Y.ewaErrors),Fd.a.uh(Y.ewaErrors,Ud.operationSucceededWithAlert)&&(Xd=!0),Fd.a.uh(Y.ewaErrors,Ud.dragDropNonEmptyRange)&&(xe=cf=!0)):Y.message&&(pf=Y.message));cf||(cf=this.vrd(Y));xe?this.gridView.ga.selectionType=-1:this.rs.ubj(gd);this.qzi(Ra,Db,ec,gd,cf,pf,ff,Xd,Jd);return Promise.reject(Y)};Ud.prototype.h1c=
function(Y,Ra){var Db=Y,ec=this.oXh();if(null===ec||void 0===ec?0:ec.ranges)Db=this.rs.TXg(Ra,ec.ranges,Y);return Db};Ud.prototype.oXh=function(){var Y=id(this.rL);return Y&&od(Y.sourceItem)?Y.sourceItem:null};Ud.prototype.F9i=function(){this.raiseEvent(Ud.fFd,null)};Ud.prototype.srj=function(Y,Ra){var Db=Y.commandParameters.originalDestinations;Ra&&(rf.Q(this.gridView.ga.va.selectedRanges,Db)?(this.nxc(Ra),jc.ULS.sendTraceTag(537167767,0,50,"CopyPasteInfrastructure.SelectPastedRangeIfNeeded: select paste range, range: {0}",
Me.HelperMethods.Xpb(Ra))):Y.commandParameters.isPasteCommandFromRecoveryUI?(this.nxc(Ra,!0),jc.ULS.sendTraceTag(537167766,0,50,"CopyPasteInfrastructure.SelectPastedRangeIfNeeded: select paste range for IsPasteCommandFromRecoveryUI, range: {0}, active cell: {1}",Ra,Ra[0].topLeft)):jc.ULS.sendTraceTag(537167765,0,50,"CopyPasteInfrastructure.SelectPastedRangeIfNeeded: user change his selection during paste operation. don't change selection. originalPasteDestinations: {0}",Me.HelperMethods.Xpb(Db)))};
Ud.prototype.ili=function(Y){if(Y.isPlainTextPaste||Y.isHtmlPaste||ed(Y)||Y.commandParameters.isPasteCommandFromEnterShortcut)return{returnValue:!0,aIa:!1};var Ra=Y.copyContextSnapshot;if(Y.commandParameters.clearStateOnFinish)return{returnValue:!0,aIa:!0};if(Ra&&od(Ra.sourceItem)){var Db=Ra.sourceItem;if(!Db.isFromCurrentSession(this.$))return{returnValue:!1,aIa:!0};Ra=-1985798686===Ra.commandParameters.ribbonCommandInfo.command;if(!(1<Db.ranges.length||1<Y.commandParameters.expandDestinations.length)){var ec=
rf.K(Db.ranges);Y=rf.K(Y.commandParameters.expandDestinations);var gd=this.$.ea.oa.sheetName;Db=Db.sheetName;if(Db===gd&&Y.equals(ec))return{returnValue:!1,aIa:!0};if(Db===gd&&Y.We(ec))return{returnValue:!0,aIa:!1}}return{returnValue:Ra,aIa:!0}}return{returnValue:!1,aIa:!0}};Ud.prototype.FHf=function(){var Y=id(this.rL);(Y=this.rs.Mxb(Y))&&Y.isFromCurrentSession(this.$)&&this.ps("OnStartEdit",!1).catch(function(){})};Ud.prototype.Wcc=function(Y){Y=Fd.a.XTh(Y,Ud.XJa);return this.nFi+Ee.a.sw(Y).toString()};
Ud.prototype.vrd=function(Y){Y=Ud.pLa(Y);return!!Y&&sf.a.o3a(Y,Ud.mFi)};Ud.prototype.I8g=function(){var Y=Fd.a.ed(1,2,328,329,xd.a.yp?330:xd.a.lI?331:332,530046625,"ActivateLocalStorage"),Ra=ah.GetServiceTaskFactory.Ua(this.$.da,5,4,0);Hb.TaskExtensions.Ba(Ra,function(){Ra.result.lg(41,Y)},this.la,3)};Ud.prototype.iGe=function(Y){return void 0===Y||null===Y?Zd.QIi:Y?Zd.success:Zd.failed};Ud.h7g=function(Y){var Ra=Y.innerError;return Ra&&0!==Ra.pasteErrorName?Y.innerError:null};Ud.V6g=function(Y){var Ra=
Y.innerError;return Ra&&0!==Ra.copyErrorName?Y.innerError:null};Ud.pLa=function(Y){var Ra="";if(!Y)return Ud.uKe;Y.errorName&&(Ra=Y.errorName,Y.innerError&&(Ra+=Ud.XJa+Ud.pLa(Y.innerError)));Ra||(Ra=Y&&Y.name?Y.name:Ud.uKe);return Ra};Ud.fcc=function(){Ud.sNb||(pg.a.njf()?Ud.sNb=ie.ZHj:pg.a.Asd()?Ud.sNb=ie.YHj:Ud.sNb=ie.XHj);return Ud.sNb};Ud.bGe=function(Y){switch(Y){case 7:case 1:return 2136;case 5:return 2133;case 6:return 2132;case 8:case 3:case 2:case 4:case 9:case 10:return 2129;default:return jc.ULS.shipAssertTag(537167764,
0,!1,"CopyPasteInfrastructure.ConvertPasteValidationOptionToJsStringId: no case for validationOptions = {0}",Y),2136}};Ud.W6g=function(Y){switch(Y){case 3:return 2130;case 1:return 2131;case 2:case 4:return 2129;default:return jc.ULS.shipAssertTag(537167763,0,!1,"CopyPasteInfrastructure.ConvertCopySourceValidationOptionToJsStringId: no case for validationOptions = {0}",Y),2136}};uk.Object.defineProperties(Ud.prototype,{pasteIndicationManager:{configurable:!0,enumerable:!0,get:function(){return this.$.da.Aa(373)}}});
Ud.muf="EwaJsMetadataChangeListenerId";Ud.fFd="cpiOSC";Ud.Xgh="cpiDID";Ud.Ftb="Unknown";Ud.uKe="UnknownError";Ud.XJa="_";Ud.sNe="DragAndDropError";Ud.pasteErrorName="PasteError";Ud.WYg="CancelError";Ud.copyErrorName="CopyError";Ud.mFi="MergedCellOverlap";Ud.DKf="PasteRecoveryCachedClipboardItems";Ud.Fpj=[1352631530,1679665408];Ud.operationSucceededWithAlert=[-103190598];Ud.pasteDataLimitHit=[1306609195];Ud.copyThrottlingError=[-386183710];Ud.dragDropNonEmptyRange=[563945982];Ud.sNb=null;Object(pd.a)(Ud,
"CopyPasteInfrastructure",Td.a,[858,859,3]);Object(pd.a)(Ne,"ClipboardPlatformInitializationResult",null,[]);var Re=b(736),ce=b(124),Jb=b(5),Mc=b(83);Object(pd.a)(Ob,"MacroRecorderPasteRangePayload",null,[428]);hd.prototype.getContent=function(){return this.content};Object(pd.a)(hd,"MacroRecorderPasteStringPayload",null,[428]);var ld=b(62);Object(pd.a)(sc,"MacroRecorderPastePayload",null,[428]);var fg=b(645),Se=b(973),tf=b(561),af=b(173),Pf=b(210),Sd=b(118),Mf=b(288),mf=b(353);Pb.prototype.getParameters=
function(){return this.parameters};Object(pd.a)(Pb,"MacroRecorderRangeCopyCutCellsInsertedPayload",null,[428]);var ud=b(387);fb.prototype.copy=function(Y,Ra,Db,ec,gd){function Jd(pf,ff,tg){var Ig={CopyPasteTargetType:1};Ig.SourceRanges=Y;Ig.CopyOperationId=Ra.id;jc.ULS.sendTraceTag(537167756,0,50,"CopyPasteInfrastructure.Copy served from CopyPasteProxy : {0}, CopyOperationId : {1}",Xd.KNa,Ig.CopyOperationId);Xd.sOa=Xd.KNa?sb(Xd.$.na.Zx,Ig,Mf.b(pf,Db),ec?Mf.a(ff,ec):ff,tg,Ra.ribbonCommandInfo,xe,gd):
sb(Xd.$.na.ta,Ig,Mf.b(pf,Db),ec?Mf.a(ff,ec):ff,tg,Ra.ribbonCommandInfo,xe,gd);return Xd.sOa}var Xd=this;ec=void 0===ec?null:ec;gd=void 0===gd?null:gd;var xe=this.$.na.ta.fc();this.Upd&&this.gZ();this.blc=xe.ClientRequestId;var cf=nd.EwaSettings.uc()?new af.a(505,0,Jd,80):new tf.a(505,0,Jd,16);cf=this.$.userOperationManager.jc(cf,Ra.ribbonCommandInfo);this.Upd&&this.Dv.add(cf)};fb.prototype.CKf=function(Y,Ra,Db,ec,gd,Jd){var Xd=this;return new Promise(function(xe,cf){var pf,ff=Jd.commandParameters.stopwatch.Gc,
tg=2;20===Jd.commandParameters.commandType&&(tg=16);36===Jd.commandParameters.commandType&&(tg=32);pg.a.Asd()&&68===Jd.commandParameters.commandType&&(tg=64);pg.a.Pud(Xd.$)&&1028===Jd.commandParameters.commandType&&(tg=1024);var Ig=null;if(null===(pf=Jd.copyContextSnapshot)||void 0===pf?0:pf.commandParameters)Ig=Jd.copyContextSnapshot.commandParameters.id;fb.RQd(Xd.$,Y,ec,Ra,Db,null,function(qg){fb.dfc(qg,Jd,xe,cf,ff,Xd.$)},function(qg){Jd.serverRequestTimeInMs=Jd.commandParameters.stopwatch.Gc-ff;
qg=Sd.a.mg(qg.data);cf(new Se.a(5,qg))},gd,tg,Ig,Jd.commandParameters.id)})};fb.prototype.pasteRange=function(Y,Ra,Db,ec,gd,Jd,Xd,xe){var cf=this;return new Promise(function(pf,ff){var tg=Xd.commandParameters.stopwatch.Gc;fb.Fsj(cf.$,Y,Ra,Db,ec|-5&gd,function(Ig){fb.dfc(Ig,Xd,pf,ff,tg,cf.$)},function(Ig){Xd.serverRequestTimeInMs=Xd.commandParameters.stopwatch.Gc-tg;Ig=Sd.a.mg(Ig.data);ff(new Se.a(5,Ig))},Jd,xe)})};fb.prototype.a7i=function(Y,Ra,Db,ec,gd,Jd,Xd){var xe=this;return new Promise(function(cf,
pf){if(Ra)if(Ra.length>xe.mPa){var ff=Xd.clipboardItems.getItem($d.qX),tg=-1;void 0!==ff&&null!==ff&&(tg=ff.length);jc.ULS.sendTraceTag(42071712,0,15,"CopyPasteInfrastructure.ProcessPasteHtml copy paste length too long. clipboardHtml.Length: {0}, MaxHtmlImportLength: {1}, PlainTextLength: {2}",Ra.length,xe.mPa,tg);pf(new Se.a(1))}else ff=function(Ig,qg,pi){xe.$.Qy();var Ld=Xd.commandParameters.stopwatch.Gc;Ig=Mf.b(Ig,function(ob){fb.dfc(ob,Xd,cf,pf,Ld,xe.$,Ra)});qg=Mf.a(qg,function(ob){Xd.serverRequestTimeInMs=
Xd.commandParameters.stopwatch.Gc-Ld;ob=Sd.a.mg(ob.data);pf(new Se.a(3,ob))});var qi=xe.$.na.ta.fc(),W=rf.v(Y,xe.$),ta={};ta.SourceHtml=Ra;ta.DestinationRanges=W?rf.s(W):null;ta.CopyOperationId=Db;ta.PasteId=ec;jc.ULS.sendTraceTag(537167755,0,50,"CopyPasteInfrastructure.ProcessPasteHtml served from CopyPasteProxy : {0}. PasteId : {1}",xe.KNa,ta.PasteId);return xe.KNa?Hd(xe.$.na.Zx,ta,Ig,qg,pi,null,qi,Jd):Hd(xe.$.na.ta,ta,Ig,qg,pi,null,qi,Jd)},ff=nd.EwaSettings.uc()?new af.a(204,0,ff,65):new tf.a(204,
0,ff,1),xe.$.userOperationManager.jc(ff,gd);else cf("")})};fb.prototype.b7i=function(Y,Ra,Db,ec,gd){var Jd=this;return new Promise(function(Xd,xe){jc.ULS.sendTraceTag(537167754,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: method start. pasteContext.Id={0}",gd.id);Ra&&(Ra=sf.a.trimEnd(Ra,"\n","\r"));jc.ULS.sendTraceTag(537167753,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: after clipboardText.TrimEnd. pasteContext.Id={0}",gd.id);if(Ra){var cf=Jd.bzd;if(Ra.length>
cf)jc.ULS.sendTraceTag(24150921,0,15,"CopyPasteInfrastructure.ProcessPasteText copy paste length too long. clipboardText.Length: {0}, MaxCopyPasteLength: {1}",Ra.length,cf),xe(new Se.a(1));else{var pf=rf.v(Y,Jd.$);jc.ULS.sendTraceTag(537167752,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before treatAsLink calculation. pasteContext.Id={0}",gd.id);cf=!Jd.$.ea.isNamedObjectViewMode&&!Ra.includes("\n")&&!Ra.includes("\t");jc.ULS.sendTraceTag(537167751,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before isLink check. pasteContext.Id={0}. treatAsLink={1}",
gd.id,cf);cf=cf&&sf.a.Oif(Ra);jc.ULS.sendTraceTag(537167750,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: after treatAsLink calculation. pasteContext.Id={0}. treatAsLink={1}",gd.id,cf);var ff=Jd.$.na.ta.fc();if(cf){var tg=526;jc.ULS.sendTraceTag(537167749,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before FixUpUrl. pasteContext.Id={0}",gd.id);var Ig=Pf.a.ded(Ra);jc.ULS.sendTraceTag(537167748,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: after FixUpUrl. pasteContext.Id={0}",
gd.id);var qg=rf.s(pf);cf=function(Ld,qi,W){var ta=gd.commandParameters.stopwatch.Gc;Ld=Mf.b(Ld,function(ob){jc.ULS.sendTraceTag(537167747,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: on ApplyHyperlink successCallback. pasteContext.Id={0}",gd.id);gd.requestTelemetryData=ob.RequestTelemetryData;gd.serverRequestTimeInMs=gd.commandParameters.stopwatch.Gc-ta;ob.Errors&&0<ob.Errors.length?xe(new Se.a(2,ob.Errors)):Xd(Ra)});qi=Mf.a(qi,function(ob){gd.serverRequestTimeInMs=gd.commandParameters.stopwatch.Gc-
ta;ob=Sd.a.mg(ob.data);xe(new Se.a(2,ob))});Jd.$.Qy();jc.ULS.sendTraceTag(537167746,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before ApplyHyperlink. pasteContext.Id={0}",gd.id);return Mc.c(Jd.$.na.ta,qg,Ra,Ig,!1,!1,63,Ld,qi,W,Y,ff,ec)};var pi=function(){return new fg.a(qg,Ra,Ig)}}else tg=180,cf=function(Ld,qi,W){Jd.$.Qy();var ta=gd.commandParameters.stopwatch.Gc;Ld=Mf.b(Ld,function(ob){jc.ULS.sendTraceTag(537167745,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: on PasteString successCallback. pasteContext.Id={0}",
gd.id);fb.dfc(ob,gd,Xd,xe,ta,Jd.$,Ra)});qi=Mf.a(qi,function(ob){gd.serverRequestTimeInMs=gd.commandParameters.stopwatch.Gc-ta;ob=Sd.a.mg(ob.data);xe(new Se.a(4,ob))});jc.ULS.sendTraceTag(537167744,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before PasteString. pasteContext.Id={0}",gd.id);return ad(Jd.$.na.ta,pf,Ra,Ld,qi,W,null,ff,ec)},pi=function(){return new hd(pf,Ra)};jc.ULS.sendTraceTag(537167715,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before UserNonBlockingWebMethodOperation. pasteContext.Id={0}",
gd.id);cf=nd.EwaSettings.uc()?new af.a(tg,0,cf,65,pi):new tf.a(tg,0,cf,1,pi);jc.ULS.sendTraceTag(537167714,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: returning. pasteContext.Id={0}",gd.id);Jd.$.userOperationManager.jc(cf,Db)}}else Xd("")})};fb.prototype.Ibf=function(Y,Ra){Ra=[1===Ra?4:5];this.gridView.Fb.ox(mf.a.E8(ld.d(this.$.oa),Y),Ra,!0);this.gridView.Fb.co(Ra);this.gridView.Fb.update(!0)};fb.prototype.Wyb=function(){var Y=[4,5];this.gridView.Fb.si(Y,!1,!1);this.gridView.Fb.ak(null,
Y,!1);1===this.gridView.ga.Ye&&this.gridView.co(!1,!1);this.gridView.Fb.update(!1,!1)};fb.prototype.TXg=function(Y,Ra,Db){var ec=[];Db=Cl(Db);for(var gd=Db.next();!gd.done;gd=Db.next())Array.add(ec,this.WXg(Y,Ra,gd.value));return ec};fb.prototype.gZ=function(){if(this.Dv)for(var Y=Cl(this.Dv),Ra=Y.next();!Ra.done;Ra=Y.next())Ra=Ra.value,this.$&&this.$.userOperationManager&&(Ra.operation&&jc.ULS.sendTraceTag(526758675,0,50,"CopyPasteUtils.AbortOutstandingUserOperation: Trying to abort pending operation {0}.",
ce.a(Ra.operation.operationName)),this.UYg(),this.$.userOperationManager.nJa(Ra))};fb.prototype.UYg=function(){if(this.sOa){var Y=this.sOa.$t;jc.ULS.sendTraceTag(526758674,0,15,"Cancelling pending copy request with Id={0}",Y);Sd.a.Ku(Y);!nd.EwaSettings.isChangeGateEnabled("OfficeVSO:6151555_DisableCancelCopyRequest")&&this.blc&&Mc.j(this.$.na.ta,this.blc,null,null,null);this.blc=this.sOa=null}};fb.prototype.kG=function(Y,Ra){2===Ra.Au?(this.Dv.clear(),this.sOa=null):1===Ra.Au&&this.Dv&&this.Dv.contains(Ra.Mg)&&
(jc.ULS.sendTraceTag(526758673,0,50,"CopyPasteUtils.OnQueueChanged: web method {0} returned, it took {1} milliseconds to complete.",ce.a(Ra.Mg.operation.operationName),Ra.Mg.dequeueUtcTime.getTime()-Ra.Mg.enqueueUtcTime.getTime()),this.Dv.remove(Ra.Mg),this.sOa=null)};fb.prototype.WXg=function(Y,Ra,Db){jc.ULS.shipAssertTag(537167713,0,!!Ra,"CopyPasteUtils.CalculateSingleImpactedRange: sourceArray shouldn't be null");jc.ULS.shipAssertTag(537167712,0,0<Ra.length,"CopyPasteUtils.CalculateSingleImpactedRange: sourceArray length shouldn't be zero");
var ec=0,gd=0,Jd=new Set,Xd=new Set;Ra=Cl(Ra);for(var xe=Ra.next();!xe.done;xe=Ra.next()){xe=xe.value;var cf=String.format("{0}_{1}",xe.left,xe.right),pf=String.format("{0}_{1}",xe.top,xe.bottom);Xd.has(cf)||(Xd.add(cf),gd+=xe.width);Jd.has(pf)||(Jd.add(pf),ec+=xe.height)}if(36===Y)return Db.isSingle?fb.IVe(gd,ec,Db):Db.clone();516===Y&&(Y=ec,ec=gd,gd=Y);Y=!(Db.width%gd)&&!(Db.height%ec);Jd=Db.FW&&!(Db.height%ec);Db.Y_&&!(Db.width%gd)||Jd?Db=fb.IVe(gd,ec,Db):Y?Db=Db.clone():(Db=Db.clone(),Db.bottom=
Math.min(Fe.a.Sh,Db.top+ec-1),Db.right=Math.min(Fe.a.di,Db.left+gd-1));return Db};fb.prototype.jPg=function(Y,Ra,Db,ec,gd,Jd,Xd,xe,cf,pf,ff){if(!ec||!ec.length)return 1;if(1<ec.length){if(!this.Zhc&&Jd)return 3;if(pf)return 0;if(xe)return 9;if(cf)return 8;if(ff)return 2;if(1<Ra.length)return 4;var tg=Ra[0];if(!Xd&&!mc.a.all(ec,function(Ig){return Ig.isSingle||!(Ig.width%tg.width)&&!(Ig.height%tg.height)}))return 5;if((!this.Zhc||!Jd)&&sf.a.equals(Y,Db,!0))for(gd=Cl(gd),Y=gd.next();!Y.done;Y=gd.next())if(Y=
Y.value,Y.Od(tg)&&!Y.equals(tg))return 6}else if(Ra&&0<Ra.length){if(0!==this.Cgf(Ra,cf))return 7;if(1<Ra.length){if(!this.Zhc&&Jd)return 3;if((!this.Zhc||!Jd)&&sf.a.equals(Y,Db,!0))for(Y=Cl(Ra),Ra=Y.next();!Ra.done;Ra=Y.next())if(Ra=Ra.value,Db=gd[0],Ra.Od(Db)&&!Ra.equals(Db))return 6}}return 0};fb.prototype.Cgf=function(Y,Ra){if(!Y||1>=Y.length)return 0;if(Ra)return 2;if(!rf.S(Y))return 1;Ra=new Re.a(dc.a.Uk());for(var Db=Cl(Y),ec=Db.next();!ec.done;ec=Db.next()){ec=ec.value;for(var gd=Cl(Y),Jd=
gd.next();!Jd.done;Jd=gd.next()){Jd=Jd.value;var Xd=ec.top===Jd.top&&ec.bottom===Jd.bottom,xe=ec.left===Jd.left&&ec.right===Jd.right,cf=Math.max(ec.left,Jd.left)<Math.min(ec.right,Jd.right);if(Math.max(ec.top,Jd.top)<Math.min(ec.bottom,Jd.bottom)&&!Xd||cf&&!xe)return 3;Ra.add(String.format("{0}-{1}-{2}-{3}",ec.top,ec.bottom,Jd.left,Jd.right));Ra.add(String.format("{0}-{1}-{2}-{3}",Jd.top,Jd.bottom,ec.left,ec.right))}}Y=Cl(Y);for(Db=Y.next();!Db.done;Db=Y.next())Db=Db.value,Ra.remove(String.format("{0}-{1}-{2}-{3}",
Db.top,Db.bottom,Db.left,Db.right));return 0<Ra.count?3:0};fb.prototype.ubj=function(Y){var Ra=this.gridView.ga;Ra.updateSelection(Y,Y.topLeft,0);Ra.selectionType=-1};fb.prototype.Mxb=function(Y){if(null===Y||void 0===Y?0:Y.sourceItem){if(!od(Y.sourceItem))return null;if((Y=Y.sourceItem)&&rf.cb(Y.ranges,!0))return Y}return null};fb.prototype.Aic=function(Y,Ra){jc.ULS.shipAssertTag(537167711,0,!!Y,"CopyPasteUtils.IsFromKeyboardShortcut: commandInfo shouldn't be null");return Ra&&Jb.a.hJ in Ra||Y.tabName?
!1:1===Y.method};fb.Fsj=function(Y,Ra,Db,ec,gd,Jd,Xd,xe,cf){function pf(){return new Ob(Db,ec,gd)}function ff(Ig,qg,pi){Y.Qy();var Ld=Y.na.ta;Ig=Mf.b(Ig,Jd);qg=Mf.a(qg,Xd);var qi=xe;qi=void 0===qi?null:qi;var W=Ld.Ma(9,tg);W.sourceRanges=Db;W.destinationRanges=ec;W.flags=gd;return Mc.i(Ld,"PasteRange",W,Ig,qg,pi,null,64,qi)}var tg=Y.na.ta.fc(cf);cf=nd.EwaSettings.uc()?new af.a(506,0,ff,65,pf):new tf.a(506,0,ff,1,pf);Y.userOperationManager.jc(cf,Ra)};fb.dfc=function(Y,Ra,Db,ec,gd,Jd,Xd){Xd=void 0===
Xd?null:Xd;jc.ULS.sendTraceTag(537167710,0,50,"CopyPasteInfrastructure.HandlePasteResult profiling trace: on HandlePasteResult start. pasteContext.Id={0}",Ra.id);Ra.requestTelemetryData=Y.RequestTelemetryData;Ra.serverRequestTimeInMs=Ra.commandParameters.stopwatch.Gc-gd;Fd.a.vh(Y.Errors)?Fd.a.Xha(Y.Errors)?(Ra&&(Ra.encounteredDeploymentErrors=!0),jc.ULS.sendTraceTag(537167707,0,15,"CopyPasteUtils.HandlePasteServerResponse: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: {0}",
Fd.a.Wc(Y.Errors))):ec(new Se.a(5,Y.Errors)):Y.Result?(ec=!!Y&&!!Y.RequestTelemetryData,qf.g(Jd).Ri.xma(Ra.commandParameters.stopwatch.id,Y.StateId,ec?Y.RequestTelemetryData.EcsOperationDuration:0,ec?Y.RequestTelemetryData.EcsRequestDuration:0,ec?Y.RequestTelemetryData.WfeRequestDuration:0),Ra.pastedRange=Y.Result.SheetMultiRange,jc.ULS.sendTraceTag(537167708,0,50,"CopyPasteInfrastructure.HandlePasteResult profiling trace: resolving promise ewaResult.Result is not null. pasteContext.Id={0}",Ra.id),
Db(!0)):(jc.ULS.sendTraceTag(537167709,0,50,"CopyPasteInfrastructure.HandlePasteResult profiling trace: resolving promise when ewaResult.Result is null. pasteContext.Id={0}",Ra.id),Db(Xd||!0))};fb.RQd=function(Y,Ra,Db,ec,gd,Jd,Xd,xe,cf,pf,ff,tg){function Ig(){return new sc(Ld)}function qg(qi,W,ta){Y.Qy();return Ac(Y.na.ta,Ld,Mf.b(qi,Xd),Mf.a(W,xe),ta,Jd,pi,cf)}var pi=Y.na.ta.fc(),Ld=fb.Kbh(Db,ec,gd,pf,ff,tg);Db=nd.EwaSettings.uc()?new af.a(503,0,qg,65,Ig):new tf.a(503,0,qg,1,Ig);Y.userOperationManager.jc(Db,
Ra)};fb.Kbh=function(Y,Ra,Db,ec,gd,Jd){var Xd={};Xd.ShadowWorkbookBase64=Y.shadowWorkbookBase64;Xd.SourceRanges={};Xd.SourceRanges.Ranges=Array(1);Xd.SourceRanges.Ranges[0]={};Xd.SourceRanges.Ranges[0].FirstRow=Y.rangeRowStart;Xd.SourceRanges.Ranges[0].LastRow=Y.rangeRowEnd;Xd.SourceRanges.Ranges[0].FirstColumn=Y.rangeColumnStart;Xd.SourceRanges.Ranges[0].LastColumn=Y.rangeColumnEnd;nd.EwaSettings.getBooleanFeatureGate(Qe.a.L6b,!1)?Db?Xd.DestinationRanges=rf.u(Db.SheetName,Db.NamedObjectName,rf.g(Db.Ranges)):
(jc.ULS.sendTraceTag(537167706,0,15,"CopyPasteInfrastructure.CreatePasteParameters: multiRangeDestination is null"),Xd.DestinationRanges=null):Xd.DestinationRanges=Ra?rf.s(Ra):null;Xd.CopyPasteTargetType=1;Xd.PasteType=ec;Xd.CopyOperationId=gd;Xd.PasteId=Jd;Xd.SourceClientPath=Y.sourceClientPath;Xd.SourceSheetName=Y.sourceSheetName;Xd.SourceWorkbookName=Y.sourceWorkbookName;if(!Y.originalSourceRangesCountExceedsLimit&&Y.originalSourceRanges&&0<Y.originalSourceRanges.length&&1024===ec){Xd.OriginalSourceMultiRange=
{};Ra=Array(Y.originalSourceRanges.length);for(Db=0;Db<Ra.length;++Db)Ra[Db]={},Ra[Db].FirstRow=Y.originalSourceRanges[Db][0],Ra[Db].FirstColumn=Y.originalSourceRanges[Db][1],Ra[Db].LastRow=Y.originalSourceRanges[Db][2],Ra[Db].LastColumn=Y.originalSourceRanges[Db][3];Xd.OriginalSourceMultiRange.Ranges=Ra}return Xd};fb.IVe=function(Y,Ra,Db){Db=Db.clone();Db.height<Ra&&(Db.bottom=Math.min(Fe.a.Sh,Db.top+Ra-1));Db.width<Y&&(Db.right=Math.min(Fe.a.di,Db.left+Y-1));return Db};fb.prototype.executeInsertCopiedCutCellsOperation=
function(Y,Ra,Db,ec,gd,Jd,Xd){function xe(){return new Pb(cf)}Jd=void 0===Jd?null:Jd;Xd=void 0===Xd?null:Xd;var cf={};cf.InsertDirection=ec;cf.SourceRange=Y;cf.DestRange=Ra;cf.CopyCutOperation=Db?0:1;var pf=this.$.na.ta;return ud.a(this.$.userOperationManager,function(ff,tg,Ig){ff=Jd?Mf.b(ff,Jd):ff;tg=Xd?Mf.a(tg,Xd):tg;var qg=pf.Ma(41,null);qg.insertCopiedCutCellsParameters=cf;return Mc.i(pf,"InsertCopiedCutCells",qg,ff,tg,Ig,null,4)},function(ff){return new af.a(104,0,ff,void 0,xe)},gd)};fb.prototype.gmh=
function(Y,Ra,Db,ec,gd,Jd){var Xd=this;return new Promise(function(xe,cf){function pf(tg){tg=Sd.a.mg(tg.data);cf(new Se.a(21,tg))}function ff(tg){Y.requestTelemetryData=tg.RequestTelemetryData;tg.Errors&&0<tg.Errors.length?cf(new Se.a(21,tg.Errors)):xe(!0)}nd.EwaSettings.isChangeGateEnabled("OfficeVSO:6126613_RemoveClearingRunningAntsICCCForDragInsert")?Xd.executeInsertCopiedCutCellsOperation(Ra,Db,ec,gd,Jd,ff,pf):Xd.executeInsertCopiedCutCellsOperation(Ra,Db,ec,gd,Jd,ff,pf).continueWith(function(){if(ec)Xd.Wyb();
else{var tg=Xd.$.da.Aa(254);tg&&tg.j4b("DragDropInsert/success/"+ke.a[Jd.method],!0)}})})};uk.Object.defineProperties(fb.prototype,{bzd:{configurable:!0,enumerable:!0,get:function(){jc.ULS.sendTraceTag(537167757,0,50,"CopyPasteUtils.MaxCopyPasteLength returning BootstrapContext.MaxCopyPasteLength. MaxCopyPasteLength={0}",this.$.ya.MaxCopyPasteLength);return this.$.ya.MaxCopyPasteLength}},mPa:{configurable:!0,enumerable:!0,get:function(){return this.KNa?nd.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.CopyPasteHtmlImportMaxLength",
this.$.ya.CopyPasteMaxPayloadLength):Fe.a.mPa}}});Object(pd.a)(fb,"CopyPasteUtils",null,[857]);var Vf=b(539),Ih;(function(Y){Y[Y.range=0]="range";Y[Y.art=1]="art"})(Ih||(Ih={}));Object(pd.b)("SourceItemType",Ih);var Cf=b(24),ye=b(95);va.prototype.serializeSourceItem=function(Y){var Ra={};if(Y&&Object.getType(Y)===ne)Ra.sheetName=Y.sheetName,Ra.topArray=mc.a.map(Y.ranges,function(Db){return Db.top}),Ra.leftArray=mc.a.map(Y.ranges,function(Db){return Db.left}),Ra.bottomArray=mc.a.map(Y.ranges,function(Db){return Db.bottom}),
Ra.rightArray=mc.a.map(Y.ranges,function(Db){return Db.right}),Ra.sessionStateId=Y.sessionStateId,Ra.sessionId=Y.sessionId,Ra.sourceItemType=this.U0f(0);else if(Y&&Object.getType(Y)===qd)Ra.activeFloatingObjectControlId=Y.activeFloatingObjectControlId,Ra.sheetName=Y.sheetName,Ra.sessionStateId=Y.sessionStateId,Ra.sessionId=Y.sessionId,Ra.floatingObjectType=this.gtj(Y.type),Ra.sourceItemType=this.U0f(1);else return jc.ULS.shipAssertTag(537167705,0,!1,"EnvironmentSerializationHelper.SerializeSourceItem: sourceItem shouldn't be null."),
null;return JSON.stringify(Ra)};va.prototype.serializeCommandParameters=function(Y){if(!Y)return jc.ULS.shipAssertTag(537167704,0,!1,"EnvironmentSerializationHelper.Serialize: commandParameters shouldn't be null."),null;var Ra={};Ra.id=Y.id;Ra.commandType=Y.commandType;Ra.copyPasteTargetType=Y.copyPasteTargetType;Y.ribbonCommandInfo&&(Ra.ribbonCommandName=this.otj(Y.ribbonCommandInfo.command),Ra.inputMethodName=this.itj(Y.ribbonCommandInfo.method),Ra.frameModeName=this.htj(Y.ribbonCommandInfo.mode),
Ra.uiLocationName=this.rtj(Y.ribbonCommandInfo.ef),Ra.tabName=Y.ribbonCommandInfo.tabName);return JSON.stringify(Ra)};va.prototype.deserializeSourceItem=function(Y){if(!Y)return null;try{var Ra=JSON.parse(Y);if(!Ra)return jc.ULS.shipAssertTag(537167703,0,!1,"EnvironmentSerializationHelper.Deserialize: Json.Parse return null result."),null;var Db=null;switch(this.Zhh(Ra.sourceItemType)){case 0:Db=new ne(this.$,this.Whh(Ra),Ra.sheetName,Ra.sessionStateId,Ra.sessionId);break;case 1:Db=new qd(Ra.activeFloatingObjectControlId,
Ra.sheetName,Ra.sessionStateId,Ra.sessionId,this.Thh(Ra.floatingObjectType))}return Db}catch(ec){return jc.ULS.sendTraceTag(537167702,0,10,"EnvironmentSerializationHelper.DeserializeSourceItem: got exception while try to JSON.Parse string length: {0}, errror: {1}",Y?Y.length:0,ec),null}};va.prototype.deserializeCommandParameters=function(Y){if(!Y)return null;try{var Ra=JSON.parse(Y);if(!Ra)return jc.ULS.shipAssertTag(537167701,0,!1,"EnvironmentSerializationHelper.DeserializeCommandParameters: Json.Parse return null result."),
null;var Db=fh.a();Db.id=Ra.id;Db.ribbonCommandInfo=this.Yhh(Ra);Db.commandType=Ra.commandType;Db.copyPasteTargetType=Ra.copyPasteTargetType;return Db}catch(ec){return jc.ULS.sendTraceTag(537167700,0,10,"EnvironmentSerializationHelper.DeserializeCommandParameters: got exception while try to JSON.Parse string length: {0}, errror: {1}",Y?Y.length:0,ec),null}};va.prototype.Whh=function(Y){var Ra=[];jc.ULS.shipAssertTag(537167699,0,!!Y.topArray&&0<Y.topArray.length,"EnvironmentSerializationHelper.DeserializeRanges: TopArray shouldn't be {0}.",
Y.topArray?"empty":"null");jc.ULS.shipAssertTag(537167698,0,!!Y.leftArray&&0<Y.leftArray.length,"EnvironmentSerializationHelper.DeserializeRanges: LeftArray shouldn't be {0}.",Y.leftArray?"empty":"null");jc.ULS.shipAssertTag(537167697,0,!!Y.bottomArray&&0<Y.bottomArray.length,"EnvironmentSerializationHelper.DeserializeRanges: BottomArray shouldn't be {0}.",Y.bottomArray?"empty":"null");jc.ULS.shipAssertTag(537167696,0,!!Y.rightArray&&0<Y.rightArray.length,"EnvironmentSerializationHelper.DeserializeRanges: RightArray shouldn't be {0}.",
Y.rightArray?"empty":"null");if(!(Y.topArray&&Y.leftArray&&Y.bottomArray&&Y.rightArray))return Ra;jc.ULS.shipAssertTag(537167695,0,Y.topArray.length===Y.bottomArray.length&&Y.topArray.length===Y.leftArray.length&&Y.topArray.length===Y.rightArray.length,"EnvironmentSerializationHelper.DeserializeRanges: The length of TopArray({0}), BottomArray({1}), LeftArray({2}), RightArray({3}) should be the same.",Y.topArray.length,Y.bottomArray.length,Y.leftArray.length,Y.rightArray.length);for(var Db=Math.min(Y.topArray.length,
Y.bottomArray.length,Y.leftArray.length,Y.rightArray.length),ec=0;ec<Db;ec++)Array.add(Ra,new Cf.Range(Y.topArray[ec],Y.leftArray[ec],Y.bottomArray[ec],Y.rightArray[ec],!1,!1));return Ra};va.prototype.Yhh=function(Y){return new ye.a(this.Xhh(Y.ribbonCommandName),this.Vhh(Y.inputMethodName),this.Uhh(Y.frameModeName),this.$hh(Y.uiLocationName),Y.tabName)};va.prototype.otj=function(Y){return void 0!==Y&&null!==Y&&Y.toString()in this.WOd?this.WOd[Y.toString()]:(jc.ULS.shipAssertTag(537167694,0,!1,"EnvironmentSerializationHelper.SerializeRibbonCommand expected to get RibbonCommand.Copy({0}) or RibbonCommand.Cut({1}) but got {2}",
-911352779,-1985798686,Y),this.WOd["-911352779"])};va.prototype.Xhh=function(Y){return Y&&Y in this.iag?this.iag[Y]:(jc.ULS.shipAssertTag(537167693,0,!1,"EnvironmentSerializationHelper.DeserializeRibbonCommand: expected to get RibbonCommand.Copy({0}) or RibbonCommand.Cut({1}) but got {2}",-911352779,-1985798686,Y),-911352779)};va.prototype.itj=function(Y){return void 0!==Y&&null!==Y&&ke.a[Y]in this.qla?this.qla[ke.a[Y]]:(jc.ULS.shipAssertTag(537167692,0,!1,"EnvironmentSerializationHelper.SerializeInputMethod: got unexpected value {0}",
Y),this.qla.unknown)};va.prototype.Vhh=function(Y){return Y&&Y in this.hag?this.hag[Y]:(jc.ULS.shipAssertTag(537167691,0,!1,"EnvironmentSerializationHelper.DeserializeInputMethod: got unexpected value {0}",Y),0)};va.prototype.htj=function(Y){return void 0!==Y&&null!==Y&&Vf.a[Y]in this.v4a?this.v4a[Vf.a[Y]]:(jc.ULS.shipAssertTag(537167690,0,!1,"EnvironmentSerializationHelper.SerializeFrameMode: got unexpected value {0}",Y),this.v4a.edit)};va.prototype.Uhh=function(Y){return Y&&Y in this.gag?this.gag[Y]:
(jc.ULS.shipAssertTag(537167689,0,!1,"EnvironmentSerializationHelper.DeserializeFrameMode: got unexpected value {0}",Y),2)};va.prototype.U0f=function(Y){return void 0!==Y&&null!==Y&&Ih[Y]in this.CNb?this.CNb[Ih[Y]]:(jc.ULS.shipAssertTag(537167688,0,!1,"EnvironmentSerializationHelper.SerializeSourceItemType: got unexpected value {0}",Y),this.CNb.range)};va.prototype.Zhh=function(Y){return Y&&Y in this.jag?this.jag[Y]:(jc.ULS.shipAssertTag(537167687,0,!1,"EnvironmentSerializationHelper.DeserializeSourceItemType: got unexpected value {0}",
Y),0)};va.prototype.gtj=function(Y){return void 0!==Y&&null!==Y&&Y.toString()in this.MZc?this.MZc[Y.toString()]:(jc.ULS.shipAssertTag(537167686,0,!1,"EnvironmentSerializationHelper.SerializeArtSourceItemType: got unexpected value {0}",Y),this.MZc["99"])};va.prototype.Thh=function(Y){return Y&&Y in this.fag?this.fag[Y]:(jc.ULS.shipAssertTag(537167685,0,!1,"EnvironmentSerializationHelper.DeserializeArtSourceItemType: got unexpected value {0}",Y),99)};va.prototype.rtj=function(Y){return void 0!==Y&&
null!==Y&&Rc.a[Y]in this.Yr?this.Yr[Rc.a[Y]]:(jc.ULS.shipAssertTag(36229129,0,!1,"EnvironmentSerializationHelper.SerializeUILocation: got unexpected value {0}",Y),this.Yr.ribbon)};va.prototype.$hh=function(Y){return Y&&Y in this.kag?this.kag[Y]:(jc.ULS.shipAssertTag(537167684,0,!1,"EnvironmentSerializationHelper.DeserializeUILocation: got unexpected value {0}",Y),2)};Object(pd.a)(va,"EnvironmentSerializationHelper",null,[]);Kc.lZf="SameSession";Kc.kJe="CrossSession";Kc.uof="LegacyCrossSession";Kc.external=
"External";Object(pd.a)(Kc,"PayloadOrigin",null,[]);ac.prototype.shouldWaitForCopyToComplete=function(){return!1};ac.prototype.onDeferredPasteStarted=function(){};ac.prototype.onDeferredPasteCompleted=function(){};ac.prototype.beforePaste=function(){};ac.prototype.bTj=function(Y){var Ra=null;try{var Db=Y.getItem($d.nP);if(!Db)return{returnValue:!1,u1:Ra};Ra=JSON.parse(Db);return{returnValue:this.Kti(Ra),u1:Ra}}catch(ec){return jc.ULS.sendTraceTag(537167835,0,50,"BaseCopyPasteHandler.TryParseRangeShadowWorkbookPayload: Exception caught: "+
ec),{returnValue:!1,u1:Ra}}};ac.prototype.Kti=function(Y){return!!Y&&(!!Y.shadowWorkbookBase64||Y.shadowWorkbookSizeExceedsLimit)&&void 0!==Y.rangeRowStart&&void 0!==Y.rangeRowEnd&&void 0!==Y.rangeColumnStart&&void 0!==Y.rangeColumnEnd};ac.prototype.Mrc=function(Y){Y.wasLastCopyExternal=!0;if(nd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!xd.a.oD&&516!==Y.commandParameters.commandType&&1028!==Y.commandParameters.commandType){var Ra=this.bTj(Y.clipboardItems);
var Db=Ra.u1;if(Ra.returnValue)return Y.isShadowWorkbookParsedSuccessfully=!0,this.X1i(Y,Db)}return 516!==Y.commandParameters.commandType&&36!==Y.commandParameters.commandType?nd.EwaSettings.ma(162)&&20!==Y.commandParameters.commandType&&(null===this.$.shortcutKeyManager||this.$.shortcutKeyManager.dic)&&(Db=Y.clipboardItems.getItem($d.html),void 0!==Db&&null!==Db&&Db&&Db.trim()!==this.QZc&&(Db.startsWith("<")||xd.a.Hf&&Db.startsWith("\n<")))?(Ra=Y.clipboardItems.getItem($d.H5c),this.V1i(Y,Db,void 0===
Ra?null:Ra)):this.yKf(Y):Promise.reject(new Se.a(6))};ac.prototype.X1i=function(Y,Ra){jc.ULS.sendTraceTag(537167834,0,50,"BaseCopyPasteHandler.PasteFromExternalByShadowWorkbook: Pasting shadow workbook from system clipboard");Y.pasteResult="SystemClipboardShadowWorkbookPaste";Y.payloadType=vd.nP;Y.payloadOrigin=Kc.external;Y.shadowWorkbookPayloadSize=Zc(Ra);Y.shadowWorkbookSizeExceedsLimit=Uc(Ra);var Db=null,ec=null,gd=Y.commandParameters.originalDestinations;nd.EwaSettings.getBooleanFeatureGate(Qe.a.L6b,
!1)?Db=rf.r(gd,this.$):ec=rf.v(rf.K(gd),this.$);Ra.hasOwnProperty("originalSourceRangesCountExceedsLimit")&&(Y.originalSourceRangesCountExceedsLimit=Ra.originalSourceRangesCountExceedsLimit);if(Y.shadowWorkbookSizeExceedsLimit)return jc.ULS.sendTraceTag(537167833,0,15,"BaseCopyPasteHandler.PasteFromExternalByShadowWorkbook: shadow workbook length({0}) is over the limit({1}). reject the paste request. ShadowWorkbookSizeExceedsLimit: {2}",Y.shadowWorkbookPayloadSize,Fe.a.Xmc,Ra.shadowWorkbookSizeExceedsLimit),
Promise.reject(new Se.a(1));jc.ULS.sendTraceTag(537167832,0,50,"BaseCopyPasteHandler.PasteFromExternalByShadowWorkbook: trigger Paste request. PasteOperationId={0}",Y.commandParameters.id);return this.rs.CKf(Y.commandParameters.ribbonCommandInfo,ec,Db,Ra,[Y.commandParameters.stopwatch],Y)};ac.prototype.yKf=function(Y){var Ra=Y.clipboardItems.getItem($d.qX);if(void 0!==Ra&&null!==Ra&&Ra.trim()===this.QZc)return Promise.reject(new Se.a(7));void 0!==Ra&&null!==Ra&&(Y.plainTextPayloadSize=Ra.length);
Y.isPlainTextPaste=!0;Y.pasteResult="SystemClipboardPaste";Y.payloadOrigin=uc(Y)?Kc.uof:Kc.external;Y.payloadType=vd.qX;jc.ULS.sendTraceTag(537167831,0,50,"BaseRangeCopyPasteHandler.PasteByPlainText: trigger ProcessPasteText request. pasteContext.Id={0}, PasteOperationId={1}",Y.id,Y.commandParameters.id);Ra=this.rs.b7i(rf.K(Y.commandParameters.originalDestinations),Ra,Y.commandParameters.ribbonCommandInfo,[Y.commandParameters.stopwatch],Y);jc.ULS.sendTraceTag(537167830,0,50,"BaseRangeCopyPasteHandler.PasteByPlainText: returned from ProcessPasteText. pasteContext.Id={0}",
Y.id);return Ra};ac.prototype.V1i=function(Y,Ra,Db){Y.htmlPayloadSize=Ra.length;Y.isHtmlPaste=!0;Y.pasteResult="SystemClipboardHtmlPaste";Y.payloadType=vd.html;Y.payloadOrigin=uc(Y)?Kc.uof:Kc.external;jc.ULS.sendTraceTag(42071711,0,50,"BaseRangeCopyPasteHandler.PasteByHtml: trigger ProcessPasteHtml request. PasteOperationId={0}",Y.commandParameters.id);return this.rs.a7i(rf.K(Y.commandParameters.originalDestinations),Ra,Db,Y.commandParameters.id,Y.commandParameters.ribbonCommandInfo,[Y.commandParameters.stopwatch],
Y)};ac.prototype.IIe=function(Y){var Ra={};Y&&(Ra.shadowWorkbookBase64=Y.ShadowWorkbookBase64,Ra.shadowWorkbookSizeExceedsLimit=Y.ShadowWorkbookSizeExceedsLimit,Ra.originalSourceRangesCountExceedsLimit=Y.OriginalSourceRangesCountExceedsLimit,Ra.originalSourceRangesCount=Y.OriginalSourceRangesCount,Ra.shadowWorkbookBlockedSize=Y.ShadowWorkbookBlockedSize);return Ra};ac.prototype.sjg=function(Y,Ra){var Db=Cd(Y),ec=32===(Y.commandParameters.commandType&32),gd=1024===(Y.commandParameters.commandType&
1024),Jd=!1,Xd=null,xe=null,cf=!1;if(!Db){Jd=-1985798686===Y.commandParameters.ribbonCommandInfo.command;var pf=Y.copyContextSnapshot;if(Ra)cf=!pf.sourceItem.isFromCurrentSession(this.$);else if(pf=this.rs.Mxb(pf))Xd=pf.ranges,xe=pf.sheetName,cf=!Y.isSameSession}return this.rs.jPg(xe,Xd,this.$.oa.sheetName,Y.commandParameters.originalDestinations,Y.commandParameters.expandDestinations,cf,ec,gd,Jd,Ra,Db)};uk.Object.defineProperties(ac.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return this._name}},
QZc:{configurable:!0,enumerable:!0,get:function(){return this.Xm.Va(5)}}});Object(pd.a)(ac,"BaseCopyPasteHandler",null,[908,909,910]);mb.prototype.getValue=function(Y){return this.key&&this.key.isEqual(Y)?this.createClipboardItems(this.clipboardItems):null};mb.prototype.setValue=function(Y,Ra){this.key=Y;this.clipboardItems=this.createClipboardItems(Ra)};mb.prototype.createClipboardItems=function(Y){var Ra=this.laa.create(),Db=Y.getItem($d.qX);Db&&Ra.setItem($d.qX,Db);(Db=Y.getItem($d.nP))&&Ra.setItem($d.nP,
Db);(Y=Y.getItem($d.html))&&Ra.setItem($d.html,Y);return Ra};Object(pd.a)(mb,"CopyCache",null,[]);var be=b(69);Am(qb,ac);qb.prototype.getSourceItem=function(){var Y=mc.a.clone(this.gridView.ga.va.selectedRanges);return new ne(this.$,Y,this.$.ea.oa.sheetName,this.$.ea.af,this.$.ya.UserSessionId)};qb.prototype.beforeSerialize=function(Y){var Ra=this;Y.isSelectionAllowed=!1;Y.isAsyncCopy=!1;Y.isFromCache=!1;Y.encounteredDeploymentErrors=!1;Y.plainTextPayloadSize=0;Y.shadowWorkbookPayloadSize=0;Y.htmlPayloadSize=
0;Y.clientSideCopyTime=0;var Db=new Ga.a(this.$.xa),ec=Y.sourceItem;Y.isSelectionAllowed=mc.a.all(ec.ranges,function(gd){return Ra.isSelectionAllowed(Db,gd)});Y.isSelectionAllowed&&this.rs.Ibf(ec.ranges,Y.commandParameters.commandType)};qb.prototype.VNa=function(Y){return this.gridView.Da.iI()&&qf.i(this.gridView,Y)};qb.prototype.r2i=function(Y,Ra,Db,ec){var gd=!1,Jd=1===Ra.commandParameters.commandType,Xd=ec[0].OQ;1===Db.ranges.length&&1===ec.length?nd.EwaSettings.isChangeGateEnabled("OfficeVSO:5593878_PasteCSE_CCPErrorTests1")&&
Jd&&1!==Xd&&Xd!==Db.ranges[0].OQ?Y.cseStatus=17:gd=this.Q7g.L9c(Y,rf.K(Db.ranges),Db.sheetName,rf.K(Y.commandParameters.expandDestinations),this.$.ea.oa.sheetName,Jd):Y.cseStatus=5;gd&&qf.g(this.$).Ri.D1(Y.commandParameters.stopwatch.id,be.BasicTelemetryCalculator.$R);return this.b2i(Y,Db,rf.u(this.$.oa.sheetName,null,ec),Ra.commandParameters.commandType,gd)};qb.prototype.isSelectionAllowed=function(Y,Ra){return Y.MBb(Ra,this.gridView)};qb.prototype.b2i=function(Y,Ra,Db,ec,gd){Ra=rf.u(Ra.sheetName,
null,Ra.ranges);Y.pasteResult="SameSessionPaste";Y.payloadOrigin=Kc.lZf;Y.payloadType=vd.MDg;jc.ULS.sendTraceTag(537167829,0,50,"BaseRangeCopyPasteHandler.PasteSameSession: trigger PasteRange request. PasteOperationId={0}",Y.commandParameters.id);return this.rs.pasteRange(Y.commandParameters.ribbonCommandInfo,Ra,Db,ec,Y.commandParameters.commandType,[Y.commandParameters.stopwatch],Y,gd)};Object(pd.a)(qb,"BaseRangeCopyPasteHandler",ac,[]);var Pg=b(34);Sb.prototype.onDeferredPasteStarted=function(Y){this.xV.xb(Y.id)||
this.xV.add(Y.id,!0);if(0<this.xV.count){var Ra=ah.GetServiceTaskFactory.Ua(this.$.da,5,4,0);Hb.TaskExtensions.Ba(Ra,function(){Ra.result.lg(28,null)},this.$.la,3)}};Sb.prototype.onDeferredPasteCompleted=function(Y){var Ra=0<this.xV.count;this.xV.xb(Y.id)&&this.xV.remove(Y.id);if(Ra&&!this.xV.count){var Db=ah.GetServiceTaskFactory.Ua(this.$.da,5,4,0);Hb.TaskExtensions.Ba(Db,function(){Db.result.removeEntry(28)},this.$.la,3)}};Object(pd.a)(Sb,"DeferredPasteTracker",null,[]);var We;(function(Y){Y[Y.none=
0]="none";Y[Y.loadClipboardFromServerFailed=1]="loadClipboardFromServerFailed";Y[Y.loadCopiedDataFromServerFailed=2]="loadCopiedDataFromServerFailed";Y[Y.asyncCopyCanceled=3]="asyncCopyCanceled";Y[Y.loadCopiedArtDataFromServerFailed=4]="loadCopiedArtDataFromServerFailed"})(We||(We={}));Object(pd.b)("CopyErrorType",We);var Zh=b(1131),hh=b(1279),rg=Zh.a;Am(xb,rg);Object(pd.a)(xb,"CopyInnerError",Zh.a,[]);Am(Xb,qb);Xb.prototype.serialize=function(Y){var Ra=Y.sourceItem,Db={},ec=this.G5c.getValue(Ra);
if(ec)Db.synchronousResult=ec,Y.isFromCache=!0,Y.clientSideCopyTime=Y.commandParameters.stopwatch.Gc;else{var gd=null,Jd=rf.F(Ra.ranges);if(!pg.a.nif()&&this.VNa(Jd)){jc.ULS.sendTraceTag(537167936,0,50,"AcrossSessionRangeCopyPasteHandler.Serialize: All data is loaded prepare the data in the client side.");Jd=this.clipboardRangeFactory.create(Jd);try{gd=Jd.toString(),ec=this.laa.create(),ec.setItem($d.qX,gd),this.G5c.setValue(Ra,ec),Db.synchronousResult=ec,Y.clientSideCopyTime=Y.commandParameters.stopwatch.Gc}finally{Jd&&
Jd.dispose()}}else Y.isAsyncCopy=!0,Db.synchronousResult=this.laa.create(),Db.synchronousResult.setItem($d.qX,this.QZc);Db.asynchronousResult=this.Tgd(Y,Ra,gd)}Y.syncClipboardItemsKeys=Ge(Db.synchronousResult);return Db};Xb.prototype.shouldWaitForCopyToComplete=function(Y){if(!Y||!Y.copyContextSnapshot)return jc.ULS.sendTraceTag(537167907,0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: pasteContext or pasteContext.CopyContextSnapshot is not define, return false."),!1;jc.ULS.shipAssertTag(537167906,
0,!!this.$.ya,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: this.EwaControl.BootstrapContext shouldn't be null");if(Y.copyContextSnapshot.sessionId===this.$.ya.UserSessionId)return jc.ULS.sendTraceTag(537167905,0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: Same session copy scenario, return false."),!1;jc.ULS.sendTraceTag(537167904,0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: returning true");return!0};Xb.prototype.onDeferredPasteStarted=
function(Y){this.xV.onDeferredPasteStarted(Y)};Xb.prototype.onDeferredPasteCompleted=function(Y){this.xV.onDeferredPasteCompleted(Y)};Xb.prototype.deserialize=function(Y){Y.isClipboardDataContainShadowWorkbook=!(void 0===Y.clipboardItems.getItem($d.nP)||null===Y.clipboardItems.getItem($d.nP));if(qf.g(this.$).ga.Ye&326)return Cd(Y)&&(Y.wasLastCopyExternal=!0),Promise.reject(new Se.a(17));var Ra=this.sjg(Y,!1);if(0!==Ra)return Promise.reject(new Se.a(Cd(Y)?18:Y.isSameSession?19:20,void 0,void 0,void 0,
Ra));var Db=Y.copyContextSnapshot,ec=this.rs.Mxb(Db);if(Cd(Y))return this.Mrc(Y);Ra=Y.commandParameters.originalDestinations;if(ec&&Y.isSameSession)return this.r2i(Y,Db,ec,Ra);if(516!==Y.commandParameters.commandType){ec=this.aTj(Y.clipboardItems);Db=ec.u1;if(ec.returnValue){Y.isShadowWorkbookParsedSuccessfully=!0;var gd=ec=null;nd.EwaSettings.getBooleanFeatureGate(Qe.a.L6b,!1)?ec=rf.r(Ra,this.$):gd=rf.v(rf.K(Ra),this.$);return this.T1i(Y,gd,ec,Db)}if(Y.isClipboardInaccessible)return Promise.reject(new Se.a(8));
if(36!==Y.commandParameters.commandType)return this.yKf(Y)}return Promise.reject(new Se.a(6))};Xb.prototype.beforePaste=function(Y){this.$.da.Aa(373).aqj(Y);Y.indicationDisplayScheduled=!0};Xb.prototype.wSj=function(Y){if(!(Y&&Y.SourceRanges&&Y.SourceRanges.Ranges&&Y.SourceRanges.Ranges.length&&(Y.OriginalSourceRangesCountExceedsLimit||Y.OriginalSourceMultiRange&&Y.OriginalSourceMultiRange.Ranges&&Y.OriginalSourceMultiRange.Ranges.length)))return{returnValue:!1,u1:null};var Ra=Y.SourceRanges.Ranges[0];
if(!Y.ShadowWorkbookBase64&&!Y.ShadowWorkbookSizeExceedsLimit)return{returnValue:!1,u1:null};var Db=this.IIe(Y);Db.rangeRowStart=Ra.FirstRow;Db.rangeRowEnd=Ra.LastRow;Db.rangeColumnStart=Ra.FirstColumn;Db.rangeColumnEnd=Ra.LastColumn;Db.sourceClientPath=Y.SourceClientPath;Db.sourceSheetName=Y.SourceSheetName;Db.sourceWorkbookName=Y.SourceWorkbookName;if(!Y.OriginalSourceRangesCountExceedsLimit)for(Y=Y.OriginalSourceMultiRange.Ranges,Db.originalSourceRanges=Array(Y.length),Ra=0;Ra<Y.length;++Ra)Db.originalSourceRanges[Ra]=
[Y[Ra].FirstRow,Y[Ra].FirstColumn,Y[Ra].LastRow,Y[Ra].LastColumn];return{returnValue:!0,u1:Db}};Xb.prototype.aTj=function(Y){var Ra=null;Y=Y.getItem($d.nP);if(!Y)return{returnValue:!1,u1:Ra};Ra=JSON.parse(Y);return{returnValue:this.Jti(Ra),u1:Ra}};Xb.prototype.Jti=function(Y){return!!Y&&(!!Y.shadowWorkbookBase64||Y.shadowWorkbookSizeExceedsLimit)&&void 0!==Y.rangeRowStart&&void 0!==Y.rangeRowEnd&&void 0!==Y.rangeColumnStart&&void 0!==Y.rangeColumnEnd};Xb.prototype.T1i=function(Y,Ra,Db,ec){jc.ULS.shipAssertTag(537167903,
0,!!ec,"AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: shadowWorkbookPayload shouldn't be null");Lc.AFrameworkApplication.kO("Microsoft.Office.Excel.Server.Flighting.IDenyListNewCopyPasteExperienceAcrossSessions");Y.pasteResult="CrossSessionPaste";Y.payloadOrigin=Kc.kJe;Y.payloadType=vd.nP;Y.shadowWorkbookPayloadSize=Zc(ec);Y.shadowWorkbookSizeExceedsLimit=Uc(ec);ec.hasOwnProperty("originalSourceRangesCountExceedsLimit")&&(Y.originalSourceRangesCountExceedsLimit=ec.originalSourceRangesCountExceedsLimit);
if(Y.shadowWorkbookSizeExceedsLimit)return jc.ULS.sendTraceTag(34415003,0,15,"AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: shadow workbook length({0}) is over the limit({1}). reject the paste request. ShadowWorkbookSizeExceedsLimit: {2}",Y.shadowWorkbookPayloadSize,Fe.a.Xmc,ec.shadowWorkbookSizeExceedsLimit),Promise.reject(new Se.a(1));if(1028===Y.commandParameters.commandType&&Y.originalSourceRangesCountExceedsLimit)return jc.ULS.sendTraceTag(572617859,0,15,"AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: Original source ranges count({0}) is over the limit({1}). Reject the paste request. OriginalSourceRangesCountExceedsLimit: {2}",
ec.originalSourceRangesCount,Fe.a.VDi,ec.originalSourceRangesCountExceedsLimit),Promise.reject(new Se.a(1));jc.ULS.sendTraceTag(537167902,0,50,"AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: trigger Paste request. PasteOperationId={0}",Y.commandParameters.id);return this.rs.CKf(Y.commandParameters.ribbonCommandInfo,Ra,Db,ec,[Y.commandParameters.stopwatch],Y)};Xb.prototype.Tgd=function(Y,Ra,Db){var ec=this;jc.ULS.shipAssertTag(537167901,0,!!Y,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: copyContext shouldn't be null");
var gd=Y.commandParameters.stopwatch.Gc;return new Promise(function(Jd,Xd){jc.ULS.sendTraceTag(26035421,0,50,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: issue request to the server to get the copied data for copy Id: {0}",Y.id);var xe=rf.u(Ra.sheetName,null,Ra.ranges);ec.rs.copy(xe,Y.commandParameters,function(cf){Y.requestTelemetryData=cf.RequestTelemetryData;Y.serverRequestTimeInMs=Y.commandParameters.stopwatch.Gc-gd;if(Fd.a.vh(cf.Errors))Fd.a.Xha(cf.Errors)?(Y.encounteredDeploymentErrors=
!0,jc.ULS.sendTraceTag(537167898,0,15,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: {0}. copy Id: {1}",Fd.a.Wc(cf.Errors),Y.id)):(jc.ULS.sendTraceTag(26035419,0,10,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: {0}. copy Id: {1}",Fd.a.Wc(cf.Errors),Y.id),Xd(new xb(2,cf.Errors)));else if(jc.ULS.sendTraceTag(537167900,0,50,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer succeed for copy Id: {0}",
Y.id),Y.markForCancellation)Xd(new xb(3,cf.Errors));else{cf=cf.Result;var pf=cf.PlainTextResult;void 0!==Db&&null!==Db&&(pf=Db);void 0!==pf&&null!==pf&&(Y.plainTextPayloadSize=pf.length);var ff=ec.laa.create(),tg=ec.wSj(cf);var Ig=tg.u1;tg.returnValue&&(Y.shadowWorkbookPayloadSize=Zc(Ig),Y.shadowWorkbookSizeExceedsLimit=Uc(Ig),Y.originalSourceRangesCountExceedsLimit=cf.OriginalSourceRangesCountExceedsLimit,Ig=JSON.stringify(Ig),ff.setItem($d.nP,Ig));ff.setItem($d.qX,pf);pg.a.nif()&&(pf=cf.HtmlResult,
Y.htmlSizeExceedsLimit=cf.HtmlSizeExceedsLimit,void 0!==pf&&null!==pf&&(Y.htmlPayloadSize=pf.length),ff.setItem($d.html,pf));Y.copyTotalSizeExceedsLimit=cf.CopyTotalSizeExceedsLimit;ff.setItem($d.H5c,Y.commandParameters.id);ec.G5c.setValue(Ra,ff);Y.asyncClipboardItemsKeys=Ge(ff);Jd(ff)}},function(cf){Y.serverRequestTimeInMs=Y.commandParameters.stopwatch.Gc-gd;cf=Sd.a.mg(cf.data);jc.ULS.sendTraceTag(537167897,0,10,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: {0}. copy Id: {1}",
Fd.a.Wc(cf),Y.id);Xd(new xb(2,cf))},[Y.commandParameters.stopwatch])})};Object(pd.a)(Xb,"AcrossSessionRangeCopyPasteHandler",qb,[]);Object(pd.a)(hb,"CopyArtRequest",null,[]);Object(pd.a)(Sa,"PasteArtRequest",null,[]);db.prototype.x9h=function(Y){if(this.Opi(Y.bPa)){jc.ULS.sendTraceTag(537167681,5,50,"PasteArtRequestManager.HandleRequest: Enqueued paste request as a result of rapid paste on same destination: {0}",Y.bPa);var Ra=this.QJb.pa(Y.bPa);this.QJb.ia(Y.bPa,Y);var Db=Ra.promise;Ra.Dif=!1;return this.Aph(Y,
Db)}this.QJb.ia(Y.bPa,Y);return this.ywi(Y)};db.prototype.Opi=function(Y){return this.QJb.xb(Y)};db.prototype.ywi=function(Y){var Ra=this;return new Promise(function(Db,ec){Y.promise=Ra.Q_a.xKf(Y).then(function(gd){Db(null);return Ra.cqc(Y,gd)},function(gd){ec(null);return Ra.dGb(gd)})})};db.prototype.Aph=function(Y,Ra){var Db=this;return new Promise(function(ec,gd){Y.promise=Ra.then(function(Jd){Db.cYj(Y,Jd);return Db.Q_a.xKf(Y).then(function(Xd){ec(null);return Db.cqc(Y,Xd)},function(Xd){gd(null);
return Db.dGb(Xd)})},function(Jd){return Db.dGb(Jd)})})};db.prototype.cqc=function(Y,Ra){Y.Dif&&(this.u1g(Y.bPa),this.sQd(Y,Ra));return this.B7i(Ra)};db.prototype.u1g=function(Y){this.QJb.remove(Y)};db.prototype.sQd=function(Y,Ra){var Db=this.P1h();Y.bPa===Db&&this.Q_a.sQd(Y.destination,Ra,Y.item.type)};db.prototype.P1h=function(){var Y=qf.g(this.$).ga.Pa.activeFloatingObjectControlId;Y||(Y=rf.v(qf.g(this.$).ga.va.activeCell,this.$),Y=Y.FirstRow+"_"+Y.FirstColumn);return Y};db.prototype.cYj=function(Y,
Ra){Y.destination=null;Y.hLe=Ra};Object(pd.a)(db,"PasteArtRequestManager",null,[]);var th=b(200),Oh=b(119),Xg=b(103);Am(Ca,ac);Ca.prototype.getSourceItem=function(){jc.ULS.shipAssertTag(537167896,0,!!this.ga.Pa.activeFloatingObjectControlId,"Expecting a floating object to be currently selected for copy");jc.ULS.sendTraceTag(537167895,0,50,"ArtCopyPasteHandler.GetSourceItem: Creating ArtSourceItem with FloatingObjectId=[{0}]",this.ga.Pa.activeFloatingObjectControlId);return new qd(this.ga.Pa.activeFloatingObjectControlId,
this.$.ea.oa.sheetName,this.$.ea.af,this.$.ya.UserSessionId,this.ga.Pa.nc.floatingObject.type)};Ca.prototype.beforeSerialize=function(Y){Y&&Y.commandParameters?(Y?(Y.isAsyncCopy=!1,Y.isSelectionAllowed=!1,Y.isFromCache=!1,Y.plainTextPayloadSize=0,Y.shadowWorkbookPayloadSize=0,Y.htmlPayloadSize=0,Y.htmlSizeExceedsLimit=!1,Y.clientSideCopyTime=0,Y.encounteredDeploymentErrors=!1,Y.shadowWorkbookSizeExceedsLimit=!1,Y.originalSourceRangesCountExceedsLimit=!1,Y.copyTotalSizeExceedsLimit=!1):jc.ULS.sendTraceTag(537167826,
0,10,"CommonCopyPasteUtils.InitializeCopyContext: copyContext is null."),Y.commandParameters.copyPasteTargetType=2):jc.ULS.sendTraceTag(537167894,0,10,"ArtCopyPasteHandler.BeforeSerialize: copyContext or copyContext.CommandParameters is null.")};Ca.prototype.serialize=function(Y){var Ra=Y.sourceItem,Db={};if(!Ra)return jc.ULS.sendTraceTag(537167893,0,10,"ArtCopyPasteHandler.Serialize: artSourceItem should not be null"),Db;if(!this.zsi())return jc.ULS.sendTraceTag(36824456,0,50,"ArtCopyPasteHandler.Serialize: Unsupported floating object type. This will clear the clipboard"),
Db;jc.ULS.sendTraceTag(537167892,0,50,"ArtCopyPasteHandler.Serialize: Serializing ArtSourceItem with FloatingObjectId=[{0}]",Ra.activeFloatingObjectControlId);this.CHd();var ec=this.F5c.getValue(Ra);if(ec)Db.synchronousResult=ec,Y.isFromCache=!0,Y.isAsyncCopy=!1,Y.clientSideCopyTime=Y.commandParameters.stopwatch.Gc,1===Y.commandParameters.commandType&&this.$.ae(2045211913,Y.commandParameters.ribbonCommandInfo.method,Y.commandParameters.ribbonCommandInfo.ef,null);else{Y.isFromCache=!1;Y.isAsyncCopy=
!0;ec=this.laa.create();if(Y.commandParameters.uploadToClipService){var gd={};gd["data-clipservice-ccpid"]=Y.commandParameters.id;gd["data-pkey"]=Y.commandParameters.pKey;gd["data-clipservice-type"]=Y.commandParameters.clipServiceDataType;gd["data-clipservice-count"]=Y.commandParameters.objectCount.toString();gd["data-clipservice-dc"]=Y.commandParameters.clipServiceDataCenter;gd["data-clipservice-client"]=this.o2g;gd["data-TimeStamp"]=(new Date).toUTCString();gd["data-clipservice-version"]=this.p2g;
ec.setItem($d.ZLg,JSON.stringify(gd))}Db.synchronousResult=this.rFg(ec);Db.asynchronousResult=this.Tgd(Y,Ra,ec)}Y.syncClipboardItemsKeys=Ge(Db.synchronousResult);return Db};Ca.prototype.rFg=function(Y){jc.ULS.shipAssertTag(537167891,0,!!this.ga.Pa.nc,"Expecting a floating object to be currently selected for copy");Y||(Y=this.laa.create());var Ra=this.ga.Pa.nc.owb();Ra&&(Ra=String.format("<img src='{0}'>",Ra),Y.setItem($d.html,Ra));return Y};Ca.prototype.CHd=function(){var Y=this.ga.Pa.nc;this.Zpb.CHd(Oh.a.Wrb(Y.floatingObject),
Oh.a.r2g(Y.hu))};Ca.prototype.shouldWaitForCopyToComplete=function(){jc.ULS.sendTraceTag(537167890,0,50,"ArtCopyPasteHandler.ShouldWaitForCopyToComplete: returning true");return!0};Ca.prototype.onDeferredPasteStarted=function(Y){this.xV.onDeferredPasteStarted(Y)};Ca.prototype.onDeferredPasteCompleted=function(Y){this.xV.onDeferredPasteCompleted(Y)};Ca.prototype.deserialize=function(Y){var Ra=Cd(Y),Db=null,ec=null,gd=!1;if(!Ra){Db=Y.copyContextSnapshot;ec=Db.sourceItem;if(!ec)return Promise.reject(new Se.a(10));
gd=ec.isFromCurrentSession(this.$)}var Jd=this.sjg(Y,!0);if(0!==Jd)return Promise.reject(new Se.a(Ra?18:gd?19:20,void 0,void 0,void 0,Jd));if(Ra)return this.Mrc(Y);if(!gd&&!Ca.Jli(ec))return Y=String.format("User attempted to paste art of type [{0}] between sessions.",ec.type),jc.ULS.sendTraceTag(537167889,0,50,Y),Promise.reject(new Se.a(11,void 0,void 0,Y));if(Db.isAsyncSerializeFailed)return Promise.reject(new Se.a(16,void 0,void 0,"Last async serialize failed, therefore no current shadow workbook payload to paste"));
try{var Xd=Y.clipboardItems.getItem($d.nP);var xe=JSON.parse(Xd)}catch(cf){return jc.ULS.sendTraceTag(537167888,0,10,"ArtCopyPasteHandler.Deserialize: Failed to parse shadow workbook JSON with exception: {0}",copyPasteInfra.getStringifiedError(cf)),Promise.reject(new Se.a(12,void 0,cf))}xe.floatingObjectId!==ec.activeFloatingObjectControlId?jc.ULS.sendTraceTag(537167887,0,10,"ArtCopyPasteHandler.Deserialize: FloatingObjectId mismatch! Deserializing with artSourceItem.ActiveFloatingObjectControlId=[{0}], shadowWorkbookPayload.FloatingObjectId=[{1}]",
ec.activeFloatingObjectControlId,xe.floatingObjectId):jc.ULS.sendTraceTag(537167886,0,50,"ArtCopyPasteHandler.Deserialize: Deserializing with artSourceItem.ActiveFloatingObjectControlId=[{0}], shadowWorkbookPayload.FloatingObjectId=[{1}]",ec.activeFloatingObjectControlId,xe.floatingObjectId);if(!xe||!xe.shadowWorkbookBase64)return Promise.reject(new Se.a(13,void 0,void 0,String.format("shadowWorkbookPayload is null = {0}",!xe)));Y.isShadowWorkbookParsedSuccessfully=!0;Y.shadowWorkbookPayloadSize=
Zc(xe);Y.shadowWorkbookSizeExceedsLimit=Uc(xe);Y.payloadOrigin=gd?Kc.lZf:Kc.kJe;Y.payloadType=vd.Omg;if(Uc(xe))return Y=String.format("Shadow workbook size [{0}] is over the limit [{1}]. ShadowWorkbookSizeExceedsLimit: {2}",Y.shadowWorkbookPayloadSize,Fe.a.Xmc,xe.shadowWorkbookSizeExceedsLimit),jc.ULS.sendTraceTag(36304156,0,15,"ArtCopyPasteHandler.Deserialize: {0}",Y),Promise.reject(new Se.a(1,void 0,void 0,Y));Db=Ra=null;qf.g(this.$).ga.Ye&326?Db=qf.g(this.$).ga.Pa.activeFloatingObjectControlId:
Ra=this.$.oa&&this.$.oa.activeCell?rf.v(this.$.oa.activeCell,this.$):rf.v(rf.K(Y.commandParameters.originalDestinations),this.$);gd=null;if(this.Zpb.v6f(ec))try{gd=this.Zpb.L9c()}catch(cf){jc.ULS.sendTraceTag(537167885,0,10,"ArtCopyPasteHandler.Deserialize: Exception encountered while performing client-side estimation. Exception: {0}",copyPasteInfra.getStringifiedError(cf))}return this.U1i.x9h(new Sa(Y.commandParameters.ribbonCommandInfo,Ra,Db,Y.commandParameters.commandType,[Y.commandParameters.stopwatch],
xe,ec,Y,gd))};Ca.prototype.Mrc=function(Y){Y.wasLastCopyExternal=!0;if(Y.clipboardItems.getItem("image/png")){var Ra=Y.commandParameters.stopwatch.Gc;Y.payloadType=vd.qSg;var Db={};return Kd.b(this.$.ae(1403967063,Y.commandParameters.ribbonCommandInfo.method,Y.commandParameters.ribbonCommandInfo.ef,(Db.dataUrl=Y.clipboardItems.getItem("image/png"),Db))).then(function(ec){Y.serverRequestTimeInMs=Y.commandParameters.stopwatch.Gc-Ra;return ec?Promise.resolve(null):Promise.reject(new Se.a(15))},function(){Y.serverRequestTimeInMs=
Y.commandParameters.stopwatch.Gc-Ra;return Promise.reject(new Se.a(15))})}jc.ULS.shipAssertTag(537167884,0,!1,"Should not paste external content that is not image via ArtCopyPasteHandler");return ac.prototype.Mrc.call(this,Y)};Ca.prototype.zsi=function(){var Y=qf.g(this.$).ga;return Y.Pa.activeFloatingObjectControlId&&Y.Pa.nc&&Y.Pa.nc.floatingObject?Y.Pa.nc.floatingObject.BXd():!1};Ca.prototype.Tgd=function(Y,Ra,Db){var ec=this;return new Promise(function(gd,Jd){var Xd=Y.commandParameters.stopwatch.Gc;
jc.ULS.sendTraceTag(41562516,0,50,"ArtCopyPasteHandler.GetCopiedDataFromServer: issue request to the server to get the copied data...");ec.Q_a.I7g(new hb(Ra.activeFloatingObjectControlId,Y.commandParameters,function(xe){Y.requestTelemetryData=xe.RequestTelemetryData;Y.serverRequestTimeInMs=Y.commandParameters.stopwatch.Gc-Xd;if(Fd.a.vh(xe.Errors))Fd.a.Xha(xe.Errors)?(Y.encounteredDeploymentErrors=!0,jc.ULS.sendTraceTag(537167879,0,15,"ArtCopyPasteHandler.GetCopiedDataFromServer: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: {0}",
Fd.a.Wc(xe.Errors))):(jc.ULS.sendTraceTag(36229122,0,10,"ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: {0}",Fd.a.Wc(xe.Errors)),Jd(new xb(4,xe.Errors)));else if(jc.ULS.sendTraceTag(537167883,0,50,"ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer succeeded for FloatingObjectId=[{0}].",Ra.activeFloatingObjectControlId),Y.markForCancellation)Jd(new xb(3,xe.Errors));else{Fd.a.Ar(xe.Errors)&&jc.ULS.sendTraceTag(537167882,0,50,"ArtCopyPasteHandler.GetCopiedDataFromServer: Server messages present. Errors: {0}",
Fd.a.Wc(xe.Errors));var cf=xe.Result;if(cf){cf=ec.IIe(cf);cf.floatingObjectId=Ra.activeFloatingObjectControlId;Y.shadowWorkbookPayloadSize=Zc(cf);Y.shadowWorkbookSizeExceedsLimit=Uc(cf);try{var pf=JSON.stringify(cf)}catch(ff){Jd(new Se.a(14,void 0,ff,String.format("Failed to stringify shadow workbook: copyContext.ShadowWorkbookPayloadSize: [{0}], shadowWorkbookPayload.FloatingObjectId: [{1}]",Y.shadowWorkbookPayloadSize,cf.floatingObjectId)));return}jc.ULS.shipAssertTag(537167881,0,!!Db,"Expecting syncClipboardItems to be defined");
Db.setItem($d.nP,pf);1===Y.commandParameters.commandType&&(ec.g5i(Ra.type,Ra.activeFloatingObjectControlId,xe.StateId),ec.deleteFloatingObject(Ra.activeFloatingObjectControlId,Ra.type));ec.F5c.setValue(Ra,Db);Y.asyncClipboardItemsKeys=Ge(Db);gd(Db)}else jc.ULS.sendTraceTag(537167880,0,50,"ArtCopyPasteHandler.GetCopiedDataFromServer: Result form server returned null, copied item id: {0}",Ra.activeFloatingObjectControlId),gd(ec.F5c.getValue(Ra))}},Y.commandParameters.commandType,Ra.type,function(xe){Y.serverRequestTimeInMs=
Y.commandParameters.stopwatch.Gc-Xd;xe=Sd.a.mg(xe.data);1===Y.commandParameters.commandType&&ec.Q_a.ZTj(Ra.type,Ra.activeFloatingObjectControlId);jc.ULS.sendTraceTag(537167878,0,10,"ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: {0}",Fd.a.Wc(xe));Jd(new xb(4,xe))},[Y.commandParameters.stopwatch]))})};Ca.prototype.deleteFloatingObject=function(Y,Ra){Y=th.a.Bz(Ra,Y);if(Y=Xg.a(this.$).Mq(Y))Xg.a(this.$).deleteFloatingObject(Y,14,!0),qf.g(this.$).ga.Pa.VC=null};Ca.prototype.g5i=
function(Y,Ra,Db){var ec=this.$.da.Aa(277);if(ec){var gd=null;Y=th.a.Bz(Y,Ra);Y=Xg.a(this.$).Mq(Y);if(null===Y||void 0===Y?0:Y.fj)gd=Y.fj.block;if(gd){var Jd=Y.floatingObject.Ug();ec.t_b(function(){return!gd.hj.xb(Jd)},Db,"CutArt")}}};Ca.Jli=function(Y){return 1===Y.type||5===Y.type};Object(pd.a)(Ca,"ArtCopyPasteHandler",ac,[]);var Sg=b(54);Am(wa,sc);Object(pd.a)(wa,"MacroRecorderPasteArtPayload",sc,[]);ma.prototype.Ldi=function(Y,Ra,Db,ec,gd,Jd,Xd){var xe=this;Jd=void 0===Jd?null:Jd;Xd=void 0===
Xd?null:Xd;var cf=this.$.na.ta.fc(),pf=null,ff={CopyPasteTargetType:2};ff.FloatingObjectId=Y;ff.CopyOperationId=Db.id;Db.floatingObjectType=Ra;ff.UploadToClipService=Db.uploadToClipService;ff.PKey=Db.pKey;ff.ClipServiceDataCenter=Db.clipServiceDataCenter;var tg=0;2===gd?(gd=505,tg=16,pf=function(Ig,qg,pi){return sb(xe.$.na.ta,ff,Mf.b(Ig,ec),Jd?Mf.a(qg,Jd):qg,pi,Db.ribbonCommandInfo,cf,Xd)}):(gd=179,pf=function(Ig,qg,pi){xe.klh(Ra,Y);xe.$.Qy();var Ld=xe.$.na.ta;Ig=Mf.b(Ig,ec);qg=Jd?Mf.a(qg,Jd):qg;
var qi=Db.ribbonCommandInfo,W=Xd;W=void 0===W?null:W;var ta=Ld.Ma(1,void 0===cf?null:cf);ta.copyParameters=ff;return Mc.i(Ld,"Cut",ta,Ig,qg,pi,qi,0,W)});nd.EwaSettings.uc()?this.$.userOperationManager.jc(new af.a(gd,0,pf,tg|64),Db.ribbonCommandInfo):this.$.userOperationManager.jc(new tf.a(gd,0,pf,tg),Db.ribbonCommandInfo)};ma.prototype.klh=function(Y,Ra){var Db=th.a.Bz(Y,Ra);(Db=Xg.a(this.$).Mq(Db))?(qf.g(this.$).ga.Pa.DH(Db),Db.isVisible=!1):jc.ULS.sendTraceTag(537167876,0,50,"ArtCopyPasteUtils.DoCutClientEstimation: floatingObjectcontrol is null. FloatingObjectType : {0}, FloatingObjectId: {1}",
Y,Ra)};ma.prototype.ZTj=function(Y,Ra){Y=th.a.Bz(Y,Ra);if(Y=Xg.a(this.$).Mq(Y))Y.isVisible=!0};ma.prototype.I7g=function(Y){this.Ldi(Y.floatingObjectId,Y.G7g,Y.commandParameters,Y.Ur,Y.gfh,Y.a5,Y.y1d)};ma.prototype.kei=function(Y,Ra,Db,ec,gd,Jd,Xd,xe,cf){var pf=this;xe=void 0===xe?null:xe;cf=void 0===cf?!0:cf;return new Promise(function(ff,tg){var Ig=Jd.commandParameters.stopwatch.Gc;pf.RQd(Y,gd,Ra,Db,function(qg){Jd.requestTelemetryData=qg.RequestTelemetryData;Jd.serverRequestTimeInMs=Jd.commandParameters.stopwatch.Gc-
Ig;if(Fd.a.Xha(qg.Errors))Jd&&(Jd.encounteredDeploymentErrors=!0),jc.ULS.sendTraceTag(537167875,0,15,"ArtCopyPasteUtils.PasteArt: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: {0}",Fd.a.Wc(qg.Errors));else if(Fd.a.vh(qg.Errors))jc.ULS.sendTraceTag(36459652,0,10,"ArtCopyPasteUtils.PasteArt: PasteArt failed. errors: {0}",Fd.a.Wc(qg.Errors)),tg(new Se.a(9,qg.Errors));else if(qg.Result){var pi=qg.Result;jc.ULS.sendTraceTag(537167874,0,50,"ArtCopyPasteUtils.PasteArt: PasteArt succeeded.");
pf.v5i(Xd,pi.FloatingObjectId,qg.StateId);ff(ma.kod(pi.FloatingObjectId))}else jc.ULS.sendTraceTag(537167873,0,10,"ArtCopyPasteUtils.PasteArt: PasteArt failed, result returned from server is null."),tg(new Se.a(9,qg.Errors))},function(qg){Jd.serverRequestTimeInMs=Jd.commandParameters.stopwatch.Gc-Ig;qg=Sd.a.mg(qg.data);jc.ULS.sendTraceTag(537167872,0,10,"ArtCopyPasteUtils.PasteArt: PasteArt failed. errors: {0}",Fd.a.Wc(qg));tg(new Se.a(9,qg))},ec,xe,cf)})};ma.prototype.v5i=function(Y,Ra,Db){var ec=
this,gd=this.$.da.Aa(277);if(gd){var Jd=th.a.Bz(Y,ma.kod(Ra));gd.t_b(function(){return!!Xg.a(ec.$).Mq(Jd)},Db,"PasteArt")}};ma.prototype.H_d=function(Y,Ra){Ra&&this.Zpb.H_d(Y,th.a.Bz(Y.type,Ra))};ma.prototype.xKf=function(Y){var Ra=this;return this.kei(Y.ribbonCommandInfo,Y.destination,Y.hLe,Y.y1d,Y.u1,Y.pasteContext,Y.item.type,Y.aDe,Y.item.isFromCurrentSession(this.$)).then(function(Db){return Db},function(Db){Ra.H_d(Y.item,Y.aDe);return Promise.reject(Db)})};ma.prototype.sQd=function(Y,Ra,Db){Y||
(Y=rf.v(qf.g(this.$).ga.va.activeCell,this.$));qf.g(this.$).Ijc(rf.D(Y),1)?Xg.a(this.$).soa(Db,Ra,!0):qf.g(this.$).ga.Pa.Qta(Y,Ra,Db).continueWith(function(ec){ec.result?jc.ULS.sendTraceTag(537167843,5,50,"ArtCopyPasteUtils.SelectPastedObject: Selection succeeded in async manner for object ID [{0}]",Ra):jc.ULS.sendTraceTag(537167842,5,10,"ArtCopyPasteUtils.SelectPastedObject: Selection failed in async manner for object ID [{0}]",Ra)})};ma.prototype.RQd=function(Y,Ra,Db,ec,gd,Jd,Xd,xe,cf){function pf(){if(cf){var pi=
Sg.a.ui(Sg.a.Kc(qg));pi.FloatingObjectId=Ra.floatingObjectId;qg.DestinationRanges||(pi.DestinationRanges=rf.p(tg.$.xa.oa.sheetName,"",0,0,0,0));return new wa(pi,cf,0,0)}return new wa(qg,cf,0,0)}function ff(pi,Ld,qi){xe||tg.$.Qy();return Ac(tg.$.na.ta,qg,Mf.b(pi,gd),Mf.a(Ld,Jd),qi,null,Ig,Xd)}var tg=this;cf=void 0===cf?!0:cf;var Ig=this.$.na.ta.fc(),qg={};qg.ShadowWorkbookBase64=Ra.shadowWorkbookBase64;qg.FloatingObjectId=ec;qg.DestinationRanges=Db?rf.s(Db):null;qg.CopyPasteTargetType=2;qg.ClientEstimationFloatingObjectId=
xe;Db=nd.EwaSettings.uc()?new af.a(503,0,ff,void 0,pf):new tf.a(503,0,ff,void 0,pf);Db.flags=nd.EwaSettings.uc()?65:1;this.$.userOperationManager.jc(Db,Y)};ma.kod=function(Y){return String.format("{0}.{{{1}}}",Y.length+2,Y.toUpperCase())};Object(pd.a)(ma,"ArtCopyPasteUtils",null,[902]);var gg=b(247);ua.prototype.CHd=function(Y,Ra){this.mua=Y;this.D5c=Ra};ua.prototype.L9c=function(){if(!this.mua||!this.D5c)return jc.ULS.sendTraceTag(537167841,0,15,"ArtPasteClientEstimation.DoPasteClientEstimation: copiedFloatingObjectControl and/or copiedEffectsExtents is null, aborting client side estimation."),
"";var Y=Oh.a.Wrb(new th.a(this.mua));Y.Id=ma.kod(le.a.create().toString());Y.Version=-1;Y.Name="";Y.IsClientEstimation=!0;var Ra=this.xfi(Y);if(!Ra)return null;var Db=new th.a(Y);Ra.block.hj.add(Db);Db.VJb();var ec=Xg.a(this.$);ec.Y5b(Db,Ra);Ra=ec.Mq(th.a.VVh(Y));!Ra||Ra.floatingObject.ENa||Ra.floatingObject.aOa||Ra.WSa(this.D5c);ec.soa(Y.Type,Y.Id,!0);return Y.Id};ua.prototype.v6f=function(Y){return nd.EwaSettings.ma(223)&&Y.isFromCurrentSession(this.$)&&!qf.g(this.$).rtl&&!qf.g(this.$).rb.jj};
ua.prototype.H_d=function(Y,Ra){this.v6f(Y)&&(Y=Xg.a(this.$).Mq(Ra))&&(jc.ULS.sendTraceTag(537167840,5,50,"ArtPasteClientEstimation.UndoPasteClientEstimation: undoing client-side estimation. Removing floating object with ID: [{0}] of type [{1}]",Ra,Y.floatingObject.type),Xg.a(this.$).deleteFloatingObject(Y,15,!0),Y.fj&&Y.scb(Y.fj,!1))};ua.prototype.xfi=function(Y){if(!Y)return jc.ULS.sendTraceTag(537167839,0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: Called with null FloatingObjectData."),
null;if(qf.g(this.$).ga.Pa.activeFloatingObjectControlId){var Ra=qf.g(this.$).ga.Pa.VC.floatingObject;Y.OriginDeltaX=Ra.offsetX+this.Xab;Y.OriginDeltaY=Ra.offsetY+this.Xab;Y.AbsoluteLeft+=this.Xab;Y.AbsoluteTop+=this.Xab;Y.AbsoluteRight+=this.Xab;Y.AbsoluteBottom+=this.Xab;Y.ZOrder=Ra.$y+1;return qf.g(this.$).ga.Pa.VC.fj}if(!this.$.oa||!this.$.oa.activeCell)return jc.ULS.sendTraceTag(537167838,0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: ActiveItem/ActiveCell is null - cannot perform estimation for grid paste."),
null;var Db=this.$.oa.activeCell;Ra=qf.g(this.$).e2(Db);if(!Ra)return jc.ULS.sendTraceTag(537167837,0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: gridViewBlock for range {0} is null.",Db.toString()),null;var ec=Me.HelperMethods.yLa(Ra.domElement,Ra.Ej.domElement);Db=Ra.gridView.jg(Db,2);if(!ec||!Db)return jc.ULS.sendTraceTag(537167836,0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: blockPositionRelativeToGridOrigin is null: {0}. cellPositionRelativeToGridOrigin is null: {1} .",
!ec,!Db),null;Y.OriginDeltaX=Db.topLeft.x-ec.x;Y.OriginDeltaY=Db.topLeft.y-ec.y;Y.AbsoluteLeft=Db.topLeft.x;Y.AbsoluteTop=Db.topLeft.y;Y.AbsoluteRight=Y.AbsoluteLeft+Math.abs(this.mua.AbsoluteRight-this.mua.AbsoluteLeft);Y.AbsoluteBottom=Y.AbsoluteTop+Math.abs(this.mua.AbsoluteBottom-this.mua.AbsoluteTop);Y.ZOrder=this.mua.ZOrder+100;return new gg.a(Ra.gridView.Da.kl(Ra.hashCode),Ra.hashCode)};Object(pd.a)(ua,"ArtPasteClientEstimation",null,[901]);T.prototype.create=function(){var Y=window.clipboardPlatform;
return Y?Y.createClipboardItems():null};Object(pd.a)(T,"ClipboardItemsFactory",null,[900]);Wc.undefined="Undefined";Object(pd.a)(Wc,"CCPTelemetryConsts",null,[]);Tb.cells="Cells";Tb.floatingObject="FloatingObject";Tb.unknown="Unknown";Object(pd.a)(Tb,"ActiveSelection",null,[]);Eb.pkh="DisplayNotInvoked";Eb.C9c="Displayed";Eb.H5i="PrerequisitesNotReady";Object(pd.a)(Eb,"PasteIndicationDisplayStatus",null,[]);var di=b(109);gc.prototype.getCopyFlowHandler=function(Y){var Ra=this.QRh(qf.g(this.$).Ye);
Y.commandParameters.copyPasteHandlerName=Ra.name;return Ra};gc.prototype.getPasteFlowHandler=function(Y){var Ra=Y.copyContextSnapshot;Ra=ed(Y)?this.LZc:Cd(Y)?this.EJd:(null===Ra||void 0===Ra?0:Ra.sourceItem)&&Object.getType(Ra.sourceItem)===qd?this.LZc:this.EJd;Y.commandParameters.copyPasteHandlerName=Ra.name;return Ra};gc.prototype.initializePasteContext=function(Y){if(Y&&(Y.isSameSession=!1,Y.isShadowWorkbookParsedSuccessfully=!1,Y.pasteResult=Wc.undefined,Y.payloadOrigin=Wc.undefined,Y.payloadType=
Wc.undefined,Y.encounteredDeploymentErrors=!1,Y.shadowWorkbookSizeExceedsLimit=!1,Y.originalSourceRangesCountExceedsLimit=!1,Y.activeSelectionType=this.INh(),Y.indicationDisplayScheduled=!1,Y.pasteDestinationHasMergedCells=!1,Y.pasteIndicationDisplayStatus=Eb.pkh,Y.copyContextSnapshot)){var Ra=Y.copyContextSnapshot,Db=od(Ra.sourceItem),ec=Ra.sourceItem;var gd=!!ec&&Object.getType(ec)===qd;ec=0;var Jd=!1;Db?(Jd=Ra.sourceItem,Y.isSameSession=Jd.isFromCurrentSession(this.$),ec=1,Jd=this.Ppi(Jd,Y)):gd&&
(Y.isSameSession=Ra.sourceItem.isFromCurrentSession(this.$),ec=2);if(Y.copyContextSnapshot.commandParameters){gd=-1985798686===Ra.commandParameters.ribbonCommandInfo.command;var Xd=Y.commandParameters;var xe=this.$;Ra?xe&&xe.ya?Ra=Ra.sessionId===xe.ya.UserSessionId:(jc.ULS.shipAssertTag(537166211,0,!1,"ewaControl shouldn't be null"),Ra=!1):(jc.ULS.shipAssertTag(537166212,0,!1,"copyContext shouldn't be null"),Ra=!1);Xd.clearSystemClipboard=Ra&&gd&&Db&&!Jd;Y.commandParameters.copyPasteTargetType=ec}}};
gc.prototype.getSessionId=function(){return this.$.ya.UserSessionId};gc.prototype.Ppi=function(Y,Ra){var Db=di.b(Y.ranges,function(ec){return ec.Xf})&&di.b(Ra.commandParameters.originalDestinations,function(ec){return 1!==ec.top});return di.b(Y.ranges,function(ec){return ec.isRow})&&di.b(Ra.commandParameters.originalDestinations,function(ec){return 1!==ec.left})||Db};gc.prototype.QRh=function(Y){switch(Y){case 1:return this.EJd;case 64:case 4:case 2:case 256:return this.LZc;default:throw Error.invalidOperation("Unsupported selection");
}};gc.prototype.INh=function(){return qf.g(this.$).ga.Ye&470?Tb.floatingObject:1===qf.g(this.$).ga.Ye?Tb.cells:Tb.unknown};uk.Object.defineProperties(gc.prototype,{EJd:{configurable:!0,enumerable:!0,get:function(){if(!this.RRc){var Y=this.$.da.Aa(254,!0);Y&&(this.RRc=new Xb(this.$,Y,new T))}return this.RRc}},LZc:{configurable:!0,enumerable:!0,get:function(){if(!this.CHc&&this.$.da.Aa(254,!0)){var Y=new ua(this.$);this.CHc=new Ca(this.$,new T,new ma(this.$,Y),Y)}return this.CHc}}});Object(pd.a)(gc,
"ExcelCopyPasteApplicationHost",null,[856]);var Jg=b(161),Mh=fe.a;Am(Ub,Mh);Ub.prototype.mh=function(Y){this.jp=new Jg.a;var Ra=ef.a.instance.fa(16);Y=this.iW(Y);this.initializeAndShow(Ra,this.thi,Y)};Ub.prototype.iW=function(Y){var Ra={};return Ra[Ub.Cz]=this.Cc,Ra[Ub.mri]=Y,Ra};uk.Object.defineProperties(Ub.prototype,{Cc:{configurable:!0,enumerable:!0,get:function(){return"InsertCopiedCutCellsDialog"}}});Ub.yjh="direction";Ub.mri="isRtl";var $h={};Ub.zjh=($h.Vertical=1,$h.Horizontal=0,$h);Object(pd.a)(Ub,
"InsertCopiedCutCellsDialog",fe.a,[]);tb.prototype.$5b=function(Y,Ra){return(new Ub(Y,Ra)).jp.task};Object(pd.a)(tb,"InsertCopiedCutCellsDialogFactory",null,[855]);var zh=b(89),Eh=b(46),Xh=b(43);Ha.prototype.oNe=function(){var Y=this;this.Esc||(jc.ULS.sendTraceTag(537167680,0,50,"PasteIndicationManager.DownloadPrerequisitesIfNeeded: Trying to get appChrome"),this.gridView.$.gD(function(Ra){Ra.iwa(0).then(function(){Y.Esc=!0})}))};Ha.prototype.aqj=function(Y){var Ra=this,Db=Y.commandParameters.id;
jc.ULS.sendTraceTag(537167651,0,50,"PasteIndicationManager.ScheduleDisplay: pasteCommandId = {0}, cancelCtx is null = {1}, PrerequisitesDownloaded = {2}",Db,!this.ot,this.Esc);this.oNe();this.d7b=Db;Db=!this.Svf();if(!this.ot||Db)this.kAe(),this.ot=Eh.a.instance.create(function(){Ra.okh(Y)},void 0===Y.timeoutToShowSpinnerInMs||null===Y.timeoutToShowSpinnerInMs?100:Y.timeoutToShowSpinnerInMs,Xh.a.Y1i);this.i3=Y.commandParameters.originalDestinations};Ha.prototype.okh=function(Y){this.Esc?(this.display(Y.commandParameters.originalDestinations),
Y.pasteIndicationDisplayStatus=Eb.C9c):(jc.ULS.sendTraceTag(537167650,0,50,"PasteIndicationManager.DisplayIfPossible: Prerequisites were not ready, skipping display"),this.hide(),Y.pasteIndicationDisplayStatus=Eb.H5i)};Ha.prototype.display=function(Y){jc.ULS.sendTraceTag(537167649,0,50,"PasteIndicationManager.Display: started");this.gridView.Fb.ox(mf.a.E8(ld.d(this.gridView.$.oa),Y),Ha.Nrc,!0);this.gridView.Fb.co(Ha.Nrc)};Ha.prototype.Vmd=function(Y){jc.ULS.sendTraceTag(537167648,0,50,"PasteIndicationManager.HideForPasteId: pasteCommandId = {0}, currentPasteCommandId = {1}",
Y,this.d7b);Y&&sf.a.equals(Y,this.d7b,!1)&&this.hide()};Ha.prototype.hide=function(Y){this.i3&&(void 0===Y?0:Y)&&this.Svf()&&jc.ULS.sendTraceTag(537167647,0,15,"PasteIndicationManager.Hide: Triggered by a SelectionChanged event while indication is (or will be) active but active range did not change");this.d7b="";this.kAe();this.i3=null;this.gridView.Fb.si(Ha.Nrc);this.gridView.Fb.ak(null,Ha.Nrc)};Ha.prototype.Svf=function(){return rf.Q(this.gridView.ga.va.selectedRanges,this.i3)};Ha.prototype.kAe=
function(){this.ot&&(zh.a.Fa(this.ot),this.ot=null)};Ha.prototype.dispose=function(){this.hide();this.gridView.ga.xG(this.mbf)};Ha.Nrc=[30];Object(pd.a)(Ha,"PasteIndicationManager",null,[773,3]);var Fh=b(1201),Kg=b(52),Sh=Ed.a;Am(nc,Sh);nc.prototype.create=function(){var Y=this,Ra=Kg.a.i0([51,52],4,this.ub,void 0,void 0,void 0,nc.KSa),Db=ah.GetServiceTaskFactory.create(this.$.da,18,this.$.la,this.ub);Hb.TaskExtensions.Ba(Hb.TaskExtensions.we([Db,Ra],this.la),function(){var ec=new Fh.a,gd=null;Y.m5g(ec).then(function(Jd){gd=
Jd.eDe;var Xd=copyPasteInfra.createCopyPasteInfra(gd,new gc(Y.$),ec,Y.$);jc.ULS.shipAssertTag(537167762,0,!!Y.$.ya,"CopyPasteInfrastructureFactory.Create: this.ewaControl.BootstrapContext should not be null");jc.ULS.shipAssertTag(537167761,0,!!Y.$.ya&&!!Y.$.ya.DocumentHostInfo,"CopyPasteInfrastructureFactory.Create: this.ewaControl.BootstrapContext.DocumentHostInfo should not be null");var xe=gd.getMetadataManager();Y.Eb(new Ud(Y.$,xe,Db.result,Xd,new fb(Y.$,qf.g(Y.$)),new tb,Y.$.ya.DocumentHostInfo.UserId,
gd.getInitializationError()));Jd.o1a?jc.ULS.sendTraceTag(41731933,0,50,"CopyPasteInfrastructureFactory.Create: Initialize CCP infra succeed. SliceName={0}, StrategyType={1}, StrategyCapabilities={2}, IsBestStrategyTypeInitialized={3}, InfraLoadTimeMS={4}",Ud.fcc(),Jd.o1a.dataClipboardStrategyType,JSON.stringify(Jd.o1a.dataClipboardCapabilities),Jd.o1a.clipboardStrategiesToInitialize[0].clipboardStrategyType===Jd.o1a.dataClipboardStrategyType,void 0===window.bsqmXLSPageLoadStartTime||null===window.bsqmXLSPageLoadStartTime?
"-1":(Date.now()-window.bsqmXLSPageLoadStartTime.getTime()).toString()):jc.ULS.shipAssertTag(537167760,0,!1,"CopyPasteInfrastructureFactory.Create: initResult.ClipboardPlatformEnvironmentInitializationInfo should not be null")},function(Jd){jc.ULS.shipAssertTag(38847436,0,!1,"CopyPasteInfrastructureFactory.Create: error during call to clipboardPlatformEnvironment.Init(). Copy Paste operations will not be available in this session. SliceName: {0} error: {1}",Ud.fcc(),Jd?copyPasteInfra.getStringifiedError(Jd):
"null")})},this.la,3)};nc.prototype.dispose=function(){Sh.prototype.dispose.call(this)};nc.prototype.m5g=function(Y){var Ra=null,Db=window.clipboardPlatform;Db&&(Ra=Db.getClipboardPlatformEnvironment());if(!Ra)return jc.ULS.shipAssertTag(537167759,0,!1,"CopyPasteInfrastructureFactory.ConfigureClipboardPlatformEnvironment: getClipboardPlatformEnvironment should have returned a valid object"),Promise.reject(null);Db=this.$.ya;var ec=[Db.OfficeOnlineChromeExtensionId,Db.ChromeClipboardAccessExtensionId],
gd=this.Xm.Va(5),Jd=this.$.dg.get(57),Xd=!Jd&&this.$.dg.get(5),xe=this.$.ea.pc;xe&&(xe.inWebPart||xe.inViewerFromWebPart||xe.isDivSyndicated)&&(Xd=!1);Jd=this.MQh(Xd,!Jd);jc.ULS.shipAssertTag(537167758,0,!!Db.DocumentHostInfo,"CopyPasteInfrastructureFactory.ConfigureClipboardPlatformEnvironment: bootstrapContext.DocumentHostInfo should not be null");return Ra.init(this.$,Y,ec,Db.SharedClipboardHostingApp,Db.SharedClipboardHostingApps,Db.SharedClipboardHostingEnvironments,Db.SharedClipboardOverrideOrigin,
Db.SharedClipboardSchemaVersion,Db.SharedClipboardExpirationInMinutes,Db.ClipboardPromiseTimeoutInMinutes,gd,Db.MachineCluster,new va(this.$),Jd,Db.DocumentHostInfo.UserId,Db.ClipboardTtlInMS,nd.EwaSettings.ma(314),Db.UserSessionId).then(function(cf){return Object.assign(new Ne,{eDe:Ra,o1a:cf})},function(cf){return Promise.reject(cf)})};nc.prototype.MQh=function(Y,Ra){var Db=[];Y&&Ra&&Array.add(Db,this.Hdh());Ra&&(Array.add(Db,this.k7c(7)),Array.add(Db,this.k7c(0)));Y&&Array.add(Db,this.QHe());Array.add(Db,
{clipboardStrategyType:4});jc.ULS.sendTraceTag(39978242,0,50,"CopyPasteInfrastructureFactory.GetClipboardStrategiesInitList: create clipboard stratgy initialization list: isBrowserStorageAllowed={0}, isSystemClipboardAllowed={1}, result = {2}",Y,Ra,Db?Db.join(","):"[]");return Db};nc.prototype.QHe=function(){var Y=this.$.ya,Ra={clipboardStrategyType:5};Ra.sessionId=Y.UserSessionId;Ra.useSharedClipboardIframe=!0;Ra.sharedClipboardHostingApp=Y.SharedClipboardHostingApp;Ra.sharedClipboardHostingApps=
Y.SharedClipboardHostingApps;Ra.sharedClipboardHostingEnvironments=Y.SharedClipboardHostingEnvironments;Ra.sharedClipboardOverrideOrigin=Y.SharedClipboardOverrideOrigin;Ra.sharedClipboardSchemaVersion=Y.SharedClipboardSchemaVersion;Ra.sharedClipboardExpirationInMinutes=Y.SharedClipboardExpirationInMinutes;Ra.wacCluster=Y.MachineCluster;return Ra};nc.prototype.Hdh=function(){var Y={clipboardStrategyType:6};Y.localStorageStrategyParameters=this.QHe();Y.systemClipboardStrategyParameters=this.k7c(0);
return Y};nc.prototype.k7c=function(Y){var Ra={};Ra.clipboardStrategyType=Y;Ra.skipFilesIfPlainTextExists=!0;return Ra};nc.ka=function(Y){Y.da.Ha(373,new Ha(Y));Y.da.Ha(nc.KSa,new nc(Y))};nc.KSa=255;Object(pd.a)(nc,"CopyPasteInfrastructureFactory",Ed.a,[]);var Nh=b(10),Gg=b(108),vh=b(12),Hi=Td.a;Am(Nb,Hi);Nb.prototype.dispose=function(){this.wm();this.xk=this.Lr=this.$=null;this.statusBarManager&&(this.statusBarManager.tG(this),this.statusBarManager=null)};Nb.prototype.wn=function(){return this.U6f};
Nb.prototype.Bs=function(Y,Ra){if("QueryPasteShortcutEnabledLabel"!==Y&&!Array.contains(Nb.aLj,Y))return!1;var Db=this.Do();"QueryPasteShortcutEnabledLabel"===Y?(Ra.Visible=Db,jc.ULS.sendTraceTag(537167636,0,100,"PasteShortcutManager.ExecuteRootCommand: Setting visible to {0} for commandId {1}",Db,Y)):(Ra.Visible=!Db,jc.ULS.sendTraceTag(537167635,0,100,"PasteShortcutManager.ExecuteRootCommand: Setting visible to {0} for commandId {1}",!Db,Y));return!0};Nb.prototype.bph=function(){this.Ik();this.raiseEvent("pasteShortcutStatusChanged")};
Nb.prototype.n8b=function(){this.wm();this.raiseEvent("pasteShortcutStatusChanged")};Nb.prototype.Do=function(){return this.wad};Nb.prototype.Gq=function(Y){this.addHandler("pasteShortcutStatusChanged",Y)};Nb.prototype.er=function(Y){this.removeHandler("pasteShortcutStatusChanged",Y)};Nb.prototype.Ik=function(){if(!this.Do()){this.wad=!0;qf.g(this.$).Uj.wl(this.WLe);this.xk.ka("blur",this.Ijh);var Y=this.$.da.Aa(65);Y&&Y.d4&&Y.d4.registerForCommentEvents(this.VLe);this.Lr.Mt(vh.a.Ub,this.slf?this.$.xw:
this.$.domElement,this.onKeyDown,!0)}};Nb.prototype.wm=function(){if(this.Do()){this.wad=!1;qf.g(this.$).Uj.$k(this.WLe);this.xk.detach("blur");var Y=this.$.da.Aa(65);Y&&Y.d4&&Y.d4.unregisterForCommentEvents(this.VLe);this.Lr.Rt(vh.a.Ub,this.slf?this.$.xw:this.$.domElement,this.onKeyDown,!0)}};Nb.aLj=["QuerySheetNumberButton","QueryWorkbookStatisticsButton"];Object(pd.a)(Nb,"PasteShortcutManager",Td.a,[775,533,299,3]);var Tg=b(127),ph=Ed.a;Am(Hc,ph);Hc.prototype.create=function(){var Y=this.$;this.Eb(Y.da.Aa(478)||
this.$.da.Ha(478,new Nb(Y,Gg.KeyInputManager.instance,Tg.a.instance.TC())))};Hc.ka=function(Y){Y.da.Ha(479,new Hc(Y))};Object(pd.a)(Hc,"PasteShortcutManagerFactory",Ed.a,[]);Cc.prototype.isEnabled=function(){if(Lc.AFrameworkApplication.ha?Lc.AFrameworkApplication.ha.ra("IsAnonymousUser"):1)return!1;var Y=Lc.AFrameworkApplication.hc?Object(Mb.a)(String,Lc.AFrameworkApplication.hc.AudienceGroup):"";return"Unknown"!==Y&&"Automation"!==Y};uk.Object.defineProperties(Cc.prototype,{$Yc:{configurable:!0,
enumerable:!0,get:function(){return"Excel"}},campaignId:{configurable:!0,enumerable:!0,get:function(){return"aed9de6b-d4e7-4878-988a-9dfec66fed9e"}},version:{configurable:!0,enumerable:!0,get:function(){return 1}},currentVersion:{configurable:!0,enumerable:!0,get:function(){return 0}},Tli:{configurable:!0,enumerable:!0,get:function(){return this.isEnabled()&&this.$.ma(341)}},L8a:{configurable:!0,enumerable:!0,get:function(){return this.isEnabled()&&this.$.ma(343)}},J8a:{configurable:!0,enumerable:!0,
get:function(){return this.$.ma(342)}},eIh:{configurable:!0,enumerable:!0,get:function(){return null}},uuf:{configurable:!0,enumerable:!0,get:function(){return 24}},uYf:{configurable:!0,enumerable:!0,get:function(){return 4E3}},mKb:{configurable:!0,enumerable:!0,get:function(){return this.$.ya.WebServiceBase||""}}});Object(pd.a)(Cc,"FirstRunExperienceLauncherSettings",null,[854]);rc.prototype.VUd=function(){this.bYe&&this.bYe.VUd(this.RHh)};Object(pd.a)(rc,"FirstRunExperienceManager",null,[774]);
var Ag=Ed.a;Am(jb,Ag);jb.prototype.create=function(){this.Eb(this.$.da.Aa(311)||this.H$g())};jb.prototype.H$g=function(){var Y=new Cc(this.$);Y=new rc(Je.a.instance.resolve("Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher"),Y);Y.VUd();return Y};jb.ka=function(Y){Y.da.Ha(312,new jb(Y))};Object(pd.a)(jb,"FirstRunExperienceManagerFactory",Ed.a,[]);var oh=b(58),Zg=Ed.a;Am(Va,Zg);Va.prototype.create=function(){this.Eb(this.$.da.Aa(361)||this.rah())};Va.prototype.rah=function(){var Y=
this;this.tod=Je.a.instance.Nh("Common.IInProductMessagingUIManager");oh.a.vg.isReactSharedHeaderUxEnabled?Md.a.get_instance().Qk(16,function(){Y.pef()}):this.pef();return this.tod};Va.prototype.pef=function(){var Y=this;Je.a.instance.qc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(Ra){Ra.isFeatureEnabled("MsoPremiumBadge",!0).then(function(Db){!Db&&Ra.isFreemiumUpsellEnabled()&&Y.tod.apf();return null})})};Va.ka=function(Y){Y.da.Ha(362,new Va(Y))};Object(pd.a)(Va,
"InProductMessagingManagerFactory",Ed.a,[]);var Dg=b(905),li=b(102),zg=b(184),Ah=b(107);ic.prototype.CGb=function(Y){this.Oj=Y;if(!this.N2a){if(this.o1d){if(this.m$a&&xd.a.aG){this.bUb=Y.L8b(Object(za.a)(this,this.qDd,"onFileChosen"));return}this.bUb=Y.L8b(null);if(!this.UCa(this.bUb,Y))return}this.finalizeUpload(Y,null)}};ic.prototype.qDd=function(Y){if(this.UCa(Y,this.Oj)){if(xd.a.aG||xd.a.Hf)this.bUb=Y;this.finalizeUpload(this.Oj,null)}};ic.prototype.Nqc=function(){this.nFd&&this.nFd()};ic.prototype.Llj=
function(){this.lsa=0;this.NFa=this.ha.Cd("Box4UploadRetryDelayStart",200);this.Oj&&(this.Oj.dispose(),this.Oj=null)};uk.Object.defineProperties(ic.prototype,{context:{configurable:!0,enumerable:!0,get:function(){return this.VT}},ha:{configurable:!0,enumerable:!0,get:function(){return this.vb}},retryCount:{configurable:!0,enumerable:!0,get:function(){return this.lsa}},QOd:{configurable:!0,enumerable:!0,get:function(){return this.NFa}}});Object(pd.a)(ic,"FileUploader",null,[]);var Qg=b(330),Bf=b(991),
Gi=b(133);Am(rb,ic);rb.prototype.j2e=function(Y){switch(Y){case 1:return CommonUIStrings.l_ImageUploadNoFileSpecified;case 2:return CommonUIStrings.l_ImageUploadUnsupportedFileType;default:return""}};rb.prototype.qjg=function(Y){return rb.UCa(Y,this.o5h())};rb.prototype.o5h=function(){return rb.$me};rb.prototype.UCa=function(Y,Ra){Ra=void 0===Ra?null:Ra;Y=this.qjg(Y);return 0!==Y?(Ra&&Ra.mpe(),2===Y&&this.zi(0,this.j2e(Y)),!1):!0};rb.prototype.finalizeUpload=function(Y,Ra){jc.ULS.sendTraceTag(36783360,
322,50,"PictureUploader.FinalizeUpload");this.nFd=Ra;this.YFj();Qg.a.mark(5576);this.KWb=this.uP.Hc("LoadResource","PictureUploadTime")};rb.prototype.zi=function(Y,Ra){var Db=new Gi.StandardDialog;Db.lc=0;Db.lA(Y,CommonUIStrings.l_ImageUploadFailedTitle,Ra,null)};rb.prototype.Nqc=function(){jc.ULS.sendTraceTag(36783361,322,50,"PictureUploader.OnUploadComplete");ic.prototype.Nqc.call(this);this.KWb&&(this.KWb.stop(),this.KWb=null);this.D2g()};rb.prototype.YFj=function(){this.Isa=(new Bf.a).create();
this.Isa.message=CommonUIStrings.l_ImageUploadWait;this.Isa.lc=5;this.Isa.rv=!1;this.Isa.UBa(null,null,null)};rb.prototype.D2g=function(){this.Isa&&(this.Isa.close(),this.Isa=null)};rb.eai=function(Y,Ra){Y=Ee.a.Yl(Y);for(var Db=0;Db<Ra.length;++Db)if(Y.endsWith(Ra[Db]))return!0;return!1};rb.UCa=function(Y,Ra){Ra=void 0===Ra?null:Ra;Ra||(Ra=rb.$me);return Y?rb.eai(Y,Ra)?0:2:1};uk.Object.defineProperties(rb.prototype,{uP:{configurable:!0,enumerable:!0,get:function(){return Lc.AFrameworkApplication.sa.gE}}});
rb.$me=".jpg .jpeg .png .gif .bmp .tif .tiff".split(" ");Object(pd.a)(rb,"PictureUploader",ic,[]);var Uh=b(618),Ka=b(289),sa=b(149),wb=b(90),Nd=b(166),ee=b(180),yf=b(86),sg=b(1318),bg=b(79),Yf=sg.a;Am(Ta,Yf);Ta.prototype.Ztc=function(Y,Ra){this.isEnabled()&&this.AGa(this.targetOrigin)&&(this.mo(Y),this.Vl(Y,Ra))};Object(pd.a)(Ta,"InsertMediaCrossDocumentMessenger",sg.a,[832,64,3]);Object(pd.a)(pc,"OnlineMediaSearchResult",null,[]);var xg=b(324),oe=sa.a;Am(yb,oe);yb.prototype.NFj=function(Y){var Ra=
this;this.Kic=!1;this.showDialog(this.uo,null);this.zxa=document.getElementById(this.vi("InsertMediaFrame"));if(!this.zxa)throw this.Dva(this.Lqb),Error.invalidOperation("Couldn't get InsertMediaIframe.");var Db=document.getElementById(this.vi("WACDialogPanel"));Db&&Db.setAttribute(wb.a.Vd,wb.a.M_a);Db=document.createElement("div");Db.id="KeepFocusStartDiv";Db.tabIndex=0;Db.className="keep-focus-start";this.zxa.parentNode.insertBefore(Db,this.zxa.parentNode.firstChild);Db=document.createElement("div");
Db.id="KeepFocusDiv";Db.tabIndex=0;Db.className="keep-focus";this.zxa.parentNode.appendChild(Db);$addHandler(this.rJa,"keydown",this.rvd);this.zxa.src=this.zef;this.zxa.frameBorder="0";Db=document.getElementById(this.vi("WACDialogButtonPanel"));if(!Db)throw Error.invalidOperation("Couldn't get WACDialogButtonPanel.");Db.className="display-none";Db=document.getElementById(this.vi("WACDialogTitleText"));if(!Db)throw Error.invalidOperation("Couldn't get WACDialogTitleText.");Db.className="display-none";
2===this.Utf&&(document.getElementById(this.vi("WACDialogTitlePanel")).className="display-none",document.getElementById(this.vi("WACDialogBodyPanel")).className="padding-zero");Yc.FocusManager.instance().IR().scope.nS=!0;this.SS=new Ta(this.zxa.contentWindow,this.zef);this.SS.Ztc(Nd.a.xFg,function(ec){Ra.qLi(ec,Object(za.a)(Y,Y.Tpa,"uploadResponseReceived"))});this.SS.Ztc(Nd.a.insert,function(){Ra.GSi(Object(za.a)(Y,Y.Tpa,"uploadResponseReceived"))});this.SS.Ztc(Nd.a.C1c,this.wMi);2===this.Utf&&0===
this.bjh&&(this.SS.Ztc(Nd.a.pwi,this.rTi),this.KOa=this.Gpb.NAa("MsoPremiumStockImages",function(ec){jc.ULS.sendTraceTag(537155811,0,50,"OnCompleteM365Upsell: Upsell completed from stock images");if(ec.isEnabled){var gd={};Ra.SS.Nj(Nd.a.AZj,(gd.LicenseTier=ec.toString(),gd))}else jc.ULS.sendTraceTag(537155810,0,10,"OnCompleteM365Upsell: Upsell completed but license tier didn't upgrade.")}))};yb.prototype.dispose=function(){this.sBa=null;this.Gpb&&this.KOa&&this.Gpb.ILd("MsoPremiumStockImages",this.KOa);
this.SS&&(this.SS.dispose(),this.SS=null);oe.prototype.dispose.call(this)};yb.prototype.hide=function(){oe.prototype.hide.call(this);yf.a.qyc(this.$)};yb.prototype.qLi=function(Y,Ra){Y=Y&&Y.Values?(Y=Y.Values)?Object.assign(new pc,{Action:Y.action||"",Caption:Y.caption||"",ContentType:Y.contentType||"",FileExtension:Y.extension||"",PageUrl:Y.pageUrl||"",SourceUrl:Y.sourceUrl||"",ThumbnailUrl:Y.thumbnailUrl||"",LicenseUrl:Y.licenseUrl||"",LicenseDisplayName:Y.licenseDisplayName||"",Height:Y.height||
0,Width:Y.width||0}):null:null;Y&&(Array.add(this.sBa,Y),this.Kic&&(jc.ULS.sendTraceTag(537155809,0,50,"InsertMediaDialog.OnAddItem: Insert Message handling was pending"),Ra(this.sBa),this.Kic=!1,this.Dva(this.Lqb)))};yb.prototype.GSi=function(Y){this.sBa&&0<this.sBa.length?this.sBa.length<=this.qte?(Y(this.sBa),this.Dva(this.Lqb)):(this.lA(),jc.ULS.sendTraceTag(537155808,0,10,"OnInsert : Tried to insert more than allowed limit of items."),Array.clear(this.sBa)):this.Kic=!0};yb.prototype.uah=function(){var Y=
document.createElement("div");Y.id="InsertMediaDialog";Y.className=nd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.InsertMediaDialog.ZoomFixHorizonalScroll",!0)?"insert-media-dialog":"insert-media-dialog-old";var Ra=document.createElement("div");Ra.id="InsertMediaPanel";Ra.className=nd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.InsertMediaDialog.ZoomFixCancelButton",!0)?"insert-media-panel":"insert-media-panel-old";var Db=document.createElement("iframe");Db.id=
"InsertMediaFrame";Db.className="insert-media-frame";Y.appendChild(Ra);Ra.appendChild(Db);return xg.b(Y)};yb.prototype.lA=function(){var Y=Fd.a.ed(1,0,0,0,0,466721363,"InsertPictureExceededAllowedCount");Y.Description=String.format(ef.a.instance.Bb(196),this.qte.toLocaleString());nd.EwaSettings.Rz()?new Bd.a(this.$,Y):(new Dc.ErrorDialog(this.$,Y)).pf()};uk.Object.defineProperties(yb.prototype,{h5:{configurable:!0,enumerable:!0,get:function(){return ee.a.e8b+"/InsertMediaDialog"}},canBePreempted:{configurable:!0,
enumerable:!0,get:function(){return!1}}});Object(pd.a)(yb,"InsertMediaDialog",sa.a,[]);var Gh=b(491),rh=b(394);Am(lb,rb);lb.prototype.Tpa=function(Y){var Ra=this;if(Y){for(var Db=Array(Y.length),ec=0;ec<Y.length;ec++){var gd=Y[ec];Db[ec]={};Db[ec].SourceUrl=gd.SourceUrl;Ee.a.aya(gd.LicenseUrl)&&Ee.a.aya(gd.PageUrl)&&(Db[ec].LicenseUrl=gd.LicenseUrl,Db[ec].LicenseDisplayName=gd.LicenseDisplayName,Db[ec].PageUrl=gd.PageUrl);Db[ec].AltText=-2053056795===this.Xd.command?gd.Caption:""}var Jd=-2009825598===
this.Xd.command?"bing":"M365";ec=qf.g(this.$);var Xd=rf.o(ec.ga.va.activeCell,this.$);ud.a(this.$.userOperationManager,function(xe,cf,pf){return Mc.M(Ra.$.na.ta,Xd,Db,Jd,Mf.b(xe,Ra.hVi),Mf.a(cf,Ra.gVi),pf,null)},function(xe){return new af.a(595,0,xe)},this.Xd);Me.HelperMethods.S_?(ec=new Map,ec.set("MediaProvider",Jd),ec.set("ImagesCount",Y.length.toString()),ec.set("TimeTakenToOpenDialog",this.urf.toString()),cc.Health.instance.recordKpiUsage(rh.a.Bhi,1,Gh.a.Vbg,ec)):jc.ULS.sendTraceTag(537155805,
0,15,"OnlinePictureUploaderWrapper.UploadResponseReceived: KPI Usage not supported.");this.Nqc()}else jc.ULS.sendTraceTag(537155806,0,10,"OnlinePictureUploaderWrapper.UploadResponseReceived: Response is null")};lb.prototype.dispose=function(){this.$=null};lb.prototype.showDialog=function(){var Y=this,Ra=null;Ra=this.$.Sb.Hc("UserAction","showOnlineImagesDialogTimeStopwatch");switch(this.Xd.command){case -2009825598:this.YEj();break;case -2053056795:this.Xte.execute(function(Db){Db.isFeatureEnabled("MsoPremiumStockImages",
!1).catch(function(ec){return jc.ULS.sendTraceTag(557200643,0,10,"OnlinePictureUploaderWrapper::ShowDialog - Failed to load the premium state from application feature helper: {0}",ec)}).then(function(ec){Y.ZEj(ec);return null})})}Ra.stop();this.urf=Ra.Gc};lb.prototype.YEj=function(){var Y=this.$.ya.BingPictureEndpoint,Ra=Uh.a.DK(Lc.AFrameworkApplication.lcid),Db=le.a.create();Y?(Y=0<Y.search(RegExp("insertmedia.bing.office.net","gi"))?String.format(Y,1,1):String.format(Y,1,Lc.AFrameworkApplication.lcid,
Ra?Ra.name:"en-us",Lc.AFrameworkApplication.buildVersion,Db.toString(),1,this.$.ya.DocumentHostInfo.LoggableUserId),this.$5b(Y,1,-1,ef.a.instance.fa(1714))):(jc.ULS.sendTraceTag(537155804,0,10,"OnlinePictureUploaderWrapper::ShowDialogForBingPictures - Can't access the Bing service endpoint"),this.K1.setException(Error.create("Failed to access the Bing service endpoint")))};lb.prototype.ZEj=function(Y){var Ra=this.$.ya.M365PictureEndpoint,Db=le.a.create();if(Ra){var ec=this.$.ya.DocumentHostInfo.UserId;
ec=ec?Ee.a.sw(ec).toString():"0";var gd=this.Xte.instance.isFreemiumUpsellEnabled();Y=Y?1:gd?0:-1;Db=Db.toString();gd=Uh.a.DK(Lc.AFrameworkApplication.lcid).name;Ra=String.format(Ra,Lc.AFrameworkApplication.lcid,gd,Lc.AFrameworkApplication.buildVersion,Db,1,ec,Y,1);this.$5b(Ra,2,Y,ef.a.instance.fa(1713))}else jc.ULS.sendTraceTag(537155803,0,10,"OnlinePictureUploaderWrapper::ShowDialogForStockImages - Can't access the M365 service endpoint"),this.K1.setException(Error.create("Failed to access the M365 service endpoint"))};
lb.prototype.$5b=function(Y,Ra,Db,ec){try{(new yb(this.$,Y,Je.a.instance.Nh("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),Ra,Db,ec)).NFj(this),this.K1.setResult(!0)}catch(gd){jc.ULS.sendTraceTag(537155802,0,10,"OnlinePictureUploaderWrapper::CreateAndShowDialog failed [Exception : {0}] [MediaProvider : {1}] [DialogLicenseTier : {2}]",gd,Ra,Db),this.K1.setException(gd)}};Object(pd.a)(lb,"OnlinePictureUploaderWrapper",rb,[3]);Cb.prototype.executeCommand=function(Y,Ra,Db){Y=Ra.command;
switch(Y){case 1403967063:if(Db&&"dataUrl"in Db)return Ra=new Jg.a,this.uploaderCreator&&this.uploaderCreator.ifi(this.$,li.a.instance,Lc.AFrameworkApplication.ha,Db,Db.dataUrl,Ra),Ra.task;this.uploaderCreator&&this.uploaderCreator.jgi(this.$,Ra,li.a.instance,Lc.AFrameworkApplication.ha,Db);return Eg.Task.Sa(!0);case -2053056795:case -2009825598:return Y=new Jg.a,new lb(this.$,Ra,li.a.instance,Lc.AFrameworkApplication.ha,Db,Y),Y.task;default:return zg.a(Y)}};Cb.prototype.Mc=function(Y,Ra){if(Y=this.$.isEditMode)switch(Ra.command){case 1403967063:Y=
!0;break;case -2053056795:Y=!0;break;case -2009825598:Y=nd.EwaSettings.isChangeGateEnabled("OfficeVSO:5744839_InsertOnlinePictures");break;default:Y=!1}return Y};Cb.prototype.nd=function(){return!1};Cb.prototype.$c=function(){return!1};Object(pd.a)(Cb,"PictureCommandHandler",null,[434]);var Ph=Dg.a;Am(wc,Ph);wc.prototype.Qd=function(){var Y=this;Hb.TaskExtensions.Ba(ah.GetServiceTaskFactory.Ua(this.$.da,484,485,1),function(Ra){Y.Jd([new Cb(Y.$,Ra.result)])},this.$.la,3)};wc.ka=function(Y){Dg.a.je(90,
new wc(Y))};Object(pd.a)(wc,"PictureCommandHandlerFactory",Dg.a,[]);var Di=b(556),Fg=b(437),$f=b(75),Bg=b(593),uh=b(637),ei=Bg.a;Am(Rb,ei);Rb.prototype.OSd=function(Y){this.Dga!==Y&&(this.Dga=Y,this.hIb())};Rb.prototype.dispose=function(){this.gridView.zc.$k(this.dzf);this.gridView.zc.Zn(this.czf);this.gridView=null;ei.prototype.dispose.call(this)};Rb.prototype.hIb=function(){this.zJd(this.Dga)};Rb.prototype.refresh=function(){this.OSd(!this.gridView.isEditing)};uk.Object.defineProperties(Rb.prototype,
{qL:{configurable:!0,enumerable:!0,get:function(){return this.nnc(this.Dga)}},name:{configurable:!0,enumerable:!0,get:function(){return uh.a.cellEdit}}});Object(pd.a)(Rb,"CellEditSafeStatePublisher",Bg.a,[]);Object(pd.a)(ib,"SafeStatePublisherState",null,[]);var cg=b(705),Gf=Td.a;Am(Da,Gf);Da.prototype.m0b=function(Y){this.addHandler(Da.sSa,Y)};Da.prototype.jvc=function(Y){this.removeHandler(Da.sSa,Y)};Da.prototype.PAa=function(Y,Ra){function Db(Jd,Xd){gd.qL=Xd.qL;ec.CJd()}var ec=this,gd=new ib(Y,
Ra);this.tSa.add(gd);Y.m0b(Db);gd.handler=Db;this.CJd()};Da.prototype.U_d=function(Y){for(var Ra=null,Db=Cl(this.tSa),ec=Db.next();!ec.done;ec=Db.next())if(ec=ec.value,ec.publisher===Y){this.egg(ec);Ra=ec;break}Ra&&(this.tSa.remove(Ra),this.CJd())};Da.prototype.dispose=function(){for(var Y=Cl(this.tSa),Ra=Y.next();!Ra.done;Ra=Y.next())this.egg(Ra.value);this.tSa.clear();Gf.prototype.dispose.call(this)};Da.prototype.Ybc=function(){return da.Ybc(this.tSa.toArray().map(function(Y){return Y.qL}))};Da.prototype.egg=
function(Y){Y.publisher.jvc(Y.handler)};Da.prototype.CJd=function(){var Y=this.Ybc();Y!==this.Qnf&&(this.raiseEvent(Da.sSa,new cg.a(Y)),this.Qnf=Y)};uk.Object.defineProperties(Da.prototype,{aVj:{configurable:!0,enumerable:!0,get:function(){return di.f(di.c(this.tSa.toArray(),function(Y){return 0!=Y.qL}),function(Y){return Y.publisher.name})}}});Da.sSa="SSC";Object(pd.a)(Da,"ClientStateMonitor",Td.a,[]);var Zf=b(6),eh=b(65),wh=Bg.a;Am(Ja,wh);Ja.prototype.OSd=function(Y){Y!==this.Dga&&(this.Dga=Y,this.hIb())};
Ja.prototype.dispose=function(){eh.a(this.$).Ruc(this.hAf);this.N6a.er(this.AO);this.xae=null;wh.prototype.dispose.call(this)};Ja.prototype.hIb=function(){this.zJd(this.Dga)};Ja.prototype.refresh=function(){this.OSd(1===this.N6a.ku||eh.a(this.$).Ci===this.N6a)};uk.Object.defineProperties(Ja.prototype,{qL:{configurable:!0,enumerable:!0,get:function(){return this.nnc(this.Dga)}},name:{configurable:!0,enumerable:!0,get:function(){return uh.a.N6a}},N6a:{configurable:!0,enumerable:!0,get:function(){return this.xae}}});
Object(pd.a)(Ja,"IdleActivitySafeStatePublisher",Bg.a,[]);var Yg=b(327),k=b(3),Ab=$f.a;Am(pa,Ab);pa.prototype.$c=function(){return!1};pa.prototype.executeCommand=function(){return Eg.Task.Sa(!0)};pa.prototype.Mc=function(Y,Ra){return 1905775613===Ra.command};pa.prototype.nd=function(){return!1};Object(pd.a)(pa,"ToggleMergeSuspensionSafeState",$f.a,[434]);var oc=Td.a;Am(nb,oc);nb.prototype.Gq=function(Y){this.addHandler(nb.Fzd,Y)};nb.prototype.er=function(Y){this.removeHandler(nb.Fzd,Y)};nb.prototype.Xz=
function(){this.raiseEvent(nb.Fzd)};nb.prototype.wn=function(Y){return Y===nb.a8i&&!!this.mergeSuspensionManager};nb.prototype.Bs=function(Y,Ra){if(!this.wn(Y))return!1;this.mergeSuspensionManager&&(Ra.LabelText=this.Vnc,Ra.On=this.$Ad);return!0};nb.prototype.dispose=function(){this.MOb&&(this.Ka.ucb(this.MOb),this.MOb.dispose(),this.MOb=null);this.mergeSuspensionManager&&(this.mergeSuspensionManager.$ab.rJb(this.RFb),this.mergeSuspensionManager.Jia.jvc(this.gQa),this.mergeSuspensionManager=null);
this.statusBarManager&&(this.statusBarManager.tG(this),this.statusBarManager=null);this.Vnc=null;oc.prototype.dispose.call(this)};nb.Fzd="MSMSC";nb.a8i="QueryMergeSuspensionStatus";Object(pd.a)(nb,"MergeSuspensionIndicatorManager",Td.a,[533,299,3]);var R=b(1096),Ba=Sys.EventArgs;Am(Za,Ba);Object(pd.a)(Za,"TogglePendingMergeBlockedByClientEventArgs",Sys.EventArgs,[]);Object(pd.a)(Ma,"SuspensionState",null,[]);Am(oa,Ma);Object(pd.a)(oa,"ReadyForPendingMergeState",Ma,[]);var d=new Ma,x=new Ma;new oa(!1);
var M=new oa(!0),V=b(1097),ca=Td.a;Am($b,ca);$b.prototype.$di=function(){return Object(Fg.a)(Da,this.Jia)?Object(Mb.a)(Da,this.Jia).Ybc():1};$b.prototype.q0b=function(Y){this.addHandler($b.gZd,Y)};$b.prototype.lvc=function(Y){this.removeHandler($b.gZd,Y)};$b.prototype.DKg=function(Y){this.addHandler($b.hKd,Y)};$b.prototype.Vhj=function(Y){this.removeHandler($b.hKd,Y)};$b.prototype.LJg=function(Y){this.addHandler($b.Azd,Y)};$b.prototype.ohj=function(Y){this.removeHandler($b.Azd,Y)};$b.prototype.G9i=
function(){this.xJd(this.getState()===x)};$b.prototype.dispose=function(){this.Jia.jvc(this.gQa);this.Jia=null;this.$ab.rJb(this.RFb);this.$ab=null;ca.prototype.dispose.call(this)};$b.prototype.Hid=function(){return Object.assign(new R.a,{Current:this.Cma.Current,Pending:this.Cma.Pending,SuspensionStartTimestamp:this.Cma.SuspensionStartTimestamp})};$b.prototype.getState=function(){return gb(this.Cma)?0==this.qL?M:x:d};$b.prototype.NXe=function(Y,Ra){Y!==Ra&&(Ra===x?this.xJd(!0):Y===x&&this.xJd(!1));
Ra===M&&this.raiseEvent($b.hKd,new V.a(this.Cma))};$b.prototype.yAi=function(Y,Ra,Db){Y===d&&Ra!==d?(Y=Ra===x,jc.ULS.sendTraceTag(252760283,0,50,"MergeSuspensionStateHandler.LogPendingMergesStatusChanged: Pending changes exist. IsBlocking: {0} publisher: {1} counter: {2}",Y,Y?this.Jia.aVj.join(","):"",zb(this.Cma))):Y!==d&&Ra===d&&jc.ULS.sendTraceTag(252760284,0,50,"MergeSuspensionStateHandler.LogPendingMergesStatusChanged: No pending changes. counter: {0}",zb(Db))};$b.prototype.xJd=function(Y){this.raiseEvent($b.gZd,
new Za(Y))};$b.gZd="TPMBBC";$b.hKd="RFPMU";$b.Azd="MCC";Object(pd.a)($b,"MergeSuspensionStateHandler",Td.a,[]);var Oa=Td.a;Am(Gb,Oa);Gb.prototype.ipb=function(Y){this.addHandler("MCU",Y)};Gb.prototype.rJb=function(Y){this.removeHandler("MCU",Y)};Gb.prototype.bQa=function(Y,Ra){Ra=void 0===Ra?"":Ra;var Db=this.L2.Current<Y.Current||this.L2.Pending<Y.Pending;if(Y.SuspensionStartTimestamp&&this.llc!==Y.SuspensionStartTimestamp){if(this.llc>Y.SuspensionStartTimestamp){Db&&jc.ULS.sendTraceTag(553736149,
0,50,"PendingMergeMonitor.OnMergeCounterReceivedFromServer: skipping a higher stale counter received via {0}. S: {1}, C: {2}",Ra,Gb.$Db(Y),Gb.$Db(this.L2));return}Db||jc.ULS.sendTraceTag(553736148,0,50,"PendingMergeMonitor.OnMergeCounterReceivedFromServer: recovering from a potentially stale counter. S: {0}, C: {1}",Gb.$Db(Y),Gb.$Db(this.L2))}else if(!Db)return;this.L2=Y;this.dPf(Y)};Gb.prototype.dispose=function(){this.$.ea.tk(this.Rxc);this.$.ea.DX(this.Rxc);this.$.na.Rr(this.Y8);qf.g(this.$).zc.Zn(this.T$a);
var Y=this.$.da.Aa(292);Y&&Y.rJb(this.aEb);Oa.prototype.dispose.call(this)};Gb.prototype.dPf=function(Y){gb(Y)&&Y.SuspensionStartTimestamp>this.llc&&(jc.ULS.sendTraceTag(537155416,0,50,"PendingMergeMonitor.RaiseMergeCounterUpdated: Merge suspension requested. MergeCounter: {0}",zb(Y)),this.llc=Y.SuspensionStartTimestamp);this.raiseEvent("MCU",new V.a(Y))};Gb.prototype.oXf=function(){jc.ULS.sendTraceTag(588276808,0,50,"PendingMergeMonitor.ResetMergeCounter : Last counter was {0}",Gb.$Db(this.L2));
this.L2=Object.assign(new R.a,{Pending:0,Current:0,SuspensionStartTimestamp:null})};Gb.$Db=function(Y){return Y?String.format("({0}/{1} @{2})",Y.Current,Y.Pending,Y.SuspensionStartTimestamp):"null"};uk.Object.defineProperties(Gb.prototype,{Cma:{configurable:!0,enumerable:!0,get:function(){return this.L2}}});Gb.I2d="PMM.RTC";Gb.h$c="PMM.EwaResult";Object(pd.a)(Gb,"PendingMergeMonitor",Td.a,[]);Object(pd.a)(xa,"ClientRevisions",null,[]);var Fb=Td.a;Am(ab,Fb);ab.prototype.dispose=function(){this.$.na.fea(this.Z8);
this.bBc();this.J6.Vhj(this.DFf);this.J6.lvc(this.zGb);this.J6.ohj(this.TDf);this.J6=null;Fb.prototype.dispose.call(this)};ab.prototype.nKj=function(){this.bBc();if(this.ILe()){var Y=this.J6.Hid();jc.ULS.sendTraceTag(537155414,0,50,"RequestController.StartKeepBlockingPendingMergesTimer: Prevented starting StartKeepBlockingPendingMergesTimer because of repeated failure in counter {0} fail count: {1}",zb(Y),this.kCb)}else this.lCb=this.pta.create(this.E0f,this.SNd,Xh.a.lCb),this.Z8a=this.pta.RC(this.E0f,
this.gvi,Xh.a.Z8a)};ab.prototype.bBc=function(){this.Z8a&&(this.lCb.cancel(),this.Z8a.cancel(),this.Z8a=this.lCb=null)};ab.prototype.aTi=function(Y){var Ra=" fail count: "+this.kCb;this.kCb++;this.ILe()&&this.bBc();jc.ULS.sendTraceTag(542229773,0,10,"RequestController.OnKeepBlockingPendingMergesRequestFailed: request failed {0}{1}",zb(Y),Ra)};ab.prototype.ILe=function(){return this.kCb>ab.bEi};ab.bEi=5;Object(pd.a)(ab,"RequestController",Td.a,[]);var lc=b(209),Oc=b(27),wd=Td.a;Am(Fa,wd);Fa.prototype.FQg=
function(Y){var Ra=this;if(this.QMb(Y))(new Jg.a).setResult(!0);else{var Db=this.p2i(Y);this.klc=Y;this.vFd++;Db.CWCT(function(){Ra.NOi()},lc.a.none,0,this.xP)}};Fa.prototype.p2i=function(Y){function Ra(){var Xd;Db.yRf||(null===(Xd=Db.Z7)||void 0===Xd?void 0:Xd.byf());jc.ULS.sendTraceTag(588276806,0,10,"DoPendingMergeThrottler.performDoPendingMergeInternal: request failed {0} / {1} @{2}",Y.Current,Y.Pending,Y.SuspensionStartTimestamp)}var Db=this,ec=this.ta.fc();this.q9f&&this.isDocumentHidden||this.Qy();
this.G1d=this.wh.vfa;jc.ULS.sendTraceTag(554767493,0,50,"DoPendingMergeThrottler.performDoPendingMergeInternal: Sending DoPendingMerge {0} / {1} @{2}",Y.Current,Y.Pending,Y.SuspensionStartTimestamp);if(this.Z7){if(this.yRf)return this.Z7.Goj(this.jTh(Ra));var gd=Cl(this.Z7.FZi()),Jd=gd.next().value;gd=gd.next().value;return this.Lze(gd,Jd?null:this.OOi.bind(this),Ra,ec)}return this.eYg(Ra,ec)};Fa.prototype.QMb=function(Y){if(this.Y7c&&this.isDocumentHidden)return this.wh.vfa-this.G1d<this.Hai;if(!this.klc||
Y.SuspensionStartTimestamp>this.klc.SuspensionStartTimestamp)return this.YMa&&jc.ULS.sendTraceTag(523551556,0,50,"DoPendingMergeThrottler.shouldThrottle: Allowing request for new suspension while previous is ongoing, new counter: {0} / {1} @{2}",Y.Current,Y.Pending,Y.SuspensionStartTimestamp),!1;if(this.YMa)Y=!0;else{var Ra=this.klc;Y=(Y||Ra?Y&&Ra?Y.Current===Ra.Current&&Y.Pending===Ra.Pending&&Y.SuspensionStartTimestamp===Ra.SuspensionStartTimestamp:!1:!0)&&this.wh.vfa-this.G1d<this.SNd}return Y};
Fa.prototype.NOi=function(){this.vFd--};Fa.prototype.OOi=function(Y){if(this.Z7){var Ra=Y.Result;this.Z7.cyf(null===Ra||void 0===Ra?void 0:Ra.AdjustedViewportState,Y.StateId)}};Fa.prototype.jTh=function(Y){var Ra=null,Db=this;return function(ec,gd,Jd){Jd&&(Y=Mf.a.call(null,Jd,Y));gd&&(Ra=Mf.b.call(null,function(Xd){var xe=Xd.Result;gd(null===xe||void 0===xe?void 0:xe.AdjustedViewportState,Xd.StateId)},Ra));return Db.Lze(ec,Ra,Y,Db.ta.fc())}};Fa.prototype.Lze=function(Y,Ra,Db,ec){return bb(this.ta,
Y,!0,Ra,Db,null,null,ec)};Fa.prototype.eYg=function(Y,Ra){return bb(this.ta,null,!0,null,Y,null,null,Ra)};uk.Object.defineProperties(Fa.prototype,{YMa:{configurable:!0,enumerable:!0,get:function(){return 0<this.vFd}},isDocumentHidden:{configurable:!0,enumerable:!0,get:function(){return!!this.documentVisibilityObserver&&this.documentVisibilityObserver.Hi}}});Object(pd.a)(Fa,"DoPendingMergeSender",Td.a,[828,829]);uk.Object.defineProperties(Aa.prototype,{reportName:{configurable:!0,enumerable:!0,get:function(){return this.Xci?
"SelectionAdjustInHiddenDocument":"SelectionAdjust"}}});Object(pd.a)(Aa,"SelectionAdjustSessionEndsReport",null,[464]);qa.prototype.Wjg=function(Y){if(!this.H5d)return jc.ULS.sendTraceTag(525135954,0,10,"Selection.viewportBlocksReadyForAdjust: _blockCacheItems undefined"),!1;for(var Ra=Cl(this.H5d),Db=Ra.next();!Db.done;Db=Ra.next())if(Db=Db.value,Db.Vj&&Db.me.Revision<Y)return!1;return!0};qa.prototype.Zcg=function(){var Y;if(this.Thb)return{SheetName:this.sheetName,ActiveCell:null===(Y=this.activeCell)||
void 0===Y?void 0:Y.toString(),SelectedRange:this.selectedRanges[0].toString(),TopLeft:void 0}};qa.prototype.toString=function(){var Y,Ra;return String.format("active cell: {0} selection: {1}",null!==(Ra=null===(Y=this.activeCell)||void 0===Y?void 0:Y.toString())&&void 0!==Ra?Ra:"null",di.f(this.selectedRanges,function(Db){var ec;return null!==(ec=null===Db||void 0===Db?void 0:Db.toString())&&void 0!==ec?ec:"null"}).join(","))};qa.prototype.equals=function(Y){return Y?this.activeCell.equals(Y.activeCell)&&
rf.Q(this.selectedRanges,Y.selectedRanges)&&this.sheetName===Y.sheetName:!1};uk.Object.defineProperties(qa.prototype,{activeCell:{configurable:!0,enumerable:!0,get:function(){return this.WG}},selectedRanges:{configurable:!0,enumerable:!0,get:function(){return this.m$}},sheetName:{configurable:!0,enumerable:!0,get:function(){return this.$Xb}},activeItemName:{configurable:!0,enumerable:!0,get:function(){return this.nog}},Thb:{configurable:!0,enumerable:!0,get:function(){return 1===this.selectedRanges.length}}});
Object(pd.a)(qa,"SelectionState",null,[]);var Rd=b(217),Oe;(function(Y){Y[Y.none=0]="none";Y[Y.waitingForAdjusted=1]="waitingForAdjusted";Y[Y.invalid=2]="invalid";Y[Y.nonContinuous=3]="nonContinuous";Y[Y.noAdjustRequired=4]="noAdjustRequired";Y[Y.waitingForViewport=5]="waitingForViewport";Y[Y.adjusted=6]="adjusted";Y[Y.divergence=7]="divergence";Y[Y.differentSheetAdjust=8]="differentSheetAdjust";Y[Y.exception=9]="exception"})(Oe||(Oe={}));Object(pd.b)("SelectionAdjustState",Oe);var la=b(951);ha.prototype.Goj=
function(Y){function Ra(){Db.byf()}var Db=this,ec=null,gd=null;this.Iff()?(this.KU.parallel++,jc.ULS.sendTraceTag(526390086,0,15,"SelectionAdjustManager.runRequestWithSelectionAdjust: Skipping parallel request. Current adjustedSelection is defined : {0}",!!this.ow)):(ec=function(Jd,Xd){Db.cyf(Jd,Xd)},gd=this.txj());return null===Y||void 0===Y?void 0:Y(gd,ec,Ra)};ha.prototype.txj=function(){jc.ULS.shipAssertTag(525135961,0,0===this.rD,"SelectionAdjustManager.setPreRequestState: unexpected state");
this.ow&&(this.KU.errors++,jc.ULS.sendTraceTag(526960090,0,10,"SelectionAdjustManager.setPreRequestState: About to ignore a defined Adjusted selection: {0}",this.ow.toString()));this.ow=null;this.Ow=this.qwa();var Y=null,Ra=this.Ow.Zcg();Ra&&(Y={ActiveSheetName:this.Ow.sheetName,SheetViewportStateChanges:[Ra]});this.rD=1;return Y};ha.prototype.FZi=function(){if(this.Iff())return this.KU.parallel++,jc.ULS.sendTraceTag(524039616,0,15,"SelectionAdjustManager.onWaitingForAdjustedSelection: Skipping parallel request. Current adjustedSelection is defined : {0}",
!!this.ow),[!0,null];jc.ULS.shipAssertTag(524039587,0,0===this.rD,"SelectionAdjustManager.onWaitingForAdjustedSelection: unexpected state");this.ow&&(this.KU.errors++,jc.ULS.sendTraceTag(524039586,0,10,"SelectionAdjustManager.onWaitingForAdjustedSelection: About to ignore a defined Adjusted selection: {0}",this.ow.toString()));this.ow=null;this.Ow=this.qwa();var Y=null,Ra=this.Ow.Zcg();Ra&&(Y={ActiveSheetName:this.Ow.sheetName,SheetViewportStateChanges:[Ra]});this.rD=1;return[!1,Y]};ha.prototype.byf=
function(){jc.ULS.shipAssertTag(525135960,0,1===this.rD,"SelectionAdjustManager.onAdjustedRequestFailed: unexpected state");this.KU.errors++;this.rD=2;this.ps()};ha.prototype.cyf=function(Y,Ra){try{jc.ULS.shipAssertTag(525135959,0,1===this.rD,"SelectionAdjustManager.onAdjustedSelectionReady: unexpected state"),this.XAc=Ra,Ra=2,this.Ow?Y?(this.ow=this.aBj(Y))?(Ra=5,this.Ow.Thb)?this.Ow.equals(this.ow)?(this.KU.adjustedDidntChange++,Ra=4):nd.EwaSettings.isChangeGateEnabled("OfficeVSO:6147595_preventDifferentSheetAdjust")&&
this.Ow.sheetName!=this.ow.sheetName&&(this.KU.differentSheetAdjust++,Ra=8):(this.KU.nonContinuous++,Ra=3):this.KU.errors++:(this.KU.errors++,jc.ULS.sendTraceTag(537155412,0,15,"SelectionAdjustManager.OnAdjustedSelectionReady: Adjusted returned null, initialSelection: {0}",this.Ow.toString())):(this.KU.errors++,jc.ULS.sendTraceTag(537155413,0,10,"SelectionAdjustManager.OnAdjustedSelectionReady: Adjusted selection results returned when not waiting for them, adjusted:  ActiveCell: {0}, SelectedRange: {1}",
null===Y||void 0===Y?void 0:Y.ActiveCell,null===Y||void 0===Y?void 0:Y.SelectedRange)),this.rD=Ra}catch(Db){this.rD=9,jc.ULS.sendTraceTag(525135958,0,10,"SelectionAdjustManager.OnAdjustedSelectionReady: caught Exception {0}",Db)}finally{5!=this.rD?this.ps():nd.EwaSettings.isChangeGateEnabled("OfficeVSO:6147586_attemptAdjustOnResponse")&&this.c_c(!1,!0)}};ha.prototype.dispose=function(){this.gridView.Da.ar(this.Qg);this.gridView.Da.Jp(this.M$a);this.gridView.Da.XTf(this.M$a);this.gridView.Da.zcb(this.M$a)};
ha.prototype.Iff=function(){return this.n0f?1===this.rD||5===this.rD:!!this.Ow||!!this.ow};ha.prototype.aBj=function(Y){var Ra=this,Db,ec;return function(){var gd=rf.Z(Y.ActiveCell,Ra.$.xa);Db=gd.range;return gd}().returnValue?function(){var gd=rf.Z(Y.SelectedRange,Ra.$.xa);ec=gd.range;return gd}().returnValue?new this.p0f(this.$,Db,[ec],Y.SheetName,this.Ow.activeItemName):(jc.ULS.sendTraceTag(537155410,0,10,"SelectionAdjustManager.sheetViewportStateToSelectionState: Unable to extract selected range {0}",
Y.SelectedRange),null):(jc.ULS.sendTraceTag(537155411,0,10,"SelectionAdjustManager.sheetViewportStateToSelectionState: Unable to extract active cell {0}",Y.ActiveCell),null)};ha.prototype.qwa=function(){var Y=this.$.oa;if((null===Y||void 0===Y?0:Y.activeCell)&&Y.selectedRanges&&Y.sheetName)return new this.p0f(this.$,Y.activeCell,Y.selectedRanges,Y.sheetName,this.$.activeItemName);this.n0f&&jc.ULS.sendTraceTag(525135957,0,10,"SelectionAdjustManager.getCurrentSelection: invalid activeItem. activeItem null: {0}, activeCell null: {1}, selectedRanges null: {2}, sheetName null: {3}",
!Y,!(null===Y||void 0===Y?0:Y.activeCell),!(null===Y||void 0===Y?0:Y.selectedRanges),!(null===Y||void 0===Y?0:Y.sheetName));return null};ha.prototype.c_c=function(Y,Ra){if(this.Fqi(Y)){Ra&&jc.ULS.sendTraceTag(524039250,0,50,"SelectionAdjustManager.attemptAdjustSelection: viewport ready on response");try{jc.ULS.shipAssertTag(525135956,0,5===this.rD,"SelectionAdjustManager.attemptAdjustSelection: unexpected state"),this.Ow.equals(this.qwa())?(this.KU.adjusted++,this.rD=6,this.gridView.kW(this.ow.selectedRanges,
0,this.ow.sheetName,null,this.ow.activeCell,null,null,0,Qa.a.Crj)):(this.KU.divergence++,this.Yjj(),this.rD=7)}catch(Db){this.rD=9,jc.ULS.sendTraceTag(525135955,0,10,"SelectionAdjustManager.attemptAdjustSelection: caught Exception {0}",Db)}finally{this.ps()}}};ha.prototype.Fqi=function(Y){if(!this.ow)return!1;if(!this.Ow)return jc.ULS.sendTraceTag(537155409,0,10,"SelectionAdjustManager.attemptAdjustSelection: initialSelection is null while adjustedSelection isn't null, adjustedSelection: {0}",this.ow.toString()),
!1;if(Y||this.dOj){if(qf.g(this.$).Da.Ctf<this.XAc)return!1;this.Ow.Thb&&jc.ULS.sendTraceTag(528590295,0,15,"SelectionAdjustManager.attemptAdjustSelection: got to blockCacheConsistent while pending for selection adjust")}else if(!this.Ow.Thb||!this.Ow.Wjg(this.XAc)||!this.ow.Wjg(this.XAc))return!1;return!0};ha.prototype.ps=function(){var Y,Ra,Db,ec;this.Gkj&&2!=this.rD&&jc.ULS.sendTraceTag(526792898,0,50,"SelectionAdjustManager.clearState: initial: {0}, adjusted: {1}, state: {2}",null!==(Ra=null===
(Y=this.Ow)||void 0===Y?void 0:Y.toString())&&void 0!==Ra?Ra:"null",null!==(ec=null===(Db=this.ow)||void 0===Db?void 0:Db.toString())&&void 0!==ec?ec:"null",Oe[this.rD]);this.Ow=this.ow=null;this.rD=0};ha.prototype.Yjj=function(){var Y=this.qwa();jc.ULS.sendTraceTag(537155408,0,50,"SelectionAdjustManager.ReportDivergence: initial: {0} current: {1} adjusted: {2} sheetSameBetweenInitialAndAdjusted: {3} sheetSameBetweenInitialAndCurrent: {4}",this.Ow.toString(),Y?Y.toString():"",this.ow.toString(),this.Ow.sheetName===
this.ow.sheetName,this.Ow.sheetName===(Y?Y.sheetName:null))};uk.Object.defineProperties(ha.prototype,{p0f:{configurable:!0,enumerable:!0,get:function(){return qa}},KU:{configurable:!0,enumerable:!0,get:function(){return this.cte&&la.a.nD(this.GFi)?this.V4d:this.U4d}}});Object(pd.a)(ha,"SelectionAdjustManager",null,[794,3]);var $a=$f.a;Am(da,$a);da.prototype.q0b=function(Y){this.Lga.q0b(Y)};da.prototype.lvc=function(Y){this.Lga&&this.Lga.lvc(Y)};da.prototype.PAa=function(Y,Ra){this.PDa.PAa(Y,Ra)};
da.prototype.U_d=function(Y){this.PDa.U_d(Y)};da.prototype.bQa=function(Y,Ra){this.qmb.bQa(Y,void 0===Ra?"":Ra)};da.prototype.dispose=function(){this.Lgc&&(this.Lgc.dispose(),this.Lgc=null);this.Z7&&this.Z7.dispose();this.T2a.dispose();this.NNd&&(this.NNd.dispose(),this.NNd=null);this.Lga&&(this.Lga.dispose(),this.Lga=null);this.qmb.dispose();this.qmb=null;this.PDa.dispose();this.PDa=null;this.Y0a&&(this.Y0a.dispose(),this.Y0a=null);this.O6a&&(this.O6a.dispose(),this.O6a=null);this.$=null;$a.prototype.dispose.call(this)};
da.prototype.hIb=function(){this.Lga.G9i()};da.Ybc=function(Y){var Ra=0;Y=Cl(Y);for(var Db=Y.next();!Db.done;Db=Y.next()){Db=Db.value;if(2==Db)return 2;1==Db&&(Ra=1)}return Ra};da.prototype.uei=function(Y,Ra){this.PDa=new Da(this.T2a);Ra?Object(Fg.a)(Ja,Ra)?this.PAa(Ra,Object(Mb.a)(Ja,Ra).qL):Object(Fg.a)(Rb,Ra)?this.PAa(Ra,Object(Mb.a)(Rb,Ra).qL):this.PAa(Ra,0):(this.Y0a=new Rb(Y),this.O6a=new Ja(Y),this.PAa(this.Y0a,this.Y0a.qL),this.PAa(this.O6a,this.O6a.qL))};uk.Object.defineProperties(da.prototype,
{Jia:{configurable:!0,enumerable:!0,get:function(){return this.PDa}},$ab:{configurable:!0,enumerable:!0,get:function(){return this.qmb}},J6:{configurable:!0,enumerable:!0,get:function(){return this.Lga}}});Object(pd.a)(da,"MergeSuspensionManager",$f.a,[772,3]);var Yb=Ed.a;Am(ka,Yb);ka.prototype.create=function(){jc.ULS.sendTraceTag(537155419,0,50,"MergeSuspensionFactory.Create");this.Eb(this.Qc.da.Aa(343)||this.Qc.da.Ha(343,new da(this.Qc,Eh.a.instance)))};ka.ka=function(Y){jc.ULS.sendTraceTag(537155418,
0,50,"MergeSuspensionFactory.Attach");Y.da.Ha(344,new ka(Y))};Object(pd.a)(ka,"MergeSuspensionFactory",Ed.a,[]);ra.zxi=3;ra.connected=0;Object(pd.a)(ra,"ConnectionStateConstants",null,[]);var Jc=b(110),td=b(116),Tc=b(42);ba.prototype.o2f=function(){this.durationMs=td.a(Oc.a.Ra,this.startTime)};ba.prototype.uEd=function(Y){var Ra=this,Db;this.o2f();Tc.a(Y).hvc(this.Myf);Tc.a(Y).yg.ivc(this.nda);Y.da.Ya(291,function(ec){ec.Bcb(Ra.bX)});if(null===(Db=Y.ea)||void 0===Db?0:Db.xf)Y.ea.xf.XMd(this.qFd),
this.wasUserActiveOnPIEnd=Y.ea.xf.Kr};ba.prototype.Ik=function(Y){var Ra=this;Tc.a(Y).i0b(this.Myf);this.isToastShown?this.toastRaiser="Immediate":Tc.a(Y).yg.YXc(this.nda);Y.da.Ya(291,function(Db){Ra.hasTabbedOut=Db.Hi;Db.IGa(Ra.bX)});this.wasUserActiveOnPIStart&&Y.ea.xf.ose(this.qFd)};Object(pd.a)(ba,"PartialInteractivityData",null,[]);var ve=b(1281);Am(ia,ba);ia.prototype.JNi=function(Y,Ra){this.swappedByOffline=Ra;this.uEd(Y)};ia.prototype.svj=function(Y){this.errorDataDuringConnectivityIssuesMode=
Y};ia.prototype.Yaj=function(Y){10>this.failedRequests.length&&(Y=Y+"_"+Jc.getElapsedSeconds(this.startTime,Oc.a.Ra.Ob).toString(),this.failedRequests.push(Y))};Object(pd.a)(ia,"ConnectivityIssuesData",ba,[]);var Ye=b(176);aa.Lmh="DuringWork";aa.connectivityIssues="ConnectivityIssues";aa.offline="Offline";Object(pd.a)(aa,"UnavailabilityTypes",null,[]);J.prototype.dispose=function(){this.$&&(Tc.a(this.$).yg.gUf(this.Yzf),this.$.tf&&this.$.tf.fUf(this.Vzf));this.data&&this.$.na.tf.fVf(this.Xn);this.$=
null};J.prototype.AXg=function(Y){var Ra=this.Ncd-1;return(this.data.averageDurationBetweenFailedRequestsSec*(Ra-1)+Y)/Ra};Object(pd.a)(J,"ConnectivityIssuesTelemetryManager",null,[3]);var Te=b(1064),Qf=b(1325),kg=b(1280);P.prototype.dispose=function(){this.$&&(this.dUd&&this.$.na&&0<this.r$a.count&&this.$.na.Rr(this.Vh),this.eUd&&(this.XWd("Dispose"),this.$.ea.xf.YAa(this.mda)))};P.prototype.Zdi=function(){nd.EwaSettings.ma(213)&&this.Y4i();this.eUd&&this.Z4i()};P.prototype.vei=function(){this.TEb=
this.UEb;this.Evd=0;var Y={};if(!this.r$a){this.r$a=new se.a;var Ra=Qf.a.Jfd(this.Fkj,"InitSampleMeasurement",this.$);Ra=Cl(Ra);for(var Db=Ra.next();!Db.done;Db=Ra.next())Db=Db.value,Y[Db.znd]=Db.baseUrl,this.r$a.add(Db)}Y=Sys.Serialization.JavaScriptSerializer.serialize(Y);jc.ULS.sendTraceTag(537155210,0,50,"Init Network measurement: numberOfRequestToWaitPerNetworkMeasurement: {0}, numberOfRequestFromTheLastNetworkMeasurement: {1}, testParams: {2} ",this.UEb,this.TEb,Y);0<this.r$a.count&&this.$.na.Hq(this.Vh)};
P.prototype.GKj=function(){for(var Y=Cl(this.r$a),Ra=Y.next();!Ra.done;Ra=Y.next())Ra.value.runTest()};P.prototype.DWd=function(Y){this.OTa&&this.OTa.Ap||(jc.ULS.sendTraceTag(537155208,0,50,"NetworkMeasurement.StartConnectionSpeedTest: starting ping tests. caller: {0}",Y),this.OTa=Eh.a.instance.RC(this.esj,5E3,Xh.a.BIj),this.OTa.yla())};P.prototype.XWd=function(Y){this.OTa&&this.OTa.Ap&&(jc.ULS.sendTraceTag(537155207,0,50,"NetworkMeasurement.StopConnectionSpeedTest: stopping ping tests. caller: {0}",
Y),this.OTa.cancel())};P.prototype.CCj=function(Y){return this.TEb>=this.UEb&&Y-this.Evd>this.Mzd};P.prototype.g0g=function(){return P.vYf(this.$.ya.SlowNetworkMeasurementsSamplePercentage)};P.prototype.Y4i=function(){this.UEb=this.$.ya.NumberOfRequestToWaitPerNetworkMeasurement;this.Mzd=1E3*this.$.ya.MinTimeBetweenNetworkMeasurementInSec;var Y=this.$.ya.NetworkMeasurementsSamplePercentage;0<this.UEb&&0<this.Mzd&&(this.dUd=P.vYf(Y))&&this.vei()};P.prototype.Z4i=function(){if(!this.AAc){this.AAc=new se.a;
var Y=Qf.a.Jfd(this.Ujj,"PrepareAndInitSlowNetworkTests.ConnectionSpeedTest",this.$,[kg.a.jGc]);Y=Cl(Y);for(var Ra=Y.next();!Ra.done;Ra=Y.next())this.AAc.add(Ra.value);this.$.ea.xf.Kr&&this.DWd("PrepareAndInitSlowNetworkTests")}};P.vYf=function(Y){return 100*Math.random()<Y};Object(pd.a)(P,"NetworkMeasurement",null,[3]);var yg=b(994);I.prototype.pWj=function(){this.rV&&this.rV.o2f()};I.prototype.bGg=function(Y){this.allOfflinePartialInteractivitiesDataInSession.push(Y);this._count++};uk.Object.defineProperties(I.prototype,
{count:{configurable:!0,enumerable:!0,get:function(){return this._count}},rV:{configurable:!0,enumerable:!0,get:function(){return this.allOfflinePartialInteractivitiesDataInSession[this.allOfflinePartialInteractivitiesDataInSession.length-1]}}});Object(pd.a)(I,"OfflinePartialInteractivitiesDataForLog",null,[]);Am(S,ba);S.prototype.Syj=function(Y){this.timeFromLastOffline=Y};S.prototype.tvj=function(Y){this._errorDataDuringOfflineMode=Y};Object(pd.a)(S,"OfflinePartialInteractivityData",ba,[]);Z.prototype.dispose=
function(){this.$&&Tc.a(this.$)&&Tc.a(this.$).yg.EMd(this.lab);zh.a.Fa(this.Pvb);this.$=this.Pvb=null};Z.prototype.OUi=function(Y){this.rV=new S(Oc.a.Ra.Ob,this.$,0!==Y);this.rV.Syj(-1!==this.lId?window.performance.now()-this.lId:-1);this.HPa.bGg(this.rV);Tc.a(this.$).yg.YXc(this.nda);this.h4a();this.Pvb=Eh.a.instance.RC(this.h4a,Z.GIh,Xh.a.h4a);Ye.a(this.$).DXc(this.CZf)};Z.prototype.PUi=function(){this.rV.uEd(this.$);this.h4a();zh.a.Fa(this.Pvb);this.Pvb=null;this.lId=window.performance.now();Tc.a(this.$).yg.ivc(this.nda);
Ye.a(this.$).qMd(this.CZf);this.Vjj()};Z.prototype.ypj=function(Y,Ra){var Db=this;this.$?this.Snf=Hb.TaskExtensions.Ba(this.Snf,function(){Db.indexedDB.wdb(new yg.a(Y,Ra))},this.$.la):jc.ULS.sendTraceTag(537155205,0,15,"OfflineModeTelemetryManager.SaveToIndexedDBSequential: EwaControl is null when attempting to write to IDB")};Z.prototype.Pjj=function(){var Y=this.$.la;Hb.TaskExtensions.Ba(Hb.TaskExtensions.Ba(this.indexedDB.oLa(Z.rGd),this.vkj,Y),this.Dej,Y)};Z.prototype.Vjj=function(){if(this.rV){var Y=
Sys.Serialization.JavaScriptSerializer.serialize(this.rV);nd.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_71qb3_Offline")?Ke.b().mLb(560791645,0,50,aa.offline,this.rV.durationMs,"OfflineModeTelemetryManager.ReportCurrentOfflinePartialInteractivityData: Ending offline partial interactivy data: {0}",Y):jc.ULS.sendTraceTag(560791645,0,50,"OfflineModeTelemetryManager.ReportCurrentOfflinePartialInteractivityData: Ending offline partial interactivy data: {0}",Y)}nd.EwaSettings.isChangeGateEnabled("OfficeVSO:5508233_ReportNetworkDownVeto")&&
this.rV&&this.rV.isToastShown&&cc.Health.instance.recordQosError(cb.a.f_j,[bc.a.Hlc],!0,!1,!1,!1,null)};Z.Cod="NetworkAvailability";Z.Dod="NetworkAvailabilityData";Z.rGd="partialInteractivityData";Z.GIh=3E3;Object(pd.a)(Z,"OfflineModeTelemetryManager",null,[3]);ea.prototype.dispose=function(){zh.a.Fa(this.Exf);zh.a.Fa(this.NAd);zh.a.Fa(this.Jma);zh.a.Fa(this.I5g);this.$=null};Object(pd.a)(ea,"NetworkConnectionTelemetryManager",null,[3]);Am(O,ba);O.prototype.lab=function(){this.wasInteruptedByOfflineMode=
!0};Object(pd.a)(O,"SilentReopenData",ba,[]);Q.prototype.dispose=function(){this.yg.FUf(this.ODf);this.yg.uij(this.tHf);this.s8=this.yg=this.$=null};Q.prototype.qHf=function(Y,Ra){Y.tQ?this.s8=new O(Oc.a.Ra.Ob,this.$,0!==Y.mpa,Ra):(5===Y.mpa&&(this.s8.wasInteruptedByOfflineMode=!0),3!==Y.mpa&&2!==Y.mpa||jc.ULS.sendTraceTag(537155202,0,10,"SilentReopenPartialInteractivityTelemetryManager.OnSilentReopen: BackToWork/DuringWork partial interactivity has been swapped to DuringWork/BackToWork."),this.s8.uEd(this.$),
2===Ra?nd.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_8dtae_B2W")?Ke.b().nLb(571289604,0,50,aa.offline,this.s8.durationMs,this.s8):jc.ULS.sendTraceTag(571289604,0,50,Sg.a.Kc(this.s8)):nd.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_6w9lg_DuringWork")?Ke.b().nLb(542782150,0,50,aa.Lmh,this.s8.durationMs,this.s8):jc.ULS.sendTraceTag(542782150,0,50,Sg.a.Kc(this.s8)),this.s8=null)};Object(pd.a)(Q,"SilentReopenPartialInteractivityTelemetryManager",
null,[3]);var Lg=Td.a;Am(U,Lg);U.prototype.dispose=function(){this.tf&&(this.nzc&&(this.tf.thj(this.YFb),this.tf.sJb(this.sEf)),this.tf.fUf(this.Wzf),this.tf.egj(this.Xzf));this.zBb&&this.documentVisibilityObserver&&(this.documentVisibilityObserver.kJb(this.Dza),this.zBb=!1);this.$&&(this.fuc&&this.oDc(),this.$.ea&&(this.$.ea.WUf(this.sHf),this.$.ea.xf&&this.$.ea.xf.YAa(this.mda)));nd.EwaSettings.isChangeGateEnabled("OfficeVSO:5533387_ReportLongSilentReopenBackToWorkVeto")&&this.P1&&(this.P1.dispose(),
this.P1=null);zh.a.Fa(this.Ivf);this.$=null;Lg.prototype.dispose.call(this)};U.prototype.DDi=function(){this.XTd=!0};U.prototype.Yne=function(){this.Yoa||(this.Yoa=Tc.a(this.$).yg.IZa(3,"NetworkConnectionStateManager.ActivateDuringWorkSilentReopenPartialInteractivity"))};U.prototype.oki=function(){if(this.XTd)return this.XTd=!1,!0;var Y=this.B8>this.mrf||this.vod>this.mrf&&10>this.B8;jc.ULS.sendTraceTag(537155223,0,50,"NetworkConnectionStateManager.IsBackToWorkSilentReopen: Inactivity duration: Time from last activity:{0}, Time gap between last two activities: {1}. return value:{2}",
this.B8,this.vod,Y);return Y};U.prototype.Ikj=function(){nd.EwaSettings.isChangeGateEnabled("OfficeVSO:5533387_ReportLongSilentReopenBackToWorkVeto")&&(this.P1=Eh.a.instance.create(function(){cc.Health.instance.recordQosError(cb.a.GIj,[bc.a.Hlc],!0,!0,!1,!1,null)},6E3,"ReportLongSilentReopenBackToWorkVeto",void 0,!0))};U.prototype.GDg=function(){var Y=this;this.Yoa||this.z1?jc.ULS.sendTraceTag(542782155,0,10,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Trying to activate during-work partial interactivity when we are already in this partial interactivity or there is a running timer that's going to do it soon."):
this.z1=Eh.a.instance.create(function(){Y.$?Y.Yoa?jc.ULS.sendTraceTag(537155221,0,15,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Tried to activate SilentReopenDuringWork PI when there is already an DuringWorkSilentReopen partial interactivity object"):qf.g(Y.$).isEditing?(Y.ncb||(qf.g(Y.$).Ac.Wo(Y.Rg),jc.ULS.sendTraceTag(541893722,0,50,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Registered OnEditEnded while during-work silent reopen")),Y.ocb=
!0,jc.ULS.sendTraceTag(537155220,0,50,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Need to init during-work silent reopen partial interactivity but the user is during a cell edit. Registered to OnEditEnded event.")):Y.Yne():jc.ULS.sendTraceTag(537155222,0,50,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: EwaControl is null")},this.a9f,Xh.a.AHj,void 0,!0)};U.prototype.Duf=function(Y){this.U4c=this.rze(2,Y,!0);this.Mse()};U.prototype.unc=function(Y,
Ra){this.RXb=this.rze(Y,Ra,!1);this.Mse()};U.prototype.rze=function(Y,Ra,Db){Db=Db?this.U4c:this.RXb;return Ra?Db|Y:Db&~Y};U.prototype.fZd=function(){var Y=!!this.IPa,Ra=!!this.JTa,Db=!!this.Yoa,ec=!!this.h5b;this.zDb&&!Y?this.FDg():!this.zDb&&Y&&this.dgh();!this.tmc||Ra||Db?this.tmc||(Ra?this.dKe():(Db||this.z1&&this.z1.Ap)&&this.eKe()):this.f6f&&this.Aga?this.DDg():!this.BMb||this.Aga||nd.EwaSettings.isChangeGateEnabled("OfficeVSO:5658794_DontActivatePartialInteractivityIfTimerIsRunning")&&this.z1||
this.GDg();this.Ela&&!ec?this.edg(!0):!this.Ela&&ec&&this.edg(!1)};U.prototype.FDg=function(){this.$?this.IPa?jc.ULS.sendTraceTag(537155215,0,15,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: Tried to activate offline PI when there is already an offline partial interactivity object"):qf.g(this.$).isEditing?(this.ocb||(qf.g(this.$).Ac.Wo(this.Rg),jc.ULS.sendTraceTag(537155217,0,50,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: Registered OnEditEnded during offline mode")),
this.ncb=!0,jc.ULS.sendTraceTag(537155216,0,50,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: Turned offline while user is editing a cell, registered to OnEditEnded event.")):this.boe():jc.ULS.sendTraceTag(537155214,0,50,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: EwaControl is null")};U.prototype.boe=function(){this.IPa||(this.IPa=Tc.a(this.$).yg.IZa(5,"NetworkConnecStateManager.ActivateOfflinePartialInteractivity"))};U.prototype.dgh=function(){this.IPa&&
(zh.a.Fa(this.IPa),this.IPa=null)};U.prototype.dKe=function(){this.JTa&&(zh.a.Fa(this.JTa),this.JTa=null);nd.EwaSettings.isChangeGateEnabled("OfficeVSO:5533387_ReportLongSilentReopenBackToWorkVeto")&&this.P1&&this.P1.Ap&&this.P1.cancel();this.P1=null};U.prototype.eKe=function(){this.Yoa&&(zh.a.Fa(this.Yoa),this.Yoa=null);this.z1&&(zh.a.Fa(this.z1),this.z1=null);this.ocb&&!this.ncb&&qf.g(this.$).Ac.Zn(this.Rg);this.ocb=!1};U.prototype.DDg=function(){this.JTa||(this.JTa=Tc.a(this.$).yg.IZa(2,"NetworkConnectionStateManager.ActivateLongInactivitySilentReopenPartialInteractivity",
void 0,ef.a.instance.fa(2127)));this.Ikj()};U.prototype.edg=function(Y){Y?(this.h5b=Tc.a(this.$).yg.IZa(4,"NetworkConnectionStateManager.ConnectivityIssues"),this.b8i()):(zh.a.Fa(this.h5b),this.h5b=null)};U.prototype.b8i=function(){if(this.$&&this.$.na){var Y=this.$.na.ta.fc();Mc.jb(this.$.na.ta,null,null,null,Y)}};U.prototype.oDc=function(){eh.a(this.$).ER(Zf.a.sQa).er(this.DEf);this.$.Bl(this.vd);this.fuc=!1};U.prototype.Mse=function(){this.documentVisibilityObserver||jc.ULS.sendTraceTag(537155211,
0,15,"NetworkConnectionStateManager.AdjustPartialInteractivityStateWhenPossible: Document visibility observer is null while it shouldn't be.");this.documentVisibilityObserver&&this.documentVisibilityObserver.Hi?this.zBb||(this.documentVisibilityObserver.dpb(this.Dza),this.zBb=!0,jc.ULS.sendTraceTag(541193954,0,50,"NetworkConnectionStateManager.AdjustPartialInteractivityStateWhenPossible: tabbed out user, will update the partial interactivity state when the user will be back.")):this.fZd()};uk.Object.defineProperties(U.prototype,
{hmi:{configurable:!0,enumerable:!0,get:function(){return this.Aga}},zDb:{configurable:!0,enumerable:!0,get:function(){return!(this.RXb&1)}},tmc:{configurable:!0,enumerable:!0,get:function(){return!(this.RXb&2)}},Ela:{configurable:!0,enumerable:!0,get:function(){return!!(this.U4c&2)}}});Object(pd.a)(U,"NetworkConnectionStateManager",Td.a,[771,3]);var Mg=Ed.a;Am(H,Mg);H.prototype.create=function(){var Y=this;Hb.TaskExtensions.Ba(ah.GetServiceTaskFactory.Ua(this.$.da,395,396,this.ub),function(Ra){Y.Eb(Y.$.da.Aa(400)||
new U(Y.$,Ra.result))},this.$.la,3)};H.ka=function(Y){Y.da.Ha(401,new H(Y))};Object(pd.a)(H,"NetworkConnectionStateManagerFactory",Ed.a,[]);var ai=b(1436),Ug=b(1236);C.prototype.dispose=function(){this.Ifg();this.Qfg();this.Ivd=this.xvd=this.RL=this.xk=this.Lr=this.vtc=this.$=null;this.u2d=0};C.prototype.pSg=function(Y){this.RL=Y;this.xvd=Y.YLg;this.Ivd=Y.rbj};C.prototype.yJa=function(){if(this.RL){var Y=rf.K(this.RL.ODh);this.PIj(Y);this.hide();this.Ifg();this.RL=null}};C.prototype.PIj=function(Y){var Ra=
[1868184698,-1985798686,753331043,2137617149,237279923,1804571062,1766348718,42074747,-875588320,-958589048,-185374993];nd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartView.OnPasteEnabled",!1)&&Y&&(jc.ULS.sendTraceTag(523622037,0,50,"RecoveryUIController.SmartViewOnPaste: RecoveryUI is being dismissed."),null!=this.tCb&&Ra.includes(this.tCb.command)?(jc.ULS.sendTraceTag(526758984,306,50,"RecoveryUIController:dismissRecoveryUI Table hand raise is not triggered. Last command was {0}",
Ug.a[this.tCb.command]),this.tCb=null):this.documentHidden?(jc.ULS.sendTraceTag(523833603,306,50,"RecoveryUIController:dismissRecoveryUI Table hand raise is not triggered. User clicked outside of document."),this.documentHidden=!1):qf.g(this.$).Tb.i6(Y)?jc.ULS.sendTraceTag(526758983,306,50,"RecoveryUIController:dismissRecoveryUI Last paste was a table. Table hand raise is not triggered."):qf.g(this.$).Tb.Qla(Y)?jc.ULS.sendTraceTag(526758982,306,50,"RecoveryUIController:dismissRecoveryUI Last paste was a pivot table. Table hand raise is not triggered."):
(Ra=ld.d(this.$.xa.oa),Y=new mf.a(Y,Ra),this.YRj(Y)))};C.prototype.Lqi=function(){return!!this.RL&&this.vtc.cni};C.prototype.NGj=function(Y){this.RL?this.show(Y):jc.ULS.shipAssertTag(537154072,0,!1,"RecoveryUIController.ShowRecoveryUI: recoveryUI is null.")};C.prototype.sXh=function(){return this.RL?this.RL.Gwi:null};C.prototype.show=function(Y){var Ra=this.RL.gTh();Ra?(this.vtc.showFloatie(Object.assign(new ai.a,{x:Ra.x,y:Ra.y}),this.RL.hLa(),Y),this.Ik()):jc.ULS.sendTraceTag(537154071,0,100,"RecoveryUIController.Show: point is null.")};
C.prototype.hide=function(){this.Lqi()&&this.vtc.XC();this.Qfg()};C.prototype.Ik=function(){if(!this.r8b){var Y=qf.g(this.$);Y.view.nt(this.Ohg);Y.Uj.wl(this.mMe);this.xk.ka("blur",this.$jh);this.$.Ka.HGa(this.z0);this.$.xa.Nf(this.nMe);(Y=this.$.da.Aa(65))&&Y.d4&&Y.d4.registerForCommentEvents(this.lMe);this.r8b=!0}this.Pfc||(this.Lr.Mt(vh.a.Ub,this.$.domElement,this.onKeyDown,!0),this.Lr.Mt(vh.a.Td,this.$.domElement,this.onKeyUp,!0),this.Pfc=!0)};C.prototype.Ifg=function(){if(this.r8b){var Y=qf.g(this.$);
Y.view.fr(this.Ohg);Y.Uj.$k(this.mMe);this.xk.detach("blur");this.$.Ka.NRa(this.z0);this.$.xa.Ag(this.nMe);(Y=this.$.da.Aa(65))&&Y.d4&&Y.d4.unregisterForCommentEvents(this.lMe);this.r8b=!1}};C.prototype.Qfg=function(){this.Pfc&&(this.Lr.Rt(vh.a.Ub,this.$.domElement,this.onKeyDown,!0),this.Lr.Rt(vh.a.Td,this.$.domElement,this.onKeyUp,!0),this.Pfc=this.c0=this.W$b=!1)};C.prototype.jYj=function(){this.RL&&250<=Oc.a.Ra.ke.m-this.u2d&&this.show(-1)};C.prototype.YRj=function(Y){Hb.TaskExtensions.Ba(ah.GetServiceTaskFactory.Ua(this.$.da,
426,427,1),function(Ra){Ra.result.ifa(Y,"Paste");jc.ULS.sendTraceTag(523622036,0,50,"RecoveryUIController.triggerTableInvitationHandRaise: IntelligentMetadataOverlayManager is triggered.")},this.$.la,3)};Object(pd.a)(C,"RecoveryUIController",null,[768,3]);var nh=Ed.a;Am(E,nh);E.prototype.create=function(){var Y=this;if(nd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ServiceInit",!1))this.cIi();else{var Ra=this.$;Ra.gD(function(Db){Db.Ogc().then(function(ec){Y.Eb(Y.$.da.Aa(406)||new C(Ra,
ec,Gg.KeyInputManager.instance,Tg.a.instance.TC()))})})}};E.prototype.cIi=function(){var Y=this,Ra=this.$,Db=this.$.da.Aa(406);Db?this.Eb(Db):Ra.gD(function(ec){ec.Ogc().then(function(gd){Db=new C(Ra,gd,Gg.KeyInputManager.instance,Tg.a.instance.TC());Y.$.da.Ha(406,Db);Y.Eb(Db)})})};E.ka=function(Y){Y.da.Ha(405,new E(Y))};Object(pd.a)(E,"RecoveryUIControllerFactory",Ed.a,[]);var Og=b(732),Ei=b(610),Vh=b(41),Xi=b(1253),yj=sa.a;Am(t,yj);t.prototype.validate=function(){this.Oj.yF||jc.ULS.sendTraceTag(25798091,
322,10,"UploadFrame.FileInputElement is null");return this.Oj.yF.value?!0:(t.lA(CommonUIStrings.l_FileUploadNoFileSpecified),!1)};t.prototype.bQi=function(Y){this.Izg&&(this.Oj=this.z4f(Y,this.eZb))};t.prototype.pZi=function(){this.Oj&&this.Oj.yF&&(this.T9d||(this.Oj.edj(Object(za.a)(this,this.qDd,"onFileChosen")),this.T9d=!0),this.Oj.MWe())};t.prototype.qDd=function(Y){this.DYa.uploadStatusLabel=Y;this.ODc(this.titleText,Object(za.a)(this,this.fhc,"insertDialogHandler"),this.DYa)};t.prototype.fhc=
function(Y){1===Y&&this.isEnabled()?t.Yy&&this.Oj.yF&&!this.Oj.yF.value?(this.DYa.uploadStatusLabel=CommonUIStrings.l_FileUploadNoFileSpecified,this.ODc(this.titleText,Object(za.a)(this,this.fhc,"insertDialogHandler"),this.DYa)):(this.bzb(),this.eZb.finalizeUpload(this.Oj,Object(za.a)(this,this.dispose,"dispose"))):0===Y&&this.hide()};t.prototype.A4f=function(){this.OKc=!1;this.Oj=this.z4f(document.getElementById("uploadFrameContainer"),this.eZb);Lc.AFrameworkApplication.ha.ra("InsertPictureDialogFocusLoopFixIsEnabled")&&
(this.uha=Object(za.a)(this,this.oFd,"onUploadFrameLoad"),Vh.a.addHandler(this.Oj.iFrame,"load",this.uha));this.Oj.yF||jc.ULS.sendTraceTag(25798092,322,15,"UploadFrame.FileInputElement is null");this.ENf()};t.prototype.oFd=function(){this.ENf()};t.prototype.ENf=function(){if(this.Oj&&!this.OKc){var Y=this.Oj.yF;Y&&(Vh.a.addHandler(Y,vh.a.Ub,Object(za.a)(this,this.onKeyDown,"onKeyDown")),Y=[Y],this.en=Y.concat.apply(Y,this.en),this.yhg(),this.OKc=!0)}};t.prototype.dispose=function(){if(this.Oj&&!t.Yy){var Y=
this.Oj.yF;Y&&Vh.a.removeHandler(Y,vh.a.Ub,Object(za.a)(this,this.onKeyDown,"onKeyDown"));this.uha&&Vh.a.removeHandler(this.Oj.iFrame,"load",this.uha)}this.Oj=null;yj.prototype.dispose.call(this)};t.prototype.yhg=function(){if(0<this.en.length){var Y=new Xi.a(this.en),Ra=Yc.FocusManager.instance().IR();Ra&&(this.en[0].focus(),Ra.kf=Y,Ra.l0=!0)}};t.prototype.onKeyDown=function(Y){4!==Yc.FocusManager.instance().GNf(Y)&&Y.preventDefault()};t.lA=function(Y){var Ra=document.getElementById("errorText");
Ra.innerText=Y;Ra.style.display="inline-block"};uk.Object.defineProperties(t.prototype,{HZj:{configurable:!0,enumerable:!0,get:function(){return this.eZb}}});uk.Object.defineProperties(t,{Yy:{configurable:!0,enumerable:!0,get:function(){return Lc.AFrameworkApplication.sa.Qa.Tw&&Lc.AFrameworkApplication.sa.Qa.ikf}}});Object(pd.a)(t,"InsertFileDialog",sa.a,[]);uk.Object.defineProperties(A,{ig:{configurable:!0,enumerable:!0,get:function(){return sa.a.Qn(A.fk,CommonUIStrings.l_ImageUploadDialogText,CommonUIStrings.l_ImageUploadNoFileSpecified)}}});
A.fk="<div class='WACDialogRow' id='block1'> <label id='labelText' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRowNoBreak' id='block2'> <div id='uploadFrameContainer'></div> <div class='WACDialogError' id='errorText' role='alert'>{1}</div> </div>";Object(pd.a)(A,"InsertImageDialogHtml",null,[]);Am(v,t);v.prototype.validate=function(){this.Oj.yF||jc.ULS.sendTraceTag(25798095,322,10,"UploadFrame.FileInputElement is null");var Y=Object(Mb.a)(rb,this.HZj),Ra=Y.qjg(this.Oj.yF.value);
return 0!==Ra?(t.lA(Y.j2e(Ra)),!1):!0};uk.Object.defineProperties(v.prototype,{BZb:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_ImageUploadButtonText}},titleText:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_ImageUploadingTitle}},ajh:{configurable:!0,enumerable:!0,get:function(){return A.ig}}});Object(pd.a)(v,"InsertImageDialog",t,[]);var yi=b(616),Hg=b(202),ni=b(495);B.prototype.mef=function(){this.rE=le.a.create().toString();this.Tra?this.kad():
this.tue()};B.prototype.C8g=function(Y){this.io=document.createElement("iframe");this.io.className=Y;this.io.id=Y;this.z$d&&(this.io.style.visibility="visible",this.io.style.height="30px",this.io.setAttribute("frameborder","0"));this.uha=Object(za.a)(this,this.oFd,"onUploadFrameLoad");Vh.a.addHandler(this.io,"load",this.uha)};B.prototype.L8b=function(Y){var Ra=this;Y=void 0===Y?null:Y;Lc.AFrameworkApplication.sa.Csc();if(!this.qr)return jc.ULS.sendTraceTag(25798093,322,50,"_fileInput is null"),"";
Vh.a.addHandler(this.qr,"change",function(){Ra.wFh(Y)});y(Object(za.a)(this,this.MWe,"fileInputClick"),1,"DoFileOpenDialog");return this.qr.value};B.prototype.wFh=function(Y){Y&&Y(this.qr.value)};B.prototype.xFh=function(){this.$Tb&&(this.$Tb.innerText=this.x3e())};B.prototype.edj=function(Y){var Ra=this;Vh.a.addHandler(this.qr,"change",function(){Y(Ra.x3e())})};B.prototype.x3e=function(){var Y=null;if(this.qr.value){var Ra=this.qr.value,Db=Ra.lastIndexOf("\\");0<Db&&(Y=Ra.substring(Db+1,Ra.length))}return Y?
Y:""};B.prototype.MWe=function(){try{jc.ULS.sendTraceTag(35939520,322,50,"UploadFrame.FileInputClick - Clicking on File input element."),this.qr.click()}catch(Y){throw jc.ULS.sendTraceTag(36783331,322,10,"UploadFrame.FileInputClick Exception: {0}",Y.message),Y;}};B.prototype.PLj=function(){this.Jri()?this.wag():(this.d1d(),this.dt.submit())};B.prototype.Jri=function(){return(this.Kug||this.Tra)&&!(void 0===window.self.FormData||null===window.self.FormData)};B.prototype.N0f=function(Y){if(Y){var Ra=
this.HGe();this.Tg=new XMLHttpRequest;this.Tg.open("POST",Ra);this.Tg.setRequestHeader("X-CorrelationId",this.rE);this.Ezi(Y);this.Tg.onreadystatechange=Object(za.a)(this,this.Tpa,"uploadResponseReceived");this.Tg.send(Y)}};B.prototype.Ezi=function(Y){if(!xd.a.FB&&Y.get){var Ra=Y.get("ImageId");Y=window.self.navigator;var Db={};Ra=(Db.CorrelationId=this.rE,Db.Canary=Lc.AFrameworkApplication.canary,Db.ImageNodeId=Ra,Db);Y&&(Y=Y.connection?Y.connection:Y.mozConnection?Y.mozConnection:Y.webkitConnection?
Y.webkitConnection:null)&&(Ra.effectiveType=Y.effectiveType,Ra.downlink=Y.downlink,Ra.type=Y.type,Ra.rtt=Y.rtt);jc.ULS.sendTraceTag(573345858,322,50,"LogFileUploadStatistics: FileUpload {0}",Ra)}};B.prototype.wag=function(){try{this.d1d();jc.ULS.sendTraceTag(594888409,322,50,"SubmitFormWithRequest is preparing to send an upload request");var Y=new (Type.parse("FormData"))(this.dt);this.N0f(Y)}catch(Ra){jc.ULS.sendTraceTag(594888407,322,10,"SubmitFormWithRequest failed to send the request with exception "+
Ra.message),this.yab(null)}};B.prototype.vag=function(Y){try{if(this.d1d(),jc.ULS.sendTraceTag(594888406,322,50,"SubmitFormWithBlob is preparing to send an upload request"),this.S_j(Y)){this.aUb=Y;this.dt.contains(this.qr)&&this.dt.removeChild(this.qr);var Ra=new (Type.parse("FormData"))(this.dt);Ra.append("applicationfileInput",Y.blob,Y.filename);this.N0f(Ra)}else this.yab(null)}catch(Db){jc.ULS.sendTraceTag(591267743,322,10,"SubmitFormWithBlob failed to send the request with exception "+Db.message),
this.yab(null)}};B.prototype.S_j=function(Y){return Y&&void 0!==Y.blob&&null!==Y.blob&&void 0!==Y.filename&&null!==Y.filename&&""!==Y.filename?void 0===window.self.FormData||null===window.self.FormData?(jc.ULS.sendTraceTag(578380442,322,10,"FormData isn't supported"),!1):!0:(Y=Y?String.format("[isNull: false] [blobIsNullorEmpty: {0}] [filenameIsNullOrEmpty: {1}]",void 0===Y.blob||null===Y.blob,void 0===Y.filename||null===Y.filename||""===Y.filename):"[isNull: true] [blobIsNullorEmpty: false] [filenameIsNullOrEmpty: false]",
jc.ULS.sendTraceTag(578380441,322,10,String.format("Content of the blob is empty {0}",Y)),!1)};B.prototype.Tpa=function(){if(4===this.Tg.readyState)if(200===this.Tg.status){jc.ULS.sendTraceTag(594888405,322,50,"UploadResponseReceived received a successful response. CorrelationId: {0}",this.rE);var Y=this.Tg.getResponseHeader("X-NewKey"),Ra=this.Qki(this.Tg),Db=!1;if(void 0!==Y&&null!==Y&&Ra&&(Db=this.H_j(Y),!this.lVc&&Db)){jc.ULS.sendTraceTag(594888404,322,50,"UploadResponseReceived resubmitting the upload request with a fresh canary. correlationId: {0}",
this.rE);this.lVc=!0;void 0!==this.aUb&&null!==this.aUb?this.vag(this.aUb):this.wag();return}jc.ULS.sendTraceTag(594888403,322,50,"UploadResponseReceived processing the response [retried: {0}] [canaryInvalid: {1}] [gotNewCanary: {2}] [canaryRenewed: {3}] [CorrelationId: {4}]",this.lVc,Ra,!(void 0===Y||null===Y),Db,this.rE);this.yab(this.Tg.responseText)}else jc.ULS.sendTraceTag(42874946,322,15,"Upload request failed with status: {0} [isResponseNull: {1}] [correlationId: {2}]",this.Tg.status,this.Tg.responseText?
!1:!0,this.rE),this.yab(null)};B.prototype.Qki=function(Y){try{var Ra=Af.a(Y.responseText).Responses;if(void 0!==Ra&&null!==Ra&&1===Ra.length){var Db=Ra[0];if(void 0!==Db&&null!==Db&&2===Db.length&&28===Db[1].StatusCode)return!0}}catch(ec){}return!1};B.prototype.H_j=function(Y){ni.a.Agg(Y);return Lc.AFrameworkApplication.canary!==Y?!1:!0};B.prototype.d1d=function(){this.mVc||(this.mVc=new Date)};B.prototype.dispose=function(){this.Cm||(this.Tra?this._parent.removeChild(this.dt):(this._parent.removeChild(this.io),
Vh.a.removeHandler(this.io,"load",this.uha),this.uha=null),this.NKc&&(Vh.a.removeHandler(this.qr,"change",this.NKc),this.NKc=null),this.NWe&&(this.Xjb&&(Vh.a.removeHandler(this.qr,"change",this.Xjb),this.Xjb=null),this.$Tb=null),this.qr=this.dt=this._parent=this.io=null,this.Cm=!0,this.mVc=null,jc.ULS.sendTraceTag(25798094,322,50,"UploadFrame disposed"))};B.prototype.delayedDispose=function(){this.dispose()};B.prototype.gah=function(Y){if(this.dt){var Ra;(Ra=this.dt.querySelector("input[name=__REQUESTDIGEST]"))?
Ra.value=Y:(Ra=this.D6c(),Ra.type="hidden",Ra.id="__REQUESTDIGEST",Ra.name="__REQUESTDIGEST",Ra.value=Y,this.dt.appendChild(Ra))}};B.prototype.D6c=function(){return this.Tra?document.createElement("input"):this.io.contentWindow.document.createElement("input")};B.prototype.oFd=function(){try{if(!this.io.contentWindow.document.body)return}catch(ec){this.e$h();return}if(!(this._initialized||this.m$a&&xd.a.aG))this.kad();else if(!this.m$a||!xd.a.aG||this.Joi){var Y=xd.a.uf?this.io.contentWindow.document.body.innerText:
this.Mig?this.io.contentWindow.document.body.firstChild.innerText:this.io.contentWindow.document.body.firstChild.innerHTML;var Ra=this.io.contentWindow.document.body.innerText.toLowerCase(),Db=0<=Ra.indexOf("responses")||0<=Ra.indexOf("wopisrc");Ra=0<=Ra.indexOf("http error");!Db&&Ra&&jc.ULS.sendTraceTag(42551183,322,15,"Couldn't obtain a valid response but the frame contains: "+this.io.contentWindow.document.body.innerText);this.yab(Y)}};B.prototype.kad=function(){if(!this._initialized){var Y=this.fa("uploadForm"),
Ra=this.fa("fileInput"),Db=this.HGe();this.N$g();this.dt.id=Y;this.dt.method="post";this.dt.encoding="multipart/form-data";this.dt.action=Db;this.qr.type="file";this.u4d&&(this.qr.accept=this.u4d,this.t6d&&(this.qr.capture=this.t6d));this.qr.id=Ra;this.qr.name=Ra;this.eNg&&(this.qr.multiple=!0);!this.NWe||xd.a.uf||xd.a.lI||(this.Xjb=Object(za.a)(this,this.xFh,"fileInputChangedHandleAccessibility"),Vh.a.addHandler(this.qr,"change",this.Xjb),this.$Tb=wb.a.pue(this.dt,this.qr,"InputFileDescription"));
this.z$d&&(this.Tra||(Y=this.io.contentWindow.document.body,Y.style.margin="0",Y.style.overflow="hidden"),Y=Lc.AFrameworkApplication.sa,this.qr.style.fontFamily=Y.T1,this.qr.style.fontSize=Y.dDc,this.qr.style.margin="0");(Y=document.getElementById("__REQUESTDIGEST"))&&this.gah(Y.value);this.dt.appendChild(this.qr);this._initialized=!0;this.qug(this)}};B.prototype.N$g=function(){if(this.Tra)this.dt=document.createElement("form"),this._parent.appendChild(this.dt),this.qr=document.createElement("input");
else{this.dt=this.io.contentWindow.document.createElement("form");var Y=this.io.contentWindow.document;Y.body.appendChild(this.dt);this.qr=Y.createElement("input")}};B.prototype.tue=function(){this._parent.appendChild(this.io);this.m$a&&xd.a.aG&&this.kad()};B.prototype.HGe=function(){var Y=new Gc.QueryStringBuilder(this.SWe);Lc.AFrameworkApplication.Kob(Y);this.auj(Y);Y=Y.toString();if(xd.a.Hf||xd.a.aG||xd.a.lI)Y=bg.a.y_e(Y);return Y};B.prototype.mpe=function(){var Y=new Ah.a(2,1,0,Object(za.a)(this,
this.delayedDispose,"delayedDispose"),4);Lc.AFrameworkApplication.Yi.$g(Y)};uk.Object.defineProperties(B.prototype,{KXf:{configurable:!0,enumerable:!0,get:function(){return this.Uyg}},sessionId:{configurable:!0,enumerable:!0,get:function(){return this.jTc}},iFrame:{configurable:!0,enumerable:!0,get:function(){return this.io}},yF:{configurable:!0,enumerable:!0,get:function(){return this.qr}},m$a:{configurable:!0,enumerable:!0,get:function(){return Lc.AFrameworkApplication.ha?Lc.AFrameworkApplication.ha.ra("NativeFileOpenDialogIsEnabled"):
!1}},NWe:{configurable:!0,enumerable:!0,get:function(){return Lc.AFrameworkApplication.ha?Lc.AFrameworkApplication.ha.ra("FileInputDescriptionAccessibilityIsEnabled"):!1}},Joi:{configurable:!0,enumerable:!0,get:function(){return this.Tra?!1:Hg.a(this.io.contentWindow.location.pathname,this.SWe,0)}},eNg:{configurable:!0,enumerable:!0,get:function(){return!xd.a.FB&&Lc.AFrameworkApplication.ha.ra("AllowMultipleImageInsertFromLocalDevice")}}});Object(pd.a)(B,"UploadFrame",null,[3]);Am(r,B);r.prototype.fa=
function(Y){return Y};r.prototype.auj=function(Y){jc.ULS.shipAssertTag(526399105,0,!!this.sessionId,"SessionId shouldn't be null.");Sd.a.eZc(Y,this.$.ya);Y.x$(Fe.a.sessionId,this.sessionId);var Ra=qf.g(this.$).ga;Ra=rf.o(Ra.va.g5,this.$);Y.x$(Fe.a.U7i,this.$.xa.oa.name);Y.x$(Fe.a.T7i,Ra.FirstRow.toString());Y.x$(Fe.a.S7i,Ra.FirstColumn.toString())};r.prototype.e$h=function(){this.KXf("ServerUploadError")};r.prototype.yab=function(Y){this.KXf(Y)};r.Pmi=function(Y){return!Y||sf.a.equals(Y,"ServerUploadError",
!1)};Object(pd.a)(r,"UploadFrameWrapper",B,[]);Am(w,v);w.prototype.z4f=function(Y,Ra){return new r(Y,Object(za.a)(Ra,Ra.CGb,"onUploadFrameInitialized"),Object(za.a)(Ra,Ra.Tpa,"uploadResponseReceived"),this.ha,!0,this.$)};w.prototype.dispose=function(){this.rDc();this.YR=this.yEc=null;v.prototype.dispose.call(this)};w.prototype.hide=function(){v.prototype.hide.call(this);this.$.yb.Tz=!1};w.prototype.validate=function(){var Y=this.yEc.P1d(this.Oj.yF.value,this.yEc.weg(this.Oj));return 0!==Y?(Y=this.yEc.mhd(Y).Description,
this.r0d(Y),this.oXd(),!1):!0};w.prototype.isEnabled=function(){return!0};w.prototype.r0d=function(Y){this.OV.innerHTML=Y};w.prototype.bpd=function(){this.OV=document.getElementById("errorText");this.OV.style.display="inline-block";this.eCa=!1;this.r0d("");this.rJa.style.maxWidth=this.rJa.currentStyle.minWidth};w.prototype.oXd=function(){this.YR.qa(vh.a.click,this.Oj.yF,this.cpc);this.YR.qa(vh.a.Ub,this.Oj.yF,this.cpc);this.eCa=!0};w.prototype.rDc=function(){this.eCa&&(this.YR.za(vh.a.click,this.Oj.yF,
this.cpc),this.YR.za(vh.a.Ub,this.Oj.yF,this.cpc),this.eCa=!1)};Object(pd.a)(w,"InsertImageDialogWrapper",v,[]);Am(u,rb);u.prototype.dispose=function(){zh.a.Fa(this.O1b);this.Oj&&this.Oj.mpe();this.Oj=this.O1b=this.wb=null};u.prototype.laj=function(Y){function Ra(){ec.sx(!0)}var Db=this;if(!this.$)return jc.ULS.sendTraceTag(526399119,0,50,"ReadPictureAsDataURLTask: EwaControl is null"),Eg.Task.Sa(!0);if(!this.$.lca)return Eg.Task.Sa(!0);var ec=new Jg.a,gd=new FileReader;Y=Y.yF.files[0];gd.onload=
function(){Db.QGd=gd.result;ec.sx(!0)};gd.onerror=Ra;gd.onabort=Ra;gd.readAsDataURL(Y);return ec.task};u.prototype.weg=function(Y){var Ra=-1;Y=Y.yF;(null===Y||void 0===Y?0:Y.files)&&0<Y.files.length&&(Ra=Y.files[0].size);return Ra};u.prototype.P1d=function(Y,Ra){var Db=u.z7g(rb.UCa(Y));0===Db?-1!==Ra&&(jc.ULS.sendTraceTag(526399118,0,50,"Validating picture, pictureSize: {0}, maxAllowedSize: {1}, remainingWorkbookSize: {2}",Ra,this.Umc,this.$.ea.Onf),Ra>this.Umc?Db=3:Ra>this.$.ea.Onf&&(Db=7)):6===
Db&&this.ABi(Y);jc.ULS.sendTraceTag(526399117,0,50,"Validated file on client, validation result: {0}",Db);return Db};u.prototype.UCa=function(Y,Ra){Y=this.P1d(Y,this.weg(Ra));return 0!==Y?(this.N2a||1===Y||this.$Ud(Y),!1):!0};u.prototype.Udg=function(Y){Y.PLj()};u.prototype.mhd=function(Y){var Ra=0,Db=1,ec=-1100324317,gd="InsertPictureUnknownError",Jd=null;switch(Y){case 1:Ra=1708;Db=0;ec=940870981;gd="InsertPictureNoFileSelected";break;case 3:Db=0;ec=1250467391;gd="InsertPicturePictureTooBig";Jd=
String.format(ef.a.instance.Bb(171),this.NDi.toLocaleString());break;case 6:Ra=1712;Db=0;ec=1380041209;gd="InsertPictureUnsupportedFormat";break;case 7:Ra=1709;Db=0;ec=-903115058;gd="InsertPictureExceedWorkbookSize";break;case 4:Ra=1710;Db=0;ec=1218352119;gd="InsertPictureUploadTimeout";break;case 5:Ra=1711,Db=0,ec=1979899005,gd="InsertPictureServiceNonDeterministicError"}Y=u.ed(Ra,Db,ec,gd);Jd&&(Y.Description=Jd);return Y};u.prototype.showDialog=function(){this.Vze()?(this.N2a=!1,this.Oj=new r(this.$.domElement,
this.CGb,this.Tpa,this.ha,!1,this.$,!0)):(jc.ULS.sendTraceTag(526399115,0,50,"Showing Insert Picture dialog"),!this.J8a&&(xd.a.vv||xd.a.aG&&72>xd.a.iCe)?(this.N2a=!1,this.Oj=new r(this.$.domElement,this.CGb,this.Tpa,this.ha,!1,this.$)):(this.N2a=!0,this.Oj=(new w(this,this.$,this.ha)).Oj))};u.prototype.R9h=function(Y){var Ra={};try{if(Ra=Sg.a.ui(Y),Ke.b().xC(this.H2d.id,Ra.ServerCorrelationId,"actions","ServerActions"),!Fd.a.vh(Ra.Errors)&&Ra.Result){this.$.ea.oY(Ra.StateId,"BasePictureUploaderWrapper.UploadResponseReceived");
var Db=Ra.Result;Xg.a(this.$).soa(1,Db);var ec=this.$.da.Aa(277);ec&&ec.YWc(this.$,1,Ra.Result,Ra,"InsertPicture");jc.ULS.sendTraceTag(526399114,0,50,"Insert picture completed successfully :)")}}catch(gd){jc.ULS.sendTraceTag(526399113,0,50,"BasePictureUploaderWrapper.HandleSuccessCallback: got exception while try to JSON.Parse string length: {0}, errror: {1}",Y?Y.length:-1,gd)}this.TCc(Ra,null,"InsertPictureWebMethod")};u.prototype.L9e=function(Y){Y={Errors:[this.mhd(Y)]};this.TCc(Y,null,"InsertPictureWebMethod")};
u.prototype.TCc=function(Y,Ra,Db){this.Ur(Y,Ra,Db)};u.prototype.VZd=function(Y,Ra,Db){this.fba(Y,Ra,Db)};u.prototype.$Ud=function(Y){Y=this.mhd(Y);nd.EwaSettings.Rz()?new Bd.a(this.$,Y):(new Dc.ErrorDialog(this.$,Y)).pf()};u.prototype.ABi=function(Y){var Ra=this.$.ya.InsertPicturUnsupportedExtensionsForLogging;Y=Ee.a.Yl(Y);for(var Db=0;Db<Ra.length;++Db)if(Y.endsWith(Ra[Db])){jc.ULS.sendTraceTag(526399112,0,50,"Insert picture blocked invalid extension: {0}",Ra[Db]);break}};u.W_j=function(Y){return!Y||
sf.a.equals(Y,Fe.a.insertPictureUnknownError,!0)?2:sf.a.equals(Y,Fe.a.insertPictureNoFileSelectedError,!0)?1:sf.a.equals(Y,Fe.a.Ehi,!0)?3:sf.a.equals(Y,Fe.a.Fhi,!0)?5:0};u.ed=function(Y,Ra,Db,ec){return Fd.a.ed(1,0,0,Y,Ra,Db,ec)};u.z7g=function(Y){switch(Y){case 1:return 1;case 2:return 6}return 0};u.prototype.Vze=function(){return nd.EwaSettings.isChangeGateEnabled("OfficeVSO:5329840_InsertPictureOpenFileBrowserDirectly")&&!this.J8a&&void 0!==window.self.FormData&&null!==window.self.FormData?!0:
!1};uk.Object.defineProperties(u.prototype,{$:{configurable:!0,enumerable:!0,get:function(){return this.wb}},NDi:{configurable:!0,enumerable:!0,get:function(){return this.Umc/1024/1024}}});Object(pd.a)(u,"BasePictureUploaderWrapper",rb,[3]);Am(h,u);h.prototype.mFj=function(){this.Umc=28E5;this.$Ud(3)};h.prototype.Edd=function(Y){var Ra=this;jc.ULS.sendTraceTag(526399111,0,50,"FileReaderUploaderWrapper.finalizeUploadImpl - Start function.");var Db=new FileReader;Y=Y.yF.files;if(0==Y.length)jc.ULS.sendTraceTag(526399110,
0,15,"FileReaderUploaderWrapper.finalizeUploadImpl - No image file found.");else{var ec=Y[0];Db.onload=function(){Ra.wac.stop();Ra.CFh.eYi(Db.result,Ra);jc.ULS.sendTraceTag(526399109,0,50,"FileReaderUploaderWrapper.finalizeUploadImpl - End function. Type:{0}, Size:{1}",ec.type,ec.size.toString())};Db.onerror=function(){Ra.wac.stop();jc.ULS.sendTraceTag(526399108,0,10,"FileReaderUploaderWrapper.finalizeUploadImpl - Can't read image. Type:{0}, Size:{1}",ec.type,ec.size.toString())};Db.onabort=function(){Ra.wac.stop();
jc.ULS.sendTraceTag(526399107,0,10,"FileReaderUploaderWrapper.finalizeUploadImpl - Aborted read image. Type:{0}, Size:{1}",ec.type,ec.size.toString())};this.wac.start();Db.readAsDataURL(ec)}};h.prototype.finalizeUpload=function(Y,Ra){this.Edd(Y,Ra)};Object(pd.a)(h,"FileReaderUploaderWrapper",u,[830]);n.prototype.getSheetName=function(){return this.sheetName};Object(pd.a)(n,"MacroRecorderPictureInsertedPayload",null,[428]);Am(m,u);m.prototype.Edd=function(Y,Ra){var Db=this;u.prototype.finalizeUpload.call(this,
Y,Ra);ud.a(this.$.userOperationManager,function(ec,gd){Db.Ur=ec;Db.fba=gd;Db.H2d.start();Db.O1b.hr();Db.tCc=!1;Db.Udg(Y);return Db.laj(Y)},function(ec){function gd(){return new n(Xd,Db.QGd?Db.QGd:"")}var Jd={};Db.$.Jj(Jd);var Xd=Jd.SheetName;ec=nd.EwaSettings.uc()?new af.a(510,0,ec,72,gd):new tf.a(510,0,ec,8,gd);ec.FBa(function(){return!0});ec.Xd=Db.Xd;return ec},this.Xd)};m.prototype.finalizeUpload=function(Y,Ra){this.Edd(Y,Ra)};Object(pd.a)(m,"PictureUploaderWrapper",u,[]);Object(pd.a)(l,"UploadBlobParameters",
null,[]);Am(e,m);e.prototype.VZd=function(Y,Ra,Db){m.prototype.VZd.call(this,Y,Ra,Db);this.K1.setException(Error.create("DataUrlUploaderWrapper.TriggerFailedCallback: File upload request failed"))};e.prototype.TCc=function(Y,Ra,Db){m.prototype.TCc.call(this,Y,Ra,Db);Fd.a.vh(Y.Errors)?this.K1.setException(Error.create(String.format("DataUrlUploaderWrapper.TriggerSuccessCallback: File upload request returned with errors: {0}",Fd.a.Wc(Y.Errors)))):this.K1.setResult(!0)};e.prototype.Udg=function(Y){var Ra=
new l(this.Agc.name,this.Agc);Y.vag(Ra)};e.JLh=function(Y){var Ra=Y.split(",");Y=Ra[0].includes("base64")?window.self.atob(Ra[1]):window.self.decodeURI(Ra[1]);Ra=Ra[0].split(":")[1].split(";")[0];for(var Db=new Uint8Array(Y.length),ec=0;ec<Y.length;ec++)Db[ec]=Y.charCodeAt(ec);Y=new Blob([Db],{type:Ra});Y.name="Image.png";return Y};Object(pd.a)(e,"DataUrlUploaderWrapper",m,[]);c.prototype.jgi=function(Y,Ra,Db,ec,gd){new m(Y,Ra,Db,ec,gd,!0)};c.prototype.ifi=function(Y,Ra,Db,ec,gd,Jd){new e(Y,null,
Ra,Db,ec,gd,Jd)};c.prototype.ufi=function(Y,Ra,Db,ec,gd){new h(Y,Ra,Db,ec,gd,!0)};Object(pd.a)(c,"UploaderCreator",null,[770]);var jj=Ed.a;Am(a,jj);a.ka=function(Y){Y.da.Ha(485,new a(Y))};a.prototype.create=function(){var Y;this.Eb(null!==(Y=this.$.da.Aa(484))&&void 0!==Y?Y:this.$.da.Ha(484,new c))};Object(pd.a)(a,"UploaderCreatorFactory",Ed.a,[]);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.InsertPicture");Type.registerNamespace("_Ewa");Type.registerNamespace("Common");Type.registerNamespace("Common.App.ApplicationFeatureHelper");
jd.main();Type.registerNamespace("Common.App.InProductMessaging");yd.main();Type.registerNamespace("Common.App.FirstRunExperienceLauncher");Hf.main();Type.registerNamespace("Common.App.InsertFile");Type.registerNamespace("Common.App.InsertPicture");(function(){Nh.a.Ga(function(Y){nc.ka(Y)})})();(function(){Nh.a.Ga(function(Y){Hc.ka(Y)})})();(function(){Nh.a.Ga(function(){Nh.a.Ga(jb.ka)})})();(function(){Nh.a.Ga(function(){Nh.a.Ga(Va.ka)})})();(function(){Nh.a.Ga(function(Y){wc.ka(Y)})})();Di.a.Ti(".insert-media-dialog-old{width:870px;float:left;margin-top:7px}.insert-media-dialog{width:870px;width:clamp(400px,870px,80vw);float:left;margin-top:7px}.app-rtl .insert-media-dialog{float:right}.insert-media-frame{width:100%;height:100%;visibility:visible}.insert-media-panel-old{height:550px}.insert-media-panel{height:550px;height:clamp(300px,550px,90vh)}.keep-focus-start{position:absolute;width:-1000px;top:-1000px}.keep-focus{position:absolute;width:-1000px;top:1000px}.display-none{display:none}.padding-zero{padding:0}");
Nh.a.Ga(ka.ka);Nh.a.Ga(H.ka);(function(){Nh.a.Ga(function(Y){E.ka(Y)})})();(function(){Nh.a.Ga(function(Y){a.ka(Y)})})()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.pi.js.map/d40ceddc9ad75fdda87459d73aa0e7ba/EwaDS.pi.js.map