(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[6],{1014:function(z,F,b){function a(Ja,Da,ib,Rb,wc,Cb,lb,yb,pc,Ta,rb,ic){this.cUc=!1;this.r9=null;this.gH=new ka.a;this.Yib=1;this.bQ=null;this.Ut=!1;this.HOc=(new Date(0)).getTime();this.Tke=0;this._clientId=Ja;this.YYb=Da;this.EM=0;this.Ih=Rb;this.iJc=yb;this.qzg=lb;this.iog=pc;this.Lqg=wc;this.wqa=Cb;this.Zl=ib;this.Xp=Ta;this.Ee=rb;this.Yg=ic;this.pAg=1>100*Math.random()}function c(Ja){return Ja?Ja.charAt(0).toLocaleUpperCase()+
Ja.substring(1,Ja.length):Ja}function e(Ja,Da,ib){return String.format("ClientID={0}, App={1}, ClientType={2}, SessionId={3}",Ja,c(pa[ib]),c("browser"),Da)}function l(Ja,Da,ib,Rb,wc,Cb,lb,yb,pc,Ta,rb,ic){pc=void 0===pc?null:pc;Ta=void 0===Ta?null:Ta;rb=void 0===rb?null:rb;ic=void 0===ic?null:ic;var Va=H.createInstance(da.AFrameworkApplication.ha),jb=da.AFrameworkApplication.buildVersion?da.AFrameworkApplication.buildVersion:"1.0",rc=e(Ja,Da,lb,jb),Cc=Va.Z1g?b(1370).RealtimeChannelMetrics.createInstance(rc):
new ea,Hc=Fa.a.create(wc);Va.rtcJsClientFrequentlyLogsMetrics&&Hc.pKj(Va.qoj);var Nb="";Nb=pc&&""!==pc?pc:"/rtc2/";Hc.DXe=ha.a.HN(Nb);var nc=Nb+"signalr";pc=Nb+"findsession";var Ha=Q.Vbi;Nb=new n;rb=rb||Ua.a.getInstance();aa.ULS.shipAssertTag(556867617,500,Va.RYf<=b(1014).RealtimeChannel.wtf,"Client attempting to override max payload size beyond absolute limit");var tb=Math.min(Va.RYf,b(1014).RealtimeChannel.wtf);Hc.vtf=tb;Hc=new r(Va,new m(Nb),Ja,rc,function(Ub){return new U(Ub.createHubProxy(Ha))},
yb,rb,Cc,Hc,tb);Ta||(Ta=b(1302).FindSessionStrategy.createInstance(Da,wc,pc,yb,jb,lb,Ja,rc,rb,Cb,Rb,ic));Ta.Lac=Va.Lac;Da=new Z(rc);ib=ib?ib.split(","):null;Ja=new (b(1014).RealtimeChannel)(Ja,ib,rc,yb,function(){return $.hubConnection(nc)},Ta,Hc,Da,rb,Cc,Va,wc);Ja.init();return Ja}function m(Ja){var Da=this;this.Ee=null;this.yx=!1;this.$a=new zb.a;this.LPc=new ka.a;this.KPc=new ka.a;this.NUc=Ja;this.wXa=this.NUc.UHe(function(ib){return ib.send()},"GlobalMaxOustandingThrottler");this.wXa.r0b(function(){Da.$a.raiseEvent("TMUDM")})}
function n(){}function h(Ja,Da){Ja=w.call(this,Ja,void 0===Da?"":Da)||this;Ja.d$a=0;Ja.flb=(new Date(0)).getTime();Ja.currentTime=function(){return(new Date).getTime()};return Ja}function u(Ja,Da){Ja=w.call(this,Ja,void 0===Da?"":Da)||this;Ja.rCa=0;Ja.Y9a=0;Ja.$a=new zb.a;Ja.SXa=!1;Ja.MUc=0;Ja.PSb=0;Ja.aTb=0;Ja.gWb=0;Ja.SYb=[];Ja.clearTimeout=u.B8c;return Ja}function w(Ja,Da){this.Ejb=this.Qnb=0;this.INc=!1;this.mZa=this.PYb=null;this.TXa=!1;this.cke=Ja;this.ycg=void 0===Da?"":Da;this.setTimeout=
w.O8c;this.dGa=this.Qnb=this.Ejb=0}function r(Ja,Da,ib,Rb,wc,Cb,lb,yb,pc,Ta){lb=C.call(this,lb)||this;lb.es=null;lb.fee=!1;lb.iQ=0;lb.kRc=new xa.a;lb.Ee=Ja;lb.Lfe=0;lb.Mfe=0;lb.Rnb=Da;lb.Rnb.r0b(Object(ia.a)(lb,lb.VYi,"onTooManyUndeliveredMessages"));lb._clientId=ib;lb.gyg=wc;lb.sh.HKg(Object(ia.a)(lb,lb.SVi,"onRefreshProxyRequired"));lb.sh.FKg(Object(ia.a)(lb,lb.PVi,"onRefreshAllPersistentStateRequest"));lb.sh.YKg(Object(ia.a)(lb,lb.zea,"sendUpdateNotification"));lb.sh.pJg(Object(ia.a)(lb,lb.RSi,
"onInternalPresenceUpdated"));lb.sh.qJg(Object(ia.a)(lb,lb.SSi,"onInternalUpdateNotificationReceived"));lb.sh.oJg(Object(ia.a)(lb,lb.QSi,"onInternalPersistentStateUpdated"));lb.sh.nJg(Object(ia.a)(lb,lb.PSi,"onInternalPersistentStateCleared"));lb.sh.XKg(Object(ia.a)(lb,lb.SQd,"sendPersistentState"));lb.sh.wLg(Object(ia.a)(lb,lb.Cgb,"updateClientInfo"));lb.Ih=Cb;lb.Zl=Rb;lb.Xp=yb;lb.kC=pc;lb.Dlb=Ta;lb.jWa=Object(bb.a)(String,da.AFrameworkApplication.hc.Application)||"";return lb}function B(){this.dUc=
this.Yp=null}function y(Ja,Da,ib,Rb){var wc=oa.call(this)||this;wc.qNd=Ja;wc.reconnectDelay=Da;wc.reason=ib;wc.GQd=Rb;return wc}function v(){this.Qee=new A;this.Oee=new A}function A(){this.h6d=this.hJc=!1;this.callback=null}function t(Ja,Da){this.Azg=Ja;this.iQ=void 0===Da?"":Da}function E(){this.Presence=null;this.TimeStamp=0}function C(Ja){this.Rnb=null;this.rea=0;this.qKa=!1;this.sh=Ja;this.sh.c_a(Object(ia.a)(this,this.aX,"onConnectionStateChanged"))}function H(){this.LHc=this.w5d=!1;this.JHc=
0;this.PIc=this.zTc=this.yTc=this.dHc=!1;this.SKc=0;this.qje=!1;this.pje=this.oje=0;this.FSc=!1;this.JSc=this.ISc=this.KSc=this.GSc=0}function U(Ja){this.es=Ja}function Q(){}function O(){}function ea(){this.bRf=this.rKd;this.eRf=this.uKd;this.dRf=this.tKd;this.iRf=this.wKd;this.hRf=this.vKd;this.CKd=this.DKd;this.zKd=this.AKd;this.wRa=this.xKd;this.AIb=this.yKd;this.cRf=this.sKd;this.yEb=this.MAd;this.Tnc=this.OAd}function Z(Ja){this.n$=!1;this.nZa=0;this.jJc=!1;this.setTimeout=Z.O8c;this.clearTimeout=
Z.B8c;this.DBi=Object(ia.a)(this,this.WAi,"logRtcConnectingUsageStatement");this.Zl=Ja}function S(Ja,Da){this.data=Ja;this.timeStamp=Da}function I(Ja,Da,ib){this.T9=null;this.xPc=this.eTc=0;this.Ee=Da;this.Ree=ib;this.knb=!1;this.sh=Ja;this.sh.i_a(Object(ia.a)(this,this.Caj,"receiveMessage"))}function P(Ja){this.messageId=Ja;this.Tsj=(new Date).getTime();this.Xvd=new Aa.a}function J(Ja,Da){this.status=Ja;this.o9a=Da}b.r(F);z=b(0);var aa=b(13),ia=b(82),ba=b(161),ra=b(1207),ka=b(97),da=b(4);Object(z.a)(J,
"UserStatusInfo",null,[]);var ha=b(79),qa=b(634),Aa=b(199);Object(z.a)(P,"MessageLatencyDetails",null,[]);I.prototype.start=function(){if(this.Ree&&!this.knb){var Ja=this.Ee.SYf;this.xPc=this.Ee.QYf;Ja<=this.xPc?(aa.ULS.sendTraceTag(570975114,500,15,"LogMetrics cannot be started because configuration values are incorrect. RtcSendTelemetryMessageIntervalInMS({0}) should be greater than RtcLogClientMessageMetricsTimeOutInMs({1})",this.Ee.SYf,this.Ee.QYf),this.Ree=!1):(this.knb=!0,this.eTc=window.setInterval(Object(ia.a)(this,
this.Nj,"sendMessage"),Ja))}};I.prototype.Nj=function(){var Ja=this;if(this.knb){var Da=qa.a.create().toString();this.T9=new P(Da);this.sh.AJd(16,Da,!1,new ba.a);window.setTimeout(function(){Ja.kAi(Da)},this.xPc)}};I.prototype.kAi=function(Ja){this.T9&&this.T9.messageId===Ja&&(0<this.T9.Xvd.count?(Ja=this.T9.Xvd.toArray().join(","),aa.ULS.sendTraceTag(571339719,500,15,"ClientMessageLatencies:[{0}]",Ja)):aa.ULS.sendTraceTag(562312150,500,50,"No client message latencies recorded"),this.T9=null)};I.prototype.stop=
function(){this.eTc&&(window.clearInterval(this.eTc),this.knb=!1)};I.prototype.Caj=function(Ja,Da){16===Da.type?this.sh.AJd(17,Da.S8,!1,new ba.a):17===Da.type&&this.knb&&Da.S8&&this.U6i(Da.S8)};I.prototype.U6i=function(Ja){Ja&&this.T9&&Ja.toString()===this.T9.messageId&&(Ja=(new Date).getTime()-this.T9.Tsj,this.T9.Xvd.add(Ja))};I.ajd=function(Ja,Da,ib){return I.instance||(I.Na=new I(Ja,Da,ib))};uk.Object.defineProperties(I,{instance:{configurable:!0,enumerable:!0,get:function(){return I.Na}}});I.Na=
null;Object(z.a)(I,"ClientToClientMessageTelemetry",null,[]);var Fa=b(1147),ab=b(1095);Object(z.a)(S,"PresenceData",null,[]);Z.prototype.GNi=function(){var Ja=this;this.n$||(this.nZa=this.setTimeout(function(){Ja.n$=!1;Ja.Oqf()},8E3),this.n$=!0,this.jJc=!1)};Z.prototype.GOi=function(){this.jN()};Z.prototype.dYi=function(){this.Oqf()};Z.prototype.Oqf=function(){this.jN();this.jJc||(this.jJc=!0,this.DBi())};Z.prototype.WAi=function(){aa.ULS.sendTraceTag(4539720,500,50,"Usage statement for the Rtc_ConnectedEver KPI for [{0}]",
this.Zl)};Z.prototype.jN=function(){this.n$&&this.clearTimeout(this.nZa);this.nZa=0;this.n$=!1};Z.O8c=function(Ja,Da){return window.setTimeout(Ja,Da)};Z.B8c=function(Ja){window.clearTimeout(Ja)};Object(z.a)(Z,"ConnectedUsageKpiLogger",null,[379]);ea.prototype.rKd=function(){};ea.prototype.uKd=function(){};ea.prototype.tKd=function(){};ea.prototype.wKd=function(){};ea.prototype.vKd=function(){};ea.prototype.AKd=function(){};ea.prototype.yKd=function(){};ea.prototype.xKd=function(){};ea.prototype.DKd=
function(){};ea.prototype.sKd=function(){};ea.prototype.MAd=function(){};ea.prototype.OAd=function(){};Object(z.a)(ea,"NoopRealtimeChannelMetrics",null,[368,73]);O.FPb="presenceUpdated";O.updateNotification="updateNotification";O.WKf="persistentStateCleared";O.updatePersistentState="persistentStateUpdated";Object(z.a)(O,"RtcClientMethodNames",null,[]);Q.Vbi="realtimeChannelHub";Q.FPb="UpdatePresence";Q.zea="SendUpdateNotification";Q.Lgd="GetCompletePersistentStateWithMetadata";Q.updatePersistentState=
"UpdatePersistentState";Q.Cgb="UpdateClientInfo";Object(z.a)(Q,"RtcHubMethodNames",null,[]);U.prototype.ndj=function(Ja){this.es.on(O.FPb,Ja)};U.prototype.Odj=function(Ja){this.es.on(O.updateNotification,Ja)};U.prototype.ldj=function(Ja){this.es.on(O.updatePersistentState,Ja)};U.prototype.kdj=function(Ja){this.es.on(O.WKf,Ja)};U.prototype.OUj=function(Ja){this.es.off(O.FPb,Ja)};U.prototype.WUj=function(Ja){this.es.off(O.updateNotification,Ja)};U.prototype.NUj=function(Ja){this.es.off(O.updatePersistentState,
Ja)};U.prototype.MUj=function(Ja){this.es.off(O.WKf,Ja)};U.prototype.FPb=function(Ja){return this.es.invoke(Q.FPb,Ja)};U.prototype.Cgb=function(Ja){return this.es.invoke(Q.Cgb,Ja)};U.prototype.zea=function(Ja,Da){return this.es.invoke(Q.zea,Ja,Da)};U.prototype.Lgd=function(Ja){return this.es.invoke(Q.Lgd,Ja)};U.prototype.updatePersistentState=function(Ja,Da){return this.es.invoke(Q.updatePersistentState,Ja,Da)};Object(z.a)(U,"RealtimeChannelProxy",null,[376,377,378]);H.createInstance=function(Ja){var Da=
b(1014).RealtimeChannel;return Ja?Object.assign(new H,{w5d:Ja.ra("AwayStatusManagerIsEnabled"),LHc:Ja.ra("AwayStatusOneMinuteTimeoutIsEnabled"),JHc:Ja.Cd("AwayCoauthorThresholdMs",9E5),dHc:Ja.ra("RtcAllowCrossDomainAccessEnabled"),yTc:Ja.ra("ShouldLogOnContentNotification"),zTc:Ja.ra("ShouldLogOnHostSubscriptionNotification"),PIc:Ja.ra("RtcClientMetricsEnabled"),SKc:Ja.Cd("RtcFindSessionRequestTimeoutInMS",6E4),qje:Ja.ra("RtcJsClientFrequentlyLogsMetrics"),oje:Ja.Cd("RtcJsClientFrequentMetricsLatencyThresholdInMS",
1E3),pje:Ja.Cd("RtcJsClientFrequentMetricsLogIntervalInMS",3E5),FSc:Ja.ra("RtcClientMessageTelemetryEnabled"),GSc:Ja.Cd("RtcClientMessageTelemetrySampleSize",5),KSc:Ja.Cd("RtcSendTelemetryMessageIntervalInMS",3E5),ISc:Ja.Cd("RtcLogClientMessageMetricsTimeOutInMs",2E4),JSc:Ja.Cd("RtcMaxPayloadSizeInCharactersOverride",Da.czd)}):Object.assign(new H,{w5d:!1,LHc:!1,JHc:9E5,dHc:!1,yTc:!1,zTc:!0,PIc:!1,SKc:9E4,FSc:!1,GSc:5,KSc:3E5,ISc:2E4,JSc:Da.czd})};uk.Object.defineProperties(H.prototype,{zRg:{configurable:!0,
enumerable:!0,get:function(){return this.LHc}},yRg:{configurable:!0,enumerable:!0,get:function(){return this.JHc}},ZMg:{configurable:!0,enumerable:!0,get:function(){return this.dHc}},xCj:{configurable:!0,enumerable:!0,get:function(){return this.yTc}},yCj:{configurable:!0,enumerable:!0,get:function(){return this.zTc}},Z1g:{configurable:!0,enumerable:!0,get:function(){return this.PIc}},Lac:{configurable:!0,enumerable:!0,get:function(){return this.SKc}},rtcJsClientFrequentlyLogsMetrics:{configurable:!0,
enumerable:!0,get:function(){return this.qje}},PYf:{configurable:!0,enumerable:!0,get:function(){return this.oje}},qoj:{configurable:!0,enumerable:!0,get:function(){return this.pje}},rtcClientMessageTelemetryEnabled:{configurable:!0,enumerable:!0,get:function(){return this.FSc}},loj:{configurable:!0,enumerable:!0,get:function(){return this.GSc}},SYf:{configurable:!0,enumerable:!0,get:function(){return this.KSc}},QYf:{configurable:!0,enumerable:!0,get:function(){return this.ISc}},RYf:{configurable:!0,
enumerable:!0,get:function(){return this.JSc}}});Object(z.a)(H,"RealtimeChannelSettings",null,[375]);var Ua=b(1298),bb=b(81),xa=b(360);C.prototype.aX=function(Ja,Da){this.rea=Da.newState};C.prototype.VYi=function(){aa.ULS.sendTraceTag(18637070,500,15,"Too many undelivered messages. Restarting RTC connection.");this.sh.qtc()};C.prototype.Eei=function(Ja){this.Rnb.init(Ja)};Object(z.a)(C,"ARtcMessageHandler",null,[]);var Gb=b(99);Object(z.a)(E,"PresenceDataEntryForClients",null,[]);var $b=b(111);t.prototype.send=
function(){return this.Azg()};uk.Object.defineProperties(t.prototype,{messageId:{configurable:!0,enumerable:!0,get:function(){return this.iQ}}});Object(z.a)(t,"MessageHandler",null,[396]);A.prototype.xO=function(Ja){this.callback=Ja;this.Rdg()};A.prototype.ctf=function(Ja){this.hJc||(this.hJc=!0,this.Iqg=Ja,this.Rdg())};A.prototype.Rdg=function(){this.hJc&&this.callback&&!this.h6d&&(this.h6d=!0,this.callback(this.Iqg))};Object(z.a)(A,"CompletionTask",null,[]);v.prototype.Ppc=function(Ja){this.Qee.xO(Ja)};
v.prototype.Opc=function(Ja){this.Oee.xO(Ja)};v.prototype.RDb=function(Ja){this.Qee.ctf(Ja)};v.prototype.eza=function(Ja){this.Oee.ctf(Ja)};v.prototype.Wyd=function(){this.RDb(2);this.eza(2)};Object(z.a)(v,"MessageStatus",null,[395]);var oa=Sys.EventArgs;Am(y,oa);Object(z.a)(y,"RefreshConnectionReconnectArgs",Sys.EventArgs,[]);var Ma=b(1208);B.prototype.start=function(){this.Yp=new Date};B.prototype.stop=function(){this.dUc=new Date};uk.Object.defineProperties(B.prototype,{Gc:{configurable:!0,enumerable:!0,
get:function(){return this.Yp?this.dUc?this.dUc.getTime()-this.Yp.getTime():(new Date).getTime()-this.Yp.getTime():0}}});Object(z.a)(B,"SimpleStopwatch",null,[]);var Za=b(1209),gb;(function(Ja){Ja[Ja.contentUpdate=0]="contentUpdate";Ja[Ja.editorsTableUpdate=1]="editorsTableUpdate";Ja[Ja.fileNameUpdate=2]="fileNameUpdate";Ja[Ja.wetContentUpdate=3]="wetContentUpdate";Ja[Ja.persistedContentUpdate=4]="persistedContentUpdate";Ja[Ja.clientRtcReconnectRequest=5]="clientRtcReconnectRequest";Ja[Ja.replicationTelemetry=
6]="replicationTelemetry";Ja[Ja.lockUpdate=7]="lockUpdate";Ja[Ja.collabServiceContentUpdate=8]="collabServiceContentUpdate";Ja[Ja.trackChangeSettingUpdate=9]="trackChangeSettingUpdate";Ja[Ja.saveTargetUpdate=10]="saveTargetUpdate";Ja[Ja.uploadToOcsUpdate=11]="uploadToOcsUpdate";Ja[Ja.labelUpdate=12]="labelUpdate";Ja[Ja.hostNotificationSubscriptionStatus=13]="hostNotificationSubscriptionStatus";Ja[Ja.subscribeOrExtend=14]="subscribeOrExtend";Ja[Ja.elapsedBootTelemetry=15]="elapsedBootTelemetry";Ja[Ja.clientToClientTelemetryMessage=
16]="clientToClientTelemetryMessage";Ja[Ja.clientToClientResponseMessage=17]="clientToClientResponseMessage";Ja[Ja.verifyNotificationPipeline=18]="verifyNotificationPipeline";Ja[Ja.hostNotificationHeartbeat=19]="hostNotificationHeartbeat";Ja[Ja.secondaryMetadataUpdate=20]="secondaryMetadataUpdate";Ja[Ja.last=21]="last"})(gb||(gb={}));Object(z.b)("UpdateNotificationType",gb);Am(r,C);r.prototype.SVi=function(Ja,Da){this.es=this.gyg(Da.hubConnection);this.Rnb.reset();this.es.ndj(Object(ia.a)(this,this.mna,
"onPresenceUpdated"));this.es.ldj(Object(ia.a)(this,this.fqc,"onPersistentStateUpdated"));this.es.kdj(Object(ia.a)(this,this.vEd,"onPersistentStateCleared"));this.es.Odj(Object(ia.a)(this,this.oda,"onUpdateNotificationReceived"))};r.prototype.aX=function(Ja,Da){this.rea=Da.newState;2===Da.newState&&this.Gsj()};r.prototype.Gsj=function(){for(var Ja=Cl(this.kRc),Da=Ja.next();!Da.done;Da=Ja.next())Da=Da.value,this.zea(null,new Ma.a(Da.key,Da.value,!1,new ba.a));this.kRc=new xa.a};r.prototype.PVi=function(Ja,
Da){Da.c3c();for(Ja=0;3>Ja;++Ja)this.qsj(Ja,Da)};r.prototype.qsj=function(Ja,Da){var ib=this;try{this.es.Lgd(Ja).done(function(Rb){Da.dhb(Da.V4c,"GetCompletePresenceSuccess")&&(Da.F5g.dYi(),aa.ULS.sendTraceTag(3249540,500,50,"Successfully retrieved complete session state for [{0}]",ib.Zl),ib.sh.z9i(),ib.fVi(Ja,Rb),ib.sh.b9i(Rb),Da.BVe.xb(Ja)&&ib.sh.sPf(Ja,Da.BVe.pa(Ja),new ba.a))}).fail(function(Rb){var wc=b(927).RtcUtils;Da.dhb(Da.V4c,"GetCompletePresenceFail")&&(aa.ULS.sendTraceTag(3249541,500,
15,"Failed to retrieve complete session state : {0} for [{1}]",wc.FPa(Rb),ib.Zl),ib.sh.qtc())}).always(function(){Da.stopwatch&&Da.stopwatch.stop()})}catch(Rb){aa.ULS.sendTraceTag(595132428,500,10,"Exception thrown while calling hub method GetCompletePersistentStateWithMetadata. Promise not even created. Current event token: {0}, Exception message: {1}",Da.V4c,Rb.message)}};r.prototype.SQd=function(Ja,Da){var ib=this,Rb=b(927).RtcUtils;Ja=Da.presence;var wc=Da.spa;this.kC.qy(1,0);try{var Cb=Rb.F2c(Ja,
this.Dlb)}catch(yb){this.kC.qy(1,3);aa.ULS.sendTraceTag(574407636,500,10,"Exception thrown while trying to serialize presence. Exception message: {0}",yb.message);wc.setException(yb);return}Rb=new ka.a;Rb.ia(this._clientId,Object.assign(new E,{Presence:Ja,TimeStamp:(new Date).getTime()}));this.sh.APf(Da.type,Rb);if(2!==this.rea)this.Xp.wRa(),this.kC.qy(1,2),wc.setResult(null);else{var lb=this.iQ.toString();++this.iQ;Ja=new t(function(){return ib.Isj(Da.type,Cb,lb)},lb);Ja=this.xcg(0,Da.type).add(Ja);
Ja.Ppc(function(yb){2===yb&&ib.kC.qy(1,6);wc.setResult(null)});Ja.Opc(function(){})}};r.prototype.Isj=function(Ja,Da,ib){var Rb=this,wc=null,Cb=new B,lb=new v;aa.ULS.sendTraceTag(3249501,500,50,"Sending presence update for [{0}]",this.Zl);if(2!==this.rea)return this.Xp.wRa(),this.kC.qy(1,2),aa.ULS.sendTraceTag(7934171,500,15,"Connection is lost - unable to send the message for [{0}]",this.Zl),lb.Wyd(),lb;this.Ih&&20>this.Lfe&&(wc=this.Ih.Hc("WebServiceCall","Send Presence Message"),this.Lfe++);Cb.start();
lb.RDb(1);try{this.es.updatePersistentState(Ja,Da).done(function(){Rb.Xp.zKd();Rb.kC.qy(1,1);aa.ULS.sendTraceTag(3249502,500,50,"Successfully delivered presence update message [{0}] for [{1}]",ib,Rb.Zl);lb.eza(1);Cb&&(Cb.stop(),Cb.Gc>Rb.Ee.PYf?Rb.kC.qy(1,4):Rb.kC.qy(1,5))}).fail(function(yb){var pc=b(927).RtcUtils;Rb.qKa||(Rb.Xp.wRa(),Rb.kC.qy(1,3),aa.ULS.sendTraceTag(3249503,500,15,"Server failed to process the presence update message [{0}]: [{1}] for [{2}]",ib,pc.FPa(yb),Rb.Zl));lb.eza(2)}).always(function(){wc&&
wc.stop()})}catch(yb){aa.ULS.sendTraceTag(593072906,500,15,"Exception when invoking hub method UpdatePersistentState, error: {1}",yb.message),this.kC.qy(1,3),lb.eza(2)}return lb};r.prototype.Cgb=function(Ja,Da){var ib=this;Ja=b(927).RtcUtils;var Rb=Da.Y1g,wc=Da.spa;try{var Cb=Ja.F2c(Rb,this.Dlb)}catch(lb){aa.ULS.sendTraceTag(544318999,500,10,"Exception thrown while trying to serialize clientInfo. Exception message: {0}",lb.message);wc.setException(lb);return}try{this.es.Cgb(Cb).done(function(){aa.ULS.sendTraceTag(544319E3,
500,50,"Successfully delivered clientInfo.")}).fail(function(lb){var yb=b(927).RtcUtils;ib.qKa||aa.ULS.sendTraceTag(544319001,500,15,"Server failed to process udpate clientInfo: {0}.",yb.FPa(lb));wc.setResult(null)})}catch(lb){aa.ULS.sendTraceTag(544319002,500,15,"Exception when invoking hub method UpdateClientInfo: error: {0}",lb.message),wc.setResult(null)}};r.prototype.zea=function(Ja,Da){var ib=this;Ja=b(927).RtcUtils;var Rb=Da.type,wc=Da.S8,Cb=Da.Ihh,lb=Da.spa;this.kC.qy(0,0);try{var yb=Ja.F2c(wc,
this.Dlb)}catch(Ta){this.kC.qy(0,3);aa.ULS.sendTraceTag(574407637,500,10,"Exception thrown while trying to serialize updateHint. Exception message: {0}",Ta.message);lb.setException(Ta);return}if(2!==this.rea)Cb?this.kRc.ia(Rb,wc):(this.Xp.wRa(),this.kC.qy(0,2)),lb.setResult(null);else{var pc=this.iQ.toString();++this.iQ;Da=new t(function(){return ib.btj(Rb,yb,pc)},pc);Da=this.xcg(1,Rb).add(Da);Da.Ppc(function(Ta){2===Ta&&ib.kC.qy(0,6);lb.setResult(null)});Da.Opc(function(){})}};r.prototype.btj=function(Ja,
Da,ib){var Rb=this,wc=null,Cb=new B,lb=new v;aa.ULS.sendTraceTag(3249505,500,50,"Sending update notification for [{0}]",this.Zl);if(2!==this.rea)return this.Xp.wRa(),this.kC.qy(0,2),aa.ULS.sendTraceTag(7934172,500,15,"Connection is lost - unable to send the message for [{0}]",this.Zl),lb.Wyd(),lb;this.Ih&&3===Ja&&20>this.Mfe&&(wc=this.Ih.Hc("WebServiceCall","Send WetContent Update"),this.Mfe++);Cb.start();lb.RDb(1);this.es.zea(Ja,Da).done(function(){Rb.Xp.zKd();Rb.kC.qy(0,1);aa.ULS.sendTraceTag(3249506,
500,50,"Successfully delivered update notification message [{0}] for [{1}]",ib,Rb.Zl);lb.eza(1);Cb&&(Cb.stop(),Cb.Gc>Rb.Ee.PYf?Rb.kC.qy(0,4):Rb.kC.qy(0,5))}).fail(function(yb){var pc=b(927).RtcUtils;Rb.qKa||(Rb.Xp.wRa(),Rb.kC.qy(0,3),aa.ULS.sendTraceTag(3249507,500,15,"Server failed to process the update notification message [{0}] : [{1}] for [{2}]",ib,pc.FPa(yb),Rb.Zl));lb.eza(2)}).always(function(){wc&&wc.stop()});return lb};r.prototype.Uv=function(){this.es.OUj(Object(ia.a)(this,this.mna,"onPresenceUpdated"));
this.es.NUj(Object(ia.a)(this,this.fqc,"onPersistentStateUpdated"));this.es.MUj(Object(ia.a)(this,this.vEd,"onPersistentStateCleared"));this.es.WUj(Object(ia.a)(this,this.oda,"onUpdateNotificationReceived"))};r.prototype.RSi=function(Ja,Da){this.mna(Da.JP,Da.v4)};r.prototype.mna=function(Ja){this.Xp.AIb();this.fqc(0,Ja)};r.prototype.QSi=function(Ja,Da){this.fqc(Da.type,Da.JP)};r.prototype.fVi=function(Ja,Da){var ib={},Rb;for(Rb in Da)ib[Rb]=Da[Rb].Presence;this.UEf(Ja,ib,Da)};r.prototype.fqc=function(Ja,
Da){this.Xp.AIb();this.UEf(Ja,Da)};r.prototype.UEf=function(Ja,Da,ib){ib=void 0===ib?null:ib;var Rb=b(927).RtcUtils;if(aa.ULS.Hea(500,100))for(var wc in Da);delete Da[this._clientId];if(!$b.a.isEmpty(Da)){for(var Cb in Da)wc=Cb,Da[wc]=Rb.deserialize(Da[Cb],"Presence",wc,!1,this.Dlb);Rb=new ka.a;Cb=(new Date).getTime();for(var lb in Da){wc=Da[lb];var yb=lb;if(ib){var pc=ib[yb];pc.Presence=wc}else pc=Object.assign(new E,{Presence:wc,TimeStamp:Cb});Rb.ia(yb,pc)}this.sh.APf(Ja,Rb);switch(Ja){case 0:this.fee||
(aa.ULS.sendTraceTag(4539734,500,50,"Raising first presence update notification for [{0}]",this.Zl),this.fee=!0,da.AFrameworkApplication.hg&&da.AFrameworkApplication.hg.vDi());this.sh.kPf(Da,[]);break;default:this.sh.t9i(Ja,Da)}}};r.prototype.PSi=function(Ja,Da){this.vEd(Da.z3c)};r.prototype.vEd=function(Ja){this.Xp.AIb();if(aa.ULS.Hea(500,100))for(var Da=0;Da<Ja.length;++Da);Ja.length&&(this.sh.N9i(Ja),this.sh.s9i(Ja),this.sh.kPf({},Ja))};r.prototype.SSi=function(Ja,Da){this.oda(Da.type,Da.S8)};
r.prototype.oda=function(Ja,Da){Da=void 0===Da?null:Da;this.Ee.xCj&&0===Ja&&aa.ULS.sendTraceTag(40128990,500,50,"Received ContentUpdate notification from the server");if(0===Ja){var ib=da.AFrameworkApplication.ha.Wa("OwningFeatureCrewForRtcNotificationKpis");if(ib&&0<ib.length){var Rb=new Map;Rb.set("AreaName","RealTimeCoauth");Rb.set("FeatureName","RtcNotification");Rb.set("SkipAria","True");Gb.Health.instance.recordKpiUsage("ContentUpdateNotificationReceived",0,ib,Rb)}}this.Ee.yCj&&13===Ja&&aa.ULS.sendTraceTag(575221780,
500,50,String.format("Received HostSubscription notification from the server : {0}",Da||"<none>"));this.Xp.AIb();5===Ja?(Da=(Ja=this.B1i(Da))?String.format("Received client reconnection request from the server. Reason: {0}, Backoff time: {1} ",Ja.reason,Ja.reconnectDelay):"Received client reconnection request from the server without params.",aa.ULS.sendTraceTag(18637071,500,50,Da),this.sh.qtc(Ja)):(Da=b(927).RtcUtils.deserialize(Da,String.format("UpdateNotification-{0}",gb[Ja]),null,!1,this.Dlb),
this.sh.M9i(Ja,Da))};r.prototype.B1i=function(Ja){try{if(!Ja||""===Ja)return null;var Da=JSON.parse(Ja);return new y(Da[Za.a.oPd],Da[Za.a.koj],Da[Za.a.moj],Da[Za.a.GQd])}catch(ib){return aa.ULS.sendTraceTag(593844380,500,15,"Error when parsing reconnect hint: {0}",ib.message),null}};r.prototype.xcg=function(Ja,Da){return this.Rnb.$3h(this.a4h(Ja,Da))};r.prototype.a4h=function(Ja,Da){return Ja+","+Da};Object(z.a)(r,"RtcMessageHandler",C,[]);var zb=b(96);w.prototype.BKd=function(){0<this.dGa&&0<this.Ejb&&
aa.ULS.sendTraceTag(36545635,500,50,"Throttler [{0}] dropped [{1}] messages out of [{2}]",this.ycg,this.Ejb,this.dGa);0<this.dGa&&0<this.Qnb&&aa.ULS.sendTraceTag(36545634,500,50,"Throttler [{0}] throttled [{1}] messages out of [{2}]",this.ycg,this.Qnb,this.dGa)};w.prototype.Nyc=function(Ja,Da){this.Qnb++;this.Srb(!0);this.INc=!0;this.PYb=Ja;this.mZa=Da};w.prototype.Srb=function(Ja){this.INc=!1;this.mZa&&Ja&&(this.Ejb++,this.mZa.Wyd());this.mZa=this.PYb=null};w.O8c=function(Ja,Da){return window.setTimeout(Ja,
Da)};uk.Object.defineProperties(w.prototype,{Y7a:{configurable:!0,enumerable:!0,get:function(){return this.INc}}});Object(z.a)(w,"ThrottlerBase",null,[]);Am(u,w);u.prototype.add=function(Ja){this.TXa||this.init(u.HKe,u.BKe);this.dGa++;var Da=new v;this.Y7a?this.Nyc(Ja,Da):this.gWb<this.Y9a?this.gLb(Ja,Da):(this.Nyc(Ja,Da),this.SXa=!1);return Da};u.prototype.gLb=function(Ja,Da){var ib=this;Ja=this.cke(Ja);var Rb=this.setTimeout(Object(ia.a)(this,this.bUi,"onMessageWaitTimeExpired"),this.rCa);++this.gWb;
Array.add(this.SYb,Rb);var wc=this.PSb;Ja.Ppc(function(Cb){Da.RDb(Cb)});Ja.Opc(function(Cb){ib.PSb===wc&&(ib.aUi(wc,Rb),Da.eza(Cb))})};u.prototype.aUi=function(Ja,Da){this.PSb===Ja&&(--this.gWb,this.clearTimeout(Da),Array.remove(this.SYb,Da),this.Y7a&&this.Rsj())};u.prototype.Rsj=function(){this.Y7a&&!this.SXa&&(this.MUc=this.setTimeout(Object(ia.a)(this,this.Ssj,"sendThrottledMessageFromTimer"),0),this.SXa=!0)};u.prototype.Ssj=function(){this.SXa=!1;if(this.Y7a){var Ja=this.PYb,Da=this.mZa;this.Srb(!1);
this.gLb(Ja,Da)}};u.prototype.bUi=function(){++this.aTb;this.aTb>Math.floor(this.Y9a/2)&&(this.aTb=-1E9,this.$a.raiseEvent("TMUDM"))};u.prototype.r0b=function(Ja){this.$a.addHandler("TMUDM",Ja)};u.prototype.reset=function(){this.dGa=this.Qnb=this.Ejb=this.aTb=0;++this.PSb;for(var Ja=Cl(this.SYb),Da=Ja.next();!Da.done;Da=Ja.next())this.clearTimeout(Da.value);this.gWb=0;this.SYb=[];this.Srb(!0);this.SXa&&(this.clearTimeout(this.MUc),this.MUc=0,this.SXa=!1)};u.prototype.init=function(Ja,Da){this.TXa||
(this.rCa=Ja,this.Y9a=Da,this.TXa=!0)};u.createInstance=function(Ja,Da){return new u(Ja,void 0===Da?"":Da)};u.B8c=function(Ja){window.clearTimeout(Ja)};u.HKe=15E3;u.BKe=5;Object(z.a)(u,"MaxOutstandingThrottler",w,[397,390]);Am(h,w);h.prototype.init=function(Ja){this.TXa||(this.d$a=Ja,this.TXa=!0)};h.prototype.add=function(Ja){this.TXa||this.init(h.rKe);this.dGa++;var Da=this.currentTime(),ib=new v;this.flb>Da&&(this.flb=Da);this.Y7a?(this.Srb(!0),this.Nyc(Ja,ib)):this.flb+this.d$a<=Da?this.gLb(Ja,
ib):(this.Nyc(Ja,ib),this.setTimeout(Object(ia.a)(this,this.Qsj,"sendThrottledMessage"),this.flb+this.d$a-Da));return ib};h.prototype.Qsj=function(){if(this.Y7a){var Ja=this.PYb,Da=this.mZa;this.Srb(!1);this.gLb(Ja,Da)}};h.prototype.gLb=function(Ja,Da){this.flb=this.currentTime();Ja=this.cke(Ja);Ja.Ppc(function(ib){Da.RDb(ib)});Ja.Opc(function(ib){Da.eza(ib)})};h.createInstance=function(Ja,Da){return new h(Ja,void 0===Da?"":Da)};h.rKe=200;Object(z.a)(h,"MaxRateThrottler",w,[389,390]);n.prototype.UHe=
function(Ja,Da){return u.createInstance(Ja,void 0===Da?"":Da)};n.prototype.Qah=function(Ja,Da){return h.createInstance(Ja,void 0===Da?"":Da)};Object(z.a)(n,"ThrottlerFactory",null,[371]);var nb=b(1210);m.prototype.init=function(Ja){this.yx||(this.Ee=Ja,this.wXa.init(this.Ee.rCa,this.Ee.B6h),this.yx=!0)};m.prototype.$3h=function(Ja){var Da=this;this.yx||this.init(new nb.a(h.rKe,u.HKe,u.BKe,m.mEi));if(!function(){var Cb=Da.LPc.Fc(Ja);wc=Cb.value;return Cb}().returnValue){if(!function(){var Cb=Da.KPc.Fc(Ja);
Rb=Cb.value;return Cb}().returnValue){var ib="MaxOutstandingThrottler-"+Ja;var Rb=this.NUc.UHe(Object(ia.a)(this.wXa,this.wXa.add,"add"),ib);Rb.init(this.Ee.rCa,this.Ee.lEi);Rb.r0b(function(){Da.$a.raiseEvent("TMUDM")});this.KPc.add(Ja,Rb)}ib="MaxRateThrottler-"+Ja;var wc=this.NUc.Qah(Object(ia.a)(Rb,Rb.add,"add"),ib);wc.init(this.Ee.pFi);this.LPc.add(Ja,wc)}return wc};m.prototype.reset=function(){for(var Ja=Cl(this.LPc),Da=Ja.next();!Da.done;Da=Ja.next())Da.value.value.BKd();Ja=Cl(this.KPc);for(Da=
Ja.next();!Da.done;Da=Ja.next())Da=Da.value,Da.value.BKd(),Da.value.reset();this.wXa.BKd();this.wXa.reset()};m.prototype.r0b=function(Ja){this.$a.addHandler("TMUDM",Ja)};m.mEi=1E3;Object(z.a)(m,"ThrottlerManager",null,[370]);var pa;(function(Ja){Ja[Ja.unspecified=0]="unspecified";Ja[Ja.word=1]="word";Ja[Ja.excel=2]="excel";Ja[Ja.powerPoint=3]="powerPoint";Ja[Ja.test=4]="test";Ja[Ja.wacFrontEnd=5]="wacFrontEnd";Ja[Ja.oneNote=6]="oneNote";Ja[Ja.visio=7]="visio";Ja[Ja.officeMobile=8]="officeMobile";
Ja[Ja.cosmosDBChangefeed=9]="cosmosDBChangefeed";Ja[Ja.last=10]="last"})(pa||(pa={}));Object(z.b)("RtcClientAppName",pa);b.d(F,"RealtimeChannel",function(){return a});a.prototype.init=function(){var Ja=this;this.sh.GKg(Object(ia.a)(this,this.p8b,"disconnectAndCreateNewConnection"));this.sh.yLg(Object(ia.a)(this,this.iZi,"onUpdatePersistentStateRequestReceivedInternal"));this.sh.xLg(Object(ia.a)(this,this.hZi,"onUpdatePersistentStateClearedRequestReceived"));this.Yg.cXc(this.Xp);da.AFrameworkApplication.TNb(function(){Ja.Xp.CKd();
Fa.a.instance&&Fa.a.instance.rxd()});this.bIe();this.Mjh();this.sh.$Kg(Object(ia.a)(this,this.hWj,"updateConnectionQueryString"))};a.prototype.Mjh=function(){try{var Ja=$.signalR;if(!Ja)throw Error.invalidOperation("Failed to retrieve Signalr object");var Da=Ja.version;if(!Da)throw Error.invalidOperation("Signalr object is missing version information");if("2.1.1"===Da){var ib=Ja.transports;if(!ib)throw Error.invalidOperation("Failed to retrieve transports object");var Rb=ib.longPolling;if(!Rb)throw Error.invalidOperation("Failed to retrieve longPolling object");
if(!Rb.supportsKeepAlive)throw Error.invalidOperation("LongPolling object does not have a field called supportsKeepAlive");Rb.supportsKeepAlive=this.ndh()}}catch(wc){aa.ULS.sendTraceTag(6432339,500,15,"Failed to disable longPolling KeepAlives: {0}",wc.message)}};a.prototype.ndh=function(){return function(){return!1}};a.prototype.bIe=function(){var Ja=this,Da=++this.Yib;this.HOc=(new Date(0)).getTime();this.bQ=this.Lqg();this.sh.x9i(this.bQ);this.bQ.stateChanged(function(ib){Ja.INi(ib,Da)});this.bQ.connectionSlow(Object(ia.a)(this,
this.SXi,"onSlowConnection"));this.bQ.error(Object(ia.a)(this,this.HXi,"onSignalRError"));this.bQ.log=Object(ia.a)(this,this.IXi,"onSignalRLog")};a.prototype.dhb=function(Ja,Da){return Ja!==this.Yib?(aa.ULS.sendTraceTag(4309017,500,50,"ConnectionToken verification failed for {0}",Da),!1):!0};a.prototype.connect=function(){2!==this.EM&&1!==this.EM&&(aa.ULS.sendTraceTag(4539721,500,50,"Starting a new RTC connection for client [{0}]",this.Zl),this.iJc.GNi(),ab.a.instance.rKj(),this.aX(1,this.EM),this.Y9f())};
a.prototype.Y9f=function(){var Ja=this.Yib;this.cUc=!1;this.Xp.bRf();this.wqa.u1h(Object(ia.a)(this,this.A5g,"connectSignalrConnection"),Object(ia.a)(this,this.pBf,"onFailureToConnect"),Object(ia.a)(this.hBa,this.hBa.Eei,"initThrottlerManager"),Object(ia.a)(this,this.dhb,"verifyConnectionToken"),Ja)};a.prototype.pBf=function(Ja){Ja=void 0===Ja?null:Ja;this.Xp.dRf();var Da=null;!Ja||"documentsessiondeleted"!==(Da=Ja.toLowerCase())&&"documentsessionexpired"!==Da?this.p8b():(aa.ULS.sendTraceTag(41788292,
500,15,"In RealtimeChannel method OnFailureToConnect: Disconnect was called for [{0}], due to non-retriable RtcErrorCode:{1}",this.Zl,Ja),this.disconnect())};a.prototype.p8b=function(Ja,Da){Da=void 0===Da?null:Da;aa.ULS.sendTraceTag(4309018,500,50,"Disconnecting the connection [{0}]",this.r9);Ja=(Ja=2===this.EM||1===this.EM)&&!this.hBa.qKa;var ib=!0,Rb=0;Da&&Object.getType(Da)!==Object.getType(Sys.EventArgs.Empty)&&Da.qNd&&""!==Da.qNd&&(Ja=!0,this.wqa.Yxj(Da.qNd),ib=Da.GQd,Rb=Da.reconnectDelay);Ja&&
this.aX(1,this.EM);++this.Yib;this.hBa.Uv();this.rLj(ib);this.wqa.Mkh();this.bIe();Ja&&window.setTimeout(Object(ia.a)(this,this.Y9f,"startConnecting"),Math.min(Rb,3E4))};a.prototype.hWj=function(){var Ja=this.wqa.w2e();var Da=Ja.correlationId;this.bQ.qs=Ja.returnValue;aa.ULS.sendTraceTag(40768457,500,50,"Connection parameters refresh finished for client [{0}], CorrelationId:{1}",this.Zl,Da)};a.prototype.A5g=function(Ja){var Da=this;this.HOc=(new Date).getTime();var ib=null;this.bQ.qs=function(){var wc=
Da.wqa.w2e();ib=wc.correlationId;return wc}().returnValue;this.Ee.ZMg&&(this.bQ.url=Ja,Fa.a.instance&&(Fa.a.instance.pFe=ha.a.HN(Ja)));var Rb=null;this.Ih&&(Rb=this.Ih.Hc("WebServiceCall","ConnectToServer"));aa.ULS.sendTraceTag(3290048,500,50,"Connecting to server for client [{0}]",this.Zl);Ja={};this.YYb&&(Ja.transport=1===this.YYb.length?this.YYb[0]:this.YYb);Ja.pingInterval=null;ab.a.instance.zIb(1,0);Ja.waitForPageLoad=!1;this.bQ.start(Ja,null).done(function(wc){Da.Xp.eRf();ab.a.instance.zIb(1,
1,!0);aa.ULS.sendTraceTag(3457857,500,50,"Successfully connected to server using connection [{0}], CorrelationId:{1}",wc.id,ib)}).fail(function(wc){var Cb=b(927).RtcUtils;aa.ULS.sendTraceTag(3457858,500,15,"Failed to connect to server : connection string: {0}, CorrelationId:{1}, callback parameter:{2} for [{3}]",Da.wqa.LC,ib,Cb.FPa(wc),Da.Zl);Da.pBf();Da.Xp.cRf(wc);ab.a.instance.zIb(1,1,!1);Cb={};Da.sh.pPf(0,(Cb.CorrelationId=ib,Cb.ErrorDetails=wc,Cb.ConnectionState=ra.a[Da.EM],Cb))}).always(function(){Rb&&
Rb.stop();Fa.a.instance&&(Fa.a.instance.BKc=!1)})};a.prototype.disconnect=function(){0===this.EM?aa.ULS.sendTraceTag(36545632,500,50,"Disconnect for [{0}] was called but the channel is already Disconnected",this.Zl):(this.Xp.hRf(),Fa.a.instance&&(Fa.a.instance.BKc=!0),aa.ULS.sendTraceTag(36545633,500,50,"Starting explicit disconnect for [{0}]",this.Zl),this.hBa.qKa=!0,this.iJc.GOi(),this.aX(0,this.EM),this.p8b(),this.hBa.qKa=!1)};a.prototype.rLj=function(Ja){function Da(){if(ib.cUc)aa.ULS.sendTraceTag(591692192,
500,15,"Stop connection was called twice, possibly on the same connection.");else try{ib.cUc=!0,wc.stop(!0,Ja)}catch(lb){aa.ULS.sendTraceTag(591692191,500,15,"Stopping connection failed: {0}",lb.message)}}var ib=this,Rb=this.$Xg(),wc=this.bQ,Cb=this.r9;0<Rb?(aa.ULS.sendTraceTag(4309020,500,50,"Waiting to stop connection [{0}]: [{1}] ms.",Cb,Rb),window.setTimeout(Da,Rb)):(aa.ULS.sendTraceTag(36804372,500,50,"Stopping connection [{0}].",Cb),Da())};a.prototype.$Xg=function(){var Ja=0;0===this.bQ.state&&
(Ja=this.HOc+a.i1j-(new Date).getTime(),0>Ja&&(Ja=0));return Ja};a.prototype.c_a=function(Ja){this.sh.c_a(Ja)};a.prototype.Nuc=function(Ja){this.sh.Nuc(Ja)};a.prototype.O0f=function(Ja){this.SQd(0,Ja)};a.prototype.SQd=function(Ja,Da){var ib=new ba.a;this.sh.sPf(Ja,Da,ib);return ib.task};a.prototype.OGa=function(Ja){this.sh.OGa(Ja)};a.prototype.XAa=function(Ja){this.sh.XAa(Ja)};a.prototype.Xxb=function(Ja){return this.d5h(Ja)};a.prototype.ggd=function(){return this.jOh()};a.prototype.jOh=function(){for(var Ja=
{},Da=Cl(this.gH),ib=Da.next();!ib.done;ib=Da.next())ib=ib.value,ib.value.xb(0)&&(Ja[ib.key]=ib.value.pa(0).data);return Ja};a.prototype.d5h=function(Ja){return this.gH.xb(Ja)&&this.gH.pa(Ja).xb(0)?this.gH.pa(Ja).pa(0).data:null};a.prototype.iZi=function(Ja,Da){Ja=Cl(Da.yZj);for(var ib=Ja.next();!ib.done;ib=Ja.next()){ib=ib.value;this.gH.xb(ib.key)||this.gH.ia(ib.key,new xa.a);var Rb=ib.value;this.gH.pa(ib.key).ia(Da.type,new S(Rb.Presence,new Date(Rb.TimeStamp)));ib.key===this._clientId&&0===Da.type&&
this.sh.l9i(Rb.Presence)}};a.prototype.hZi=function(Ja,Da){Ja=Cl(Da.z3c);for(Da=Ja.next();!Da.done;Da=Ja.next())this.gH.remove(Da.value)};a.prototype.iOh=function(){var Ja=new xa.a;if(!this.gH.xb(this._clientId))return Ja;for(var Da=Cl(this.gH.pa(this._clientId)),ib=Da.next();!ib.done;ib=Da.next())ib=ib.value,Ja.ia(ib.key,ib.value.data);return Ja};a.prototype.zea=function(Ja,Da,ib){Da=void 0===Da?null:Da;ib=void 0===ib?!1:ib;var Rb=new ba.a;this.sh.AJd(Ja,Da,ib,Rb);return Rb.task};a.prototype.i_a=
function(Ja){this.sh.i_a(Ja)};a.prototype.zJb=function(Ja){this.sh.zJb(Ja)};a.prototype.Qwa=function(Ja){var Da=this,ib,Rb;return function(){var wc=Da.gH.Fc(Ja);ib=wc.value;return wc}().returnValue&&function(){var wc=ib.Fc(0);Rb=wc.value;return wc}().returnValue?new J(this.h5h(Rb),Rb.timeStamp):null};a.prototype.oOh=function(){for(var Ja={},Da={},ib=Cl(this.gH),Rb=ib.next();!Rb.done;Da={Fhb:Da.Fhb,cGc:Da.cGc},Rb=ib.next())Da.Fhb=Rb.value,Da.cGc=void 0,function(wc){return function(){var Cb=wc.Fhb.value.Fc(0);
wc.cGc=Cb.value;return Cb}}(Da)().returnValue&&(Ja[Da.Fhb.key]=this.Qwa(Da.Fhb.key));return Ja};a.prototype.Cgb=function(Ja){var Da=new ba.a;this.sh.L9i(Ja,Da);return Da.task};a.prototype.dispose=function(){this.Ut||(this.hBa.Uv(),this.Yg.dfj(this.Xp),this.Xp.CKd(),Fa.a.instance&&Fa.a.instance.rxd(),this.Ut=!0)};a.prototype.INi=function(Ja,Da){this.dhb(Da,"StateChangedSignalR")&&this.aX(this.eGe(Ja.newState),this.eGe(Ja.oldState))};a.prototype.aX=function(Ja,Da){if((1!==this.EM||0!==Da||1!==Ja)&&
this.EM!==Da){var ib=String.format.apply(null,["Unexpected connection state change : Current state is '{0}' while the event indicates ('{1}'->'{2}') transition"].concat([this.EM,Da,Ja]));aa.ULS.sendTraceTag(3290053,500,10,ib)}if(this.EM!==Ja){switch(Ja){case 2:Fa.a.instance&&Fa.a.instance.yDi();this.r9=this.bQ.id;aa.ULS.sendTraceTag(3249539,500,50,"Established connection [{0}] for client [{1}]",this.r9,this.Zl);this.wBi(this.bQ);aa.ULS.sendTraceTag(4298369,500,50,"Retrieving complete session state");
ib=null;this.Ih&&(ib=this.Ih.Hc("WebServiceCall","Receive First Presence"));var Rb=this.Yib;this.sh.w9i(Object(ia.a)(this,this.dhb,"verifyConnectionToken"),Rb,this.iJc,Object(ia.a)(this,this.c3c,"clearExistingPersistentState"),this.iOh(),ib);this.Ee.rtcClientMessageTelemetryEnabled&&I.ajd(this.sh,this.Ee,100*Math.random()<=this.Ee.loj).start();break;case 1:2===Da&&aa.ULS.sendTraceTag(4298644,500,50,"Lost connection [{0}] to the server ...trying to re-establish it",this.r9);break;case 0:if(I.instance&&
I.instance.stop(),this.hBa.qKa)aa.ULS.sendTraceTag(3249543,500,50,"Connection [{0}] has been explicitly closed",this.r9);else{1===Da&&(aa.ULS.sendTraceTag(7672737,500,50,"Signalr detected an unexpected disconnect event while attempting to re-establish connection [{0}]. Kicking off global reconnect logic ...",this.r9),this.Xp.iRf());2===Da&&aa.ULS.sendTraceTag(36574532,500,50,"Signalr detected a disconnect event triggered by a period of client inactivity for connection [{0}]. Kicking off global reconnect logic ...",
this.r9);this.p8b();return}}this.EM=Ja;this.sh.N8i(Ja,Da)}};a.prototype.wBi=function(Ja){if(Ja&&Ja.transport&&Ja.transport.name){Ja=Ja.transport.name;var Da=Ja.toLowerCase();"websockets"===Da?aa.ULS.sendTraceTag(4290723,500,50,"Transport name - {0} for [{1}]",Ja,this.Zl):"serversentevents"===Da?aa.ULS.sendTraceTag(4290752,500,50,"Transport name - {0} for [{1}]",Ja,this.Zl):"foreverframe"===Da?aa.ULS.sendTraceTag(4290753,500,50,"Transport name - {0} for [{1}]",Ja,this.Zl):"longpolling"===Da?aa.ULS.sendTraceTag(4290754,
500,50,"Transport name - {0} for [{1}]",Ja,this.Zl):"mocktransport"!==Da&&aa.ULS.sendTraceTag(4290755,500,15,"Unknown transport protocol encountered - '{0}'",Ja)}else aa.ULS.sendTraceTag(4290722,500,10,"Transport protocol name is missing")};a.prototype.SXi=function(){aa.ULS.sendTraceTag(3249544,500,50,"Detected that the connection [{0}] is slow",this.r9)};a.prototype.HXi=function(){aa.ULS.sendTraceTag(3249545,600,10,"SignalR ERROR for connection [{0}];",this.r9)};a.prototype.IXi=function(Ja){Ja=b(927).RtcUtils.FPa(Ja);
this.yHj&&2E3>this.Tke&&!Ja.startsWith("Invok")&&!Ja.startsWith("Trigger")&&(aa.ULS.sendTraceTag(578950464,500,50,"SignalR lib: {0}",Ja),this.Tke++)};a.prototype.c3c=function(){var Ja=[],Da=this.gH.Fc(this._clientId);var ib=Da.value;Da.returnValue&&this.gH.remove(this._clientId);var Rb=Cl(this.gH.keys);for(Da=Rb.next();!Da.done;Da=Rb.next())Array.add(Ja,Da.value);Rb=Cl(Ja);for(Da=Rb.next();!Da.done;Da=Rb.next())this.gH.remove(Da.value);ib&&this.gH.ia(this._clientId,ib);this.sh.h9i(Ja)};a.prototype.eGe=
function(Ja){switch(Ja){case 0:return 1;case 2:return 1;case 1:return 2;case 4:return 0;default:throw Error.argumentOutOfRange("state",Ja,"Unknown SignalR state");}};a.prototype.h5h=function(Ja){return Ja&&Ja.timeStamp?(new Date).getTime()-Ja.timeStamp.getTime()>(this.Ee.zRg?6E4:this.Ee.yRg)?2:1:1};a.createInstance=function(Ja,Da,ib,Rb,wc,Cb,lb,yb,pc,Ta,rb,ic,Va){return l(Ja,Da,ib,void 0===Va?null:Va,Rb,wc,Cb,lb,void 0===yb?null:yb,void 0===pc?null:pc,void 0===Ta?null:Ta,void 0===ic?null:ic,void 0===
rb?null:rb)};uk.Object.defineProperties(a.prototype,{Qmc:{configurable:!0,enumerable:!0,get:function(){return this.wqa.Qmc},set:function(Ja){this.wqa.Qmc=Ja}},hBa:{configurable:!0,enumerable:!0,get:function(){return this.qzg}},sh:{configurable:!0,enumerable:!0,get:function(){return this.iog}},connectionState:{configurable:!0,enumerable:!0,get:function(){return this.EM}},clientId:{configurable:!0,enumerable:!0,get:function(){return this._clientId}},yHj:{configurable:!0,enumerable:!0,get:function(){return this.pAg}}});
a.wtf=31E3;a.czd=8E3;a.i1j=15E3;Object(z.a)(a,"RealtimeChannel",null,[328,329])},1095:function(z,F,b){function a(){this.xle=!1;this.DRc=null;this.K7d=0;this.RKc=this.fJe();this.OSb=this.fJe();this.SDa=this.tXa=0;this.Hw=function(){return new Date}}b.d(F,"a",function(){return a});z=b(0);a.prototype.fJe=function(){for(var c=Array(6),e=0;e<c.length;e++)c[e]=0;return c};a.prototype.DUh=function(){return this.RKc.toString()};a.prototype.sRh=function(){return this.OSb.toString()};a.prototype.rKj=function(){this.DRc=
this.Hw()};a.prototype.zIb=function(c,e,l){if(!this.kMj){if(void 0===l?0:l)this.xle=!0;l=this.Hw();0===c&&5<this.tXa||1===c&&5<this.SDa||(this.K7d<c?(1===this.tXa%2&&(this.RKc[this.tXa]=-1,this.tXa++),this.K7d=c,1===e&&(this.OSb[this.SDa]=-1,this.SDa++),this.OSb[this.SDa]=this.hXd(l),this.SDa++):0===c?(this.RKc[this.tXa]=this.hXd(l),this.tXa++):(this.OSb[this.SDa]=this.hXd(l),this.SDa++))}};a.prototype.hXd=function(c){var e=c.getTime()-this.DRc.getTime();this.DRc=c;return e};uk.Object.defineProperties(a.prototype,
{kMj:{configurable:!0,enumerable:!0,get:function(){return this.xle}}});uk.Object.defineProperties(a,{instance:{configurable:!0,enumerable:!0,get:function(){a.Na||(a.Na=new a);return a.Na},set:function(c){a.Na=c}}});a.Na=null;Object(z.a)(a,"LatencyMetrics",null,[])},1147:function(z,F,b){function a(u){this.pFe=this.DXe=null;this.vtf=this.xZe=0;this.Xp=null;this.lee=this.wPc=0;this.Yg=u;this.bgi();this.BKc=this.f$d=this.TPc=!1;this.qPc=0}z=b(0);var c=b(13),e=b(82),l=b(111),m;(function(u){u[u.SendNotification=
0]="SendNotification";u[u.SendPersistentState=1]="SendPersistentState";u[u.FindSession=2]="FindSession";u[u.Last=3]="Last"})(m||(m={}));Object(z.b)("ApiType",m);var n;(function(u){u[u.AttemptCount=0]="AttemptCount";u[u.SuccessCount=1]="SuccessCount";u[u.DropCount=2]="DropCount";u[u.FailedCount=3]="FailedCount";u[u.LatencyOverThresholdCount=4]="LatencyOverThresholdCount";u[u.LatencyUnderThresholdCount=5]="LatencyUnderThresholdCount";u[u.ThrottledCount=6]="ThrottledCount";u[u.Last=7]="Last"})(n||(n=
{}));Object(z.b)("EventCountType",n);var h=b(1095);b.d(F,"a",function(){return a});a.prototype.pKj=function(u){this.lee=u;window.setInterval(Object(e.a)(this,this.rxd,"logMetricsBatchAndReset"),u);this.wPc=(new Date).getTime()};a.prototype.qy=function(u,w){this.vBj(u)&&!this.f$d||this.TDh||!window.navigator.onLine||this.Yg.b8a||(this.Xp[u][w]++,this.TPc=!0)};a.prototype.bgi=function(){this.Xp=Array(3);for(var u=0;3>u;u++){this.Xp[u]=Array(7);for(var w=0;7>w;w++)this.Xp[u][w]=0}};a.prototype.XUg=function(){for(var u=
{},w=0;3>w;w++)for(var r=0;7>r;r++)this.Eti(w,r)&&(u[m[w]+n[r]]=this.Xp[w][r]);u.FSDomain=this.DXe;u.ConnectionDomain=this.pFe;u.FSRetryInterval=this.xZe;u.MaxPayloadSize=this.vtf;u.LogNumber=this.qPc;1===this.qPc&&(u.FSLatencies=h.a.instance.DUh(),u.ConLatencies=h.a.instance.sRh());return u};a.prototype.Eti=function(u,w){return 2===u&&3!==w&&0!==w?!1:!0};a.prototype.vBj=function(u){return 2===u?!1:!0};a.prototype.rxd=function(){if(this.TPc){this.qPc++;if((new Date).getTime()-this.wPc<5E3+this.lee){var u=
l.a.toJSON(this.XUg());c.ULS.sendTraceTag(50644352,500,15,u)}this.wPc=(new Date).getTime();for(u=0;3>u;u++)for(var w=0;7>w;w++)this.Xp[u][w]=0;this.TPc=!1}};a.prototype.yDi=function(){this.f$d=!0};a.create=function(u){a.instance||(a.Na=new a(u));return a.instance};uk.Object.defineProperties(a.prototype,{TDh:{configurable:!0,enumerable:!0,get:function(){return this.BKc}}});uk.Object.defineProperties(a,{instance:{configurable:!0,enumerable:!0,get:function(){return a.Na}}});a.Na=null;Object(z.a)(a,"FrequentLoggingMetrics",
null,[350])},1207:function(z,F,b){b.d(F,"a",function(){return a});z=b(0);var a;(function(c){c[c.disconnected=0]="disconnected";c[c.connecting=1]="connecting";c[c.connected=2]="connected"})(a||(a={}));Object(z.b)("ChannelConnectionState",a)},1208:function(z,F,b){function a(e,l,m,n){var h=c.call(this)||this;h.type=e;h.S8=l;h.Ihh=m;h.spa=n;return h}b.d(F,"a",function(){return a});z=b(0);var c=Sys.EventArgs;Am(a,c);Object(z.a)(a,"SendUpdateNotificationEventArgs",Sys.EventArgs,[])},1209:function(z,F,b){function a(){}
b.d(F,"a",function(){return a});z=b(0);a.oPd="rr";a.moj="rd";a.koj="rbp";a.GQd="sa";Object(z.a)(a,"RtcReconnectParams",null,[])},1210:function(z,F,b){function a(c,e,l,m){this.pFi=c;this.rCa=e;this.lEi=l;this.B6h=m}b.d(F,"a",function(){return a});z=b(0);Object(z.a)(a,"ThrottlerManagerSettings",null,[])},1298:function(z,F,b){function a(){this.$a=new ka.a}function c(da,ha){var qa=ra.call(this)||this;qa.type=da;qa.yZj=ha;return qa}function e(da){var ha=ba.call(this)||this;ha.z3c=da;return ha}function l(da,
ha){var qa=ia.call(this)||this;qa.p4j=da;qa.c5j=ha;return qa}function m(da,ha,qa){var Aa=J.call(this)||this;Aa.type=da;Aa.presence=ha;Aa.spa=qa;return Aa}function n(da,ha){var qa=P.call(this)||this;qa.B4j=da;qa.errorMessage=ha;return qa}function h(da){var ha=I.call(this)||this;ha.hubConnection=da;return ha}function u(da,ha,qa,Aa,Fa,ab){var Ua=S.call(this)||this;Ua.dhb=da;Ua.V4c=ha;Ua.F5g=qa;Ua.BVe=Fa;Ua.c3c=Aa;Ua.stopwatch=ab;return Ua}function w(da){var ha=Z.call(this)||this;ha.w5j=da;return ha}
function r(da,ha){ha=void 0===ha?null:ha;var qa=ea.call(this)||this;qa.vC=da;qa.dCg=ha;return qa}function B(da,ha){var qa=Q.call(this)||this;qa.type=da;qa.JP=ha;return qa}function y(da){var ha=U.call(this)||this;ha.z3c=da;return ha}function v(da){var ha=H.call(this)||this;ha.presence=da;return ha}function A(da,ha){var qa=C.call(this)||this;qa.Y1g=da;qa.spa=ha;return qa}function t(da,ha){var qa=E.call(this)||this;qa.newState=da;qa.oldState=ha;return qa}z=b(0);var E=Sys.EventArgs;Am(t,E);Object(z.a)(t,
"ChangedConnectionStateEventArgs",Sys.EventArgs,[]);var C=Sys.EventArgs;Am(A,C);Object(z.a)(A,"ClientInfoEventArgs",Sys.EventArgs,[]);var H=Sys.EventArgs;Am(v,H);Object(z.a)(v,"MyPresenceUpdatedEventArgs",Sys.EventArgs,[]);var U=Sys.EventArgs;Am(y,U);Object(z.a)(y,"PersistentStateClearedEventArgs",Sys.EventArgs,[]);var Q=Sys.EventArgs;Am(B,Q);Object(z.a)(B,"PersistentStateUpdateEventArgs",Sys.EventArgs,[]);var O=b(1371),ea=Sys.EventArgs;Am(r,ea);uk.Object.defineProperties(r.prototype,{type:{configurable:!0,
enumerable:!0,get:function(){return this.vC}},S8:{configurable:!0,enumerable:!0,get:function(){return this.dCg}}});Object(z.a)(r,"UpdateNotificationEventArgs",Sys.EventArgs,[]);var Z=Sys.EventArgs;Am(w,Z);Object(z.a)(w,"GotCompletePersistentStateWithMetadataEventArgs",Sys.EventArgs,[]);var S=Sys.EventArgs;Am(u,S);Object(z.a)(u,"RefreshAllPersistentStateEventArgs",Sys.EventArgs,[]);var I=Sys.EventArgs;Am(h,I);Object(z.a)(h,"RefreshProxyEventArgs",Sys.EventArgs,[]);var P=Sys.EventArgs;Am(n,P);Object(z.a)(n,
"RtcConnectFailedEventArgs",Sys.EventArgs,[]);var J=Sys.EventArgs;Am(m,J);Object(z.a)(m,"SendPersistentStateEventArgs",Sys.EventArgs,[]);var aa=b(1208),ia=Sys.EventArgs;Am(l,ia);Object(z.a)(l,"SessionPropertiesChangedEventArgs",Sys.EventArgs,[]);var ba=Sys.EventArgs;Am(e,ba);Object(z.a)(e,"UpdatePersistentStateClearedRequestEventArgs",Sys.EventArgs,[]);var ra=Sys.EventArgs;Am(c,ra);Object(z.a)(c,"UpdatePersistentStateRequestEventArgs",Sys.EventArgs,[]);var ka=b(96);b.d(F,"a",function(){return a});
a.prototype.N8i=function(da,ha){this.$a.raiseEvent("CSC",new t(da,ha))};a.prototype.x9i=function(da){this.$a.raiseEvent("RP",new h(da))};a.prototype.qtc=function(da){this.$a.raiseEvent("RC",da)};a.prototype.z9i=function(){this.$a.raiseEvent("RMID")};a.prototype.w9i=function(da,ha,qa,Aa,Fa,ab){this.$a.raiseEvent("RPS",new u(da,ha,qa,Aa,Fa,ab))};a.prototype.APf=function(da,ha){this.$a.raiseEvent("UPSR",new c(da,ha))};a.prototype.kPf=function(da,ha){this.$a.raiseEvent("PU",new O.a(da,ha))};a.prototype.l9i=
function(da){this.$a.raiseEvent("MPU",new v(da))};a.prototype.AJd=function(da,ha,qa,Aa){this.$a.raiseEvent("SUN",new aa.a(da,ha,qa,Aa))};a.prototype.M9i=function(da,ha){this.$a.raiseEvent("UNR",new r(da,ha))};a.prototype.sPf=function(da,ha,qa){this.$a.raiseEvent("SP",new m(da,ha,qa))};a.prototype.t9i=function(da,ha){this.$a.raiseEvent("PSU",new B(da,ha))};a.prototype.s9i=function(da){this.$a.raiseEvent("PSC",new y(da))};a.prototype.h9i=function(da){this.$a.raiseEvent("IPSC",new y(da))};a.prototype.N9i=
function(da){this.$a.raiseEvent("UPSC",new e(da))};a.prototype.C9i=function(da,ha){this.$a.raiseEvent("SPC",new l(da,ha))};a.prototype.pPf=function(da,ha){this.$a.raiseEvent("RCF",new n(da,ha))};a.prototype.b9i=function(da){this.$a.raiseEvent("CPSWM",new w(da))};a.prototype.L9i=function(da,ha){this.$a.raiseEvent("UCI",new A(da,ha))};a.prototype.c_a=function(da){this.$a.addHandler("CSC",da)};a.prototype.Nuc=function(da){this.$a.removeHandler("CSC",da)};a.prototype.HKg=function(da){this.$a.addHandler("RP",
da)};a.prototype.GKg=function(da){this.$a.addHandler("RC",da)};a.prototype.LKg=function(da){this.$a.addHandler("RMID",da)};a.prototype.FKg=function(da){this.$a.addHandler("RPS",da)};a.prototype.yLg=function(da){this.$a.addHandler("UPSR",da)};a.prototype.OGa=function(da){this.$a.addHandler("PU",da)};a.prototype.XAa=function(da){this.$a.removeHandler("PU",da)};a.prototype.pJg=function(da){this.$a.addHandler("IPU",da)};a.prototype.wLg=function(da){this.$a.addHandler("UCI",da)};a.prototype.YKg=function(da){this.$a.addHandler("SUN",
da)};a.prototype.qJg=function(da){this.$a.addHandler("IUNR",da)};a.prototype.i_a=function(da){this.$a.addHandler("UNR",da)};a.prototype.zJb=function(da){this.$a.removeHandler("UNR",da)};a.prototype.oJg=function(da){this.$a.addHandler("IPSU",da)};a.prototype.nJg=function(da){this.$a.addHandler("IPSC",da)};a.prototype.xLg=function(da){this.$a.addHandler("UPSC",da)};a.prototype.XKg=function(da){this.$a.addHandler("SP",da)};a.prototype.$Kg=function(da){this.$a.addHandler("SPC",da)};a.getInstance=function(){return a.Na||
(a.Na=new a)};a.Na=null;Object(z.a)(a,"RtcEventHub",null,[372])},1302:function(z,F,b){function a(P,J,aa,ia,ba,ra,ka,da,ha,qa,Aa,Fa,ab){var Ua=this;ab=void 0===ab?null:ab;this.ide=(new Date(0)).getTime();this.ree=0;this.KVb=!1;this.hke=null;this.LKd=36E5;this.PWa=a.Pdf;this.Rjb=0;this.cSa=null;this.rea=0;this.rdb=this.qFe=null;this.Syg=[u.rBb,u.errorMessage,u.Y8f,u.LC,u.y7,u.O8e,u.Y9a,u.rCa,u.d$a];this.Ryg=[u.rBb,u.errorMessage];this.LC=this.Qmc=null;this.b$d=new m(Aa?Aa:function(){return v.AFrameworkApplication.uj},
ba,ra,ka,P,J);this.Eib=Fa;this.Ih=ia;this.Yg=J;this.Hsg=aa;this.Zl=da;this.sh=ha;this.akb=ab;this.c$d=!1;this.Lac=9E4;qa&&qa.execute(function(bb){bb.f0b(function(){w.ULS.sendTraceTag(40768456,500,50,"Connection parameters refresh requested for client [{0}]",Ua.Zl);Ua.b$d.SRf()})});2>=100*Math.random()&&(this.LKd=3E5);O.a.instance&&(O.a.instance.xZe=this.LKd)}function c(){}function e(){}function l(){}function m(P,J,aa,ia,ba,ra){this.EFa=null;var ka=b(1302).FindSessionStrategy;this.lyg=P;P=String.format("{0}={1}",
n.clientId,U.a.rf(ia));P=String.format("{0}&{1}={2}",P,n.userSessionId,U.a.rf(ba));P=String.format("{0}&{1}={2}",P,n.VZj,U.a.rf(aa.toString()));P=String.format("{0}&{1}={2}",P,n.userType,U.a.rf("1"));P=String.format("{0}&{1}={2}",P,n.n_j,U.a.rf(J));P=String.format("{0}&{1}={2}",P,n.b2g,U.a.rf(ka.$1g));(J=m.NOh(aa,ra))&&(P=String.format("{0}&{1}",P,J));this.Nqg=P}function n(){}function h(){this.P8e=this.ttf=this.utf=this.ytf=0;this.Sjc=!1;this.correlationId=this.LC=this.y7=this.W4c=this.errorMessage=
null}function u(){}b.r(F);z=b(0);var w=b(13),r=b(82),B=b(199),y=b(1207);u.d$a="throttling_messageDelay";u.rBb="enabled";u.rCa="throttling_timeToWaitForResponse";u.Y9a="throttling_maxNumberOfOutstandingMessages";u.O8e="throttling_globalMaxNumberOfOutstandingMessages";u.errorMessage="errorMessage";u.Y8f="url";u.y7="queryString";u.LC="connectionString";Object(z.a)(u,"RtcFindSessionOutputFieldNameConstants",null,[]);var v=b(4),A=b(79),t=b(37),E=b(495),C=b(896),H=b(111),U=b(28),Q=b(186);uk.Object.defineProperties(h.prototype,
{K4g:{configurable:!0,enumerable:!0,get:function(){return this.W4c+"?"+this.y7}}});Object(z.a)(h,"FindSessionResponse",null,[]);n.clientId="ClientId";n.VZj="UserApp";n.userSessionId="usid";n.userType="UserType";n.n_j="UserVersion";n.htc="qs";n.b2g="clientProtocol";n.wIi="NoAuth";Object(z.a)(n,"RtcFindSessionInputQueryParamConstants",null,[]);m.prototype.SRf=function(){this.EFa=this.lyg()};m.prototype.Afd=function(){this.EFa&&""!==this.EFa||(this.SRf(),w.ULS.sendTraceTag(575784194,500,this.EFa&&""!==
this.EFa?50:15,"Query signature delegate called for refresh returned: {0} ",this.EFa));var P=String.format("{0}={1}",n.htc,U.a.rf(this.EFa));return String.format("{0}&{1}",P,this.Nqg)};m.NOh=function(P,J){return 4===P?String.format("{0}={1}",n.wIi,"1"):J?J.l5h():null};Object(z.a)(m,"FindSessionQueryStringGenerator",null,[]);var O=b(1147),ea=b(1095),Z=b(927),S=b(1210);l.nHh="FSType";Object(z.a)(l,"RtcFindSessionRequestHeaders",null,[]);e.iaj="polling";Object(z.a)(e,"RtcFindSessionTypes",null,[]);var I=
b(1209);c.d0j="RTC-TokenProofkey";c.Vti="RTC-IsWacJsBootFsRequest";Object(z.a)(c,"RtcRequestHeaders",null,[]);b.d(F,"FindSessionStrategy",function(){return a});a.prototype.Yxj=function(P){this.rdb=P};a.prototype.init=function(){this.sh.LKg(Object(r.a)(this,this.Clj,"resetGetMachineIdDelay"));this.sh.c_a(Object(r.a)(this,this.aX,"onConnectionStateChanged"))};a.prototype.aX=function(P,J){this.rea=J.newState;2===J.newState&&(this.Rjb=0)};a.prototype.w2e=function(){var P=this.cSa.correlationId;return{returnValue:String.format("{0}&{1}={2}",
this.cSa.y7,a.vGe,U.a.rf(P)),correlationId:P}};a.prototype.u1h=function(P,J,aa,ia,ba){var ra=this;this.osj(function(){ia(ba,"GetMachineIdSuccess")&&(w.ULS.sendTraceTag(17956951,500,50,"Successfully retrieved Rtc MachineId [{0}] for [{1}]",ra.LC,ra.Zl),P(ra.hke),aa(ra.b4h()))},function(ka){ia(ba,"GetMachineIdFailure")&&(w.ULS.sendTraceTag(4060129,500,15,"Failed to retrieve Rtc MachineId for [{0}]",ra.Zl),J(ka))},ia,ba)};a.prototype.Mkh=function(){this.JCe();this.hdi()};a.prototype.osj=function(P,J,
aa,ia){var ba=this;w.ULS.sendTraceTag(17956952,500,50,"Retrieving Rtc MachineId from server. Getting from last findsession, connectionString is [{0}]",this.LC);if(this.LC)P();else{var ra=this.MXg();window.setTimeout(function(){ba.sendFindSessionRequestToServerInternal(P,J,aa,ia)},ra)}};a.prototype.sendFindSessionRequestToServerInternal=function(P,J,aa,ia){var ba=this;aa(ia,"RequestMachineId")&&(this.ide=(new Date).getTime(),aa=t.a.Ae(),this.x2e(function(ra){var ka=t.a.Ae();ba.mKf(ra);ba.eSd();P();
ra=t.a.Ae()-ka;w.ULS.sendTraceTag(577356039,345,50,"SFSRTS Success - TimeElapsed: {0}",ra)},function(ra){var ka=t.a.Ae();ba.JCe();O.a.instance&&O.a.instance.qy(2,3);J(ra);ra=t.a.Ae()-ka;w.ULS.sendTraceTag(577356040,345,50,"SFSRTS Failure - TimeElapsed: {0}",ra)},!1),aa=t.a.Ae()-aa,w.ULS.sendTraceTag(577599296,345,50,"SFSRTS - TimeElapsed: {0}",aa))};a.prototype.hdi=function(){this.PWa+=a.YXh;this.PWa=Math.min(this.PWa,a.YDi)};a.prototype.MXg=function(){var P=(new Date).getTime();P=this.ide+this.PWa-
P;0>P&&(P=0);return P};a.prototype.mKf=function(P){try{this.cSa=P,this.Qmc=P.K4g,this.LC=P.LC,this.qFe=P.y7,this.hke=P.W4c}catch(J){w.ULS.sendTraceTag(17956953,500,10,"FindSession response contains invalid fields. Exception {0}, is thrown",J.toString())}};a.prototype.JCe=function(){this.LC=null;this.KCe()};a.prototype.eSd=function(){this.KCe();this.KVb=!0;this.ree=window.setTimeout(Object(r.a)(this,this.Mbj,"refreshMachineId"),this.LKd)};a.prototype.KCe=function(){this.KVb&&(window.clearTimeout(this.ree),
this.KVb=!1)};a.prototype.Mbj=function(){var P=this;this.KVb=!1;this.x2e(function(J){var aa=P.qFe!==J.y7,ia=P.LC!==J.LC,ba=P.LC;P.mKf(J);0!==P.rea&&(ia?(w.ULS.sendTraceTag(17956955,500,15,"Recycling RTC connection due to RTC machine id change. old={0}, new={1}",ba||"null",J.LC),P.sh.qtc()):(P.sh.C9i(aa,ia),P.eSd()))},function(){O.a.instance&&O.a.instance.qy(2,3);P.eSd()},!0)};a.prototype.Clj=function(){this.PWa=a.Pdf};a.prototype.b4h=function(){return new S.a(this.cSa.ytf,this.cSa.utf,this.cSa.ttf,
this.cSa.P8e)};a.prototype.sRj=function(P){if(Object.getType(P)!==Object)return null;for(var J in P);return this.E$g(P)};a.prototype.E$g=function(P){if(!(u.rBb in P))return null;for(var J=P[u.rBb],aa=Cl(J?this.Syg:this.Ryg),ia=aa.next();!ia.done;ia=aa.next())if(!(ia.value in P))return null;aa=Object.assign(new h,{Sjc:P[u.rBb],errorMessage:P[u.errorMessage],correlationId:Q.a.create().toString()});J&&(aa.W4c=P[u.Y8f],aa.y7=P[u.y7],aa.LC=P[u.LC],aa.P8e=P[u.O8e],aa.ttf=P[u.Y9a],aa.utf=P[u.rCa],aa.ytf=
P[u.d$a]);return aa};a.prototype.EUh=function(P,J){var aa=this;w.ULS.sendTraceTag(50448152,500,50,"Using FindSessionUtils find session response");this.akb.lHh.continueWith(function(){aa.akb.lHh.result?(w.ULS.sendTraceTag(50448153,500,50,"FindSessionUtils find Session resulted in success"),P(aa.akb.mHh)):(w.ULS.sendTraceTag(50448154,500,15,"FindSessionUtils find Session resulted in error"),J(aa.akb.mHh))})};a.prototype.TWf=function(P,J,aa,ia,ba){var ra=this;ba=void 0===ba?!1:ba;return function(ka){ea.a.instance.zIb(0,
1);P&&P.stop();ra.rdb=null;ra.Eib=null;ra.Nqf(ka.data,!0,J);var da=Z.RtcUtils.deserialize(ka.data.oe,"FindSession",null);if(da)if(da=ra.sRj(da)){if(da.Sjc&&da.y7&&da.LC){w.ULS.sendTraceTag(4317446,500,50,"Successfully retrieved MachineId from server for [{0}]",ra.Zl);ra.pzi(ka.data);aa(da);return}J.FindSessionFailureReason="FindSessionInvalidResponse";J.IsRtcEnabled=da.Sjc;J.IsQueryStringEmpty=!da.y7;J.IsConnectionStringEmpty=!da.LC;w.ULS.sendTraceTag(4290720,500,15,"Response did not contain valid MachineId [ConnectionUrl and/or QueryString] for [{0}]; IsRtcEnabled:{1}; IsQueryStringEmpty:{2}; IsConnectionStringEmpty:{3}",
ra.Zl,da.Sjc,!da.y7,!da.LC)}else J.FindSessionFailureReason="FindSessionTranslateServerResponseFailed",w.ULS.sendTraceTag(8745097,500,15,"Could not translate server response to findSession response for [{0}]",ra.Zl);else J.FindSessionFailureReason="FindSessionDeserializeServerResponseFailed",w.ULS.sendTraceTag(7372827,500,10,"Could not deserialize response data for [{0}]",ra.Zl);ra.qPf(J,ba);ia(null)}};a.prototype.MWf=function(P,J,aa,ia){var ba=this;ia=void 0===ia?!1:ia;return function(ra){ea.a.instance.zIb(0,
1);P&&P.stop();ba.rdb=null;ba.Eib=null;ba.Nqf(ra.data,!1,J);var ka=null,da="unknown",ha="unknown";ra.data&&((da=ra.data.responseHeaders)&&a.tKb in da&&(ka=da[a.tKb].toString()),da=C.a[ra.data.status],ha=ra.data.httpStatus.toString());J.FindSessionFailureReason="FindSessionRequestFailed";J.HttpErrorCode=ha;J.HttpErrorStatus=da;J[a.tKb]=ka;w.ULS.sendTraceTag(4290721,500,15,"Request for MachineId failed with Status='{0}'; HttpStatus='{1}' for [{2}]; RtcErrorCode='{3}'. Polling: '{4}' '",da,ha,ba.Zl,
ka,ia);ba.qPf(J,ia);aa(ha)}};a.prototype.x2e=function(P,J,aa){var ia=this;aa=void 0===aa?!1:aa;var ba=null;w.ULS.sendTraceTag(4317445,500,50,"Getting MachineId from server for [{0}]",this.Zl);var ra={},ka=this.b$d.Afd();ra[E.a.PZ]=Q.a.create().toString();this.rdb&&""!==this.rdb?ka=String.format("{0}&{1}={2}",ka,I.a.oPd,this.rdb):this.Eib&&""!==this.Eib&&(ka=String.format("{0}&{1}={2}",ka,I.a.oPd,this.Eib),ra[c.d0j]="True",ra[c.Vti]="True");ka=this.Hsg+"?"+ka;aa&&(ra[l.nHh]=e.iaj);var da={};da.IsNetworkOfflineBeforeSendRequest=
this.Yg.b8a;da.HasAvailableConnectionsBeforeSendRequest=this.Yg.X$e;da.MaxConnectionsAllowed=this.Yg.Wmc;da.IsRefreshMachineId=aa;this.akb&&!this.c$d?(this.EUh(this.TWf(null,da,P,J,aa),this.MWf(null,da,J,aa)),this.c$d=!0):(this.Ih&&(ba=this.Ih.Hc("WebServiceCall","GetMachineIdFromTheServer")),O.a.instance&&O.a.instance.qy(2,0),0>this.Yg.y$(ka,1,null,ra,[a.M5b,a.tKb,a.WEb,a.nPd,a.avf,a.txf,a.sxf],!1,1,this.TWf(ba,da,P,J,aa),this.MWf(ba,da,J,aa),null,null,!1,null,this.Lac,"3",null,!0)&&(5<this.Rjb&&
200>this.Rjb&&w.ULS.sendTraceTag(578166985,500,15,"FindSession request not scheduled due to expired token. Manually triggered failure callback {0} times.",this.Rjb),window.setTimeout(function(){ia.Rjb++;J("-1")},1E3)))};a.prototype.Nqf=function(P,J,aa){aa||(aa={});aa.IsNetworkOfflineAfterRequestComplete=this.Yg.b8a;aa.IsRequestSucceeded=J;P&&(aa.EnqueueTime=P.M9b,aa.InvokedTime=P.TF,aa.CompletedTime=P.f4,P.responseHeaders&&(a.M5b in P.responseHeaders&&(aa.CorrelationId=P.responseHeaders[a.M5b]),a.WEb in
P.responseHeaders&&(aa[a.WEb]=P.responseHeaders[a.WEb])));w.ULS.sendTraceTag(38633565,500,J?50:15,Z.RtcUtils.FPa(aa))};a.prototype.qPf=function(P,J){P||(P={});P.ConnectionState=y.a[this.rea];J||this.sh.pPf(1,P)};a.prototype.pzi=function(P){try{var J=!1,aa=!1,ia=P.responseHeaders,ba=A.a.HN(P.request.get_url());if(ia&&a.nPd in ia){var ra=ia[a.nPd].toString().toLocaleLowerCase();aa="true"===ra;J="false"===ra}ia=!1;var ka=0<=ba.toLocaleLowerCase().indexOf("collab");aa&&!ka?ia=!0:J&&ka&&(ia=!0);if(ia){J=
{HostName:ba};J.Status=C.a[P.status];J.HttpStatus=P.httpStatus.toString();var da=P.request.get_headers(),ha;for(ha in da){var qa=da[ha];(aa=ha)&&0<aa.length&&(ba=0,qa&&(ba=qa.toString().length),J["r_"+aa]=ba)}if(P.responseHeaders){var Aa=new B.a;Aa.add(a.M5b);Aa.add(a.WEb);Aa.add(a.tKb);Aa.add(a.txf);Aa.add(a.sxf);Aa.add(a.avf);a.yGg(J,P.responseHeaders,Aa)}a.nGg(P.request.get_url(),J);var Fa=H.a.toJSON(J);w.ULS.sendTraceTag(559437006,500,15,Fa)}}catch(ab){w.ULS.sendTraceTag(559437007,500,10,"DomainLandingIncorretDC exception[{0}]",
ab.toString())}};a.createInstance=function(P,J,aa,ia,ba,ra,ka,da,ha,qa,Aa,Fa){return a.wah(P,J,aa,ia,ba,ra,ka,da,ha,qa,Aa,void 0===Fa?null:Fa)};a.wah=function(P,J,aa,ia,ba,ra,ka,da,ha,qa,Aa,Fa){Fa=void 0===Fa?null:Fa;P=P||Q.a.create().toString();P=new a(P,J,aa,ia,ba,ra,ka,da,ha,qa,null,Aa,Fa);P.init();return P};a.yGg=function(P,J,aa){aa=Cl(aa);for(var ia=aa.next();!ia.done;ia=aa.next())ia=ia.value,ia in J&&(P[ia]=J[ia])};a.nGg=function(P,J){if(P){var aa=P.indexOf("?");if(-1!==aa)for(P=P.substr(aa+
1).split("&"),aa=0;aa<P.length;++aa){var ia=P[aa].split("=");if(2===ia.length){var ba=ia[0];if(ba&&0<ba.length){var ra=0;if(ia=ia[1])ra=ia.length;J["q_"+ba]=ra}}}}};a.YXh=3E3;a.YDi=3E5;a.$1g="1.0";a.Pdf=1E3;a.M5b="X-CorrelationId";a.vGe="corrid";a.tKb="RtcErrorCode";a.WEb="X-OfficeCluster";a.nPd="X-NewEnv";a.avf="X-MSEdge-Ref";a.sxf="X-OFFICEFD";a.txf="X-OfficeFE";Object(z.a)(a,"FindSessionStrategy",null,[367])},1370:function(z,F,b){function a(){this.Sfe=this.Tfe=this.Ufe=this.Qfe=this.Pfe=this.Rfe=
this.Ylb=this.zQc=0;this.fUb=this.WOc=this.hlb=this.POc=this.QOc=this.GOc=this.yra=this.elb=this.XXa=this.FOc=this.dUb=this.kXa=null;this.GPc=this.Clb=this.fke=this.K6d=0;this.See=!1;this.bRf=this.rKd;this.eRf=this.uKd;this.dRf=this.tKd;this.iRf=this.wKd;this.hRf=this.vKd;this.CKd=this.DKd;this.zKd=this.AKd;this.wRa=this.xKd;this.AIb=this.yKd;this.cRf=this.sKd;this.yEb=this.MAd;this.Tnc=this.OAd}b.r(F);b.d(F,"RealtimeChannelMetrics",function(){return a});z=b(0);var c=b(13),e=b(242),l=b(111),m=b(927);
a.prototype.rKd=function(){this.zQc++;this.FOc=new Date;this.kXa||(this.kXa=new Date)};a.prototype.uKd=function(){this.Ylb++;this.yra=new Date;this.dUb||(this.dUb=this.yra);this.hlb=this.yra;this.U4g()};a.prototype.tKd=function(){this.Rfe++;this.GOc=new Date};a.prototype.wKd=function(){this.Pfe++;this.XXa=new Date};a.prototype.vKd=function(){this.Qfe++;this.elb=new Date};a.prototype.AKd=function(){this.QOc=new Date;this.Ufe++};a.prototype.yKd=function(){this.fUb||(this.fUb=new Date);this.Tfe++};a.prototype.xKd=
function(){this.POc=new Date;this.Sfe++};a.prototype.DKd=function(){!this.See&&this.zQc&&(c.ULS.sendTraceTag(39321871,500,15,l.a.toJSON(this.e3g())),this.See=!0)};a.prototype.sKd=function(n){var h=m.RtcUtils.nEh(n);n=h.rcf;var u=h.tcf;h=h.exception;if(n&&n!==e.a.SP){var w={};c.ULS.sendTraceTag(40157596,500,15,l.a.toJSON((w.HttpErrorCode=n,w.HttpErrorStatus=u,w.Exception=h,w)));e.a.qgf(n)&&this.K6d++;e.a.Wkf(n)&&this.fke++}};a.prototype.MAd=function(){this.WOc=new Date};a.prototype.OAd=function(){this.XXa=
this.hlb=new Date};a.prototype.e3g=function(){var n={};return n.numberOfConnectionAttempts=this.zQc,n.numberOfSuccessfulConnections=this.Ylb,n.numberOfFailedConnections=this.Rfe,n.numberOfDisconnectedConnections=this.Pfe,n.numberOfExplicitDisconnectedConnections=this.Qfe,n.numberOfSentMessages=this.Ufe,n.numberOfReceivedMessages=this.Tfe,n.numberOfLostMessages=this.Sfe,n.firstConnectionAttempt=this.kXa?this.kXa:null,n.firstMessageReceived=this.fUb?this.fUb:null,n.firstConnectionSuccess=this.dUb?this.dUb:
null,n.lastConnectionAttempt=this.FOc?this.FOc:null,n.lastConnectionSuccess=this.yra?this.yra:null,n.lastConnectionFailure=this.GOc?this.GOc:null,n.lastMessageSent=this.QOc?this.QOc:null,n.lastMessageLost=this.POc?this.POc:null,n.lastDisconnect=this.XXa?this.XXa:null,n.lastExplicitDisconnect=this.elb?this.elb:null,n.lastTimeOnline=this.hlb?this.hlb:null,n.lastTimeOffline=this.WOc?this.WOc:null,n.maxDisconnectedTimeMs=this.Clb,n.maxExplicitDisconnectedTimeMs=this.GPc,n.clientConnectionErrors=this.K6d,
n.serverConnectionErrors=this.fke,n};a.prototype.U4g=function(){this.kXa&&1===this.Ylb&&(this.Clb=Math.max(this.Clb,this.yra.getTime()-this.kXa.getTime()));this.XXa&&1<this.Ylb&&(this.Clb=Math.max(this.Clb,this.yra.getTime()-this.XXa.getTime()));this.elb&&1<this.Ylb&&(this.GPc=Math.max(this.GPc,this.yra.getTime()-this.elb.getTime()))};a.createInstance=function(n){a.Na||(a.Na=new a,c.ULS.sendTraceTag(39321870,500,50,"RealtimeChannelMetrics initialized for client {0}",n));return a.Na};a.Na=null;Object(z.a)(a,
"RealtimeChannelMetrics",null,[368,73])},1371:function(z,F,b){function a(e,l){var m=c.call(this)||this;m.JP=e;m.v4=l;return m}b.d(F,"a",function(){return a});z=b(0);var c=Sys.EventArgs;Am(a,c);Object(z.a)(a,"PresenceUpdatedEventArgs",Sys.EventArgs,[])},1450:function(z,F,b){function a(Na){this.$=Na}function c(Na,Ib,vc,Yc,Md,Ed){var ke=Ef.call(this)||this;ke.Lj=null;ke.qBd=!1;ke.Cnd=null;ke.currentUserId=null;ke.ode=null;ke.BEd=function(mc,Rc){if(Rc.JP){mc=Rc.JP;for(var nd in mc)(mc=nd)&&mc!==ke.currentUserId&&
!ke.h1a.has(mc)&&ke.Ldc(mc).TXj()}};ke.JI=function(){ke.kRf()};ke.oda=function(mc,Rc){ke.qBd=!0;var nd=Object(Eb.a)(Object,Rc.S8);if(1===Rc.type)if(mc=sc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EditorsTableNotification",!1),null===nd||void 0===nd?0:nd[Zd.a.Ibi]){if(!mc||!Object(Eb.a)(String,nd[Zd.a.$bf]))return;mc=ke.UFe(Object(Eb.a)(String,nd[Zd.a.$bf]));Object(Eb.a)(String,nd[Zd.a.acf])===Zd.a.Gbi?(mc=[mc],mc[0]===ke.currentUserId||ke.h1a.has(mc[0])||ke.Ldc(mc[0]).QXj(),ke.iUd(mc)&&
ke.hVa(mc,null)):Object(Eb.a)(String,nd[Zd.a.acf])===Zd.a.Hbi&&mc!==ke.currentUserId&&ke.hVa(null,null)}else{Rc=Array.isArray(Rc.S8)?Rc.S8:null;!Rc&&nd&&(Rc=Array.isArray(nd[Zd.a.VNe])?nd[Zd.a.VNe]:null);if(Rc&&mc)for(var Td=Cl(Rc),Fe=Td.next();!Fe.done;Fe=Td.next())Fe=Fe.value,Fe===ke.currentUserId||ke.h1a.has(Fe)||ke.Ldc(Fe).SXj();sc.EwaSettings.isChangeGateEnabled("OfficeVSO:5930962_ProcessPeerNotificationAsFallback")?Rc&&!ke.iUd(Rc)||ke.hVa(Rc,null):Rc&&(mc||!ke.iUd(Rc))||ke.hVa(Rc,null);return}if(nd)if(0===
Rc.type){var fe;(function(){var rf=ke.rHa(nd);fe=rf.UQf;return rf})().returnValue?(ke.bQa(nd),Zd.a.af in nd&&(ke.$.ea.oY(nd[Zd.a.af],"ContentRefreshManager.OnUpdateNotificationReceived"),ke.vgg())):Ub.ULS.sendTraceTag(22905367,0,50,"RTC ContentUpdate session identifier mismatch. Received: {0}. Expected: {1}. Ignoring this update.",fe,ke.$.ea.e8)}else{if(3===Rc.type){if(!(Zd.a.NYf in nd)){Ub.ULS.sendTraceTag(537154117,13,10,"RTC WetContentUpdate does not specify a type. Ignoring this update.");return}Rc=
nd[Zd.a.NYf];if(Rc===Zd.a.toj)ke.z9h(nd);else if(Rc===Zd.a.roj){if(!sc.EwaSettings.isChangeGateEnabled("OfficeVSO:5935009_UseSignalRForRtc")){if(ke.rHa(nd).returnValue)return;if(Rc=nd[Zd.a.noj])Ub.ULS.sendTraceTag(537154114,0,50,"RTC : FullSaveStarted received. Now invoking ProcessFullSaveStartedNotification web method"),H(ke.$.na.ta,Rc,null,null,null,null)}}else if(Rc===Zd.a.uoj||Rc===Zd.a.voj||Rc===Zd.a.XYf){if(!sc.EwaSettings.isChangeGateEnabled("OfficeVSO:5935009_UseSignalRForRtc")&&sc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.HandleUploadNotificationsRTC",
!0)){if(ke.rHa(nd).returnValue)return;mc=0;Rc!==Zd.a.XYf&&(mc=nd[Zd.a.mPd]);(Td=nd[Zd.a.JYf])&&ke.GZj.Yrc(new e(Rc,mc,Td,ke.Soc))}}else Rc!==Zd.a.soj&&Ub.ULS.sendTraceTag(537154081,13,50,"RTC WetContentUpdate of unknown type {0}. Ignoring this update.",Rc);return}if(4===Rc.type){mc=!1;Zd.a.TKf in nd&&(mc=nd[Zd.a.TKf]);if(ke.rHa(nd).returnValue)return;ke.$.ea.nli()&&ke.I2c();if(ke.$.ea.N8a&&mc)return;Td=nd[Zd.a.y2i];ke.$.ea.sc&&Td&&ke.x2i.Yrc(new n(Td,mc,ke.Soc))}else if(8===Rc.type){if(ke.zfj)return;
var ef=0,If=nd[Zd.a.poj],Ke=nd[Zd.a.JYf],ng=nd[Zd.a.ooj];Zd.a.mPd in nd&&(ef=nd[Zd.a.mPd]);ke.$.ea.sc&&If&&(mc=Object.assign(new r,{OcsSessionId:If,ClientId:Ke&&sc.EwaSettings.isChangeGateEnabled("OfficeVSO:5544917_HookUpRevisionTrackerOnXLO")?Ke:"",SeqNum:ng,XrevidSaved:ef}),Td=function(){Ub.ULS.sendTraceTag(537154080,0,10,"BatchCheckCollabServiceContent failed. OcsSessionId: {0}, ClientId: {1}, SeqNum: {2}, XrevidSaved: {3}",If,Ke,ng,ef)},sc.EwaSettings.ma(472)?(Fe=Array(1),Fe[0]=mc,U(ke.$.na.ta,
Fe,ke.Soc,Td,null,null)):ke.Z2g.Yrc(new w(mc,ke.Soc,Td)))}}2===Rc.type?nd&&ke.rHa(nd).returnValue||(Ub.ULS.sendTraceTag(537154079,0,50,"RTC : FileNameUpdate received. Now invoking CheckWorkbookFileNameUpdate web method"),C(ke.$.na.ta,null,null,null,null)):12!==Rc.type||nd&&ke.rHa(nd).returnValue||ke.raiseEvent("LabelUpdateEventKey")};ke.Soc=function(mc){var Rc=mc.Errors;vd.a.Ar(Rc)?(Rc=vd.a.uG(Rc,[1552731907],"ContentRefreshManager"),vd.a.Xha(Rc)||ke.$.ea.Hp(Rc)):(Rc=mc.StateId+1,mc.Result&&ke.$.ea.af<
Rc&&ke.$.ea.oY(Zd.a.Re,"ContentRefreshManager.OnCheckForUpdateSuccess"))};ke.Vh=function(){ke.joj&&ke.qBd&&ke.$.ea.t9b&&ke.vgg()};ke.Uzf=function(){ke.qBd=!1;ke.$.ea.zoa=500;ke.ode=Ae.a.Ra.Ob};ke.pFb=function(mc,Rc){ke.CWd(Rc.Lj)};ke.$=Na;ke.Cn=Ib;ke.$.na.Hq(ke.Vh);ke.Cn.P_b(ke.pFb);ke.Cn.Qqe(ke.Uzf);ke.Z2g=vc;ke.x2i=Yc;ke.mYj=Md;ke.GZj=Ed;ke.xMa={};ke.h1a=new Set;ke.Cn.d1a();sc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EditorsTableNotification",!1)&&(ke.currentUserId=ke.$.workbookContext.ClientId,
ke.kRf(),ke.$.ea.Qha(ke.JI));ke.zfj=sc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RemoveWebRequestsForCollabServiceContentUpdates",!1);return ke}function e(Na,Ib,vc,Yc){this.i1d=new jf.a(!0);this.i1d.add(vc,Object.assign(new l,{RtcUpdateType:Na,XrevidSaved:Ib,ClientId:vc}));this.Ur=Yc}function l(){}function m(Na,Ib,vc){this.NIc={};this.OIc={};this.Ur=vc;this.j1b(Na,this.NIc);this.j1b(Ib,this.OIc)}function n(Na,Ib,vc){this.tfh=Na;this.Loc=Ib;this.Ur=vc}function h(Na,Ib,vc,Yc){this.HEc=
this.Fsc=this.Qrc=this.lgc=0;this.Vbe=this.Lff=!1;this.clientId=Na;this.Yeh=Ib;this.$=Yc;this.uBi=pe.a.Ae()+vc}function u(Na,Ib,vc,Yc,Md){var Ed=lg.call(this)||this;Ed.pj=Na;Ed.dtj=Ib;Ed.ctj=vc;Ed.e8=Yc;Ed.F3g=Md;return Ed}function w(Na,Ib,vc){this.Kia=new Ee.a;this.Kia.add(Na.ClientId,Na);this.Ur=Ib;this.a5=vc}function r(){}function B(Na){var Ib=Qd.call(this)||this;Ib.Je=null;Ib.mergeSuspensionManager=null;Ib.hya=!1;Ib.AGd=null;Ib.Pd=!1;Ib.pBc=!1;Ib.nBc=!1;Ib.oBc=!1;Ib.zGb=function(vc,Yc){Ib.hya!==
Yc.hya&&(Ib.hya=Yc.hya,Ib.AGd=Ib.hya?null:Ae.a.Ra.Ob)};Ib.vd=function(){Ib.$.uv&&Ib.aMj()};Ib.fd=function(vc,Yc){Yc.sc||Ib.ps(vc,Yc)};Ib.ps=function(){if(0<Ib.fBa.length||0<Ib.Sea.count)Ub.ULS.sendTraceTag(537154128,13,15,"Dropping {0} revisionGeneratedNotifications and {1} stateDownloadedNotifications.",Ib.fBa.length,Ib.Sea.count),Ib.fBa=[],Ib.Sea=new Le.a;Ib.gqb.cancel();Ib.bgg();Ib.Y_d();Ib.gVj()};Ib.MFf=function(vc,Yc){Ib.ZLj();Ib.$Lj();vc=new v;vc.Xluid=Yc.pj;vc.NotificationReceivedOn=Ae.a.Ra.Ob.toISOString();
vc.CurrentPresenceUserCount=Ib.$.ea.Om.length;vc.OurCollabModeIsUsingOcs=Ib.$.ea.N8a;vc.SenderCollabMode=Yc.dtj;vc.SenderClientType=Yc.ctj;vc.SessionSiteIdentifier=Yc.e8;vc.CommandTimeInMs=Yc.F3g;Ub.ULS.sendTraceTag(537154127,13,50,"ContentLatencyTracker.OnRemoteRevisionGenerated: RevisionGeneratedNotification: {0}",JSON.stringify(vc));Ib.fBa.push(vc)};Ib.Qg=function(){Ib.OGe(Ib.$.ea.af,"OnBlockCacheConsistent")};Ib.QFf=function(vc,Yc){(vc=Object(Eb.a)(444,Yc.Df))&&Ib.OGe(vc.cK,"OnRenderedContent")};
Ib.FZj=function(){if(!Ib.$.ea.sc)Ub.ULS.sendTraceTag(537154122,13,15,"ContentLatencyTracker.UploadLatencyTelemetryPeriodically: session isn't active");else if(Ib.fBa.length||Ib.Sea.count){var vc=null;0<Ib.fBa.length&&(vc=Ib.fBa,Ib.fBa=[]);var Yc=null;if(0<Ib.Sea.count){Yc=Array(Ib.Sea.count);for(var Md=0,Ed=Cl(Ib.Sea.values),ke=Ed.next();!ke.done;ke=Ed.next())ke=ke.value,Yc[Md++]=ke;Ib.Sea=new Le.a}Ub.ULS.sendTraceTag(537154120,13,100,"ContentLatencyTracker.UploadLatencyTelemetryPeriodically: Uploading {0} revisionGeneratedNotifications and {1} stateDownloadedNotifications.",
vc?vc.length:0,Yc?Yc.length:0);Md=Ib.$.na.ta;Ed=Ib.tZi;ke=Md.Ma(1,null);ke.GenerateNotifications=vc;ke.DownloadNotifications=Yc;Lb.i(Md,"UploadLatencyTelemetry",ke,Ed,null,null,null,128)}};Ib.tZi=function(vc){vc.Result&&0<vc.Result&&Ib.Vyd()};Ib.$=Na;Ib.Da=we.g(Ib.$).Da;Ib.viewport=we.g(Ib.$).view;Ib.contentRefreshManager=Ib.$.da.Aa(292);Ib.tf=Ib.$.tf;Ib.fBa=[];Ib.Sea=new Le.a;Na=sc.EwaSettings.ma(288)?1E3:3E4;Ib.gqb=Hf.a.instance.RC(Ib.FZj,Na,De.a.i6g,!1,!1);Ib.$.fl(Ib.vd);Ib.$.ea.ek(Ib.fd);Ib.$.ea.dYc(Ib.ps);
Ib.$.da.Ya(291,function(vc){Ib.Je=vc});Ib.$.da.Ya(343,function(vc){Ib.Pd||(Ib.mergeSuspensionManager=vc,Ib.mergeSuspensionManager.q0b(Ib.zGb),Ib.mergeSuspensionManager.hIb())});Ub.ULS.sendTraceTag(537154131,13,50,"ContentLatencyTracker initialized");Ib.vd(Ib.$,null);return Ib}function y(){}function v(){}function A(Na){this.$=Na}function t(Na){this.$=Na}function E(Na){this.$=Na}function C(Na,Ib,vc,Yc,Md,Ed){Ed=Na.Ma(1,void 0===Ed?null:Ed);return Lb.i(Na,"CheckWorkbookFileNameUpdate",Ed,Ib,vc,Yc,Md,
0)}function H(Na,Ib,vc,Yc,Md,Ed,ke){ke=Na.Ma(1,void 0===ke?null:ke);ke.fullSaveId=Ib;return Lb.i(Na,"ProcessFullSaveStartedNotification",ke,vc,Yc,Md,Ed,0)}function U(Na,Ib,vc,Yc,Md,Ed,ke){ke=Na.Ma(1,void 0===ke?null:ke);ke.updateInfo=Ib;return Lb.i(Na,"BatchCheckCollabServiceContent",ke,vc,Yc,Md,Ed,516)}function Q(Na,Ib,vc){var Yc=ug.call(this)||this;Yc.LHd=null;Yc.UQa=null;Yc.eGb=function(Md,Ed){if(Ed.JP){Md=[];var ke=[],mc=we.g(Yc.$).ga,Rc=!(2===mc.Ye||128===mc.Ye);mc=Rc?id.k(mc.va.selectedRanges,
Yc.$):mc.Pa.nc.floatingObject;Ed=Ed.JP;for(var nd in Ed)Yc.presenceView.uLe(mc,Rc,Md,ke,nd);nd=Cl(Yc.WIa);for(Ed=nd.next();!Ed.done;Ed=nd.next())Ed=Ed.value,Array.contains(Md,Ed)||Array.contains(ke,Ed)||Yc.presenceView.uLe(mc,Rc,Md,ke,Ed.UserID);Yc.WIa=[];Array.addRange(Yc.WIa,Md);Array.addRange(Yc.WIa,ke);Yc.LHd&&($d.a.Fa(Yc.UQa),Yc.UQa=null,Yc.LHd=null);var Td=Q.Dye(Md,ke);Yc.UQa=new Tf.a;Yc.LHd=fb.TaskExtensions.Ba(ma.Task.delay(1),function(){Yc.ariaLiveNotifier.$bb(Td,Wf.a.P_a)},Yc.UQa.token,
3)}};Yc.$=Ib;Yc.ariaLiveNotifier=Na;Yc.presenceView=vc;Yc.WIa=[];vc.NGa(Yc.eGb);Yc.$.da.Ha(231,Yc);return Yc}function O(Na){var Ib=wf.call(this)||this;Ib.manager=null;Ib.$=Na;Ib.Xb();return Ib}function ea(Na,Ib){var vc=se.call(this)||this;vc.Lj=null;vc.fieldManagerPane=null;vc.p0=null;vc.zOb=null;vc.rcg=null;vc.messageId=0;vc.Fp=function(){vc.$&&vc.LQd(0,!1)};vc.mj=function(){vc.zYd?vc.zOb(!1):(vc.yc.PresenceType=1,vc.raiseEvent(ea.p1),vc.sendPresenceToService(!1))};vc.Rg=function(){vc.zYd?vc.rcg(!1):
(vc.Hdb(!1),vc.HQd())};vc.kpc=function(){vc.ga.Pa.nc?vc.LQd(1,!1):vc.UQd(0,!1)};vc.mna=function(Yc,Md){vc.raiseEvent(ea.JHd,Md)};vc.ld=function(){vc.UQd(we.g(vc.$).isEditing?1:0,!1)};vc.fd=function(Yc,Md){Je.a(Md)&&(vc.csa={})};vc.XFb=function(){vc.y0f()};vc.MIf=function(Yc,Md){if(Md&&Md.methodName in ea.asc){Yc=!1;switch(ea.asc[Md.methodName]){case 0:Md=Md.parameters.cell;break;case 1:Md=Md.parameters.parameters.Location;break;case 2:Md=id.v(vc.ga.va.activeRange,vc.$);Yc=!0;break;default:return}Md.LastColumn=
Md.FirstColumn;Md.LastRow=Md.FirstRow;Md.NamedObjectName=null;vc.yc.SelectedRange=[Md];vc.yc.PresenceType=0;if(Yc){Md=[];Yc=Cl(vc.$.Ab.LYh());for(var Ed=Yc.next();!Ed.done;Ed=Yc.next()){Ed=Ed.value;var ke={};ke.ObjectType=vc.Gba(Ed.type);ke.ObjectPresenceType=1;ke.ObjectId=Ed.pj;Array.add(Md,ke)}vc.yc.Object=Md}else Md=Rb(Md,vc.$,1),Yc=null,Md&&(Yc={},Yc.ObjectType=vc.Gba(Md.type),Yc.ObjectPresenceType=0,Yc.ObjectId=Md.pj),vc.yc.Object=[Yc];vc.raiseEvent(ea.p1);vc.sendPresenceToService(!1)}};vc.Xn=
function(Yc,Md){Md.context.methodName in ea.asc&&(vc.yc.Object=[null],vc.Hdb(!1))};vc.Vh=function(Yc,Md){Md.context.methodName in ea.asc&&(vc.yc.Object=[null],vc.Hdb(!1))};vc.vd=function(Yc,Md){Md.eL||(vc.csa={},sc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SendPresenterDetailsForExcelLive",!1)&&vc.$.ya.IsMeetingLiveSession&&vc.$.ya.IsMeetingPresenter&&(vc.yc.MeetingInfo=vc.Fid()),vc.$.uv?vc.D6a():vc.pPb())};vc.rd=function(){vc.HQd()};vc.gmf=function(){vc.y0f();vc.kxf.Xz()};vc.$=Na;
vc.ga=we.g(vc.$).ga;vc.zPa=Ib;vc.Xkf=sc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ServiceInit",!1);vc.$.fl(vc.vd);vc.$.Gl(vc.rd);vc.csa={};vc.xYa=new Ud.a(null,null,null,null);vc.wBa={};vc.wBa.b=0;vc.wBa.c=0;vc.kxf=new Z(vc.$);sc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SendPresenterDetailsForExcelLive",!1)&&vc.$.ya.IsMeetingLiveSession&&vc.$.ya.IsMeetingPresenter&&(vc.yc.MeetingInfo=vc.Fid());vc.zYd=sc.EwaSettings.Gb();vc.zYd&&(vc.zOb=lf.a(function(Yc){vc.yc.PresenceType=
1;vc.raiseEvent(ea.p1);vc.sendPresenceToService(Yc)},40,vc.$.la,"SelectionPresenceManager.SendPresenceToService",!0),vc.rcg=lf.a(function(Yc){vc.Hdb(Yc);vc.HQd()},40,vc.$.la,"SelectionPresenceManager.SendCurrentPresence",!0));return vc}function Z(Na){var Ib=vf.call(this)||this;Ib.statusBarManager=null;Ib.$=Na;Ib.$.da.Ya(29,function(vc){Ib.statusBarManager=vc;vc.WJ(Ib)});return Ib}function S(Na,Ib,vc,Yc,Md){Md=void 0===Md?null:Md;var Ed=le.call(this)||this;Ed.Vu={};Ed.Q5b=0;Ed.P5b=0;Ed.rtb=null;Ed.Wvd=
null;Ed.iqf=3E4;Ed.fmd=!1;Ed.LTd=!0;Ed.HHd=null;Ed.RAf=function(){var ke=Ed.yna,mc;for(mc in ke)ke=mc,Ed.Spe(ke)?(Ed.fmc(ke,!0),delete Ed.bbb[ke],delete Ed.yna[ke]):Ub.ULS.sendTraceTag(537154377,0,50,"PresenceView.OnEcsUserListChanged: pending userId=[{0}] still not updated",ke)};Ed.WEd=function(ke,mc){ke={};ke.UpdatedCount=mc.JP?Object.keys(mc.JP).length:0;ke.DisconnectedCount=mc.v4?mc.v4.length:0;ke.Location="canvas";He.b(Ed.$).he(qd.a.QHd,ke);ke=null;Ed.$.Sb&&(ke=Ed.$.Sb.Kh("ModelUpdate","PresenceRendering"),
ke.start());var Rc={};if(mc.JP){if(sc.EwaSettings.isChangeGateEnabled("OfficeVSO:5140517_PresenceBootBreakDownMetrics")){var nd=(new Date).getTime();fb.TaskExtensions.Ba(va.GetServiceTaskFactory.Ua(Ed.$.da,435,436,1),function(rf){rf.result.CAi(nd)},Ed.$.la,3)}Ed.Gvb||(Ed.zxd(!0),Ed.Gvb=!0);var Td=mc.JP;for(Ke in Td){var Fe=Td[Ke],fe=Ke;Ed.yod[fe]=Ae.a.Ra.Ob;if(!fc.g(Ed.$)||null==Fe.NavigationState)if(Ed.YDe(fe,new Date),Ed.nMg(Fe),fe!==Ed.rtb){var ef=Ed.Vu[fe];ef||(Ed.Spe(fe)?Ed.fmc(fe,!0):(fe in
Ed.yna?Ub.ULS.sendTraceTag(537154376,0,50,"PresenceView.OnSelectionPresenceChanged: userId=[{0}] already pending update",fe):(Ed.bbb[fe]=Ae.a.Ra.Ob,Rc[fe]=1),Ed.yna[fe]=!0,ef=Ed.YZh(fe),Ed.Vu[fe]=Ed.bJe(ef)),ef=Ed.Vu[fe]);ef&&(ef.yc=Fe,Fe.SelectedRange&&1<Fe.SelectedRange.length?Ed.Q5b++:Ed.P5b++,Ed.KTf(fe),Ed.e1a(ef))}}if(sc.EwaSettings.isChangeGateEnabled("OfficeVSO:5140517_PresenceBootBreakDownMetrics")&&Ed.$.ea&&Ed.$.ea.u6a){var If=(new Date).getTime();fb.TaskExtensions.Ba(va.GetServiceTaskFactory.Ua(Ed.$.da,
435,436,1),function(rf){rf.result.DAi(If)},Ed.$.la,3)}}if(mc.v4){var Ke=0;for(Td=mc.v4.length;Ke<Td;Ke++)fe=mc.v4[Ke],Ed.u9c[fe]=Ae.a.Ra.Ob,Ed.BTf(fe,!0)}if(mc.v4&&0<mc.v4.length||0<Id.a(Rc).length||0<Id.a(Ed.yna).length)Ke=[],Array.addRange(Ke,Id.a(Rc)),Array.addRange(Ke,Id.a(Ed.yna)),(Rc=Ed.$.da.Aa(292))&&Rc.hVa(Ke,mc.v4);ke&&ke.stop();Ed.fmd=!1;ke=Ed.Vu;for(var ng in ke)if(0===Object(Eb.a)(oa,ke[ng]).yc.CollabMode){Ed.fmd=!0;break}Ed.raiseEvent("pcek",mc)};Ed.Z8=function(ke,mc){mc&&Ed.$.uv&&(mc.cHa.HasAnyNonOcsCoauthor=
Ed.fmd)};Ed.XFb=function(){var ke=new zf.a({},null),mc=Ed.SCa,Rc;for(Rc in mc){var nd=Rc,Td=mc[Rc].yc;Td.SelectedRange=Td.SelectedRangeRaw;ke.JP[nd]=Td}Ed.WEd(Ed,ke)};Ed.ld=function(){Ed.C$e()};Ed.CBi=function(){Ed.Wvd&&yd.a(Ae.a.Ra,Ed.Wvd)<Ed.iqf||(Ed.Wvd=Ae.a.Ra.Ob,Ed.Zwd(),Ed.Gyi(),Ed.ozi(),Ed.Gvb||Ed.zxd(!1))};Ed.Rza=function(){Ed.C$e();var ke=Ed.Vu,mc;for(mc in ke)Ed.e1a(ke[mc])};Ed.rd=function(){Ed.Zwd();Ed.Gvb||Ed.zxd(!1);Ed.Gvb=!1};Ed.iFf=function(){var ke=Ed.Vu,mc;for(mc in ke)ke[mc].dispose();
Ed.Vu={};Ed.tCe();Ed.bbb={};Ed.mRc={};Array.clear(Ed.sy);Ed.Xzc()};Ed.pFb=function(ke,mc){Ed.CWd(mc.Lj)};Ed.u9c={};Ed.yod={};Ed.bbb={};Ed.mRc={};Ed.$=Na;Ed.zPa=Yc;Ed.Cn=Ib;Ed.$je=vc;ra.KMb=!0;ra.Uoa=!0;Ed.D6a();Ed.My=new ba(Na);Ed.$.xa&&Ed.$.xa.Nf(Ed.Rza);Ed.Cn.P_b(Ed.pFb);Na.na&&Ed.$.na.D$(Ed.Z8);Ed.sy=[];Ed.Cn.d1a();Na.da.Ha(25,Ed);Ed.Gvb=!1;Ed.$.Gl(Ed.rd);Ed.RZc=Hf.a.instance.RC(Ed.CBi,Ed.iqf/2,De.a.J5i,!0,!1);Ed.IHd=Md;return Ed}function I(Na,Ib,vc){var Yc=oa.call(this)||this;Yc.JH=new jf.a(!0);
Yc.N5c=0;Yc.O5c=0;Yc.countFloatingObjects=0;Yc.Xq=function(){Yc.SRd()};Yc.Rza=function(){Yc.SRd()};Yc.qA=new Ma(Na);Yc.W4f(Na);Yc.My=vc;Yc.QSd([]);Yc.$=Ib;Yc.$.xa.Nf(Yc.Rza);we.g(Yc.$).vQ(Yc.Xq);return Yc}function P(Na,Ib,vc){var Yc=Gc.call(this,Ib,we.g(Ib),!0,!1,Na.User.UserID)||this;Yc.Mz=[];Yc.F4d=46;Yc.hNb=!1;Yc.ajc=!1;Yc.fGb=function(){if(Yc.Lo.User.UserID===P.excelLiveManager.FQa.KL){var Md=Yc.Lo.UserColor;Yc.Mz.forEach(function(Ed){Ed.style.backgroundColor=Md;Ed.style.opacity="0.1"});Yc.Mz=
[]}};P.M1a||(P.M1a={});Yc.Lo=Na;Yc.Bv=new aa(Yc.gridView,Yc.Lo.User.UserID,Yc.Lo.User.UserName,Yc.Lo.UserColor,Yc,vc,Yc.$,Yc.Lo.IsAnonymous);Yc.fGb=Yc.fGb.bind(Yc);fc.h(Yc.$)&&Yc.xxi();return Yc}function J(Na,Ib,vc){this.lh=this.objectId=this.wEa=null;this.Lo=Na;this.$=Ib;this.My=vc;this.Bv=new aa(we.g(this.$),this.Lo.User.UserID,this.Lo.User.UserName,this.Lo.UserColor,null,vc,this.$,this.Lo.IsAnonymous)}function aa(Na,Ib,vc,Yc,Md,Ed,ke,mc){var Rc=Lc.call(this)||this;Rc.Nb=null;Rc.Wz={};Rc.loe=0;
Rc.Qsa=null;Rc.lh=null;Rc.Xra=0;Rc.JFb=function(nd){Rc.Qsa&&Rc.Qsa!==nd||(Rc.Qsa=null,Rc.I5(!1));Rc.raiseEvent("hidePresenceTooltip")};Rc.qGb=function(nd){Rc.Qsa&&Rc.Qsa!==nd||(Rc.Qsa=null,Rc.Voa(!0,!1));Rc.raiseEvent("showPresenceTooltip")};Rc.pGb=function(nd){Rc.Qsa||Rc.raiseEvent("showFullPresenceTooltip");Rc.Qsa=nd};Rc.eGb=function(){Rc.I5(!1);Rc.raiseEvent("presenceChanged")};mc=vc===je.a.instance.Bb(86)||mc;Rc.xRc=new Ud.a(Ib,vc,Yc,new La.a,null,null,null,null,mc);Rc.gridView=Na;Rc.gVc=Ib;Rc.highlight=
Md;Rc.My=Ed;Rc.$=ke;return Rc}function ia(Na,Ib,vc,Yc,Md){var Ed=Ec.call(this)||this;Ed.sy=[];Ed.E0a=null;Ed.visible=!1;Ed.MCb=null;Ed.eqb=null;Ed.Ova=!1;Ed.ome=null;Ed.mHj=function(){$d.a.Fa(Ed.eqb);Ed.eqb=null;Ed.visible&&(Ed.JNa()?Ed.raiseEvent("showPresenceTooltip"):Ed.I5(!0))};Ed.VDd=function(ke){Ed.ycb(ke)};Ed.Yz=function(){Ed.zgg()};Ed.hG=function(){Ed.zgg()};Ed.domElement=Na;Ed.gridView=Ib;Ed.gVc=Na.id;Ed.Xra=Yc;Ed.$=Md;Ed.Vjc=!1;Ed.Obf();Ed.xRc=vc;Ed.lh=null;Ed.Ax={};Ed.Ax.FirstColumn=0;
Ed.Ax.FirstRow=0;Ed.Ax.LastColumn=0;Ed.Ax.LastRow=0;return Ed}function ba(Na){var Ib=this;this.Wjc=!1;this.Spa=this.PHd=null;this.JFb=function(vc){var Yc=Ib.Mka(vc.cC);Yc&&Ib.Fuc(Yc,vc.qAa.clientId,vc.cC)};this.qGb=function(vc){Ib.HG(!1,vc)};this.pGb=function(vc){Ib.HG(!0,vc)};this.Yz=function(){Ib.sig()};this.hG=function(){Ib.sig()};this.Rza=function(){Ib.Rsb();Ib.clearCache()};this.x5h=function(vc){vc=jc.DOMElementExtensions.getBounds(vc.element);vc=new ge.a(vc.x,vc.y,vc.width,vc.height);for(var Yc=
Cl(ka.RLa()),Md=Yc.next();!Md.done;Md=Yc.next())if(Md=Ib.gridView.Kf(Md.value),Md=jc.DOMElementExtensions.getBoundingClientRect(Md.domElement),(new ge.a(Md.x,Md.y,Md.width,Md.height)).Od(vc))return Md;return null};this.lZj=function(){var vc=Ib.Wz,Yc;for(Yc in vc){var Md=vc[Yc];if(Md){var Ed=Md.JNa(),ke=Ib.Mka(Md.cC),mc=Ed?Ib.C5e(Md.Gsc,Md.paneType,Md.range):null;if(mc!==ke){ke&&Ib.Fuc(ke,Md.qAa.clientId,Md.cC);if(!ra.Uoa)break;mc&&Ed&&(mc.ZZa(Md.qAa),Ib.tVa[Md.cC]=mc,Md.SNb(mc),Ib.Q$e(mc,Md))}else Ib.Q$e(ke,
Md)}}};this.Acf=te.a.Jyh;this.sxa=20;this.gridView=we.g(Na);this.$=Na;this.JHb={};this.tVa={};this.Wz={};this.sVa={};this.$.xa&&this.$.xa.Nf(this.Rza);this.Rsb()}function ra(){}function ka(Na,Ib,vc){var Yc=Mb.call(this)||this;Yc.mAa=null;Yc.NLf=null;Yc.WPd=!1;Yc.Yz=function(){Yc.snd()};Yc.hG=function(){Yc.snd()};Yc.gridView=Na;Yc.rtl=Na.rtl;Yc.nsd=!1;Yc.mi=new jf.a(!0);for(var Md=0;4>Md;Md++)if(Yc.gridView.rb.ktd(vc,ka.RLa()[Md])||1===ka.RLa()[Md]){var Ed=Ib.x9g(),ke=Na.Kf(ka.RLa()[Md]).domElement;
ke.insertBefore(Ed.element,ke.firstChild);Yc.mi.add(Enum.toString(za,ka.RLa()[Md]),Ed)}return Yc}function da(Na,Ib,vc){if(!Ib)return null;Na=Na.Zq;return new Sys.UI.Point(Ib.x+Na.x*(vc?1:-1),Ib.y+Na.y*(vc?1:-1))}function ha(Na){this.Ee=Na;this.Ee.XZa(10,$c.a.instance);this.Ee.XZa(9,me.a.instance);this.Ee.XZa(6,20);this.Ee.XZa(13,rd.a.instance);this.Ee.XZa(17,!1)}function qa(Na,Ib,vc){Na=Gb.call(this,Na)||this;Na.yEa=!1;Na.MUb=!1;Na.L9=!1;Na.HYa=!1;Na.ZA=[];Na.FUb={};Na.Ee=vc;Na.rj=vc.get(8,!1);Na.kae=
vc.get(15,!1);Na.xrg=vc.get(12,0);Na.Bta=vc.get(6,0);Na.rYb=Ib;Na.ine=vc.get(16);Na.fLc=vc.get(17,!1);Na.K3j=vc.get(19,!1);Na.Yxg=vc.get(20,!1);Na.zVb=0;Na.Uxg=new Fa(Na.rj,Na.fLc);Na.bib=Na.G1e();Na.jRc=!1;Na.Nfa=[];Na.Dkb=[];Na.element.id=qa.TLh();Na.element.className=Gb.Tch(Na.rj);Na.Jtb&&(Na.zIndex=Na.Jtb);Na.rtl=Na.rj;Na.Euj(Ib);Na.pga=Na.createElement("div");Na.pga.className="prFlyoutContainer";Na.element.appendChild(Na.pga);Na.JM=[];Na.kra=new Aa(Na.zK,Na.element,Na.Bta,4,6,32,Na.rj);Na.UA=
vc.get(9);Na.UA.qa(jd.a.pointerDown,Na.kra.element,Object(tb.a)(Na,Na.X$a,"onHitTarget"));Na.UA.qa(jd.a.pointerOver,Na.kra.element,Object(tb.a)(Na,Na.X$a,"onHitTarget"));Na.UA.qa(jd.a.pointerOut,Na.kra.element,Object(tb.a)(Na,Na.X$a,"onHitTarget"));return Na}function Aa(Na,Ib,vc,Yc,Md,Ed,ke){this.JM=Na;this._parent=Ib;this.Y6d=vc;this.uqg=Yc;this.dug=Md;this.jZa=Ed;this.PJ=ke;this._element=document.createElement("div");this.element.className="prTouchTarget"}function Fa(Na,Ib){this.rj=void 0===Na?
!1:Na;this.fLc=void 0===Ib?!1:Ib}function ab(Na,Ib,vc,Yc){this.offsetTop=Na;this.offsetLeft=Ib;this.Ojg=void 0===vc?2:vc;this.Sbf=void 0===Yc?4:Yc}function Ua(Na,Ib){var vc=Gb.call(this,Na)||this;vc.Ji=null;vc.UA=null;vc.qJc=null;vc.HMc=null;vc.HIc=null;vc.cra=null;vc.Ome=null;vc.PJ=Ib.get(8,!1);vc.vjb=Ib.get(6,0);vc.iCg=Ib.get(15,!1);vc.Ee=Ib;vc.K9d=0;vc.element=Na;vc.element.className=Ua.NIh;vc.iH=document.createElement("span");vc.element.appendChild(vc.iH);vc.Trg=bb.vSh(Ib.get(6,0));vc.Gv(Ib);
vc._state=5;return vc}function bb(){}function xa(Na,Ib){var vc=kf.call(this)||this;vc.type=Na;vc.Zub=Ib;return vc}function Gb(Na){var Ib=Ve.call(this)||this;Ib._element=null;Ib.element=Na;return Ib}function $b(){this.dQ={}}function oa(){var Na=ae.call(this)||this;Na.qA=null;Na.Bhe=null;Na.Dhe=null;return Na}function Ma(Na){var Ib=Od.call(this)||this;Ib.Tme=Na;Ib.csa=null;Ib.CRc=null;return Ib}function Za(Na){var Ib=Ue.call(this)||this;Ib.$=Na;Ib.Xb();return Ib}function gb(Na){var Ib=this;this.wMf=
this.MHd=this.yMf=this.uMf=this.IKf=this.lPd=this.OYf=this.UYf=this.TYf=!1;this.NHd=this.CGd=this.sKb=this.uKb=this.zwc=this.pPd=0;this.Gkf=!1;this.GAd=this.drb=0;this.akc=!1;this.fd=function(){Ib.akc=!0;Ib.$.ea.tk(Ib.fd)};this.$=Na;Xb.a.JQ&&(this.GAd=window.performance.timing.navigationStart);this.GAd||Ub.ULS.sendTraceTag(537154379,0,15,"Navigation start time is zero");this.$.ea.ek(this.fd)}function zb(){var Na=ne.call(this)||this;Na.lGe=null;Na.Xb();return Na}function nb(){}function pa(){}function Ja(Na){var Ib=
this;this.Oa=new ad.a;this.disposed=!1;this.EGb=function(){Ub.ULS.sendTraceTag(537154381,0,50,"PeopleInfoProvider.OnUserListUpdated fired");Ib.Oa.raiseEvent("UU",Ib)};this.$=Na;this.$.ea.Qha(this.EGb)}function Da(Na){var Ib=Cd.call(this)||this;Ib.manager=null;Ib.$=Na;Ib.Xb();return Ib}function ib(Na){var Ib=ed.call(this)||this;Ib.iua=null;Ib.U1a=null;Ib.Rua=!1;Ib.wFc=!1;Ib.Tf=function(){var vc=Ib.$.ea.Pm;if(null===vc||void 0===vc?0:vc.SheetChanges){vc=Cl(vc.SheetChanges);for(var Yc=vc.next();!Yc.done;Yc=
vc.next())if(Yc=Yc.value,2===Yc.Type){if(Ib.iua)for(var Md=Cl(Ib.iua),Ed=Md.next();!Ed.done;Ed=Md.next())Ed=Ed.value,Ed.Range.SheetName===Yc.Name&&(Ed.Range.SheetName=Yc.NewName);if(Ib.U1a)for(Md=Cl(Ib.U1a),Ed=Md.next();!Ed.done;Ed=Md.next())Ed=Ed.value,Ed.Range.SheetName===Yc.Name&&(Ed.Range.SheetName=Yc.NewName)}}};Ib.BCf=function(){Ub.ULS.sendTraceTag(537154395,0,50,"NamedSheetViewConversionManager.OnGridLoaded");Ib.wFc=!1;Ib.Zoc(Ib,Sys.EventArgs.Empty)};Ib.rd=function(){Ub.ULS.sendTraceTag(537154394,
0,50,"NamedSheetViewConversionManager.OnWorkbookClosing");Ib.wFc=!0};Ib.Zoc=function(){Ub.ULS.sendTraceTag(50620166,0,50,"NamedSheetViewConversionManager.OnConversionOutdatedEvent: triggered with version [{0}]",Ib.$.ea.oza);if(!Ib.$.isEditMode||!Ib.$.ea.sc||Ib.$.ea.q6a||Ib.wFc||Ib.$.ea.oza===Zd.a.G7b)Ub.ULS.sendTraceTag(537154393,0,50,"NamedSheetViewConversionManager.OnConversionOutdatedEvent: Request skipped [Edit Mode: {0}] [IsSessionActive: {1}] [HasRaisedSessionEnded: {2}] [WorkbookClosed: {3}]",
Ib.$.isEditMode,Ib.$.ea.sc,Ib.$.ea.q6a,Ib.wFc);else{Ib.iua=null;Ib.U1a=null;var vc=Ib.$.na.ta.fc(),Yc=Ib.$.na.ta,Md=Ib.eRi,Ed=Ib.dRi,ke=Yc.Ma(1,null);Lb.i(Yc,"GetNamedSheetViewConversion",ke,Md,Ed,null,vc,132)}};Ib.eRi=function(vc){if(vd.a.Ar(vc.Errors)){Ib.Rua=!0;var Yc=[-1100324317,-1857233882];vd.a.uh(vc.Errors,Yc)&&Ub.ULS.sendTraceTag(537154392,0,10,"NamedSheetViewConversionManager.OnGetNamedSheetViewConversionSuccess Errors: [{0}]",vd.a.Wc(vc.Errors));vc=vd.a.uG(vc.Errors,Yc,"NamedSheetViewConversionManager:OnGetNamedSheetViewConversionSuccess");
Ib.$.ea.Hp(vc)}else Ib.Rua=!1,vc=vc.Result,Ib.$.ea.oza=vc.ConversionVersion,Ib.L6i(vc.NamedSheetViewConversionEntries),Ib.P8i()};Ib.dRi=function(vc){Ib.Rua=!0;vc=ie.a.mg(vc.data);Ub.ULS.sendTraceTag(537154391,0,10,"NamedSheetViewConversionManager.OnGetNamedSheetViewConversionFailure: Errors: [{0}].",vd.a.Wc(vc))};Ib.$=Na;Ub.ULS.shipAssertTag(537154397,0,!!Ib.$.ea,"NamedSheetViewConversionManager ctor: EwaControl.SessionStateManager should not be null");Ib.$.Gl(Ib.rd);Ib.$.ea.IU(Ib.BCf);Ib.$.ea.QJg(Ib.Zoc);
Ib.$.ea.Yt(Ib.Tf);Ib.$.ea.uu&&Ib.Zoc(Ib,Sys.EventArgs.Empty);return Ib}function Rb(Na,Ib,vc){if(!Ib||!Ib.Ab)return null;for(var Yc=0;Yc<Ib.Ab.count;Yc++){var Md=Ib.Ab.getItem(Yc);if(Md&&Md.type===vc&&Md.usedRange&&Md.usedRange.contains(id.D(Na))&&uc.a.equals(Md.sheetName,Na.SheetName,!0))return Md}return null}function wc(Na,Ib){return!!Na&&!!Ib&&Na.SheetName===Ib.SheetName&&(!!Na.NamedObjectName&&Na.NamedObjectName===Ib.NamedObjectName||!Na.NamedObjectName&&!Ib.NamedObjectName&&id.D(Na).Od(id.D(Ib)))}
function Cb(){}function lb(Na,Ib,vc,Yc,Md,Ed,ke,mc,Rc){Rc=void 0===Rc?!1:Rc;this.oqa=null;this.$Kc=!0;this.wRc=this.OFa=this.KHc=null;this.$a=new ad.a;this.Hwg=Na;this.sje=Ib;this.Che=vc;this.Ahe=Yc;this.x5d=Ed;lb.re=Md;this.dyg=ke;this.Rra=mc;this.Dyg=Rc;ma.Task.WAA(Ib,vc).continueWith(Object(tb.a)(this,this.fei,"initOnTaskReady"))}function yb(Na){var Ib=Ac.call(this)||this;Ib.e5b=null;Ib.VYf=null;Ib.Wga=null;Ib.sbe=!1;Ib.aX=function(vc,Yc){if(2===Yc.newState){if(Ib.Lj){if(sc.EwaSettings.isChangeGateEnabled("OfficeVSO:5140517_PresenceBootBreakDownMetrics")){var Md=
(new Date).getTime();fb.TaskExtensions.Ba(va.GetServiceTaskFactory.Ua(Ib.$.da,435,436,1),function(Ed){Ed.result.VAi(Md)},Ib.$.la,3)}Ib.raiseEvent("connectionCompleted",new pc(Ib.Lj),Yc)}else Ub.ULS.sendTraceTag(537167630,0,15,"RealTimeChannelController.OnConnectionStateChanged: new state is connected and this.RealTimeChannel is null");Ib.e5b=Yc}else if(2===Yc.oldState||0===Yc.newState)Ib.e5b=null,Ib.raiseEvent("connectionLostEventKey")};Ib.Tqc=function(){if(Ib.Lj){var vc=Object(Eb.a)(328,Ib.Lj);vc&&
(Ub.ULS.sendTraceTag(537167629,0,50,"RealTimeChannelController.OnWorkbookClosed: disconnecting from RTC"),vc.disconnect(),vc.Nuc(Ib.aX))}Ib.Wga=null};Ib.$=Na;Ib.$.Gl(Ib.Tqc);Ib.$.ea.dYc(Ib.Tqc);Na.da.Ya(38,function(vc){vc.Nre(Ib.Tqc)});return Ib}function pc(Na){var Ib=Kc.call(this)||this;Ib.Lj=Na;return Ib}function Ta(){}function rb(Na,Ib,vc,Yc,Md,Ed,ke,mc,Rc){ke=void 0===ke?null:ke;mc=void 0===mc?null:mc;Rc=void 0===Rc?null:Rc;this.Rhe={};this.UIc={};this.Nce=new wa.a;this.Gkb=this.zx=this.DXb=null;
this.hle=this.gle=0;this.mGa=new Ca.a(function(){return ke.NR("PresenceBootLatencyThreshold",1E4)});this.$Da=new Ca.a(function(){return ke.NR("PresenceBootLatencyCutoffThreshold",6E4)});this.BCg=new Ca.a(function(){return ke.NR("PresenceLightupLatencyThreshold",2E3)});this.jrg=new Ca.a(function(){return ke.NR("PresenceLightupLatencyCutoffThreshold",1E4)});this.Txg=Yc;this.U6d=Na;this.rje=Ib;this.asa=vc;this.ni=Md;this.qYa=mc;this.GDa=Ed;this.Nd=Rc;this.L5d=!1;this.init()}function ic(Na,Ib,vc){this.r6d=
this.S6d=this.ySb=this.JSb=this.gWa=0;this._id=Na;this.mGa=Ib;this.$Da=vc;this.jWa=Object(Eb.a)(String,Tb.AFrameworkApplication.hc.Application)||""}function Va(Na,Ib,vc,Yc,Md,Ed,ke,mc,Rc){this.nke=!1;this._id=Na;this.Yp=Ib;this.IM=vc;this.hQc=Yc;this.LUc=Md;this.mGa=Ed;this.$Da=ke;this.N6d=mc;this.GDa=Rc;this.jWa=Object(Eb.a)(String,Tb.AFrameworkApplication.hc.Application)||""}function jb(){this.ct=this.vt=this.d=0}function rc(){this.id=null;this.d=this.tp=this.mp=this.st=this.et=0;this.ct=null;this.vc=
!1}function Cc(Na,Ib,vc,Yc){this.d$=null;this.iKc=this.gQc=!1;this.smb=Na;this.tUc=Ib;this.vb=vc;this.qYa=Yc}function Hc(Na){this.zx=null;this.KSb={};this.HWb={};this.Fkb=null;this.asa=Na}function Nb(Na,Ib,vc,Yc,Md,Ed,ke,mc,Rc){this.dhe=this.V6d=this.zx=null;this.JRb=Na;this.uYb=new gc.a;this.vb=vc;this.VIc=Ib;this.kWa=Yc;this.ni=Md;this.oRc=Ed;this.asa=ke;this.Xog=mc;this.$$d=this.X$d=!1;this.QYb=0;this.T6d=1;this.GDa=Rc;this.Xme=this.vb.ra("PeoplesWellExtraButtonInfoIsEnabled");this.jWa=Object(Eb.a)(String,
Tb.AFrameworkApplication.hc.Application)||""}function nc(Na,Ib){this.d$=null;this.smb=Na;this.Qxg=Ib}b.r(F);var Ha=b(0),tb=b(82);nc.prototype.init=function(){var Na=this;this.smb.continueWith(function(){Na.d$=Na.smb.result;Na.d$.j_a(Object(tb.a)(Na,Na.nG,"onUsersUpdated"))})};nc.prototype.nG=function(){nc.Fve(this.d$.hwa())&&(this.d$.nvc(Object(tb.a)(this,this.nG,"onUsersUpdated")),this.Qxg.IsRealCoauthSession=!0)};nc.Fve=function(Na){var Ib,vc=null;Na=Cl(Na);for(Ib=Na.next();!Ib.done;Ib=Na.next())if(Ib=
Ib.value)if(Ib=Ib.isAnonymous||!Ib.email?Ib.clientId:Ib.email.toUpperCase(),!vc)vc=Ib;else if(vc!==Ib)return!0;return!1};Object(Ha.a)(nc,"CoauthTelemetry",null,[565]);var Ub=b(13),gc=b(161),Eb=b(81),Tb=b(4),Wc;(function(Na){Na[Na.badStatePreventedTelemetry=0]="badStatePreventedTelemetry";Na[Na.notImplemented=1]="notImplemented";Na[Na.renderHandled=2]="renderHandled";Na[Na.renderHandledWithVeto=3]="renderHandledWithVeto"})(Wc||(Wc={}));Object(Ha.b)("CoauthorGalleryTelemetryEndResult",Wc);var T=b(99),
ua=b(111),ma=b(53);Nb.prototype.init=function(){var Na=this;ma.Task.WAA.call(null,this.asa,this.VIc,this.oRc).continueWith(function(){Na.zx=Na.asa.result;Na.V6d=Na.VIc.result;Na.dhe=Na.oRc.result;ma.Task.WAA.call(null,Na.VIc.result.V3c,Na.oRc.result.pCc).continueWith(function(){Na.T6d=Na.V6d.V3c.result;Na.QYb=Na.dhe.pCc.result;Na.zx.j_a(Object(tb.a)(Na,Na.Pqc,"onUsersUpdatedEventListener"));Na.zx.hwa().length&&Na.nG()})})};Nb.prototype.Pqc=function(){this.nG()};Nb.prototype.nG=function(){this.Xog(this.zx.hwa())?
(this.zx.nvc(Object(tb.a)(this,this.Pqc,"onUsersUpdatedEventListener")),this.GPi(this.X$d)):this.uYb.sx(1);this.X$d=!0};Nb.prototype.GPi=function(Na){var Ib=this;this.$$d?this.y$f.continueWith(function(){Ub.ULS.sendTraceTag(42062996,325,15,"We already attempted to log a render of coauthor gallery: {0}",Wc[Ib.y$f.result])}):(this.$$d=!0,this.i7i(0===this.T6d&&!Na))};Nb.prototype.i7i=function(Na){Na?this.kWa.Qk(4,Object(tb.a)(this,this.TDd,"onInteractiveReady")):this.uYb.sx(1)};Nb.prototype.TDd=function(){var Na=
this.ni.VH("AppInitStatus_interactivityReady");Ub.ULS.shipAssertTag(42259235,325,!!this.QYb);var Ib=this.QYb-Na;Na={InteractiveTime:Na};Na.ReactRenderComplete=this.QYb;Na.HadTabSwitch=this.GDa();Na.IsModernGallery=this.Xme;Ub.ULS.sendTraceTag(594883104,325,50,ua.a.toJSON(Na));this.Xme?(Ub.ULS.sendTraceTag(42062997,325,15,Ib.toString()),this.uYb.sx(this.B0j(Ib)?3:2)):Ub.ULS.sendTraceTag(594883103,325,15,Ib.toString())};Nb.prototype.B0j=function(Na){var Ib=Na>this.vb.Cd("CoauthorGalleryTimeToRenderDurationMs",
1E4),vc="Word"===this.jWa;if(this.GDa())return Ub.ULS.sendTraceTag(50455714,325,50,Ib.toString()),!1;vc&&T.Health.instance.recordKpiUsage("CoauthGalleryExperienceDegraded",0,"wordcollabrel",null);Ib&&(vc&&T.Health.instance.recordKpiFailure("CoauthGalleryExperienceDegraded","CoauthorGalleryTimeToRenderDurationIsTooLong",!1,!0,null),Ub.ULS.sendTraceTag(42062998,325,15,Na.toString()));return Ib};uk.Object.defineProperties(Nb.prototype,{y$f:{configurable:!0,enumerable:!0,get:function(){return this.uYb.task}}});
Object(Ha.a)(Nb,"CoauthorGalleryTelemetry",null,[564]);Hc.prototype.Qdc=function(Na){var Ib=this,vc=new gc.a;this.init().continueWith(function(){Na in Ib.KSb?vc.sx(Ib.KSb[Na]):Ib.HWb[Na]=vc});return vc.task};Hc.prototype.init=function(){var Na=this;if(this.Fkb)return this.Fkb.task;this.Fkb=new gc.a;this.asa.continueWith(function(){Na.zx=Na.asa.result;Na.zx.j_a(Object(tb.a)(Na,Na.nG,"onUsersUpdated"));Na.Nhg();Na.Fkb.setResult(null)});return this.Fkb.task};Hc.prototype.Nhg=function(){var Na=this.zx.hwa();
Na.sort(Object(tb.a)(this,this.C4g,"comparePresenceUsers"));this.KSb={};for(var Ib=0;Ib<Na.length&&Na[Ib]&&Na[Ib].ema;Ib++)this.jGg(this.KSb,Na[Ib].clientId,Ib)};Hc.prototype.jGg=function(Na,Ib,vc){Na[Ib]=vc;Ib in this.HWb&&(this.HWb[Ib].sx(vc),delete this.HWb[Ib])};Hc.prototype.nG=function(){this.Nhg()};Hc.prototype.C4g=function(Na,Ib){return Na.ema>Ib.ema?1:Na.ema<Ib.ema?-1:0};Object(Ha.a)(Hc,"CoauthorPositionFinder",null,[562]);var wa=b(199);Cc.prototype.init=function(){var Na=this;this.smb.continueWith(function(){Na.d$=
Na.smb.result;Na.d$.j_a(Object(tb.a)(Na,Na.nG,"onUsersUpdated"))})};Cc.prototype.nG=function(){this.d3g(this.d$.hwa());!this.gQc||this.CJe&&!this.iKc||this.d$.nvc(Object(tb.a)(this,this.nG,"onUsersUpdated"))};Cc.prototype.d3g=function(Na){var Ib=new wa.a,vc=0;Na=Cl(Na);for(var Yc=Na.next();!Yc.done;Yc=Na.next())(Yc=Yc.value)&&Yc.isAnonymous&&(Tb.AFrameworkApplication.nmc("70eb6120;2gfeb930"),this.CJe&&!this.iKc&&(Ib.contains(Yc.userName)?(Ub.ULS.sendTraceTag(526394833,302,50,"Duplicate guest friendly name detected"),
this.iKc=!0):Ib.add(Yc.userName)),Yc.clientId===this.qYa||this.gQc||(vc++,2<=vc&&this.nAi()))};Cc.prototype.nAi=function(){var Na=this;Ub.ULS.sendTraceTag(525112603,302,50,"Multiple guests simultaneously coauthoring");this.gQc=!0;this.r7h&&this.tUc&&this.tUc.continueWith(function(){window.setTimeout(function(){Na.tUc.result.logActivity("MultipleGuestsCoauthoring",null)},5E3)})};uk.Object.defineProperties(Cc.prototype,{CJe:{configurable:!0,enumerable:!0,get:function(){return this.vb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsCustomAnonymousNameEnabled",
!1)}},r7h:{configurable:!0,enumerable:!0,get:function(){return this.vb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GuestCoauthFloodgateEnabled",!1)}}});Object(Ha.a)(Cc,"GuestCoauthTelemetry",null,[]);var Ca=b(613);Object(Ha.a)(rc,"PL",null,[]);var db=b(40);jb.W0f=function(Na,Ib,vc){var Yc=new jb;Yc.d=Na;Yc.vt=Ib;Yc.ct=vc;return db.c(Yc)};Object(Ha.a)(jb,"VD",null,[]);var Sa=b(355);Va.prototype.veto=function(Na){var Ib=this;ma.Task.WAA(this.hQc,this.LUc).continueWith(function(){if(Ib.hQc.result<=
Ib.LUc.result)Na.sx(!1);else{var vc=Ib.IM-Ib.Yp,Yc=new rc;Yc.id=Ib._id;Yc.et=Ib.IM;Yc.st=Ib.Yp;Yc.d=Ib.IM-Ib.Yp;Yc.mp=Ib.hQc.result;Yc.tp=Ib.LUc.result;Yc.ct=Ib.KQh(Ib.N6d);Yc.vc=Ib.GDa();var Md=db.c(Yc),Ed="Word"===Ib.jWa;Ub.ULS.sendTraceTag(42078597,302,15,Md);if(Ed){var ke=new Map;ke.set("data",Md);T.Health.instance.recordKpiUsage("PresenceExperienceDegraded",0,"wordcollabrel",ke)}vc>Ib.mGa.value&&!Ib.nke&&!Yc.vc&&(Ib.nke=!0,Na.sx(!0),Yc=Object.assign(new Sa.a,{inStaging:!0,extendedProperties:new Map}),
Yc.extendedProperties.set("data",Md),Ed&&T.Health.instance.recordKpiFailure("PresenceExperienceDegraded","PresenceRenderDurationIsTooLong",!1,!0,Yc),vc<Ib.$Da.value&&Ub.ULS.sendTraceTag(42078598,302,15,jb.W0f(vc,Ib.mGa.value,Ib.$Da.value)));Na.task.isCompleted||Na.sx(!1)}})};Va.prototype.KQh=function(Na){switch(Na){case 2:return"NonWac";case 0:return"Unknown";case 1:return"Wac";default:return"Unknown"}};Object(Ha.a)(Va,"PresenceLatencyActivityLogger",null,[]);ic.prototype.D2c=function(){!this.LDe&&
this.gWa&&this.JSb&&(this.S6d=this.veto(this.JSb,"CoauthGalleryLightupDurationTooLong"));!this.IAe&&this.gWa&&this.ySb&&(this.r6d=this.veto(this.ySb,"CanvasPresenceLightupDurationTooLong"))};ic.prototype.veto=function(Na,Ib){var vc=Na-this.gWa,Yc=new rc;Yc.id=this._id;Yc.et=Na;Yc.st=this.gWa;Yc.d=vc;var Md=db.c(Yc);Na="Word"===this.jWa;Yc="CanvasPresenceLightupDurationTooLong"===Ib?"PresenceExperienceDegraded":"CoauthGalleryExperienceDegraded";"CanvasPresenceLightupDurationTooLong"===Ib?Ub.ULS.sendTraceTag(572289499,
302,15,Md):Ub.ULS.sendTraceTag(571524118,302,15,Md);if(Na){var Ed=new Map;Ed.set("data",Md);T.Health.instance.recordKpiUsage(Yc,0,"wordcollabrel",Ed)}return vc>this.mGa.value?(Ed=Object.assign(new Sa.a,{inStaging:!0,extendedProperties:new Map}),Ed.extendedProperties.set("data",Md),Md=vc<this.$Da.value,Ed.extendedProperties.set("cash",Md?"true":"false"),Na&&T.Health.instance.recordKpiFailure(Yc,Ib,!1,!0,Ed),Ub.ULS.sendTraceTag(572289500,302,15,jb.W0f(vc,this.mGa.value,this.$Da.value)),Md?2:1):3};uk.Object.defineProperties(ic.prototype,
{tMg:{configurable:!0,enumerable:!0,get:function(){return this.gWa},set:function(Na){this.gWa=Na;this.D2c()}},U2g:{configurable:!0,enumerable:!0,get:function(){return this.JSb},set:function(Na){this.JSb=Na;this.D2c()}},lZg:{configurable:!0,enumerable:!0,get:function(){return this.ySb},set:function(Na){this.ySb=Na;this.D2c()}},LDe:{configurable:!0,enumerable:!0,get:function(){return 0!==this.S6d}},IAe:{configurable:!0,enumerable:!0,get:function(){return 0!==this.r6d}}});Object(Ha.a)(ic,"PresenceLightupLatencyLogger",
null,[]);var hb=b(57),Xb=b(332);rb.prototype.rph=function(Na,Ib,vc){var Yc=this;vc=void 0===vc?null:vc;var Md=void 0===Md?0:Md;vc&&(Ub.ULS.shipAssertTag(42274970,302,!this.qYa||this.qYa===vc,"_myClientId is already set and you are trying to update it to something different"),this.qYa=vc);var Ed=new gc.a;this.init().continueWith(function(){Yc.oVi(Na);Yc.sph(Ed,Na,Ib,Md)})};rb.prototype.init=function(){var Na=this;if(this.Gkb)return this.Gkb.task;this.Gkb=new gc.a;this.GDa()&&Ub.ULS.sendTraceTag(50951700,
302,15,"TabSwitched Session");this.U6d.continueWith(function(){var Ib=Na.U6d.result,vc=Ib.V3c,Yc=Ib.rGi;Yc.continueWith(function(){vc.continueWith(function(){Na.Nd&&Na.Nd.addQosPillar("RealTimeCoauth");Na.JKj(vc.result,Yc.result);Na.Gkb.setResult(null)})})});this.rje.continueWith(function(){Na.DXb=Na.rje.result;Na.DXb.c_a(Object(tb.a)(Na,Na.sWi,"onRtcConnection"));Na.DXb.i_a(Object(tb.a)(Na,Na.wNi,"onCoauthorBootReceived"))});this.asa.continueWith(function(){Na.zx=Na.asa.result;Na.zx.j_a(Object(tb.a)(Na,
Na.Pqc,"onUsersUpdatedEventListener"));0<Na.zx.hwa().length&&Na.nG()});return this.Gkb.task};rb.prototype.Q0e=function(){return this.ni.fua(hb.a.qVa)?this.ni.VH(hb.a.qVa):Xb.a.JQ?window.performance.timing.fetchStart:-1};rb.prototype.sWi=function(Na,Ib){this.L5d||2!==Ib.newState||(Na=Date.now()-this.Q0e(),Ib={},Ib.clientId=this.lvf,Ib.bootTime=Na,this.L5d=!0,this.DXb.zea(15,Ib))};rb.prototype.wNi=function(Na,Ib){if(15===Ib.type){Na=Date.now();Ib=Ib.S8;var vc=Ib.bootTime;this.yid(Ib.clientId).tMg=Na-
vc}};rb.prototype.Pqc=function(){this.nG()};rb.prototype.nG=function(){var Na=Date.now(),Ib=this.zx.hwa(),vc=new wa.a;Ib=Cl(Ib);for(var Yc=Ib.next();!Yc.done;Yc=Ib.next())Yc=Yc.value,this.Nce.contains(Yc.clientId)||(this.Nce.add(Yc.clientId),vc.add(Yc.clientId));if(0<vc.count)for(vc=Cl(vc),Ib=vc.next();!Ib.done;Ib=vc.next())Ib=this.yid(Ib.value),Ib.LDe||(Ib.U2g=Na)};rb.prototype.oVi=function(Na){Na=this.yid(Na);Na.IAe||(Na.lZg=Date.now())};rb.prototype.yid=function(Na){return Na in this.UIc?this.UIc[Na]:
this.UIc[Na]=new ic(Na,this.BCg,this.jrg)};rb.prototype.JKj=function(Na,Ib){Ib=void 0===Ib?0:Ib;this.gle=Na;this.hle=Ib?Ib:(new Date).getTime()};rb.prototype.sph=function(Na,Ib,vc,Yc){vc=vc?vc.getTime():(new Date).getTime();Ib in this.Rhe?Na.pA():(Yc=new Va(Ib,this.X2h(),vc,this.Qdc(this.lvf),this.Qdc(Ib),this.mGa,this.$Da,Yc,this.GDa),this.Rhe[Ib]=Yc,Yc.veto(Na))};rb.prototype.X2h=function(){return 1===this.gle?this.hle:this.Q0e()};rb.prototype.Qdc=function(Na){return this.Txg.Qdc(Na)};uk.Object.defineProperties(rb.prototype,
{lvf:{configurable:!0,enumerable:!0,get:function(){return this.qYa||"{"+Tb.AFrameworkApplication.userSessionId+"}"}}});Object(Ha.a)(rb,"PresenceBootTelemetry",null,[532]);var xb=b(140),Sb=b(254),qb=b(221),mb=b(84),ac=b(565);Ta.prototype.hi=function(Na){var Ib=this;Na.register(nc,"Common.App.CoauthTelemetry.CoauthTelemetry").as("Common.App.CoauthTelemetry.ICoauthTelemetry").Ic().Nc(function(){return new nc(ac.a.lr(Na.qc("Common.IPeopleInfoProvider")),Tb.AFrameworkApplication.hg)});Na.register(Nb,"Common.App.CoauthTelemetry.CoauthorGalleryTelemetry").as("Common.ICoauthorGalleryTelemetry").Ic().Nc(function(){return new Nb(Tb.AFrameworkApplication.Ib,
ac.a.lr(Na.qc("Common.ICoauthoringTelemeryInfoProvider")),Tb.AFrameworkApplication.ha,xb.a.get_instance(),qb.a.instance,ac.a.lr(Na.qc("Common.IPeoplesWell")),ac.a.lr(Na.qc("Common.IPeopleInfoProvider")),nc.Fve,function(){return Ib.lye()})});Na.register(rb,"Common.App.CoauthTelemetry.PresenceBootTelemetry").as("Common.App.CoauthTelemetry.IPresenceBootTelemetry").Ic().Nc(function(){return new rb(ac.a.lr(Na.qc("Common.ICoauthoringTelemeryInfoProvider")),ac.a.lr(Na.qc("Common.IRealtimeChannelBasic")),
ac.a.lr(Na.qc("Common.IPeopleInfoProvider")),Na.resolve("Common.App.CoauthTelemetry.ICoauthorPositionFinder"),qb.a.instance,function(){return Ib.lye()},Tb.AFrameworkApplication.ha,null,T.Health.instance)});Na.register(Hc,"Common.App.CoauthTelemetry.CoauthorPositionFinder").as("Common.App.CoauthTelemetry.ICoauthorPositionFinder").Ic().Nc(function(){return new Hc(ac.a.lr(Na.qc("Common.IPeopleInfoProvider")))});Na.register(Cc,"Common.App.CoauthTelemetry.GuestCoauthTelemetry").Ic().Nc(function(){return new Cc(ac.a.lr(Na.qc("Common.IPeopleInfoProvider")),
ac.a.lr(Na.qc("Common.ISystemInitiatedFeedback")),Tb.AFrameworkApplication.ha,"{"+Tb.AFrameworkApplication.userSessionId+"}")})};Ta.prototype.init=function(){Tb.AFrameworkApplication.ha.tv(function(){mb.a.instance.resolve("Common.App.CoauthTelemetry.CoauthTelemetry").init();mb.a.instance.resolve("Common.App.CoauthTelemetry.GuestCoauthTelemetry").init();Tb.AFrameworkApplication.ha.ra("CoauthorGalleryTelemetryIsEnabled")&&mb.a.instance.resolve("Common.ICoauthorGalleryTelemetry").init();Tb.AFrameworkApplication.ha.ra("CashTelemetryIsEnabled")&&
(mb.a.instance.resolve("Common.App.CoauthTelemetry.IPresenceBootTelemetry"),mb.a.instance.resolve("Common.App.CoauthTelemetry.ICoauthorPositionFinder"))})};Ta.prototype.dispose=function(){};Ta.prototype.lye=function(){return Xb.a.JQ&&qb.a.instance.fua(hb.a.$Pb)?0<qb.a.instance.VH(hb.a.$Pb)[hb.a.ckg]:!1};Ta.main=function(){Sb.a.instance.nj(new Ta)};uk.Object.defineProperties(Ta.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.CoauthTelemetry"}}});Object(Ha.a)(Ta,"CoauthTelemetryPackage",
null,[4,5]);var Uc=b(1014),Zc=b(36),Kc=Sys.EventArgs;Am(pc,Kc);Object(Ha.a)(pc,"ConnectionCompletedEventArgs",Sys.EventArgs,[]);var va=b(51),fb=b(35),Pb=b(52),sc=b(1),hd=b(49),Ob=b(1298),Ac=Zc.a;Am(yb,Ac);yb.prototype.P_b=function(Na){this.addHandler("connectionCompleted",Na)};yb.prototype.nMd=function(Na){this.removeHandler("connectionCompleted",Na)};yb.prototype.$Xc=function(Na){this.addHandler("rtcInitialized",Na)};yb.prototype.vJb=function(Na){this.removeHandler("rtcInitialized",Na)};yb.prototype.Qqe=
function(Na){this.addHandler("connectionLostEventKey",Na)};yb.prototype.eUf=function(Na){this.removeHandler("connectionLostEventKey",Na)};yb.prototype.dispose=function(){this.Lj&&this.Lj.Nuc(this.aX);this.$&&this.$.En(this.Tqc);this.Wga=this.$=null;Ac.prototype.dispose.call(this)};yb.prototype.CIe=function(Na){fb.TaskExtensions.Ba(this.o6e().task,function(Ib){Na(Ib.result)},this.la)};yb.prototype.oFe=function(Na,Ib){this.sbe=Ib;this.HTi(Na)};yb.prototype.d1a=function(){this.Lj&&(this.raiseEvent("rtcInitialized"),
2===this.Lj.connectionState&&this.e5b&&this.raiseEvent("connectionCompleted",new pc(this.Lj),this.e5b))};yb.prototype.cyi=function(){Ub.ULS.sendTraceTag(537167633,0,50,"RealTimeChannelController.OnLoadRealTimeChannelSlice");if(sc.EwaSettings.isChangeGateEnabled("OfficeVSO:5856505_RtcDownloadBreakDownMetrics")){var Na=(new Date).getTime();fb.TaskExtensions.Ba(va.GetServiceTaskFactory.Ua(this.$.da,435,436,1),function(Yc){Yc.result.YAi(Na)},this.$.la,3)}var Ib=[];Ib.push(Pb.a.current.Bo(43));Ib.push(Pb.a.current.Bo(44));
Ib=Pb.a.Hwd(Ib,this.$.la);var vc=Pb.a.loadScript(10,0,1);return ma.Task.WAA.call(null,Ib,vc)};yb.prototype.HTi=function(Na){var Ib=this,vc=this.cyi();fb.TaskExtensions.Ba(vc,function(){Ub.ULS.sendTraceTag(537167632,0,50,"RealTimeChannelController.OnLoadRealTimeChannelSlice Before RealtimeChannel create. RealtimeChannel = null: {0}",void 0===Uc.RealtimeChannel||null===Uc.RealtimeChannel);if(sc.EwaSettings.isChangeGateEnabled("OfficeVSO:5140517_PresenceBootBreakDownMetrics")){var Yc=(new Date).getTime();
fb.TaskExtensions.Ba(va.GetServiceTaskFactory.Ua(Ib.$.da,435,436,1),function(ke){ke.result.ZAi(Yc)},Ib.$.la,3)}Ib.Wga=Uc.RealtimeChannel.createInstance(Na,Ib.$.ya.UserSessionId,Tb.AFrameworkApplication.WYf,Tb.AFrameworkApplication.Ld,null,2,hd.b().m8e(),Ib.$.workbookContext.RtcEndpointUrl,void 0,new Ob.a,void 0,void 0,Ib.$.workbookContext.RtcBootToken);Ub.ULS.sendTraceTag(571770432,0,50,"RealTimeChannelController.OnLoadRealTimeChannelSlice RealtimeChannel created");sc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EditorsTableNotification",
!1)&&(mb.a.instance.register(Uc.RealtimeChannel,"AppRealtimeChannel.RealtimeChannel").as("Common.IRealtimeChannelBasic").as("AppRealtimeChannel.IRealtimeChannel").Ic().Nc(function(){return Ib.Lj}),mb.a.instance.resolve("Common.IRealtimeChannelBasic"));Ib.o6e().setResult(Ib.Lj);if(sc.EwaSettings.isChangeGateEnabled("OfficeVSO:5140517_PresenceBootBreakDownMetrics")){var Md=(new Date).getTime();fb.TaskExtensions.Ba(va.GetServiceTaskFactory.Ua(Ib.$.da,435,436,1),function(ke){ke.result.XAi(Ib.Dqd,Md)},
Ib.$.la,3)}Ib.raiseEvent("rtcInitialized");Ub.ULS.sendTraceTag(571770403,0,50,"RealTimeChannelController.OnLoadRealTimeChannelSlice raise RealTimeChannelInitializedEventKey");var Ed=Object(Eb.a)(328,Ib.Lj);Ed&&(Ub.ULS.sendTraceTag(571770402,0,50,"RealTimeChannelController.OnLoadRealTimeChannelSlice attach changed handler"),Ed.c_a(Ib.aX),Ed.connect())},this.la,3)};yb.prototype.o6e=function(){return this.VYf||(this.VYf=new gc.a)};yb.ka=function(Na){Na.da.Ha(26,new yb(Na))};uk.Object.defineProperties(yb.prototype,
{Lj:{configurable:!0,enumerable:!0,get:function(){return this.Wga}},Dqd:{configurable:!0,enumerable:!0,get:function(){return this.sbe}}});Object(Ha.a)(yb,"RealTimeChannelController",Zc.a,[8,9]);var sb=b(10),ad=b(96),Hd=b(107),Ne=b(26);lb.prototype.CPf=function(){this.$a.raiseEvent("u",null,this)};lb.prototype.fei=function(){this.sje.result&&this.Che.result&&(this.OFa=this.sje.result,this.wRc=this.Che.result,this.OFa.OGa(Object(tb.a)(this,this.mna,"onPresenceUpdated")),this.KHc=new Hd.a(2,2,this.x5d,
Object(tb.a)(this,this.HVj,"updateAwayClientsTask"),88),lb.re.$g(this.KHc))};lb.prototype.mna=function(Na,Ib){(this.$Kc||this.Faj(Ib.JP))&&lb.re.doa(this.KHc,0)};lb.prototype.Faj=function(Na){for(var Ib in Na){var vc=this.Ahe.D5e({key:Ib,value:Na[Ib]});if(vc&&vc.clientId&&(vc=vc.clientId.toLowerCase(),(vc=this.oqa[vc]||this.oqa[vc.toUpperCase()])&&2===vc.status))return!0}return!1};lb.prototype.HVj=function(Na){var Ib=this.OFa.oOh();if(Ib){var vc=new Date,Yc=!1;if(this.$Kc){this.oqa=Ib;this.$Kc=!1;
Ib=this.oqa;for(var Md in Ib){var Ed=Md,ke=Ib[Md];ke.o9a<vc&&(vc=ke.o9a);2===ke.status&&(Yc=!0,this.wRc.MTf(Ed))}Yc&&this.CPf();lb.re.doa(Na,this.E4e(vc))}else{ke=new wa.a;Md=!1;var mc=this.oqa;for(Ed in mc)if(mc=Ed,mc in this.oqa&&this.Hwg.clientId!==mc){var Rc=this.oqa[mc],nd=Ib[mc];if(Rc&&nd){Rc=Rc.status;var Td=nd.status;2===Rc&&1===Td?(ke.add(mc),Ub.ULS.sendTraceTag(38052609,392,50,mc+" returned from away")):1===Rc&&2===Td&&(Md=Yc=!0,this.wRc.MTf(mc),Ub.ULS.sendTraceTag(38052610,392,50,mc+" went away"));
1===Td&&nd.o9a<vc&&(vc=nd.o9a)}}this.oqa=Ib;lb.re.doa(Na,this.E4e(vc));(0<ke.count||Yc)&&this.CPf();0<ke.count&&!this.Dyg?(Na=this.QQh(ke),this.ZPj(Na)):Na=new wa.a;(Md||0<Na.count)&&this.dyg(Ne.a.U3c,2)}}};lb.prototype.ZPj=function(Na){if(Na.count){Na=Cl(Na);for(var Ib=Na.next();!Ib.done;Ib=Na.next())Ib=this.Rra.Caa(String.format(CommonUIStrings.l_EditorsToastArriving,Ib.value),!1),Ib.image=5,Ib.jla="CoAuth_AuthorStatus_16x16x32",this.Rra.OE(Ib)}};lb.prototype.QQh=function(Na){var Ib=this.OFa.ggd(),
vc=new wa.a,Yc;for(Yc in Ib){var Md={key:Yc,value:Ib[Yc]};if(Na.contains(Md.key)){var Ed=this.Ahe.D5e(Md);Ed&&(vc.add(Ed.userName),Na.remove(Md.key))}}vc.count||Ub.ULS.sendTraceTag(38052611,392,10,"There were no coauthor names found");return vc};lb.prototype.E4e=function(Na){var Ib=new Date;return Math.max(Na.getTime()+this.x5d-Ib.getTime(),0)};lb.re=null;Object(Ha.a)(lb,"AwayManager",null,[]);var Ud=b(1372),Ge=b(102),Sc=b(301),Pc=b(224);Object(Ha.a)(Cb,"NamedSheetViewConversionEntry",null,[]);var Zd=
b(9),ie=b(118),vd=b(29),Lb=b(83),id=b(45),uc=b(21),ed=Zc.a;Am(ib,ed);ib.prototype.Are=function(Na){this.addHandler("SVCU",Na)};ib.prototype.HUf=function(Na){this.removeHandler("SVCU",Na)};ib.prototype.dispose=function(){this.U1a=this.iua=null;this.$&&this.$.En(this.rd);this.$.ea&&(this.$.ea.YS(this.BCf),this.$.ea.shj(this.Zoc),this.$.ea.jx(this.Tf));this.$=null;ed.prototype.dispose.call(this)};ib.prototype.k7g=function(Na){return this.Rua?null:this.cGe(Na,this.U1a,"ConvertPresencePublicToPrivate")};
ib.prototype.j7g=function(Na){return this.Rua?null:this.cGe(Na,this.iua,"ConvertPresencePrivateToPublic")};ib.prototype.L6i=function(Na){Na?(this.lgh(Na),this.iua=Na,this.U1a=this.yah(this.iua)):Ub.ULS.sendTraceTag(537154396,0,10,"NamedSheetViewConversionManager.ProcessConversionEntries: conversionEntries can be empty but not null")};ib.prototype.P8i=function(){Ub.ULS.sendTraceTag(537154390,0,50,"NamedSheetViewConversionManager.RaiseConversionUpdatedEvent: new version is update on client from server");
this.raiseEvent("SVCU")};ib.prototype.cGe=function(Na,Ib,vc){if(!Ib||!Ib.length)return Ub.ULS.sendTraceTag(537154389,0,50,"NamedSheetViewConversionManager.{0}: skipping convert due to {1} ConversionEntries. ",vc,Ib?"empty":"null"),Na;vc=Cl(Na);for(var Yc=vc.next();!Yc.done;Yc=vc.next()){Yc=Yc.value;for(var Md=Cl(Ib),Ed=Md.next();!Ed.done;Ed=Md.next())if(Ed=Ed.value,Ed.IsRow&&wc(Ed.Range,Yc)&&!(Yc.FirstRow<=Ed.Range.FirstRow&&Yc.LastRow>=Ed.Range.LastRow)){var ke={};ke.SheetName=Yc.SheetName;ke.FirstRow=
ke.LastRow=Yc.FirstRow;ke.FirstColumn=ke.LastColumn=Yc.FirstColumn;wc(Ed.Range,ke)?(ke=Yc.FirstRow-Ed.Range.FirstRow,0>ke||ke>=Ed.ConversionMap.length?Ub.ULS.sendTraceTag(537154388,0,10,"NamedSheetViewConversionManager.ConvertRanges: invalid mapIndex after adjust. Index: [{0}], ConversionMap.Length: {1}",ke,Ed.ConversionMap.length):(ke=Ed.ConversionMap[ke]-ke,Yc.FirstRow+=ke,Yc.LastRow=Yc.FirstRow,Yc.LastColumn=Math.min(Yc.LastColumn,Ed.Range.LastColumn))):Yc.FirstRow<Ed.Range.FirstRow&&Yc.LastRow>=
Ed.Range.FirstRow?Yc.LastRow=Ed.Range.FirstRow-1:Yc.LastColumn>=Ed.Range.FirstColumn&&(Yc.LastColumn=Ed.Range.FirstColumn-1)}if(0>Yc.FirstRow||Yc.FirstRow>Zd.a.By)Yc.FirstRow=Math.max(Math.min(Yc.FirstRow,Zd.a.By),0);if(0>Yc.LastRow||Yc.LastRow>Zd.a.By)Yc.LastRow=Math.max(Math.min(Yc.LastRow,Zd.a.By),0);if(0>Yc.FirstColumn||Yc.FirstColumn>Zd.a.yv)Yc.FirstColumn=Math.max(Math.min(Yc.FirstColumn,Zd.a.yv),0);if(0>Yc.LastColumn||Yc.LastColumn>Zd.a.yv)Yc.LastColumn=Math.max(Math.min(Yc.LastColumn,Zd.a.yv),
0)}return Na};ib.prototype.yah=function(Na){if(!Na||!Na.length)return Ub.ULS.sendTraceTag(537154387,0,50,"NamedSheetViewConversionManager.CreateInverseConversionEntries: skip creating inverse due to {0} ConversionEntries. ",this.iua?"empty":"null"),Na;for(var Ib=Array(Na.length),vc=0;vc<Na.length;++vc){var Yc=new Cb;Yc.Range=Na[vc].Range;Yc.IsRow=Na[vc].IsRow;Yc.ConversionMap=Array(Na[vc].ConversionMap.length);Yc.IsRow||(this.Rua=!0,Ub.ULS.sendTraceTag(537154386,0,10,"NamedSheetViewConversionManager.CreateInverseConversionEntries: adjusting presence against column sort map is NYI."));
for(var Md=0;Md<Na[vc].ConversionMap.length;++Md)Yc.ConversionMap[Na[vc].ConversionMap[Md]]=Md;Ib[Na.length-vc-1]=Yc}return Ib};ib.prototype.lgh=function(Na){if(Na&&Na.length){Na=Cl(Na);for(var Ib=Na.next();!Ib.done;Ib=Na.next()){Ib=Ib.value;this.kgh(Ib);var vc=Ib.IsRow?Ib.Range.LastRow-Ib.Range.FirstRow+1:Ib.Range.LastColumn-Ib.Range.FirstColumn+1;Ib.ConversionMap.length!==vc&&(Ub.ULS.shipAssertTag(537154385,0,!1,"NamedSheetViewConversionManager.DecompressEntries: decompressed conversion map doesn't match expected size - Expected: [{0}] | Actual: [{1}]",
vc,Ib.ConversionMap.length),this.Rua=!0)}}};ib.prototype.kgh=function(Na){var Ib=Na.ConversionMap;if(Ib&&Ib.length)if(0>Ib[0])Ub.ULS.shipAssertTag(537154384,0,!1,"NamedSheetViewConversionManager.DecompressConversionMap: conversionMap starts with a negative number"),this.Rua=!0;else{for(var vc=[],Yc=0;Yc<Ib.length;++Yc)if(0>Ib[Yc])for(var Md=Ib[Yc-1],Ed=-1*Ib[Yc],ke=1;ke<=Ed;++ke)Array.add(vc,Md+ke);else Array.add(vc,Ib[Yc]);Na.ConversionMap=vc}};Object(Ha.a)(ib,"NamedSheetViewConversionManager",Zc.a,
[634,3]);var Cd=Pc.a;Am(Da,Cd);Da.prototype.create=function(){this.Eb(this.manager||(this.manager=new ib(this.$)))};Object(Ha.a)(Da,"NamedSheetViewConversionManagerFactory",Pc.a,[]);var $d=b(89),La=b(1211);Ja.prototype.dispose=function(){this.disposed||(this.$&&this.$.ea&&this.$.ea.eea(this.EGb),$d.a.tc([this.Oa]),this.$=this.Oa=null,this.disposed=!0)};Ja.prototype.j_a=function(Na){this.Oa.addHandler("UU",Na)};Ja.prototype.nvc=function(Na){this.Oa.removeHandler("UU",Na)};Ja.prototype.hwa=function(){for(var Na=
[],Ib=Cl(this.$.ea.Om),vc=Ib.next();!vc.done;vc=Ib.next())vc=vc.value,vc=new Ud.a(vc.User.UserID,vc.User.UserName,vc.UserColor,new La.a(1),null,vc.UserEmail,void 0,void 0,void 0,void 0,void 0,vc.JoinCoauthTime),Array.add(Na,vc);Ub.ULS.sendTraceTag(537154383,0,50,"PeopleInfoProvider.GetAllUsers: Count: [{0}]",Na.length);return Na};Object(Ha.a)(Ja,"PeopleInfoProvider",null,[197,3]);var od=b(734);pa.prototype.OE=function(){Ub.ULS.sendTraceTag(537154380,0,50,"PresenceBootstrapper.AddNotificationBarEntry: User state changed from inactive to active")};
pa.prototype.removeEntry=function(){};pa.prototype.Caa=function(Na,Ib){return new od.a(Na,Ib)};pa.prototype.dispose=function(){};uk.Object.defineProperties(pa.prototype,{isVisible:{configurable:!0,enumerable:!0,get:function(){return!1}}});uk.Object.defineProperties(pa,{instance:{configurable:!0,enumerable:!0,get:function(){pa.Na||(pa.Na=new pa);return pa.Na}}});pa.Na=null;Object(Ha.a)(pa,"NoOpNotificationBar",null,[290,3]);nb.prototype.D5e=function(Na){var Ib=Na.key;Na=Na.value;if(!Na)return null;
var vc=Na.SupportsChat?4:0;return Object.assign(new Ud.a,{clientId:Ib,C2c:Na.ChatThreadId,B2c:Na.ChatThreadDiscoveryUri,xzb:Na.InChat,email:Na.Cid,capabilities:new La.a(vc)})};Object(Ha.a)(nb,"PresenceConverter",null,[633]);var ne=Pc.a;Am(zb,ne);zb.prototype.create=function(){this.Eb(this.lGe||(this.lGe=new nb))};zb.ka=function(Na){Na.da.Ha(159,new zb)};Object(Ha.a)(zb,"PresenceConverterFactory",Pc.a,[]);var qd=b(131),He=b(132);gb.prototype.YAi=function(Na){this.TYf||(this.pPd=Na,this.TYf=!0)};gb.prototype.ZAi=
function(Na){this.UYf||(this.zwc=Na,this.UYf=!0)};gb.prototype.XAi=function(Na,Ib){this.OYf||(this.uKb=Ib,this.Gkf=Na,this.OYf=!0)};gb.prototype.VAi=function(Na){this.lPd||(this.sKb=Na,this.lPd=!0)};gb.prototype.CAi=function(Na){!this.MHd&&this.lPd&&(this.NHd=Na,this.MHd=!0)};gb.prototype.zAi=function(Na){this.IKf||(this.CGd=Na,this.IKf=!0)};gb.prototype.BAi=function(Na){if(!this.uMf&&this.Wha&&!this.akc){this.uMf=!0;var Ib=this.Kgd();Ib.RtcIntializeToPeopleWellServiceCreate=this.CGd-this.uKb;Ib.PeopleWellServiceCreateToPresenceGalleryRender=
Na-this.CGd;Ib.PresenceGalleryRenderTotalTime=Na-this.Wha;He.b(this.$).he(qd.a.vMf,Ib,void 0,!0)}};gb.prototype.EAi=function(Na){if(!this.yMf&&this.Wha&&!this.akc){this.yMf=!0;var Ib=this.Kgd();Ib.RtcIntializeToRtcConnect=this.sKb-this.uKb;Ib.RtcConnectToPresenceSent=Na-this.sKb;Ib.PresenceSentTotalTime=Na-this.Wha;He.b(this.$).he(qd.a.zMf,Ib,void 0,!0)}};gb.prototype.DAi=function(Na){if(!this.wMf&&this.MHd&&this.Wha&&!this.akc){this.wMf=!0;var Ib=this.Kgd();Ib.RtcIntializeToRtcConnect=this.sKb-this.uKb;
Ib.RtcConnectToPresenceRenderInitiate=this.NHd-this.sKb;Ib.PresenceRenderInitiateToPresenceRenderFinish=Na-this.NHd;Ib.PresenceRenderTotalTime=Na-this.Wha;He.b(this.$).he(qd.a.xMf,Ib,void 0,!0)}};gb.prototype.dispose=function(){this.$=null};gb.prototype.Kgd=function(){var Na={};Na.CoAuthorCountsOnBoot=this.$.ea.Om.length;Na.RtcConnectedLaterInSession=this.Gkf;Na.BrowserVisibilityChanged=this.KTg();Na.AppInteractiveAbsTime=this.Wha;Na.NavigationStartTime=this.GAd;Na.AppInteractiveToRtcSliceDownloadInitialize=
this.pPd-this.Wha;Na.RtcSliceDownloadInitializeToRtcSliceLoad=this.zwc-this.pPd;Na.AppInteractiveToRtcSliceLoad=this.zwc-this.Wha;Na.RtcSliceLoadToRtcInitialize=this.uKb-this.zwc;return Na};gb.prototype.KTg=function(){return Xb.a.JQ&&qb.a.instance.fua(hb.a.$Pb)?0<qb.a.instance.VH(hb.a.$Pb)[hb.a.ckg]:!1};uk.Object.defineProperties(gb.prototype,{Wha:{configurable:!0,enumerable:!0,get:function(){if(this.drb)return this.drb;qb.a.instance.fua("AppInitStatus_interactivityReady")&&(this.drb=qb.a.instance.VH("AppInitStatus_interactivityReady"));
this.drb||Ub.ULS.sendTraceTag(537154378,0,15,"App interactive time is zero");return this.drb}}});Object(Ha.a)(gb,"PresenceTelemetry",null,[632,3]);var Ue=Pc.a;Am(Za,Ue);Za.prototype.create=function(){this.Eb(this.$.da.Aa(435)||this.$.da.Ha(435,new gb(this.$)))};Za.ka=function(Na){Na.da.Ha(436,new Za(Na))};Object(Ha.a)(Za,"PresenceTelemetryFactory",Pc.a,[]);var zf=b(1371),Hf=b(46),De=b(43),Ae=b(27),yd=b(116),je=b(14),we=b(20),Bc=b(75),Od=Zc.a;Am(Ma,Od);Ma.prototype.dispose=function(){this.raiseEvent("userPresenceChanged");
this.raiseEvent("userLeft");this.CRc=this.csa=this.Tme=null;Od.prototype.dispose.call(this)};uk.Object.defineProperties(Ma.prototype,{dQb:{configurable:!0,enumerable:!0,get:function(){return this.Tme}},yc:{configurable:!0,enumerable:!0,get:function(){return this.csa||{}},set:function(Na){this.CRc=this.csa;this.csa=Na;this.raiseEvent("userPresenceChanged")}},mId:{configurable:!0,enumerable:!0,get:function(){return this.CRc}}});Object(Ha.a)(Ma,"UserPresence",Zc.a,[]);var ae=Bc.a;Am(oa,ae);oa.prototype.QSd=
function(Na){this.Bhe=Na};oa.prototype.W4f=function(Na){this.Dhe=Na};oa.prototype.e1a=function(){};oa.prototype.B5a=function(){return null};oa.prototype.Ehd=function(){return null};oa.prototype.O8f=function(){};oa.prototype.P8f=function(){};oa.prototype.Khg=function(){};oa.prototype.Uzc=function(){};oa.prototype.Rfc=function(){};oa.eYj=function(Na,Ib){var vc=Na.qA.yc;$d.a.tc(Na.Ly);$d.a.tc([Na.qA]);Na.qA=null;Na.qA=new Ma(Ib);Na.QSd([]);Na.W4f(Ib);Na.yc=vc};uk.Object.defineProperties(oa.prototype,
{Ly:{configurable:!0,enumerable:!0,get:function(){return this.Bhe}},Lo:{configurable:!0,enumerable:!0,get:function(){return this.Dhe}},yc:{configurable:!0,enumerable:!0,get:function(){return this.qA.yc},set:function(Na){this.qA.yc=Na}}});Object(Ha.a)(oa,"IUserGridPresence",Bc.a,[]);var Ad;(function(Na){Na[Na.multipleBrowsersImageClassName=0]="multipleBrowsersImageClassName";Na[Na.peopleImageClassName=1]="peopleImageClassName";Na[Na.peopleImageClusterPath=4]="peopleImageClusterPath";Na[Na.multipleBrowserImageClusterPath=
5]="multipleBrowserImageClusterPath";Na[Na.imageDimension=6]="imageDimension";Na[Na.rtl=8]="rtl";Na[Na.pointerInputManager=9]="pointerInputManager";Na[Na.clickInputManager=10]="clickInputManager";Na[Na.vertical=11]="vertical";Na[Na.zIndex=12]="zIndex";Na[Na.contextMenuInputManager=13]="contextMenuInputManager";Na[Na.imageDomElement=14]="imageDomElement";Na[Na.useIdleTooltip=15]="useIdleTooltip";Na[Na.viewportBoundsCallback=16]="viewportBoundsCallback";Na[Na.flipHorizontalDirection=17]="flipHorizontalDirection";
Na[Na.fixRemoveFadeOutElementCrash=18]="fixRemoveFadeOutElementCrash";Na[Na.ignoreEventOnExpandedTooltip=19]="ignoreEventOnExpandedTooltip";Na[Na.ipWidthAdjustForFlyout=20]="ipWidthAdjustForFlyout"})(Ad||(Ad={}));Object(Ha.b)("PresenceTooltipSettingKeys",Ad);$b.prototype.get=function(Na,Ib){Na=Ad[Na];return"number"===typeof(void 0===Ib?null:Ib)?(Ib=this.dQ[Na])?Number.parseInvariant(Ib.toString()):0:this.dQ[Na]};$b.prototype.add=function(Na,Ib){this.dQ[Ad[Na]]=Ib};$b.prototype.XZa=function(Na,Ib){Ad[Na]in
this.dQ||(this.dQ[Ad[Na]]=Ib)};$b.prototype.remove=function(Na){delete this.dQ[Ad[Na]]};Object(Ha.a)($b,"PresenceTooltipSettings",null,[]);var Ve=ad.a;Am(Gb,Ve);Gb.prototype.dispose=function(){this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element);this.element=null;Ve.prototype.dispose.call(this)};Gb.prototype.createElement=function(Na){return this.element.ownerDocument.createElement(Na)};Gb.prototype.cBc=function(){return!0};Gb.Tch=function(Na){return"prControl"+
(Na?"Rtl":"")};uk.Object.defineProperties(Gb.prototype,{element:{configurable:!0,enumerable:!0,get:function(){return this._element},set:function(Na){this._element=Na}},visible:{configurable:!0,enumerable:!0,get:function(){return"visible"===this.element.style.visibility},set:function(Na){this.element.style.visibility=Na?"visible":"hidden"}},rtl:{configurable:!0,enumerable:!0,get:function(){return"rtl"===this.element.dir.toLowerCase()},set:function(Na){this.element.dir=Na?"rtl":"ltr"}},zIndex:{configurable:!0,
enumerable:!0,get:function(){return this.element.style.zIndex},set:function(Na){this.element.style.zIndex=String(Na)}}});Object(Ha.a)(Gb,"BasePresenceControl",ad.a,[3,348]);var kf=Sys.EventArgs;Am(xa,kf);xa.ula="InteractivityChanged";Object(Ha.a)(xa,"InteractivityChangedEventArgs",Sys.EventArgs,[]);bb.vSh=function(Na){return bb.wSh(Na)};bb.wSh=function(Na){var Ib=document.createElementNS(bb.$2d,"svg");Ib.setAttribute("viewBox",String.format(bb.ifh,bb.Rjg,bb.Qjg));Ib.appendChild(bb.A3h(Na));return Ib};
bb.A3h=function(Na){var Ib=bb.Rjg/Na,vc=2*Ib,Yc=bb.Qjg/2;Na=(Na-12-8)*Ib/2;var Md=document.createElementNS(bb.$2d,"g");Sys.UI.DomElement.addCssClass(Md,bb.hfh);for(var Ed=1;3>=Ed;Ed++)Md.appendChild(bb.HQh(Ed,vc,Na+(6*Ed-2)*Ib,Yc));return Md};bb.HQh=function(Na,Ib,vc,Yc){var Md=document.createElementNS(bb.$2d,"circle");Sys.UI.DomElement.addCssClass(Md,String.format("{0}-{1}",bb.L0g,Na));Md.setAttribute("cx",String.format("{0}",vc));Md.setAttribute("cy",String.format("{0}",Yc));Md.setAttribute("r",
String.format("{0}",Ib));return Md};bb.$2d="http://www.w3.org/2000/svg";bb.hfh="prDancingDots";bb.L0g="prAnimateCircle";bb.ifh="0 0 {0} {1}";bb.Qjg=40;bb.Rjg=120;Object(Ha.a)(bb,"ModernPresenceTooltipDancingDots",null,[]);var Fc=b(117),fd=b(156),jd=b(12),zd=b(90),zc=b(121),$e=b(55),Xe=b(28);Am(Ua,Gb);Ua.prototype.JXc=function(Na){this.addHandler(xa.ula,Na)};Ua.prototype.$uc=function(Na){this.removeHandler(xa.ula,Na)};Ua.prototype.dispose=function(){this.element&&(this.Ji.za(jd.a.click,this.element,
Object(tb.a)(this,this.dd,"onClick")),this.Ji.za(jd.a.qk,this.element,Object(tb.a)(this,this.cBc,"stopPropagationAndPreventDefaultBehavior")),this.UA.za(jd.a.pointerDown,this.element,Object(tb.a)(this,this.onPointerDown,"onPointerDown")),this.UA.za(jd.a.pointerOut,this.element,Object(tb.a)(this,this.HO,"onPointerOut")),this.UA.za(jd.a.pointerOver,this.element,Object(tb.a)(this,this.$w,"onPointerOver")),this.qJc.za(this.element,Object(tb.a)(this,this.cBc,"stopPropagationAndPreventDefaultBehavior")));
Gb.prototype.dispose.call(this)};Ua.prototype.Gv=function(Na){this.Ji=Na.get(10);this.Ji.qa(jd.a.click,this.element,Object(tb.a)(this,this.dd,"onClick"));this.Ji.qa(jd.a.qk,this.element,Object(tb.a)(this,this.cBc,"stopPropagationAndPreventDefaultBehavior"));this.UA=Na.get(9);this.UA.qa(jd.a.pointerOver,this.element,Object(tb.a)(this,this.$w,"onPointerOver"));this.UA.qa(jd.a.pointerOut,this.element,Object(tb.a)(this,this.HO,"onPointerOut"));this.UA.qa(jd.a.pointerDown,this.element,Object(tb.a)(this,
this.onPointerDown,"onPointerDown"));this.qJc=Na.get(13);this.qJc.qa(this.element,Object(tb.a)(this,this.cBc,"stopPropagationAndPreventDefaultBehavior"))};Ua.prototype.hide=function(Na,Ib,vc){Na=void 0===Na?null:Na;Ib=void 0===Ib?0:Ib;vc=void 0===vc?0:vc;this.iCg&&Na?this.MFj(Na,Ib,vc):(3===this.state&&this.jTf(),this.visible=!1,this._state=5)};Ua.prototype.MFj=function(Na,Ib,vc){this.show(Na,Ib,15,4,void 0,void 0===vc?0:vc)};Ua.prototype.r7f=function(Na,Ib,vc,Yc,Md,Ed){this.show(Na,Ib,20,(void 0===
vc?0:vc)?2:(void 0===Yc?0:Yc)?1:0,void 0===Md?!1:Md,void 0===Ed?0:Ed)};Ua.prototype.iFj=function(Na,Ib,vc,Yc,Md){this.show(Na,Ib,vc+20,3,void 0===Yc?!1:Yc,void 0===Md?0:Md)};Ua.prototype.show=function(Na,Ib,vc,Yc,Md,Ed){Yc=void 0===Yc?3:Yc;Ed=void 0===Ed?0:Ed;!Na||Yc===this.state&&this.X$h(Ib,vc)||(this.CEg(Yc,void 0===Md?!1:Md,Ed),this.ZZa(Na,Yc,Ed),this._state=Yc,4===Ed||0===Ed&&!this.PJ?this.element.style.left=Ib+"px":this.element.style.right=Ib+"px",this.element.style.top=vc+"px",this.visible=
!0)};Ua.prototype.ZZa=function(Na,Ib,vc){this.Ome=Na;$e.a.Nrb(this.iH);zc.a.L1g(this.iH);this.iH.id="fly_"+Na.clientId;this.iH.style.backgroundColor=Na.color;4!==Ib?(this.iH.style.height=this.vjb+"px",this.iH.style.lineHeight=this.vjb+"px",zc.a.fTa(this.iH,"border-radius",this.vjb+"px")):4===vc||0===vc&&!this.PJ?this.iH.style.left="0px":this.iH.style.right="0px";2!==Ib&&(4===Ib?$e.a.kyc(this.iH,""):1===Ib?this.iH.appendChild(this.Trg):(this.iH.setAttribute("dir","auto"),vc=Xe.a.CWh(Na.userName),(!Na.isAnonymous||
Tb.AFrameworkApplication.ha.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsCustomAnonymousNameEnabled",!1))&&vc||0!==Ib?(Na=Na.userName,0===Ib&&(Na=vc,zc.a.fTa(this.iH,"text-align","center")),$e.a.kyc(this.iH,Na)):(this.HMc||(this.HMc=this.O8g()),this.iH.appendChild(this.HMc),zc.a.fTa(this.iH,"text-align","start"))))};Ua.prototype.dd=function(Na){if(0===this.state)return this.raiseEvent(xa.ula,new xa(1,Na)),!0;3===this.state&&Ub.ULS.sendTraceTag(50436114,302,50,"User clicked on presence pill.");
return!1};Ua.prototype.HO=function(Na){3===this.state&&this.raiseEvent(xa.ula,new xa(3,Na));return!1};Ua.prototype.$w=function(Na){3!==Na.zb&&this.raiseEvent(xa.ula,new xa(2,Na));return!1};Ua.prototype.onPointerDown=function(Na){if(3!==Na.zb)return!0;this.raiseEvent(xa.ula,new xa(4,Na));return!1};Ua.prototype.O8g=function(){var Na=document.createElement("img");Na.src=Fc.a.bua("doughperson_white_glyph.svg");Na.setAttribute("Unselectable","on");zd.a.ih(Na,zd.a.Vd,zd.a.ls);return fd.createClusteredImageFromClusterWithImageClass(this.vjb,
this.vjb,null,null,Ua.QIh,"",!1,"",this.element.ownerDocument,Na)};Ua.prototype.CEg=function(Na,Ib,vc){Ib=void 0===Ib?!1:Ib;vc=void 0===vc?0:vc;if(!this.lAb(this.state)||!this.lAb(Na))switch(Sys.UI.DomElement.removeCssClass(this.element,this.HIc),this.state){case 4:3===Na?this.Hha(Ua.med,Ua.AYe):this.lAb(Na)&&this.Hha(Ua.ked,Ua.AYe);break;case 3:4===Na?this.Hha(Ua.ped,Ua.zYe):this.lAb(Na)&&(Ib&&this.jTf(),this.Hha(Ua.ked,Ua.zYe,Ib?Ua.PIh:""));break;case 0:case 1:case 2:4===Na?this.Hha(Ua.ped,Ua.ned):
3===Na&&(Ib&&this.bFg(),this.Hha(Ua.med,Ua.ned,Ib?Ua.BYe:"",3===vc?Ua.TIh:Ua.RIh));break;default:4===Na?this.Hha(Ua.ped):3===Na?this.Hha(Ua.med):this.lAb(Na)&&this.Hha(Ua.ked)}};Ua.prototype.Hha=function(Na){for(var Ib=[],vc=0;vc<arguments.length;++vc)Ib[vc-0]=arguments[vc];this.HIc=Ib.join(" ");Sys.UI.DomElement.addCssClass(this.element,this.HIc)};Ua.prototype.bFg=function(){var Na=this;this.K9d=window.setTimeout(function(){Na.element&&(Na.cra=Na.element.cloneNode(!0),Na.element.parentNode.appendChild(Na.cra),
Na.element.style.zIndex="2",Na.cra.style.zIndex="1")},300)};Ua.prototype.jTf=function(){var Na=this;window.clearTimeout(this.K9d);this.cra&&(Sys.UI.DomElement.removeCssClass(this.cra,Ua.ned+" "+Ua.BYe),Sys.UI.DomElement.addCssClass(this.cra,Ua.OIh),ma.Task.delay(300).continueWith(function(){Na.element&&Na.element.parentNode===Na.cra.parentNode&&Na.element.parentNode.removeChild(Na.cra)}),zc.a.bJb(this.element,"z-index"))};Ua.prototype.lAb=function(Na){return 0===Na||1===Na||2===Na};Ua.prototype.X$h=
function(Na,Ib){var vc=zc.a.HD(this.element.style.top);return zc.a.HD(this.element.style.left)===Na&&vc===Ib};Ua.prototype.XNd=function(Na){3===Na&&zc.a.U3(this.element,"left")?(Na=zc.a.HD(this.element.style.left),zc.a.bJb(this.element,"left"),this.element.style.right=-1*Na+"px"):4===Na&&zc.a.U3(this.element,"right")&&(Na=zc.a.HD(this.element.style.right),zc.a.bJb(this.element,"right"),this.element.style.left=-1*Na+"px")};uk.Object.defineProperties(Ua.prototype,{user:{configurable:!0,enumerable:!0,
get:function(){return this.Ome}},state:{configurable:!0,enumerable:!0,get:function(){return this._state}}});Ua.NIh="prModernFlyout UIFont";Ua.ped="flyoutIdle";Ua.med="flyoutExpanded";Ua.ked="flyoutCollapsed";Ua.AYe="flyoutFromIdle";Ua.zYe="flyoutFromExpanded";Ua.ned="flyoutFromCollapsed";Ua.BYe="flyoutStacked";Ua.PIh="flyoutFromStacked";Ua.OIh="flyoutFadeOut";Ua.QIh="cui-img-cont-float cui-img-20by20";Ua.RIh="flyoutLtrDir";Ua.TIh="flyoutRtlDir";Object(Ha.a)(Ua,"ModernPresenceTooltipFlyoutControl",
Gb,[]);Object(Ha.a)(ab,"FlyoutsPositioningInfo",null,[]);var pe=b(37);Fa.prototype.pXh=function(Na,Ib,vc,Yc,Md){var Ed=Md.y,ke=Md.height,mc=this.APh(Yc),Rc=mc+Ib,nd=Na*vc+2*(Na-1);vc=null;1===Na||this.zYg(mc,nd,Ed,ke)?Na=new ab(0,0,2):(Na=this.aed(Rc,nd,Ed,ke),Na.offsetTop-=mc);this.fLc?vc=new ab(0,0,void 0,this.rj?4:3):(Yc=this.zPh(Yc,Md),mc=Math.max(0,Md.x),Md=Md.width,Ib=Yc+Ib,this.AYg(Yc,mc,Md)?vc=new ab(0,0,void 0,this.rj?3:4):this.BYg(Ib,mc)&&(vc=new ab(0,0,void 0,this.rj?4:3)),vc||(vc=this.WHh(Yc,
Ib,mc,Md)));return new ab(Na.offsetTop,vc.offsetLeft,Na.Ojg,vc.Sbf)};Fa.prototype.APh=function(Na){return pe.a.yPh(Na)};Fa.prototype.zPh=function(Na,Ib){return this.rj?Ib.width-pe.a.xPh(Na):pe.a.wPh(Na)};Fa.prototype.zYg=function(Na,Ib,vc,Yc){return Na+Ib<=vc+Yc};Fa.prototype.aed=function(Na,Ib,vc,Yc){var Md=1,Ed=Math.max(vc,Na-Ib);Ib>Na-vc&&(Md=2,Ed=Ib<Yc?Yc-Ib:vc);return new ab(Ed,0,Md)};Fa.prototype.AYg=function(Na,Ib,vc){return Na+150<=Ib+vc};Fa.prototype.BYg=function(Na,Ib){return 150<=Na-Ib};
Fa.prototype.WHh=function(Na,Ib,vc,Yc){Yc-Ib>=Na-vc?Na=4:(Ib=Na,Na=3);return new ab(0,Ib,void 0,Na)};Object(Ha.a)(Fa,"ModernPresenceTooltipPositioner",null,[]);Aa.prototype.update=function(Na,Ib){if(3!==Na)if(5!==Na&&this.JM&&this.JM.length){if(4===Na){var vc=this.dug;var Yc=(this.jZa-vc)/2;this.element.style.height=this.jZa+"px";this.element.style.width=this.jZa+"px";Na=zc.a.HD(this.JM[0].element.style.top);Ib=zc.a.HD(this.PJ?this.JM[0].element.style.right:this.JM[0].element.style.left)}else vc=
this.Y6d,Yc=(this.jZa-vc)/2,this.element.style.height=this.jZa+"px",this.element.style.width=this.SQh()+2*Yc+"px",Na=zc.a.HD(this.JM[this.JM.length-1].element.style.top),Ib=this.XXg(this.JM[this.JM.length-1].element,vc,Ib);zc.a.fTa(this.element,"border-radius",this.jZa+"px");this.element.style.top=Na-Yc-vc+"px";this.PJ?this.element.style.right=Ib-Yc+"px":this.element.style.left=Ib-Yc+"px";this.element.parentNode||this._parent.insertBefore(this.element,this._parent.firstChild)}else this.element.parentNode&&
this.element.parentNode.removeChild(this.element)};Aa.prototype.XXg=function(Na,Ib,vc){return this.PJ&&!vc?zc.a.HD(Na.style.right):this.PJ||vc?this.PJ&&vc?-zc.a.HD(Na.style.left)-Ib:-zc.a.HD(Na.style.right)-Ib:zc.a.HD(Na.style.left)};Aa.prototype.SQh=function(){return this.JM&&this.JM.length?this.Y6d+Math.min(this.JM.length-1,2)*this.uqg:0};uk.Object.defineProperties(Aa.prototype,{element:{configurable:!0,enumerable:!0,get:function(){return this._element}}});Object(Ha.a)(Aa,"ModernPresenceTooltipTarget",
null,[]);var Jf=b(174),kc=b(273);Am(qa,Gb);qa.prototype.JXc=function(Na){this.addHandler(xa.ula,Na)};qa.prototype.$uc=function(Na){this.removeHandler(xa.ula,Na)};qa.prototype.dispose=function(){if(this.rhf)this.jRc=!0;else{if(this.zK)for(var Na=Cl(this.zK),Ib=Na.next();!Ib.done;Ib=Na.next())Ib=Ib.value,Ib.$uc(Object(tb.a)(this,this.$$a,"onInteractivityChanged")),$d.a.Fa(Ib);this.JM=null;this.UA.za(jd.a.pointerDown,this.kra.element,Object(tb.a)(this,this.X$a,"onHitTarget"));this.UA.za(jd.a.pointerOver,
this.kra.element,Object(tb.a)(this,this.X$a,"onHitTarget"));this.UA.za(jd.a.pointerOut,this.kra.element,Object(tb.a)(this,this.X$a,"onHitTarget"));Gb.prototype.dispose.call(this)}};qa.prototype.XX=function(){this.fIa();this.visible=!0};qa.prototype.Jea=function(){this.visible=!0;this.FVe();this.yEa=!0};qa.prototype.hide=function(){this.zTf();this.kbf();this.kra.update(this.xCa,this.HYa)};qa.prototype.ZZa=function(Na){var Ib=this.xCa,vc=this.yEa;Na.clientId||(Na.clientId=(qa.Wae++).toString());if(Na.clientId in
this.FUb){var Yc=this.Bvb(Na.clientId);if(0<=Yc){Yc=this.ZA[Yc];if(Yc.color===Na.color&&Yc.userName===Na.userName)return;this.ycb(Na.clientId)}}this.hide();Yc=new Ua(this.createElement("div"),this.Ee);Yc.JXc(Object(tb.a)(this,this.$$a,"onInteractivityChanged"));this.pga.insertBefore(Yc.element,this.pga.firstChild);this.FUb[Na.clientId]=Yc;Array.add(this.ZA,Na);Array.add(this.zK,Yc);this.rig(Ib,vc);this.visible=!0};qa.prototype.ycb=function(Na){if(this.rhf)Array.add(this.Dkb,Na);else{var Ib=this.xCa,
vc=this.yEa;this.hide();this.LTf(Na);this.rig(Ib,vc)}};qa.prototype.cAd=function(Na){var Ib=this.Bvb(Na);if(!(0>=Ib)){var vc=this.ZA[Ib];Na=this.FUb[Na];Array.removeAt(this.ZA,Ib);Array.insert(this.ZA,0,vc);Array.removeAt(this.zK,Ib);Array.insert(this.zK,0,Na);this.pga.removeChild(Na.element);this.pga.appendChild(Na.element);this.fIa()}};qa.prototype.rig=function(Na,Ib){0>=this.ZA.length?this.hide():3===Na&&Ib?this.Jea():this.XX()};qa.prototype.bMb=function(Na,Ib){Ib?this.$Dg(Na):this.PSf(Na)};qa.prototype.Goa=
function(Na){Na!==this.MUb&&(this.MUb=Na,this.sSd(Na))};qa.prototype.position=function(Na,Ib){this.element.style.top=Ib+"px";this.element.style.left=Na+"px"};qa.prototype.fIa=function(Na){if(void 0===Na||!Na||this.L9){this.MUb&&this.sSd(!0);var Ib=Math.min(3,this.bka)-1;Na=0;var vc=1,Yc=0;this.HYa&&(Na=this.bib,vc=-1,Yc=-this.Bta);for(var Md=this.bka-1;Md>Ib;Md--)this.zK[Md].r7f(this.ZA[Md],-4*Ib*vc+Yc,!0,!1,!0,Na);for(;0<=Ib;Ib--)this.zK[Ib].r7f(this.ZA[Ib],-4*Ib*vc+Yc,0<Ib,Array.contains(this.Nfa,
this.ZA[Ib].clientId),Ib!==this.zVb,Na);this.zVb=0;this.kra.update(0,this.HYa);this.zIndex=this.Jtb;this.yEa=!1;this.zTf(0);this.jRc&&this.dispose()}};qa.prototype.FVe=function(){this.MUb&&this.sSd(!1);this.zIndex=this.Jtb+1;var Na=this.Awj();var Ib=Na.offsetX;var vc=Na.offsetY;Na=Na.Rbf;for(var Yc=0;Yc<this.bka;Yc++)this.zK[Yc].iFj(this.ZA[Yc],Ib,vc+(this.Bta+2)*Yc,Yc!==this.zVb,Na)};qa.prototype.kbf=function(){var Na=0,Ib=0;this.HYa&&(Na=this.bib,Ib=-6);for(var vc=0;vc<this.bka;vc++)this.zK[vc].hide(this.ZA[vc],
Ib,Na);this.zIndex=this.Jtb;this.visible=this.yEa=!1;this.jRc&&this.dispose()};qa.prototype.$3c=function(Na){var Ib=this;(Na=void 0===Na?0:Na)?(this.L9=!0,ma.Task.delay(Na).continueWith(function(){Ib.kae?Ib.kbi():Ib.fIa(!0);Ib.L9=!1})):this.kae?this.hide():this.fIa()};qa.prototype.kbi=function(){this.L9&&this.hide()};qa.prototype.zSg=function(){if(Tb.AFrameworkApplication.sa&&Tb.AFrameworkApplication.sa.Qa.Sz&&Jf.c()){var Na=appChrome.selectors.getShyState();return Na.isActive&&0!==Na.state}return!1};
qa.prototype.$$a=function(Na,Ib){var vc=this;Na=this.xCa;this.zSg()||2!==Ib.type&&(4!==Ib.type||3===Na)?4===Ib.type&&3===Na?(this.L9&&(this.L9=!1),this.$3c()):3!==Ib.type||3!==Na||this.yEa||(1<this.bka?(this.L9=!0,ma.Task.delay(250).continueWith(function(){vc.fIa(!0);vc.L9=!1})):this.$3c()):(this.L9&&(this.L9=!1),3!==Na&&(this.FVe(),3===Ib.Zub.zb&&this.$3c(2E3)));this.raiseEvent(xa.ula,Ib)};qa.prototype.X$a=function(Na){3===Na.zb?this.$$a(this,new xa(4,Na)):Na.eventName===jd.a.pointerOver?this.$$a(this,
new xa(2,Na)):Na.eventName===jd.a.pointerOut&&this.$$a(this,new xa(3,Na));return!1};qa.prototype.Euj=function(Na){this.element.style.width=Na+"px";this.element.style.height=this.Bta+"px"};qa.prototype.LTf=function(Na){this.PSf(Na);Na=this.Bvb(Na);if(!(0>Na)){var Ib=this.ZA[Na];Array.removeAt(this.ZA,Na);delete this.FUb[Ib.clientId];Ib=this.zK[Na];this.pga.removeChild(Ib.element);this.Ee.get(18,!1)&&Ib.$uc(Object(tb.a)(this,this.$$a,"onInteractivityChanged"));Array.removeAt(this.zK,Na);Ib.dispose()}};
qa.prototype.zTf=function(Na){Na=void 0===Na?5:Na;if(this.Dkb.length){this.visible&&this.kbf();for(var Ib=0;Ib<this.Dkb.length;Ib++)this.LTf(this.Dkb[Ib]);Array.clear(this.Dkb);0>=this.ZA.length||5===Na?this.hide():0===Na&&this.XX()}};qa.prototype.Bvb=function(Na){for(var Ib=0;Ib<this.ZA.length;Ib++)if(this.ZA[Ib].clientId===Na)return Ib;return-1};qa.prototype.$Dg=function(Na){if(-1===this.Bvb(Na))Ub.ULS.sendTraceTag(41706451,302,15,"Cannot set active editor because client id is invalid");else{if(Array.contains(this.Nfa,
Na)){if(this.ZA[0].clientId===Na)return;Array.remove(this.Nfa,Na)}Array.add(this.Nfa,Na);this.cAd(Na);1!==this.xCa&&this.fIa()}};qa.prototype.PSf=function(Na){-1===this.Bvb(Na)?Ub.ULS.sendTraceTag(41706452,302,50,"Cannot remove active editor because client id is invalid"):Array.contains(this.Nfa,Na)&&(Array.remove(this.Nfa,Na),this.ZA[0].clientId===Na&&0<this.Nfa.length&&this.cAd(this.Nfa[this.Nfa.length-1]),this.ZA[0].clientId===Na&&1===this.xCa&&this.fIa())};qa.prototype.sSd=function(Na){Na?Sys.UI.DomElement.addCssClass(this.pga,
"prBackgroundSelection"):Sys.UI.DomElement.removeCssClass(this.pga,"prBackgroundSelection")};qa.prototype.Awj=function(){var Na;var Ib=Na=0;var vc=this.bib;if(this.ine){var Yc=this.ine(this);if(!Yc)return{offsetX:Na,offsetY:Ib,Rbf:vc};var Md=4===this.xCa;vc=this.Uxg.pXh(this.bka,Md?6:this.Bta,this.Bta,this.element,Yc);Ib=vc.offsetTop;this.zVb=this.zWh(vc.Ojg,vc.offsetTop);vc=vc.Sbf;vc!==this.bib&&(this.XNd(vc),this.element.dir=3===vc?"rtl":"ltr",this.bib=vc);vc!==this.G1e()?(Na=this.Yxg?-2:Md?-6:
-this.Bta,this.HYa=!0):this.HYa=!1}return{offsetX:Na,offsetY:Ib,Rbf:vc}};qa.prototype.zWh=function(Na,Ib){if(1===Na)return this.bka-1;Na=Math.abs(Ib);return 0<Na?Na/(this.Bta+2):0};qa.prototype.XNd=function(Na){for(var Ib=0;Ib<this.bka;Ib++)this.zK[Ib].XNd(Na)};qa.prototype.G1e=function(){return this.rj?3:4};qa.TLh=function(){return String.format("{0}-{1}","presencetooltip",qa.Wae++)};uk.Object.defineProperties(qa.prototype,{Hsc:{configurable:!0,enumerable:!0,get:function(){return kc.a.clone(this.ZA)}},
zK:{configurable:!0,enumerable:!0,get:function(){return this.JM}},Jtb:{configurable:!0,enumerable:!0,get:function(){return this.xrg}},bka:{configurable:!0,enumerable:!0,get:function(){return this.zK?this.zK.length:0}},xCa:{configurable:!0,enumerable:!0,get:function(){return 0<this.bka?this.zK[0].state:5}},rhf:{configurable:!0,enumerable:!0,get:function(){return 3===this.xCa&&!this.yEa}}});qa.Wae=0;Object(Ha.a)(qa,"ModernPresenceTooltipControl",Gb,[363,3]);var $c=b(226),rd=b(367),me=b(177);ha.prototype.x9g=
function(){var Na=document.createElement("div");this.Ee.XZa(15,!1);return new qa(Na,20,this.Ee)};Object(Ha.a)(ha,"ModernPresenceTooltipFactory",null,[364]);var te=b(17),ge=b(59),pd=b(187),jc=b(11),jf=b(34),dc=b(359),za;(function(Na){Na[Na.none=0]="none";Na[Na.master=1]="master";Na[Na.fixed=2]="fixed";Na[Na.horizontal=3]="horizontal";Na[Na.vertical=4]="vertical";Na[Na.first=1]="first";Na[Na.last=4]="last"})(za||(za={}));Object(Ha.b)("PaneType",za);var Mb=Zc.a;Am(ka,Mb);ka.prototype.JXc=function(Na){this.addHandler("interactivityChanged",
Na)};ka.prototype.$uc=function(Na){this.removeHandler("interactivityChanged",Na)};ka.prototype.dispose=function(){if(0<this.mi.count){this.hide();var Na=this.mi.xv,Ib;for(Ib in Na)Na[Ib].dispose()}this.gridView=null;this.mi.clear();Mb.prototype.dispose.call(this)};ka.prototype.sxj=function(Na){this.NLf=Na};ka.prototype.XX=function(){var Na=this.mi.xv,Ib;for(Ib in Na)Na[Ib].XX()};ka.prototype.Jea=function(){this.snd();var Na=this.mi.xv,Ib;for(Ib in Na)Na[Ib].Jea()};ka.prototype.hide=function(){this.YUa();
var Na=this.mi.xv,Ib;for(Ib in Na)Na[Ib].hide()};ka.prototype.ZZa=function(Na){var Ib=this.mi.xv,vc;for(vc in Ib)Ib[vc].ZZa(Na)};ka.prototype.ycb=function(Na){var Ib=this.mi.xv,vc;for(vc in Ib)Ib[vc].ycb(Na)};ka.prototype.cAd=function(){};ka.prototype.bMb=function(Na,Ib){var vc=this.mi.xv,Yc;for(Yc in vc)vc[Yc].bMb(Na,Ib)};ka.prototype.Goa=function(Na){this.nsd!==Na&&(this.nsd=Na,Na=jf.a.Fc(this.mi.xv,Enum.toString(za,ka.RLa()[0])),this.mAa&&Na&&(Na=jc.DOMElementExtensions.getWidth(Na.element)/2,
this.position(this.nsd?this.mAa.x+14+Na:this.mAa.x-14-Na,this.mAa.y)))};ka.prototype.position=function(Na,Ib){var vc=this.mi.xv,Yc;for(Yc in vc){var Md=vc[Yc],Ed=Enum.parse(za,Yc);Ed=this.gridView.Kf(Ed);var ke=da(Ed,new Sys.UI.Point(Na,Ib),!1);this.mAa=new Sys.UI.Point(Na,Ib);0>ke.x&&(ke.x+=Ed.domElement.scrollLeft);jc.DOMElementExtensions.updatePosition(Md.element,ke.x,ke.y,!1,this.rtl)}};ka.prototype.snd=function(){this.mAa&&(this.position(this.mAa.x,this.mAa.y),this.WPd||(this.WPd=!0,this.gridView.Da.lH(this.Yz),
this.gridView.Da.xr(this.Yz),this.gridView.view.nt(this.hG)))};ka.prototype.YUa=function(){this.WPd&&(this.gridView.Da.MI(this.Yz),this.gridView.Da.Jp(this.Yz),this.gridView.view.fr(this.hG))};ka.RLa=function(){return ka.I$||(ka.I$=[1,3,2,4])};uk.Object.defineProperties(ka.prototype,{element:{configurable:!0,enumerable:!0,get:function(){return null}},Hsc:{configurable:!0,enumerable:!0,get:function(){var Na=jf.a.Fc(this.mi.xv,Enum.toString(za,ka.RLa()[0]));return Na?Na.Hsc:null}},r4i:{configurable:!0,
enumerable:!0,get:function(){return this.NLf}}});ka.I$=null;Object(Ha.a)(ka,"PaneInvariantTooltip",Zc.a,[363,3]);ra.KMb=!1;ra.Uoa=!1;Object(Ha.a)(ra,"PresenceViewSettings",null,[]);ba.prototype.dispose=function(){this.YUa();this.clearCache();this.$&&this.$.xa&&this.$.xa.Ag(this.Rza);this.gridView=null};ba.prototype.YUa=function(){this.Wjc&&(this.gridView.Da.MI(this.Yz),this.gridView.Da.Jp(this.Yz),this.gridView.view.fr(this.hG),this.Wjc=!1)};ba.prototype.gUj=function(Na){var Ib=this.Wz[Na],vc=this.Mka(Na);
Ib&&this.iTf(Ib);vc&&this.Fuc(vc,Ib.qAa.clientId,Ib.cC);delete this.tVa[Na];delete this.Wz[Na];delete this.sVa[Na]};ba.prototype.e1d=function(Na){var Ib=Na.cC;this.Wz[Ib]||(this.D6a(Na),this.Wz[Ib]=Na)};ba.prototype.oZj=function(Na){var Ib=Na.cC,vc=this.C5e(Na.Gsc,Na.paneType,Na.range),Yc=this.Mka(Ib);vc&&vc!==Yc&&(Na.SNb(vc),this.tVa[Ib]=vc,this.Wz[Ib]=Na,this.sVa[Ib]&&vc.Goa(this.sVa[Ib]));Yc!==vc&&Yc&&this.Fuc(Yc,Na.qAa.clientId,Na.cC);!this.Wjc&&this.gridView&&(this.gridView.Da.lH(this.Yz),this.gridView.Da.xr(this.Yz),
this.gridView.view.nt(this.hG),this.Wjc=!0)};ba.prototype.Fuc=function(Na,Ib,vc){Na.ycb(Ib);sc.EwaSettings.isChangeGateEnabled("OfficeVSO:3663630_ModernPresenceUxPerf")&&this.Mka(vc)===Na&&delete this.tVa[vc];Na.Hsc&&Na.Hsc.length||((Ib=Na.r4i)&&delete this.JHb[Ib],sc.EwaSettings.isChangeGateEnabled("OfficeVSO:3663630_ModernPresenceUxPerf")||this.Mka(vc)===Na&&delete this.tVa[vc],Na.dispose())};ba.prototype.iTf=function(Na){Na&&(Na.uMd(this.JFb),Na.UMd(this.qGb),Na.TMd(this.pGb),Na.SNb(null))};ba.prototype.D6a=
function(Na){Na.IXc(this.JFb);Na.hYc(this.qGb);Na.gYc(this.pGb)};ba.prototype.HG=function(Na,Ib){if(ra.Uoa){Ib.Ova||this.e1d(Ib);this.oZj(Ib);var vc=this.Mka(Ib.cC);vc&&(vc.ZZa(Ib.qAa),Ib.JNa()?Na?vc.Jea():vc.XX():vc.hide())}};ba.prototype.Mka=function(Na){return this.tVa[Na]};ba.prototype.C5e=function(Na,Ib,vc){if(!Na)return null;Na=this.fid(Na,Ib,vc);var Yc=this.gridView.Kf(Ib).Zq;Ib=ba.t_h(Na,Ib,Yc).toString();Yc=jf.a.Fc(this.JHb,Ib);Yc||(Yc=new ka(this.gridView,this.PHd,vc),Yc.position(Na.x,Na.y),
Yc.sxj(Ib),this.JHb[Ib]=Yc);return Yc};ba.prototype.fid=function(Na,Ib,vc){var Yc=this.gridView.Kf(Ib).An,Md=this.gridView.Kf(Ib).Zq;Ib=dc.a.IN(Ib,Yc.topLeft);var Ed=Math.max(Md.x,Na.x-this.sxa/2-2);Ed=Math.min(Math.max(Ib.x+Md.x,Ed),Ib.x+Md.x+Yc.width-this.sxa);Na=Math.max(Md.y,Na.y-this.sxa/2+1);sc.EwaSettings.isChangeGateEnabled("OfficeVSO:5703071_toolTipOnRightForFirstRow")&&(Ib.y+Md.y>Na||this.zQj(vc))&&(Ed=Math.min(Ed+this.sxa/4,Ib.x+Md.x+Yc.width-this.sxa));Na=Math.min(Math.max(Ib.y+Md.y,Na),
Ib.y+Md.y+Yc.height-this.sxa);return new Sys.UI.Point(Ed,Na)};ba.prototype.clearCache=function(){var Na=this.Wz,Ib;for(Ib in Na)this.iTf(Na[Ib]);Na=this.JHb;for(var vc in Na)Na[vc].dispose();this.tVa={};this.Wz={};this.JHb={};this.sVa={};$d.a.Fa(this.Spa);this.Spa=null};ba.prototype.Rsb=function(){var Na=new $b;Na.add(0,te.a.Ebd);Na.add(1,this.Acf);Na.add(12,49);Na.add(6,this.sxa);this.gridView&&(Na.add(4,Pb.a.Ge(3)),Na.add(5,Pb.a.Ge(3)),Na.add(8,this.gridView.rtl));Na.add(18,!0);this.PHd=new ha(Na);
Na.add(16,this.x5h)};ba.prototype.lYj=function(Na){var Ib=new $b;Ib.add(0,te.a.Ebd);Ib.add(1,this.Acf);Ib.add(12,Number.parseInvariant(Na.toString()));Ib.add(6,this.sxa);this.gridView&&(Ib.add(4,Pb.a.Ge(3)),Ib.add(5,Pb.a.Ge(3)),Ib.add(8,this.gridView.rtl));this.PHd=new ha(Ib)};ba.prototype.tZj=function(Na){this.lYj(Na)};ba.prototype.sig=function(){ra.Uoa&&(this.Spa=pd.AsyncMethodContext.av(this.lZj,100,De.a.I5i,this.Spa))};ba.prototype.Q$e=function(Na,Ib){ra.Uoa&&(this.sVa[Ib.cC]&&Na.Goa(this.sVa[Ib.cC]),
Ib.JNa()?Ib.Voa(!0,!0):Ib.Voa(!1,!0))};ba.prototype.Goa=function(Na,Ib){this.sVa[Na]=Ib;(Na=this.Mka(Na))&&Na.Goa(Ib)};ba.prototype.bMb=function(Na,Ib){var vc=this.Mka(Na);vc&&vc.bMb(Na,Ib)};ba.t_h=function(Na,Ib,vc){return Na.x.toString()+"-"+Na.y.toString()+"-"+Ib.toString()+"-"+vc.x.toString()+"-"+vc.y.toString()};ba.prototype.zQj=function(Na){var Ib;Na=we.g(this.$).Da.fwa(Na.topRight);return null===(Ib=null===Na||void 0===Na?void 0:Na[0])||void 0===Ib?void 0:Ib.$wa};Object(Ha.a)(ba,"PresenceTooltipManager",
null,[3]);var hc=b(103),cc=b(114),Ec=Zc.a;Am(ia,Ec);ia.prototype.IXc=function(Na){this.addHandler("hidePresenceTooltip",Na)};ia.prototype.uMd=function(Na){this.removeHandler("hidePresenceTooltip",Na)};ia.prototype.hYc=function(Na){this.addHandler("showPresenceTooltip",Na)};ia.prototype.UMd=function(Na){this.removeHandler("showPresenceTooltip",Na)};ia.prototype.gYc=function(Na){this.addHandler("showFullPresenceTooltip",Na)};ia.prototype.TMd=function(Na){this.removeHandler("showFullPresenceTooltip",
Na)};ia.prototype.NGa=function(Na){this.addHandler("presenceChanged",Na)};ia.prototype.WAa=function(Na){this.removeHandler("presenceChanged",Na)};ia.prototype.dispose=function(){this.raiseEvent("hidePresenceTooltip");this.raiseEvent("presenceChanged");this.SCe();this.YUa();$d.a.Fa(this.eqb);this.ome=this.domElement=this.gridView=null;Ec.prototype.dispose.call(this)};ia.prototype.IVd=function(Na,Ib){var vc=!!Na&&!id.D(Na).equals(id.D(this.Ax)),Yc=!!Ib&&(!this.lh||this.lh.get_id()!==Ib.get_id());if(vc||
Yc)this.raiseEvent("presenceChanged"),this.SCe(),this.Ova=!1,this.Ax=Na,this.lh=Ib,this.MCb=null};ia.prototype.I5=function(Na){this.visible=this.Ova=!1;Na&&this.raiseEvent("hidePresenceTooltip")};ia.prototype.Kha=function(Na){Array.add(this.sy,Na);this.Obf();Na.NGa(this.VDd)};ia.prototype.Voa=function(Na,Ib){Na?(this.visible=!0,Ib&&(this.eqb=pd.AsyncMethodContext.av(this.mHj,this.$.ya.ShowTooltipDelayInMs,De.a.EQj,this.eqb))):this.I5(Ib)};ia.prototype.SNb=function(Na){this.ome=Na};ia.prototype.Agb=
function(){if(this.domElement&&this.visible){this.E0a=jc.DOMElementExtensions.getBoundingClientRect(this.domElement);var Na=Math.floor(this.E0a.x);this.E0a.x=Na===this.E0a.x?Na:Na+1;this.E0a.y=Math.floor(this.E0a.y)}};ia.prototype.JNa=function(){if(!this.Ax)return!1;if(sc.EwaSettings.ma(702)){var Na=this.A_h();return Na?this.gridView.wqi(Na,this.paneType):!1}Na=this.gridView.Kf(this.paneType).An;var Ib=this.gridView.jg(this.range,this.paneType);return Na.Od(Ib)};ia.prototype.A_h=function(){if(this.range.isSingle){var Na=
this.gridView.Da.ywa(this.range,this.$.activeItemName);return Na?(Na=Na.xt(this.range))?Na.JF:null:null}return this.range};ia.prototype.SCe=function(){for(var Na=0,Ib=this.sy.length;Na<Ib;Na++)this.sy[Na].WAa(this.VDd);Array.clear(this.sy);this.YUa()};ia.prototype.Obf=function(){!this.Vjc&&1<=this.sy.length&&(this.Vjc=!0,this.gridView.Da.lH(this.Yz),this.gridView.Da.xr(this.Yz),this.gridView.view.nt(this.hG))};ia.prototype.YUa=function(){this.Vjc&&!this.sy.length&&(this.Vjc=!1,this.gridView&&(this.gridView.Da.MI(this.Yz),
this.gridView.Da.Jp(this.Yz),this.gridView.view.fr(this.hG)))};ia.prototype.ycb=function(Na){Na.WAa(this.VDd);Array.remove(this.sy,Na);this.YUa()};ia.prototype.zgg=function(){this.Agb();for(var Na=0,Ib=this.sy.length;Na<Ib;Na++)this.sy[Na].Agb()};uk.Object.defineProperties(ia.prototype,{cC:{configurable:!0,enumerable:!0,get:function(){return this.gVc}},qAa:{configurable:!0,enumerable:!0,get:function(){return this.xRc}},paneType:{configurable:!0,enumerable:!0,get:function(){return this.Xra}},Gsc:{configurable:!0,
enumerable:!0,get:function(){if(!this.domElement)return null;var Na=this.gridView.Kf(this.paneType).An,Ib=this.gridView.rtl,vc=this.domElement.offsetWidth;if(!this.lh&&4>=vc){if(this.Ax){vc=this.gridView.nh;var Yc=this.Ax.FirstRow;Ib=Ib?this.Ax.FirstColumn:this.Ax.LastColumn;if(vc&&!(Yc>=vc.top&&Yc<=vc.bottom&&Ib>=vc.left&&Ib<=vc.right))return Yc=Yc<=vc.top?Na.y:Na.y+(Yc>=vc.bottom?Na.height:Na.height/2),Ib=Ib<=vc.left?Na.x:Na.x+(Ib>=vc.right?Na.width:Na.width/2),this.MCb=new Sys.UI.Point(Ib,Yc)}return this.MCb}if(this.lh){Na=
this.domElement.offsetTop-2;Yc=parseInt(this.domElement.style.left,10);var Md=0;Ib&&(Md=parseInt(this.domElement.parentNode.style.width,10)-vc-Yc,Md-=this.gridView.cP.xya&&this.gridView.cP.Kud?cc.a.Mp:0);return this.MCb=new Sys.UI.Point((Ib?Md:Yc)+vc+4,Na)}return this.MCb=new Sys.UI.Point(parseInt(Ib?this.domElement.style.right:this.domElement.style.left,10)+vc,this.domElement.offsetTop)}},range:{configurable:!0,enumerable:!0,get:function(){return id.D(this.Ax)}}});Object(Ha.a)(ia,"TooltipNotificationUnit",
Zc.a,[653,3]);var Lc=Zc.a;Am(aa,Lc);aa.prototype.IXc=function(Na){this.addHandler("hidePresenceTooltip",Na)};aa.prototype.uMd=function(Na){this.removeHandler("hidePresenceTooltip",Na)};aa.prototype.hYc=function(Na){this.addHandler("showPresenceTooltip",Na)};aa.prototype.UMd=function(Na){this.removeHandler("showPresenceTooltip",Na)};aa.prototype.gYc=function(Na){this.addHandler("showFullPresenceTooltip",Na)};aa.prototype.TMd=function(Na){this.removeHandler("showFullPresenceTooltip",Na)};aa.prototype.NGa=
function(Na){this.addHandler("presenceChanged",Na)};aa.prototype.WAa=function(Na){this.removeHandler("presenceChanged",Na)};aa.prototype.dispose=function(){this.raiseEvent("hidePresenceTooltip");this.raiseEvent("presenceChanged");this.My&&this.My.gUj(this.cC);var Na=this.Wz,Ib;for(Ib in Na){var vc=Na[Ib];vc.uMd(this.JFb);vc.UMd(this.qGb);vc.TMd(this.pGb);vc.WAa(this.eGb);vc.dispose()}this.My=this.Nb=this.highlight=this.gridView=this.Wz=null;Lc.prototype.dispose.call(this)};aa.prototype.W8f=function(Na,
Ib,vc){vc=void 0===vc?null:vc;Na?(this.Nb=id.D(Na),this.Xra=this.gridView.rb.wj(this.Nb.topRight)):vc?(this.lh=vc,this.Xra=vc.sg.paneType):this.Xra=1;this.loe=Ib;this.Fwa(this.paneType);this.IVd(Na,vc)};aa.prototype.IVd=function(Na,Ib){var vc=this.Wz,Yc;for(Yc in vc)vc[Yc].IVd(Na,Ib)};aa.prototype.I5=function(Na){this.Fwa(this.paneType).I5(Na);Na=this.Wz;for(var Ib in Na)Na[Ib].I5(!1)};aa.prototype.Vpe=function(Na){var Ib=this.Wz,vc;for(vc in Ib){var Yc=Ib[vc];Yc.Kha(Na.Fwa(Yc.paneType))}};aa.prototype.Kha=
function(Na){this.Fwa(Na.paneType).Kha(Na)};aa.prototype.JNa=function(){var Na=this.Fwa(this.paneType).JNa(),Ib=this.Wz,vc;for(vc in Ib)Na=Ib[vc].JNa()||Na;return Na};aa.prototype.Voa=function(Na,Ib){this.My.e1d(this);this.Fwa(this.paneType).Voa(Na,Ib);Ib=this.Wz;for(var vc in Ib)Ib[vc].Voa(Na,!1)};aa.prototype.SNb=function(Na){var Ib=this.Wz,vc;for(vc in Ib)Ib[vc].SNb(Na)};aa.prototype.Agb=function(){var Na=this.Wz,Ib;for(Ib in Na)Na[Ib].Agb();this.My.e1d(this)};aa.prototype.Fwa=function(Na){return this.DZh(Na,
this.loe)};aa.prototype.DZh=function(Na,Ib){var vc=this.highlight?this.highlight.Iw(Ib,Na).Qf:this.lh?this.lh.get_element():null;Ib=aa.O4h(Ib,Na);var Yc=jf.a.Fc(this.Wz,Ib);Yc||(Yc=new ia(vc,this.gridView,this.qAa,Na,this.$),this.Wz[Ib]=Yc,Yc.IXc(this.JFb),Yc.hYc(this.qGb),Yc.gYc(this.pGb),Yc.NGa(this.eGb));return Yc};aa.O4h=function(Na,Ib){return Na.toString()+Ib.toString()};uk.Object.defineProperties(aa.prototype,{cC:{configurable:!0,enumerable:!0,get:function(){return this.gVc}},qAa:{configurable:!0,
enumerable:!0,get:function(){return this.xRc}},paneType:{configurable:!0,enumerable:!0,get:function(){return this.Xra}},range:{configurable:!0,enumerable:!0,get:function(){return this.Nb}},Gsc:{configurable:!0,enumerable:!0,get:function(){return this.Nb||this.lh?da(this.gridView.Kf(this.paneType),this.Fwa(this.paneType).Gsc,!0):null}},Ova:{configurable:!0,enumerable:!0,get:function(){return this.Fwa(this.paneType).Ova},set:function(Na){var Ib=this.Wz,vc;for(vc in Ib)Ib[vc].Ova=Na}}});Object(Ha.a)(aa,
"PaneInvariantTooltipNotificationUnit",Zc.a,[653,3]);J.prototype.dispose=function(){this.azb();$d.a.Fa(this.Bv);this.objectId=this.$=this.Lo=this.lh=null};J.prototype.Kha=function(Na){this.Bv.Vpe(Na.Bv)};J.prototype.azb=function(){this.lh&&this.Lo&&this.Lo.User&&(this.lh.HDc(!1,this.Lo.User.UserID,null),this.Bv.I5(!0))};J.prototype.eNb=function(){ra.KMb&&this.lh&&this.Lo&&this.Lo.User&&(this.lh.HDc(!0,this.Lo.User.UserID,this.Lo.UserColor),this.Bv.Agb())};J.prototype.HG=function(Na){ra.Uoa&&(this.Bv.Ova=
Na,this.Bv.Voa(Na,!0))};J.prototype.mNb=function(Na,Ib){this.Bv.W8f(null,0===Ib?46:47,Na)};uk.Object.defineProperties(J.prototype,{lh:{configurable:!0,enumerable:!0,get:function(){return this.wEa},set:function(Na){this.wEa=Na;!this.wEa||sc.EwaSettings.isChangeGateEnabled("OfficeVSO:6032771_PresenceToolTipZIndexCheck")&&!this.wEa.$y||this.My.tZj(this.wEa.$y)}}});Object(Ha.a)(J,"FloatingObjectPresenceHighlight",null,[652,3]);var he=b(720),qe=b(70),Af=b(8),xf=b(257),fc=b(175),Gc=he.a;Am(P,Gc);P.prototype.dispose=
function(){var Na;$d.a.Fa(this.Bv);Gc.prototype.dispose.call(this);var Ib=P.M1a,vc;for(vc in Ib){var Yc=vc,Md=Ib[vc];Md&&!Md.children.length&&(jc.DOMElementExtensions.vf(Md),P.M1a[Yc]=null)}null===(Na=P.excelLiveManager)||void 0===Na?void 0:Na.LMd(this.fGb);this.Mz=null};P.prototype.Kha=function(Na){this.Bv.Vpe(Na.Bv)};P.prototype.HG=function(Na){ra.Uoa&&(this.ajc||(this.Bv.Ova=Na,this.Bv.Voa(Na,!0)),this.hNb=Na&&this.ajc)};P.prototype.mNb=function(Na,Ib){this.Bv.W8f(Na,0===Ib?46:47);this.hNb=!1};
P.prototype.eNb=function(Na){ra.KMb&&(this.Bv.Voa(!0,!0),this.F4d=Na,this.co([Na]))};P.prototype.azb=function(Na){this.I5();this.si(Na)};P.prototype.PIe=function(Na,Ib,vc){vc.className=qe.a.NAh;vc.style.borderColor=this.Lo.UserColor;var Yc=document.createElement("div");46!==Na&&47!==Na&&(Yc.style.backgroundColor=this.Lo.UserColor);vc.appendChild(Yc);Yc.className=[qe.a.PAh,qe.a.OAh][Na-46];Na=jf.a.Fc(P.M1a,Ib.toString());if(!Na){var Md=this.gridView.Kf(Ib).domElement;Na=document.createElement("div");
Md.insertBefore(Na,Md.firstChild);P.M1a[Ib.toString()]=Na}Na.appendChild(vc);fc.h(this.$)&&this.vci(Yc)};P.prototype.Xyb=function(){};P.prototype.X2f=function(Na,Ib,vc,Yc){var Md=this.eMg(Yc,Na,Ib);xf.c(vc,this.gridView.rtl,Af.HelperMethods.Yb(Md.x));vc.width=Af.HelperMethods.Yb(Md.width);vc.top=Af.HelperMethods.Yb(Md.y);vc.height=Af.HelperMethods.Yb(Md.height);Ib=Ib.Qf;vc=Ib.parentNode;47===Na?P.jKd(vc,Ib,!1):46===Na&&(Md=this.Iw(47),Yc.equals(Md.$kc)?P.jKd(vc,Ib,!1):P.jKd(vc,Ib,!0));this.A4i(Na)};
P.prototype.E6f=function(){return!1};P.prototype.eMg=function(Na,Ib,vc){var Yc=Na.y+this.gxb(vc,!1);vc=Na.x+this.gxb(vc,!0)+cc.a.Qfd(vc.Qf.parentNode.parentNode,this.gridView.rtl);var Md=Na.width;Na=Na.height+1;1>vc&&-1<=vc&&46===Ib&&(Md-=1-vc,vc=1);1>Yc&&-1<=Yc&&46===Ib&&(Na-=1-Yc,Yc=1);Md=Math.max(0,Md-1);Na=Math.max(0,Na-2);return new ge.a(vc,Yc,Md,Na)};P.prototype.A4i=function(Na){this.Bv.Agb();this.F4d=Na;this.ajc=!1;this.hNb&&this.HG(!0);this.hNb=!1};P.prototype.I5=function(){this.ajc||(this.Bv.I5(!0),
this.hNb=!1)};P.jKd=function(Na,Ib,vc){vc?Ib!==Na.firstChild&&(Na.removeChild(Ib),Na.insertBefore(Ib,Na.firstChild)):Ib!==Na.lastChild&&(Na.removeChild(Ib),Na.appendChild(Ib))};P.prototype.vci=function(Na){var Ib;(null===(Ib=P.excelLiveManager)||void 0===Ib?0:Ib.FQa.KL)?this.wci(Na):Array.add(this.Mz,Na)};P.prototype.wci=function(Na){this.Lo.User.UserID===P.excelLiveManager.FQa.KL&&(Na.style.backgroundColor=this.Lo.UserColor,Na.style.opacity="0.1")};P.prototype.xxi=function(){var Na=this;P.excelLiveManager?
P.excelLiveManager.l0b(this.fGb):this.$.da.Ya(473,function(Ib){P.excelLiveManager=Ib;P.excelLiveManager.l0b(Na.fGb)})};P.M1a=null;Object(Ha.a)(P,"PresenceHighlight",he.a,[]);Am(I,oa);I.prototype.Uzc=function(){for(var Na=1===this.yc.PresenceType?47:46,Ib=0;Ib<this.Ly.length;Ib++)this.Ly[Ib].eNb(Na);for(Na=0;Na<this.JH.count;Na++)this.JH.ng(Na).eNb()};I.prototype.Rfc=function(){for(var Na=1===this.yc.PresenceType?47:46,Ib=0;Ib<this.Ly.length;Ib++)this.Ly[Ib].azb([Na]);for(Na=0;Na<this.JH.count;Na++)this.JH.ng(Na).azb()};
I.prototype.dispose=function(){this.$&&(this.$.xa&&this.$.xa.Ag(this.Rza),we.g(this.$).UL(this.Xq));this.CMe();$d.a.tc(this.Ly);$d.a.tc([this.qA]);this.qA=this.$=null;this.QSd(null);this.JH=null;oa.prototype.dispose.call(this)};I.prototype.CMe=function(){if(this.JH){for(var Na=0;Na<this.JH.count;Na++)this.JH.ng(Na).dispose();this.JH.clear()}};I.prototype.e1a=function(Na){1===this.yc.Version?this.h0g(Na):this.i0g(Na)};I.prototype.h0g=function(Na){if(Na.yc.SelectedRange&&this.yc.SelectedRange)for(var Ib=
this.yc.SelectedRange.length,vc=Na.yc.SelectedRange.length,Yc=0;Yc<Ib;Yc++)for(var Md=0;Md<vc;Md++)if(wc(this.yc.SelectedRange[Yc],Na.yc.SelectedRange[Md])){this.Ly[Yc].Kha(Na.B5a(Md));return}};I.prototype.i0g=function(Na){var Ib,vc=0,Yc=0;if(this.yc&&this.yc.Object&&(null===(Ib=Na.yc)||void 0===Ib?0:Ib.Object)){Ib=this.yc.Object.length;for(var Md=Na.yc.Object.length,Ed=0;Ed<Ib;Ed++)if(this.yc.Object[Ed]&&this.Yjd(this.yc.Object[Ed])){vc++;for(var ke=0;ke<Md;ke++)if(Na.yc.Object[ke]&&this.Yjd(Na.yc.Object[ke])&&
(Yc++,this.vZc(this.yc.Object[Ed],Na.yc.Object[ke]))){var mc=this.B5a(vc),Rc=Na.B5a(Yc);if(mc&&Rc){mc.Kha(Rc);return}}}else if(this.yc.Object[Ed]&&Na.yc.Object[Ed]&&(0===this.yc.Object[Ed].ObjectType||2===this.yc.Object[Ed].ObjectType))for(ke=0;ke<Md;ke++)if(Na.yc.Object[ke]&&(0===Na.yc.Object[Ed].ObjectType||2===Na.yc.Object[Ed].ObjectType)&&this.yc.Object[Ed].ObjectId===Na.yc.Object[ke].ObjectId&&(mc=this.Ehd(this.yc.Object[Ed].ObjectId),Rc=Na.Ehd(this.yc.Object[Ed].ObjectId),mc&&Rc)){mc.Kha(Rc);
return}}if(Na.yc.SelectedRange&&this.yc.SelectedRange)for(Ib=this.yc.SelectedRange.length,Md=Na.yc.SelectedRange.length,Ed=0;Ed<Ib;Ed++)for(ke=0;ke<Md;ke++)if(wc(this.yc.SelectedRange[Ed],Na.yc.SelectedRange[ke])&&(mc=this.B5a(vc+Ed),Rc=Na.B5a(Yc+ke),mc&&Rc)){mc.Kha(Rc);return}};I.prototype.vZc=function(Na,Ib){return!!Na&&!!Ib&&Ib.ObjectType===Na.ObjectType&&(1===Na.ObjectType||3===Na.ObjectType)&&!Na.ObjectId.localeCompare(Ib.ObjectId)};I.prototype.B5a=function(Na){return 0<=Na&&this.Ly.length>Na?
this.Ly[Na]:null};I.prototype.O8f=function(Na){for(var Ib=0,vc=this.Ly.length;Ib<vc;Ib++)this.Ly[Ib].HG(Na)};I.prototype.Ehd=function(Na){return Na&&this.JH.xb(Na)?this.JH.getItem(Na):null};I.prototype.P8f=function(Na,Ib){Ib=void 0===Ib?null:Ib;if(Na)(Na=this.JH.getItem(Ib))&&Na.HG(!0);else for(Na=0;Na<this.JH.count;Na++)(Ib=this.JH.ng(Na))&&Ib.HG(!1)};I.prototype.Khg=function(Na){oa.eYj(this,Na)};I.prototype.Q6c=function(Na,Ib){if(Na<Ib)return this.Ly[Na];if(!this.Lo||!this.$||!this.My)return null;
Na=new P(this.Lo,this.$,this.My);Array.add(this.Ly,Na);return Na};I.prototype.$vj=function(){for(var Na=this.Ly.length,Ib=this.yc.SelectedRange?this.yc.SelectedRange.length:0,vc=this.$.xa.oa,Yc=0;Yc<Ib;Yc++){var Md=this.Q6c(Yc,Na);Md&&this.yc.SelectedRange[Yc]&&(this.yc.SelectedRange[Yc].NamedObjectName?Md.si([47,46]):(Md.mNb(this.yc.SelectedRange[Yc],this.yc.PresenceType),I.N0d(this.yc.PresenceType,Md,this.yc.SelectedRange[Yc],vc,this.Lo,this.My)))}for(Ib=this.qA&&this.qA.mId&&this.qA.mId.PresenceType!==
this.qA.yc.PresenceType?0:Ib;Ib<Na;Ib++)this.Ly[Ib].si([1===this.qA.mId.PresenceType?47:46])};I.prototype.Yjd=function(Na){return(null===Na||void 0===Na?0:Na.ObjectId)&&(1===this.t4e(Na.ObjectType)||2===this.t4e(Na.ObjectType))&&(Na=this.$.Ab.Mid(Na.ObjectId))?id.w(Na):null};I.prototype.awj=function(){for(var Na=this.Ly.length,Ib=this.$.xa.oa,vc=this.yc.SelectedRange?this.yc.SelectedRange.length:0,Yc=this.yc.Object?this.yc.Object.length:0,Md=0;Md<Na;Md++)this.Ly[Md].si([47,46]);this.q1g();for(var Ed=
this.O5c=this.N5c=Md=0;Ed<Yc;Ed++){var ke=this.yc.Object[Ed],mc=this.Yjd(ke);if(mc){var Rc=this.Q6c(Md,Na);1===ke.ObjectType?this.N5c++:3===ke.ObjectType&&this.O5c++;Md++;Rc.mNb(mc,ke.ObjectPresenceType);I.N0d(ke.ObjectPresenceType,Rc,mc,Ib,this.Lo,this.My)}}for(Yc=0;Yc<vc;Yc++)this.yc&&this.yc.SelectedRange&&(Ed=this.yc.SelectedRange[Yc],Ed.NamedObjectName||(ke=!!Ib&&Ed.SheetName===Ib.name,mc=!!Rb(Ed,this.$,1),ke&&mc||(ke=this.Q6c(Md+Yc,Na),ke.mNb(Ed,this.yc.PresenceType),I.N0d(this.yc.PresenceType,
ke,Ed,Ib,this.Lo,this.My))));0<(this.countFloatingObjects=this.p1f())&&Ub.ULS.sendTraceTag(537154370,0,50,'{{"SetAllFloatingObjectPresenceHighlights":"Success"}')};I.prototype.q1g=function(){this.p1f();this.CMe()};I.prototype.p1f=function(){var Na=0;if(this.yc&&this.yc.Object)for(var Ib=0;Ib<this.yc.Object.length;Ib++)this.NWj(this.yc.Object[Ib])&&Na++;return Na};I.prototype.Cbh=function(Na,Ib){if(this.JH.xb(Ib))return Ib=this.JH.getItem(Ib),Ib.lh=Na,Ib;if(!this.Lo||!this.$||!this.My)return null;
var vc=new J(this.Lo,this.$,this.My);vc.lh=Na;this.JH.add(Ib,vc);return vc};I.prototype.NWj=function(Na){var Ib=!1;if((null===Na||void 0===Na?0:Na.ObjectId)&&(0===Na.ObjectType||2===Na.ObjectType))try{var vc=this.RUh(Na);if(vc){var Yc=this.Cbh(vc,Na.ObjectId);Yc.mNb(vc,Na.ObjectPresenceType);Yc.eNb();Ib=!0}}catch(Md){throw Ub.ULS.sendTraceTag(537154369,0,10,'{{"UpdatedFloatingObjectPresence":"Fail","Exception":"{0}"}',Md.stack),Md;}return Ib};I.prototype.RUh=function(Na){if(!Na)return null;var Ib=
null;2===Na.ObjectType?Ib=hc.a(this.$).nLa(Na.ObjectId):0===Na.ObjectType&&(Na=this.$.Ab.Mid(Na.ObjectId),null===Na||void 0===Na?0:Na.hla)&&(Ib=hc.a(this.$).EWh(Na.hla));return Ib};I.prototype.SRd=function(){try{1===this.yc.Version?(this.$vj(),Ub.ULS.sendTraceTag(537154368,0,50,'{{"SetGridHighlightPass":"V1"}')):(this.awj(),Ub.ULS.sendTraceTag(537154339,0,50,'{{"FloatingObjects":"{0}","PivotTables":"{1}","QueryTables":"{2}"}',this.countFloatingObjects,this.N5c,this.O5c))}catch(Na){throw Ub.ULS.sendTraceTag(537154338,
0,10,'{{"SetGridHighlight Exception":"{0}"}',Na.stack),Na;}};I.prototype.t4e=function(Na){switch(Na){case 0:return 0;case 1:return 1;case 3:return 2;case 2:return 9;default:return-1}};I.N0d=function(Na,Ib,vc,Yc,Md,Ed){var ke=1===Na?47:46;Yc&&vc&&Yc.name===vc.SheetName?(Ib.ak(id.D(vc),[ke]),Ib.eNb(ke),Ub.ULS.shipAssertTag(537154337,0,Ib.Bv.cC===Md.User.UserID,"UserID and UnitID should match"),Ed.bMb(Ib.Bv.cC,1===Na)):Ib.azb([ke])};uk.Object.defineProperties(I.prototype,{yc:{configurable:!0,enumerable:!0,
get:function(){return this.qA.yc},set:function(Na){this.qA.yc=Na;this.SRd()}}});Object(Ha.a)(I,"UserGridPresence",oa,[]);var xd=b(44),Id=b(1004),le=Zc.a;Am(S,le);S.prototype.NGa=function(Na){this.addHandler("pcek",Na)};S.prototype.WAa=function(Na){this.removeHandler("pcek",Na)};S.prototype.MTf=function(Na){this.SCa[Na]&&this.BTf(Na,!1)};S.prototype.CWd=function(Na){this.rtb&&this.rtb!==Na.clientId&&(this.LTd=!1);!sc.EwaSettings.isChangeGateEnabled("OfficeVSO:5657706_CorrectPresenceBootTelemetry")||
this.$.ea.u6a&&xd.PageLoadTrackingInfo.instance.Jtj||(this.LTd=!1);this.eM.D5g(Na);this.rtb=Na.clientId};S.prototype.LWh=function(Na,Ib){var vc=[];var Yc=[];var Md=this.SCa,Ed;for(Ed in Md){var ke=Md[Ed];if(Ib){var mc=id.k(Na,this.$);this.a8e(mc,vc,Yc,ke)}else this.$7e(Na,vc,Yc,ke)}return{aii:vc,Anh:Yc}};S.prototype.uLe=function(Na,Ib,vc,Yc,Md){(Md=this.SCa[Md])&&(Ib?this.a8e(Na,vc,Yc,Md):this.$7e(Na,vc,Yc,Md))};S.prototype.G5h=function(){var Na=[],Ib=this.SCa,vc;for(vc in Ib){var Yc=Ib[vc],Md=Yc.yc.SelectedRange;
if(void 0!==Md&&null!==Md&&sc.EwaSettings.isChangeGateEnabled("OfficeVSO:5280212_Guard_PresenceState.SelectedRange")){Md=Cl(Md);for(var Ed=Md.next();!Ed.done;Ed=Md.next()){Ed=Ed.value;var ke=id.D(Ed),mc=we.g(this.$).ga.va.g5;if(this.$.xa.oa.sheetName===Ed.SheetName&&ke.right===mc.right&&ke.top===mc.top){Yc=Yc.Lo;Yc=new Ud.a(Yc.User.UserID,Yc.User.UserName,Yc.UserColor,new La.a(1),null,Yc.UserEmail,void 0,void 0,void 0,void 0,void 0,Yc.JoinCoauthTime);Array.add(Na,Yc);break}}}}return Na};S.prototype.Uzc=
function(){ra.KMb=!0;ra.Uoa=!0;var Na=this.Vu,Ib;for(Ib in Na)Na[Ib].Uzc()};S.prototype.Rfc=function(){ra.KMb=!1;ra.Uoa=!1;var Na=this.Vu,Ib;for(Ib in Na)Na[Ib].Rfc()};S.prototype.dispose=function(){this.pPb();this.$&&(this.$.xa&&this.$.xa.Ag(this.Rza),this.$.na&&this.$.na.fea(this.Z8),this.$.En(this.rd));this.Cn&&this.Cn.nMd(this.pFb);this.RZc&&(this.RZc.dispose(),this.RZc=null);if(this.Vu){var Na=this.Vu,Ib;for(Ib in Na)Na[Ib].dispose()}$d.a.tc([this.eM,this.My]);this.tCe();this.Vu=this.$=this.$je=
null;Array.clear(this.sy);le.prototype.dispose.call(this)};S.prototype.pPb=function(){this.eM&&(this.eM.WAa(this.WEd),this.eM.rgj(this.RAf),this.eM.Thj(this.iFf),this.eM.dea(this.ld));this.zPa.HUf(this.XFb)};S.prototype.bJe=function(Na){return new I(Na,this.$,this.My)};S.prototype.Spe=function(Na){var Ib=this.$.ea.Lkd(Na);if(Ib)if(Na in this.Vu)this.Vu[Na].Khg(Ib);else{var vc=this.bJe(Ib);this.Vu[Na]=vc;this.e1a(vc)}return!!Ib};S.prototype.a8e=function(Na,Ib,vc,Yc){if(Na){Na=Cl(Na);for(var Md=Na.next();!Md.done;Md=
Na.next()){if(Md=Md.value){var Ed=Rb(Md,this.$,1);if(Ed&&S.Nkd(Ed.pj,Ib,vc,Yc))break;if((Ed=Rb(Md,this.$,2))&&S.Nkd(Ed.pj,Ib,vc,Yc))break}if(Yc.yc.SelectedRange){Ed=Cl(Yc.yc.SelectedRange);for(var ke=Ed.next();!ke.done;ke=Ed.next())if((ke=ke.value)&&Md&&wc(Md,ke)){Array.add(1===Yc.yc.PresenceType?vc:Ib,Yc.qA.dQb.User);return}}}}};S.prototype.$7e=function(Na,Ib,vc,Yc){Na&&S.Nkd(this.XUh(Na),Ib,vc,Yc)};S.prototype.nMg=function(Na){Na.SelectedRange&&(Na.SelectedRangeRaw=this.qgh(Na.SelectedRange),Na.SelectedRange=
this.zPa.k7g(Na.SelectedRange))};S.prototype.qgh=function(Na){for(var Ib=Array(Na.length),vc=0;vc<Na.length;vc++){var Yc=vc,Md=Na[vc],Ed={};Ed.SheetName=Md.SheetName;Ed.FirstColumn=Md.FirstColumn;Ed.FirstRow=Md.FirstRow;Ed.LastRow=Md.LastRow;Ed.LastColumn=Md.LastColumn;Ed.NamedObjectName=Md.NamedObjectName;Ib[Yc]=Ed}return Ib};S.prototype.XUh=function(Na){if(Na)switch(Na.type){case 0:return(Na=this.$.Ab.s4e(Na.id))?Na.pj:null;case 2:return Na.pj}return null};S.prototype.D6a=function(){this.eM.NGa(this.WEd);
this.eM.BKg(this.iFf);this.eM.DIg(this.RAf);this.eM.w3(this.ld);this.zPa.Are(this.XFb)};S.prototype.Dqf=function(Na,Ib,vc,Yc){var Md={};Md.a=this.$.ya.UserSessionId;Md.b=Na;Md.c=vc?"PendingUserRemoved":"Non-PendingUserRemoved";Md.d=Yc?"Disconnected":"Inactivity";Md.e=Ib;hd.b().Te(22,Md,!0)};S.prototype.BTf=function(Na,Ib){Na in this.Vu&&(this.KTf(Na),this.Vu[Na].dispose(),delete this.Vu[Na],Ub.ULS.sendTraceTag(537154375,0,50,"PresenceView.RemovePresenceForUser: userId=[{0}] removed due to inactivity",
Na),this.Dqf(Na,Ae.a.Ra.Ob,!1,Ib));Na in this.yna&&(this.fmc(Na,!1),delete this.bbb[Na],delete this.yna[Na],Ub.ULS.sendTraceTag(537154374,0,50,"PresenceView.RemovePresenceForUser: Pending userId=[{0}] removed due to inactivity",Na),this.Dqf(Na,Ae.a.Ra.Ob,!0,Ib))};S.prototype.KTf=function(Na){for(var Ib=this.sy.length-1;0<=Ib;Ib--)if(this.sy[Ib].User.UserID===Na){Array.removeAt(this.sy,Ib);for(var vc=Cl(this.Vu[Na].Ly),Yc=vc.next();!Yc.done;Yc=vc.next())this.My.Goa(Yc.value.Bv.cC,!1);this.Xzc()}};
S.prototype.ozi=function(){if(this.P5b||this.Q5b)this.$.ae(-70383382,-1,0,null),Ub.ULS.sendTraceTag(537154373,0,50,"PresenceView.LogDiscontinuousCountPresenceData: Discontinuous Presence Received with count= [{0}], Continuous Presence Received with count= [{1}]",this.Q5b,this.P5b);this.Q5b=this.P5b=0};S.prototype.tCe=function(){this.Zwd();this.mRc=this.bbb=null};S.prototype.Zwd=function(){var Na=this.yna,Ib;for(Ib in Na)this.fmc(Ib,!1)};S.prototype.Gyi=function(){var Na=this.u9c,Ib;for(Ib in Na)this.nqf(Ib,
!0,Na[Ib]);Na=this.yod;for(var vc in Na)this.nqf(vc,!1,Na[vc]);this.u9c={};this.yod={}};S.prototype.fmc=function(Na,Ib){if(this.$.uv&&this.$.ea.sc){var vc={};vc.a=this.$.ya.UserSessionId;vc.b=Na;vc.c=Ib;vc.e=!1;vc.d=-1;vc.f=Ae.a.Ra.Ob;this.$.ea&&(vc.e=this.$.ea.tN);if(Na=this.bbb[Na])vc.d=yd.a(Ae.a.Ra,Na);hd.b().Te(20,vc,!0)}};S.prototype.zxd=function(Na){if(this.$.uv){var Ib={e:-1,f:-1,c:!1,d:!1};Ib.b=Na;Ib.a=this.$.ya.UserSessionId;this.$.ea&&(Ib.c=this.$.ea.u6a,Ib.d=this.$.ea.tN,Ib.e=this.$.ea.Om.length,
this.$.ea.eDa&&(Ib.f=yd.a(Ae.a.Ra,this.$.ea.j2j)));hd.b().Te(21,Ib,!0)}};S.prototype.nqf=function(Na,Ib,vc){if(this.$.uv){var Yc={};Yc.a=this.$.ya.UserSessionId;Yc.b=Na;Yc.c=Ib;Yc.d=vc;hd.b().Te(19,Yc,!0)}};S.prototype.C$e=function(){var Na=[],Ib=this.Vu,vc;for(vc in Ib){var Yc=Ib[vc];if(this.eM.q0f(Yc.yc)){this.Cqe(Na,Yc);Array.remove(this.sy,Yc.qA.dQb);if(1===this.eM.yc.PresenceType){var Md={};Md.a=1===Yc.yc.PresenceType?"Editing":"Non-Editing";Md.b=this.$.ya.UserSessionId;Md.c=Ae.a.Ra.Ob;hd.b().Te(18,
Md)}Md=Cl(Yc.Ly);for(Yc=Md.next();!Yc.done;Yc=Md.next())this.My.Goa(Yc.value.Bv.cC,!0)}else for(Md=Cl(Yc.Ly),Yc=Md.next();!Yc.done;Yc=Md.next())this.My.Goa(Yc.value.Bv.cC,!1)}Array.clear(this.sy);this.sy=Na;this.Xzc()};S.prototype.Cqe=function(Na,Ib){var vc=Ib.qA.dQb;if(0===Ib.yc.PresenceType){Ib=Na.length;var Yc;for(Yc=0;Yc<Ib&&0===this.Vu[Na[Yc].User.UserID].yc.PresenceType;Yc++);Array.insert(Na,Yc,vc)}else Array.add(Na,vc)};S.prototype.e1a=function(Na){this.eM.q0f(Na.yc)&&(this.Cqe(this.sy,Na),
this.Xzc());var Ib=Na.qA.dQb.User.UserID,vc=this.Vu,Yc;for(Yc in vc){var Md=vc[Yc];Yc!==Ib&&Na.e1a(Md)}};S.prototype.Xzc=function(){0<this.sy.length&&this.nHj()};S.prototype.nHj=function(){for(var Na=0,Ib=this.sy.length;Na<Ib;Na++){var vc=this.Vu[this.sy[Na].User.UserID];if(vc)if(this.eM.IPf(vc.yc)){vc.O8f(!0);vc=Cl(vc.Ly);for(var Yc=vc.next();!Yc.done;Yc=vc.next())this.My.Goa(Yc.value.Bv.cC,!0)}else(Yc=this.eM.B3e(vc.yc))&&vc.P8f(!0,Yc)}};S.prototype.YZh=function(Na){var Ib={User:{}};Ib.User.UserID=
Na;Ib.User.UserName=je.a.instance.Bb(86);Ib.UserColor="#AAAAAA";return Ib};S.prototype.YDe=function(Na,Ib){var vc=this;this.LTd&&this.IHd&&(Na&&Ib?this.HHd?this.HHd.rph(Na,Ib,this.rtb):this.IHd.continueWith(function(){vc.HHd=vc.IHd.result;vc.YDe(Na,Ib)}):Ub.ULS.sendTraceTag(537154372,0,15,"userId: [{0}], endTime: [{1}]",Na,Ib))};S.Nkd=function(Na,Ib,vc,Yc){if(!Yc||!Yc.yc||!Yc.yc.Object)return!1;for(var Md=Cl(Yc.yc.Object),Ed=Md.next();!Ed.done;Ed=Md.next())if(Ed=Ed.value,Na&&Ed&&Ed.ObjectId&&!Ed.ObjectId.localeCompare(Na))return Array.add(1===
Ed.ObjectPresenceType?vc:Ib,Yc.qA.dQb.User),!0;return!1};uk.Object.defineProperties(S.prototype,{eM:{configurable:!0,enumerable:!0,get:function(){return this.$je}},SCa:{configurable:!0,enumerable:!0,get:function(){return this.Vu}},yna:{configurable:!0,enumerable:!0,get:function(){return this.mRc}}});Object(Ha.a)(S,"PresenceView",Zc.a,[616,617]);var Wd=b(209),Je=b(227),lf=b(328),vf=Zc.a;Am(Z,vf);Z.prototype.Gq=function(Na){this.addHandler("OSC",Na)};Z.prototype.er=function(Na){this.removeHandler("OSC",
Na)};Z.prototype.Xz=function(){this.raiseEvent("OSC")};Z.prototype.Bs=function(Na,Ib){if("QueryOcsConnectionStatus"===Na)Ib.Value=this.$.ea.N8a?je.a.instance.fa(893):je.a.instance.fa(894);else return!1;return!0};Z.prototype.wn=function(){return!0};Z.prototype.dispose=function(){this.statusBarManager&&(this.statusBarManager.tG(this),this.statusBarManager=null);this.$=null;vf.prototype.dispose.call(this)};Object(Ha.a)(Z,"OcsStatusBarManager",Zc.a,[3,533,299]);var se=Zc.a;Am(ea,se);ea.prototype.Fid=
function(){this.p0||(this.p0={},this.p0.IsPresenter=this.$.ya.IsMeetingPresenter,this.p0.MeetingId=this.$.ya.MeetingId);this.p0.MessageId=++this.messageId;Ub.ULS.sendTraceTag(524940883,0,50,"SelectionPresenceManager::getMeetingInfo: Sending presence with messageId: "+this.messageId);return this.p0};ea.prototype.NGa=function(Na){this.addHandler(ea.JHd,Na)};ea.prototype.WAa=function(Na){this.removeHandler(ea.JHd,Na)};ea.prototype.DIg=function(Na){this.$.ea.Qha(Na)};ea.prototype.rgj=function(Na){this.$.ea.eea(Na)};
ea.prototype.w3=function(Na){this.addHandler(ea.p1,Na)};ea.prototype.dea=function(Na){this.removeHandler(ea.p1,Na)};ea.prototype.BKg=function(Na){this.addHandler(ea.KHd,Na)};ea.prototype.Thj=function(Na){this.removeHandler(ea.KHd,Na)};ea.prototype.dispose=function(){this.$&&(this.pPb(),this.$.Bl(this.vd),this.$.En(this.rd));this.Lj&&this.Lj.XAa(this.mna);$d.a.Fa(this.kxf);this.$=this.Lj=this.p0=null;se.prototype.dispose.call(this)};ea.prototype.D5g=function(Na){this.Lj?this.Lj.XAa(this.mna):this.D6a();
(this.Lj=Na)?(this.Lj.OGa(this.mna),this.Hdb(!0)):this.pPb()};ea.prototype.D6a=function(){var Na=this;this.ga.nH(this.ld);we.g(this.$).RE(this.Fp);var Ib=we.g(this.$).zc;Ib.Wo(this.Rg);Ib.wl(this.mj);this.$.ea.ek(this.fd);this.$.ea.mre(this.gmf);this.zPa.Are(this.XFb);Ib=this.$.na.ta;Ib.PGa(this.MIf);Ib.Hq(this.Vh);Ib.mz(this.Xn);this.Xkf?this.$.da.Ya(16,function(vc){vc.cre(Na.kpc);vc.bre(Na.Rg)}):(Ib=va.GetServiceTaskFactory.Ua(this.$.da,16,74,1),fb.TaskExtensions.Ba(Ib,function(vc){Na.fieldManagerPane=
vc.result;Na.fieldManagerPane.cre(Na.kpc);Na.fieldManagerPane.bre(Na.Rg)},Wd.a.none,3))};ea.prototype.pPb=function(){var Na=this;this.ga.xG(this.ld);we.g(this.$).wG(this.Fp);var Ib=we.g(this.$).zc;Ib.Zn(this.Rg);Ib.$k(this.mj);this.$.ea.tk(this.fd);this.$.ea.xUf(this.gmf);this.zPa.HUf(this.XFb);this.$.na.ta.QRa(this.MIf);this.$.na.ta.Rr(this.Vh);this.$.na.ta.fA(this.Xn);this.Xkf?this.$.da.Ya(16,function(vc){vc.oUf(Na.kpc);vc.nUf(Na.Rg)}):this.fieldManagerPane&&(this.fieldManagerPane.oUf(this.kpc),
this.fieldManagerPane.nUf(this.Rg));this.raiseEvent(ea.KHd)};ea.prototype.q0f=function(Na){return this.IPf(Na)||!!this.B3e(Na)};ea.prototype.IPf=function(Na){if(2===this.yc.Version&&this.yc.Object&&2===Na.Version&&Na.Object&&0<this.yc.Object.length&&0<Na.Object.length)for(var Ib=this.yc.Object.length,vc=Na.Object.length,Yc=0;Yc<Ib;Yc++)for(var Md=0;Md<vc;Md++)if(this.vZc(this.yc.Object[Yc],Na.Object[Md]))return!0;if(this.yc.SelectedRange&&Na.SelectedRange)for(Ib=this.yc.SelectedRange.length,vc=Na.SelectedRange.length,
Yc=0;Yc<Ib;Yc++)for(Md=0;Md<vc;Md++)if(ea.iPg(this.yc.SelectedRange[Yc],Na.SelectedRange[Md]))return!0;return!1};ea.prototype.B3e=function(Na){if(2===this.yc.Version&&this.yc.Object&&2===Na.Version&&Na.Object&&0<this.yc.Object.length&&0<Na.Object.length)for(var Ib=this.yc.Object.length,vc=Na.Object.length,Yc=0;Yc<Ib;Yc++)for(var Md=0;Md<vc;Md++)if(ea.AKi(this.yc.Object[Yc],Na.Object[Md]))return this.yc.Object[Yc].ObjectId;return null};ea.prototype.vZc=function(Na,Ib){return!!Na&&!!Ib&&Na.ObjectType===
Ib.ObjectType&&(1===Na.ObjectType||3===Na.ObjectType)&&!!Na.ObjectId&&!!Ib.ObjectId&&!Na.ObjectId.localeCompare(Ib.ObjectId)};ea.prototype.y0f=function(){this.Hdb(!1)};ea.prototype.Hdb=function(Na){this.ga.Pa.nc?this.LQd(0,Na):this.UQd(we.g(this.$).zc.isEditing?1:0,Na)};ea.prototype.LQd=function(Na,Ib){var vc={};this.$.Jj(vc);if(this.ga.Pa.nc){var Yc=this.ga.Pa.nc.floatingObject;vc.FirstColumn=-1;vc.FirstRow=-1;vc.LastColumn=-1;vc.LastRow=-1;vc.NamedObjectName=Yc?Yc.Ug():null;this.yc.SelectedRange=
[vc];this.yc.PresenceType=0;vc=null;if(Yc)switch(Yc.type){case 0:if(Yc=this.$.Ab.s4e(Yc.id))vc={},vc.ObjectType=this.Gba(0),vc.ObjectPresenceType=Na,vc.ObjectId=Yc.pj;break;case 2:Yc.id&&(vc={},vc.ObjectType=this.Gba(9),vc.ObjectPresenceType=Na,vc.ObjectId=Yc.pj)}this.yc.Object=[vc]}this.raiseEvent(ea.p1);this.sendPresenceToService(Ib)};ea.prototype.UQd=function(Na,Ib){if(!we.g(this.$).isEditing&&!we.g(this.$).Vi){var vc=this.$.Sb.Kh("ModelUpdate","SendRangePresence");vc.start();var Yc=id.k(this.ga.va.selectedRanges,
this.$);this.yc.SelectedRange=this.zPa.j7g(Yc);this.yc.Object=[];Yc=Cl(Yc);for(var Md=Yc.next();!Md.done;Md=Yc.next())if(Md=Rb(Md.value,this.$,1)){var Ed={};Ed.ObjectType=this.Gba(Md.type);Ed.ObjectPresenceType=0;Ed.ObjectId=Md.pj;Array.add(this.yc.Object,Ed)}this.yc.PresenceType=Na;this.raiseEvent(ea.p1);this.yc.SelectedRange||this.yc.Object?this.sendPresenceToService(Ib):Ub.ULS.sendTraceTag(537154371,0,50,"SelectionPresenceManager.SendRangePresence: skip sending range presence since selected range/object are both null.  UserId: [{0}]",
this.Lj.clientId);vc.stop()}};ea.prototype.sendPresenceToService=function(Na){if(this.$.ea.t9b||!this.$.ea.d5b||Na)if(this.amIAlone||++this.wBa.b,this.Lj){this.yc.Version=2;this.yc.ClientType=1;this.yc.ChatThreadId=this.xYa.C2c;this.yc.ChatThreadDiscoveryUri=this.xYa.B2c;this.yc.InChat=this.xYa.xzb;this.yc.Cid=this.xYa.email;this.yc.SupportsChat=!!this.xYa.capabilities&&this.xYa.capabilities.cMa(4);this.yc.CollabMode=this.$.ea.N8a?2:0;this.yc.OcsCapable=this.$.ea.ocsCapable;this.$.ya.IsMeetingLiveSession&&
this.$.ya.IsMeetingPresenter&&sc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SendPresenterDetailsForExcelLive",!1)&&(this.yc.MeetingInfo=this.Fid());this.Lj.O0f(this.yc);if(sc.EwaSettings.isChangeGateEnabled("OfficeVSO:5140517_PresenceBootBreakDownMetrics")&&this.$.ea&&this.$.ea.u6a){var Ib=(new Date).getTime();fb.TaskExtensions.Ba(va.GetServiceTaskFactory.Ua(this.$.da,435,436,1),function(vc){vc.result.EAi(Ib)},this.$.la,3)}this.amIAlone||++this.wBa.c}};ea.prototype.HQd=function(){this.$.uv&&
(this.wBa.a=this.$.ya.UserSessionId,hd.b().Te(26,this.wBa,!0));this.wBa.b=0;this.wBa.c=0};ea.prototype.Gba=function(Na){switch(Na){case 0:return 0;case 1:return 1;case 2:return 3;case 9:return 2;default:return-1}};ea.AKi=function(Na,Ib){return!!Na&&!!Na.ObjectId&&!!Ib&&!!Ib.ObjectId&&(0===Na.ObjectType||2===Na.ObjectType)&&Na.ObjectType===Ib.ObjectType&&!Na.ObjectId.localeCompare(Ib.ObjectId)};ea.iPg=function(Na,Ib){return!Na.NamedObjectName&&wc(Na,Ib)};uk.Object.defineProperties(ea.prototype,{yc:{configurable:!0,
enumerable:!0,get:function(){return this.csa}},amIAlone:{configurable:!0,enumerable:!0,get:function(){return!this.$.ea||this.$.ea.amIAlone}}});uk.Object.defineProperties(ea,{asc:{configurable:!0,enumerable:!0,get:function(){var Na={};return ea.ohe||(ea.ohe=(Na.ApplyFilter=1,Na.ApplyPivot=0,Na.ApplyPivotSort=0,Na.ApplyPivotSortByValue=1,Na.ApplyWellKnownPivotFilter=0,Na.RemovePivotFilter=0,Na.SetCustomFilter=1,Na.SetTop10Filter=1,Na.TogglePivotDrill=0,Na.RefreshAll=2,Na))}}});ea.JHd="presenceChanged";
ea.KHd="presenceDisabled";ea.p1="selectionChanged";ea.ohe=null;Object(Ha.a)(ea,"SelectionPresenceManager",Zc.a,[630,3,631]);var wf=Pc.a;Am(O,wf);O.prototype.create=function(){var Na=this;this.manager?this.Eb(this.manager):fb.TaskExtensions.Ba(va.GetServiceTaskFactory.create(this.$.da,28,this.la,this.ub),function(Ib){Na.Eb(Na.manager||(Na.manager=new ea(Na.$,Ib.result)))},this.la,3)};Object(Ha.a)(O,"SelectionPresenceManagerFactory",Pc.a,[]);var Uf=b(1319),Wf=b(5),Tf=b(194),ug=Bc.a;Am(Q,ug);Q.prototype.C3e=
function(Na,Ib){this.WIa=[];Ib=this.presenceView.LWh(Na,Ib);Na=Ib.aii;Ib=Ib.Anh;Array.addRange(this.WIa,Na);Array.addRange(this.WIa,Ib);return Q.Dye(Na,Ib)};Q.prototype.dispose=function(){this.presenceView.WAa(this.eGb);this.UQa&&($d.a.Fa(this.UQa),this.UQa=null);ug.prototype.dispose.call(this)};Q.Dye=function(Na,Ib){if(!Na.length&&!Ib.length)return"";if(Ib.length){if(1===Ib.length)return Na=je.a.instance.Bb(82),String.format(Na,Ib[0].UserName);Na=je.a.instance.Bb(83);return String.format(Na,Ib.length)}if(1===
Na.length)return Ib=je.a.instance.Bb(84),String.format(Ib,Na[0].UserName);Ib=je.a.instance.Bb(85);return String.format(Ib,Na.length)};Object(Ha.a)(Q,"PresenceReadoutHandlerService",Bc.a,[622]);E.prototype.Sbc=function(Na){return Na};E.prototype.Wrc=function(Na){for(var Ib=Array(Na.Kia.count),vc=0,Yc=Cl(Na.Kia.values),Md=Yc.next();!Md.done;Md=Yc.next())Ib[vc]=Md.value,vc++;return U(this.$.na.ta,Ib,Na.Ur,Na.a5,null,null)};E.prototype.R0b=function(Na,Ib){if(!Ib)return Na;if(!Na)return Ub.ULS.shipAssertTag(537154136,
0,!!Na,"CheckCollabServiceActionAggregationPerformer.AggregateActionParameters: Received null newActionParameters"),Ib;Ub.ULS.shipAssertTag(537154135,0,1===Na.Kia.count,"CheckCollabServiceActionAggregationPerformer.AggregateActionParameters: newActionParameters has unexpected number of entries");for(var vc={},Yc=Cl(Na.Kia),Md=Yc.next();!Md.done;vc={PP:vc.PP,Kfa:vc.Kfa},Md=Yc.next())vc.PP=Md.value,vc.Kfa=void 0,function(Ed){return function(){var ke=Ib.Kia.Fc(Ed.PP.key);Ed.Kfa=ke.value;return ke}}(vc)().returnValue?
vc.Kfa.OcsSessionId!==vc.PP.value.OcsSessionId?(Ub.ULS.sendTraceTag(537154134,0,15,"CheckCollabServiceActionAggregationPerformer.AggregateActionParameters: Found nonidentical OcsSessionIds. new SeqNum: {0}, aggregated SeqNum: {1}",vc.PP.value.SeqNum,vc.Kfa.SeqNum),Ib.Kia.ia(vc.PP.key,vc.PP.value.SeqNum<vc.Kfa.SeqNum?vc.PP.value:vc.Kfa),Ib.Ur=vc.PP.value.SeqNum<vc.Kfa.SeqNum?Na.Ur:Ib.Ur):(vc.PP.value.SeqNum>vc.Kfa.SeqNum&&Ib.Kia.ia(vc.PP.key,vc.PP.value),Ib.Ur=Na.Ur):(Ib.Kia.add(vc.PP.key,vc.PP.value),
Ib.Ur=Na.Ur);return Ib};Object(Ha.a)(E,"CheckCollabServiceActionAggregationPerformer",null,[619,620]);t.prototype.Sbc=function(Na){return Na};t.prototype.Wrc=function(Na){var Ib=this.$.na.ta,vc=Na.tfh,Yc=Na.Loc;Na=Na.Ur;var Md=Ib.Ma(1,null);Md.Id=vc;Md.OnBehalfOfOcs=Yc;return Lb.i(Ib,"CheckPersistedContentUpdate",Md,Na,null,null,null,516)};t.prototype.R0b=function(Na,Ib){if(!Ib)return Na;if(!Na)return Ub.ULS.shipAssertTag(537154133,0,!1,"CheckPersistedActionAggregationPerformer.AggregateActionParameters: Received null newActionParameters"),
Ib;Na.Loc=Ib.Loc&&Na.Loc;return Na};Object(Ha.a)(t,"CheckPersistedActionAggregationPerformer",null,[619,620]);A.prototype.Sbc=function(Na){return Na};A.prototype.Wrc=function(Na){var Ib=this.$.na.ta;Na=Na.h1d;var vc=Ib.Ma(1,null);vc.UploadInfo=Na;return Lb.i(Ib,"ProcessUploadRtcNotification",vc,null,null,null,null,0)};A.prototype.R0b=function(Na,Ib){if(!Ib)return Na;if(!Na)return Ub.ULS.shipAssertTag(537154132,0,!!Na,"UploadNotificationActionAggregationPerformer.AggregateActionParameters: Received null newActionParameters"),
Ib;Ib.vWj(Na);return Ib};Object(Ha.a)(A,"CheckUploadNotificationActionAggregationPerformer",null,[619,620]);Object(Ha.a)(v,"RevisionGeneratedNotification",null,[]);Object(Ha.a)(y,"StateDownloadedNotification",null,[]);var Le=b(128),Qd=Bc.a;Am(B,Qd);B.prototype.dispose=function(){this.Pd=!0;this.gqb&&(this.gqb.dispose(),this.gqb=null);this.contentRefreshManager&&(this.bgg(),this.contentRefreshManager=null);this.Da&&(this.Y_d(),this.Da=null);this.viewport&&(this.Y_d(),this.viewport=null);this.tf&&(this.tf=
null);this.$&&(this.$.Bl(this.vd),this.$.ea.tk(this.fd),this.$.ea.UUf(this.ps),this.$=null);this.mergeSuspensionManager&&(this.mergeSuspensionManager.lvc(this.zGb),this.mergeSuspensionManager=null);Qd.prototype.dispose.call(this)};B.prototype.aMj=function(){this.pBc||(this.contentRefreshManager.JKg(this.MFf),this.pBc=!0,this.gqb.hr())};B.prototype.bgg=function(){this.pBc&&(this.contentRefreshManager.Zhj(this.MFf),this.pBc=!1)};B.prototype.ZLj=function(){this.nBc||(this.Da.aq(this.Qg),this.nBc=!0)};
B.prototype.Y_d=function(){this.nBc&&(this.Da.ar(this.Qg),this.nBc=!1)};B.prototype.$Lj=function(){this.oBc||(this.viewport.KKg(this.QFf),this.oBc=!0)};B.prototype.gVj=function(){this.oBc&&(this.viewport.bij(this.QFf),this.oBc=!1)};B.prototype.OGe=function(Na,Ib){if(Na!==Zd.a.Re&&!this.Sea.xb(Na)){var vc=Ae.a.Ra.Ob.toISOString();vc=Object.assign(new y,{StateId:Na,DownloadedOn:vc,IsHidden:this.Je?this.Je.Hi:"visible"!==window.document.visibilityState,DocumentLastUnhidden:this.Je&&this.Je.dlc?this.Je.dlc.toISOString():
null,LastLostRtcConnection:this.contentRefreshManager&&this.contentRefreshManager.Dnf?this.contentRefreshManager.Dnf.toISOString():null,LastOffline:this.tf&&this.tf.Gya?this.tf.Gya.toISOString():null});this.mergeSuspensionManager&&(vc.IsPendingMergeBlockedByClient=this.hya,this.AGd&&(vc.PendingMergeBlockedByClientLastEnded=this.AGd.toISOString()));Ub.ULS.sendTraceTag(537154124,13,50,"ContentLatencyTracker.CreateAndAddstateDownloadedNotifications: {0} - StateDownloadedNotification: {1}",Ib,JSON.stringify(vc));
this.Sea.add(Na,vc)}};B.prototype.Vyd=function(){Tb.AFrameworkApplication.hg&&Tb.AFrameworkApplication.hg.Vyd()};Object(Ha.a)(B,"ContentLatencyTracker",Bc.a,[]);var Of=b(1096);Object(Ha.a)(r,"UpdateInfo",null,[]);var Ee=b(97);Object(Ha.a)(w,"CollabServiceContentUpdateActionParameters",null,[]);var Eg=b(1097),lg=Sys.EventArgs;Am(u,lg);Object(Ha.a)(u,"RevisionGeneratedEventArgs",Sys.EventArgs,[]);h.prototype.TXj=function(){this.Fsc||(this.Fsc=pe.a.Ae(),this.uDb())};h.prototype.QXj=function(){this.lgc||
(this.lgc=pe.a.Ae(),this.uDb())};h.prototype.SXj=function(){this.Qrc||(this.Qrc=pe.a.Ae(),this.uDb())};h.prototype.UXj=function(Na){this.HEc||(this.HEc=pe.a.Ae(),this.Lff=Na,this.uDb())};h.prototype.uDb=function(Na){Na=void 0===Na?0:Na;this.Sif||(Na&&Na>this.uBi?this.Sya(!0):this.Fsc&&this.Qrc&&this.lgc&&this.HEc&&this.Sya(!1))};h.prototype.dispose=function(){this.$=null};h.prototype.Sya=function(Na){var Ib={};Ib.CoAuthorsCount=this.$.ea.Om.length;Ib.HostNotificationTime=this.lgc;Ib.PeerNotificationTime=
this.Qrc;Ib.PresenceNotificationTime=this.Fsc;Ib.UserFetchTime=this.HEc;Ib.IsAlreadyFetchedFromServer=this.Lff;Ib.IsTimeout=Na;Ib.ClientId=this.clientId;Ib.CurrentUserClientId=this.Yeh;Ub.ULS.sendTraceTag(541388879,0,50,"Host Notification Latency Entry: {0}",Ib);this.Vbe=!0};uk.Object.defineProperties(h.prototype,{Sif:{configurable:!0,enumerable:!0,get:function(){return this.Vbe}}});Object(Ha.a)(h,"HostNotificationLatencyEntry",null,[3]);Object(Ha.a)(n,"PersistedContentUpdateActionParameters",null,
[]);m.prototype.kUj=function(Na){this.j1b(Na.w3c,this.NIc);this.j1b(Na.x3c,this.OIc)};m.prototype.j1b=function(Na,Ib){if(Na){Na=Cl(Na);for(var vc=Na.next();!vc.done;vc=Na.next())Ib[vc.value]=!0}};uk.Object.defineProperties(m.prototype,{w3c:{configurable:!0,enumerable:!0,get:function(){return Id.a(this.NIc)}},x3c:{configurable:!0,enumerable:!0,get:function(){return Id.a(this.OIc)}},Rhf:{configurable:!0,enumerable:!0,get:function(){return!this.w3c.length&&!this.x3c.length}}});Object(Ha.a)(m,"UpdatePresenceUsersActionParameters",
null,[]);Object(Ha.a)(l,"UploadRevisionInfo",null,[]);e.prototype.vWj=function(Na){for(var Ib=0;Ib<Na.h1d.length;Ib++){var vc=Na.h1d[Ib];this.i1d.add(vc.ClientId,vc)}};uk.Object.defineProperties(e.prototype,{h1d:{configurable:!0,enumerable:!0,get:function(){return this.i1d.values}}});Object(Ha.a)(e,"UploadNotificationActionParameters",null,[]);var Ef=Zc.a;Am(c,Ef);c.prototype.JKg=function(Na){this.addHandler("ekcrmrrg",Na)};c.prototype.Zhj=function(Na){this.removeHandler("ekcrmrrg",Na)};c.prototype.ipb=
function(Na){this.addHandler("ekcrmmcu",Na)};c.prototype.rJb=function(Na){this.removeHandler("ekcrmmcu",Na)};c.prototype.zJg=function(Na){this.addHandler("LabelUpdateEventKey",Na)};c.prototype.chj=function(Na){this.removeHandler("LabelUpdateEventKey",Na)};c.prototype.hVa=function(Na,Ib){this.$.ea.sc&&(Ub.ULS.sendTraceTag(537154119,0,50,"ContentRefreshManager.UpdatePresenceUsers: clientIdsToAdd=[{0}] clientIdsToRemove=[{1}]",Na?Na.join(","):"null",Ib?Ib.join(","):"null"),this.mYj.Yrc(new m(Na,Ib,null)))};
c.prototype.dispose=function(){this.Lj&&(this.Lj.zJb(this.oda),this.Lj.XAa(this.BEd));this.$&&(this.$.na.Rr(this.Vh),this.$.ea.eea(this.JI));this.Cn&&(this.Cn.nMd(this.pFb),this.Cn.eUf(this.Uzf));this.$=this.Lj=this.h1a=this.xMa=null;Ef.prototype.dispose.call(this)};c.prototype.CWd=function(Na){this.Lj&&(this.Lj.zJb(this.oda),this.Lj.XAa(this.BEd));this.Lj=Object(Eb.a)(328,Na);this.Lj.i_a(this.oda);sc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EditorsTableNotification",!1)&&this.Lj.OGa(this.BEd);
this.currentUserId=this.Lj.clientId};c.prototype.kRf=function(){for(var Na=!this.Lj,Ib=Cl(this.$.ea.Om),vc=Ib.next();!vc.done;vc=Ib.next())(vc=vc.value.User.UserID)&&vc!==this.currentUserId&&!this.h1a.has(vc)&&this.Ldc(vc).UXj(Na)};c.prototype.z9h=function(Na){if(Zd.a.MYf in Na&&Zd.a.LYf in Na&&Zd.a.KYf in Na){var Ib=Na[Zd.a.KYf];1!==Ib||Zd.a.e8 in Na&&Zd.a.ywc in Na||Ub.ULS.sendTraceTag(537154076,13,10,"RTC WetContentUpdate was sent from ECS and is missing some expected fields. Has SessionSiteIdentifier: {0}, Has UserOperationTimeInMs: {1}.",
Zd.a.e8 in Na,Zd.a.ywc in Na);var vc=this.rHa(Na);var Yc=vc.UQf;vc.returnValue||(Na=new u(Na[Zd.a.MYf],Na[Zd.a.LYf],Ib,Yc,Zd.a.ywc in Na?Na[Zd.a.ywc]:0),this.raiseEvent("ekcrmrrg",Na,this))}else Ub.ULS.sendTraceTag(537154077,13,10,"RTC WetContentUpdate is missing some critical fields. Ignoring this update.")};c.prototype.rHa=function(Na){Na=Zd.a.e8 in Na?Na[Zd.a.e8]:null;return{returnValue:this.$.ea.e8===Na,UQf:Na}};c.prototype.vgg=function(){this.$.ea.zoa=Math.max(c.DRg,this.$.ea.zoa)};c.prototype.iUd=
function(Na){Na=Cl(Na);for(var Ib=Na.next();!Ib.done;Ib=Na.next())if(!this.$.ea.Lkd(Ib.value))return!0;return!1};c.prototype.I2c=function(){this.$.ae(1562177611,-1,0,null)};c.prototype.bQa=function(Na){Zd.a.huf in Na&&Zd.a.iuf in Na&&Zd.a.juf in Na&&(Na=Object.assign(new Of.a,{Pending:Na[Zd.a.iuf],Current:Na[Zd.a.huf],SuspensionStartTimestamp:Na[Zd.a.juf]}),this.raiseEvent("ekcrmmcu",new Eg.a(Na),this))};c.prototype.Ldc=function(Na){Na=this.UFe(Na);if(!this.xMa[Na]){var Ib=new h(Na,this.currentUserId,
4E4,this.$);this.xMa[Na]=Ib}this.p_f();return Object(Eb.a)(h,this.xMa[Na])};c.prototype.UFe=function(Na){if(!Na)return Na;var Ib=Na.toLocaleLowerCase();Ib.startsWith("{")||(Ib="{"+Na+"}");return Ib};c.prototype.p_f=function(){var Na=this;this.Cnd||ua.a.isEmpty(this.xMa)||!sc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EditorsTableNotification",!1)||(this.Cnd=ma.Task.delay(2E4).continueWith(function(){Na.Fbi()}))};c.prototype.Fbi=function(){var Na=[],Ib=pe.a.Ae(),vc=this.xMa,Yc;for(Yc in vc){var Md=
Yc,Ed=Object(Eb.a)(h,vc[Yc]);Ed.uDb(Ib);Ed.Sif&&(Ed.dispose(),Na.push(Md))}Na=Cl(Na);for(Ib=Na.next();!Ib.done;Ib=Na.next())Ib=Ib.value,delete this.xMa[Ib],this.h1a.add(Ib);this.Cnd=null;this.p_f()};uk.Object.defineProperties(c.prototype,{Dnf:{configurable:!0,enumerable:!0,get:function(){return this.ode}},joj:{configurable:!0,enumerable:!0,get:function(){return!!this.Lj&&2===this.Lj.connectionState}}});c.DRg=3E4;Object(Ha.a)(c,"ContentRefreshManager",Zc.a,[621]);var eg=b(60);a.prototype.Sbc=function(Na){return Na+
5E3};a.prototype.Wrc=function(Na){var Ib=this;return this.$.ea.sc?fb.TaskExtensions.ts(fb.TaskExtensions.ts(ma.Task.delay(0),function(){var vc=Ib.$.na.ta,Yc=Na.w3c,Md=Na.x3c,Ed=Na.Ur,ke=vc.Ma(1,null);ke.clientIdsToAdd=Yc;ke.clientIdsToRemove=Md;return Lb.i(vc,"UpdatePresenceUsers",ke,Ed,null,null,null,0)},Wd.a.none,0,eg.a.current),function(){return ma.Task.delay(5E3)},Wd.a.none,0,eg.a.current):ma.Task.Sa(!0)};a.prototype.R0b=function(Na,Ib){if(!Ib)return Na;if(!Na)return Ub.ULS.shipAssertTag(537154073,
0,!1,"UpdatePresenceUsersActionAggregationPerformer.AggregateActionParameters: Received null newActionParameter"),Ib;if(Ib.Rhf)return Ib;if(Na.Rhf)return Na;Ib.kUj(Na);return Ib};Object(Ha.a)(a,"UpdatePresenceUsersActionAggregationPerformer",null,[619,620]);Type.registerNamespace("_Ewa");Type.registerNamespace("Common.App.CoauthTelemetry");Ta.main();Type.registerNamespace("Common.App.CollabControls");Type.registerNamespace("Common.App.Presence");Type.registerNamespace("RealtimePresenceUI");sb.a.Ga(yb.ka);
(function(){sb.a.Ga(function(Na){sc.EwaSettings.isChangeGateEnabled("OfficeVSO:5140517_PresenceBootBreakDownMetrics")&&Za.ka(Na);var Ib=Na.da;Ib.Ha(28,new Da(Na));Ib.Ha(158,new O(Na));sb.a.Ga(zb.ka);var vc=va.GetServiceTaskFactory.create(Na.da,158,Ib.la,1),Yc=va.GetServiceTaskFactory.create(Na.da,28,Ib.la,1);fb.TaskExtensions.Ba(fb.TaskExtensions.we([vc,Yc],Ib.la),function(){var Md=new gc.a,Ed=Ib.Aa(26);Ed.CIe(Object(tb.a)(Md,Md.setResult,"setResult"));var ke=new S(Na,Ed,vc.result,Yc.result,ac.a.lr(mb.a.instance.qc("Common.App.CoauthTelemetry.IPresenceBootTelemetry")));
Sc.a.getInstance(Na.da).add(ke);Ib.Ha(159,new zb);fb.TaskExtensions.Ba(va.GetServiceTaskFactory.create(Ib,159,Ib.la,1),function(mc){var Rc=new gc.a;Rc.setResult(ke);new lb(Object.assign(new Ud.a,{clientId:Na.workbookContext.ClientId}),Md.task,Rc.task,mc.result,Ge.a.instance,Tb.AFrameworkApplication.ha.ra("AwayStatusOneMinuteTimeoutIsEnabled")?6E4:Tb.AFrameworkApplication.ha.Cd("AwayCoauthorThresholdMs",9E5),Object(tb.a)(Tb.AFrameworkApplication.Ib,Tb.AFrameworkApplication.Ib.processAction,"processAction"),
pa.instance)},Ib.la)},Ib.la,3);mb.a.instance.register(597,"Microsoft.Office.Excel.WebUI.Client.ISessionStateManager").as("Common.ICoauthoringTelemeryInfoProvider").Ic().Nc(function(){return Na.ea});mb.a.instance.resolve("Common.ICoauthoringTelemeryInfoProvider");mb.a.instance.register(Ja,"Microsoft.Office.Excel.WebUI.Client.Presence.PeopleInfoProvider").as("Common.IPeopleInfoProvider").Ic().Nc(function(){return new Ja(Na)});mb.a.instance.resolve("Common.IPeopleInfoProvider")})})();sb.a.Ga(Uf.a.ka);
sb.a.Ga(function(Na){var Ib=Na.da,vc=va.GetServiceTaskFactory.Ua(Na.da,211,212,1);Ib.Ya(25,function(Yc){fb.TaskExtensions.Ba(vc,function(Md){Ib.Aa(231)||new Q(Md.result,Na,Yc)},Ib.la,3)})});(function(){sb.a.Ga(function(Na){fb.TaskExtensions.Ba(va.GetServiceTaskFactory.Ua(Na.da,12,477,0),function(Ib){var vc=new E(Na),Yc=Na.da.Aa(291);vc=Ib.result.X5b(vc,vc,Yc,"collabService");var Md=new t(Na);Yc=Ib.result.X5b(Md,Md,Yc,"persisted");Md=new a(Na);Md=Ib.result.X5b(Md,Md,null,"updatePresence");var Ed=new A(Na);
Ib=Ib.result.X5b(Ed,Ed,null,"uploadNotification");Na.da.Ha(292,new c(Na,Na.da.Aa(26),vc,Yc,Md,Ib));Sc.a.getInstance(Na.da).add(new B(Na));Sc.a.getInstance(Na.da).add(vc);Sc.a.getInstance(Na.da).add(Yc);Sc.a.getInstance(Na.da).add(Ib)},Na.la)})})()},927:function(z,F,b){function a(){}b.r(F);b.d(F,"RtcUtils",function(){return a});z=b(0);var c=b(13),e=b(1014),l=b(40);a.F2c=function(m,n){n=void 0===n?e.RealtimeChannel.czd:n;try{var h=l.c(m)}catch(u){throw m=String.format("Failed to JSON-serialize payload : {0}",
u),c.ULS.sendTraceTag(18637072,500,10,m),Error.argument("payload",m);}if(h.length>n)throw m=String.format("Payload exceeds maximum length: {0} > {1}.",h.length,n),c.ULS.sendTraceTag(18637074,500,10,m),Error.argument("payload",m);return h};a.deserialize=function(m,n,h){if(!m)return null;if(Object.getType(m)!==String){var u=String.format("Failed to deserialize [{0}] - object is not of type [String] and is instead of type [{1}]. ExtraInfo: [{2}].",n,Object.getType(m).getName(),h);c.ULS.sendTraceTag(18637075,
500,10,u);return null}u=null;try{u=l.a(m)}catch(w){m=String.format("Failed to deserialize [{0}]. Exception deserializing the object : [{1}]. ExtraInfo: [{2}].",n,w,h),c.ULS.sendTraceTag(18637077,500,10,m)}return u};a.FPa=function(m){if(!m)return"";if("string"===typeof m)return m.toString();try{return l.c(m)}catch(n){return m.toString()}};a.nEh=function(m){var n;var h=0;var u=n=null;if(!m)return{rcf:h,tcf:n,exception:u};try{var w=m.source;w&&Object.getType(w)===String&&(u=w);var r=m.context;r&&(m=
r,h=m.status?m.status:0,n=m.statusText?m.statusText:null)}catch(B){}return{rcf:h,tcf:n,exception:u}};Object(z.a)(a,"RtcUtils",null,[])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.cl.js.map/bbfbe8d2a838c0a7b5f053fed20f90e5/EwaDS.cl.js.map